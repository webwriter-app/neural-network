var uZe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var oHn=uZe((hHn,whe)=>{function HSe(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var qSe=Object.defineProperty,cZe=Object.defineProperties,fZe=Object.getOwnPropertyDescriptor,hZe=Object.getOwnPropertyDescriptors,mde=Object.getOwnPropertySymbols,dZe=Object.prototype.hasOwnProperty,pZe=Object.prototype.propertyIsEnumerable,vde=(e,t,n)=>t in e?qSe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,GSe=(e,t)=>{for(var n in t||(t={}))dZe.call(t,n)&&vde(e,n,t[n]);if(mde)for(var n of mde(t))pZe.call(t,n)&&vde(e,n,t[n]);return e},gZe=(e,t)=>cZe(e,hZe(t)),H=(e,t,n,r)=>{for(var i=r>1?void 0:r?fZe(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&qSe(t,n,i),i};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ze=e=>t=>typeof t=="function"?((n,r)=>(customElements.define(n,r),r))(e,t):((n,r)=>{const{kind:i,elements:s}=r;return{kind:i,elements:s,finisher(a){customElements.define(n,a)}}})(e,t);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const mZe=(e,t)=>t.kind==="method"&&t.descriptor&&!("value"in t.descriptor)?{...t,finisher(n){n.createProperty(t.key,e)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:t.key,initializer(){typeof t.initializer=="function"&&(this[t.key]=t.initializer.call(this))},finisher(n){n.createProperty(t.key,e)}},vZe=(e,t,n)=>{t.constructor.createProperty(n,e)};function Q(e){return(t,n)=>n!==void 0?vZe(e,t,n):mZe(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Cr(e){return Q({...e,state:!0})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const rB=({finisher:e,descriptor:t})=>(n,r)=>{var i;if(r===void 0){const s=(i=n.originalKey)!==null&&i!==void 0?i:n.key,a=t!=null?{kind:"method",placement:"prototype",key:s,descriptor:t(n.key)}:{...n,key:s};return e!=null&&(a.finisher=function(o){e(o,s)}),a}{const s=n.constructor;t!==void 0&&Object.defineProperty(n,r,t(r)),e==null||e(s,r)}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function yZe(e){return rB({finisher:(t,n)=>{Object.assign(t.prototype[n],e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function pt(e,t){return rB({descriptor:n=>{const r={get(){var i,s;return(s=(i=this.renderRoot)===null||i===void 0?void 0:i.querySelector(e))!==null&&s!==void 0?s:null},enumerable:!0,configurable:!0};if(t){const i=typeof n=="symbol"?Symbol():"__"+n;r.get=function(){var s,a;return this[i]===void 0&&(this[i]=(a=(s=this.renderRoot)===null||s===void 0?void 0:s.querySelector(e))!==null&&a!==void 0?a:null),this[i]}}return r}})}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var LV;((LV=window.HTMLSlotElement)===null||LV===void 0?void 0:LV.prototype.assignedElements)!=null;let XG="";function KG(e){XG=e}function bZe(e=""){if(!XG){const t=[...document.getElementsByTagName("script")],n=t.find(r=>r.hasAttribute("data-shoelace"));if(n)KG(n.getAttribute("data-shoelace"));else{const r=t.find(s=>/shoelace(\.min)?\.js($|\?)/.test(s.src)||/shoelace-autoloader(\.min)?\.js($|\?)/.test(s.src));let i="";r&&(i=r.getAttribute("src")),KG(i.split("/").slice(0,-1).join("/"))}}return XG.replace(/\/$/,"")+(e?`/${e.replace(/^\//,"")}`:"")}const xZe={name:"default",resolver:e=>bZe(`assets/icons/${e}.svg`)};var wZe=xZe;const yde={caret:`
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="6 9 12 15 18 9"></polyline>
    </svg>
  `,check:`
    <svg part="checked-icon" class="checkbox__icon" viewBox="0 0 16 16">
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">
        <g stroke="currentColor" stroke-width="2">
          <g transform="translate(3.428571, 3.428571)">
            <path d="M0,5.71428571 L3.42857143,9.14285714"></path>
            <path d="M9.14285714,0 L3.42857143,9.14285714"></path>
          </g>
        </g>
      </g>
    </svg>
  `,"chevron-down":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
    </svg>
  `,"chevron-left":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
    </svg>
  `,"chevron-right":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
    </svg>
  `,eye:`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
      <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>
      <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>
    </svg>
  `,"eye-slash":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-slash" viewBox="0 0 16 16">
      <path d="M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7.028 7.028 0 0 0-2.79.588l.77.771A5.944 5.944 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.134 13.134 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755-.165.165-.337.328-.517.486l.708.709z"/>
      <path d="M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829l.822.822zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829z"/>
      <path d="M3.35 5.47c-.18.16-.353.322-.518.487A13.134 13.134 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7.029 7.029 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12-.708.708z"/>
    </svg>
  `,eyedropper:`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eyedropper" viewBox="0 0 16 16">
      <path d="M13.354.646a1.207 1.207 0 0 0-1.708 0L8.5 3.793l-.646-.647a.5.5 0 1 0-.708.708L8.293 5l-7.147 7.146A.5.5 0 0 0 1 12.5v1.793l-.854.853a.5.5 0 1 0 .708.707L1.707 15H3.5a.5.5 0 0 0 .354-.146L11 7.707l1.146 1.147a.5.5 0 0 0 .708-.708l-.647-.646 3.147-3.146a1.207 1.207 0 0 0 0-1.708l-2-2zM2 12.707l7-7L10.293 7l-7 7H2v-1.293z"></path>
    </svg>
  `,"grip-vertical":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-grip-vertical" viewBox="0 0 16 16">
      <path d="M7 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"></path>
    </svg>
  `,indeterminate:`
    <svg part="indeterminate-icon" class="checkbox__icon" viewBox="0 0 16 16">
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">
        <g stroke="currentColor" stroke-width="2">
          <g transform="translate(2.285714, 6.857143)">
            <path d="M10.2857143,1.14285714 L1.14285714,1.14285714"></path>
          </g>
        </g>
      </g>
    </svg>
  `,"person-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
      <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
    </svg>
  `,"play-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-play-fill" viewBox="0 0 16 16">
      <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"></path>
    </svg>
  `,"pause-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pause-fill" viewBox="0 0 16 16">
      <path d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z"></path>
    </svg>
  `,radio:`
    <svg part="checked-icon" class="radio__icon" viewBox="0 0 16 16">
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g fill="currentColor">
          <circle cx="8" cy="8" r="3.42857143"></circle>
        </g>
      </g>
    </svg>
  `,"star-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-star-fill" viewBox="0 0 16 16">
      <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
    </svg>
  `,"x-lg":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">
      <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
    </svg>
  `,"x-circle-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle-fill" viewBox="0 0 16 16">
      <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"></path>
    </svg>
  `},$Ze={name:"system",resolver:e=>e in yde?`data:image/svg+xml,${encodeURIComponent(yde[e])}`:""};var CZe=$Ze;let _Ze=[wZe,CZe],ZG=[];function SZe(e){ZG.push(e)}function kZe(e){ZG=ZG.filter(t=>t!==e)}function bde(e){return _Ze.find(t=>t.name===e)}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const XR=window,gee=XR.ShadowRoot&&(XR.ShadyCSS===void 0||XR.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,mee=Symbol(),xde=new WeakMap;class YSe{constructor(t,n,r){if(this._$cssResult$=!0,r!==mee)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=n}get styleSheet(){let t=this.o;const n=this.t;if(gee&&t===void 0){const r=n!==void 0&&n.length===1;r&&(t=xde.get(n)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),r&&xde.set(n,t))}return t}toString(){return this.cssText}}const EZe=e=>new YSe(typeof e=="string"?e:e+"",void 0,mee),Xt=(e,...t)=>{const n=e.length===1?e[0]:t.reduce((r,i,s)=>r+(a=>{if(a._$cssResult$===!0)return a.cssText;if(typeof a=="number")return a;throw Error("Value passed to 'css' function must be a 'css' function result: "+a+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+e[s+1],e[0]);return new YSe(n,e,mee)},XSe=(e,t)=>{gee?e.adoptedStyleSheets=t.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet):t.forEach(n=>{const r=document.createElement("style"),i=XR.litNonce;i!==void 0&&r.setAttribute("nonce",i),r.textContent=n.cssText,e.appendChild(r)})},wde=gee?e=>e:e=>e instanceof CSSStyleSheet?(t=>{let n="";for(const r of t.cssRules)n+=r.cssText;return EZe(n)})(e):e;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var BV;const r5=window,$de=r5.trustedTypes,AZe=$de?$de.emptyScript:"",Cde=r5.reactiveElementPolyfillSupport,XA={toAttribute(e,t){switch(t){case Boolean:e=e?AZe:null;break;case Object:case Array:e=e==null?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=e!==null;break;case Number:n=e===null?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch{n=null}}return n}},KSe=(e,t)=>t!==e&&(t==t||e==e),zV={attribute:!0,type:String,converter:XA,reflect:!1,hasChanged:KSe},QG="finalized";class w2 extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var n;this.finalize(),((n=this.h)!==null&&n!==void 0?n:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach((n,r)=>{const i=this._$Ep(r,n);i!==void 0&&(this._$Ev.set(i,r),t.push(i))}),t}static createProperty(t,n=zV){if(n.state&&(n.attribute=!1),this.finalize(),this.elementProperties.set(t,n),!n.noAccessor&&!this.prototype.hasOwnProperty(t)){const r=typeof t=="symbol"?Symbol():"__"+t,i=this.getPropertyDescriptor(t,r,n);i!==void 0&&Object.defineProperty(this.prototype,t,i)}}static getPropertyDescriptor(t,n,r){return{get(){return this[n]},set(i){const s=this[t];this[n]=i,this.requestUpdate(t,s,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||zV}static finalize(){if(this.hasOwnProperty(QG))return!1;this[QG]=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),t.h!==void 0&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const n=this.properties,r=[...Object.getOwnPropertyNames(n),...Object.getOwnPropertySymbols(n)];for(const i of r)this.createProperty(i,n[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const n=[];if(Array.isArray(t)){const r=new Set(t.flat(1/0).reverse());for(const i of r)n.unshift(wde(i))}else t!==void 0&&n.push(wde(t));return n}static _$Ep(t,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof t=="string"?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise(n=>this.enableUpdating=n),this._$AL=new Map,this._$Eg(),this.requestUpdate(),(t=this.constructor.h)===null||t===void 0||t.forEach(n=>n(this))}addController(t){var n,r;((n=this._$ES)!==null&&n!==void 0?n:this._$ES=[]).push(t),this.renderRoot!==void 0&&this.isConnected&&((r=t.hostConnected)===null||r===void 0||r.call(t))}removeController(t){var n;(n=this._$ES)===null||n===void 0||n.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((t,n)=>{this.hasOwnProperty(n)&&(this._$Ei.set(n,this[n]),delete this[n])})}createRenderRoot(){var t;const n=(t=this.shadowRoot)!==null&&t!==void 0?t:this.attachShadow(this.constructor.shadowRootOptions);return XSe(n,this.constructor.elementStyles),n}connectedCallback(){var t;this.renderRoot===void 0&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(t=this._$ES)===null||t===void 0||t.forEach(n=>{var r;return(r=n.hostConnected)===null||r===void 0?void 0:r.call(n)})}enableUpdating(t){}disconnectedCallback(){var t;(t=this._$ES)===null||t===void 0||t.forEach(n=>{var r;return(r=n.hostDisconnected)===null||r===void 0?void 0:r.call(n)})}attributeChangedCallback(t,n,r){this._$AK(t,r)}_$EO(t,n,r=zV){var i;const s=this.constructor._$Ep(t,r);if(s!==void 0&&r.reflect===!0){const a=(((i=r.converter)===null||i===void 0?void 0:i.toAttribute)!==void 0?r.converter:XA).toAttribute(n,r.type);this._$El=t,a==null?this.removeAttribute(s):this.setAttribute(s,a),this._$El=null}}_$AK(t,n){var r;const i=this.constructor,s=i._$Ev.get(t);if(s!==void 0&&this._$El!==s){const a=i.getPropertyOptions(s),o=typeof a.converter=="function"?{fromAttribute:a.converter}:((r=a.converter)===null||r===void 0?void 0:r.fromAttribute)!==void 0?a.converter:XA;this._$El=s,this[s]=o.fromAttribute(n,a.type),this._$El=null}}requestUpdate(t,n,r){let i=!0;t!==void 0&&(((r=r||this.constructor.getPropertyOptions(t)).hasChanged||KSe)(this[t],n)?(this._$AL.has(t)||this._$AL.set(t,n),r.reflect===!0&&this._$El!==t&&(this._$EC===void 0&&(this._$EC=new Map),this._$EC.set(t,r))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(n){Promise.reject(n)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((i,s)=>this[s]=i),this._$Ei=void 0);let n=!1;const r=this._$AL;try{n=this.shouldUpdate(r),n?(this.willUpdate(r),(t=this._$ES)===null||t===void 0||t.forEach(i=>{var s;return(s=i.hostUpdate)===null||s===void 0?void 0:s.call(i)}),this.update(r)):this._$Ek()}catch(i){throw n=!1,this._$Ek(),i}n&&this._$AE(r)}willUpdate(t){}_$AE(t){var n;(n=this._$ES)===null||n===void 0||n.forEach(r=>{var i;return(i=r.hostUpdated)===null||i===void 0?void 0:i.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){this._$EC!==void 0&&(this._$EC.forEach((n,r)=>this._$EO(r,this[r],n)),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}w2[QG]=!0,w2.elementProperties=new Map,w2.elementStyles=[],w2.shadowRootOptions={mode:"open"},Cde==null||Cde({ReactiveElement:w2}),((BV=r5.reactiveElementVersions)!==null&&BV!==void 0?BV:r5.reactiveElementVersions=[]).push("1.6.2");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var UV;const i5=window,xw=i5.trustedTypes,_de=xw?xw.createPolicy("lit-html",{createHTML:e=>e}):void 0,JG="$lit$",jg=`lit$${(Math.random()+"").slice(9)}$`,ZSe="?"+jg,TZe=`<${ZSe}>`,$y=document,KA=()=>$y.createComment(""),ZA=e=>e===null||typeof e!="object"&&typeof e!="function",QSe=Array.isArray,DZe=e=>QSe(e)||typeof(e==null?void 0:e[Symbol.iterator])=="function",WV=`[ 	
\f\r]`,zS=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Sde=/-->/g,kde=/>/g,Sv=RegExp(`>|${WV}(?:([^\\s"'>=/]+)(${WV}*=${WV}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Ede=/'/g,Ade=/"/g,JSe=/^(?:script|style|textarea|title)$/i,NZe=e=>(t,...n)=>({_$litType$:e,strings:t,values:n}),he=NZe(1),fu=Symbol.for("lit-noChange"),ri=Symbol.for("lit-nothing"),Tde=new WeakMap,C1=$y.createTreeWalker($y,129,null,!1);function eke(e,t){if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return _de!==void 0?_de.createHTML(t):t}const IZe=(e,t)=>{const n=e.length-1,r=[];let i,s=t===2?"<svg>":"",a=zS;for(let o=0;o<n;o++){const l=e[o];let u,c,f=-1,h=0;for(;h<l.length&&(a.lastIndex=h,c=a.exec(l),c!==null);)h=a.lastIndex,a===zS?c[1]==="!--"?a=Sde:c[1]!==void 0?a=kde:c[2]!==void 0?(JSe.test(c[2])&&(i=RegExp("</"+c[2],"g")),a=Sv):c[3]!==void 0&&(a=Sv):a===Sv?c[0]===">"?(a=i!=null?i:zS,f=-1):c[1]===void 0?f=-2:(f=a.lastIndex-c[2].length,u=c[1],a=c[3]===void 0?Sv:c[3]==='"'?Ade:Ede):a===Ade||a===Ede?a=Sv:a===Sde||a===kde?a=zS:(a=Sv,i=void 0);const d=a===Sv&&e[o+1].startsWith("/>")?" ":"";s+=a===zS?l+TZe:f>=0?(r.push(u),l.slice(0,f)+JG+l.slice(f)+jg+d):l+jg+(f===-2?(r.push(void 0),o):d)}return[eke(e,s+(e[n]||"<?>")+(t===2?"</svg>":"")),r]};class QA{constructor({strings:t,_$litType$:n},r){let i;this.parts=[];let s=0,a=0;const o=t.length-1,l=this.parts,[u,c]=IZe(t,n);if(this.el=QA.createElement(u,r),C1.currentNode=this.el.content,n===2){const f=this.el.content,h=f.firstChild;h.remove(),f.append(...h.childNodes)}for(;(i=C1.nextNode())!==null&&l.length<o;){if(i.nodeType===1){if(i.hasAttributes()){const f=[];for(const h of i.getAttributeNames())if(h.endsWith(JG)||h.startsWith(jg)){const d=c[a++];if(f.push(h),d!==void 0){const p=i.getAttribute(d.toLowerCase()+JG).split(jg),g=/([.?@])?(.*)/.exec(d);l.push({type:1,index:s,name:g[2],strings:p,ctor:g[1]==="."?FZe:g[1]==="?"?RZe:g[1]==="@"?PZe:iB})}else l.push({type:6,index:s})}for(const h of f)i.removeAttribute(h)}if(JSe.test(i.tagName)){const f=i.textContent.split(jg),h=f.length-1;if(h>0){i.textContent=xw?xw.emptyScript:"";for(let d=0;d<h;d++)i.append(f[d],KA()),C1.nextNode(),l.push({type:2,index:++s});i.append(f[h],KA())}}}else if(i.nodeType===8)if(i.data===ZSe)l.push({type:2,index:s});else{let f=-1;for(;(f=i.data.indexOf(jg,f+1))!==-1;)l.push({type:7,index:s}),f+=jg.length-1}s++}}static createElement(t,n){const r=$y.createElement("template");return r.innerHTML=t,r}}function ww(e,t,n=e,r){var i,s,a,o;if(t===fu)return t;let l=r!==void 0?(i=n._$Co)===null||i===void 0?void 0:i[r]:n._$Cl;const u=ZA(t)?void 0:t._$litDirective$;return(l==null?void 0:l.constructor)!==u&&((s=l==null?void 0:l._$AO)===null||s===void 0||s.call(l,!1),u===void 0?l=void 0:(l=new u(e),l._$AT(e,n,r)),r!==void 0?((a=(o=n)._$Co)!==null&&a!==void 0?a:o._$Co=[])[r]=l:n._$Cl=l),l!==void 0&&(t=ww(e,l._$AS(e,t.values),l,r)),t}class MZe{constructor(t,n){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var n;const{el:{content:r},parts:i}=this._$AD,s=((n=t==null?void 0:t.creationScope)!==null&&n!==void 0?n:$y).importNode(r,!0);C1.currentNode=s;let a=C1.nextNode(),o=0,l=0,u=i[0];for(;u!==void 0;){if(o===u.index){let c;u.type===2?c=new iN(a,a.nextSibling,this,t):u.type===1?c=new u.ctor(a,u.name,u.strings,this,t):u.type===6&&(c=new LZe(a,this,t)),this._$AV.push(c),u=i[++l]}o!==(u==null?void 0:u.index)&&(a=C1.nextNode(),o++)}return C1.currentNode=$y,s}v(t){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(t,r,n),n+=r.strings.length-2):r._$AI(t[n])),n++}}class iN{constructor(t,n,r,i){var s;this.type=2,this._$AH=ri,this._$AN=void 0,this._$AA=t,this._$AB=n,this._$AM=r,this.options=i,this._$Cp=(s=i==null?void 0:i.isConnected)===null||s===void 0||s}get _$AU(){var t,n;return(n=(t=this._$AM)===null||t===void 0?void 0:t._$AU)!==null&&n!==void 0?n:this._$Cp}get parentNode(){let t=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&(t==null?void 0:t.nodeType)===11&&(t=n.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,n=this){t=ww(this,t,n),ZA(t)?t===ri||t==null||t===""?(this._$AH!==ri&&this._$AR(),this._$AH=ri):t!==this._$AH&&t!==fu&&this._(t):t._$litType$!==void 0?this.g(t):t.nodeType!==void 0?this.$(t):DZe(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==ri&&ZA(this._$AH)?this._$AA.nextSibling.data=t:this.$($y.createTextNode(t)),this._$AH=t}g(t){var n;const{values:r,_$litType$:i}=t,s=typeof i=="number"?this._$AC(t):(i.el===void 0&&(i.el=QA.createElement(eke(i.h,i.h[0]),this.options)),i);if(((n=this._$AH)===null||n===void 0?void 0:n._$AD)===s)this._$AH.v(r);else{const a=new MZe(s,this),o=a.u(this.options);a.v(r),this.$(o),this._$AH=a}}_$AC(t){let n=Tde.get(t.strings);return n===void 0&&Tde.set(t.strings,n=new QA(t)),n}T(t){QSe(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,i=0;for(const s of t)i===n.length?n.push(r=new iN(this.k(KA()),this.k(KA()),this,this.options)):r=n[i],r._$AI(s),i++;i<n.length&&(this._$AR(r&&r._$AB.nextSibling,i),n.length=i)}_$AR(t=this._$AA.nextSibling,n){var r;for((r=this._$AP)===null||r===void 0||r.call(this,!1,!0,n);t&&t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){var n;this._$AM===void 0&&(this._$Cp=t,(n=this._$AP)===null||n===void 0||n.call(this,t))}}class iB{constructor(t,n,r,i,s){this.type=1,this._$AH=ri,this._$AN=void 0,this.element=t,this.name=n,this._$AM=i,this.options=s,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=ri}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,n=this,r,i){const s=this.strings;let a=!1;if(s===void 0)t=ww(this,t,n,0),a=!ZA(t)||t!==this._$AH&&t!==fu,a&&(this._$AH=t);else{const o=t;let l,u;for(t=s[0],l=0;l<s.length-1;l++)u=ww(this,o[r+l],n,l),u===fu&&(u=this._$AH[l]),a||(a=!ZA(u)||u!==this._$AH[l]),u===ri?t=ri:t!==ri&&(t+=(u!=null?u:"")+s[l+1]),this._$AH[l]=u}a&&!i&&this.j(t)}j(t){t===ri?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t!=null?t:"")}}class FZe extends iB{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===ri?void 0:t}}const OZe=xw?xw.emptyScript:"";class RZe extends iB{constructor(){super(...arguments),this.type=4}j(t){t&&t!==ri?this.element.setAttribute(this.name,OZe):this.element.removeAttribute(this.name)}}class PZe extends iB{constructor(t,n,r,i,s){super(t,n,r,i,s),this.type=5}_$AI(t,n=this){var r;if((t=(r=ww(this,t,n,0))!==null&&r!==void 0?r:ri)===fu)return;const i=this._$AH,s=t===ri&&i!==ri||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,a=t!==ri&&(i===ri||s);s&&this.element.removeEventListener(this.name,this,i),a&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var n,r;typeof this._$AH=="function"?this._$AH.call((r=(n=this.options)===null||n===void 0?void 0:n.host)!==null&&r!==void 0?r:this.element,t):this._$AH.handleEvent(t)}}class LZe{constructor(t,n,r){this.element=t,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(t){ww(this,t)}}const Dde=i5.litHtmlPolyfillSupport;Dde==null||Dde(QA,iN),((UV=i5.litHtmlVersions)!==null&&UV!==void 0?UV:i5.litHtmlVersions=[]).push("2.7.5");const BZe=(e,t,n)=>{var r,i;const s=(r=n==null?void 0:n.renderBefore)!==null&&r!==void 0?r:t;let a=s._$litPart$;if(a===void 0){const o=(i=n==null?void 0:n.renderBefore)!==null&&i!==void 0?i:null;s._$litPart$=a=new iN(t.insertBefore(KA(),o),o,void 0,n!=null?n:{})}return a._$AI(e),a};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var VV,jV;class Y1 extends w2{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,n;const r=super.createRenderRoot();return(t=(n=this.renderOptions).renderBefore)!==null&&t!==void 0||(n.renderBefore=r.firstChild),r}update(t){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=BZe(n,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),(t=this._$Do)===null||t===void 0||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),(t=this._$Do)===null||t===void 0||t.setConnected(!1)}render(){return fu}}Y1.finalized=!0,Y1._$litElement$=!0,(VV=globalThis.litElementHydrateSupport)===null||VV===void 0||VV.call(globalThis,{LitElement:Y1});const Nde=globalThis.litElementPolyfillSupport;Nde==null||Nde({LitElement:Y1});((jV=globalThis.litElementVersions)!==null&&jV!==void 0?jV:globalThis.litElementVersions=[]).push("3.3.2");/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const zZe=(e,t)=>t===void 0?(e==null?void 0:e._$litType$)!==void 0:(e==null?void 0:e._$litType$)===t,UZe=e=>e.strings===void 0,WZe={},VZe=(e,t=WZe)=>e._$AH=t;function Jt(e,t){const n=Object.assign({waitUntilFirstUpdate:!1},t);return(r,i)=>{const{update:s}=r,a=Array.isArray(e)?e:[e];r.update=function(o){a.forEach(l=>{const u=l;if(o.has(u)){const c=o.get(u),f=this[u];c!==f&&(!n.waitUntilFirstUpdate||this.hasUpdated)&&this[i](c,f)}}),s.call(this,o)}}}var tke=globalThis&&globalThis.__decorate||function(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(s=(i<3?a(s):i>3?a(t,n,s):a(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};class Xn extends Y1{emit(t,n){const r=new CustomEvent(t,Object.assign({bubbles:!0,cancelable:!1,composed:!0,detail:{}},n));return this.dispatchEvent(r),r}}tke([Q()],Xn.prototype,"dir",void 0);tke([Q()],Xn.prototype,"lang",void 0);const _r=Xt`
  :host {
    box-sizing: border-box;
  }

  :host *,
  :host *::before,
  :host *::after {
    box-sizing: inherit;
  }

  [hidden] {
    display: none !important;
  }
`;var jZe=Xt`
  ${_r}

  :host {
    display: inline-block;
    width: 1em;
    height: 1em;
    box-sizing: content-box !important;
  }

  svg {
    display: block;
    height: 100%;
    width: 100%;
  }
`;const US=Symbol(),WF=Symbol();let HV;const qV=new Map;let _h=class extends Xn{constructor(){super(...arguments),this.initialRender=!1,this.svg=null,this.label="",this.library="default"}async resolveIcon(e,t){var n;let r;if(t!=null&&t.spriteSheet)return he`<svg part="svg">
        <use part="use" href="${e}"></use>
      </svg>`;try{if(r=await fetch(e,{mode:"cors"}),!r.ok)return r.status===410?US:WF}catch{return WF}try{const i=document.createElement("div");i.innerHTML=await r.text();const s=i.firstElementChild;if(((n=s==null?void 0:s.tagName)==null?void 0:n.toLowerCase())!=="svg")return US;HV||(HV=new DOMParser);const o=HV.parseFromString(s.outerHTML,"text/html").body.querySelector("svg");return o?(o.part.add("svg"),document.adoptNode(o)):US}catch{return US}}connectedCallback(){super.connectedCallback(),SZe(this)}firstUpdated(){this.initialRender=!0,this.setIcon()}disconnectedCallback(){super.disconnectedCallback(),kZe(this)}getUrl(){const e=bde(this.library);return this.name&&e?e.resolver(this.name):this.src}handleLabelChange(){typeof this.label=="string"&&this.label.length>0?(this.setAttribute("role","img"),this.setAttribute("aria-label",this.label),this.removeAttribute("aria-hidden")):(this.removeAttribute("role"),this.removeAttribute("aria-label"),this.setAttribute("aria-hidden","true"))}async setIcon(){var e;const t=bde(this.library),n=this.getUrl();if(!n){this.svg=null;return}let r=qV.get(n);if(r||(r=this.resolveIcon(n,t),qV.set(n,r)),!this.initialRender)return;const i=await r;if(i===WF&&qV.delete(n),n===this.getUrl()){if(zZe(i)){this.svg=i;return}switch(i){case WF:case US:this.svg=null,this.emit("sl-error");break;default:this.svg=i.cloneNode(!0),(e=t==null?void 0:t.mutator)==null||e.call(t,this.svg),this.emit("sl-load")}}}render(){return this.svg}};_h.styles=jZe;H([Cr()],_h.prototype,"svg",2);H([Q({reflect:!0})],_h.prototype,"name",2);H([Q()],_h.prototype,"src",2);H([Q()],_h.prototype,"label",2);H([Q({reflect:!0})],_h.prototype,"library",2);H([Jt("label")],_h.prototype,"handleLabelChange",1);H([Jt(["name","src","library"])],_h.prototype,"setIcon",1);_h=H([ze("sl-icon")],_h);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Og={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},vee=e=>(...t)=>({_$litDirective$:e,values:t});class yee{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,n,r){this._$Ct=t,this._$AM=n,this._$Ci=r}_$AS(t,n){return this.update(t,n)}update(t,n){return this.render(...n)}}/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const wr=vee(class extends yee{constructor(e){var t;if(super(e),e.type!==Og.ATTRIBUTE||e.name!=="class"||((t=e.strings)===null||t===void 0?void 0:t.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter(t=>e[t]).join(" ")+" "}update(e,[t]){var n,r;if(this.it===void 0){this.it=new Set,e.strings!==void 0&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter(s=>s!=="")));for(const s in t)t[s]&&!(!((n=this.nt)===null||n===void 0)&&n.has(s))&&this.it.add(s);return this.render(t)}const i=e.element.classList;this.it.forEach(s=>{s in t||(i.remove(s),this.it.delete(s))});for(const s in t){const a=!!t[s];a===this.it.has(s)||((r=this.nt)===null||r===void 0?void 0:r.has(s))||(a?(i.add(s),this.it.add(s)):(i.remove(s),this.it.delete(s)))}return fu}});/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const nke=Symbol.for(""),HZe=e=>{if((e==null?void 0:e.r)===nke)return e==null?void 0:e._$litStatic$},s5=(e,...t)=>({_$litStatic$:t.reduce((n,r,i)=>n+(s=>{if(s._$litStatic$!==void 0)return s._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${s}. Use 'unsafeStatic' to pass non-literal values, but
            take care to ensure page security.`)})(r)+e[i+1],e[0]),r:nke}),Ide=new Map,qZe=e=>(t,...n)=>{const r=n.length;let i,s;const a=[],o=[];let l,u=0,c=!1;for(;u<r;){for(l=t[u];u<r&&(s=n[u],(i=HZe(s))!==void 0);)l+=i+t[++u],c=!0;u!==r&&o.push(s),a.push(l),u++}if(u===r&&a.push(t[r]),c){const f=a.join("$$lit$$");(t=Ide.get(f))===void 0&&(a.raw=a,Ide.set(f,t=a)),n=o}return e(t,...n)},nA=qZe(he);/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Et=e=>e!=null?e:ri;var GZe=Xt`
  ${_r}

  :host {
    display: inline-block;
    color: var(--sl-color-neutral-600);
  }

  .icon-button {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    background: none;
    border: none;
    border-radius: var(--sl-border-radius-medium);
    font-size: inherit;
    color: inherit;
    padding: var(--sl-spacing-x-small);
    cursor: pointer;
    transition: var(--sl-transition-x-fast) color;
    -webkit-appearance: none;
  }

  .icon-button:hover:not(.icon-button--disabled),
  .icon-button:focus-visible:not(.icon-button--disabled) {
    color: var(--sl-color-primary-600);
  }

  .icon-button:active:not(.icon-button--disabled) {
    color: var(--sl-color-primary-700);
  }

  .icon-button:focus {
    outline: none;
  }

  .icon-button--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .icon-button:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .icon-button__icon {
    pointer-events: none;
  }
`;let zl=class extends Xn{constructor(){super(...arguments),this.hasFocus=!1,this.label="",this.disabled=!1}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleClick(e){this.disabled&&(e.preventDefault(),e.stopPropagation())}click(){this.button.click()}focus(e){this.button.focus(e)}blur(){this.button.blur()}render(){const e=!!this.href,t=e?s5`a`:s5`button`;return nA`
      <${t}
        part="base"
        class=${wr({"icon-button":!0,"icon-button--disabled":!e&&this.disabled,"icon-button--focused":this.hasFocus})}
        ?disabled=${Et(e?void 0:this.disabled)}
        type=${Et(e?void 0:"button")}
        href=${Et(e?this.href:void 0)}
        target=${Et(e?this.target:void 0)}
        download=${Et(e?this.download:void 0)}
        rel=${Et(e&&this.target?"noreferrer noopener":void 0)}
        role=${Et(e?void 0:"button")}
        aria-disabled=${this.disabled?"true":"false"}
        aria-label="${this.label}"
        tabindex=${this.disabled?"-1":"0"}
        @blur=${this.handleBlur}
        @focus=${this.handleFocus}
        @click=${this.handleClick}
      >
        <sl-icon
          class="icon-button__icon"
          name=${Et(this.name)}
          library=${Et(this.library)}
          src=${Et(this.src)}
          aria-hidden="true"
        ></sl-icon>
      </${t}>
    `}};zl.styles=GZe;H([pt(".icon-button")],zl.prototype,"button",2);H([Cr()],zl.prototype,"hasFocus",2);H([Q()],zl.prototype,"name",2);H([Q()],zl.prototype,"library",2);H([Q()],zl.prototype,"src",2);H([Q()],zl.prototype,"href",2);H([Q()],zl.prototype,"target",2);H([Q()],zl.prototype,"download",2);H([Q()],zl.prototype,"label",2);H([Q({type:Boolean,reflect:!0})],zl.prototype,"disabled",2);zl=H([ze("sl-icon-button")],zl);function Ki(e,t,n){return new Promise(r=>{if((n==null?void 0:n.duration)===1/0)throw new Error("Promise-based animations must be finite.");const i=e.animate(t,Object.assign(Object.assign({},n),{duration:YZe()?0:n.duration}));i.addEventListener("cancel",r,{once:!0}),i.addEventListener("finish",r,{once:!0})})}function Mde(e){return e=e.toString().toLowerCase(),e.indexOf("ms")>-1?parseFloat(e):e.indexOf("s")>-1?parseFloat(e)*1e3:parseFloat(e)}function YZe(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}function ma(e){return Promise.all(e.getAnimations().map(t=>new Promise(n=>{const r=requestAnimationFrame(n);t.addEventListener("cancel",()=>r,{once:!0}),t.addEventListener("finish",()=>r,{once:!0}),t.cancel()})))}function Fde(e,t){return e.map(n=>Object.assign(Object.assign({},n),{height:n.height==="auto"?`${t}px`:n.height}))}const rke=new Map,XZe=new WeakMap;function KZe(e){return e!=null?e:{keyframes:[],options:{duration:0}}}function Ode(e,t){return t.toLowerCase()==="rtl"?{keyframes:e.rtlKeyframes||e.keyframes,options:e.options}:e}function Mr(e,t){rke.set(e,KZe(t))}function Zi(e,t,n){const r=XZe.get(e);if(r!=null&&r[t])return Ode(r[t],n.dir);const i=rke.get(t);return i?Ode(i,n.dir):{keyframes:[],options:{duration:0}}}class td{constructor(t,...n){this.slotNames=[],(this.host=t).addController(this),this.slotNames=n,this.handleSlotChange=this.handleSlotChange.bind(this)}hasDefaultSlot(){return[...this.host.childNodes].some(t=>{if(t.nodeType===t.TEXT_NODE&&t.textContent.trim()!=="")return!0;if(t.nodeType===t.ELEMENT_NODE){const n=t;if(n.tagName.toLowerCase()==="sl-visually-hidden")return!1;if(!n.hasAttribute("slot"))return!0}return!1})}hasNamedSlot(t){return this.host.querySelector(`:scope > [slot="${t}"]`)!==null}test(t){return t==="[default]"?this.hasDefaultSlot():this.hasNamedSlot(t)}hostConnected(){this.host.shadowRoot.addEventListener("slotchange",this.handleSlotChange)}hostDisconnected(){this.host.shadowRoot.removeEventListener("slotchange",this.handleSlotChange)}handleSlotChange(t){const n=t.target;(this.slotNames.includes("[default]")&&!n.name||n.name&&this.slotNames.includes(n.name))&&this.host.requestUpdate()}}const eY=new Set,ZZe=new MutationObserver(ake),E2=new Map;let ike=document.documentElement.dir||"ltr",ske=document.documentElement.lang||navigator.language,n1;ZZe.observe(document.documentElement,{attributes:!0,attributeFilter:["dir","lang"]});function QZe(...e){e.map(t=>{const n=t.$code.toLowerCase();E2.has(n)?E2.set(n,Object.assign(Object.assign({},E2.get(n)),t)):E2.set(n,t),n1||(n1=t)}),ake()}function ake(){ike=document.documentElement.dir||"ltr",ske=document.documentElement.lang||navigator.language,[...eY.keys()].map(e=>{typeof e.requestUpdate=="function"&&e.requestUpdate()})}class JZe{constructor(t){this.host=t,this.host.addController(this)}hostConnected(){eY.add(this.host)}hostDisconnected(){eY.delete(this.host)}dir(){return`${this.host.dir||ike}`.toLowerCase()}lang(){return`${this.host.lang||ske}`.toLowerCase()}getTranslationData(t){var n,r;const i=new Intl.Locale(t),s=i==null?void 0:i.language.toLowerCase(),a=(r=(n=i==null?void 0:i.region)===null||n===void 0?void 0:n.toLowerCase())!==null&&r!==void 0?r:"",o=E2.get(`${s}-${a}`),l=E2.get(s);return{locale:i,language:s,region:a,primary:o,secondary:l}}exists(t,n){var r;const{primary:i,secondary:s}=this.getTranslationData((r=n.lang)!==null&&r!==void 0?r:this.lang());return n=Object.assign({includeFallback:!1},n),!!(i&&i[t]||s&&s[t]||n.includeFallback&&n1&&n1[t])}term(t,...n){const{primary:r,secondary:i}=this.getTranslationData(this.lang());let s;if(r&&r[t])s=r[t];else if(i&&i[t])s=i[t];else if(n1&&n1[t])s=n1[t];else return console.error(`No translation found for: ${String(t)}`),String(t);return typeof s=="function"?s(...n):s}date(t,n){return t=new Date(t),new Intl.DateTimeFormat(this.lang(),n).format(t)}number(t,n){return t=Number(t),isNaN(t)?"":new Intl.NumberFormat(this.lang(),n).format(t)}relativeTime(t,n,r){return new Intl.RelativeTimeFormat(this.lang(),r).format(t,n)}}const eQe={$code:"en",$name:"English",$dir:"ltr",carousel:"Carousel",clearEntry:"Clear entry",close:"Close",copy:"Copy",currentValue:"Current value",goToSlide:(e,t)=>`Go to slide ${e} of ${t}`,hidePassword:"Hide password",loading:"Loading",nextSlide:"Next slide",numOptionsSelected:e=>e===0?"No options selected":e===1?"1 option selected":`${e} options selected`,previousSlide:"Previous slide",progress:"Progress",remove:"Remove",resize:"Resize",scrollToEnd:"Scroll to end",scrollToStart:"Scroll to start",selectAColorFromTheScreen:"Select a color from the screen",showPassword:"Show password",slideNum:e=>`Slide ${e}`,toggleColorFormat:"Toggle color format"};QZe(eQe);class Ra extends JZe{}function Mu(e,t){return new Promise(n=>{function r(i){i.target===e&&(e.removeEventListener(t,r),n())}e.addEventListener(t,r)})}var tQe=Xt`
  ${_r}

  :host {
    display: contents;

    /* For better DX, we'll reset the margin here so the base part can inherit it */
    margin: 0;
  }

  .alert {
    position: relative;
    display: flex;
    align-items: stretch;
    background-color: var(--sl-panel-background-color);
    border: solid var(--sl-panel-border-width) var(--sl-panel-border-color);
    border-top-width: calc(var(--sl-panel-border-width) * 3);
    border-radius: var(--sl-border-radius-medium);
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-small);
    font-weight: var(--sl-font-weight-normal);
    line-height: 1.6;
    color: var(--sl-color-neutral-700);
    margin: inherit;
  }

  .alert:not(.alert--has-icon) .alert__icon,
  .alert:not(.alert--closable) .alert__close-button {
    display: none;
  }

  .alert__icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-large);
    padding-inline-start: var(--sl-spacing-large);
  }

  .alert--primary {
    border-top-color: var(--sl-color-primary-600);
  }

  .alert--primary .alert__icon {
    color: var(--sl-color-primary-600);
  }

  .alert--success {
    border-top-color: var(--sl-color-success-600);
  }

  .alert--success .alert__icon {
    color: var(--sl-color-success-600);
  }

  .alert--neutral {
    border-top-color: var(--sl-color-neutral-600);
  }

  .alert--neutral .alert__icon {
    color: var(--sl-color-neutral-600);
  }

  .alert--warning {
    border-top-color: var(--sl-color-warning-600);
  }

  .alert--warning .alert__icon {
    color: var(--sl-color-warning-600);
  }

  .alert--danger {
    border-top-color: var(--sl-color-danger-600);
  }

  .alert--danger .alert__icon {
    color: var(--sl-color-danger-600);
  }

  .alert__message {
    flex: 1 1 auto;
    display: block;
    padding: var(--sl-spacing-large);
    overflow: hidden;
  }

  .alert__close-button {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-medium);
    padding-inline-end: var(--sl-spacing-medium);
  }
`;const Yx=Object.assign(document.createElement("div"),{className:"sl-toast-stack"});let Sh=class extends Xn{constructor(){super(...arguments),this.hasSlotController=new td(this,"icon","suffix"),this.localize=new Ra(this),this.open=!1,this.closable=!1,this.variant="primary",this.duration=1/0}firstUpdated(){this.base.hidden=!this.open}restartAutoHide(){clearTimeout(this.autoHideTimeout),this.open&&this.duration<1/0&&(this.autoHideTimeout=window.setTimeout(()=>this.hide(),this.duration))}handleCloseClick(){this.hide()}handleMouseMove(){this.restartAutoHide()}async handleOpenChange(){if(this.open){this.emit("sl-show"),this.duration<1/0&&this.restartAutoHide(),await ma(this.base),this.base.hidden=!1;const{keyframes:e,options:t}=Zi(this,"alert.show",{dir:this.localize.dir()});await Ki(this.base,e,t),this.emit("sl-after-show")}else{this.emit("sl-hide"),clearTimeout(this.autoHideTimeout),await ma(this.base);const{keyframes:e,options:t}=Zi(this,"alert.hide",{dir:this.localize.dir()});await Ki(this.base,e,t),this.base.hidden=!0,this.emit("sl-after-hide")}}handleDurationChange(){this.restartAutoHide()}async show(){if(!this.open)return this.open=!0,Mu(this,"sl-after-show")}async hide(){if(!!this.open)return this.open=!1,Mu(this,"sl-after-hide")}async toast(){return new Promise(e=>{Yx.parentElement===null&&document.body.append(Yx),Yx.appendChild(this),requestAnimationFrame(()=>{this.clientWidth,this.show()}),this.addEventListener("sl-after-hide",()=>{Yx.removeChild(this),e(),Yx.querySelector("sl-alert")===null&&Yx.remove()},{once:!0})})}render(){return he`
      <div
        part="base"
        class=${wr({alert:!0,"alert--open":this.open,"alert--closable":this.closable,"alert--has-icon":this.hasSlotController.test("icon"),"alert--primary":this.variant==="primary","alert--success":this.variant==="success","alert--neutral":this.variant==="neutral","alert--warning":this.variant==="warning","alert--danger":this.variant==="danger"})}
        role="alert"
        aria-hidden=${this.open?"false":"true"}
        @mousemove=${this.handleMouseMove}
      >
        <slot name="icon" part="icon" class="alert__icon"></slot>

        <slot part="message" class="alert__message" aria-live="polite"></slot>

        ${this.closable?he`
              <sl-icon-button
                part="close-button"
                exportparts="base:close-button__base"
                class="alert__close-button"
                name="x-lg"
                library="system"
                label=${this.localize.term("close")}
                @click=${this.handleCloseClick}
              ></sl-icon-button>
            `:""}
      </div>
    `}};Sh.styles=tQe;H([pt('[part~="base"]')],Sh.prototype,"base",2);H([Q({type:Boolean,reflect:!0})],Sh.prototype,"open",2);H([Q({type:Boolean,reflect:!0})],Sh.prototype,"closable",2);H([Q({reflect:!0})],Sh.prototype,"variant",2);H([Q({type:Number})],Sh.prototype,"duration",2);H([Jt("open",{waitUntilFirstUpdate:!0})],Sh.prototype,"handleOpenChange",1);H([Jt("duration")],Sh.prototype,"handleDurationChange",1);Sh=H([ze("sl-alert")],Sh);Mr("alert.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:250,easing:"ease"}});Mr("alert.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:250,easing:"ease"}});var nQe=Xt`
  ${_r}

  :host {
    display: inline-flex;
  }

  .badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: max(12px, 0.75em);
    font-weight: var(--sl-font-weight-semibold);
    letter-spacing: var(--sl-letter-spacing-normal);
    line-height: 1;
    border-radius: var(--sl-border-radius-small);
    border: solid 1px var(--sl-color-neutral-0);
    white-space: nowrap;
    padding: 0.35em 0.6em;
    user-select: none;
    cursor: inherit;
  }

  /* Variant modifiers */
  .badge--primary {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .badge--success {
    background-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  .badge--neutral {
    background-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  .badge--warning {
    background-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }

  .badge--danger {
    background-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  /* Pill modifier */
  .badge--pill {
    border-radius: var(--sl-border-radius-pill);
  }

  /* Pulse modifier */
  .badge--pulse {
    animation: pulse 1.5s infinite;
  }

  .badge--pulse.badge--primary {
    --pulse-color: var(--sl-color-primary-600);
  }

  .badge--pulse.badge--success {
    --pulse-color: var(--sl-color-success-600);
  }

  .badge--pulse.badge--neutral {
    --pulse-color: var(--sl-color-neutral-600);
  }

  .badge--pulse.badge--warning {
    --pulse-color: var(--sl-color-warning-600);
  }

  .badge--pulse.badge--danger {
    --pulse-color: var(--sl-color-danger-600);
  }

  @keyframes pulse {
    0% {
      box-shadow: 0 0 0 0 var(--pulse-color);
    }
    70% {
      box-shadow: 0 0 0 0.5rem transparent;
    }
    100% {
      box-shadow: 0 0 0 0 transparent;
    }
  }
`;let $w=class extends Xn{constructor(){super(...arguments),this.variant="primary",this.pill=!1,this.pulse=!1}render(){return he`
      <slot
        part="base"
        class=${wr({badge:!0,"badge--primary":this.variant==="primary","badge--success":this.variant==="success","badge--neutral":this.variant==="neutral","badge--warning":this.variant==="warning","badge--danger":this.variant==="danger","badge--pill":this.pill,"badge--pulse":this.pulse})}
        role="status"
      ></slot>
    `}};$w.styles=nQe;H([Q({reflect:!0})],$w.prototype,"variant",2);H([Q({type:Boolean,reflect:!0})],$w.prototype,"pill",2);H([Q({type:Boolean,reflect:!0})],$w.prototype,"pulse",2);$w=H([ze("sl-badge")],$w);var rQe=Xt`
  ${_r}

  :host {
    --track-width: 2px;
    --track-color: rgb(128 128 128 / 25%);
    --indicator-color: var(--sl-color-primary-600);
    --speed: 2s;

    display: inline-flex;
    width: 1em;
    height: 1em;
  }

  .spinner {
    flex: 1 1 auto;
    height: 100%;
    width: 100%;
  }

  .spinner__track,
  .spinner__indicator {
    fill: none;
    stroke-width: var(--track-width);
    r: calc(0.5em - var(--track-width) / 2);
    cx: 0.5em;
    cy: 0.5em;
    transform-origin: 50% 50%;
  }

  .spinner__track {
    stroke: var(--track-color);
    transform-origin: 0% 0%;
  }

  .spinner__indicator {
    stroke: var(--indicator-color);
    stroke-linecap: round;
    stroke-dasharray: 150% 75%;
    animation: spin var(--speed) linear infinite;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
      stroke-dasharray: 0.01em, 2.75em;
    }

    50% {
      transform: rotate(450deg);
      stroke-dasharray: 1.375em, 1.375em;
    }

    100% {
      transform: rotate(1080deg);
      stroke-dasharray: 0.01em, 2.75em;
    }
  }
`;let tY=class extends Xn{constructor(){super(...arguments),this.localize=new Ra(this)}render(){return he`
      <svg part="base" class="spinner" role="progressbar" aria-valuetext=${this.localize.term("loading")}>
        <circle class="spinner__track"></circle>
        <circle class="spinner__indicator"></circle>
      </svg>
    `}};tY.styles=rQe;tY=H([ze("sl-spinner")],tY);const WS=new WeakMap,VS=new WeakMap,GV=new WeakSet,VF=new WeakMap;class dC{constructor(t,n){(this.host=t).addController(this),this.options=Object.assign({form:r=>{if(r.hasAttribute("form")&&r.getAttribute("form")!==""){const i=r.getRootNode(),s=r.getAttribute("form");if(s)return i.getElementById(s)}return r.closest("form")},name:r=>r.name,value:r=>r.value,defaultValue:r=>r.defaultValue,disabled:r=>{var i;return(i=r.disabled)!==null&&i!==void 0?i:!1},reportValidity:r=>typeof r.reportValidity=="function"?r.reportValidity():!0,setValue:(r,i)=>r.value=i,assumeInteractionOn:["sl-input"]},n),this.handleFormData=this.handleFormData.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleFormReset=this.handleFormReset.bind(this),this.reportFormValidity=this.reportFormValidity.bind(this),this.handleInteraction=this.handleInteraction.bind(this)}hostConnected(){const t=this.options.form(this.host);t&&this.attachForm(t),VF.set(this.host,[]),this.options.assumeInteractionOn.forEach(n=>{this.host.addEventListener(n,this.handleInteraction)})}hostDisconnected(){this.detachForm(),VF.delete(this.host),this.options.assumeInteractionOn.forEach(t=>{this.host.removeEventListener(t,this.handleInteraction)})}hostUpdated(){const t=this.options.form(this.host);t||this.detachForm(),t&&this.form!==t&&(this.detachForm(),this.attachForm(t)),this.host.hasUpdated&&this.setValidity(this.host.validity.valid)}attachForm(t){t?(this.form=t,WS.has(this.form)?WS.get(this.form).add(this.host):WS.set(this.form,new Set([this.host])),this.form.addEventListener("formdata",this.handleFormData),this.form.addEventListener("submit",this.handleFormSubmit),this.form.addEventListener("reset",this.handleFormReset),VS.has(this.form)||(VS.set(this.form,this.form.reportValidity),this.form.reportValidity=()=>this.reportFormValidity())):this.form=void 0}detachForm(){var t;this.form&&((t=WS.get(this.form))===null||t===void 0||t.delete(this.host),this.form.removeEventListener("formdata",this.handleFormData),this.form.removeEventListener("submit",this.handleFormSubmit),this.form.removeEventListener("reset",this.handleFormReset),VS.has(this.form)&&(this.form.reportValidity=VS.get(this.form),VS.delete(this.form))),this.form=void 0}handleFormData(t){const n=this.options.disabled(this.host),r=this.options.name(this.host),i=this.options.value(this.host),s=this.host.tagName.toLowerCase()==="sl-button";!n&&!s&&typeof r=="string"&&r.length>0&&typeof i<"u"&&(Array.isArray(i)?i.forEach(a=>{t.formData.append(r,a.toString())}):t.formData.append(r,i.toString()))}handleFormSubmit(t){var n;const r=this.options.disabled(this.host),i=this.options.reportValidity;this.form&&!this.form.noValidate&&((n=WS.get(this.form))===null||n===void 0||n.forEach(s=>{this.setUserInteracted(s,!0)})),this.form&&!this.form.noValidate&&!r&&!i(this.host)&&(t.preventDefault(),t.stopImmediatePropagation())}handleFormReset(){this.options.setValue(this.host,this.options.defaultValue(this.host)),this.setUserInteracted(this.host,!1),VF.set(this.host,[])}handleInteraction(t){const n=VF.get(this.host);n.includes(t.type)||n.push(t.type),n.length===this.options.assumeInteractionOn.length&&this.setUserInteracted(this.host,!0)}reportFormValidity(){if(this.form&&!this.form.noValidate){const t=this.form.querySelectorAll("*");for(const n of t)if(typeof n.reportValidity=="function"&&!n.reportValidity())return!1}return!0}setUserInteracted(t,n){n?GV.add(t):GV.delete(t),t.requestUpdate()}doAction(t,n){if(this.form){const r=document.createElement("button");r.type=t,r.style.position="absolute",r.style.width="0",r.style.height="0",r.style.clipPath="inset(50%)",r.style.overflow="hidden",r.style.whiteSpace="nowrap",n&&(r.name=n.name,r.value=n.value,["formaction","formenctype","formmethod","formnovalidate","formtarget"].forEach(i=>{n.hasAttribute(i)&&r.setAttribute(i,n.getAttribute(i))})),this.form.append(r),r.click(),r.remove()}}getForm(){var t;return(t=this.form)!==null&&t!==void 0?t:null}reset(t){this.doAction("reset",t)}submit(t){this.doAction("submit",t)}setValidity(t){const n=this.host,r=Boolean(GV.has(n)),i=Boolean(n.required);n.toggleAttribute("data-required",i),n.toggleAttribute("data-optional",!i),n.toggleAttribute("data-invalid",!t),n.toggleAttribute("data-valid",t),n.toggleAttribute("data-user-invalid",!t&&r),n.toggleAttribute("data-user-valid",t&&r)}updateValidity(){const t=this.host;this.setValidity(t.validity.valid)}emitInvalidEvent(t){const n=new CustomEvent("sl-invalid",{bubbles:!1,composed:!1,cancelable:!0,detail:{}});t||n.preventDefault(),this.host.dispatchEvent(n)||t==null||t.preventDefault()}}const sB=Object.freeze({badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:!0,valueMissing:!1}),iQe=Object.freeze(Object.assign(Object.assign({},sB),{valid:!1,valueMissing:!0})),sQe=Object.freeze(Object.assign(Object.assign({},sB),{valid:!1,customError:!0}));var oke=Xt`
  ${_r}

  :host {
    display: inline-block;
    position: relative;
    width: auto;
    cursor: pointer;
  }

  .button {
    display: inline-flex;
    align-items: stretch;
    justify-content: center;
    width: 100%;
    border-style: solid;
    border-width: var(--sl-input-border-width);
    font-family: var(--sl-input-font-family);
    font-weight: var(--sl-font-weight-semibold);
    text-decoration: none;
    user-select: none;
    white-space: nowrap;
    vertical-align: middle;
    padding: 0;
    transition: var(--sl-transition-x-fast) background-color, var(--sl-transition-x-fast) color,
      var(--sl-transition-x-fast) border, var(--sl-transition-x-fast) box-shadow;
    cursor: inherit;
  }

  .button::-moz-focus-inner {
    border: 0;
  }

  .button:focus {
    outline: none;
  }

  .button:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .button--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  /* When disabled, prevent mouse events from bubbling up from children */
  .button--disabled * {
    pointer-events: none;
  }

  .button__prefix,
  .button__suffix {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    pointer-events: none;
  }

  .button__label {
    display: inline-block;
  }

  .button__label::slotted(sl-icon) {
    vertical-align: -2px;
  }

  /*
   * Standard buttons
   */

  /* Default */
  .button--standard.button--default {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-neutral-300);
    color: var(--sl-color-neutral-700);
  }

  .button--standard.button--default:hover:not(.button--disabled) {
    background-color: var(--sl-color-primary-50);
    border-color: var(--sl-color-primary-300);
    color: var(--sl-color-primary-700);
  }

  .button--standard.button--default:active:not(.button--disabled) {
    background-color: var(--sl-color-primary-100);
    border-color: var(--sl-color-primary-400);
    color: var(--sl-color-primary-700);
  }

  /* Primary */
  .button--standard.button--primary {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--primary:hover:not(.button--disabled) {
    background-color: var(--sl-color-primary-500);
    border-color: var(--sl-color-primary-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--primary:active:not(.button--disabled) {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  /* Success */
  .button--standard.button--success {
    background-color: var(--sl-color-success-600);
    border-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--success:hover:not(.button--disabled) {
    background-color: var(--sl-color-success-500);
    border-color: var(--sl-color-success-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--success:active:not(.button--disabled) {
    background-color: var(--sl-color-success-600);
    border-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  /* Neutral */
  .button--standard.button--neutral {
    background-color: var(--sl-color-neutral-600);
    border-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--neutral:hover:not(.button--disabled) {
    background-color: var(--sl-color-neutral-500);
    border-color: var(--sl-color-neutral-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--neutral:active:not(.button--disabled) {
    background-color: var(--sl-color-neutral-600);
    border-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  /* Warning */
  .button--standard.button--warning {
    background-color: var(--sl-color-warning-600);
    border-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }
  .button--standard.button--warning:hover:not(.button--disabled) {
    background-color: var(--sl-color-warning-500);
    border-color: var(--sl-color-warning-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--warning:active:not(.button--disabled) {
    background-color: var(--sl-color-warning-600);
    border-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }

  /* Danger */
  .button--standard.button--danger {
    background-color: var(--sl-color-danger-600);
    border-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--danger:hover:not(.button--disabled) {
    background-color: var(--sl-color-danger-500);
    border-color: var(--sl-color-danger-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--danger:active:not(.button--disabled) {
    background-color: var(--sl-color-danger-600);
    border-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  /*
   * Outline buttons
   */

  .button--outline {
    background: none;
    border: solid 1px;
  }

  /* Default */
  .button--outline.button--default {
    border-color: var(--sl-color-neutral-300);
    color: var(--sl-color-neutral-700);
  }

  .button--outline.button--default:hover:not(.button--disabled),
  .button--outline.button--default.button--checked:not(.button--disabled) {
    border-color: var(--sl-color-primary-600);
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--default:active:not(.button--disabled) {
    border-color: var(--sl-color-primary-700);
    background-color: var(--sl-color-primary-700);
    color: var(--sl-color-neutral-0);
  }

  /* Primary */
  .button--outline.button--primary {
    border-color: var(--sl-color-primary-600);
    color: var(--sl-color-primary-600);
  }

  .button--outline.button--primary:hover:not(.button--disabled),
  .button--outline.button--primary.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--primary:active:not(.button--disabled) {
    border-color: var(--sl-color-primary-700);
    background-color: var(--sl-color-primary-700);
    color: var(--sl-color-neutral-0);
  }

  /* Success */
  .button--outline.button--success {
    border-color: var(--sl-color-success-600);
    color: var(--sl-color-success-600);
  }

  .button--outline.button--success:hover:not(.button--disabled),
  .button--outline.button--success.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--success:active:not(.button--disabled) {
    border-color: var(--sl-color-success-700);
    background-color: var(--sl-color-success-700);
    color: var(--sl-color-neutral-0);
  }

  /* Neutral */
  .button--outline.button--neutral {
    border-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-600);
  }

  .button--outline.button--neutral:hover:not(.button--disabled),
  .button--outline.button--neutral.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--neutral:active:not(.button--disabled) {
    border-color: var(--sl-color-neutral-700);
    background-color: var(--sl-color-neutral-700);
    color: var(--sl-color-neutral-0);
  }

  /* Warning */
  .button--outline.button--warning {
    border-color: var(--sl-color-warning-600);
    color: var(--sl-color-warning-600);
  }

  .button--outline.button--warning:hover:not(.button--disabled),
  .button--outline.button--warning.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--warning:active:not(.button--disabled) {
    border-color: var(--sl-color-warning-700);
    background-color: var(--sl-color-warning-700);
    color: var(--sl-color-neutral-0);
  }

  /* Danger */
  .button--outline.button--danger {
    border-color: var(--sl-color-danger-600);
    color: var(--sl-color-danger-600);
  }

  .button--outline.button--danger:hover:not(.button--disabled),
  .button--outline.button--danger.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--danger:active:not(.button--disabled) {
    border-color: var(--sl-color-danger-700);
    background-color: var(--sl-color-danger-700);
    color: var(--sl-color-neutral-0);
  }

  @media (forced-colors: active) {
    .button.button--outline.button--checked:not(.button--disabled) {
      outline: solid 2px transparent;
    }
  }

  /*
   * Text buttons
   */

  .button--text {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-600);
  }

  .button--text:hover:not(.button--disabled) {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-500);
  }

  .button--text:focus-visible:not(.button--disabled) {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-500);
  }

  .button--text:active:not(.button--disabled) {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-700);
  }

  /*
   * Size modifiers
   */

  .button--small {
    height: auto;
    min-height: var(--sl-input-height-small);
    font-size: var(--sl-button-font-size-small);
    line-height: calc(var(--sl-input-height-small) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-small);
  }

  .button--medium {
    height: auto;
    min-height: var(--sl-input-height-medium);
    font-size: var(--sl-button-font-size-medium);
    line-height: calc(var(--sl-input-height-medium) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-medium);
  }

  .button--large {
    height: auto;
    min-height: var(--sl-input-height-large);
    font-size: var(--sl-button-font-size-large);
    line-height: calc(var(--sl-input-height-large) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-large);
  }

  /*
   * Pill modifier
   */

  .button--pill.button--small {
    border-radius: var(--sl-input-height-small);
  }

  .button--pill.button--medium {
    border-radius: var(--sl-input-height-medium);
  }

  .button--pill.button--large {
    border-radius: var(--sl-input-height-large);
  }

  /*
   * Circle modifier
   */

  .button--circle {
    padding-left: 0;
    padding-right: 0;
  }

  .button--circle.button--small {
    width: var(--sl-input-height-small);
    border-radius: 50%;
  }

  .button--circle.button--medium {
    width: var(--sl-input-height-medium);
    border-radius: 50%;
  }

  .button--circle.button--large {
    width: var(--sl-input-height-large);
    border-radius: 50%;
  }

  .button--circle .button__prefix,
  .button--circle .button__suffix,
  .button--circle .button__caret {
    display: none;
  }

  /*
   * Caret modifier
   */

  .button--caret .button__suffix {
    display: none;
  }

  .button--caret .button__caret {
    height: auto;
  }

  /*
   * Loading modifier
   */

  .button--loading {
    position: relative;
    cursor: wait;
  }

  .button--loading .button__prefix,
  .button--loading .button__label,
  .button--loading .button__suffix,
  .button--loading .button__caret {
    visibility: hidden;
  }

  .button--loading sl-spinner {
    --indicator-color: currentColor;
    position: absolute;
    font-size: 1em;
    height: 1em;
    width: 1em;
    top: calc(50% - 0.5em);
    left: calc(50% - 0.5em);
  }

  /*
   * Badges
   */

  .button ::slotted(sl-badge) {
    position: absolute;
    top: 0;
    right: 0;
    translate: 50% -50%;
    pointer-events: none;
  }

  .button--rtl ::slotted(sl-badge) {
    right: auto;
    left: 0;
    translate: -50% -50%;
  }

  /*
   * Button spacing
   */

  .button--has-label.button--small .button__label {
    padding: 0 var(--sl-spacing-small);
  }

  .button--has-label.button--medium .button__label {
    padding: 0 var(--sl-spacing-medium);
  }

  .button--has-label.button--large .button__label {
    padding: 0 var(--sl-spacing-large);
  }

  .button--has-prefix.button--small {
    padding-inline-start: var(--sl-spacing-x-small);
  }

  .button--has-prefix.button--small .button__label {
    padding-inline-start: var(--sl-spacing-x-small);
  }

  .button--has-prefix.button--medium {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-prefix.button--medium .button__label {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-prefix.button--large {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-prefix.button--large .button__label {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-suffix.button--small,
  .button--caret.button--small {
    padding-inline-end: var(--sl-spacing-x-small);
  }

  .button--has-suffix.button--small .button__label,
  .button--caret.button--small .button__label {
    padding-inline-end: var(--sl-spacing-x-small);
  }

  .button--has-suffix.button--medium,
  .button--caret.button--medium {
    padding-inline-end: var(--sl-spacing-small);
  }

  .button--has-suffix.button--medium .button__label,
  .button--caret.button--medium .button__label {
    padding-inline-end: var(--sl-spacing-small);
  }

  .button--has-suffix.button--large,
  .button--caret.button--large {
    padding-inline-end: var(--sl-spacing-small);
  }

  .button--has-suffix.button--large .button__label,
  .button--caret.button--large .button__label {
    padding-inline-end: var(--sl-spacing-small);
  }

  /*
   * Button groups support a variety of button types (e.g. buttons with tooltips, buttons as dropdown triggers, etc.).
   * This means buttons aren't always direct descendants of the button group, thus we can't target them with the
   * ::slotted selector. To work around this, the button group component does some magic to add these special classes to
   * buttons and we style them here instead.
   */

  :host(.sl-button-group__button--first:not(.sl-button-group__button--last)) .button {
    border-start-end-radius: 0;
    border-end-end-radius: 0;
  }

  :host(.sl-button-group__button--inner) .button {
    border-radius: 0;
  }

  :host(.sl-button-group__button--last:not(.sl-button-group__button--first)) .button {
    border-start-start-radius: 0;
    border-end-start-radius: 0;
  }

  /* All except the first */
  :host(.sl-button-group__button:not(.sl-button-group__button--first)) {
    margin-inline-start: calc(-1 * var(--sl-input-border-width));
  }

  /* Add a visual separator between solid buttons */
  :host(
      .sl-button-group__button:not(
          .sl-button-group__button--first,
          .sl-button-group__button--radio,
          [variant='default']
        ):not(:hover)
    )
    .button:after {
    content: '';
    position: absolute;
    top: 0;
    inset-inline-start: 0;
    bottom: 0;
    border-left: solid 1px rgb(128 128 128 / 33%);
    mix-blend-mode: multiply;
  }

  /* Bump hovered, focused, and checked buttons up so their focus ring isn't clipped */
  :host(.sl-button-group__button--hover) {
    z-index: 1;
  }

  /* Focus and checked are always on top */
  :host(.sl-button-group__button--focus),
  :host(.sl-button-group__button[checked]) {
    z-index: 2;
  }
`;let Vn=class extends Xn{constructor(){super(),this.formControlController=new dC(this,{form:e=>{if(e.hasAttribute("form")){const t=e.getRootNode(),n=e.getAttribute("form");return t.getElementById(n)}return e.closest("form")},assumeInteractionOn:["click"]}),this.hasSlotController=new td(this,"[default]","prefix","suffix"),this.localize=new Ra(this),this.hasFocus=!1,this.invalid=!1,this.title="",this.variant="default",this.size="medium",this.caret=!1,this.disabled=!1,this.loading=!1,this.outline=!1,this.pill=!1,this.circle=!1,this.type="button",this.name="",this.value="",this.href="",this.rel="noreferrer noopener",this.handleHostClick=e=>{(this.disabled||this.loading)&&(e.preventDefault(),e.stopImmediatePropagation())},this.addEventListener("click",this.handleHostClick)}get validity(){return this.isButton()?this.button.validity:sB}get validationMessage(){return this.isButton()?this.button.validationMessage:""}firstUpdated(){this.isButton()&&this.formControlController.updateValidity()}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleClick(){this.type==="submit"&&this.formControlController.submit(this),this.type==="reset"&&this.formControlController.reset(this)}handleInvalid(e){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(e)}isButton(){return!this.href}isLink(){return!!this.href}handleDisabledChange(){this.isButton()&&this.formControlController.setValidity(this.disabled)}click(){this.button.click()}focus(e){this.button.focus(e)}blur(){this.button.blur()}checkValidity(){return this.isButton()?this.button.checkValidity():!0}getForm(){return this.formControlController.getForm()}reportValidity(){return this.isButton()?this.button.reportValidity():!0}setCustomValidity(e){this.isButton()&&(this.button.setCustomValidity(e),this.formControlController.updateValidity())}render(){const e=this.isLink(),t=e?s5`a`:s5`button`;return nA`
      <${t}
        part="base"
        class=${wr({button:!0,"button--default":this.variant==="default","button--primary":this.variant==="primary","button--success":this.variant==="success","button--neutral":this.variant==="neutral","button--warning":this.variant==="warning","button--danger":this.variant==="danger","button--text":this.variant==="text","button--small":this.size==="small","button--medium":this.size==="medium","button--large":this.size==="large","button--caret":this.caret,"button--circle":this.circle,"button--disabled":this.disabled,"button--focused":this.hasFocus,"button--loading":this.loading,"button--standard":!this.outline,"button--outline":this.outline,"button--pill":this.pill,"button--rtl":this.localize.dir()==="rtl","button--has-label":this.hasSlotController.test("[default]"),"button--has-prefix":this.hasSlotController.test("prefix"),"button--has-suffix":this.hasSlotController.test("suffix")})}
        ?disabled=${Et(e?void 0:this.disabled)}
        type=${Et(e?void 0:this.type)}
        title=${this.title}
        name=${Et(e?void 0:this.name)}
        value=${Et(e?void 0:this.value)}
        href=${Et(e?this.href:void 0)}
        target=${Et(e?this.target:void 0)}
        download=${Et(e?this.download:void 0)}
        rel=${Et(e?this.rel:void 0)}
        role=${Et(e?void 0:"button")}
        aria-disabled=${this.disabled?"true":"false"}
        tabindex=${this.disabled?"-1":"0"}
        @blur=${this.handleBlur}
        @focus=${this.handleFocus}
        @invalid=${this.isButton()?this.handleInvalid:null}
        @click=${this.handleClick}
      >
        <slot name="prefix" part="prefix" class="button__prefix"></slot>
        <slot part="label" class="button__label"></slot>
        <slot name="suffix" part="suffix" class="button__suffix"></slot>
        ${this.caret?nA` <sl-icon part="caret" class="button__caret" library="system" name="caret"></sl-icon> `:""}
        ${this.loading?nA`<sl-spinner></sl-spinner>`:""}
      </${t}>
    `}};Vn.styles=oke;H([pt(".button")],Vn.prototype,"button",2);H([Cr()],Vn.prototype,"hasFocus",2);H([Cr()],Vn.prototype,"invalid",2);H([Q()],Vn.prototype,"title",2);H([Q({reflect:!0})],Vn.prototype,"variant",2);H([Q({reflect:!0})],Vn.prototype,"size",2);H([Q({type:Boolean,reflect:!0})],Vn.prototype,"caret",2);H([Q({type:Boolean,reflect:!0})],Vn.prototype,"disabled",2);H([Q({type:Boolean,reflect:!0})],Vn.prototype,"loading",2);H([Q({type:Boolean,reflect:!0})],Vn.prototype,"outline",2);H([Q({type:Boolean,reflect:!0})],Vn.prototype,"pill",2);H([Q({type:Boolean,reflect:!0})],Vn.prototype,"circle",2);H([Q()],Vn.prototype,"type",2);H([Q()],Vn.prototype,"name",2);H([Q()],Vn.prototype,"value",2);H([Q()],Vn.prototype,"href",2);H([Q()],Vn.prototype,"target",2);H([Q()],Vn.prototype,"rel",2);H([Q()],Vn.prototype,"download",2);H([Q()],Vn.prototype,"form",2);H([Q({attribute:"formaction"})],Vn.prototype,"formAction",2);H([Q({attribute:"formenctype"})],Vn.prototype,"formEnctype",2);H([Q({attribute:"formmethod"})],Vn.prototype,"formMethod",2);H([Q({attribute:"formnovalidate",type:Boolean})],Vn.prototype,"formNoValidate",2);H([Q({attribute:"formtarget"})],Vn.prototype,"formTarget",2);H([Jt("disabled",{waitUntilFirstUpdate:!0})],Vn.prototype,"handleDisabledChange",1);Vn=H([ze("sl-button")],Vn);var aQe=Xt`
  ${_r}

  :host {
    --border-color: var(--sl-color-neutral-200);
    --border-radius: var(--sl-border-radius-medium);
    --border-width: 1px;
    --padding: var(--sl-spacing-large);

    display: inline-block;
  }

  .card {
    display: flex;
    flex-direction: column;
    background-color: var(--sl-panel-background-color);
    box-shadow: var(--sl-shadow-x-small);
    border: solid var(--border-width) var(--border-color);
    border-radius: var(--border-radius);
  }

  .card__image {
    display: flex;
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
    margin: calc(-1 * var(--border-width));
    overflow: hidden;
  }

  .card__image::slotted(img) {
    display: block;
    width: 100%;
  }

  .card:not(.card--has-image) .card__image {
    display: none;
  }

  .card__header {
    display: block;
    border-bottom: solid var(--border-width) var(--border-color);
    padding: calc(var(--padding) / 2) var(--padding);
  }

  .card:not(.card--has-header) .card__header {
    display: none;
  }

  .card:not(.card--has-image) .card__header {
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
  }

  .card__body {
    display: block;
    padding: var(--padding);
  }

  .card--has-footer .card__footer {
    display: block;
    border-top: solid var(--border-width) var(--border-color);
    padding: var(--padding);
  }

  .card:not(.card--has-footer) .card__footer {
    display: none;
  }
`;let nY=class extends Xn{constructor(){super(...arguments),this.hasSlotController=new td(this,"footer","header","image")}render(){return he`
      <div
        part="base"
        class=${wr({card:!0,"card--has-footer":this.hasSlotController.test("footer"),"card--has-image":this.hasSlotController.test("image"),"card--has-header":this.hasSlotController.test("header")})}
      >
        <slot name="image" part="image" class="card__image"></slot>
        <slot name="header" part="header" class="card__header"></slot>
        <slot part="body" class="card__body"></slot>
        <slot name="footer" part="footer" class="card__footer"></slot>
      </div>
    `}};nY.styles=aQe;nY=H([ze("sl-card")],nY);var oQe=Xt`
  ${_r}

  :host {
    display: block;
  }

  .details {
    border: solid 1px var(--sl-color-neutral-200);
    border-radius: var(--sl-border-radius-medium);
    background-color: var(--sl-color-neutral-0);
    overflow-anchor: none;
  }

  .details--disabled {
    opacity: 0.5;
  }

  .details__header {
    display: flex;
    align-items: center;
    border-radius: inherit;
    padding: var(--sl-spacing-medium);
    user-select: none;
    cursor: pointer;
  }

  .details__header:focus {
    outline: none;
  }

  .details__header:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: calc(1px + var(--sl-focus-ring-offset));
  }

  .details--disabled .details__header {
    cursor: not-allowed;
  }

  .details--disabled .details__header:focus-visible {
    outline: none;
    box-shadow: none;
  }

  .details__summary {
    flex: 1 1 auto;
    display: flex;
    align-items: center;
  }

  .details__summary-icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    transition: var(--sl-transition-medium) rotate ease;
  }

  .details--open .details__summary-icon {
    rotate: 90deg;
  }

  .details--open.details--rtl .details__summary-icon {
    rotate: -90deg;
  }

  .details--open slot[name='expand-icon'],
  .details:not(.details--open) slot[name='collapse-icon'] {
    display: none;
  }

  .details__body {
    overflow: hidden;
  }

  .details__content {
    display: block;
    padding: var(--sl-spacing-medium);
  }
`;let Yc=class extends Xn{constructor(){super(...arguments),this.localize=new Ra(this),this.open=!1,this.disabled=!1}firstUpdated(){this.body.hidden=!this.open,this.body.style.height=this.open?"auto":"0"}handleSummaryClick(){this.disabled||(this.open?this.hide():this.show(),this.header.focus())}handleSummaryKeyDown(e){(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),this.open?this.hide():this.show()),(e.key==="ArrowUp"||e.key==="ArrowLeft")&&(e.preventDefault(),this.hide()),(e.key==="ArrowDown"||e.key==="ArrowRight")&&(e.preventDefault(),this.show())}async handleOpenChange(){if(this.open){if(this.emit("sl-show",{cancelable:!0}).defaultPrevented){this.open=!1;return}await ma(this.body),this.body.hidden=!1;const{keyframes:t,options:n}=Zi(this,"details.show",{dir:this.localize.dir()});await Ki(this.body,Fde(t,this.body.scrollHeight),n),this.body.style.height="auto",this.emit("sl-after-show")}else{if(this.emit("sl-hide",{cancelable:!0}).defaultPrevented){this.open=!0;return}await ma(this.body);const{keyframes:t,options:n}=Zi(this,"details.hide",{dir:this.localize.dir()});await Ki(this.body,Fde(t,this.body.scrollHeight),n),this.body.hidden=!0,this.body.style.height="auto",this.emit("sl-after-hide")}}async show(){if(!(this.open||this.disabled))return this.open=!0,Mu(this,"sl-after-show")}async hide(){if(!(!this.open||this.disabled))return this.open=!1,Mu(this,"sl-after-hide")}render(){const e=this.localize.dir()==="rtl";return he`
      <div
        part="base"
        class=${wr({details:!0,"details--open":this.open,"details--disabled":this.disabled,"details--rtl":e})}
      >
        <div
          part="header"
          id="header"
          class="details__header"
          role="button"
          aria-expanded=${this.open?"true":"false"}
          aria-controls="content"
          aria-disabled=${this.disabled?"true":"false"}
          tabindex=${this.disabled?"-1":"0"}
          @click=${this.handleSummaryClick}
          @keydown=${this.handleSummaryKeyDown}
        >
          <slot name="summary" part="summary" class="details__summary">${this.summary}</slot>

          <span part="summary-icon" class="details__summary-icon">
            <slot name="expand-icon">
              <sl-icon library="system" name=${e?"chevron-left":"chevron-right"}></sl-icon>
            </slot>
            <slot name="collapse-icon">
              <sl-icon library="system" name=${e?"chevron-left":"chevron-right"}></sl-icon>
            </slot>
          </span>
        </div>

        <div class="details__body" role="region" aria-labelledby="header">
          <slot part="content" id="content" class="details__content"></slot>
        </div>
      </div>
    `}};Yc.styles=oQe;H([pt(".details")],Yc.prototype,"details",2);H([pt(".details__header")],Yc.prototype,"header",2);H([pt(".details__body")],Yc.prototype,"body",2);H([pt(".details__expand-icon-slot")],Yc.prototype,"expandIconSlot",2);H([Q({type:Boolean,reflect:!0})],Yc.prototype,"open",2);H([Q()],Yc.prototype,"summary",2);H([Q({type:Boolean,reflect:!0})],Yc.prototype,"disabled",2);H([Jt("open",{waitUntilFirstUpdate:!0})],Yc.prototype,"handleOpenChange",1);Yc=H([ze("sl-details")],Yc);Mr("details.show",{keyframes:[{height:"0",opacity:"0"},{height:"auto",opacity:"1"}],options:{duration:250,easing:"linear"}});Mr("details.hide",{keyframes:[{height:"auto",opacity:"1"},{height:"0",opacity:"0"}],options:{duration:250,easing:"linear"}});function lQe(e,t){return{top:Math.round(e.getBoundingClientRect().top-t.getBoundingClientRect().top),left:Math.round(e.getBoundingClientRect().left-t.getBoundingClientRect().left)}}const rY=new Set;function uQe(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}function rA(e){if(rY.add(e),!document.body.classList.contains("sl-scroll-lock")){const t=uQe();document.body.classList.add("sl-scroll-lock"),document.body.style.setProperty("--sl-scroll-lock-size",`${t}px`)}}function iA(e){rY.delete(e),rY.size===0&&(document.body.classList.remove("sl-scroll-lock"),document.body.style.removeProperty("--sl-scroll-lock-size"))}function iY(e,t,n="vertical",r="smooth"){const i=lQe(e,t),s=i.top+t.scrollTop,a=i.left+t.scrollLeft,o=t.scrollLeft,l=t.scrollLeft+t.offsetWidth,u=t.scrollTop,c=t.scrollTop+t.offsetHeight;(n==="horizontal"||n==="both")&&(a<o?t.scrollTo({left:a,behavior:r}):a+e.clientWidth>l&&t.scrollTo({left:a-t.offsetWidth+e.clientWidth,behavior:r})),(n==="vertical"||n==="both")&&(s<u?t.scrollTo({top:s,behavior:r}):s+e.clientHeight>c&&t.scrollTo({top:s-t.offsetHeight+e.clientHeight,behavior:r}))}function Rde(e){const t=e.tagName.toLowerCase();return e.getAttribute("tabindex")==="-1"||e.hasAttribute("disabled")||e.hasAttribute("aria-disabled")&&e.getAttribute("aria-disabled")!=="false"||t==="input"&&e.getAttribute("type")==="radio"&&!e.hasAttribute("checked")||e.offsetParent===null||window.getComputedStyle(e).visibility==="hidden"?!1:(t==="audio"||t==="video")&&e.hasAttribute("controls")||e.hasAttribute("tabindex")||e.hasAttribute("contenteditable")&&e.getAttribute("contenteditable")!=="false"?!0:["button","input","select","textarea","a","audio","video","summary"].includes(t)}function cQe(e){var t,n;const r=[];function i(o){o instanceof HTMLElement&&(r.push(o),o.shadowRoot!==null&&o.shadowRoot.mode==="open"&&i(o.shadowRoot)),[...o.children].forEach(l=>i(l))}i(e);const s=(t=r.find(o=>Rde(o)))!==null&&t!==void 0?t:null,a=(n=r.reverse().find(o=>Rde(o)))!==null&&n!==void 0?n:null;return{start:s,end:a}}let jS=[];class lke{constructor(t){this.tabDirection="forward",this.element=t,this.handleFocusIn=this.handleFocusIn.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this)}activate(){jS.push(this.element),document.addEventListener("focusin",this.handleFocusIn),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}deactivate(){jS=jS.filter(t=>t!==this.element),document.removeEventListener("focusin",this.handleFocusIn),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)}isActive(){return jS[jS.length-1]===this.element}checkFocus(){if(this.isActive()&&!this.element.matches(":focus-within")){const{start:t,end:n}=cQe(this.element),r=this.tabDirection==="forward"?t:n;typeof(r==null?void 0:r.focus)=="function"&&r.focus({preventScroll:!0})}}handleFocusIn(){this.checkFocus()}handleKeyDown(t){t.key==="Tab"&&t.shiftKey&&(this.tabDirection="backward",requestAnimationFrame(()=>this.checkFocus()))}handleKeyUp(){this.tabDirection="forward"}}var fQe=Xt`
  ${_r}

  :host {
    --width: 31rem;
    --header-spacing: var(--sl-spacing-large);
    --body-spacing: var(--sl-spacing-large);
    --footer-spacing: var(--sl-spacing-large);

    display: contents;
  }

  .dialog {
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    z-index: var(--sl-z-index-dialog);
  }

  .dialog__panel {
    display: flex;
    flex-direction: column;
    z-index: 2;
    width: var(--width);
    max-width: calc(100% - var(--sl-spacing-2x-large));
    max-height: calc(100% - var(--sl-spacing-2x-large));
    background-color: var(--sl-panel-background-color);
    border-radius: var(--sl-border-radius-medium);
    box-shadow: var(--sl-shadow-x-large);
  }

  .dialog__panel:focus {
    outline: none;
  }

  /* Ensure there's enough vertical padding for phones that don't update vh when chrome appears (e.g. iPhone) */
  @media screen and (max-width: 420px) {
    .dialog__panel {
      max-height: 80vh;
    }
  }

  .dialog--open .dialog__panel {
    display: flex;
    opacity: 1;
  }

  .dialog__header {
    flex: 0 0 auto;
    display: flex;
  }

  .dialog__title {
    flex: 1 1 auto;
    font: inherit;
    font-size: var(--sl-font-size-large);
    line-height: var(--sl-line-height-dense);
    padding: var(--header-spacing);
    margin: 0;
  }

  .dialog__header-actions {
    flex-shrink: 0;
    display: flex;
    flex-wrap: wrap;
    justify-content: end;
    gap: var(--sl-spacing-2x-small);
    padding: 0 var(--header-spacing);
  }

  .dialog__header-actions sl-icon-button,
  .dialog__header-actions ::slotted(sl-icon-button) {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-medium);
  }

  .dialog__body {
    flex: 1 1 auto;
    display: block;
    padding: var(--body-spacing);
    overflow: auto;
    -webkit-overflow-scrolling: touch;
  }

  .dialog__footer {
    flex: 0 0 auto;
    text-align: right;
    padding: var(--footer-spacing);
  }

  .dialog__footer ::slotted(sl-button:not(:first-of-type)) {
    margin-inline-start: var(--sl-spacing-x-small);
  }

  .dialog:not(.dialog--has-footer) .dialog__footer {
    display: none;
  }

  .dialog__overlay {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background-color: var(--sl-overlay-background-color);
  }

  @media (forced-colors: active) {
    .dialog__panel {
      border: solid 1px var(--sl-color-neutral-0);
    }
  }
`;let kh=class extends Xn{constructor(){super(...arguments),this.hasSlotController=new td(this,"footer"),this.localize=new Ra(this),this.modal=new lke(this),this.open=!1,this.label="",this.noHeader=!1,this.handleDocumentKeyDown=e=>{this.open&&e.key==="Escape"&&(e.stopPropagation(),this.requestClose("keyboard"))}}firstUpdated(){this.dialog.hidden=!this.open,this.open&&(this.addOpenListeners(),this.modal.activate(),rA(this))}disconnectedCallback(){super.disconnectedCallback(),iA(this)}requestClose(e){if(this.emit("sl-request-close",{cancelable:!0,detail:{source:e}}).defaultPrevented){const n=Zi(this,"dialog.denyClose",{dir:this.localize.dir()});Ki(this.panel,n.keyframes,n.options);return}this.hide()}addOpenListeners(){document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){document.removeEventListener("keydown",this.handleDocumentKeyDown)}async handleOpenChange(){if(this.open){this.emit("sl-show"),this.addOpenListeners(),this.originalTrigger=document.activeElement,this.modal.activate(),rA(this);const e=this.querySelector("[autofocus]");e&&e.removeAttribute("autofocus"),await Promise.all([ma(this.dialog),ma(this.overlay)]),this.dialog.hidden=!1,requestAnimationFrame(()=>{this.emit("sl-initial-focus",{cancelable:!0}).defaultPrevented||(e?e.focus({preventScroll:!0}):this.panel.focus({preventScroll:!0})),e&&e.setAttribute("autofocus","")});const t=Zi(this,"dialog.show",{dir:this.localize.dir()}),n=Zi(this,"dialog.overlay.show",{dir:this.localize.dir()});await Promise.all([Ki(this.panel,t.keyframes,t.options),Ki(this.overlay,n.keyframes,n.options)]),this.emit("sl-after-show")}else{this.emit("sl-hide"),this.removeOpenListeners(),this.modal.deactivate(),await Promise.all([ma(this.dialog),ma(this.overlay)]);const e=Zi(this,"dialog.hide",{dir:this.localize.dir()}),t=Zi(this,"dialog.overlay.hide",{dir:this.localize.dir()});await Promise.all([Ki(this.overlay,t.keyframes,t.options).then(()=>{this.overlay.hidden=!0}),Ki(this.panel,e.keyframes,e.options).then(()=>{this.panel.hidden=!0})]),this.dialog.hidden=!0,this.overlay.hidden=!1,this.panel.hidden=!1,iA(this);const n=this.originalTrigger;typeof(n==null?void 0:n.focus)=="function"&&setTimeout(()=>n.focus()),this.emit("sl-after-hide")}}async show(){if(!this.open)return this.open=!0,Mu(this,"sl-after-show")}async hide(){if(!!this.open)return this.open=!1,Mu(this,"sl-after-hide")}render(){return he`
      <div
        part="base"
        class=${wr({dialog:!0,"dialog--open":this.open,"dialog--has-footer":this.hasSlotController.test("footer")})}
      >
        <div part="overlay" class="dialog__overlay" @click=${()=>this.requestClose("overlay")} tabindex="-1"></div>

        <div
          part="panel"
          class="dialog__panel"
          role="dialog"
          aria-modal="true"
          aria-hidden=${this.open?"false":"true"}
          aria-label=${Et(this.noHeader?this.label:void 0)}
          aria-labelledby=${Et(this.noHeader?void 0:"title")}
          tabindex="0"
        >
          ${this.noHeader?"":he`
                <header part="header" class="dialog__header">
                  <h2 part="title" class="dialog__title" id="title">
                    <slot name="label"> ${this.label.length>0?this.label:String.fromCharCode(65279)} </slot>
                  </h2>
                  <div part="header-actions" class="dialog__header-actions">
                    <slot name="header-actions"></slot>
                    <sl-icon-button
                      part="close-button"
                      exportparts="base:close-button__base"
                      class="dialog__close"
                      name="x-lg"
                      label=${this.localize.term("close")}
                      library="system"
                      @click="${()=>this.requestClose("close-button")}"
                    ></sl-icon-button>
                  </div>
                </header>
              `}

          <slot part="body" class="dialog__body"></slot>

          <footer part="footer" class="dialog__footer">
            <slot name="footer"></slot>
          </footer>
        </div>
      </div>
    `}};kh.styles=fQe;H([pt(".dialog")],kh.prototype,"dialog",2);H([pt(".dialog__panel")],kh.prototype,"panel",2);H([pt(".dialog__overlay")],kh.prototype,"overlay",2);H([Q({type:Boolean,reflect:!0})],kh.prototype,"open",2);H([Q({reflect:!0})],kh.prototype,"label",2);H([Q({attribute:"no-header",type:Boolean,reflect:!0})],kh.prototype,"noHeader",2);H([Jt("open",{waitUntilFirstUpdate:!0})],kh.prototype,"handleOpenChange",1);kh=H([ze("sl-dialog")],kh);Mr("dialog.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:250,easing:"ease"}});Mr("dialog.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:250,easing:"ease"}});Mr("dialog.denyClose",{keyframes:[{scale:1},{scale:1.02},{scale:1}],options:{duration:250}});Mr("dialog.overlay.show",{keyframes:[{opacity:0},{opacity:1}],options:{duration:250}});Mr("dialog.overlay.hide",{keyframes:[{opacity:1},{opacity:0}],options:{duration:250}});function Pde(e){return e.charAt(0).toUpperCase()+e.slice(1)}var hQe=Xt`
  ${_r}

  :host {
    --size: 25rem;
    --header-spacing: var(--sl-spacing-large);
    --body-spacing: var(--sl-spacing-large);
    --footer-spacing: var(--sl-spacing-large);

    display: contents;
  }

  .drawer {
    top: 0;
    inset-inline-start: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: hidden;
  }

  .drawer--contained {
    position: absolute;
    z-index: initial;
  }

  .drawer--fixed {
    position: fixed;
    z-index: var(--sl-z-index-drawer);
  }

  .drawer__panel {
    position: absolute;
    display: flex;
    flex-direction: column;
    z-index: 2;
    max-width: 100%;
    max-height: 100%;
    background-color: var(--sl-panel-background-color);
    box-shadow: var(--sl-shadow-x-large);
    overflow: auto;
    pointer-events: all;
  }

  .drawer__panel:focus {
    outline: none;
  }

  .drawer--top .drawer__panel {
    top: 0;
    inset-inline-end: auto;
    bottom: auto;
    inset-inline-start: 0;
    width: 100%;
    height: var(--size);
  }

  .drawer--end .drawer__panel {
    top: 0;
    inset-inline-end: 0;
    bottom: auto;
    inset-inline-start: auto;
    width: var(--size);
    height: 100%;
  }

  .drawer--bottom .drawer__panel {
    top: auto;
    inset-inline-end: auto;
    bottom: 0;
    inset-inline-start: 0;
    width: 100%;
    height: var(--size);
  }

  .drawer--start .drawer__panel {
    top: 0;
    inset-inline-end: auto;
    bottom: auto;
    inset-inline-start: 0;
    width: var(--size);
    height: 100%;
  }

  .drawer__header {
    display: flex;
  }

  .drawer__title {
    flex: 1 1 auto;
    font: inherit;
    font-size: var(--sl-font-size-large);
    line-height: var(--sl-line-height-dense);
    padding: var(--header-spacing);
    margin: 0;
  }

  .drawer__header-actions {
    flex-shrink: 0;
    display: flex;
    flex-wrap: wrap;
    justify-content: end;
    gap: var(--sl-spacing-2x-small);
    padding: 0 var(--header-spacing);
  }

  .drawer__header-actions sl-icon-button,
  .drawer__header-actions ::slotted(sl-icon-button) {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-medium);
  }

  .drawer__body {
    flex: 1 1 auto;
    display: block;
    padding: var(--body-spacing);
    overflow: auto;
    -webkit-overflow-scrolling: touch;
  }

  .drawer__footer {
    text-align: right;
    padding: var(--footer-spacing);
  }

  .drawer__footer ::slotted(sl-button:not(:last-of-type)) {
    margin-inline-end: var(--sl-spacing-x-small);
  }

  .drawer:not(.drawer--has-footer) .drawer__footer {
    display: none;
  }

  .drawer__overlay {
    display: block;
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background-color: var(--sl-overlay-background-color);
    pointer-events: all;
  }

  .drawer--contained .drawer__overlay {
    display: none;
  }

  @media (forced-colors: active) {
    .drawer__panel {
      border: solid 1px var(--sl-color-neutral-0);
    }
  }
`;let Ul=class extends Xn{constructor(){super(...arguments),this.hasSlotController=new td(this,"footer"),this.localize=new Ra(this),this.modal=new lke(this),this.open=!1,this.label="",this.placement="end",this.contained=!1,this.noHeader=!1,this.handleDocumentKeyDown=e=>{this.open&&!this.contained&&e.key==="Escape"&&(e.stopPropagation(),this.requestClose("keyboard"))}}firstUpdated(){this.drawer.hidden=!this.open,this.open&&(this.addOpenListeners(),this.contained||(this.modal.activate(),rA(this)))}disconnectedCallback(){super.disconnectedCallback(),iA(this)}requestClose(e){if(this.emit("sl-request-close",{cancelable:!0,detail:{source:e}}).defaultPrevented){const n=Zi(this,"drawer.denyClose",{dir:this.localize.dir()});Ki(this.panel,n.keyframes,n.options);return}this.hide()}addOpenListeners(){document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){document.removeEventListener("keydown",this.handleDocumentKeyDown)}async handleOpenChange(){if(this.open){this.emit("sl-show"),this.addOpenListeners(),this.originalTrigger=document.activeElement,this.contained||(this.modal.activate(),rA(this));const e=this.querySelector("[autofocus]");e&&e.removeAttribute("autofocus"),await Promise.all([ma(this.drawer),ma(this.overlay)]),this.drawer.hidden=!1,requestAnimationFrame(()=>{this.emit("sl-initial-focus",{cancelable:!0}).defaultPrevented||(e?e.focus({preventScroll:!0}):this.panel.focus({preventScroll:!0})),e&&e.setAttribute("autofocus","")});const t=Zi(this,`drawer.show${Pde(this.placement)}`,{dir:this.localize.dir()}),n=Zi(this,"drawer.overlay.show",{dir:this.localize.dir()});await Promise.all([Ki(this.panel,t.keyframes,t.options),Ki(this.overlay,n.keyframes,n.options)]),this.emit("sl-after-show")}else{this.emit("sl-hide"),this.removeOpenListeners(),this.contained||(this.modal.deactivate(),iA(this)),await Promise.all([ma(this.drawer),ma(this.overlay)]);const e=Zi(this,`drawer.hide${Pde(this.placement)}`,{dir:this.localize.dir()}),t=Zi(this,"drawer.overlay.hide",{dir:this.localize.dir()});await Promise.all([Ki(this.overlay,t.keyframes,t.options).then(()=>{this.overlay.hidden=!0}),Ki(this.panel,e.keyframes,e.options).then(()=>{this.panel.hidden=!0})]),this.drawer.hidden=!0,this.overlay.hidden=!1,this.panel.hidden=!1;const n=this.originalTrigger;typeof(n==null?void 0:n.focus)=="function"&&setTimeout(()=>n.focus()),this.emit("sl-after-hide")}}handleNoModalChange(){this.open&&!this.contained&&(this.modal.activate(),rA(this)),this.open&&this.contained&&(this.modal.deactivate(),iA(this))}async show(){if(!this.open)return this.open=!0,Mu(this,"sl-after-show")}async hide(){if(!!this.open)return this.open=!1,Mu(this,"sl-after-hide")}render(){return he`
      <div
        part="base"
        class=${wr({drawer:!0,"drawer--open":this.open,"drawer--top":this.placement==="top","drawer--end":this.placement==="end","drawer--bottom":this.placement==="bottom","drawer--start":this.placement==="start","drawer--contained":this.contained,"drawer--fixed":!this.contained,"drawer--rtl":this.localize.dir()==="rtl","drawer--has-footer":this.hasSlotController.test("footer")})}
      >
        <div part="overlay" class="drawer__overlay" @click=${()=>this.requestClose("overlay")} tabindex="-1"></div>

        <div
          part="panel"
          class="drawer__panel"
          role="dialog"
          aria-modal="true"
          aria-hidden=${this.open?"false":"true"}
          aria-label=${Et(this.noHeader?this.label:void 0)}
          aria-labelledby=${Et(this.noHeader?void 0:"title")}
          tabindex="0"
        >
          ${this.noHeader?"":he`
                <header part="header" class="drawer__header">
                  <h2 part="title" class="drawer__title" id="title">
                    <!-- If there's no label, use an invisible character to prevent the header from collapsing -->
                    <slot name="label"> ${this.label.length>0?this.label:String.fromCharCode(65279)} </slot>
                  </h2>
                  <div part="header-actions" class="drawer__header-actions">
                    <slot name="header-actions"></slot>
                    <sl-icon-button
                      part="close-button"
                      exportparts="base:close-button__base"
                      class="drawer__close"
                      name="x-lg"
                      label=${this.localize.term("close")}
                      library="system"
                      @click=${()=>this.requestClose("close-button")}
                    ></sl-icon-button>
                  </div>
                </header>
              `}

          <slot part="body" class="drawer__body"></slot>

          <footer part="footer" class="drawer__footer">
            <slot name="footer"></slot>
          </footer>
        </div>
      </div>
    `}};Ul.styles=hQe;H([pt(".drawer")],Ul.prototype,"drawer",2);H([pt(".drawer__panel")],Ul.prototype,"panel",2);H([pt(".drawer__overlay")],Ul.prototype,"overlay",2);H([Q({type:Boolean,reflect:!0})],Ul.prototype,"open",2);H([Q({reflect:!0})],Ul.prototype,"label",2);H([Q({reflect:!0})],Ul.prototype,"placement",2);H([Q({type:Boolean,reflect:!0})],Ul.prototype,"contained",2);H([Q({attribute:"no-header",type:Boolean,reflect:!0})],Ul.prototype,"noHeader",2);H([Jt("open",{waitUntilFirstUpdate:!0})],Ul.prototype,"handleOpenChange",1);H([Jt("contained",{waitUntilFirstUpdate:!0})],Ul.prototype,"handleNoModalChange",1);Ul=H([ze("sl-drawer")],Ul);Mr("drawer.showTop",{keyframes:[{opacity:0,translate:"0 -100%"},{opacity:1,translate:"0 0"}],options:{duration:250,easing:"ease"}});Mr("drawer.hideTop",{keyframes:[{opacity:1,translate:"0 0"},{opacity:0,translate:"0 -100%"}],options:{duration:250,easing:"ease"}});Mr("drawer.showEnd",{keyframes:[{opacity:0,translate:"100%"},{opacity:1,translate:"0"}],rtlKeyframes:[{opacity:0,translate:"-100%"},{opacity:1,translate:"0"}],options:{duration:250,easing:"ease"}});Mr("drawer.hideEnd",{keyframes:[{opacity:1,translate:"0"},{opacity:0,translate:"100%"}],rtlKeyframes:[{opacity:1,translate:"0"},{opacity:0,translate:"-100%"}],options:{duration:250,easing:"ease"}});Mr("drawer.showBottom",{keyframes:[{opacity:0,translate:"0 100%"},{opacity:1,translate:"0 0"}],options:{duration:250,easing:"ease"}});Mr("drawer.hideBottom",{keyframes:[{opacity:1,translate:"0 0"},{opacity:0,translate:"0 100%"}],options:{duration:250,easing:"ease"}});Mr("drawer.showStart",{keyframes:[{opacity:0,translate:"-100%"},{opacity:1,translate:"0"}],rtlKeyframes:[{opacity:0,translate:"100%"},{opacity:1,translate:"0"}],options:{duration:250,easing:"ease"}});Mr("drawer.hideStart",{keyframes:[{opacity:1,translate:"0"},{opacity:0,translate:"-100%"}],rtlKeyframes:[{opacity:1,translate:"0"},{opacity:0,translate:"100%"}],options:{duration:250,easing:"ease"}});Mr("drawer.denyClose",{keyframes:[{scale:1},{scale:1.01},{scale:1}],options:{duration:250}});Mr("drawer.overlay.show",{keyframes:[{opacity:0},{opacity:1}],options:{duration:250}});Mr("drawer.overlay.hide",{keyframes:[{opacity:1},{opacity:0}],options:{duration:250}});const aB=(e="value")=>(t,n)=>{const r=t.constructor,i=r.prototype.attributeChangedCallback;r.prototype.attributeChangedCallback=function(s,a,o){var l;const u=r.getPropertyOptions(e),c=typeof u.attribute=="string"?u.attribute:e;if(s===c){const f=u.converter||XA,d=(typeof f=="function"?f:(l=f==null?void 0:f.fromAttribute)!==null&&l!==void 0?l:XA.fromAttribute)(o,u.type);this[e]!==d&&(this[n]=d)}i.call(this,s,a,o)}};/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const bee=vee(class extends yee{constructor(e){if(super(e),e.type!==Og.PROPERTY&&e.type!==Og.ATTRIBUTE&&e.type!==Og.BOOLEAN_ATTRIBUTE)throw Error("The `live` directive is not allowed on child or event bindings");if(!UZe(e))throw Error("`live` bindings can only contain a single expression")}render(e){return e}update(e,[t]){if(t===fu||t===ri)return t;const n=e.element,r=e.name;if(e.type===Og.PROPERTY){if(t===n[r])return fu}else if(e.type===Og.BOOLEAN_ATTRIBUTE){if(!!t===n.hasAttribute(r))return fu}else if(e.type===Og.ATTRIBUTE&&n.getAttribute(r)===t+"")return fu;return VZe(e),t}}),oB=Xt`
  .form-control .form-control__label {
    display: none;
  }

  .form-control .form-control__help-text {
    display: none;
  }

  /* Label */
  .form-control--has-label .form-control__label {
    display: inline-block;
    color: var(--sl-input-label-color);
    margin-bottom: var(--sl-spacing-3x-small);
  }

  .form-control--has-label.form-control--small .form-control__label {
    font-size: var(--sl-input-label-font-size-small);
  }

  .form-control--has-label.form-control--medium .form-control__label {
    font-size: var(--sl-input-label-font-size-medium);
  }

  .form-control--has-label.form-control--large .form-control__label {
    font-size: var(--sl-input-label-font-size-large);
  }

  :host([required]) .form-control--has-label .form-control__label::after {
    content: var(--sl-input-required-content);
    margin-inline-start: var(--sl-input-required-content-offset);
    color: var(--sl-input-required-content-color);
  }

  /* Help text */
  .form-control--has-help-text .form-control__help-text {
    display: block;
    color: var(--sl-input-help-text-color);
    margin-top: var(--sl-spacing-3x-small);
  }

  .form-control--has-help-text.form-control--small .form-control__help-text {
    font-size: var(--sl-input-help-text-font-size-small);
  }

  .form-control--has-help-text.form-control--medium .form-control__help-text {
    font-size: var(--sl-input-help-text-font-size-medium);
  }

  .form-control--has-help-text.form-control--large .form-control__help-text {
    font-size: var(--sl-input-help-text-font-size-large);
  }

  .form-control--has-help-text.form-control--radio-group .form-control__help-text {
    margin-top: var(--sl-spacing-2x-small);
  }
`;var dQe=Xt`
  ${_r}
  ${oB}

  :host {
    display: block;
  }

  .input {
    flex: 1 1 auto;
    display: inline-flex;
    align-items: stretch;
    justify-content: start;
    position: relative;
    width: 100%;
    font-family: var(--sl-input-font-family);
    font-weight: var(--sl-input-font-weight);
    letter-spacing: var(--sl-input-letter-spacing);
    vertical-align: middle;
    overflow: hidden;
    cursor: text;
    transition: var(--sl-transition-fast) color, var(--sl-transition-fast) border, var(--sl-transition-fast) box-shadow,
      var(--sl-transition-fast) background-color;
  }

  /* Standard inputs */
  .input--standard {
    background-color: var(--sl-input-background-color);
    border: solid var(--sl-input-border-width) var(--sl-input-border-color);
  }

  .input--standard:hover:not(.input--disabled) {
    background-color: var(--sl-input-background-color-hover);
    border-color: var(--sl-input-border-color-hover);
  }

  .input--standard.input--focused:not(.input--disabled) {
    background-color: var(--sl-input-background-color-focus);
    border-color: var(--sl-input-border-color-focus);
    box-shadow: 0 0 0 var(--sl-focus-ring-width) var(--sl-input-focus-ring-color);
  }

  .input--standard.input--focused:not(.input--disabled) .input__control {
    color: var(--sl-input-color-focus);
  }

  .input--standard.input--disabled {
    background-color: var(--sl-input-background-color-disabled);
    border-color: var(--sl-input-border-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
  }

  .input--standard.input--disabled .input__control {
    color: var(--sl-input-color-disabled);
  }

  .input--standard.input--disabled .input__control::placeholder {
    color: var(--sl-input-placeholder-color-disabled);
  }

  /* Filled inputs */
  .input--filled {
    border: none;
    background-color: var(--sl-input-filled-background-color);
    color: var(--sl-input-color);
  }

  .input--filled:hover:not(.input--disabled) {
    background-color: var(--sl-input-filled-background-color-hover);
  }

  .input--filled.input--focused:not(.input--disabled) {
    background-color: var(--sl-input-filled-background-color-focus);
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .input--filled.input--disabled {
    background-color: var(--sl-input-filled-background-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
  }

  .input__control {
    flex: 1 1 auto;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    min-width: 0;
    height: 100%;
    color: var(--sl-input-color);
    border: none;
    background: inherit;
    box-shadow: none;
    padding: 0;
    margin: 0;
    cursor: inherit;
    -webkit-appearance: none;
  }

  .input__control::-webkit-search-decoration,
  .input__control::-webkit-search-cancel-button,
  .input__control::-webkit-search-results-button,
  .input__control::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }

  .input__control:-webkit-autofill,
  .input__control:-webkit-autofill:hover,
  .input__control:-webkit-autofill:focus,
  .input__control:-webkit-autofill:active {
    box-shadow: 0 0 0 var(--sl-input-height-large) var(--sl-input-background-color-hover) inset !important;
    -webkit-text-fill-color: var(--sl-color-primary-500);
    caret-color: var(--sl-input-color);
  }

  .input--filled .input__control:-webkit-autofill,
  .input--filled .input__control:-webkit-autofill:hover,
  .input--filled .input__control:-webkit-autofill:focus,
  .input--filled .input__control:-webkit-autofill:active {
    box-shadow: 0 0 0 var(--sl-input-height-large) var(--sl-input-filled-background-color) inset !important;
  }

  .input__control::placeholder {
    color: var(--sl-input-placeholder-color);
    user-select: none;
  }

  .input:hover:not(.input--disabled) .input__control {
    color: var(--sl-input-color-hover);
  }

  .input__control:focus {
    outline: none;
  }

  .input__prefix,
  .input__suffix {
    display: inline-flex;
    flex: 0 0 auto;
    align-items: center;
    cursor: default;
  }

  .input__prefix::slotted(sl-icon),
  .input__suffix::slotted(sl-icon) {
    color: var(--sl-input-icon-color);
  }

  /*
   * Size modifiers
   */

  .input--small {
    border-radius: var(--sl-input-border-radius-small);
    font-size: var(--sl-input-font-size-small);
    height: var(--sl-input-height-small);
  }

  .input--small .input__control {
    height: calc(var(--sl-input-height-small) - var(--sl-input-border-width) * 2);
    padding: 0 var(--sl-input-spacing-small);
  }

  .input--small .input__clear,
  .input--small .input__password-toggle {
    width: calc(1em + var(--sl-input-spacing-small) * 2);
  }

  .input--small .input__prefix::slotted(*) {
    margin-inline-start: var(--sl-input-spacing-small);
  }

  .input--small .input__suffix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-small);
  }

  .input--medium {
    border-radius: var(--sl-input-border-radius-medium);
    font-size: var(--sl-input-font-size-medium);
    height: var(--sl-input-height-medium);
  }

  .input--medium .input__control {
    height: calc(var(--sl-input-height-medium) - var(--sl-input-border-width) * 2);
    padding: 0 var(--sl-input-spacing-medium);
  }

  .input--medium .input__clear,
  .input--medium .input__password-toggle {
    width: calc(1em + var(--sl-input-spacing-medium) * 2);
  }

  .input--medium .input__prefix::slotted(*) {
    margin-inline-start: var(--sl-input-spacing-medium);
  }

  .input--medium .input__suffix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-medium);
  }

  .input--large {
    border-radius: var(--sl-input-border-radius-large);
    font-size: var(--sl-input-font-size-large);
    height: var(--sl-input-height-large);
  }

  .input--large .input__control {
    height: calc(var(--sl-input-height-large) - var(--sl-input-border-width) * 2);
    padding: 0 var(--sl-input-spacing-large);
  }

  .input--large .input__clear,
  .input--large .input__password-toggle {
    width: calc(1em + var(--sl-input-spacing-large) * 2);
  }

  .input--large .input__prefix::slotted(*) {
    margin-inline-start: var(--sl-input-spacing-large);
  }

  .input--large .input__suffix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-large);
  }

  /*
   * Pill modifier
   */

  .input--pill.input--small {
    border-radius: var(--sl-input-height-small);
  }

  .input--pill.input--medium {
    border-radius: var(--sl-input-height-medium);
  }

  .input--pill.input--large {
    border-radius: var(--sl-input-height-large);
  }

  /*
   * Clearable + Password Toggle
   */

  .input__clear,
  .input__password-toggle {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: inherit;
    color: var(--sl-input-icon-color);
    border: none;
    background: none;
    padding: 0;
    transition: var(--sl-transition-fast) color;
    cursor: pointer;
  }

  .input__clear:hover,
  .input__password-toggle:hover {
    color: var(--sl-input-icon-color-hover);
  }

  .input__clear:focus,
  .input__password-toggle:focus {
    outline: none;
  }

  .input--empty .input__clear {
    visibility: hidden;
  }

  /* Don't show the browser's password toggle in Edge */
  ::-ms-reveal {
    display: none;
  }

  /* Hide the built-in number spinner */
  .input--no-spin-buttons input[type='number']::-webkit-outer-spin-button,
  .input--no-spin-buttons input[type='number']::-webkit-inner-spin-button {
    -webkit-appearance: none;
    display: none;
  }

  .input--no-spin-buttons input[type='number'] {
    -moz-appearance: textfield;
  }
`;let Wt=class extends Xn{constructor(){super(...arguments),this.formControlController=new dC(this,{assumeInteractionOn:["sl-blur","sl-input"]}),this.hasSlotController=new td(this,"help-text","label"),this.localize=new Ra(this),this.hasFocus=!1,this.title="",this.__numberInput=Object.assign(document.createElement("input"),{type:"number"}),this.__dateInput=Object.assign(document.createElement("input"),{type:"date"}),this.type="text",this.name="",this.value="",this.defaultValue="",this.size="medium",this.filled=!1,this.pill=!1,this.label="",this.helpText="",this.clearable=!1,this.disabled=!1,this.placeholder="",this.readonly=!1,this.passwordToggle=!1,this.passwordVisible=!1,this.noSpinButtons=!1,this.form="",this.required=!1,this.spellcheck=!0}get valueAsDate(){var e;return this.__dateInput.value=this.value,((e=this.input)==null?void 0:e.valueAsDate)||this.__dateInput.valueAsDate}set valueAsDate(e){this.__dateInput.valueAsDate=e,this.value=this.__dateInput.value}get valueAsNumber(){var e;return this.__numberInput.value=this.value,((e=this.input)==null?void 0:e.valueAsNumber)||this.__numberInput.valueAsNumber}set valueAsNumber(e){this.__numberInput.valueAsNumber=e,this.value=this.__numberInput.value}get validity(){return this.input.validity}get validationMessage(){return this.input.validationMessage}firstUpdated(){this.formControlController.updateValidity()}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleChange(){this.value=this.input.value,this.emit("sl-change")}handleClearClick(e){this.value="",this.emit("sl-clear"),this.emit("sl-input"),this.emit("sl-change"),this.input.focus(),e.stopPropagation()}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleInput(){this.value=this.input.value,this.formControlController.updateValidity(),this.emit("sl-input")}handleInvalid(e){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(e)}handleKeyDown(e){const t=e.metaKey||e.ctrlKey||e.shiftKey||e.altKey;e.key==="Enter"&&!t&&setTimeout(()=>{!e.defaultPrevented&&!e.isComposing&&this.formControlController.submit()})}handlePasswordToggle(){this.passwordVisible=!this.passwordVisible}handleDisabledChange(){this.formControlController.setValidity(this.disabled)}handleStepChange(){this.input.step=String(this.step),this.formControlController.updateValidity()}async handleValueChange(){await this.updateComplete,this.formControlController.updateValidity()}focus(e){this.input.focus(e)}blur(){this.input.blur()}select(){this.input.select()}setSelectionRange(e,t,n="none"){this.input.setSelectionRange(e,t,n)}setRangeText(e,t,n,r){this.input.setRangeText(e,t,n,r),this.value!==this.input.value&&(this.value=this.input.value)}showPicker(){"showPicker"in HTMLInputElement.prototype&&this.input.showPicker()}stepUp(){this.input.stepUp(),this.value!==this.input.value&&(this.value=this.input.value)}stepDown(){this.input.stepDown(),this.value!==this.input.value&&(this.value=this.input.value)}checkValidity(){return this.input.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.input.reportValidity()}setCustomValidity(e){this.input.setCustomValidity(e),this.formControlController.updateValidity()}render(){const e=this.hasSlotController.test("label"),t=this.hasSlotController.test("help-text"),n=this.label?!0:!!e,r=this.helpText?!0:!!t,i=this.clearable&&!this.disabled&&!this.readonly&&(typeof this.value=="number"||this.value.length>0);return he`
      <div
        part="form-control"
        class=${wr({"form-control":!0,"form-control--small":this.size==="small","form-control--medium":this.size==="medium","form-control--large":this.size==="large","form-control--has-label":n,"form-control--has-help-text":r})}
      >
        <label
          part="form-control-label"
          class="form-control__label"
          for="input"
          aria-hidden=${n?"false":"true"}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <div
            part="base"
            class=${wr({input:!0,"input--small":this.size==="small","input--medium":this.size==="medium","input--large":this.size==="large","input--pill":this.pill,"input--standard":!this.filled,"input--filled":this.filled,"input--disabled":this.disabled,"input--focused":this.hasFocus,"input--empty":!this.value,"input--no-spin-buttons":this.noSpinButtons})}
          >
            <slot name="prefix" part="prefix" class="input__prefix"></slot>
            <input
              part="input"
              id="input"
              class="input__control"
              type=${this.type==="password"&&this.passwordVisible?"text":this.type}
              title=${this.title}
              name=${Et(this.name)}
              ?disabled=${this.disabled}
              ?readonly=${this.readonly}
              ?required=${this.required}
              placeholder=${Et(this.placeholder)}
              minlength=${Et(this.minlength)}
              maxlength=${Et(this.maxlength)}
              min=${Et(this.min)}
              max=${Et(this.max)}
              step=${Et(this.step)}
              .value=${bee(this.value)}
              autocapitalize=${Et(this.autocapitalize)}
              autocomplete=${Et(this.autocomplete)}
              autocorrect=${Et(this.autocorrect)}
              ?autofocus=${this.autofocus}
              spellcheck=${this.spellcheck}
              pattern=${Et(this.pattern)}
              enterkeyhint=${Et(this.enterkeyhint)}
              inputmode=${Et(this.inputmode)}
              aria-describedby="help-text"
              @change=${this.handleChange}
              @input=${this.handleInput}
              @invalid=${this.handleInvalid}
              @keydown=${this.handleKeyDown}
              @focus=${this.handleFocus}
              @blur=${this.handleBlur}
            />

            ${i?he`
                    <button
                      part="clear-button"
                      class="input__clear"
                      type="button"
                      aria-label=${this.localize.term("clearEntry")}
                      @click=${this.handleClearClick}
                      tabindex="-1"
                    >
                      <slot name="clear-icon">
                        <sl-icon name="x-circle-fill" library="system"></sl-icon>
                      </slot>
                    </button>
                  `:""}
            ${this.passwordToggle&&!this.disabled?he`
                    <button
                      part="password-toggle-button"
                      class="input__password-toggle"
                      type="button"
                      aria-label=${this.localize.term(this.passwordVisible?"hidePassword":"showPassword")}
                      @click=${this.handlePasswordToggle}
                      tabindex="-1"
                    >
                      ${this.passwordVisible?he`
                            <slot name="show-password-icon">
                              <sl-icon name="eye-slash" library="system"></sl-icon>
                            </slot>
                          `:he`
                            <slot name="hide-password-icon">
                              <sl-icon name="eye" library="system"></sl-icon>
                            </slot>
                          `}
                    </button>
                  `:""}

            <slot name="suffix" part="suffix" class="input__suffix"></slot>
          </div>
        </div>

        <slot
          name="help-text"
          part="form-control-help-text"
          id="help-text"
          class="form-control__help-text"
          aria-hidden=${r?"false":"true"}
        >
          ${this.helpText}
        </slot>
        </div>
      </div>
    `}};Wt.styles=dQe;H([pt(".input__control")],Wt.prototype,"input",2);H([Cr()],Wt.prototype,"hasFocus",2);H([Q()],Wt.prototype,"title",2);H([Q({reflect:!0})],Wt.prototype,"type",2);H([Q()],Wt.prototype,"name",2);H([Q()],Wt.prototype,"value",2);H([aB()],Wt.prototype,"defaultValue",2);H([Q({reflect:!0})],Wt.prototype,"size",2);H([Q({type:Boolean,reflect:!0})],Wt.prototype,"filled",2);H([Q({type:Boolean,reflect:!0})],Wt.prototype,"pill",2);H([Q()],Wt.prototype,"label",2);H([Q({attribute:"help-text"})],Wt.prototype,"helpText",2);H([Q({type:Boolean})],Wt.prototype,"clearable",2);H([Q({type:Boolean,reflect:!0})],Wt.prototype,"disabled",2);H([Q()],Wt.prototype,"placeholder",2);H([Q({type:Boolean,reflect:!0})],Wt.prototype,"readonly",2);H([Q({attribute:"password-toggle",type:Boolean})],Wt.prototype,"passwordToggle",2);H([Q({attribute:"password-visible",type:Boolean})],Wt.prototype,"passwordVisible",2);H([Q({attribute:"no-spin-buttons",type:Boolean})],Wt.prototype,"noSpinButtons",2);H([Q({reflect:!0})],Wt.prototype,"form",2);H([Q({type:Boolean,reflect:!0})],Wt.prototype,"required",2);H([Q()],Wt.prototype,"pattern",2);H([Q({type:Number})],Wt.prototype,"minlength",2);H([Q({type:Number})],Wt.prototype,"maxlength",2);H([Q()],Wt.prototype,"min",2);H([Q()],Wt.prototype,"max",2);H([Q()],Wt.prototype,"step",2);H([Q()],Wt.prototype,"autocapitalize",2);H([Q()],Wt.prototype,"autocorrect",2);H([Q()],Wt.prototype,"autocomplete",2);H([Q({type:Boolean})],Wt.prototype,"autofocus",2);H([Q()],Wt.prototype,"enterkeyhint",2);H([Q({type:Boolean,converter:{fromAttribute:e=>!(!e||e==="false"),toAttribute:e=>e?"true":"false"}})],Wt.prototype,"spellcheck",2);H([Q()],Wt.prototype,"inputmode",2);H([Jt("disabled",{waitUntilFirstUpdate:!0})],Wt.prototype,"handleDisabledChange",1);H([Jt("step",{waitUntilFirstUpdate:!0})],Wt.prototype,"handleStepChange",1);H([Jt("value",{waitUntilFirstUpdate:!0})],Wt.prototype,"handleValueChange",1);Wt=H([ze("sl-input")],Wt);var pQe=Xt`
  ${_r}

  :host {
    display: block;
    user-select: none;
  }

  :host(:focus) {
    outline: none;
  }

  .option {
    position: relative;
    display: flex;
    align-items: center;
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-medium);
    font-weight: var(--sl-font-weight-normal);
    line-height: var(--sl-line-height-normal);
    letter-spacing: var(--sl-letter-spacing-normal);
    color: var(--sl-color-neutral-700);
    padding: var(--sl-spacing-x-small) var(--sl-spacing-medium) var(--sl-spacing-x-small) var(--sl-spacing-x-small);
    transition: var(--sl-transition-fast) fill;
    cursor: pointer;
  }

  .option--hover:not(.option--current):not(.option--disabled) {
    background-color: var(--sl-color-neutral-100);
    color: var(--sl-color-neutral-1000);
  }

  .option--current,
  .option--current.option--disabled {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
    opacity: 1;
  }

  .option--disabled {
    outline: none;
    opacity: 0.5;
    cursor: not-allowed;
  }

  .option__label {
    flex: 1 1 auto;
    display: inline-block;
    line-height: var(--sl-line-height-dense);
  }

  .option .option__check {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    visibility: hidden;
    padding-inline-end: var(--sl-spacing-2x-small);
  }

  .option--selected .option__check {
    visibility: visible;
  }

  .option__prefix,
  .option__suffix {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
  }

  .option__prefix::slotted(*) {
    margin-inline-end: var(--sl-spacing-x-small);
  }

  .option__suffix::slotted(*) {
    margin-inline-start: var(--sl-spacing-x-small);
  }

  @media (forced-colors: active) {
    :host(:hover:not([aria-disabled='true'])) .option {
      outline: dashed 1px SelectedItem;
      outline-offset: -1px;
    }
  }
`;let Fu=class extends Xn{constructor(){super(...arguments),this.localize=new Ra(this),this.current=!1,this.selected=!1,this.hasHover=!1,this.value="",this.disabled=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","option"),this.setAttribute("aria-selected","false")}handleDefaultSlotChange(){const e=this.getTextLabel();if(typeof this.cachedTextLabel>"u"){this.cachedTextLabel=e;return}e!==this.cachedTextLabel&&(this.cachedTextLabel=e,this.emit("slotchange",{bubbles:!0,composed:!1,cancelable:!1}))}handleMouseEnter(){this.hasHover=!0}handleMouseLeave(){this.hasHover=!1}handleDisabledChange(){this.setAttribute("aria-disabled",this.disabled?"true":"false")}handleSelectedChange(){this.setAttribute("aria-selected",this.selected?"true":"false")}handleValueChange(){typeof this.value!="string"&&(this.value=String(this.value)),this.value.includes(" ")&&(console.error("Option values cannot include a space. All spaces have been replaced with underscores.",this),this.value=this.value.replace(/ /g,"_"))}getTextLabel(){var e;return((e=this.textContent)!=null?e:"").trim()}render(){return he`
      <div
        part="base"
        class=${wr({option:!0,"option--current":this.current,"option--disabled":this.disabled,"option--selected":this.selected,"option--hover":this.hasHover})}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
      >
        <sl-icon part="checked-icon" class="option__check" name="check" library="system" aria-hidden="true"></sl-icon>
        <slot part="prefix" name="prefix" class="option__prefix"></slot>
        <slot part="label" class="option__label" @slotchange=${this.handleDefaultSlotChange}></slot>
        <slot part="suffix" name="suffix" class="option__suffix"></slot>
      </div>
    `}};Fu.styles=pQe;H([pt(".option__label")],Fu.prototype,"defaultSlot",2);H([Cr()],Fu.prototype,"current",2);H([Cr()],Fu.prototype,"selected",2);H([Cr()],Fu.prototype,"hasHover",2);H([Q({reflect:!0})],Fu.prototype,"value",2);H([Q({type:Boolean,reflect:!0})],Fu.prototype,"disabled",2);H([Jt("disabled")],Fu.prototype,"handleDisabledChange",1);H([Jt("selected")],Fu.prototype,"handleSelectedChange",1);H([Jt("value")],Fu.prototype,"handleValueChange",1);Fu=H([ze("sl-option")],Fu);/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const uke="important",gQe=" !"+uke,mQe=vee(class extends yee{constructor(e){var t;if(super(e),e.type!==Og.ATTRIBUTE||e.name!=="style"||((t=e.strings)===null||t===void 0?void 0:t.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(e){return Object.keys(e).reduce((t,n)=>{const r=e[n];return r==null?t:t+`${n=n.includes("-")?n:n.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`},"")}update(e,[t]){const{style:n}=e.element;if(this.ut===void 0){this.ut=new Set;for(const r in t)this.ut.add(r);return this.render(t)}this.ut.forEach(r=>{t[r]==null&&(this.ut.delete(r),r.includes("-")?n.removeProperty(r):n[r]="")});for(const r in t){const i=t[r];if(i!=null){this.ut.add(r);const s=typeof i=="string"&&i.endsWith(gQe);r.includes("-")||s?n.setProperty(r,s?i.slice(0,-11):i,s?uke:""):n[r]=i}}return fu}});var vQe=Xt`
  ${_r}

  :host {
    --height: 1rem;
    --track-color: var(--sl-color-neutral-200);
    --indicator-color: var(--sl-color-primary-600);
    --label-color: var(--sl-color-neutral-0);

    display: block;
  }

  .progress-bar {
    position: relative;
    background-color: var(--track-color);
    height: var(--height);
    border-radius: var(--sl-border-radius-pill);
    box-shadow: inset var(--sl-shadow-small);
    overflow: hidden;
  }

  .progress-bar__indicator {
    height: 100%;
    font-family: var(--sl-font-sans);
    font-size: 12px;
    font-weight: var(--sl-font-weight-normal);
    background-color: var(--indicator-color);
    color: var(--label-color);
    text-align: center;
    line-height: var(--height);
    white-space: nowrap;
    overflow: hidden;
    transition: 400ms width, 400ms background-color;
    user-select: none;
  }

  /* Indeterminate */
  .progress-bar--indeterminate .progress-bar__indicator {
    position: absolute;
    animation: indeterminate 2.5s infinite cubic-bezier(0.37, 0, 0.63, 1);
  }

  .progress-bar--indeterminate.progress-bar--rtl .progress-bar__indicator {
    animation-name: indeterminate-rtl;
  }

  @media (forced-colors: active) {
    .progress-bar {
      outline: solid 1px SelectedItem;
      background-color: var(--sl-color-neutral-0);
    }

    .progress-bar__indicator {
      outline: solid 1px SelectedItem;
      background-color: SelectedItem;
    }
  }

  @keyframes indeterminate {
    0% {
      left: -50%;
      width: 50%;
    }
    75%,
    100% {
      left: 100%;
      width: 50%;
    }
  }

  @keyframes indeterminate-rtl {
    0% {
      right: -50%;
      width: 50%;
    }
    75%,
    100% {
      right: 100%;
      width: 50%;
    }
  }
`;let Cw=class extends Xn{constructor(){super(...arguments),this.localize=new Ra(this),this.value=0,this.indeterminate=!1,this.label=""}render(){return he`
      <div
        part="base"
        class=${wr({"progress-bar":!0,"progress-bar--indeterminate":this.indeterminate,"progress-bar--rtl":this.localize.dir()==="rtl"})}
        role="progressbar"
        title=${Et(this.title)}
        aria-label=${this.label.length>0?this.label:this.localize.term("progress")}
        aria-valuemin="0"
        aria-valuemax="100"
        aria-valuenow=${this.indeterminate?0:this.value}
      >
        <div part="indicator" class="progress-bar__indicator" style=${mQe({width:`${this.value}%`})}>
          ${this.indeterminate?"":he` <slot part="label" class="progress-bar__label"></slot> `}
        </div>
      </div>
    `}};Cw.styles=vQe;H([Q({type:Number,reflect:!0})],Cw.prototype,"value",2);H([Q({type:Boolean,reflect:!0})],Cw.prototype,"indeterminate",2);H([Q()],Cw.prototype,"label",2);Cw=H([ze("sl-progress-bar")],Cw);var yQe=Xt`
  ${oke}

  .button__prefix,
  .button__suffix,
  .button__label {
    display: inline-flex;
    position: relative;
    align-items: center;
  }

  /* We use a hidden input so constraint validation errors work, since they don't appear to show when used with buttons.
    We can't actually hide it, though, otherwise the messages will be suppressed by the browser. */
  .hidden-input {
    all: unset;
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    outline: dotted 1px red;
    opacity: 0;
    z-index: -1;
  }
`;let Ou=class extends Xn{constructor(){super(...arguments),this.hasSlotController=new td(this,"[default]","prefix","suffix"),this.hasFocus=!1,this.checked=!1,this.disabled=!1,this.size="medium",this.pill=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","presentation")}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleClick(e){if(this.disabled){e.preventDefault(),e.stopPropagation();return}this.checked=!0}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleDisabledChange(){this.setAttribute("aria-disabled",this.disabled?"true":"false")}focus(e){this.input.focus(e)}blur(){this.input.blur()}render(){return nA`
      <div part="base" role="presentation">
        <button
          part="${`button${this.checked?" button--checked":""}`}"
          role="radio"
          aria-checked="${this.checked}"
          class=${wr({button:!0,"button--default":!0,"button--small":this.size==="small","button--medium":this.size==="medium","button--large":this.size==="large","button--checked":this.checked,"button--disabled":this.disabled,"button--focused":this.hasFocus,"button--outline":!0,"button--pill":this.pill,"button--has-label":this.hasSlotController.test("[default]"),"button--has-prefix":this.hasSlotController.test("prefix"),"button--has-suffix":this.hasSlotController.test("suffix")})}
          aria-disabled=${this.disabled}
          type="button"
          value=${Et(this.value)}
          tabindex="${this.checked?"0":"-1"}"
          @blur=${this.handleBlur}
          @focus=${this.handleFocus}
          @click=${this.handleClick}
        >
          <slot name="prefix" part="prefix" class="button__prefix"></slot>
          <slot part="label" class="button__label"></slot>
          <slot name="suffix" part="suffix" class="button__suffix"></slot>
        </button>
      </div>
    `}};Ou.styles=yQe;H([pt(".button")],Ou.prototype,"input",2);H([pt(".hidden-input")],Ou.prototype,"hiddenInput",2);H([Cr()],Ou.prototype,"hasFocus",2);H([Q({type:Boolean,reflect:!0})],Ou.prototype,"checked",2);H([Q()],Ou.prototype,"value",2);H([Q({type:Boolean,reflect:!0})],Ou.prototype,"disabled",2);H([Q({reflect:!0})],Ou.prototype,"size",2);H([Q({type:Boolean,reflect:!0})],Ou.prototype,"pill",2);H([Jt("disabled",{waitUntilFirstUpdate:!0})],Ou.prototype,"handleDisabledChange",1);Ou=H([ze("sl-radio-button")],Ou);var bQe=Xt`
  ${_r}

  :host {
    display: inline-block;
  }

  .button-group {
    display: flex;
    flex-wrap: nowrap;
  }
`;let _w=class extends Xn{constructor(){super(...arguments),this.disableRole=!1,this.label=""}handleFocus(e){const t=HS(e.target);t==null||t.classList.add("sl-button-group__button--focus")}handleBlur(e){const t=HS(e.target);t==null||t.classList.remove("sl-button-group__button--focus")}handleMouseOver(e){const t=HS(e.target);t==null||t.classList.add("sl-button-group__button--hover")}handleMouseOut(e){const t=HS(e.target);t==null||t.classList.remove("sl-button-group__button--hover")}handleSlotChange(){const e=[...this.defaultSlot.assignedElements({flatten:!0})];e.forEach(t=>{const n=e.indexOf(t),r=HS(t);r!==null&&(r.classList.add("sl-button-group__button"),r.classList.toggle("sl-button-group__button--first",n===0),r.classList.toggle("sl-button-group__button--inner",n>0&&n<e.length-1),r.classList.toggle("sl-button-group__button--last",n===e.length-1),r.classList.toggle("sl-button-group__button--radio",r.tagName.toLowerCase()==="sl-radio-button"))})}render(){return he`
      <slot
        part="base"
        class="button-group"
        role="${this.disableRole?"presentation":"group"}"
        aria-label=${this.label}
        @focusout=${this.handleBlur}
        @focusin=${this.handleFocus}
        @mouseover=${this.handleMouseOver}
        @mouseout=${this.handleMouseOut}
        @slotchange=${this.handleSlotChange}
      ></slot>
    `}};_w.styles=bQe;H([pt("slot")],_w.prototype,"defaultSlot",2);H([Cr()],_w.prototype,"disableRole",2);H([Q()],_w.prototype,"label",2);_w=H([ze("sl-button-group")],_w);function HS(e){var t;const n="sl-button, sl-radio-button";return(t=e.closest(n))!=null?t:e.querySelector(n)}var xQe=Xt`
  ${_r}
  ${oB}

  :host {
    display: block;
  }

  .form-control {
    position: relative;
    border: none;
    padding: 0;
    margin: 0;
  }

  .form-control__label {
    padding: 0;
  }

  .radio-group--required .radio-group__label::after {
    content: var(--sl-input-required-content);
    margin-inline-start: var(--sl-input-required-content-offset);
  }

  .visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
`;let js=class extends Xn{constructor(){super(...arguments),this.formControlController=new dC(this),this.hasSlotController=new td(this,"help-text","label"),this.customValidityMessage="",this.hasButtonGroup=!1,this.errorMessage="",this.defaultValue="",this.label="",this.helpText="",this.name="option",this.value="",this.size="medium",this.form="",this.required=!1}get validity(){const e=this.required&&!this.value;return this.customValidityMessage!==""?sQe:e?iQe:sB}get validationMessage(){const e=this.required&&!this.value;return this.customValidityMessage!==""?this.customValidityMessage:e?this.validationInput.validationMessage:""}connectedCallback(){super.connectedCallback(),this.defaultValue=this.value}firstUpdated(){this.formControlController.updateValidity()}getAllRadios(){return[...this.querySelectorAll("sl-radio, sl-radio-button")]}handleRadioClick(e){const t=e.target.closest("sl-radio, sl-radio-button"),n=this.getAllRadios(),r=this.value;t.disabled||(this.value=t.value,n.forEach(i=>i.checked=i===t),this.value!==r&&(this.emit("sl-change"),this.emit("sl-input")))}handleKeyDown(e){var t;if(!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," "].includes(e.key))return;const n=this.getAllRadios().filter(o=>!o.disabled),r=(t=n.find(o=>o.checked))!=null?t:n[0],i=e.key===" "?0:["ArrowUp","ArrowLeft"].includes(e.key)?-1:1,s=this.value;let a=n.indexOf(r)+i;a<0&&(a=n.length-1),a>n.length-1&&(a=0),this.getAllRadios().forEach(o=>{o.checked=!1,this.hasButtonGroup||(o.tabIndex=-1)}),this.value=n[a].value,n[a].checked=!0,this.hasButtonGroup?n[a].shadowRoot.querySelector("button").focus():(n[a].tabIndex=0,n[a].focus()),this.value!==s&&(this.emit("sl-change"),this.emit("sl-input")),e.preventDefault()}handleLabelClick(){const e=this.getAllRadios(),n=e.find(r=>r.checked)||e[0];n&&n.focus()}handleInvalid(e){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(e)}async syncRadioElements(){var e,t;const n=this.getAllRadios();if(await Promise.all(n.map(async r=>{await r.updateComplete,r.checked=r.value===this.value,r.size=this.size})),this.hasButtonGroup=n.some(r=>r.tagName.toLowerCase()==="sl-radio-button"),!n.some(r=>r.checked))if(this.hasButtonGroup){const r=(e=n[0].shadowRoot)==null?void 0:e.querySelector("button");r&&(r.tabIndex=0)}else n[0].tabIndex=0;if(this.hasButtonGroup){const r=(t=this.shadowRoot)==null?void 0:t.querySelector("sl-button-group");r&&(r.disableRole=!0)}}syncRadios(){if(customElements.get("sl-radio")&&customElements.get("sl-radio-button")){this.syncRadioElements();return}customElements.get("sl-radio")?this.syncRadioElements():customElements.whenDefined("sl-radio").then(()=>this.syncRadios()),customElements.get("sl-radio-button")?this.syncRadioElements():customElements.whenDefined("sl-radio-button").then(()=>this.syncRadios())}updateCheckedRadio(){this.getAllRadios().forEach(t=>t.checked=t.value===this.value),this.formControlController.setValidity(this.validity.valid)}handleSizeChange(){this.syncRadios()}handleValueChange(){this.hasUpdated&&this.updateCheckedRadio()}checkValidity(){const e=this.required&&!this.value,t=this.customValidityMessage!=="";return e||t?(this.formControlController.emitInvalidEvent(),!1):!0}getForm(){return this.formControlController.getForm()}reportValidity(){const e=this.validity.valid;return this.errorMessage=this.customValidityMessage||e?"":this.validationInput.validationMessage,this.formControlController.setValidity(e),this.validationInput.hidden=!0,clearTimeout(this.validationTimeout),e||(this.validationInput.hidden=!1,this.validationInput.reportValidity(),this.validationTimeout=setTimeout(()=>this.validationInput.hidden=!0,1e4)),e}setCustomValidity(e=""){this.customValidityMessage=e,this.errorMessage=e,this.validationInput.setCustomValidity(e),this.formControlController.updateValidity()}render(){const e=this.hasSlotController.test("label"),t=this.hasSlotController.test("help-text"),n=this.label?!0:!!e,r=this.helpText?!0:!!t,i=he`
      <slot
        @click=${this.handleRadioClick}
        @keydown=${this.handleKeyDown}
        @slotchange=${this.syncRadios}
        role="presentation"
      ></slot>
    `;return he`
      <fieldset
        part="form-control"
        class=${wr({"form-control":!0,"form-control--small":this.size==="small","form-control--medium":this.size==="medium","form-control--large":this.size==="large","form-control--radio-group":!0,"form-control--has-label":n,"form-control--has-help-text":r})}
        role="radiogroup"
        aria-labelledby="label"
        aria-describedby="help-text"
        aria-errormessage="error-message"
      >
        <label
          part="form-control-label"
          id="label"
          class="form-control__label"
          aria-hidden=${n?"false":"true"}
          @click=${this.handleLabelClick}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <div class="visually-hidden">
            <div id="error-message" aria-live="assertive">${this.errorMessage}</div>
            <label class="radio-group__validation">
              <input
                type="text"
                class="radio-group__validation-input"
                ?required=${this.required}
                tabindex="-1"
                hidden
                @invalid=${this.handleInvalid}
              />
            </label>
          </div>

          ${this.hasButtonGroup?he`
                <sl-button-group part="button-group" exportparts="base:button-group__base">
                  ${i}
                </sl-button-group>
              `:i}
        </div>

        <slot
          name="help-text"
          part="form-control-help-text"
          id="help-text"
          class="form-control__help-text"
          aria-hidden=${r?"false":"true"}
        >
          ${this.helpText}
        </slot>
      </fieldset>
    `}};js.styles=xQe;H([pt("slot:not([name])")],js.prototype,"defaultSlot",2);H([pt(".radio-group__validation-input")],js.prototype,"validationInput",2);H([Cr()],js.prototype,"hasButtonGroup",2);H([Cr()],js.prototype,"errorMessage",2);H([Cr()],js.prototype,"defaultValue",2);H([Q()],js.prototype,"label",2);H([Q({attribute:"help-text"})],js.prototype,"helpText",2);H([Q()],js.prototype,"name",2);H([Q({reflect:!0})],js.prototype,"value",2);H([Q({reflect:!0})],js.prototype,"size",2);H([Q({reflect:!0})],js.prototype,"form",2);H([Q({type:Boolean,reflect:!0})],js.prototype,"required",2);H([Jt("size",{waitUntilFirstUpdate:!0})],js.prototype,"handleSizeChange",1);H([Jt("value")],js.prototype,"handleValueChange",1);js=H([ze("sl-radio-group")],js);var wQe=Xt`
  ${_r}
  ${oB}

  :host {
    --thumb-size: 20px;
    --tooltip-offset: 10px;
    --track-color-active: var(--sl-color-neutral-200);
    --track-color-inactive: var(--sl-color-neutral-200);
    --track-active-offset: 0%;
    --track-height: 6px;

    display: block;
  }

  .range {
    position: relative;
  }

  .range__control {
    --percent: 0%;
    -webkit-appearance: none;
    border-radius: 3px;
    width: 100%;
    height: var(--track-height);
    background: transparent;
    line-height: var(--sl-input-height-medium);
    vertical-align: middle;
    margin: 0;

    background-image: linear-gradient(
      to right,
      var(--track-color-inactive) 0%,
      var(--track-color-inactive) min(var(--percent), var(--track-active-offset)),
      var(--track-color-active) min(var(--percent), var(--track-active-offset)),
      var(--track-color-active) max(var(--percent), var(--track-active-offset)),
      var(--track-color-inactive) max(var(--percent), var(--track-active-offset)),
      var(--track-color-inactive) 100%
    );
  }

  .range--rtl .range__control {
    background-image: linear-gradient(
      to left,
      var(--track-color-inactive) 0%,
      var(--track-color-inactive) min(var(--percent), var(--track-active-offset)),
      var(--track-color-active) min(var(--percent), var(--track-active-offset)),
      var(--track-color-active) max(var(--percent), var(--track-active-offset)),
      var(--track-color-inactive) max(var(--percent), var(--track-active-offset)),
      var(--track-color-inactive) 100%
    );
  }

  /* Webkit */
  .range__control::-webkit-slider-runnable-track {
    width: 100%;
    height: var(--track-height);
    border-radius: 3px;
    border: none;
  }

  .range__control::-webkit-slider-thumb {
    border: none;
    width: var(--thumb-size);
    height: var(--thumb-size);
    border-radius: 50%;
    background-color: var(--sl-color-primary-600);
    border: solid var(--sl-input-border-width) var(--sl-color-primary-600);
    -webkit-appearance: none;
    margin-top: calc(var(--thumb-size) / -2 + var(--track-height) / 2);
    cursor: pointer;
  }

  .range__control:enabled::-webkit-slider-thumb:hover {
    background-color: var(--sl-color-primary-500);
    border-color: var(--sl-color-primary-500);
  }

  .range__control:enabled:focus-visible::-webkit-slider-thumb {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .range__control:enabled::-webkit-slider-thumb:active {
    background-color: var(--sl-color-primary-500);
    border-color: var(--sl-color-primary-500);
    cursor: grabbing;
  }

  /* Firefox */
  .range__control::-moz-focus-outer {
    border: 0;
  }

  .range__control::-moz-range-progress {
    background-color: var(--track-color-active);
    border-radius: 3px;
    height: var(--track-height);
  }

  .range__control::-moz-range-track {
    width: 100%;
    height: var(--track-height);
    background-color: var(--track-color-inactive);
    border-radius: 3px;
    border: none;
  }

  .range__control::-moz-range-thumb {
    border: none;
    height: var(--thumb-size);
    width: var(--thumb-size);
    border-radius: 50%;
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
    transition: var(--sl-transition-fast) border-color, var(--sl-transition-fast) background-color,
      var(--sl-transition-fast) color, var(--sl-transition-fast) box-shadow;
    cursor: pointer;
  }

  .range__control:enabled::-moz-range-thumb:hover {
    background-color: var(--sl-color-primary-500);
    border-color: var(--sl-color-primary-500);
  }

  .range__control:enabled:focus-visible::-moz-range-thumb {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .range__control:enabled::-moz-range-thumb:active {
    background-color: var(--sl-color-primary-500);
    border-color: var(--sl-color-primary-500);
    cursor: grabbing;
  }

  /* States */
  .range__control:focus-visible {
    outline: none;
  }

  .range__control:disabled {
    opacity: 0.5;
  }

  .range__control:disabled::-webkit-slider-thumb {
    cursor: not-allowed;
  }

  .range__control:disabled::-moz-range-thumb {
    cursor: not-allowed;
  }

  /* Tooltip output */
  .range__tooltip {
    position: absolute;
    z-index: var(--sl-z-index-tooltip);
    left: 0;
    border-radius: var(--sl-tooltip-border-radius);
    background-color: var(--sl-tooltip-background-color);
    font-family: var(--sl-tooltip-font-family);
    font-size: var(--sl-tooltip-font-size);
    font-weight: var(--sl-tooltip-font-weight);
    line-height: var(--sl-tooltip-line-height);
    color: var(--sl-tooltip-color);
    opacity: 0;
    padding: var(--sl-tooltip-padding);
    transition: var(--sl-transition-fast) opacity;
    pointer-events: none;
  }

  .range__tooltip:after {
    content: '';
    position: absolute;
    width: 0;
    height: 0;
    left: 50%;
    translate: calc(-1 * var(--sl-tooltip-arrow-size));
  }

  .range--tooltip-visible .range__tooltip {
    opacity: 1;
  }

  /* Tooltip on top */
  .range--tooltip-top .range__tooltip {
    top: calc(-1 * var(--thumb-size) - var(--tooltip-offset));
  }

  .range--tooltip-top .range__tooltip:after {
    border-top: var(--sl-tooltip-arrow-size) solid var(--sl-tooltip-background-color);
    border-left: var(--sl-tooltip-arrow-size) solid transparent;
    border-right: var(--sl-tooltip-arrow-size) solid transparent;
    top: 100%;
  }

  /* Tooltip on bottom */
  .range--tooltip-bottom .range__tooltip {
    bottom: calc(-1 * var(--thumb-size) - var(--tooltip-offset));
  }

  .range--tooltip-bottom .range__tooltip:after {
    border-bottom: var(--sl-tooltip-arrow-size) solid var(--sl-tooltip-background-color);
    border-left: var(--sl-tooltip-arrow-size) solid transparent;
    border-right: var(--sl-tooltip-arrow-size) solid transparent;
    bottom: 100%;
  }

  @media (forced-colors: active) {
    .range__control,
    .range__tooltip {
      border: solid 1px transparent;
    }

    .range__control::-webkit-slider-thumb {
      border: solid 1px transparent;
    }

    .range__control::-moz-range-thumb {
      border: solid 1px transparent;
    }

    .range__tooltip:after {
      display: none;
    }
  }
`;let Nr=class extends Xn{constructor(){super(...arguments),this.formControlController=new dC(this),this.hasSlotController=new td(this,"help-text","label"),this.localize=new Ra(this),this.hasFocus=!1,this.hasTooltip=!1,this.title="",this.name="",this.value=0,this.label="",this.helpText="",this.disabled=!1,this.min=0,this.max=100,this.step=1,this.tooltip="top",this.tooltipFormatter=e=>e.toString(),this.form="",this.defaultValue=0}get validity(){return this.input.validity}get validationMessage(){return this.input.validationMessage}connectedCallback(){super.connectedCallback(),this.resizeObserver=new ResizeObserver(()=>this.syncRange()),this.value<this.min&&(this.value=this.min),this.value>this.max&&(this.value=this.max),this.updateComplete.then(()=>{this.syncRange(),this.resizeObserver.observe(this.input)})}disconnectedCallback(){super.disconnectedCallback(),this.resizeObserver.unobserve(this.input)}handleChange(){this.emit("sl-change")}handleInput(){this.value=parseFloat(this.input.value),this.emit("sl-input"),this.syncRange()}handleBlur(){this.hasFocus=!1,this.hasTooltip=!1,this.emit("sl-blur")}handleFocus(){this.hasFocus=!0,this.hasTooltip=!0,this.emit("sl-focus")}handleThumbDragStart(){this.hasTooltip=!0}handleThumbDragEnd(){this.hasTooltip=!1}syncProgress(e){this.input.style.setProperty("--percent",`${e*100}%`)}syncTooltip(e){if(this.output!==null){const t=this.input.offsetWidth,n=this.output.offsetWidth,r=getComputedStyle(this.input).getPropertyValue("--thumb-size"),i=this.localize.dir()==="rtl",s=t*e;if(i){const a=`${t-s}px + ${e} * ${r}`;this.output.style.translate=`calc((${a} - ${n/2}px - ${r} / 2))`}else{const a=`${s}px - ${e} * ${r}`;this.output.style.translate=`calc(${a} - ${n/2}px + ${r} / 2)`}}}handleValueChange(){this.formControlController.updateValidity(),this.input.value=this.value.toString(),this.value=parseFloat(this.input.value),this.syncRange()}handleDisabledChange(){this.formControlController.setValidity(this.disabled)}syncRange(){const e=Math.max(0,(this.value-this.min)/(this.max-this.min));this.syncProgress(e),this.tooltip!=="none"&&this.syncTooltip(e)}handleInvalid(e){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(e)}focus(e){this.input.focus(e)}blur(){this.input.blur()}stepUp(){this.input.stepUp(),this.value!==Number(this.input.value)&&(this.value=Number(this.input.value))}stepDown(){this.input.stepDown(),this.value!==Number(this.input.value)&&(this.value=Number(this.input.value))}checkValidity(){return this.input.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.input.reportValidity()}setCustomValidity(e){this.input.setCustomValidity(e),this.formControlController.updateValidity()}render(){const e=this.hasSlotController.test("label"),t=this.hasSlotController.test("help-text"),n=this.label?!0:!!e,r=this.helpText?!0:!!t;return he`
      <div
        part="form-control"
        class=${wr({"form-control":!0,"form-control--medium":!0,"form-control--has-label":n,"form-control--has-help-text":r})}
      >
        <label
          part="form-control-label"
          class="form-control__label"
          for="input"
          aria-hidden=${n?"false":"true"}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <div
            part="base"
            class=${wr({range:!0,"range--disabled":this.disabled,"range--focused":this.hasFocus,"range--rtl":this.localize.dir()==="rtl","range--tooltip-visible":this.hasTooltip,"range--tooltip-top":this.tooltip==="top","range--tooltip-bottom":this.tooltip==="bottom"})}
            @mousedown=${this.handleThumbDragStart}
            @mouseup=${this.handleThumbDragEnd}
            @touchstart=${this.handleThumbDragStart}
            @touchend=${this.handleThumbDragEnd}
          >
            <input
              part="input"
              id="input"
              class="range__control"
              title=${this.title}
              type="range"
              name=${Et(this.name)}
              ?disabled=${this.disabled}
              min=${Et(this.min)}
              max=${Et(this.max)}
              step=${Et(this.step)}
              .value=${bee(this.value.toString())}
              aria-describedby="help-text"
              @change=${this.handleChange}
              @focus=${this.handleFocus}
              @input=${this.handleInput}
              @invalid=${this.handleInvalid}
              @blur=${this.handleBlur}
            />
            ${this.tooltip!=="none"&&!this.disabled?he`
                  <output part="tooltip" class="range__tooltip">
                    ${typeof this.tooltipFormatter=="function"?this.tooltipFormatter(this.value):this.value}
                  </output>
                `:""}
          </div>
        </div>

        <slot
          name="help-text"
          part="form-control-help-text"
          id="help-text"
          class="form-control__help-text"
          aria-hidden=${r?"false":"true"}
        >
          ${this.helpText}
        </slot>
      </div>
    `}};Nr.styles=wQe;H([pt(".range__control")],Nr.prototype,"input",2);H([pt(".range__tooltip")],Nr.prototype,"output",2);H([Cr()],Nr.prototype,"hasFocus",2);H([Cr()],Nr.prototype,"hasTooltip",2);H([Q()],Nr.prototype,"title",2);H([Q()],Nr.prototype,"name",2);H([Q({type:Number})],Nr.prototype,"value",2);H([Q()],Nr.prototype,"label",2);H([Q({attribute:"help-text"})],Nr.prototype,"helpText",2);H([Q({type:Boolean,reflect:!0})],Nr.prototype,"disabled",2);H([Q({type:Number})],Nr.prototype,"min",2);H([Q({type:Number})],Nr.prototype,"max",2);H([Q({type:Number})],Nr.prototype,"step",2);H([Q()],Nr.prototype,"tooltip",2);H([Q({attribute:!1})],Nr.prototype,"tooltipFormatter",2);H([Q({reflect:!0})],Nr.prototype,"form",2);H([aB()],Nr.prototype,"defaultValue",2);H([yZe({passive:!0})],Nr.prototype,"handleThumbDragStart",1);H([Jt("value",{waitUntilFirstUpdate:!0})],Nr.prototype,"handleValueChange",1);H([Jt("disabled",{waitUntilFirstUpdate:!0})],Nr.prototype,"handleDisabledChange",1);H([Jt("hasTooltip",{waitUntilFirstUpdate:!0})],Nr.prototype,"syncRange",1);Nr=H([ze("sl-range")],Nr);function pC(e){return e.split("-")[1]}function xee(e){return e==="y"?"height":"width"}function I0(e){return e.split("-")[0]}function gC(e){return["top","bottom"].includes(I0(e))?"x":"y"}function Lde(e,t,n){let{reference:r,floating:i}=e;const s=r.x+r.width/2-i.width/2,a=r.y+r.height/2-i.height/2,o=gC(t),l=xee(o),u=r[l]/2-i[l]/2,c=I0(t),f=o==="x";let h;switch(c){case"top":h={x:s,y:r.y-i.height};break;case"bottom":h={x:s,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:a};break;case"left":h={x:r.x-i.width,y:a};break;default:h={x:r.x,y:r.y}}switch(pC(t)){case"start":h[o]-=u*(n&&f?-1:1);break;case"end":h[o]+=u*(n&&f?-1:1);break}return h}const $Qe=async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:a}=n,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let u=await a.getElementRects({reference:e,floating:t,strategy:i}),{x:c,y:f}=Lde(u,r,l),h=r,d={},p=0;for(let g=0;g<o.length;g++){const{name:m,fn:v}=o[g],{x:y,y:b,data:x,reset:w}=await v({x:c,y:f,initialPlacement:r,placement:h,strategy:i,middlewareData:d,rects:u,platform:a,elements:{reference:e,floating:t}});if(c=y!=null?y:c,f=b!=null?b:f,d={...d,[m]:{...d[m],...x}},w&&p<=50){p++,typeof w=="object"&&(w.placement&&(h=w.placement),w.rects&&(u=w.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:i}):w.rects),{x:c,y:f}=Lde(u,h,l)),g=-1;continue}}return{x:c,y:f,placement:h,strategy:i,middlewareData:d}};function mC(e,t){return typeof e=="function"?e(t):e}function CQe(e){return{top:0,right:0,bottom:0,left:0,...e}}function cke(e){return typeof e!="number"?CQe(e):{top:e,right:e,bottom:e,left:e}}function a5(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function wee(e,t){var n;t===void 0&&(t={});const{x:r,y:i,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:f="floating",altBoundary:h=!1,padding:d=0}=mC(t,e),p=cke(d),m=o[h?f==="floating"?"reference":"floating":f],v=a5(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(m)))==null||n?m:m.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:u,rootBoundary:c,strategy:l})),y=f==="floating"?{...a.floating,x:r,y:i}:a.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),x=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},w=a5(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:y,offsetParent:b,strategy:l}):y);return{top:(v.top-w.top+p.top)/x.y,bottom:(w.bottom-v.bottom+p.bottom)/x.y,left:(v.left-w.left+p.left)/x.x,right:(w.right-v.right+p.right)/x.x}}const JA=Math.min,jv=Math.max;function sY(e,t,n){return jv(e,JA(t,n))}const _Qe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:i,rects:s,platform:a,elements:o}=t,{element:l,padding:u=0}=mC(e,t)||{};if(l==null)return{};const c=cke(u),f={x:n,y:r},h=gC(i),d=xee(h),p=await a.getDimensions(l),g=h==="y",m=g?"top":"left",v=g?"bottom":"right",y=g?"clientHeight":"clientWidth",b=s.reference[d]+s.reference[h]-f[h]-s.floating[d],x=f[h]-s.reference[h],w=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l));let C=w?w[y]:0;(!C||!await(a.isElement==null?void 0:a.isElement(w)))&&(C=o.floating[y]||s.floating[d]);const $=b/2-x/2,_=C/2-p[d]/2-1,k=JA(c[m],_),E=JA(c[v],_),S=k,N=C-p[d]-E,A=C/2-p[d]/2+$,D=sY(S,A,N),I=pC(i)!=null&&A!=D&&s.reference[d]/2-(A<S?k:E)-p[d]/2<0?A<S?S-A:N-A:0;return{[h]:f[h]-I,data:{[h]:D,centerOffset:A-D+I}}}}),SQe={left:"right",right:"left",bottom:"top",top:"bottom"};function o5(e){return e.replace(/left|right|bottom|top/g,t=>SQe[t])}function kQe(e,t,n){n===void 0&&(n=!1);const r=pC(e),i=gC(e),s=xee(i);let a=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=o5(a)),{main:a,cross:o5(a)}}const EQe={start:"end",end:"start"};function aY(e){return e.replace(/start|end/g,t=>EQe[t])}function AQe(e){const t=o5(e);return[aY(e),t,aY(t)]}function TQe(e,t,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?s:a;default:return[]}}function DQe(e,t,n,r){const i=pC(e);let s=TQe(I0(e),n==="start",r);return i&&(s=s.map(a=>a+"-"+i),t&&(s=s.concat(s.map(aY)))),s}const NQe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n;const{placement:r,middlewareData:i,rects:s,initialPlacement:a,platform:o,elements:l}=t,{mainAxis:u=!0,crossAxis:c=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:d="none",flipAlignment:p=!0,...g}=mC(e,t),m=I0(r),v=I0(a)===a,y=await(o.isRTL==null?void 0:o.isRTL(l.floating)),b=f||(v||!p?[o5(a)]:AQe(a));!f&&d!=="none"&&b.push(...DQe(a,p,d,y));const x=[a,...b],w=await wee(t,g),C=[];let $=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&C.push(w[m]),c){const{main:S,cross:N}=kQe(r,s,y);C.push(w[S],w[N])}if($=[...$,{placement:r,overflows:C}],!C.every(S=>S<=0)){var _,k;const S=(((_=i.flip)==null?void 0:_.index)||0)+1,N=x[S];if(N)return{data:{index:S,overflows:$},reset:{placement:N}};let A=(k=$.filter(D=>D.overflows[0]<=0).sort((D,T)=>D.overflows[1]-T.overflows[1])[0])==null?void 0:k.placement;if(!A)switch(h){case"bestFit":{var E;const D=(E=$.map(T=>[T.placement,T.overflows.filter(I=>I>0).reduce((I,F)=>I+F,0)]).sort((T,I)=>T[1]-I[1])[0])==null?void 0:E[0];D&&(A=D);break}case"initialPlacement":A=a;break}if(r!==A)return{reset:{placement:A}}}return{}}}};async function IQe(e,t){const{placement:n,platform:r,elements:i}=e,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=I0(n),o=pC(n),l=gC(n)==="x",u=["left","top"].includes(a)?-1:1,c=s&&l?-1:1,f=mC(t,e);let{mainAxis:h,crossAxis:d,alignmentAxis:p}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...f};return o&&typeof p=="number"&&(d=o==="end"?p*-1:p),l?{x:d*c,y:h*u}:{x:h*u,y:d*c}}const MQe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){const{x:n,y:r}=t,i=await IQe(t,e);return{x:n+i.x,y:r+i.y,data:i}}}};function FQe(e){return e==="x"?"y":"x"}const OQe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:m=>{let{x:v,y}=m;return{x:v,y}}},...l}=mC(e,t),u={x:n,y:r},c=await wee(t,l),f=gC(I0(i)),h=FQe(f);let d=u[f],p=u[h];if(s){const m=f==="y"?"top":"left",v=f==="y"?"bottom":"right",y=d+c[m],b=d-c[v];d=sY(y,d,b)}if(a){const m=h==="y"?"top":"left",v=h==="y"?"bottom":"right",y=p+c[m],b=p-c[v];p=sY(y,p,b)}const g=o.fn({...t,[f]:d,[h]:p});return{...g,data:{x:g.x-n,y:g.y-r}}}}},Bde=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:i,elements:s}=t,{apply:a=()=>{},...o}=mC(e,t),l=await wee(t,o),u=I0(n),c=pC(n),h=gC(n)==="x",{width:d,height:p}=r.floating;let g,m;u==="top"||u==="bottom"?(g=u,m=c===(await(i.isRTL==null?void 0:i.isRTL(s.floating))?"start":"end")?"left":"right"):(m=u,g=c==="end"?"top":"bottom");const v=p-l[g],y=d-l[m],b=!t.middlewareData.shift;let x=v,w=y;if(h){const $=d-l.left-l.right;w=c||b?JA(y,$):$}else{const $=p-l.top-l.bottom;x=c||b?JA(v,$):$}if(b&&!c){const $=jv(l.left,0),_=jv(l.right,0),k=jv(l.top,0),E=jv(l.bottom,0);h?w=d-2*($!==0||_!==0?$+_:jv(l.left,l.right)):x=p-2*(k!==0||E!==0?k+E:jv(l.top,l.bottom))}await a({...t,availableWidth:w,availableHeight:x});const C=await i.getDimensions(s.floating);return d!==C.width||p!==C.height?{reset:{rects:!0}}:{}}}};function Ol(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Eh(e){return Ol(e).getComputedStyle(e)}function fke(e){return e instanceof Ol(e).Node}function M0(e){return fke(e)?(e.nodeName||"").toLowerCase():"#document"}function Xc(e){return e instanceof Ol(e).HTMLElement}function zde(e){return typeof ShadowRoot>"u"?!1:e instanceof Ol(e).ShadowRoot||e instanceof ShadowRoot}function sN(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=Eh(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function RQe(e){return["table","td","th"].includes(M0(e))}function $ee(e){const t=Cee(),n=Eh(e);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Cee(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function lB(e){return["html","body","#document"].includes(M0(e))}const oY=Math.min,z2=Math.max,l5=Math.round,jF=Math.floor,F0=e=>({x:e,y:e});function hke(e){const t=Eh(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=Xc(e),s=i?e.offsetWidth:n,a=i?e.offsetHeight:r,o=l5(n)!==s||l5(r)!==a;return o&&(n=s,r=a),{width:n,height:r,$:o}}function Ep(e){return e instanceof Ol(e).Element}function _ee(e){return Ep(e)?e:e.contextElement}function U2(e){const t=_ee(e);if(!Xc(t))return F0(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:s}=hke(t);let a=(s?l5(n.width):n.width)/r,o=(s?l5(n.height):n.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const PQe=F0(0);function dke(e){const t=Ol(e);return!Cee()||!t.visualViewport?PQe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function LQe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Ol(e)?!1:t}function Cy(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),s=_ee(e);let a=F0(1);t&&(r?Ep(r)&&(a=U2(r)):a=U2(e));const o=LQe(s,n,r)?dke(s):F0(0);let l=(i.left+o.x)/a.x,u=(i.top+o.y)/a.y,c=i.width/a.x,f=i.height/a.y;if(s){const h=Ol(s),d=r&&Ep(r)?Ol(r):r;let p=h.frameElement;for(;p&&r&&d!==h;){const g=U2(p),m=p.getBoundingClientRect(),v=getComputedStyle(p),y=m.left+(p.clientLeft+parseFloat(v.paddingLeft))*g.x,b=m.top+(p.clientTop+parseFloat(v.paddingTop))*g.y;l*=g.x,u*=g.y,c*=g.x,f*=g.y,l+=y,u+=b,p=Ol(p).frameElement}}return a5({width:c,height:f,x:l,y:u})}function uB(e){return Ep(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Kp(e){return((fke(e)?e.ownerDocument:e.document)||window.document).documentElement}function BQe(e){let{rect:t,offsetParent:n,strategy:r}=e;const i=Xc(n),s=Kp(n);if(n===s)return t;let a={scrollLeft:0,scrollTop:0},o=F0(1);const l=F0(0);if((i||!i&&r!=="fixed")&&((M0(n)!=="body"||sN(s))&&(a=uB(n)),Xc(n))){const u=Cy(n);o=U2(n),l.x=u.x+n.clientLeft,l.y=u.y+n.clientTop}return{width:t.width*o.x,height:t.height*o.y,x:t.x*o.x-a.scrollLeft*o.x+l.x,y:t.y*o.y-a.scrollTop*o.y+l.y}}function zQe(e){return Array.from(e.getClientRects())}function pke(e){return Cy(Kp(e)).left+uB(e).scrollLeft}function UQe(e){const t=Kp(e),n=uB(e),r=e.ownerDocument.body,i=z2(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=z2(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+pke(e);const o=-n.scrollTop;return Eh(r).direction==="rtl"&&(a+=z2(t.clientWidth,r.clientWidth)-i),{width:i,height:s,x:a,y:o}}function Sw(e){if(M0(e)==="html")return e;const t=e.assignedSlot||e.parentNode||zde(e)&&e.host||Kp(e);return zde(t)?t.host:t}function gke(e){const t=Sw(e);return lB(t)?e.ownerDocument?e.ownerDocument.body:e.body:Xc(t)&&sN(t)?t:gke(t)}function u5(e,t){var n;t===void 0&&(t=[]);const r=gke(e),i=r===((n=e.ownerDocument)==null?void 0:n.body),s=Ol(r);return i?t.concat(s,s.visualViewport||[],sN(r)?r:[]):t.concat(r,u5(r))}function WQe(e,t){const n=Ol(e),r=Kp(e),i=n.visualViewport;let s=r.clientWidth,a=r.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;const u=Cee();(!u||u&&t==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:s,height:a,x:o,y:l}}function VQe(e,t){const n=Cy(e,!0,t==="fixed"),r=n.top+e.clientTop,i=n.left+e.clientLeft,s=Xc(e)?U2(e):F0(1),a=e.clientWidth*s.x,o=e.clientHeight*s.y,l=i*s.x,u=r*s.y;return{width:a,height:o,x:l,y:u}}function Ude(e,t,n){let r;if(t==="viewport")r=WQe(e,n);else if(t==="document")r=UQe(Kp(e));else if(Ep(t))r=VQe(t,n);else{const i=dke(e);r={...t,x:t.x-i.x,y:t.y-i.y}}return a5(r)}function mke(e,t){const n=Sw(e);return n===t||!Ep(n)||lB(n)?!1:Eh(n).position==="fixed"||mke(n,t)}function jQe(e,t){const n=t.get(e);if(n)return n;let r=u5(e).filter(o=>Ep(o)&&M0(o)!=="body"),i=null;const s=Eh(e).position==="fixed";let a=s?Sw(e):e;for(;Ep(a)&&!lB(a);){const o=Eh(a),l=$ee(a);!l&&o.position==="fixed"&&(i=null),(s?!l&&!i:!l&&o.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||sN(a)&&!l&&mke(e,a))?r=r.filter(c=>c!==a):i=o,a=Sw(a)}return t.set(e,r),r}function HQe(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const a=[...n==="clippingAncestors"?jQe(t,this._c):[].concat(n),r],o=a[0],l=a.reduce((u,c)=>{const f=Ude(t,c,i);return u.top=z2(f.top,u.top),u.right=oY(f.right,u.right),u.bottom=oY(f.bottom,u.bottom),u.left=z2(f.left,u.left),u},Ude(t,o,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function qQe(e){return hke(e)}function GQe(e,t,n){const r=Xc(t),i=Kp(t),s=n==="fixed",a=Cy(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=F0(0);if(r||!r&&!s)if((M0(t)!=="body"||sN(i))&&(o=uB(t)),Xc(t)){const u=Cy(t,!0,s,t);l.x=u.x+t.clientLeft,l.y=u.y+t.clientTop}else i&&(l.x=pke(i));return{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}function Wde(e,t){return!Xc(e)||Eh(e).position==="fixed"?null:t?t(e):e.offsetParent}function YQe(e){let t=Sw(e);for(;Xc(t)&&!lB(t);){if($ee(t))return t;t=Sw(t)}return null}function vke(e,t){const n=Ol(e);if(!Xc(e))return n;let r=Wde(e,t);for(;r&&RQe(r)&&Eh(r).position==="static";)r=Wde(r,t);return r&&(M0(r)==="html"||M0(r)==="body"&&Eh(r).position==="static"&&!$ee(r))?n:r||YQe(e)||n}const XQe=async function(e){let{reference:t,floating:n,strategy:r}=e;const i=this.getOffsetParent||vke,s=this.getDimensions;return{reference:GQe(t,await i(n),r),floating:{x:0,y:0,...await s(n)}}};function KQe(e){return getComputedStyle(e).direction==="rtl"}const KR={convertOffsetParentRelativeRectToViewportRelativeRect:BQe,getDocumentElement:Kp,getClippingRect:HQe,getOffsetParent:vke,getElementRects:XQe,getClientRects:zQe,getDimensions:qQe,getScale:U2,isElement:Ep,isRTL:KQe};function ZQe(e,t){let n=null,r;const i=Kp(e);function s(){clearTimeout(r),n&&n.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const{left:u,top:c,width:f,height:h}=e.getBoundingClientRect();if(o||t(),!f||!h)return;const d=jF(c),p=jF(i.clientWidth-(u+f)),g=jF(i.clientHeight-(c+h)),m=jF(u),y={rootMargin:-d+"px "+-p+"px "+-g+"px "+-m+"px",threshold:z2(0,oY(1,l))||1};let b=!0;function x(w){const C=w[0].intersectionRatio;if(C!==l){if(!b)return a();C?a(!1,C):r=setTimeout(()=>{a(!1,1e-7)},100)}b=!1}try{n=new IntersectionObserver(x,{...y,root:i.ownerDocument})}catch{n=new IntersectionObserver(x,y)}n.observe(e)}return a(!0),s}function QQe(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,u=_ee(e),c=i||s?[...u?u5(u):[],...u5(t)]:[];c.forEach(v=>{i&&v.addEventListener("scroll",n,{passive:!0}),s&&v.addEventListener("resize",n)});const f=u&&o?ZQe(u,n):null;let h=-1,d=null;a&&(d=new ResizeObserver(v=>{let[y]=v;y&&y.target===u&&d&&(d.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{d&&d.observe(t)})),n()}),u&&!l&&d.observe(u),d.observe(t));let p,g=l?Cy(e):null;l&&m();function m(){const v=Cy(e);g&&(v.x!==g.x||v.y!==g.y||v.width!==g.width||v.height!==g.height)&&n(),g=v,p=requestAnimationFrame(m)}return n(),()=>{c.forEach(v=>{i&&v.removeEventListener("scroll",n),s&&v.removeEventListener("resize",n)}),f&&f(),d&&d.disconnect(),d=null,l&&cancelAnimationFrame(p)}}const JQe=(e,t,n)=>{const r=new Map,i={platform:KR,...n},s={...i.platform,_c:r};return $Qe(e,t,{...i,platform:s})};function eJe(e){return tJe(e)}function YV(e){return e.assignedSlot?e.assignedSlot:e.parentNode instanceof ShadowRoot?e.parentNode.host:e.parentNode}function tJe(e){for(let t=e;t;t=YV(t))if(t instanceof Element&&getComputedStyle(t).display==="none")return null;for(let t=YV(e);t;t=YV(t)){if(!(t instanceof Element))continue;const n=getComputedStyle(t);if(n.display!=="contents"&&(n.position!=="static"||n.filter!=="none"||t.tagName==="BODY"))return t}return null}var nJe=Xt`
  ${_r}

  :host {
    --arrow-color: var(--sl-color-neutral-1000);
    --arrow-size: 6px;

    /*
     * These properties are computed to account for the arrow's dimensions after being rotated 45º. The constant
     * 0.7071 is derived from sin(45), which is the diagonal size of the arrow's container after rotating.
     */
    --arrow-size-diagonal: calc(var(--arrow-size) * 0.7071);
    --arrow-padding-offset: calc(var(--arrow-size-diagonal) - var(--arrow-size));

    display: contents;
  }

  .popup {
    position: absolute;
    isolation: isolate;
    max-width: var(--auto-size-available-width, none);
    max-height: var(--auto-size-available-height, none);
  }

  .popup--fixed {
    position: fixed;
  }

  .popup:not(.popup--active) {
    display: none;
  }

  .popup__arrow {
    position: absolute;
    width: calc(var(--arrow-size-diagonal) * 2);
    height: calc(var(--arrow-size-diagonal) * 2);
    rotate: 45deg;
    background: var(--arrow-color);
    z-index: -1;
  }
`;let cr=class extends Xn{constructor(){super(...arguments),this.active=!1,this.placement="top",this.strategy="absolute",this.distance=0,this.skidding=0,this.arrow=!1,this.arrowPlacement="anchor",this.arrowPadding=10,this.flip=!1,this.flipFallbackPlacements="",this.flipFallbackStrategy="best-fit",this.flipPadding=0,this.shift=!1,this.shiftPadding=0,this.autoSizePadding=0}async connectedCallback(){super.connectedCallback(),await this.updateComplete,this.start()}disconnectedCallback(){this.stop()}async updated(e){super.updated(e),e.has("active")&&(this.active?this.start():this.stop()),e.has("anchor")&&this.handleAnchorChange(),this.active&&(await this.updateComplete,this.reposition())}async handleAnchorChange(){if(await this.stop(),this.anchor&&typeof this.anchor=="string"){const e=this.getRootNode();this.anchorEl=e.getElementById(this.anchor)}else this.anchor instanceof Element?this.anchorEl=this.anchor:this.anchorEl=this.querySelector('[slot="anchor"]');if(this.anchorEl instanceof HTMLSlotElement&&(this.anchorEl=this.anchorEl.assignedElements({flatten:!0})[0]),!this.anchorEl)throw new Error("Invalid anchor element: no anchor could be found using the anchor slot or the anchor attribute.");this.start()}start(){!this.anchorEl||(this.cleanup=QQe(this.anchorEl,this.popup,()=>{this.reposition()}))}async stop(){return new Promise(e=>{this.cleanup?(this.cleanup(),this.cleanup=void 0,this.removeAttribute("data-current-placement"),this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height"),requestAnimationFrame(()=>e())):e()})}reposition(){if(!this.active||!this.anchorEl)return;const e=[MQe({mainAxis:this.distance,crossAxis:this.skidding})];this.sync?e.push(Bde({apply:({rects:n})=>{const r=this.sync==="width"||this.sync==="both",i=this.sync==="height"||this.sync==="both";this.popup.style.width=r?`${n.reference.width}px`:"",this.popup.style.height=i?`${n.reference.height}px`:""}})):(this.popup.style.width="",this.popup.style.height=""),this.flip&&e.push(NQe({boundary:this.flipBoundary,fallbackPlacements:this.flipFallbackPlacements,fallbackStrategy:this.flipFallbackStrategy==="best-fit"?"bestFit":"initialPlacement",padding:this.flipPadding})),this.shift&&e.push(OQe({boundary:this.shiftBoundary,padding:this.shiftPadding})),this.autoSize?e.push(Bde({boundary:this.autoSizeBoundary,padding:this.autoSizePadding,apply:({availableWidth:n,availableHeight:r})=>{this.autoSize==="vertical"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-height",`${r}px`):this.style.removeProperty("--auto-size-available-height"),this.autoSize==="horizontal"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-width",`${n}px`):this.style.removeProperty("--auto-size-available-width")}})):(this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height")),this.arrow&&e.push(_Qe({element:this.arrowEl,padding:this.arrowPadding}));const t=this.strategy==="absolute"?n=>KR.getOffsetParent(n,eJe):KR.getOffsetParent;JQe(this.anchorEl,this.popup,{placement:this.placement,middleware:e,strategy:this.strategy,platform:gZe(GSe({},KR),{getOffsetParent:t})}).then(({x:n,y:r,middlewareData:i,placement:s})=>{const a=getComputedStyle(this).direction==="rtl",o={top:"bottom",right:"left",bottom:"top",left:"right"}[s.split("-")[0]];if(this.setAttribute("data-current-placement",s),Object.assign(this.popup.style,{left:`${n}px`,top:`${r}px`}),this.arrow){const l=i.arrow.x,u=i.arrow.y;let c="",f="",h="",d="";if(this.arrowPlacement==="start"){const p=typeof l=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";c=typeof u=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"",f=a?p:"",d=a?"":p}else if(this.arrowPlacement==="end"){const p=typeof l=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";f=a?"":p,d=a?p:"",h=typeof u=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:""}else this.arrowPlacement==="center"?(d=typeof l=="number"?"calc(50% - var(--arrow-size-diagonal))":"",c=typeof u=="number"?"calc(50% - var(--arrow-size-diagonal))":""):(d=typeof l=="number"?`${l}px`:"",c=typeof u=="number"?`${u}px`:"");Object.assign(this.arrowEl.style,{top:c,right:f,bottom:h,left:d,[o]:"calc(var(--arrow-size-diagonal) * -1)"})}}),this.emit("sl-reposition")}render(){return he`
      <slot name="anchor" @slotchange=${this.handleAnchorChange}></slot>

      <div
        part="popup"
        class=${wr({popup:!0,"popup--active":this.active,"popup--fixed":this.strategy==="fixed","popup--has-arrow":this.arrow})}
      >
        <slot></slot>
        ${this.arrow?he`<div part="arrow" class="popup__arrow" role="presentation"></div>`:""}
      </div>
    `}};cr.styles=nJe;H([pt(".popup")],cr.prototype,"popup",2);H([pt(".popup__arrow")],cr.prototype,"arrowEl",2);H([Q()],cr.prototype,"anchor",2);H([Q({type:Boolean,reflect:!0})],cr.prototype,"active",2);H([Q({reflect:!0})],cr.prototype,"placement",2);H([Q({reflect:!0})],cr.prototype,"strategy",2);H([Q({type:Number})],cr.prototype,"distance",2);H([Q({type:Number})],cr.prototype,"skidding",2);H([Q({type:Boolean})],cr.prototype,"arrow",2);H([Q({attribute:"arrow-placement"})],cr.prototype,"arrowPlacement",2);H([Q({attribute:"arrow-padding",type:Number})],cr.prototype,"arrowPadding",2);H([Q({type:Boolean})],cr.prototype,"flip",2);H([Q({attribute:"flip-fallback-placements",converter:{fromAttribute:e=>e.split(" ").map(t=>t.trim()).filter(t=>t!==""),toAttribute:e=>e.join(" ")}})],cr.prototype,"flipFallbackPlacements",2);H([Q({attribute:"flip-fallback-strategy"})],cr.prototype,"flipFallbackStrategy",2);H([Q({type:Object})],cr.prototype,"flipBoundary",2);H([Q({attribute:"flip-padding",type:Number})],cr.prototype,"flipPadding",2);H([Q({type:Boolean})],cr.prototype,"shift",2);H([Q({type:Object})],cr.prototype,"shiftBoundary",2);H([Q({attribute:"shift-padding",type:Number})],cr.prototype,"shiftPadding",2);H([Q({attribute:"auto-size"})],cr.prototype,"autoSize",2);H([Q()],cr.prototype,"sync",2);H([Q({type:Object})],cr.prototype,"autoSizeBoundary",2);H([Q({attribute:"auto-size-padding",type:Number})],cr.prototype,"autoSizePadding",2);cr=H([ze("sl-popup")],cr);var rJe=Xt`
  ${_r}

  :host {
    display: inline-block;
  }

  .tag {
    display: flex;
    align-items: center;
    border: solid 1px;
    line-height: 1;
    white-space: nowrap;
    user-select: none;
  }

  .tag__remove::part(base) {
    color: inherit;
    padding: 0;
  }

  /*
   * Variant modifiers
   */

  .tag--primary {
    background-color: var(--sl-color-primary-50);
    border-color: var(--sl-color-primary-200);
    color: var(--sl-color-primary-800);
  }

  .tag--primary:active > sl-icon-button {
    color: var(--sl-color-primary-600);
  }

  .tag--success {
    background-color: var(--sl-color-success-50);
    border-color: var(--sl-color-success-200);
    color: var(--sl-color-success-800);
  }

  .tag--success:active > sl-icon-button {
    color: var(--sl-color-success-600);
  }

  .tag--neutral {
    background-color: var(--sl-color-neutral-50);
    border-color: var(--sl-color-neutral-200);
    color: var(--sl-color-neutral-800);
  }

  .tag--neutral:active > sl-icon-button {
    color: var(--sl-color-neutral-600);
  }

  .tag--warning {
    background-color: var(--sl-color-warning-50);
    border-color: var(--sl-color-warning-200);
    color: var(--sl-color-warning-800);
  }

  .tag--warning:active > sl-icon-button {
    color: var(--sl-color-warning-600);
  }

  .tag--danger {
    background-color: var(--sl-color-danger-50);
    border-color: var(--sl-color-danger-200);
    color: var(--sl-color-danger-800);
  }

  .tag--danger:active > sl-icon-button {
    color: var(--sl-color-danger-600);
  }

  /*
   * Size modifiers
   */

  .tag--small {
    font-size: var(--sl-button-font-size-small);
    height: calc(var(--sl-input-height-small) * 0.8);
    line-height: calc(var(--sl-input-height-small) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-small);
    padding: 0 var(--sl-spacing-x-small);
  }

  .tag--medium {
    font-size: var(--sl-button-font-size-medium);
    height: calc(var(--sl-input-height-medium) * 0.8);
    line-height: calc(var(--sl-input-height-medium) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-medium);
    padding: 0 var(--sl-spacing-small);
  }

  .tag--large {
    font-size: var(--sl-button-font-size-large);
    height: calc(var(--sl-input-height-large) * 0.8);
    line-height: calc(var(--sl-input-height-large) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-large);
    padding: 0 var(--sl-spacing-medium);
  }

  .tag__remove {
    margin-inline-start: var(--sl-spacing-x-small);
  }

  /*
   * Pill modifier
   */

  .tag--pill {
    border-radius: var(--sl-border-radius-pill);
  }
`;let _y=class extends Xn{constructor(){super(...arguments),this.localize=new Ra(this),this.variant="neutral",this.size="medium",this.pill=!1,this.removable=!1}handleRemoveClick(){this.emit("sl-remove")}render(){return he`
      <span
        part="base"
        class=${wr({tag:!0,"tag--primary":this.variant==="primary","tag--success":this.variant==="success","tag--neutral":this.variant==="neutral","tag--warning":this.variant==="warning","tag--danger":this.variant==="danger","tag--text":this.variant==="text","tag--small":this.size==="small","tag--medium":this.size==="medium","tag--large":this.size==="large","tag--pill":this.pill,"tag--removable":this.removable})}
      >
        <slot part="content" class="tag__content"></slot>

        ${this.removable?he`
              <sl-icon-button
                part="remove-button"
                exportparts="base:remove-button__base"
                name="x-lg"
                library="system"
                label=${this.localize.term("remove")}
                class="tag__remove"
                @click=${this.handleRemoveClick}
                tabindex="-1"
              ></sl-icon-button>
            `:""}
      </span>
    `}};_y.styles=rJe;H([Q({reflect:!0})],_y.prototype,"variant",2);H([Q({reflect:!0})],_y.prototype,"size",2);H([Q({type:Boolean,reflect:!0})],_y.prototype,"pill",2);H([Q({type:Boolean})],_y.prototype,"removable",2);_y=H([ze("sl-tag")],_y);var iJe=Xt`
  ${_r}
  ${oB}

  :host {
    display: block;
  }

  /** The popup */
  .select {
    flex: 1 1 auto;
    display: inline-flex;
    width: 100%;
    position: relative;
    vertical-align: middle;
  }

  .select::part(popup) {
    z-index: var(--sl-z-index-dropdown);
  }

  .select[data-current-placement^='top']::part(popup) {
    transform-origin: bottom;
  }

  .select[data-current-placement^='bottom']::part(popup) {
    transform-origin: top;
  }

  /* Combobox */
  .select__combobox {
    flex: 1;
    display: flex;
    width: 100%;
    min-width: 0;
    position: relative;
    align-items: center;
    justify-content: start;
    font-family: var(--sl-input-font-family);
    font-weight: var(--sl-input-font-weight);
    letter-spacing: var(--sl-input-letter-spacing);
    vertical-align: middle;
    overflow: hidden;
    cursor: pointer;
    transition: var(--sl-transition-fast) color, var(--sl-transition-fast) border, var(--sl-transition-fast) box-shadow,
      var(--sl-transition-fast) background-color;
  }

  .select__display-input {
    position: relative;
    width: 100%;
    font: inherit;
    border: none;
    background: none;
    color: var(--sl-input-color);
    cursor: inherit;
    overflow: hidden;
    padding: 0;
    margin: 0;
    -webkit-appearance: none;
  }

  .select:not(.select--disabled):hover .select__display-input {
    color: var(--sl-input-color-hover);
  }

  .select__display-input:focus {
    outline: none;
  }

  /* Visually hide the display input when multiple is enabled */
  .select--multiple:not(.select--placeholder-visible) .select__display-input {
    position: absolute;
    z-index: -1;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
  }

  .select__value-input {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
    opacity: 0;
    z-index: -1;
  }

  .select__tags {
    display: flex;
    flex: 1;
    align-items: center;
    flex-wrap: wrap;
    margin-inline-start: var(--sl-spacing-2x-small);
  }

  .select__tags::slotted(sl-tag) {
    cursor: pointer !important;
  }

  .select--disabled .select__tags,
  .select--disabled .select__tags::slotted(sl-tag) {
    cursor: not-allowed !important;
  }

  /* Standard selects */
  .select--standard .select__combobox {
    background-color: var(--sl-input-background-color);
    border: solid var(--sl-input-border-width) var(--sl-input-border-color);
  }

  .select--standard.select--disabled .select__combobox {
    background-color: var(--sl-input-background-color-disabled);
    border-color: var(--sl-input-border-color-disabled);
    color: var(--sl-input-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
    outline: none;
  }

  .select--standard:not(.select--disabled).select--open .select__combobox,
  .select--standard:not(.select--disabled).select--focused .select__combobox {
    background-color: var(--sl-input-background-color-focus);
    border-color: var(--sl-input-border-color-focus);
    box-shadow: 0 0 0 var(--sl-focus-ring-width) var(--sl-input-focus-ring-color);
  }

  /* Filled selects */
  .select--filled .select__combobox {
    border: none;
    background-color: var(--sl-input-filled-background-color);
    color: var(--sl-input-color);
  }

  .select--filled:hover:not(.select--disabled) .select__combobox {
    background-color: var(--sl-input-filled-background-color-hover);
  }

  .select--filled.select--disabled .select__combobox {
    background-color: var(--sl-input-filled-background-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
  }

  .select--filled:not(.select--disabled).select--open .select__combobox,
  .select--filled:not(.select--disabled).select--focused .select__combobox {
    background-color: var(--sl-input-filled-background-color-focus);
    outline: var(--sl-focus-ring);
  }

  /* Sizes */
  .select--small .select__combobox {
    border-radius: var(--sl-input-border-radius-small);
    font-size: var(--sl-input-font-size-small);
    min-height: var(--sl-input-height-small);
    padding-block: 0;
    padding-inline: var(--sl-input-spacing-small);
  }

  .select--small .select__clear {
    margin-inline-start: var(--sl-input-spacing-small);
  }

  .select--small .select__prefix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-small);
  }

  .select--small.select--multiple:not(.select--placeholder-visible) .select__combobox {
    padding-block: 2px;
    padding-inline-start: 0;
  }

  .select--small .select__tags {
    gap: 2px;
  }

  .select--medium .select__combobox {
    border-radius: var(--sl-input-border-radius-medium);
    font-size: var(--sl-input-font-size-medium);
    min-height: var(--sl-input-height-medium);
    padding-block: 0;
    padding-inline: var(--sl-input-spacing-medium);
  }

  .select--medium .select__clear {
    margin-inline-start: var(--sl-input-spacing-medium);
  }

  .select--medium .select__prefix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-medium);
  }

  .select--medium.select--multiple:not(.select--placeholder-visible) .select__combobox {
    padding-inline-start: 0;
    padding-block: 3px;
  }

  .select--medium .select__tags {
    gap: 3px;
  }

  .select--large .select__combobox {
    border-radius: var(--sl-input-border-radius-large);
    font-size: var(--sl-input-font-size-large);
    min-height: var(--sl-input-height-large);
    padding-block: 0;
    padding-inline: var(--sl-input-spacing-large);
  }

  .select--large .select__clear {
    margin-inline-start: var(--sl-input-spacing-large);
  }

  .select--large .select__prefix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-large);
  }

  .select--large.select--multiple:not(.select--placeholder-visible) .select__combobox {
    padding-inline-start: 0;
    padding-block: 4px;
  }

  .select--large .select__tags {
    gap: 4px;
  }

  /* Pills */
  .select--pill.select--small .select__combobox {
    border-radius: var(--sl-input-height-small);
  }

  .select--pill.select--medium .select__combobox {
    border-radius: var(--sl-input-height-medium);
  }

  .select--pill.select--large .select__combobox {
    border-radius: var(--sl-input-height-large);
  }

  /* Prefix */
  .select__prefix {
    flex: 0;
    display: inline-flex;
    align-items: center;
    color: var(--sl-input-placeholder-color);
  }

  /* Clear button */
  .select__clear {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: inherit;
    color: var(--sl-input-icon-color);
    border: none;
    background: none;
    padding: 0;
    transition: var(--sl-transition-fast) color;
    cursor: pointer;
  }

  .select__clear:hover {
    color: var(--sl-input-icon-color-hover);
  }

  .select__clear:focus {
    outline: none;
  }

  /* Expand icon */
  .select__expand-icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    transition: var(--sl-transition-medium) rotate ease;
    rotate: 0;
    margin-inline-start: var(--sl-spacing-small);
  }

  .select--open .select__expand-icon {
    rotate: -180deg;
  }

  /* Listbox */
  .select__listbox {
    display: block;
    position: relative;
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-medium);
    font-weight: var(--sl-font-weight-normal);
    box-shadow: var(--sl-shadow-large);
    background: var(--sl-panel-background-color);
    border: solid var(--sl-panel-border-width) var(--sl-panel-border-color);
    border-radius: var(--sl-border-radius-medium);
    padding-block: var(--sl-spacing-x-small);
    padding-inline: 0;
    overflow: auto;
    overscroll-behavior: none;

    /* Make sure it adheres to the popup's auto size */
    max-width: var(--auto-size-available-width);
    max-height: var(--auto-size-available-height);
  }

  .select__listbox ::slotted(sl-divider) {
    --spacing: var(--sl-spacing-x-small);
  }

  .select__listbox ::slotted(small) {
    font-size: var(--sl-font-size-small);
    font-weight: var(--sl-font-weight-semibold);
    color: var(--sl-color-neutral-500);
    padding-block: var(--sl-spacing-x-small);
    padding-inline: var(--sl-spacing-x-large);
  }
`;let mn=class extends Xn{constructor(){super(...arguments),this.formControlController=new dC(this,{assumeInteractionOn:["sl-blur","sl-input"]}),this.hasSlotController=new td(this,"help-text","label"),this.localize=new Ra(this),this.typeToSelectString="",this.hasFocus=!1,this.displayLabel="",this.selectedOptions=[],this.name="",this.value="",this.defaultValue="",this.size="medium",this.placeholder="",this.multiple=!1,this.maxOptionsVisible=3,this.disabled=!1,this.clearable=!1,this.open=!1,this.hoist=!1,this.filled=!1,this.pill=!1,this.label="",this.placement="bottom",this.helpText="",this.form="",this.required=!1,this.handleDocumentFocusIn=e=>{const t=e.composedPath();this&&!t.includes(this)&&this.hide()},this.handleDocumentKeyDown=e=>{const t=e.target,n=t.closest(".select__clear")!==null,r=t.closest("sl-icon-button")!==null;if(!(n||r)){if(e.key==="Escape"&&this.open&&(e.preventDefault(),e.stopPropagation(),this.hide(),this.displayInput.focus({preventScroll:!0})),e.key==="Enter"||e.key===" "&&this.typeToSelectString===""){if(e.preventDefault(),e.stopImmediatePropagation(),!this.open){this.show();return}this.currentOption&&!this.currentOption.disabled&&(this.multiple?this.toggleOptionSelection(this.currentOption):this.setSelectedOptions(this.currentOption),this.updateComplete.then(()=>{this.emit("sl-input"),this.emit("sl-change")}),this.multiple||(this.hide(),this.displayInput.focus({preventScroll:!0})));return}if(["ArrowUp","ArrowDown","Home","End"].includes(e.key)){const i=this.getAllOptions(),s=i.indexOf(this.currentOption);let a=Math.max(0,s);if(e.preventDefault(),!this.open&&(this.show(),this.currentOption))return;e.key==="ArrowDown"?(a=s+1,a>i.length-1&&(a=0)):e.key==="ArrowUp"?(a=s-1,a<0&&(a=i.length-1)):e.key==="Home"?a=0:e.key==="End"&&(a=i.length-1),this.setCurrentOption(i[a])}if(e.key.length===1||e.key==="Backspace"){const i=this.getAllOptions();if(e.metaKey||e.ctrlKey||e.altKey)return;if(!this.open){if(e.key==="Backspace")return;this.show()}e.stopPropagation(),e.preventDefault(),clearTimeout(this.typeToSelectTimeout),this.typeToSelectTimeout=window.setTimeout(()=>this.typeToSelectString="",1e3),e.key==="Backspace"?this.typeToSelectString=this.typeToSelectString.slice(0,-1):this.typeToSelectString+=e.key.toLowerCase();for(const s of i)if(s.getTextLabel().toLowerCase().startsWith(this.typeToSelectString)){this.setCurrentOption(s);break}}}},this.handleDocumentMouseDown=e=>{const t=e.composedPath();this&&!t.includes(this)&&this.hide()}}get validity(){return this.valueInput.validity}get validationMessage(){return this.valueInput.validationMessage}connectedCallback(){super.connectedCallback(),this.open=!1}addOpenListeners(){document.addEventListener("focusin",this.handleDocumentFocusIn),document.addEventListener("keydown",this.handleDocumentKeyDown),document.addEventListener("mousedown",this.handleDocumentMouseDown)}removeOpenListeners(){document.removeEventListener("focusin",this.handleDocumentFocusIn),document.removeEventListener("keydown",this.handleDocumentKeyDown),document.removeEventListener("mousedown",this.handleDocumentMouseDown)}handleFocus(){this.hasFocus=!0,this.displayInput.setSelectionRange(0,0),this.emit("sl-focus")}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleLabelClick(){this.displayInput.focus()}handleComboboxMouseDown(e){const n=e.composedPath().some(r=>r instanceof Element&&r.tagName.toLowerCase()==="sl-icon-button");this.disabled||n||(e.preventDefault(),this.displayInput.focus({preventScroll:!0}),this.open=!this.open)}handleComboboxKeyDown(e){e.stopPropagation(),this.handleDocumentKeyDown(e)}handleClearClick(e){e.stopPropagation(),this.value!==""&&(this.setSelectedOptions([]),this.displayInput.focus({preventScroll:!0}),this.updateComplete.then(()=>{this.emit("sl-clear"),this.emit("sl-input"),this.emit("sl-change")}))}handleClearMouseDown(e){e.stopPropagation(),e.preventDefault()}handleOptionClick(e){const n=e.target.closest("sl-option"),r=this.value;n&&!n.disabled&&(this.multiple?this.toggleOptionSelection(n):this.setSelectedOptions(n),this.updateComplete.then(()=>this.displayInput.focus({preventScroll:!0})),this.value!==r&&this.updateComplete.then(()=>{this.emit("sl-input"),this.emit("sl-change")}),this.multiple||(this.hide(),this.displayInput.focus({preventScroll:!0})))}handleDefaultSlotChange(){const e=this.getAllOptions(),t=Array.isArray(this.value)?this.value:[this.value],n=[];customElements.get("sl-option")?(e.forEach(r=>n.push(r.value)),this.setSelectedOptions(e.filter(r=>t.includes(r.value)))):customElements.whenDefined("sl-option").then(()=>this.handleDefaultSlotChange())}handleTagRemove(e,t){e.stopPropagation(),this.disabled||(this.toggleOptionSelection(t,!1),this.updateComplete.then(()=>{this.emit("sl-input"),this.emit("sl-change")}))}getAllOptions(){return[...this.querySelectorAll("sl-option")]}getFirstOption(){return this.querySelector("sl-option")}setCurrentOption(e){this.getAllOptions().forEach(n=>{n.current=!1,n.tabIndex=-1}),e&&(this.currentOption=e,e.current=!0,e.tabIndex=0,e.focus())}setSelectedOptions(e){const t=this.getAllOptions(),n=Array.isArray(e)?e:[e];t.forEach(r=>r.selected=!1),n.length&&n.forEach(r=>r.selected=!0),this.selectionChanged()}toggleOptionSelection(e,t){t===!0||t===!1?e.selected=t:e.selected=!e.selected,this.selectionChanged()}selectionChanged(){var e,t,n,r;this.selectedOptions=this.getAllOptions().filter(i=>i.selected),this.multiple?(this.value=this.selectedOptions.map(i=>i.value),this.placeholder&&this.value.length===0?this.displayLabel="":this.displayLabel=this.localize.term("numOptionsSelected",this.selectedOptions.length)):(this.value=(t=(e=this.selectedOptions[0])==null?void 0:e.value)!=null?t:"",this.displayLabel=(r=(n=this.selectedOptions[0])==null?void 0:n.getTextLabel())!=null?r:""),this.updateComplete.then(()=>{this.formControlController.updateValidity()})}handleInvalid(e){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(e)}handleDisabledChange(){this.disabled&&(this.open=!1,this.handleOpenChange())}handleValueChange(){const e=this.getAllOptions(),t=Array.isArray(this.value)?this.value:[this.value];this.setSelectedOptions(e.filter(n=>t.includes(n.value)))}async handleOpenChange(){if(this.open&&!this.disabled){this.setCurrentOption(this.selectedOptions[0]||this.getFirstOption()),this.emit("sl-show"),this.addOpenListeners(),await ma(this),this.listbox.hidden=!1,this.popup.active=!0,requestAnimationFrame(()=>{this.setCurrentOption(this.currentOption)});const{keyframes:e,options:t}=Zi(this,"select.show",{dir:this.localize.dir()});await Ki(this.popup.popup,e,t),this.currentOption&&iY(this.currentOption,this.listbox,"vertical","auto"),this.emit("sl-after-show")}else{this.emit("sl-hide"),this.removeOpenListeners(),await ma(this);const{keyframes:e,options:t}=Zi(this,"select.hide",{dir:this.localize.dir()});await Ki(this.popup.popup,e,t),this.listbox.hidden=!0,this.popup.active=!1,this.emit("sl-after-hide")}}async show(){if(this.open||this.disabled){this.open=!1;return}return this.open=!0,Mu(this,"sl-after-show")}async hide(){if(!this.open||this.disabled){this.open=!1;return}return this.open=!1,Mu(this,"sl-after-hide")}checkValidity(){return this.valueInput.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.valueInput.reportValidity()}setCustomValidity(e){this.valueInput.setCustomValidity(e),this.formControlController.updateValidity()}focus(e){this.displayInput.focus(e)}blur(){this.displayInput.blur()}render(){const e=this.hasSlotController.test("label"),t=this.hasSlotController.test("help-text"),n=this.label?!0:!!e,r=this.helpText?!0:!!t,i=this.clearable&&!this.disabled&&this.value.length>0,s=this.placeholder&&this.value.length===0;return he`
      <div
        part="form-control"
        class=${wr({"form-control":!0,"form-control--small":this.size==="small","form-control--medium":this.size==="medium","form-control--large":this.size==="large","form-control--has-label":n,"form-control--has-help-text":r})}
      >
        <label
          id="label"
          part="form-control-label"
          class="form-control__label"
          aria-hidden=${n?"false":"true"}
          @click=${this.handleLabelClick}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <sl-popup
            class=${wr({select:!0,"select--standard":!0,"select--filled":this.filled,"select--pill":this.pill,"select--open":this.open,"select--disabled":this.disabled,"select--multiple":this.multiple,"select--focused":this.hasFocus,"select--placeholder-visible":s,"select--top":this.placement==="top","select--bottom":this.placement==="bottom","select--small":this.size==="small","select--medium":this.size==="medium","select--large":this.size==="large"})}
            placement=${this.placement}
            strategy=${this.hoist?"fixed":"absolute"}
            flip
            shift
            sync="width"
            auto-size="vertical"
            auto-size-padding="10"
          >
            <div
              part="combobox"
              class="select__combobox"
              slot="anchor"
              @keydown=${this.handleComboboxKeyDown}
              @mousedown=${this.handleComboboxMouseDown}
            >
              <slot part="prefix" name="prefix" class="select__prefix"></slot>

              <input
                part="display-input"
                class="select__display-input"
                type="text"
                placeholder=${this.placeholder}
                .disabled=${this.disabled}
                .value=${this.displayLabel}
                autocomplete="off"
                spellcheck="false"
                autocapitalize="off"
                readonly
                aria-controls="listbox"
                aria-expanded=${this.open?"true":"false"}
                aria-haspopup="listbox"
                aria-labelledby="label"
                aria-disabled=${this.disabled?"true":"false"}
                aria-describedby="help-text"
                role="combobox"
                tabindex="0"
                @focus=${this.handleFocus}
                @blur=${this.handleBlur}
              />

              ${this.multiple?he`
                    <div part="tags" class="select__tags">
                      ${this.selectedOptions.map((a,o)=>o<this.maxOptionsVisible||this.maxOptionsVisible<=0?he`
                            <sl-tag
                              part="tag"
                              exportparts="
                                base:tag__base,
                                content:tag__content,
                                remove-button:tag__remove-button,
                                remove-button__base:tag__remove-button__base
                              "
                              ?pill=${this.pill}
                              size=${this.size}
                              removable
                              @sl-remove=${l=>this.handleTagRemove(l,a)}
                            >
                              ${a.getTextLabel()}
                            </sl-tag>
                          `:o===this.maxOptionsVisible?he` <sl-tag size=${this.size}> +${this.selectedOptions.length-o} </sl-tag> `:null)}
                    </div>
                  `:""}

              <input
                class="select__value-input"
                type="text"
                ?disabled=${this.disabled}
                ?required=${this.required}
                .value=${Array.isArray(this.value)?this.value.join(", "):this.value}
                tabindex="-1"
                aria-hidden="true"
                @focus=${()=>this.focus()}
                @invalid=${this.handleInvalid}
              />

              ${i?he`
                    <button
                      part="clear-button"
                      class="select__clear"
                      type="button"
                      aria-label=${this.localize.term("clearEntry")}
                      @mousedown=${this.handleClearMouseDown}
                      @click=${this.handleClearClick}
                      tabindex="-1"
                    >
                      <slot name="clear-icon">
                        <sl-icon name="x-circle-fill" library="system"></sl-icon>
                      </slot>
                    </button>
                  `:""}

              <slot name="expand-icon" part="expand-icon" class="select__expand-icon">
                <sl-icon library="system" name="chevron-down"></sl-icon>
              </slot>
            </div>

            <div
              id="listbox"
              role="listbox"
              aria-expanded=${this.open?"true":"false"}
              aria-multiselectable=${this.multiple?"true":"false"}
              aria-labelledby="label"
              part="listbox"
              class="select__listbox"
              tabindex="-1"
              @mouseup=${this.handleOptionClick}
              @slotchange=${this.handleDefaultSlotChange}
            >
              <slot></slot>
            </div>
          </sl-popup>
        </div>

        <slot
          name="help-text"
          part="form-control-help-text"
          id="help-text"
          class="form-control__help-text"
          aria-hidden=${r?"false":"true"}
        >
          ${this.helpText}
        </slot>
      </div>
    `}};mn.styles=iJe;H([pt(".select")],mn.prototype,"popup",2);H([pt(".select__combobox")],mn.prototype,"combobox",2);H([pt(".select__display-input")],mn.prototype,"displayInput",2);H([pt(".select__value-input")],mn.prototype,"valueInput",2);H([pt(".select__listbox")],mn.prototype,"listbox",2);H([Cr()],mn.prototype,"hasFocus",2);H([Cr()],mn.prototype,"displayLabel",2);H([Cr()],mn.prototype,"currentOption",2);H([Cr()],mn.prototype,"selectedOptions",2);H([Q()],mn.prototype,"name",2);H([Q({converter:{fromAttribute:e=>e.split(" "),toAttribute:e=>e.join(" ")}})],mn.prototype,"value",2);H([aB()],mn.prototype,"defaultValue",2);H([Q({reflect:!0})],mn.prototype,"size",2);H([Q()],mn.prototype,"placeholder",2);H([Q({type:Boolean,reflect:!0})],mn.prototype,"multiple",2);H([Q({attribute:"max-options-visible",type:Number})],mn.prototype,"maxOptionsVisible",2);H([Q({type:Boolean,reflect:!0})],mn.prototype,"disabled",2);H([Q({type:Boolean})],mn.prototype,"clearable",2);H([Q({type:Boolean,reflect:!0})],mn.prototype,"open",2);H([Q({type:Boolean})],mn.prototype,"hoist",2);H([Q({type:Boolean,reflect:!0})],mn.prototype,"filled",2);H([Q({type:Boolean,reflect:!0})],mn.prototype,"pill",2);H([Q()],mn.prototype,"label",2);H([Q({reflect:!0})],mn.prototype,"placement",2);H([Q({attribute:"help-text"})],mn.prototype,"helpText",2);H([Q({reflect:!0})],mn.prototype,"form",2);H([Q({type:Boolean,reflect:!0})],mn.prototype,"required",2);H([Jt("disabled",{waitUntilFirstUpdate:!0})],mn.prototype,"handleDisabledChange",1);H([Jt("value",{waitUntilFirstUpdate:!0})],mn.prototype,"handleValueChange",1);H([Jt("open",{waitUntilFirstUpdate:!0})],mn.prototype,"handleOpenChange",1);mn=H([ze("sl-select")],mn);Mr("select.show",{keyframes:[{opacity:0,scale:.9},{opacity:1,scale:1}],options:{duration:100,easing:"ease"}});Mr("select.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.9}],options:{duration:100,easing:"ease"}});function Vde(e,t,n){const r=i=>Object.is(i,-0)?0:i;return e<t?r(t):e>n?r(n):r(e)}function sJe(e,t){function n(i){const s=e.getBoundingClientRect(),a=e.ownerDocument.defaultView,o=s.left+a.pageXOffset,l=s.top+a.pageYOffset,u=i.pageX-o,c=i.pageY-l;t!=null&&t.onMove&&t.onMove(u,c)}function r(){document.removeEventListener("pointermove",n),document.removeEventListener("pointerup",r),t!=null&&t.onStop&&t.onStop()}document.addEventListener("pointermove",n,{passive:!0}),document.addEventListener("pointerup",r),(t==null?void 0:t.initialEvent)instanceof PointerEvent&&n(t.initialEvent)}var aJe=Xt`
  ${_r}

  :host {
    --divider-width: 4px;
    --divider-hit-area: 12px;
    --min: 0%;
    --max: 100%;

    display: grid;
  }

  .start,
  .end {
    overflow: hidden;
  }

  .divider {
    flex: 0 0 var(--divider-width);
    display: flex;
    position: relative;
    align-items: center;
    justify-content: center;
    background-color: var(--sl-color-neutral-200);
    color: var(--sl-color-neutral-900);
    z-index: 1;
  }

  .divider:focus {
    outline: none;
  }

  :host(:not([disabled])) .divider:focus-visible {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  :host([disabled]) .divider {
    cursor: not-allowed;
  }

  /* Horizontal */
  :host(:not([vertical], [disabled])) .divider {
    cursor: col-resize;
  }

  :host(:not([vertical])) .divider::after {
    display: flex;
    content: '';
    position: absolute;
    height: 100%;
    left: calc(var(--divider-hit-area) / -2 + var(--divider-width) / 2);
    width: var(--divider-hit-area);
  }

  /* Vertical */
  :host([vertical]) {
    flex-direction: column;
  }

  :host([vertical]:not([disabled])) .divider {
    cursor: row-resize;
  }

  :host([vertical]) .divider::after {
    content: '';
    position: absolute;
    width: 100%;
    top: calc(var(--divider-hit-area) / -2 + var(--divider-width) / 2);
    height: var(--divider-hit-area);
  }

  @media (forced-colors: active) {
    .divider {
      outline: solid 1px transparent;
    }
  }
`;let rl=class extends Xn{constructor(){super(...arguments),this.localize=new Ra(this),this.position=50,this.vertical=!1,this.disabled=!1,this.snapThreshold=12}connectedCallback(){super.connectedCallback(),this.resizeObserver=new ResizeObserver(e=>this.handleResize(e)),this.updateComplete.then(()=>this.resizeObserver.observe(this)),this.detectSize(),this.cachedPositionInPixels=this.percentageToPixels(this.position)}disconnectedCallback(){super.disconnectedCallback(),this.resizeObserver.unobserve(this)}detectSize(){const{width:e,height:t}=this.getBoundingClientRect();this.size=this.vertical?t:e}percentageToPixels(e){return this.size*(e/100)}pixelsToPercentage(e){return e/this.size*100}handleDrag(e){const t=this.localize.dir()==="rtl";this.disabled||(e.cancelable&&e.preventDefault(),sJe(this,{onMove:(n,r)=>{let i=this.vertical?r:n;this.primary==="end"&&(i=this.size-i),this.snap&&this.snap.split(" ").forEach(a=>{let o;a.endsWith("%")?o=this.size*(parseFloat(a)/100):o=parseFloat(a),t&&!this.vertical&&(o=this.size-o),i>=o-this.snapThreshold&&i<=o+this.snapThreshold&&(i=o)}),this.position=Vde(this.pixelsToPercentage(i),0,100)},initialEvent:e}))}handleKeyDown(e){if(!this.disabled&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(e.key)){let t=this.position;const n=(e.shiftKey?10:1)*(this.primary==="end"?-1:1);e.preventDefault(),(e.key==="ArrowLeft"&&!this.vertical||e.key==="ArrowUp"&&this.vertical)&&(t-=n),(e.key==="ArrowRight"&&!this.vertical||e.key==="ArrowDown"&&this.vertical)&&(t+=n),e.key==="Home"&&(t=this.primary==="end"?100:0),e.key==="End"&&(t=this.primary==="end"?0:100),this.position=Vde(t,0,100)}}handleResize(e){const{width:t,height:n}=e[0].contentRect;this.size=this.vertical?n:t,this.primary&&(this.position=this.pixelsToPercentage(this.cachedPositionInPixels))}handlePositionChange(){this.cachedPositionInPixels=this.percentageToPixels(this.position),this.positionInPixels=this.percentageToPixels(this.position),this.emit("sl-reposition")}handlePositionInPixelsChange(){this.position=this.pixelsToPercentage(this.positionInPixels)}handleVerticalChange(){this.detectSize()}render(){const e=this.vertical?"gridTemplateRows":"gridTemplateColumns",t=this.vertical?"gridTemplateColumns":"gridTemplateRows",n=this.localize.dir()==="rtl",r=`
      clamp(
        0%,
        clamp(
          var(--min),
          ${this.position}% - var(--divider-width) / 2,
          var(--max)
        ),
        calc(100% - var(--divider-width))
      )
    `,i="auto";return this.primary==="end"?n&&!this.vertical?this.style[e]=`${r} var(--divider-width) ${i}`:this.style[e]=`${i} var(--divider-width) ${r}`:n&&!this.vertical?this.style[e]=`${i} var(--divider-width) ${r}`:this.style[e]=`${r} var(--divider-width) ${i}`,this.style[t]="",he`
      <slot name="start" part="panel start" class="start"></slot>

      <div
        part="divider"
        class="divider"
        tabindex=${Et(this.disabled?void 0:"0")}
        role="separator"
        aria-valuenow=${this.position}
        aria-valuemin="0"
        aria-valuemax="100"
        aria-label=${this.localize.term("resize")}
        @keydown=${this.handleKeyDown}
        @mousedown=${this.handleDrag}
        @touchstart=${this.handleDrag}
      >
        <slot name="divider"></slot>
      </div>

      <slot name="end" part="panel end" class="end"></slot>
    `}};rl.styles=aJe;H([pt(".divider")],rl.prototype,"divider",2);H([Q({type:Number,reflect:!0})],rl.prototype,"position",2);H([Q({attribute:"position-in-pixels",type:Number})],rl.prototype,"positionInPixels",2);H([Q({type:Boolean,reflect:!0})],rl.prototype,"vertical",2);H([Q({type:Boolean,reflect:!0})],rl.prototype,"disabled",2);H([Q()],rl.prototype,"primary",2);H([Q()],rl.prototype,"snap",2);H([Q({type:Number,attribute:"snap-threshold"})],rl.prototype,"snapThreshold",2);H([Jt("position")],rl.prototype,"handlePositionChange",1);H([Jt("positionInPixels")],rl.prototype,"handlePositionInPixelsChange",1);H([Jt("vertical")],rl.prototype,"handleVerticalChange",1);rl=H([ze("sl-split-panel")],rl);var oJe=Xt`
  ${_r}

  :host {
    display: inline-block;
  }

  :host([size='small']) {
    --height: var(--sl-toggle-size-small);
    --thumb-size: calc(var(--sl-toggle-size-small) + 4px);
    --width: calc(var(--height) * 2);

    font-size: var(--sl-input-font-size-small);
  }

  :host([size='medium']) {
    --height: var(--sl-toggle-size-medium);
    --thumb-size: calc(var(--sl-toggle-size-medium) + 4px);
    --width: calc(var(--height) * 2);

    font-size: var(--sl-input-font-size-medium);
  }

  :host([size='large']) {
    --height: var(--sl-toggle-size-large);
    --thumb-size: calc(var(--sl-toggle-size-large) + 4px);
    --width: calc(var(--height) * 2);

    font-size: var(--sl-input-font-size-large);
  }

  .switch {
    position: relative;
    display: inline-flex;
    align-items: center;
    font-family: var(--sl-input-font-family);
    font-size: inherit;
    font-weight: var(--sl-input-font-weight);
    color: var(--sl-input-label-color);
    vertical-align: middle;
    cursor: pointer;
  }

  .switch__control {
    flex: 0 0 auto;
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: var(--width);
    height: var(--height);
    background-color: var(--sl-color-neutral-400);
    border: solid var(--sl-input-border-width) var(--sl-color-neutral-400);
    border-radius: var(--height);
    transition: var(--sl-transition-fast) border-color, var(--sl-transition-fast) background-color;
  }

  .switch__control .switch__thumb {
    width: var(--thumb-size);
    height: var(--thumb-size);
    background-color: var(--sl-color-neutral-0);
    border-radius: 50%;
    border: solid var(--sl-input-border-width) var(--sl-color-neutral-400);
    translate: calc((var(--width) - var(--height)) / -2);
    transition: var(--sl-transition-fast) translate ease, var(--sl-transition-fast) background-color,
      var(--sl-transition-fast) border-color, var(--sl-transition-fast) box-shadow;
  }

  .switch__input {
    position: absolute;
    opacity: 0;
    padding: 0;
    margin: 0;
    pointer-events: none;
  }

  /* Hover */
  .switch:not(.switch--checked):not(.switch--disabled) .switch__control:hover {
    background-color: var(--sl-color-neutral-400);
    border-color: var(--sl-color-neutral-400);
  }

  .switch:not(.switch--checked):not(.switch--disabled) .switch__control:hover .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-neutral-400);
  }

  /* Focus */
  .switch:not(.switch--checked):not(.switch--disabled) .switch__input:focus-visible ~ .switch__control {
    background-color: var(--sl-color-neutral-400);
    border-color: var(--sl-color-neutral-400);
  }

  .switch:not(.switch--checked):not(.switch--disabled) .switch__input:focus-visible ~ .switch__control .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-primary-600);
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  /* Checked */
  .switch--checked .switch__control {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
  }

  .switch--checked .switch__control .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-primary-600);
    translate: calc((var(--width) - var(--height)) / 2);
  }

  /* Checked + hover */
  .switch.switch--checked:not(.switch--disabled) .switch__control:hover {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
  }

  .switch.switch--checked:not(.switch--disabled) .switch__control:hover .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-primary-600);
  }

  /* Checked + focus */
  .switch.switch--checked:not(.switch--disabled) .switch__input:focus-visible ~ .switch__control {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
  }

  .switch.switch--checked:not(.switch--disabled) .switch__input:focus-visible ~ .switch__control .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-primary-600);
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  /* Disabled */
  .switch--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .switch__label {
    display: inline-block;
    line-height: var(--height);
    margin-inline-start: 0.5em;
    user-select: none;
  }

  :host([required]) .switch__label::after {
    content: var(--sl-input-required-content);
    margin-inline-start: var(--sl-input-required-content-offset);
  }

  @media (forced-colors: active) {
    .switch.switch--checked:not(.switch--disabled) .switch__control:hover .switch__thumb,
    .switch--checked .switch__control .switch__thumb {
      background-color: ButtonText;
    }
  }
`;let Da=class extends Xn{constructor(){super(...arguments),this.formControlController=new dC(this,{value:e=>e.checked?e.value||"on":void 0,defaultValue:e=>e.defaultChecked,setValue:(e,t)=>e.checked=t}),this.hasFocus=!1,this.title="",this.name="",this.size="medium",this.disabled=!1,this.checked=!1,this.defaultChecked=!1,this.form="",this.required=!1}get validity(){return this.input.validity}get validationMessage(){return this.input.validationMessage}firstUpdated(){this.formControlController.updateValidity()}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleInput(){this.emit("sl-input")}handleInvalid(e){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(e)}handleClick(){this.checked=!this.checked,this.emit("sl-change")}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleKeyDown(e){e.key==="ArrowLeft"&&(e.preventDefault(),this.checked=!1,this.emit("sl-change"),this.emit("sl-input")),e.key==="ArrowRight"&&(e.preventDefault(),this.checked=!0,this.emit("sl-change"),this.emit("sl-input"))}handleCheckedChange(){this.input.checked=this.checked,this.formControlController.updateValidity()}handleDisabledChange(){this.formControlController.setValidity(!0)}click(){this.input.click()}focus(e){this.input.focus(e)}blur(){this.input.blur()}checkValidity(){return this.input.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.input.reportValidity()}setCustomValidity(e){this.input.setCustomValidity(e),this.formControlController.updateValidity()}render(){return he`
      <label
        part="base"
        class=${wr({switch:!0,"switch--checked":this.checked,"switch--disabled":this.disabled,"switch--focused":this.hasFocus,"switch--small":this.size==="small","switch--medium":this.size==="medium","switch--large":this.size==="large"})}
      >
        <input
          class="switch__input"
          type="checkbox"
          title=${this.title}
          name=${this.name}
          value=${Et(this.value)}
          .checked=${bee(this.checked)}
          .disabled=${this.disabled}
          .required=${this.required}
          role="switch"
          aria-checked=${this.checked?"true":"false"}
          @click=${this.handleClick}
          @input=${this.handleInput}
          @invalid=${this.handleInvalid}
          @blur=${this.handleBlur}
          @focus=${this.handleFocus}
          @keydown=${this.handleKeyDown}
        />

        <span part="control" class="switch__control">
          <span part="thumb" class="switch__thumb"></span>
        </span>

        <slot part="label" class="switch__label"></slot>
      </label>
    `}};Da.styles=oJe;H([pt('input[type="checkbox"]')],Da.prototype,"input",2);H([Cr()],Da.prototype,"hasFocus",2);H([Q()],Da.prototype,"title",2);H([Q()],Da.prototype,"name",2);H([Q()],Da.prototype,"value",2);H([Q({reflect:!0})],Da.prototype,"size",2);H([Q({type:Boolean,reflect:!0})],Da.prototype,"disabled",2);H([Q({type:Boolean,reflect:!0})],Da.prototype,"checked",2);H([aB("checked")],Da.prototype,"defaultChecked",2);H([Q({reflect:!0})],Da.prototype,"form",2);H([Q({type:Boolean,reflect:!0})],Da.prototype,"required",2);H([Jt("checked",{waitUntilFirstUpdate:!0})],Da.prototype,"handleCheckedChange",1);H([Jt("disabled",{waitUntilFirstUpdate:!0})],Da.prototype,"handleDisabledChange",1);Da=H([ze("sl-switch")],Da);var lJe=Xt`
  ${_r}

  :host {
    display: inline-block;
  }

  .tab {
    display: inline-flex;
    align-items: center;
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-small);
    font-weight: var(--sl-font-weight-semibold);
    border-radius: var(--sl-border-radius-medium);
    color: var(--sl-color-neutral-600);
    padding: var(--sl-spacing-medium) var(--sl-spacing-large);
    white-space: nowrap;
    user-select: none;
    cursor: pointer;
    transition: var(--transition-speed) box-shadow, var(--transition-speed) color;
  }

  .tab:hover:not(.tab--disabled) {
    color: var(--sl-color-primary-600);
  }

  .tab:focus {
    outline: none;
  }

  .tab:focus-visible:not(.tab--disabled) {
    color: var(--sl-color-primary-600);
  }

  .tab:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: calc(-1 * var(--sl-focus-ring-width) - var(--sl-focus-ring-offset));
  }

  .tab.tab--active:not(.tab--disabled) {
    color: var(--sl-color-primary-600);
  }

  .tab.tab--closable {
    padding-inline-end: var(--sl-spacing-small);
  }

  .tab.tab--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .tab__close-button {
    font-size: var(--sl-font-size-small);
    margin-inline-start: var(--sl-spacing-small);
  }

  .tab__close-button::part(base) {
    padding: var(--sl-spacing-3x-small);
  }

  @media (forced-colors: active) {
    .tab.tab--active:not(.tab--disabled) {
      outline: solid 1px transparent;
      outline-offset: -3px;
    }
  }
`;let uJe=0,Ah=class extends Xn{constructor(){super(...arguments),this.localize=new Ra(this),this.attrId=++uJe,this.componentId=`sl-tab-${this.attrId}`,this.panel="",this.active=!1,this.closable=!1,this.disabled=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","tab")}handleCloseClick(e){e.stopPropagation(),this.emit("sl-close")}handleActiveChange(){this.setAttribute("aria-selected",this.active?"true":"false")}handleDisabledChange(){this.setAttribute("aria-disabled",this.disabled?"true":"false")}focus(e){this.tab.focus(e)}blur(){this.tab.blur()}render(){return this.id=this.id.length>0?this.id:this.componentId,he`
      <div
        part="base"
        class=${wr({tab:!0,"tab--active":this.active,"tab--closable":this.closable,"tab--disabled":this.disabled})}
        tabindex=${this.disabled?"-1":"0"}
      >
        <slot></slot>
        ${this.closable?he`
              <sl-icon-button
                part="close-button"
                exportparts="base:close-button__base"
                name="x-lg"
                library="system"
                label=${this.localize.term("close")}
                class="tab__close-button"
                @click=${this.handleCloseClick}
                tabindex="-1"
              ></sl-icon-button>
            `:""}
      </div>
    `}};Ah.styles=lJe;H([pt(".tab")],Ah.prototype,"tab",2);H([Q({reflect:!0})],Ah.prototype,"panel",2);H([Q({type:Boolean,reflect:!0})],Ah.prototype,"active",2);H([Q({type:Boolean})],Ah.prototype,"closable",2);H([Q({type:Boolean,reflect:!0})],Ah.prototype,"disabled",2);H([Jt("active")],Ah.prototype,"handleActiveChange",1);H([Jt("disabled")],Ah.prototype,"handleDisabledChange",1);Ah=H([ze("sl-tab")],Ah);var cJe=Xt`
  ${_r}

  :host {
    --indicator-color: var(--sl-color-primary-600);
    --track-color: var(--sl-color-neutral-200);
    --track-width: 2px;

    display: block;
  }

  .tab-group {
    display: flex;
    border-radius: 0;
  }

  .tab-group__tabs {
    display: flex;
    position: relative;
  }

  .tab-group__indicator {
    position: absolute;
    transition: var(--sl-transition-fast) translate ease, var(--sl-transition-fast) width ease;
  }

  .tab-group--has-scroll-controls .tab-group__nav-container {
    position: relative;
    padding: 0 var(--sl-spacing-x-large);
  }

  .tab-group__body {
    display: block;
    overflow: auto;
  }

  .tab-group__scroll-button {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    bottom: 0;
    width: var(--sl-spacing-x-large);
  }

  .tab-group__scroll-button--start {
    left: 0;
  }

  .tab-group__scroll-button--end {
    right: 0;
  }

  .tab-group--rtl .tab-group__scroll-button--start {
    left: auto;
    right: 0;
  }

  .tab-group--rtl .tab-group__scroll-button--end {
    left: 0;
    right: auto;
  }

  /*
   * Top
   */

  .tab-group--top {
    flex-direction: column;
  }

  .tab-group--top .tab-group__nav-container {
    order: 1;
  }

  .tab-group--top .tab-group__nav {
    display: flex;
    overflow-x: auto;

    /* Hide scrollbar in Firefox */
    scrollbar-width: none;
  }

  /* Hide scrollbar in Chrome/Safari */
  .tab-group--top .tab-group__nav::-webkit-scrollbar {
    width: 0;
    height: 0;
  }

  .tab-group--top .tab-group__tabs {
    flex: 1 1 auto;
    position: relative;
    flex-direction: row;
    border-bottom: solid var(--track-width) var(--track-color);
  }

  .tab-group--top .tab-group__indicator {
    bottom: calc(-1 * var(--track-width));
    border-bottom: solid var(--track-width) var(--indicator-color);
  }

  .tab-group--top .tab-group__body {
    order: 2;
  }

  .tab-group--top ::slotted(sl-tab-panel) {
    --padding: var(--sl-spacing-medium) 0;
  }

  /*
   * Bottom
   */

  .tab-group--bottom {
    flex-direction: column;
  }

  .tab-group--bottom .tab-group__nav-container {
    order: 2;
  }

  .tab-group--bottom .tab-group__nav {
    display: flex;
    overflow-x: auto;

    /* Hide scrollbar in Firefox */
    scrollbar-width: none;
  }

  /* Hide scrollbar in Chrome/Safari */
  .tab-group--bottom .tab-group__nav::-webkit-scrollbar {
    width: 0;
    height: 0;
  }

  .tab-group--bottom .tab-group__tabs {
    flex: 1 1 auto;
    position: relative;
    flex-direction: row;
    border-top: solid var(--track-width) var(--track-color);
  }

  .tab-group--bottom .tab-group__indicator {
    top: calc(-1 * var(--track-width));
    border-top: solid var(--track-width) var(--indicator-color);
  }

  .tab-group--bottom .tab-group__body {
    order: 1;
  }

  .tab-group--bottom ::slotted(sl-tab-panel) {
    --padding: var(--sl-spacing-medium) 0;
  }

  /*
   * Start
   */

  .tab-group--start {
    flex-direction: row;
  }

  .tab-group--start .tab-group__nav-container {
    order: 1;
  }

  .tab-group--start .tab-group__tabs {
    flex: 0 0 auto;
    flex-direction: column;
    border-inline-end: solid var(--track-width) var(--track-color);
  }

  .tab-group--start .tab-group__indicator {
    right: calc(-1 * var(--track-width));
    border-right: solid var(--track-width) var(--indicator-color);
  }

  .tab-group--start.tab-group--rtl .tab-group__indicator {
    right: auto;
    left: calc(-1 * var(--track-width));
  }

  .tab-group--start .tab-group__body {
    flex: 1 1 auto;
    order: 2;
  }

  .tab-group--start ::slotted(sl-tab-panel) {
    --padding: 0 var(--sl-spacing-medium);
  }

  /*
   * End
   */

  .tab-group--end {
    flex-direction: row;
  }

  .tab-group--end .tab-group__nav-container {
    order: 2;
  }

  .tab-group--end .tab-group__tabs {
    flex: 0 0 auto;
    flex-direction: column;
    border-left: solid var(--track-width) var(--track-color);
  }

  .tab-group--end .tab-group__indicator {
    left: calc(-1 * var(--track-width));
    border-inline-start: solid var(--track-width) var(--indicator-color);
  }

  .tab-group--end.tab-group--rtl .tab-group__indicator {
    right: calc(-1 * var(--track-width));
    left: auto;
  }

  .tab-group--end .tab-group__body {
    flex: 1 1 auto;
    order: 1;
  }

  .tab-group--end ::slotted(sl-tab-panel) {
    --padding: 0 var(--sl-spacing-medium);
  }
`;let Wl=class extends Xn{constructor(){super(...arguments),this.localize=new Ra(this),this.tabs=[],this.panels=[],this.hasScrollControls=!1,this.placement="top",this.activation="auto",this.noScrollControls=!1}connectedCallback(){const e=Promise.all([customElements.whenDefined("sl-tab"),customElements.whenDefined("sl-tab-panel")]);super.connectedCallback(),this.resizeObserver=new ResizeObserver(()=>{this.repositionIndicator(),this.updateScrollControls()}),this.mutationObserver=new MutationObserver(t=>{t.some(n=>!["aria-labelledby","aria-controls"].includes(n.attributeName))&&setTimeout(()=>this.setAriaLabels()),t.some(n=>n.attributeName==="disabled")&&this.syncTabsAndPanels()}),this.updateComplete.then(()=>{this.syncTabsAndPanels(),this.mutationObserver.observe(this,{attributes:!0,childList:!0,subtree:!0}),this.resizeObserver.observe(this.nav),e.then(()=>{new IntersectionObserver((n,r)=>{var i;n[0].intersectionRatio>0&&(this.setAriaLabels(),this.setActiveTab((i=this.getActiveTab())!=null?i:this.tabs[0],{emitEvents:!1}),r.unobserve(n[0].target))}).observe(this.tabGroup)})})}disconnectedCallback(){this.mutationObserver.disconnect(),this.resizeObserver.unobserve(this.nav)}getAllTabs(e={includeDisabled:!0}){return[...this.shadowRoot.querySelector('slot[name="nav"]').assignedElements()].filter(n=>e.includeDisabled?n.tagName.toLowerCase()==="sl-tab":n.tagName.toLowerCase()==="sl-tab"&&!n.disabled)}getAllPanels(){return[...this.body.assignedElements()].filter(e=>e.tagName.toLowerCase()==="sl-tab-panel")}getActiveTab(){return this.tabs.find(e=>e.active)}handleClick(e){const n=e.target.closest("sl-tab");(n==null?void 0:n.closest("sl-tab-group"))===this&&n!==null&&this.setActiveTab(n,{scrollBehavior:"smooth"})}handleKeyDown(e){const n=e.target.closest("sl-tab");if((n==null?void 0:n.closest("sl-tab-group"))===this&&(["Enter"," "].includes(e.key)&&n!==null&&(this.setActiveTab(n,{scrollBehavior:"smooth"}),e.preventDefault()),["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(e.key))){const i=this.tabs.find(a=>a.matches(":focus")),s=this.localize.dir()==="rtl";if((i==null?void 0:i.tagName.toLowerCase())==="sl-tab"){let a=this.tabs.indexOf(i);e.key==="Home"?a=0:e.key==="End"?a=this.tabs.length-1:["top","bottom"].includes(this.placement)&&e.key===(s?"ArrowRight":"ArrowLeft")||["start","end"].includes(this.placement)&&e.key==="ArrowUp"?a--:(["top","bottom"].includes(this.placement)&&e.key===(s?"ArrowLeft":"ArrowRight")||["start","end"].includes(this.placement)&&e.key==="ArrowDown")&&a++,a<0&&(a=this.tabs.length-1),a>this.tabs.length-1&&(a=0),this.tabs[a].focus({preventScroll:!0}),this.activation==="auto"&&this.setActiveTab(this.tabs[a],{scrollBehavior:"smooth"}),["top","bottom"].includes(this.placement)&&iY(this.tabs[a],this.nav,"horizontal"),e.preventDefault()}}}handleScrollToStart(){this.nav.scroll({left:this.localize.dir()==="rtl"?this.nav.scrollLeft+this.nav.clientWidth:this.nav.scrollLeft-this.nav.clientWidth,behavior:"smooth"})}handleScrollToEnd(){this.nav.scroll({left:this.localize.dir()==="rtl"?this.nav.scrollLeft-this.nav.clientWidth:this.nav.scrollLeft+this.nav.clientWidth,behavior:"smooth"})}setActiveTab(e,t){if(t=GSe({emitEvents:!0,scrollBehavior:"auto"},t),e!==this.activeTab&&!e.disabled){const n=this.activeTab;this.activeTab=e,this.tabs.forEach(r=>r.active=r===this.activeTab),this.panels.forEach(r=>{var i;return r.active=r.name===((i=this.activeTab)==null?void 0:i.panel)}),this.syncIndicator(),["top","bottom"].includes(this.placement)&&iY(this.activeTab,this.nav,"horizontal",t.scrollBehavior),t.emitEvents&&(n&&this.emit("sl-tab-hide",{detail:{name:n.panel}}),this.emit("sl-tab-show",{detail:{name:this.activeTab.panel}}))}}setAriaLabels(){this.tabs.forEach(e=>{const t=this.panels.find(n=>n.name===e.panel);t&&(e.setAttribute("aria-controls",t.getAttribute("id")),t.setAttribute("aria-labelledby",e.getAttribute("id")))})}repositionIndicator(){const e=this.getActiveTab();if(!e)return;const t=e.clientWidth,n=e.clientHeight,r=this.localize.dir()==="rtl",i=this.getAllTabs(),a=i.slice(0,i.indexOf(e)).reduce((o,l)=>({left:o.left+l.clientWidth,top:o.top+l.clientHeight}),{left:0,top:0});switch(this.placement){case"top":case"bottom":this.indicator.style.width=`${t}px`,this.indicator.style.height="auto",this.indicator.style.translate=r?`${-1*a.left}px`:`${a.left}px`;break;case"start":case"end":this.indicator.style.width="auto",this.indicator.style.height=`${n}px`,this.indicator.style.translate=`0 ${a.top}px`;break}}syncTabsAndPanels(){this.tabs=this.getAllTabs({includeDisabled:!1}),this.panels=this.getAllPanels(),this.syncIndicator(),this.updateComplete.then(()=>this.updateScrollControls())}updateScrollControls(){this.noScrollControls?this.hasScrollControls=!1:this.hasScrollControls=["top","bottom"].includes(this.placement)&&this.nav.scrollWidth>this.nav.clientWidth}syncIndicator(){this.getActiveTab()?(this.indicator.style.display="block",this.repositionIndicator()):this.indicator.style.display="none"}show(e){const t=this.tabs.find(n=>n.panel===e);t&&this.setActiveTab(t,{scrollBehavior:"smooth"})}render(){const e=this.localize.dir()==="rtl";return he`
      <div
        part="base"
        class=${wr({"tab-group":!0,"tab-group--top":this.placement==="top","tab-group--bottom":this.placement==="bottom","tab-group--start":this.placement==="start","tab-group--end":this.placement==="end","tab-group--rtl":this.localize.dir()==="rtl","tab-group--has-scroll-controls":this.hasScrollControls})}
        @click=${this.handleClick}
        @keydown=${this.handleKeyDown}
      >
        <div class="tab-group__nav-container" part="nav">
          ${this.hasScrollControls?he`
                <sl-icon-button
                  part="scroll-button scroll-button--start"
                  exportparts="base:scroll-button__base"
                  class="tab-group__scroll-button tab-group__scroll-button--start"
                  name=${e?"chevron-right":"chevron-left"}
                  library="system"
                  label=${this.localize.term("scrollToStart")}
                  @click=${this.handleScrollToStart}
                ></sl-icon-button>
              `:""}

          <div class="tab-group__nav">
            <div part="tabs" class="tab-group__tabs" role="tablist">
              <div part="active-tab-indicator" class="tab-group__indicator"></div>
              <slot name="nav" @slotchange=${this.syncTabsAndPanels}></slot>
            </div>
          </div>

          ${this.hasScrollControls?he`
                <sl-icon-button
                  part="scroll-button scroll-button--end"
                  exportparts="base:scroll-button__base"
                  class="tab-group__scroll-button tab-group__scroll-button--end"
                  name=${e?"chevron-left":"chevron-right"}
                  library="system"
                  label=${this.localize.term("scrollToEnd")}
                  @click=${this.handleScrollToEnd}
                ></sl-icon-button>
              `:""}
        </div>

        <slot part="body" class="tab-group__body" @slotchange=${this.syncTabsAndPanels}></slot>
      </div>
    `}};Wl.styles=cJe;H([pt(".tab-group")],Wl.prototype,"tabGroup",2);H([pt(".tab-group__body")],Wl.prototype,"body",2);H([pt(".tab-group__nav")],Wl.prototype,"nav",2);H([pt(".tab-group__indicator")],Wl.prototype,"indicator",2);H([Cr()],Wl.prototype,"hasScrollControls",2);H([Q()],Wl.prototype,"placement",2);H([Q()],Wl.prototype,"activation",2);H([Q({attribute:"no-scroll-controls",type:Boolean})],Wl.prototype,"noScrollControls",2);H([Jt("noScrollControls",{waitUntilFirstUpdate:!0})],Wl.prototype,"updateScrollControls",1);H([Jt("placement",{waitUntilFirstUpdate:!0})],Wl.prototype,"syncIndicator",1);Wl=H([ze("sl-tab-group")],Wl);var fJe=Xt`
  ${_r}

  :host {
    --padding: 0;

    display: none;
  }

  :host([active]) {
    display: block;
  }

  .tab-panel {
    display: block;
    padding: var(--padding);
  }
`;let hJe=0,kw=class extends Xn{constructor(){super(...arguments),this.attrId=++hJe,this.componentId=`sl-tab-panel-${this.attrId}`,this.name="",this.active=!1}connectedCallback(){super.connectedCallback(),this.id=this.id.length>0?this.id:this.componentId,this.setAttribute("role","tabpanel")}handleActiveChange(){this.setAttribute("aria-hidden",this.active?"false":"true")}render(){return he`
      <slot
        part="base"
        class=${wr({"tab-panel":!0,"tab-panel--active":this.active})}
      ></slot>
    `}};kw.styles=fJe;H([Q({reflect:!0})],kw.prototype,"name",2);H([Q({type:Boolean,reflect:!0})],kw.prototype,"active",2);H([Jt("active")],kw.prototype,"handleActiveChange",1);kw=H([ze("sl-tab-panel")],kw);var dJe=Xt`
  ${_r}

  :host {
    --max-width: 20rem;
    --hide-delay: 0ms;
    --show-delay: 150ms;

    display: contents;
  }

  .tooltip {
    --arrow-size: var(--sl-tooltip-arrow-size);
    --arrow-color: var(--sl-tooltip-background-color);
  }

  .tooltip::part(popup) {
    pointer-events: none;
    z-index: var(--sl-z-index-tooltip);
  }

  .tooltip[placement^='top']::part(popup) {
    transform-origin: bottom;
  }

  .tooltip[placement^='bottom']::part(popup) {
    transform-origin: top;
  }

  .tooltip[placement^='left']::part(popup) {
    transform-origin: right;
  }

  .tooltip[placement^='right']::part(popup) {
    transform-origin: left;
  }

  .tooltip__body {
    display: block;
    width: max-content;
    max-width: var(--max-width);
    border-radius: var(--sl-tooltip-border-radius);
    background-color: var(--sl-tooltip-background-color);
    font-family: var(--sl-tooltip-font-family);
    font-size: var(--sl-tooltip-font-size);
    font-weight: var(--sl-tooltip-font-weight);
    line-height: var(--sl-tooltip-line-height);
    color: var(--sl-tooltip-color);
    padding: var(--sl-tooltip-padding);
    pointer-events: none;
  }
`;let Hs=class extends Xn{constructor(){super(),this.localize=new Ra(this),this.content="",this.placement="top",this.disabled=!1,this.distance=8,this.open=!1,this.skidding=0,this.trigger="hover focus",this.hoist=!1,this.handleBlur=()=>{this.hasTrigger("focus")&&this.hide()},this.handleClick=()=>{this.hasTrigger("click")&&(this.open?this.hide():this.show())},this.handleFocus=()=>{this.hasTrigger("focus")&&this.show()},this.handleKeyDown=e=>{this.open&&e.key==="Escape"&&(e.stopPropagation(),this.hide())},this.handleMouseOver=()=>{if(this.hasTrigger("hover")){const e=Mde(getComputedStyle(this).getPropertyValue("--show-delay"));clearTimeout(this.hoverTimeout),this.hoverTimeout=window.setTimeout(()=>this.show(),e)}},this.handleMouseOut=()=>{if(this.hasTrigger("hover")){const e=Mde(getComputedStyle(this).getPropertyValue("--hide-delay"));clearTimeout(this.hoverTimeout),this.hoverTimeout=window.setTimeout(()=>this.hide(),e)}},this.addEventListener("blur",this.handleBlur,!0),this.addEventListener("focus",this.handleFocus,!0),this.addEventListener("click",this.handleClick),this.addEventListener("keydown",this.handleKeyDown),this.addEventListener("mouseover",this.handleMouseOver),this.addEventListener("mouseout",this.handleMouseOut)}connectedCallback(){super.connectedCallback()}firstUpdated(){this.body.hidden=!this.open,this.open&&(this.popup.active=!0,this.popup.reposition())}hasTrigger(e){return this.trigger.split(" ").includes(e)}async handleOpenChange(){if(this.open){if(this.disabled)return;this.emit("sl-show"),await ma(this.body),this.body.hidden=!1,this.popup.active=!0;const{keyframes:e,options:t}=Zi(this,"tooltip.show",{dir:this.localize.dir()});await Ki(this.popup.popup,e,t),this.emit("sl-after-show")}else{this.emit("sl-hide"),await ma(this.body);const{keyframes:e,options:t}=Zi(this,"tooltip.hide",{dir:this.localize.dir()});await Ki(this.popup.popup,e,t),this.popup.active=!1,this.body.hidden=!0,this.emit("sl-after-hide")}}async handleOptionsChange(){this.hasUpdated&&(await this.updateComplete,this.popup.reposition())}handleDisabledChange(){this.disabled&&this.open&&this.hide()}async show(){if(!this.open)return this.open=!0,Mu(this,"sl-after-show")}async hide(){if(!!this.open)return this.open=!1,Mu(this,"sl-after-hide")}render(){return he`
      <sl-popup
        part="base"
        exportparts="
          popup:base__popup,
          arrow:base__arrow
        "
        class=${wr({tooltip:!0,"tooltip--open":this.open})}
        placement=${this.placement}
        distance=${this.distance}
        skidding=${this.skidding}
        strategy=${this.hoist?"fixed":"absolute"}
        flip
        shift
        arrow
      >
        <slot slot="anchor" aria-describedby="tooltip"></slot>

        <slot
          name="content"
          part="body"
          id="tooltip"
          class="tooltip__body"
          role="tooltip"
          aria-live=${this.open?"polite":"off"}
        >
          ${this.content}
        </slot>
      </sl-popup>
    `}};Hs.styles=dJe;H([pt("slot:not([name])")],Hs.prototype,"defaultSlot",2);H([pt(".tooltip__body")],Hs.prototype,"body",2);H([pt("sl-popup")],Hs.prototype,"popup",2);H([Q()],Hs.prototype,"content",2);H([Q()],Hs.prototype,"placement",2);H([Q({type:Boolean,reflect:!0})],Hs.prototype,"disabled",2);H([Q({type:Number})],Hs.prototype,"distance",2);H([Q({type:Boolean,reflect:!0})],Hs.prototype,"open",2);H([Q({type:Number})],Hs.prototype,"skidding",2);H([Q()],Hs.prototype,"trigger",2);H([Q({type:Boolean})],Hs.prototype,"hoist",2);H([Jt("open",{waitUntilFirstUpdate:!0})],Hs.prototype,"handleOpenChange",1);H([Jt(["content","distance","hoist","placement","skidding"])],Hs.prototype,"handleOptionsChange",1);H([Jt("disabled")],Hs.prototype,"handleDisabledChange",1);Hs=H([ze("sl-tooltip")],Hs);Mr("tooltip.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:150,easing:"ease"}});Mr("tooltip.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:150,easing:"ease"}});const yke=new WeakMap;function pJe(e,t){let n=t;for(;n;){if(yke.get(n)===e)return!0;n=Object.getPrototypeOf(n)}return!1}function gJe(e){return t=>{if(pJe(e,t))return t;const n=e(t);return yke.set(n,e),n}}const HF=!!ShadowRoot.prototype.createElement,mJe=e=>class extends e{static get scopedElements(){return{}}static get shadowRootOptions(){return this.__shadowRootOptions}static set shadowRootOptions(n){this.__shadowRootOptions=n}static get elementStyles(){return this.__elementStyles}static set elementStyles(n){this.__elementStyles=n}constructor(...n){super(),this.renderOptions=this.renderOptions||void 0}get registry(){return this.constructor.__registry}set registry(n){this.constructor.__registry=n}createRenderRoot(){const{scopedElements:n,shadowRootOptions:r,elementStyles:i}=this.constructor;if(!this.registry||this.registry===this.constructor.__registry&&!Object.prototype.hasOwnProperty.call(this.constructor,"__registry")){this.registry=HF?new CustomElementRegistry:customElements;for(const[l,u]of Object.entries(n))this.defineScopedElement(l,u)}const a={mode:"open",...r,customElements:this.registry},o=this.attachShadow(a);return HF&&(this.renderOptions.creationScope=o),o instanceof ShadowRoot&&(XSe(o,i),this.renderOptions.renderBefore=this.renderOptions.renderBefore||o.firstChild),o}createScopedElement(n){return(HF?this.shadowRoot:document).createElement(n)}defineScopedElement(n,r){const i=this.registry.get(n);return i&&HF===!1&&i!==r&&console.error([`You are trying to re-register the "${n}" custom element with a different class via ScopedElementsMixin.`,"This is only possible with a CustomElementRegistry.","Your browser does not support this feature so you will need to load a polyfill for it.",'Load "@webcomponents/scoped-custom-element-registry" before you register ANY web component to the global customElements registry.','e.g. add "<script src="/node_modules/@webcomponents/scoped-custom-element-registry/scoped-custom-element-registry.min.js"><\/script>" as your first script tag.',"For more details you can visit https://open-wc.org/docs/development/scoped-elements/"].join(`
`)),i?this.registry.get(n):this.registry.define(n,r)}getScopedTagName(n){return this.constructor.getScopedTagName(n)}static getScopedTagName(n){return this.__registry.get(n)?n:void 0}},bke=gJe(mJe);var vJe=Object.defineProperty,yJe=Object.getOwnPropertyDescriptor,See=(e,t,n,r)=>{for(var i=r>1?void 0:r?yJe(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&vJe(t,n,i),i};class _t extends bke(Y1){connectedCallback(){super.connectedCallback(),this.getAttributeNames().forEach(t=>this.setAttribute(t,this.getAttribute(t)))}}_t.shadowRootOptions={...bke(Y1).shadowRootOptions,delegatesFocus:!0};See([Q({type:Boolean,attribute:!0,reflect:!0})],_t.prototype,"printable",2);See([Q({type:Boolean,attribute:!0,reflect:!0})],_t.prototype,"editable",2);See([Q({type:Boolean,attribute:!0,reflect:!0})],_t.prototype,"analyzable",2);const St=Xt`
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: var(--sl-font-sans);
  }

  h1,
  h2,
  h3,
  h4 {
    text-transform: uppercase;
  }

  h1 {
    font-size: 18px;
    margin: 10px 0 15px 0;
  }

  h2 {
    font-size: 16px;
    margin: 15px 0 5px 0;
  }

  h3 {
    font-size: 14px;
    margin: 15px 0 5px 0;
  }

  h4 {
    font-size: 12px;
    margin: 15px 0 5px 0;
  }

  .hidden {
    display: none !important;
  }

  sl-progress-bar {
    --height: 7px;
    --track-color: var(--sl-color-primary-100);
    --indicator-color: var(--sl-color-primary-600);
    margin-bottom: 10px;
  }

  sl-range {
    --track-color-active: var(--sl-color-primary-600);
    --track-color-inactive: var(--sl-color-primary-100);
  }
`;var bJe=Object.defineProperty,xJe=Object.getOwnPropertyDescriptor,wJe=(e,t,n,r)=>{for(var i=r>1?void 0:r?xJe(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&bJe(t,n,i),i};let lY=class extends _t{render(){return he`
      <div class="c-button-group">
        <slot></slot>
      </div>
    `}};lY.styles=[St,Xt`
      .c-button-group {
        width: 100%;
        display: flex;
        justify-content: space-between;
        gap: 20px;
      }

      .c-button-group ::slotted(*) {
        flex-grow: 1;
      }
    `];lY=wJe([ze("c-button-group")],lY);var $Je=Object.defineProperty,CJe=Object.getOwnPropertyDescriptor,_Je=(e,t,n,r)=>{for(var i=r>1?void 0:r?CJe(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&$Je(t,n,i),i};let uY=class extends _t{render(){return he`
      <sl-card class="c-card">
        <h1><slot name="title"></slot></h1>
        <slot name="content"> </slot>
      </sl-card>
    `}};uY.styles=[St,Xt`
      :host {
        width: 100%;
      }

      .c-card {
        --padding: 10px 20px 20px 20px;
        margin: 0;
        width: 100%;
      }

      .c-card ::slotted(*[slot='content']) {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
    `];uY=_Je([ze("c-card")],uY);function cY(e){return e.type=="classification"}function xke(e){return e.type=="regression"}var SJe=Object.defineProperty,kJe=Object.getOwnPropertyDescriptor,wke=(e,t,n,r)=>{for(var i=r>1?void 0:r?kJe(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&SJe(t,n,i),i};let c5=class extends _t{getTooltipContent(){if(this.dataProperty.type){if(xke(this.dataProperty))return he`
          <p>Type: regression</p>
          <p>${this.dataProperty.description}</p>
        `;if(cY(this.dataProperty))return he`
          <p>Type: classification</p>
          <p>${this.dataProperty.description}</p>
          ${this.dataProperty.classes.map(e=>he` <p>${e.key}: ${e.description}</p> `)}
        `}else return he` <p>${this.dataProperty.description}</p> `}render(){return he`
      <sl-tooltip>
        <div slot="content">${this.getTooltipContent()}</div>
        <sl-tag pill> ${this.dataProperty.key} </sl-tag>
      </sl-tooltip>
    `}};c5.styles=[St];wke([Q({type:Object})],c5.prototype,"dataProperty",2);c5=wke([ze("c-data-info")],c5);/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class EJe extends Event{constructor(t,n,r){super("context-request",{bubbles:!0,composed:!0}),this.context=t,this.callback=n,this.subscribe=r}}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 *//**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class AJe{constructor(t,n,r,i){var s;if(this.subscribe=!1,this.provided=!1,this.value=void 0,this.t=(a,o)=>{this.unsubscribe&&(this.unsubscribe!==o&&(this.provided=!1,this.unsubscribe()),this.subscribe||this.unsubscribe()),this.value=a,this.host.requestUpdate(),this.provided&&!this.subscribe||(this.provided=!0,this.callback&&this.callback(a,o)),this.unsubscribe=o},this.host=t,n.context!==void 0){const a=n;this.context=a.context,this.callback=a.callback,this.subscribe=(s=a.subscribe)!==null&&s!==void 0&&s}else this.context=n,this.callback=r,this.subscribe=i!=null&&i;this.host.addController(this)}hostConnected(){this.dispatchRequest()}hostDisconnected(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=void 0)}dispatchRequest(){this.host.dispatchEvent(new EJe(this.context,this.t,this.subscribe))}}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class TJe{constructor(t){this.disposers=new Map,this.updateObservers=()=>{for(const[n,r]of this.disposers)n(this.o,r)},t!==void 0&&(this.value=t)}get value(){return this.o}set value(t){this.setValue(t)}setValue(t,n=!1){const r=n||!Object.is(t,this.o);this.o=t,r&&this.updateObservers()}addCallback(t,n){if(n){this.disposers.has(t)||this.disposers.set(t,()=>{this.disposers.delete(t)});const r=this.disposers.get(t);t(this.value,r)}else t(this.value)}clearCallbacks(){this.disposers.clear()}}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class DJe extends Event{constructor(t){super("context-provider",{bubbles:!0,composed:!0}),this.context=t}}class NJe extends TJe{constructor(t,n,r){super(n.context!==void 0?n.initialValue:r),this.onContextRequest=i=>{i.context===this.context&&i.composedPath()[0]!==this.host&&(i.stopPropagation(),this.addCallback(i.callback,i.subscribe))},this.host=t,n.context!==void 0?this.context=n.context:this.context=n,this.attachListeners(),this.host.addController(this)}attachListeners(){this.host.addEventListener("context-request",this.onContextRequest)}hostConnected(){this.host.dispatchEvent(new DJe(this.context))}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Fb({context:e}){return rB({finisher:(t,n)=>{const r=new WeakMap;t.addInitializer(o=>{r.set(o,new NJe(o,{context:e}))});const i=Object.getOwnPropertyDescriptor(t.prototype,n),s=i==null?void 0:i.set,a={...i,set:function(o){var l;(l=r.get(this))===null||l===void 0||l.setValue(o),s&&s.call(this,o)}};Object.defineProperty(t.prototype,n,a)}})}/**
 * @license
 * Copyright 2022 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function tn({context:e,subscribe:t}){return rB({finisher:(n,r)=>{n.addInitializer(i=>{new AJe(i,{context:e,callback:s=>{i[r]=s},subscribe:t})})}})}var mt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ob(e){var t=e.default;if(typeof t=="function"){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}function IJe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var aN=IJe,MJe=typeof mt=="object"&&mt&&mt.Object===Object&&mt,FJe=MJe,OJe=FJe,RJe=typeof self=="object"&&self&&self.Object===Object&&self,PJe=OJe||RJe||Function("return this")(),cB=PJe,LJe=cB,BJe=function(){return LJe.Date.now()},zJe=BJe,UJe=/\s/;function WJe(e){for(var t=e.length;t--&&UJe.test(e.charAt(t)););return t}var VJe=WJe,jJe=VJe,HJe=/^\s+/;function qJe(e){return e&&e.slice(0,jJe(e)+1).replace(HJe,"")}var GJe=qJe,YJe=cB,XJe=YJe.Symbol,kee=XJe,jde=kee,$ke=Object.prototype,KJe=$ke.hasOwnProperty,ZJe=$ke.toString,qS=jde?jde.toStringTag:void 0;function QJe(e){var t=KJe.call(e,qS),n=e[qS];try{e[qS]=void 0;var r=!0}catch{}var i=ZJe.call(e);return r&&(t?e[qS]=n:delete e[qS]),i}var JJe=QJe,eet=Object.prototype,tet=eet.toString;function net(e){return tet.call(e)}var ret=net,Hde=kee,iet=JJe,set=ret,aet="[object Null]",oet="[object Undefined]",qde=Hde?Hde.toStringTag:void 0;function uet(e){return e==null?e===void 0?oet:aet:qde&&qde in Object(e)?iet(e):set(e)}var Cke=uet;function cet(e){return e!=null&&typeof e=="object"}var fet=cet,het=Cke,det=fet,pet="[object Symbol]";function get(e){return typeof e=="symbol"||det(e)&&het(e)==pet}var oN=get,met=GJe,Gde=aN,vet=oN,Yde=0/0,yet=/^[-+]0x[0-9a-f]+$/i,bet=/^0b[01]+$/i,xet=/^0o[0-7]+$/i,wet=parseInt;function $et(e){if(typeof e=="number")return e;if(vet(e))return Yde;if(Gde(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Gde(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=met(e);var n=bet.test(e);return n||xet.test(e)?wet(e.slice(2),n?2:8):yet.test(e)?Yde:+e}var Cet=$et,_et=aN,XV=zJe,Xde=Cet,ket="Expected a function",Eet=Math.max,Aet=Math.min;function Tet(e,t,n){var r,i,s,a,o,l,u=0,c=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(ket);t=Xde(t)||0,_et(n)&&(c=!!n.leading,f="maxWait"in n,s=f?Eet(Xde(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h);function d(C){var $=r,_=i;return r=i=void 0,u=C,a=e.apply(_,$),a}function p(C){return u=C,o=setTimeout(v,t),c?d(C):a}function g(C){var $=C-l,_=C-u,k=t-$;return f?Aet(k,s-_):k}function m(C){var $=C-l,_=C-u;return l===void 0||$>=t||$<0||f&&_>=s}function v(){var C=XV();if(m(C))return y(C);o=setTimeout(v,g(C))}function y(C){return o=void 0,h&&r?d(C):(r=i=void 0,a)}function b(){o!==void 0&&clearTimeout(o),u=0,r=l=i=o=void 0}function x(){return o===void 0?a:y(XV())}function w(){var C=XV(),$=m(C);if(r=arguments,i=this,l=C,$){if(o===void 0)return p(l);if(f)return clearTimeout(o),o=setTimeout(v,t),d(l)}return o===void 0&&(o=setTimeout(v,t)),a}return w.cancel=b,w.flush=x,w}var Det=Tet,_ke={exports:{}},Ske={exports:{}};(function(e,t){(function(){var n,r,i,s,a,o,l,u,c,f,h,d,p,g,m;i=Math.floor,f=Math.min,r=function(v,y){return v<y?-1:v>y?1:0},c=function(v,y,b,x,w){var C;if(b==null&&(b=0),w==null&&(w=r),b<0)throw new Error("lo must be non-negative");for(x==null&&(x=v.length);b<x;)C=i((b+x)/2),w(y,v[C])<0?x=C:b=C+1;return[].splice.apply(v,[b,b-b].concat(y)),y},o=function(v,y,b){return b==null&&(b=r),v.push(y),g(v,0,v.length-1,b)},a=function(v,y){var b,x;return y==null&&(y=r),b=v.pop(),v.length?(x=v[0],v[0]=b,m(v,0,y)):x=b,x},u=function(v,y,b){var x;return b==null&&(b=r),x=v[0],v[0]=y,m(v,0,b),x},l=function(v,y,b){var x;return b==null&&(b=r),v.length&&b(v[0],y)<0&&(x=[v[0],y],y=x[0],v[0]=x[1],m(v,0,b)),y},s=function(v,y){var b,x,w,C,$,_;for(y==null&&(y=r),C=function(){_=[];for(var k=0,E=i(v.length/2);0<=E?k<E:k>E;0<=E?k++:k--)_.push(k);return _}.apply(this).reverse(),$=[],x=0,w=C.length;x<w;x++)b=C[x],$.push(m(v,b,y));return $},p=function(v,y,b){var x;if(b==null&&(b=r),x=v.indexOf(y),x!==-1)return g(v,0,x,b),m(v,x,b)},h=function(v,y,b){var x,w,C,$,_;if(b==null&&(b=r),w=v.slice(0,y),!w.length)return w;for(s(w,b),_=v.slice(y),C=0,$=_.length;C<$;C++)x=_[C],l(w,x,b);return w.sort(b).reverse()},d=function(v,y,b){var x,w,C,$,_,k,E,S,N;if(b==null&&(b=r),y*10<=v.length){if(C=v.slice(0,y).sort(b),!C.length)return C;for(w=C[C.length-1],E=v.slice(y),$=0,k=E.length;$<k;$++)x=E[$],b(x,w)<0&&(c(C,x,0,null,b),C.pop(),w=C[C.length-1]);return C}for(s(v,b),N=[],_=0,S=f(y,v.length);0<=S?_<S:_>S;0<=S?++_:--_)N.push(a(v,b));return N},g=function(v,y,b,x){var w,C,$;for(x==null&&(x=r),w=v[b];b>y;){if($=b-1>>1,C=v[$],x(w,C)<0){v[b]=C,b=$;continue}break}return v[b]=w},m=function(v,y,b){var x,w,C,$,_;for(b==null&&(b=r),w=v.length,_=y,C=v[y],x=2*y+1;x<w;)$=x+1,$<w&&!(b(v[x],v[$])<0)&&(x=$),v[y]=v[x],y=x,x=2*y+1;return v[y]=C,g(v,_,y,b)},n=function(){v.push=o,v.pop=a,v.replace=u,v.pushpop=l,v.heapify=s,v.updateItem=p,v.nlargest=h,v.nsmallest=d;function v(y){this.cmp=y!=null?y:r,this.nodes=[]}return v.prototype.push=function(y){return o(this.nodes,y,this.cmp)},v.prototype.pop=function(){return a(this.nodes,this.cmp)},v.prototype.peek=function(){return this.nodes[0]},v.prototype.contains=function(y){return this.nodes.indexOf(y)!==-1},v.prototype.replace=function(y){return u(this.nodes,y,this.cmp)},v.prototype.pushpop=function(y){return l(this.nodes,y,this.cmp)},v.prototype.heapify=function(){return s(this.nodes,this.cmp)},v.prototype.updateItem=function(y){return p(this.nodes,y,this.cmp)},v.prototype.clear=function(){return this.nodes=[]},v.prototype.empty=function(){return this.nodes.length===0},v.prototype.size=function(){return this.nodes.length},v.prototype.clone=function(){var y;return y=new v,y.nodes=this.nodes.slice(0),y},v.prototype.toArray=function(){return this.nodes.slice(0)},v.prototype.insert=v.prototype.push,v.prototype.top=v.prototype.peek,v.prototype.front=v.prototype.peek,v.prototype.has=v.prototype.contains,v.prototype.copy=v.prototype.clone,v}(),function(v,y){return e.exports=y()}(this,function(){return n})}).call(mt)})(Ske);(function(e){e.exports=Ske.exports})(_ke);var Net=Array.isArray,fB=Net,Iet=fB,Met=oN,Fet=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Oet=/^\w*$/;function Ret(e,t){if(Iet(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||Met(e)?!0:Oet.test(e)||!Fet.test(e)||t!=null&&e in Object(t)}var Pet=Ret,Let=Cke,Bet=aN,zet="[object AsyncFunction]",Uet="[object Function]",Wet="[object GeneratorFunction]",Vet="[object Proxy]";function jet(e){if(!Bet(e))return!1;var t=Let(e);return t==Uet||t==Wet||t==zet||t==Vet}var Het=jet,qet=cB,Get=qet["__core-js_shared__"],Yet=Get,KV=Yet,Kde=function(){var e=/[^.]+$/.exec(KV&&KV.keys&&KV.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Xet(e){return!!Kde&&Kde in e}var Ket=Xet,Zet=Function.prototype,Qet=Zet.toString;function Jet(e){if(e!=null){try{return Qet.call(e)}catch{}try{return e+""}catch{}}return""}var ett=Jet,ttt=Het,ntt=Ket,rtt=aN,itt=ett,stt=/[\\^$.*+?()[\]{}|]/g,att=/^\[object .+?Constructor\]$/,ott=Function.prototype,ltt=Object.prototype,utt=ott.toString,ctt=ltt.hasOwnProperty,ftt=RegExp("^"+utt.call(ctt).replace(stt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function htt(e){if(!rtt(e)||ntt(e))return!1;var t=ttt(e)?ftt:att;return t.test(itt(e))}var dtt=htt;function ptt(e,t){return e==null?void 0:e[t]}var gtt=ptt,mtt=dtt,vtt=gtt;function ytt(e,t){var n=vtt(e,t);return mtt(n)?n:void 0}var Eee=ytt,btt=Eee,xtt=btt(Object,"create"),hB=xtt,Zde=hB;function wtt(){this.__data__=Zde?Zde(null):{},this.size=0}var $tt=wtt;function Ctt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _tt=Ctt,Stt=hB,ktt="__lodash_hash_undefined__",Ett=Object.prototype,Att=Ett.hasOwnProperty;function Ttt(e){var t=this.__data__;if(Stt){var n=t[e];return n===ktt?void 0:n}return Att.call(t,e)?t[e]:void 0}var Dtt=Ttt,Ntt=hB,Itt=Object.prototype,Mtt=Itt.hasOwnProperty;function Ftt(e){var t=this.__data__;return Ntt?t[e]!==void 0:Mtt.call(t,e)}var Ott=Ftt,Rtt=hB,Ptt="__lodash_hash_undefined__";function Ltt(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Rtt&&t===void 0?Ptt:t,this}var Btt=Ltt,ztt=$tt,Utt=_tt,Wtt=Dtt,Vtt=Ott,jtt=Btt;function vC(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}vC.prototype.clear=ztt;vC.prototype.delete=Utt;vC.prototype.get=Wtt;vC.prototype.has=Vtt;vC.prototype.set=jtt;var Htt=vC;function qtt(){this.__data__=[],this.size=0}var Gtt=qtt;function Ytt(e,t){return e===t||e!==e&&t!==t}var kke=Ytt,Xtt=kke;function Ktt(e,t){for(var n=e.length;n--;)if(Xtt(e[n][0],t))return n;return-1}var dB=Ktt,Ztt=dB,Qtt=Array.prototype,Jtt=Qtt.splice;function ent(e){var t=this.__data__,n=Ztt(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Jtt.call(t,n,1),--this.size,!0}var tnt=ent,nnt=dB;function rnt(e){var t=this.__data__,n=nnt(t,e);return n<0?void 0:t[n][1]}var int=rnt,snt=dB;function ant(e){return snt(this.__data__,e)>-1}var ont=ant,lnt=dB;function unt(e,t){var n=this.__data__,r=lnt(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var cnt=unt,fnt=Gtt,hnt=tnt,dnt=int,pnt=ont,gnt=cnt;function yC(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}yC.prototype.clear=fnt;yC.prototype.delete=hnt;yC.prototype.get=dnt;yC.prototype.has=pnt;yC.prototype.set=gnt;var mnt=yC,vnt=Eee,ynt=cB,bnt=vnt(ynt,"Map"),xnt=bnt,Qde=Htt,wnt=mnt,$nt=xnt;function Cnt(){this.size=0,this.__data__={hash:new Qde,map:new($nt||wnt),string:new Qde}}var _nt=Cnt;function Snt(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var knt=Snt,Ent=knt;function Ant(e,t){var n=e.__data__;return Ent(t)?n[typeof t=="string"?"string":"hash"]:n.map}var pB=Ant,Tnt=pB;function Dnt(e){var t=Tnt(this,e).delete(e);return this.size-=t?1:0,t}var Nnt=Dnt,Int=pB;function Mnt(e){return Int(this,e).get(e)}var Fnt=Mnt,Ont=pB;function Rnt(e){return Ont(this,e).has(e)}var Pnt=Rnt,Lnt=pB;function Bnt(e,t){var n=Lnt(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var znt=Bnt,Unt=_nt,Wnt=Nnt,Vnt=Fnt,jnt=Pnt,Hnt=znt;function bC(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}bC.prototype.clear=Unt;bC.prototype.delete=Wnt;bC.prototype.get=Vnt;bC.prototype.has=jnt;bC.prototype.set=Hnt;var qnt=bC,Eke=qnt,Gnt="Expected a function";function Aee(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Gnt);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var a=e.apply(this,r);return n.cache=s.set(i,a)||s,a};return n.cache=new(Aee.Cache||Eke),n}Aee.Cache=Eke;var Ynt=Aee,Xnt=Ynt,Knt=500;function Znt(e){var t=Xnt(e,function(r){return n.size===Knt&&n.clear(),r}),n=t.cache;return t}var Qnt=Znt,Jnt=Qnt,ert=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,trt=/\\(\\)?/g,nrt=Jnt(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(ert,function(n,r,i,s){t.push(i?s.replace(trt,"$1"):r||n)}),t}),Ake=nrt;function rrt(e,t){for(var n=-1,r=e==null?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var Tke=rrt,Jde=kee,irt=Tke,srt=fB,art=oN,ort=1/0,epe=Jde?Jde.prototype:void 0,tpe=epe?epe.toString:void 0;function Dke(e){if(typeof e=="string")return e;if(srt(e))return irt(e,Dke)+"";if(art(e))return tpe?tpe.call(e):"";var t=e+"";return t=="0"&&1/e==-ort?"-0":t}var lrt=Dke,urt=lrt;function crt(e){return e==null?"":urt(e)}var Nke=crt,frt=fB,hrt=Pet,drt=Ake,prt=Nke;function grt(e,t){return frt(e)?e:hrt(e,t)?[e]:drt(prt(e))}var Ike=grt,mrt=oN,vrt=1/0;function yrt(e){if(typeof e=="string"||mrt(e))return e;var t=e+"";return t=="0"&&1/e==-vrt?"-0":t}var Tee=yrt,brt=Ike,xrt=Tee;function wrt(e,t){t=brt(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[xrt(t[n++])];return n&&n==r?e:void 0}var $rt=wrt,Crt=$rt;function _rt(e,t,n){var r=e==null?void 0:Crt(e,t);return r===void 0?n:r}var Srt=_rt,krt=Eee,Ert=function(){try{var e=krt(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Art=Ert,npe=Art;function Trt(e,t,n){t=="__proto__"&&npe?npe(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var Drt=Trt,Nrt=Drt,Irt=kke,Mrt=Object.prototype,Frt=Mrt.hasOwnProperty;function Ort(e,t,n){var r=e[t];(!(Frt.call(e,t)&&Irt(r,n))||n===void 0&&!(t in e))&&Nrt(e,t,n)}var Rrt=Ort,Prt=9007199254740991,Lrt=/^(?:0|[1-9]\d*)$/;function Brt(e,t){var n=typeof e;return t=t==null?Prt:t,!!t&&(n=="number"||n!="symbol"&&Lrt.test(e))&&e>-1&&e%1==0&&e<t}var zrt=Brt,Urt=Rrt,Wrt=Ike,Vrt=zrt,rpe=aN,jrt=Tee;function Hrt(e,t,n,r){if(!rpe(e))return e;t=Wrt(t,e);for(var i=-1,s=t.length,a=s-1,o=e;o!=null&&++i<s;){var l=jrt(t[i]),u=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(i!=a){var c=o[l];u=r?r(c,l,o):void 0,u===void 0&&(u=rpe(c)?c:Vrt(t[i+1])?[]:{})}Urt(o,l,u),o=o[l]}return e}var qrt=Hrt,Grt=qrt;function Yrt(e,t,n){return e==null?e:Grt(e,t,n)}var Xrt=Yrt;function Krt(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var Zrt=Krt,Qrt=Tke,Jrt=Zrt,eit=fB,tit=oN,nit=Ake,rit=Tee,iit=Nke;function sit(e){return eit(e)?Qrt(e,rit):tit(e)?[e]:Jrt(nit(iit(e)))}var ait=sit,oit=Det,lit=_ke.exports,uit=Srt,cit=Xrt,fit=ait;function lN(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var gB=lN(oit),uN=lN(lit),hit=lN(uit),dit=lN(cit),pit=lN(fit);function Mi(e){return Mi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mi(e)}function Dee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ipe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nee(e,t,n){return t&&ipe(e.prototype,t),n&&ipe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rd(e,t){return git(e)||mit(e,t)||vit(e,t)||yit()}function git(e){if(Array.isArray(e))return e}function mit(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],i=!0,s=!1,a,o;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(r.push(a.value),!(t&&r.length===t));i=!0);}catch(l){s=!0,o=l}finally{try{!i&&n.return!=null&&n.return()}finally{if(s)throw o}}return r}}function vit(e,t){if(!!e){if(typeof e=="string")return spe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return spe(e,t)}}function spe(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yit(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Er=typeof window>"u"?null:window,ape=Er?Er.navigator:null;Er&&Er.document;var bit=Mi(""),Fke=Mi({}),xit=Mi(function(){}),wit=typeof HTMLElement>"u"?"undefined":Mi(HTMLElement),cN=function(t){return t&&t.instanceString&&zr(t.instanceString)?t.instanceString():null},rt=function(t){return t!=null&&Mi(t)==bit},zr=function(t){return t!=null&&Mi(t)===xit},Jn=function(t){return!Rl(t)&&(Array.isArray?Array.isArray(t):t!=null&&t instanceof Array)},pn=function(t){return t!=null&&Mi(t)===Fke&&!Jn(t)&&t.constructor===Object},$it=function(t){return t!=null&&Mi(t)===Fke},Pe=function(t){return t!=null&&Mi(t)===Mi(1)&&!isNaN(t)},Cit=function(t){return Pe(t)&&Math.floor(t)===t},f5=function(t){if(wit!=="undefined")return t!=null&&t instanceof HTMLElement},Rl=function(t){return fN(t)||Oke(t)},fN=function(t){return cN(t)==="collection"&&t._private.single},Oke=function(t){return cN(t)==="collection"&&!t._private.single},Iee=function(t){return cN(t)==="core"},Rke=function(t){return cN(t)==="stylesheet"},_it=function(t){return cN(t)==="event"},O0=function(t){return t==null?!0:!!(t===""||t.match(/^\s+$/))},Sit=function(t){return typeof HTMLElement>"u"?!1:t instanceof HTMLElement},kit=function(t){return pn(t)&&Pe(t.x1)&&Pe(t.x2)&&Pe(t.y1)&&Pe(t.y2)},Eit=function(t){return $it(t)&&zr(t.then)},Ait=function(){return ape&&ape.userAgent.match(/msie|trident|edge/i)},eT=function(t,n){n||(n=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var s=[],a=0;a<arguments.length;a++)s.push(arguments[a]);return s.join("$")});var r=function i(){var s=this,a=arguments,o,l=n.apply(s,a),u=i.cache;return(o=u[l])||(o=u[l]=t.apply(s,a)),o};return r.cache={},r},Mee=eT(function(e){return e.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}),mB=eT(function(e){return e.replace(/(-\w)/g,function(t){return t[1].toUpperCase()})}),Pke=eT(function(e,t){return e+t[0].toUpperCase()+t.substring(1)},function(e,t){return e+"$"+t}),ope=function(t){return O0(t)?t:t.charAt(0).toUpperCase()+t.substring(1)},Ei="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",Tit="rgb[a]?\\(("+Ei+"[%]?)\\s*,\\s*("+Ei+"[%]?)\\s*,\\s*("+Ei+"[%]?)(?:\\s*,\\s*("+Ei+"))?\\)",Dit="rgb[a]?\\((?:"+Ei+"[%]?)\\s*,\\s*(?:"+Ei+"[%]?)\\s*,\\s*(?:"+Ei+"[%]?)(?:\\s*,\\s*(?:"+Ei+"))?\\)",Nit="hsl[a]?\\(("+Ei+")\\s*,\\s*("+Ei+"[%])\\s*,\\s*("+Ei+"[%])(?:\\s*,\\s*("+Ei+"))?\\)",Iit="hsl[a]?\\((?:"+Ei+")\\s*,\\s*(?:"+Ei+"[%])\\s*,\\s*(?:"+Ei+"[%])(?:\\s*,\\s*(?:"+Ei+"))?\\)",Mit="\\#[0-9a-fA-F]{3}",Fit="\\#[0-9a-fA-F]{6}",Lke=function(t,n){return t<n?-1:t>n?1:0},Oit=function(t,n){return-1*Lke(t,n)},gt=Object.assign!=null?Object.assign.bind(Object):function(e){for(var t=arguments,n=1;n<t.length;n++){var r=t[n];if(r!=null)for(var i=Object.keys(r),s=0;s<i.length;s++){var a=i[s];e[a]=r[a]}}return e},Rit=function(t){if(!(!(t.length===4||t.length===7)||t[0]!=="#")){var n=t.length===4,r,i,s,a=16;return n?(r=parseInt(t[1]+t[1],a),i=parseInt(t[2]+t[2],a),s=parseInt(t[3]+t[3],a)):(r=parseInt(t[1]+t[2],a),i=parseInt(t[3]+t[4],a),s=parseInt(t[5]+t[6],a)),[r,i,s]}},Pit=function(t){var n,r,i,s,a,o,l,u;function c(p,g,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?p+(g-p)*6*m:m<1/2?g:m<2/3?p+(g-p)*(2/3-m)*6:p}var f=new RegExp("^"+Nit+"$").exec(t);if(f){if(r=parseInt(f[1]),r<0?r=(360- -1*r%360)%360:r>360&&(r=r%360),r/=360,i=parseFloat(f[2]),i<0||i>100||(i=i/100,s=parseFloat(f[3]),s<0||s>100)||(s=s/100,a=f[4],a!==void 0&&(a=parseFloat(a),a<0||a>1)))return;if(i===0)o=l=u=Math.round(s*255);else{var h=s<.5?s*(1+i):s+i-s*i,d=2*s-h;o=Math.round(255*c(d,h,r+1/3)),l=Math.round(255*c(d,h,r)),u=Math.round(255*c(d,h,r-1/3))}n=[o,l,u,a]}return n},Lit=function(t){var n,r=new RegExp("^"+Tit+"$").exec(t);if(r){n=[];for(var i=[],s=1;s<=3;s++){var a=r[s];if(a[a.length-1]==="%"&&(i[s]=!0),a=parseFloat(a),i[s]&&(a=a/100*255),a<0||a>255)return;n.push(Math.floor(a))}var o=i[1]||i[2]||i[3],l=i[1]&&i[2]&&i[3];if(o&&!l)return;var u=r[4];if(u!==void 0){if(u=parseFloat(u),u<0||u>1)return;n.push(u)}}return n},Bit=function(t){return Uit[t.toLowerCase()]},zit=function(t){return(Jn(t)?t:null)||Bit(t)||Rit(t)||Lit(t)||Pit(t)},Uit={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Bke=function(t){for(var n=t.map,r=t.keys,i=r.length,s=0;s<i;s++){var a=r[s];if(pn(a))throw Error("Tried to set map with object key");s<r.length-1?(n[a]==null&&(n[a]={}),n=n[a]):n[a]=t.value}},zke=function(t){for(var n=t.map,r=t.keys,i=r.length,s=0;s<i;s++){var a=r[s];if(pn(a))throw Error("Tried to get map with object key");if(n=n[a],n==null)return n}return n},ZV=Er?Er.performance:null,Uke=ZV&&ZV.now?function(){return ZV.now()}:function(){return Date.now()},Wit=function(){if(Er){if(Er.requestAnimationFrame)return function(e){Er.requestAnimationFrame(e)};if(Er.mozRequestAnimationFrame)return function(e){Er.mozRequestAnimationFrame(e)};if(Er.webkitRequestAnimationFrame)return function(e){Er.webkitRequestAnimationFrame(e)};if(Er.msRequestAnimationFrame)return function(e){Er.msRequestAnimationFrame(e)}}return function(e){e&&setTimeout(function(){e(Uke())},1e3/60)}}(),h5=function(t){return Wit(t)},Ap=Uke,A2=9261,Wke=65599,eE=5381,Vke=function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A2,r=n,i;i=t.next(),!i.done;)r=r*Wke+i.value|0;return r},tT=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A2;return n*Wke+t|0},nT=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:eE;return(n<<5)+n+t|0},Vit=function(t,n){return t*2097152+n},Eg=function(t){return t[0]*2097152+t[1]},qF=function(t,n){return[tT(t[0],n[0]),nT(t[1],n[1])]},jit=function(t,n){var r={value:0,done:!1},i=0,s=t.length,a={next:function(){return i<s?r.value=t[i++]:r.done=!0,r}};return Vke(a,n)},Sy=function(t,n){var r={value:0,done:!1},i=0,s=t.length,a={next:function(){return i<s?r.value=t.charCodeAt(i++):r.done=!0,r}};return Vke(a,n)},jke=function(){return Hit(arguments)},Hit=function(t){for(var n,r=0;r<t.length;r++){var i=t[r];r===0?n=Sy(i):n=Sy(i,n)}return n},lpe=!0,qit=console.warn!=null,Git=console.trace!=null,Fee=Number.MAX_SAFE_INTEGER||9007199254740991,Hke=function(){return!0},d5=function(){return!1},upe=function(){return 0},Oee=function(){},Xr=function(t){throw new Error(t)},qke=function(t){if(t!==void 0)lpe=!!t;else return lpe},Rn=function(t){!qke()||(qit?console.warn(t):(console.log(t),Git&&console.trace()))},Yit=function(t){return gt({},t)},Kf=function(t){return t==null?t:Jn(t)?t.slice():pn(t)?Yit(t):t},Xit=function(t){return t.slice()},Gke=function(t,n){for(n=t="";t++<36;n+=t*51&52?(t^15?8^Math.random()*(t^20?16:4):4).toString(16):"-");return n},Kit={},Yke=function(){return Kit},Ys=function(t){var n=Object.keys(t);return function(r){for(var i={},s=0;s<n.length;s++){var a=n[s],o=r==null?void 0:r[a];i[a]=o===void 0?t[a]:o}return i}},R0=function(t,n,r){for(var i=t.length-1;i>=0&&!(t[i]===n&&(t.splice(i,1),r));i--);},Ree=function(t){t.splice(0,t.length)},Zit=function(t,n){for(var r=0;r<n.length;r++){var i=n[r];t.push(i)}},vc=function(t,n,r){return r&&(n=Pke(r,n)),t[n]},Hg=function(t,n,r,i){r&&(n=Pke(r,n)),t[n]=i},Qit=function(){function e(){Dee(this,e),this._obj={}}return Nee(e,[{key:"set",value:function(n,r){return this._obj[n]=r,this}},{key:"delete",value:function(n){return this._obj[n]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(n){return this._obj[n]!==void 0}},{key:"get",value:function(n){return this._obj[n]}}]),e}(),Zf=typeof Map<"u"?Map:Qit,Jit="undefined",est=function(){function e(t){if(Dee(this,e),this._obj=Object.create(null),this.size=0,t!=null){var n;t.instanceString!=null&&t.instanceString()===this.instanceString()?n=t.toArray():n=t;for(var r=0;r<n.length;r++)this.add(n[r])}}return Nee(e,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(n){var r=this._obj;r[n]!==1&&(r[n]=1,this.size++)}},{key:"delete",value:function(n){var r=this._obj;r[n]===1&&(r[n]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(n){return this._obj[n]===1}},{key:"toArray",value:function(){var n=this;return Object.keys(this._obj).filter(function(r){return n.has(r)})}},{key:"forEach",value:function(n,r){return this.toArray().forEach(n,r)}}]),e}(),xC=(typeof Set>"u"?"undefined":Mi(Set))!==Jit?Set:est,vB=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(t===void 0||n===void 0||!Iee(t)){Xr("An element must have a core reference and parameters set");return}var i=n.group;if(i==null&&(n.data&&n.data.source!=null&&n.data.target!=null?i="edges":i="nodes"),i!=="nodes"&&i!=="edges"){Xr("An element must be of type `nodes` or `edges`; you specified `"+i+"`");return}this.length=1,this[0]=this;var s=this._private={cy:t,single:!0,data:n.data||{},position:n.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!n.selected,selectable:n.selectable===void 0?!0:!!n.selectable,locked:!!n.locked,grabbed:!1,grabbable:n.grabbable===void 0?!0:!!n.grabbable,pannable:n.pannable===void 0?i==="edges":!!n.pannable,active:!1,classes:new xC,animation:{current:[],queue:[]},rscratch:{},scratch:n.scratch||{},edges:[],children:[],parent:n.parent&&n.parent.isNode()?n.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(s.position.x==null&&(s.position.x=0),s.position.y==null&&(s.position.y=0),n.renderedPosition){var a=n.renderedPosition,o=t.pan(),l=t.zoom();s.position={x:(a.x-o.x)/l,y:(a.y-o.y)/l}}var u=[];Jn(n.classes)?u=n.classes:rt(n.classes)&&(u=n.classes.split(/\s+/));for(var c=0,f=u.length;c<f;c++){var h=u[c];!h||h===""||s.classes.add(h)}this.createEmitter();var d=n.style||n.css;d&&(Rn("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(d)),(r===void 0||r)&&this.restore()},cpe=function(t){return t={bfs:t.bfs||!t.dfs,dfs:t.dfs||!t.bfs},function(r,i,s){var a;pn(r)&&!Rl(r)&&(a=r,r=a.roots||a.root,i=a.visit,s=a.directed),s=arguments.length===2&&!zr(i)?i:s,i=zr(i)?i:function(){};for(var o=this._private.cy,l=r=rt(r)?this.filter(r):r,u=[],c=[],f={},h={},d={},p=0,g,m=this.byGroup(),v=m.nodes,y=m.edges,b=0;b<l.length;b++){var x=l[b],w=x.id();x.isNode()&&(u.unshift(x),t.bfs&&(d[w]=!0,c.push(x)),h[w]=0)}for(var C=function(){var A=t.bfs?u.shift():u.pop(),D=A.id();if(t.dfs){if(d[D])return"continue";d[D]=!0,c.push(A)}var T=h[D],I=f[D],F=I!=null?I.source():null,R=I!=null?I.target():null,P=I==null?void 0:A.same(F)?R[0]:F[0],V=void 0;if(V=i(A,I,P,p++,T),V===!0)return g=A,"break";if(V===!1)return"break";for(var z=A.connectedEdges().filter(function(te){return(!s||te.source().same(A))&&y.has(te)}),q=0;q<z.length;q++){var G=z[q],K=G.connectedNodes().filter(function(te){return!te.same(A)&&v.has(te)}),Y=K.id();K.length!==0&&!d[Y]&&(K=K[0],u.push(K),t.bfs&&(d[Y]=!0,c.push(K)),f[Y]=G,h[Y]=h[D]+1)}};u.length!==0;){var $=C();if($!=="continue"&&$==="break")break}for(var _=o.collection(),k=0;k<c.length;k++){var E=c[k],S=f[E.id()];S!=null&&_.push(S),_.push(E)}return{path:o.collection(_),found:o.collection(g)}}},rT={breadthFirstSearch:cpe({bfs:!0}),depthFirstSearch:cpe({dfs:!0})};rT.bfs=rT.breadthFirstSearch;rT.dfs=rT.depthFirstSearch;var tst=Ys({root:null,weight:function(t){return 1},directed:!1}),nst={dijkstra:function(t){if(!pn(t)){var n=arguments;t={root:n[0],weight:n[1],directed:n[2]}}var r=tst(t),i=r.root,s=r.weight,a=r.directed,o=this,l=s,u=rt(i)?this.filter(i)[0]:i[0],c={},f={},h={},d=this.byGroup(),p=d.nodes,g=d.edges;g.unmergeBy(function(T){return T.isLoop()});for(var m=function(I){return c[I.id()]},v=function(I,F){c[I.id()]=F,y.updateItem(I)},y=new uN.default(function(T,I){return m(T)-m(I)}),b=0;b<p.length;b++){var x=p[b];c[x.id()]=x.same(u)?0:1/0,y.push(x)}for(var w=function(I,F){for(var R=(a?I.edgesTo(F):I.edgesWith(F)).intersect(g),P=1/0,V,z=0;z<R.length;z++){var q=R[z],G=l(q);(G<P||!V)&&(P=G,V=q)}return{edge:V,dist:P}};y.size()>0;){var C=y.pop(),$=m(C),_=C.id();if(h[_]=$,$!==1/0)for(var k=C.neighborhood().intersect(p),E=0;E<k.length;E++){var S=k[E],N=S.id(),A=w(C,S),D=$+A.dist;D<m(S)&&(v(S,D),f[N]={node:C,edge:A.edge})}}return{distanceTo:function(I){var F=rt(I)?p.filter(I)[0]:I[0];return h[F.id()]},pathTo:function(I){var F=rt(I)?p.filter(I)[0]:I[0],R=[],P=F,V=P.id();if(F.length>0)for(R.unshift(F);f[V];){var z=f[V];R.unshift(z.edge),R.unshift(z.node),P=z.node,V=P.id()}return o.spawn(R)}}}},rst={kruskal:function(t){t=t||function(b){return 1};for(var n=this.byGroup(),r=n.nodes,i=n.edges,s=r.length,a=new Array(s),o=r,l=function(x){for(var w=0;w<a.length;w++){var C=a[w];if(C.has(x))return w}},u=0;u<s;u++)a[u]=this.spawn(r[u]);for(var c=i.sort(function(b,x){return t(b)-t(x)}),f=0;f<c.length;f++){var h=c[f],d=h.source()[0],p=h.target()[0],g=l(d),m=l(p),v=a[g],y=a[m];g!==m&&(o.merge(h),v.merge(y),a.splice(m,1))}return o}},ist=Ys({root:null,goal:null,weight:function(t){return 1},heuristic:function(t){return 0},directed:!1}),sst={aStar:function(t){var n=this.cy(),r=ist(t),i=r.root,s=r.goal,a=r.heuristic,o=r.directed,l=r.weight;i=n.collection(i)[0],s=n.collection(s)[0];var u=i.id(),c=s.id(),f={},h={},d={},p=new uN.default(function(V,z){return h[V.id()]-h[z.id()]}),g=new xC,m={},v={},y=function(z,q){p.push(z),g.add(q)},b,x,w=function(){b=p.pop(),x=b.id(),g.delete(x)},C=function(z){return g.has(z)};y(i,u),f[u]=0,h[u]=a(i);for(var $=0;p.size()>0;){if(w(),$++,x===c){for(var _=[],k=s,E=c,S=v[E];_.unshift(k),S!=null&&_.unshift(S),k=m[E],k!=null;)E=k.id(),S=v[E];return{found:!0,distance:f[x],path:this.spawn(_),steps:$}}d[x]=!0;for(var N=b._private.edges,A=0;A<N.length;A++){var D=N[A];if(!!this.hasElementWithId(D.id())&&!(o&&D.data("source")!==x)){var T=D.source(),I=D.target(),F=T.id()!==x?T:I,R=F.id();if(!!this.hasElementWithId(R)&&!d[R]){var P=f[x]+l(D);if(!C(R)){f[R]=P,h[R]=P+a(F),y(F,R),m[R]=b,v[R]=D;continue}P<f[R]&&(f[R]=P,h[R]=P+a(F),m[R]=b,v[R]=D)}}}}return{found:!1,distance:void 0,path:void 0,steps:$}}},ast=Ys({weight:function(t){return 1},directed:!1}),ost={floydWarshall:function(t){for(var n=this.cy(),r=ast(t),i=r.weight,s=r.directed,a=i,o=this.byGroup(),l=o.nodes,u=o.edges,c=l.length,f=c*c,h=function(G){return l.indexOf(G)},d=function(G){return l[G]},p=new Array(f),g=0;g<f;g++){var m=g%c,v=(g-m)/c;v===m?p[g]=0:p[g]=1/0}for(var y=new Array(f),b=new Array(f),x=0;x<u.length;x++){var w=u[x],C=w.source()[0],$=w.target()[0];if(C!==$){var _=h(C),k=h($),E=_*c+k,S=a(w);if(p[E]>S&&(p[E]=S,y[E]=k,b[E]=w),!s){var N=k*c+_;!s&&p[N]>S&&(p[N]=S,y[N]=_,b[N]=w)}}}for(var A=0;A<c;A++)for(var D=0;D<c;D++)for(var T=D*c+A,I=0;I<c;I++){var F=D*c+I,R=A*c+I;p[T]+p[R]<p[F]&&(p[F]=p[T]+p[R],y[F]=y[T])}var P=function(G){return(rt(G)?n.filter(G):G)[0]},V=function(G){return h(P(G))},z={distance:function(G,K){var Y=V(G),te=V(K);return p[Y*c+te]},path:function(G,K){var Y=V(G),te=V(K),Z=d(Y);if(Y===te)return Z.collection();if(y[Y*c+te]==null)return n.collection();var ae=n.collection(),O=Y,L;for(ae.merge(Z);Y!==te;)O=Y,Y=y[Y*c+te],L=b[O*c+Y],ae.merge(L),ae.merge(d(Y));return ae}};return z}},lst=Ys({weight:function(t){return 1},directed:!1,root:null}),ust={bellmanFord:function(t){var n=this,r=lst(t),i=r.weight,s=r.directed,a=r.root,o=i,l=this,u=this.cy(),c=this.byGroup(),f=c.edges,h=c.nodes,d=h.length,p=new Zf,g=!1,m=[];a=u.collection(a)[0],f.unmergeBy(function(pe){return pe.isLoop()});for(var v=f.length,y=function(Ce){var Ue=p.get(Ce.id());return Ue||(Ue={},p.set(Ce.id(),Ue)),Ue},b=function(Ce){return(rt(Ce)?u.$(Ce):Ce)[0]},x=function(Ce){return y(b(Ce)).dist},w=function(Ce){for(var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a,et=b(Ce),dt=[],He=et;;){if(He==null)return n.spawn();var Se=y(He),j=Se.edge,fe=Se.pred;if(dt.unshift(He[0]),He.same(Ue)&&dt.length>0)break;j!=null&&dt.unshift(j),He=fe}return l.spawn(dt)},C=0;C<d;C++){var $=h[C],_=y($);$.same(a)?_.dist=0:_.dist=1/0,_.pred=null,_.edge=null}for(var k=!1,E=function(Ce,Ue,et,dt,He,Se){var j=dt.dist+Se;j<He.dist&&!et.same(dt.edge)&&(He.dist=j,He.pred=Ce,He.edge=et,k=!0)},S=1;S<d;S++){k=!1;for(var N=0;N<v;N++){var A=f[N],D=A.source(),T=A.target(),I=o(A),F=y(D),R=y(T);E(D,T,A,F,R,I),s||E(T,D,A,R,F,I)}if(!k)break}if(k)for(var P=[],V=0;V<v;V++){var z=f[V],q=z.source(),G=z.target(),K=o(z),Y=y(q).dist,te=y(G).dist;if(Y+K<te||!s&&te+K<Y)if(g||(Rn("Graph contains a negative weight cycle for Bellman-Ford"),g=!0),t.findNegativeWeightCycles!==!1){var Z=[];Y+K<te&&Z.push(q),!s&&te+K<Y&&Z.push(G);for(var ae=Z.length,O=0;O<ae;O++){var L=Z[O],W=[L];W.push(y(L).edge);for(var M=y(L).pred;W.indexOf(M)===-1;)W.push(M),W.push(y(M).edge),M=y(M).pred;W=W.slice(W.indexOf(M));for(var ue=W[0].id(),X=0,se=2;se<W.length;se+=2)W[se].id()<ue&&(ue=W[se].id(),X=se);W=W.slice(X).concat(W.slice(0,X)),W.push(W[0]);var oe=W.map(function(pe){return pe.id()}).join(",");P.indexOf(oe)===-1&&(m.push(l.spawn(W)),P.push(oe))}}else break}return{distanceTo:x,pathTo:w,hasNegativeWeightCycle:g,negativeWeightCycles:m}}},cst=Math.sqrt(2),fst=function(t,n,r){r.length===0&&Xr("Karger-Stein must be run on a connected (sub)graph");for(var i=r[t],s=i[1],a=i[2],o=n[s],l=n[a],u=r,c=u.length-1;c>=0;c--){var f=u[c],h=f[1],d=f[2];(n[h]===o&&n[d]===l||n[h]===l&&n[d]===o)&&u.splice(c,1)}for(var p=0;p<u.length;p++){var g=u[p];g[1]===l?(u[p]=g.slice(),u[p][1]=o):g[2]===l&&(u[p]=g.slice(),u[p][2]=o)}for(var m=0;m<n.length;m++)n[m]===l&&(n[m]=o);return u},QV=function(t,n,r,i){for(;r>i;){var s=Math.floor(Math.random()*n.length);n=fst(s,t,n),r--}return n},hst={kargerStein:function(){var t=this,n=this.byGroup(),r=n.nodes,i=n.edges;i.unmergeBy(function(R){return R.isLoop()});var s=r.length,a=i.length,o=Math.ceil(Math.pow(Math.log(s)/Math.LN2,2)),l=Math.floor(s/cst);if(s<2){Xr("At least 2 nodes are required for Karger-Stein algorithm");return}for(var u=[],c=0;c<a;c++){var f=i[c];u.push([c,r.indexOf(f.source()),r.indexOf(f.target())])}for(var h=1/0,d=[],p=new Array(s),g=new Array(s),m=new Array(s),v=function(P,V){for(var z=0;z<s;z++)V[z]=P[z]},y=0;y<=o;y++){for(var b=0;b<s;b++)g[b]=b;var x=QV(g,u.slice(),s,l),w=x.slice();v(g,m);var C=QV(g,x,l,2),$=QV(m,w,l,2);C.length<=$.length&&C.length<h?(h=C.length,d=C,v(g,p)):$.length<=C.length&&$.length<h&&(h=$.length,d=$,v(m,p))}for(var _=this.spawn(d.map(function(R){return i[R[0]]})),k=this.spawn(),E=this.spawn(),S=p[0],N=0;N<p.length;N++){var A=p[N],D=r[N];A===S?k.merge(D):E.merge(D)}var T=function(P){var V=t.spawn();return P.forEach(function(z){V.merge(z),z.connectedEdges().forEach(function(q){t.contains(q)&&!_.contains(q)&&V.merge(q)})}),V},I=[T(k),T(E)],F={cut:_,components:I,partition1:k,partition2:E};return F}},dst=function(t){return{x:t.x,y:t.y}},yB=function(t,n,r){return{x:t.x*n+r.x,y:t.y*n+r.y}},Xke=function(t,n,r){return{x:(t.x-r.x)/n,y:(t.y-r.y)/n}},T2=function(t){return{x:t[0],y:t[1]}},pst=function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,i=1/0,s=n;s<r;s++){var a=t[s];isFinite(a)&&(i=Math.min(a,i))}return i},gst=function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,i=-1/0,s=n;s<r;s++){var a=t[s];isFinite(a)&&(i=Math.max(a,i))}return i},mst=function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,i=0,s=0,a=n;a<r;a++){var o=t[a];isFinite(o)&&(i+=o,s++)}return i/s},vst=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;i?t=t.slice(n,r):(r<t.length&&t.splice(r,t.length-r),n>0&&t.splice(0,n));for(var o=0,l=t.length-1;l>=0;l--){var u=t[l];a?isFinite(u)||(t[l]=-1/0,o++):t.splice(l,1)}s&&t.sort(function(h,d){return h-d});var c=t.length,f=Math.floor(c/2);return c%2!==0?t[f+1+o]:(t[f-1+o]+t[f+o])/2},yst=function(t){return Math.PI*t/180},GF=function(t,n){return Math.atan2(n,t)-Math.PI/2},Pee=Math.log2||function(e){return Math.log(e)/Math.log(2)},Kke=function(t){return t>0?1:t<0?-1:0},ky=function(t,n){return Math.sqrt(Hv(t,n))},Hv=function(t,n){var r=n.x-t.x,i=n.y-t.y;return r*r+i*i},bst=function(t){for(var n=t.length,r=0,i=0;i<n;i++)r+=t[i];for(var s=0;s<n;s++)t[s]=t[s]/r;return t},Xi=function(t,n,r,i){return(1-i)*(1-i)*t+2*(1-i)*i*n+i*i*r},W2=function(t,n,r,i){return{x:Xi(t.x,n.x,r.x,i),y:Xi(t.y,n.y,r.y,i)}},xst=function(t,n,r,i){var s={x:n.x-t.x,y:n.y-t.y},a=ky(t,n),o={x:s.x/a,y:s.y/a};return r=r==null?0:r,i=i!=null?i:r*a,{x:t.x+o.x*i,y:t.y+o.y*i}},iT=function(t,n,r){return Math.max(t,Math.min(r,n))},il=function(t){if(t==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(t.x1!=null&&t.y1!=null){if(t.x2!=null&&t.y2!=null&&t.x2>=t.x1&&t.y2>=t.y1)return{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,w:t.x2-t.x1,h:t.y2-t.y1};if(t.w!=null&&t.h!=null&&t.w>=0&&t.h>=0)return{x1:t.x1,y1:t.y1,x2:t.x1+t.w,y2:t.y1+t.h,w:t.w,h:t.h}}},wst=function(t){return{x1:t.x1,x2:t.x2,w:t.w,y1:t.y1,y2:t.y2,h:t.h}},$st=function(t){t.x1=1/0,t.y1=1/0,t.x2=-1/0,t.y2=-1/0,t.w=0,t.h=0},Cst=function(t,n){t.x1=Math.min(t.x1,n.x1),t.x2=Math.max(t.x2,n.x2),t.w=t.x2-t.x1,t.y1=Math.min(t.y1,n.y1),t.y2=Math.max(t.y2,n.y2),t.h=t.y2-t.y1},_st=function(t,n,r){t.x1=Math.min(t.x1,n),t.x2=Math.max(t.x2,n),t.w=t.x2-t.x1,t.y1=Math.min(t.y1,r),t.y2=Math.max(t.y2,r),t.h=t.y2-t.y1},ZR=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.x1-=n,t.x2+=n,t.y1-=n,t.y2+=n,t.w=t.x2-t.x1,t.h=t.y2-t.y1,t},JV=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],r,i,s,a;if(n.length===1)r=i=s=a=n[0];else if(n.length===2)r=s=n[0],a=i=n[1];else if(n.length===4){var o=Rd(n,4);r=o[0],i=o[1],s=o[2],a=o[3]}return t.x1-=a,t.x2+=i,t.y1-=r,t.y2+=s,t.w=t.x2-t.x1,t.h=t.y2-t.y1,t},fpe=function(t,n){t.x1=n.x1,t.y1=n.y1,t.x2=n.x2,t.y2=n.y2,t.w=t.x2-t.x1,t.h=t.y2-t.y1},Lee=function(t,n){return!(t.x1>n.x2||n.x1>t.x2||t.x2<n.x1||n.x2<t.x1||t.y2<n.y1||n.y2<t.y1||t.y1>n.y2||n.y1>t.y2)},Ew=function(t,n,r){return t.x1<=n&&n<=t.x2&&t.y1<=r&&r<=t.y2},Sst=function(t,n){return Ew(t,n.x,n.y)},Zke=function(t,n){return Ew(t,n.x1,n.y1)&&Ew(t,n.x2,n.y2)},Qke=function(t,n,r,i,s,a,o){var l=hN(s,a),u=s/2,c=a/2,f;{var h=r-u+l-o,d=i-c-o,p=r+u-l+o,g=d;if(f=Xg(t,n,r,i,h,d,p,g,!1),f.length>0)return f}{var m=r+u+o,v=i-c+l-o,y=m,b=i+c-l+o;if(f=Xg(t,n,r,i,m,v,y,b,!1),f.length>0)return f}{var x=r-u+l-o,w=i+c+o,C=r+u-l+o,$=w;if(f=Xg(t,n,r,i,x,w,C,$,!1),f.length>0)return f}{var _=r-u-o,k=i-c+l-o,E=_,S=i+c-l+o;if(f=Xg(t,n,r,i,_,k,E,S,!1),f.length>0)return f}var N;{var A=r-u+l,D=i-c+l;if(N=tE(t,n,r,i,A,D,l+o),N.length>0&&N[0]<=A&&N[1]<=D)return[N[0],N[1]]}{var T=r+u-l,I=i-c+l;if(N=tE(t,n,r,i,T,I,l+o),N.length>0&&N[0]>=T&&N[1]<=I)return[N[0],N[1]]}{var F=r+u-l,R=i+c-l;if(N=tE(t,n,r,i,F,R,l+o),N.length>0&&N[0]>=F&&N[1]>=R)return[N[0],N[1]]}{var P=r-u+l,V=i+c-l;if(N=tE(t,n,r,i,P,V,l+o),N.length>0&&N[0]<=P&&N[1]>=V)return[N[0],N[1]]}return[]},kst=function(t,n,r,i,s,a,o){var l=o,u=Math.min(r,s),c=Math.max(r,s),f=Math.min(i,a),h=Math.max(i,a);return u-l<=t&&t<=c+l&&f-l<=n&&n<=h+l},Est=function(t,n,r,i,s,a,o,l,u){var c={x1:Math.min(r,o,s)-u,x2:Math.max(r,o,s)+u,y1:Math.min(i,l,a)-u,y2:Math.max(i,l,a)+u};return!(t<c.x1||t>c.x2||n<c.y1||n>c.y2)},Ast=function(t,n,r,i){r-=i;var s=n*n-4*t*r;if(s<0)return[];var a=Math.sqrt(s),o=2*t,l=(-n+a)/o,u=(-n-a)/o;return[l,u]},Tst=function(t,n,r,i,s){var a=1e-5;t===0&&(t=a),n/=t,r/=t,i/=t;var o,l,u,c,f,h,d,p;if(l=(3*r-n*n)/9,u=-(27*i)+n*(9*r-2*(n*n)),u/=54,o=l*l*l+u*u,s[1]=0,d=n/3,o>0){f=u+Math.sqrt(o),f=f<0?-Math.pow(-f,1/3):Math.pow(f,1/3),h=u-Math.sqrt(o),h=h<0?-Math.pow(-h,1/3):Math.pow(h,1/3),s[0]=-d+f+h,d+=(f+h)/2,s[4]=s[2]=-d,d=Math.sqrt(3)*(-h+f)/2,s[3]=d,s[5]=-d;return}if(s[5]=s[3]=0,o===0){p=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3),s[0]=-d+2*p,s[4]=s[2]=-(p+d);return}l=-l,c=l*l*l,c=Math.acos(u/Math.sqrt(c)),p=2*Math.sqrt(l),s[0]=-d+p*Math.cos(c/3),s[2]=-d+p*Math.cos((c+2*Math.PI)/3),s[4]=-d+p*Math.cos((c+4*Math.PI)/3)},Dst=function(t,n,r,i,s,a,o,l){var u=1*r*r-4*r*s+2*r*o+4*s*s-4*s*o+o*o+i*i-4*i*a+2*i*l+4*a*a-4*a*l+l*l,c=1*9*r*s-3*r*r-3*r*o-6*s*s+3*s*o+9*i*a-3*i*i-3*i*l-6*a*a+3*a*l,f=1*3*r*r-6*r*s+r*o-r*t+2*s*s+2*s*t-o*t+3*i*i-6*i*a+i*l-i*n+2*a*a+2*a*n-l*n,h=1*r*s-r*r+r*t-s*t+i*a-i*i+i*n-a*n,d=[];Tst(u,c,f,h,d);for(var p=1e-7,g=[],m=0;m<6;m+=2)Math.abs(d[m+1])<p&&d[m]>=0&&d[m]<=1&&g.push(d[m]);g.push(1),g.push(0);for(var v=-1,y,b,x,w=0;w<g.length;w++)y=Math.pow(1-g[w],2)*r+2*(1-g[w])*g[w]*s+g[w]*g[w]*o,b=Math.pow(1-g[w],2)*i+2*(1-g[w])*g[w]*a+g[w]*g[w]*l,x=Math.pow(y-t,2)+Math.pow(b-n,2),v>=0?x<v&&(v=x):v=x;return v},Nst=function(t,n,r,i,s,a){var o=[t-r,n-i],l=[s-r,a-i],u=l[0]*l[0]+l[1]*l[1],c=o[0]*o[0]+o[1]*o[1],f=o[0]*l[0]+o[1]*l[1],h=f*f/u;return f<0?c:h>u?(t-s)*(t-s)+(n-a)*(n-a):c-h},Bo=function(t,n,r){for(var i,s,a,o,l,u=0,c=0;c<r.length/2;c++)if(i=r[c*2],s=r[c*2+1],c+1<r.length/2?(a=r[(c+1)*2],o=r[(c+1)*2+1]):(a=r[(c+1-r.length/2)*2],o=r[(c+1-r.length/2)*2+1]),!(i==t&&a==t))if(i>=t&&t>=a||i<=t&&t<=a)l=(t-i)/(a-i)*(o-s)+s,l>n&&u++;else continue;return u%2!==0},Tp=function(t,n,r,i,s,a,o,l,u){var c=new Array(r.length),f;l[0]!=null?(f=Math.atan(l[1]/l[0]),l[0]<0?f=f+Math.PI/2:f=-f-Math.PI/2):f=l;for(var h=Math.cos(-f),d=Math.sin(-f),p=0;p<c.length/2;p++)c[p*2]=a/2*(r[p*2]*h-r[p*2+1]*d),c[p*2+1]=o/2*(r[p*2+1]*h+r[p*2]*d),c[p*2]+=i,c[p*2+1]+=s;var g;if(u>0){var m=eEe(c,-u);g=Jke(m)}else g=c;return Bo(t,n,g)},Ist=function(t,n,r,i,s,a,o){for(var l=new Array(r.length),u=a/2,c=o/2,f=Bee(a,o),h=f*f,d=0;d<r.length/4;d++){var p=void 0,g=void 0;d===0?p=r.length-2:p=d*4-2,g=d*4+2;var m=i+u*r[d*4],v=s+c*r[d*4+1],y=-r[p]*r[g]-r[p+1]*r[g+1],b=f/Math.tan(Math.acos(y)/2),x=m-b*r[p],w=v-b*r[p+1],C=m+b*r[g],$=v+b*r[g+1];l[d*4]=x,l[d*4+1]=w,l[d*4+2]=C,l[d*4+3]=$;var _=r[p+1],k=-r[p],E=_*r[g]+k*r[g+1];E<0&&(_*=-1,k*=-1);var S=x+_*f,N=w+k*f,A=Math.pow(S-t,2)+Math.pow(N-n,2);if(A<=h)return!0}return Bo(t,n,l)},Jke=function(t){for(var n=new Array(t.length/2),r,i,s,a,o,l,u,c,f=0;f<t.length/4;f++){r=t[f*4],i=t[f*4+1],s=t[f*4+2],a=t[f*4+3],f<t.length/4-1?(o=t[(f+1)*4],l=t[(f+1)*4+1],u=t[(f+1)*4+2],c=t[(f+1)*4+3]):(o=t[0],l=t[1],u=t[2],c=t[3]);var h=Xg(r,i,s,a,o,l,u,c,!0);n[f*2]=h[0],n[f*2+1]=h[1]}return n},eEe=function(t,n){for(var r=new Array(t.length*2),i,s,a,o,l=0;l<t.length/2;l++){i=t[l*2],s=t[l*2+1],l<t.length/2-1?(a=t[(l+1)*2],o=t[(l+1)*2+1]):(a=t[0],o=t[1]);var u=o-s,c=-(a-i),f=Math.sqrt(u*u+c*c),h=u/f,d=c/f;r[l*4]=i+h*n,r[l*4+1]=s+d*n,r[l*4+2]=a+h*n,r[l*4+3]=o+d*n}return r},Mst=function(t,n,r,i,s,a){var o=r-t,l=i-n;o/=s,l/=a;var u=Math.sqrt(o*o+l*l),c=u-1;if(c<0)return[];var f=c/u;return[(r-t)*f+t,(i-n)*f+n]},_1=function(t,n,r,i,s,a,o){return t-=s,n-=a,t/=r/2+o,n/=i/2+o,t*t+n*n<=1},tE=function(t,n,r,i,s,a,o){var l=[r-t,i-n],u=[t-s,n-a],c=l[0]*l[0]+l[1]*l[1],f=2*(u[0]*l[0]+u[1]*l[1]),h=u[0]*u[0]+u[1]*u[1]-o*o,d=f*f-4*c*h;if(d<0)return[];var p=(-f+Math.sqrt(d))/(2*c),g=(-f-Math.sqrt(d))/(2*c),m=Math.min(p,g),v=Math.max(p,g),y=[];if(m>=0&&m<=1&&y.push(m),v>=0&&v<=1&&y.push(v),y.length===0)return[];var b=y[0]*l[0]+t,x=y[0]*l[1]+n;if(y.length>1){if(y[0]==y[1])return[b,x];var w=y[1]*l[0]+t,C=y[1]*l[1]+n;return[b,x,w,C]}else return[b,x]},ej=function(t,n,r){return n<=t&&t<=r||r<=t&&t<=n?t:t<=n&&n<=r||r<=n&&n<=t?n:r},Xg=function(t,n,r,i,s,a,o,l,u){var c=t-s,f=r-t,h=o-s,d=n-a,p=i-n,g=l-a,m=h*d-g*c,v=f*d-p*c,y=g*f-h*p;if(y!==0){var b=m/y,x=v/y,w=.001,C=0-w,$=1+w;return C<=b&&b<=$&&C<=x&&x<=$?[t+b*f,n+b*p]:u?[t+b*f,n+b*p]:[]}else return m===0||v===0?ej(t,r,o)===o?[o,l]:ej(t,r,s)===s?[s,a]:ej(s,o,r)===r?[r,i]:[]:[]},sT=function(t,n,r,i,s,a,o,l){var u=[],c,f=new Array(r.length),h=!0;a==null&&(h=!1);var d;if(h){for(var p=0;p<f.length/2;p++)f[p*2]=r[p*2]*a+i,f[p*2+1]=r[p*2+1]*o+s;if(l>0){var g=eEe(f,-l);d=Jke(g)}else d=f}else d=r;for(var m,v,y,b,x=0;x<d.length/2;x++)m=d[x*2],v=d[x*2+1],x<d.length/2-1?(y=d[(x+1)*2],b=d[(x+1)*2+1]):(y=d[0],b=d[1]),c=Xg(t,n,i,s,m,v,y,b),c.length!==0&&u.push(c[0],c[1]);return u},Fst=function(t,n,r,i,s,a,o,l){for(var u=[],c,f=new Array(r.length),h=a/2,d=o/2,p=Bee(a,o),g=0;g<r.length/4;g++){var m=void 0,v=void 0;g===0?m=r.length-2:m=g*4-2,v=g*4+2;var y=i+h*r[g*4],b=s+d*r[g*4+1],x=-r[m]*r[v]-r[m+1]*r[v+1],w=p/Math.tan(Math.acos(x)/2),C=y-w*r[m],$=b-w*r[m+1],_=y+w*r[v],k=b+w*r[v+1];g===0?(f[r.length-2]=C,f[r.length-1]=$):(f[g*4-2]=C,f[g*4-1]=$),f[g*4]=_,f[g*4+1]=k;var E=r[m+1],S=-r[m],N=E*r[v]+S*r[v+1];N<0&&(E*=-1,S*=-1);var A=C+E*p,D=$+S*p;c=tE(t,n,i,s,A,D,p),c.length!==0&&u.push(c[0],c[1])}for(var T=0;T<f.length/4;T++)c=Xg(t,n,i,s,f[T*4],f[T*4+1],f[T*4+2],f[T*4+3],!1),c.length!==0&&u.push(c[0],c[1]);if(u.length>2){for(var I=[u[0],u[1]],F=Math.pow(I[0]-t,2)+Math.pow(I[1]-n,2),R=1;R<u.length/2;R++){var P=Math.pow(u[R*2]-t,2)+Math.pow(u[R*2+1]-n,2);P<=F&&(I[0]=u[R*2],I[1]=u[R*2+1],F=P)}return I}return u},YF=function(t,n,r){var i=[t[0]-n[0],t[1]-n[1]],s=Math.sqrt(i[0]*i[0]+i[1]*i[1]),a=(s-r)/s;return a<0&&(a=1e-5),[n[0]+a*i[0],n[1]+a*i[1]]},Wa=function(t,n){var r=fY(t,n);return r=tEe(r),r},tEe=function(t){for(var n,r,i=t.length/2,s=1/0,a=1/0,o=-1/0,l=-1/0,u=0;u<i;u++)n=t[2*u],r=t[2*u+1],s=Math.min(s,n),o=Math.max(o,n),a=Math.min(a,r),l=Math.max(l,r);for(var c=2/(o-s),f=2/(l-a),h=0;h<i;h++)n=t[2*h]=t[2*h]*c,r=t[2*h+1]=t[2*h+1]*f,s=Math.min(s,n),o=Math.max(o,n),a=Math.min(a,r),l=Math.max(l,r);if(a<-1)for(var d=0;d<i;d++)r=t[2*d+1]=t[2*d+1]+(-1-a);return t},fY=function(t,n){var r=1/t*2*Math.PI,i=t%2===0?Math.PI/2+r/2:Math.PI/2;i+=n;for(var s=new Array(t*2),a,o=0;o<t;o++)a=o*r+i,s[2*o]=Math.cos(a),s[2*o+1]=Math.sin(-a);return s},hN=function(t,n){return Math.min(t/4,n/4,8)},Bee=function(t,n){return Math.min(t/10,n/10,8)},nEe=function(){return 8},Ost=function(t,n,r){return[t-2*n+r,2*(n-t),t]},hY=function(t,n){return{heightOffset:Math.min(15,.05*n),widthOffset:Math.min(100,.25*t),ctrlPtOffsetPct:.05}},Rst=Ys({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(t){return 1}}),Pst={pageRank:function(t){for(var n=Rst(t),r=n.dampingFactor,i=n.precision,s=n.iterations,a=n.weight,o=this._private.cy,l=this.byGroup(),u=l.nodes,c=l.edges,f=u.length,h=f*f,d=c.length,p=new Array(h),g=new Array(f),m=(1-r)/f,v=0;v<f;v++){for(var y=0;y<f;y++){var b=v*f+y;p[b]=0}g[v]=0}for(var x=0;x<d;x++){var w=c[x],C=w.data("source"),$=w.data("target");if(C!==$){var _=u.indexOfId(C),k=u.indexOfId($),E=a(w),S=k*f+_;p[S]+=E,g[_]+=E}}for(var N=1/f+m,A=0;A<f;A++)if(g[A]===0)for(var D=0;D<f;D++){var T=D*f+A;p[T]=N}else for(var I=0;I<f;I++){var F=I*f+A;p[F]=p[F]/g[A]+m}for(var R=new Array(f),P=new Array(f),V,z=0;z<f;z++)R[z]=1;for(var q=0;q<s;q++){for(var G=0;G<f;G++)P[G]=0;for(var K=0;K<f;K++)for(var Y=0;Y<f;Y++){var te=K*f+Y;P[K]+=p[te]*R[Y]}bst(P),V=R,R=P,P=V;for(var Z=0,ae=0;ae<f;ae++){var O=V[ae]-R[ae];Z+=O*O}if(Z<i)break}var L={rank:function(M){return M=o.collection(M)[0],R[u.indexOf(M)]}};return L}},hpe=Ys({root:null,weight:function(t){return 1},directed:!1,alpha:0}),V2={degreeCentralityNormalized:function(t){t=hpe(t);var n=this.cy(),r=this.nodes(),i=r.length;if(t.directed){for(var c={},f={},h=0,d=0,p=0;p<i;p++){var g=r[p],m=g.id();t.root=g;var v=this.degreeCentrality(t);h<v.indegree&&(h=v.indegree),d<v.outdegree&&(d=v.outdegree),c[m]=v.indegree,f[m]=v.outdegree}return{indegree:function(b){return h==0?0:(rt(b)&&(b=n.filter(b)),c[b.id()]/h)},outdegree:function(b){return d===0?0:(rt(b)&&(b=n.filter(b)),f[b.id()]/d)}}}else{for(var s={},a=0,o=0;o<i;o++){var l=r[o];t.root=l;var u=this.degreeCentrality(t);a<u.degree&&(a=u.degree),s[l.id()]=u.degree}return{degree:function(b){return a===0?0:(rt(b)&&(b=n.filter(b)),s[b.id()]/a)}}}},degreeCentrality:function(t){t=hpe(t);var n=this.cy(),r=this,i=t,s=i.root,a=i.weight,o=i.directed,l=i.alpha;if(s=n.collection(s)[0],o){for(var d=s.connectedEdges(),p=d.filter(function(C){return C.target().same(s)&&r.has(C)}),g=d.filter(function(C){return C.source().same(s)&&r.has(C)}),m=p.length,v=g.length,y=0,b=0,x=0;x<p.length;x++)y+=a(p[x]);for(var w=0;w<g.length;w++)b+=a(g[w]);return{indegree:Math.pow(m,1-l)*Math.pow(y,l),outdegree:Math.pow(v,1-l)*Math.pow(b,l)}}else{for(var u=s.connectedEdges().intersection(r),c=u.length,f=0,h=0;h<u.length;h++)f+=a(u[h]);return{degree:Math.pow(c,1-l)*Math.pow(f,l)}}}};V2.dc=V2.degreeCentrality;V2.dcn=V2.degreeCentralityNormalised=V2.degreeCentralityNormalized;var dpe=Ys({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),j2={closenessCentralityNormalized:function(t){for(var n=dpe(t),r=n.harmonic,i=n.weight,s=n.directed,a=this.cy(),o={},l=0,u=this.nodes(),c=this.floydWarshall({weight:i,directed:s}),f=0;f<u.length;f++){for(var h=0,d=u[f],p=0;p<u.length;p++)if(f!==p){var g=c.distance(d,u[p]);r?h+=1/g:h+=g}r||(h=1/h),l<h&&(l=h),o[d.id()]=h}return{closeness:function(v){return l==0?0:(rt(v)?v=a.filter(v)[0].id():v=v.id(),o[v]/l)}}},closenessCentrality:function(t){var n=dpe(t),r=n.root,i=n.weight,s=n.directed,a=n.harmonic;r=this.filter(r)[0];for(var o=this.dijkstra({root:r,weight:i,directed:s}),l=0,u=this.nodes(),c=0;c<u.length;c++){var f=u[c];if(!f.same(r)){var h=o.distanceTo(f);a?l+=1/h:l+=h}}return a?l:1/l}};j2.cc=j2.closenessCentrality;j2.ccn=j2.closenessCentralityNormalised=j2.closenessCentralityNormalized;var Lst=Ys({weight:null,directed:!1}),dY={betweennessCentrality:function(t){for(var n=Lst(t),r=n.directed,i=n.weight,s=i!=null,a=this.cy(),o=this.nodes(),l={},u={},c=0,f={set:function(b,x){u[b]=x,x>c&&(c=x)},get:function(b){return u[b]}},h=0;h<o.length;h++){var d=o[h],p=d.id();r?l[p]=d.outgoers().nodes():l[p]=d.openNeighborhood().nodes(),f.set(p,0)}for(var g=function(b){for(var x=o[b].id(),w=[],C={},$={},_={},k=new uN.default(function(Y,te){return _[Y]-_[te]}),E=0;E<o.length;E++){var S=o[E].id();C[S]=[],$[S]=0,_[S]=1/0}for($[x]=1,_[x]=0,k.push(x);!k.empty();){var N=k.pop();if(w.push(N),s)for(var A=0;A<l[N].length;A++){var D=l[N][A],T=a.getElementById(N),I=void 0;T.edgesTo(D).length>0?I=T.edgesTo(D)[0]:I=D.edgesTo(T)[0];var F=i(I);D=D.id(),_[D]>_[N]+F&&(_[D]=_[N]+F,k.nodes.indexOf(D)<0?k.push(D):k.updateItem(D),$[D]=0,C[D]=[]),_[D]==_[N]+F&&($[D]=$[D]+$[N],C[D].push(N))}else for(var R=0;R<l[N].length;R++){var P=l[N][R].id();_[P]==1/0&&(k.push(P),_[P]=_[N]+1),_[P]==_[N]+1&&($[P]=$[P]+$[N],C[P].push(N))}}for(var V={},z=0;z<o.length;z++)V[o[z].id()]=0;for(;w.length>0;){for(var q=w.pop(),G=0;G<C[q].length;G++){var K=C[q][G];V[K]=V[K]+$[K]/$[q]*(1+V[q])}q!=o[b].id()&&f.set(q,f.get(q)+V[q])}},m=0;m<o.length;m++)g(m);var v={betweenness:function(b){var x=a.collection(b).id();return f.get(x)},betweennessNormalized:function(b){if(c==0)return 0;var x=a.collection(b).id();return f.get(x)/c}};return v.betweennessNormalised=v.betweennessNormalized,v}};dY.bc=dY.betweennessCentrality;var Bst=Ys({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(e){return 1}]}),zst=function(t){return Bst(t)},Ust=function(t,n){for(var r=0,i=0;i<n.length;i++)r+=n[i](t);return r},Wst=function(t,n,r){for(var i=0;i<n;i++)t[i*n+i]=r},rEe=function(t,n){for(var r,i=0;i<n;i++){r=0;for(var s=0;s<n;s++)r+=t[s*n+i];for(var a=0;a<n;a++)t[a*n+i]=t[a*n+i]/r}},Vst=function(t,n,r){for(var i=new Array(r*r),s=0;s<r;s++){for(var a=0;a<r;a++)i[s*r+a]=0;for(var o=0;o<r;o++)for(var l=0;l<r;l++)i[s*r+l]+=t[s*r+o]*n[o*r+l]}return i},jst=function(t,n,r){for(var i=t.slice(0),s=1;s<r;s++)t=Vst(t,i,n);return t},Hst=function(t,n,r){for(var i=new Array(n*n),s=0;s<n*n;s++)i[s]=Math.pow(t[s],r);return rEe(i,n),i},qst=function(t,n,r,i){for(var s=0;s<r;s++){var a=Math.round(t[s]*Math.pow(10,i))/Math.pow(10,i),o=Math.round(n[s]*Math.pow(10,i))/Math.pow(10,i);if(a!==o)return!1}return!0},Gst=function(t,n,r,i){for(var s=[],a=0;a<n;a++){for(var o=[],l=0;l<n;l++)Math.round(t[a*n+l]*1e3)/1e3>0&&o.push(r[l]);o.length!==0&&s.push(i.collection(o))}return s},Yst=function(t,n){for(var r=0;r<t.length;r++)if(!n[r]||t[r].id()!==n[r].id())return!1;return!0},Xst=function(t){for(var n=0;n<t.length;n++)for(var r=0;r<t.length;r++)n!=r&&Yst(t[n],t[r])&&t.splice(r,1);return t},ppe=function(t){for(var n=this.nodes(),r=this.edges(),i=this.cy(),s=zst(t),a={},o=0;o<n.length;o++)a[n[o].id()]=o;for(var l=n.length,u=l*l,c=new Array(u),f,h=0;h<u;h++)c[h]=0;for(var d=0;d<r.length;d++){var p=r[d],g=a[p.source().id()],m=a[p.target().id()],v=Ust(p,s.attributes);c[g*l+m]+=v,c[m*l+g]+=v}Wst(c,l,s.multFactor),rEe(c,l);for(var y=!0,b=0;y&&b<s.maxIterations;)y=!1,f=jst(c,l,s.expandFactor),c=Hst(f,l,s.inflateFactor),qst(c,f,u,4)||(y=!0),b++;var x=Gst(c,l,n,i);return x=Xst(x),x},Kst={markovClustering:ppe,mcl:ppe},Zst=function(t){return t},iEe=function(t,n){return Math.abs(n-t)},gpe=function(t,n,r){return t+iEe(n,r)},mpe=function(t,n,r){return t+Math.pow(r-n,2)},Qst=function(t){return Math.sqrt(t)},Jst=function(t,n,r){return Math.max(t,iEe(n,r))},GS=function(t,n,r,i,s){for(var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:Zst,o=i,l,u,c=0;c<t;c++)l=n(c),u=r(c),o=s(o,l,u);return a(o)},Aw={euclidean:function(t,n,r){return t>=2?GS(t,n,r,0,mpe,Qst):GS(t,n,r,0,gpe)},squaredEuclidean:function(t,n,r){return GS(t,n,r,0,mpe)},manhattan:function(t,n,r){return GS(t,n,r,0,gpe)},max:function(t,n,r){return GS(t,n,r,-1/0,Jst)}};Aw["squared-euclidean"]=Aw.squaredEuclidean;Aw.squaredeuclidean=Aw.squaredEuclidean;function bB(e,t,n,r,i,s){var a;return zr(e)?a=e:a=Aw[e]||Aw.euclidean,t===0&&zr(e)?a(i,s):a(t,n,r,i,s)}var eat=Ys({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),zee=function(t){return eat(t)},p5=function(t,n,r,i,s){var a=s!=="kMedoids",o=a?function(f){return r[f]}:function(f){return i[f](r)},l=function(h){return i[h](n)},u=r,c=n;return bB(t,i.length,o,l,u,c)},tj=function(t,n,r){for(var i=r.length,s=new Array(i),a=new Array(i),o=new Array(n),l=null,u=0;u<i;u++)s[u]=t.min(r[u]).value,a[u]=t.max(r[u]).value;for(var c=0;c<n;c++){l=[];for(var f=0;f<i;f++)l[f]=Math.random()*(a[f]-s[f])+s[f];o[c]=l}return o},sEe=function(t,n,r,i,s){for(var a=1/0,o=0,l=0;l<n.length;l++){var u=p5(r,t,n[l],i,s);u<a&&(a=u,o=l)}return o},aEe=function(t,n,r){for(var i=[],s=null,a=0;a<n.length;a++)s=n[a],r[s.id()]===t&&i.push(s);return i},tat=function(t,n,r){return Math.abs(n-t)<=r},nat=function(t,n,r){for(var i=0;i<t.length;i++)for(var s=0;s<t[i].length;s++){var a=Math.abs(t[i][s]-n[i][s]);if(a>r)return!1}return!0},rat=function(t,n,r){for(var i=0;i<r;i++)if(t===n[i])return!0;return!1},vpe=function(t,n){var r=new Array(n);if(t.length<50)for(var i=0;i<n;i++){for(var s=t[Math.floor(Math.random()*t.length)];rat(s,r,i);)s=t[Math.floor(Math.random()*t.length)];r[i]=s}else for(var a=0;a<n;a++)r[a]=t[Math.floor(Math.random()*t.length)];return r},ype=function(t,n,r){for(var i=0,s=0;s<n.length;s++)i+=p5("manhattan",n[s],t,r,"kMedoids");return i},iat=function(t){var n=this.cy(),r=this.nodes(),i=null,s=zee(t),a=new Array(s.k),o={},l;s.testMode?typeof s.testCentroids=="number"?(s.testCentroids,l=tj(r,s.k,s.attributes)):Mi(s.testCentroids)==="object"?l=s.testCentroids:l=tj(r,s.k,s.attributes):l=tj(r,s.k,s.attributes);for(var u=!0,c=0;u&&c<s.maxIterations;){for(var f=0;f<r.length;f++)i=r[f],o[i.id()]=sEe(i,l,s.distance,s.attributes,"kMeans");u=!1;for(var h=0;h<s.k;h++){var d=aEe(h,r,o);if(d.length!==0){for(var p=s.attributes.length,g=l[h],m=new Array(p),v=new Array(p),y=0;y<p;y++){v[y]=0;for(var b=0;b<d.length;b++)i=d[b],v[y]+=s.attributes[y](i);m[y]=v[y]/d.length,tat(m[y],g[y],s.sensitivityThreshold)||(u=!0)}l[h]=m,a[h]=n.collection(d)}}c++}return a},sat=function(t){var n=this.cy(),r=this.nodes(),i=null,s=zee(t),a=new Array(s.k),o,l={},u,c=new Array(s.k);s.testMode?typeof s.testCentroids=="number"||(Mi(s.testCentroids)==="object"?o=s.testCentroids:o=vpe(r,s.k)):o=vpe(r,s.k);for(var f=!0,h=0;f&&h<s.maxIterations;){for(var d=0;d<r.length;d++)i=r[d],l[i.id()]=sEe(i,o,s.distance,s.attributes,"kMedoids");f=!1;for(var p=0;p<o.length;p++){var g=aEe(p,r,l);if(g.length!==0){c[p]=ype(o[p],g,s.attributes);for(var m=0;m<g.length;m++)u=ype(g[m],g,s.attributes),u<c[p]&&(c[p]=u,o[p]=g[m],f=!0);a[p]=n.collection(g)}}h++}return a},aat=function(t,n,r,i,s){for(var a,o,l=0;l<n.length;l++)for(var u=0;u<t.length;u++)i[l][u]=Math.pow(r[l][u],s.m);for(var c=0;c<t.length;c++)for(var f=0;f<s.attributes.length;f++){a=0,o=0;for(var h=0;h<n.length;h++)a+=i[h][c]*s.attributes[f](n[h]),o+=i[h][c];t[c][f]=a/o}},oat=function(t,n,r,i,s){for(var a=0;a<t.length;a++)n[a]=t[a].slice();for(var o,l,u,c=2/(s.m-1),f=0;f<r.length;f++)for(var h=0;h<i.length;h++){o=0;for(var d=0;d<r.length;d++)l=p5(s.distance,i[h],r[f],s.attributes,"cmeans"),u=p5(s.distance,i[h],r[d],s.attributes,"cmeans"),o+=Math.pow(l/u,c);t[h][f]=1/o}},lat=function(t,n,r,i){for(var s=new Array(r.k),a=0;a<s.length;a++)s[a]=[];for(var o,l,u=0;u<n.length;u++){o=-1/0,l=-1;for(var c=0;c<n[0].length;c++)n[u][c]>o&&(o=n[u][c],l=c);s[l].push(t[u])}for(var f=0;f<s.length;f++)s[f]=i.collection(s[f]);return s},bpe=function(t){var n=this.cy(),r=this.nodes(),i=zee(t),s,a,o,l,u;l=new Array(r.length);for(var c=0;c<r.length;c++)l[c]=new Array(i.k);o=new Array(r.length);for(var f=0;f<r.length;f++)o[f]=new Array(i.k);for(var h=0;h<r.length;h++){for(var d=0,p=0;p<i.k;p++)o[h][p]=Math.random(),d+=o[h][p];for(var g=0;g<i.k;g++)o[h][g]=o[h][g]/d}a=new Array(i.k);for(var m=0;m<i.k;m++)a[m]=new Array(i.attributes.length);u=new Array(r.length);for(var v=0;v<r.length;v++)u[v]=new Array(i.k);for(var y=!0,b=0;y&&b<i.maxIterations;)y=!1,aat(a,r,o,u,i),oat(o,l,a,r,i),nat(o,l,i.sensitivityThreshold)||(y=!0),b++;return s=lat(r,o,i,n),{clusters:s,degreeOfMembership:o}},uat={kMeans:iat,kMedoids:sat,fuzzyCMeans:bpe,fcm:bpe},cat=Ys({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),fat={single:"min",complete:"max"},hat=function(t){var n=cat(t),r=fat[n.linkage];return r!=null&&(n.linkage=r),n},xpe=function(t,n,r,i,s){for(var a=0,o=1/0,l,u=s.attributes,c=function(k,E){return bB(s.distance,u.length,function(S){return u[S](k)},function(S){return u[S](E)},k,E)},f=0;f<t.length;f++){var h=t[f].key,d=r[h][i[h]];d<o&&(a=h,o=d)}if(s.mode==="threshold"&&o>=s.threshold||s.mode==="dendrogram"&&t.length===1)return!1;var p=n[a],g=n[i[a]],m;s.mode==="dendrogram"?m={left:p,right:g,key:p.key}:m={value:p.value.concat(g.value),key:p.key},t[p.index]=m,t.splice(g.index,1),n[p.key]=m;for(var v=0;v<t.length;v++){var y=t[v];p.key===y.key?l=1/0:s.linkage==="min"?(l=r[p.key][y.key],r[p.key][y.key]>r[g.key][y.key]&&(l=r[g.key][y.key])):s.linkage==="max"?(l=r[p.key][y.key],r[p.key][y.key]<r[g.key][y.key]&&(l=r[g.key][y.key])):s.linkage==="mean"?l=(r[p.key][y.key]*p.size+r[g.key][y.key]*g.size)/(p.size+g.size):s.mode==="dendrogram"?l=c(y.value,p.value):l=c(y.value[0],p.value[0]),r[p.key][y.key]=r[y.key][p.key]=l}for(var b=0;b<t.length;b++){var x=t[b].key;if(i[x]===p.key||i[x]===g.key){for(var w=x,C=0;C<t.length;C++){var $=t[C].key;r[x][$]<r[x][w]&&(w=$)}i[x]=w}t[b].index=b}return p.key=g.key=p.index=g.index=null,!0},XF=function e(t,n,r){!t||(t.value?n.push(t.value):(t.left&&e(t.left,n),t.right&&e(t.right,n)))},dat=function e(t,n){if(!t)return"";if(t.left&&t.right){var r=e(t.left,n),i=e(t.right,n),s=n.add({group:"nodes",data:{id:r+","+i}});return n.add({group:"edges",data:{source:r,target:s.id()}}),n.add({group:"edges",data:{source:i,target:s.id()}}),s.id()}else if(t.value)return t.value.id()},pat=function e(t,n,r){if(!t)return[];var i=[],s=[],a=[];return n===0?(t.left&&XF(t.left,i),t.right&&XF(t.right,s),a=i.concat(s),[r.collection(a)]):n===1?t.value?[r.collection(t.value)]:(t.left&&XF(t.left,i),t.right&&XF(t.right,s),[r.collection(i),r.collection(s)]):t.value?[r.collection(t.value)]:(t.left&&(i=e(t.left,n-1,r)),t.right&&(s=e(t.right,n-1,r)),i.concat(s))},wpe=function(t){for(var n=this.cy(),r=this.nodes(),i=hat(t),s=i.attributes,a=function(b,x){return bB(i.distance,s.length,function(w){return s[w](b)},function(w){return s[w](x)},b,x)},o=[],l=[],u=[],c=[],f=0;f<r.length;f++){var h={value:i.mode==="dendrogram"?r[f]:[r[f]],key:f,index:f};o[f]=h,c[f]=h,l[f]=[],u[f]=0}for(var d=0;d<o.length;d++)for(var p=0;p<=d;p++){var g=void 0;i.mode==="dendrogram"?g=d===p?1/0:a(o[d].value,o[p].value):g=d===p?1/0:a(o[d].value[0],o[p].value[0]),l[d][p]=g,l[p][d]=g,g<l[d][u[d]]&&(u[d]=p)}for(var m=xpe(o,c,l,u,i);m;)m=xpe(o,c,l,u,i);var v;return i.mode==="dendrogram"?(v=pat(o[0],i.dendrogramDepth,n),i.addDendrogram&&dat(o[0],n)):(v=new Array(o.length),o.forEach(function(y,b){y.key=y.index=null,v[b]=n.collection(y.value)})),v},gat={hierarchicalClustering:wpe,hca:wpe},mat=Ys({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),vat=function(t){var n=t.damping,r=t.preference;.5<=n&&n<1||Xr("Damping must range on [0.5, 1).  Got: ".concat(n));var i=["median","mean","min","max"];return i.some(function(s){return s===r})||Pe(r)||Xr("Preference must be one of [".concat(i.map(function(s){return"'".concat(s,"'")}).join(", "),"] or a number.  Got: ").concat(r)),mat(t)},yat=function(t,n,r,i){var s=function(o,l){return i[l](o)};return-bB(t,i.length,function(a){return s(n,a)},function(a){return s(r,a)},n,r)},bat=function(t,n){var r=null;return n==="median"?r=vst(t):n==="mean"?r=mst(t):n==="min"?r=pst(t):n==="max"?r=gst(t):r=n,r},xat=function(t,n,r){for(var i=[],s=0;s<t;s++)n[s*t+s]+r[s*t+s]>0&&i.push(s);return i},$pe=function(t,n,r){for(var i=[],s=0;s<t;s++){for(var a=-1,o=-1/0,l=0;l<r.length;l++){var u=r[l];n[s*t+u]>o&&(a=u,o=n[s*t+u])}a>0&&i.push(a)}for(var c=0;c<r.length;c++)i[r[c]]=r[c];return i},wat=function(t,n,r){for(var i=$pe(t,n,r),s=0;s<r.length;s++){for(var a=[],o=0;o<i.length;o++)i[o]===r[s]&&a.push(o);for(var l=-1,u=-1/0,c=0;c<a.length;c++){for(var f=0,h=0;h<a.length;h++)f+=n[a[h]*t+a[c]];f>u&&(l=c,u=f)}r[s]=a[l]}return i=$pe(t,n,r),i},Cpe=function(t){for(var n=this.cy(),r=this.nodes(),i=vat(t),s={},a=0;a<r.length;a++)s[r[a].id()]=a;var o,l,u,c,f,h;o=r.length,l=o*o,u=new Array(l);for(var d=0;d<l;d++)u[d]=-1/0;for(var p=0;p<o;p++)for(var g=0;g<o;g++)p!==g&&(u[p*o+g]=yat(i.distance,r[p],r[g],i.attributes));c=bat(u,i.preference);for(var m=0;m<o;m++)u[m*o+m]=c;f=new Array(l);for(var v=0;v<l;v++)f[v]=0;h=new Array(l);for(var y=0;y<l;y++)h[y]=0;for(var b=new Array(o),x=new Array(o),w=new Array(o),C=0;C<o;C++)b[C]=0,x[C]=0,w[C]=0;for(var $=new Array(o*i.minIterations),_=0;_<$.length;_++)$[_]=0;var k;for(k=0;k<i.maxIterations;k++){for(var E=0;E<o;E++){for(var S=-1/0,N=-1/0,A=-1,D=0,T=0;T<o;T++)b[T]=f[E*o+T],D=h[E*o+T]+u[E*o+T],D>=S?(N=S,S=D,A=T):D>N&&(N=D);for(var I=0;I<o;I++)f[E*o+I]=(1-i.damping)*(u[E*o+I]-S)+i.damping*b[I];f[E*o+A]=(1-i.damping)*(u[E*o+A]-N)+i.damping*b[A]}for(var F=0;F<o;F++){for(var R=0,P=0;P<o;P++)b[P]=h[P*o+F],x[P]=Math.max(0,f[P*o+F]),R+=x[P];R-=x[F],x[F]=f[F*o+F],R+=x[F];for(var V=0;V<o;V++)h[V*o+F]=(1-i.damping)*Math.min(0,R-x[V])+i.damping*b[V];h[F*o+F]=(1-i.damping)*(R-x[F])+i.damping*b[F]}for(var z=0,q=0;q<o;q++){var G=h[q*o+q]+f[q*o+q]>0?1:0;$[k%i.minIterations*o+q]=G,z+=G}if(z>0&&(k>=i.minIterations-1||k==i.maxIterations-1)){for(var K=0,Y=0;Y<o;Y++){w[Y]=0;for(var te=0;te<i.minIterations;te++)w[Y]+=$[te*o+Y];(w[Y]===0||w[Y]===i.minIterations)&&K++}if(K===o)break}}for(var Z=xat(o,f,h),ae=wat(o,u,Z),O={},L=0;L<Z.length;L++)O[Z[L]]=[];for(var W=0;W<r.length;W++){var M=s[r[W].id()],ue=ae[M];ue!=null&&O[ue].push(r[W])}for(var X=new Array(Z.length),se=0;se<Z.length;se++)X[se]=n.collection(O[Z[se]]);return X},$at={affinityPropagation:Cpe,ap:Cpe},Cat=Ys({root:void 0,directed:!1}),_at={hierholzer:function(t){if(!pn(t)){var n=arguments;t={root:n[0],directed:n[1]}}var r=Cat(t),i=r.root,s=r.directed,a=this,o=!1,l,u,c;i&&(c=rt(i)?this.filter(i)[0].id():i[0].id());var f={},h={};s?a.forEach(function(y){var b=y.id();if(y.isNode()){var x=y.indegree(!0),w=y.outdegree(!0),C=x-w,$=w-x;C==1?l?o=!0:l=b:$==1?u?o=!0:u=b:($>1||C>1)&&(o=!0),f[b]=[],y.outgoers().forEach(function(_){_.isEdge()&&f[b].push(_.id())})}else h[b]=[void 0,y.target().id()]}):a.forEach(function(y){var b=y.id();if(y.isNode()){var x=y.degree(!0);x%2&&(l?u?o=!0:u=b:l=b),f[b]=[],y.connectedEdges().forEach(function(w){return f[b].push(w.id())})}else h[b]=[y.source().id(),y.target().id()]});var d={found:!1,trail:void 0};if(o)return d;if(u&&l)if(s){if(c&&u!=c)return d;c=u}else{if(c&&u!=c&&l!=c)return d;c||(c=u)}else c||(c=a[0].id());var p=function(b){for(var x=b,w=[b],C,$,_;f[x].length;)C=f[x].shift(),$=h[C][0],_=h[C][1],x!=_?(f[_]=f[_].filter(function(k){return k!=C}),x=_):!s&&x!=$&&(f[$]=f[$].filter(function(k){return k!=C}),x=$),w.unshift(C),w.unshift(x);return w},g=[],m=[];for(m=p(c);m.length!=1;)f[m[0]].length==0?(g.unshift(a.getElementById(m.shift())),g.unshift(a.getElementById(m.shift()))):m=p(m.shift()).concat(m);g.unshift(a.getElementById(m.shift()));for(var v in f)if(f[v].length)return d;return d.found=!0,d.trail=this.spawn(g,!0),d}},KF=function(){var t=this,n={},r=0,i=0,s=[],a=[],o={},l=function(h,d){for(var p=a.length-1,g=[],m=t.spawn();a[p].x!=h||a[p].y!=d;)g.push(a.pop().edge),p--;g.push(a.pop().edge),g.forEach(function(v){var y=v.connectedNodes().intersection(t);m.merge(v),y.forEach(function(b){var x=b.id(),w=b.connectedEdges().intersection(t);m.merge(b),n[x].cutVertex?m.merge(w.filter(function(C){return C.isLoop()})):m.merge(w)})}),s.push(m)},u=function f(h,d,p){h===p&&(i+=1),n[d]={id:r,low:r++,cutVertex:!1};var g=t.getElementById(d).connectedEdges().intersection(t);if(g.size()===0)s.push(t.spawn(t.getElementById(d)));else{var m,v,y,b;g.forEach(function(x){m=x.source().id(),v=x.target().id(),y=m===d?v:m,y!==p&&(b=x.id(),o[b]||(o[b]=!0,a.push({x:d,y,edge:x})),y in n?n[d].low=Math.min(n[d].low,n[y].id):(f(h,y,d),n[d].low=Math.min(n[d].low,n[y].low),n[d].id<=n[y].low&&(n[d].cutVertex=!0,l(d,y))))})}};t.forEach(function(f){if(f.isNode()){var h=f.id();h in n||(i=0,u(h,h),n[h].cutVertex=i>1)}});var c=Object.keys(n).filter(function(f){return n[f].cutVertex}).map(function(f){return t.getElementById(f)});return{cut:t.spawn(c),components:s}},Sat={hopcroftTarjanBiconnected:KF,htbc:KF,htb:KF,hopcroftTarjanBiconnectedComponents:KF},ZF=function(){var t=this,n={},r=0,i=[],s=[],a=t.spawn(t),o=function l(u){s.push(u),n[u]={index:r,low:r++,explored:!1};var c=t.getElementById(u).connectedEdges().intersection(t);if(c.forEach(function(g){var m=g.target().id();m!==u&&(m in n||l(m),n[m].explored||(n[u].low=Math.min(n[u].low,n[m].low)))}),n[u].index===n[u].low){for(var f=t.spawn();;){var h=s.pop();if(f.merge(t.getElementById(h)),n[h].low=n[u].index,n[h].explored=!0,h===u)break}var d=f.edgesWith(f),p=f.merge(d);i.push(p),a=a.difference(p)}};return t.forEach(function(l){if(l.isNode()){var u=l.id();u in n||o(u)}}),{cut:a,components:i}},kat={tarjanStronglyConnected:ZF,tsc:ZF,tscc:ZF,tarjanStronglyConnectedComponents:ZF},oEe={};[rT,nst,rst,sst,ost,ust,hst,Pst,V2,j2,dY,Kst,uat,gat,$at,_at,Sat,kat].forEach(function(e){gt(oEe,e)});/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/var lEe=0,uEe=1,cEe=2,Dp=function e(t){if(!(this instanceof e))return new e(t);this.id="Thenable/1.0.7",this.state=lEe,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof t=="function"&&t.call(this,this.fulfill.bind(this),this.reject.bind(this))};Dp.prototype={fulfill:function(t){return _pe(this,uEe,"fulfillValue",t)},reject:function(t){return _pe(this,cEe,"rejectReason",t)},then:function(t,n){var r=this,i=new Dp;return r.onFulfilled.push(kpe(t,i,"fulfill")),r.onRejected.push(kpe(n,i,"reject")),fEe(r),i.proxy}};var _pe=function(t,n,r,i){return t.state===lEe&&(t.state=n,t[r]=i,fEe(t)),t},fEe=function(t){t.state===uEe?Spe(t,"onFulfilled",t.fulfillValue):t.state===cEe&&Spe(t,"onRejected",t.rejectReason)},Spe=function(t,n,r){if(t[n].length!==0){var i=t[n];t[n]=[];var s=function(){for(var o=0;o<i.length;o++)i[o](r)};typeof setImmediate=="function"?setImmediate(s):setTimeout(s,0)}},kpe=function(t,n,r){return function(i){if(typeof t!="function")n[r].call(n,i);else{var s;try{s=t(i)}catch(a){n.reject(a);return}Eat(n,s)}}},Eat=function e(t,n){if(t===n||t.proxy===n){t.reject(new TypeError("cannot resolve promise with itself"));return}var r;if(Mi(n)==="object"&&n!==null||typeof n=="function")try{r=n.then}catch(s){t.reject(s);return}if(typeof r=="function"){var i=!1;try{r.call(n,function(s){i||(i=!0,s===n?t.reject(new TypeError("circular thenable chain")):e(t,s))},function(s){i||(i=!0,t.reject(s))})}catch(s){i||t.reject(s)}return}t.fulfill(n)};Dp.all=function(e){return new Dp(function(t,n){for(var r=new Array(e.length),i=0,s=function(l,u){r[l]=u,i++,i===e.length&&t(r)},a=0;a<e.length;a++)(function(o){var l=e[o],u=l!=null&&l.then!=null;if(u)l.then(function(f){s(o,f)},function(f){n(f)});else{var c=l;s(o,c)}})(a)})};Dp.resolve=function(e){return new Dp(function(t,n){t(e)})};Dp.reject=function(e){return new Dp(function(t,n){n(e)})};var wC=typeof Promise<"u"?Promise:Dp,pY=function(t,n,r){var i=Iee(t),s=!i,a=this._private=gt({duration:1e3},n,r);if(a.target=t,a.style=a.style||a.css,a.started=!1,a.playing=!1,a.hooked=!1,a.applying=!1,a.progress=0,a.completes=[],a.frames=[],a.complete&&zr(a.complete)&&a.completes.push(a.complete),s){var o=t.position();a.startPosition=a.startPosition||{x:o.x,y:o.y},a.startStyle=a.startStyle||t.cy().style().getAnimationStartStyle(t,a.style)}if(i){var l=t.pan();a.startPan={x:l.x,y:l.y},a.startZoom=t.zoom()}this.length=1,this[0]=this},Ey=pY.prototype;gt(Ey,{instanceString:function(){return"animation"},hook:function(){var t=this._private;if(!t.hooked){var n,r=t.target._private.animation;t.queue?n=r.queue:n=r.current,n.push(this),Rl(t.target)&&t.target.cy().addToAnimationPool(t.target),t.hooked=!0}return this},play:function(){var t=this._private;return t.progress===1&&(t.progress=0),t.playing=!0,t.started=!1,t.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var t=this._private;return t.applying=!0,t.started=!1,t.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var t=this._private;return t.playing=!1,t.started=!1,this},stop:function(){var t=this._private;return t.playing=!1,t.started=!1,t.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(t){var n=this._private;return t===void 0?n.progress*n.duration:this.progress(t/n.duration)},progress:function(t){var n=this._private,r=n.playing;return t===void 0?n.progress:(r&&this.pause(),n.progress=t,n.started=!1,r&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var t=this._private,n=t.playing;n&&this.pause(),t.progress=1-t.progress,t.started=!1;var r=function(u,c){var f=t[u];f!=null&&(t[u]=t[c],t[c]=f)};if(r("zoom","startZoom"),r("pan","startPan"),r("position","startPosition"),t.style)for(var i=0;i<t.style.length;i++){var s=t.style[i],a=s.name,o=t.startStyle[a];t.startStyle[a]=s,t.style[i]=o}return n&&this.play(),this},promise:function(t){var n=this._private,r;switch(t){case"frame":r=n.frames;break;default:case"complete":case"completed":r=n.completes}return new wC(function(i,s){r.push(function(){i()})})}});Ey.complete=Ey.completed;Ey.run=Ey.play;Ey.running=Ey.playing;var Aat={animated:function(){return function(){var n=this,r=n.length!==void 0,i=r?n:[n],s=this._private.cy||this;if(!s.styleEnabled())return!1;var a=i[0];if(a)return a._private.animation.current.length>0}},clearQueue:function(){return function(){var n=this,r=n.length!==void 0,i=r?n:[n],s=this._private.cy||this;if(!s.styleEnabled())return this;for(var a=0;a<i.length;a++){var o=i[a];o._private.animation.queue=[]}return this}},delay:function(){return function(n,r){var i=this._private.cy||this;return i.styleEnabled()?this.animate({delay:n,duration:n,complete:r}):this}},delayAnimation:function(){return function(n,r){var i=this._private.cy||this;return i.styleEnabled()?this.animation({delay:n,duration:n,complete:r}):this}},animation:function(){return function(n,r){var i=this,s=i.length!==void 0,a=s?i:[i],o=this._private.cy||this,l=!s,u=!l;if(!o.styleEnabled())return this;var c=o.style();n=gt({},n,r);var f=Object.keys(n).length===0;if(f)return new pY(a[0],n);switch(n.duration===void 0&&(n.duration=400),n.duration){case"slow":n.duration=600;break;case"fast":n.duration=200;break}if(u&&(n.style=c.getPropsList(n.style||n.css),n.css=void 0),u&&n.renderedPosition!=null){var h=n.renderedPosition,d=o.pan(),p=o.zoom();n.position=Xke(h,p,d)}if(l&&n.panBy!=null){var g=n.panBy,m=o.pan();n.pan={x:m.x+g.x,y:m.y+g.y}}var v=n.center||n.centre;if(l&&v!=null){var y=o.getCenterPan(v.eles,n.zoom);y!=null&&(n.pan=y)}if(l&&n.fit!=null){var b=n.fit,x=o.getFitViewport(b.eles||b.boundingBox,b.padding);x!=null&&(n.pan=x.pan,n.zoom=x.zoom)}if(l&&pn(n.zoom)){var w=o.getZoomedViewport(n.zoom);w!=null?(w.zoomed&&(n.zoom=w.zoom),w.panned&&(n.pan=w.pan)):n.zoom=null}return new pY(a[0],n)}},animate:function(){return function(n,r){var i=this,s=i.length!==void 0,a=s?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;r&&(n=gt({},n,r));for(var l=0;l<a.length;l++){var u=a[l],c=u.animated()&&(n.queue===void 0||n.queue),f=u.animation(n,c?{queue:!0}:void 0);f.play()}return this}},stop:function(){return function(n,r){var i=this,s=i.length!==void 0,a=s?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;for(var l=0;l<a.length;l++){for(var u=a[l],c=u._private,f=c.animation.current,h=0;h<f.length;h++){var d=f[h],p=d._private;r&&(p.duration=0)}n&&(c.animation.queue=[]),r||(c.animation.current=[])}return o.notify("draw"),this}}},Tat={data:function(t){var n={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(i){},beforeSet:function(i,s){},onSet:function(i){},canSet:function(i){return!0}};return t=gt({},n,t),function(i,s){var a=t,o=this,l=o.length!==void 0,u=l?o:[o],c=l?o[0]:o;if(rt(i)){var f=i.indexOf(".")!==-1,h=f&&pit.default(i);if(a.allowGetting&&s===void 0){var d;return c&&(a.beforeGet(c),h&&c._private[a.field][i]===void 0?d=hit.default(c._private[a.field],h):d=c._private[a.field][i]),d}else if(a.allowSetting&&s!==void 0){var p=!a.immutableKeys[i];if(p){var g=Mke({},i,s);a.beforeSet(o,g);for(var m=0,v=u.length;m<v;m++){var y=u[m];a.canSet(y)&&(h&&c._private[a.field][i]===void 0?dit.default(y._private[a.field],h,s):y._private[a.field][i]=s)}a.updateStyle&&o.updateStyle(),a.onSet(o),a.settingTriggersEvent&&o[a.triggerFnName](a.settingEvent)}}}else if(a.allowSetting&&pn(i)){var b=i,x,w,C=Object.keys(b);a.beforeSet(o,b);for(var $=0;$<C.length;$++){x=C[$],w=b[x];var _=!a.immutableKeys[x];if(_)for(var k=0;k<u.length;k++){var E=u[k];a.canSet(E)&&(E._private[a.field][x]=w)}}a.updateStyle&&o.updateStyle(),a.onSet(o),a.settingTriggersEvent&&o[a.triggerFnName](a.settingEvent)}else if(a.allowBinding&&zr(i)){var S=i;o.on(a.bindingEvent,S)}else if(a.allowGetting&&i===void 0){var N;return c&&(a.beforeGet(c),N=c._private[a.field]),N}return o}},removeData:function(t){var n={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return t=gt({},n,t),function(i){var s=t,a=this,o=a.length!==void 0,l=o?a:[a];if(rt(i)){for(var u=i.split(/\s+/),c=u.length,f=0;f<c;f++){var h=u[f];if(!O0(h)){var d=!s.immutableKeys[h];if(d)for(var p=0,g=l.length;p<g;p++)l[p]._private[s.field][h]=void 0}}s.triggerEvent&&a[s.triggerFnName](s.event)}else if(i===void 0){for(var m=0,v=l.length;m<v;m++)for(var y=l[m]._private[s.field],b=Object.keys(y),x=0;x<b.length;x++){var w=b[x],C=!s.immutableKeys[w];C&&(y[w]=void 0)}s.triggerEvent&&a[s.triggerFnName](s.event)}return a}}},Dat={eventAliasesOn:function(t){var n=t;n.addListener=n.listen=n.bind=n.on,n.unlisten=n.unbind=n.off=n.removeListener,n.trigger=n.emit,n.pon=n.promiseOn=function(r,i){var s=this,a=Array.prototype.slice.call(arguments,0);return new wC(function(o,l){var u=function(d){s.off.apply(s,f),o(d)},c=a.concat([u]),f=c.concat([]);s.on.apply(s,c)})}}},Fn={};[Aat,Tat,Dat].forEach(function(e){gt(Fn,e)});var Nat={animate:Fn.animate(),animation:Fn.animation(),animated:Fn.animated(),clearQueue:Fn.clearQueue(),delay:Fn.delay(),delayAnimation:Fn.delayAnimation(),stop:Fn.stop()},QR={classes:function(t){var n=this;if(t===void 0){var r=[];return n[0]._private.classes.forEach(function(p){return r.push(p)}),r}else Jn(t)||(t=(t||"").match(/\S+/g)||[]);for(var i=[],s=new xC(t),a=0;a<n.length;a++){for(var o=n[a],l=o._private,u=l.classes,c=!1,f=0;f<t.length;f++){var h=t[f],d=u.has(h);if(!d){c=!0;break}}c||(c=u.size!==t.length),c&&(l.classes=s,i.push(o))}return i.length>0&&this.spawn(i).updateStyle().emit("class"),n},addClass:function(t){return this.toggleClass(t,!0)},hasClass:function(t){var n=this[0];return n!=null&&n._private.classes.has(t)},toggleClass:function(t,n){Jn(t)||(t=t.match(/\S+/g)||[]);for(var r=this,i=n===void 0,s=[],a=0,o=r.length;a<o;a++)for(var l=r[a],u=l._private.classes,c=!1,f=0;f<t.length;f++){var h=t[f],d=u.has(h),p=!1;n||i&&!d?(u.add(h),p=!0):(!n||i&&d)&&(u.delete(h),p=!0),!c&&p&&(s.push(l),c=!0)}return s.length>0&&this.spawn(s).updateStyle().emit("class"),r},removeClass:function(t){return this.toggleClass(t,!1)},flashClass:function(t,n){var r=this;if(n==null)n=250;else if(n===0)return r;return r.addClass(t),setTimeout(function(){r.removeClass(t)},n),r}};QR.className=QR.classNames=QR.classes;var hn={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Ei,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};hn.variable="(?:[\\w-.]|(?:\\\\"+hn.metaChar+"))+";hn.className="(?:[\\w-]|(?:\\\\"+hn.metaChar+"))+";hn.value=hn.string+"|"+hn.number;hn.id=hn.variable;(function(){var e,t,n;for(e=hn.comparatorOp.split("|"),n=0;n<e.length;n++)t=e[n],hn.comparatorOp+="|@"+t;for(e=hn.comparatorOp.split("|"),n=0;n<e.length;n++)t=e[n],!(t.indexOf("!")>=0)&&t!=="="&&(hn.comparatorOp+="|\\!"+t)})();var qn=function(){return{checks:[]}},je={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},gY=[{selector:":selected",matches:function(t){return t.selected()}},{selector:":unselected",matches:function(t){return!t.selected()}},{selector:":selectable",matches:function(t){return t.selectable()}},{selector:":unselectable",matches:function(t){return!t.selectable()}},{selector:":locked",matches:function(t){return t.locked()}},{selector:":unlocked",matches:function(t){return!t.locked()}},{selector:":visible",matches:function(t){return t.visible()}},{selector:":hidden",matches:function(t){return!t.visible()}},{selector:":transparent",matches:function(t){return t.transparent()}},{selector:":grabbed",matches:function(t){return t.grabbed()}},{selector:":free",matches:function(t){return!t.grabbed()}},{selector:":removed",matches:function(t){return t.removed()}},{selector:":inside",matches:function(t){return!t.removed()}},{selector:":grabbable",matches:function(t){return t.grabbable()}},{selector:":ungrabbable",matches:function(t){return!t.grabbable()}},{selector:":animated",matches:function(t){return t.animated()}},{selector:":unanimated",matches:function(t){return!t.animated()}},{selector:":parent",matches:function(t){return t.isParent()}},{selector:":childless",matches:function(t){return t.isChildless()}},{selector:":child",matches:function(t){return t.isChild()}},{selector:":orphan",matches:function(t){return t.isOrphan()}},{selector:":nonorphan",matches:function(t){return t.isChild()}},{selector:":compound",matches:function(t){return t.isNode()?t.isParent():t.source().isParent()||t.target().isParent()}},{selector:":loop",matches:function(t){return t.isLoop()}},{selector:":simple",matches:function(t){return t.isSimple()}},{selector:":active",matches:function(t){return t.active()}},{selector:":inactive",matches:function(t){return!t.active()}},{selector:":backgrounding",matches:function(t){return t.backgrounding()}},{selector:":nonbackgrounding",matches:function(t){return!t.backgrounding()}}].sort(function(e,t){return Oit(e.selector,t.selector)}),Iat=function(){for(var e={},t,n=0;n<gY.length;n++)t=gY[n],e[t.selector]=t.matches;return e}(),Mat=function(t,n){return Iat[t](n)},Fat="("+gY.map(function(e){return e.selector}).join("|")+")",Xx=function(t){return t.replace(new RegExp("\\\\("+hn.metaChar+")","g"),function(n,r){return r})},Ag=function(t,n,r){t[t.length-1]=r},mY=[{name:"group",query:!0,regex:"("+hn.group+")",populate:function(t,n,r){var i=Rd(r,1),s=i[0];n.checks.push({type:je.GROUP,value:s==="*"?s:s+"s"})}},{name:"state",query:!0,regex:Fat,populate:function(t,n,r){var i=Rd(r,1),s=i[0];n.checks.push({type:je.STATE,value:s})}},{name:"id",query:!0,regex:"\\#("+hn.id+")",populate:function(t,n,r){var i=Rd(r,1),s=i[0];n.checks.push({type:je.ID,value:Xx(s)})}},{name:"className",query:!0,regex:"\\.("+hn.className+")",populate:function(t,n,r){var i=Rd(r,1),s=i[0];n.checks.push({type:je.CLASS,value:Xx(s)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+hn.variable+")\\s*\\]",populate:function(t,n,r){var i=Rd(r,1),s=i[0];n.checks.push({type:je.DATA_EXIST,field:Xx(s)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+hn.variable+")\\s*("+hn.comparatorOp+")\\s*("+hn.value+")\\s*\\]",populate:function(t,n,r){var i=Rd(r,3),s=i[0],a=i[1],o=i[2],l=new RegExp("^"+hn.string+"$").exec(o)!=null;l?o=o.substring(1,o.length-1):o=parseFloat(o),n.checks.push({type:je.DATA_COMPARE,field:Xx(s),operator:a,value:o})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+hn.boolOp+")\\s*("+hn.variable+")\\s*\\]",populate:function(t,n,r){var i=Rd(r,2),s=i[0],a=i[1];n.checks.push({type:je.DATA_BOOL,field:Xx(a),operator:s})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+hn.meta+")\\s*("+hn.comparatorOp+")\\s*("+hn.number+")\\s*\\]\\]",populate:function(t,n,r){var i=Rd(r,3),s=i[0],a=i[1],o=i[2];n.checks.push({type:je.META_COMPARE,field:Xx(s),operator:a,value:parseFloat(o)})}},{name:"nextQuery",separator:!0,regex:hn.separator,populate:function(t,n){var r=t.currentSubject,i=t.edgeCount,s=t.compoundCount,a=t[t.length-1];r!=null&&(a.subject=r,t.currentSubject=null),a.edgeCount=i,a.compoundCount=s,t.edgeCount=0,t.compoundCount=0;var o=t[t.length++]=qn();return o}},{name:"directedEdge",separator:!0,regex:hn.directedEdge,populate:function(t,n){if(t.currentSubject==null){var r=qn(),i=n,s=qn();return r.checks.push({type:je.DIRECTED_EDGE,source:i,target:s}),Ag(t,n,r),t.edgeCount++,s}else{var a=qn(),o=n,l=qn();return a.checks.push({type:je.NODE_SOURCE,source:o,target:l}),Ag(t,n,a),t.edgeCount++,l}}},{name:"undirectedEdge",separator:!0,regex:hn.undirectedEdge,populate:function(t,n){if(t.currentSubject==null){var r=qn(),i=n,s=qn();return r.checks.push({type:je.UNDIRECTED_EDGE,nodes:[i,s]}),Ag(t,n,r),t.edgeCount++,s}else{var a=qn(),o=n,l=qn();return a.checks.push({type:je.NODE_NEIGHBOR,node:o,neighbor:l}),Ag(t,n,a),l}}},{name:"child",separator:!0,regex:hn.child,populate:function(t,n){if(t.currentSubject==null){var r=qn(),i=qn(),s=t[t.length-1];return r.checks.push({type:je.CHILD,parent:s,child:i}),Ag(t,n,r),t.compoundCount++,i}else if(t.currentSubject===n){var a=qn(),o=t[t.length-1],l=qn(),u=qn(),c=qn(),f=qn();return a.checks.push({type:je.COMPOUND_SPLIT,left:o,right:l,subject:u}),u.checks=n.checks,n.checks=[{type:je.TRUE}],f.checks.push({type:je.TRUE}),l.checks.push({type:je.PARENT,parent:f,child:c}),Ag(t,o,a),t.currentSubject=u,t.compoundCount++,c}else{var h=qn(),d=qn(),p=[{type:je.PARENT,parent:h,child:d}];return h.checks=n.checks,n.checks=p,t.compoundCount++,d}}},{name:"descendant",separator:!0,regex:hn.descendant,populate:function(t,n){if(t.currentSubject==null){var r=qn(),i=qn(),s=t[t.length-1];return r.checks.push({type:je.DESCENDANT,ancestor:s,descendant:i}),Ag(t,n,r),t.compoundCount++,i}else if(t.currentSubject===n){var a=qn(),o=t[t.length-1],l=qn(),u=qn(),c=qn(),f=qn();return a.checks.push({type:je.COMPOUND_SPLIT,left:o,right:l,subject:u}),u.checks=n.checks,n.checks=[{type:je.TRUE}],f.checks.push({type:je.TRUE}),l.checks.push({type:je.ANCESTOR,ancestor:f,descendant:c}),Ag(t,o,a),t.currentSubject=u,t.compoundCount++,c}else{var h=qn(),d=qn(),p=[{type:je.ANCESTOR,ancestor:h,descendant:d}];return h.checks=n.checks,n.checks=p,t.compoundCount++,d}}},{name:"subject",modifier:!0,regex:hn.subject,populate:function(t,n){if(t.currentSubject!=null&&t.currentSubject!==n)return Rn("Redefinition of subject in selector `"+t.toString()+"`"),!1;t.currentSubject=n;var r=t[t.length-1],i=r.checks[0],s=i==null?null:i.type;s===je.DIRECTED_EDGE?i.type=je.NODE_TARGET:s===je.UNDIRECTED_EDGE&&(i.type=je.NODE_NEIGHBOR,i.node=i.nodes[1],i.neighbor=i.nodes[0],i.nodes=null)}}];mY.forEach(function(e){return e.regexObj=new RegExp("^"+e.regex)});var Oat=function(t){for(var n,r,i,s=0;s<mY.length;s++){var a=mY[s],o=a.name,l=t.match(a.regexObj);if(l!=null){r=l,n=a,i=o;var u=l[0];t=t.substring(u.length);break}}return{expr:n,match:r,name:i,remaining:t}},Rat=function(t){var n=t.match(/^\s+/);if(n){var r=n[0];t=t.substring(r.length)}return t},Pat=function(t){var n=this,r=n.inputText=t,i=n[0]=qn();for(n.length=1,r=Rat(r);;){var s=Oat(r);if(s.expr==null)return Rn("The selector `"+t+"`is invalid"),!1;var a=s.match.slice(1),o=s.expr.populate(n,i,a);if(o===!1)return!1;if(o!=null&&(i=o),r=s.remaining,r.match(/^\s*$/))break}var l=n[n.length-1];n.currentSubject!=null&&(l.subject=n.currentSubject),l.edgeCount=n.edgeCount,l.compoundCount=n.compoundCount;for(var u=0;u<n.length;u++){var c=n[u];if(c.compoundCount>0&&c.edgeCount>0)return Rn("The selector `"+t+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(c.edgeCount>1)return Rn("The selector `"+t+"` is invalid because it uses multiple edge selectors"),!1;c.edgeCount===1&&Rn("The selector `"+t+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},Lat=function(){if(this.toStringCache!=null)return this.toStringCache;for(var t=function(c){return c==null?"":c},n=function(c){return rt(c)?'"'+c+'"':t(c)},r=function(c){return" "+c+" "},i=function(c,f){var h=c.type,d=c.value;switch(h){case je.GROUP:{var p=t(d);return p.substring(0,p.length-1)}case je.DATA_COMPARE:{var g=c.field,m=c.operator;return"["+g+r(t(m))+n(d)+"]"}case je.DATA_BOOL:{var v=c.operator,y=c.field;return"["+t(v)+y+"]"}case je.DATA_EXIST:{var b=c.field;return"["+b+"]"}case je.META_COMPARE:{var x=c.operator,w=c.field;return"[["+w+r(t(x))+n(d)+"]]"}case je.STATE:return d;case je.ID:return"#"+d;case je.CLASS:return"."+d;case je.PARENT:case je.CHILD:return s(c.parent,f)+r(">")+s(c.child,f);case je.ANCESTOR:case je.DESCENDANT:return s(c.ancestor,f)+" "+s(c.descendant,f);case je.COMPOUND_SPLIT:{var C=s(c.left,f),$=s(c.subject,f),_=s(c.right,f);return C+(C.length>0?" ":"")+$+_}case je.TRUE:return""}},s=function(c,f){return c.checks.reduce(function(h,d,p){return h+(f===c&&p===0?"$":"")+i(d,f)},"")},a="",o=0;o<this.length;o++){var l=this[o];a+=s(l,l.subject),this.length>1&&o<this.length-1&&(a+=", ")}return this.toStringCache=a,a},Bat={parse:Pat,toString:Lat},hEe=function(t,n,r){var i,s=rt(t),a=Pe(t),o=rt(r),l,u,c=!1,f=!1,h=!1;switch(n.indexOf("!")>=0&&(n=n.replace("!",""),f=!0),n.indexOf("@")>=0&&(n=n.replace("@",""),c=!0),(s||o||c)&&(l=!s&&!a?"":""+t,u=""+r),c&&(t=l=l.toLowerCase(),r=u=u.toLowerCase()),n){case"*=":i=l.indexOf(u)>=0;break;case"$=":i=l.indexOf(u,l.length-u.length)>=0;break;case"^=":i=l.indexOf(u)===0;break;case"=":i=t===r;break;case">":h=!0,i=t>r;break;case">=":h=!0,i=t>=r;break;case"<":h=!0,i=t<r;break;case"<=":h=!0,i=t<=r;break;default:i=!1;break}return f&&(t!=null||!h)&&(i=!i),i},zat=function(t,n){switch(n){case"?":return!!t;case"!":return!t;case"^":return t===void 0}},Uat=function(t){return t!==void 0},Uee=function(t,n){return t.data(n)},Wat=function(t,n){return t[n]()},Qr=[],vr=function(t,n){return t.checks.every(function(r){return Qr[r.type](r,n)})};Qr[je.GROUP]=function(e,t){var n=e.value;return n==="*"||n===t.group()};Qr[je.STATE]=function(e,t){var n=e.value;return Mat(n,t)};Qr[je.ID]=function(e,t){var n=e.value;return t.id()===n};Qr[je.CLASS]=function(e,t){var n=e.value;return t.hasClass(n)};Qr[je.META_COMPARE]=function(e,t){var n=e.field,r=e.operator,i=e.value;return hEe(Wat(t,n),r,i)};Qr[je.DATA_COMPARE]=function(e,t){var n=e.field,r=e.operator,i=e.value;return hEe(Uee(t,n),r,i)};Qr[je.DATA_BOOL]=function(e,t){var n=e.field,r=e.operator;return zat(Uee(t,n),r)};Qr[je.DATA_EXIST]=function(e,t){var n=e.field;return e.operator,Uat(Uee(t,n))};Qr[je.UNDIRECTED_EDGE]=function(e,t){var n=e.nodes[0],r=e.nodes[1],i=t.source(),s=t.target();return vr(n,i)&&vr(r,s)||vr(r,i)&&vr(n,s)};Qr[je.NODE_NEIGHBOR]=function(e,t){return vr(e.node,t)&&t.neighborhood().some(function(n){return n.isNode()&&vr(e.neighbor,n)})};Qr[je.DIRECTED_EDGE]=function(e,t){return vr(e.source,t.source())&&vr(e.target,t.target())};Qr[je.NODE_SOURCE]=function(e,t){return vr(e.source,t)&&t.outgoers().some(function(n){return n.isNode()&&vr(e.target,n)})};Qr[je.NODE_TARGET]=function(e,t){return vr(e.target,t)&&t.incomers().some(function(n){return n.isNode()&&vr(e.source,n)})};Qr[je.CHILD]=function(e,t){return vr(e.child,t)&&vr(e.parent,t.parent())};Qr[je.PARENT]=function(e,t){return vr(e.parent,t)&&t.children().some(function(n){return vr(e.child,n)})};Qr[je.DESCENDANT]=function(e,t){return vr(e.descendant,t)&&t.ancestors().some(function(n){return vr(e.ancestor,n)})};Qr[je.ANCESTOR]=function(e,t){return vr(e.ancestor,t)&&t.descendants().some(function(n){return vr(e.descendant,n)})};Qr[je.COMPOUND_SPLIT]=function(e,t){return vr(e.subject,t)&&vr(e.left,t)&&vr(e.right,t)};Qr[je.TRUE]=function(){return!0};Qr[je.COLLECTION]=function(e,t){var n=e.value;return n.has(t)};Qr[je.FILTER]=function(e,t){var n=e.value;return n(t)};var Vat=function(t){var n=this;if(n.length===1&&n[0].checks.length===1&&n[0].checks[0].type===je.ID)return t.getElementById(n[0].checks[0].value).collection();var r=function(s){for(var a=0;a<n.length;a++){var o=n[a];if(vr(o,s))return!0}return!1};return n.text()==null&&(r=function(){return!0}),t.filter(r)},jat=function(t){for(var n=this,r=0;r<n.length;r++){var i=n[r];if(vr(i,t))return!0}return!1},Hat={matches:jat,filter:Vat},P0=function(t){this.inputText=t,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,t==null||rt(t)&&t.match(/^\s*$/)||(Rl(t)?this.addQuery({checks:[{type:je.COLLECTION,value:t.collection()}]}):zr(t)?this.addQuery({checks:[{type:je.FILTER,value:t}]}):rt(t)?this.parse(t)||(this.invalid=!0):Xr("A selector must be created from a string; found "))},L0=P0.prototype;[Bat,Hat].forEach(function(e){return gt(L0,e)});L0.text=function(){return this.inputText};L0.size=function(){return this.length};L0.eq=function(e){return this[e]};L0.sameText=function(e){return!this.invalid&&!e.invalid&&this.text()===e.text()};L0.addQuery=function(e){this[this.length++]=e};L0.selector=L0.toString;var p0={allAre:function(t){var n=new P0(t);return this.every(function(r){return n.matches(r)})},is:function(t){var n=new P0(t);return this.some(function(r){return n.matches(r)})},some:function(t,n){for(var r=0;r<this.length;r++){var i=n?t.apply(n,[this[r],r,this]):t(this[r],r,this);if(i)return!0}return!1},every:function(t,n){for(var r=0;r<this.length;r++){var i=n?t.apply(n,[this[r],r,this]):t(this[r],r,this);if(!i)return!1}return!0},same:function(t){if(this===t)return!0;t=this.cy().collection(t);var n=this.length,r=t.length;return n!==r?!1:n===1?this[0]===t[0]:this.every(function(i){return t.hasElementWithId(i.id())})},anySame:function(t){return t=this.cy().collection(t),this.some(function(n){return t.hasElementWithId(n.id())})},allAreNeighbors:function(t){t=this.cy().collection(t);var n=this.neighborhood();return t.every(function(r){return n.hasElementWithId(r.id())})},contains:function(t){t=this.cy().collection(t);var n=this;return t.every(function(r){return n.hasElementWithId(r.id())})}};p0.allAreNeighbours=p0.allAreNeighbors;p0.has=p0.contains;p0.equal=p0.equals=p0.same;var hu=function(t,n){return function(i,s,a,o){var l=i,u=this,c;if(l==null?c="":Rl(l)&&l.length===1&&(c=l.id()),u.length===1&&c){var f=u[0]._private,h=f.traversalCache=f.traversalCache||{},d=h[n]=h[n]||[],p=Sy(c),g=d[p];return g||(d[p]=t.call(u,i,s,a,o))}else return t.call(u,i,s,a,o)}},Tw={parent:function(t){var n=[];if(this.length===1){var r=this[0]._private.parent;if(r)return r}for(var i=0;i<this.length;i++){var s=this[i],a=s._private.parent;a&&n.push(a)}return this.spawn(n,!0).filter(t)},parents:function(t){for(var n=[],r=this.parent();r.nonempty();){for(var i=0;i<r.length;i++){var s=r[i];n.push(s)}r=r.parent()}return this.spawn(n,!0).filter(t)},commonAncestors:function(t){for(var n,r=0;r<this.length;r++){var i=this[r],s=i.parents();n=n||s,n=n.intersect(s)}return n.filter(t)},orphans:function(t){return this.stdFilter(function(n){return n.isOrphan()}).filter(t)},nonorphans:function(t){return this.stdFilter(function(n){return n.isChild()}).filter(t)},children:hu(function(e){for(var t=[],n=0;n<this.length;n++)for(var r=this[n],i=r._private.children,s=0;s<i.length;s++)t.push(i[s]);return this.spawn(t,!0).filter(e)},"children"),siblings:function(t){return this.parent().children().not(this).filter(t)},isParent:function(){var t=this[0];if(t)return t.isNode()&&t._private.children.length!==0},isChildless:function(){var t=this[0];if(t)return t.isNode()&&t._private.children.length===0},isChild:function(){var t=this[0];if(t)return t.isNode()&&t._private.parent!=null},isOrphan:function(){var t=this[0];if(t)return t.isNode()&&t._private.parent==null},descendants:function(t){var n=[];function r(i){for(var s=0;s<i.length;s++){var a=i[s];n.push(a),a.children().nonempty()&&r(a.children())}}return r(this.children()),this.spawn(n,!0).filter(t)}};function Wee(e,t,n,r){for(var i=[],s=new xC,a=e.cy(),o=a.hasCompoundNodes(),l=0;l<e.length;l++){var u=e[l];n?i.push(u):o&&r(i,s,u)}for(;i.length>0;){var c=i.shift();t(c),s.add(c.id()),o&&r(i,s,c)}return e}function dEe(e,t,n){if(n.isParent())for(var r=n._private.children,i=0;i<r.length;i++){var s=r[i];t.has(s.id())||e.push(s)}}Tw.forEachDown=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Wee(this,e,t,dEe)};function pEe(e,t,n){if(n.isChild()){var r=n._private.parent;t.has(r.id())||e.push(r)}}Tw.forEachUp=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Wee(this,e,t,pEe)};function qat(e,t,n){pEe(e,t,n),dEe(e,t,n)}Tw.forEachUpAndDown=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Wee(this,e,t,qat)};Tw.ancestors=Tw.parents;var aT,gEe;aT=gEe={data:Fn.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:Fn.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:Fn.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Fn.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:Fn.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:Fn.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var t=this[0];if(t)return t._private.data.id}};aT.attr=aT.data;aT.removeAttr=aT.removeData;var Gat=gEe,xB={};function nj(e){return function(t){var n=this;if(t===void 0&&(t=!0),n.length!==0)if(n.isNode()&&!n.removed()){for(var r=0,i=n[0],s=i._private.edges,a=0;a<s.length;a++){var o=s[a];!t&&o.isLoop()||(r+=e(i,o))}return r}else return}}gt(xB,{degree:nj(function(e,t){return t.source().same(t.target())?2:1}),indegree:nj(function(e,t){return t.target().same(e)?1:0}),outdegree:nj(function(e,t){return t.source().same(e)?1:0})});function Kx(e,t){return function(n){for(var r,i=this.nodes(),s=0;s<i.length;s++){var a=i[s],o=a[e](n);o!==void 0&&(r===void 0||t(o,r))&&(r=o)}return r}}gt(xB,{minDegree:Kx("degree",function(e,t){return e<t}),maxDegree:Kx("degree",function(e,t){return e>t}),minIndegree:Kx("indegree",function(e,t){return e<t}),maxIndegree:Kx("indegree",function(e,t){return e>t}),minOutdegree:Kx("outdegree",function(e,t){return e<t}),maxOutdegree:Kx("outdegree",function(e,t){return e>t})});gt(xB,{totalDegree:function(t){for(var n=0,r=this.nodes(),i=0;i<r.length;i++)n+=r[i].degree(t);return n}});var Lc,mEe,vEe=function(t,n,r){for(var i=0;i<t.length;i++){var s=t[i];if(!s.locked()){var a=s._private.position,o={x:n.x!=null?n.x-a.x:0,y:n.y!=null?n.y-a.y:0};s.isParent()&&!(o.x===0&&o.y===0)&&s.children().shift(o,r),s.dirtyBoundingBoxCache()}}},Epe={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(t){t.updateCompoundBounds()},beforeSet:function(t,n){vEe(t,n,!1)},onSet:function(t){t.dirtyCompoundBoundsCache()},canSet:function(t){return!t.locked()}};Lc=mEe={position:Fn.data(Epe),silentPosition:Fn.data(gt({},Epe,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(t,n){vEe(t,n,!0)},onSet:function(t){t.dirtyCompoundBoundsCache()}})),positions:function(t,n){if(pn(t))n?this.silentPosition(t):this.position(t);else if(zr(t)){var r=t,i=this.cy();i.startBatch();for(var s=0;s<this.length;s++){var a=this[s],o=void 0;(o=r(a,s))&&(n?a.silentPosition(o):a.position(o))}i.endBatch()}return this},silentPositions:function(t){return this.positions(t,!0)},shift:function(t,n,r){var i;if(pn(t)?(i={x:Pe(t.x)?t.x:0,y:Pe(t.y)?t.y:0},r=n):rt(t)&&Pe(n)&&(i={x:0,y:0},i[t]=n),i!=null){var s=this.cy();s.startBatch();for(var a=0;a<this.length;a++){var o=this[a];if(!(s.hasCompoundNodes()&&o.isChild()&&o.ancestors().anySame(this))){var l=o.position(),u={x:l.x+i.x,y:l.y+i.y};r?o.silentPosition(u):o.position(u)}}s.endBatch()}return this},silentShift:function(t,n){return pn(t)?this.shift(t,!0):rt(t)&&Pe(n)&&this.shift(t,n,!0),this},renderedPosition:function(t,n){var r=this[0],i=this.cy(),s=i.zoom(),a=i.pan(),o=pn(t)?t:void 0,l=o!==void 0||n!==void 0&&rt(t);if(r&&r.isNode())if(l)for(var u=0;u<this.length;u++){var c=this[u];n!==void 0?c.position(t,(n-a[t])/s):o!==void 0&&c.position(Xke(o,s,a))}else{var f=r.position();return o=yB(f,s,a),t===void 0?o:o[t]}else if(!l)return;return this},relativePosition:function(t,n){var r=this[0],i=this.cy(),s=pn(t)?t:void 0,a=s!==void 0||n!==void 0&&rt(t),o=i.hasCompoundNodes();if(r&&r.isNode())if(a)for(var l=0;l<this.length;l++){var u=this[l],c=o?u.parent():null,f=c&&c.length>0,h=f;f&&(c=c[0]);var d=h?c.position():{x:0,y:0};n!==void 0?u.position(t,n+d[t]):s!==void 0&&u.position({x:s.x+d.x,y:s.y+d.y})}else{var p=r.position(),g=o?r.parent():null,m=g&&g.length>0,v=m;m&&(g=g[0]);var y=v?g.position():{x:0,y:0};return s={x:p.x-y.x,y:p.y-y.y},t===void 0?s:s[t]}else if(!a)return;return this}};Lc.modelPosition=Lc.point=Lc.position;Lc.modelPositions=Lc.points=Lc.positions;Lc.renderedPoint=Lc.renderedPosition;Lc.relativePoint=Lc.relativePosition;var Yat=mEe,H2,Rm;H2=Rm={};Rm.renderedBoundingBox=function(e){var t=this.boundingBox(e),n=this.cy(),r=n.zoom(),i=n.pan(),s=t.x1*r+i.x,a=t.x2*r+i.x,o=t.y1*r+i.y,l=t.y2*r+i.y;return{x1:s,x2:a,y1:o,y2:l,w:a-s,h:l-o}};Rm.dirtyCompoundBoundsCache=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.cy();return!t.styleEnabled()||!t.hasCompoundNodes()?this:(this.forEachUp(function(n){if(n.isParent()){var r=n._private;r.compoundBoundsClean=!1,r.bbCache=null,e||n.emitAndNotify("bounds")}}),this)};Rm.updateCompoundBounds=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.cy();if(!t.styleEnabled()||!t.hasCompoundNodes())return this;if(!e&&t.batching())return this;function n(a){if(!a.isParent())return;var o=a._private,l=a.children(),u=a.pstyle("compound-sizing-wrt-labels").value==="include",c={width:{val:a.pstyle("min-width").pfValue,left:a.pstyle("min-width-bias-left"),right:a.pstyle("min-width-bias-right")},height:{val:a.pstyle("min-height").pfValue,top:a.pstyle("min-height-bias-top"),bottom:a.pstyle("min-height-bias-bottom")}},f=l.boundingBox({includeLabels:u,includeOverlays:!1,useCache:!1}),h=o.position;(f.w===0||f.h===0)&&(f={w:a.pstyle("width").pfValue,h:a.pstyle("height").pfValue},f.x1=h.x-f.w/2,f.x2=h.x+f.w/2,f.y1=h.y-f.h/2,f.y2=h.y+f.h/2);function d(k,E,S){var N=0,A=0,D=E+S;return k>0&&D>0&&(N=E/D*k,A=S/D*k),{biasDiff:N,biasComplementDiff:A}}function p(k,E,S,N){if(S.units==="%")switch(N){case"width":return k>0?S.pfValue*k:0;case"height":return E>0?S.pfValue*E:0;case"average":return k>0&&E>0?S.pfValue*(k+E)/2:0;case"min":return k>0&&E>0?k>E?S.pfValue*E:S.pfValue*k:0;case"max":return k>0&&E>0?k>E?S.pfValue*k:S.pfValue*E:0;default:return 0}else return S.units==="px"?S.pfValue:0}var g=c.width.left.value;c.width.left.units==="px"&&c.width.val>0&&(g=g*100/c.width.val);var m=c.width.right.value;c.width.right.units==="px"&&c.width.val>0&&(m=m*100/c.width.val);var v=c.height.top.value;c.height.top.units==="px"&&c.height.val>0&&(v=v*100/c.height.val);var y=c.height.bottom.value;c.height.bottom.units==="px"&&c.height.val>0&&(y=y*100/c.height.val);var b=d(c.width.val-f.w,g,m),x=b.biasDiff,w=b.biasComplementDiff,C=d(c.height.val-f.h,v,y),$=C.biasDiff,_=C.biasComplementDiff;o.autoPadding=p(f.w,f.h,a.pstyle("padding"),a.pstyle("padding-relative-to").value),o.autoWidth=Math.max(f.w,c.width.val),h.x=(-x+f.x1+f.x2+w)/2,o.autoHeight=Math.max(f.h,c.height.val),h.y=(-$+f.y1+f.y2+_)/2}for(var r=0;r<this.length;r++){var i=this[r],s=i._private;(!s.compoundBoundsClean||e)&&(n(i),t.batching()||(s.compoundBoundsClean=!0))}return this};var cu=function(t){return t===1/0||t===-1/0?0:t},gc=function(t,n,r,i,s){i-n===0||s-r===0||n==null||r==null||i==null||s==null||(t.x1=n<t.x1?n:t.x1,t.x2=i>t.x2?i:t.x2,t.y1=r<t.y1?r:t.y1,t.y2=s>t.y2?s:t.y2,t.w=t.x2-t.x1,t.h=t.y2-t.y1)},qv=function(t,n){return n==null?t:gc(t,n.x1,n.y1,n.x2,n.y2)},YS=function(t,n,r){return vc(t,n,r)},QF=function(t,n,r){if(!n.cy().headless()){var i=n._private,s=i.rstyle,a=s.arrowWidth/2,o=n.pstyle(r+"-arrow-shape").value,l,u;if(o!=="none"){r==="source"?(l=s.srcX,u=s.srcY):r==="target"?(l=s.tgtX,u=s.tgtY):(l=s.midX,u=s.midY);var c=i.arrowBounds=i.arrowBounds||{},f=c[r]=c[r]||{};f.x1=l-a,f.y1=u-a,f.x2=l+a,f.y2=u+a,f.w=f.x2-f.x1,f.h=f.y2-f.y1,ZR(f,1),gc(t,f.x1,f.y1,f.x2,f.y2)}}},rj=function(t,n,r){if(!n.cy().headless()){var i;r?i=r+"-":i="";var s=n._private,a=s.rstyle,o=n.pstyle(i+"label").strValue;if(o){var l=n.pstyle("text-halign"),u=n.pstyle("text-valign"),c=YS(a,"labelWidth",r),f=YS(a,"labelHeight",r),h=YS(a,"labelX",r),d=YS(a,"labelY",r),p=n.pstyle(i+"text-margin-x").pfValue,g=n.pstyle(i+"text-margin-y").pfValue,m=n.isEdge(),v=n.pstyle(i+"text-rotation"),y=n.pstyle("text-outline-width").pfValue,b=n.pstyle("text-border-width").pfValue,x=b/2,w=n.pstyle("text-background-padding").pfValue,C=2,$=f,_=c,k=_/2,E=$/2,S,N,A,D;if(m)S=h-k,N=h+k,A=d-E,D=d+E;else{switch(l.value){case"left":S=h-_,N=h;break;case"center":S=h-k,N=h+k;break;case"right":S=h,N=h+_;break}switch(u.value){case"top":A=d-$,D=d;break;case"center":A=d-E,D=d+E;break;case"bottom":A=d,D=d+$;break}}S+=p-Math.max(y,x)-w-C,N+=p+Math.max(y,x)+w+C,A+=g-Math.max(y,x)-w-C,D+=g+Math.max(y,x)+w+C;var T=r||"main",I=s.labelBounds,F=I[T]=I[T]||{};F.x1=S,F.y1=A,F.x2=N,F.y2=D,F.w=N-S,F.h=D-A;var R=m&&v.strValue==="autorotate",P=v.pfValue!=null&&v.pfValue!==0;if(R||P){var V=R?YS(s.rstyle,"labelAngle",r):v.pfValue,z=Math.cos(V),q=Math.sin(V),G=(S+N)/2,K=(A+D)/2;if(!m){switch(l.value){case"left":G=N;break;case"right":G=S;break}switch(u.value){case"top":K=D;break;case"bottom":K=A;break}}var Y=function(ue,X){return ue=ue-G,X=X-K,{x:ue*z-X*q+G,y:ue*q+X*z+K}},te=Y(S,A),Z=Y(S,D),ae=Y(N,A),O=Y(N,D);S=Math.min(te.x,Z.x,ae.x,O.x),N=Math.max(te.x,Z.x,ae.x,O.x),A=Math.min(te.y,Z.y,ae.y,O.y),D=Math.max(te.y,Z.y,ae.y,O.y)}var L=T+"Rot",W=I[L]=I[L]||{};W.x1=S,W.y1=A,W.x2=N,W.y2=D,W.w=N-S,W.h=D-A,gc(t,S,A,N,D),gc(s.labelBounds.all,S,A,N,D)}return t}},Xat=function(t,n){var r=t._private.cy,i=r.styleEnabled(),s=r.headless(),a=il(),o=t._private,l=t.isNode(),u=t.isEdge(),c,f,h,d,p,g,m=o.rstyle,v=l&&i?t.pstyle("bounds-expansion").pfValue:[0],y=function(oe){return oe.pstyle("display").value!=="none"},b=!i||y(t)&&(!u||y(t.source())&&y(t.target()));if(b){var x=0,w=0;i&&n.includeOverlays&&(x=t.pstyle("overlay-opacity").value,x!==0&&(w=t.pstyle("overlay-padding").value));var C=0,$=0;i&&n.includeUnderlays&&(C=t.pstyle("underlay-opacity").value,C!==0&&($=t.pstyle("underlay-padding").value));var _=Math.max(w,$),k=0,E=0;if(i&&(k=t.pstyle("width").pfValue,E=k/2),l&&n.includeNodes){var S=t.position();p=S.x,g=S.y;var N=t.outerWidth(),A=N/2,D=t.outerHeight(),T=D/2;c=p-A,f=p+A,h=g-T,d=g+T,gc(a,c,h,f,d)}else if(u&&n.includeEdges)if(i&&!s){var I=t.pstyle("curve-style").strValue;if(c=Math.min(m.srcX,m.midX,m.tgtX),f=Math.max(m.srcX,m.midX,m.tgtX),h=Math.min(m.srcY,m.midY,m.tgtY),d=Math.max(m.srcY,m.midY,m.tgtY),c-=E,f+=E,h-=E,d+=E,gc(a,c,h,f,d),I==="haystack"){var F=m.haystackPts;if(F&&F.length===2){if(c=F[0].x,h=F[0].y,f=F[1].x,d=F[1].y,c>f){var R=c;c=f,f=R}if(h>d){var P=h;h=d,d=P}gc(a,c-E,h-E,f+E,d+E)}}else if(I==="bezier"||I==="unbundled-bezier"||I==="segments"||I==="taxi"){var V;switch(I){case"bezier":case"unbundled-bezier":V=m.bezierPts;break;case"segments":case"taxi":V=m.linePts;break}if(V!=null)for(var z=0;z<V.length;z++){var q=V[z];c=q.x-E,f=q.x+E,h=q.y-E,d=q.y+E,gc(a,c,h,f,d)}}}else{var G=t.source(),K=G.position(),Y=t.target(),te=Y.position();if(c=K.x,f=te.x,h=K.y,d=te.y,c>f){var Z=c;c=f,f=Z}if(h>d){var ae=h;h=d,d=ae}c-=E,f+=E,h-=E,d+=E,gc(a,c,h,f,d)}if(i&&n.includeEdges&&u&&(QF(a,t,"mid-source"),QF(a,t,"mid-target"),QF(a,t,"source"),QF(a,t,"target")),i){var O=t.pstyle("ghost").value==="yes";if(O){var L=t.pstyle("ghost-offset-x").pfValue,W=t.pstyle("ghost-offset-y").pfValue;gc(a,a.x1+L,a.y1+W,a.x2+L,a.y2+W)}}var M=o.bodyBounds=o.bodyBounds||{};fpe(M,a),JV(M,v),ZR(M,1),i&&(c=a.x1,f=a.x2,h=a.y1,d=a.y2,gc(a,c-_,h-_,f+_,d+_));var ue=o.overlayBounds=o.overlayBounds||{};fpe(ue,a),JV(ue,v),ZR(ue,1);var X=o.labelBounds=o.labelBounds||{};X.all!=null?$st(X.all):X.all=il(),i&&n.includeLabels&&(n.includeMainLabels&&rj(a,t,null),u&&(n.includeSourceLabels&&rj(a,t,"source"),n.includeTargetLabels&&rj(a,t,"target")))}return a.x1=cu(a.x1),a.y1=cu(a.y1),a.x2=cu(a.x2),a.y2=cu(a.y2),a.w=cu(a.x2-a.x1),a.h=cu(a.y2-a.y1),a.w>0&&a.h>0&&b&&(JV(a,v),ZR(a,1)),a},yEe=function(t){var n=0,r=function(a){return(a?1:0)<<n++},i=0;return i+=r(t.incudeNodes),i+=r(t.includeEdges),i+=r(t.includeLabels),i+=r(t.includeMainLabels),i+=r(t.includeSourceLabels),i+=r(t.includeTargetLabels),i+=r(t.includeOverlays),i},bEe=function(t){if(t.isEdge()){var n=t.source().position(),r=t.target().position(),i=function(a){return Math.round(a)};return jit([i(n.x),i(n.y),i(r.x),i(r.y)])}else return 0},Ape=function(t,n){var r=t._private,i,s=t.isEdge(),a=n==null?Tpe:yEe(n),o=a===Tpe,l=bEe(t),u=r.bbCachePosKey===l,c=n.useCache&&u,f=function(g){return g._private.bbCache==null||g._private.styleDirty},h=!c||f(t)||s&&f(t.source())||f(t.target());if(h?(u||t.recalculateRenderedStyle(c),i=Xat(t,oT),r.bbCache=i,r.bbCachePosKey=l):i=r.bbCache,!o){var d=t.isNode();i=il(),(n.includeNodes&&d||n.includeEdges&&!d)&&(n.includeOverlays?qv(i,r.overlayBounds):qv(i,r.bodyBounds)),n.includeLabels&&(n.includeMainLabels&&(!s||n.includeSourceLabels&&n.includeTargetLabels)?qv(i,r.labelBounds.all):(n.includeMainLabels&&qv(i,r.labelBounds.mainRot),n.includeSourceLabels&&qv(i,r.labelBounds.sourceRot),n.includeTargetLabels&&qv(i,r.labelBounds.targetRot))),i.w=i.x2-i.x1,i.h=i.y2-i.y1}return i},oT={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,useCache:!0},Tpe=yEe(oT),Dpe=Ys(oT);Rm.boundingBox=function(e){var t;if(this.length===1&&this[0]._private.bbCache!=null&&!this[0]._private.styleDirty&&(e===void 0||e.useCache===void 0||e.useCache===!0))e===void 0?e=oT:e=Dpe(e),t=Ape(this[0],e);else{t=il(),e=e||oT;var n=Dpe(e),r=this,i=r.cy(),s=i.styleEnabled();if(s)for(var a=0;a<r.length;a++){var o=r[a],l=o._private,u=bEe(o),c=l.bbCachePosKey===u,f=n.useCache&&c&&!l.styleDirty;o.recalculateRenderedStyle(f)}this.updateCompoundBounds(!e.useCache);for(var h=0;h<r.length;h++){var d=r[h];qv(t,Ape(d,n))}}return t.x1=cu(t.x1),t.y1=cu(t.y1),t.x2=cu(t.x2),t.y2=cu(t.y2),t.w=cu(t.x2-t.x1),t.h=cu(t.y2-t.y1),t};Rm.dirtyBoundingBoxCache=function(){for(var e=0;e<this.length;e++){var t=this[e]._private;t.bbCache=null,t.bbCachePosKey=null,t.bodyBounds=null,t.overlayBounds=null,t.labelBounds.all=null,t.labelBounds.source=null,t.labelBounds.target=null,t.labelBounds.main=null,t.labelBounds.sourceRot=null,t.labelBounds.targetRot=null,t.labelBounds.mainRot=null,t.arrowBounds.source=null,t.arrowBounds.target=null,t.arrowBounds["mid-source"]=null,t.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Rm.boundingBoxAt=function(e){var t=this.nodes(),n=this.cy(),r=n.hasCompoundNodes(),i=n.collection();if(r&&(i=t.filter(function(u){return u.isParent()}),t=t.not(i)),pn(e)){var s=e;e=function(){return s}}var a=function(c,f){return c._private.bbAtOldPos=e(c,f)},o=function(c){return c._private.bbAtOldPos};n.startBatch(),t.forEach(a).silentPositions(e),r&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0));var l=wst(this.boundingBox({useCache:!1}));return t.silentPositions(o),r&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0)),n.endBatch(),l};H2.boundingbox=H2.bb=H2.boundingBox;H2.renderedBoundingbox=H2.renderedBoundingBox;var Kat=Rm,nE,dN;nE=dN={};var xEe=function(t){t.uppercaseName=ope(t.name),t.autoName="auto"+t.uppercaseName,t.labelName="label"+t.uppercaseName,t.outerName="outer"+t.uppercaseName,t.uppercaseOuterName=ope(t.outerName),nE[t.name]=function(){var r=this[0],i=r._private,s=i.cy,a=s._private.styleEnabled;if(r)if(a){if(r.isParent())return r.updateCompoundBounds(),i[t.autoName]||0;var o=r.pstyle(t.name);switch(o.strValue){case"label":return r.recalculateRenderedStyle(),i.rstyle[t.labelName]||0;default:return o.pfValue}}else return 1},nE["outer"+t.uppercaseName]=function(){var r=this[0],i=r._private,s=i.cy,a=s._private.styleEnabled;if(r)if(a){var o=r[t.name](),l=r.pstyle("border-width").pfValue,u=2*r.padding();return o+l+u}else return 1},nE["rendered"+t.uppercaseName]=function(){var r=this[0];if(r){var i=r[t.name]();return i*this.cy().zoom()}},nE["rendered"+t.uppercaseOuterName]=function(){var r=this[0];if(r){var i=r[t.outerName]();return i*this.cy().zoom()}}};xEe({name:"width"});xEe({name:"height"});dN.padding=function(){var e=this[0],t=e._private;return e.isParent()?(e.updateCompoundBounds(),t.autoPadding!==void 0?t.autoPadding:e.pstyle("padding").pfValue):e.pstyle("padding").pfValue};dN.paddedHeight=function(){var e=this[0];return e.height()+2*e.padding()};dN.paddedWidth=function(){var e=this[0];return e.width()+2*e.padding()};var Zat=dN,Qat=function(t,n){if(t.isEdge())return n(t)},Jat=function(t,n){if(t.isEdge()){var r=t.cy();return yB(n(t),r.zoom(),r.pan())}},eot=function(t,n){if(t.isEdge()){var r=t.cy(),i=r.pan(),s=r.zoom();return n(t).map(function(a){return yB(a,s,i)})}},tot=function(t){return t.renderer().getControlPoints(t)},not=function(t){return t.renderer().getSegmentPoints(t)},rot=function(t){return t.renderer().getSourceEndpoint(t)},iot=function(t){return t.renderer().getTargetEndpoint(t)},sot=function(t){return t.renderer().getEdgeMidpoint(t)},Npe={controlPoints:{get:tot,mult:!0},segmentPoints:{get:not,mult:!0},sourceEndpoint:{get:rot},targetEndpoint:{get:iot},midpoint:{get:sot}},aot=function(t){return"rendered"+t[0].toUpperCase()+t.substr(1)},oot=Object.keys(Npe).reduce(function(e,t){var n=Npe[t],r=aot(t);return e[t]=function(){return Qat(this,n.get)},n.mult?e[r]=function(){return eot(this,n.get)}:e[r]=function(){return Jat(this,n.get)},e},{}),lot=gt({},Yat,Kat,Zat,oot);/*!
Event object based on jQuery events, MIT license

https://jquery.org/license/
https://tldrlegal.com/license/mit-license
https://github.com/jquery/jquery/blob/master/src/event.js
*/var wEe=function(t,n){this.recycle(t,n)};function XS(){return!1}function JF(){return!0}wEe.prototype={instanceString:function(){return"event"},recycle:function(t,n){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=XS,t!=null&&t.preventDefault?(this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?JF:XS):t!=null&&t.type?n=t:this.type=t,n!=null&&(this.originalEvent=n.originalEvent,this.type=n.type!=null?n.type:this.type,this.cy=n.cy,this.target=n.target,this.position=n.position,this.renderedPosition=n.renderedPosition,this.namespace=n.namespace,this.layout=n.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var r=this.position,i=this.cy.zoom(),s=this.cy.pan();this.renderedPosition={x:r.x*i+s.x,y:r.y*i+s.y}}this.timeStamp=t&&t.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=JF;var t=this.originalEvent;!t||t.preventDefault&&t.preventDefault()},stopPropagation:function(){this.isPropagationStopped=JF;var t=this.originalEvent;!t||t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=JF,this.stopPropagation()},isDefaultPrevented:XS,isPropagationStopped:XS,isImmediatePropagationStopped:XS};var $Ee=/^([^.]+)(\.(?:[^.]+))?$/,uot=".*",CEe={qualifierCompare:function(t,n){return t===n},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(t){return t},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},Ipe=Object.keys(CEe),cot={};function wB(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:cot,t=arguments.length>1?arguments[1]:void 0,n=0;n<Ipe.length;n++){var r=Ipe[n];this[r]=e[r]||CEe[r]}this.context=t||this.context,this.listeners=[],this.emitting=0}var B0=wB.prototype,_Ee=function(t,n,r,i,s,a,o){zr(i)&&(s=i,i=null),o&&(a==null?a=o:a=gt({},a,o));for(var l=Jn(r)?r:r.split(/\s+/),u=0;u<l.length;u++){var c=l[u];if(!O0(c)){var f=c.match($Ee);if(f){var h=f[1],d=f[2]?f[2]:null,p=n(t,c,h,d,i,s,a);if(p===!1)break}}}},Mpe=function(t,n){return t.addEventFields(t.context,n),new wEe(n.type,n)},fot=function(t,n,r){if(_it(r)){n(t,r);return}else if(pn(r)){n(t,Mpe(t,r));return}for(var i=Jn(r)?r:r.split(/\s+/),s=0;s<i.length;s++){var a=i[s];if(!O0(a)){var o=a.match($Ee);if(o){var l=o[1],u=o[2]?o[2]:null,c=Mpe(t,{type:l,namespace:u,target:t.context});n(t,c)}}}};B0.on=B0.addListener=function(e,t,n,r,i){return _Ee(this,function(s,a,o,l,u,c,f){zr(c)&&s.listeners.push({event:a,callback:c,type:o,namespace:l,qualifier:u,conf:f})},e,t,n,r,i),this};B0.one=function(e,t,n,r){return this.on(e,t,n,r,{one:!0})};B0.removeListener=B0.off=function(e,t,n,r){var i=this;this.emitting!==0&&(this.listeners=Xit(this.listeners));for(var s=this.listeners,a=function(u){var c=s[u];_Ee(i,function(f,h,d,p,g,m){if((c.type===d||e==="*")&&(!p&&c.namespace!==".*"||c.namespace===p)&&(!g||f.qualifierCompare(c.qualifier,g))&&(!m||c.callback===m))return s.splice(u,1),!1},e,t,n,r)},o=s.length-1;o>=0;o--)a(o);return this};B0.removeAllListeners=function(){return this.removeListener("*")};B0.emit=B0.trigger=function(e,t,n){var r=this.listeners,i=r.length;return this.emitting++,Jn(t)||(t=[t]),fot(this,function(s,a){n!=null&&(r=[{event:a.event,type:a.type,namespace:a.namespace,callback:n}],i=r.length);for(var o=function(c){var f=r[c];if(f.type===a.type&&(!f.namespace||f.namespace===a.namespace||f.namespace===uot)&&s.eventMatches(s.context,f,a)){var h=[a];t!=null&&Zit(h,t),s.beforeEmit(s.context,f,a),f.conf&&f.conf.one&&(s.listeners=s.listeners.filter(function(g){return g!==f}));var d=s.callbackContext(s.context,f,a),p=f.callback.apply(d,h);s.afterEmit(s.context,f,a),p===!1&&(a.stopPropagation(),a.preventDefault())}},l=0;l<i;l++)o(l);s.bubble(s.context)&&!a.isPropagationStopped()&&s.parent(s.context).emit(a,t)},e),this.emitting--,this};var hot={qualifierCompare:function(t,n){return t==null||n==null?t==null&&n==null:t.sameText(n)},eventMatches:function(t,n,r){var i=n.qualifier;return i!=null?t!==r.target&&fN(r.target)&&i.matches(r.target):!0},addEventFields:function(t,n){n.cy=t.cy(),n.target=t},callbackContext:function(t,n,r){return n.qualifier!=null?r.target:t},beforeEmit:function(t,n){n.conf&&n.conf.once&&n.conf.onceCollection.removeListener(n.event,n.qualifier,n.callback)},bubble:function(){return!0},parent:function(t){return t.isChild()?t.parent():t.cy()}},eO=function(t){return rt(t)?new P0(t):t},SEe={createEmitter:function(){for(var t=0;t<this.length;t++){var n=this[t],r=n._private;r.emitter||(r.emitter=new wB(hot,n))}return this},emitter:function(){return this._private.emitter},on:function(t,n,r){for(var i=eO(n),s=0;s<this.length;s++){var a=this[s];a.emitter().on(t,i,r)}return this},removeListener:function(t,n,r){for(var i=eO(n),s=0;s<this.length;s++){var a=this[s];a.emitter().removeListener(t,i,r)}return this},removeAllListeners:function(){for(var t=0;t<this.length;t++){var n=this[t];n.emitter().removeAllListeners()}return this},one:function(t,n,r){for(var i=eO(n),s=0;s<this.length;s++){var a=this[s];a.emitter().one(t,i,r)}return this},once:function(t,n,r){for(var i=eO(n),s=0;s<this.length;s++){var a=this[s];a.emitter().on(t,i,r,{once:!0,onceCollection:this})}},emit:function(t,n){for(var r=0;r<this.length;r++){var i=this[r];i.emitter().emit(t,n)}return this},emitAndNotify:function(t,n){if(this.length!==0)return this.cy().notify(t,this),this.emit(t,n),this}};Fn.eventAliasesOn(SEe);var kEe={nodes:function(t){return this.filter(function(n){return n.isNode()}).filter(t)},edges:function(t){return this.filter(function(n){return n.isEdge()}).filter(t)},byGroup:function(){for(var t=this.spawn(),n=this.spawn(),r=0;r<this.length;r++){var i=this[r];i.isNode()?t.push(i):n.push(i)}return{nodes:t,edges:n}},filter:function(t,n){if(t===void 0)return this;if(rt(t)||Rl(t))return new P0(t).filter(this);if(zr(t)){for(var r=this.spawn(),i=this,s=0;s<i.length;s++){var a=i[s],o=n?t.apply(n,[a,s,i]):t(a,s,i);o&&r.push(a)}return r}return this.spawn()},not:function(t){if(t){rt(t)&&(t=this.filter(t));for(var n=this.spawn(),r=0;r<this.length;r++){var i=this[r],s=t.has(i);s||n.push(i)}return n}else return this},absoluteComplement:function(){var t=this.cy();return t.mutableElements().not(this)},intersect:function(t){if(rt(t)){var n=t;return this.filter(n)}for(var r=this.spawn(),i=this,s=t,a=this.length<t.length,o=a?i:s,l=a?s:i,u=0;u<o.length;u++){var c=o[u];l.has(c)&&r.push(c)}return r},xor:function(t){var n=this._private.cy;rt(t)&&(t=n.$(t));var r=this.spawn(),i=this,s=t,a=function(l,u){for(var c=0;c<l.length;c++){var f=l[c],h=f._private.data.id,d=u.hasElementWithId(h);d||r.push(f)}};return a(i,s),a(s,i),r},diff:function(t){var n=this._private.cy;rt(t)&&(t=n.$(t));var r=this.spawn(),i=this.spawn(),s=this.spawn(),a=this,o=t,l=function(c,f,h){for(var d=0;d<c.length;d++){var p=c[d],g=p._private.data.id,m=f.hasElementWithId(g);m?s.merge(p):h.push(p)}};return l(a,o,r),l(o,a,i),{left:r,right:i,both:s}},add:function(t){var n=this._private.cy;if(!t)return this;if(rt(t)){var r=t;t=n.mutableElements().filter(r)}for(var i=this.spawnSelf(),s=0;s<t.length;s++){var a=t[s],o=!this.has(a);o&&i.push(a)}return i},merge:function(t){var n=this._private,r=n.cy;if(!t)return this;if(t&&rt(t)){var i=t;t=r.mutableElements().filter(i)}for(var s=n.map,a=0;a<t.length;a++){var o=t[a],l=o._private.data.id,u=!s.has(l);if(u){var c=this.length++;this[c]=o,s.set(l,{ele:o,index:c})}}return this},unmergeAt:function(t){var n=this[t],r=n.id(),i=this._private,s=i.map;this[t]=void 0,s.delete(r);var a=t===this.length-1;if(this.length>1&&!a){var o=this.length-1,l=this[o],u=l._private.data.id;this[o]=void 0,this[t]=l,s.set(u,{ele:l,index:t})}return this.length--,this},unmergeOne:function(t){t=t[0];var n=this._private,r=t._private.data.id,i=n.map,s=i.get(r);if(!s)return this;var a=s.index;return this.unmergeAt(a),this},unmerge:function(t){var n=this._private.cy;if(!t)return this;if(t&&rt(t)){var r=t;t=n.mutableElements().filter(r)}for(var i=0;i<t.length;i++)this.unmergeOne(t[i]);return this},unmergeBy:function(t){for(var n=this.length-1;n>=0;n--){var r=this[n];t(r)&&this.unmergeAt(n)}return this},map:function(t,n){for(var r=[],i=this,s=0;s<i.length;s++){var a=i[s],o=n?t.apply(n,[a,s,i]):t(a,s,i);r.push(o)}return r},reduce:function(t,n){for(var r=n,i=this,s=0;s<i.length;s++)r=t(r,i[s],s,i);return r},max:function(t,n){for(var r=-1/0,i,s=this,a=0;a<s.length;a++){var o=s[a],l=n?t.apply(n,[o,a,s]):t(o,a,s);l>r&&(r=l,i=o)}return{value:r,ele:i}},min:function(t,n){for(var r=1/0,i,s=this,a=0;a<s.length;a++){var o=s[a],l=n?t.apply(n,[o,a,s]):t(o,a,s);l<r&&(r=l,i=o)}return{value:r,ele:i}}},yn=kEe;yn.u=yn["|"]=yn["+"]=yn.union=yn.or=yn.add;yn["\\"]=yn["!"]=yn["-"]=yn.difference=yn.relativeComplement=yn.subtract=yn.not;yn.n=yn["&"]=yn["."]=yn.and=yn.intersection=yn.intersect;yn["^"]=yn["(+)"]=yn["(-)"]=yn.symmetricDifference=yn.symdiff=yn.xor;yn.fnFilter=yn.filterFn=yn.stdFilter=yn.filter;yn.complement=yn.abscomp=yn.absoluteComplement;var dot={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var t=this[0];if(t)return t._private.group}},EEe=function(t,n){var r=t.cy(),i=r.hasCompoundNodes();function s(c){var f=c.pstyle("z-compound-depth");return f.value==="auto"?i?c.zDepth():0:f.value==="bottom"?-1:f.value==="top"?Fee:0}var a=s(t)-s(n);if(a!==0)return a;function o(c){var f=c.pstyle("z-index-compare");return f.value==="auto"&&c.isNode()?1:0}var l=o(t)-o(n);if(l!==0)return l;var u=t.pstyle("z-index").value-n.pstyle("z-index").value;return u!==0?u:t.poolIndex()-n.poolIndex()},g5={forEach:function(t,n){if(zr(t))for(var r=this.length,i=0;i<r;i++){var s=this[i],a=n?t.apply(n,[s,i,this]):t(s,i,this);if(a===!1)break}return this},toArray:function(){for(var t=[],n=0;n<this.length;n++)t.push(this[n]);return t},slice:function(t,n){var r=[],i=this.length;n==null&&(n=i),t==null&&(t=0),t<0&&(t=i+t),n<0&&(n=i+n);for(var s=t;s>=0&&s<n&&s<i;s++)r.push(this[s]);return this.spawn(r)},size:function(){return this.length},eq:function(t){return this[t]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(t){if(!zr(t))return this;var n=this.toArray().sort(t);return this.spawn(n)},sortByZIndex:function(){return this.sort(EEe)},zDepth:function(){var t=this[0];if(!!t){var n=t._private,r=n.group;if(r==="nodes"){var i=n.data.parent?t.parents().size():0;return t.isParent()?i:Fee-1}else{var s=n.source,a=n.target,o=s.zDepth(),l=a.zDepth();return Math.max(o,l,0)}}}};g5.each=g5.forEach;var pot=function(){var t="undefined",n=(typeof Symbol>"u"?"undefined":Mi(Symbol))!=t&&Mi(Symbol.iterator)!=t;n&&(g5[Symbol.iterator]=function(){var r=this,i={value:void 0,done:!1},s=0,a=this.length;return Mke({next:function(){return s<a?i.value=r[s++]:(i.value=void 0,i.done=!0),i}},Symbol.iterator,function(){return this})})};pot();var got=Ys({nodeDimensionsIncludeLabels:!1}),JR={layoutDimensions:function(t){t=got(t);var n;if(!this.takesUpSpace())n={w:0,h:0};else if(t.nodeDimensionsIncludeLabels){var r=this.boundingBox();n={w:r.w,h:r.h}}else n={w:this.outerWidth(),h:this.outerHeight()};return(n.w===0||n.h===0)&&(n.w=n.h=1),n},layoutPositions:function(t,n,r){var i=this.nodes().filter(function(w){return!w.isParent()}),s=this.cy(),a=n.eles,o=function(C){return C.id()},l=eT(r,o);t.emit({type:"layoutstart",layout:t}),t.animations=[];var u=function(C,$,_){var k={x:$.x1+$.w/2,y:$.y1+$.h/2},E={x:(_.x-k.x)*C,y:(_.y-k.y)*C};return{x:k.x+E.x,y:k.y+E.y}},c=n.spacingFactor&&n.spacingFactor!==1,f=function(){if(!c)return null;for(var C=il(),$=0;$<i.length;$++){var _=i[$],k=l(_,$);_st(C,k.x,k.y)}return C},h=f(),d=eT(function(w,C){var $=l(w,C);if(c){var _=Math.abs(n.spacingFactor);$=u(_,h,$)}return n.transform!=null&&($=n.transform(w,$)),$},o);if(n.animate){for(var p=0;p<i.length;p++){var g=i[p],m=d(g,p),v=n.animateFilter==null||n.animateFilter(g,p);if(v){var y=g.animation({position:m,duration:n.animationDuration,easing:n.animationEasing});t.animations.push(y)}else g.position(m)}if(n.fit){var b=s.animation({fit:{boundingBox:a.boundingBoxAt(d),padding:n.padding},duration:n.animationDuration,easing:n.animationEasing});t.animations.push(b)}else if(n.zoom!==void 0&&n.pan!==void 0){var x=s.animation({zoom:n.zoom,pan:n.pan,duration:n.animationDuration,easing:n.animationEasing});t.animations.push(x)}t.animations.forEach(function(w){return w.play()}),t.one("layoutready",n.ready),t.emit({type:"layoutready",layout:t}),wC.all(t.animations.map(function(w){return w.promise()})).then(function(){t.one("layoutstop",n.stop),t.emit({type:"layoutstop",layout:t})})}else i.positions(d),n.fit&&s.fit(n.eles,n.padding),n.zoom!=null&&s.zoom(n.zoom),n.pan&&s.pan(n.pan),t.one("layoutready",n.ready),t.emit({type:"layoutready",layout:t}),t.one("layoutstop",n.stop),t.emit({type:"layoutstop",layout:t});return this},layout:function(t){var n=this.cy();return n.makeLayout(gt({},t,{eles:this}))}};JR.createLayout=JR.makeLayout=JR.layout;function AEe(e,t,n){var r=n._private,i=r.styleCache=r.styleCache||[],s;return(s=i[e])!=null||(s=i[e]=t(n)),s}function $B(e,t){return e=Sy(e),function(r){return AEe(e,t,r)}}function CB(e,t){e=Sy(e);var n=function(i){return t.call(i)};return function(){var i=this[0];if(i)return AEe(e,n,i)}}var zs={recalculateRenderedStyle:function(t){var n=this.cy(),r=n.renderer(),i=n.styleEnabled();return r&&i&&r.recalculateRenderedStyle(this,t),this},dirtyStyleCache:function(){var t=this.cy(),n=function(s){return s._private.styleCache=null};if(t.hasCompoundNodes()){var r;r=this.spawnSelf().merge(this.descendants()).merge(this.parents()),r.merge(r.connectedEdges()),r.forEach(n)}else this.forEach(function(i){n(i),i.connectedEdges().forEach(n)});return this},updateStyle:function(t){var n=this._private.cy;if(!n.styleEnabled())return this;if(n.batching()){var r=n._private.batchStyleEles;return r.merge(this),this}var i=n.hasCompoundNodes(),s=this;t=!!(t||t===void 0),i&&(s=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var a=s;return t?a.emitAndNotify("style"):a.emit("style"),s.forEach(function(o){return o._private.styleDirty=!0}),this},cleanStyle:function(){var t=this.cy();if(!!t.styleEnabled())for(var n=0;n<this.length;n++){var r=this[n];r._private.styleDirty&&(r._private.styleDirty=!1,t.style().apply(r))}},parsedStyle:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this[0],i=r.cy();if(!!i.styleEnabled()&&r){this.cleanStyle();var s=r._private.style[t];return s!=null?s:n?i.style().getDefaultProperty(t):null}},numericStyle:function(t){var n=this[0];if(!!n.cy().styleEnabled()&&n){var r=n.pstyle(t);return r.pfValue!==void 0?r.pfValue:r.value}},numericStyleUnits:function(t){var n=this[0];if(!!n.cy().styleEnabled()&&n)return n.pstyle(t).units},renderedStyle:function(t){var n=this.cy();if(!n.styleEnabled())return this;var r=this[0];if(r)return n.style().getRenderedStyle(r,t)},style:function(t,n){var r=this.cy();if(!r.styleEnabled())return this;var i=!1,s=r.style();if(pn(t)){var a=t;s.applyBypass(this,a,i),this.emitAndNotify("style")}else if(rt(t))if(n===void 0){var o=this[0];return o?s.getStylePropertyValue(o,t):void 0}else s.applyBypass(this,t,n,i),this.emitAndNotify("style");else if(t===void 0){var l=this[0];return l?s.getRawStyle(l):void 0}return this},removeStyle:function(t){var n=this.cy();if(!n.styleEnabled())return this;var r=!1,i=n.style(),s=this;if(t===void 0)for(var a=0;a<s.length;a++){var o=s[a];i.removeAllBypasses(o,r)}else{t=t.split(/\s+/);for(var l=0;l<s.length;l++){var u=s[l];i.removeBypasses(u,t,r)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var t=this.cy();if(!t.styleEnabled())return 1;var n=t.hasCompoundNodes(),r=this[0];if(r){var i=r._private,s=r.pstyle("opacity").value;if(!n)return s;var a=i.data.parent?r.parents():null;if(a)for(var o=0;o<a.length;o++){var l=a[o],u=l.pstyle("opacity").value;s=u*s}return s}},transparent:function(){var t=this.cy();if(!t.styleEnabled())return!1;var n=this[0],r=n.cy().hasCompoundNodes();if(n)return r?n.effectiveOpacity()===0:n.pstyle("opacity").value===0},backgrounding:function(){var t=this.cy();if(!t.styleEnabled())return!1;var n=this[0];return!!n._private.backgrounding}};function ij(e,t){var n=e._private,r=n.data.parent?e.parents():null;if(r)for(var i=0;i<r.length;i++){var s=r[i];if(!t(s))return!1}return!0}function Vee(e){var t=e.ok,n=e.edgeOkViaNode||e.ok,r=e.parentOk||e.ok;return function(){var i=this.cy();if(!i.styleEnabled())return!0;var s=this[0],a=i.hasCompoundNodes();if(s){var o=s._private;if(!t(s))return!1;if(s.isNode())return!a||ij(s,r);var l=o.source,u=o.target;return n(l)&&(!a||ij(l,n))&&(l===u||n(u)&&(!a||ij(u,n)))}}}var $C=$B("eleTakesUpSpace",function(e){return e.pstyle("display").value==="element"&&e.width()!==0&&(e.isNode()?e.height()!==0:!0)});zs.takesUpSpace=CB("takesUpSpace",Vee({ok:$C}));var mot=$B("eleInteractive",function(e){return e.pstyle("events").value==="yes"&&e.pstyle("visibility").value==="visible"&&$C(e)}),vot=$B("parentInteractive",function(e){return e.pstyle("visibility").value==="visible"&&$C(e)});zs.interactive=CB("interactive",Vee({ok:mot,parentOk:vot,edgeOkViaNode:$C}));zs.noninteractive=function(){var e=this[0];if(e)return!e.interactive()};var yot=$B("eleVisible",function(e){return e.pstyle("visibility").value==="visible"&&e.pstyle("opacity").pfValue!==0&&$C(e)}),bot=$C;zs.visible=CB("visible",Vee({ok:yot,edgeOkViaNode:bot}));zs.hidden=function(){var e=this[0];if(e)return!e.visible()};zs.isBundledBezier=CB("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});zs.bypass=zs.css=zs.style;zs.renderedCss=zs.renderedStyle;zs.removeBypass=zs.removeCss=zs.removeStyle;zs.pstyle=zs.parsedStyle;var g0={};function Fpe(e){return function(){var t=arguments,n=[];if(t.length===2){var r=t[0],i=t[1];this.on(e.event,r,i)}else if(t.length===1&&zr(t[0])){var s=t[0];this.on(e.event,s)}else if(t.length===0||t.length===1&&Jn(t[0])){for(var a=t.length===1?t[0]:null,o=0;o<this.length;o++){var l=this[o],u=!e.ableField||l._private[e.ableField],c=l._private[e.field]!=e.value;if(e.overrideAble){var f=e.overrideAble(l);if(f!==void 0&&(u=f,!f))return this}u&&(l._private[e.field]=e.value,c&&n.push(l))}var h=this.spawn(n);h.updateStyle(),h.emit(e.event),a&&h.emit(a)}return this}}function CC(e){g0[e.field]=function(){var t=this[0];if(t){if(e.overrideField){var n=e.overrideField(t);if(n!==void 0)return n}return t._private[e.field]}},g0[e.on]=Fpe({event:e.on,field:e.field,ableField:e.ableField,overrideAble:e.overrideAble,value:!0}),g0[e.off]=Fpe({event:e.off,field:e.field,ableField:e.ableField,overrideAble:e.overrideAble,value:!1})}CC({field:"locked",overrideField:function(t){return t.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});CC({field:"grabbable",overrideField:function(t){return t.cy().autoungrabify()||t.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});CC({field:"selected",ableField:"selectable",overrideAble:function(t){return t.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});CC({field:"selectable",overrideField:function(t){return t.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});g0.deselect=g0.unselect;g0.grabbed=function(){var e=this[0];if(e)return e._private.grabbed};CC({field:"active",on:"activate",off:"unactivate"});CC({field:"pannable",on:"panify",off:"unpanify"});g0.inactive=function(){var e=this[0];if(e)return!e._private.active};var Na={},Ope=function(t){return function(r){for(var i=this,s=[],a=0;a<i.length;a++){var o=i[a];if(!!o.isNode()){for(var l=!1,u=o.connectedEdges(),c=0;c<u.length;c++){var f=u[c],h=f.source(),d=f.target();if(t.noIncomingEdges&&d===o&&h!==o||t.noOutgoingEdges&&h===o&&d!==o){l=!0;break}}l||s.push(o)}}return this.spawn(s,!0).filter(r)}},Rpe=function(t){return function(n){for(var r=this,i=[],s=0;s<r.length;s++){var a=r[s];if(!!a.isNode())for(var o=a.connectedEdges(),l=0;l<o.length;l++){var u=o[l],c=u.source(),f=u.target();t.outgoing&&c===a?(i.push(u),i.push(f)):t.incoming&&f===a&&(i.push(u),i.push(c))}}return this.spawn(i,!0).filter(n)}},Ppe=function(t){return function(n){for(var r=this,i=[],s={};;){var a=t.outgoing?r.outgoers():r.incomers();if(a.length===0)break;for(var o=!1,l=0;l<a.length;l++){var u=a[l],c=u.id();s[c]||(s[c]=!0,i.push(u),o=!0)}if(!o)break;r=a}return this.spawn(i,!0).filter(n)}};Na.clearTraversalCache=function(){for(var e=0;e<this.length;e++)this[e]._private.traversalCache=null};gt(Na,{roots:Ope({noIncomingEdges:!0}),leaves:Ope({noOutgoingEdges:!0}),outgoers:hu(Rpe({outgoing:!0}),"outgoers"),successors:Ppe({outgoing:!0}),incomers:hu(Rpe({incoming:!0}),"incomers"),predecessors:Ppe({incoming:!0})});gt(Na,{neighborhood:hu(function(e){for(var t=[],n=this.nodes(),r=0;r<n.length;r++)for(var i=n[r],s=i.connectedEdges(),a=0;a<s.length;a++){var o=s[a],l=o.source(),u=o.target(),c=i===l?u:l;c.length>0&&t.push(c[0]),t.push(o[0])}return this.spawn(t,!0).filter(e)},"neighborhood"),closedNeighborhood:function(t){return this.neighborhood().add(this).filter(t)},openNeighborhood:function(t){return this.neighborhood(t)}});Na.neighbourhood=Na.neighborhood;Na.closedNeighbourhood=Na.closedNeighborhood;Na.openNeighbourhood=Na.openNeighborhood;gt(Na,{source:hu(function(t){var n=this[0],r;return n&&(r=n._private.source||n.cy().collection()),r&&t?r.filter(t):r},"source"),target:hu(function(t){var n=this[0],r;return n&&(r=n._private.target||n.cy().collection()),r&&t?r.filter(t):r},"target"),sources:Lpe({attr:"source"}),targets:Lpe({attr:"target"})});function Lpe(e){return function(n){for(var r=[],i=0;i<this.length;i++){var s=this[i],a=s._private[e.attr];a&&r.push(a)}return this.spawn(r,!0).filter(n)}}gt(Na,{edgesWith:hu(Bpe(),"edgesWith"),edgesTo:hu(Bpe({thisIsSrc:!0}),"edgesTo")});function Bpe(e){return function(n){var r=[],i=this._private.cy,s=e||{};rt(n)&&(n=i.$(n));for(var a=0;a<n.length;a++)for(var o=n[a]._private.edges,l=0;l<o.length;l++){var u=o[l],c=u._private.data,f=this.hasElementWithId(c.source)&&n.hasElementWithId(c.target),h=n.hasElementWithId(c.source)&&this.hasElementWithId(c.target),d=f||h;!d||(s.thisIsSrc||s.thisIsTgt)&&(s.thisIsSrc&&!f||s.thisIsTgt&&!h)||r.push(u)}return this.spawn(r,!0)}}gt(Na,{connectedEdges:hu(function(e){for(var t=[],n=this,r=0;r<n.length;r++){var i=n[r];if(!!i.isNode())for(var s=i._private.edges,a=0;a<s.length;a++){var o=s[a];t.push(o)}}return this.spawn(t,!0).filter(e)},"connectedEdges"),connectedNodes:hu(function(e){for(var t=[],n=this,r=0;r<n.length;r++){var i=n[r];!i.isEdge()||(t.push(i.source()[0]),t.push(i.target()[0]))}return this.spawn(t,!0).filter(e)},"connectedNodes"),parallelEdges:hu(zpe(),"parallelEdges"),codirectedEdges:hu(zpe({codirected:!0}),"codirectedEdges")});function zpe(e){var t={codirected:!1};return e=gt({},t,e),function(r){for(var i=[],s=this.edges(),a=e,o=0;o<s.length;o++)for(var l=s[o],u=l._private,c=u.source,f=c._private.data.id,h=u.data.target,d=c._private.edges,p=0;p<d.length;p++){var g=d[p],m=g._private.data,v=m.target,y=m.source,b=v===h&&y===f,x=f===v&&h===y;(a.codirected&&b||!a.codirected&&(b||x))&&i.push(g)}return this.spawn(i,!0).filter(r)}}gt(Na,{components:function(t){var n=this,r=n.cy(),i=r.collection(),s=t==null?n.nodes():t.nodes(),a=[];t!=null&&s.empty()&&(s=t.sources());var o=function(c,f){i.merge(c),s.unmerge(c),f.merge(c)};if(s.empty())return n.spawn();var l=function(){var c=r.collection();a.push(c);var f=s[0];o(f,c),n.bfs({directed:!1,roots:f,visit:function(d){return o(d,c)}}),c.forEach(function(h){h.connectedEdges().forEach(function(d){n.has(d)&&c.has(d.source())&&c.has(d.target())&&c.merge(d)})})};do l();while(s.length>0);return a},component:function(){var t=this[0];return t.cy().mutableElements().components(t)[0]}});Na.componentsOf=Na.components;var Us=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(t===void 0){Xr("A collection must have a reference to the core");return}var s=new Zf,a=!1;if(!n)n=[];else if(n.length>0&&pn(n[0])&&!fN(n[0])){a=!0;for(var o=[],l=new xC,u=0,c=n.length;u<c;u++){var f=n[u];f.data==null&&(f.data={});var h=f.data;if(h.id==null)h.id=Gke();else if(t.hasElementWithId(h.id)||l.has(h.id))continue;var d=new vB(t,f,!1);o.push(d),l.add(h.id)}n=o}this.length=0;for(var p=0,g=n.length;p<g;p++){var m=n[p][0];if(m!=null){var v=m._private.data.id;(!r||!s.has(v))&&(r&&s.set(v,{index:this.length,ele:m}),this[this.length]=m,this.length++)}}this._private={eles:this,cy:t,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(y){this.lazyMap=y},rebuildMap:function(){for(var b=this.lazyMap=new Zf,x=this.eles,w=0;w<x.length;w++){var C=x[w];b.set(C.id(),{index:w,ele:C})}}},r&&(this._private.map=s),a&&!i&&this.restore()},fr=vB.prototype=Us.prototype=Object.create(Array.prototype);fr.instanceString=function(){return"collection"};fr.spawn=function(e,t){return new Us(this.cy(),e,t)};fr.spawnSelf=function(){return this.spawn(this)};fr.cy=function(){return this._private.cy};fr.renderer=function(){return this._private.cy.renderer()};fr.element=function(){return this[0]};fr.collection=function(){return Oke(this)?this:new Us(this._private.cy,[this])};fr.unique=function(){return new Us(this._private.cy,this,!0)};fr.hasElementWithId=function(e){return e=""+e,this._private.map.has(e)};fr.getElementById=function(e){e=""+e;var t=this._private.cy,n=this._private.map.get(e);return n?n.ele:new Us(t)};fr.$id=fr.getElementById;fr.poolIndex=function(){var e=this._private.cy,t=e._private.elements,n=this[0]._private.data.id;return t._private.map.get(n).index};fr.indexOf=function(e){var t=e[0]._private.data.id;return this._private.map.get(t).index};fr.indexOfId=function(e){return e=""+e,this._private.map.get(e).index};fr.json=function(e){var t=this.element(),n=this.cy();if(t==null&&e)return this;if(t!=null){var r=t._private;if(pn(e)){if(n.startBatch(),e.data){t.data(e.data);var i=r.data;if(t.isEdge()){var s=!1,a={},o=e.data.source,l=e.data.target;o!=null&&o!=i.source&&(a.source=""+o,s=!0),l!=null&&l!=i.target&&(a.target=""+l,s=!0),s&&(t=t.move(a))}else{var u="parent"in e.data,c=e.data.parent;u&&(c!=null||i.parent!=null)&&c!=i.parent&&(c===void 0&&(c=null),c!=null&&(c=""+c),t=t.move({parent:c}))}}e.position&&t.position(e.position);var f=function(g,m,v){var y=e[g];y!=null&&y!==r[g]&&(y?t[m]():t[v]())};return f("removed","remove","restore"),f("selected","select","unselect"),f("selectable","selectify","unselectify"),f("locked","lock","unlock"),f("grabbable","grabify","ungrabify"),f("pannable","panify","unpanify"),e.classes!=null&&t.classes(e.classes),n.endBatch(),this}else if(e===void 0){var h={data:Kf(r.data),position:Kf(r.position),group:r.group,removed:r.removed,selected:r.selected,selectable:r.selectable,locked:r.locked,grabbable:r.grabbable,pannable:r.pannable,classes:null};h.classes="";var d=0;return r.classes.forEach(function(p){return h.classes+=d++===0?p:" "+p}),h}}};fr.jsons=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t],r=n.json();e.push(r)}return e};fr.clone=function(){for(var e=this.cy(),t=[],n=0;n<this.length;n++){var r=this[n],i=r.json(),s=new vB(e,i,!1);t.push(s)}return new Us(e,t)};fr.copy=fr.clone;fr.restore=function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this,r=n.cy(),i=r._private,s=[],a=[],o,l=0,u=n.length;l<u;l++){var c=n[l];t&&!c.removed()||(c.isNode()?s.push(c):a.push(c))}o=s.concat(a);var f,h=function(){o.splice(f,1),f--};for(f=0;f<o.length;f++){var d=o[f],p=d._private,g=p.data;if(d.clearTraversalCache(),!(!t&&!p.removed)){if(g.id===void 0)g.id=Gke();else if(Pe(g.id))g.id=""+g.id;else if(O0(g.id)||!rt(g.id)){Xr("Can not create element with invalid string ID `"+g.id+"`"),h();continue}else if(r.hasElementWithId(g.id)){Xr("Can not create second element with ID `"+g.id+"`"),h();continue}}var m=g.id;if(d.isNode()){var v=p.position;v.x==null&&(v.x=0),v.y==null&&(v.y=0)}if(d.isEdge()){for(var y=d,b=["source","target"],x=b.length,w=!1,C=0;C<x;C++){var $=b[C],_=g[$];Pe(_)&&(_=g[$]=""+g[$]),_==null||_===""?(Xr("Can not create edge `"+m+"` with unspecified "+$),w=!0):r.hasElementWithId(_)||(Xr("Can not create edge `"+m+"` with nonexistant "+$+" `"+_+"`"),w=!0)}if(w){h();continue}var k=r.getElementById(g.source),E=r.getElementById(g.target);k.same(E)?k._private.edges.push(y):(k._private.edges.push(y),E._private.edges.push(y)),y._private.source=k,y._private.target=E}p.map=new Zf,p.map.set(m,{ele:d,index:0}),p.removed=!1,t&&r.addToPool(d)}for(var S=0;S<s.length;S++){var N=s[S],A=N._private.data;Pe(A.parent)&&(A.parent=""+A.parent);var D=A.parent,T=D!=null;if(T||N._private.parent){var I=N._private.parent?r.collection().merge(N._private.parent):r.getElementById(D);if(I.empty())A.parent=void 0;else if(I[0].removed())Rn("Node added with missing parent, reference to parent removed"),A.parent=void 0,N._private.parent=null;else{for(var F=!1,R=I;!R.empty();){if(N.same(R)){F=!0,A.parent=void 0;break}R=R.parent()}F||(I[0]._private.children.push(N),N._private.parent=I[0],i.hasCompoundNodes=!0)}}}if(o.length>0){for(var P=o.length===n.length?n:new Us(r,o),V=0;V<P.length;V++){var z=P[V];z.isNode()||(z.parallelEdges().clearTraversalCache(),z.source().clearTraversalCache(),z.target().clearTraversalCache())}var q;i.hasCompoundNodes?q=r.collection().merge(P).merge(P.connectedNodes()).merge(P.parent()):q=P,q.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(e),e?P.emitAndNotify("add"):t&&P.emit("add")}return n};fr.removed=function(){var e=this[0];return e&&e._private.removed};fr.inside=function(){var e=this[0];return e&&!e._private.removed};fr.remove=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this,r=[],i={},s=n._private.cy;function a(D){for(var T=D._private.edges,I=0;I<T.length;I++)l(T[I])}function o(D){for(var T=D._private.children,I=0;I<T.length;I++)l(T[I])}function l(D){var T=i[D.id()];t&&D.removed()||T||(i[D.id()]=!0,D.isNode()?(r.push(D),a(D),o(D)):r.unshift(D))}for(var u=0,c=n.length;u<c;u++){var f=n[u];l(f)}function h(D,T){var I=D._private.edges;R0(I,T),D.clearTraversalCache()}function d(D){D.clearTraversalCache()}var p=[];p.ids={};function g(D,T){T=T[0],D=D[0];var I=D._private.children,F=D.id();R0(I,T),T._private.parent=null,p.ids[F]||(p.ids[F]=!0,p.push(D))}n.dirtyCompoundBoundsCache(),t&&s.removeFromPool(r);for(var m=0;m<r.length;m++){var v=r[m];if(v.isEdge()){var y=v.source()[0],b=v.target()[0];h(y,v),h(b,v);for(var x=v.parallelEdges(),w=0;w<x.length;w++){var C=x[w];d(C),C.isBundledBezier()&&C.dirtyBoundingBoxCache()}}else{var $=v.parent();$.length!==0&&g($,v)}t&&(v._private.removed=!0)}var _=s._private.elements;s._private.hasCompoundNodes=!1;for(var k=0;k<_.length;k++){var E=_[k];if(E.isParent()){s._private.hasCompoundNodes=!0;break}}var S=new Us(this.cy(),r);S.size()>0&&(e?S.emitAndNotify("remove"):t&&S.emit("remove"));for(var N=0;N<p.length;N++){var A=p[N];(!t||!A.removed())&&A.updateStyle()}return S};fr.move=function(e){var t=this._private.cy,n=this,r=!1,i=!1,s=function(p){return p==null?p:""+p};if(e.source!==void 0||e.target!==void 0){var a=s(e.source),o=s(e.target),l=a!=null&&t.hasElementWithId(a),u=o!=null&&t.hasElementWithId(o);(l||u)&&(t.batch(function(){n.remove(r,i),n.emitAndNotify("moveout");for(var d=0;d<n.length;d++){var p=n[d],g=p._private.data;p.isEdge()&&(l&&(g.source=a),u&&(g.target=o))}n.restore(r,i)}),n.emitAndNotify("move"))}else if(e.parent!==void 0){var c=s(e.parent),f=c===null||t.hasElementWithId(c);if(f){var h=c===null?void 0:c;t.batch(function(){var d=n.remove(r,i);d.emitAndNotify("moveout");for(var p=0;p<n.length;p++){var g=n[p],m=g._private.data;g.isNode()&&(m.parent=h)}d.restore(r,i)}),n.emitAndNotify("move")}}return this};[oEe,Nat,QR,p0,Tw,Gat,xB,lot,SEe,kEe,dot,g5,JR,zs,g0,Na].forEach(function(e){gt(fr,e)});var xot={add:function(t){var n,r=this;if(Rl(t)){var i=t;if(i._private.cy===r)n=i.restore();else{for(var s=[],a=0;a<i.length;a++){var o=i[a];s.push(o.json())}n=new Us(r,s)}}else if(Jn(t)){var l=t;n=new Us(r,l)}else if(pn(t)&&(Jn(t.nodes)||Jn(t.edges))){for(var u=t,c=[],f=["nodes","edges"],h=0,d=f.length;h<d;h++){var p=f[h],g=u[p];if(Jn(g))for(var m=0,v=g.length;m<v;m++){var y=gt({group:p},g[m]);c.push(y)}}n=new Us(r,c)}else{var b=t;n=new vB(r,b).collection()}return n},remove:function(t){if(!Rl(t)){if(rt(t)){var n=t;t=this.$(n)}}return t.remove()}};/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */function wot(e,t,n,r){var i=4,s=.001,a=1e-7,o=10,l=11,u=1/(l-1),c=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var f=0;f<4;++f)if(typeof arguments[f]!="number"||isNaN(arguments[f])||!isFinite(arguments[f]))return!1;e=Math.min(e,1),n=Math.min(n,1),e=Math.max(e,0),n=Math.max(n,0);var h=c?new Float32Array(l):new Array(l);function d(E,S){return 1-3*S+3*E}function p(E,S){return 3*S-6*E}function g(E){return 3*E}function m(E,S,N){return((d(S,N)*E+p(S,N))*E+g(S))*E}function v(E,S,N){return 3*d(S,N)*E*E+2*p(S,N)*E+g(S)}function y(E,S){for(var N=0;N<i;++N){var A=v(S,e,n);if(A===0)return S;var D=m(S,e,n)-E;S-=D/A}return S}function b(){for(var E=0;E<l;++E)h[E]=m(E*u,e,n)}function x(E,S,N){var A,D,T=0;do D=S+(N-S)/2,A=m(D,e,n)-E,A>0?N=D:S=D;while(Math.abs(A)>a&&++T<o);return D}function w(E){for(var S=0,N=1,A=l-1;N!==A&&h[N]<=E;++N)S+=u;--N;var D=(E-h[N])/(h[N+1]-h[N]),T=S+D*u,I=v(T,e,n);return I>=s?y(E,T):I===0?T:x(E,S,S+u)}var C=!1;function $(){C=!0,(e!==t||n!==r)&&b()}var _=function(S){return C||$(),e===t&&n===r?S:S===0?0:S===1?1:m(w(S),t,r)};_.getControlPoints=function(){return[{x:e,y:t},{x:n,y:r}]};var k="generateBezier("+[e,t,n,r]+")";return _.toString=function(){return k},_}/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */var $ot=function(){function e(r){return-r.tension*r.x-r.friction*r.v}function t(r,i,s){var a={x:r.x+s.dx*i,v:r.v+s.dv*i,tension:r.tension,friction:r.friction};return{dx:a.v,dv:e(a)}}function n(r,i){var s={dx:r.v,dv:e(r)},a=t(r,i*.5,s),o=t(r,i*.5,a),l=t(r,i,o),u=1/6*(s.dx+2*(a.dx+o.dx)+l.dx),c=1/6*(s.dv+2*(a.dv+o.dv)+l.dv);return r.x=r.x+u*i,r.v=r.v+c*i,r}return function r(i,s,a){var o={x:-1,v:0,tension:null,friction:null},l=[0],u=0,c=1/1e4,f=16/1e3,h,d,p;for(i=parseFloat(i)||500,s=parseFloat(s)||20,a=a||null,o.tension=i,o.friction=s,h=a!==null,h?(u=r(i,s),d=u/a*f):d=f;p=n(p||o,d),l.push(1+p.x),u+=16,Math.abs(p.x)>c&&Math.abs(p.v)>c;);return h?function(g){return l[g*(l.length-1)|0]}:u}}(),ir=function(t,n,r,i){var s=wot(t,n,r,i);return function(a,o,l){return a+(o-a)*s(l)}},e4={linear:function(t,n,r){return t+(n-t)*r},ease:ir(.25,.1,.25,1),"ease-in":ir(.42,0,1,1),"ease-out":ir(0,0,.58,1),"ease-in-out":ir(.42,0,.58,1),"ease-in-sine":ir(.47,0,.745,.715),"ease-out-sine":ir(.39,.575,.565,1),"ease-in-out-sine":ir(.445,.05,.55,.95),"ease-in-quad":ir(.55,.085,.68,.53),"ease-out-quad":ir(.25,.46,.45,.94),"ease-in-out-quad":ir(.455,.03,.515,.955),"ease-in-cubic":ir(.55,.055,.675,.19),"ease-out-cubic":ir(.215,.61,.355,1),"ease-in-out-cubic":ir(.645,.045,.355,1),"ease-in-quart":ir(.895,.03,.685,.22),"ease-out-quart":ir(.165,.84,.44,1),"ease-in-out-quart":ir(.77,0,.175,1),"ease-in-quint":ir(.755,.05,.855,.06),"ease-out-quint":ir(.23,1,.32,1),"ease-in-out-quint":ir(.86,0,.07,1),"ease-in-expo":ir(.95,.05,.795,.035),"ease-out-expo":ir(.19,1,.22,1),"ease-in-out-expo":ir(1,0,0,1),"ease-in-circ":ir(.6,.04,.98,.335),"ease-out-circ":ir(.075,.82,.165,1),"ease-in-out-circ":ir(.785,.135,.15,.86),spring:function(t,n,r){if(r===0)return e4.linear;var i=$ot(t,n,r);return function(s,a,o){return s+(a-s)*i(o)}},"cubic-bezier":ir};function Upe(e,t,n,r,i){if(r===1||t===n)return n;var s=i(t,n,r);return e==null||((e.roundValue||e.color)&&(s=Math.round(s)),e.min!==void 0&&(s=Math.max(s,e.min)),e.max!==void 0&&(s=Math.min(s,e.max))),s}function Wpe(e,t){return e.pfValue!=null||e.value!=null?e.pfValue!=null&&(t==null||t.type.units!=="%")?e.pfValue:e.value:e}function Zx(e,t,n,r,i){var s=i!=null?i.type:null;n<0?n=0:n>1&&(n=1);var a=Wpe(e,i),o=Wpe(t,i);if(Pe(a)&&Pe(o))return Upe(s,a,o,n,r);if(Jn(a)&&Jn(o)){for(var l=[],u=0;u<o.length;u++){var c=a[u],f=o[u];if(c!=null&&f!=null){var h=Upe(s,c,f,n,r);l.push(h)}else l.push(f)}return l}}function Cot(e,t,n,r){var i=!r,s=e._private,a=t._private,o=a.easing,l=a.startTime,u=r?e:e.cy(),c=u.style();if(!a.easingImpl)if(o==null)a.easingImpl=e4.linear;else{var f;if(rt(o)){var h=c.parse("transition-timing-function",o);f=h.value}else f=o;var d,p;rt(f)?(d=f,p=[]):(d=f[1],p=f.slice(2).map(function(P){return+P})),p.length>0?(d==="spring"&&p.push(a.duration),a.easingImpl=e4[d].apply(null,p)):a.easingImpl=e4[d]}var g=a.easingImpl,m;if(a.duration===0?m=1:m=(n-l)/a.duration,a.applying&&(m=a.progress),m<0?m=0:m>1&&(m=1),a.delay==null){var v=a.startPosition,y=a.position;if(y&&i&&!e.locked()){var b={};KS(v.x,y.x)&&(b.x=Zx(v.x,y.x,m,g)),KS(v.y,y.y)&&(b.y=Zx(v.y,y.y,m,g)),e.position(b)}var x=a.startPan,w=a.pan,C=s.pan,$=w!=null&&r;$&&(KS(x.x,w.x)&&(C.x=Zx(x.x,w.x,m,g)),KS(x.y,w.y)&&(C.y=Zx(x.y,w.y,m,g)),e.emit("pan"));var _=a.startZoom,k=a.zoom,E=k!=null&&r;E&&(KS(_,k)&&(s.zoom=iT(s.minZoom,Zx(_,k,m,g),s.maxZoom)),e.emit("zoom")),($||E)&&e.emit("viewport");var S=a.style;if(S&&S.length>0&&i){for(var N=0;N<S.length;N++){var A=S[N],D=A.name,T=A,I=a.startStyle[D],F=c.properties[I.name],R=Zx(I,T,m,g,F);c.overrideBypass(e,D,R)}e.emit("style")}}return a.progress=m,m}function KS(e,t){return e==null||t==null?!1:Pe(e)&&Pe(t)?!0:!!(e&&t)}function _ot(e,t,n,r){var i=t._private;i.started=!0,i.startTime=n-i.progress*i.duration}function Vpe(e,t){var n=t._private.aniEles,r=[];function i(c,f){var h=c._private,d=h.animation.current,p=h.animation.queue,g=!1;if(d.length===0){var m=p.shift();m&&d.push(m)}for(var v=function(C){for(var $=C.length-1;$>=0;$--){var _=C[$];_()}C.splice(0,C.length)},y=d.length-1;y>=0;y--){var b=d[y],x=b._private;if(x.stopped){d.splice(y,1),x.hooked=!1,x.playing=!1,x.started=!1,v(x.frames);continue}!x.playing&&!x.applying||(x.playing&&x.applying&&(x.applying=!1),x.started||_ot(c,b,e),Cot(c,b,e,f),x.applying&&(x.applying=!1),v(x.frames),x.step!=null&&x.step(e),b.completed()&&(d.splice(y,1),x.hooked=!1,x.playing=!1,x.started=!1,v(x.completes)),g=!0)}return!f&&d.length===0&&p.length===0&&r.push(c),g}for(var s=!1,a=0;a<n.length;a++){var o=n[a],l=i(o);s=s||l}var u=i(t,!0);(s||u)&&(n.length>0?t.notify("draw",n):t.notify("draw")),n.unmerge(r),t.emit("step")}var Sot={animate:Fn.animate(),animation:Fn.animation(),animated:Fn.animated(),clearQueue:Fn.clearQueue(),delay:Fn.delay(),delayAnimation:Fn.delayAnimation(),stop:Fn.stop(),addToAnimationPool:function(t){var n=this;!n.styleEnabled()||n._private.aniEles.merge(t)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var t=this;if(t._private.animationsRunning=!0,!t.styleEnabled())return;function n(){!t._private.animationsRunning||h5(function(s){Vpe(s,t),n()})}var r=t.renderer();r&&r.beforeRender?r.beforeRender(function(s,a){Vpe(a,t)},r.beforeRenderPriorities.animations):n()}},kot={qualifierCompare:function(t,n){return t==null||n==null?t==null&&n==null:t.sameText(n)},eventMatches:function(t,n,r){var i=n.qualifier;return i!=null?t!==r.target&&fN(r.target)&&i.matches(r.target):!0},addEventFields:function(t,n){n.cy=t,n.target=t},callbackContext:function(t,n,r){return n.qualifier!=null?r.target:t}},tO=function(t){return rt(t)?new P0(t):t},TEe={createEmitter:function(){var t=this._private;return t.emitter||(t.emitter=new wB(kot,this)),this},emitter:function(){return this._private.emitter},on:function(t,n,r){return this.emitter().on(t,tO(n),r),this},removeListener:function(t,n,r){return this.emitter().removeListener(t,tO(n),r),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(t,n,r){return this.emitter().one(t,tO(n),r),this},once:function(t,n,r){return this.emitter().one(t,tO(n),r),this},emit:function(t,n){return this.emitter().emit(t,n),this},emitAndNotify:function(t,n){return this.emit(t),this.notify(t,n),this}};Fn.eventAliasesOn(TEe);var vY={png:function(t){var n=this._private.renderer;return t=t||{},n.png(t)},jpg:function(t){var n=this._private.renderer;return t=t||{},t.bg=t.bg||"#fff",n.jpg(t)}};vY.jpeg=vY.jpg;var t4={layout:function(t){var n=this;if(t==null){Xr("Layout options must be specified to make a layout");return}if(t.name==null){Xr("A `name` must be specified to make a layout");return}var r=t.name,i=n.extension("layout",r);if(i==null){Xr("No such layout `"+r+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var s;rt(t.eles)?s=n.$(t.eles):s=t.eles!=null?t.eles:n.$();var a=new i(gt({},t,{cy:n,eles:s}));return a}};t4.createLayout=t4.makeLayout=t4.layout;var Eot={notify:function(t,n){var r=this._private;if(this.batching()){r.batchNotifications=r.batchNotifications||{};var i=r.batchNotifications[t]=r.batchNotifications[t]||this.collection();n!=null&&i.merge(n);return}if(!!r.notificationsEnabled){var s=this.renderer();this.destroyed()||!s||s.notify(t,n)}},notifications:function(t){var n=this._private;return t===void 0?n.notificationsEnabled:(n.notificationsEnabled=!!t,this)},noNotifications:function(t){this.notifications(!1),t(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var t=this._private;return t.batchCount==null&&(t.batchCount=0),t.batchCount===0&&(t.batchStyleEles=this.collection(),t.batchNotifications={}),t.batchCount++,this},endBatch:function(){var t=this._private;if(t.batchCount===0)return this;if(t.batchCount--,t.batchCount===0){t.batchStyleEles.updateStyle();var n=this.renderer();Object.keys(t.batchNotifications).forEach(function(r){var i=t.batchNotifications[r];i.empty()?n.notify(r):n.notify(r,i)})}return this},batch:function(t){return this.startBatch(),t(),this.endBatch(),this},batchData:function(t){var n=this;return this.batch(function(){for(var r=Object.keys(t),i=0;i<r.length;i++){var s=r[i],a=t[s],o=n.getElementById(s);o.data(a)}})}},Aot=Ys({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1}),yY={renderTo:function(t,n,r,i){var s=this._private.renderer;return s.renderTo(t,n,r,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(t){var n=this,r=n.extension("renderer",t.name);if(r==null){Xr("Can not initialise: No such renderer `".concat(t.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}t.wheelSensitivity!==void 0&&Rn("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=Aot(t);i.cy=n,n._private.renderer=new r(i),this.notify("init")},destroyRenderer:function(){var t=this;t.notify("destroy");var n=t.container();if(n)for(n._cyreg=null;n.childNodes.length>0;)n.removeChild(n.childNodes[0]);t._private.renderer=null,t.mutableElements().forEach(function(r){var i=r._private;i.rscratch={},i.rstyle={},i.animation.current=[],i.animation.queue=[]})},onRender:function(t){return this.on("render",t)},offRender:function(t){return this.off("render",t)}};yY.invalidateDimensions=yY.resize;var n4={collection:function(t,n){return rt(t)?this.$(t):Rl(t)?t.collection():Jn(t)?(n||(n={}),new Us(this,t,n.unique,n.removed)):new Us(this)},nodes:function(t){var n=this.$(function(r){return r.isNode()});return t?n.filter(t):n},edges:function(t){var n=this.$(function(r){return r.isEdge()});return t?n.filter(t):n},$:function(t){var n=this._private.elements;return t?n.filter(t):n.spawnSelf()},mutableElements:function(){return this._private.elements}};n4.elements=n4.filter=n4.$;var Pa={},sA="t",Tot="f";Pa.apply=function(e){for(var t=this,n=t._private,r=n.cy,i=r.collection(),s=0;s<e.length;s++){var a=e[s],o=t.getContextMeta(a);if(!o.empty){var l=t.getContextStyle(o),u=t.applyContextStyle(o,l,a);a._private.appliedInitStyle?t.updateTransitions(a,u.diffProps):a._private.appliedInitStyle=!0;var c=t.updateStyleHints(a);c&&i.push(a)}}return i};Pa.getPropertiesDiff=function(e,t){var n=this,r=n._private.propDiffs=n._private.propDiffs||{},i=e+"-"+t,s=r[i];if(s)return s;for(var a=[],o={},l=0;l<n.length;l++){var u=n[l],c=e[l]===sA,f=t[l]===sA,h=c!==f,d=u.mappedProperties.length>0;if(h||f&&d){var p=void 0;h&&d||h?p=u.properties:d&&(p=u.mappedProperties);for(var g=0;g<p.length;g++){for(var m=p[g],v=m.name,y=!1,b=l+1;b<n.length;b++){var x=n[b],w=t[b]===sA;if(!!w&&(y=x.properties[m.name]!=null,y))break}!o[v]&&!y&&(o[v]=!0,a.push(v))}}}return r[i]=a,a};Pa.getContextMeta=function(e){for(var t=this,n="",r,i=e._private.styleCxtKey||"",s=0;s<t.length;s++){var a=t[s],o=a.selector&&a.selector.matches(e);o?n+=sA:n+=Tot}return r=t.getPropertiesDiff(i,n),e._private.styleCxtKey=n,{key:n,diffPropNames:r,empty:r.length===0}};Pa.getContextStyle=function(e){var t=e.key,n=this,r=this._private.contextStyles=this._private.contextStyles||{};if(r[t])return r[t];for(var i={_private:{key:t}},s=0;s<n.length;s++){var a=n[s],o=t[s]===sA;if(!!o)for(var l=0;l<a.properties.length;l++){var u=a.properties[l];i[u.name]=u}}return r[t]=i,i};Pa.applyContextStyle=function(e,t,n){for(var r=this,i=e.diffPropNames,s={},a=r.types,o=0;o<i.length;o++){var l=i[o],u=t[l],c=n.pstyle(l);if(!u)if(c)c.bypass?u={name:l,deleteBypassed:!0}:u={name:l,delete:!0};else continue;if(c!==u){if(u.mapped===a.fn&&c!=null&&c.mapping!=null&&c.mapping.value===u.value){var f=c.mapping,h=f.fnValue=u.value(n);if(h===f.prevFnValue)continue}var d=s[l]={prev:c};r.applyParsedProperty(n,u),d.next=n.pstyle(l),d.next&&d.next.bypass&&(d.next=d.next.bypassed)}}return{diffProps:s}};Pa.updateStyleHints=function(e){var t=e._private,n=this,r=n.propertyGroupNames,i=n.propertyGroupKeys,s=function(L,W,M){return n.getPropertiesHash(L,W,M)},a=t.styleKey;if(e.removed())return!1;var o=t.group==="nodes",l=e._private.style;r=Object.keys(l);for(var u=0;u<i.length;u++){var c=i[u];t.styleKeys[c]=[A2,eE]}for(var f=function(L,W){return t.styleKeys[W][0]=tT(L,t.styleKeys[W][0])},h=function(L,W){return t.styleKeys[W][1]=nT(L,t.styleKeys[W][1])},d=function(L,W){f(L,W),h(L,W)},p=function(L,W){for(var M=0;M<L.length;M++){var ue=L.charCodeAt(M);f(ue,W),h(ue,W)}},g=2e9,m=function(L){return-128<L&&L<128&&Math.floor(L)!==L?g-(L*1024|0):L},v=0;v<r.length;v++){var y=r[v],b=l[y];if(b!=null){var x=this.properties[y],w=x.type,C=x.groupKey,$=void 0;x.hashOverride!=null?$=x.hashOverride(e,b):b.pfValue!=null&&($=b.pfValue);var _=x.enums==null?b.value:null,k=$!=null,E=_!=null,S=k||E,N=b.units;if(w.number&&S&&!w.multiple){var A=k?$:_;d(m(A),C),!k&&N!=null&&p(N,C)}else p(b.strValue,C)}}for(var D=[A2,eE],T=0;T<i.length;T++){var I=i[T],F=t.styleKeys[I];D[0]=tT(F[0],D[0]),D[1]=nT(F[1],D[1])}t.styleKey=Vit(D[0],D[1]);var R=t.styleKeys;t.labelDimsKey=Eg(R.labelDimensions);var P=s(e,["label"],R.labelDimensions);if(t.labelKey=Eg(P),t.labelStyleKey=Eg(qF(R.commonLabel,P)),!o){var V=s(e,["source-label"],R.labelDimensions);t.sourceLabelKey=Eg(V),t.sourceLabelStyleKey=Eg(qF(R.commonLabel,V));var z=s(e,["target-label"],R.labelDimensions);t.targetLabelKey=Eg(z),t.targetLabelStyleKey=Eg(qF(R.commonLabel,z))}if(o){var q=t.styleKeys,G=q.nodeBody,K=q.nodeBorder,Y=q.backgroundImage,te=q.compound,Z=q.pie,ae=[G,K,Y,te,Z].filter(function(O){return O!=null}).reduce(qF,[A2,eE]);t.nodeKey=Eg(ae),t.hasPie=Z!=null&&Z[0]!==A2&&Z[1]!==eE}return a!==t.styleKey};Pa.clearStyleHints=function(e){var t=e._private;t.styleCxtKey="",t.styleKeys={},t.styleKey=null,t.labelKey=null,t.labelStyleKey=null,t.sourceLabelKey=null,t.sourceLabelStyleKey=null,t.targetLabelKey=null,t.targetLabelStyleKey=null,t.nodeKey=null,t.hasPie=null};Pa.applyParsedProperty=function(e,t){var n=this,r=t,i=e._private.style,s,a=n.types,o=n.properties[r.name].type,l=r.bypass,u=i[r.name],c=u&&u.bypass,f=e._private,h="mapping",d=function(G){return G==null?null:G.pfValue!=null?G.pfValue:G.value},p=function(){var G=d(u),K=d(r);n.checkTriggers(e,r.name,G,K)};if(r&&r.name.substr(0,3)==="pie"&&Rn("The pie style properties are deprecated.  Create charts using background images instead."),t.name==="curve-style"&&e.isEdge()&&(t.value!=="bezier"&&e.isLoop()||t.value==="haystack"&&(e.source().isParent()||e.target().isParent()))&&(r=t=this.parse(t.name,"bezier",l)),r.delete)return i[r.name]=void 0,p(),!0;if(r.deleteBypassed)return u?u.bypass?(u.bypassed=void 0,p(),!0):!1:(p(),!0);if(r.deleteBypass)return u?u.bypass?(i[r.name]=u.bypassed,p(),!0):!1:(p(),!0);var g=function(){Rn("Do not assign mappings to elements without corresponding data (i.e. ele `"+e.id()+"` has no mapping for property `"+r.name+"` with data field `"+r.field+"`); try a `["+r.field+"]` selector to limit scope to elements with `"+r.field+"` defined")};switch(r.mapped){case a.mapData:{for(var m=r.field.split("."),v=f.data,y=0;y<m.length&&v;y++){var b=m[y];v=v[b]}if(v==null)return g(),!1;var x;if(Pe(v)){var w=r.fieldMax-r.fieldMin;w===0?x=0:x=(v-r.fieldMin)/w}else return Rn("Do not use continuous mappers without specifying numeric data (i.e. `"+r.field+": "+v+"` for `"+e.id()+"` is non-numeric)"),!1;if(x<0?x=0:x>1&&(x=1),o.color){var C=r.valueMin[0],$=r.valueMax[0],_=r.valueMin[1],k=r.valueMax[1],E=r.valueMin[2],S=r.valueMax[2],N=r.valueMin[3]==null?1:r.valueMin[3],A=r.valueMax[3]==null?1:r.valueMax[3],D=[Math.round(C+($-C)*x),Math.round(_+(k-_)*x),Math.round(E+(S-E)*x),Math.round(N+(A-N)*x)];s={bypass:r.bypass,name:r.name,value:D,strValue:"rgb("+D[0]+", "+D[1]+", "+D[2]+")"}}else if(o.number){var T=r.valueMin+(r.valueMax-r.valueMin)*x;s=this.parse(r.name,T,r.bypass,h)}else return!1;if(!s)return g(),!1;s.mapping=r,r=s;break}case a.data:{for(var I=r.field.split("."),F=f.data,R=0;R<I.length&&F;R++){var P=I[R];F=F[P]}if(F!=null&&(s=this.parse(r.name,F,r.bypass,h)),!s)return g(),!1;s.mapping=r,r=s;break}case a.fn:{var V=r.value,z=r.fnValue!=null?r.fnValue:V(e);if(r.prevFnValue=z,z==null)return Rn("Custom function mappers may not return null (i.e. `"+r.name+"` for ele `"+e.id()+"` is null)"),!1;if(s=this.parse(r.name,z,r.bypass,h),!s)return Rn("Custom function mappers may not return invalid values for the property type (i.e. `"+r.name+"` for ele `"+e.id()+"` is invalid)"),!1;s.mapping=Kf(r),r=s;break}case void 0:break;default:return!1}return l?(c?r.bypassed=u.bypassed:r.bypassed=u,i[r.name]=r):c?u.bypassed=r:i[r.name]=r,p(),!0};Pa.cleanElements=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(this.clearStyleHints(r),r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache(),!t)r._private.style={};else for(var i=r._private.style,s=Object.keys(i),a=0;a<s.length;a++){var o=s[a],l=i[o];l!=null&&(l.bypass?l.bypassed=null:i[o]=null)}}};Pa.update=function(){var e=this._private.cy,t=e.mutableElements();t.updateStyle()};Pa.updateTransitions=function(e,t){var n=this,r=e._private,i=e.pstyle("transition-property").value,s=e.pstyle("transition-duration").pfValue,a=e.pstyle("transition-delay").pfValue;if(i.length>0&&s>0){for(var o={},l=!1,u=0;u<i.length;u++){var c=i[u],f=e.pstyle(c),h=t[c];if(!!h){var d=h.prev,p=d,g=h.next!=null?h.next:f,m=!1,v=void 0,y=1e-6;!p||(Pe(p.pfValue)&&Pe(g.pfValue)?(m=g.pfValue-p.pfValue,v=p.pfValue+y*m):Pe(p.value)&&Pe(g.value)?(m=g.value-p.value,v=p.value+y*m):Jn(p.value)&&Jn(g.value)&&(m=p.value[0]!==g.value[0]||p.value[1]!==g.value[1]||p.value[2]!==g.value[2],v=p.strValue),m&&(o[c]=g.strValue,this.applyBypass(e,c,v),l=!0))}}if(!l)return;r.transitioning=!0,new wC(function(b){a>0?e.delayAnimation(a).play().promise().then(b):b()}).then(function(){return e.animation({style:o,duration:s,easing:e.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){n.removeBypasses(e,i),e.emitAndNotify("style"),r.transitioning=!1})}else r.transitioning&&(this.removeBypasses(e,i),e.emitAndNotify("style"),r.transitioning=!1)};Pa.checkTrigger=function(e,t,n,r,i,s){var a=this.properties[t],o=i(a);o!=null&&o(n,r)&&s(a)};Pa.checkZOrderTrigger=function(e,t,n,r){var i=this;this.checkTrigger(e,t,n,r,function(s){return s.triggersZOrder},function(){i._private.cy.notify("zorder",e)})};Pa.checkBoundsTrigger=function(e,t,n,r){this.checkTrigger(e,t,n,r,function(i){return i.triggersBounds},function(i){e.dirtyCompoundBoundsCache(),e.dirtyBoundingBoxCache(),i.triggersBoundsOfParallelBeziers&&(t==="curve-style"&&(n==="bezier"||r==="bezier")||t==="display"&&(n==="none"||r==="none"))&&e.parallelEdges().forEach(function(s){s.isBundledBezier()&&s.dirtyBoundingBoxCache()})})};Pa.checkTriggers=function(e,t,n,r){e.dirtyStyleCache(),this.checkZOrderTrigger(e,t,n,r),this.checkBoundsTrigger(e,t,n,r)};var pN={};pN.applyBypass=function(e,t,n,r){var i=this,s=[],a=!0;if(t==="*"||t==="**"){if(n!==void 0)for(var o=0;o<i.properties.length;o++){var l=i.properties[o],u=l.name,c=this.parse(u,n,!0);c&&s.push(c)}}else if(rt(t)){var f=this.parse(t,n,!0);f&&s.push(f)}else if(pn(t)){var h=t;r=n;for(var d=Object.keys(h),p=0;p<d.length;p++){var g=d[p],m=h[g];if(m===void 0&&(m=h[mB(g)]),m!==void 0){var v=this.parse(g,m,!0);v&&s.push(v)}}}else return!1;if(s.length===0)return!1;for(var y=!1,b=0;b<e.length;b++){for(var x=e[b],w={},C=void 0,$=0;$<s.length;$++){var _=s[$];if(r){var k=x.pstyle(_.name);C=w[_.name]={prev:k}}y=this.applyParsedProperty(x,Kf(_))||y,r&&(C.next=x.pstyle(_.name))}y&&this.updateStyleHints(x),r&&this.updateTransitions(x,w,a)}return y};pN.overrideBypass=function(e,t,n){t=Mee(t);for(var r=0;r<e.length;r++){var i=e[r],s=i._private.style[t],a=this.properties[t].type,o=a.color,l=a.mutiple,u=s?s.pfValue!=null?s.pfValue:s.value:null;!s||!s.bypass?this.applyBypass(i,t,n):(s.value=n,s.pfValue!=null&&(s.pfValue=n),o?s.strValue="rgb("+n.join(",")+")":l?s.strValue=n.join(" "):s.strValue=""+n,this.updateStyleHints(i)),this.checkTriggers(i,t,u,n)}};pN.removeAllBypasses=function(e,t){return this.removeBypasses(e,this.propertyNames,t)};pN.removeBypasses=function(e,t,n){for(var r=!0,i=0;i<e.length;i++){for(var s=e[i],a={},o=0;o<t.length;o++){var l=t[o],u=this.properties[l],c=s.pstyle(u.name);if(!(!c||!c.bypass)){var f="",h=this.parse(l,f,!0),d=a[u.name]={prev:c};this.applyParsedProperty(s,h),d.next=s.pstyle(u.name)}}this.updateStyleHints(s),n&&this.updateTransitions(s,a,r)}};var jee={};jee.getEmSizeInPixels=function(){var e=this.containerCss("font-size");return e!=null?parseFloat(e):1};jee.containerCss=function(e){var t=this._private.cy,n=t.container();if(Er&&n&&Er.getComputedStyle)return Er.getComputedStyle(n).getPropertyValue(e)};var Th={};Th.getRenderedStyle=function(e,t){return t?this.getStylePropertyValue(e,t,!0):this.getRawStyle(e,!0)};Th.getRawStyle=function(e,t){var n=this;if(e=e[0],e){for(var r={},i=0;i<n.properties.length;i++){var s=n.properties[i],a=n.getStylePropertyValue(e,s.name,t);a!=null&&(r[s.name]=a,r[mB(s.name)]=a)}return r}};Th.getIndexedStyle=function(e,t,n,r){var i=e.pstyle(t)[n][r];return i!=null?i:e.cy().style().getDefaultProperty(t)[n][0]};Th.getStylePropertyValue=function(e,t,n){var r=this;if(e=e[0],e){var i=r.properties[t];i.alias&&(i=i.pointsTo);var s=i.type,a=e.pstyle(i.name);if(a){var o=a.value,l=a.units,u=a.strValue;if(n&&s.number&&o!=null&&Pe(o)){var c=e.cy().zoom(),f=function(m){return m*c},h=function(m,v){return f(m)+v},d=Jn(o),p=d?l.every(function(g){return g!=null}):l!=null;return p?d?o.map(function(g,m){return h(g,l[m])}).join(" "):h(o,l):d?o.map(function(g){return rt(g)?g:""+f(g)}).join(" "):""+f(o)}else if(u!=null)return u}return null}};Th.getAnimationStartStyle=function(e,t){for(var n={},r=0;r<t.length;r++){var i=t[r],s=i.name,a=e.pstyle(s);a!==void 0&&(pn(a)?a=this.parse(s,a.strValue):a=this.parse(s,a)),a&&(n[s]=a)}return n};Th.getPropsList=function(e){var t=this,n=[],r=e,i=t.properties;if(r)for(var s=Object.keys(r),a=0;a<s.length;a++){var o=s[a],l=r[o],u=i[o]||i[Mee(o)],c=this.parse(u.name,l);c&&n.push(c)}return n};Th.getNonDefaultPropertiesHash=function(e,t,n){var r=n.slice(),i,s,a,o,l,u;for(l=0;l<t.length;l++)if(i=t[l],s=e.pstyle(i,!1),s!=null)if(s.pfValue!=null)r[0]=tT(o,r[0]),r[1]=nT(o,r[1]);else for(a=s.strValue,u=0;u<a.length;u++)o=a.charCodeAt(u),r[0]=tT(o,r[0]),r[1]=nT(o,r[1]);return r};Th.getPropertiesHash=Th.getNonDefaultPropertiesHash;var _B={};_B.appendFromJson=function(e){for(var t=this,n=0;n<e.length;n++){var r=e[n],i=r.selector,s=r.style||r.css,a=Object.keys(s);t.selector(i);for(var o=0;o<a.length;o++){var l=a[o],u=s[l];t.css(l,u)}}return t};_B.fromJson=function(e){var t=this;return t.resetToDefault(),t.appendFromJson(e),t};_B.json=function(){for(var e=[],t=this.defaultLength;t<this.length;t++){for(var n=this[t],r=n.selector,i=n.properties,s={},a=0;a<i.length;a++){var o=i[a];s[o.name]=o.strValue}e.push({selector:r?r.toString():"core",style:s})}return e};var Hee={};Hee.appendFromString=function(e){var t=this,n=this,r=""+e,i,s,a;r=r.replace(/[/][*](\s|.)+?[*][/]/g,"");function o(){r.length>i.length?r=r.substr(i.length):r=""}function l(){s.length>a.length?s=s.substr(a.length):s=""}for(;;){var u=r.match(/^\s*$/);if(u)break;var c=r.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!c){Rn("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+r);break}i=c[0];var f=c[1];if(f!=="core"){var h=new P0(f);if(h.invalid){Rn("Skipping parsing of block: Invalid selector found in string stylesheet: "+f),o();continue}}var d=c[2],p=!1;s=d;for(var g=[];;){var m=s.match(/^\s*$/);if(m)break;var v=s.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!v){Rn("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+d),p=!0;break}a=v[0];var y=v[1],b=v[2],x=t.properties[y];if(!x){Rn("Skipping property: Invalid property name in: "+a),l();continue}var w=n.parse(y,b);if(!w){Rn("Skipping property: Invalid property definition in: "+a),l();continue}g.push({name:y,val:b}),l()}if(p){o();break}n.selector(f);for(var C=0;C<g.length;C++){var $=g[C];n.css($.name,$.val)}o()}return n};Hee.fromString=function(e){var t=this;return t.resetToDefault(),t.appendFromString(e),t};var Ns={};(function(){var e=Ei,t=Dit,n=Iit,r=Mit,i=Fit,s=function(ae){return"^"+ae+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},a=function(ae){var O=e+"|\\w+|"+t+"|"+n+"|"+r+"|"+i;return"^"+ae+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+e+")\\s*\\,\\s*("+e+")\\s*,\\s*("+O+")\\s*\\,\\s*("+O+")\\)$"},o=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];Ns.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi"]},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:s("data")},layoutData:{mapping:!0,regex:s("layoutData")},scratch:{mapping:!0,regex:s("scratch")},mapData:{mapping:!0,regex:a("mapData")},mapLayoutData:{mapping:!0,regex:a("mapLayoutData")},mapScratch:{mapping:!0,regex:a("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:o,singleRegexMatchValue:!0},urls:{regexes:o,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(ae,O){switch(ae.length){case 2:return O[0]!=="deg"&&O[0]!=="rad"&&O[1]!=="deg"&&O[1]!=="rad";case 1:return rt(ae[0])||O[0]==="deg"||O[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+e+")\\s*,\\s*("+e+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+e+")\\s*,\\s*("+e+")\\s*,\\s*("+e+")\\s*,\\s*("+e+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(ae){var O=ae.length;return O===1||O===2||O===4}}};var l={zeroNonZero:function(ae,O){return(ae==null||O==null)&&ae!==O||ae==0&&O!=0?!0:ae!=0&&O==0},any:function(ae,O){return ae!=O},emptyNonEmpty:function(ae,O){var L=O0(ae),W=O0(O);return L&&!W||!L&&W}},u=Ns.types,c=[{name:"label",type:u.text,triggersBounds:l.any,triggersZOrder:l.emptyNonEmpty},{name:"text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any}],f=[{name:"source-label",type:u.text,triggersBounds:l.any},{name:"source-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"source-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-offset",type:u.size,triggersBounds:l.any}],h=[{name:"target-label",type:u.text,triggersBounds:l.any},{name:"target-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"target-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-offset",type:u.size,triggersBounds:l.any}],d=[{name:"font-family",type:u.fontFamily,triggersBounds:l.any},{name:"font-style",type:u.fontStyle,triggersBounds:l.any},{name:"font-weight",type:u.fontWeight,triggersBounds:l.any},{name:"font-size",type:u.size,triggersBounds:l.any},{name:"text-transform",type:u.textTransform,triggersBounds:l.any},{name:"text-wrap",type:u.textWrap,triggersBounds:l.any},{name:"text-overflow-wrap",type:u.textOverflowWrap,triggersBounds:l.any},{name:"text-max-width",type:u.size,triggersBounds:l.any},{name:"text-outline-width",type:u.size,triggersBounds:l.any},{name:"line-height",type:u.positiveNumber,triggersBounds:l.any}],p=[{name:"text-valign",type:u.valign,triggersBounds:l.any},{name:"text-halign",type:u.halign,triggersBounds:l.any},{name:"color",type:u.color},{name:"text-outline-color",type:u.color},{name:"text-outline-opacity",type:u.zeroOneNumber},{name:"text-background-color",type:u.color},{name:"text-background-opacity",type:u.zeroOneNumber},{name:"text-background-padding",type:u.size,triggersBounds:l.any},{name:"text-border-opacity",type:u.zeroOneNumber},{name:"text-border-color",type:u.color},{name:"text-border-width",type:u.size,triggersBounds:l.any},{name:"text-border-style",type:u.borderStyle,triggersBounds:l.any},{name:"text-background-shape",type:u.textBackgroundShape,triggersBounds:l.any},{name:"text-justification",type:u.justification}],g=[{name:"events",type:u.bool},{name:"text-events",type:u.bool}],m=[{name:"display",type:u.display,triggersZOrder:l.any,triggersBounds:l.any,triggersBoundsOfParallelBeziers:!0},{name:"visibility",type:u.visibility,triggersZOrder:l.any},{name:"opacity",type:u.zeroOneNumber,triggersZOrder:l.zeroNonZero},{name:"text-opacity",type:u.zeroOneNumber},{name:"min-zoomed-font-size",type:u.size},{name:"z-compound-depth",type:u.zCompoundDepth,triggersZOrder:l.any},{name:"z-index-compare",type:u.zIndexCompare,triggersZOrder:l.any},{name:"z-index",type:u.nonNegativeInt,triggersZOrder:l.any}],v=[{name:"overlay-padding",type:u.size,triggersBounds:l.any},{name:"overlay-color",type:u.color},{name:"overlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"overlay-shape",type:u.overlayShape,triggersBounds:l.any}],y=[{name:"underlay-padding",type:u.size,triggersBounds:l.any},{name:"underlay-color",type:u.color},{name:"underlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"underlay-shape",type:u.overlayShape,triggersBounds:l.any}],b=[{name:"transition-property",type:u.propList},{name:"transition-duration",type:u.time},{name:"transition-delay",type:u.time},{name:"transition-timing-function",type:u.easing}],x=function(ae,O){return O.value==="label"?-ae.poolIndex():O.pfValue},w=[{name:"height",type:u.nodeSize,triggersBounds:l.any,hashOverride:x},{name:"width",type:u.nodeSize,triggersBounds:l.any,hashOverride:x},{name:"shape",type:u.nodeShape,triggersBounds:l.any},{name:"shape-polygon-points",type:u.polygonPointList,triggersBounds:l.any},{name:"background-color",type:u.color},{name:"background-fill",type:u.fill},{name:"background-opacity",type:u.zeroOneNumber},{name:"background-blacken",type:u.nOneOneNumber},{name:"background-gradient-stop-colors",type:u.colors},{name:"background-gradient-stop-positions",type:u.percentages},{name:"background-gradient-direction",type:u.gradientDirection},{name:"padding",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"padding-relative-to",type:u.paddingRelativeTo,triggersBounds:l.any},{name:"bounds-expansion",type:u.boundsExpansion,triggersBounds:l.any}],C=[{name:"border-color",type:u.color},{name:"border-opacity",type:u.zeroOneNumber},{name:"border-width",type:u.size,triggersBounds:l.any},{name:"border-style",type:u.borderStyle}],$=[{name:"background-image",type:u.urls},{name:"background-image-crossorigin",type:u.bgCrossOrigin},{name:"background-image-opacity",type:u.zeroOneNumbers},{name:"background-image-containment",type:u.bgContainment},{name:"background-image-smoothing",type:u.bools},{name:"background-position-x",type:u.bgPos},{name:"background-position-y",type:u.bgPos},{name:"background-width-relative-to",type:u.bgRelativeTo},{name:"background-height-relative-to",type:u.bgRelativeTo},{name:"background-repeat",type:u.bgRepeat},{name:"background-fit",type:u.bgFit},{name:"background-clip",type:u.bgClip},{name:"background-width",type:u.bgWH},{name:"background-height",type:u.bgWH},{name:"background-offset-x",type:u.bgPos},{name:"background-offset-y",type:u.bgPos}],_=[{name:"position",type:u.position,triggersBounds:l.any},{name:"compound-sizing-wrt-labels",type:u.compoundIncludeLabels,triggersBounds:l.any},{name:"min-width",type:u.size,triggersBounds:l.any},{name:"min-width-bias-left",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-width-bias-right",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height",type:u.size,triggersBounds:l.any},{name:"min-height-bias-top",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height-bias-bottom",type:u.sizeMaybePercent,triggersBounds:l.any}],k=[{name:"line-style",type:u.lineStyle},{name:"line-color",type:u.color},{name:"line-fill",type:u.fill},{name:"line-cap",type:u.lineCap},{name:"line-opacity",type:u.zeroOneNumber},{name:"line-dash-pattern",type:u.numbers},{name:"line-dash-offset",type:u.number},{name:"line-gradient-stop-colors",type:u.colors},{name:"line-gradient-stop-positions",type:u.percentages},{name:"curve-style",type:u.curveStyle,triggersBounds:l.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:u.zeroOneNumber,triggersBounds:l.any},{name:"source-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"target-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"control-point-step-size",type:u.size,triggersBounds:l.any},{name:"control-point-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"control-point-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"segment-weights",type:u.numbers,triggersBounds:l.any},{name:"taxi-turn",type:u.bidirectionalSizeMaybePercent,triggersBounds:l.any},{name:"taxi-turn-min-distance",type:u.size,triggersBounds:l.any},{name:"taxi-direction",type:u.axisDirection,triggersBounds:l.any},{name:"edge-distances",type:u.edgeDistances,triggersBounds:l.any},{name:"arrow-scale",type:u.positiveNumber,triggersBounds:l.any},{name:"loop-direction",type:u.angle,triggersBounds:l.any},{name:"loop-sweep",type:u.angle,triggersBounds:l.any},{name:"source-distance-from-node",type:u.size,triggersBounds:l.any},{name:"target-distance-from-node",type:u.size,triggersBounds:l.any}],E=[{name:"ghost",type:u.bool,triggersBounds:l.any},{name:"ghost-offset-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-offset-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-opacity",type:u.zeroOneNumber}],S=[{name:"selection-box-color",type:u.color},{name:"selection-box-opacity",type:u.zeroOneNumber},{name:"selection-box-border-color",type:u.color},{name:"selection-box-border-width",type:u.size},{name:"active-bg-color",type:u.color},{name:"active-bg-opacity",type:u.zeroOneNumber},{name:"active-bg-size",type:u.size},{name:"outside-texture-bg-color",type:u.color},{name:"outside-texture-bg-opacity",type:u.zeroOneNumber}],N=[];Ns.pieBackgroundN=16,N.push({name:"pie-size",type:u.sizeMaybePercent});for(var A=1;A<=Ns.pieBackgroundN;A++)N.push({name:"pie-"+A+"-background-color",type:u.color}),N.push({name:"pie-"+A+"-background-size",type:u.percent}),N.push({name:"pie-"+A+"-background-opacity",type:u.zeroOneNumber});var D=[],T=Ns.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:u.arrowShape,triggersBounds:l.any},{name:"arrow-color",type:u.color},{name:"arrow-fill",type:u.arrowFill}].forEach(function(Z){T.forEach(function(ae){var O=ae+"-"+Z.name,L=Z.type,W=Z.triggersBounds;D.push({name:O,type:L,triggersBounds:W})})},{});var I=Ns.properties=[].concat(g,b,m,v,y,E,p,d,c,f,h,w,C,$,N,_,k,D,S),F=Ns.propertyGroups={behavior:g,transition:b,visibility:m,overlay:v,underlay:y,ghost:E,commonLabel:p,labelDimensions:d,mainLabel:c,sourceLabel:f,targetLabel:h,nodeBody:w,nodeBorder:C,backgroundImage:$,pie:N,compound:_,edgeLine:k,edgeArrow:D,core:S},R=Ns.propertyGroupNames={},P=Ns.propertyGroupKeys=Object.keys(F);P.forEach(function(Z){R[Z]=F[Z].map(function(ae){return ae.name}),F[Z].forEach(function(ae){return ae.groupKey=Z})});var V=Ns.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Ns.propertyNames=I.map(function(Z){return Z.name});for(var z=0;z<I.length;z++){var q=I[z];I[q.name]=q}for(var G=0;G<V.length;G++){var K=V[G],Y=I[K.pointsTo],te={name:K.name,alias:!0,pointsTo:Y};I.push(te),I[K.name]=te}})();Ns.getDefaultProperty=function(e){return this.getDefaultProperties()[e]};Ns.getDefaultProperties=function(){var e=this._private;if(e.defaultProperties!=null)return e.defaultProperties;for(var t=gt({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var c=1;c<=Ns.pieBackgroundN;c++){var f=u.name.replace("{{i}}",c),h=u.value;l[f]=h}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"taxi-turn":"50%","taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"}].reduce(function(l,u){return Ns.arrowPrefixes.forEach(function(c){var f=c+"-"+u.name,h=u.value;l[f]=h}),l},{})),n={},r=0;r<this.properties.length;r++){var i=this.properties[r];if(!i.pointsTo){var s=i.name,a=t[s],o=this.parse(s,a);n[s]=o}}return e.defaultProperties=n,e.defaultProperties};Ns.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var SB={};SB.parse=function(e,t,n,r){var i=this;if(zr(t))return i.parseImplWarn(e,t,n,r);var s=r==="mapping"||r===!0||r===!1||r==null?"dontcare":r,a=n?"t":"f",o=""+t,l=jke(e,o,a,s),u=i.propCache=i.propCache||[],c;return(c=u[l])||(c=u[l]=i.parseImplWarn(e,t,n,r)),(n||r==="mapping")&&(c=Kf(c),c&&(c.value=Kf(c.value))),c};SB.parseImplWarn=function(e,t,n,r){var i=this.parseImpl(e,t,n,r);return!i&&t!=null&&Rn("The style property `".concat(e,": ").concat(t,"` is invalid")),i&&(i.name==="width"||i.name==="height")&&t==="label"&&Rn("The style value of `label` is deprecated for `"+i.name+"`"),i};SB.parseImpl=function(e,t,n,r){var i=this;e=Mee(e);var s=i.properties[e],a=t,o=i.types;if(!s||t===void 0)return null;s.alias&&(s=s.pointsTo,e=s.name);var l=rt(t);l&&(t=t.trim());var u=s.type;if(!u)return null;if(n&&(t===""||t===null))return{name:e,value:t,bypass:!0,deleteBypass:!0};if(zr(t))return{name:e,value:t,strValue:"fn",mapped:o.fn,bypass:n};var c,f;if(!(!l||r||t.length<7||t[1]!=="a")){if(t.length>=7&&t[0]==="d"&&(c=new RegExp(o.data.regex).exec(t))){if(n)return!1;var h=o.data;return{name:e,value:c,strValue:""+t,mapped:h,field:c[1],bypass:n}}else if(t.length>=10&&t[0]==="m"&&(f=new RegExp(o.mapData.regex).exec(t))){if(n||u.multiple)return!1;var d=o.mapData;if(!(u.color||u.number))return!1;var p=this.parse(e,f[4]);if(!p||p.mapped)return!1;var g=this.parse(e,f[5]);if(!g||g.mapped)return!1;if(p.pfValue===g.pfValue||p.strValue===g.strValue)return Rn("`"+e+": "+t+"` is not a valid mapper because the output range is zero; converting to `"+e+": "+p.strValue+"`"),this.parse(e,p.strValue);if(u.color){var m=p.value,v=g.value,y=m[0]===v[0]&&m[1]===v[1]&&m[2]===v[2]&&(m[3]===v[3]||(m[3]==null||m[3]===1)&&(v[3]==null||v[3]===1));if(y)return!1}return{name:e,value:f,strValue:""+t,mapped:d,field:f[1],fieldMin:parseFloat(f[2]),fieldMax:parseFloat(f[3]),valueMin:p.value,valueMax:g.value,bypass:n}}}if(u.multiple&&r!=="multiple"){var b;if(l?b=t.split(/\s+/):Jn(t)?b=t:b=[t],u.evenMultiple&&b.length%2!==0)return null;for(var x=[],w=[],C=[],$="",_=!1,k=0;k<b.length;k++){var E=i.parse(e,b[k],n,"multiple");_=_||rt(E.value),x.push(E.value),C.push(E.pfValue!=null?E.pfValue:E.value),w.push(E.units),$+=(k>0?" ":"")+E.strValue}return u.validate&&!u.validate(x,w)?null:u.singleEnum&&_?x.length===1&&rt(x[0])?{name:e,value:x[0],strValue:x[0],bypass:n}:null:{name:e,value:x,pfValue:C,strValue:$,bypass:n,units:w}}var S=function(){for(var O=0;O<u.enums.length;O++){var L=u.enums[O];if(L===t)return{name:e,value:t,strValue:""+t,bypass:n}}return null};if(u.number){var N,A="px";if(u.units&&(N=u.units),u.implicitUnits&&(A=u.implicitUnits),!u.unitless)if(l){var D="px|em"+(u.allowPercent?"|\\%":"");N&&(D=N);var T=t.match("^("+Ei+")("+D+")?$");T&&(t=T[1],N=T[2]||A)}else(!N||u.implicitUnits)&&(N=A);if(t=parseFloat(t),isNaN(t)&&u.enums===void 0)return null;if(isNaN(t)&&u.enums!==void 0)return t=a,S();if(u.integer&&!Cit(t)||u.min!==void 0&&(t<u.min||u.strictMin&&t===u.min)||u.max!==void 0&&(t>u.max||u.strictMax&&t===u.max))return null;var I={name:e,value:t,strValue:""+t+(N||""),units:N,bypass:n};return u.unitless||N!=="px"&&N!=="em"?I.pfValue=t:I.pfValue=N==="px"||!N?t:this.getEmSizeInPixels()*t,(N==="ms"||N==="s")&&(I.pfValue=N==="ms"?t:1e3*t),(N==="deg"||N==="rad")&&(I.pfValue=N==="rad"?t:yst(t)),N==="%"&&(I.pfValue=t/100),I}else if(u.propList){var F=[],R=""+t;if(R!=="none"){for(var P=R.split(/\s*,\s*|\s+/),V=0;V<P.length;V++){var z=P[V].trim();i.properties[z]?F.push(z):Rn("`"+z+"` is not a valid property name")}if(F.length===0)return null}return{name:e,value:F,strValue:F.length===0?"none":F.join(" "),bypass:n}}else if(u.color){var q=zit(t);return q?{name:e,value:q,pfValue:q,strValue:"rgb("+q[0]+","+q[1]+","+q[2]+")",bypass:n}:null}else if(u.regex||u.regexes){if(u.enums){var G=S();if(G)return G}for(var K=u.regexes?u.regexes:[u.regex],Y=0;Y<K.length;Y++){var te=new RegExp(K[Y]),Z=te.exec(t);if(Z)return{name:e,value:u.singleRegexMatchValue?Z[1]:Z,strValue:""+t,bypass:n}}return null}else return u.string?{name:e,value:""+t,strValue:""+t,bypass:n}:u.enums?S():null};var wa=function e(t){if(!(this instanceof e))return new e(t);if(!Iee(t)){Xr("A style must have a core reference");return}this._private={cy:t,coreStyle:{}},this.length=0,this.resetToDefault()},Ia=wa.prototype;Ia.instanceString=function(){return"style"};Ia.clear=function(){for(var e=this._private,t=e.cy,n=t.elements(),r=0;r<this.length;r++)this[r]=void 0;return this.length=0,e.contextStyles={},e.propDiffs={},this.cleanElements(n,!0),n.forEach(function(i){var s=i[0]._private;s.styleDirty=!0,s.appliedInitStyle=!1}),this};Ia.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};Ia.core=function(e){return this._private.coreStyle[e]||this.getDefaultProperty(e)};Ia.selector=function(e){var t=e==="core"?null:new P0(e),n=this.length++;return this[n]={selector:t,properties:[],mappedProperties:[],index:n},this};Ia.css=function(){var e=this,t=arguments;if(t.length===1)for(var n=t[0],r=0;r<e.properties.length;r++){var i=e.properties[r],s=n[i.name];s===void 0&&(s=n[mB(i.name)]),s!==void 0&&this.cssRule(i.name,s)}else t.length===2&&this.cssRule(t[0],t[1]);return this};Ia.style=Ia.css;Ia.cssRule=function(e,t){var n=this.parse(e,t);if(n){var r=this.length-1;this[r].properties.push(n),this[r].properties[n.name]=n,n.name.match(/pie-(\d+)-background-size/)&&n.value&&(this._private.hasPie=!0),n.mapped&&this[r].mappedProperties.push(n);var i=!this[r].selector;i&&(this._private.coreStyle[n.name]=n)}return this};Ia.append=function(e){return Rke(e)?e.appendToStyle(this):Jn(e)?this.appendFromJson(e):rt(e)&&this.appendFromString(e),this};wa.fromJson=function(e,t){var n=new wa(e);return n.fromJson(t),n};wa.fromString=function(e,t){return new wa(e).fromString(t)};[Pa,pN,jee,Th,_B,Hee,Ns,SB].forEach(function(e){gt(Ia,e)});wa.types=Ia.types;wa.properties=Ia.properties;wa.propertyGroups=Ia.propertyGroups;wa.propertyGroupNames=Ia.propertyGroupNames;wa.propertyGroupKeys=Ia.propertyGroupKeys;var Dot={style:function(t){if(t){var n=this.setStyle(t);n.update()}return this._private.style},setStyle:function(t){var n=this._private;return Rke(t)?n.style=t.generateStyle(this):Jn(t)?n.style=wa.fromJson(this,t):rt(t)?n.style=wa.fromString(this,t):n.style=wa(this),n.style},updateStyle:function(){this.mutableElements().updateStyle()}},Not="single",Ay={autolock:function(t){if(t!==void 0)this._private.autolock=!!t;else return this._private.autolock;return this},autoungrabify:function(t){if(t!==void 0)this._private.autoungrabify=!!t;else return this._private.autoungrabify;return this},autounselectify:function(t){if(t!==void 0)this._private.autounselectify=!!t;else return this._private.autounselectify;return this},selectionType:function(t){var n=this._private;if(n.selectionType==null&&(n.selectionType=Not),t!==void 0)(t==="additive"||t==="single")&&(n.selectionType=t);else return n.selectionType;return this},panningEnabled:function(t){if(t!==void 0)this._private.panningEnabled=!!t;else return this._private.panningEnabled;return this},userPanningEnabled:function(t){if(t!==void 0)this._private.userPanningEnabled=!!t;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(t){if(t!==void 0)this._private.zoomingEnabled=!!t;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(t){if(t!==void 0)this._private.userZoomingEnabled=!!t;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(t){if(t!==void 0)this._private.boxSelectionEnabled=!!t;else return this._private.boxSelectionEnabled;return this},pan:function(){var t=arguments,n=this._private.pan,r,i,s,a,o;switch(t.length){case 0:return n;case 1:if(rt(t[0]))return r=t[0],n[r];if(pn(t[0])){if(!this._private.panningEnabled)return this;s=t[0],a=s.x,o=s.y,Pe(a)&&(n.x=a),Pe(o)&&(n.y=o),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;r=t[0],i=t[1],(r==="x"||r==="y")&&Pe(i)&&(n[r]=i),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(t,n){var r=arguments,i=this._private.pan,s,a,o,l,u;if(!this._private.panningEnabled)return this;switch(r.length){case 1:pn(t)&&(o=r[0],l=o.x,u=o.y,Pe(l)&&(i.x+=l),Pe(u)&&(i.y+=u),this.emit("pan viewport"));break;case 2:s=t,a=n,(s==="x"||s==="y")&&Pe(a)&&(i[s]+=a),this.emit("pan viewport");break}return this.notify("viewport"),this},fit:function(t,n){var r=this.getFitViewport(t,n);if(r){var i=this._private;i.zoom=r.zoom,i.pan=r.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(t,n){if(Pe(t)&&n===void 0&&(n=t,t=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var r;if(rt(t)){var i=t;t=this.$(i)}else if(kit(t)){var s=t;r={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2},r.w=r.x2-r.x1,r.h=r.y2-r.y1}else Rl(t)||(t=this.mutableElements());if(!(Rl(t)&&t.empty())){r=r||t.boundingBox();var a=this.width(),o=this.height(),l;if(n=Pe(n)?n:0,!isNaN(a)&&!isNaN(o)&&a>0&&o>0&&!isNaN(r.w)&&!isNaN(r.h)&&r.w>0&&r.h>0){l=Math.min((a-2*n)/r.w,(o-2*n)/r.h),l=l>this._private.maxZoom?this._private.maxZoom:l,l=l<this._private.minZoom?this._private.minZoom:l;var u={x:(a-l*(r.x1+r.x2))/2,y:(o-l*(r.y1+r.y2))/2};return{zoom:l,pan:u}}}}},zoomRange:function(t,n){var r=this._private;if(n==null){var i=t;t=i.min,n=i.max}return Pe(t)&&Pe(n)&&t<=n?(r.minZoom=t,r.maxZoom=n):Pe(t)&&n===void 0&&t<=r.maxZoom?r.minZoom=t:Pe(n)&&t===void 0&&n>=r.minZoom&&(r.maxZoom=n),this},minZoom:function(t){return t===void 0?this._private.minZoom:this.zoomRange({min:t})},maxZoom:function(t){return t===void 0?this._private.maxZoom:this.zoomRange({max:t})},getZoomedViewport:function(t){var n=this._private,r=n.pan,i=n.zoom,s,a,o=!1;if(n.zoomingEnabled||(o=!0),Pe(t)?a=t:pn(t)&&(a=t.level,t.position!=null?s=yB(t.position,i,r):t.renderedPosition!=null&&(s=t.renderedPosition),s!=null&&!n.panningEnabled&&(o=!0)),a=a>n.maxZoom?n.maxZoom:a,a=a<n.minZoom?n.minZoom:a,o||!Pe(a)||a===i||s!=null&&(!Pe(s.x)||!Pe(s.y)))return null;if(s!=null){var l=r,u=i,c=a,f={x:-c/u*(s.x-l.x)+s.x,y:-c/u*(s.y-l.y)+s.y};return{zoomed:!0,panned:!0,zoom:c,pan:f}}else return{zoomed:!0,panned:!1,zoom:a,pan:r}},zoom:function(t){if(t===void 0)return this._private.zoom;var n=this.getZoomedViewport(t),r=this._private;return n==null||!n.zoomed?this:(r.zoom=n.zoom,n.panned&&(r.pan.x=n.pan.x,r.pan.y=n.pan.y),this.emit("zoom"+(n.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(t){var n=this._private,r=!0,i=!0,s=[],a=!1,o=!1;if(!t)return this;if(Pe(t.zoom)||(r=!1),pn(t.pan)||(i=!1),!r&&!i)return this;if(r){var l=t.zoom;l<n.minZoom||l>n.maxZoom||!n.zoomingEnabled?a=!0:(n.zoom=l,s.push("zoom"))}if(i&&(!a||!t.cancelOnFailedZoom)&&n.panningEnabled){var u=t.pan;Pe(u.x)&&(n.pan.x=u.x,o=!1),Pe(u.y)&&(n.pan.y=u.y,o=!1),o||s.push("pan")}return s.length>0&&(s.push("viewport"),this.emit(s.join(" ")),this.notify("viewport")),this},center:function(t){var n=this.getCenterPan(t);return n&&(this._private.pan=n,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(t,n){if(!!this._private.panningEnabled){if(rt(t)){var r=t;t=this.mutableElements().filter(r)}else Rl(t)||(t=this.mutableElements());if(t.length!==0){var i=t.boundingBox(),s=this.width(),a=this.height();n=n===void 0?this._private.zoom:n;var o={x:(s-n*(i.x1+i.x2))/2,y:(a-n*(i.y1+i.y2))/2};return o}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var t=this._private,n=t.container;return t.sizeCache=t.sizeCache||(n?function(){var r=Er.getComputedStyle(n),i=function(a){return parseFloat(r.getPropertyValue(a))};return{width:n.clientWidth-i("padding-left")-i("padding-right"),height:n.clientHeight-i("padding-top")-i("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var t=this._private.pan,n=this._private.zoom,r=this.renderedExtent(),i={x1:(r.x1-t.x)/n,x2:(r.x2-t.x)/n,y1:(r.y1-t.y)/n,y2:(r.y2-t.y)/n};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var t=this.width(),n=this.height();return{x1:0,y1:0,x2:t,y2:n,w:t,h:n}},multiClickDebounceTime:function(t){if(t)this._private.multiClickDebounceTime=t;else return this._private.multiClickDebounceTime;return this}};Ay.centre=Ay.center;Ay.autolockNodes=Ay.autolock;Ay.autoungrabifyNodes=Ay.autoungrabify;var lT={data:Fn.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:Fn.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:Fn.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Fn.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};lT.attr=lT.data;lT.removeAttr=lT.removeData;var uT=function(t){var n=this;t=gt({},t);var r=t.container;r&&!f5(r)&&f5(r[0])&&(r=r[0]);var i=r?r._cyreg:null;i=i||{},i&&i.cy&&(i.cy.destroy(),i={});var s=i.readies=i.readies||[];r&&(r._cyreg=i),i.cy=n;var a=Er!==void 0&&r!==void 0&&!t.headless,o=t;o.layout=gt({name:a?"grid":"null"},o.layout),o.renderer=gt({name:a?"canvas":"null"},o.renderer);var l=function(p,g,m){return g!==void 0?g:m!==void 0?m:p},u=this._private={container:r,ready:!1,options:o,elements:new Us(this),listeners:[],aniEles:new Us(this),data:o.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:l(!0,o.zoomingEnabled),userZoomingEnabled:l(!0,o.userZoomingEnabled),panningEnabled:l(!0,o.panningEnabled),userPanningEnabled:l(!0,o.userPanningEnabled),boxSelectionEnabled:l(!0,o.boxSelectionEnabled),autolock:l(!1,o.autolock,o.autolockNodes),autoungrabify:l(!1,o.autoungrabify,o.autoungrabifyNodes),autounselectify:l(!1,o.autounselectify),styleEnabled:o.styleEnabled===void 0?a:o.styleEnabled,zoom:Pe(o.zoom)?o.zoom:1,pan:{x:pn(o.pan)&&Pe(o.pan.x)?o.pan.x:0,y:pn(o.pan)&&Pe(o.pan.y)?o.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:l(250,o.multiClickDebounceTime)};this.createEmitter(),this.selectionType(o.selectionType),this.zoomRange({min:o.minZoom,max:o.maxZoom});var c=function(p,g){var m=p.some(Eit);if(m)return wC.all(p).then(g);g(p)};u.styleEnabled&&n.setStyle([]);var f=gt({},o,o.renderer);n.initRenderer(f);var h=function(p,g,m){n.notifications(!1);var v=n.mutableElements();v.length>0&&v.remove(),p!=null&&(pn(p)||Jn(p))&&n.add(p),n.one("layoutready",function(b){n.notifications(!0),n.emit(b),n.one("load",g),n.emitAndNotify("load")}).one("layoutstop",function(){n.one("done",m),n.emit("done")});var y=gt({},n._private.options.layout);y.eles=n.elements(),n.layout(y).run()};c([o.style,o.elements],function(d){var p=d[0],g=d[1];u.styleEnabled&&n.style().append(p),h(g,function(){n.startAnimationLoop(),u.ready=!0,zr(o.ready)&&n.on("ready",o.ready);for(var m=0;m<s.length;m++){var v=s[m];n.on("ready",v)}i&&(i.readies=[]),n.emit("ready")},o.done)})},m5=uT.prototype;gt(m5,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(t){return this.isReady()?this.emitter().emit("ready",[],t):this.on("ready",t),this},destroy:function(){var t=this;if(!t.destroyed())return t.stopAnimationLoop(),t.destroyRenderer(),this.emit("destroy"),t._private.destroyed=!0,t},hasElementWithId:function(t){return this._private.elements.hasElementWithId(t)},getElementById:function(t){return this._private.elements.getElementById(t)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(t){return this._private.elements.merge(t),this},removeFromPool:function(t){return this._private.elements.unmerge(t),this},container:function(){return this._private.container||null},mount:function(t){if(t!=null){var n=this,r=n._private,i=r.options;return!f5(t)&&f5(t[0])&&(t=t[0]),n.stopAnimationLoop(),n.destroyRenderer(),r.container=t,r.styleEnabled=!0,n.invalidateSize(),n.initRenderer(gt({},i,i.renderer,{name:i.renderer.name==="null"?"canvas":i.renderer.name})),n.startAnimationLoop(),n.style(i.style),n.emit("mount"),n}},unmount:function(){var t=this;return t.stopAnimationLoop(),t.destroyRenderer(),t.initRenderer({name:"null"}),t.emit("unmount"),t},options:function(){return Kf(this._private.options)},json:function(t){var n=this,r=n._private,i=n.mutableElements(),s=function(x){return n.getElementById(x.id())};if(pn(t)){if(n.startBatch(),t.elements){var a={},o=function(x,w){for(var C=[],$=[],_=0;_<x.length;_++){var k=x[_];if(!k.data.id){Rn("cy.json() cannot handle elements without an ID attribute");continue}var E=""+k.data.id,S=n.getElementById(E);a[E]=!0,S.length!==0?$.push({ele:S,json:k}):(w&&(k.group=w),C.push(k))}n.add(C);for(var N=0;N<$.length;N++){var A=$[N],D=A.ele,T=A.json;D.json(T)}};if(Jn(t.elements))o(t.elements);else for(var l=["nodes","edges"],u=0;u<l.length;u++){var c=l[u],f=t.elements[c];Jn(f)&&o(f,c)}var h=n.collection();i.filter(function(b){return!a[b.id()]}).forEach(function(b){b.isParent()?h.merge(b):b.remove()}),h.forEach(function(b){return b.children().move({parent:null})}),h.forEach(function(b){return s(b).remove()})}t.style&&n.style(t.style),t.zoom!=null&&t.zoom!==r.zoom&&n.zoom(t.zoom),t.pan&&(t.pan.x!==r.pan.x||t.pan.y!==r.pan.y)&&n.pan(t.pan),t.data&&n.data(t.data);for(var d=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],p=0;p<d.length;p++){var g=d[p];t[g]!=null&&n[g](t[g])}return n.endBatch(),this}else{var m=!!t,v={};m?v.elements=this.elements().map(function(b){return b.json()}):(v.elements={},i.forEach(function(b){var x=b.group();v.elements[x]||(v.elements[x]=[]),v.elements[x].push(b.json())})),this._private.styleEnabled&&(v.style=n.style().json()),v.data=Kf(n.data());var y=r.options;return v.zoomingEnabled=r.zoomingEnabled,v.userZoomingEnabled=r.userZoomingEnabled,v.zoom=r.zoom,v.minZoom=r.minZoom,v.maxZoom=r.maxZoom,v.panningEnabled=r.panningEnabled,v.userPanningEnabled=r.userPanningEnabled,v.pan=Kf(r.pan),v.boxSelectionEnabled=r.boxSelectionEnabled,v.renderer=Kf(y.renderer),v.hideEdgesOnViewport=y.hideEdgesOnViewport,v.textureOnViewport=y.textureOnViewport,v.wheelSensitivity=y.wheelSensitivity,v.motionBlur=y.motionBlur,v.multiClickDebounceTime=y.multiClickDebounceTime,v}}});m5.$id=m5.getElementById;[xot,Sot,TEe,vY,t4,Eot,yY,n4,Dot,Ay,lT].forEach(function(e){gt(m5,e)});var Iot={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,n){return!0},ready:void 0,stop:void 0,transform:function(t,n){return n}},Mot={maximal:!1,acyclic:!1},Qx=function(t){return t.scratch("breadthfirst")},jpe=function(t,n){return t.scratch("breadthfirst",n)};function DEe(e){this.options=gt({},Iot,Mot,e)}DEe.prototype.run=function(){var e=this.options,t=e,n=e.cy,r=t.eles,i=r.nodes().filter(function(X){return!X.isParent()}),s=r,a=t.directed,o=t.acyclic||t.maximal||t.maximalAdjustments>0,l=il(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),u;if(Rl(t.roots))u=t.roots;else if(Jn(t.roots)){for(var c=[],f=0;f<t.roots.length;f++){var h=t.roots[f],d=n.getElementById(h);c.push(d)}u=n.collection(c)}else if(rt(t.roots))u=n.$(t.roots);else if(a)u=i.roots();else{var p=r.components();u=n.collection();for(var g=function(se){var oe=p[se],pe=oe.maxDegree(!1),Ce=oe.filter(function(Ue){return Ue.degree(!1)===pe});u=u.add(Ce)},m=0;m<p.length;m++)g(m)}var v=[],y={},b=function(se,oe){v[oe]==null&&(v[oe]=[]);var pe=v[oe].length;v[oe].push(se),jpe(se,{index:pe,depth:oe})},x=function(se,oe){var pe=Qx(se),Ce=pe.depth,Ue=pe.index;v[Ce][Ue]=null,b(se,oe)};s.bfs({roots:u,directed:t.directed,visit:function(se,oe,pe,Ce,Ue){var et=se[0],dt=et.id();b(et,Ue),y[dt]=!0}});for(var w=[],C=0;C<i.length;C++){var $=i[C];y[$.id()]||w.push($)}var _=function(se){for(var oe=v[se],pe=0;pe<oe.length;pe++){var Ce=oe[pe];if(Ce==null){oe.splice(pe,1),pe--;continue}jpe(Ce,{depth:se,index:pe})}},k=function(){for(var se=0;se<v.length;se++)_(se)},E=function(se,oe){for(var pe=Qx(se),Ce=se.incomers().filter(function(fe){return fe.isNode()&&r.has(fe)}),Ue=-1,et=se.id(),dt=0;dt<Ce.length;dt++){var He=Ce[dt],Se=Qx(He);Ue=Math.max(Ue,Se.depth)}if(pe.depth<=Ue){if(!t.acyclic&&oe[et])return null;var j=Ue+1;return x(se,j),oe[et]=j,!0}return!1};if(a&&o){var S=[],N={},A=function(se){return S.push(se)},D=function(){return S.shift()};for(i.forEach(function(X){return S.push(X)});S.length>0;){var T=D(),I=E(T,N);if(I)T.outgoers().filter(function(X){return X.isNode()&&r.has(X)}).forEach(A);else if(I===null){Rn("Detected double maximal shift for node `"+T.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}k();var F=0;if(t.avoidOverlap)for(var R=0;R<i.length;R++){var P=i[R],V=P.layoutDimensions(t),z=V.w,q=V.h;F=Math.max(F,z,q)}var G={},K=function(se){if(G[se.id()])return G[se.id()];for(var oe=Qx(se).depth,pe=se.neighborhood(),Ce=0,Ue=0,et=0;et<pe.length;et++){var dt=pe[et];if(!(dt.isEdge()||dt.isParent()||!i.has(dt))){var He=Qx(dt);if(He!=null){var Se=He.index,j=He.depth;if(!(Se==null||j==null)){var fe=v[j].length;j<oe&&(Ce+=Se/fe,Ue++)}}}}return Ue=Math.max(1,Ue),Ce=Ce/Ue,Ue===0&&(Ce=0),G[se.id()]=Ce,Ce},Y=function(se,oe){var pe=K(se),Ce=K(oe),Ue=pe-Ce;return Ue===0?Lke(se.id(),oe.id()):Ue};t.depthSort!==void 0&&(Y=t.depthSort);for(var te=0;te<v.length;te++)v[te].sort(Y),_(te);for(var Z=[],ae=0;ae<w.length;ae++)Z.push(w[ae]);v.unshift(Z),k();for(var O=0,L=0;L<v.length;L++)O=Math.max(v[L].length,O);var W={x:l.x1+l.w/2,y:l.x1+l.h/2},M=v.reduce(function(X,se){return Math.max(X,se.length)},0),ue=function(se){var oe=Qx(se),pe=oe.depth,Ce=oe.index,Ue=v[pe].length,et=Math.max(l.w/((t.grid?M:Ue)+1),F),dt=Math.max(l.h/(v.length+1),F),He=Math.min(l.w/2/v.length,l.h/2/v.length);if(He=Math.max(He,F),t.circle){var j=He*pe+He-(v.length>0&&v[0].length<=3?He/2:0),fe=2*Math.PI/v[pe].length*Ce;return pe===0&&v[0].length===1&&(j=1),{x:W.x+j*Math.cos(fe),y:W.y+j*Math.sin(fe)}}else{var Se={x:W.x+(Ce+1-(Ue+1)/2)*et,y:(pe+1)*dt};return Se}};return r.nodes().layoutPositions(this,t,ue),this};var Fot={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,n){return!0},ready:void 0,stop:void 0,transform:function(t,n){return n}};function NEe(e){this.options=gt({},Fot,e)}NEe.prototype.run=function(){var e=this.options,t=e,n=e.cy,r=t.eles,i=t.counterclockwise!==void 0?!t.counterclockwise:t.clockwise,s=r.nodes().not(":parent");t.sort&&(s=s.sort(t.sort));for(var a=il(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),o={x:a.x1+a.w/2,y:a.y1+a.h/2},l=t.sweep===void 0?2*Math.PI-2*Math.PI/s.length:t.sweep,u=l/Math.max(1,s.length-1),c,f=0,h=0;h<s.length;h++){var d=s[h],p=d.layoutDimensions(t),g=p.w,m=p.h;f=Math.max(f,g,m)}if(Pe(t.radius)?c=t.radius:s.length<=1?c=0:c=Math.min(a.h,a.w)/2-f,s.length>1&&t.avoidOverlap){f*=1.75;var v=Math.cos(u)-Math.cos(0),y=Math.sin(u)-Math.sin(0),b=Math.sqrt(f*f/(v*v+y*y));c=Math.max(b,c)}var x=function(C,$){var _=t.startAngle+$*u*(i?1:-1),k=c*Math.cos(_),E=c*Math.sin(_),S={x:o.x+k,y:o.y+E};return S};return r.nodes().layoutPositions(this,t,x),this};var Oot={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(t){return t.degree()},levelWidth:function(t){return t.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,n){return!0},ready:void 0,stop:void 0,transform:function(t,n){return n}};function IEe(e){this.options=gt({},Oot,e)}IEe.prototype.run=function(){for(var e=this.options,t=e,n=t.counterclockwise!==void 0?!t.counterclockwise:t.clockwise,r=e.cy,i=t.eles,s=i.nodes().not(":parent"),a=il(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()}),o={x:a.x1+a.w/2,y:a.y1+a.h/2},l=[],u=0,c=0;c<s.length;c++){var f=s[c],h=void 0;h=t.concentric(f),l.push({value:h,node:f}),f._private.scratch.concentric=h}s.updateStyle();for(var d=0;d<s.length;d++){var p=s[d],g=p.layoutDimensions(t);u=Math.max(u,g.w,g.h)}l.sort(function(X,se){return se.value-X.value});for(var m=t.levelWidth(s),v=[[]],y=v[0],b=0;b<l.length;b++){var x=l[b];if(y.length>0){var w=Math.abs(y[0].value-x.value);w>=m&&(y=[],v.push(y))}y.push(x)}var C=u+t.minNodeSpacing;if(!t.avoidOverlap){var $=v.length>0&&v[0].length>1,_=Math.min(a.w,a.h)/2-C,k=_/(v.length+$?1:0);C=Math.min(C,k)}for(var E=0,S=0;S<v.length;S++){var N=v[S],A=t.sweep===void 0?2*Math.PI-2*Math.PI/N.length:t.sweep,D=N.dTheta=A/Math.max(1,N.length-1);if(N.length>1&&t.avoidOverlap){var T=Math.cos(D)-Math.cos(0),I=Math.sin(D)-Math.sin(0),F=Math.sqrt(C*C/(T*T+I*I));E=Math.max(F,E)}N.r=E,E+=C}if(t.equidistant){for(var R=0,P=0,V=0;V<v.length;V++){var z=v[V],q=z.r-P;R=Math.max(R,q)}P=0;for(var G=0;G<v.length;G++){var K=v[G];G===0&&(P=K.r),K.r=P,P+=R}}for(var Y={},te=0;te<v.length;te++)for(var Z=v[te],ae=Z.dTheta,O=Z.r,L=0;L<Z.length;L++){var W=Z[L],M=t.startAngle+(n?1:-1)*ae*L,ue={x:o.x+O*Math.cos(M),y:o.y+O*Math.sin(M)};Y[W.node.id()]=ue}return i.nodes().layoutPositions(this,t,function(X){var se=X.id();return Y[se]}),this};var sj,Rot={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(t,n){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(t){return 2048},nodeOverlap:4,idealEdgeLength:function(t){return 32},edgeElasticity:function(t){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function kB(e){this.options=gt({},Rot,e),this.options.layout=this}kB.prototype.run=function(){var e=this.options,t=e.cy,n=this;n.stopped=!1,(e.animate===!0||e.animate===!1)&&n.emit({type:"layoutstart",layout:n}),e.debug===!0?sj=!0:sj=!1;var r=Pot(t,n,e);sj&&zot(r),e.randomize&&Uot(r);var i=Ap(),s=function(){Wot(r,t,e),e.fit===!0&&t.fit(e.padding)},a=function(h){return!(n.stopped||h>=e.numIter||(Vot(r,e),r.temperature=r.temperature*e.coolingFactor,r.temperature<e.minTemp))},o=function(){if(e.animate===!0||e.animate===!1)s(),n.one("layoutstop",e.stop),n.emit({type:"layoutstop",layout:n});else{var h=e.eles.nodes(),d=MEe(r,e,h);h.layoutPositions(n,e,d)}},l=0,u=!0;if(e.animate===!0){var c=function f(){for(var h=0;u&&h<e.refresh;)u=a(l),l++,h++;if(!u)qpe(r,e),o();else{var d=Ap();d-i>=e.animationThreshold&&s(),h5(f)}};c()}else{for(;u;)u=a(l),l++;qpe(r,e),o()}return this};kB.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};kB.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var Pot=function(t,n,r){for(var i=r.eles.edges(),s=r.eles.nodes(),a=il(r.boundingBox?r.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),o={isCompound:t.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:s.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:i.size(),temperature:r.initialTemp,clientWidth:a.w,clientHeight:a.h,boundingBox:a},l=r.eles.components(),u={},c=0;c<l.length;c++)for(var f=l[c],h=0;h<f.length;h++){var d=f[h];u[d.id()]=c}for(var c=0;c<o.nodeSize;c++){var p=s[c],g=p.layoutDimensions(r),m={};m.isLocked=p.locked(),m.id=p.data("id"),m.parentId=p.data("parent"),m.cmptId=u[p.id()],m.children=[],m.positionX=p.position("x"),m.positionY=p.position("y"),m.offsetX=0,m.offsetY=0,m.height=g.w,m.width=g.h,m.maxX=m.positionX+m.width/2,m.minX=m.positionX-m.width/2,m.maxY=m.positionY+m.height/2,m.minY=m.positionY-m.height/2,m.padLeft=parseFloat(p.style("padding")),m.padRight=parseFloat(p.style("padding")),m.padTop=parseFloat(p.style("padding")),m.padBottom=parseFloat(p.style("padding")),m.nodeRepulsion=zr(r.nodeRepulsion)?r.nodeRepulsion(p):r.nodeRepulsion,o.layoutNodes.push(m),o.idToIndex[m.id]=c}for(var v=[],y=0,b=-1,x=[],c=0;c<o.nodeSize;c++){var p=o.layoutNodes[c],w=p.parentId;w!=null?o.layoutNodes[o.idToIndex[w]].children.push(p.id):(v[++b]=p.id,x.push(p.id))}for(o.graphSet.push(x);y<=b;){var C=v[y++],$=o.idToIndex[C],d=o.layoutNodes[$],_=d.children;if(_.length>0){o.graphSet.push(_);for(var c=0;c<_.length;c++)v[++b]=_[c]}}for(var c=0;c<o.graphSet.length;c++)for(var k=o.graphSet[c],h=0;h<k.length;h++){var E=o.idToIndex[k[h]];o.indexToGraph[E]=c}for(var c=0;c<o.edgeSize;c++){var S=i[c],N={};N.id=S.data("id"),N.sourceId=S.data("source"),N.targetId=S.data("target");var A=zr(r.idealEdgeLength)?r.idealEdgeLength(S):r.idealEdgeLength,D=zr(r.edgeElasticity)?r.edgeElasticity(S):r.edgeElasticity,T=o.idToIndex[N.sourceId],I=o.idToIndex[N.targetId],F=o.indexToGraph[T],R=o.indexToGraph[I];if(F!=R){for(var P=Lot(N.sourceId,N.targetId,o),V=o.graphSet[P],z=0,m=o.layoutNodes[T];V.indexOf(m.id)===-1;)m=o.layoutNodes[o.idToIndex[m.parentId]],z++;for(m=o.layoutNodes[I];V.indexOf(m.id)===-1;)m=o.layoutNodes[o.idToIndex[m.parentId]],z++;A*=z*r.nestingFactor}N.idealLength=A,N.elasticity=D,o.layoutEdges.push(N)}return o},Lot=function(t,n,r){var i=Bot(t,n,0,r);return 2>i.count?0:i.graph},Bot=function e(t,n,r,i){var s=i.graphSet[r];if(-1<s.indexOf(t)&&-1<s.indexOf(n))return{count:2,graph:r};for(var a=0,o=0;o<s.length;o++){var l=s[o],u=i.idToIndex[l],c=i.layoutNodes[u].children;if(c.length!==0){var f=i.indexToGraph[i.idToIndex[c[0]]],h=e(t,n,f,i);if(h.count!==0)if(h.count===1){if(a++,a===2)break}else return h}}return{count:a,graph:r}},zot,Uot=function(t,n){for(var r=t.clientWidth,i=t.clientHeight,s=0;s<t.nodeSize;s++){var a=t.layoutNodes[s];a.children.length===0&&!a.isLocked&&(a.positionX=Math.random()*r,a.positionY=Math.random()*i)}},MEe=function(t,n,r){var i=t.boundingBox,s={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return n.boundingBox&&(r.forEach(function(a){var o=t.layoutNodes[t.idToIndex[a.data("id")]];s.x1=Math.min(s.x1,o.positionX),s.x2=Math.max(s.x2,o.positionX),s.y1=Math.min(s.y1,o.positionY),s.y2=Math.max(s.y2,o.positionY)}),s.w=s.x2-s.x1,s.h=s.y2-s.y1),function(a,o){var l=t.layoutNodes[t.idToIndex[a.data("id")]];if(n.boundingBox){var u=(l.positionX-s.x1)/s.w,c=(l.positionY-s.y1)/s.h;return{x:i.x1+u*i.w,y:i.y1+c*i.h}}else return{x:l.positionX,y:l.positionY}}},Wot=function(t,n,r){var i=r.layout,s=r.eles.nodes(),a=MEe(t,r,s);s.positions(a),t.ready!==!0&&(t.ready=!0,i.one("layoutready",r.ready),i.emit({type:"layoutready",layout:this}))},Vot=function(t,n,r){jot(t,n),Got(t),Yot(t,n),Xot(t),Kot(t)},jot=function(t,n){for(var r=0;r<t.graphSet.length;r++)for(var i=t.graphSet[r],s=i.length,a=0;a<s;a++)for(var o=t.layoutNodes[t.idToIndex[i[a]]],l=a+1;l<s;l++){var u=t.layoutNodes[t.idToIndex[i[l]]];Hot(o,u,t,n)}},Hpe=function(t){return-t+2*t*Math.random()},Hot=function(t,n,r,i){var s=t.cmptId,a=n.cmptId;if(!(s!==a&&!r.isCompound)){var o=n.positionX-t.positionX,l=n.positionY-t.positionY,u=1;o===0&&l===0&&(o=Hpe(u),l=Hpe(u));var c=qot(t,n,o,l);if(c>0)var f=i.nodeOverlap*c,h=Math.sqrt(o*o+l*l),d=f*o/h,p=f*l/h;else var g=v5(t,o,l),m=v5(n,-1*o,-1*l),v=m.x-g.x,y=m.y-g.y,b=v*v+y*y,h=Math.sqrt(b),f=(t.nodeRepulsion+n.nodeRepulsion)/b,d=f*v/h,p=f*y/h;t.isLocked||(t.offsetX-=d,t.offsetY-=p),n.isLocked||(n.offsetX+=d,n.offsetY+=p)}},qot=function(t,n,r,i){if(r>0)var s=t.maxX-n.minX;else var s=n.maxX-t.minX;if(i>0)var a=t.maxY-n.minY;else var a=n.maxY-t.minY;return s>=0&&a>=0?Math.sqrt(s*s+a*a):0},v5=function(t,n,r){var i=t.positionX,s=t.positionY,a=t.height||1,o=t.width||1,l=r/n,u=a/o,c={};return n===0&&0<r||n===0&&0>r?(c.x=i,c.y=s+a/2,c):0<n&&-1*u<=l&&l<=u?(c.x=i+o/2,c.y=s+o*r/2/n,c):0>n&&-1*u<=l&&l<=u?(c.x=i-o/2,c.y=s-o*r/2/n,c):0<r&&(l<=-1*u||l>=u)?(c.x=i+a*n/2/r,c.y=s+a/2,c):(0>r&&(l<=-1*u||l>=u)&&(c.x=i-a*n/2/r,c.y=s-a/2),c)},Got=function(t,n){for(var r=0;r<t.edgeSize;r++){var i=t.layoutEdges[r],s=t.idToIndex[i.sourceId],a=t.layoutNodes[s],o=t.idToIndex[i.targetId],l=t.layoutNodes[o],u=l.positionX-a.positionX,c=l.positionY-a.positionY;if(!(u===0&&c===0)){var f=v5(a,u,c),h=v5(l,-1*u,-1*c),d=h.x-f.x,p=h.y-f.y,g=Math.sqrt(d*d+p*p),m=Math.pow(i.idealLength-g,2)/i.elasticity;if(g!==0)var v=m*d/g,y=m*p/g;else var v=0,y=0;a.isLocked||(a.offsetX+=v,a.offsetY+=y),l.isLocked||(l.offsetX-=v,l.offsetY-=y)}}},Yot=function(t,n){if(n.gravity!==0)for(var r=1,i=0;i<t.graphSet.length;i++){var s=t.graphSet[i],a=s.length;if(i===0)var o=t.clientHeight/2,l=t.clientWidth/2;else var u=t.layoutNodes[t.idToIndex[s[0]]],c=t.layoutNodes[t.idToIndex[u.parentId]],o=c.positionX,l=c.positionY;for(var f=0;f<a;f++){var h=t.layoutNodes[t.idToIndex[s[f]]];if(!h.isLocked){var d=o-h.positionX,p=l-h.positionY,g=Math.sqrt(d*d+p*p);if(g>r){var m=n.gravity*d/g,v=n.gravity*p/g;h.offsetX+=m,h.offsetY+=v}}}}},Xot=function(t,n){var r=[],i=0,s=-1;for(r.push.apply(r,t.graphSet[0]),s+=t.graphSet[0].length;i<=s;){var a=r[i++],o=t.idToIndex[a],l=t.layoutNodes[o],u=l.children;if(0<u.length&&!l.isLocked){for(var c=l.offsetX,f=l.offsetY,h=0;h<u.length;h++){var d=t.layoutNodes[t.idToIndex[u[h]]];d.offsetX+=c,d.offsetY+=f,r[++s]=u[h]}l.offsetX=0,l.offsetY=0}}},Kot=function(t,n){for(var r=0;r<t.nodeSize;r++){var i=t.layoutNodes[r];0<i.children.length&&(i.maxX=void 0,i.minX=void 0,i.maxY=void 0,i.minY=void 0)}for(var r=0;r<t.nodeSize;r++){var i=t.layoutNodes[r];if(!(0<i.children.length||i.isLocked)){var s=Zot(i.offsetX,i.offsetY,t.temperature);i.positionX+=s.x,i.positionY+=s.y,i.offsetX=0,i.offsetY=0,i.minX=i.positionX-i.width,i.maxX=i.positionX+i.width,i.minY=i.positionY-i.height,i.maxY=i.positionY+i.height,Qot(i,t)}}for(var r=0;r<t.nodeSize;r++){var i=t.layoutNodes[r];0<i.children.length&&!i.isLocked&&(i.positionX=(i.maxX+i.minX)/2,i.positionY=(i.maxY+i.minY)/2,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY)}},Zot=function(t,n,r){var i=Math.sqrt(t*t+n*n);if(i>r)var s={x:r*t/i,y:r*n/i};else var s={x:t,y:n};return s},Qot=function e(t,n){var r=t.parentId;if(r!=null){var i=n.layoutNodes[n.idToIndex[r]],s=!1;if((i.maxX==null||t.maxX+i.padRight>i.maxX)&&(i.maxX=t.maxX+i.padRight,s=!0),(i.minX==null||t.minX-i.padLeft<i.minX)&&(i.minX=t.minX-i.padLeft,s=!0),(i.maxY==null||t.maxY+i.padBottom>i.maxY)&&(i.maxY=t.maxY+i.padBottom,s=!0),(i.minY==null||t.minY-i.padTop<i.minY)&&(i.minY=t.minY-i.padTop,s=!0),s)return e(i,n)}},qpe=function(t,n){for(var r=t.layoutNodes,i=[],s=0;s<r.length;s++){var a=r[s],o=a.cmptId,l=i[o]=i[o]||[];l.push(a)}for(var u=0,s=0;s<i.length;s++){var c=i[s];if(!!c){c.x1=1/0,c.x2=-1/0,c.y1=1/0,c.y2=-1/0;for(var f=0;f<c.length;f++){var h=c[f];c.x1=Math.min(c.x1,h.positionX-h.width/2),c.x2=Math.max(c.x2,h.positionX+h.width/2),c.y1=Math.min(c.y1,h.positionY-h.height/2),c.y2=Math.max(c.y2,h.positionY+h.height/2)}c.w=c.x2-c.x1,c.h=c.y2-c.y1,u+=c.w*c.h}}i.sort(function(y,b){return b.w*b.h-y.w*y.h});for(var d=0,p=0,g=0,m=0,v=Math.sqrt(u)*t.clientWidth/t.clientHeight,s=0;s<i.length;s++){var c=i[s];if(!!c){for(var f=0;f<c.length;f++){var h=c[f];h.isLocked||(h.positionX+=d-c.x1,h.positionY+=p-c.y1)}d+=c.w+n.componentSpacing,g+=c.w+n.componentSpacing,m=Math.max(m,c.h),g>v&&(p+=m+n.componentSpacing,d=0,g=0,m=0)}}},Jot={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(t){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,n){return!0},ready:void 0,stop:void 0,transform:function(t,n){return n}};function FEe(e){this.options=gt({},Jot,e)}FEe.prototype.run=function(){var e=this.options,t=e,n=e.cy,r=t.eles,i=r.nodes().not(":parent");t.sort&&(i=i.sort(t.sort));var s=il(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()});if(s.h===0||s.w===0)r.nodes().layoutPositions(this,t,function(G){return{x:s.x1,y:s.y1}});else{var a=i.size(),o=Math.sqrt(a*s.h/s.w),l=Math.round(o),u=Math.round(s.w/s.h*o),c=function(K){if(K==null)return Math.min(l,u);var Y=Math.min(l,u);Y==l?l=K:u=K},f=function(K){if(K==null)return Math.max(l,u);var Y=Math.max(l,u);Y==l?l=K:u=K},h=t.rows,d=t.cols!=null?t.cols:t.columns;if(h!=null&&d!=null)l=h,u=d;else if(h!=null&&d==null)l=h,u=Math.ceil(a/l);else if(h==null&&d!=null)u=d,l=Math.ceil(a/u);else if(u*l>a){var p=c(),g=f();(p-1)*g>=a?c(p-1):(g-1)*p>=a&&f(g-1)}else for(;u*l<a;){var m=c(),v=f();(v+1)*m>=a?f(v+1):c(m+1)}var y=s.w/u,b=s.h/l;if(t.condense&&(y=0,b=0),t.avoidOverlap)for(var x=0;x<i.length;x++){var w=i[x],C=w._private.position;(C.x==null||C.y==null)&&(C.x=0,C.y=0);var $=w.layoutDimensions(t),_=t.avoidOverlapPadding,k=$.w+_,E=$.h+_;y=Math.max(y,k),b=Math.max(b,E)}for(var S={},N=function(K,Y){return!!S["c-"+K+"-"+Y]},A=function(K,Y){S["c-"+K+"-"+Y]=!0},D=0,T=0,I=function(){T++,T>=u&&(T=0,D++)},F={},R=0;R<i.length;R++){var P=i[R],V=t.position(P);if(V&&(V.row!==void 0||V.col!==void 0)){var z={row:V.row,col:V.col};if(z.col===void 0)for(z.col=0;N(z.row,z.col);)z.col++;else if(z.row===void 0)for(z.row=0;N(z.row,z.col);)z.row++;F[P.id()]=z,A(z.row,z.col)}}var q=function(K,Y){var te,Z;if(K.locked()||K.isParent())return!1;var ae=F[K.id()];if(ae)te=ae.col*y+y/2+s.x1,Z=ae.row*b+b/2+s.y1;else{for(;N(D,T);)I();te=T*y+y/2+s.x1,Z=D*b+b/2+s.y1,A(D,T),I()}return{x:te,y:Z}};i.layoutPositions(this,t,q)}return this};var elt={ready:function(){},stop:function(){}};function qee(e){this.options=gt({},elt,e)}qee.prototype.run=function(){var e=this.options,t=e.eles,n=this;return e.cy,n.emit("layoutstart"),t.nodes().positions(function(){return{x:0,y:0}}),n.one("layoutready",e.ready),n.emit("layoutready"),n.one("layoutstop",e.stop),n.emit("layoutstop"),this};qee.prototype.stop=function(){return this};var tlt={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,n){return!0},ready:void 0,stop:void 0,transform:function(t,n){return n}};function OEe(e){this.options=gt({},tlt,e)}OEe.prototype.run=function(){var e=this.options,t=e.eles,n=t.nodes(),r=zr(e.positions);function i(s){if(e.positions==null)return dst(s.position());if(r)return e.positions(s);var a=e.positions[s._private.data.id];return a==null?null:a}return n.layoutPositions(this,e,function(s,a){var o=i(s);return s.locked()||o==null?!1:o}),this};var nlt={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,n){return!0},ready:void 0,stop:void 0,transform:function(t,n){return n}};function REe(e){this.options=gt({},nlt,e)}REe.prototype.run=function(){var e=this.options,t=e.cy,n=e.eles,r=il(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),i=function(a,o){return{x:r.x1+Math.round(Math.random()*r.w),y:r.y1+Math.round(Math.random()*r.h)}};return n.nodes().layoutPositions(this,e,i),this};var rlt=[{name:"breadthfirst",impl:DEe},{name:"circle",impl:NEe},{name:"concentric",impl:IEe},{name:"cose",impl:kB},{name:"grid",impl:FEe},{name:"null",impl:qee},{name:"preset",impl:OEe},{name:"random",impl:REe}];function PEe(e){this.options=e,this.notifications=0}var Gpe=function(){},Ype=function(){throw new Error("A headless instance can not render images")};PEe.prototype={recalculateRenderedStyle:Gpe,notify:function(){this.notifications++},init:Gpe,isHeadless:function(){return!0},png:Ype,jpg:Ype};var Gee={};Gee.arrowShapeWidth=.3;Gee.registerArrowShapes=function(){var e=this.arrowShapes={},t=this,n=function(u,c,f,h,d,p,g){var m=d.x-f/2-g,v=d.x+f/2+g,y=d.y-f/2-g,b=d.y+f/2+g,x=m<=u&&u<=v&&y<=c&&c<=b;return x},r=function(u,c,f,h,d){var p=u*Math.cos(h)-c*Math.sin(h),g=u*Math.sin(h)+c*Math.cos(h),m=p*f,v=g*f,y=m+d.x,b=v+d.y;return{x:y,y:b}},i=function(u,c,f,h){for(var d=[],p=0;p<u.length;p+=2){var g=u[p],m=u[p+1];d.push(r(g,m,c,f,h))}return d},s=function(u){for(var c=[],f=0;f<u.length;f++){var h=u[f];c.push(h.x,h.y)}return c},a=function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").pfValue*2},o=function(u,c){rt(c)&&(c=e[c]),e[u]=gt({name:u,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(h,d,p,g,m,v){var y=s(i(this.points,p+2*v,g,m)),b=Bo(h,d,y);return b},roughCollide:n,draw:function(h,d,p,g){var m=i(this.points,d,p,g);t.arrowShapeImpl("polygon")(h,m)},spacing:function(h){return 0},gap:a},c)};o("none",{collide:d5,roughCollide:d5,draw:Oee,spacing:upe,gap:upe}),o("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),o("arrow","triangle"),o("triangle-backcurve",{points:e.triangle.points,controlPoint:[0,-.15],roughCollide:n,draw:function(u,c,f,h,d){var p=i(this.points,c,f,h),g=this.controlPoint,m=r(g[0],g[1],c,f,h);t.arrowShapeImpl(this.name)(u,p,m)},gap:function(u){return a(u)*.8}}),o("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(u,c,f,h,d,p,g){var m=s(i(this.points,f+2*g,h,d)),v=s(i(this.pointsTee,f+2*g,h,d)),y=Bo(u,c,m)||Bo(u,c,v);return y},draw:function(u,c,f,h,d){var p=i(this.points,c,f,h),g=i(this.pointsTee,c,f,h);t.arrowShapeImpl(this.name)(u,p,g)}}),o("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(u,c,f,h,d,p,g){var m=d,v=Math.pow(m.x-u,2)+Math.pow(m.y-c,2)<=Math.pow((f+2*g)*this.radius,2),y=s(i(this.points,f+2*g,h,d));return Bo(u,c,y)||v},draw:function(u,c,f,h,d){var p=i(this.pointsTr,c,f,h);t.arrowShapeImpl(this.name)(u,p,h.x,h.y,this.radius*c)},spacing:function(u){return t.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),o("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(u,c){var f=this.baseCrossLinePts.slice(),h=c/u,d=3,p=5;return f[d]=f[d]-h,f[p]=f[p]-h,f},collide:function(u,c,f,h,d,p,g){var m=s(i(this.points,f+2*g,h,d)),v=s(i(this.crossLinePts(f,p),f+2*g,h,d)),y=Bo(u,c,m)||Bo(u,c,v);return y},draw:function(u,c,f,h,d){var p=i(this.points,c,f,h),g=i(this.crossLinePts(c,d),c,f,h);t.arrowShapeImpl(this.name)(u,p,g)}}),o("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(u){return a(u)*.525}}),o("circle",{radius:.15,collide:function(u,c,f,h,d,p,g){var m=d,v=Math.pow(m.x-u,2)+Math.pow(m.y-c,2)<=Math.pow((f+2*g)*this.radius,2);return v},draw:function(u,c,f,h,d){t.arrowShapeImpl(this.name)(u,h.x,h.y,this.radius*c)},spacing:function(u){return t.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),o("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(u){return 1},gap:function(u){return 1}}),o("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),o("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}}),o("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(u){return .95*u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}})};var Rb={};Rb.projectIntoViewport=function(e,t){var n=this.cy,r=this.findContainerClientCoords(),i=r[0],s=r[1],a=r[4],o=n.pan(),l=n.zoom(),u=((e-i)/a-o.x)/l,c=((t-s)/a-o.y)/l;return[u,c]};Rb.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var e=this.container,t=e.getBoundingClientRect(),n=Er.getComputedStyle(e),r=function(v){return parseFloat(n.getPropertyValue(v))},i={left:r("padding-left"),right:r("padding-right"),top:r("padding-top"),bottom:r("padding-bottom")},s={left:r("border-left-width"),right:r("border-right-width"),top:r("border-top-width"),bottom:r("border-bottom-width")},a=e.clientWidth,o=e.clientHeight,l=i.left+i.right,u=i.top+i.bottom,c=s.left+s.right,f=t.width/(a+c),h=a-l,d=o-u,p=t.left+i.left+s.left,g=t.top+i.top+s.top;return this.containerBB=[p,g,h,d,f]};Rb.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Rb.findNearestElement=function(e,t,n,r){return this.findNearestElements(e,t,n,r)[0]};Rb.findNearestElements=function(e,t,n,r){var i=this,s=this,a=s.getCachedZSortedEles(),o=[],l=s.cy.zoom(),u=s.cy.hasCompoundNodes(),c=(r?24:8)/l,f=(r?8:2)/l,h=(r?8:2)/l,d=1/0,p,g;n&&(a=a.interactive);function m($,_){if($.isNode()){if(g)return;g=$,o.push($)}if($.isEdge()&&(_==null||_<d))if(p){if(p.pstyle("z-compound-depth").value===$.pstyle("z-compound-depth").value&&p.pstyle("z-compound-depth").value===$.pstyle("z-compound-depth").value){for(var k=0;k<o.length;k++)if(o[k].isEdge()){o[k]=$,p=$,d=_!=null?_:d;break}}}else o.push($),p=$,d=_!=null?_:d}function v($){var _=$.outerWidth()+2*f,k=$.outerHeight()+2*f,E=_/2,S=k/2,N=$.position();if(N.x-E<=e&&e<=N.x+E&&N.y-S<=t&&t<=N.y+S){var A=s.nodeShapes[i.getNodeShape($)];if(A.checkPoint(e,t,0,_,k,N.x,N.y))return m($,0),!0}}function y($){var _=$._private,k=_.rscratch,E=$.pstyle("width").pfValue,S=$.pstyle("arrow-scale").value,N=E/2+c,A=N*N,D=N*2,R=_.source,P=_.target,T;if(k.edgeType==="segments"||k.edgeType==="straight"||k.edgeType==="haystack"){for(var I=k.allpts,F=0;F+3<I.length;F+=2)if(kst(e,t,I[F],I[F+1],I[F+2],I[F+3],D)&&A>(T=Nst(e,t,I[F],I[F+1],I[F+2],I[F+3])))return m($,T),!0}else if(k.edgeType==="bezier"||k.edgeType==="multibezier"||k.edgeType==="self"||k.edgeType==="compound"){for(var I=k.allpts,F=0;F+5<k.allpts.length;F+=4)if(Est(e,t,I[F],I[F+1],I[F+2],I[F+3],I[F+4],I[F+5],D)&&A>(T=Dst(e,t,I[F],I[F+1],I[F+2],I[F+3],I[F+4],I[F+5])))return m($,T),!0}for(var R=R||_.source,P=P||_.target,V=i.getArrowWidth(E,S),z=[{name:"source",x:k.arrowStartX,y:k.arrowStartY,angle:k.srcArrowAngle},{name:"target",x:k.arrowEndX,y:k.arrowEndY,angle:k.tgtArrowAngle},{name:"mid-source",x:k.midX,y:k.midY,angle:k.midsrcArrowAngle},{name:"mid-target",x:k.midX,y:k.midY,angle:k.midtgtArrowAngle}],F=0;F<z.length;F++){var q=z[F],G=s.arrowShapes[$.pstyle(q.name+"-arrow-shape").value],K=$.pstyle("width").pfValue;if(G.roughCollide(e,t,V,q.angle,{x:q.x,y:q.y},K,c)&&G.collide(e,t,V,q.angle,{x:q.x,y:q.y},K,c))return m($),!0}u&&o.length>0&&(v(R),v(P))}function b($,_,k){return vc($,_,k)}function x($,_){var k=$._private,E=h,S;_?S=_+"-":S="",$.boundingBox();var N=k.labelBounds[_||"main"],A=$.pstyle(S+"label").value,D=$.pstyle("text-events").strValue==="yes";if(!(!D||!A)){var T=b(k.rscratch,"labelX",_),I=b(k.rscratch,"labelY",_),F=b(k.rscratch,"labelAngle",_),R=$.pstyle(S+"text-margin-x").pfValue,P=$.pstyle(S+"text-margin-y").pfValue,V=N.x1-E-R,z=N.x2+E-R,q=N.y1-E-P,G=N.y2+E-P;if(F){var K=Math.cos(F),Y=Math.sin(F),te=function(ue,X){return ue=ue-T,X=X-I,{x:ue*K-X*Y+T,y:ue*Y+X*K+I}},Z=te(V,q),ae=te(V,G),O=te(z,q),L=te(z,G),W=[Z.x+R,Z.y+P,O.x+R,O.y+P,L.x+R,L.y+P,ae.x+R,ae.y+P];if(Bo(e,t,W))return m($),!0}else if(Ew(N,e,t))return m($),!0}}for(var w=a.length-1;w>=0;w--){var C=a[w];C.isNode()?v(C)||x(C):y(C)||x(C)||x(C,"source")||x(C,"target")}return o};Rb.getAllInBox=function(e,t,n,r){var i=this.getCachedZSortedEles().interactive,s=[],a=Math.min(e,n),o=Math.max(e,n),l=Math.min(t,r),u=Math.max(t,r);e=a,n=o,t=l,r=u;for(var c=il({x1:e,y1:t,x2:n,y2:r}),f=0;f<i.length;f++){var h=i[f];if(h.isNode()){var d=h,p=d.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});Lee(c,p)&&!Zke(p,c)&&s.push(d)}else{var g=h,m=g._private,v=m.rscratch;if(v.startX!=null&&v.startY!=null&&!Ew(c,v.startX,v.startY)||v.endX!=null&&v.endY!=null&&!Ew(c,v.endX,v.endY))continue;if(v.edgeType==="bezier"||v.edgeType==="multibezier"||v.edgeType==="self"||v.edgeType==="compound"||v.edgeType==="segments"||v.edgeType==="haystack"){for(var y=m.rstyle.bezierPts||m.rstyle.linePts||m.rstyle.haystackPts,b=!0,x=0;x<y.length;x++)if(!Sst(c,y[x])){b=!1;break}b&&s.push(g)}else(v.edgeType==="haystack"||v.edgeType==="straight")&&s.push(g)}}return s};var y5={};y5.calculateArrowAngles=function(e){var t=e._private.rscratch,n=t.edgeType==="haystack",r=t.edgeType==="bezier",i=t.edgeType==="multibezier",s=t.edgeType==="segments",a=t.edgeType==="compound",o=t.edgeType==="self",l,u,c,f,h,d,v,y;if(n?(c=t.haystackPts[0],f=t.haystackPts[1],h=t.haystackPts[2],d=t.haystackPts[3]):(c=t.arrowStartX,f=t.arrowStartY,h=t.arrowEndX,d=t.arrowEndY),v=t.midX,y=t.midY,s)l=c-t.segpts[0],u=f-t.segpts[1];else if(i||a||o||r){var p=t.allpts,g=Xi(p[0],p[2],p[4],.1),m=Xi(p[1],p[3],p[5],.1);l=c-g,u=f-m}else l=c-v,u=f-y;t.srcArrowAngle=GF(l,u);var v=t.midX,y=t.midY;if(n&&(v=(c+h)/2,y=(f+d)/2),l=h-c,u=d-f,s){var p=t.allpts;if(p.length/2%2===0){var b=p.length/2,x=b-2;l=p[b]-p[x],u=p[b+1]-p[x+1]}else{var b=p.length/2-1,x=b-2,w=b+2;l=p[b]-p[x],u=p[b+1]-p[x+1]}}else if(i||a||o){var p=t.allpts,C=t.ctrlpts,$,_,k,E;if(C.length/2%2===0){var S=p.length/2-1,N=S+2,A=N+2;$=Xi(p[S],p[N],p[A],0),_=Xi(p[S+1],p[N+1],p[A+1],0),k=Xi(p[S],p[N],p[A],1e-4),E=Xi(p[S+1],p[N+1],p[A+1],1e-4)}else{var N=p.length/2-1,S=N-2,A=N+2;$=Xi(p[S],p[N],p[A],.4999),_=Xi(p[S+1],p[N+1],p[A+1],.4999),k=Xi(p[S],p[N],p[A],.5),E=Xi(p[S+1],p[N+1],p[A+1],.5)}l=k-$,u=E-_}if(t.midtgtArrowAngle=GF(l,u),t.midDispX=l,t.midDispY=u,l*=-1,u*=-1,s){var p=t.allpts;if(p.length/2%2!==0){var b=p.length/2-1,w=b+2;l=-(p[w]-p[b]),u=-(p[w+1]-p[b+1])}}if(t.midsrcArrowAngle=GF(l,u),s)l=h-t.segpts[t.segpts.length-2],u=d-t.segpts[t.segpts.length-1];else if(i||a||o||r){var p=t.allpts,D=p.length,g=Xi(p[D-6],p[D-4],p[D-2],.9),m=Xi(p[D-5],p[D-3],p[D-1],.9);l=h-g,u=d-m}else l=h-v,u=d-y;t.tgtArrowAngle=GF(l,u)};y5.getArrowWidth=y5.getArrowHeight=function(e,t){var n=this.arrowWidthCache=this.arrowWidthCache||{},r=n[e+", "+t];return r||(r=Math.max(Math.pow(e*13.37,.9),29)*t,n[e+", "+t]=r,r)};var So={};So.findHaystackPoints=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=n._private,i=r.rscratch;if(!i.haystack){var s=Math.random()*2*Math.PI;i.source={x:Math.cos(s),y:Math.sin(s)},s=Math.random()*2*Math.PI,i.target={x:Math.cos(s),y:Math.sin(s)}}var a=r.source,o=r.target,l=a.position(),u=o.position(),c=a.width(),f=o.width(),h=a.height(),d=o.height(),p=n.pstyle("haystack-radius").value,g=p/2;i.haystackPts=i.allpts=[i.source.x*c*g+l.x,i.source.y*h*g+l.y,i.target.x*f*g+u.x,i.target.y*d*g+u.y],i.midX=(i.allpts[0]+i.allpts[2])/2,i.midY=(i.allpts[1]+i.allpts[3])/2,i.edgeType="haystack",i.haystack=!0,this.storeEdgeProjections(n),this.calculateArrowAngles(n),this.recalculateEdgeLabelProjections(n),this.calculateLabelAngles(n)}};So.findSegmentsPoints=function(e,t){var n=e._private.rscratch,r=t.posPts,i=t.intersectionPts,s=t.vectorNormInverse,a=e.pstyle("edge-distances").value,o=e.pstyle("segment-weights"),l=e.pstyle("segment-distances"),u=Math.min(o.pfValue.length,l.pfValue.length);n.edgeType="segments",n.segpts=[];for(var c=0;c<u;c++){var f=o.pfValue[c],h=l.pfValue[c],d=1-f,p=f,g=a==="node-position"?r:i,m={x:g.x1*d+g.x2*p,y:g.y1*d+g.y2*p};n.segpts.push(m.x+s.x*h,m.y+s.y*h)}};So.findLoopPoints=function(e,t,n,r){var i=e._private.rscratch,s=t.dirCounts,a=t.srcPos,o=e.pstyle("control-point-distances"),l=o?o.pfValue[0]:void 0,u=e.pstyle("loop-direction").pfValue,c=e.pstyle("loop-sweep").pfValue,f=e.pstyle("control-point-step-size").pfValue;i.edgeType="self";var h=n,d=f;r&&(h=0,d=l);var p=u-Math.PI/2,g=p-c/2,m=p+c/2,v=String(u+"_"+c);h=s[v]===void 0?s[v]=0:++s[v],i.ctrlpts=[a.x+Math.cos(g)*1.4*d*(h/3+1),a.y+Math.sin(g)*1.4*d*(h/3+1),a.x+Math.cos(m)*1.4*d*(h/3+1),a.y+Math.sin(m)*1.4*d*(h/3+1)]};So.findCompoundLoopPoints=function(e,t,n,r){var i=e._private.rscratch;i.edgeType="compound";var s=t.srcPos,a=t.tgtPos,o=t.srcW,l=t.srcH,u=t.tgtW,c=t.tgtH,f=e.pstyle("control-point-step-size").pfValue,h=e.pstyle("control-point-distances"),d=h?h.pfValue[0]:void 0,p=n,g=f;r&&(p=0,g=d);var m=50,v={x:s.x-o/2,y:s.y-l/2},y={x:a.x-u/2,y:a.y-c/2},b={x:Math.min(v.x,y.x),y:Math.min(v.y,y.y)},x=.5,w=Math.max(x,Math.log(o*.01)),C=Math.max(x,Math.log(u*.01));i.ctrlpts=[b.x,b.y-(1+Math.pow(m,1.12)/100)*g*(p/3+1)*w,b.x-(1+Math.pow(m,1.12)/100)*g*(p/3+1)*C,b.y]};So.findStraightEdgePoints=function(e){e._private.rscratch.edgeType="straight"};So.findBezierPoints=function(e,t,n,r,i){var s=e._private.rscratch,a=t.vectorNormInverse,o=t.posPts,l=t.intersectionPts,u=e.pstyle("edge-distances").value,c=e.pstyle("control-point-step-size").pfValue,f=e.pstyle("control-point-distances"),h=e.pstyle("control-point-weights"),d=f&&h?Math.min(f.value.length,h.value.length):1,p=f?f.pfValue[0]:void 0,g=h.value[0],m=r;s.edgeType=m?"multibezier":"bezier",s.ctrlpts=[];for(var v=0;v<d;v++){var y=(.5-t.eles.length/2+n)*c*(i?-1:1),b=void 0,x=Kke(y);m&&(p=f?f.pfValue[v]:c,g=h.value[v]),r?b=p:b=p!==void 0?x*p:void 0;var w=b!==void 0?b:y,C=1-g,$=g,_=u==="node-position"?o:l,k={x:_.x1*C+_.x2*$,y:_.y1*C+_.y2*$};s.ctrlpts.push(k.x+a.x*w,k.y+a.y*w)}};So.findTaxiPoints=function(e,t){var n=e._private.rscratch;n.edgeType="segments";var r="vertical",i="horizontal",s="leftward",a="rightward",o="downward",l="upward",u="auto",c=t.posPts,f=t.srcW,h=t.srcH,d=t.tgtW,p=t.tgtH,g=e.pstyle("edge-distances").value,m=g!=="node-position",v=e.pstyle("taxi-direction").value,y=v,b=e.pstyle("taxi-turn"),x=b.units==="%",w=b.pfValue,C=w<0,$=e.pstyle("taxi-turn-min-distance").pfValue,_=m?(f+d)/2:0,k=m?(h+p)/2:0,E=c.x2-c.x1,S=c.y2-c.y1,N=function(Ve,Kt){return Ve>0?Math.max(Ve-Kt,0):Math.min(Ve+Kt,0)},A=N(E,_),D=N(S,k),T=!1;y===u?v=Math.abs(A)>Math.abs(D)?i:r:y===l||y===o?(v=r,T=!0):(y===s||y===a)&&(v=i,T=!0);var I=v===r,F=I?D:A,R=I?S:E,P=Kke(R),V=!1;!(T&&(x||C))&&(y===o&&R<0||y===l&&R>0||y===s&&R>0||y===a&&R<0)&&(P*=-1,F=P*Math.abs(F),V=!0);var z;if(x){var q=w<0?1+w:w;z=q*F}else{var G=w<0?F:0;z=G+w*P}var K=function(Ve){return Math.abs(Ve)<$||Math.abs(Ve)>=Math.abs(F)},Y=K(z),te=K(Math.abs(F)-Math.abs(z)),Z=Y||te;if(Z&&!V)if(I){var ae=Math.abs(R)<=h/2,O=Math.abs(E)<=d/2;if(ae){var L=(c.x1+c.x2)/2,W=c.y1,M=c.y2;n.segpts=[L,W,L,M]}else if(O){var ue=(c.y1+c.y2)/2,X=c.x1,se=c.x2;n.segpts=[X,ue,se,ue]}else n.segpts=[c.x1,c.y2]}else{var oe=Math.abs(R)<=f/2,pe=Math.abs(S)<=p/2;if(oe){var Ce=(c.y1+c.y2)/2,Ue=c.x1,et=c.x2;n.segpts=[Ue,Ce,et,Ce]}else if(pe){var dt=(c.x1+c.x2)/2,He=c.y1,Se=c.y2;n.segpts=[dt,He,dt,Se]}else n.segpts=[c.x2,c.y1]}else if(I){var j=c.y1+z+(m?h/2*P:0),fe=c.x1,_e=c.x2;n.segpts=[fe,j,_e,j]}else{var ve=c.x1+z+(m?f/2*P:0),ye=c.y1,yt=c.y2;n.segpts=[ve,ye,ve,yt]}};So.tryToCorrectInvalidPoints=function(e,t){var n=e._private.rscratch;if(n.edgeType==="bezier"){var r=t.srcPos,i=t.tgtPos,s=t.srcW,a=t.srcH,o=t.tgtW,l=t.tgtH,u=t.srcShape,c=t.tgtShape,f=!Pe(n.startX)||!Pe(n.startY),h=!Pe(n.arrowStartX)||!Pe(n.arrowStartY),d=!Pe(n.endX)||!Pe(n.endY),p=!Pe(n.arrowEndX)||!Pe(n.arrowEndY),g=3,m=this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth,v=g*m,y=ky({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.startX,y:n.startY}),b=y<v,x=ky({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.endX,y:n.endY}),w=x<v,C=!1;if(f||h||b){C=!0;var $={x:n.ctrlpts[0]-r.x,y:n.ctrlpts[1]-r.y},_=Math.sqrt($.x*$.x+$.y*$.y),k={x:$.x/_,y:$.y/_},E=Math.max(s,a),S={x:n.ctrlpts[0]+k.x*2*E,y:n.ctrlpts[1]+k.y*2*E},N=u.intersectLine(r.x,r.y,s,a,S.x,S.y,0);b?(n.ctrlpts[0]=n.ctrlpts[0]+k.x*(v-y),n.ctrlpts[1]=n.ctrlpts[1]+k.y*(v-y)):(n.ctrlpts[0]=N[0]+k.x*v,n.ctrlpts[1]=N[1]+k.y*v)}if(d||p||w){C=!0;var A={x:n.ctrlpts[0]-i.x,y:n.ctrlpts[1]-i.y},D=Math.sqrt(A.x*A.x+A.y*A.y),T={x:A.x/D,y:A.y/D},I=Math.max(s,a),F={x:n.ctrlpts[0]+T.x*2*I,y:n.ctrlpts[1]+T.y*2*I},R=c.intersectLine(i.x,i.y,o,l,F.x,F.y,0);w?(n.ctrlpts[0]=n.ctrlpts[0]+T.x*(v-x),n.ctrlpts[1]=n.ctrlpts[1]+T.y*(v-x)):(n.ctrlpts[0]=R[0]+T.x*v,n.ctrlpts[1]=R[1]+T.y*v)}C&&this.findEndpoints(e)}};So.storeAllpts=function(e){var t=e._private.rscratch;if(t.edgeType==="multibezier"||t.edgeType==="bezier"||t.edgeType==="self"||t.edgeType==="compound"){t.allpts=[],t.allpts.push(t.startX,t.startY);for(var n=0;n+1<t.ctrlpts.length;n+=2)t.allpts.push(t.ctrlpts[n],t.ctrlpts[n+1]),n+3<t.ctrlpts.length&&t.allpts.push((t.ctrlpts[n]+t.ctrlpts[n+2])/2,(t.ctrlpts[n+1]+t.ctrlpts[n+3])/2);t.allpts.push(t.endX,t.endY);var r,i;t.ctrlpts.length/2%2===0?(r=t.allpts.length/2-1,t.midX=t.allpts[r],t.midY=t.allpts[r+1]):(r=t.allpts.length/2-3,i=.5,t.midX=Xi(t.allpts[r],t.allpts[r+2],t.allpts[r+4],i),t.midY=Xi(t.allpts[r+1],t.allpts[r+3],t.allpts[r+5],i))}else if(t.edgeType==="straight")t.allpts=[t.startX,t.startY,t.endX,t.endY],t.midX=(t.startX+t.endX+t.arrowStartX+t.arrowEndX)/4,t.midY=(t.startY+t.endY+t.arrowStartY+t.arrowEndY)/4;else if(t.edgeType==="segments")if(t.allpts=[],t.allpts.push(t.startX,t.startY),t.allpts.push.apply(t.allpts,t.segpts),t.allpts.push(t.endX,t.endY),t.segpts.length%4===0){var s=t.segpts.length/2,a=s-2;t.midX=(t.segpts[a]+t.segpts[s])/2,t.midY=(t.segpts[a+1]+t.segpts[s+1])/2}else{var o=t.segpts.length/2-1;t.midX=t.segpts[o],t.midY=t.segpts[o+1]}};So.checkForInvalidEdgeWarning=function(e){var t=e[0]._private.rscratch;t.nodesOverlap||Pe(t.startX)&&Pe(t.startY)&&Pe(t.endX)&&Pe(t.endY)?t.loggedErr=!1:t.loggedErr||(t.loggedErr=!0,Rn("Edge `"+e.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};So.findEdgeControlPoints=function(e){var t=this;if(!(!e||e.length===0)){for(var n=this,r=n.cy,i=r.hasCompoundNodes(),s={map:new Zf,get:function($){var _=this.map.get($[0]);return _!=null?_.get($[1]):null},set:function($,_){var k=this.map.get($[0]);k==null&&(k=new Zf,this.map.set($[0],k)),k.set($[1],_)}},a=[],o=[],l=0;l<e.length;l++){var u=e[l],c=u._private,f=u.pstyle("curve-style").value;if(!(u.removed()||!u.takesUpSpace())){if(f==="haystack"){o.push(u);continue}var h=f==="unbundled-bezier"||f==="segments"||f==="straight"||f==="straight-triangle"||f==="taxi",d=f==="unbundled-bezier"||f==="bezier",p=c.source,g=c.target,m=p.poolIndex(),v=g.poolIndex(),y=[m,v].sort(),b=s.get(y);b==null&&(b={eles:[]},s.set(y,b),a.push(y)),b.eles.push(u),h&&(b.hasUnbundled=!0),d&&(b.hasBezier=!0)}}for(var x=function($){var _=a[$],k=s.get(_),E=void 0;if(!k.hasUnbundled){var S=k.eles[0].parallelEdges().filter(function(Se){return Se.isBundledBezier()});Ree(k.eles),S.forEach(function(Se){return k.eles.push(Se)}),k.eles.sort(function(Se,j){return Se.poolIndex()-j.poolIndex()})}var N=k.eles[0],A=N.source(),D=N.target();if(A.poolIndex()>D.poolIndex()){var T=A;A=D,D=T}var I=k.srcPos=A.position(),F=k.tgtPos=D.position(),R=k.srcW=A.outerWidth(),P=k.srcH=A.outerHeight(),V=k.tgtW=D.outerWidth(),z=k.tgtH=D.outerHeight(),q=k.srcShape=n.nodeShapes[t.getNodeShape(A)],G=k.tgtShape=n.nodeShapes[t.getNodeShape(D)];k.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var K=0;K<k.eles.length;K++){var Y=k.eles[K],te=Y[0]._private.rscratch,Z=Y.pstyle("curve-style").value,ae=Z==="unbundled-bezier"||Z==="segments"||Z==="taxi",O=!A.same(Y.source());if(!k.calculatedIntersection&&A!==D&&(k.hasBezier||k.hasUnbundled)){k.calculatedIntersection=!0;var L=q.intersectLine(I.x,I.y,R,P,F.x,F.y,0),W=k.srcIntn=L,M=G.intersectLine(F.x,F.y,V,z,I.x,I.y,0),ue=k.tgtIntn=M,X=k.intersectionPts={x1:L[0],x2:M[0],y1:L[1],y2:M[1]},se=k.posPts={x1:I.x,x2:F.x,y1:I.y,y2:F.y},oe=M[1]-L[1],pe=M[0]-L[0],Ce=Math.sqrt(pe*pe+oe*oe),Ue=k.vector={x:pe,y:oe},et=k.vectorNorm={x:Ue.x/Ce,y:Ue.y/Ce},dt={x:-et.y,y:et.x};k.nodesOverlap=!Pe(Ce)||G.checkPoint(L[0],L[1],0,V,z,F.x,F.y)||q.checkPoint(M[0],M[1],0,R,P,I.x,I.y),k.vectorNormInverse=dt,E={nodesOverlap:k.nodesOverlap,dirCounts:k.dirCounts,calculatedIntersection:!0,hasBezier:k.hasBezier,hasUnbundled:k.hasUnbundled,eles:k.eles,srcPos:F,tgtPos:I,srcW:V,srcH:z,tgtW:R,tgtH:P,srcIntn:ue,tgtIntn:W,srcShape:G,tgtShape:q,posPts:{x1:se.x2,y1:se.y2,x2:se.x1,y2:se.y1},intersectionPts:{x1:X.x2,y1:X.y2,x2:X.x1,y2:X.y1},vector:{x:-Ue.x,y:-Ue.y},vectorNorm:{x:-et.x,y:-et.y},vectorNormInverse:{x:-dt.x,y:-dt.y}}}var He=O?E:k;te.nodesOverlap=He.nodesOverlap,te.srcIntn=He.srcIntn,te.tgtIntn=He.tgtIntn,i&&(A.isParent()||A.isChild()||D.isParent()||D.isChild())&&(A.parents().anySame(D)||D.parents().anySame(A)||A.same(D)&&A.isParent())?t.findCompoundLoopPoints(Y,He,K,ae):A===D?t.findLoopPoints(Y,He,K,ae):Z==="segments"?t.findSegmentsPoints(Y,He):Z==="taxi"?t.findTaxiPoints(Y,He):Z==="straight"||!ae&&k.eles.length%2===1&&K===Math.floor(k.eles.length/2)?t.findStraightEdgePoints(Y):t.findBezierPoints(Y,He,K,ae,O),t.findEndpoints(Y),t.tryToCorrectInvalidPoints(Y,He),t.checkForInvalidEdgeWarning(Y),t.storeAllpts(Y),t.storeEdgeProjections(Y),t.calculateArrowAngles(Y),t.recalculateEdgeLabelProjections(Y),t.calculateLabelAngles(Y)}},w=0;w<a.length;w++)x(w);this.findHaystackPoints(o)}};function LEe(e){var t=[];if(e!=null){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1];t.push({x:r,y:i})}return t}}So.getSegmentPoints=function(e){var t=e[0]._private.rscratch,n=t.edgeType;if(n==="segments")return this.recalculateRenderedStyle(e),LEe(t.segpts)};So.getControlPoints=function(e){var t=e[0]._private.rscratch,n=t.edgeType;if(n==="bezier"||n==="multibezier"||n==="self"||n==="compound")return this.recalculateRenderedStyle(e),LEe(t.ctrlpts)};So.getEdgeMidpoint=function(e){var t=e[0]._private.rscratch;return this.recalculateRenderedStyle(e),{x:t.midX,y:t.midY}};var gN={};gN.manualEndptToPx=function(e,t){var n=this,r=e.position(),i=e.outerWidth(),s=e.outerHeight();if(t.value.length===2){var a=[t.pfValue[0],t.pfValue[1]];return t.units[0]==="%"&&(a[0]=a[0]*i),t.units[1]==="%"&&(a[1]=a[1]*s),a[0]+=r.x,a[1]+=r.y,a}else{var o=t.pfValue[0];o=-Math.PI/2+o;var l=2*Math.max(i,s),u=[r.x+Math.cos(o)*l,r.y+Math.sin(o)*l];return n.nodeShapes[this.getNodeShape(e)].intersectLine(r.x,r.y,i,s,u[0],u[1],0)}};gN.findEndpoints=function(e){var t=this,n,r=e.source()[0],i=e.target()[0],s=r.position(),a=i.position(),o=e.pstyle("target-arrow-shape").value,l=e.pstyle("source-arrow-shape").value,u=e.pstyle("target-distance-from-node").pfValue,c=e.pstyle("source-distance-from-node").pfValue,f=e.pstyle("curve-style").value,h=e._private.rscratch,d=h.edgeType,p=f==="taxi",g=d==="self"||d==="compound",m=d==="bezier"||d==="multibezier"||g,v=d!=="bezier",y=d==="straight"||d==="segments",b=d==="segments",x=m||v||y,w=g||p,C=e.pstyle("source-endpoint"),$=w?"outside-to-node":C.value,_=e.pstyle("target-endpoint"),k=w?"outside-to-node":_.value;h.srcManEndpt=C,h.tgtManEndpt=_;var E,S,N,A;if(m){var D=[h.ctrlpts[0],h.ctrlpts[1]],T=v?[h.ctrlpts[h.ctrlpts.length-2],h.ctrlpts[h.ctrlpts.length-1]]:D;E=T,S=D}else if(y){var I=b?h.segpts.slice(0,2):[a.x,a.y],F=b?h.segpts.slice(h.segpts.length-2):[s.x,s.y];E=F,S=I}if(k==="inside-to-node")n=[a.x,a.y];else if(_.units)n=this.manualEndptToPx(i,_);else if(k==="outside-to-line")n=h.tgtIntn;else if(k==="outside-to-node"||k==="outside-to-node-or-label"?N=E:(k==="outside-to-line"||k==="outside-to-line-or-label")&&(N=[s.x,s.y]),n=t.nodeShapes[this.getNodeShape(i)].intersectLine(a.x,a.y,i.outerWidth(),i.outerHeight(),N[0],N[1],0),k==="outside-to-node-or-label"||k==="outside-to-line-or-label"){var R=i._private.rscratch,P=R.labelWidth,V=R.labelHeight,z=R.labelX,q=R.labelY,G=P/2,K=V/2,Y=i.pstyle("text-valign").value;Y==="top"?q-=K:Y==="bottom"&&(q+=K);var te=i.pstyle("text-halign").value;te==="left"?z-=G:te==="right"&&(z+=G);var Z=sT(N[0],N[1],[z-G,q-K,z+G,q-K,z+G,q+K,z-G,q+K],a.x,a.y);if(Z.length>0){var ae=s,O=Hv(ae,T2(n)),L=Hv(ae,T2(Z)),W=O;if(L<O&&(n=Z,W=L),Z.length>2){var M=Hv(ae,{x:Z[2],y:Z[3]});M<W&&(n=[Z[2],Z[3]])}}}var ue=YF(n,E,t.arrowShapes[o].spacing(e)+u),X=YF(n,E,t.arrowShapes[o].gap(e)+u);if(h.endX=X[0],h.endY=X[1],h.arrowEndX=ue[0],h.arrowEndY=ue[1],$==="inside-to-node")n=[s.x,s.y];else if(C.units)n=this.manualEndptToPx(r,C);else if($==="outside-to-line")n=h.srcIntn;else if($==="outside-to-node"||$==="outside-to-node-or-label"?A=S:($==="outside-to-line"||$==="outside-to-line-or-label")&&(A=[a.x,a.y]),n=t.nodeShapes[this.getNodeShape(r)].intersectLine(s.x,s.y,r.outerWidth(),r.outerHeight(),A[0],A[1],0),$==="outside-to-node-or-label"||$==="outside-to-line-or-label"){var se=r._private.rscratch,oe=se.labelWidth,pe=se.labelHeight,Ce=se.labelX,Ue=se.labelY,et=oe/2,dt=pe/2,He=r.pstyle("text-valign").value;He==="top"?Ue-=dt:He==="bottom"&&(Ue+=dt);var Se=r.pstyle("text-halign").value;Se==="left"?Ce-=et:Se==="right"&&(Ce+=et);var j=sT(A[0],A[1],[Ce-et,Ue-dt,Ce+et,Ue-dt,Ce+et,Ue+dt,Ce-et,Ue+dt],s.x,s.y);if(j.length>0){var fe=a,_e=Hv(fe,T2(n)),ve=Hv(fe,T2(j)),ye=_e;if(ve<_e&&(n=[j[0],j[1]],ye=ve),j.length>2){var yt=Hv(fe,{x:j[2],y:j[3]});yt<ye&&(n=[j[2],j[3]])}}}var Ae=YF(n,S,t.arrowShapes[l].spacing(e)+c),Ve=YF(n,S,t.arrowShapes[l].gap(e)+c);h.startX=Ve[0],h.startY=Ve[1],h.arrowStartX=Ae[0],h.arrowStartY=Ae[1],x&&(!Pe(h.startX)||!Pe(h.startY)||!Pe(h.endX)||!Pe(h.endY)?h.badLine=!0:h.badLine=!1)};gN.getSourceEndpoint=function(e){var t=e[0]._private.rscratch;switch(this.recalculateRenderedStyle(e),t.edgeType){case"haystack":return{x:t.haystackPts[0],y:t.haystackPts[1]};default:return{x:t.arrowStartX,y:t.arrowStartY}}};gN.getTargetEndpoint=function(e){var t=e[0]._private.rscratch;switch(this.recalculateRenderedStyle(e),t.edgeType){case"haystack":return{x:t.haystackPts[2],y:t.haystackPts[3]};default:return{x:t.arrowEndX,y:t.arrowEndY}}};var Yee={};function ilt(e,t,n){for(var r=function(u,c,f,h){return Xi(u,c,f,h)},i=t._private,s=i.rstyle.bezierPts,a=0;a<e.bezierProjPcts.length;a++){var o=e.bezierProjPcts[a];s.push({x:r(n[0],n[2],n[4],o),y:r(n[1],n[3],n[5],o)})}}Yee.storeEdgeProjections=function(e){var t=e._private,n=t.rscratch,r=n.edgeType;if(t.rstyle.bezierPts=null,t.rstyle.linePts=null,t.rstyle.haystackPts=null,r==="multibezier"||r==="bezier"||r==="self"||r==="compound"){t.rstyle.bezierPts=[];for(var i=0;i+5<n.allpts.length;i+=4)ilt(this,e,n.allpts.slice(i,i+6))}else if(r==="segments")for(var s=t.rstyle.linePts=[],i=0;i+1<n.allpts.length;i+=2)s.push({x:n.allpts[i],y:n.allpts[i+1]});else if(r==="haystack"){var a=n.haystackPts;t.rstyle.haystackPts=[{x:a[0],y:a[1]},{x:a[2],y:a[3]}]}t.rstyle.arrowWidth=this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth};Yee.recalculateEdgeProjections=function(e){this.findEdgeControlPoints(e)};var nd={};nd.recalculateNodeLabelProjection=function(e){var t=e.pstyle("label").strValue;if(!O0(t)){var n,r,i=e._private,s=e.width(),a=e.height(),o=e.padding(),l=e.position(),u=e.pstyle("text-halign").strValue,c=e.pstyle("text-valign").strValue,f=i.rscratch,h=i.rstyle;switch(u){case"left":n=l.x-s/2-o;break;case"right":n=l.x+s/2+o;break;default:n=l.x}switch(c){case"top":r=l.y-a/2-o;break;case"bottom":r=l.y+a/2+o;break;default:r=l.y}f.labelX=n,f.labelY=r,h.labelX=n,h.labelY=r,this.calculateLabelAngles(e),this.applyLabelDimensions(e)}};var BEe=function(t,n){var r=Math.atan(n/t);return t===0&&r<0&&(r=r*-1),r},zEe=function(t,n){var r=n.x-t.x,i=n.y-t.y;return BEe(r,i)},slt=function(t,n,r,i){var s=iT(0,i-.001,1),a=iT(0,i+.001,1),o=W2(t,n,r,s),l=W2(t,n,r,a);return zEe(o,l)};nd.recalculateEdgeLabelProjections=function(e){var t,n=e._private,r=n.rscratch,i=this,s={mid:e.pstyle("label").strValue,source:e.pstyle("source-label").strValue,target:e.pstyle("target-label").strValue};if(!!(s.mid||s.source||s.target)){t={x:r.midX,y:r.midY};var a=function(f,h,d){Hg(n.rscratch,f,h,d),Hg(n.rstyle,f,h,d)};a("labelX",null,t.x),a("labelY",null,t.y);var o=BEe(r.midDispX,r.midDispY);a("labelAutoAngle",null,o);var l=function c(){if(c.cache)return c.cache;for(var f=[],h=0;h+5<r.allpts.length;h+=4){var d={x:r.allpts[h],y:r.allpts[h+1]},p={x:r.allpts[h+2],y:r.allpts[h+3]},g={x:r.allpts[h+4],y:r.allpts[h+5]};f.push({p0:d,p1:p,p2:g,startDist:0,length:0,segments:[]})}var m=n.rstyle.bezierPts,v=i.bezierProjPcts.length;function y($,_,k,E,S){var N=ky(_,k),A=$.segments[$.segments.length-1],D={p0:_,p1:k,t0:E,t1:S,startDist:A?A.startDist+A.length:0,length:N};$.segments.push(D),$.length+=N}for(var b=0;b<f.length;b++){var x=f[b],w=f[b-1];w&&(x.startDist=w.startDist+w.length),y(x,x.p0,m[b*v],0,i.bezierProjPcts[0]);for(var C=0;C<v-1;C++)y(x,m[b*v+C],m[b*v+C+1],i.bezierProjPcts[C],i.bezierProjPcts[C+1]);y(x,m[b*v+v-1],x.p2,i.bezierProjPcts[v-1],1)}return c.cache=f},u=function(f){var h,d=f==="source";if(!!s[f]){var p=e.pstyle(f+"-text-offset").pfValue;switch(r.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var g=l(),m,v=0,y=0,b=0;b<g.length;b++){for(var x=g[d?b:g.length-1-b],w=0;w<x.segments.length;w++){var C=x.segments[d?w:x.segments.length-1-w],$=b===g.length-1&&w===x.segments.length-1;if(v=y,y+=C.length,y>=p||$){m={cp:x,segment:C};break}}if(m)break}var _=m.cp,k=m.segment,E=(p-v)/k.length,S=k.t1-k.t0,N=d?k.t0+S*E:k.t1-S*E;N=iT(0,N,1),t=W2(_.p0,_.p1,_.p2,N),h=slt(_.p0,_.p1,_.p2,N);break}case"straight":case"segments":case"haystack":{for(var A=0,D,T,I,F,R=r.allpts.length,P=0;P+3<R&&(d?(I={x:r.allpts[P],y:r.allpts[P+1]},F={x:r.allpts[P+2],y:r.allpts[P+3]}):(I={x:r.allpts[R-2-P],y:r.allpts[R-1-P]},F={x:r.allpts[R-4-P],y:r.allpts[R-3-P]}),D=ky(I,F),T=A,A+=D,!(A>=p));P+=2);var V=p-T,z=V/D;z=iT(0,z,1),t=xst(I,F,z),h=zEe(I,F);break}}a("labelX",f,t.x),a("labelY",f,t.y),a("labelAutoAngle",f,h)}};u("source"),u("target"),this.applyLabelDimensions(e)}};nd.applyLabelDimensions=function(e){this.applyPrefixedLabelDimensions(e),e.isEdge()&&(this.applyPrefixedLabelDimensions(e,"source"),this.applyPrefixedLabelDimensions(e,"target"))};nd.applyPrefixedLabelDimensions=function(e,t){var n=e._private,r=this.getLabelText(e,t),i=this.calculateLabelDimensions(e,r),s=e.pstyle("line-height").pfValue,a=e.pstyle("text-wrap").strValue,o=vc(n.rscratch,"labelWrapCachedLines",t)||[],l=a!=="wrap"?1:Math.max(o.length,1),u=i.height/l,c=u*s,f=i.width,h=i.height+(l-1)*(s-1)*u;Hg(n.rstyle,"labelWidth",t,f),Hg(n.rscratch,"labelWidth",t,f),Hg(n.rstyle,"labelHeight",t,h),Hg(n.rscratch,"labelHeight",t,h),Hg(n.rscratch,"labelLineHeight",t,c)};nd.getLabelText=function(e,t){var n=e._private,r=t?t+"-":"",i=e.pstyle(r+"label").strValue,s=e.pstyle("text-transform").value,a=function(V,z){return z?(Hg(n.rscratch,V,t,z),z):vc(n.rscratch,V,t)};if(!i)return"";s=="none"||(s=="uppercase"?i=i.toUpperCase():s=="lowercase"&&(i=i.toLowerCase()));var o=e.pstyle("text-wrap").value;if(o==="wrap"){var l=a("labelKey");if(l!=null&&a("labelWrapKey")===l)return a("labelWrapCachedText");for(var u="\u200B",c=i.split(`
`),f=e.pstyle("text-max-width").pfValue,h=e.pstyle("text-overflow-wrap").value,d=h==="anywhere",p=[],g=/[\s\u200b]+/,m=d?"":" ",v=0;v<c.length;v++){var y=c[v],b=this.calculateLabelDimensions(e,y),x=b.width;if(d){var w=y.split("").join(u);y=w}if(x>f){for(var C=y.split(g),$="",_=0;_<C.length;_++){var k=C[_],E=$.length===0?k:$+m+k,S=this.calculateLabelDimensions(e,E),N=S.width;N<=f?$+=k+m:($&&p.push($),$=k+m)}$.match(/^[\s\u200b]+$/)||p.push($)}else p.push(y)}a("labelWrapCachedLines",p),i=a("labelWrapCachedText",p.join(`
`)),a("labelWrapKey",l)}else if(o==="ellipsis"){var A=e.pstyle("text-max-width").pfValue,D="",T="\u2026",I=!1;if(this.calculateLabelDimensions(e,i).width<A)return i;for(var F=0;F<i.length;F++){var R=this.calculateLabelDimensions(e,D+i[F]+T).width;if(R>A)break;D+=i[F],F===i.length-1&&(I=!0)}return I||(D+=T),D}return i};nd.getLabelJustification=function(e){var t=e.pstyle("text-justification").strValue,n=e.pstyle("text-halign").strValue;if(t==="auto")if(e.isNode())switch(n){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return t};nd.calculateLabelDimensions=function(e,t){var n=this,r=Sy(t,e._private.labelDimsKey),i=n.labelDimCache||(n.labelDimCache=[]),s=i[r];if(s!=null)return s;var a=0,o=e.pstyle("font-style").strValue,l=e.pstyle("font-size").pfValue,u=e.pstyle("font-family").strValue,c=e.pstyle("font-weight").strValue,f=this.labelCalcCanvas,h=this.labelCalcCanvasContext;if(!f){f=this.labelCalcCanvas=document.createElement("canvas"),h=this.labelCalcCanvasContext=f.getContext("2d");var d=f.style;d.position="absolute",d.left="-9999px",d.top="-9999px",d.zIndex="-1",d.visibility="hidden",d.pointerEvents="none"}h.font="".concat(o," ").concat(c," ").concat(l,"px ").concat(u);for(var p=0,g=0,m=t.split(`
`),v=0;v<m.length;v++){var y=m[v],b=h.measureText(y),x=Math.ceil(b.width),w=l;p=Math.max(x,p),g+=w}return p+=a,g+=a,i[r]={width:p,height:g}};nd.calculateLabelAngle=function(e,t){var n=e._private,r=n.rscratch,i=e.isEdge(),s=t?t+"-":"",a=e.pstyle(s+"text-rotation"),o=a.strValue;return o==="none"?0:i&&o==="autorotate"?r.labelAutoAngle:o==="autorotate"?0:a.pfValue};nd.calculateLabelAngles=function(e){var t=this,n=e.isEdge(),r=e._private,i=r.rscratch;i.labelAngle=t.calculateLabelAngle(e),n&&(i.sourceLabelAngle=t.calculateLabelAngle(e,"source"),i.targetLabelAngle=t.calculateLabelAngle(e,"target"))};var UEe={},Xpe=28,Kpe=!1;UEe.getNodeShape=function(e){var t=this,n=e.pstyle("shape").value;if(n==="cutrectangle"&&(e.width()<Xpe||e.height()<Xpe))return Kpe||(Rn("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),Kpe=!0),"rectangle";if(e.isParent())return n==="rectangle"||n==="roundrectangle"||n==="round-rectangle"||n==="cutrectangle"||n==="cut-rectangle"||n==="barrel"?n:"rectangle";if(n==="polygon"){var r=e.pstyle("shape-polygon-points").value;return t.nodeShapes.makePolygon(r).name}return n};var EB={};EB.registerCalculationListeners=function(){var e=this.cy,t=e.collection(),n=this,r=function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(t.merge(a),o)for(var l=0;l<a.length;l++){var u=a[l],c=u._private,f=c.rstyle;f.clean=!1,f.cleanConnected=!1}};n.binder(e).on("bounds.* dirty.*",function(a){var o=a.target;r(o)}).on("style.* background.*",function(a){var o=a.target;r(o,!1)});var i=function(a){if(a){var o=n.onUpdateEleCalcsFns;t.cleanStyle();for(var l=0;l<t.length;l++){var u=t[l],c=u._private.rstyle;u.isNode()&&!c.cleanConnected&&(r(u.connectedEdges()),c.cleanConnected=!0)}if(o)for(var f=0;f<o.length;f++){var h=o[f];h(a,t)}n.recalculateRenderedStyle(t),t=e.collection()}};n.flushRenderedStyleQueue=function(){i(!0)},n.beforeRender(i,n.beforeRenderPriorities.eleCalcs)};EB.onUpdateEleCalcs=function(e){var t=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];t.push(e)};EB.recalculateRenderedStyle=function(e,t){var n=function(x){return x._private.rstyle.cleanConnected},r=[],i=[];if(!this.destroyed){t===void 0&&(t=!0);for(var s=0;s<e.length;s++){var a=e[s],o=a._private,l=o.rstyle;a.isEdge()&&(!n(a.source())||!n(a.target()))&&(l.clean=!1),!(t&&l.clean||a.removed())&&a.pstyle("display").value!=="none"&&(o.group==="nodes"?i.push(a):r.push(a),l.clean=!0)}for(var u=0;u<i.length;u++){var c=i[u],f=c._private,h=f.rstyle,d=c.position();this.recalculateNodeLabelProjection(c),h.nodeX=d.x,h.nodeY=d.y,h.nodeW=c.pstyle("width").pfValue,h.nodeH=c.pstyle("height").pfValue}this.recalculateEdgeProjections(r);for(var p=0;p<r.length;p++){var g=r[p],m=g._private,v=m.rstyle,y=m.rscratch;v.srcX=y.arrowStartX,v.srcY=y.arrowStartY,v.tgtX=y.arrowEndX,v.tgtY=y.arrowEndY,v.midX=y.midX,v.midY=y.midY,v.labelAngle=y.labelAngle,v.sourceLabelAngle=y.sourceLabelAngle,v.targetLabelAngle=y.targetLabelAngle}}};var AB={};AB.updateCachedGrabbedEles=function(){var e=this.cachedZSortedEles;if(!!e){e.drag=[],e.nondrag=[];for(var t=[],n=0;n<e.length;n++){var r=e[n],i=r._private.rscratch;r.grabbed()&&!r.isParent()?t.push(r):i.inDragLayer?e.drag.push(r):e.nondrag.push(r)}for(var n=0;n<t.length;n++){var r=t[n];e.drag.push(r)}}};AB.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};AB.getCachedZSortedEles=function(e){if(e||!this.cachedZSortedEles){var t=this.cy.mutableElements().toArray();t.sort(EEe),t.interactive=t.filter(function(n){return n.interactive()}),this.cachedZSortedEles=t,this.updateCachedGrabbedEles()}else t=this.cachedZSortedEles;return t};var WEe={};[Rb,y5,So,gN,Yee,nd,UEe,EB,AB].forEach(function(e){gt(WEe,e)});var VEe={};VEe.getCachedImage=function(e,t,n){var r=this,i=r.imageCache=r.imageCache||{},s=i[e];if(s)return s.image.complete||s.image.addEventListener("load",n),s.image;s=i[e]=i[e]||{};var a=s.image=new Image;a.addEventListener("load",n),a.addEventListener("error",function(){a.error=!0});var o="data:",l=e.substring(0,o.length).toLowerCase()===o;return l||(t=t==="null"?null:t,a.crossOrigin=t),a.src=e,a};var _C={};_C.registerBinding=function(e,t,n,r){var i=Array.prototype.slice.apply(arguments,[1]),s=this.binder(e);return s.on.apply(s,i)};_C.binder=function(e){var t=this,n=e===window||e===document||e===document.body||Sit(e);if(t.supportsPassiveEvents==null){var r=!1;try{var i=Object.defineProperty({},"passive",{get:function(){return r=!0,!0}});window.addEventListener("test",null,i)}catch{}t.supportsPassiveEvents=r}var s=function(o,l,u){var c=Array.prototype.slice.call(arguments);return n&&t.supportsPassiveEvents&&(c[2]={capture:u!=null?u:!1,passive:!1,once:!1}),t.bindings.push({target:e,args:c}),(e.addEventListener||e.on).apply(e,c),this};return{on:s,addEventListener:s,addListener:s,bind:s}};_C.nodeIsDraggable=function(e){return e&&e.isNode()&&!e.locked()&&e.grabbable()};_C.nodeIsGrabbable=function(e){return this.nodeIsDraggable(e)&&e.interactive()};_C.load=function(){var e=this,t=function(j){return j.selected()},n=function(j,fe,_e,ve){j==null&&(j=e.cy);for(var ye=0;ye<fe.length;ye++){var yt=fe[ye];j.emit({originalEvent:_e,type:yt,position:ve})}},r=function(j){return j.shiftKey||j.metaKey||j.ctrlKey},i=function(j,fe){var _e=!0;if(e.cy.hasCompoundNodes()&&j&&j.pannable())for(var ve=0;fe&&ve<fe.length;ve++){var j=fe[ve];if(j.isNode()&&j.isParent()&&!j.pannable()){_e=!1;break}}else _e=!0;return _e},s=function(j){j[0]._private.grabbed=!0},a=function(j){j[0]._private.grabbed=!1},o=function(j){j[0]._private.rscratch.inDragLayer=!0},l=function(j){j[0]._private.rscratch.inDragLayer=!1},u=function(j){j[0]._private.rscratch.isGrabTarget=!0},c=function(j){j[0]._private.rscratch.isGrabTarget=!1},f=function(j,fe){var _e=fe.addToList,ve=_e.has(j);!ve&&j.grabbable()&&!j.locked()&&(_e.merge(j),s(j))},h=function(j,fe){if(!!j.cy().hasCompoundNodes()&&!(fe.inDragLayer==null&&fe.addToList==null)){var _e=j.descendants();fe.inDragLayer&&(_e.forEach(o),_e.connectedEdges().forEach(o)),fe.addToList&&f(_e,fe)}},d=function(j,fe){fe=fe||{};var _e=j.cy().hasCompoundNodes();fe.inDragLayer&&(j.forEach(o),j.neighborhood().stdFilter(function(ve){return!_e||ve.isEdge()}).forEach(o)),fe.addToList&&j.forEach(function(ve){f(ve,fe)}),h(j,fe),m(j,{inDragLayer:fe.inDragLayer}),e.updateCachedGrabbedEles()},p=d,g=function(j){!j||(e.getCachedZSortedEles().forEach(function(fe){a(fe),l(fe),c(fe)}),e.updateCachedGrabbedEles())},m=function(j,fe){if(!(fe.inDragLayer==null&&fe.addToList==null)&&!!j.cy().hasCompoundNodes()){var _e=j.ancestors().orphans();if(!_e.same(j)){var ve=_e.descendants().spawnSelf().merge(_e).unmerge(j).unmerge(j.descendants()),ye=ve.connectedEdges();fe.inDragLayer&&(ye.forEach(o),ve.forEach(o)),fe.addToList&&ve.forEach(function(yt){f(yt,fe)})}}},v=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},y=typeof MutationObserver<"u",b=typeof ResizeObserver<"u";y?(e.removeObserver=new MutationObserver(function(Se){for(var j=0;j<Se.length;j++){var fe=Se[j],_e=fe.removedNodes;if(_e)for(var ve=0;ve<_e.length;ve++){var ye=_e[ve];if(ye===e.container){e.destroy();break}}}}),e.container.parentNode&&e.removeObserver.observe(e.container.parentNode,{childList:!0})):e.registerBinding(e.container,"DOMNodeRemoved",function(Se){e.destroy()});var x=gB.default(function(){e.cy.resize()},100);y&&(e.styleObserver=new MutationObserver(x),e.styleObserver.observe(e.container,{attributes:!0})),e.registerBinding(window,"resize",x),b&&(e.resizeObserver=new ResizeObserver(x),e.resizeObserver.observe(e.container));var w=function(j,fe){for(;j!=null;)fe(j),j=j.parentNode},C=function(){e.invalidateContainerClientCoordsCache()};w(e.container,function(Se){e.registerBinding(Se,"transitionend",C),e.registerBinding(Se,"animationend",C),e.registerBinding(Se,"scroll",C)}),e.registerBinding(e.container,"contextmenu",function(Se){Se.preventDefault()});var $=function(){return e.selection[4]!==0},_=function(j){for(var fe=e.findContainerClientCoords(),_e=fe[0],ve=fe[1],ye=fe[2],yt=fe[3],Ae=j.touches?j.touches:[j],Ve=!1,Kt=0;Kt<Ae.length;Kt++){var rn=Ae[Kt];if(_e<=rn.clientX&&rn.clientX<=_e+ye&&ve<=rn.clientY&&rn.clientY<=ve+yt){Ve=!0;break}}if(!Ve)return!1;for(var Nt=e.container,fn=j.target,At=fn.parentNode,Rt=!1;At;){if(At===Nt){Rt=!0;break}At=At.parentNode}return!!Rt};e.registerBinding(e.container,"mousedown",function(j){if(!!_(j)){j.preventDefault(),v(),e.hoverData.capture=!0,e.hoverData.which=j.which;var fe=e.cy,_e=[j.clientX,j.clientY],ve=e.projectIntoViewport(_e[0],_e[1]),ye=e.selection,yt=e.findNearestElements(ve[0],ve[1],!0,!1),Ae=yt[0],Ve=e.dragData.possibleDragElements;e.hoverData.mdownPos=ve,e.hoverData.mdownGPos=_e;var Kt=function(){e.hoverData.tapholdCancelled=!1,clearTimeout(e.hoverData.tapholdTimeout),e.hoverData.tapholdTimeout=setTimeout(function(){if(!e.hoverData.tapholdCancelled){var Wr=e.hoverData.down;Wr?Wr.emit({originalEvent:j,type:"taphold",position:{x:ve[0],y:ve[1]}}):fe.emit({originalEvent:j,type:"taphold",position:{x:ve[0],y:ve[1]}})}},e.tapholdDuration)};if(j.which==3){e.hoverData.cxtStarted=!0;var rn={originalEvent:j,type:"cxttapstart",position:{x:ve[0],y:ve[1]}};Ae?(Ae.activate(),Ae.emit(rn),e.hoverData.down=Ae):fe.emit(rn),e.hoverData.downTime=new Date().getTime(),e.hoverData.cxtDragged=!1}else if(j.which==1){Ae&&Ae.activate();{if(Ae!=null&&e.nodeIsGrabbable(Ae)){var Nt=function(Wr){return{originalEvent:j,type:Wr,position:{x:ve[0],y:ve[1]}}},fn=function(Wr){Wr.emit(Nt("grab"))};if(u(Ae),!Ae.selected())Ve=e.dragData.possibleDragElements=fe.collection(),p(Ae,{addToList:Ve}),Ae.emit(Nt("grabon")).emit(Nt("grab"));else{Ve=e.dragData.possibleDragElements=fe.collection();var At=fe.$(function(Rt){return Rt.isNode()&&Rt.selected()&&e.nodeIsGrabbable(Rt)});d(At,{addToList:Ve}),Ae.emit(Nt("grabon")),At.forEach(fn)}e.redrawHint("eles",!0),e.redrawHint("drag",!0)}e.hoverData.down=Ae,e.hoverData.downs=yt,e.hoverData.downTime=new Date().getTime()}n(Ae,["mousedown","tapstart","vmousedown"],j,{x:ve[0],y:ve[1]}),Ae==null?(ye[4]=1,e.data.bgActivePosistion={x:ve[0],y:ve[1]},e.redrawHint("select",!0),e.redraw()):Ae.pannable()&&(ye[4]=1),Kt()}ye[0]=ye[2]=ve[0],ye[1]=ye[3]=ve[1]}},!1),e.registerBinding(window,"mousemove",function(j){var fe=e.hoverData.capture;if(!(!fe&&!_(j))){var _e=!1,ve=e.cy,ye=ve.zoom(),yt=[j.clientX,j.clientY],Ae=e.projectIntoViewport(yt[0],yt[1]),Ve=e.hoverData.mdownPos,Kt=e.hoverData.mdownGPos,rn=e.selection,Nt=null;!e.hoverData.draggingEles&&!e.hoverData.dragging&&!e.hoverData.selecting&&(Nt=e.findNearestElement(Ae[0],Ae[1],!0,!1));var fn=e.hoverData.last,At=e.hoverData.down,Rt=[Ae[0]-rn[2],Ae[1]-rn[3]],Wr=e.dragData.possibleDragElements,Ts;if(Kt){var ec=yt[0]-Kt[0],tc=ec*ec,Ds=yt[1]-Kt[1],nu=Ds*Ds,za=tc+nu;e.hoverData.isOverThresholdDrag=Ts=za>=e.desktopTapThreshold2}var Ad=r(j);Ts&&(e.hoverData.tapholdCancelled=!0);var kg=function(){var kf=e.hoverData.dragDelta=e.hoverData.dragDelta||[];kf.length===0?(kf.push(Rt[0]),kf.push(Rt[1])):(kf[0]+=Rt[0],kf[1]+=Rt[1])};_e=!0,n(Nt,["mousemove","vmousemove","tapdrag"],j,{x:Ae[0],y:Ae[1]});var qx=function(){e.data.bgActivePosistion=void 0,e.hoverData.selecting||ve.emit({originalEvent:j,type:"boxstart",position:{x:Ae[0],y:Ae[1]}}),rn[4]=1,e.hoverData.selecting=!0,e.redrawHint("select",!0),e.redraw()};if(e.hoverData.which===3){if(Ts){var Cv={originalEvent:j,type:"cxtdrag",position:{x:Ae[0],y:Ae[1]}};At?At.emit(Cv):ve.emit(Cv),e.hoverData.cxtDragged=!0,(!e.hoverData.cxtOver||Nt!==e.hoverData.cxtOver)&&(e.hoverData.cxtOver&&e.hoverData.cxtOver.emit({originalEvent:j,type:"cxtdragout",position:{x:Ae[0],y:Ae[1]}}),e.hoverData.cxtOver=Nt,Nt&&Nt.emit({originalEvent:j,type:"cxtdragover",position:{x:Ae[0],y:Ae[1]}}))}}else if(e.hoverData.dragging){if(_e=!0,ve.panningEnabled()&&ve.userPanningEnabled()){var Gx;if(e.hoverData.justStartedPan){var BF=e.hoverData.mdownPos;Gx={x:(Ae[0]-BF[0])*ye,y:(Ae[1]-BF[1])*ye},e.hoverData.justStartedPan=!1}else Gx={x:Rt[0]*ye,y:Rt[1]*ye};ve.panBy(Gx),ve.emit("dragpan"),e.hoverData.dragged=!0}Ae=e.projectIntoViewport(j.clientX,j.clientY)}else if(rn[4]==1&&(At==null||At.pannable())){if(Ts){if(!e.hoverData.dragging&&ve.boxSelectionEnabled()&&(Ad||!ve.panningEnabled()||!ve.userPanningEnabled()))qx();else if(!e.hoverData.selecting&&ve.panningEnabled()&&ve.userPanningEnabled()){var _v=i(At,e.hoverData.downs);_v&&(e.hoverData.dragging=!0,e.hoverData.justStartedPan=!0,rn[4]=0,e.data.bgActivePosistion=T2(Ve),e.redrawHint("select",!0),e.redraw())}At&&At.pannable()&&At.active()&&At.unactivate()}}else{if(At&&At.pannable()&&At.active()&&At.unactivate(),(!At||!At.grabbed())&&Nt!=fn&&(fn&&n(fn,["mouseout","tapdragout"],j,{x:Ae[0],y:Ae[1]}),Nt&&n(Nt,["mouseover","tapdragover"],j,{x:Ae[0],y:Ae[1]}),e.hoverData.last=Nt),At)if(Ts){if(ve.boxSelectionEnabled()&&Ad)At&&At.grabbed()&&(g(Wr),At.emit("freeon"),Wr.emit("free"),e.dragData.didDrag&&(At.emit("dragfreeon"),Wr.emit("dragfree"))),qx();else if(At&&At.grabbed()&&e.nodeIsDraggable(At)){var No=!e.dragData.didDrag;No&&e.redrawHint("eles",!0),e.dragData.didDrag=!0,e.hoverData.draggingEles||d(Wr,{inDragLayer:!0});var Qs={x:0,y:0};if(Pe(Rt[0])&&Pe(Rt[1])&&(Qs.x+=Rt[0],Qs.y+=Rt[1],No)){var Io=e.hoverData.dragDelta;Io&&Pe(Io[0])&&Pe(Io[1])&&(Qs.x+=Io[0],Qs.y+=Io[1])}e.hoverData.draggingEles=!0,Wr.silentShift(Qs).emit("position drag"),e.redrawHint("drag",!0),e.redraw()}}else kg();_e=!0}if(rn[2]=Ae[0],rn[3]=Ae[1],_e)return j.stopPropagation&&j.stopPropagation(),j.preventDefault&&j.preventDefault(),!1}},!1);var k,E,S;e.registerBinding(window,"mouseup",function(j){var fe=e.hoverData.capture;if(!!fe){e.hoverData.capture=!1;var _e=e.cy,ve=e.projectIntoViewport(j.clientX,j.clientY),ye=e.selection,yt=e.findNearestElement(ve[0],ve[1],!0,!1),Ae=e.dragData.possibleDragElements,Ve=e.hoverData.down,Kt=r(j);if(e.data.bgActivePosistion&&(e.redrawHint("select",!0),e.redraw()),e.hoverData.tapholdCancelled=!0,e.data.bgActivePosistion=void 0,Ve&&Ve.unactivate(),e.hoverData.which===3){var rn={originalEvent:j,type:"cxttapend",position:{x:ve[0],y:ve[1]}};if(Ve?Ve.emit(rn):_e.emit(rn),!e.hoverData.cxtDragged){var Nt={originalEvent:j,type:"cxttap",position:{x:ve[0],y:ve[1]}};Ve?Ve.emit(Nt):_e.emit(Nt)}e.hoverData.cxtDragged=!1,e.hoverData.which=null}else if(e.hoverData.which===1){if(n(yt,["mouseup","tapend","vmouseup"],j,{x:ve[0],y:ve[1]}),!e.dragData.didDrag&&!e.hoverData.dragged&&!e.hoverData.selecting&&!e.hoverData.isOverThresholdDrag&&(n(Ve,["click","tap","vclick"],j,{x:ve[0],y:ve[1]}),E=!1,j.timeStamp-S<=_e.multiClickDebounceTime()?(k&&clearTimeout(k),E=!0,S=null,n(Ve,["dblclick","dbltap","vdblclick"],j,{x:ve[0],y:ve[1]})):(k=setTimeout(function(){E||n(Ve,["oneclick","onetap","voneclick"],j,{x:ve[0],y:ve[1]})},_e.multiClickDebounceTime()),S=j.timeStamp)),Ve==null&&!e.dragData.didDrag&&!e.hoverData.selecting&&!e.hoverData.dragged&&!r(j)&&(_e.$(t).unselect(["tapunselect"]),Ae.length>0&&e.redrawHint("eles",!0),e.dragData.possibleDragElements=Ae=_e.collection()),yt==Ve&&!e.dragData.didDrag&&!e.hoverData.selecting&&yt!=null&&yt._private.selectable&&(e.hoverData.dragging||(_e.selectionType()==="additive"||Kt?yt.selected()?yt.unselect(["tapunselect"]):yt.select(["tapselect"]):Kt||(_e.$(t).unmerge(yt).unselect(["tapunselect"]),yt.select(["tapselect"]))),e.redrawHint("eles",!0)),e.hoverData.selecting){var fn=_e.collection(e.getAllInBox(ye[0],ye[1],ye[2],ye[3]));e.redrawHint("select",!0),fn.length>0&&e.redrawHint("eles",!0),_e.emit({type:"boxend",originalEvent:j,position:{x:ve[0],y:ve[1]}});var At=function(Ts){return Ts.selectable()&&!Ts.selected()};_e.selectionType()==="additive"||Kt||_e.$(t).unmerge(fn).unselect(),fn.emit("box").stdFilter(At).select().emit("boxselect"),e.redraw()}if(e.hoverData.dragging&&(e.hoverData.dragging=!1,e.redrawHint("select",!0),e.redrawHint("eles",!0),e.redraw()),!ye[4]){e.redrawHint("drag",!0),e.redrawHint("eles",!0);var Rt=Ve&&Ve.grabbed();g(Ae),Rt&&(Ve.emit("freeon"),Ae.emit("free"),e.dragData.didDrag&&(Ve.emit("dragfreeon"),Ae.emit("dragfree")))}}ye[4]=0,e.hoverData.down=null,e.hoverData.cxtStarted=!1,e.hoverData.draggingEles=!1,e.hoverData.selecting=!1,e.hoverData.isOverThresholdDrag=!1,e.dragData.didDrag=!1,e.hoverData.dragged=!1,e.hoverData.dragDelta=[],e.hoverData.mdownPos=null,e.hoverData.mdownGPos=null}},!1);var N=function(j){if(!e.scrollingPage){var fe=e.cy,_e=fe.zoom(),ve=fe.pan(),ye=e.projectIntoViewport(j.clientX,j.clientY),yt=[ye[0]*_e+ve.x,ye[1]*_e+ve.y];if(e.hoverData.draggingEles||e.hoverData.dragging||e.hoverData.cxtStarted||$()){j.preventDefault();return}if(fe.panningEnabled()&&fe.userPanningEnabled()&&fe.zoomingEnabled()&&fe.userZoomingEnabled()){j.preventDefault(),e.data.wheelZooming=!0,clearTimeout(e.data.wheelTimeout),e.data.wheelTimeout=setTimeout(function(){e.data.wheelZooming=!1,e.redrawHint("eles",!0),e.redraw()},150);var Ae;j.deltaY!=null?Ae=j.deltaY/-250:j.wheelDeltaY!=null?Ae=j.wheelDeltaY/1e3:Ae=j.wheelDelta/1e3,Ae=Ae*e.wheelSensitivity;var Ve=j.deltaMode===1;Ve&&(Ae*=33);var Kt=fe.zoom()*Math.pow(10,Ae);j.type==="gesturechange"&&(Kt=e.gestureStartZoom*j.scale),fe.zoom({level:Kt,renderedPosition:{x:yt[0],y:yt[1]}}),fe.emit(j.type==="gesturechange"?"pinchzoom":"scrollzoom")}}};e.registerBinding(e.container,"wheel",N,!0),e.registerBinding(window,"scroll",function(j){e.scrollingPage=!0,clearTimeout(e.scrollingPageTimeout),e.scrollingPageTimeout=setTimeout(function(){e.scrollingPage=!1},250)},!0),e.registerBinding(e.container,"gesturestart",function(j){e.gestureStartZoom=e.cy.zoom(),e.hasTouchStarted||j.preventDefault()},!0),e.registerBinding(e.container,"gesturechange",function(Se){e.hasTouchStarted||N(Se)},!0),e.registerBinding(e.container,"mouseout",function(j){var fe=e.projectIntoViewport(j.clientX,j.clientY);e.cy.emit({originalEvent:j,type:"mouseout",position:{x:fe[0],y:fe[1]}})},!1),e.registerBinding(e.container,"mouseover",function(j){var fe=e.projectIntoViewport(j.clientX,j.clientY);e.cy.emit({originalEvent:j,type:"mouseover",position:{x:fe[0],y:fe[1]}})},!1);var A,D,T,I,F,R,P,V,z,q,G,K,Y,te=function(j,fe,_e,ve){return Math.sqrt((_e-j)*(_e-j)+(ve-fe)*(ve-fe))},Z=function(j,fe,_e,ve){return(_e-j)*(_e-j)+(ve-fe)*(ve-fe)},ae;e.registerBinding(e.container,"touchstart",ae=function(j){if(e.hasTouchStarted=!0,!!_(j)){v(),e.touchData.capture=!0,e.data.bgActivePosistion=void 0;var fe=e.cy,_e=e.touchData.now,ve=e.touchData.earlier;if(j.touches[0]){var ye=e.projectIntoViewport(j.touches[0].clientX,j.touches[0].clientY);_e[0]=ye[0],_e[1]=ye[1]}if(j.touches[1]){var ye=e.projectIntoViewport(j.touches[1].clientX,j.touches[1].clientY);_e[2]=ye[0],_e[3]=ye[1]}if(j.touches[2]){var ye=e.projectIntoViewport(j.touches[2].clientX,j.touches[2].clientY);_e[4]=ye[0],_e[5]=ye[1]}if(j.touches[1]){e.touchData.singleTouchMoved=!0,g(e.dragData.touchDragEles);var yt=e.findContainerClientCoords();z=yt[0],q=yt[1],G=yt[2],K=yt[3],A=j.touches[0].clientX-z,D=j.touches[0].clientY-q,T=j.touches[1].clientX-z,I=j.touches[1].clientY-q,Y=0<=A&&A<=G&&0<=T&&T<=G&&0<=D&&D<=K&&0<=I&&I<=K;var Ae=fe.pan(),Ve=fe.zoom();F=te(A,D,T,I),R=Z(A,D,T,I),P=[(A+T)/2,(D+I)/2],V=[(P[0]-Ae.x)/Ve,(P[1]-Ae.y)/Ve];var Kt=200,rn=Kt*Kt;if(R<rn&&!j.touches[2]){var Nt=e.findNearestElement(_e[0],_e[1],!0,!0),fn=e.findNearestElement(_e[2],_e[3],!0,!0);Nt&&Nt.isNode()?(Nt.activate().emit({originalEvent:j,type:"cxttapstart",position:{x:_e[0],y:_e[1]}}),e.touchData.start=Nt):fn&&fn.isNode()?(fn.activate().emit({originalEvent:j,type:"cxttapstart",position:{x:_e[0],y:_e[1]}}),e.touchData.start=fn):fe.emit({originalEvent:j,type:"cxttapstart",position:{x:_e[0],y:_e[1]}}),e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxt=!0,e.touchData.cxtDragged=!1,e.data.bgActivePosistion=void 0,e.redraw();return}}if(j.touches[2])fe.boxSelectionEnabled()&&j.preventDefault();else if(!j.touches[1]){if(j.touches[0]){var At=e.findNearestElements(_e[0],_e[1],!0,!0),Rt=At[0];if(Rt!=null&&(Rt.activate(),e.touchData.start=Rt,e.touchData.starts=At,e.nodeIsGrabbable(Rt))){var Wr=e.dragData.touchDragEles=fe.collection(),Ts=null;e.redrawHint("eles",!0),e.redrawHint("drag",!0),Rt.selected()?(Ts=fe.$(function(za){return za.selected()&&e.nodeIsGrabbable(za)}),d(Ts,{addToList:Wr})):p(Rt,{addToList:Wr}),u(Rt);var ec=function(Ad){return{originalEvent:j,type:Ad,position:{x:_e[0],y:_e[1]}}};Rt.emit(ec("grabon")),Ts?Ts.forEach(function(za){za.emit(ec("grab"))}):Rt.emit(ec("grab"))}n(Rt,["touchstart","tapstart","vmousedown"],j,{x:_e[0],y:_e[1]}),Rt==null&&(e.data.bgActivePosistion={x:ye[0],y:ye[1]},e.redrawHint("select",!0),e.redraw()),e.touchData.singleTouchMoved=!1,e.touchData.singleTouchStartTime=+new Date,clearTimeout(e.touchData.tapholdTimeout),e.touchData.tapholdTimeout=setTimeout(function(){e.touchData.singleTouchMoved===!1&&!e.pinching&&!e.touchData.selecting&&n(e.touchData.start,["taphold"],j,{x:_e[0],y:_e[1]})},e.tapholdDuration)}}if(j.touches.length>=1){for(var tc=e.touchData.startPosition=[],Ds=0;Ds<_e.length;Ds++)tc[Ds]=ve[Ds]=_e[Ds];var nu=j.touches[0];e.touchData.startGPosition=[nu.clientX,nu.clientY]}}},!1);var O;e.registerBinding(window,"touchmove",O=function(j){var fe=e.touchData.capture;if(!(!fe&&!_(j))){var _e=e.selection,ve=e.cy,ye=e.touchData.now,yt=e.touchData.earlier,Ae=ve.zoom();if(j.touches[0]){var Ve=e.projectIntoViewport(j.touches[0].clientX,j.touches[0].clientY);ye[0]=Ve[0],ye[1]=Ve[1]}if(j.touches[1]){var Ve=e.projectIntoViewport(j.touches[1].clientX,j.touches[1].clientY);ye[2]=Ve[0],ye[3]=Ve[1]}if(j.touches[2]){var Ve=e.projectIntoViewport(j.touches[2].clientX,j.touches[2].clientY);ye[4]=Ve[0],ye[5]=Ve[1]}var Kt=e.touchData.startGPosition,rn;if(fe&&j.touches[0]&&Kt){for(var Nt=[],fn=0;fn<ye.length;fn++)Nt[fn]=ye[fn]-yt[fn];var At=j.touches[0].clientX-Kt[0],Rt=At*At,Wr=j.touches[0].clientY-Kt[1],Ts=Wr*Wr,ec=Rt+Ts;rn=ec>=e.touchTapThreshold2}if(fe&&e.touchData.cxt){j.preventDefault();var tc=j.touches[0].clientX-z,Ds=j.touches[0].clientY-q,nu=j.touches[1].clientX-z,za=j.touches[1].clientY-q,Ad=Z(tc,Ds,nu,za),kg=Ad/R,qx=150,Cv=qx*qx,Gx=1.5,BF=Gx*Gx;if(kg>=BF||Ad>=Cv){e.touchData.cxt=!1,e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);var _v={originalEvent:j,type:"cxttapend",position:{x:ye[0],y:ye[1]}};e.touchData.start?(e.touchData.start.unactivate().emit(_v),e.touchData.start=null):ve.emit(_v)}}if(fe&&e.touchData.cxt){var _v={originalEvent:j,type:"cxtdrag",position:{x:ye[0],y:ye[1]}};e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),e.touchData.start?e.touchData.start.emit(_v):ve.emit(_v),e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxtDragged=!0;var No=e.findNearestElement(ye[0],ye[1],!0,!0);(!e.touchData.cxtOver||No!==e.touchData.cxtOver)&&(e.touchData.cxtOver&&e.touchData.cxtOver.emit({originalEvent:j,type:"cxtdragout",position:{x:ye[0],y:ye[1]}}),e.touchData.cxtOver=No,No&&No.emit({originalEvent:j,type:"cxtdragover",position:{x:ye[0],y:ye[1]}}))}else if(fe&&j.touches[2]&&ve.boxSelectionEnabled())j.preventDefault(),e.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,e.touchData.selecting||ve.emit({originalEvent:j,type:"boxstart",position:{x:ye[0],y:ye[1]}}),e.touchData.selecting=!0,e.touchData.didSelect=!0,_e[4]=1,!_e||_e.length===0||_e[0]===void 0?(_e[0]=(ye[0]+ye[2]+ye[4])/3,_e[1]=(ye[1]+ye[3]+ye[5])/3,_e[2]=(ye[0]+ye[2]+ye[4])/3+1,_e[3]=(ye[1]+ye[3]+ye[5])/3+1):(_e[2]=(ye[0]+ye[2]+ye[4])/3,_e[3]=(ye[1]+ye[3]+ye[5])/3),e.redrawHint("select",!0),e.redraw();else if(fe&&j.touches[1]&&!e.touchData.didSelect&&ve.zoomingEnabled()&&ve.panningEnabled()&&ve.userZoomingEnabled()&&ve.userPanningEnabled()){j.preventDefault(),e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);var Qs=e.dragData.touchDragEles;if(Qs){e.redrawHint("drag",!0);for(var Io=0;Io<Qs.length;Io++){var zF=Qs[Io]._private;zF.grabbed=!1,zF.rscratch.inDragLayer=!1}}var kf=e.touchData.start,tc=j.touches[0].clientX-z,Ds=j.touches[0].clientY-q,nu=j.touches[1].clientX-z,za=j.touches[1].clientY-q,hde=te(tc,Ds,nu,za),eZe=hde/F;if(Y){var tZe=tc-A,nZe=Ds-D,rZe=nu-T,iZe=za-I,sZe=(tZe+rZe)/2,aZe=(nZe+iZe)/2,LS=ve.zoom(),RV=LS*eZe,UF=ve.pan(),dde=V[0]*LS+UF.x,pde=V[1]*LS+UF.y,oZe={x:-RV/LS*(dde-UF.x-sZe)+dde,y:-RV/LS*(pde-UF.y-aZe)+pde};if(kf&&kf.active()){var Qs=e.dragData.touchDragEles;g(Qs),e.redrawHint("drag",!0),e.redrawHint("eles",!0),kf.unactivate().emit("freeon"),Qs.emit("free"),e.dragData.didDrag&&(kf.emit("dragfreeon"),Qs.emit("dragfree"))}ve.viewport({zoom:RV,pan:oZe,cancelOnFailedZoom:!0}),ve.emit("pinchzoom"),F=hde,A=tc,D=Ds,T=nu,I=za,e.pinching=!0}if(j.touches[0]){var Ve=e.projectIntoViewport(j.touches[0].clientX,j.touches[0].clientY);ye[0]=Ve[0],ye[1]=Ve[1]}if(j.touches[1]){var Ve=e.projectIntoViewport(j.touches[1].clientX,j.touches[1].clientY);ye[2]=Ve[0],ye[3]=Ve[1]}if(j.touches[2]){var Ve=e.projectIntoViewport(j.touches[2].clientX,j.touches[2].clientY);ye[4]=Ve[0],ye[5]=Ve[1]}}else if(j.touches[0]&&!e.touchData.didSelect){var nc=e.touchData.start,PV=e.touchData.last,No;if(!e.hoverData.draggingEles&&!e.swipePanning&&(No=e.findNearestElement(ye[0],ye[1],!0,!0)),fe&&nc!=null&&j.preventDefault(),fe&&nc!=null&&e.nodeIsDraggable(nc))if(rn){var Qs=e.dragData.touchDragEles,gde=!e.dragData.didDrag;gde&&d(Qs,{inDragLayer:!0}),e.dragData.didDrag=!0;var BS={x:0,y:0};if(Pe(Nt[0])&&Pe(Nt[1])&&(BS.x+=Nt[0],BS.y+=Nt[1],gde)){e.redrawHint("eles",!0);var rc=e.touchData.dragDelta;rc&&Pe(rc[0])&&Pe(rc[1])&&(BS.x+=rc[0],BS.y+=rc[1])}e.hoverData.draggingEles=!0,Qs.silentShift(BS).emit("position drag"),e.redrawHint("drag",!0),e.touchData.startPosition[0]==yt[0]&&e.touchData.startPosition[1]==yt[1]&&e.redrawHint("eles",!0),e.redraw()}else{var rc=e.touchData.dragDelta=e.touchData.dragDelta||[];rc.length===0?(rc.push(Nt[0]),rc.push(Nt[1])):(rc[0]+=Nt[0],rc[1]+=Nt[1])}if(n(nc||No,["touchmove","tapdrag","vmousemove"],j,{x:ye[0],y:ye[1]}),(!nc||!nc.grabbed())&&No!=PV&&(PV&&PV.emit({originalEvent:j,type:"tapdragout",position:{x:ye[0],y:ye[1]}}),No&&No.emit({originalEvent:j,type:"tapdragover",position:{x:ye[0],y:ye[1]}})),e.touchData.last=No,fe)for(var Io=0;Io<ye.length;Io++)ye[Io]&&e.touchData.startPosition[Io]&&rn&&(e.touchData.singleTouchMoved=!0);if(fe&&(nc==null||nc.pannable())&&ve.panningEnabled()&&ve.userPanningEnabled()){var lZe=i(nc,e.touchData.starts);lZe&&(j.preventDefault(),e.data.bgActivePosistion||(e.data.bgActivePosistion=T2(e.touchData.startPosition)),e.swipePanning?(ve.panBy({x:Nt[0]*Ae,y:Nt[1]*Ae}),ve.emit("dragpan")):rn&&(e.swipePanning=!0,ve.panBy({x:At*Ae,y:Wr*Ae}),ve.emit("dragpan"),nc&&(nc.unactivate(),e.redrawHint("select",!0),e.touchData.start=null)));var Ve=e.projectIntoViewport(j.touches[0].clientX,j.touches[0].clientY);ye[0]=Ve[0],ye[1]=Ve[1]}}for(var fn=0;fn<ye.length;fn++)yt[fn]=ye[fn];fe&&j.touches.length>0&&!e.hoverData.draggingEles&&!e.swipePanning&&e.data.bgActivePosistion!=null&&(e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),e.redraw())}},!1);var L;e.registerBinding(window,"touchcancel",L=function(j){var fe=e.touchData.start;e.touchData.capture=!1,fe&&fe.unactivate()});var W,M,ue,X;if(e.registerBinding(window,"touchend",W=function(j){var fe=e.touchData.start,_e=e.touchData.capture;if(_e)j.touches.length===0&&(e.touchData.capture=!1),j.preventDefault();else return;var ve=e.selection;e.swipePanning=!1,e.hoverData.draggingEles=!1;var ye=e.cy,yt=ye.zoom(),Ae=e.touchData.now,Ve=e.touchData.earlier;if(j.touches[0]){var Kt=e.projectIntoViewport(j.touches[0].clientX,j.touches[0].clientY);Ae[0]=Kt[0],Ae[1]=Kt[1]}if(j.touches[1]){var Kt=e.projectIntoViewport(j.touches[1].clientX,j.touches[1].clientY);Ae[2]=Kt[0],Ae[3]=Kt[1]}if(j.touches[2]){var Kt=e.projectIntoViewport(j.touches[2].clientX,j.touches[2].clientY);Ae[4]=Kt[0],Ae[5]=Kt[1]}fe&&fe.unactivate();var rn;if(e.touchData.cxt){if(rn={originalEvent:j,type:"cxttapend",position:{x:Ae[0],y:Ae[1]}},fe?fe.emit(rn):ye.emit(rn),!e.touchData.cxtDragged){var Nt={originalEvent:j,type:"cxttap",position:{x:Ae[0],y:Ae[1]}};fe?fe.emit(Nt):ye.emit(Nt)}e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxt=!1,e.touchData.start=null,e.redraw();return}if(!j.touches[2]&&ye.boxSelectionEnabled()&&e.touchData.selecting){e.touchData.selecting=!1;var fn=ye.collection(e.getAllInBox(ve[0],ve[1],ve[2],ve[3]));ve[0]=void 0,ve[1]=void 0,ve[2]=void 0,ve[3]=void 0,ve[4]=0,e.redrawHint("select",!0),ye.emit({type:"boxend",originalEvent:j,position:{x:Ae[0],y:Ae[1]}});var At=function(Cv){return Cv.selectable()&&!Cv.selected()};fn.emit("box").stdFilter(At).select().emit("boxselect"),fn.nonempty()&&e.redrawHint("eles",!0),e.redraw()}if(fe!=null&&fe.unactivate(),j.touches[2])e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);else if(!j.touches[1]){if(!j.touches[0]){if(!j.touches[0]){e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);var Rt=e.dragData.touchDragEles;if(fe!=null){var Wr=fe._private.grabbed;g(Rt),e.redrawHint("drag",!0),e.redrawHint("eles",!0),Wr&&(fe.emit("freeon"),Rt.emit("free"),e.dragData.didDrag&&(fe.emit("dragfreeon"),Rt.emit("dragfree"))),n(fe,["touchend","tapend","vmouseup","tapdragout"],j,{x:Ae[0],y:Ae[1]}),fe.unactivate(),e.touchData.start=null}else{var Ts=e.findNearestElement(Ae[0],Ae[1],!0,!0);n(Ts,["touchend","tapend","vmouseup","tapdragout"],j,{x:Ae[0],y:Ae[1]})}var ec=e.touchData.startPosition[0]-Ae[0],tc=ec*ec,Ds=e.touchData.startPosition[1]-Ae[1],nu=Ds*Ds,za=tc+nu,Ad=za*yt*yt;e.touchData.singleTouchMoved||(fe||ye.$(":selected").unselect(["tapunselect"]),n(fe,["tap","vclick"],j,{x:Ae[0],y:Ae[1]}),M=!1,j.timeStamp-X<=ye.multiClickDebounceTime()?(ue&&clearTimeout(ue),M=!0,X=null,n(fe,["dbltap","vdblclick"],j,{x:Ae[0],y:Ae[1]})):(ue=setTimeout(function(){M||n(fe,["onetap","voneclick"],j,{x:Ae[0],y:Ae[1]})},ye.multiClickDebounceTime()),X=j.timeStamp)),fe!=null&&!e.dragData.didDrag&&fe._private.selectable&&Ad<e.touchTapThreshold2&&!e.pinching&&(ye.selectionType()==="single"?(ye.$(t).unmerge(fe).unselect(["tapunselect"]),fe.select(["tapselect"])):fe.selected()?fe.unselect(["tapunselect"]):fe.select(["tapselect"]),e.redrawHint("eles",!0)),e.touchData.singleTouchMoved=!0}}}for(var kg=0;kg<Ae.length;kg++)Ve[kg]=Ae[kg];e.dragData.didDrag=!1,j.touches.length===0&&(e.touchData.dragDelta=[],e.touchData.startPosition=null,e.touchData.startGPosition=null,e.touchData.didSelect=!1),j.touches.length<2&&(j.touches.length===1&&(e.touchData.startGPosition=[j.touches[0].clientX,j.touches[0].clientY]),e.pinching=!1,e.redrawHint("eles",!0),e.redraw())},!1),typeof TouchEvent>"u"){var se=[],oe=function(j){return{clientX:j.clientX,clientY:j.clientY,force:1,identifier:j.pointerId,pageX:j.pageX,pageY:j.pageY,radiusX:j.width/2,radiusY:j.height/2,screenX:j.screenX,screenY:j.screenY,target:j.target}},pe=function(j){return{event:j,touch:oe(j)}},Ce=function(j){se.push(pe(j))},Ue=function(j){for(var fe=0;fe<se.length;fe++){var _e=se[fe];if(_e.event.pointerId===j.pointerId){se.splice(fe,1);return}}},et=function(j){var fe=se.filter(function(_e){return _e.event.pointerId===j.pointerId})[0];fe.event=j,fe.touch=oe(j)},dt=function(j){j.touches=se.map(function(fe){return fe.touch})},He=function(j){return j.pointerType==="mouse"||j.pointerType===4};e.registerBinding(e.container,"pointerdown",function(Se){He(Se)||(Se.preventDefault(),Ce(Se),dt(Se),ae(Se))}),e.registerBinding(e.container,"pointerup",function(Se){He(Se)||(Ue(Se),dt(Se),W(Se))}),e.registerBinding(e.container,"pointercancel",function(Se){He(Se)||(Ue(Se),dt(Se),L(Se))}),e.registerBinding(e.container,"pointermove",function(Se){He(Se)||(Se.preventDefault(),et(Se),dt(Se),O(Se))})}};var Zp={};Zp.generatePolygon=function(e,t){return this.nodeShapes[e]={renderer:this,name:e,points:t,draw:function(r,i,s,a,o){this.renderer.nodeShapeImpl("polygon",r,i,s,a,o,this.points)},intersectLine:function(r,i,s,a,o,l,u){return sT(o,l,this.points,r,i,s/2,a/2,u)},checkPoint:function(r,i,s,a,o,l,u){return Tp(r,i,this.points,l,u,a,o,[0,-1],s)}}};Zp.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(t,n,r,i,s){this.renderer.nodeShapeImpl(this.name,t,n,r,i,s)},intersectLine:function(t,n,r,i,s,a,o){return Mst(s,a,t,n,r/2+o,i/2+o)},checkPoint:function(t,n,r,i,s,a,o){return _1(t,n,i,s,a,o,r)}}};Zp.generateRoundPolygon=function(e,t){for(var n=new Array(t.length*2),r=0;r<t.length/2;r++){var i=r*2,s=void 0;r<t.length/2-1?s=(r+1)*2:s=0,n[r*4]=t[i],n[r*4+1]=t[i+1];var a=t[s]-t[i],o=t[s+1]-t[i+1],l=Math.sqrt(a*a+o*o);n[r*4+2]=a/l,n[r*4+3]=o/l}return this.nodeShapes[e]={renderer:this,name:e,points:n,draw:function(c,f,h,d,p){this.renderer.nodeShapeImpl("round-polygon",c,f,h,d,p,this.points)},intersectLine:function(c,f,h,d,p,g,m){return Fst(p,g,this.points,c,f,h,d)},checkPoint:function(c,f,h,d,p,g,m){return Ist(c,f,this.points,g,m,d,p)}}};Zp.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Wa(4,0),draw:function(t,n,r,i,s){this.renderer.nodeShapeImpl(this.name,t,n,r,i,s)},intersectLine:function(t,n,r,i,s,a,o){return Qke(s,a,t,n,r,i,o)},checkPoint:function(t,n,r,i,s,a,o){var l=hN(i,s),u=l*2;return!!(Tp(t,n,this.points,a,o,i,s-u,[0,-1],r)||Tp(t,n,this.points,a,o,i-u,s,[0,-1],r)||_1(t,n,u,u,a-i/2+l,o-s/2+l,r)||_1(t,n,u,u,a+i/2-l,o-s/2+l,r)||_1(t,n,u,u,a+i/2-l,o+s/2-l,r)||_1(t,n,u,u,a-i/2+l,o+s/2-l,r))}}};Zp.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:nEe(),points:Wa(4,0),draw:function(t,n,r,i,s){this.renderer.nodeShapeImpl(this.name,t,n,r,i,s)},generateCutTrianglePts:function(t,n,r,i){var s=this.cornerLength,a=n/2,o=t/2,l=r-o,u=r+o,c=i-a,f=i+a;return{topLeft:[l,c+s,l+s,c,l+s,c+s],topRight:[u-s,c,u,c+s,u-s,c+s],bottomRight:[u,f-s,u-s,f,u-s,f-s],bottomLeft:[l+s,f,l,f-s,l+s,f-s]}},intersectLine:function(t,n,r,i,s,a,o){var l=this.generateCutTrianglePts(r+2*o,i+2*o,t,n),u=[].concat.apply([],[l.topLeft.splice(0,4),l.topRight.splice(0,4),l.bottomRight.splice(0,4),l.bottomLeft.splice(0,4)]);return sT(s,a,u,t,n)},checkPoint:function(t,n,r,i,s,a,o){if(Tp(t,n,this.points,a,o,i,s-2*this.cornerLength,[0,-1],r)||Tp(t,n,this.points,a,o,i-2*this.cornerLength,s,[0,-1],r))return!0;var l=this.generateCutTrianglePts(i,s,a,o);return Bo(t,n,l.topLeft)||Bo(t,n,l.topRight)||Bo(t,n,l.bottomRight)||Bo(t,n,l.bottomLeft)}}};Zp.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Wa(4,0),draw:function(t,n,r,i,s){this.renderer.nodeShapeImpl(this.name,t,n,r,i,s)},intersectLine:function(t,n,r,i,s,a,o){var l=.15,u=.5,c=.85,f=this.generateBarrelBezierPts(r+2*o,i+2*o,t,n),h=function(g){var m=W2({x:g[0],y:g[1]},{x:g[2],y:g[3]},{x:g[4],y:g[5]},l),v=W2({x:g[0],y:g[1]},{x:g[2],y:g[3]},{x:g[4],y:g[5]},u),y=W2({x:g[0],y:g[1]},{x:g[2],y:g[3]},{x:g[4],y:g[5]},c);return[g[0],g[1],m.x,m.y,v.x,v.y,y.x,y.y,g[4],g[5]]},d=[].concat(h(f.topLeft),h(f.topRight),h(f.bottomRight),h(f.bottomLeft));return sT(s,a,d,t,n)},generateBarrelBezierPts:function(t,n,r,i){var s=n/2,a=t/2,o=r-a,l=r+a,u=i-s,c=i+s,f=hY(t,n),h=f.heightOffset,d=f.widthOffset,p=f.ctrlPtOffsetPct*t,g={topLeft:[o,u+h,o+p,u,o+d,u],topRight:[l-d,u,l-p,u,l,u+h],bottomRight:[l,c-h,l-p,c,l-d,c],bottomLeft:[o+d,c,o+p,c,o,c-h]};return g.topLeft.isTop=!0,g.topRight.isTop=!0,g.bottomLeft.isBottom=!0,g.bottomRight.isBottom=!0,g},checkPoint:function(t,n,r,i,s,a,o){var l=hY(i,s),u=l.heightOffset,c=l.widthOffset;if(Tp(t,n,this.points,a,o,i,s-2*u,[0,-1],r)||Tp(t,n,this.points,a,o,i-2*c,s,[0,-1],r))return!0;for(var f=this.generateBarrelBezierPts(i,s,a,o),h=function($,_,k){var E=k[4],S=k[2],N=k[0],A=k[5],D=k[1],T=Math.min(E,N),I=Math.max(E,N),F=Math.min(A,D),R=Math.max(A,D);if(T<=$&&$<=I&&F<=_&&_<=R){var P=Ost(E,S,N),V=Ast(P[0],P[1],P[2],$),z=V.filter(function(q){return 0<=q&&q<=1});if(z.length>0)return z[0]}return null},d=Object.keys(f),p=0;p<d.length;p++){var g=d[p],m=f[g],v=h(t,n,m);if(v!=null){var y=m[5],b=m[3],x=m[1],w=Xi(y,b,x,v);if(m.isTop&&w<=n||m.isBottom&&n<=w)return!0}}return!1}}};Zp.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Wa(4,0),draw:function(t,n,r,i,s){this.renderer.nodeShapeImpl(this.name,t,n,r,i,s)},intersectLine:function(t,n,r,i,s,a,o){var l=t-(r/2+o),u=n-(i/2+o),c=u,f=t+(r/2+o),h=Xg(s,a,t,n,l,u,f,c,!1);return h.length>0?h:Qke(s,a,t,n,r,i,o)},checkPoint:function(t,n,r,i,s,a,o){var l=hN(i,s),u=2*l;if(Tp(t,n,this.points,a,o,i,s-u,[0,-1],r)||Tp(t,n,this.points,a,o,i-u,s,[0,-1],r))return!0;var c=i/2+2*r,f=s/2+2*r,h=[a-c,o-f,a-c,o,a+c,o,a+c,o-f];return!!(Bo(t,n,h)||_1(t,n,u,u,a+i/2-l,o+s/2-l,r)||_1(t,n,u,u,a-i/2+l,o+s/2-l,r))}}};Zp.registerNodeShapes=function(){var e=this.nodeShapes={},t=this;this.generateEllipse(),this.generatePolygon("triangle",Wa(3,0)),this.generateRoundPolygon("round-triangle",Wa(3,0)),this.generatePolygon("rectangle",Wa(4,0)),e.square=e.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var n=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",n),this.generateRoundPolygon("round-diamond",n)}this.generatePolygon("pentagon",Wa(5,0)),this.generateRoundPolygon("round-pentagon",Wa(5,0)),this.generatePolygon("hexagon",Wa(6,0)),this.generateRoundPolygon("round-hexagon",Wa(6,0)),this.generatePolygon("heptagon",Wa(7,0)),this.generateRoundPolygon("round-heptagon",Wa(7,0)),this.generatePolygon("octagon",Wa(8,0)),this.generateRoundPolygon("round-octagon",Wa(8,0));var r=new Array(20);{var i=fY(5,0),s=fY(5,Math.PI/5),a=.5*(3-Math.sqrt(5));a*=1.57;for(var o=0;o<s.length/2;o++)s[o*2]*=a,s[o*2+1]*=a;for(var o=0;o<20/4;o++)r[o*4]=i[o*2],r[o*4+1]=i[o*2+1],r[o*4+2]=s[o*2],r[o*4+3]=s[o*2+1]}r=tEe(r),this.generatePolygon("star",r),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l)}e.makePolygon=function(u){var c=u.join("$"),f="polygon-"+c,h;return(h=this[f])?h:t.generatePolygon(f,u)}};var mN={};mN.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};mN.redraw=function(e){e=e||Yke();var t=this;t.averageRedrawTime===void 0&&(t.averageRedrawTime=0),t.lastRedrawTime===void 0&&(t.lastRedrawTime=0),t.lastDrawTime===void 0&&(t.lastDrawTime=0),t.requestedFrame=!0,t.renderOptions=e};mN.beforeRender=function(e,t){if(!this.destroyed){t==null&&Xr("Priority is not optional for beforeRender");var n=this.beforeRenderCallbacks;n.push({fn:e,priority:t}),n.sort(function(r,i){return i.priority-r.priority})}};var Zpe=function(t,n,r){for(var i=t.beforeRenderCallbacks,s=0;s<i.length;s++)i[s].fn(n,r)};mN.startRenderLoop=function(){var e=this,t=e.cy;if(!e.renderLoopStarted){e.renderLoopStarted=!0;var n=function r(i){if(!e.destroyed){if(!t.batching())if(e.requestedFrame&&!e.skipFrame){Zpe(e,!0,i);var s=Ap();e.render(e.renderOptions);var a=e.lastDrawTime=Ap();e.averageRedrawTime===void 0&&(e.averageRedrawTime=a-s),e.redrawCount===void 0&&(e.redrawCount=0),e.redrawCount++,e.redrawTotalTime===void 0&&(e.redrawTotalTime=0);var o=a-s;e.redrawTotalTime+=o,e.lastRedrawTime=o,e.averageRedrawTime=e.averageRedrawTime/2+o/2,e.requestedFrame=!1}else Zpe(e,!1,i);e.skipFrame=!1,h5(r)}};h5(n)}};var alt=function(t){this.init(t)},jEe=alt,SC=jEe.prototype;SC.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];SC.init=function(e){var t=this;t.options=e,t.cy=e.cy;var n=t.container=e.cy.container();if(Er){var r=Er.document,i=r.head,s="__________cytoscape_stylesheet",a="__________cytoscape_container",o=r.getElementById(s)!=null;if(n.className.indexOf(a)<0&&(n.className=(n.className||"")+" "+a),!o){var l=r.createElement("style");l.id=s,l.textContent="."+a+" { position: relative; }",i.insertBefore(l,i.children[0])}var u=Er.getComputedStyle(n),c=u.getPropertyValue("position");c==="static"&&Rn("A Cytoscape container has style position:static and so can not use UI extensions properly")}t.selection=[void 0,void 0,void 0,void 0,0],t.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],t.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},t.dragData={possibleDragElements:[]},t.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},t.redraws=0,t.showFps=e.showFps,t.debug=e.debug,t.hideEdgesOnViewport=e.hideEdgesOnViewport,t.textureOnViewport=e.textureOnViewport,t.wheelSensitivity=e.wheelSensitivity,t.motionBlurEnabled=e.motionBlur,t.forcedPixelRatio=Pe(e.pixelRatio)?e.pixelRatio:null,t.motionBlur=e.motionBlur,t.motionBlurOpacity=e.motionBlurOpacity,t.motionBlurTransparency=1-t.motionBlurOpacity,t.motionBlurPxRatio=1,t.mbPxRBlurry=1,t.minMbLowQualFrames=4,t.fullQualityMb=!1,t.clearedForMotionBlur=[],t.desktopTapThreshold=e.desktopTapThreshold,t.desktopTapThreshold2=e.desktopTapThreshold*e.desktopTapThreshold,t.touchTapThreshold=e.touchTapThreshold,t.touchTapThreshold2=e.touchTapThreshold*e.touchTapThreshold,t.tapholdDuration=500,t.bindings=[],t.beforeRenderCallbacks=[],t.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},t.registerNodeShapes(),t.registerArrowShapes(),t.registerCalculationListeners()};SC.notify=function(e,t){var n=this,r=n.cy;if(!this.destroyed){if(e==="init"){n.load();return}if(e==="destroy"){n.destroy();return}(e==="add"||e==="remove"||e==="move"&&r.hasCompoundNodes()||e==="load"||e==="zorder"||e==="mount")&&n.invalidateCachedZSortedEles(),e==="viewport"&&n.redrawHint("select",!0),(e==="load"||e==="resize"||e==="mount")&&(n.invalidateContainerClientCoordsCache(),n.matchCanvasSize(n.container)),n.redrawHint("eles",!0),n.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};SC.destroy=function(){var e=this;e.destroyed=!0,e.cy.stopAnimationLoop();for(var t=0;t<e.bindings.length;t++){var n=e.bindings[t],r=n,i=r.target;(i.off||i.removeEventListener).apply(i,r.args)}if(e.bindings=[],e.beforeRenderCallbacks=[],e.onUpdateEleCalcsFns=[],e.removeObserver&&e.removeObserver.disconnect(),e.styleObserver&&e.styleObserver.disconnect(),e.resizeObserver&&e.resizeObserver.disconnect(),e.labelCalcDiv)try{document.body.removeChild(e.labelCalcDiv)}catch{}};SC.isHeadless=function(){return!1};[Gee,WEe,VEe,_C,Zp,mN].forEach(function(e){gt(SC,e)});var aj=1e3/60,HEe={setupDequeueing:function(t){return function(){var r=this,i=this.renderer;if(!r.dequeueingSetup){r.dequeueingSetup=!0;var s=gB.default(function(){i.redrawHint("eles",!0),i.redrawHint("drag",!0),i.redraw()},t.deqRedrawThreshold),a=function(u,c){var f=Ap(),h=i.averageRedrawTime,d=i.lastRedrawTime,p=[],g=i.cy.extent(),m=i.getPixelRatio();for(u||i.flushRenderedStyleQueue();;){var v=Ap(),y=v-f,b=v-c;if(d<aj){var x=aj-(u?h:0);if(b>=t.deqFastCost*x)break}else if(u){if(y>=t.deqCost*d||y>=t.deqAvgCost*h)break}else if(b>=t.deqNoDrawCost*aj)break;var w=t.deq(r,m,g);if(w.length>0)for(var C=0;C<w.length;C++)p.push(w[C]);else break}p.length>0&&(t.onDeqd(r,p),!u&&t.shouldRedraw(r,p,m,g)&&s())},o=t.priority||Oee;i.beforeRender(a,o(r))}}}},olt=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d5;Dee(this,e),this.idsByKey=new Zf,this.keyForId=new Zf,this.cachesByLvl=new Zf,this.lvls=[],this.getKey=t,this.doesEleInvalidateKey=n}return Nee(e,[{key:"getIdsFor",value:function(n){n==null&&Xr("Can not get id list for null key");var r=this.idsByKey,i=this.idsByKey.get(n);return i||(i=new xC,r.set(n,i)),i}},{key:"addIdForKey",value:function(n,r){n!=null&&this.getIdsFor(n).add(r)}},{key:"deleteIdForKey",value:function(n,r){n!=null&&this.getIdsFor(n).delete(r)}},{key:"getNumberOfIdsForKey",value:function(n){return n==null?0:this.getIdsFor(n).size}},{key:"updateKeyMappingFor",value:function(n){var r=n.id(),i=this.keyForId.get(r),s=this.getKey(n);this.deleteIdForKey(i,r),this.addIdForKey(s,r),this.keyForId.set(r,s)}},{key:"deleteKeyMappingFor",value:function(n){var r=n.id(),i=this.keyForId.get(r);this.deleteIdForKey(i,r),this.keyForId.delete(r)}},{key:"keyHasChangedFor",value:function(n){var r=n.id(),i=this.keyForId.get(r),s=this.getKey(n);return i!==s}},{key:"isInvalid",value:function(n){return this.keyHasChangedFor(n)||this.doesEleInvalidateKey(n)}},{key:"getCachesAt",value:function(n){var r=this.cachesByLvl,i=this.lvls,s=r.get(n);return s||(s=new Zf,r.set(n,s),i.push(n)),s}},{key:"getCache",value:function(n,r){return this.getCachesAt(r).get(n)}},{key:"get",value:function(n,r){var i=this.getKey(n),s=this.getCache(i,r);return s!=null&&this.updateKeyMappingFor(n),s}},{key:"getForCachedKey",value:function(n,r){var i=this.keyForId.get(n.id()),s=this.getCache(i,r);return s}},{key:"hasCache",value:function(n,r){return this.getCachesAt(r).has(n)}},{key:"has",value:function(n,r){var i=this.getKey(n);return this.hasCache(i,r)}},{key:"setCache",value:function(n,r,i){i.key=n,this.getCachesAt(r).set(n,i)}},{key:"set",value:function(n,r,i){var s=this.getKey(n);this.setCache(s,r,i),this.updateKeyMappingFor(n)}},{key:"deleteCache",value:function(n,r){this.getCachesAt(r).delete(n)}},{key:"delete",value:function(n,r){var i=this.getKey(n);this.deleteCache(i,r)}},{key:"invalidateKey",value:function(n){var r=this;this.lvls.forEach(function(i){return r.deleteCache(n,i)})}},{key:"invalidate",value:function(n){var r=n.id(),i=this.keyForId.get(r);this.deleteKeyMappingFor(n);var s=this.doesEleInvalidateKey(n);return s&&this.invalidateKey(i),s||this.getNumberOfIdsForKey(i)===0}}]),e}(),Qpe=25,nO=50,r4=-4,bY=3,llt=7.99,ult=8,clt=1024,flt=1024,hlt=1024,dlt=.2,plt=.8,glt=10,mlt=.15,vlt=.1,ylt=.9,blt=.9,xlt=100,wlt=1,D2={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},$lt=Ys({getKey:null,doesEleInvalidateKey:d5,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:Hke,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),rE=function(t,n){var r=this;r.renderer=t,r.onDequeues=[];var i=$lt(n);gt(r,i),r.lookup=new olt(i.getKey,i.doesEleInvalidateKey),r.setupDequeueing()},Ri=rE.prototype;Ri.reasons=D2;Ri.getTextureQueue=function(e){var t=this;return t.eleImgCaches=t.eleImgCaches||{},t.eleImgCaches[e]=t.eleImgCaches[e]||[]};Ri.getRetiredTextureQueue=function(e){var t=this,n=t.eleImgCaches.retired=t.eleImgCaches.retired||{},r=n[e]=n[e]||[];return r};Ri.getElementQueue=function(){var e=this,t=e.eleCacheQueue=e.eleCacheQueue||new uN.default(function(n,r){return r.reqs-n.reqs});return t};Ri.getElementKeyToQueue=function(){var e=this,t=e.eleKeyToCacheQueue=e.eleKeyToCacheQueue||{};return t};Ri.getElement=function(e,t,n,r,i){var s=this,a=this.renderer,o=a.cy.zoom(),l=this.lookup;if(!t||t.w===0||t.h===0||isNaN(t.w)||isNaN(t.h)||!e.visible()||e.removed()||!s.allowEdgeTxrCaching&&e.isEdge()||!s.allowParentTxrCaching&&e.isParent())return null;if(r==null&&(r=Math.ceil(Pee(o*n))),r<r4)r=r4;else if(o>=llt||r>bY)return null;var u=Math.pow(2,r),c=t.h*u,f=t.w*u,h=a.eleTextBiggerThanMin(e,u);if(!this.isVisible(e,h))return null;var d=l.get(e,r);if(d&&d.invalidated&&(d.invalidated=!1,d.texture.invalidatedWidth-=d.width),d)return d;var p;if(c<=Qpe?p=Qpe:c<=nO?p=nO:p=Math.ceil(c/nO)*nO,c>hlt||f>flt)return null;var g=s.getTextureQueue(p),m=g[g.length-2],v=function(){return s.recycleTexture(p,f)||s.addTexture(p,f)};m||(m=g[g.length-1]),m||(m=v()),m.width-m.usedWidth<f&&(m=v());for(var y=function(I){return I&&I.scaledLabelShown===h},b=i&&i===D2.dequeue,x=i&&i===D2.highQuality,w=i&&i===D2.downscale,C,$=r+1;$<=bY;$++){var _=l.get(e,$);if(_){C=_;break}}var k=C&&C.level===r+1?C:null,E=function(){m.context.drawImage(k.texture.canvas,k.x,0,k.width,k.height,m.usedWidth,0,f,c)};if(m.context.setTransform(1,0,0,1,0,0),m.context.clearRect(m.usedWidth,0,f,p),y(k))E();else if(y(C))if(x){for(var S=C.level;S>r;S--)k=s.getElement(e,t,n,S,D2.downscale);E()}else return s.queueElement(e,C.level-1),C;else{var N;if(!b&&!x&&!w)for(var A=r-1;A>=r4;A--){var D=l.get(e,A);if(D){N=D;break}}if(y(N))return s.queueElement(e,r),N;m.context.translate(m.usedWidth,0),m.context.scale(u,u),this.drawElement(m.context,e,t,h,!1),m.context.scale(1/u,1/u),m.context.translate(-m.usedWidth,0)}return d={x:m.usedWidth,texture:m,level:r,scale:u,width:f,height:c,scaledLabelShown:h},m.usedWidth+=Math.ceil(f+ult),m.eleCaches.push(d),l.set(e,r,d),s.checkTextureFullness(m),d};Ri.invalidateElements=function(e){for(var t=0;t<e.length;t++)this.invalidateElement(e[t])};Ri.invalidateElement=function(e){var t=this,n=t.lookup,r=[],i=n.isInvalid(e);if(!!i){for(var s=r4;s<=bY;s++){var a=n.getForCachedKey(e,s);a&&r.push(a)}var o=n.invalidate(e);if(o)for(var l=0;l<r.length;l++){var u=r[l],c=u.texture;c.invalidatedWidth+=u.width,u.invalidated=!0,t.checkTextureUtility(c)}t.removeFromQueue(e)}};Ri.checkTextureUtility=function(e){e.invalidatedWidth>=dlt*e.width&&this.retireTexture(e)};Ri.checkTextureFullness=function(e){var t=this,n=t.getTextureQueue(e.height);e.usedWidth/e.width>plt&&e.fullnessChecks>=glt?R0(n,e):e.fullnessChecks++};Ri.retireTexture=function(e){var t=this,n=e.height,r=t.getTextureQueue(n),i=this.lookup;R0(r,e),e.retired=!0;for(var s=e.eleCaches,a=0;a<s.length;a++){var o=s[a];i.deleteCache(o.key,o.level)}Ree(s);var l=t.getRetiredTextureQueue(n);l.push(e)};Ri.addTexture=function(e,t){var n=this,r=n.getTextureQueue(e),i={};return r.push(i),i.eleCaches=[],i.height=e,i.width=Math.max(clt,t),i.usedWidth=0,i.invalidatedWidth=0,i.fullnessChecks=0,i.canvas=n.renderer.makeOffscreenCanvas(i.width,i.height),i.context=i.canvas.getContext("2d"),i};Ri.recycleTexture=function(e,t){for(var n=this,r=n.getTextureQueue(e),i=n.getRetiredTextureQueue(e),s=0;s<i.length;s++){var a=i[s];if(a.width>=t)return a.retired=!1,a.usedWidth=0,a.invalidatedWidth=0,a.fullnessChecks=0,Ree(a.eleCaches),a.context.setTransform(1,0,0,1,0,0),a.context.clearRect(0,0,a.width,a.height),R0(i,a),r.push(a),a}};Ri.queueElement=function(e,t){var n=this,r=n.getElementQueue(),i=n.getElementKeyToQueue(),s=this.getKey(e),a=i[s];if(a)a.level=Math.max(a.level,t),a.eles.merge(e),a.reqs++,r.updateItem(a);else{var o={eles:e.spawn().merge(e),level:t,reqs:1,key:s};r.push(o),i[s]=o}};Ri.dequeue=function(e){for(var t=this,n=t.getElementQueue(),r=t.getElementKeyToQueue(),i=[],s=t.lookup,a=0;a<wlt&&n.size()>0;a++){var o=n.pop(),l=o.key,u=o.eles[0],c=s.hasCache(u,o.level);if(r[l]=null,c)continue;i.push(o);var f=t.getBoundingBox(u);t.getElement(u,f,e,o.level,D2.dequeue)}return i};Ri.removeFromQueue=function(e){var t=this,n=t.getElementQueue(),r=t.getElementKeyToQueue(),i=this.getKey(e),s=r[i];s!=null&&(s.eles.length===1?(s.reqs=Fee,n.updateItem(s),n.pop(),r[i]=null):s.eles.unmerge(e))};Ri.onDequeue=function(e){this.onDequeues.push(e)};Ri.offDequeue=function(e){R0(this.onDequeues,e)};Ri.setupDequeueing=HEe.setupDequeueing({deqRedrawThreshold:xlt,deqCost:mlt,deqAvgCost:vlt,deqNoDrawCost:ylt,deqFastCost:blt,deq:function(t,n,r){return t.dequeue(n,r)},onDeqd:function(t,n){for(var r=0;r<t.onDequeues.length;r++){var i=t.onDequeues[r];i(n)}},shouldRedraw:function(t,n,r,i){for(var s=0;s<n.length;s++)for(var a=n[s].eles,o=0;o<a.length;o++){var l=a[o].boundingBox();if(Lee(l,i))return!0}return!1},priority:function(t){return t.renderer.beforeRenderPriorities.eleTxrDeq}});var Clt=1,aA=-4,b5=2,_lt=3.99,Slt=50,klt=50,Elt=.15,Alt=.1,Tlt=.9,Dlt=.9,Nlt=1,Jpe=250,Ilt=4e3*4e3,Mlt=!0,qEe=function(t){var n=this,r=n.renderer=t,i=r.cy;n.layersByLevel={},n.firstGet=!0,n.lastInvalidationTime=Ap()-2*Jpe,n.skipping=!1,n.eleTxrDeqs=i.collection(),n.scheduleElementRefinement=gB.default(function(){n.refineElementTextures(n.eleTxrDeqs),n.eleTxrDeqs.unmerge(n.eleTxrDeqs)},klt),r.beforeRender(function(a,o){o-n.lastInvalidationTime<=Jpe?n.skipping=!0:n.skipping=!1},r.beforeRenderPriorities.lyrTxrSkip);var s=function(o,l){return l.reqs-o.reqs};n.layersQueue=new uN.default(s),n.setupDequeueing()},Xs=qEe.prototype,ege=0,Flt=Math.pow(2,53)-1;Xs.makeLayer=function(e,t){var n=Math.pow(2,t),r=Math.ceil(e.w*n),i=Math.ceil(e.h*n),s=this.renderer.makeOffscreenCanvas(r,i),a={id:ege=++ege%Flt,bb:e,level:t,width:r,height:i,canvas:s,context:s.getContext("2d"),eles:[],elesQueue:[],reqs:0},o=a.context,l=-a.bb.x1,u=-a.bb.y1;return o.scale(n,n),o.translate(l,u),a};Xs.getLayers=function(e,t,n){var r=this,i=r.renderer,s=i.cy,a=s.zoom(),o=r.firstGet;if(r.firstGet=!1,n==null){if(n=Math.ceil(Pee(a*t)),n<aA)n=aA;else if(a>=_lt||n>b5)return null}r.validateLayersElesOrdering(n,e);var l=r.layersByLevel,u=Math.pow(2,n),c=l[n]=l[n]||[],f,h=r.levelIsComplete(n,e),d,p=function(){var E=function(T){if(r.validateLayersElesOrdering(T,e),r.levelIsComplete(T,e))return d=l[T],!0},S=function(T){if(!d)for(var I=n+T;aA<=I&&I<=b5&&!E(I);I+=T);};S(1),S(-1);for(var N=c.length-1;N>=0;N--){var A=c[N];A.invalid&&R0(c,A)}};if(!h)p();else return c;var g=function(){if(!f){f=il();for(var E=0;E<e.length;E++)Cst(f,e[E].boundingBox())}return f},m=function(E){E=E||{};var S=E.after;g();var N=f.w*u*(f.h*u);if(N>Ilt)return null;var A=r.makeLayer(f,n);if(S!=null){var D=c.indexOf(S)+1;c.splice(D,0,A)}else(E.insert===void 0||E.insert)&&c.unshift(A);return A};if(r.skipping&&!o)return null;for(var v=null,y=e.length/Clt,b=!o,x=0;x<e.length;x++){var w=e[x],C=w._private.rscratch,$=C.imgLayerCaches=C.imgLayerCaches||{},_=$[n];if(_){v=_;continue}if((!v||v.eles.length>=y||!Zke(v.bb,w.boundingBox()))&&(v=m({insert:!0,after:v}),!v))return null;d||b?r.queueLayer(v,w):r.drawEleInLayer(v,w,n,t),v.eles.push(w),$[n]=v}return d||(b?null:c)};Xs.getEleLevelForLayerLevel=function(e,t){return e};Xs.drawEleInLayer=function(e,t,n,r){var i=this,s=this.renderer,a=e.context,o=t.boundingBox();o.w===0||o.h===0||!t.visible()||(n=i.getEleLevelForLayerLevel(n,r),s.setImgSmoothing(a,!1),s.drawCachedElement(a,t,null,null,n,Mlt),s.setImgSmoothing(a,!0))};Xs.levelIsComplete=function(e,t){var n=this,r=n.layersByLevel[e];if(!r||r.length===0)return!1;for(var i=0,s=0;s<r.length;s++){var a=r[s];if(a.reqs>0||a.invalid)return!1;i+=a.eles.length}return i===t.length};Xs.validateLayersElesOrdering=function(e,t){var n=this.layersByLevel[e];if(!!n)for(var r=0;r<n.length;r++){for(var i=n[r],s=-1,a=0;a<t.length;a++)if(i.eles[0]===t[a]){s=a;break}if(s<0){this.invalidateLayer(i);continue}for(var o=s,a=0;a<i.eles.length;a++)if(i.eles[a]!==t[o+a]){this.invalidateLayer(i);break}}};Xs.updateElementsInLayers=function(e,t){for(var n=this,r=fN(e[0]),i=0;i<e.length;i++)for(var s=r?null:e[i],a=r?e[i]:e[i].ele,o=a._private.rscratch,l=o.imgLayerCaches=o.imgLayerCaches||{},u=aA;u<=b5;u++){var c=l[u];!c||s&&n.getEleLevelForLayerLevel(c.level)!==s.level||t(c,a,s)}};Xs.haveLayers=function(){for(var e=this,t=!1,n=aA;n<=b5;n++){var r=e.layersByLevel[n];if(r&&r.length>0){t=!0;break}}return t};Xs.invalidateElements=function(e){var t=this;e.length!==0&&(t.lastInvalidationTime=Ap(),!(e.length===0||!t.haveLayers())&&t.updateElementsInLayers(e,function(r,i,s){t.invalidateLayer(r)}))};Xs.invalidateLayer=function(e){if(this.lastInvalidationTime=Ap(),!e.invalid){var t=e.level,n=e.eles,r=this.layersByLevel[t];R0(r,e),e.elesQueue=[],e.invalid=!0,e.replacement&&(e.replacement.invalid=!0);for(var i=0;i<n.length;i++){var s=n[i]._private.rscratch.imgLayerCaches;s&&(s[t]=null)}}};Xs.refineElementTextures=function(e){var t=this;t.updateElementsInLayers(e,function(r,i,s){var a=r.replacement;if(a||(a=r.replacement=t.makeLayer(r.bb,r.level),a.replaces=r,a.eles=r.eles),!a.reqs)for(var o=0;o<a.eles.length;o++)t.queueLayer(a,a.eles[o])})};Xs.enqueueElementRefinement=function(e){this.eleTxrDeqs.merge(e),this.scheduleElementRefinement()};Xs.queueLayer=function(e,t){var n=this,r=n.layersQueue,i=e.elesQueue,s=i.hasId=i.hasId||{};if(!e.replacement){if(t){if(s[t.id()])return;i.push(t),s[t.id()]=!0}e.reqs?(e.reqs++,r.updateItem(e)):(e.reqs=1,r.push(e))}};Xs.dequeue=function(e){for(var t=this,n=t.layersQueue,r=[],i=0;i<Nlt&&n.size()!==0;){var s=n.peek();if(s.replacement){n.pop();continue}if(s.replaces&&s!==s.replaces.replacement){n.pop();continue}if(s.invalid){n.pop();continue}var a=s.elesQueue.shift();a&&(t.drawEleInLayer(s,a,s.level,e),i++),r.length===0&&r.push(!0),s.elesQueue.length===0&&(n.pop(),s.reqs=0,s.replaces&&t.applyLayerReplacement(s),t.requestRedraw())}return r};Xs.applyLayerReplacement=function(e){var t=this,n=t.layersByLevel[e.level],r=e.replaces,i=n.indexOf(r);if(!(i<0||r.invalid)){n[i]=e;for(var s=0;s<e.eles.length;s++){var a=e.eles[s]._private,o=a.imgLayerCaches=a.imgLayerCaches||{};o&&(o[e.level]=e)}t.requestRedraw()}};Xs.requestRedraw=gB.default(function(){var e=this.renderer;e.redrawHint("eles",!0),e.redrawHint("drag",!0),e.redraw()},100);Xs.setupDequeueing=HEe.setupDequeueing({deqRedrawThreshold:Slt,deqCost:Elt,deqAvgCost:Alt,deqNoDrawCost:Tlt,deqFastCost:Dlt,deq:function(t,n){return t.dequeue(n)},onDeqd:Oee,shouldRedraw:Hke,priority:function(t){return t.renderer.beforeRenderPriorities.lyrTxrDeq}});var GEe={},tge;function Olt(e,t){for(var n=0;n<t.length;n++){var r=t[n];e.lineTo(r.x,r.y)}}function Rlt(e,t,n){for(var r,i=0;i<t.length;i++){var s=t[i];i===0&&(r=s),e.lineTo(s.x,s.y)}e.quadraticCurveTo(n.x,n.y,r.x,r.y)}function nge(e,t,n){e.beginPath&&e.beginPath();for(var r=t,i=0;i<r.length;i++){var s=r[i];e.lineTo(s.x,s.y)}var a=n,o=n[0];e.moveTo(o.x,o.y);for(var i=1;i<a.length;i++){var s=a[i];e.lineTo(s.x,s.y)}e.closePath&&e.closePath()}function Plt(e,t,n,r,i){e.beginPath&&e.beginPath(),e.arc(n,r,i,0,Math.PI*2,!1);var s=t,a=s[0];e.moveTo(a.x,a.y);for(var o=0;o<s.length;o++){var l=s[o];e.lineTo(l.x,l.y)}e.closePath&&e.closePath()}function Llt(e,t,n,r){e.arc(t,n,r,0,Math.PI*2,!1)}GEe.arrowShapeImpl=function(e){return(tge||(tge={polygon:Olt,"triangle-backcurve":Rlt,"triangle-tee":nge,"circle-triangle":Plt,"triangle-cross":nge,circle:Llt}))[e]};var rd={};rd.drawElement=function(e,t,n,r,i,s){var a=this;t.isNode()?a.drawNode(e,t,n,r,i,s):a.drawEdge(e,t,n,r,i,s)};rd.drawElementOverlay=function(e,t){var n=this;t.isNode()?n.drawNodeOverlay(e,t):n.drawEdgeOverlay(e,t)};rd.drawElementUnderlay=function(e,t){var n=this;t.isNode()?n.drawNodeUnderlay(e,t):n.drawEdgeUnderlay(e,t)};rd.drawCachedElementPortion=function(e,t,n,r,i,s,a,o){var l=this,u=n.getBoundingBox(t);if(!(u.w===0||u.h===0)){var c=n.getElement(t,u,r,i,s);if(c!=null){var f=o(l,t);if(f===0)return;var h=a(l,t),d=u.x1,p=u.y1,g=u.w,m=u.h,v,y,b,x,w;if(h!==0){var C=n.getRotationPoint(t);b=C.x,x=C.y,e.translate(b,x),e.rotate(h),w=l.getImgSmoothing(e),w||l.setImgSmoothing(e,!0);var $=n.getRotationOffset(t);v=$.x,y=$.y}else v=d,y=p;var _;f!==1&&(_=e.globalAlpha,e.globalAlpha=_*f),e.drawImage(c.texture.canvas,c.x,0,c.width,c.height,v,y,g,m),f!==1&&(e.globalAlpha=_),h!==0&&(e.rotate(-h),e.translate(-b,-x),w||l.setImgSmoothing(e,!1))}else n.drawElement(e,t)}};var Blt=function(){return 0},zlt=function(t,n){return t.getTextAngle(n,null)},Ult=function(t,n){return t.getTextAngle(n,"source")},Wlt=function(t,n){return t.getTextAngle(n,"target")},Vlt=function(t,n){return n.effectiveOpacity()},oj=function(t,n){return n.pstyle("text-opacity").pfValue*n.effectiveOpacity()};rd.drawCachedElement=function(e,t,n,r,i,s){var a=this,o=a.data,l=o.eleTxrCache,u=o.lblTxrCache,c=o.slbTxrCache,f=o.tlbTxrCache,h=t.boundingBox(),d=s===!0?l.reasons.highQuality:null;if(!(h.w===0||h.h===0||!t.visible())&&(!r||Lee(h,r))){var p=t.isEdge(),g=t.element()._private.rscratch.badLine;a.drawElementUnderlay(e,t),a.drawCachedElementPortion(e,t,l,n,i,d,Blt,Vlt),(!p||!g)&&a.drawCachedElementPortion(e,t,u,n,i,d,zlt,oj),p&&!g&&(a.drawCachedElementPortion(e,t,c,n,i,d,Ult,oj),a.drawCachedElementPortion(e,t,f,n,i,d,Wlt,oj)),a.drawElementOverlay(e,t)}};rd.drawElements=function(e,t){for(var n=this,r=0;r<t.length;r++){var i=t[r];n.drawElement(e,i)}};rd.drawCachedElements=function(e,t,n,r){for(var i=this,s=0;s<t.length;s++){var a=t[s];i.drawCachedElement(e,a,n,r)}};rd.drawCachedNodes=function(e,t,n,r){for(var i=this,s=0;s<t.length;s++){var a=t[s];!a.isNode()||i.drawCachedElement(e,a,n,r)}};rd.drawLayeredElements=function(e,t,n,r){var i=this,s=i.data.lyrTxrCache.getLayers(t,n);if(s)for(var a=0;a<s.length;a++){var o=s[a],l=o.bb;l.w===0||l.h===0||e.drawImage(o.canvas,l.x1,l.y1,l.w,l.h)}else i.drawCachedElements(e,t,n,r)};var Qp={};Qp.drawEdge=function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,a=this,o=t._private.rscratch;if(!(s&&!t.visible())&&!(o.badLine||o.allpts==null||isNaN(o.allpts[0]))){var l;n&&(l=n,e.translate(-l.x1,-l.y1));var u=s?t.pstyle("opacity").value:1,c=s?t.pstyle("line-opacity").value:1,f=t.pstyle("curve-style").value,h=t.pstyle("line-style").value,d=t.pstyle("width").pfValue,p=t.pstyle("line-cap").value,g=u*c,m=u*c,v=function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g;f==="straight-triangle"?(a.eleStrokeStyle(e,t,N),a.drawEdgeTrianglePath(t,e,o.allpts)):(e.lineWidth=d,e.lineCap=p,a.eleStrokeStyle(e,t,N),a.drawEdgePath(t,e,o.allpts,h),e.lineCap="butt")},y=function(){!i||a.drawEdgeOverlay(e,t)},b=function(){!i||a.drawEdgeUnderlay(e,t)},x=function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m;a.drawArrowheads(e,t,N)},w=function(){a.drawElementText(e,t,null,r)};e.lineJoin="round";var C=t.pstyle("ghost").value==="yes";if(C){var $=t.pstyle("ghost-offset-x").pfValue,_=t.pstyle("ghost-offset-y").pfValue,k=t.pstyle("ghost-opacity").value,E=g*k;e.translate($,_),v(E),x(E),e.translate(-$,-_)}b(),v(),x(),y(),w(),n&&e.translate(l.x1,l.y1)}};var YEe=function(t){if(!["overlay","underlay"].includes(t))throw new Error("Invalid state");return function(n,r){if(!!r.visible()){var i=r.pstyle("".concat(t,"-opacity")).value;if(i!==0){var s=this,a=s.usePaths(),o=r._private.rscratch,l=r.pstyle("".concat(t,"-padding")).pfValue,u=2*l,c=r.pstyle("".concat(t,"-color")).value;n.lineWidth=u,o.edgeType==="self"&&!a?n.lineCap="butt":n.lineCap="round",s.colorStrokeStyle(n,c[0],c[1],c[2],i),s.drawEdgePath(r,n,o.allpts,"solid")}}}};Qp.drawEdgeOverlay=YEe("overlay");Qp.drawEdgeUnderlay=YEe("underlay");Qp.drawEdgePath=function(e,t,n,r){var i=e._private.rscratch,s=t,a,o=!1,l=this.usePaths(),u=e.pstyle("line-dash-pattern").pfValue,c=e.pstyle("line-dash-offset").pfValue;if(l){var f=n.join("$"),h=i.pathCacheKey&&i.pathCacheKey===f;h?(a=t=i.pathCache,o=!0):(a=t=new Path2D,i.pathCacheKey=f,i.pathCache=a)}if(s.setLineDash)switch(r){case"dotted":s.setLineDash([1,1]);break;case"dashed":s.setLineDash(u),s.lineDashOffset=c;break;case"solid":s.setLineDash([]);break}if(!o&&!i.badLine)switch(t.beginPath&&t.beginPath(),t.moveTo(n[0],n[1]),i.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var d=2;d+3<n.length;d+=4)t.quadraticCurveTo(n[d],n[d+1],n[d+2],n[d+3]);break;case"straight":case"segments":case"haystack":for(var p=2;p+1<n.length;p+=2)t.lineTo(n[p],n[p+1]);break}t=s,l?t.stroke(a):t.stroke(),t.setLineDash&&t.setLineDash([])};Qp.drawEdgeTrianglePath=function(e,t,n){t.fillStyle=t.strokeStyle;for(var r=e.pstyle("width").pfValue,i=0;i+1<n.length;i+=2){var s=[n[i+2]-n[i],n[i+3]-n[i+1]],a=Math.sqrt(s[0]*s[0]+s[1]*s[1]),o=[s[1]/a,-s[0]/a],l=[o[0]*r/2,o[1]*r/2];t.beginPath(),t.moveTo(n[i]-l[0],n[i+1]-l[1]),t.lineTo(n[i]+l[0],n[i+1]+l[1]),t.lineTo(n[i+2],n[i+3]),t.closePath(),t.fill()}};Qp.drawArrowheads=function(e,t,n){var r=t._private.rscratch,i=r.edgeType==="haystack";i||this.drawArrowhead(e,t,"source",r.arrowStartX,r.arrowStartY,r.srcArrowAngle,n),this.drawArrowhead(e,t,"mid-target",r.midX,r.midY,r.midtgtArrowAngle,n),this.drawArrowhead(e,t,"mid-source",r.midX,r.midY,r.midsrcArrowAngle,n),i||this.drawArrowhead(e,t,"target",r.arrowEndX,r.arrowEndY,r.tgtArrowAngle,n)};Qp.drawArrowhead=function(e,t,n,r,i,s,a){if(!(isNaN(r)||r==null||isNaN(i)||i==null||isNaN(s)||s==null)){var o=this,l=t.pstyle(n+"-arrow-shape").value;if(l!=="none"){var u=t.pstyle(n+"-arrow-fill").value==="hollow"?"both":"filled",c=t.pstyle(n+"-arrow-fill").value,f=t.pstyle("width").pfValue,h=t.pstyle("opacity").value;a===void 0&&(a=h);var d=e.globalCompositeOperation;(a!==1||c==="hollow")&&(e.globalCompositeOperation="destination-out",o.colorFillStyle(e,255,255,255,1),o.colorStrokeStyle(e,255,255,255,1),o.drawArrowShape(t,e,u,f,l,r,i,s),e.globalCompositeOperation=d);var p=t.pstyle(n+"-arrow-color").value;o.colorFillStyle(e,p[0],p[1],p[2],a),o.colorStrokeStyle(e,p[0],p[1],p[2],a),o.drawArrowShape(t,e,c,f,l,r,i,s)}}};Qp.drawArrowShape=function(e,t,n,r,i,s,a,o){var l=this,u=this.usePaths()&&i!=="triangle-cross",c=!1,f,h=t,d={x:s,y:a},p=e.pstyle("arrow-scale").value,g=this.getArrowWidth(r,p),m=l.arrowShapes[i];if(u){var v=l.arrowPathCache=l.arrowPathCache||[],y=Sy(i),b=v[y];b!=null?(f=t=b,c=!0):(f=t=new Path2D,v[y]=f)}c||(t.beginPath&&t.beginPath(),u?m.draw(t,1,0,{x:0,y:0},1):m.draw(t,g,o,d,r),t.closePath&&t.closePath()),t=h,u&&(t.translate(s,a),t.rotate(o),t.scale(g,g)),(n==="filled"||n==="both")&&(u?t.fill(f):t.fill()),(n==="hollow"||n==="both")&&(t.lineWidth=(m.matchEdgeWidth?r:1)/(u?g:1),t.lineJoin="miter",u?t.stroke(f):t.stroke()),u&&(t.scale(1/g,1/g),t.rotate(-o),t.translate(-s,-a))};var Xee={};Xee.safeDrawImage=function(e,t,n,r,i,s,a,o,l,u){if(!(i<=0||s<=0||l<=0||u<=0))try{e.drawImage(t,n,r,i,s,a,o,l,u)}catch(c){Rn(c)}};Xee.drawInscribedImage=function(e,t,n,r,i){var s=this,a=n.position(),o=a.x,l=a.y,u=n.cy().style(),c=u.getIndexedStyle.bind(u),f=c(n,"background-fit","value",r),h=c(n,"background-repeat","value",r),d=n.width(),p=n.height(),g=n.padding()*2,m=d+(c(n,"background-width-relative-to","value",r)==="inner"?0:g),v=p+(c(n,"background-height-relative-to","value",r)==="inner"?0:g),y=n._private.rscratch,b=c(n,"background-clip","value",r),x=b==="node",w=c(n,"background-image-opacity","value",r)*i,C=c(n,"background-image-smoothing","value",r),$=t.width||t.cachedW,_=t.height||t.cachedH;($==null||_==null)&&(document.body.appendChild(t),$=t.cachedW=t.width||t.offsetWidth,_=t.cachedH=t.height||t.offsetHeight,document.body.removeChild(t));var k=$,E=_;if(c(n,"background-width","value",r)!=="auto"&&(c(n,"background-width","units",r)==="%"?k=c(n,"background-width","pfValue",r)*m:k=c(n,"background-width","pfValue",r)),c(n,"background-height","value",r)!=="auto"&&(c(n,"background-height","units",r)==="%"?E=c(n,"background-height","pfValue",r)*v:E=c(n,"background-height","pfValue",r)),!(k===0||E===0)){if(f==="contain"){var S=Math.min(m/k,v/E);k*=S,E*=S}else if(f==="cover"){var S=Math.max(m/k,v/E);k*=S,E*=S}var N=o-m/2,A=c(n,"background-position-x","units",r),D=c(n,"background-position-x","pfValue",r);A==="%"?N+=(m-k)*D:N+=D;var T=c(n,"background-offset-x","units",r),I=c(n,"background-offset-x","pfValue",r);T==="%"?N+=(m-k)*I:N+=I;var F=l-v/2,R=c(n,"background-position-y","units",r),P=c(n,"background-position-y","pfValue",r);R==="%"?F+=(v-E)*P:F+=P;var V=c(n,"background-offset-y","units",r),z=c(n,"background-offset-y","pfValue",r);V==="%"?F+=(v-E)*z:F+=z,y.pathCache&&(N-=o,F-=l,o=0,l=0);var q=e.globalAlpha;e.globalAlpha=w;var G=s.getImgSmoothing(e),K=!1;if(C==="no"&&G?(s.setImgSmoothing(e,!1),K=!0):C==="yes"&&!G&&(s.setImgSmoothing(e,!0),K=!0),h==="no-repeat")x&&(e.save(),y.pathCache?e.clip(y.pathCache):(s.nodeShapes[s.getNodeShape(n)].draw(e,o,l,m,v),e.clip())),s.safeDrawImage(e,t,0,0,$,_,N,F,k,E),x&&e.restore();else{var Y=e.createPattern(t,h);e.fillStyle=Y,s.nodeShapes[s.getNodeShape(n)].draw(e,o,l,m,v),e.translate(N,F),e.fill(),e.translate(-N,-F)}e.globalAlpha=q,K&&s.setImgSmoothing(e,G)}};var Pb={};Pb.eleTextBiggerThanMin=function(e,t){if(!t){var n=e.cy().zoom(),r=this.getPixelRatio(),i=Math.ceil(Pee(n*r));t=Math.pow(2,i)}var s=e.pstyle("font-size").pfValue*t,a=e.pstyle("min-zoomed-font-size").pfValue;return!(s<a)};Pb.drawElementText=function(e,t,n,r,i){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,a=this;if(r==null){if(s&&!a.eleTextBiggerThanMin(t))return}else if(r===!1)return;if(t.isNode()){var o=t.pstyle("label");if(!o||!o.value)return;var l=a.getLabelJustification(t);e.textAlign=l,e.textBaseline="bottom"}else{var u=t.element()._private.rscratch.badLine,c=t.pstyle("label"),f=t.pstyle("source-label"),h=t.pstyle("target-label");if(u||(!c||!c.value)&&(!f||!f.value)&&(!h||!h.value))return;e.textAlign="center",e.textBaseline="bottom"}var d=!n,p;n&&(p=n,e.translate(-p.x1,-p.y1)),i==null?(a.drawText(e,t,null,d,s),t.isEdge()&&(a.drawText(e,t,"source",d,s),a.drawText(e,t,"target",d,s))):a.drawText(e,t,i,d,s),n&&e.translate(p.x1,p.y1)};Pb.getFontCache=function(e){var t;this.fontCaches=this.fontCaches||[];for(var n=0;n<this.fontCaches.length;n++)if(t=this.fontCaches[n],t.context===e)return t;return t={context:e},this.fontCaches.push(t),t};Pb.setupTextStyle=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=t.pstyle("font-style").strValue,i=t.pstyle("font-size").pfValue+"px",s=t.pstyle("font-family").strValue,a=t.pstyle("font-weight").strValue,o=n?t.effectiveOpacity()*t.pstyle("text-opacity").value:1,l=t.pstyle("text-outline-opacity").value*o,u=t.pstyle("color").value,c=t.pstyle("text-outline-color").value;e.font=r+" "+a+" "+i+" "+s,e.lineJoin="round",this.colorFillStyle(e,u[0],u[1],u[2],o),this.colorStrokeStyle(e,c[0],c[1],c[2],l)};function jlt(e,t,n,r,i){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5;e.beginPath(),e.moveTo(t+s,n),e.lineTo(t+r-s,n),e.quadraticCurveTo(t+r,n,t+r,n+s),e.lineTo(t+r,n+i-s),e.quadraticCurveTo(t+r,n+i,t+r-s,n+i),e.lineTo(t+s,n+i),e.quadraticCurveTo(t,n+i,t,n+i-s),e.lineTo(t,n+s),e.quadraticCurveTo(t,n,t+s,n),e.closePath(),e.fill()}Pb.getTextAngle=function(e,t){var n,r=e._private,i=r.rscratch,s=t?t+"-":"",a=e.pstyle(s+"text-rotation"),o=vc(i,"labelAngle",t);return a.strValue==="autorotate"?n=e.isEdge()?o:0:a.strValue==="none"?n=0:n=a.pfValue,n};Pb.drawText=function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=t._private,a=s.rscratch,o=i?t.effectiveOpacity():1;if(!(i&&(o===0||t.pstyle("text-opacity").value===0))){n==="main"&&(n=null);var l=vc(a,"labelX",n),u=vc(a,"labelY",n),c,f,h=this.getLabelText(t,n);if(h!=null&&h!==""&&!isNaN(l)&&!isNaN(u)){this.setupTextStyle(e,t,i);var d=n?n+"-":"",p=vc(a,"labelWidth",n),g=vc(a,"labelHeight",n),m=t.pstyle(d+"text-margin-x").pfValue,v=t.pstyle(d+"text-margin-y").pfValue,y=t.isEdge(),b=t.pstyle("text-halign").value,x=t.pstyle("text-valign").value;y&&(b="center",x="center"),l+=m,u+=v;var w;switch(r?w=this.getTextAngle(t,n):w=0,w!==0&&(c=l,f=u,e.translate(c,f),e.rotate(w),l=0,u=0),x){case"top":break;case"center":u+=g/2;break;case"bottom":u+=g;break}var C=t.pstyle("text-background-opacity").value,$=t.pstyle("text-border-opacity").value,_=t.pstyle("text-border-width").pfValue,k=t.pstyle("text-background-padding").pfValue;if(C>0||_>0&&$>0){var E=l-k;switch(b){case"left":E-=p;break;case"center":E-=p/2;break}var S=u-g-k,N=p+2*k,A=g+2*k;if(C>0){var D=e.fillStyle,T=t.pstyle("text-background-color").value;e.fillStyle="rgba("+T[0]+","+T[1]+","+T[2]+","+C*o+")";var I=t.pstyle("text-background-shape").strValue;I.indexOf("round")===0?jlt(e,E,S,N,A,2):e.fillRect(E,S,N,A),e.fillStyle=D}if(_>0&&$>0){var F=e.strokeStyle,R=e.lineWidth,P=t.pstyle("text-border-color").value,V=t.pstyle("text-border-style").value;if(e.strokeStyle="rgba("+P[0]+","+P[1]+","+P[2]+","+$*o+")",e.lineWidth=_,e.setLineDash)switch(V){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"double":e.lineWidth=_/4,e.setLineDash([]);break;case"solid":e.setLineDash([]);break}if(e.strokeRect(E,S,N,A),V==="double"){var z=_/2;e.strokeRect(E+z,S+z,N-z*2,A-z*2)}e.setLineDash&&e.setLineDash([]),e.lineWidth=R,e.strokeStyle=F}}var q=2*t.pstyle("text-outline-width").pfValue;if(q>0&&(e.lineWidth=q),t.pstyle("text-wrap").value==="wrap"){var G=vc(a,"labelWrapCachedLines",n),K=vc(a,"labelLineHeight",n),Y=p/2,te=this.getLabelJustification(t);switch(te==="auto"||(b==="left"?te==="left"?l+=-p:te==="center"&&(l+=-Y):b==="center"?te==="left"?l+=-Y:te==="right"&&(l+=Y):b==="right"&&(te==="center"?l+=Y:te==="right"&&(l+=p))),x){case"top":u-=(G.length-1)*K;break;case"center":case"bottom":u-=(G.length-1)*K;break}for(var Z=0;Z<G.length;Z++)q>0&&e.strokeText(G[Z],l,u),e.fillText(G[Z],l,u),u+=K}else q>0&&e.strokeText(h,l,u),e.fillText(h,l,u);w!==0&&(e.rotate(-w),e.translate(-c,-f))}}};var kC={};kC.drawNode=function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,a=this,o,l,u=t._private,c=u.rscratch,f=t.position();if(!(!Pe(f.x)||!Pe(f.y))&&!(s&&!t.visible())){var h=s?t.effectiveOpacity():1,d=a.usePaths(),p,g=!1,m=t.padding();o=t.width()+2*m,l=t.height()+2*m;var v;n&&(v=n,e.translate(-v.x1,-v.y1));for(var y=t.pstyle("background-image"),b=y.value,x=new Array(b.length),w=new Array(b.length),C=0,$=0;$<b.length;$++){var _=b[$],k=x[$]=_!=null&&_!=="none";if(k){var E=t.cy().style().getIndexedStyle(t,"background-image-crossorigin","value",$);C++,w[$]=a.getCachedImage(_,E,function(){u.backgroundTimestamp=Date.now(),t.emitAndNotify("background")})}}var S=t.pstyle("background-blacken").value,N=t.pstyle("border-width").pfValue,A=t.pstyle("background-opacity").value*h,D=t.pstyle("border-color").value,T=t.pstyle("border-style").value,I=t.pstyle("border-opacity").value*h;e.lineJoin="miter";var F=function(){var Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:A;a.eleFillStyle(e,t,Ce)},R=function(){var Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I;a.colorStrokeStyle(e,D[0],D[1],D[2],Ce)},P=t.pstyle("shape").strValue,V=t.pstyle("shape-polygon-points").pfValue;if(d){e.translate(f.x,f.y);var z=a.nodePathCache=a.nodePathCache||[],q=jke(P==="polygon"?P+","+V.join(","):P,""+l,""+o),G=z[q];G!=null?(p=G,g=!0,c.pathCache=p):(p=new Path2D,z[q]=c.pathCache=p)}var K=function(){if(!g){var Ce=f;d&&(Ce={x:0,y:0}),a.nodeShapes[a.getNodeShape(t)].draw(p||e,Ce.x,Ce.y,o,l)}d?e.fill(p):e.fill()},Y=function(){for(var Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h,Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,et=u.backgrounding,dt=0,He=0;He<w.length;He++){var Se=t.cy().style().getIndexedStyle(t,"background-image-containment","value",He);if(Ue&&Se==="over"||!Ue&&Se==="inside"){dt++;continue}x[He]&&w[He].complete&&!w[He].error&&(dt++,a.drawInscribedImage(e,w[He],t,He,Ce))}u.backgrounding=dt!==C,et!==u.backgrounding&&t.updateStyle(!1)},te=function(){var Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h;a.hasPie(t)&&(a.drawPie(e,t,Ue),Ce&&(d||a.nodeShapes[a.getNodeShape(t)].draw(e,f.x,f.y,o,l)))},Z=function(){var Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h,Ue=(S>0?S:-S)*Ce,et=S>0?0:255;S!==0&&(a.colorFillStyle(e,et,et,et,Ue),d?e.fill(p):e.fill())},ae=function(){if(N>0){if(e.lineWidth=N,e.lineCap="butt",e.setLineDash)switch(T){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"solid":case"double":e.setLineDash([]);break}if(d?e.stroke(p):e.stroke(),T==="double"){e.lineWidth=N/3;var Ce=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",d?e.stroke(p):e.stroke(),e.globalCompositeOperation=Ce}e.setLineDash&&e.setLineDash([])}},O=function(){i&&a.drawNodeOverlay(e,t,f,o,l)},L=function(){i&&a.drawNodeUnderlay(e,t,f,o,l)},W=function(){a.drawElementText(e,t,null,r)},M=t.pstyle("ghost").value==="yes";if(M){var ue=t.pstyle("ghost-offset-x").pfValue,X=t.pstyle("ghost-offset-y").pfValue,se=t.pstyle("ghost-opacity").value,oe=se*h;e.translate(ue,X),F(se*A),K(),Y(oe,!0),R(se*I),ae(),te(S!==0||N!==0),Y(oe,!1),Z(oe),e.translate(-ue,-X)}d&&e.translate(-f.x,-f.y),L(),d&&e.translate(f.x,f.y),F(),K(),Y(h,!0),R(),ae(),te(S!==0||N!==0),Y(h,!1),Z(),d&&e.translate(-f.x,-f.y),W(),O(),n&&e.translate(v.x1,v.y1)}};var XEe=function(t){if(!["overlay","underlay"].includes(t))throw new Error("Invalid state");return function(n,r,i,s,a){var o=this;if(!!r.visible()){var l=r.pstyle("".concat(t,"-padding")).pfValue,u=r.pstyle("".concat(t,"-opacity")).value,c=r.pstyle("".concat(t,"-color")).value,f=r.pstyle("".concat(t,"-shape")).value;if(u>0){if(i=i||r.position(),s==null||a==null){var h=r.padding();s=r.width()+2*h,a=r.height()+2*h}o.colorFillStyle(n,c[0],c[1],c[2],u),o.nodeShapes[f].draw(n,i.x,i.y,s+l*2,a+l*2),n.fill()}}}};kC.drawNodeOverlay=XEe("overlay");kC.drawNodeUnderlay=XEe("underlay");kC.hasPie=function(e){return e=e[0],e._private.hasPie};kC.drawPie=function(e,t,n,r){t=t[0],r=r||t.position();var i=t.cy().style(),s=t.pstyle("pie-size"),a=r.x,o=r.y,l=t.width(),u=t.height(),c=Math.min(l,u)/2,f=0,h=this.usePaths();h&&(a=0,o=0),s.units==="%"?c=c*s.pfValue:s.pfValue!==void 0&&(c=s.pfValue/2);for(var d=1;d<=i.pieBackgroundN;d++){var p=t.pstyle("pie-"+d+"-background-size").value,g=t.pstyle("pie-"+d+"-background-color").value,m=t.pstyle("pie-"+d+"-background-opacity").value*n,v=p/100;v+f>1&&(v=1-f);var y=1.5*Math.PI+2*Math.PI*f,b=2*Math.PI*v,x=y+b;p===0||f>=1||f+v>1||(e.beginPath(),e.moveTo(a,o),e.arc(a,o,c,y,x),e.closePath(),this.colorFillStyle(e,g[0],g[1],g[2],m),e.fill(),f+=v)}};var Ql={},Hlt=100;Ql.getPixelRatio=function(){var e=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/t};Ql.paintCache=function(e){for(var t=this.paintCaches=this.paintCaches||[],n=!0,r,i=0;i<t.length;i++)if(r=t[i],r.context===e){n=!1;break}return n&&(r={context:e},t.push(r)),r};Ql.createGradientStyleFor=function(e,t,n,r,i){var s,a=this.usePaths(),o=n.pstyle(t+"-gradient-stop-colors").value,l=n.pstyle(t+"-gradient-stop-positions").pfValue;if(r==="radial-gradient")if(n.isEdge()){var u=n.sourceEndpoint(),c=n.targetEndpoint(),f=n.midpoint(),h=ky(u,f),d=ky(c,f);s=e.createRadialGradient(f.x,f.y,0,f.x,f.y,Math.max(h,d))}else{var p=a?{x:0,y:0}:n.position(),g=n.paddedWidth(),m=n.paddedHeight();s=e.createRadialGradient(p.x,p.y,0,p.x,p.y,Math.max(g,m))}else if(n.isEdge()){var v=n.sourceEndpoint(),y=n.targetEndpoint();s=e.createLinearGradient(v.x,v.y,y.x,y.y)}else{var b=a?{x:0,y:0}:n.position(),x=n.paddedWidth(),w=n.paddedHeight(),C=x/2,$=w/2,_=n.pstyle("background-gradient-direction").value;switch(_){case"to-bottom":s=e.createLinearGradient(b.x,b.y-$,b.x,b.y+$);break;case"to-top":s=e.createLinearGradient(b.x,b.y+$,b.x,b.y-$);break;case"to-left":s=e.createLinearGradient(b.x+C,b.y,b.x-C,b.y);break;case"to-right":s=e.createLinearGradient(b.x-C,b.y,b.x+C,b.y);break;case"to-bottom-right":case"to-right-bottom":s=e.createLinearGradient(b.x-C,b.y-$,b.x+C,b.y+$);break;case"to-top-right":case"to-right-top":s=e.createLinearGradient(b.x-C,b.y+$,b.x+C,b.y-$);break;case"to-bottom-left":case"to-left-bottom":s=e.createLinearGradient(b.x+C,b.y-$,b.x-C,b.y+$);break;case"to-top-left":case"to-left-top":s=e.createLinearGradient(b.x+C,b.y+$,b.x-C,b.y-$);break}}if(!s)return null;for(var k=l.length===o.length,E=o.length,S=0;S<E;S++)s.addColorStop(k?l[S]:S/(E-1),"rgba("+o[S][0]+","+o[S][1]+","+o[S][2]+","+i+")");return s};Ql.gradientFillStyle=function(e,t,n,r){var i=this.createGradientStyleFor(e,"background",t,n,r);if(!i)return null;e.fillStyle=i};Ql.colorFillStyle=function(e,t,n,r,i){e.fillStyle="rgba("+t+","+n+","+r+","+i+")"};Ql.eleFillStyle=function(e,t,n){var r=t.pstyle("background-fill").value;if(r==="linear-gradient"||r==="radial-gradient")this.gradientFillStyle(e,t,r,n);else{var i=t.pstyle("background-color").value;this.colorFillStyle(e,i[0],i[1],i[2],n)}};Ql.gradientStrokeStyle=function(e,t,n,r){var i=this.createGradientStyleFor(e,"line",t,n,r);if(!i)return null;e.strokeStyle=i};Ql.colorStrokeStyle=function(e,t,n,r,i){e.strokeStyle="rgba("+t+","+n+","+r+","+i+")"};Ql.eleStrokeStyle=function(e,t,n){var r=t.pstyle("line-fill").value;if(r==="linear-gradient"||r==="radial-gradient")this.gradientStrokeStyle(e,t,r,n);else{var i=t.pstyle("line-color").value;this.colorStrokeStyle(e,i[0],i[1],i[2],n)}};Ql.matchCanvasSize=function(e){var t=this,n=t.data,r=t.findContainerClientCoords(),i=r[2],s=r[3],a=t.getPixelRatio(),o=t.motionBlurPxRatio;(e===t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE]||e===t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG])&&(a=o);var l=i*a,u=s*a,c;if(!(l===t.canvasWidth&&u===t.canvasHeight)){t.fontCaches=null;var f=n.canvasContainer;f.style.width=i+"px",f.style.height=s+"px";for(var h=0;h<t.CANVAS_LAYERS;h++)c=n.canvases[h],c.width=l,c.height=u,c.style.width=i+"px",c.style.height=s+"px";for(var h=0;h<t.BUFFER_COUNT;h++)c=n.bufferCanvases[h],c.width=l,c.height=u,c.style.width=i+"px",c.style.height=s+"px";t.textureMult=1,a<=1&&(c=n.bufferCanvases[t.TEXTURE_BUFFER],t.textureMult=2,c.width=l*t.textureMult,c.height=u*t.textureMult),t.canvasWidth=l,t.canvasHeight=u}};Ql.renderTo=function(e,t,n,r){this.render({forcedContext:e,forcedZoom:t,forcedPan:n,drawAllLayers:!0,forcedPxRatio:r})};Ql.render=function(e){e=e||Yke();var t=e.forcedContext,n=e.drawAllLayers,r=e.drawOnlyNodeLayer,i=e.forcedZoom,s=e.forcedPan,a=this,o=e.forcedPxRatio===void 0?this.getPixelRatio():e.forcedPxRatio,l=a.cy,u=a.data,c=u.canvasNeedsRedraw,f=a.textureOnViewport&&!t&&(a.pinching||a.hoverData.dragging||a.swipePanning||a.data.wheelZooming),h=e.motionBlur!==void 0?e.motionBlur:a.motionBlur,d=a.motionBlurPxRatio,p=l.hasCompoundNodes(),g=a.hoverData.draggingEles,m=!!(a.hoverData.selecting||a.touchData.selecting);h=h&&!t&&a.motionBlurEnabled&&!m;var v=h;t||(a.prevPxRatio!==o&&(a.invalidateContainerClientCoordsCache(),a.matchCanvasSize(a.container),a.redrawHint("eles",!0),a.redrawHint("drag",!0)),a.prevPxRatio=o),!t&&a.motionBlurTimeout&&clearTimeout(a.motionBlurTimeout),h&&(a.mbFrames==null&&(a.mbFrames=0),a.mbFrames++,a.mbFrames<3&&(v=!1),a.mbFrames>a.minMbLowQualFrames&&(a.motionBlurPxRatio=a.mbPxRBlurry)),a.clearingMotionBlur&&(a.motionBlurPxRatio=1),a.textureDrawLastFrame&&!f&&(c[a.NODE]=!0,c[a.SELECT_BOX]=!0);var y=l.style(),b=l.zoom(),x=i!==void 0?i:b,w=l.pan(),C={x:w.x,y:w.y},$={zoom:b,pan:{x:w.x,y:w.y}},_=a.prevViewport,k=_===void 0||$.zoom!==_.zoom||$.pan.x!==_.pan.x||$.pan.y!==_.pan.y;!k&&!(g&&!p)&&(a.motionBlurPxRatio=1),s&&(C=s),x*=o,C.x*=o,C.y*=o;var E=a.getCachedZSortedEles();function S(X,se,oe,pe,Ce){var Ue=X.globalCompositeOperation;X.globalCompositeOperation="destination-out",a.colorFillStyle(X,255,255,255,a.motionBlurTransparency),X.fillRect(se,oe,pe,Ce),X.globalCompositeOperation=Ue}function N(X,se){var oe,pe,Ce,Ue;!a.clearingMotionBlur&&(X===u.bufferContexts[a.MOTIONBLUR_BUFFER_NODE]||X===u.bufferContexts[a.MOTIONBLUR_BUFFER_DRAG])?(oe={x:w.x*d,y:w.y*d},pe=b*d,Ce=a.canvasWidth*d,Ue=a.canvasHeight*d):(oe=C,pe=x,Ce=a.canvasWidth,Ue=a.canvasHeight),X.setTransform(1,0,0,1,0,0),se==="motionBlur"?S(X,0,0,Ce,Ue):!t&&(se===void 0||se)&&X.clearRect(0,0,Ce,Ue),n||(X.translate(oe.x,oe.y),X.scale(pe,pe)),s&&X.translate(s.x,s.y),i&&X.scale(i,i)}if(f||(a.textureDrawLastFrame=!1),f){if(a.textureDrawLastFrame=!0,!a.textureCache){a.textureCache={},a.textureCache.bb=l.mutableElements().boundingBox(),a.textureCache.texture=a.data.bufferCanvases[a.TEXTURE_BUFFER];var A=a.data.bufferContexts[a.TEXTURE_BUFFER];A.setTransform(1,0,0,1,0,0),A.clearRect(0,0,a.canvasWidth*a.textureMult,a.canvasHeight*a.textureMult),a.render({forcedContext:A,drawOnlyNodeLayer:!0,forcedPxRatio:o*a.textureMult});var $=a.textureCache.viewport={zoom:l.zoom(),pan:l.pan(),width:a.canvasWidth,height:a.canvasHeight};$.mpan={x:(0-$.pan.x)/$.zoom,y:(0-$.pan.y)/$.zoom}}c[a.DRAG]=!1,c[a.NODE]=!1;var D=u.contexts[a.NODE],T=a.textureCache.texture,$=a.textureCache.viewport;D.setTransform(1,0,0,1,0,0),h?S(D,0,0,$.width,$.height):D.clearRect(0,0,$.width,$.height);var I=y.core("outside-texture-bg-color").value,F=y.core("outside-texture-bg-opacity").value;a.colorFillStyle(D,I[0],I[1],I[2],F),D.fillRect(0,0,$.width,$.height);var b=l.zoom();N(D,!1),D.clearRect($.mpan.x,$.mpan.y,$.width/$.zoom/o,$.height/$.zoom/o),D.drawImage(T,$.mpan.x,$.mpan.y,$.width/$.zoom/o,$.height/$.zoom/o)}else a.textureOnViewport&&!t&&(a.textureCache=null);var R=l.extent(),P=a.pinching||a.hoverData.dragging||a.swipePanning||a.data.wheelZooming||a.hoverData.draggingEles||a.cy.animated(),V=a.hideEdgesOnViewport&&P,z=[];if(z[a.NODE]=!c[a.NODE]&&h&&!a.clearedForMotionBlur[a.NODE]||a.clearingMotionBlur,z[a.NODE]&&(a.clearedForMotionBlur[a.NODE]=!0),z[a.DRAG]=!c[a.DRAG]&&h&&!a.clearedForMotionBlur[a.DRAG]||a.clearingMotionBlur,z[a.DRAG]&&(a.clearedForMotionBlur[a.DRAG]=!0),c[a.NODE]||n||r||z[a.NODE]){var q=h&&!z[a.NODE]&&d!==1,D=t||(q?a.data.bufferContexts[a.MOTIONBLUR_BUFFER_NODE]:u.contexts[a.NODE]),G=h&&!q?"motionBlur":void 0;N(D,G),V?a.drawCachedNodes(D,E.nondrag,o,R):a.drawLayeredElements(D,E.nondrag,o,R),a.debug&&a.drawDebugPoints(D,E.nondrag),!n&&!h&&(c[a.NODE]=!1)}if(!r&&(c[a.DRAG]||n||z[a.DRAG])){var q=h&&!z[a.DRAG]&&d!==1,D=t||(q?a.data.bufferContexts[a.MOTIONBLUR_BUFFER_DRAG]:u.contexts[a.DRAG]);N(D,h&&!q?"motionBlur":void 0),V?a.drawCachedNodes(D,E.drag,o,R):a.drawCachedElements(D,E.drag,o,R),a.debug&&a.drawDebugPoints(D,E.drag),!n&&!h&&(c[a.DRAG]=!1)}if(a.showFps||!r&&c[a.SELECT_BOX]&&!n){var D=t||u.contexts[a.SELECT_BOX];if(N(D),a.selection[4]==1&&(a.hoverData.selecting||a.touchData.selecting)){var b=a.cy.zoom(),K=y.core("selection-box-border-width").value/b;D.lineWidth=K,D.fillStyle="rgba("+y.core("selection-box-color").value[0]+","+y.core("selection-box-color").value[1]+","+y.core("selection-box-color").value[2]+","+y.core("selection-box-opacity").value+")",D.fillRect(a.selection[0],a.selection[1],a.selection[2]-a.selection[0],a.selection[3]-a.selection[1]),K>0&&(D.strokeStyle="rgba("+y.core("selection-box-border-color").value[0]+","+y.core("selection-box-border-color").value[1]+","+y.core("selection-box-border-color").value[2]+","+y.core("selection-box-opacity").value+")",D.strokeRect(a.selection[0],a.selection[1],a.selection[2]-a.selection[0],a.selection[3]-a.selection[1]))}if(u.bgActivePosistion&&!a.hoverData.selecting){var b=a.cy.zoom(),Y=u.bgActivePosistion;D.fillStyle="rgba("+y.core("active-bg-color").value[0]+","+y.core("active-bg-color").value[1]+","+y.core("active-bg-color").value[2]+","+y.core("active-bg-opacity").value+")",D.beginPath(),D.arc(Y.x,Y.y,y.core("active-bg-size").pfValue/b,0,2*Math.PI),D.fill()}var te=a.lastRedrawTime;if(a.showFps&&te){te=Math.round(te);var Z=Math.round(1e3/te);D.setTransform(1,0,0,1,0,0),D.fillStyle="rgba(255, 0, 0, 0.75)",D.strokeStyle="rgba(255, 0, 0, 0.75)",D.lineWidth=1,D.fillText("1 frame = "+te+" ms = "+Z+" fps",0,20);var ae=60;D.strokeRect(0,30,250,20),D.fillRect(0,30,250*Math.min(Z/ae,1),20)}n||(c[a.SELECT_BOX]=!1)}if(h&&d!==1){var O=u.contexts[a.NODE],L=a.data.bufferCanvases[a.MOTIONBLUR_BUFFER_NODE],W=u.contexts[a.DRAG],M=a.data.bufferCanvases[a.MOTIONBLUR_BUFFER_DRAG],ue=function(se,oe,pe){se.setTransform(1,0,0,1,0,0),pe||!v?se.clearRect(0,0,a.canvasWidth,a.canvasHeight):S(se,0,0,a.canvasWidth,a.canvasHeight);var Ce=d;se.drawImage(oe,0,0,a.canvasWidth*Ce,a.canvasHeight*Ce,0,0,a.canvasWidth,a.canvasHeight)};(c[a.NODE]||z[a.NODE])&&(ue(O,L,z[a.NODE]),c[a.NODE]=!1),(c[a.DRAG]||z[a.DRAG])&&(ue(W,M,z[a.DRAG]),c[a.DRAG]=!1)}a.prevViewport=$,a.clearingMotionBlur&&(a.clearingMotionBlur=!1,a.motionBlurCleared=!0,a.motionBlur=!0),h&&(a.motionBlurTimeout=setTimeout(function(){a.motionBlurTimeout=null,a.clearedForMotionBlur[a.NODE]=!1,a.clearedForMotionBlur[a.DRAG]=!1,a.motionBlur=!1,a.clearingMotionBlur=!f,a.mbFrames=0,c[a.NODE]=!0,c[a.DRAG]=!0,a.redraw()},Hlt)),t||l.emit("render")};var Pm={};Pm.drawPolygonPath=function(e,t,n,r,i,s){var a=r/2,o=i/2;e.beginPath&&e.beginPath(),e.moveTo(t+a*s[0],n+o*s[1]);for(var l=1;l<s.length/2;l++)e.lineTo(t+a*s[l*2],n+o*s[l*2+1]);e.closePath()};Pm.drawRoundPolygonPath=function(e,t,n,r,i,s){var a=r/2,o=i/2,l=Bee(r,i);e.beginPath&&e.beginPath();for(var u=0;u<s.length/4;u++){var c=void 0,f=void 0;u===0?c=s.length-2:c=u*4-2,f=u*4+2;var h=t+a*s[u*4],d=n+o*s[u*4+1],p=-s[c]*s[f]-s[c+1]*s[f+1],g=l/Math.tan(Math.acos(p)/2),m=h-g*s[c],v=d-g*s[c+1],y=h+g*s[f],b=d+g*s[f+1];u===0?e.moveTo(m,v):e.lineTo(m,v),e.arcTo(h,d,y,b,l)}e.closePath()};Pm.drawRoundRectanglePath=function(e,t,n,r,i){var s=r/2,a=i/2,o=hN(r,i);e.beginPath&&e.beginPath(),e.moveTo(t,n-a),e.arcTo(t+s,n-a,t+s,n,o),e.arcTo(t+s,n+a,t,n+a,o),e.arcTo(t-s,n+a,t-s,n,o),e.arcTo(t-s,n-a,t,n-a,o),e.lineTo(t,n-a),e.closePath()};Pm.drawBottomRoundRectanglePath=function(e,t,n,r,i){var s=r/2,a=i/2,o=hN(r,i);e.beginPath&&e.beginPath(),e.moveTo(t,n-a),e.lineTo(t+s,n-a),e.lineTo(t+s,n),e.arcTo(t+s,n+a,t,n+a,o),e.arcTo(t-s,n+a,t-s,n,o),e.lineTo(t-s,n-a),e.lineTo(t,n-a),e.closePath()};Pm.drawCutRectanglePath=function(e,t,n,r,i){var s=r/2,a=i/2,o=nEe();e.beginPath&&e.beginPath(),e.moveTo(t-s+o,n-a),e.lineTo(t+s-o,n-a),e.lineTo(t+s,n-a+o),e.lineTo(t+s,n+a-o),e.lineTo(t+s-o,n+a),e.lineTo(t-s+o,n+a),e.lineTo(t-s,n+a-o),e.lineTo(t-s,n-a+o),e.closePath()};Pm.drawBarrelPath=function(e,t,n,r,i){var s=r/2,a=i/2,o=t-s,l=t+s,u=n-a,c=n+a,f=hY(r,i),h=f.widthOffset,d=f.heightOffset,p=f.ctrlPtOffsetPct*h;e.beginPath&&e.beginPath(),e.moveTo(o,u+d),e.lineTo(o,c-d),e.quadraticCurveTo(o+p,c,o+h,c),e.lineTo(l-h,c),e.quadraticCurveTo(l-p,c,l,c-d),e.lineTo(l,u+d),e.quadraticCurveTo(l-p,u,l-h,u),e.lineTo(o+h,u),e.quadraticCurveTo(o+p,u,o,u+d),e.closePath()};var rge=Math.sin(0),ige=Math.cos(0),xY={},wY={},KEe=Math.PI/40;for(var Jx=0*Math.PI;Jx<2*Math.PI;Jx+=KEe)xY[Jx]=Math.sin(Jx),wY[Jx]=Math.cos(Jx);Pm.drawEllipsePath=function(e,t,n,r,i){if(e.beginPath&&e.beginPath(),e.ellipse)e.ellipse(t,n,r/2,i/2,0,0,2*Math.PI);else for(var s,a,o=r/2,l=i/2,u=0*Math.PI;u<2*Math.PI;u+=KEe)s=t-o*xY[u]*rge+o*wY[u]*ige,a=n+l*wY[u]*rge+l*xY[u]*ige,u===0?e.moveTo(s,a):e.lineTo(s,a);e.closePath()};var vN={};vN.createBuffer=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,[n,n.getContext("2d")]};vN.bufferCanvasImage=function(e){var t=this.cy,n=t.mutableElements(),r=n.boundingBox(),i=this.findContainerClientCoords(),s=e.full?Math.ceil(r.w):i[2],a=e.full?Math.ceil(r.h):i[3],o=Pe(e.maxWidth)||Pe(e.maxHeight),l=this.getPixelRatio(),u=1;if(e.scale!==void 0)s*=e.scale,a*=e.scale,u=e.scale;else if(o){var c=1/0,f=1/0;Pe(e.maxWidth)&&(c=u*e.maxWidth/s),Pe(e.maxHeight)&&(f=u*e.maxHeight/a),u=Math.min(c,f),s*=u,a*=u}o||(s*=l,a*=l,u*=l);var h=document.createElement("canvas");h.width=s,h.height=a,h.style.width=s+"px",h.style.height=a+"px";var d=h.getContext("2d");if(s>0&&a>0){d.clearRect(0,0,s,a),d.globalCompositeOperation="source-over";var p=this.getCachedZSortedEles();if(e.full)d.translate(-r.x1*u,-r.y1*u),d.scale(u,u),this.drawElements(d,p),d.scale(1/u,1/u),d.translate(r.x1*u,r.y1*u);else{var g=t.pan(),m={x:g.x*u,y:g.y*u};u*=t.zoom(),d.translate(m.x,m.y),d.scale(u,u),this.drawElements(d,p),d.scale(1/u,1/u),d.translate(-m.x,-m.y)}e.bg&&(d.globalCompositeOperation="destination-over",d.fillStyle=e.bg,d.rect(0,0,s,a),d.fill())}return h};function qlt(e,t){for(var n=atob(e),r=new ArrayBuffer(n.length),i=new Uint8Array(r),s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return new Blob([r],{type:t})}function sge(e){var t=e.indexOf(",");return e.substr(t+1)}function ZEe(e,t,n){var r=function(){return t.toDataURL(n,e.quality)};switch(e.output){case"blob-promise":return new wC(function(i,s){try{t.toBlob(function(a){a!=null?i(a):s(new Error("`canvas.toBlob()` sent a null value in its callback"))},n,e.quality)}catch(a){s(a)}});case"blob":return qlt(sge(r()),n);case"base64":return sge(r());case"base64uri":default:return r()}}vN.png=function(e){return ZEe(e,this.bufferCanvasImage(e),"image/png")};vN.jpg=function(e){return ZEe(e,this.bufferCanvasImage(e),"image/jpeg")};var QEe={};QEe.nodeShapeImpl=function(e,t,n,r,i,s,a){switch(e){case"ellipse":return this.drawEllipsePath(t,n,r,i,s);case"polygon":return this.drawPolygonPath(t,n,r,i,s,a);case"round-polygon":return this.drawRoundPolygonPath(t,n,r,i,s,a);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(t,n,r,i,s);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(t,n,r,i,s);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(t,n,r,i,s);case"barrel":return this.drawBarrelPath(t,n,r,i,s)}};var Glt=JEe,vn=JEe.prototype;vn.CANVAS_LAYERS=3;vn.SELECT_BOX=0;vn.DRAG=1;vn.NODE=2;vn.BUFFER_COUNT=3;vn.TEXTURE_BUFFER=0;vn.MOTIONBLUR_BUFFER_NODE=1;vn.MOTIONBLUR_BUFFER_DRAG=2;function JEe(e){var t=this;t.data={canvases:new Array(vn.CANVAS_LAYERS),contexts:new Array(vn.CANVAS_LAYERS),canvasNeedsRedraw:new Array(vn.CANVAS_LAYERS),bufferCanvases:new Array(vn.BUFFER_COUNT),bufferContexts:new Array(vn.CANVAS_LAYERS)};var n="-webkit-tap-highlight-color",r="rgba(0,0,0,0)";t.data.canvasContainer=document.createElement("div");var i=t.data.canvasContainer.style;t.data.canvasContainer.style[n]=r,i.position="relative",i.zIndex="0",i.overflow="hidden";var s=e.cy.container();s.appendChild(t.data.canvasContainer),s.style[n]=r;var a={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};Ait()&&(a["-ms-touch-action"]="none",a["touch-action"]="none");for(var o=0;o<vn.CANVAS_LAYERS;o++){var l=t.data.canvases[o]=document.createElement("canvas");t.data.contexts[o]=l.getContext("2d"),Object.keys(a).forEach(function(te){l.style[te]=a[te]}),l.style.position="absolute",l.setAttribute("data-id","layer"+o),l.style.zIndex=String(vn.CANVAS_LAYERS-o),t.data.canvasContainer.appendChild(l),t.data.canvasNeedsRedraw[o]=!1}t.data.topCanvas=t.data.canvases[0],t.data.canvases[vn.NODE].setAttribute("data-id","layer"+vn.NODE+"-node"),t.data.canvases[vn.SELECT_BOX].setAttribute("data-id","layer"+vn.SELECT_BOX+"-selectbox"),t.data.canvases[vn.DRAG].setAttribute("data-id","layer"+vn.DRAG+"-drag");for(var o=0;o<vn.BUFFER_COUNT;o++)t.data.bufferCanvases[o]=document.createElement("canvas"),t.data.bufferContexts[o]=t.data.bufferCanvases[o].getContext("2d"),t.data.bufferCanvases[o].style.position="absolute",t.data.bufferCanvases[o].setAttribute("data-id","buffer"+o),t.data.bufferCanvases[o].style.zIndex=String(-o-1),t.data.bufferCanvases[o].style.visibility="hidden";t.pathsEnabled=!0;var u=il(),c=function(Z){return{x:(Z.x1+Z.x2)/2,y:(Z.y1+Z.y2)/2}},f=function(Z){return{x:-Z.w/2,y:-Z.h/2}},h=function(Z){var ae=Z[0]._private,O=ae.oldBackgroundTimestamp===ae.backgroundTimestamp;return!O},d=function(Z){return Z[0]._private.nodeKey},p=function(Z){return Z[0]._private.labelStyleKey},g=function(Z){return Z[0]._private.sourceLabelStyleKey},m=function(Z){return Z[0]._private.targetLabelStyleKey},v=function(Z,ae,O,L,W){return t.drawElement(Z,ae,O,!1,!1,W)},y=function(Z,ae,O,L,W){return t.drawElementText(Z,ae,O,L,"main",W)},b=function(Z,ae,O,L,W){return t.drawElementText(Z,ae,O,L,"source",W)},x=function(Z,ae,O,L,W){return t.drawElementText(Z,ae,O,L,"target",W)},w=function(Z){return Z.boundingBox(),Z[0]._private.bodyBounds},C=function(Z){return Z.boundingBox(),Z[0]._private.labelBounds.main||u},$=function(Z){return Z.boundingBox(),Z[0]._private.labelBounds.source||u},_=function(Z){return Z.boundingBox(),Z[0]._private.labelBounds.target||u},k=function(Z,ae){return ae},E=function(Z){return c(w(Z))},S=function(Z,ae,O){var L=Z?Z+"-":"";return{x:ae.x+O.pstyle(L+"text-margin-x").pfValue,y:ae.y+O.pstyle(L+"text-margin-y").pfValue}},N=function(Z,ae,O){var L=Z[0]._private.rscratch;return{x:L[ae],y:L[O]}},A=function(Z){return S("",N(Z,"labelX","labelY"),Z)},D=function(Z){return S("source",N(Z,"sourceLabelX","sourceLabelY"),Z)},T=function(Z){return S("target",N(Z,"targetLabelX","targetLabelY"),Z)},I=function(Z){return f(w(Z))},F=function(Z){return f($(Z))},R=function(Z){return f(_(Z))},P=function(Z){var ae=C(Z),O=f(C(Z));if(Z.isNode()){switch(Z.pstyle("text-halign").value){case"left":O.x=-ae.w;break;case"right":O.x=0;break}switch(Z.pstyle("text-valign").value){case"top":O.y=-ae.h;break;case"bottom":O.y=0;break}}return O},V=t.data.eleTxrCache=new rE(t,{getKey:d,doesEleInvalidateKey:h,drawElement:v,getBoundingBox:w,getRotationPoint:E,getRotationOffset:I,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),z=t.data.lblTxrCache=new rE(t,{getKey:p,drawElement:y,getBoundingBox:C,getRotationPoint:A,getRotationOffset:P,isVisible:k}),q=t.data.slbTxrCache=new rE(t,{getKey:g,drawElement:b,getBoundingBox:$,getRotationPoint:D,getRotationOffset:F,isVisible:k}),G=t.data.tlbTxrCache=new rE(t,{getKey:m,drawElement:x,getBoundingBox:_,getRotationPoint:T,getRotationOffset:R,isVisible:k}),K=t.data.lyrTxrCache=new qEe(t);t.onUpdateEleCalcs(function(Z,ae){V.invalidateElements(ae),z.invalidateElements(ae),q.invalidateElements(ae),G.invalidateElements(ae),K.invalidateElements(ae);for(var O=0;O<ae.length;O++){var L=ae[O]._private;L.oldBackgroundTimestamp=L.backgroundTimestamp}});var Y=function(Z){for(var ae=0;ae<Z.length;ae++)K.enqueueElementRefinement(Z[ae].ele)};V.onDequeue(Y),z.onDequeue(Y),q.onDequeue(Y),G.onDequeue(Y)}vn.redrawHint=function(e,t){var n=this;switch(e){case"eles":n.data.canvasNeedsRedraw[vn.NODE]=t;break;case"drag":n.data.canvasNeedsRedraw[vn.DRAG]=t;break;case"select":n.data.canvasNeedsRedraw[vn.SELECT_BOX]=t;break}};var Ylt=typeof Path2D<"u";vn.path2dEnabled=function(e){if(e===void 0)return this.pathsEnabled;this.pathsEnabled=!!e};vn.usePaths=function(){return Ylt&&this.pathsEnabled};vn.setImgSmoothing=function(e,t){e.imageSmoothingEnabled!=null?e.imageSmoothingEnabled=t:(e.webkitImageSmoothingEnabled=t,e.mozImageSmoothingEnabled=t,e.msImageSmoothingEnabled=t)};vn.getImgSmoothing=function(e){return e.imageSmoothingEnabled!=null?e.imageSmoothingEnabled:e.webkitImageSmoothingEnabled||e.mozImageSmoothingEnabled||e.msImageSmoothingEnabled};vn.makeOffscreenCanvas=function(e,t){var n;return(typeof OffscreenCanvas>"u"?"undefined":Mi(OffscreenCanvas))!=="undefined"?n=new OffscreenCanvas(e,t):(n=document.createElement("canvas"),n.width=e,n.height=t),n};[GEe,rd,Qp,Xee,Pb,kC,Ql,Pm,vN,QEe].forEach(function(e){gt(vn,e)});var Xlt=[{name:"null",impl:PEe},{name:"base",impl:jEe},{name:"canvas",impl:Glt}],Klt=[{type:"layout",extensions:rlt},{type:"renderer",extensions:Xlt}],eAe={},tAe={};function nAe(e,t,n){var r=n,i=function(_){Rn("Can not register `"+t+"` for `"+e+"` since `"+_+"` already exists in the prototype and can not be overridden")};if(e==="core"){if(uT.prototype[t])return i(t);uT.prototype[t]=n}else if(e==="collection"){if(Us.prototype[t])return i(t);Us.prototype[t]=n}else if(e==="layout"){for(var s=function(_){this.options=_,n.call(this,_),pn(this._private)||(this._private={}),this._private.cy=_.cy,this._private.listeners=[],this.createEmitter()},a=s.prototype=Object.create(n.prototype),o=[],l=0;l<o.length;l++){var u=o[l];a[u]=a[u]||function(){return this}}a.start&&!a.run?a.run=function(){return this.start(),this}:!a.start&&a.run&&(a.start=function(){return this.run(),this});var c=n.prototype.stop;a.stop=function(){var $=this.options;if($&&$.animate){var _=this.animations;if(_)for(var k=0;k<_.length;k++)_[k].stop()}return c?c.call(this):this.emit("layoutstop"),this},a.destroy||(a.destroy=function(){return this}),a.cy=function(){return this._private.cy};var f=function(_){return _._private.cy},h={addEventFields:function(_,k){k.layout=_,k.cy=f(_),k.target=_},bubble:function(){return!0},parent:function(_){return f(_)}};gt(a,{createEmitter:function(){return this._private.emitter=new wB(h,this),this},emitter:function(){return this._private.emitter},on:function(_,k){return this.emitter().on(_,k),this},one:function(_,k){return this.emitter().one(_,k),this},once:function(_,k){return this.emitter().one(_,k),this},removeListener:function(_,k){return this.emitter().removeListener(_,k),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(_,k){return this.emitter().emit(_,k),this}}),Fn.eventAliasesOn(a),r=s}else if(e==="renderer"&&t!=="null"&&t!=="base"){var d=rAe("renderer","base"),p=d.prototype,g=n,m=n.prototype,v=function(){d.apply(this,arguments),g.apply(this,arguments)},y=v.prototype;for(var b in p){var x=p[b],w=m[b]!=null;if(w)return i(b);y[b]=x}for(var C in m)y[C]=m[C];p.clientFunctions.forEach(function($){y[$]=y[$]||function(){Xr("Renderer does not implement `renderer."+$+"()` on its prototype")}}),r=v}else if(e==="__proto__"||e==="constructor"||e==="prototype")return Xr(e+" is an illegal type to be registered, possibly lead to prototype pollutions");return Bke({map:eAe,keys:[e,t],value:r})}function rAe(e,t){return zke({map:eAe,keys:[e,t]})}function Zlt(e,t,n,r,i){return Bke({map:tAe,keys:[e,t,n,r],value:i})}function Qlt(e,t,n,r){return zke({map:tAe,keys:[e,t,n,r]})}var $Y=function(){if(arguments.length===2)return rAe.apply(null,arguments);if(arguments.length===3)return nAe.apply(null,arguments);if(arguments.length===4)return Qlt.apply(null,arguments);if(arguments.length===5)return Zlt.apply(null,arguments);Xr("Invalid extension access syntax")};uT.prototype.extension=$Y;Klt.forEach(function(e){e.extensions.forEach(function(t){nAe(e.type,t.name,t.impl)})});var iAe=function e(){if(!(this instanceof e))return new e;this.length=0},Ty=iAe.prototype;Ty.instanceString=function(){return"stylesheet"};Ty.selector=function(e){var t=this.length++;return this[t]={selector:e,properties:[]},this};Ty.css=function(e,t){var n=this.length-1;if(rt(e))this[n].properties.push({name:e,value:t});else if(pn(e))for(var r=e,i=Object.keys(r),s=0;s<i.length;s++){var a=i[s],o=r[a];if(o!=null){var l=wa.properties[a]||wa.properties[mB(a)];if(l!=null){var u=l.name,c=o;this[n].properties.push({name:u,value:c})}}}return this};Ty.style=Ty.css;Ty.generateStyle=function(e){var t=new wa(e);return this.appendToStyle(t)};Ty.appendToStyle=function(e){for(var t=0;t<this.length;t++){var n=this[t],r=n.selector,i=n.properties;e.selector(r);for(var s=0;s<i.length;s++){var a=i[s];e.css(a.name,a.value)}}return e};var Jlt="3.25.0",Dy=function(t){if(t===void 0&&(t={}),pn(t))return new uT(t);if(rt(t))return $Y.apply($Y,arguments)};Dy.use=function(e){var t=Array.prototype.slice.call(arguments,1);return t.unshift(Dy),e.apply(null,t),this};Dy.warnings=function(e){return qke(e)};Dy.version=Jlt;Dy.stylesheet=Dy.Stylesheet=iAe;var age=Dy;const eut=HSe({__proto__:null,default:age},[age]),S1={right:["settings","network","dataSet","train","predict","layer","neuron","edge"]},TB="panels";class tut{constructor(t,n){this.host=t,t.addController(this),this.LAYER_WIDTH=300,this.LAYER_PADDING=20,this.LAYER_DISTANCE=150,this.NEURON_SIZE=100,this.NEURON_DISTANCE=40,this.cy=eut({container:n,elements:[],style:[{selector:'node[type="layer"]',style:{shape:"round-rectangle","background-color":"#ffffff","border-color":"#efefef","border-width":5,padding:this.LAYER_PADDING,label:"data(label)","text-halign":"left","text-valign":"center","text-margin-x":-20,"z-compound-depth":"bottom"}},{selector:'node[type="layer"]:selected',style:{"border-color":"#26A269"}},{selector:'node[type="neuron-wrapper"]',style:{shape:"round-rectangle","border-width":5,"border-color":"black",padding:0,label:"data(label)","text-halign":"center","text-valign":"bottom","text-margin-y":20,"z-compound-depth":"bottom"}},{selector:'node[type="neuron"]',style:{shape:"round-rectangle","background-color":"white","border-width":5,"border-color":"#0183C7",width:"95px",height:"95px",label:"data(label)","text-halign":"center","text-valign":"center","z-compound-depth":"bottom"}},{selector:'node[type="neuron"][wrapped="true"]',style:{width:"90px",height:"90px"}},{selector:'node[type="neuron"]:selected',style:{"border-color":"#26A269"}},{selector:"edge",style:{width:3,"line-color":"lightgray","target-arrow-color":"gray","target-arrow-shape":"triangle","curve-style":"bezier"}},{selector:"edge:selected",style:{"line-color":"#26A269","target-arrow-color":"#26A269"}}],wheelSensitivity:.2,boxSelectionEnabled:!1,selectionType:"single"}),this.cy.on("tap",r=>{r.target===this.cy&&(this.host.selected.select(),this.host.panels.close(...S1.right))}),this.cy.on("select","node, edge",r=>{const i=r.target;if(this.cy.elements().not(i).unselect(),i.isNode()){const s=i;if(s.data("type")=="layer"){const a=this.host.networkConf.layers.get(s.data("layer"));this.host.selected.select({layer:a})}else if(s.data("type")=="neuron"){const a=this.host.networkConf.layers.get(s.data("layer")),o=a.neurons[s.data("neuron")-1];this.host.selected.select({layer:a,neuron:o})}}else if(i.isEdge()){const s=i,a=this.host.networkConf.layers.get(s.source().data("layer"));let o=null;o=a.neurons[s.source().data("neuron")-1];const l=this.host.networkConf.layers.get(s.target().data("layer"));let u=null;u=l.neurons[s.target().data("neuron")-1];const c={sourceLayer:a,sourceNeuron:o,targetLayer:l,targetNeuron:u};this.host.selected.select({edge:c})}})}hostConnected(){console.log("canvas controller connected")}hostDisconnected(){console.log("canvas controller disconnected")}zoomOut(){this.cy&&this.cy.zoom(this.cy.zoom()-.1)}fit(){this.cy&&this.cy.fit(this.cy.$(""),30)}zoomIn(){this.cy&&this.cy.zoom(this.cy.zoom()+.1)}getHeight(t){return this.cy.getElementById(t).outerHeight()}generatePos(){const t=this.cy.extent();return{x:t.x1+(t.x2-t.x1)/2,y:t.y1+(t.y2-t.y1)/2}}}const Lm="canvas";var nut=Object.defineProperty,rut=Object.getOwnPropertyDescriptor,DB=(e,t,n,r)=>{for(var i=r>1?void 0:r?rut(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&nut(t,n,i),i};let Dw=class extends _t{_handleClick(){this.canvas.cy.getElementById(this.target.getCyId()).select()}render(){return he`
      <sl-button 
        size="small" 
        pill 
        @click="${e=>this._handleClick()}"
      >
        <slot>
      </sl-button>
    `}};Dw.styles=[St];DB([Q({type:Boolean})],Dw.prototype,"disabled",2);DB([Q({type:String})],Dw.prototype,"target",2);DB([tn({context:Lm,subscribe:!0})],Dw.prototype,"canvas",2);Dw=DB([ze("c-network-link")],Dw);var iut=Object.defineProperty,sut=Object.getOwnPropertyDescriptor,Kee=(e,t,n,r)=>{for(var i=r>1?void 0:r?sut(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&iut(t,n,i),i};let cT=class extends _t{disconnectedCallback(){this.panels.close(this.name)}render(){return he`
      <div class="c-panel ${this.name&&!this.panels.containsSome(this.name)?"hidden":""}">
        <slot>
      </div>
    `}};cT.styles=[St,Xt`
      .c-panel {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
    `];Kee([Q({type:String})],cT.prototype,"name",2);Kee([tn({context:TB,subscribe:!0})],cT.prototype,"panels",2);cT=Kee([ze("c-panel")],cT);var aut=Object.defineProperty,out=Object.getOwnPropertyDescriptor,yN=(e,t,n,r)=>{for(var i=r>1?void 0:r?out(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&aut(t,n,i),i};let Ny=class extends _t{render(){return he`
      <div class="c-tab">
        <sl-button 
          class="${this.panels.openPanels.includes(this.name)?"active":""}" 
          @click="${e=>this.panels.open(this.name,this.group)}"
        >
          <slot>
        </sl-button>
      </div>
    `}};Ny.styles=[St,Xt`
      sl-button {
        width: 100%;
      }

      :host([colored]) sl-button::part(base) {
        background-color: var(--sl-color-primary-100);
      }

      .active::part(base) {
        background-color: var(--sl-color-primary-600) !important;
        color: var(--sl-color-neutral-0);
      }
    `];yN([Q({type:String})],Ny.prototype,"name",2);yN([Q({type:String})],Ny.prototype,"group",2);yN([Q({type:Boolean})],Ny.prototype,"colored",2);yN([tn({context:TB,subscribe:!0})],Ny.prototype,"panels",2);Ny=yN([ze("c-tab")],Ny);KG("/shoelace");function lut(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function Ms({message:e,variant:t="primary",icon:n="info-circle",duration:r=7e3}){const i=Object.assign(document.createElement("sl-alert"),{variant:t,closable:!0,duration:r,innerHTML:`
        <sl-icon name="${n}" slot="icon"></sl-icon>
        ${lut(e)}
    `});document.body.append(i),i.toast()}class uut{constructor(t){this.host=t,t.addController(this)}hostConnected(){window.addEventListener("keyup",t=>this.removeListener(t)),window.addEventListener("keydown",t=>this.moveListener(t))}hostDisconnected(){window.removeEventListener("keyup",t=>this.removeListener(t)),window.removeEventListener("keydown",t=>this.moveListener(t))}removeListener(t){if(t.code=="Delete"||t.code=="Backspace"){if(this.host.selected.layer){const n=this.host.selected.layer;Ms({message:`'${n.getName()}' has been deleted!`,variant:"danger",icon:"trash"}),this.host.networkConf.network.removeLayer(n)}else if(this.host.selected.neuron)Ms({message:"You can not delete neurons by now! To adjust the number of neurons in the layer, select the layer and set the number of neurons in the right panel!",variant:"warning",icon:"x-circle"});else if(this.host.selected.edge){const n=this.host.selected.edge;Ms({message:`Can not delete edges manually. If you wish to delete the connection between '${n.sourceLayer.getName()}' and '${n.targetLayer.getName()}' select one of the layers and remove the other layer as its input resp. output!`,variant:"warning",icon:"x-circle"})}}}moveListener(t){if(this.host.selected.layer){const n=this.host.selected.layer,r=this.host.canvas.cy.getElementById(n.getCyId()),i=10;t.code=="KeyW"||t.code=="ArrowUp"?r.shift("y",-i):t.code=="KeyA"||t.code=="ArrowLeft"?r.shift("x",-i):t.code=="KeyS"||t.code=="ArrowDown"?r.shift("y",i):(t.code=="KeyD"||t.code=="ArrowRight")&&r.shift("x",i),this.host.selected.layer.updateInternalPos()}}}const Jp="network-conf",Bm="data-set",sAe="train-options",EC="model",AC="selected";class cut{constructor({name:t,description:n,inputs:r,label:i},s){this.name=t,this.description=n,this.inputs=r,this.label=i,this.data=s}unassignKey(t){this.assignKey(t,null)}assignKey(t,n){this.assignInputToLayer({key:t,layer:n}),this.assignLabelToLayer({key:t,layer:n})}getByKey(t){var n;return(n=this.getInputByKey(t))!=null?n:this.getLabelByKey(t)}getNonAssignedInputKeys(){return this.inputs.filter(n=>!n.layer).map(n=>n.key)}getAssignedInputsFor(t){return this.inputs.filter(n=>n.layer==t)}getInputByKey(t){return this.inputs.find(r=>r.key==t)}assignInputToLayer({key:t,layer:n}){const r=this.getInputByKey(t);r&&(r.layer=n)}getInputDataForLayer(t){const n=[];for(const[i,s]of this.inputs.entries())s.layer==t&&n.push(i);return this.data.map(({inputs:i})=>i.filter((s,a)=>n.includes(a)))}getNonAssignedLabelKey(){return this.label.layer?null:this.label.key}getLabelByKey(t){return this.label.key==t?this.label:null}assignLabelToLayer({key:t,layer:n}){const r=this.getLabelByKey(t);r&&(r.layer=n)}getLabelData(){return this.data.map(({label:t})=>t)}getData(){return this.data}}class q2{constructor(){}static async openDataSet(t){const r=await(await fetch(`${t}/config.json`)).json(),i=Object.create(r),o=(await(await fetch(`${t}/data.txt`)).text()).split(`
`),l=[];for(const u of o){const c=u.trim().split(/\s+/),f=[];let h=0;for(const p of i.inputs)f.push(parseInt(c[h])),h+=1;const d=parseInt(c[h]);l.push({inputs:f,label:d})}return new cut(i,l)}static getDataSetByName(t){switch(t){case"Boston House Pricing":return this.openDataSet("/data_set/boston");case"Pima Indians Diabetes":return this.openDataSet("/data_set/diabetes")}}static getOptions(){return["Boston House Pricing","Pima Indians Diabetes"]}}var fut=Object.defineProperty,hut=Object.getOwnPropertyDescriptor,TC=(e,t,n,r)=>{for(var i=r>1?void 0:r?hut(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&fut(t,n,i),i};let Np=class extends _t{constructor(){super(...arguments),this.tensor=null,this.alert=!0}connectedCallback(){super.connectedCallback(),this.alert&&Ms({message:`${this.getName()} has been created!`,variant:"success",icon:"check-circle"})}disconnectedCallback(){this.removeFromCanvas()}getCyId(){return`${this.layerId}`}removeFromCanvas(){this.canvas.cy.filter(t=>t.isNode()&&t.data("layer")==this.layerId,this).remove()}getName(){return`${this.layerId} - ${this.constructor.LAYER_NAME} ${this.activation!="None"?`(${this.activation})`:""}`}duplicate(){Ms({message:`Layer '${this.getName()}' can not be duplicated!`,variant:"warning",icon:"x-circle"})}setActivation(e){this.activation=e,this.canvas.cy.getElementById(`${this.layerId}`).data("label",this.getName())}getTensorName(){return this.getName().replace(/\s+/g,"").replace(/[^\w ]/g,"")}render(){return this.canvas.cy.getElementById(this.getCyId()).length||this.canvas.cy.add({group:"nodes",data:{id:this.getCyId(),label:this.getName(),type:"layer",layer:this.layerId,layer_type:`${this.constructor.LAYER_TYPE}`},css:{"z-index":this.layerId*3}}),he``}};Np.styles=[St];TC([tn({context:Lm,subscribe:!0})],Np.prototype,"canvas",2);TC([Q()],Np.prototype,"layerId",2);TC([Q()],Np.prototype,"activation",2);TC([Q()],Np.prototype,"tensor",2);TC([Q()],Np.prototype,"alert",2);Np=TC([ze("c-layer")],Np);var dut=Object.defineProperty,put=Object.getOwnPropertyDescriptor,zm=(e,t,n,r)=>{for(var i=r>1?void 0:r?put(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&dut(t,n,i),i};let Dh=class extends _t{constructor(){super(...arguments),this.rendered=!1}connectedCallback(){super.connectedCallback(),this.value=Math.random()}firstUpdated(){this.label&&this.dataSet.assignKey(this.label,this.layer)}disconnectedCallback(){super.disconnectedCallback(),this.label&&this.dataSet.unassignKey(this.label)}getCyId(){return`${this.layer.getCyId()}n${this.neuronId}`}removeFromCanvas(){const e=this.canvas.cy.getElementById(this.getCyId());if(e.length){this.neuronId!=1&&this.canvas.cy.getElementById(this.layer.getCyId()).shift("x",(this.canvas.NEURON_SIZE+this.canvas.NEURON_DISTANCE)/2),e.remove();const t=this.canvas.cy.getElementById(`${this.getCyId()}w`);t&&t.remove()}}render(){this.removeFromCanvas();let e=this.layer.getCyId(),t=!1;return this.label&&(this.canvas.cy.add({group:"nodes",grabbable:!1,selectable:!1,data:{id:`${this.getCyId()}w`,parent:e,type:"neuron-wrapper",layer:this.layer.layerId,neuron:this.neuronId,label:this.label},css:{"z-index":this.layer.layerId*3+1}}),e=`${this.getCyId()}w`,t=!0),this.canvas.cy.add({group:"nodes",grabbable:!1,data:{id:this.getCyId(),parent:e,type:"neuron",layer:this.layer.layerId,neuron:this.neuronId,label:`${this.value}`.substring(0,3),wrapped:`${String(t)}`},position:this.layer.getPositionForUnit(this.neuronId),css:{"z-index":this.layer.layerId*3+2}}),this.rendered=!0,this.neuronId!=1&&this.canvas.cy.getElementById(this.layer.getCyId()).shift("x",-(this.canvas.NEURON_SIZE+this.canvas.NEURON_DISTANCE)/2),this.dispatchEvent(new CustomEvent("layer-updated",{detail:this.layer.layerId,bubbles:!0,composed:!0})),he``}};Dh.styles=[St];zm([tn({context:Lm,subscribe:!0})],Dh.prototype,"canvas",2);zm([tn({context:Bm,subscribe:!0})],Dh.prototype,"dataSet",2);zm([Q()],Dh.prototype,"layer",2);zm([Q()],Dh.prototype,"neuronId",2);zm([Q()],Dh.prototype,"label",2);zm([Cr()],Dh.prototype,"value",2);zm([Cr()],Dh.prototype,"rendered",2);Dh=zm([ze("c-neuron")],Dh);var gut=Object.defineProperty,mut=Object.getOwnPropertyDescriptor,Zee=(e,t,n,r)=>{for(var i=r>1?void 0:r?mut(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&gut(t,n,i),i};let Bc=class extends Np{constructor(){super(...arguments),this.neurons=[]}firstUpdated(){this.firstNeuronPos||(this.firstNeuronPos={...this.canvas.generatePos()}),this.canvas.cy.getElementById(this.getCyId()).on("position",e=>this.updateInternalFirstNeuronPos())}getConnectionIds(){return this.neurons.filter(e=>e.rendered).map(e=>e.getCyId())}getFreshNeuronId(){return this.neurons.length?this.neurons[this.neurons.length-1].neuronId+1:1}getPositionForUnit(e){return{x:this.firstNeuronPos.x+(e-1)*(this.canvas.NEURON_SIZE+this.canvas.NEURON_DISTANCE),y:this.firstNeuronPos.y}}updateInternalFirstNeuronPos(){if(this.neurons.length){const e=this.canvas.cy.getElementById(this.neurons[0].getCyId());e.length&&(this.firstNeuronPos=e.position())}}addNeuron({label:e}={}){const t=document.createElement("c-neuron");return t.layer=this,t.neuronId=this.getFreshNeuronId(),t.label=e,this.neurons.push(t),this.requestUpdate(),t}removeNeuron({neuron:e=null,force:t=!1}={}){e&&console.error("removing specific neurons is not yet supported! To adjust the number of neurons in the layer, select the layer and adjust its configuration instead!"),this.neurons.length>1||t?(this.neurons.pop().removeFromCanvas(),this.requestUpdate()):Ms({message:`Could not remove neuron in '${this.getName()}'! Layer needs at least one neuron!`,variant:"warning",icon:"x-circle"})}render(){return he`${super.render()}${this.neurons}`}};Bc.styles=[St];Zee([Q()],Bc.prototype,"firstNeuronPos",2);Zee([Cr()],Bc.prototype,"neurons",2);Bc=Zee([ze("neuron-layer")],Bc);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vut=1e-7,yut=1e-4;class Qee{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class NB{refCount(t){return Mo("refCount")}incRef(t){return Mo("incRef")}timerAvailable(){return!0}time(t){return Mo("time")}read(t){return Mo("read")}readSync(t){return Mo("readSync")}readToGPU(t,n){return Mo("readToGPU")}numDataIds(){return Mo("numDataIds")}disposeData(t,n){return Mo("disposeData")}write(t,n,r){return Mo("write")}move(t,n,r,i,s){return Mo("move")}createTensorFromGPUData(t,n,r){return Mo("createTensorFromGPUData")}memory(){return Mo("memory")}floatPrecision(){return Mo("floatPrecision")}epsilon(){return this.floatPrecision()===32?vut:yut}dispose(){return Mo("dispose")}}function Mo(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jee(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,Gd(e,t,n)}function but(e,t){if(e.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,Gd(e,n,r),Gd(t,n,r)}function z0(e,t,n){return Math.max(e,Math.min(t,n))}function IB(e){return e%2===0?e:e+1}function Gd(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function aAe(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function xut(e,t){const n=Math.random();return t*n+(1-n)*e}function wut(e,t){let n=0;for(let r=0;r<e.length;r++){const i=Number(e[r])-Number(t[r]);n+=i*i}return n}function B(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function gs(e,t,n=""){B(Qt(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function Lb(e){B(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function de(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function $ut(e){return e.length===0}function oAe(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==null&&t[n]!==null&&e[n]!==t[n])return!1;return!0}function Qt(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Iy(e){return e%1===0}function Cut(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{const t=Math.exp(2*e);return(t-1)/(t+1)}}function x5(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function _ut(e){const t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return Jee(t),t}function X1(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function CY(e,t=i=>0,n,r){return new Promise((i,s)=>{let a=0;const o=()=>{if(e()){i();return}a++;const l=t(a);if(n!=null&&a>=n){s();return}r!=null?r(o,l):setTimeout(o,l)};o()})}function ete(e,t){let n=1,r=-1;for(let s=0;s<e.length;++s)if(e[s]>=0)n*=e[s];else if(e[s]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(e[s]<0)throw Error(`Shapes can not be < 0. Found ${e[s]} at dim ${s}`);if(r===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const i=e.slice();return i[r]=t/n,i}function Ot(e,t){const n=t.length;return e=e==null?t.map((r,i)=>i):[].concat(e),B(e.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),B(e.every(r=>Iy(r)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(r=>r<0?n+r:r)}function eg(e,t){const n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,s=t==null||i?null:Ot(t,e).sort();let a=0;for(let o=0;o<e.length;++o){if(s!=null){if(s[a]===o&&e[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${e[o]}' is not 1`);(s[a]==null||s[a]>o)&&e[o]===1&&(n.push(e[o]),r.push(o)),s[a]<=o&&a++}e[o]!==1&&(n.push(e[o]),r.push(o))}return{newShape:n,keptDims:r}}function Fi(e,t){return Br(e,t)}function Br(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function lAe(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function uAe(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function tte(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function fT(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function cAe(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function Qf(e){return typeof e=="string"||e instanceof String}function fAe(e){return typeof e=="boolean"}function w5(e){return typeof e=="number"}function Bb(e){return Array.isArray(e)?Bb(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":w5(e)?"float32":Qf(e)?"string":fAe(e)?"bool":"float32"}function U0(e){return!!(e&&e.constructor&&e.call&&e.apply)}function $5(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function Je(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function hAe(e,t,n,r=!1){const i=new Array;if(t.length===1){const s=t[0]*(r?2:1);for(let a=0;a<s;a++)i[a]=n[e+a]}else{const s=t[0],a=t.slice(1),o=a.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<s;l++)i[l]=hAe(e+l*o,a,n,r)}return i}function Tu(e,t,n=!1){if(e.length===0)return t[0];const r=e.reduce((i,s)=>i*s)*(n?2:1);if(r===0)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return hAe(0,e,t,n)}function dAe(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function MB(e,t){const n=hs(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function hs(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function nte(e,t){const n=e.reduce((r,i)=>r*i,1);if(t==null||t==="float32")return Tu(e,new Float32Array(n));if(t==="int32")return Tu(e,new Int32Array(n));if(t==="bool")return Tu(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function ml(e){e.forEach(t=>{B(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function zc(e,t,n){if(t===0)return 0;if(t===1)return e[0];let r=e[e.length-1];for(let i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function zb(e,t,n){if(t===0)return[];if(t===1)return[e];const r=new Array(t);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}function FB(e){return e&&e.then&&typeof e.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oge="tfjsflags";class pAe{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Sut,this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&(le().getBool("IS_TEST")||le().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=n}registerFlag(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){const i=this.urlFlags[t];le().getBool("IS_TEST")||le().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${i}.`),this.set(t,i)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if(FB(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);oge in t&&t[oge].split(",").forEach(r=>{const[i,s]=r.split(":");this.urlFlags[i]=Eut(i,s)})}}function Sut(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(kut(t,r[0],r[1]),r.join("="))),t}function kut(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function Eut(e,t){const n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function le(){return rte}let rte=null;function Aut(e){rte=e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let lj;function gAe(){if(lj==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");lj=e}return lj}function Tut(){const e=gAe();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function ite(e,t){const n=Tut();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}const bN="Abs",DC="Acos",NC="Acosh",Ub="Add",xN="AddN",OB="All",RB="Any",wN="ArgMax",$N="ArgMin",IC="Asin",MC="Asinh",FC="Atan",OC="Atanh",RC="Atan2",CN="AvgPool",PB="AvgPoolGrad",_N="AvgPool3D",LB="AvgPool3DGrad",SN="BatchMatMul",kN="BatchToSpaceND",BB="Bincount",EN="BitwiseAnd",mAe="BroadcastTo",zB="BroadcastArgs",PC="Cast",LC="Ceil",BC="ClipByValue",UB="Complex",AN="ComplexAbs",TN="Concat",DN="Conv2D",WB="Conv2DBackpropFilter",NN="Conv2DBackpropInput",IN="Conv3D",VB="Conv3DBackpropFilterV2",jB="Conv3DBackpropInputV2",zC="Cos",UC="Cosh",HB="Cumprod",MN="Cumsum",qB="CropAndResize",GB="DenseBincount",YB="DepthToSpace",FN="DepthwiseConv2dNative",XB="DepthwiseConv2dNativeBackpropFilter",KB="DepthwiseConv2dNativeBackpropInput",ZB="Diag",ON="Dilation2D",C5="Dilation2DBackpropInput",_5="Dilation2DBackpropFilter",QB="Draw",WC="RealDiv",JB="Einsum",VC="Elu",ez="EluGrad",jC="Erf",RN="Equal",HC="Exp",PN="ExpandDims",qC="Expm1",tz="FFT",nz="Fill",rz="FlipLeftRight",GC="Floor",YC="FloorDiv",LN="FusedBatchNorm",BN="GatherV2",iz="GatherNd",zN="Greater",XC="GreaterEqual",KC="Identity",sz="IFFT",az="Imag",ZC="IsFinite",QC="IsInf",JC="IsNan",UN="LeakyRelu",WN="Less",VN="LessEqual",oz="LinSpace",e_="Log",t_="Log1p",jN="LogicalAnd",HN="LogicalNot",qN="LogicalOr",Dut="LogicalXor",vAe="LogSoftmax",Nut="LowerBound",GN="LRN",lz="LRNGrad",Iut="MatrixBandPart",YN="Max",n_="Maximum",XN="MaxPool",uz="MaxPoolGrad",KN="MaxPool3D",cz="MaxPool3DGrad",fz="MaxPoolWithArgmax",ZN="Mean",QN="Min",r_="Minimum",JN="MirrorPad",i_="Mod",hz="Multinomial",s_="Multiply",eI="Neg",tI="NotEqual",dz="NonMaxSuppressionV3",pz="NonMaxSuppressionV4",gz="NonMaxSuppressionV5",nI="OnesLike",rI="OneHot",iI="Pack",sI="PadV2",Mut="Pool",a_="Pow",aI="Prelu",oI="Prod",mz="RaggedGather",vz="RaggedRange",yz="RaggedTensorToTensor",bz="Range",xz="Real",o_="Reciprocal",l_="Relu",lI="Reshape",uI="ResizeNearestNeighbor",wz="ResizeNearestNeighborGrad",cI="ResizeBilinear",$z="ResizeBilinearGrad",u_="Relu6",fI="Reverse",c_="Round",f_="Rsqrt",Cz="ScatterNd",_z="TensorScatterUpdate",Sz="SearchSorted",hI="Select",h_="Selu",dI="Slice",d_="Sin",p_="Sinh",g_="Sign",m_="Sigmoid",v_="Softplus",y_="Sqrt",pI="Sum",gI="SpaceToBatchND",mI="SplitV",vI="Softmax",kz="SparseFillEmptyRows",Ez="SparseReshape",Az="SparseSegmentMean",Tz="SparseSegmentSum",Dz="SparseToDense",b_="SquaredDifference",Nz="Square",yI="StaticRegexReplace",Iz="StridedSlice",Mz="StringNGrams",Fz="StringSplit",Oz="StringToHashBucketFast",x_="Sub",w_="Tan",$_="Tanh",C_="Tile",Rz="TopK",Pz="Transform",K1="Transpose",Lz="Unique",bI="Unpack",xI="UnsortedSegmentSum",Fut="UpperBound",wI="ZerosLike",__="Step",S5="FromPixels",Bz="RotateWithOffset",hT="_FusedMatMul",dT="FusedConv2D",pT="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kl(...e){le().getBool("IS_TEST")||le().getBool("PROD")||console.warn(...e)}function Out(...e){le().getBool("IS_TEST")||le().getBool("PROD")||console.log(...e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nw=ite("kernelRegistry",()=>new Map),gT=ite("gradRegistry",()=>new Map);function mT(e,t){const n=ste(e,t);return Nw.get(n)}function _Y(e){return gT.get(e)}function k5(e){const t=Nw.entries(),n=[];for(;;){const{done:r,value:i}=t.next();if(r)break;const[s,a]=i,[o]=s.split("_");o===e&&n.push(a)}return n}function zz(e){const{kernelName:t,backendName:n}=e,r=ste(t,n);Nw.has(r)&&kl(`The kernel '${t}' for backend '${n}' is already registered`),Nw.set(r,e)}function yAe(e){const{kernelName:t}=e;gT.has(t)&&le().getBool("DEBUG")&&kl(`Overriding the gradient for '${t}'`),gT.set(t,e)}function Rut(e,t){const n=ste(e,t);if(!Nw.has(n))throw new Error(`The kernel '${e}' for backend '${t}' is not registered`);Nw.delete(n)}function Put(e){if(!gT.has(e))throw new Error(`The gradient '${e}' for backend is not registered`);gT.delete(e)}function Lut(e,t){k5(e).forEach(r=>{const i=Object.assign({},r,{backendName:t});zz(i)})}function ste(e,t){return`${t}_${e}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bAe(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var SY=or,du=null;try{du=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function or(e,t,n){this.low=e|0,this.high=t|0,this.unsigned=!!n}or.prototype.__isLong__;Object.defineProperty(or.prototype,"__isLong__",{value:!0});function vl(e){return(e&&e.__isLong__)===!0}or.isLong=vl;var lge={},uge={};function Wb(e,t){var n,r,i;return t?(e>>>=0,(i=0<=e&&e<256)&&(r=uge[e],r)?r:(n=lr(e,(e|0)<0?-1:0,!0),i&&(uge[e]=n),n)):(e|=0,(i=-128<=e&&e<128)&&(r=lge[e],r)?r:(n=lr(e,e<0?-1:0,!1),i&&(lge[e]=n),n))}or.fromInt=Wb;function pu(e,t){if(isNaN(e))return t?k1:gu;if(t){if(e<0)return k1;if(e>=xAe)return CAe}else{if(e<=-fge)return Go;if(e+1>=fge)return $Ae}return e<0?pu(-e,t).neg():lr(e%Iw|0,e/Iw|0,t)}or.fromNumber=pu;function lr(e,t,n){return new or(e,t,n)}or.fromBits=lr;var E5=Math.pow;function ate(e,t,n){if(e.length===0)throw Error("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return gu;if(typeof t=="number"?(n=t,t=!1):t=!!t,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return ate(e.substring(1),t,n).neg();for(var i=pu(E5(n,8)),s=gu,a=0;a<e.length;a+=8){var o=Math.min(8,e.length-a),l=parseInt(e.substring(a,a+o),n);if(o<8){var u=pu(E5(n,o));s=s.mul(u).add(pu(l))}else s=s.mul(i),s=s.add(pu(l))}return s.unsigned=t,s}or.fromString=ate;function cf(e,t){return typeof e=="number"?pu(e,t):typeof e=="string"?ate(e,t):lr(e.low,e.high,typeof t=="boolean"?t:e.unsigned)}or.fromValue=cf;var cge=1<<16,But=1<<24,Iw=cge*cge,xAe=Iw*Iw,fge=xAe/2,hge=Wb(But),gu=Wb(0);or.ZERO=gu;var k1=Wb(0,!0);or.UZERO=k1;var N2=Wb(1);or.ONE=N2;var wAe=Wb(1,!0);or.UONE=wAe;var kY=Wb(-1);or.NEG_ONE=kY;var $Ae=lr(-1,2147483647,!1);or.MAX_VALUE=$Ae;var CAe=lr(-1,-1,!0);or.MAX_UNSIGNED_VALUE=CAe;var Go=lr(0,-2147483648,!1);or.MIN_VALUE=Go;var Re=or.prototype;Re.toInt=function(){return this.unsigned?this.low>>>0:this.low};Re.toNumber=function(){return this.unsigned?(this.high>>>0)*Iw+(this.low>>>0):this.high*Iw+(this.low>>>0)};Re.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Go)){var n=pu(t),r=this.div(n),i=r.mul(n).sub(this);return r.toString(t)+i.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var s=pu(E5(t,6),this.unsigned),a=this,o="";;){var l=a.div(s),u=a.sub(l.mul(s)).toInt()>>>0,c=u.toString(t);if(a=l,a.isZero())return c+o;for(;c.length<6;)c="0"+c;o=""+c+o}};Re.getHighBits=function(){return this.high};Re.getHighBitsUnsigned=function(){return this.high>>>0};Re.getLowBits=function(){return this.low};Re.getLowBitsUnsigned=function(){return this.low>>>0};Re.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Go)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,n=31;n>0&&(t&1<<n)==0;n--);return this.high!=0?n+33:n+1};Re.isZero=function(){return this.high===0&&this.low===0};Re.eqz=Re.isZero;Re.isNegative=function(){return!this.unsigned&&this.high<0};Re.isPositive=function(){return this.unsigned||this.high>=0};Re.isOdd=function(){return(this.low&1)===1};Re.isEven=function(){return(this.low&1)===0};Re.equals=function(t){return vl(t)||(t=cf(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low};Re.eq=Re.equals;Re.notEquals=function(t){return!this.eq(t)};Re.neq=Re.notEquals;Re.ne=Re.notEquals;Re.lessThan=function(t){return this.comp(t)<0};Re.lt=Re.lessThan;Re.lessThanOrEqual=function(t){return this.comp(t)<=0};Re.lte=Re.lessThanOrEqual;Re.le=Re.lessThanOrEqual;Re.greaterThan=function(t){return this.comp(t)>0};Re.gt=Re.greaterThan;Re.greaterThanOrEqual=function(t){return this.comp(t)>=0};Re.gte=Re.greaterThanOrEqual;Re.ge=Re.greaterThanOrEqual;Re.compare=function(t){if(vl(t)||(t=cf(t)),this.eq(t))return 0;var n=this.isNegative(),r=t.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1};Re.comp=Re.compare;Re.negate=function(){return!this.unsigned&&this.eq(Go)?Go:this.not().add(N2)};Re.neg=Re.negate;Re.add=function(t){vl(t)||(t=cf(t));var n=this.high>>>16,r=this.high&65535,i=this.low>>>16,s=this.low&65535,a=t.high>>>16,o=t.high&65535,l=t.low>>>16,u=t.low&65535,c=0,f=0,h=0,d=0;return d+=s+u,h+=d>>>16,d&=65535,h+=i+l,f+=h>>>16,h&=65535,f+=r+o,c+=f>>>16,f&=65535,c+=n+a,c&=65535,lr(h<<16|d,c<<16|f,this.unsigned)};Re.subtract=function(t){return vl(t)||(t=cf(t)),this.add(t.neg())};Re.sub=Re.subtract;Re.multiply=function(t){if(this.isZero())return gu;if(vl(t)||(t=cf(t)),du){var n=du.mul(this.low,this.high,t.low,t.high);return lr(n,du.get_high(),this.unsigned)}if(t.isZero())return gu;if(this.eq(Go))return t.isOdd()?Go:gu;if(t.eq(Go))return this.isOdd()?Go:gu;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(hge)&&t.lt(hge))return pu(this.toNumber()*t.toNumber(),this.unsigned);var r=this.high>>>16,i=this.high&65535,s=this.low>>>16,a=this.low&65535,o=t.high>>>16,l=t.high&65535,u=t.low>>>16,c=t.low&65535,f=0,h=0,d=0,p=0;return p+=a*c,d+=p>>>16,p&=65535,d+=s*c,h+=d>>>16,d&=65535,d+=a*u,h+=d>>>16,d&=65535,h+=i*c,f+=h>>>16,h&=65535,h+=s*u,f+=h>>>16,h&=65535,h+=a*l,f+=h>>>16,h&=65535,f+=r*c+i*u+s*l+a*o,f&=65535,lr(d<<16|p,f<<16|h,this.unsigned)};Re.mul=Re.multiply;Re.divide=function(t){if(vl(t)||(t=cf(t)),t.isZero())throw Error("division by zero");if(du){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var n=(this.unsigned?du.div_u:du.div_s)(this.low,this.high,t.low,t.high);return lr(n,du.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?k1:gu;var r,i,s;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return k1;if(t.gt(this.shru(1)))return wAe;s=k1}else{if(this.eq(Go)){if(t.eq(N2)||t.eq(kY))return Go;if(t.eq(Go))return N2;var a=this.shr(1);return r=a.div(t).shl(1),r.eq(gu)?t.isNegative()?N2:kY:(i=this.sub(t.mul(r)),s=r.add(i.div(t)),s)}else if(t.eq(Go))return this.unsigned?k1:gu;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();s=gu}for(i=this;i.gte(t);){r=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(r)/Math.LN2),l=o<=48?1:E5(2,o-48),u=pu(r),c=u.mul(t);c.isNegative()||c.gt(i);)r-=l,u=pu(r,this.unsigned),c=u.mul(t);u.isZero()&&(u=N2),s=s.add(u),i=i.sub(c)}return s};Re.div=Re.divide;Re.modulo=function(t){if(vl(t)||(t=cf(t)),du){var n=(this.unsigned?du.rem_u:du.rem_s)(this.low,this.high,t.low,t.high);return lr(n,du.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))};Re.mod=Re.modulo;Re.rem=Re.modulo;Re.not=function(){return lr(~this.low,~this.high,this.unsigned)};Re.and=function(t){return vl(t)||(t=cf(t)),lr(this.low&t.low,this.high&t.high,this.unsigned)};Re.or=function(t){return vl(t)||(t=cf(t)),lr(this.low|t.low,this.high|t.high,this.unsigned)};Re.xor=function(t){return vl(t)||(t=cf(t)),lr(this.low^t.low,this.high^t.high,this.unsigned)};Re.shiftLeft=function(t){return vl(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?lr(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):lr(0,this.low<<t-32,this.unsigned)};Re.shl=Re.shiftLeft;Re.shiftRight=function(t){return vl(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?lr(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):lr(this.high>>t-32,this.high>=0?0:-1,this.unsigned)};Re.shr=Re.shiftRight;Re.shiftRightUnsigned=function(t){if(vl(t)&&(t=t.toInt()),t&=63,t===0)return this;var n=this.high;if(t<32){var r=this.low;return lr(r>>>t|n<<32-t,n>>>t,this.unsigned)}else return t===32?lr(n,0,this.unsigned):lr(n>>>t-32,0,this.unsigned)};Re.shru=Re.shiftRightUnsigned;Re.shr_u=Re.shiftRightUnsigned;Re.toSigned=function(){return this.unsigned?lr(this.low,this.high,!1):this};Re.toUnsigned=function(){return this.unsigned?this:lr(this.low,this.high,!0)};Re.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()};Re.toBytesLE=function(){var t=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]};Re.toBytesBE=function(){var t=this.high,n=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};or.fromBytes=function(t,n,r){return r?or.fromBytesLE(t,n):or.fromBytesBE(t,n)};or.fromBytesLE=function(t,n){return new or(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,n)};or.fromBytesBE=function(t,n){return new or(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],n)};const zut=HSe({__proto__:null,default:SY},[SY]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r1=SY||zut;function $I(e){return r1.fromString(e,!0,16)}const _Ae=$I("c3a5c85c97cb3127"),Gv=$I("b492b66fbe98f273"),da=$I("9ae16a3b2f90404f");function EY(e){return e.xor(e.shru(47))}function SAe(e,t,n){const r=e.slice(t,t+n);return r1.fromBytes(Array.from(r),!0,!0)}function Qn(e,t){return SAe(e,t,8)}function dge(e,t){return SAe(e,t,4)}function $i(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function m0(e,t,n=$I("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let i=t.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function Uut(e,t,n,r,i,s){i=i.add(e),s=$i(s.add(i).add(r),21);const a=i;return i=i.add(t),i=i.add(n),s=s.add($i(i,44)),[i.add(r),s.add(a)]}function rO(e,t,n,r){return Uut(Qn(e,t),Qn(e,t+8),Qn(e,t+16),Qn(e,t+24),n,r)}function Wut(e,t=e.length){if(t>=8){const n=da.add(t*2),r=Qn(e,0).add(da),i=Qn(e,t-8),s=$i(i,37).mul(n).add(r),a=$i(r,25).add(i).mul(n);return m0(s,a,n)}if(t>=4){const n=da.add(t*2),r=dge(e,0);return m0(r.shl(3).add(t),dge(e,t-4),n)}if(t>0){const n=e[0],r=e[t>>1],i=e[t-1],s=n+(r<<8),a=t+(i<<2);return EY(da.mul(s).xor(_Ae.mul(a))).mul(da)}return da}function Vut(e,t=e.length){const n=da.add(t*2),r=Qn(e,0).mul(Gv),i=Qn(e,8),s=Qn(e,t-8).mul(n),a=Qn(e,t-16).mul(da);return m0($i(r.add(i),43).add($i(s,30)).add(a),r.add($i(i.add(da),18)).add(s),n)}function jut(e,t=e.length){const n=da.add(t*2),r=Qn(e,0).mul(da),i=Qn(e,8),s=Qn(e,t-8).mul(n),a=Qn(e,t-16).mul(da),o=$i(r.add(i),43).add($i(s,30)).add(a),l=m0(o,r.add($i(i.add(da),18)).add(s),n),u=Qn(e,16).mul(n),c=Qn(e,24),f=o.add(Qn(e,t-32)).mul(n),h=l.add(Qn(e,t-24)).mul(n);return m0($i(u.add(c),43).add($i(f,30)).add(h),u.add($i(c.add(r),18)).add(f),n)}function kAe(e,t=e.length){const n=r1.fromNumber(81,!0);if(t<=32)return t<=16?Wut(e,t):Vut(e,t);if(t<=64)return jut(e,t);let r=n,i=n.mul(Gv).add(113),s=EY(i.mul(da).add(113)).mul(da),a=[r1.UZERO,r1.UZERO],o=[r1.UZERO,r1.UZERO];r=r.mul(da).add(Qn(e,0));let l=0;const u=(t-1>>6)*64,c=u+(t-1&63)-63;do r=$i(r.add(i).add(a[0]).add(Qn(e,l+8)),37).mul(Gv),i=$i(i.add(a[1]).add(Qn(e,l+48)),42).mul(Gv),r=r.xor(o[1]),i=i.add(a[0]).add(Qn(e,l+40)),s=$i(s.add(o[0]),33).mul(Gv),a=rO(e,l,a[1].mul(Gv),r.add(o[0])),o=rO(e,l+32,s.add(o[1]),i.add(Qn(e,l+16))),[s,r]=[r,s],l+=64;while(l!==u);const f=Gv.add(s.and(255).shl(1));return l=c,o[0]=o[0].add(t-1&63),a[0]=a[0].add(o[0]),o[0]=o[0].add(a[0]),r=$i(r.add(i).add(a[0]).add(Qn(e,l+8)),37).mul(f),i=$i(i.add(a[1]).add(Qn(e,l+48)),42).mul(f),r=r.xor(o[1].mul(9)),i=i.add(a[0].mul(9).add(Qn(e,l+40))),s=$i(s.add(o[0]),33).mul(f),a=rO(e,l,a[1].mul(f),r.add(o[0])),o=rO(e,l+32,s.add(o[1]),i.add(Qn(e,l+16))),[s,r]=[r,s],m0(m0(a[0],o[0],f).add(EY(i).mul(_Ae)).add(s),m0(a[1],o[1],f).add(r),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tg(e,t){return t==="string"?rh(e):Um([e],t)}function Hut(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function Um(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Nh(e)),le().getBool("DEBUG")&&lAe(e,t),Hut(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){const n=new Uint8Array(e.length);for(let r=0;r<n.length;++r)Math.round(e[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${t}`)}function ca(){return le().platform.now()}function qut(e,t){return le().platform.fetch(e,t)}function rh(e,t="utf-8"){return t=t||"utf-8",le().platform.encode(e,t)}function Ip(e,t="utf-8"){return t=t||"utf-8",le().platform.decode(e,t)}function Ci(e){return le().platform.isTypedArray!=null?le().platform.isTypedArray(e):bAe(e)}function Nh(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||FB(e)||e==null||Ci(e)&&n)t.push(e);else if(Array.isArray(e)||Ci(e))for(let r=0;r<e.length;++r)Nh(e[r],t,n);else{let r=-1;for(const i of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(i)&&(r=Math.max(r,Number(i)));for(let i=0;i<=r;i++)Nh(e[i],t,n)}return t}const Gut=Object.freeze(Object.defineProperty({__proto__:null,createScalarValue:tg,toTypedArray:Um,now:ca,fetch:qut,encodeString:rh,decodeString:Ip,isTypedArray:Ci,flatten:Nh,shuffle:Jee,shuffleCombo:but,clamp:z0,nearestLargerEven:IB,swap:Gd,sum:aAe,randUniform:xut,distSquared:wut,assert:B,assertShapesMatch:gs,assertNonNull:Lb,sizeFromShape:de,isScalarShape:$ut,arraysEqualWithNull:oAe,arraysEqual:Qt,isInt:Iy,tanh:Cut,sizeToSquarishShape:x5,createShuffledIndices:_ut,rightPad:X1,repeatedTry:CY,inferFromImplicitShape:ete,parseAxisParam:Ot,squeezeShape:eg,getTypedArrayFromDType:Fi,getArrayFromDType:Br,checkConversionForErrors:lAe,isValidDtype:uAe,hasEncodingLoss:tte,bytesPerElement:fT,bytesFromStringArray:cAe,isString:Qf,isBoolean:fAe,isNumber:w5,inferDtype:Bb,isFunction:U0,nearestDivisor:$5,computeStrides:Je,toNestedArray:Tu,convertBackendValuesAndArrayBuffer:dAe,makeOnesTypedArray:MB,makeZerosTypedArray:hs,makeZerosNestedTypedArray:nte,assertNonNegativeIntegerDimensions:ml,locToIndex:zc,indexToLoc:zb,isPromise:FB,hexToLong:$I,fingerPrint64:kAe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yut{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new Kut)}profileKernel(t,n,r){let i;const s=()=>{i=r()};let a;const o=ca();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(s);else{s();for(const u of i)u.dataSync();a=Promise.resolve({kernelMs:ca()-o})}if(le().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<i.length;u++){const c=i[u];c.data().then(f=>{Xut(f,c.dtype,t)})}return{kernelName:t,outputs:i,inputs:n,timeMs:a.then(u=>u.kernelMs),extraInfo:a.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:r,timeMs:i,inputs:s,extraInfo:a}=t;r.forEach(o=>{Promise.all([o.data(),i,a]).then(l=>{this.logger.logKernelProfile(n,o,l[0],l[1],s,l[2])})})}}function Xut(e,t,n){if(t!=="float32")return!1;for(let r=0;r<e.length;r++){const i=e[r];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${n}'`),!0}return!1}class Kut{logKernelProfile(t,n,r,i,s,a){const o=typeof i=="number"?X1(`${i}ms`,9):i.error,l=X1(t,25),u=n.rank,c=n.size,f=X1(n.shape.toString(),14);let h="";for(const d in s){const p=s[d];if(p!=null){const g=p.shape||n.shape,m=g.length;h+=`${d}: ${m}D ${m>0?g:""} `}}console.log(`%c${l}	%c${o}	%c${u}D ${f}	%c${c}	%c${h}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zut(e,t,n){const r={},i={};for(let l=0;l<t.length;l++)r[t[l].id]=!0;for(let l=0;l<e.length;l++){const u=e[l],c=u.inputs;for(const f in c){const h=c[f];let d=!1;for(let p=0;p<t.length;p++)if(r[h.id]){u.outputs.forEach(g=>r[g.id]=!0),d=!0,i[u.id]=!0;break}if(d)break}}const s={};s[n.id]=!0;const a={};for(let l=e.length-1;l>=0;l--){const u=e[l],c=u.inputs;for(let f=0;f<u.outputs.length;f++)if(s[u.outputs[f].id]){for(const h in c)s[c[h].id]=!0,a[u.id]=!0;break}}const o=[];for(let l=0;l<e.length;l++){const u=e[l];if(i[u.id]&&a[u.id]){const c={};for(const h in u.inputs){const d=u.inputs[h];r[d.id]&&(c[h]=d)}const f=Object.assign({},u);f.inputs=c,f.outputs=u.outputs,o.push(f)}}return o}function Qut(e,t,n,r){for(let i=t.length-1;i>=0;i--){const s=t[i],a=[];if(s.outputs.forEach(l=>{const u=e[l.id];u!=null?a.push(u):a.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const o=s.gradient(a);for(const l in s.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const u=n(()=>o[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=s.inputs[l];if(!Qt(u.shape,c.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(e[c.id]==null)e[c.id]=u;else{const f=e[c.id];e[c.id]=r(f,u),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pge=20,ZS=3,uj=7;function Jut(e,t,n,r){const i=Je(t),s=ect(e,t,n,i),a=t.length,o=i4(e,t,n,i,s),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${a}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(o.map(u=>"    "+u).join(`
`)),l.join(`
`)}function ect(e,t,n,r){const i=de(t),s=r[r.length-1],a=new Array(s).fill(0),o=t.length,l=n==="complex64"?sE(e):e;if(o>1)for(let u=0;u<i/s;u++){const c=u*s;for(let f=0;f<s;f++)a[f]=Math.max(a[f],iE(l[c+f],0,n).length)}return a}function iE(e,t,n){let r;return Array.isArray(e)?r=`${parseFloat(e[0].toFixed(uj))} + ${parseFloat(e[1].toFixed(uj))}j`:Qf(e)?r=`'${e}'`:n==="bool"?r=EAe(e):r=parseFloat(e.toFixed(uj)).toString(),X1(r,t)}function EAe(e){return e===0?"false":"true"}function i4(e,t,n,r,i,s=!0){const a=n==="complex64"?2:1,o=t[0],l=t.length;if(l===0){if(n==="complex64"){const g=sE(e);return[iE(g[0],0,n)]}return n==="bool"?[EAe(e[0])]:[e[0].toString()]}if(l===1){if(o>pge){const m=ZS*a;let v=Array.from(e.slice(0,m)),y=Array.from(e.slice((o-ZS)*a,o*a));return n==="complex64"&&(v=sE(v),y=sE(y)),["["+v.map((b,x)=>iE(b,i[x],n)).join(", ")+", ..., "+y.map((b,x)=>iE(b,i[o-ZS+x],n)).join(", ")+"]"]}return["["+(n==="complex64"?sE(e):Array.from(e)).map((m,v)=>iE(m,i[v],n)).join(", ")+"]"]}const u=t.slice(1),c=r.slice(1),f=r[0]*a,h=[];if(o>pge){for(let g=0;g<ZS;g++){const m=g*f,v=m+f;h.push(...i4(e.slice(m,v),u,n,c,i,!1))}h.push("...");for(let g=o-ZS;g<o;g++){const m=g*f,v=m+f;h.push(...i4(e.slice(m,v),u,n,c,i,g===o-1))}}else for(let g=0;g<o;g++){const m=g*f,v=m+f;h.push(...i4(e.slice(m,v),u,n,c,i,g===o-1))}const d=l===2?",":"";h[0]="["+(o>0?h[0]+d:"");for(let g=1;g<h.length-1;g++)h[g]=" "+h[g]+d;let p=`,
`;for(let g=2;g<l;g++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(s?"":p),h}function sE(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oi{constructor(t,n,r){if(this.dtype=n,this.shape=t.slice(),this.size=de(t),r!=null){const i=r.length;B(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Br(n,this.size),this.strides=Je(t)}set(t,...n){n.length===0&&(n=[0]),B(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const i of t){if(i<0||i>=this.shape[n]){const s=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(s)}n++}let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=this.strides[i]*t[i];return this.values[r]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return yc().makeTensor(this.values,this.shape,this.dtype)}}let yc=null,$2=null;function tct(e){yc=e}function nct(e){$2=e}class On{constructor(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=de(t),this.strides=Je(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return $2.buffer(this.shape,this.dtype,t)}bufferSync(){return $2.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Tu(this.shape,t,this.dtype==="complex64")}arraySync(){return Tu(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=yc().read(this.dataId);if(this.dtype==="string"){const n=await t;try{return n.map(r=>Ip(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),yc().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=yc().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>Ip(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await yc().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(yc().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return $2.print(this,t)}clone(){return this.throwIfDisposed(),$2.clone(this)}toString(t=!1){const n=this.dataSync();return Jut(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),$2.cast(this,t)}variable(t=!0,n,r){return this.throwIfDisposed(),yc().makeVariable(this,t,n,r)}}Object.defineProperty(On,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function ge(){return ite("Tensor",()=>On)}ge();class vT extends On{constructor(t,n,r,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=n,this.name=r}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!Qt(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);yc().disposeTensor(this),this.dataId=t.dataId,yc().incRef(this,null)}dispose(){yc().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(vT,Symbol.hasInstance,{value:e=>e instanceof On&&e.assign!=null&&e.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var AY;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(AY||(AY={}));var TY;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(TY||(TY={}));var DY;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(DY||(DY={}));var NY;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(NY||(NY={}));var IY;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(IY||(IY={}));const rct={float32:NY,int32:TY,bool:DY,complex64:IY};function po(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return rct[e][t]}function Uz(e){return po(e,"int32")}function AAe(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function TAe(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ir(e,t){if(e.dtype===t.dtype)return[e,t];const n=po(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function DAe(e,t){B(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function ict(e,t){return t.some(n=>n.id===e.id)}function ote(e){const t=[];return NAe(e,t,new Set),t}function NAe(e,t,n){if(e==null)return;if(e instanceof On){t.push(e);return}if(!sct(e))return;const r=e;for(const i in r){const s=r[i];n.has(s)||(n.add(s),NAe(s,t,n))}}function sct(e){return Array.isArray(e)||typeof e=="object"}const act=Object.freeze(Object.defineProperty({__proto__:null,makeTypesMatch:Ir,assertTypesMatch:DAe,isTensorInList:ict,getTensorsInContainer:ote},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cj(e){return e.kernelName!=null}class gge{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Mw{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new gge}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const r=t[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,r=1){return t in this.registryFactory?(kl(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:r},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(t);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Yut(this.backendInstance),!0}setupRegisteredKernels(){k5(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){k5(t).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof NB)&&typeof r.then=="function"){const i=++this.pendingBackendInitId,s=r.then(a=>i<this.pendingBackendInitId?!1:(this.registry[t]=a,this.pendingBackendInit=null,!0)).catch(a=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,kl(`Initialization of backend ${t} failed`),kl(a.stack||a.message)),!1));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}else return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(r){return kl(`Initialization of backend ${t} failed`),kl(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const r=t[n],{success:i,asyncInit:s}=this.initializeBackend(r);if(s||i)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const r=this.state.tensorInfo.get(n),i=r.backend,s=this.readSync(n),a=i.refCount(n);i.disposeData(n,!0),r.backend=t,t.move(n,s,r.shape,r.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let r=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}let i;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(i),()=>(i=n(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(t,n,r){t();try{const i=r();return n(),i}catch(i){throw n(),i}}nextTensorId(){return Mw.nextTensorId++}nextVariableId(){return Mw.nextVariableId++}clone(t){const n=J.runKernel(KC,{x:t}),r={x:t},i=a=>({x:()=>{const o="float32",l={x:a},u={dtype:o};return J.runKernel(PC,l,u)}}),s=[];return this.addTapeNode(this.state.activeScope.name,r,[n],i,s,{}),n}runKernel(t,n,r){if(this.backendName==null&&this.backend,!(mT(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,r){const i=this.backend.numDataIds();let s=0;r.forEach(l=>{s+=l.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=i-n-s-a;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${t}'`)}runKernelFunc(t){let n,r=[];const i=this.isTapeOn(),s=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const u=cj(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(cj(t)){const{kernelName:p,inputs:g,attrs:m}=t;this.backendName==null&&this.backend;const v=mT(p,this.backendName);B(v!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),o=()=>{const y=this.backend.numDataIds();l=v.kernelFunc({inputs:g,attrs:m,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,y,b);const x=b.map(w=>w.rank!=null?w:this.makeTensorFromTensorInfo(w));if(i){const w=this.getTensorsForGradient(p,g,x);r=this.saveTensorsForBackwardMode(w)}return x}}else{const{forwardFunc:p}=t,g=m=>{!i||(r=m.map(v=>this.keep(this.clone(v))))};o=()=>{const m=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,g));const v=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,m,v),v}}const{inputs:c,attrs:f}=t,h=cj(t)?null:t.backwardsFunc;let d;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=o():(d=this.profiler.profileKernel(u,c,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(d),n=d.outputs)}),i&&this.addTapeNode(u,c,n,h,r,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:d.timeMs,extraInfo:d.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(t){return t.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(t,n,r){const i=_Y(t);if(i!=null){const s=i.inputsToSave||[],a=i.outputsToSave||[];let o;i.saveAllInputs?(B(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(n).map(u=>n[u])):o=s.map(u=>n[u]);const l=r.filter((u,c)=>a[c]);return o.concat(l)}return[]}makeTensor(t,n,r,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;let s=t;r==="string"&&Qf(t[0])&&(s=t.map(l=>rh(l)));const a=i.write(s,n,r),o=new On(n,r,a,this.nextTensorId());if(this.trackTensor(o,i),r==="string"){const l=this.state.tensorInfo.get(a),u=cAe(s);this.state.numBytes+=u-l.bytes,l.bytes=u}return o}makeTensorFromDataId(t,n,r,i){r=r||"float32";const s={dataId:t,shape:n,dtype:r};return this.makeTensorFromTensorInfo(s,i)}makeTensorFromTensorInfo(t,n){const{dataId:r,shape:i,dtype:s}=t,a=new On(i,s,r,this.nextTensorId());return this.trackTensor(a,n),a}makeVariable(t,n=!0,r,i){r=r||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.cast(i));const s=new vT(t,n,r,this.nextTensorId());if(this.state.registeredVariables[s.name]!=null)throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(t,n){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let r=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(r=t.size*fT(t.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:r})),t instanceof vT||this.track(t)}incRef(t,n){this.trackTensor(t,n),this.backend.incRef(t.dataId)}removeDataId(t,n){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===n&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const n=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const r=t.size*fT(t.dtype);this.state.numBytes-=r}n.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,n.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,r,i,s,a){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:s},l=_Y(t);l!=null&&(i=l.gradFunc),i!=null&&(o.gradient=u=>(u=u.map((c,f)=>{if(c==null){const h=r[f],d=hs(h.size,h.dtype);return this.makeTensor(d,h.shape,h.dtype)}return c}),i(u.length>1?u:u[0],s,a))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=ote(t),r=new Set(n.map(s=>s.id));for(let s=0;s<this.state.activeScope.track.length;s++){const a=this.state.activeScope.track[s];!a.kept&&!r.has(a.id)&&a.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(s=>{!s.kept&&s.scopeId===i.id&&this.track(s)})}gradients(t,n,r,i=!1){if(B(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));B(s instanceof On,()=>"The result y returned by f() must be a tensor.");const a=Zut(this.state.activeTape,n,s);if(!i&&a.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[s.id]=r==null?oct(s.shape):r,Qut(o,a,u=>this.tidy(u),lct);const l=n.map(u=>o[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:s,grads:l}})}customGrad(t){return B(U0(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{B(n.every(o=>o instanceof On),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const i={};n.forEach((o,l)=>{i[l]=o});const s=(o,l)=>(r=t(...n,l),B(r.value instanceof On,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),B(U0(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),a=(o,l)=>{const u=r.gradFunc(o,l),c=Array.isArray(u)?u:[u];B(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),B(c.every(h=>h instanceof On),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return c.forEach((h,d)=>{f[d]=()=>h}),f};return this.runKernelFunc({forwardFunc:s,backwardsFunc:a,inputs:i})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,n){return this.state.tensorInfo.get(t).backend.readToGPU(t,n)}async time(t){const n=ca(),r=await this.backend.time(t);return r.wallMs=ca()-n,r}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new gge;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Mw.nextTensorId=0;Mw.nextVariableId=0;function oct(e){const t=MB(de(e),"float32");return J.makeTensor(t,e,"float32")}function IAe(){const e=gAe();if(e._tfengine==null){const t=new pAe(e);e._tfengine=new Mw(t)}return Aut(e._tfengine.ENV),tct(()=>e._tfengine),e._tfengine}const J=IAe();function lct(e,t){const n={a:e,b:t};return J.runKernel(Ub,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uct(){return typeof navigator<"u"&&navigator!=null}let MY;function cct(e){MY=e}function lte(e){if(MY!==void 0)return MY;if(e||uct()){if(e||(e=navigator),e.product==="ReactNative")return!0;const t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){const n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function ute(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const fct=Object.freeze(Object.defineProperty({__proto__:null,mockIsMobile:cct,isMobile:lte,isBrowser:ute},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const go=le();go.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});go.registerFlag("IS_BROWSER",()=>ute());go.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");go.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));go.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));go.registerFlag("PROD",()=>!1);go.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>go.getBool("DEBUG"));go.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);go.registerFlag("IS_TEST",()=>!1);go.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>go.getBool("DEBUG"));go.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);go.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);go.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ih(e,t){let n=e;if(Ci(e))return t==="string"?[]:[e.length];if(AAe(e)){const i=e.channels||"RGBA";return[e.height,e.width*i.length]}else if(TAe(e))return[e.buffer.size/(t==null?4:fT(t))];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||Ci(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&le().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&MAe(e,r,[]),r}function MAe(e,t,n){if(n=n||[],!Array.isArray(e)&&!Ci(e)){B(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}B(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),B(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);const r=t.slice(1);for(let i=0;i<e.length;++i)MAe(e[i],r,n.concat(i))}function mge(e,t,n,r){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function U(e,t,n,r="numeric"){if(e instanceof On)return mge(r,e.dtype,t,n),e;let i=Bb(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),mge(r,i,t,n),e==null||!Ci(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){const l=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const s=Ih(e,i);!Ci(e)&&!Array.isArray(e)&&(e=[e]);const o=i!=="string"?Um(e,i):Nh(e,[],!0);return J.makeTensor(o,s,i)}function yT(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((s,a)=>U(s,`${t}[${a}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FAe="__op";function ee(e){const t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+FAe;const i=(...s)=>{J.startScope(n);try{const a=r(...s);return FB(a)&&console.error("Cannot return a Promise inside of tidy."),J.endScope(a),a}catch(a){throw J.endScope(null),a}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hct(e,t){const n=U(e,"real","complex"),r=U(t,"imag","complex");gs(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const i={real:n,imag:r};return J.runKernel(UB,i)}const W0=ee({complex_:hct});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wm(e,t,n,r){if(r==null)r=Bb(e);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(TAe(e)||AAe(e)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return J.backend.createTensorFromGPUData(e,t||n,r)}if(!Ci(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){ml(t);const i=de(t),s=de(n);B(i===s,()=>`Based on the provided shape, [${t}], the tensor should have ${i} values but has ${s}`);for(let a=0;a<n.length;++a){const o=n[a],l=a===n.length-1?o!==de(t.slice(a)):!0;B(n[a]===t[a]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Ci(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=r!=="string"?Um(e,r):Nh(e,[],!0),J.makeTensor(e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vp(e,t,n){const r=Ih(e,n);return Wm(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FY={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class ff{static join(t){return new ff(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(r=>Ci(r)?r.buffer:r),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let n=0;for(let r=0;r<t.length;r++){const i=t[r];r!==t.length-1&&i.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const s=n+i.byteLength;this.shards.push({buffer:i,start:n,end:s}),n=s}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,n=isNaN(Number(n))?0:n,t=Math.max(0,t),n=Math.min(this.byteLength,n),n<=t)return new ArrayBuffer(0);const r=this.findShardForByte(t);if(r===-1)throw new Error(`Could not find start shard for byte ${t}`);const i=n-t,s=new ArrayBuffer(i),a=new Uint8Array(s);let o=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],f=t+o-u.start,h=o,p=Math.min(n,u.end)-u.start,g=new Uint8Array(u.buffer,f,p-f);if(a.set(g,h),o+=g.length,n<u.end)break}return s}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function n(i){return t<i.start?-1:t>=i.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=dct(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function dct(e,t){let n=0,r=e.length;for(;n<=r;){const i=Math.floor((r-n)/2)+n,s=t(e[i]);if(s===0)return i;s<0?r=i:n=i+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A5=4;async function OY(e,t){const n=[],r=[],i=Array.isArray(e)?e.map(a=>a.name):Object.keys(e);for(let a=0;a<i.length;++a){const o=i[a],l=Array.isArray(e)?e[a].tensor:e[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const u={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async f=>{const h=await l.bytes(),d=h.reduce((m,v)=>m+v.length,0)+A5*h.length,p=new Uint8Array(d);let g=0;for(let m=0;m<h.length;m++){const v=h[m],y=new Uint8Array(new Uint32Array([v.length]).buffer);p.set(y,g),g+=A5,p.set(v,g),g+=v.length}f(p)});r.push(c)}else r.push(l.data());t!=null&&(u.group=t),n.push(u)}const s=await Promise.all(r);return{data:pct(s),specs:n}}function OAe(e,t){const n=new ff(e),r={};let i,s=0;for(const a of t){const o=a.name,l=a.dtype,u=a.shape,c=de(u);let f;if("quantization"in a){const h=a.quantization;if(h.dtype==="uint8"||h.dtype==="uint16"){if(!("min"in h&&"scale"in h))throw new Error(`Weight ${a.name} with quantization ${h.dtype} doesn't have corresponding metadata min and scale.`)}else if(h.dtype==="float16"){if(l!=="float32")throw new Error(`Weight ${a.name} is quantized with ${h.dtype} which only supports weights of type float32 not ${l}.`)}else throw new Error(`Weight ${a.name} has unknown quantization dtype ${h.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const d=FY[h.dtype],p=n.slice(s,s+c*d),g=h.dtype==="uint8"?new Uint8Array(p):new Uint16Array(p);if(l==="float32")if(h.dtype==="uint8"||h.dtype==="uint16"){f=new Float32Array(g.length);for(let m=0;m<g.length;m++){const v=g[m];f[m]=v*h.scale+h.min}}else if(h.dtype==="float16")i===void 0&&(i=xct()),f=i(g);else throw new Error(`Unsupported quantization type ${h.dtype} for weight type float32.`);else if(l==="int32"){if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error(`Unsupported quantization type ${h.dtype} for weight type int32.`);f=new Int32Array(g.length);for(let m=0;m<g.length;m++){const v=g[m];f[m]=Math.round(v*h.scale+h.min)}}else throw new Error(`Unsupported dtype in weight '${o}': ${l}`);s+=c*d}else if(l==="string"){const h=de(a.shape);f=[];for(let d=0;d<h;d++){const p=new Uint32Array(n.slice(s,s+A5))[0];s+=A5;const g=new Uint8Array(n.slice(s,s+p));f.push(g),s+=p}}else{const h=FY[l],d=n.slice(s,s+c*h);if(l==="float32")f=new Float32Array(d);else if(l==="int32")f=new Int32Array(d);else if(l==="bool")f=new Uint8Array(d);else if(l==="complex64"){f=new Float32Array(d);const p=new Float32Array(f.length/2),g=new Float32Array(f.length/2);for(let y=0;y<p.length;y++)p[y]=f[y*2],g[y]=f[y*2+1];const m=vp(p,u,"float32"),v=vp(g,u,"float32");r[o]=W0(m,v),m.dispose(),v.dispose()}else throw new Error(`Unsupported dtype in weight '${o}': ${l}`);s+=c*h}l!=="complex64"&&(r[o]=vp(f,u,l))}return r}function pct(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const n=[];e.forEach(s=>{if(t+=s.byteLength,n.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});const r=new Uint8Array(t);let i=0;return n.forEach(s=>{r.set(new Uint8Array(s.buffer),i),i+=s.byteLength}),r.buffer}const cte=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function vge(e){return cte?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function gct(e){if(cte)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let r=0,i=t.length;r<i;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function mct(e){if(cte){const r=Buffer.from(e,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}function RAe(e){return ff.join(e)}function yge(e){const t="/";for(e=e.trim();e.endsWith(t);)e=e.slice(0,e.length-1);const n=e.split(t);return n[n.length-1]}function PAe(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function LAe(e,t,n){const r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(r.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return e.signature!=null&&(r.signature=e.signature),e.userDefinedMetadata!=null&&(r.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(r.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(r.initializerSignature=e.initializerSignature),r}async function fte(e,t){let n,r;return e.weightsManifest!=null&&([n,r]=await t(e.weightsManifest)),LAe(e,n,r)}function CI(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:vge(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:vge(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new ff(e.weightData).byteLength}}function BAe(e){const t=[];for(const n of e)t.push(...n.weights);return t}function vct(){const e=n=>{let r=n<<13,i=0;for(;(r&8388608)===0;)i-=8388608,r<<=1;return r&=-8388609,i+=947912704,r|i},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function yct(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function bct(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function xct(){const e=vct(),t=yct(),n=bct();return r=>{const i=new ArrayBuffer(4*r.length),s=new Uint32Array(i);for(let a=0;a<r.length;a++){const o=r[a],l=e[n[o>>10]+(o&1023)]+t[o>>10];s[a]=l}return new Float32Array(i)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kr{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return kr.instance==null&&(kr.instance=new kr),kr.instance}static registerSaveRouter(t){kr.getInstance().saveRouters.push(t)}static registerLoadRouter(t){kr.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return kr.getHandlers(t,"save")}static getLoadHandlers(t,n){return kr.getHandlers(t,"load",n)}static getHandlers(t,n,r){const i=[];return(n==="load"?kr.getInstance().loadRouters:kr.getInstance().saveRouters).forEach(a=>{const o=a(t,r);o!==null&&i.push(o)}),i}}const wct=e=>kr.registerSaveRouter(e),$ct=e=>kr.registerLoadRouter(e),zAe=e=>kr.getSaveHandlers(e),Cct=(e,t)=>kr.getLoadHandlers(e,t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RY="tensorflowjs",PY=1,E1="models_store",Kg="model_info_store";function UAe(){if(!le().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function LY(e){const t=e.result;t.createObjectStore(E1,{keyPath:"modelPath"}),t.createObjectStore(Kg,{keyPath:"modelPath"})}class My{constructor(t){if(this.indexedDB=UAe(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,n){return new Promise((r,i)=>{const s=this.indexedDB.open(RY,PY);s.onupgradeneeded=()=>LY(s),s.onsuccess=()=>{const a=s.result;if(n==null){const o=a.transaction(E1,"readonly"),u=o.objectStore(E1).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return a.close(),i(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(a.close(),i(u.error)),o.oncomplete=()=>a.close()}else{n.weightData=ff.join(n.weightData);const o=CI(n),l=a.transaction(Kg,"readwrite");let u=l.objectStore(Kg),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(h){return i(h)}let f;c.onsuccess=()=>{f=a.transaction(E1,"readwrite");const h=f.objectStore(E1);let d;try{d=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:o})}catch(p){return i(p)}d.onsuccess=()=>r({modelArtifactsInfo:o}),d.onerror=p=>{u=l.objectStore(Kg);const g=u.delete(this.modelPath);g.onsuccess=()=>(a.close(),i(d.error)),g.onerror=m=>(a.close(),i(d.error))}},c.onerror=h=>(a.close(),i(c.error)),l.oncomplete=()=>{f==null?a.close():f.oncomplete=()=>a.close()}}},s.onerror=a=>i(s.error)})}}My.URL_SCHEME="indexeddb://";const WAe=e=>le().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(My.URL_SCHEME)?_ct(e.slice(My.URL_SCHEME.length)):null;kr.registerSaveRouter(WAe);kr.registerLoadRouter(WAe);function _ct(e){return new My(e)}function Sct(e){return e.startsWith(My.URL_SCHEME)?e.slice(My.URL_SCHEME.length):e}class kct{constructor(){this.indexedDB=UAe()}async listModels(){return new Promise((t,n)=>{const r=this.indexedDB.open(RY,PY);r.onupgradeneeded=()=>LY(r),r.onsuccess=()=>{const i=r.result,s=i.transaction(Kg,"readonly"),o=s.objectStore(Kg).getAll();o.onsuccess=()=>{const l={};for(const u of o.result)l[u.modelPath]=u.modelArtifactsInfo;t(l)},o.onerror=l=>(i.close(),n(o.error)),s.oncomplete=()=>i.close()},r.onerror=i=>n(r.error)})}async removeModel(t){return t=Sct(t),new Promise((n,r)=>{const i=this.indexedDB.open(RY,PY);i.onupgradeneeded=()=>LY(i),i.onsuccess=()=>{const s=i.result,a=s.transaction(Kg,"readwrite"),o=a.objectStore(Kg),l=o.get(t);let u;l.onsuccess=()=>{if(l.result==null)return s.close(),r(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const c=o.delete(t),f=()=>{u=s.transaction(E1,"readwrite");const d=u.objectStore(E1).delete(t);d.onsuccess=()=>n(l.result.modelArtifactsInfo),d.onerror=p=>r(l.error)};c.onsuccess=f,c.onerror=h=>(f(),s.close(),r(l.error))}},l.onerror=c=>(s.close(),r(l.error)),a.oncomplete=()=>{u==null?s.close():u.oncomplete=()=>s.close()}},i.onerror=s=>r(i.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yd="/",C2="tensorflowjs_models",VAe="info",Ect="model_topology",Act="weight_specs",Tct="weight_data",Dct="model_metadata";function jAe(e){return{info:[C2,e,VAe].join(Yd),topology:[C2,e,Ect].join(Yd),weightSpecs:[C2,e,Act].join(Yd),weightData:[C2,e,Tct].join(Yd),modelMetadata:[C2,e,Dct].join(Yd)}}function HAe(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function Nct(e){const t=e.split(Yd);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(Yd)}function Ict(e){return e.startsWith(Fy.URL_SCHEME)?e.slice(Fy.URL_SCHEME.length):e}class Fy{constructor(t){if(!le().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=jAe(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=CI(t),s=ff.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,gct(s));const a={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,initializerSignature:t.initializerSignature!=null?t.initializerSignature:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:i}}catch{throw HAe(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(i==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=i;const s=this.LS.getItem(this.keys.modelMetadata);if(s!=null){const o=JSON.parse(s);n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,o.signature!=null&&(n.signature=o.signature),o.userDefinedMetadata!=null&&(n.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(n.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(n.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(n.trainingConfig=o.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=mct(a),n}}Fy.URL_SCHEME="localstorage://";const qAe=e=>le().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Fy.URL_SCHEME)?Mct(e.slice(Fy.URL_SCHEME.length)):null;kr.registerSaveRouter(qAe);kr.registerLoadRouter(qAe);function Mct(e){return new Fy(e)}class Fct{constructor(){B(le().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),B(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},n=C2+Yd,r=Yd+VAe;for(let i=0;i<this.LS.length;++i){const s=this.LS.key(i);if(s.startsWith(n)&&s.endsWith(r)){const a=Nct(s);t[a]=JSON.parse(this.LS.getItem(s))}}return t}async removeModel(t){t=Ict(t);const n=jAe(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const r=JSON.parse(this.LS.getItem(n.info));return HAe(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G2="://";class fa{constructor(){this.managers={}}static getInstance(){return fa.instance==null&&(fa.instance=new fa),fa.instance}static registerManager(t,n){B(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(G2)&&(t=t.slice(0,t.indexOf(G2))),B(t.length>0,()=>"scheme must not be an empty string.");const r=fa.getInstance();B(r.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=n}static getManager(t){const n=fa.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(fa.getInstance().managers)}}function s4(e){if(e.indexOf(G2)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${fa.getSchemes().join(",")}`);return{scheme:e.split(G2)[0],path:e.split(G2)[1]}}async function GAe(e,t,n=!1){B(e!==t,()=>`Old path and new path are the same: '${e}'`);const r=kr.getLoadHandlers(e);B(r.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),B(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`);const i=r[0],s=kr.getSaveHandlers(t);B(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),B(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);const a=s[0],o=s4(e).scheme,l=s4(e).path,u=o===s4(e).scheme,c=await i.load();n&&u&&await fa.getManager(o).removeModel(l);const f=await a.save(c);return n&&!u&&await fa.getManager(o).removeModel(l),f.modelArtifactsInfo}async function Oct(){const e=fa.getSchemes(),t={};for(const n of e){const r=await fa.getManager(n).listModels();for(const i in r){const s=n+G2+i;t[s]=r[i]}}return t}async function Rct(e){const t=s4(e);return fa.getManager(t.scheme).removeModel(t.path)}async function Pct(e,t){return GAe(e,t,!1)}async function Lct(e,t){return GAe(e,t,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bct{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}setTimeoutCustom(t,n){if(typeof window>"u"||!le().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,n);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const i=this.functionRefs[r.data.index];i(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return bAe(t)}}if(le().get("IS_BROWSER")){le().setPlatform("browser",new Bct);try{fa.registerManager(Fy.URL_SCHEME,new Fct)}catch{}try{fa.registerManager(My.URL_SCHEME,new kct)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zct={importFetch:()=>require("node-fetch")};let fj;class Uct{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return le().global.fetch!=null?le().global.fetch(t,n):(fj==null&&(fj=zct.importFetch()),fj(t,n))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}le().get("IS_NODE")&&!le().get("IS_BROWSER")&&le().setPlatform("node",new Uct);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mt(e,t="float32",n){return t=t||"float32",ml(e),new oi(e,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wct(e,t){const n=U(e,"x","cast");if(!uAe(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},i={dtype:t};return J.runKernel(PC,r,i)}const Oe=ee({cast_:Wct});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vct(e){const n={x:U(e,"x","clone","string_or_numeric")};return J.runKernel(KC,n)}const v0=ee({clone_:Vct});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YAe(e,t=!1){console.log(e.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */IAe();const jct={buffer:Mt,cast:Oe,clone:v0,print:YAe};nct(jct);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hct(){le().set("PROD",!0)}function qct(){le().set("DEBUG",!0)}function Gct(){le().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Yct(e){le().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Xct(){J.disposeVariables()}function dc(){return J}function T5(){return J.memory()}function Kct(e){return J.profile(e)}function ce(e,t){return J.tidy(e,t)}function Bt(e){ote(e).forEach(n=>n.dispose())}function Uc(e){return J.keep(e)}function Zct(e){return J.time(e)}function Qct(e){return J.setBackend(e)}function Jct(){return J.ready()}function eft(){return J.backendName}function tft(e){J.removeBackend(e)}function nft(e){return J.findBackend(e)}function rft(e){return J.findBackendFactory(e)}function hte(e,t,n=1){return J.registerBackend(e,t,n)}function XAe(){return J.backend}function ift(e,t){le().setPlatform(e,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sft(e,t){let n=U(e,"a","add"),r=U(t,"b","add");[n,r]=Ir(n,r);const i={a:n,b:r};return J.runKernel(Ub,i)}const ke=ee({add_:sft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aft(e,t){let n=U(e,"a","floorDiv"),r=U(t,"b","floorDiv");[n,r]=Ir(n,r);const i={a:n,b:r};return J.runKernel(YC,i)}const dte=ee({floorDiv_:aft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oft(e,t){let n=U(e,"a","div"),r=U(t,"b","div");if([n,r]=Ir(n,r),n.dtype==="int32"&&r.dtype==="int32")return dte(n,r);const i={a:n,b:r},s={};return J.runKernel(WC,i,s)}const Qe=ee({div_:oft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lft(e,t){let n=U(e,"a","mul"),r=U(t,"b","mul");[n,r]=Ir(n,r);const i={a:n,b:r};return J.runKernel(s_,i)}const ne=ee({mul_:lft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uft(e){const t=U(e,"x","abs");if(t.dtype==="complex64"){const n={x:t};return J.runKernel(AN,n)}else{const n={x:t};return J.runKernel(bN,n)}}const hi=ee({abs_:uft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cft(e){const n={x:U(e,"x","acos")};return J.runKernel(DC,n)}const KAe=ee({acos_:cft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fft(e){const n={x:U(e,"x","acosh")};return J.runKernel(NC,n)}const ZAe=ee({acosh_:fft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hft(e){B(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),B(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);const t=e.map((i,s)=>U(i,`tensors${s}`,"addN")),n=t[0];t.forEach(i=>{if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(i=>{if(!Qt(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=t;return J.runKernel(xN,r)}const dft=ee({addN_:hft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pft(e,t=null,n=!1){const i={x:U(e,"x","all","bool")},s={axis:t,keepDims:n};return J.runKernel(OB,i,s)}const pte=ee({all_:pft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gft(e,t=null,n=!1){const i={x:U(e,"x","any","bool")},s={axis:t,keepDims:n};return J.runKernel(RB,i,s)}const D5=ee({any_:gft});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mft(e,t=0){const r={x:U(e,"x","argMax")},i={axis:t};return J.runKernel(wN,r,i)}const Fw=ee({argMax_:mft});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vft(e,t=0){const r={x:U(e,"x","argMin")},i={axis:t};return J.runKernel($N,r,i)}const QAe=ee({argMin_:vft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yft(e){const n={x:U(e,"x","asin")};return J.runKernel(IC,n)}const JAe=ee({asin_:yft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bft(e){const n={x:U(e,"x","asinh")};return J.runKernel(MC,n)}const eTe=ee({asinh_:bft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xft(e){const n={x:U(e,"x","atan")};return J.runKernel(FC,n)}const tTe=ee({atan_:xft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wft(e,t){let n=U(e,"a","atan2"),r=U(t,"b","atan2");[n,r]=Ir(n,r);const i={a:n,b:r};return J.runKernel(RC,i)}const nTe=ee({atan2_:wft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ft(e){const n={x:U(e,"x","atanh")};return J.runKernel(OC,n)}const rTe=ee({atanh_:$ft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _I(e,t,n,r,i="NHWC",s){const a=e[3],o=[...t,a],l=rg(i);return Pi(e,o,n,s,r,null,null,l)}function Gu(e,t,n,r,i,s,a="channelsLast"){const[o,l]=bT(t);let u;if(a==="channelsLast")u=[o,l,e[3],e[3]];else if(a==="channelsFirst")u=[o,l,e[1],e[1]];else throw new Error(`Unknown dataFormat ${a}`);return Pi(e,u,n,r,i,s,!1,a)}function ng(e,t,n,r,i,s,a="NDHWC"){const[o,l,u]=BY(t);let c,f;if(a==="NDHWC")f="channelsLast",c=[o,l,u,e[4],e[4]];else if(a==="NCDHW")f="channelsFirst",c=[o,l,u,e[1],e[1]];else throw new Error(`Unknown dataFormat ${a}`);return Vm(e,c,n,r,i,!1,f,s)}function Pi(e,t,n,r,i,s,a=!1,o="channelsLast"){let[l,u,c,f]=[-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,f]=e;else if(o==="channelsFirst")[l,f,u,c]=e;else throw new Error(`Unknown dataFormat ${o}`);const[h,d,,p]=t,[g,m]=bT(n),[v,y]=bT(r),b=Y2(h,v),x=Y2(d,y),{padInfo:w,outHeight:C,outWidth:$}=Sft(i,u,c,g,m,b,x,s,o),_=a?p*f:p;let k;return o==="channelsFirst"?k=[l,_,C,$]:o==="channelsLast"&&(k=[l,C,$,_]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:c,inChannels:f,outHeight:C,outWidth:$,outChannels:_,padInfo:w,strideHeight:g,strideWidth:m,filterHeight:h,filterWidth:d,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:v,dilationWidth:y,inShape:e,outShape:k,filterShape:t}}function Vm(e,t,n,r,i,s=!1,a="channelsLast",o){let[l,u,c,f,h]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,f,h]=e;else if(a==="channelsFirst")[l,h,u,c,f]=e;else throw new Error(`Unknown dataFormat ${a}`);const[d,p,g,,m]=t,[v,y,b]=BY(n),[x,w,C]=BY(r),$=Y2(d,x),_=Y2(p,w),k=Y2(g,C),{padInfo:E,outDepth:S,outHeight:N,outWidth:A}=kft(i,u,c,f,v,y,b,$,_,k,o),D=s?m*h:m;let T;return a==="channelsFirst"?T=[l,D,S,N,A]:a==="channelsLast"&&(T=[l,S,N,A,D]),{batchSize:l,dataFormat:a,inDepth:u,inHeight:c,inWidth:f,inChannels:h,outDepth:S,outHeight:N,outWidth:A,outChannels:D,padInfo:E,strideDepth:v,strideHeight:y,strideWidth:b,filterDepth:d,filterHeight:p,filterWidth:g,effectiveFilterDepth:$,effectiveFilterHeight:_,effectiveFilterWidth:k,dilationDepth:x,dilationHeight:w,dilationWidth:C,inShape:e,outShape:T,filterShape:t}}function Cft(e,t,n,r,i){r==null&&(r=gte(e,t,n));const s=e[0],a=e[1],o=xT((s-t+2*r)/n+1,i),l=xT((a-t+2*r)/n+1,i);return[o,l]}function _ft(e,t,n,r,i,s){i==null&&(i=gte(e,t[0],r[0]));const a=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*i>=t[o]&&(a[o]=xT((e[o]-t[o]+2*i)/r[o]+1,s));return a}function gte(e,t,n,r=1){const i=Y2(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function bT(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function BY(e){return typeof e=="number"?[e,e,e]:e}function Y2(e,t){return t<=1?e:e+(e-1)*(t-1)}function Sft(e,t,n,r,i,s,a,o,l){let u,c,f;if(typeof e=="number"){u={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};const d=Cft([t,n],s,r,e,o);c=d[0],f=d[1]}else if(e==="same"){c=Math.ceil(t/r),f=Math.ceil(n/i);const h=Math.max(0,(c-1)*r+s-t),d=Math.max(0,(f-1)*i+a-n),p=Math.floor(h/2),g=h-p,m=Math.floor(d/2),v=d-m;u={top:p,bottom:g,left:m,right:v,type:"SAME"}}else if(e==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-s+1)/r),f=Math.ceil((n-a+1)/i);else if(typeof e=="object"){const h=l==="channelsLast"?e[1][0]:e[2][0],d=l==="channelsLast"?e[1][1]:e[2][1],p=l==="channelsLast"?e[2][0]:e[3][0],g=l==="channelsLast"?e[2][1]:e[3][1];u={top:h,bottom:d,left:p,right:g,type:h===0&&d===0&&p===0&&g===0?"VALID":"EXPLICIT"},c=xT((t-s+h+d)/r+1,o),f=xT((n-a+p+g)/i+1,o)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:u,outHeight:c,outWidth:f}}function kft(e,t,n,r,i,s,a,o,l,u,c){let f,h,d,p;if(e==="valid"&&(e=0),typeof e=="number"){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};const m=_ft([t,n,r,1],[o,l,u],1,[i,s,a],e,c);h=m[0],d=m[1],p=m[2]}else if(e==="same"){h=Math.ceil(t/i),d=Math.ceil(n/s),p=Math.ceil(r/a);const g=(h-1)*i+o-t,m=(d-1)*s+l-n,v=(p-1)*a+u-r,y=Math.floor(g/2),b=g-y,x=Math.floor(m/2),w=m-x,C=Math.floor(v/2),$=v-C;f={top:x,bottom:w,left:C,right:$,front:y,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:f,outDepth:h,outHeight:d,outWidth:p}}function xT(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function V0(e){const[t,n,r]=bT(e);return t===1&&n===1&&r===1}function ms(e,t){return V0(e)||V0(t)}function Oy(e){return bT(e).every(t=>t>0)}function rg(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function La(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")B(Iy(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(r=>{r.forEach(i=>{B(Iy(i),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${i}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eft(e,t){const r={x:U(e,"x","reshape","string_or_numeric")},i={shape:t};return J.runKernel(lI,r,i)}const ie=ee({reshape_:Eft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aft(e,t,n,r,i){const s=U(e,"x","avgPool","float32"),a=1;B(ms(n,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);let o=s,l=!1;s.rank===3&&(l=!0,o=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]])),B(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),La("avgPool",r,i);const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i};let f=J.runKernel(CN,u,c);return f=Oe(f,s.dtype),l?ie(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Wz=ee({avgPool_:Aft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tft(e,t,n,r,i,s="NDHWC"){const a=U(e,"x","avgPool3d","float32");let o=a,l=!1;a.rank===4&&(l=!0,o=ie(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),B(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),B(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),B(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),La("avgPool3d",r,i);const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:s};let f=J.runKernel(_N,u,c);return f=Oe(f,o.dtype),l?ie(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const iTe=ee({avgPool3d_:Tft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dft(e,t=0){B(e.length>=1,()=>"Pass at least one tensor to concat");const n=yT(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),n.length===1)return v0(n[0]);const r=n,i={axis:t};return J.runKernel(TN,r,i)}const Di=ee({concat_:Dft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nft(e,t,n=!1,r=!1){let i=U(e,"a","matMul"),s=U(t,"b","matMul");[i,s]=Ir(i,s);const a={a:i,b:s},o={transposeA:n,transposeB:r};return J.runKernel(SN,a,o)}const Pt=ee({matMul_:Nft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ift(e){const n={x:U(e,"x","sigmoid","float32")};return J.runKernel(m_,n)}const ih=ee({sigmoid_:Ift});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mft(e,t,n){const r=U(e,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const i={x:r},s={begin:t,size:n};return J.runKernel(dI,i,s)}const sn=ee({slice_:Mft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fft(e){const n={x:U(e,"x","tanh","float32")};return J.runKernel($_,n)}const Ow=ee({tanh_:Fft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oft(e,t,n,r,i,s){const a=U(e,"forgetBias","basicLSTMCell"),o=U(t,"lstmKernel","basicLSTMCell"),l=U(n,"lstmBias","basicLSTMCell"),u=U(r,"data","basicLSTMCell"),c=U(i,"c","basicLSTMCell"),f=U(s,"h","basicLSTMCell"),h=Di([u,f],1),d=Pt(h,o),p=ke(d,l),g=p.shape[0],m=p.shape[1]/4,v=[g,m],y=sn(p,[0,0],v),b=sn(p,[0,m],v),x=sn(p,[0,m*2],v),w=sn(p,[0,m*3],v),C=ke(ne(ih(y),Ow(b)),ne(c,ih(ke(a,x)))),$=ne(Ow(C),ih(w));return[C,$]}const Rft=ee({basicLSTMCell_:Oft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pft(e,t,n){const r=U(e,"x","batchToSpaceND"),i=t.reduce((o,l)=>o*l);B(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),B(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),B(r.shape[0]%i===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`);const s={x:r},a={blockShape:t,crops:n};return J.runKernel(kN,s,a)}const Vz=ee({batchToSpaceND_:Pft});function Lft(e){let t;return e.rank===0||e.rank===1?t=ie(e,[1,1,1,e.size]):e.rank===2?t=ie(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bft(e,t,n,r,i,s){s==null&&(s=.001);const a=U(e,"x","batchNorm"),o=U(t,"mean","batchNorm"),l=U(n,"variance","batchNorm");let u;i!=null&&(u=U(i,"scale","batchNorm"));let c;r!=null&&(c=U(r,"offset","batchNorm")),B(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),B(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),B(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:Lft(a),scale:u,offset:c,mean:o,variance:l},d={varianceEpsilon:s},p=J.runKernel(LN,h,d);return ie(p,a.shape)}const SI=ee({batchNorm_:Bft});function zft(e,t,n,r,i,s){const a=U(e,"x","batchNorm"),o=U(t,"mean","batchNorm"),l=U(n,"variance","batchNorm");let u;i!=null&&(u=U(i,"scale","batchNorm"));let c;return r!=null&&(c=U(r,"offset","batchNorm")),B(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),B(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),B(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&B(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&B(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),SI(a,o,l,c,u,s)}const sTe=ee({batchNorm2d_:zft});function Uft(e,t,n,r,i,s){const a=U(e,"x","batchNorm"),o=U(t,"mean","batchNorm"),l=U(n,"variance","batchNorm");let u;i!=null&&(u=U(i,"scale","batchNorm"));let c;return r!=null&&(c=U(r,"offset","batchNorm")),B(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),B(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),B(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&B(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&B(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),SI(a,o,l,c,u,s)}const aTe=ee({batchNorm3d_:Uft});function Wft(e,t,n,r,i,s){const a=U(e,"x","batchNorm"),o=U(t,"mean","batchNorm"),l=U(n,"variance","batchNorm");let u;i!=null&&(u=U(i,"scale","batchNorm"));let c;return r!=null&&(c=U(r,"offset","batchNorm")),B(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),B(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),B(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&B(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&B(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),SI(a,o,l,c,u,s)}const oTe=ee({batchNorm4d_:Wft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vft(e,t,n){const r=U(e,"x","bincount"),i=U(t,"weights","bincount");B(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),B(n>=0,()=>`size must be non-negative, but got ${n}.`),B(i.size===r.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`);const s={x:r,weights:i},a={size:n};return J.runKernel(BB,s,a)}const lTe=ee({bincount_:Vft});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jft(e,t){const n=U(e,"x","bitwiseAnd"),r=U(t,"y","bitwiseAnd");if(!Qt(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const i={a:n,b:r};return J.runKernel(EN,i)}const Hft=ee({bitwiseAnd_:jft});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qft(e,t){const n=U(e,"s0","broadcastArgs","int32"),r=U(t,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const i={s0:n,s1:r};return J.runKernel(zB,i)}const Gft=ee({broadcastArgs_:qft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yft(e,t){let n=U(e,"broadcastTo","x");const r=n.shape;if(ml(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const u=n.shape.slice();for(;u.length<t.length;)u.unshift(1);n=ie(n,u)}const i=n.shape,s=Array.from(t);for(let u=t.length-1;u>=0;u--)if(i[u]===t[u])s[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(s.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return v0(n);const o={x:n},l={reps:s};return J.runKernel(C_,o,l)}const X2=ee({broadcastTo_:Yft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xft(e){const n={x:U(e,"x","ceil","float32")};return J.runKernel(LC,n)}const uTe=ee({ceil_:Xft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S_(e,t,n){ml(e),n=n||Bb(t);const r={shape:e,value:t,dtype:n};return J.runKernel(nz,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kft(e,t,n){const r=U(e,"x","clipByValue");if(B(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return S_(r.shape,t,r.dtype);const i={x:r},s={clipValueMin:t,clipValueMax:n};return J.runKernel(BC,i,s)}const sl=ee({clipByValue_:Kft});function Zft(e){return Di(e,0)}const cTe=ee({concat1d_:Zft});function Qft(e,t){return Di(e,t)}const fTe=ee({concat2d_:Qft});function Jft(e,t){return Di(e,t)}const hTe=ee({concat3d_:Jft});function eht(e,t){return Di(e,t)}const dTe=ee({concat4d_:eht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tht(e,t,n,r,i="NHWC",s=[1,1],a){const o=U(e,"x","conv2d","float32"),l=U(t,"filter","conv2d","float32");let u=o,c=!1;o.rank===3&&(c=!0,u=ie(o,[1,o.shape[0],o.shape[1],o.shape[2]])),B(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),B(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),La("conv2d",r,a);const f=i==="NHWC"?u.shape[3]:u.shape[1];B(f===l.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${l.shape[2]}.`),B(ms(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),B(Oy(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),B(Oy(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:u,filter:l},d={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:a},p=J.runKernel(DN,h,d);return c?ie(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const j0=ee({conv2d_:tht});function nht(e,t,n,r,i="NWC",s=1,a){const o=U(e,"x","conv1d"),l=U(t,"filter","conv1d");let u=o,c=!1;o.rank===2&&(c=!0,u=ie(o,[1,o.shape[0],o.shape[1]])),B(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),B(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),La("conv1d",r,a),B(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),B(ms(n,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${s}'`),B(Oy(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),B(Oy(n),()=>"Error in conv1D: Stride should be larger than 0."),B(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const f=ie(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=ie(u,[u.shape[0],1,u.shape[1],u.shape[2]]),m=j0(h,f,[1,n],r,"NHWC",[1,s],a);return c?ie(m,[m.shape[2],m.shape[3]]):ie(m,[m.shape[0],m.shape[2],m.shape[3]])}const mte=ee({conv1d_:nht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rht(e,t,n,r,i,s="NHWC",a){B(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let o=e,l=t,u=!1;t.rank===3&&(u=!0,l=ie(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),B(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),B(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),B(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=s==="NHWC"?o[3]:o[1],f=s==="NHWC"?l.shape[3]:l.shape[1];B(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),B(f===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[3]}.`),La("conv2dDerInput",i,a);const h={dy:l,filter:n},d={strides:r,pad:i,dataFormat:s,dimRoundingMode:a,inputShape:o},p=J.runKernel(NN,h,d);return u?ie(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const vte=ee({conv2DBackpropInput_:rht});function iht(e,t,n,r,i,s){const a=U(e,"x","conv2dTranspose"),o=U(t,"filter","conv2dTranspose");return vte(n,a,o,r,i,"NHWC",s)}const yte=ee({conv2dTranspose_:iht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sht(e,t,n,r,i="NDHWC",s=[1,1,1]){const a=U(e,"x","conv3d"),o=U(t,"filter","conv3d");let l=a,u=!1;a.rank===4&&(u=!0,l=ie(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),B(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),B(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),B(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),B(ms(n,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),B(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),B(Oy(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),B(Oy(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:o},f={strides:n,pad:r,dataFormat:i,dilations:s},h=J.runKernel(IN,c,f);return u?ie(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const pTe=ee({conv3d_:sht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aht(e,t,n,r,i){B(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let s=e,a=t,o=!1;t.rank===4&&(o=!0,a=ie(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,e[0],e[1],e[2],e[3]]);const l=s[4],u=a.shape[4];B(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),B(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),B(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),B(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),B(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:a,filter:n},f={pad:i,strides:r,inputShape:s},h=J.runKernel(jB,c,f);return o?ie(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const gTe=ee({conv3DBackpropInput_:aht});function oht(e,t,n,r,i){const s=U(e,"x","conv3dTranspose"),a=U(t,"filter","conv3dTranspose");return gTe(n,s,a,r,i)}const mTe=ee({conv3dTranspose_:oht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lht(e){const n={x:U(e,"x","cos","float32")};return J.runKernel(zC,n)}const jz=ee({cos_:lht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uht(e){const n={x:U(e,"x","cosh","float32")};return J.runKernel(UC,n)}const bte=ee({cosh_:uht});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cht(e,t=0,n=!1,r=!1){const s={x:U(e,"x","cumprod")},a={axis:t,exclusive:n,reverse:r};return J.runKernel(HB,s,a)}const N5=ee({cumprod_:cht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fht(e,t=0,n=!1,r=!1){const s={x:U(e,"x","cumsum")},a={axis:t,exclusive:n,reverse:r};return J.runKernel(MN,s,a)}const xte=ee({cumsum_:fht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hht(e,t,n,r=!1){const i=U(e,"x","denseBincount"),s=U(t,"weights","denseBincount");B(i.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),B(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),B(n>=0,()=>`size must be non-negative, but got ${n}.`),B(s.size===i.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${s.shape}.`);const a={x:i,weights:s},o={size:n,binaryOutput:r};return J.runKernel(GB,a,o)}const zY=ee({denseBincount_:hht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dht(e,t,n="NHWC"){const r=U(e,"x","depthToSpace","float32"),i=n==="NHWC"?r.shape[1]:r.shape[2],s=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];B(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),B(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t}  for depthToSpace with input shape
    ${r.shape}`),B(s*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${t} for depthToSpace with input shape
        ${r.shape}`),B(a%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${a} for depthToSpace with input shape ${r.shape}`);const o={x:r},l={blockSize:t,dataFormat:n};return J.runKernel(YB,o,l)}const vTe=ee({depthToSpace_:dht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pht(e,t,n,r,i="NHWC",s=[1,1],a){const o=U(e,"x","depthwiseConv2d","float32"),l=U(t,"filter","depthwiseConv2d","float32");let u=o,c=!1;o.rank===3&&(c=!0,u=ie(o,[1,o.shape[0],o.shape[1],o.shape[2]])),B(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),B(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const f=i==="NHWC"?u.shape[3]:u.shape[1];B(f===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${l.shape[2]}.`),La("depthwiseConv2d",r,a);const h={x:u,filter:l},d={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:a},p=J.runKernel(FN,h,d);return c?ie(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const kI=ee({depthwiseConv2d_:pht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ght(e){const n={x:U(e,"x","diag")};return J.runKernel(ZB,n)}const mht=ee({diag_:ght});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vht(e,t,n,r,i=[1,1],s="NHWC"){const a=U(e,"x","dilation2d"),o=U(t,"filter","dilation2d");B(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),B(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),B(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let l=a,u=!1;a.rank===3&&(l=ie(a,[1,a.shape[0],a.shape[1],a.shape[2]]),u=!0),B(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);const c={x:l,filter:o},f={strides:n,pad:r,dilations:i},h=J.runKernel(ON,c,f);return u?ie(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const yTe=ee({dilation2d_:vht});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ry(e,t){const n=e.length,r=[];for(let i=0;i<n;i++){const s=n-1-i,a=e[s]||1;(t[t.length-1-i]||1)>1&&a===1&&r.unshift(s)}return r}function ui(e,t){const n=[];for(let r=0;r<t.length;r++){const i=e[e.length-r-1],s=t.length-r-1,a=t[s];(i==null||i===1&&a>1)&&n.unshift(s)}return n}function Ct(e,t){const n=Math.max(e.length,t.length),r=new Array(n);for(let i=0;i<n;i++){let s=e[e.length-i-1];s==null&&(s=1);let a=t[t.length-i-1];if(a==null&&(a=1),s===1)r[n-i-1]=a;else if(a===1)r[n-i-1]=s;else if(s!==a){const o=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(o)}else r[n-i-1]=s}return r}const yht=Object.freeze(Object.defineProperty({__proto__:null,getBroadcastDims:Ry,getReductionAxes:ui,assertAndGetBroadcastShape:Ct},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bht(e,t){let n=U(e,"a","equal","string_or_numeric"),r=U(t,"b","equal","string_or_numeric");[n,r]=Ir(n,r),Ct(n.shape,r.shape);const i={a:n,b:r};return J.runKernel(RN,i)}const Kc=ee({equal_:bht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xht(e,t,n){const r=U(t,"a","where"),i=U(n,"b","where"),s=U(e,"condition","where","bool"),a=Ct(Ct(s.shape,r.shape),i.shape),o=X2(s,a),l=X2(r,a),u=X2(i,a),c={condition:o,t:l,e:u};return J.runKernel(hI,c)}const Ws=ee({where_:xht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wht(e){const n={x:U(e,"x","zerosLike")};return J.runKernel(wI,n)}const en=ee({zerosLike_:wht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ht(e,t){let n=U(e,"a","div"),r=U(t,"b","div");[n,r]=Ir(n,r);const i=Qe(n,r),s=en(i),a=Kc(r,s);return Ws(a,s,i)}const bTe=ee({divNoNan_:$ht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cht(e,t){const n=U(e,"t1","dot"),r=U(t,"t2","dot");B((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const i=n.rank===1?n.size:n.shape[1],s=r.rank===1?r.size:r.shape[0];if(B(i===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${s}.`),n.rank===1&&r.rank===1){const a=ie(n,[1,-1]),o=ie(r,[-1,1]),l=Pt(a,o);return ie(l,[])}else if(n.rank===1&&r.rank===2){const a=ie(n,[1,-1]),o=ie(r,[r.shape[0],r.shape[1]]),l=Pt(a,o);return ie(l,[l.size])}else if(n.rank===2&&r.rank===1){const a=ie(r,[-1,1]),o=Pt(n,a);return ie(o,[o.size])}else{const a=ie(r,[r.shape[0],r.shape[1]]);return Pt(n,a)}}const xTe=ee({dot_:Cht});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ht(e,...t){const n=t.map((i,s)=>U(i,`tensors${s}`,"einsum")),r={equation:e};return J.runKernel(JB,n,r)}const Sht=ee({einsum_:_ht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kht(e){const n={x:U(e,"x","elu","float32")};return J.runKernel(VC,n)}const EI=ee({elu_:kht});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eht(e,t){const n=U(e,"x","ensureShape","string_or_numeric");if(!oAe(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}const Aht=ee({ensureShape_:Eht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tht(e){let t=U(e,"x","erf");B(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=Oe(t,"float32"));const n={x:t};return J.runKernel(jC,n)}const wTe=ee({erf_:Tht});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function $Te(e,t,n){const r=e.length+t.length,i=[];let s=0,a=0;for(let o=0;o<r;o++)n.indexOf(o)===-1?i.push(e[s++]):i.push(t[a++]);return i}function Li(e,t){const n=[],r=e.length;for(let s=0;s<r;s++)t.indexOf(s)===-1&&n.push(e[s]);const i=t.map(s=>e[s]);return[n,i]}function Zr(e,t){const n=t.map(r=>1);return $Te(e,n,t)}function vs(e,t,n){B(wte(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function Fr(e,t){if(wte(e,t))return null;const n=[];for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(r=>n.push(r)),n}function jm(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function Jr(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dht(e,t=null,n=!1){const i={x:U(e,"x","max")},s={reductionIndices:t,keepDims:n};return J.runKernel(YN,i,s)}const Du=ee({max_:Dht});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nht(e,t=null,n=!1){const i={x:U(e,"x","min")},s={axis:t,keepDims:n};return J.runKernel(QN,i,s)}const wT=ee({min_:Nht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iht(e,t){let n=U(e,"base","pow"),r=U(t,"exp","pow");[n,r]=Ir(n,r);const i={a:n,b:r};return J.runKernel(a_,i)}const H0=ee({pow_:Iht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xt(e,t){if((Ci(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Ci(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Wm(e,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mht(e){const n={x:U(e,"x","sqrt","float32")};return J.runKernel(y_,n)}const qs=ee({sqrt_:Mht});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fht(e){const t=U(e,"x","square"),n={};return J.runKernel("Square",{x:t},n)}const Gn=ee({square_:Fht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oht(e,t=null,n=!1){let r=U(e,"x","sum");r.dtype==="bool"&&(r=Oe(r,"int32"));const i={x:r},s={axis:t,keepDims:n};return J.runKernel(pI,i,s)}const qe=ee({sum_:Oht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rht(e,t="euclidean",n=null,r=!1){e=U(e,"x","norm");const i=CTe(e,t,n);let s=i.shape;if(r){const a=Ot(n,e.shape);s=Zr(i.shape,a)}return ie(i,s)}function CTe(e,t,n=null){if(e.rank===0)return hi(e);if(e.rank!==1&&n===null)return CTe(ie(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return qe(hi(e),n);if(t===1/0)return Du(hi(e),n);if(t===-1/0)return wT(hi(e),n);if(t==="euclidean"||t===2)return qs(qe(H0(hi(e),xt(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return Du(qe(hi(e),n[0]),n[1]-1);if(t===1/0)return Du(qe(hi(e),n[1]),n[0]);if(t===-1/0)return wT(qe(hi(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return qs(qe(Gn(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const AI=ee({norm_:Rht});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pht(e,t=null,n=!1){return AI(e,"euclidean",t,n)}const _Te=ee({euclideanNorm_:Pht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lht(e){const n={x:U(e,"x","exp")};return J.runKernel(HC,n)}const Vl=ee({exp_:Lht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bht(e,t=0){const n=U(e,"x","expandDims","string_or_numeric");B(t<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},i={dim:t};return J.runKernel(PN,r,i)}const Ga=ee({expandDims_:Bht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zht(e){const n={x:U(e,"x","expm1")};return J.runKernel(qC,n)}const STe=ee({expm1_:zht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uht(e,t){const n=U(e,"x","tile","string_or_numeric");B(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const r={x:n},i={reps:t};return J.runKernel(C_,r,i)}const mu=ee({tile_:Uht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wht(e,t,n,r="float32"){t==null&&(t=e);const i=Mt([e,t],r),s=e<=t?e:t;for(let o=0;o<s;++o)i.set(1,o,o);const a=ie(i.toTensor(),[e,t]);if(n==null)return a;if(n.length===1)return mu(Ga(a,0),[n[0],1,1]);if(n.length===2)return mu(Ga(Ga(a,0),0),[n[0],n[1],1,1]);if(n.length===3)return mu(Ga(Ga(Ga(a,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const $te=ee({eye_:Wht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vht(e){const n={x:U(e,"x","floor","float32")};return J.runKernel(GC,n)}const TI=ee({floor_:Vht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jht(e,t,n=0,r=0){const i=U(e,"x","gather"),s=U(t,"indices","gather","int32"),a={x:i,indices:s},o={axis:n,batchDims:r};return J.runKernel(BN,a,o)}const DI=ee({gather_:jht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hht(e,t){let n=U(e,"a","greater","string_or_numeric"),r=U(t,"b","greater","string_or_numeric");[n,r]=Ir(n,r),Ct(n.shape,r.shape);const i={a:n,b:r};return J.runKernel(zN,i)}const yl=ee({greater_:Hht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qht(e,t){let n=U(e,"a","greaterEqual","string_or_numeric"),r=U(t,"b","greaterEqual","string_or_numeric");[n,r]=Ir(n,r),Ct(n.shape,r.shape);const i={a:n,b:r};return J.runKernel(XC,i)}const Hm=ee({greaterEqual_:qht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ght(e){const n={input:U(e,"input","imag")};return J.runKernel(az,n)}const Hz=ee({imag_:Ght});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yht(e){const n={x:U(e,"x","isFinite")};return J.runKernel(ZC,n)}const kTe=ee({isFinite_:Yht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xht(e){const n={x:U(e,"x","isInf")};return J.runKernel(QC,n)}const ETe=ee({isInf_:Xht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kht(e){const n={x:U(e,"x","isNaN")};return J.runKernel(JC,n)}const ATe=ee({isNaN_:Kht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zht(e,t=.2){const r={x:U(e,"x","leakyRelu")},i={alpha:t};return J.runKernel(UN,r,i)}const qz=ee({leakyRelu_:Zht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qht(e,t){let n=U(e,"a","less","string_or_numeric"),r=U(t,"b","less","string_or_numeric");[n,r]=Ir(n,r),Ct(n.shape,r.shape);const i={a:n,b:r};return J.runKernel(WN,i)}const $T=ee({less_:Qht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jht(e,t){let n=U(e,"a","lessEqual","string_or_numeric"),r=U(t,"b","lessEqual","string_or_numeric");[n,r]=Ir(n,r),Ct(n.shape,r.shape);const i={a:n,b:r};return J.runKernel(VN,i)}const Vb=ee({lessEqual_:Jht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function edt(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:e,stop:t,num:n};return J.runKernel(oz,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tdt(e,t=5,n=1,r=1,i=.5){const s=U(e,"x","localResponseNormalization");B(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),B(Iy(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let a=s,o=!1;s.rank===3&&(o=!0,a=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const l={x:a},u={depthRadius:t,bias:n,alpha:r,beta:i},c=J.runKernel(GN,l,u);return o?ie(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const TTe=ee({localResponseNormalization_:tdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ndt(e){const n={x:U(e,"x","log","float32")};return J.runKernel(e_,n)}const jl=ee({log_:ndt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rdt(e){const n={x:U(e,"x","log1p")};return J.runKernel(t_,n)}const Gz=ee({log1p_:rdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function idt(e){return B(U0(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{const r=U(t,"x","tf.grad","string_or_numeric"),i=n!=null?U(n,"dy","tf.grad"):null;return J.tidy(()=>{const{value:s,grads:a}=J.gradients(()=>e(r),[r],i);return i!=null&&gs(s.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Yz(a),a[0]})}}function sdt(e){return B(U0(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{B(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const r=yT(t,"args","tf.grads","string_or_numeric"),i=n!=null?U(n,"dy","tf.grads"):null;return J.tidy(()=>{const{value:s,grads:a}=J.gradients(()=>e(...r),r,i);return i!=null&&gs(s.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Yz(a),a})}}function adt(e){return B(U0(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{B(t instanceof On,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),B(n==null||n instanceof On,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:r,value:i}=J.gradients(()=>e(t),[t],n);return Yz(r),{grad:r[0],value:i}}}function odt(e){return B(U0(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{B(Array.isArray(t)&&t.every(i=>i instanceof On),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),B(n==null||n instanceof On,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const r=J.gradients(()=>e(...t),t,n);return n!=null&&gs(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Yz(r.grads),r}}function DTe(e,t){B(U0(e),()=>"The f passed in variableGrads(f) must be a function"),B(t==null||Array.isArray(t)&&t.every(u=>u instanceof vT),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=t!=null;if(!n){t=[];for(const u in J.registeredVariables)t.push(J.registeredVariables[u])}const r=n?t.filter(u=>!u.trainable):null,i=t.length;t=t.filter(u=>u.trainable),B(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const s=!0,{value:a,grads:o}=J.gradients(e,t,null,s);B(o.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),B(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const l={};return t.forEach((u,c)=>{o[c]!=null&&(l[u.name]=o[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:a,grads:l}}function Mh(e){return J.customGrad(e)}function Yz(e){if(e.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ldt(e){const n={x:U(e,"x","neg")};return J.runKernel(eI,n)}const ur=ee({neg_:ldt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function udt(e){const n={x:U(e,"x","softplus")};return J.runKernel(v_,n)}const k_=ee({softplus_:udt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cdt(e){const t=U(e,"x","logSigmoid");return Mh(r=>({value:ur(k_(ur(r))),gradFunc:a=>ne(a,ih(ur(r)))}))(t)}const NTe=ee({logSigmoid_:cdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fdt(e,t){let n=U(e,"a","sub"),r=U(t,"b","sub");[n,r]=Ir(n,r);const i={a:n,b:r};return J.runKernel(x_,i)}const We=ee({sub_:fdt});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hdt(e,t=-1){const n=U(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Mh((i,s)=>{const o=Du(i,t,!0),l=We(i,o),u=We(Oe(l,"float32"),jl(qe(Vl(l),t,!0)));return s([u]),{value:u,gradFunc:(f,h)=>{const[d]=h,p=!0,g=Vl(d);return We(f,ne(qe(f,t,p),g))}}})(n)}const Cte=ee({logSoftmax_:hdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ddt(e,t=null,n=!1){const r=U(e,"x","logSumExp"),i=Ot(t,r.shape),s=Du(r,i,!0),a=We(r,s),o=Vl(a),l=qe(o,i),u=jl(l),c=ke(ie(s,u.shape),u);if(n){const f=Zr(c.shape,i);return ie(c,f)}return c}const _te=ee({logSumExp_:ddt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pdt(e,t){const n=U(e,"a","logicalAnd","bool"),r=U(t,"b","logicalAnd","bool");Ct(n.shape,r.shape);const i={a:n,b:r};return J.runKernel(jN,i)}const Fh=ee({logicalAnd_:pdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gdt(e){const n={x:U(e,"x","logicalNot","bool")};return J.runKernel(HN,n)}const Xz=ee({logicalNot_:gdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mdt(e,t){const n=U(e,"a","logicalOr","bool"),r=U(t,"b","logicalOr","bool");Ct(n.shape,r.shape);const i={a:n,b:r};return J.runKernel(qN,i)}const Ste=ee({logicalOr_:mdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vdt(e,t){const n=U(e,"a","logicalXor","bool"),r=U(t,"b","logicalXor","bool");return Ct(n.shape,r.shape),Fh(Ste(e,t),Xz(Fh(e,t)))}const ITe=ee({logicalXor_:vdt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iO=2147483648;function ydt(e,t,n="left"){const r=U(e,"sortedSequence","searchSorted"),i=U(t,"values","searchSorted"),s=r.shape[r.shape.length-1],a=i.shape[i.shape.length-1],o=ie(r,[-1,s]),l=ie(i,[-1,a]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(de(l.shape)>=iO)throw new Error(`values tensor size must less than ${iO}`);if(o.shape[1]>=iO)throw new Error(`trailing dim_size must less than ${iO} for int32 output type, was ${o.shape[1]}`);const u={sortedSequence:o,values:l},c={side:n};return J.runKernel(Sz,u,c)}const kte=ee({searchSorted_:ydt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bdt(e,t){return kte(e,t,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xdt(e,t,n,r,i){const s=U(e,"x","maxPool"),a=1;let o=s,l=!1;s.rank===3&&(l=!0,o=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]])),B(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),B(ms(n,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),La("maxPool",r,i);const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i},f=J.runKernel(XN,u,c);return l?ie(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Kz=ee({maxPool_:xdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wdt(e,t=[1,1,1],n,r,i,s="NDHWC"){const a=U(e,"x","maxPool3d");let o=a,l=!1;a.rank===4&&(l=!0,o=ie(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),B(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),B(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),La("maxPool3d",r,i);const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:s},f=J.runKernel(KN,u,c);return l?ie(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const MTe=ee({maxPool3d_:wdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $dt(e,t,n,r,i=!1){const a={x:U(e,"x","maxPoolWithArgmax")},o={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},l=J.runKernel(fz,a,o);return{result:l[0],indexes:l[1]}}const Cdt=ee({maxPoolWithArgmax_:$dt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _dt(e,t){let n=U(e,"a","maximum"),r=U(t,"b","maximum");[n,r]=Ir(n,r),n.dtype==="bool"&&(n=Oe(n,"int32"),r=Oe(r,"int32")),Ct(n.shape,r.shape);const i={a:n,b:r};return J.runKernel(n_,i)}const ig=ee({maximum_:_dt});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sdt(e,t=null,n=!1){const i={x:U(e,"x","mean")},s={axis:t,keepDims:n};return J.runKernel(ZN,i,s)}const Lr=ee({mean_:Sdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function di(e,t="float32"){if(ml(e),t==="complex64"){const r=di(e,"float32"),i=di(e,"float32");return W0(r,i)}const n=hs(de(e),t);return J.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dl(e,t="float32"){if(ml(e),t==="complex64"){const r=Dl(e,"float32"),i=di(e,"float32");return W0(r,i)}const n=MB(de(e),t);return J.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kdt(e,t,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(e===void 0)return[];let r=U(e,"x","meshgrid",e instanceof On?e.dtype:"float32");if(t===void 0)return[r];let i=U(t,"y","meshgrid",t instanceof On?t.dtype:"float32");const s=de(r.shape),a=de(i.shape);return n==="xy"?(r=ie(r,[1,-1]),i=ie(i,[-1,1]),[Pt(Dl([a,1],r.dtype),r),Pt(i,Dl([1,s],i.dtype))]):(r=ie(r,[-1,1]),i=ie(i,[1,-1]),[Pt(r,Dl([1,a],r.dtype)),Pt(Dl([s,1],i.dtype),i)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Edt(e,t){let n=U(e,"a","minimum"),r=U(t,"b","minimum");[n,r]=Ir(n,r),n.dtype==="bool"&&(n=Oe(n,"int32"),r=Oe(r,"int32")),Ct(n.shape,r.shape);const i={a:n,b:r};return J.runKernel(r_,i)}const Py=ee({minimum_:Edt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Adt(e,t,n){B(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=U(e,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");B(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);const i=n==="reflect"?1:0;for(let o=0;o<r.rank;o++)B(t[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),B(t[o][0]>=0&&t[o][0]<=r.shape[o]-i&&t[o][1]>=0&&t[o][1]<=r.shape[o]-i,()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-i} or less than 0 for input of shape ${r.shape}`);const s={paddings:t,mode:n},a={x:r};return J.runKernel(JN,a,s)}const FTe=ee({mirrorPad_:Adt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tdt(e,t){let n=U(e,"a","mod"),r=U(t,"b","mod");[n,r]=Ir(n,r);const i={a:n,b:r};return J.runKernel(i_,i)}const OTe=ee({mod_:Tdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ddt(e,t=null,n=!1){e=U(e,"x","moments");const r=Ot(t,e.shape),i=Lr(e,r,n);let s=i.shape;n||(s=Zr(i.shape,r));const a=Gn(We(Oe(e,"float32"),ie(i,s))),o=Lr(a,r,n);return{mean:i,variance:o}}const Zz=ee({moments_:Ddt});function Ndt(e,t,n,r){const i=U(t,"data","multiRNNCell"),s=yT(n,"c","multiRNNCell"),a=yT(r,"h","multiRNNCell");let o=i;const l=[];for(let f=0;f<e.length;f++){const h=e[f](o,s[f],a[f]);l.push(h[0]),l.push(h[1]),o=h[1]}const u=[],c=[];for(let f=0;f<l.length;f+=2)u.push(l[f]),c.push(l[f+1]);return[u,c]}const Idt=ee({multiRNNCell_:Ndt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mdt(e,t,n,r=!1){const i=U(e,"logits","multinomial"),s=i.size,a=i.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(a>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${a}`);n=n||Math.random();const l={logits:a===1?ie(i,[1,-1]):i},u={numSamples:t,seed:n,normalized:r},c=J.runKernel(hz,l,u);return a===1?ie(c,[c.size]):c}const Fdt=ee({multinomial_:Mdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Odt(e,t){let n=U(e,"a","notEqual","string_or_numeric"),r=U(t,"b","notEqual","string_or_numeric");[n,r]=Ir(n,r),Ct(n.shape,r.shape);const i={a:n,b:r};return J.runKernel(tI,i)}const Rw=ee({notEqual_:Odt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rdt(e,t,n=1,r=0,i="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const a={indices:U(e,"indices","oneHot","int32")},o={dtype:i,depth:t,onValue:n,offValue:r};return J.runKernel(rI,a,o)}const CT=ee({oneHot_:Rdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pdt(e){const n={x:U(e,"x","onesLike")};return J.runKernel(nI,n)}const Hl=ee({onesLike_:Pdt});function Ldt(e,t){const n=U(e,"v1","outerProduct"),r=U(t,"v2","outerProduct");B(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const i=ie(n,[-1,1]),s=ie(r,[1,-1]);return Pt(i,s)}const Bdt=ee({outerProduct_:Ldt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zdt(e,t,n=0){const r=U(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:t,constantValue:n},s={x:r};return J.runKernel(sI,s,i)}const qm=ee({pad_:zdt});function Udt(e,t,n=0){return B(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),qm(e,[t],n)}const Wdt=ee({pad1d_:Udt});function Vdt(e,t,n=0){return B(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),qm(e,t,n)}const jdt=ee({pad2d_:Vdt});function Hdt(e,t,n=0){return B(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),qm(e,t,n)}const qdt=ee({pad3d_:Hdt});function Gdt(e,t,n=0){return B(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),qm(e,t,n)}const Ydt=ee({pad4d_:Gdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xdt(e,t,n){const r=U(e,"x","spaceToBatchND");B(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),B(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),B(r.shape.reduce((a,o,l)=>l>0&&l<=t.length?a&&(o+n[l-1][0]+n[l-1][1])%t[l-1]===0:a,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const i={x:r},s={blockShape:t,paddings:n};return J.runKernel(gI,i,s)}const Qz=ee({spaceToBatchND_:Xdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kdt(e,t,n,r,i,s,a){i==null&&(i=[1,1]),s==null&&(s=1),r===0&&(r="valid");const o=U(e,"x","maxPool");let l=o,u=!1;o.rank===3&&(u=!0,l=ie(o,[1,o.shape[0],o.shape[1],o.shape[2]])),B(ms(s,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${i}'`);const c=Gu(l.shape,t,s,i,r),f=[c.dilationHeight,c.dilationWidth];let h;r==="same"?h=Qdt([c.filterHeight,c.filterWidth],f):h=[[0,0],[0,0]];const d=f[0]===1&&f[1]===1,[p,g]=Zdt([c.inHeight,c.inWidth],f,h),m=d?r:"valid",v=d?l:Qz(l,f,p),b=(n==="avg"?()=>Wz(v,t,s,m,a):()=>Kz(v,t,s,m,a))(),x=d?b:Vz(b,f,g);return u?ie(x,[x.shape[1],x.shape[2],x.shape[3]]):x}function Zdt(e,t,n){const r=n.map(c=>c[0]),i=n.map(c=>c[1]),s=e.concat(r,i),a=t.map((c,f)=>(c-s[f]%c)%c),o=i.map((c,f)=>c+a[f]),l=t.map((c,f)=>[r[f],o[f]]),u=t.map((c,f)=>[0,a[f]]);return[l,u]}function Qdt(e,t){const r=e.map((a,o)=>a+(a-1)*(t[o]-1)).map(a=>a-1),i=r.map(a=>Math.floor(a/2)),s=r.map((a,o)=>a-i[o]);return r.map((a,o)=>[i[o],s[o]])}const RTe=ee({pool_:Kdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jdt(e,t){const n=U(e,"x","prelu"),r=U(t,"alpha","prelu"),i={x:n,alpha:r};return J.runKernel(aI,i)}const Jz=ee({prelu_:Jdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ept(e,t=null,n=!1){let r=U(e,"x","prod");r.dtype==="bool"&&(r=Oe(r,"int32"));const i={x:r},s={axis:t,keepDims:n};return J.runKernel(oI,i,s)}const PTe=ee({prod_:ept});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tpt(e,t,n,r){const i=e.map((c,f)=>U(c,`tensors${f}`,"raggedGather","int32")),s=U(t,"paramsDenseValues","raggedGather"),a=U(n,"indices","raggedGather","int32"),o={paramsNestedSplits:i,paramsDenseValues:s,indices:a},l={outputRaggedRank:r},u=J.runKernel(mz,o,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const npt=ee({raggedGather_:tpt});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rpt(e,t,n){const r=U(e,"starts","raggedRange"),i=U(t,"limits","raggedRange",r.dtype),s=U(n,"deltas","raggedRange",r.dtype),a={starts:r,limits:i,deltas:s},o=J.runKernel(vz,a);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}const ipt=ee({raggedRange_:rpt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function spt(e,t,n,r,i){const s=U(e,"shape","raggedTensorToTensor","int32"),a=U(t,"values","raggedTensorToTensor"),o=U(n,"defaultValue","raggedTensorToTensor",a.dtype),l=r.map((f,h)=>U(f,`tensors${h}`,"raggedTensorToTensor","int32")),u={shape:s,values:a,defaultValue:o,rowPartitionTensors:l},c={rowPartitionTypes:i};return J.runKernel(yz,u,c)}const apt=ee({raggedTensorToTensor_:spt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function opt(e,t,n){ml(e);const r=de(e);let i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else if(n==="bool")i=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let s=0;s<r;s++)i[s]=t();return J.makeTensor(i,e,n)}const lpt=ee({rand_:opt});var LTe={exports:{}};(function(e){(function(t,n,r){function i(l){var u=this,c=o();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function s(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function a(l,u){var c=new i(l),f=u&&u.state,h=c.next;return h.int32=function(){return c.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,f&&(typeof f=="object"&&s(f,c),h.state=function(){return s(c,{})}),h}function o(){var l=4022871197,u=function(c){c=String(c);for(var f=0;f<c.length;f++){l+=c.charCodeAt(f);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.alea=a})(mt,e,!1)})(LTe);var BTe={exports:{}};(function(e){(function(t,n,r){function i(o){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var f=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^f^f>>>8},o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function s(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function a(o,l){var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a})(mt,e,!1)})(BTe);var zTe={exports:{}};(function(e){(function(t,n,r){function i(o){var l=this,u="";l.next=function(){var f=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(f^f<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function s(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function a(o,l){var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a})(mt,e,!1)})(zTe);var UTe={exports:{}};(function(e){(function(t,n,r){function i(o){var l=this;l.next=function(){var c=l.x,f=l.i,h,d;return h=c[f],h^=h>>>7,d=h^h<<24,h=c[f+1&7],d^=h^h>>>10,h=c[f+3&7],d^=h^h>>>3,h=c[f+4&7],d^=h^h<<7,h=c[f+7&7],h=h^h<<13,d^=h^h<<9,c[f]=d,l.i=f+1&7,d};function u(c,f){var h,d=[];if(f===(f|0))d[0]=f;else for(f=""+f,h=0;h<f.length;++h)d[h&7]=d[h&7]<<15^f.charCodeAt(h)+d[h+1&7]<<13;for(;d.length<8;)d.push(0);for(h=0;h<8&&d[h]===0;++h);for(h==8?d[7]=-1:d[h],c.x=d,c.i=0,h=256;h>0;--h)c.next()}u(l,o)}function s(o,l){return l.x=o.x.slice(),l.i=o.i,l}function a(o,l){o==null&&(o=+new Date);var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(c.x&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a})(mt,e,!1)})(UTe);var WTe={exports:{}};(function(e){(function(t,n,r){function i(o){var l=this;l.next=function(){var c=l.w,f=l.X,h=l.i,d,p;return l.w=c=c+1640531527|0,p=f[h+34&127],d=f[h=h+1&127],p^=p<<13,d^=d<<17,p^=p>>>15,d^=d>>>12,p=f[h]=p^d,l.i=h,p+(c^c>>>16)|0};function u(c,f){var h,d,p,g,m,v=[],y=128;for(f===(f|0)?(d=f,f=null):(f=f+"\0",d=0,y=Math.max(y,f.length)),p=0,g=-32;g<y;++g)f&&(d^=f.charCodeAt((g+32)%f.length)),g===0&&(m=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,g>=0&&(m=m+1640531527|0,h=v[g&127]^=d+m,p=h==0?p+1:0);for(p>=128&&(v[(f&&f.length||0)&127]=-1),p=127,g=4*128;g>0;--g)d=v[p+34&127],h=v[p=p+1&127],d^=d<<13,h^=h<<17,d^=d>>>15,h^=h>>>12,v[p]=d^h;c.w=m,c.X=v,c.i=p}u(l,o)}function s(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function a(o,l){o==null&&(o=+new Date);var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(c.X&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a})(mt,e,!1)})(WTe);var VTe={exports:{}};(function(e){(function(t,n,r){function i(o){var l=this,u="";l.next=function(){var f=l.b,h=l.c,d=l.d,p=l.a;return f=f<<25^f>>>7^h,h=h-d|0,d=d<<24^d>>>8^p,p=p-f|0,l.b=f=f<<20^f>>>12^h,l.c=h=h-d|0,l.d=d<<16^h>>>16^p,l.a=p-f|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):u+=o;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function s(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function a(o,l){var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a})(mt,e,!1)})(VTe);var jTe={exports:{}};const upt={},cpt=Object.freeze(Object.defineProperty({__proto__:null,default:upt},Symbol.toStringTag,{value:"Module"})),fpt=Ob(cpt);(function(e){(function(t,n,r){var i=256,s=6,a=52,o="random",l=r.pow(i,s),u=r.pow(2,a),c=u*2,f=i-1,h;function d(x,w,C){var $=[];w=w==!0?{entropy:!0}:w||{};var _=v(m(w.entropy?[x,b(n)]:x==null?y():x,3),$),k=new p($),E=function(){for(var S=k.g(s),N=l,A=0;S<u;)S=(S+A)*i,N*=i,A=k.g(1);for(;S>=c;)S/=2,N/=2,A>>>=1;return(S+A)/N};return E.int32=function(){return k.g(4)|0},E.quick=function(){return k.g(4)/4294967296},E.double=E,v(b(k.S),n),(w.pass||C||function(S,N,A,D){return D&&(D.S&&g(D,k),S.state=function(){return g(k,{})}),A?(r[o]=S,N):S})(E,_,"global"in w?w.global:this==r,w.state)}function p(x){var w,C=x.length,$=this,_=0,k=$.i=$.j=0,E=$.S=[];for(C||(x=[C++]);_<i;)E[_]=_++;for(_=0;_<i;_++)E[_]=E[k=f&k+x[_%C]+(w=E[_])],E[k]=w;($.g=function(S){for(var N,A=0,D=$.i,T=$.j,I=$.S;S--;)N=I[D=f&D+1],A=A*i+I[f&(I[D]=I[T=f&T+N])+(I[T]=N)];return $.i=D,$.j=T,A})(i)}function g(x,w){return w.i=x.i,w.j=x.j,w.S=x.S.slice(),w}function m(x,w){var C=[],$=typeof x,_;if(w&&$=="object")for(_ in x)try{C.push(m(x[_],w-1))}catch{}return C.length?C:$=="string"?x:x+"\0"}function v(x,w){for(var C=x+"",$,_=0;_<C.length;)w[f&_]=f&($^=w[f&_]*19)+C.charCodeAt(_++);return b(w)}function y(){try{var x;return h&&(x=h.randomBytes)?x=x(i):(x=new Uint8Array(i),(t.crypto||t.msCrypto).getRandomValues(x)),b(x)}catch{var w=t.navigator,C=w&&w.plugins;return[+new Date,t,C,t.screen,b(n)]}}function b(x){return String.fromCharCode.apply(0,x)}if(v(r.random(),n),e.exports){e.exports=d;try{h=fpt}catch{}}else r["seed"+o]=d})(typeof self<"u"?self:mt,[],Math)})(jTe);var hpt=LTe.exports,dpt=BTe.exports,ppt=zTe.exports,gpt=UTe.exports,mpt=WTe.exports,vpt=VTe.exports,jb=jTe.exports;jb.alea=hpt;jb.xor128=dpt;jb.xorwow=ppt;jb.xorshift7=gpt;jb.xor4096=mpt;jb.tychei=vpt;var e7=jb;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ypt=.001,HTe=.1;function bpt(e,t,n){return n==null&&(n=Ete()),UY(e,t,(r,i)=>Ate(r,i,n))}function Ete(){return J.backend.floatPrecision()===32?ypt:HTe}function UY(e,t,n){let r=!0;if((Ci(e)||Ci(t))&&(r=!1),Ci(e)&&Ci(t)&&(r=!0),r){const a=e.constructor.name,o=t.constructor.name;if(a!==o)throw new Error(`Arrays are of different type. Actual: ${a}. Expected: ${o}`)}if(Array.isArray(e)&&Array.isArray(t)){const a=Ih(e),o=Ih(t);if(!Qt(a,o))throw new Error(`Arrays have different shapes. Actual: [${a}]. Expected: [${o}]`)}const i=Ci(e)?e:Nh(e),s=Ci(t)?t:Nh(t);if(i.length!==s.length)throw new Error(`Arrays have different lengths actual: ${i.length} vs expected: ${s.length}.
Actual:   ${i}.
Expected: ${s}.`);for(let a=0;a<s.length;++a){const o=i[a],l=s[a];if(!n(o,l))throw new Error(`Arrays differ: actual[${a}] = ${o}, expected[${a}] = ${l}.
Actual:   ${i}.
Expected: ${s}.`)}typeof expect<"u"&&expect().nothing()}function xpt(e,t){e().then(()=>t.fail(),()=>t()),typeof expect<"u"&&expect().nothing()}function wpt(e,t){const n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return Qf(e)||Qf(e[0])||Qf(t)||Qf(t[0])?UY(e,n,(r,i)=>r==i):UY(e,t,(r,i)=>Ate(r,i,0))}function $pt(e,t,n){if(n==null&&(n=Ete()),!Ate(e,t,n))throw new Error(`Numbers differ: actual === ${e}, expected === ${t}`);typeof expect<"u"&&expect().nothing()}function Ate(e,t,n){return!isFinite(e)&&!isFinite(t)?!0:!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function Cpt(e,t,n){for(let r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error(`Value out of range:${e[r]} low: ${t}, high: ${n}`)}function _pt(e,t){const n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let i=0;i<r.length;i++)if(n[i]!==r[i])throw new Error(`Expected ArrayBuffer value at ${i} to be ${r[i]} but got ${n[i]} instead`)}function qTe(e){for(let t=0;t<e.length;t++){const n=e[t];Array.isArray(n)?qTe(n):e[t]=rh(n)}return e}function Spt(e){const t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(n=>{t.addEventListener("loadeddata",r=>n(t)),t.load()})}async function kpt(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}const Ept=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:HTe,expectArraysClose:bpt,testEpsilon:Ete,expectPromiseToFail:xpt,expectArraysEqual:wpt,expectNumbersClose:$pt,expectValuesInRange:Cpt,expectArrayBuffersEqual:_pt,encodeStrings:qTe,createVideoElement:Spt,play:kpt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tte{constructor(t,n,r,i,s){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=s||Math.random();this.random=e7.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let t,n,r=!1;for(;!r;){let i,s,a;do i=2*this.random()-1,s=2*this.random()-1,a=i*i+s*s;while(a>=1||a===0);const o=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*i*o,n=this.mean+this.stdDev*s*o,(!this.truncated||this.isValidTruncated(t))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class Apt{constructor(t,n,r,i){this.alpha=t,this.beta=1/n,this.dtype=r;const s=i||Math.random();this.randu=e7.alea(s.toString()),this.randn=new Tte(0,1,r,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,n,r,i,s,a;for(;;){do i=this.randn.nextValue(),a=1+this.c*i;while(a<=0);if(a*=a*a,t=i*i,n=1-.331*t*t,r=.5*t+this.d*(1-a+Math.log(a)),s=this.randu(),s<n||Math.log(s)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}}class Tpt{constructor(t=0,n=1,r,i){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=e7.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dpt(e,t,n=1,r="float32",i){if(ml(e),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const s=new Apt(t,n,r,i),a=Mt(e,r);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}const Npt=ee({randomGamma_:Dpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ipt(e,t=0,n=1,r,i){if(ml(e),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const s=new Tte(t,n,r,!1,i),a=Mt(e,r);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}const Dte=ee({randomNormal_:Ipt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mpt(e,t,n){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return Dte(e,0,1,t,n)}const Fpt=ee({randomStandardNormal_:Mpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Opt(e,t=0,n=1,r="float32",i){ml(e);const s=Mt(e,r),a=new Tpt(t,n,null,i);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}const Hb=ee({randomUniform_:Opt});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rpt(e,t,n,r){return Hb(e,t,n,"int32",r)}const Ppt=ee({randomUniformInt_:Rpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pw(e,t,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const i={start:e,stop:t,step:n,dtype:r};return J.runKernel(bz,{},i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lpt(e){const n={input:U(e,"input","real")};return J.runKernel(xz,n)}const _T=ee({real_:Lpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bpt(e){const n={x:U(e,"x","reciprocal")};return J.runKernel(o_,n)}const GTe=ee({reciprocal_:Bpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zpt(e){const n={x:U(e,"x","relu")};return J.runKernel(l_,n)}const id=ee({relu_:zpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Upt(e){const n={x:U(e,"x","relu6")};return J.runKernel(u_,n)}const Nte=ee({relu6_:Upt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wpt(e,t){const r={x:U(e,"x","reverse")},i={dims:t};return J.runKernel(fI,r,i)}const Ru=ee({reverse_:Wpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vpt(e){const t=U(e,"x","reverse");return B(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),Ru(t,0)}const jpt=ee({reverse1d_:Vpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hpt(e,t){const n=U(e,"x","reverse");return B(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Ru(n,t)}const qpt=ee({reverse2d_:Hpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gpt(e,t){const n=U(e,"x","reverse");return B(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Ru(n,t)}const Ypt=ee({reverse3d_:Gpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xpt(e,t){const n=U(e,"x","reverse");return B(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Ru(n,t)}const Kpt=ee({reverse4d_:Xpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zpt(e){const n={x:U(e,"x","round")};return J.runKernel(c_,n)}const Ite=ee({round_:Zpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qpt(e){const n={x:U(e,"x","rsqrt","float32")};return J.runKernel(f_,n)}const Mte=ee({rsqrt_:Qpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jpt(e){const n={x:U(e,"x","selu")};return J.runKernel(h_,n)}const Fte=ee({selu_:Jpt});function egt(e,t,n,r,i,s=[1,1],a="NHWC"){const o=U(e,"x","separableConv2d"),l=U(t,"depthwiseFilter","separableConv2d"),u=U(n,"pointwiseFilter","separableConv2d");let c=o,f=!1;if(o.rank===3&&(f=!0,c=ie(o,[1,o.shape[0],o.shape[1],o.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");B(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),B(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),B(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),B(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),B(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const h=l.shape[2],d=l.shape[3];B(u.shape[2]===h*d,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*d}, but got ${u.shape[2]}.`);const p=kI(c,l,r,i,a,s),m=j0(p,u,1,"valid",a);return f?ie(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const Ote=ee({separableConv2d_:egt});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function tgt(e,t){const n=U(e,"x","setdiff1d"),r=U(t,"y","setdiff1d");B(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),B(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),B(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const i=await n.data(),s=await r.data(),a=new Set(s);let o=0;for(let c=0;c<i.length;c++)a.has(i[c])||o++;const l=new oi([o],n.dtype),u=new oi([o],"int32");for(let c=0,f=0;c<i.length;c++)a.has(i[c])||(l.values[f]=i[c],u.values[f]=c,f++);return[l.toTensor(),u.toTensor()]}const ngt=tgt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rgt(e){const n={x:U(e,"x","sign")};return J.runKernel(g_,n)}const YTe=ee({sign_:rgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function igt(e){const n={x:U(e,"x","sin","float32")};return J.runKernel(d_,n)}const Rte=ee({sin_:igt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sgt(e){const n={x:U(e,"x","sinh")};return J.runKernel(p_,n)}const Pte=ee({sinh_:sgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function agt(e,t,n){const r=U(e,"x","slice1d");return B(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),sn(r,[t],[n])}const t7=ee({slice1d_:agt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ogt(e,t,n){const r=U(e,"x","slice2d");return B(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),sn(r,t,n)}const Lte=ee({slice2d_:ogt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lgt(e,t,n){const r=U(e,"x","slice3d");return B(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),sn(r,t,n)}const n7=ee({slice3d_:lgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ugt(e,t,n){const r=U(e,"x","slice4d");return B(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),sn(r,t,n)}const ST=ee({slice4d_:ugt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cgt(e,t=-1){const n=U(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const r={logits:n},i={dim:t};return J.runKernel(vI,r,i)}const r7=ee({softmax_:cgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fgt(e){B(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);const t={input:e};return J.runKernel(tz,t)}const i7=ee({fft_:fgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hgt(e){B(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);const t={input:e};return J.runKernel(sz,t)}const kT=ee({ifft_:hgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dgt(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const i=ie(e,[n,t]);r=kT(i)}else{const i=[n,2*(t-1)],s=ie(_T(e),[n,t]),a=ie(Hz(e),[n,t]),o=Ru(sn(s,[0,1],[n,t-2]),1),l=ne(Ru(sn(a,[0,1],[n,t-2]),1),xt(-1)),u=Di([s,o],1),c=Di([a,l],1),f=ie(W0(u,c),[i[0],i[1]]);r=kT(f)}if(r=_T(r),e.rank===3&&e.shape[0]!==0){const i=r,s=e.shape[0];r=ie(r,[s,r.shape[0]/s,r.shape[1]]),i.dispose()}return r}const Bte=ee({irfft_:dgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pgt(e,t,n=0){const i={x:U(e,"x","split")},s={numOrSizeSplits:t,axis:n};return J.runKernel(mI,i,s)}const Jo=ee({split_:pgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ggt(e,t){B(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1];const r=e.size/n;let i;if(t!=null&&t<n){const p=e.shape.map(m=>0),g=e.shape.map(m=>m);g[e.shape.length-1]=t,i=sn(e,p,g),n=t}else if(t!=null&&t>n){const p=e.shape.map(g=>g);p[e.shape.length-1]=t-n,i=Di([e,di(p)],e.shape.length-1),n=t}else i=e;const s=en(i),a=ie(W0(i,s),[r,n]),o=i7(a),l=Math.floor(n/2)+1,u=_T(o),c=Hz(o),f=Jo(u,[l,n-l],u.shape.length-1),h=Jo(c,[l,n-l],c.shape.length-1),d=i.shape.slice();return d[i.shape.length-1]=l,ie(W0(f[0],h[0]),d)}const s7=ee({rfft_:ggt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mgt(e,t){let n=U(e,"a","squaredDifference"),r=U(t,"b","squaredDifference");[n,r]=Ir(n,r),Ct(n.shape,r.shape);const i={a:n,b:r},s={};return J.runKernel(b_,i,s)}const zte=ee({squaredDifference_:mgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vgt(e,t){const n=U(e,"x","squeeze","string_or_numeric");return ie(n,eg(n.shape,t).newShape)}const qb=ee({squeeze_:vgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ygt(e,t=0){const n=yT(e,"tensors","stack","string_or_numeric");B(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&B(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,i={axis:t};return J.runKernel(iI,r,i)}const Mp=ee({stack_:ygt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bgt(e,t=0){const r={x:U(e,"x","step")},i={alpha:t};return J.runKernel(__,r,i)}const E_=ee({step_:bgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xgt(e,t,n,r,i=0,s=0,a=0,o=0,l=0){const c={x:U(e,"x","stridedSlice","string_or_numeric")},f={begin:t,end:n,strides:r,beginMask:i,endMask:s,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};return J.runKernel(Iz,c,f)}const XTe=ee({stridedSlice_:xgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wgt(e){const n={x:U(e,"x","tan","float32")};return J.runKernel(w_,n)}const KTe=ee({tan_:wgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function so(e,t){Lb(e);const n=Ih(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Wm(e,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oA(e,t,n){if(Lb(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Ih(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Wm(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZTe(e,t,n){if(Lb(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Ih(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Wm(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $gt(e,t,n){if(Lb(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Ih(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Wm(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cgt(e,t,n){if(Lb(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Ih(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Wm(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _gt(e,t,n){if(Lb(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Ih(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,Wm(e,t,r,n)}function Ute(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(s+` update.rank < ${i}. `);if(e.length<r+(n.rank-i))throw new Error(s+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+e.length-r)throw new Error(s+` update.rank != ${i+e.length-r}`);for(let a=0;a<i;++a)if(n.shape[a]!==t.shape[a])throw new Error(s+` updates.shape[${a}] (${n.shape[a]}) != indices.shape[${a}] (${t.shape[a]}).`);for(let a=0;a<n.rank-i;++a)if(n.shape[a+i]!==e[a+r])throw new Error(s+` updates.shape[${a+i}] (${n.shape[a+i]}) != shape[${a+i}] (${e[a+i]})`)}function a7(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}Ute(n,t,e)}function Gm(e,t,n){const r=t.shape.length,i=r>1?t.shape[r-1]:1,s=n.length;let a=1;for(let f=i;f<s;++f)a*=n[f];const o=i<1?1:i,l=de(t.shape)/o,u=[...Je(n.slice(0,i)),1],c=de(n);return{sliceRank:i,numUpdates:l,sliceSize:a,strides:u,outputSize:c}}const Sgt=Object.freeze(Object.defineProperty({__proto__:null,validateUpdateShape:Ute,validateInput:a7,calculateShapes:Gm},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kgt(e,t,n){const r=U(e,"tensor","tensorScatterupdate"),i=U(t,"indices","tensorScatterupdate","int32"),s=U(n,"updates","tensorScatterupdate");if(a7(s,i,r.shape),r.dtype!==s.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${s.dtype}.`);const a={tensor:r,indices:i,updates:s},o={};return J.runKernel(_z,a,o)}const Egt=ee({tensorScatterUpdate_:kgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Agt(e,t=1,n=!0){const r=U(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);const s={x:r},a={k:t,sorted:n},[o,l]=J.runKernel(Rz,s,a);return{values:o,indices:l}}const QTe=ee({topk_:Agt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tgt(e,t=0,n=1,r,i){if(ml(e),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const s=new Tte(t,n,r,!0,i),a=Mt(e,r);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}const Wte=ee({truncatedNormal_:Tgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dgt(e,t=0){const n=U(e,"x","unique","string_or_numeric");B(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},i={axis:t},[s,a]=J.runKernel(Lz,r,i);return{values:s,indices:a}}const JTe=ee({unique_:Dgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ngt(e,t,n){const r=U(e,"x","unsortedSegmentSum"),i=U(t,"segmentIds","unsortedSegmentSum","int32");B(Iy(n),()=>"numSegments must be of dtype int");const s={x:r,segmentIds:i},a={numSegments:n};return J.runKernel(xI,s,a)}const Vte=ee({unsortedSegmentSum_:Ngt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Igt(e,t=0){const n=U(e,"x","unstack","string_or_numeric");B(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},i={axis:t};return J.runKernel(bI,r,i)}const q0=ee({unstack_:Igt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mgt(e,t){return kte(e,t,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e3e(e,t=!0,n,r){return J.makeVariable(e,t,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o7(e,t){const n=[];for(let s=0;s<t.length;s++)t[s]&&n.push(s);const r=Mt(e,"int32"),i=Mt([n.length,e.length],"int32");for(let s=0;s<n.length;s++){const a=r.indexToLoc(n[s]),o=s*e.length;i.values.set(a,o)}return i.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Fgt(e){const t=U(e,"condition","whereAsync","bool"),n=await t.data(),r=o7(t.shape,n);return e!==t&&t.dispose(),r}const t3e=Fgt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ogt(e,t,n){const r=U(e,"tensor","boolMask"),i=U(t,"mask","boolMask","bool"),s=n==null?0:n,a=i.rank,o=r.shape;B(a>0,()=>"mask cannot be scalar"),gs(o.slice(s,s+a),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let g=s;g<s+a;g++)l*=o[g];const u=o.slice(0,s).concat([l],o.slice(s+a)),c=ie(r,u),f=ie(i,[-1]),h=await t3e(f),d=qb(h,[1]),p=DI(c,d,s);return e!==r&&r.dispose(),t!==i&&i.dispose(),d.dispose(),c.dispose(),f.dispose(),h.dispose(),p}const Rgt=Ogt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pgt(e,t,n){const r=U(e,"x","transpose");if(t==null&&(t=r.shape.map((a,o)=>o).reverse()),B(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`),t.forEach(a=>{B(a>=0&&a<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`)}),r.rank<=1)return r.clone();const i={x:r},s={perm:t};return r.dtype==="complex64"?ce(()=>{let a=_T(r),o=Hz(r);return a=J.runKernel(K1,{x:a},s),o=J.runKernel(K1,{x:o},s),n&&(o=ur(o)),W0(a,o)}):J.runKernel(K1,i,s)}const Zt=ee({transpose_:Pgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lgt(e,t,n,r,i=!0){const s=U(e,"v","movingAverage"),a=U(t,"x","movingAverage"),o=U(n,"decay","movingAverage");DAe(s,a),B(Qt(s.shape,a.shape),()=>"Shape mismatch in v and x");const l=xt(1),u=We(l,o);let c=ne(We(a,s),u);if(i){B(r!=null,()=>"When using zeroDebias: true, step is required.");const f=U(r,"step","movingAverage");c=Qe(c,We(l,H0(o,f)))}return ke(s,c)}const Bgt=ee({movingAverage_:Lgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zgt(e,t,n){ml(n);const r=U(e,"indices","scatterND","int32"),i=U(t,"updates","scatterND");a7(i,r,n);const s={indices:r,updates:i},a={shape:n};return J.runKernel(Cz,s,a)}const Ugt=ee({scatterND_:zgt});function Wgt(e,t,n,r){if(e.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);const i=e.rank>0?e.shape[0]:1,s=e.rank>1?e.shape[1]:1;if(n.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${s}.`);const a=t.size;if(!(t.rank===0||t.rank===1&&a===i))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${i}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vgt(e,t,n,r=0){ml(n);const i=U(e,"sparseIndices","sparseToDense","int32"),s=U(t,"sparseValues","sparseToDense","string_or_numeric"),a=U(r,"defaultValue","sparseToDense",s.dtype);Wgt(i,s,n,a);const o={sparseIndices:i,sparseValues:s,defaultValue:a},l={outputShape:n};return J.runKernel(Dz,o,l)}const jgt=ee({sparseToDense_:Vgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hgt(e,t){const n=U(t,"indices","gatherND","int32"),i={params:U(e,"x","gatherND","string_or_numeric"),indices:n};return J.runKernel(iz,i)}const qgt=ee({gatherND_:Hgt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ggt(e,t){if(t==null)return e.shape.slice();if(Qt(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let r=0;r<e.shape.length;r++)t[r]==null&&e.shape[r]!=null?n.push(e.shape[r]):n.push(t[r]);return n}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ygt(e,t,n,r){const i=U(e,"x","dropout");if(B(i.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),B(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof On?i.clone():i;const s=Ggt(i,n),a=1-t,o=Qe(TI(ke(Hb(s,0,1,"float32",r),a)),a);return ne(i,o)}const n3e=ee({dropout_:Ygt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r3e(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function jte(e,t,n){const r=1-e%2,i=new Float32Array(e);for(let s=0;s<e;++s){const a=2*Math.PI*s/(e+r-1);i[s]=t-n*Math.cos(a)}return so(i,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Xgt(e,t,n=1){const r=U(e,"predictions","inTopK"),i=U(t,"targets","inTopK");B(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),B(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),gs(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=r.shape[r.shape.length-1];B(n>0&&n<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${n}`);const a=await r.data(),o=await i.data(),[l,u]=[a.length/s,s],c=Fi("bool",l);for(let f=0;f<l;f++){const h=f*u,d=a.subarray(h,h+u),p=[];for(let g=0;g<d.length;g++)p.push({value:d[g],index:g});p.sort((g,m)=>m.value-g.value),c[f]=0;for(let g=0;g<n;g++)if(p[g].index===o[f]){c[f]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),vp(c,i.shape,"bool")}const Kgt=Xgt;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zgt(e,t,n,r,i,s="NHWC",a){let o=e;e.rank===3&&(o=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=ie(t,[1,t.shape[0],t.shape[1],t.shape[2]])),B(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),B(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),B(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=s==="NHWC"?o.shape[3]:o.shape[1],c=s==="NHWC"?l.shape[3]:l.shape[1];B(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),B(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),La("conv2dDerFilter",i,a);const f={x:o,dy:l},h={strides:r,pad:i,dataFormat:s,dimRoundingMode:a,filterShape:n};return J.runKernel(WB,f,h)}const Hte=ee({conv2DBackpropFilter_:Zgt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l7(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return ne(e,E_(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function u7(e,t){let n=t;const r=ui(e.shape,t.shape);return r.length>0&&(n=qe(n,r)),ie(n,e.shape)}function c7(e,t,n,r){if(t==="linear")return e;if(t==="relu")return id(e);if(t==="elu")return EI(e);if(t==="relu6")return Nte(e);if(t==="prelu")return Jz(e,n);if(t==="leakyrelu")return qz(e,r);if(t==="sigmoid")return ih(e);throw new Error(`Unknown fused activation ${t}.`)}const f7=(e,t)=>!(e>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qgt({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",f7(J.state.gradientDepth,l)===!1){B(i==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let C=j0(e,t,n,r,i,s,a);return o!=null&&(C=ke(C,o)),c7(C,l,u,c)}const f=U(e,"x","conv2d","float32"),h=U(t,"filter","conv2d","float32");let d=f,p=!1;f.rank===3&&(p=!0,d=ie(f,[1,f.shape[0],f.shape[1],f.shape[2]])),B(d.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${d.rank}.`),B(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),La("fused conv2d",r,a);const g=i==="NHWC"?d.shape[3]:d.shape[1];B(h.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${h.shape[2]}.`),B(ms(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);const m=Pi(d.shape,h.shape,n,s,r,a);let v;o!=null&&(v=U(o,"bias","fused conv2d"),[v]=Ir(v,f),i==="NHWC"?Ct(m.outShape,v.shape):(B(v.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${v.shape.length}.`),B(v.shape.length===0||v.shape[0]===m.outChannels||v.shape[0]===1,()=>`Error in fused conv2d: bias shape (${v.shape}) is not compatible with the number of output channels (${m.outChannels})`)));let y;if(u!=null){const C=u.shape;if(B(C.length<=1||C.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${C.length}.`),C.length===1)B(C[0]===1||C[0]===m.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the number of output channels (${m.outChannels}).`);else if(C.length===3)try{Ct(C,m.outShape)}catch{const _=`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the output shape of the conv2d (${m.outShape}).`;throw Error(_)}y=U(u,"prelu weights","fused conv2d")}const b=(C,$)=>{B(i==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);const[_,k,E,S]=$,N=l7(C,E,l);B(V0(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const A=vte(k.shape,N,_,n,r),D=Hte(k,N,_.shape,n,r),T=[A,D];if(S!=null){const I=u7(S,N);T.push(I)}return T},x={x:d,filter:h,bias:v,preluActivationWeights:y},w={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:a,activation:l,leakyreluAlpha:c};return o==null?Mh(($,_,k)=>{let E=J.runKernel(dT,x,w);return k([_,$,E]),p&&(E=ie(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(d,h):Mh(($,_,k,E)=>{let S=J.runKernel(dT,x,w);return E([_,$,S,k]),p&&(S=ie(S,[S.shape[1],S.shape[2],S.shape[3]])),{value:S,gradFunc:b}})(d,h,v)}const i3e=ee({fusedConv2d_:Qgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jgt(e,t,n,r,i,s=[1,1],a){let o=e;e.rank===3&&(o=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=ie(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const u={x:o,dy:l},c={strides:r,pad:i,dimRoundingMode:a,dilations:s,filterShape:n};return J.runKernel(XB,u,c)}const s3e=ee({depthwiseConv2dNativeBackpropFilter_:Jgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0t(e,t,n,r,i,s=[1,1],a){let o=t,l=!1;t.rank===3&&(l=!0,o=ie(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const u={dy:o,filter:n},c={strides:r,pad:i,dimRoundingMode:a,dilations:s,inputShape:e},f=J.runKernel(KB,u,c);return l?ie(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const a3e=ee({depthwiseConv2dNativeBackpropInput_:e0t});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t0t({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(f7(J.state.gradientDepth,l)===!1){let w=kI(e,t,n,r,i,s,a);return o!=null&&(w=ke(w,o)),c7(w,l,u,c)}const f=U(e,"x","depthwiseConv2d","float32"),h=U(t,"filter","depthwiseConv2d","float32");let d=f,p=!1;f.rank===3&&(p=!0,d=ie(f,[1,f.shape[0],f.shape[1],f.shape[2]])),B(d.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${d.rank}.`),B(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),B(d.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${d.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),s==null&&(s=[1,1]),B(ms(n,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),La("fused depthwiseConv2d",r,a);const g=Pi(d.shape,h.shape,n,s,r,a,!0);let m;o!=null&&(m=U(o,"bias","fused conv2d"),[m]=Ir(m,f),Ct(g.outShape,m.shape));let v;u!=null&&(v=U(u,"prelu weights","fused depthwiseConv2d"));const y=(w,C)=>{B(V0(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[$,_,k,E]=C,S=l7(w,k,l),N=a3e(_.shape,S,$,n,r,s,a),A=s3e(_,S,$.shape,n,r,s,a);if(E!=null){const D=u7(m,S);return[N,A,D]}return[N,A]},b={x:d,filter:h,bias:m,preluActivationWeights:v},x={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:a,activation:l,leakyreluAlpha:c};return o==null?Mh((C,$,_)=>{let k=J.runKernel(pT,b,x);return _([$,C,k]),p&&(k=ie(k,[k.shape[1],k.shape[2],k.shape[3]])),{value:k,gradFunc:y}})(d,h):Mh((C,$,_,k)=>{let E=J.runKernel(pT,b,x);return k([$,C,E,_]),p&&(E=ie(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:y}})(d,h,m)}const n0t=ee({fusedDepthwiseConv2d_:t0t});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r0t({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:i,activation:s="linear",preluActivationWeights:a,leakyreluAlpha:o=.2}){if(f7(J.state.gradientDepth,s)===!1){let S=Pt(e,t,n,r);return i!=null&&(S=ke(S,i)),c7(S,s,a,o)}let l=U(e,"a","fused matMul"),u=U(t,"b","fused matMul");[l,u]=Ir(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],f=r?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],d=r?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),g=u.shape.slice(0,-2),m=de(p),v=de(g);B(c===f,()=>`Error in fused matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const b=Ct(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,d]),x=n?ie(l,[m,c,h]):ie(l,[m,h,c]),w=r?ie(u,[v,d,f]):ie(u,[v,f,d]);let C;i!=null&&(C=U(i,"bias","fused matMul"),[C]=Ir(C,l),Ct(b,C.shape));let $;a!=null&&($=U(a,"prelu weights","fused matMul"));const _=(S,N)=>{const[A,D,T,I]=N,F=l7(ie(S,T.shape),T,s);let R,P;if(!n&&!r?(R=Pt(F,D,!1,!0),P=Pt(A,F,!0,!1)):!n&&r?(R=Pt(F,D,!1,!1),P=Pt(F,A,!0,!1)):n&&!r?(R=Pt(D,F,!1,!0),P=Pt(A,F,!1,!1)):(R=Pt(D,F,!0,!0),P=Pt(F,A,!0,!0)),i!=null){const V=u7(I,F);return[R,P,V]}else return[R,P]},k={a:x,b:w,bias:C,preluActivationWeights:$},E={transposeA:n,transposeB:r,activation:s,leakyreluAlpha:o};return i==null?Mh((N,A,D)=>{const T=J.runKernel(hT,k,E);return D([N,A,T]),{value:ie(T,b),gradFunc:_}})(x,w):Mh((N,A,D,T)=>{const I=J.runKernel(hT,k,E);return T([N,A,I,D]),{value:ie(I,b),gradFunc:_}})(x,w,C)}const WY=ee({fusedMatMul_:r0t});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i0t=Object.freeze(Object.defineProperty({__proto__:null,conv2d:i3e,depthwiseConv2d:n0t,matMul:WY},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0t(e){return jte(e,.54,.46)}const a0t=ee({hammingWindow_:s0t});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o0t(e){return jte(e,.5,.5)}const o3e=ee({hannWindow_:o0t});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l0t(e,t,n,r=!1,i=0){let s=0;const a=[];for(;s+t<=e.size;)a.push(sn(e,s,t)),s+=n;if(r)for(;s<e.size;){const o=s+t-e.size,l=Di([sn(e,s,t-o),S_([o],i)]);a.push(l),s+=n}return a.length===0?oA([],[0,t]):ie(Di(a),[a.length,t])}const l3e=ee({frame_:l0t});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u0t(e,t,n,r,i=o3e){r==null&&(r=r3e(t));const s=l3e(e,t,n),a=ne(s,i(t));return s7(a,r)}const c0t=ee({stft_:u0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f0t(e,t,n,r,i="bilinear",s=0){const a=U(e,"image","cropAndResize"),o=U(t,"boxes","cropAndResize","float32"),l=U(n,"boxInd","cropAndResize","int32"),u=o.shape[0];B(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),B(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`),B(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`),B(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),B(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),B(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);const c={image:a,boxes:o,boxInd:l},f={method:i,extrapolationValue:s,cropSize:r};return J.runKernel(qB,c,f)}const h0t=ee({cropAndResize_:f0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0t(e){const t=U(e,"image","flipLeftRight","float32");B(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return J.runKernel(rz,n,{})}const p0t=ee({flipLeftRight_:d0t});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0t(e){const t=U(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];B(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),B(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const i=new Array(t.rank);return i.fill(1,0,n),i[n]=3,mu(t,i)}const m0t=ee({grayscaleToRGB_:g0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v0t(e,t,n=0,r=.5){const i=U(e,"image","rotateWithOffset","float32");B(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);const s={image:i},a={radians:t,fillValue:n,center:r};return J.runKernel(Bz,s,a)}const y0t=ee({rotateWithOffset_:v0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A_(e,t,n,r,i,s){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),s==null&&(s=0);const a=e.shape[0];return n=Math.min(n,a),B(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),B(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),B(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),B(t.rank===1,()=>"scores must be a 1D tensor"),B(t.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${t.shape[0]}`),B(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b0t(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const s=U(e,"boxes","nonMaxSuppression","float32"),a=U(t,"scores","nonMaxSuppression","float32"),o=A_(s,a,n,r,i);n=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return J.runKernel(dz,{boxes:s,scores:a},l)}const x0t=ee({nonMaxSuppression_:b0t});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w0t(e,t,n){const r=$0t(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function $0t(e,t,n){return _0t(e,t,n||C0t)}function C0t(e,t){return e>t?1:e<t?-1:0}function _0t(e,t,n){let r=0,i=e.length,s=0,a=!1;for(;r<i;){s=r+(i-r>>>1);const o=n(t,e[s]);o>0?r=s+1:(i=s,a=!o)}return a?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h7(e,t,n,r,i){return qte(e,t,n,r,i,0)}function d7(e,t,n,r,i,s){return qte(e,t,n,r,i,0,!1,s,!0)}function p7(e,t,n,r,i,s){return qte(e,t,n,r,i,s,!0)}function qte(e,t,n,r,i,s,a=!1,o=!1,l=!1){const u=[];for(let m=0;m<t.length;m++)t[m]>i&&u.push({score:t[m],boxIndex:m,suppressBeginIndex:0});u.sort(bge);const c=s>0?-.5/s:0,f=[],h=[];for(;f.length<n&&u.length>0;){const m=u.pop(),{score:v,boxIndex:y,suppressBeginIndex:b}=m;if(v<i)break;let x=!1;for(let w=f.length-1;w>=b;--w){const C=S0t(e,y,f[w]);if(C>=r){x=!0;break}if(m.score=m.score*k0t(r,c,C),m.score<=i)break}m.suppressBeginIndex=f.length,x||(m.score===v?(f.push(y),h.push(m.score)):m.score>i&&w0t(u,m,bge))}const d=f.length,p=n-d;o&&p>0&&(f.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const g={selectedIndices:f};return a&&(g.selectedScores=h),l&&(g.validOutputs=d),g}function S0t(e,t,n){const r=e.subarray(t*4,t*4+4),i=e.subarray(n*4,n*4+4),s=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]),d=(o-s)*(l-a),p=(f-u)*(h-c);if(d<=0||p<=0)return 0;const g=Math.max(s,u),m=Math.max(a,c),v=Math.min(o,f),y=Math.min(l,h),b=Math.max(v-g,0)*Math.max(y-m,0);return b/(d+p-b)}function k0t(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function bge(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function E0t(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const s=U(e,"boxes","nonMaxSuppressionAsync"),a=U(t,"scores","nonMaxSuppressionAsync"),o=A_(s,a,n,r,i);n=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;const l=await Promise.all([s.data(),a.data()]),u=l[0],c=l[1],{selectedIndices:f}=h7(u,c,n,r,i);return s!==e&&s.dispose(),a!==t&&a.dispose(),so(f,"int32")}const A0t=E0t;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T0t(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const a=U(e,"boxes","nonMaxSuppression"),o=U(t,"scores","nonMaxSuppression"),l=A_(a,o,n,r,i,s);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,s=l.softNmsSigma;const u={boxes:a,scores:o},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:s},f=J.runKernel(gz,u,c);return{selectedIndices:f[0],selectedScores:f[1]}}const D0t=ee({nonMaxSuppressionWithScore_:T0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function N0t(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const a=U(e,"boxes","nonMaxSuppressionAsync"),o=U(t,"scores","nonMaxSuppressionAsync"),l=A_(a,o,n,r,i,s);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,s=l.softNmsSigma;const u=await Promise.all([a.data(),o.data()]),c=u[0],f=u[1],{selectedIndices:h,selectedScores:d}=p7(c,f,n,r,i,s);return a!==e&&a.dispose(),o!==t&&o.dispose(),{selectedIndices:so(h,"int32"),selectedScores:so(d)}}const I0t=N0t;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M0t(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const a=U(e,"boxes","nonMaxSuppression"),o=U(t,"scores","nonMaxSuppression"),l=A_(a,o,n,r,i,null),u=l.maxOutputSize,c=l.iouThreshold,f=l.scoreThreshold,h={boxes:a,scores:o},d={maxOutputSize:u,iouThreshold:c,scoreThreshold:f,padToMaxOutputSize:s},p=J.runKernel(pz,h,d);return{selectedIndices:p[0],validOutputs:p[1]}}const F0t=ee({nonMaxSuppressionPadded_:M0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function O0t(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const a=U(e,"boxes","nonMaxSuppressionAsync"),o=U(t,"scores","nonMaxSuppressionAsync"),l=A_(a,o,n,r,i,null),u=l.maxOutputSize,c=l.iouThreshold,f=l.scoreThreshold,[h,d]=await Promise.all([a.data(),o.data()]),{selectedIndices:p,validOutputs:g}=d7(h,d,u,c,f,s);return a!==e&&a.dispose(),o!==t&&o.dispose(),{selectedIndices:so(p,"int32"),validOutputs:xt(g,"int32")}}const R0t=O0t;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P0t(e,t,n=!1,r=!1){const i=U(e,"images","resizeBilinear");B(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),B(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),B(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=i,a=!1;i.rank===3&&(a=!0,s=ie(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const o={images:s},l={alignCorners:n,halfPixelCenters:r,size:t},u=J.runKernel(cI,o,l);return a?ie(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const u3e=ee({resizeBilinear_:P0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L0t(e,t,n=!1,r=!1){const i=U(e,"images","resizeNearestNeighbor");B(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),B(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),B(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),B(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=i,a=!1;i.rank===3&&(a=!0,s=ie(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const o={images:s},l={alignCorners:n,halfPixelCenters:r,size:t},u=J.runKernel(uI,o,l);return a?ie(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const c3e=ee({resizeNearestNeighbor_:L0t});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B0t(e,t="binary",n=!1,r=.5){const i=U(e,"image","threshold"),s=.2989,a=.587,o=.114,l=i.shape[0]*i.shape[1];let u=ne(so([r]),255),c,f,h,d;if(B(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),B(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),B(i.dtype==="int32"||i.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),B(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),i.shape[2]===3){[c,f,h]=Jo(i,[1,1,1],-1);const m=ne(c,s),v=ne(f,a),y=ne(h,o);d=ke(ke(m,v),y)}else d=e;if(t==="otsu"){const m=lTe(Oe(Ite(d),"int32"),vp([]),256);u=z0t(m,l)}const p=n?Vb(d,u):yl(d,u);return Oe(ne(p,255),"int32")}function z0t(e,t){let n=so([-1]),r=so([0]),i=so([0]),s,a,o,l,u,c;for(let f=0;f<e.size-1;f++){s=sn(e,0,f+1),a=sn(e,f+1),u=Qe(qe(s),t),c=Qe(qe(a),t);const h=qe(ne(s,Pw(0,s.size)));o=Qe(h,qe(s));const d=S_(a.shape,s.size),p=ke(Pw(0,a.size),d),g=ne(a,p);l=Qe(qe(g),qe(a));const m=We(o,l),v=We(o,l),y=ne(u,c);i=ne(ne(y,m),v);const b=yl(i,r);r=Ws(b,i,r),n=Ws(b,so([f]),n)}return n}const U0t=ee({threshold_:B0t});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W0t(e,t,n="nearest",r="constant",i=0,s){const a=U(e,"image","transform","float32"),o=U(t,"transforms","transform","float32");B(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),B(o.rank===2&&(o.shape[0]===a.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),B(s==null||s.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`);const l={image:a,transforms:o},u={interpolation:n,fillMode:r,fillValue:i,outputShape:s};return J.runKernel(Pz,l,u)}const V0t=ee({transform_:W0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j0t(e,t,n){const r=U(e,"a","bandPart");B(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const i=r.shape,[s,a]=r.shape.slice(-2);let o,l;typeof t=="number"?(B(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),B(t<=s,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`),o=U(t<0?s:t,"numLower","bandPart")):(B(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=Ws($T(t,0),s,Py(t,s))),typeof n=="number"?(B(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),B(n<=a,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${a}).`),l=U(n<0?a:n,"numUpper","bandPart")):(B(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Ws($T(n,0),a,Py(n,a)));const u=ie(Pw(0,s,1,"int32"),[-1,1]),c=Pw(0,a,1,"int32"),f=We(u,c),h=Fh(Vb(f,o),Hm(f,ur(l))),d=di([s,a],r.dtype);return ie(Mp(q0(ie(r,[-1,s,a])).map(p=>Ws(h,p,d))),i)}const H0t=ee({bandPart_:j0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q0t(e){let t;if(Array.isArray(e)){t=!1,B(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const i=e[0].shape[0];for(let s=1;s<e.length;++s)B(e[s].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[s].shape[0]} vs. ${i})`)}else t=!0,e=Jo(e,e.shape[0],0).map(i=>qb(i,[0]));B(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);const n=[],r=e;for(let i=0;i<e.length;++i)n.push(J.tidy(()=>{let s=r[i];if(i>0)for(let a=0;a<i;++a){const o=ne(qe(ne(n[a],s)),n[a]);s=We(s,o)}return Qe(s,AI(s,"euclidean"))}));return t?Mp(n,0):n}const G0t=ee({gramSchmidt_:q0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y0t(e,t=!1){if(B(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return xge(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce((l,u)=>l*u),r=q0(ie(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],s=[];r.forEach(l=>{const[u,c]=xge(l,t);i.push(u),s.push(c)});const a=ie(Mp(i,0),e.shape),o=ie(Mp(s,0),e.shape);return[a,o]}}function xge(e,t=!1){return J.tidy(()=>{B(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);const n=e.shape[0],r=e.shape[1];let i=$te(n),s=v0(e);const a=oA([[1]],[1,1]);let o=v0(a);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=s,f=o,h=i;[o,s,i]=J.tidy(()=>{const d=sn(s,[u,u],[n-u,1]),p=AI(d),g=sn(s,[u,u],[1,1]),m=Ws(yl(g,0),oA([[-1]]),oA([[1]])),v=We(g,ne(m,p)),y=Qe(d,v);y.shape[0]===1?o=v0(a):o=Di([a,sn(y,[1,0],[y.shape[0]-1,y.shape[1]])],0);const b=ur(Qe(Pt(m,v),p)),x=sn(s,[u,0],[n-u,r]),w=ne(b,o),C=Zt(o);if(u===0)s=We(x,Pt(w,Pt(C,x)));else{const k=We(x,Pt(w,Pt(C,x)));s=Di([sn(s,[0,0],[u,r]),k],0)}const $=Zt(w),_=sn(i,[0,u],[n,i.shape[1]-u]);if(u===0)i=We(_,Pt(Pt(_,o),$));else{const k=We(_,Pt(Pt(_,o),$));i=Di([sn(i,[0,0],[n,u]),k],1)}return[o,s,i]}),Bt([c,f,h])}return!t&&n>r&&(i=sn(i,[0,0],[n,r]),s=sn(s,[0,0],[r,r])),[i,s]})}const X0t=ee({qr_:Y0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var pa;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(pa||(pa={}));function K0t(e,t,n=pa.SUM_BY_NONZERO_WEIGHTS){const r=U(e,"losses","computeWeightedLoss");let i=null;t!=null&&(i=U(t,"weights","computeWeightedLoss"));const s=i==null?r:ne(r,i);if(n===pa.NONE)return s;if(n===pa.SUM)return qe(s);if(n===pa.MEAN){if(i==null)return Lr(s);{const a=r.size/i.size,o=Qe(qe(s),qe(i));return a>1?Qe(o,xt(a)):o}}if(n===pa.SUM_BY_NONZERO_WEIGHTS){if(i==null)return Qe(qe(s),xt(r.size));{const a=ne(i,Dl(r.shape)),o=Oe(qe(Rw(a,xt(0))),"float32");return Qe(qe(s),o)}}throw Error(`Unknown reduction: ${n}`)}const sg=ee({computeWeightedLoss_:K0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z0t(e,t,n,r=pa.SUM_BY_NONZERO_WEIGHTS){const i=U(e,"labels","absoluteDifference"),s=U(t,"predictions","absoluteDifference");let a=null;n!=null&&(a=U(n,"weights","absoluteDifference")),gs(i.shape,s.shape,"Error in absoluteDifference: ");const o=hi(We(i,s));return sg(o,a,r)}const Q0t=ee({absoluteDifference_:Z0t});function J0t(e,t,n,r,i=pa.SUM_BY_NONZERO_WEIGHTS){const s=U(e,"labels","cosineDistance"),a=U(t,"predictions","cosineDistance");let o=null;r!=null&&(o=U(r,"weights","cosineDistance")),gs(s.shape,a.shape,"Error in cosineDistance: ");const l=xt(1),u=We(l,qe(ne(s,a),n,!0));return sg(u,o,i)}const emt=ee({cosineDistance_:J0t});function tmt(e,t,n,r=pa.SUM_BY_NONZERO_WEIGHTS){let i=U(e,"labels","hingeLoss");const s=U(t,"predictions","hingeLoss");let a=null;n!=null&&(a=U(n,"weights","hingeLoss")),gs(i.shape,s.shape,"Error in hingeLoss: ");const o=xt(1);i=We(ne(xt(2),i),o);const l=id(We(o,ne(i,s)));return sg(l,a,r)}const nmt=ee({hingeLoss_:tmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rmt(e,t,n,r=1,i=pa.SUM_BY_NONZERO_WEIGHTS){const s=U(e,"labels","huberLoss"),a=U(t,"predictions","huberLoss");let o=null;n!=null&&(o=U(n,"weights","huberLoss")),gs(s.shape,a.shape,"Error in huberLoss: ");const l=xt(r),u=hi(We(a,s)),c=Py(u,l),f=We(u,c),h=ke(ne(xt(.5),Gn(c)),ne(l,f));return sg(h,o,i)}const imt=ee({huberLoss_:rmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function smt(e,t,n,r=1e-7,i=pa.SUM_BY_NONZERO_WEIGHTS){const s=U(e,"labels","logLoss"),a=U(t,"predictions","logLoss");let o=null;n!=null&&(o=U(n,"weights","logLoss")),gs(s.shape,a.shape,"Error in logLoss: ");const l=xt(1),u=xt(r),c=ur(ne(s,jl(ke(a,u)))),f=ne(We(l,s),jl(ke(We(l,a),u))),h=We(c,f);return sg(h,o,i)}const amt=ee({logLoss_:smt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function omt(e,t,n,r=pa.SUM_BY_NONZERO_WEIGHTS){const i=U(e,"labels","meanSquaredError"),s=U(t,"predictions","meanSquaredError");let a=null;n!=null&&(a=U(n,"weights","meanSquaredError")),gs(i.shape,s.shape,"Error in meanSquaredError: ");const o=zte(i,s);return sg(o,a,r)}const lmt=ee({meanSquaredError_:omt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function umt(e,t){const n=U(e,"labels","sigmoidCrossEntropyWithLogits"),r=U(t,"logits","sigmoidCrossEntropyWithLogits");gs(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=id(r),s=ne(r,n),a=Gz(Vl(ur(hi(r))));return ke(We(i,s),a)}function cmt(e,t,n,r=0,i=pa.SUM_BY_NONZERO_WEIGHTS){let s=U(e,"multiClassLabels","sigmoidCrossEntropy");const a=U(t,"logits","sigmoidCrossEntropy");let o=null;if(n!=null&&(o=U(n,"weights","sigmoidCrossEntropy")),gs(s.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=xt(r),c=xt(1),f=xt(.5);s=ke(ne(s,We(c,u)),ne(f,u))}const l=umt(s,a);return sg(l,o,i)}const fmt=ee({sigmoidCrossEntropy_:cmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hmt(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return Mh((i,s,a)=>{const l=_te(s,[n],!0),u=We(Oe(s,"float32"),l);a([i,u]);const c=ur(ne(u,i));return{value:qe(c,[n]),gradFunc:(d,p)=>{const[g,m]=p,v=Zr(d.shape,[n]);return[ne(ie(d,v),We(Oe(g,"float32"),Vl(m))),ne(ie(d,v),We(Vl(m),Oe(g,"float32")))]}}})(e,t)}function dmt(e,t,n,r=0,i=pa.SUM_BY_NONZERO_WEIGHTS){let s=U(e,"onehotLabels","softmaxCrossEntropy");const a=U(t,"logits","softmaxCrossEntropy");let o=null;if(n!=null&&(o=U(n,"weights","softmaxCrossEntropy")),gs(s.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){const u=xt(r),c=xt(1),f=xt(s.shape[1]);s=ke(ne(s,We(c,u)),Qe(u,f))}const l=hmt(s,a);return sg(l,o,i)}const pmt=ee({softmaxCrossEntropy_:dmt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gmt(e,t,n,r){const i=U(e,"indices","sparseFillEmptyRows","int32"),s=U(t,"values","sparseFillEmptyRows"),a=U(n,"denseShape","sparseFillEmptyRows","int32"),o=U(r,"defaultValue","sparseFillEmptyRows",s.dtype);if(i.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${i.shape}`);if(s.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(a.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${a.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:i,values:s,denseShape:a,defaultValue:o},u=J.runKernel(kz,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const mmt=ee({sparseFillEmptyRows_:gmt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vmt(e,t,n){const r=U(e,"inputIndices","sparseReshape","int32"),i=U(t,"inputShape","sparseReshape","int32"),s=U(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(s.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);const a={inputIndices:r,inputShape:i,newShape:s},o=J.runKernel(Ez,a);return{outputIndices:o[0],outputShape:o[1]}}const ymt=ee({sparseReshape_:vmt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bmt(e,t,n){const r=U(e,"data","sparseSegmentMean"),i=U(t,"indices","sparseSegmentMean","int32"),s=U(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${i.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${s.shape}`);const a={data:r,indices:i,segmentIds:s};return J.runKernel(Az,a)}const xmt=ee({sparseSegmentMean_:bmt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wmt(e,t,n){const r=U(e,"data","sparseSegmentSum"),i=U(t,"indices","sparseSegmentSum","int32"),s=U(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${i.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${s.shape}`);const a={data:r,indices:i,segmentIds:s};return J.runKernel(Tz,a)}const $mt=ee({sparseSegmentSum_:wmt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cmt(e,t,n,r,i,s,a,o){const l=U(e,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=U(t,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:i,rightPad:s,padWidth:a,preserveShortSequences:o},f={data:l,dataSplits:u},h=J.runKernel(Mz,f,c);return{nGrams:h[0],nGramsSplits:h[1]}}const _mt=ee({stringNGrams_:Cmt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Smt(e,t,n=!0){const r=U(e,"input","stringSplit","string"),i=U(t,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(i.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const s={skipEmpty:n},a={input:r,delimiter:i},o=J.runKernel(Fz,a,s);return{indices:o[0],values:o[1],shape:o[2]}}const kmt=ee({stringSplit_:Smt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Emt(e,t){const n=U(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const i={input:n};return J.runKernel(Oz,i,r)}const Amt=ee({stringToHashBucketFast_:Emt});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tmt(e,t,n,r=!0){const i=U(e,"input","staticRegexReplace","string"),s={pattern:t,rewrite:n,replaceGlobal:r};return J.runKernel(yI,{x:i},s)}const Dmt=ee({staticRegexReplace_:Tmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nmt={fft:i7,ifft:kT,rfft:s7,irfft:Bte},Imt={hammingWindow:a0t,hannWindow:o3e,frame:l3e,stft:c0t},Jf={flipLeftRight:p0t,grayscaleToRGB:m0t,resizeNearestNeighbor:c3e,resizeBilinear:u3e,rotateWithOffset:y0t,cropAndResize:h0t,nonMaxSuppression:x0t,nonMaxSuppressionAsync:A0t,nonMaxSuppressionWithScore:D0t,nonMaxSuppressionWithScoreAsync:I0t,nonMaxSuppressionPadded:F0t,nonMaxSuppressionPaddedAsync:R0t,threshold:U0t,transform:V0t},f3e={bandPart:H0t,gramSchmidt:G0t,qr:X0t},Mmt={absoluteDifference:Q0t,computeWeightedLoss:sg,cosineDistance:emt,hingeLoss:nmt,huberLoss:imt,logLoss:amt,meanSquaredError:lmt,sigmoidCrossEntropy:fmt,softmaxCrossEntropy:pmt},Fmt={sparseFillEmptyRows:mmt,sparseReshape:ymt,sparseSegmentMean:xmt,sparseSegmentSum:$mt},Omt={stringNGrams:_mt,stringSplit:kmt,stringToHashBucketFast:Amt,staticRegexReplace:Dmt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rmt=new Map,VY=new Map;class Gb{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}}class El{constructor(){this.classNameMap={}}static getMap(){return El.instance==null&&(El.instance=new El),El.instance}static register(t){El.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function Ee(e,t,n){B(e.className!=null,()=>"Class being registered does not have the static className property defined."),B(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),B(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof n>"u"&&(n=e.className);const r=n,i=t+">"+r;return El.register(e),Rmt.set(i,e),VY.set(e,i),e}function Pmt(e){return VY.has(e)?VY.get(e):e.className}const Lmt=Object.freeze(Object.defineProperty({__proto__:null,Serializable:Gb,SerializationMap:El,registerClass:Ee,getRegisteredName:Pmt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ag extends Gb{minimize(t,n=!1,r){const{value:i,grads:s}=this.computeGradients(t,r);if(r!=null){const a=r.map(o=>({name:o.name,tensor:s[o.name]}));this.applyGradients(a)}else this.applyGradients(s);return Bt(s),n?i:(i.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return DTe(t,n)}dispose(){this.iterations_!=null&&Bt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:xt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(ag,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gte extends ag{static get className(){return"Adadelta"}constructor(t,n,r=null){super(),this.learningRate=t,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=J.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=J.registeredVariables[r],a=!1;this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accum_grad`,variable:ce(()=>en(s).variable(a))}),this.accumulatedUpdates[i]==null&&(this.accumulatedUpdates[i]={originalName:`${r}/accum_var`,variable:ce(()=>en(s).variable(a))});const o=Array.isArray(t)?t[i].tensor:t[r];if(o==null)return;const l=this.accumulatedGrads[i].variable,u=this.accumulatedUpdates[i].variable;ce(()=>{const c=ke(ne(l,this.rho),ne(Gn(o),1-this.rho)),f=ne(Qe(qs(ke(u,this.epsilon)),qs(ke(l,this.epsilon))),o),h=ke(ne(u,this.rho),ne(Gn(f),1-this.rho));l.assign(c),u.assign(h);const d=ke(ne(f,-this.learningRate),s);s.assign(d)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Bt(this.accumulatedGrads.map(t=>t.variable)),Bt(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=t.length/2,r=!1;this.accumulatedGrads=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedUpdates=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yte extends ag{static get className(){return"Adagrad"}constructor(t,n=.1){super(),this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=J.registeredVariables[r];this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accumulator`,variable:ce(()=>S_(s.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(t)?t[i].tensor:t[r];if(a==null)return;const o=this.accumulatedGrads[i].variable;ce(()=>{const l=ke(o,Gn(a));o.assign(l);const u=ke(ne(Qe(a,qs(ke(l,J.backend.epsilon()))),-this.learningRate),s);s.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Bt(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulatedGrads=t.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xte extends ag{static get className(){return"Adam"}constructor(t,n,r,i=null){super(),this.learningRate=t,this.beta1=n,this.beta2=r,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ce(()=>{this.accBeta1=xt(n).variable(),this.accBeta2=xt(r).variable()}),i==null&&(this.epsilon=J.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);ce(()=>{const r=We(1,this.accBeta1),i=We(1,this.accBeta2);n.forEach((s,a)=>{const o=J.registeredVariables[s],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${s}/m`,variable:ce(()=>en(o).variable(l))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${s}/v`,variable:ce(()=>en(o).variable(l))});const u=Array.isArray(t)?t[a].tensor:t[s];if(u==null)return;const c=this.accumulatedFirstMoment[a].variable,f=this.accumulatedSecondMoment[a].variable,h=ke(ne(c,this.beta1),ne(u,1-this.beta1)),d=ke(ne(f,this.beta2),ne(Gn(u),1-this.beta2)),p=Qe(h,r),g=Qe(d,i);c.assign(h),f.assign(d);const m=ke(ne(Qe(p,ke(qs(g),this.epsilon)),-this.learningRate),o);o.assign(m)}),this.accBeta1.assign(ne(this.accBeta1,this.beta1)),this.accBeta2.assign(ne(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Bt(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&Bt(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t),ce(()=>{this.accBeta1.assign(H0(this.beta1,this.iterations_+1)),this.accBeta2.assign(H0(this.beta2,this.iterations_+1))});const n=t.length/2,r=!1;this.accumulatedFirstMoment=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kte extends ag{static get className(){return"Adamax"}constructor(t,n,r,i=null,s=0){super(),this.learningRate=t,this.beta1=n,this.beta2=r,this.epsilon=i,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ce(()=>{this.iteration=xt(0).variable(),this.accBeta1=xt(n).variable()}),i==null&&(this.epsilon=J.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);ce(()=>{const r=We(1,this.accBeta1),i=Qe(-this.learningRate,ke(ne(this.iteration,this.decay),1));n.forEach((s,a)=>{const o=J.registeredVariables[s],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${s}/m`,variable:en(o).variable(l)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${s}/v`,variable:en(o).variable(l)});const u=Array.isArray(t)?t[a].tensor:t[s];if(u==null)return;const c=this.accumulatedFirstMoment[a].variable,f=this.accumulatedWeightedInfNorm[a].variable,h=ke(ne(c,this.beta1),ne(u,1-this.beta1)),d=ne(f,this.beta2),p=hi(u),g=ig(d,p);c.assign(h),f.assign(g);const m=ke(ne(Qe(i,r),Qe(h,ke(g,this.epsilon))),o);o.assign(m)}),this.iteration.assign(ke(this.iteration,1)),this.accBeta1.assign(ne(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Bt(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&Bt(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g7 extends ag{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Array.isArray(t)?t[i].tensor:t[r];if(s==null)return;const a=J.registeredVariables[r];ce(()=>{const o=ke(ne(this.c,s),a);a.assign(o)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=Uc(xt(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zte extends g7{static get className(){return"Momentum"}constructor(t,n,r=!1){super(t),this.learningRate=t,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=xt(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=J.registeredVariables[r];this.accumulations[i]==null&&(this.accumulations[i]={originalName:`${r}/momentum`,variable:ce(()=>en(s).variable(!1))});const a=this.accumulations[i].variable,o=Array.isArray(t)?t[i].tensor:t[r];o!=null&&ce(()=>{let l;const u=ke(ne(this.m,a),o);this.useNesterov?l=ke(ne(this.c,ke(o,ne(u,this.m))),s):l=ke(ne(this.c,u),s),a.assign(u),s.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Bt(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulations=t.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qte extends ag{static get className(){return"RMSProp"}constructor(t,n=.9,r=0,i=null,s=!1){if(super(),this.learningRate=t,this.decay=n,this.momentum=r,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,i==null&&(this.epsilon=J.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=J.registeredVariables[r],a=!1;this.accumulatedMeanSquares[i]==null&&(this.accumulatedMeanSquares[i]={originalName:`${r}/rms`,variable:ce(()=>en(s).variable(a))}),this.accumulatedMoments[i]==null&&(this.accumulatedMoments[i]={originalName:`${r}/momentum`,variable:ce(()=>en(s).variable(a))}),this.accumulatedMeanGrads[i]==null&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${r}/mg`,variable:ce(()=>en(s).variable(a))});const o=Array.isArray(t)?t[i].tensor:t[r];if(o==null)return;const l=this.accumulatedMeanSquares[i].variable,u=this.accumulatedMoments[i].variable;ce(()=>{const c=ke(ne(l,this.decay),ne(Gn(o),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[i].variable,h=ke(ne(f,this.decay),ne(o,1-this.decay)),d=Qe(ne(o,this.learningRate),qs(We(c,ke(Gn(h),this.epsilon)))),p=ke(ne(u,this.momentum),d);l.assign(c),f.assign(h),u.assign(p);const g=We(s,p);s.assign(g)}else{const f=ke(ne(l,this.decay),ne(Gn(o),1-this.decay)),h=ke(ne(u,this.momentum),Qe(ne(o,this.learningRate),qs(ke(f,this.epsilon))));l.assign(f),u.assign(h);const d=We(s,h);s.assign(d)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Bt(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Bt(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&Bt(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=this.centered?t.length/3:t.length/2,r=!1;this.accumulatedMeanSquares=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedMoments=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bmt=[Gte,Yte,Xte,Kte,Zte,Qte,g7];function zmt(){for(const e of Bmt)Ee(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Umt="model",Wmt=".json",Vmt=".weights.bin";function wge(e){return new Promise(t=>setTimeout(t)).then(e)}class Ly{constructor(t){if(!le().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Ly.URL_SCHEME)&&(t=t.slice(Ly.URL_SCHEME.length)),(t==null||t.length===0)&&(t=Umt),this.modelJsonFileName=t+Wmt,this.weightDataFileName=t+Vmt}async save(t){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=ff.join(t.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const i=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],s=PAe(t,i),a=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=a,await wge(()=>o.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=r,await wge(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:CI(t)}}}}Ly.URL_SCHEME="downloads://";class jmt{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise((t,n)=>{const r=new FileReader;r.onload=i=>{const s=JSON.parse(i.target.result),a=s.modelTopology;if(a==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(s.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){t({modelTopology:a});return}const l=fte(s,u=>this.loadWeights(u));t(l)},r.onerror=i=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(t){const n=[],r=[];for(const a of t)n.push(...a.weights),r.push(...a.paths);const i=this.checkManifestAndWeightFiles(t),s=r.map(a=>this.loadWeightsFile(a,i[a]));return Promise.all(s).then(a=>[n,a])}loadWeightsFile(t,n){return new Promise((r,i)=>{const s=new FileReader;s.onload=a=>{const o=a.target.result;r(o)},s.onerror=a=>i(`Failed to weights data from file of path '${t}'.`),s.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(t){const n=[],r=this.weightsFiles.map(s=>yge(s.name)),i={};for(const s of t)s.paths.forEach(a=>{const o=yge(a);if(n.indexOf(o)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(n.push(o),r.indexOf(o)===-1)throw new Error(`Weight file with basename '${o}' is not provided.`);i[a]=this.weightsFiles[r.indexOf(o)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return i}}const Hmt=e=>le().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ly.URL_SCHEME)?qmt(e.slice(Ly.URL_SCHEME.length)):null;kr.registerSaveRouter(Hmt);function qmt(e="model"){return new Ly(e)}function Gmt(e){return new jmt(e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ge(e,t,n,r){a(e),n=n==null?0:n,r=r==null?1:r,o(n,r);let i=0;const s=l=>(l.then(u=>{const c=n+ ++i/e.length*(r-n);return t(c),u}),l);function a(l){B(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,u){B(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),B(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),B(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(e.map(s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function h3e(e,t){t==null&&(t={});const n=t.fetchFunc==null?le().platform.fetch:t.fetchFunc,r=e.map(f=>n(f,t.requestInit,{isBinary:!0})),i=0,s=.5,o=(t.onProgress==null?await Promise.all(r):await $ge(r,t.onProgress,i,s)).map(f=>f.arrayBuffer()),l=.5,u=1;return t.onProgress==null?await Promise.all(o):await $ge(o,t.onProgress,l,u)}async function Ymt(e,t="",n,r){return d3e(a=>h3e(a,{requestInit:r}))(e,t,n)}function d3e(e){return async(t,n="",r)=>{const i=t.map(()=>!1),s={},a=r!=null?r.map(()=>!1):[],o=[];if(t.forEach((d,p)=>{let g=0;d.weights.forEach(m=>{const v="quantization"in m?m.quantization.dtype:m.dtype,y=FY[v]*de(m.shape),b=()=>{i[p]=!0,s[p]==null&&(s[p]=[]),s[p].push({manifestEntry:m,groupOffset:g,sizeBytes:y})};r!=null?r.forEach((x,w)=>{x===m.name&&(b(),a[w]=!0)}):b(),o.push(m.name),g+=y})}),!a.every(d=>d)){const d=r.filter((p,g)=>!a[g]);throw new Error(`Could not find weights in manifest with names: ${d.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}const l=i.reduce((d,p,g)=>(p&&d.push(g),d),[]),u=[];l.forEach(d=>{t[d].paths.forEach(p=>{const g=n+(n.endsWith("/")?"":"/")+p;u.push(g)})});const c=await e(u),f={};let h=0;return l.forEach(d=>{const p=t[d].paths.length,g=new ff(c.slice(h,h+p));s[d].forEach(v=>{const y=g.slice(v.groupOffset,v.groupOffset+v.sizeBytes),b=OAe(y,[v.manifestEntry]);for(const x in b)f[x]=b[x]}),h+=p}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xmt="application/octet-stream",Kmt="application/json";class Jte{constructor(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(B(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=le().platform.fetch,B(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&B(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i=PAe(t,r);if(n.body.append("model.json",new Blob([JSON.stringify(i)],{type:Kmt}),"model.json"),t.weightData!=null){const a=ff.join(t.weightData);n.body.append("model.weights.bin",new Blob([a],{type:Xmt}),"model.weights.bin")}const s=await this.fetch(this.path,n);if(s.ok)return{modelArtifactsInfo:CI(t),responses:[s]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${s.status}.`)}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await t.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}const r=n.modelTopology,i=n.weightsManifest;if(r==null&&i==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return fte(n,s=>this.loadWeights(s))}async loadWeights(t){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,i]=Zmt(n),s=this.weightPathPrefix||r,a=BAe(t),o=[],l=[];for(const c of t)for(const f of c.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(f)):o.push(s+f+i);this.weightUrlConverter&&o.push(...await Promise.all(l));const u=await h3e(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[a,u]}}Jte.URL_SCHEME_REGEX=/^https?:\/\//;function Zmt(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),i=n>t?e.substring(n):"";return[r+"/",i]}function jY(e){return e.match(Jte.URL_SCHEME_REGEX)!=null}const p3e=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(e)?n=e.every(r=>jY(r)):n=jY(e),n)return ene(e,t)}return null};kr.registerSaveRouter(p3e);kr.registerLoadRouter(p3e);function ene(e,t){return new Jte(e,t)}function Qmt(e,t){return ene(e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hj{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class g3e{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class Jmt{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=n=>Promise.resolve(t.save(n)))}}function evt(e,t,n,r){const i=arguments;return new Jmt(m3e(...i))}function m3e(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new hj(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new hj({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new hj({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function tvt(e){return new g3e(e)}function nvt(e){return new g3e(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rvt=Object.freeze(Object.defineProperty({__proto__:null,browserFiles:Gmt,browserHTTPRequest:Qmt,CompositeArrayBuffer:ff,concatenateArrayBuffers:RAe,decodeWeights:OAe,encodeWeights:OY,fromMemory:evt,fromMemorySync:m3e,getLoadHandlers:Cct,getModelArtifactsForJSON:fte,getModelArtifactsForJSONSync:LAe,getModelArtifactsInfoForJSON:CI,getSaveHandlers:zAe,getWeightSpecs:BAe,http:ene,isHTTPScheme:jY,loadWeights:Ymt,registerLoadRouter:$ct,registerSaveRouter:wct,weightsLoaderFactory:d3e,withSaveHandler:tvt,withSaveHandlerSync:nvt,copyModel:Pct,listModels:Oct,moveModel:Lct,removeModel:Rct},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ivt(e,t,n){const r=U(e,"labels","confusionMatrix"),i=U(t,"predictions","confusionMatrix");B(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),B(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),B(i.rank===1,()=>`Expected the rank of predictions to be 1, but got ${i.rank}`),B(r.shape[0]===i.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`),B(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const s=CT(Oe(r,"int32"),n),a=CT(Oe(i,"int32"),n),o=Zt(s),l=Pt(o,a);return Oe(l,"int32")}const svt=ee({confusionMatrix_:ivt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const avt=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:svt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let kv,Cge=!1;function v3e(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,s=!1,a=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)s=!0;else if(e.getContext!=null)a=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(mT(S5,J.backendName)!=null){const p={pixels:e},g={numChannels:t};return J.runKernel(S5,p,g)}const[u,c]=i?[e.videoWidth,e.videoHeight]:[e.width,e.height];let f;if(a)f=e.getContext("2d").getImageData(0,0,u,c).data;else if(r||n)f=e.data;else if(s||i||o){if(kv==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")kv=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else kv=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});kv.canvas.width=u,kv.canvas.height=c,kv.drawImage(e,0,0,u,c),f=kv.getImageData(0,0,u,c).data}let h;if(t===4)h=new Int32Array(f);else{const p=u*c;h=new Int32Array(p*t);for(let g=0;g<p;g++)for(let m=0;m<t;++m)h[g*t+m]=f[g*4+m]}return ZTe(h,[c,u,t],"int32")}function ovt(e){return e!=null&&e.data instanceof Uint8Array}function lvt(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function uvt(e){return e!=null&&e.width!==0&&e.height!==0}function cvt(e){return lvt()&&!(e instanceof ImageBitmap)&&uvt(e)&&!ovt(e)}async function fvt(e,t=3){let n=null;if(le().getBool("WRAP_TO_IMAGEBITMAP")&&cvt(e)){let r;try{r=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===e.width&&r.height===e.height?n=r:n=e}else n=e;return v3e(n,t)}function y3e(e){if(e.rank!==2&&e.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);const t=e.rank===2?1:e.shape[2];if(t>4||t===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if(e.dtype!=="float32"&&e.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}function hvt(e){const t=(e==null?void 0:e.alpha)||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}async function dvt(e,t){let n=U(e,"img","toPixels");if(!(e instanceof On)){const u=n;n=Oe(u,"int32"),u.dispose()}y3e(n);const[r,i]=n.shape.slice(0,2),s=n.rank===2?1:n.shape[2],a=await n.data(),o=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(i*r*4);for(let u=0;u<r*i;++u){const c=[0,0,0,255];for(let h=0;h<s;h++){const d=a[u*s+h];if(n.dtype==="float32"){if(d<0||d>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${d}.`)}else if(n.dtype==="int32"&&(d<0||d>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${d}.`);s===1?(c[0]=d*o,c[1]=d*o,c[2]=d*o):c[h]=d*o}const f=u*4;l[f+0]=Math.round(c[0]),l[f+1]=Math.round(c[1]),l[f+2]=Math.round(c[2]),l[f+3]=Math.round(c[3])}if(t!=null){Cge||mT(QB,J.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),Cge=!0),t.width=i,t.height=r;const u=t.getContext("2d"),c=new ImageData(l,i,r);u.putImageData(c,0,0)}return n!==e&&n.dispose(),l}function pvt(e,t,n){let r=U(e,"img","draw");if(!(e instanceof On)){const a=r;r=Oe(a,"int32"),a.dispose()}y3e(r),hvt(n==null?void 0:n.imageOptions);const i={image:r},s={canvas:t,options:n};J.runKernel(QB,i,s)}const gvt=ee({fromPixels_:v3e}),mvt=Object.freeze(Object.defineProperty({__proto__:null,fromPixelsAsync:fvt,toPixels:dvt,draw:pvt,fromPixels:gvt},Symbol.toStringTag,{value:"Module"}));function m7(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(de(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const i=t.shape,s=i[i.length-1];let a=1;for(let f=0;f<i.length-1;++f)a*=i[f];const o=e.shape,l=i.slice();l.pop();let u=1;for(let f=s;f<n;++f)u*=o[f],l.push(o[f]);const c=[...Je(e.shape).map(f=>f/u),1].slice(0,s);return[l,a,u,c]}const vvt=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:m7},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HY=-2,yvt=-1;function tne(e,t,n){const r=e.shape.length;B(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),B(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)B(t[i]+n[i]<=e.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${t[i]+n[i]}) would overflow input.shape[${i}] (${e.shape[i]})`)}function bvt(e){const t=[];let n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function nne(e,t,n){const r=[];for(let i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function b3e(e,t,n,r){const i=[...e];for(let s=i.length;s<r.length;s++)i.push(1);for(let s=0;s<n;s++)s===0?i[t]=1:(i.splice(t,0,1),i.pop());return i}function x3e(e,t,n){return n<=e?n:n-(t-1)}function w3e(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function xvt(e,t,n,r,i,s,a,o,l){const u=e.length;let c=new Array(u),f=new Array(u),h=new Array(u);if(t.length&&n>0){const d=t[0],p=n+1;c=$3e(a,d,p,r,e),f=C3e(o,d,p,i,e),h=b3e(s,d,p,e)}else for(let d=0;d<u;d++)c[d]=S3e(a,r,s,e,d,l),f[d]=k3e(o,i,s,e,d,l),h[d]=_3e(s,d,l);return{begin:c,end:f,strides:h}}function $3e(e,t,n,r,i){const s=[...i],a=w3e(n,t);for(let o=0;o<s.length;o++)if(a.indexOf(o)>-1)s[o]=0;else{const l=x3e(t,n,o);let u=r[l];e&1<<l&&(u=0),s[o]=u}return s}function C3e(e,t,n,r,i){const s=[...i],a=w3e(n,t);for(let o=0;o<s.length;o++)if(a.indexOf(o)>-1)s[o]=Number.MAX_SAFE_INTEGER;else{const l=x3e(t,n,o);let u=r[l];e&1<<l&&(u=Number.MAX_SAFE_INTEGER),s[o]=u}for(let o=0;o<s.length;o++){const l=i[o];s[o]<0&&(s[o]+=l),s[o]=z0(0,s[o],i[o])}return s}function _3e(e,t,n){let r=e[t];return(n&1<<t||r==null)&&(r=1),r}function S3e(e,t,n,r,i,s){let a=t[i];const o=n[i]||1;(e&1<<i||s&1<<i||a==null)&&(o>0?a=Number.MIN_SAFE_INTEGER:a=Number.MAX_SAFE_INTEGER);const l=r[i];return a<0&&(a+=l),a=z0(0,a,l-1),a}function k3e(e,t,n,r,i,s){let a=t[i];const o=n[i]||1;(e&1<<i||s&1<<i||a==null)&&(o>0?a=Number.MAX_SAFE_INTEGER:a=Number.MIN_SAFE_INTEGER);const l=r[i];return a<0&&(a+=l),o>0?a=z0(0,a,l):a=z0(-1,a,l-1),a}function rne(e,t,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function ine(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function v7(e,t,n){let r;const i=e.shape.length;typeof t=="number"?r=[t,...new Array(i-1).fill(0)]:t.length<i?r=t.concat(new Array(i-t.length).fill(0)):r=t.slice(),r.forEach(a=>{B(a!==-1,()=>"slice() does not support negative begin indexing.")});let s;return n==null?s=new Array(i).fill(-1):typeof n=="number"?s=[n,...new Array(i-1).fill(-1)]:n.length<i?s=n.concat(new Array(i-n.length).fill(-1)):s=n,s=s.map((a,o)=>a>=0?a:(B(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${o}.`),e.shape[o]-r[o])),[r,s]}function sne(e,t,n,r,i,s,a,o,l){let u;if(r==null?(u=new Array(t.length),u.fill(1)):u=r,a!=null&&(a&a-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const f={dims:u.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:u.slice(),beginMask:i,endMask:s,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};for(let b=0;b<f.dims;b++)c&&(1<<b&o)!==0&&f.numAddAxisAfterEllipsis++,1<<b&a&&(c=!0);c||(f.ellipsisMask|=1<<f.dims,f.dims++);const h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};wvt(f,h);let d=!0,p=!0,g=!0;const m=[],v=[];for(let b=0;b<e.length;++b){if(h.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const x=!!(h.shrinkAxisMask&1<<b),w=e[b];if(w===-1){m.push(x?1:-1);continue}const C=[h.beginMask&1<<b,h.endMask&1<<b],$=[h.strides[b]>0?0:-1,h.strides[b]>0?w:w-1];if(x&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&h.strides[b]===1;const _=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(x){const N=h.begin[b]<0?w+h.begin[b]:h.begin[b];if(h.begin[b]=N,h.end[b]=h.begin[b]+1,N<0||N>=w)throw Error(`slice index ${h.begin[b]} of dimension ${b} out of bounds.`)}else h.begin[b]=_ge(h.begin[b],0,h.strides[b],w,C,$),h.end[b]=_ge(h.end[b],1,h.strides[b],w,C,$);const S=h.strides[b]===1&&h.begin[b]===0&&h.end[b]===w;d=d&&S,p=p&&(b===0&&h.strides[b]===1||S)}else d=d&&h.strides[b]===1&&_,p=p&&(b===0&&h.strides[b]===1||_);let k,E=!1;if(h.beginValid&&h.endValid?(k=h.end[b]-h.begin[b],E=!0):x?(k=1,E=!0):_&&w>=0&&(h.strides[b]<0?k=-w:k=w,E=!0),E){let S;k===0||k<0!=h.strides[b]<0?S=0:S=Math.trunc(k/h.strides[b])+(k%h.strides[b]!==0?1:0),m.push(S)}else m.push(-1)}for(let b=0;b<h.finalShapeGatherIndices.length;++b){const x=h.finalShapeGatherIndices[b];x>=0?v.push(m[x]):x===HY&&v.push(1)}return{finalShapeSparse:v.filter((b,x)=>h.finalShapeGatherIndices[x]!==HY),finalShape:v,isIdentity:d,sliceDim0:p,isSimpleSlice:g,begin:h.begin,end:h.end,strides:h.strides}}function wvt(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const i=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(HY),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[r]),e.end!=null&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(yvt),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}function _ge(e,t,n,r,i,s){if(i[t])return n>0?s[t]:s[t+1&1];{const a=e<0?r+e:e;return a<s[0]?s[0]:a>s[1]?s[1]:a}}const E3e=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:tne,maskToAxes:bvt,computeOutShape:nne,stridesWithElidedDims:b3e,getNormalizedAxes:xvt,startIndicesWithElidedDims:$3e,stopIndicesWithElidedDims:C3e,stridesForAxis:_3e,startForAxis:S3e,stopForAxis:k3e,isSliceContinous:rne,computeFlatOffset:ine,parseSliceParams:v7,sliceInfo:sne},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const $vt="4.8.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A3e{static sgd(t){return new g7(t)}static momentum(t,n,r=!1){return new Zte(t,n,r)}static rmsprop(t,n=.9,r=0,i=null,s=!1){return new Qte(t,n,r,i,s)}static adam(t=.001,n=.9,r=.999,i=null){return new Xte(t,n,r,i)}static adadelta(t=.001,n=.95,r=null){return new Gte(t,n,r)}static adamax(t=.002,n=.9,r=.999,i=null,s=0){return new Kte(t,n,r,i,s)}static adagrad(t,n=.1){return new Yte(t,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rg=A3e;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cvt=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e())();function ane(){return new Promise(e=>Cvt(()=>e()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function one(e,t){const n=e[0].length;e.forEach((i,s)=>{B(i.length===n,()=>`Error in concat${n}D: rank of tensors[${s}] must be the same as the rank of the rest (${n})`)}),B(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=e[0];e.forEach((i,s)=>{for(let a=0;a<n;a++)B(a===t||i[a]===r[a],()=>`Error in concat${n}D: Shape of tensors[${s}] (${i}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function sh(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bc;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(bc||(bc={}));function T3e(e,t,n){let r=new Array;if(n==null&&t==null)return r;if(t==null)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(n==null)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){const s=n[i],a=r[r.length-n.length+i],o=r[a];if(s>=0)if(o>=0){if(o!==s)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+e}] = ${s} but shape[${i+e}] = ${o}`)}else r[a]=s}return r}function D3e(e){const t={FIRST_DIM_SIZE:bc.FIRST_DIM_SIZE,VALUE_ROWIDS:bc.VALUE_ROWIDS,ROW_LENGTHS:bc.ROW_LENGTHS,ROW_SPLITS:bc.ROW_SPLITS,ROW_LIMITS:bc.ROW_LIMITS,ROW_STARTS:bc.ROW_STARTS},n=[];for(const r of e)if(r in t)n.push(t[r]);else break;return n}function N3e(e){return e.length===0?0:e[0]===bc.FIRST_DIM_SIZE?e.length-1:e.length}function I3e(e,t){if(e==null||t==null)return;const n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){const s=e[i],a=t[i+1];if(s>=0&&a>=0&&s!==1&&s!==a)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-e.length}] = ${s} but ragged tensor input.flatValues.shape[${i-e.length}] = ${a}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lne=30;function y7(e){return e<=lne?e:$5(e,Math.floor(Math.sqrt(e)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function une(e,t,n){const r=n*(typeof e=="number"?e:e[0]),i=t*(typeof e=="number"?e:e[1]);return[r,i]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NI(e,t,n,r=!0){let i=[];if(r)i=i.concat(t.slice(0)),i.push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);const s=t.length;for(let a=0;a<s;++a)i=i.concat([e[a+1]/t[a],t[a]]);i=i.concat(e.slice(s+1))}return i}function II(e,t,n=!0){const r=[];if(n){r.push(t);for(let i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{const i=[],s=[];for(let a=1;a<e;++a)a>=t*2+1||a%2===1?s.push(a):i.push(a);r.push(...i),r.push(0),r.push(...s)}return r}function MI(e,t,n,r=!0){const i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(let s=1;s<e.length;++s)s<=t.length?r?i.push(t[s-1]*e[s]):i.push(e[s]/t[s-1]):i.push(e[s]);return i}function cne(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function fne(e,t,n){const r=e.slice(0,1);for(let i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b7=1.7580993408473768,x7=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hne=.3275911,dne=.254829592,pne=-.284496736,gne=1.421413741,mne=-1.453152027,vne=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fp(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(e.length*2);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function M3e(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function F3e(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=0;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function O3e(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=2;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function yne(e,t){const n=e[t*2],r=e[t*2+1];return{real:n,imag:r}}function R3e(e,t,n,r){e[r*2]=t,e[r*2+1]=n}function P3e(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let i=0;i<Math.ceil(e/2);i++){const s=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(s),r[i]=Math.sin(s)}return{real:n,imag:r}}function L3e(e,t,n){const r=(n?2:-2)*Math.PI*(e/t),i=Math.cos(r),s=Math.sin(r);return{real:i,imag:s}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dj="->",_vt=/->/g,Sge=",",kge="...";function bne(e,t){e=e.replace(/\s/g,"");const n=(e.length-e.replace(_vt,"").length)/dj.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${dj}").`);const[r,i]=e.split(dj);B(r.indexOf(kge)===-1,()=>`The ellipsis notation ("${kge}") is not supported yet.`);const s=r.split(Sge),a=s.length;if(t!==a)throw new Error(`Expected ${a} input tensors, received ${t}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let h=0;h<i.length;++h){const d=i[h];if(!s.some(p=>p.indexOf(d)!==-1))throw new Error(`Output subscripts contain the label ${d} not present in the input subscripts.`);o.indexOf(d)===-1&&o.push(d)}for(let h=0;h<r.length;++h){const d=r[h];o.indexOf(d)===-1&&d!==Sge&&o.push(d)}const l=new Array(s.length);for(let h=0;h<a;++h){if(new Set(s[h].split("")).size!==s[h].length)throw new Error(`Found duplicate axes in input component ${s[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let d=0;d<s[h].length;++d)l[h].push(o.indexOf(s[h][d]))}const u=o.length,c=i.length,f=[];for(let h=c;h<u;++h)f.push(h);return{allDims:o,summedDims:f,idDims:l}}function xne(e,t){let n=new Array(e);n.fill(-1);for(let i=0;i<t.length;++i)n[t[i]]=i;const r=[];for(let i=0;i<e;++i)n[i]===-1&&r.push(i);return n=n.filter(i=>i!==-1),{permutationIndices:n,expandDims:r}}function wne(e,t,n){const r=new Array(e);for(let i=0;i<n.length;++i){const s=n[i].shape;for(let a=0;a<t[i].length;++a)r[t[i][a]]===void 0?r[t[i][a]]=s[a]:B(r[t[i][a]]===s[a],()=>`Expected dimension ${r[t[i][a]]} at axis ${a} of input shaped ${JSON.stringify(s)}, but got dimension ${s[a]}`)}}function $ne(e,t){const n=e,r=[];let i=0;e.length===0&&n.push(-1),i=e.length+1;for(let a=0;a<i;++a)r.push([]);const s=[];for(let a=0;a<n.length;++a){const o=n[a],l=Svt(t,o);for(const u of l)s.indexOf(u)===-1&&(r[a].push(u),s.push(u))}return{path:n,steps:r}}function Cne(e){return e.every((t,n)=>t===n)}function Svt(e,t){const n=[];for(let r=0;r<e.length;++r)(e[r].length===0||e[r].indexOf(t)!==-1||t===-1)&&n.push(r);return n}function _ne(e,t,n=0){let r=[];if(typeof t=="number")B(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(e.shape[n]/t);else{const i=t.reduce((a,o)=>(o===-1&&(a+=1),a),0);B(i<=1,()=>"There should be only one negative value in split array.");const s=t.indexOf(-1);if(s!==-1){const a=t.reduce((o,l)=>l>0?o+l:o);t[s]=e.shape[n]-a}B(e.shape[n]===t.reduce((a,o)=>a+o),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3e(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function z3e(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function U3e(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W3e(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function V3e(e,t){return`size ${e} must be non-negative, not ${t}`}function j3e(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function H3e(e,t){const n=de(e),r=de(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${e} outputShape= ${t}`}function q3e(e,t){const n=de(e),r=de(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${e} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qY(){return"segment ids must be >= 0"}function G3e(){return"segment ids are not increasing"}function Y3e(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function X3e(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3e(e,t){let n=!1,r;for(e<=lne?(r=e,n=!0):r=$5(e,Math.floor(Math.sqrt(e)));!n;)r>t||r===e?n=!0:r=$5(e,r+1);return r}function Z3e(e,t,n){const r=[],i=e.length;for(let s=0;s<i;s++)s!==t?r.push(e[s]):r.push(n);return r}function Sne(e,t,n,r){const i=t.shape.length,s=e.shape.length;if(r!==0&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${s}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let f=0;f<r;++f)if(e.shape[f]!==t.shape[f])throw new Error(`x.shape[${f}]: ${e.shape[f]} should be equal to indices.shape[${f}]: ${t.shape[f]}.`);const a=e.shape[n],o=[];let l=1,u=1,c=1;for(let f=0;f<r;++f)o.push(e.shape[f]),l*=e.shape[f];for(let f=r;f<n;f++)o.push(e.shape[f]),u*=e.shape[f];for(let f=r;f<i;f++)o.push(t.shape[f]);for(let f=n+1;f<s;f++)o.push(e.shape[f]),c*=e.shape[f];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:a,outputShape:o}}const kvt=Object.freeze(Object.defineProperty({__proto__:null,segOpComputeOptimalWindowSize:K3e,computeOutShape:Z3e,collectGatherOpShapeInfo:Sne},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Op(e){try{return e.map(t=>Ip(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function Q3e(e){return e.map(t=>rh(t))}const J3e=Object.freeze(Object.defineProperty({__proto__:null,slice_util:E3e,segment_util:kvt,fromUint8ToStringArray:Op,fromStringArrayToUint8:Q3e,upcastType:po,axesAreInnerMostDims:wte,combineLocations:$Te,computeOutAndReduceShapes:Li,expandShapeToKeepDim:Zr,assertAxesAreInnerMostDims:vs,getAxesPermutation:Fr,getUndoAxesPermutation:jm,getInnerMostAxes:Jr,getBroadcastDims:Ry,getReductionAxes:ui,assertAndGetBroadcastShape:Ct,assertParamsConsistent:one,computeOutShape:sh,computeDilation2DInfo:_I,computePool2DInfo:Gu,computePool3DInfo:ng,computeConv2DInfo:Pi,computeConv3DInfo:Vm,computeDefaultPad:gte,tupleValuesAreOne:V0,eitherStridesOrDilationsAreOne:ms,stridesOrDilationsArePositive:Oy,convertConv2DDataFormat:rg,checkPadOnDimRoundingMode:La,getFusedDyActivation:l7,getFusedBiasGradient:u7,applyActivation:c7,shouldFuse:f7,get RowPartitionType(){return bc},combineRaggedTensorToTensorShapes:T3e,getRowPartitionTypesHelper:D3e,getRaggedRank:N3e,validateDefaultValueShape:I3e,PARALLELIZE_THRESHOLD:lne,computeOptimalWindowSize:y7,getImageCenter:une,getReshaped:NI,getPermuted:II,getReshapedPermuted:MI,getSliceBeginCoords:cne,getSliceSize:fne,prepareAndValidate:m7,validateUpdateShape:Ute,validateInput:a7,calculateShapes:Gm,SELU_SCALEALPHA:b7,SELU_SCALE:x7,ERF_P:hne,ERF_A1:dne,ERF_A2:pne,ERF_A3:gne,ERF_A4:mne,ERF_A5:vne,warn:kl,log:Out,mergeRealAndImagArrays:Fp,splitRealAndImagArrays:M3e,complexWithEvenIndex:F3e,complexWithOddIndex:O3e,getComplexWithIndex:yne,assignToTypedArray:R3e,exponents:P3e,exponent:L3e,decodeEinsumEquation:bne,getEinsumPermutation:xne,checkEinsumDimSizes:wne,getEinsumComputePath:$ne,isIdentityPermutation:Cne,prepareSplitSize:_ne,getSparseFillEmptyRowsIndicesDenseShapeMismatch:B3e,getSparseFillEmptyRowsNegativeIndexErrorMessage:z3e,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:U3e,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:W3e,getSparseReshapeNegativeOutputDimErrorMessage:V3e,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:j3e,getSparseReshapeInputOutputMultipleErrorMessage:H3e,getSparseReshapeInputOutputMismatchErrorMessage:q3e,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:qY,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:G3e,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:Y3e,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:X3e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Evt=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:h7,nonMaxSuppressionV4Impl:d7,nonMaxSuppressionV5Impl:p7,whereImpl:o7},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */zmt();const Avt=Object.freeze(Object.defineProperty({__proto__:null,AdadeltaOptimizer:Gte,AdagradOptimizer:Yte,AdamOptimizer:Xte,AdamaxOptimizer:Kte,MomentumOptimizer:Zte,Optimizer:ag,OptimizerConstructors:A3e,RMSPropOptimizer:Qte,SGDOptimizer:g7,Tensor:On,TensorBuffer:oi,Variable:vT,get Rank(){return AY},sumOutType:Uz,upcastType:po,get Reduction(){return pa},customGrad:Mh,grad:idt,grads:sdt,valueAndGrad:adt,valueAndGrads:odt,variableGrads:DTe,Environment:pAe,env:le,get ENV(){return rte},nextFrame:ane,KernelBackend:NB,DataStorage:Qee,abs:hi,acos:KAe,acosh:ZAe,add:ke,addN:dft,all:pte,any:D5,argMax:Fw,argMin:QAe,asin:JAe,asinh:eTe,atan:tTe,atan2:nTe,atanh:rTe,avgPool:Wz,avgPool3d:iTe,basicLSTMCell:Rft,batchToSpaceND:Vz,batchNorm:SI,batchNorm2d:sTe,batchNorm3d:aTe,batchNorm4d:oTe,bincount:lTe,bitwiseAnd:Hft,broadcastArgs:Gft,broadcastTo:X2,buffer:Mt,cast:Oe,ceil:uTe,clipByValue:sl,clone:v0,complex:W0,concat:Di,concat1d:cTe,concat2d:fTe,concat3d:hTe,concat4d:dTe,conv1d:mte,conv2d:j0,conv2dTranspose:yte,conv3d:pTe,conv3dTranspose:mTe,cos:jz,cosh:bte,cumprod:N5,cumsum:xte,denseBincount:zY,depthToSpace:vTe,depthwiseConv2d:kI,diag:mht,dilation2d:yTe,div:Qe,divNoNan:bTe,dot:xTe,einsum:Sht,elu:EI,ensureShape:Aht,equal:Kc,erf:wTe,euclideanNorm:_Te,exp:Vl,expandDims:Ga,expm1:STe,eye:$te,fill:S_,floor:TI,floorDiv:dte,gather:DI,greater:yl,greaterEqual:Hm,imag:Hz,isFinite:kTe,isInf:ETe,isNaN:ATe,leakyRelu:qz,less:$T,lessEqual:Vb,linspace:edt,localResponseNormalization:TTe,log:jl,log1p:Gz,logSigmoid:NTe,logSoftmax:Cte,logSumExp:_te,logicalAnd:Fh,logicalNot:Xz,logicalOr:Ste,logicalXor:ITe,lowerBound:bdt,matMul:Pt,max:Du,maxPool:Kz,maxPool3d:MTe,maxPoolWithArgmax:Cdt,maximum:ig,mean:Lr,meshgrid:kdt,min:wT,minimum:Py,mirrorPad:FTe,mod:OTe,moments:Zz,mul:ne,multiRNNCell:Idt,multinomial:Fdt,neg:ur,notEqual:Rw,oneHot:CT,ones:Dl,onesLike:Hl,outerProduct:Bdt,pad:qm,pad1d:Wdt,pad2d:jdt,pad3d:qdt,pad4d:Ydt,pool:RTe,pow:H0,prelu:Jz,print:YAe,prod:PTe,raggedGather:npt,raggedRange:ipt,raggedTensorToTensor:apt,rand:lpt,randomGamma:Npt,randomNormal:Dte,randomStandardNormal:Fpt,randomUniform:Hb,randomUniformInt:Ppt,range:Pw,real:_T,reciprocal:GTe,relu:id,relu6:Nte,reshape:ie,reverse:Ru,reverse1d:jpt,reverse2d:qpt,reverse3d:Ypt,reverse4d:Kpt,round:Ite,rsqrt:Mte,scalar:xt,selu:Fte,separableConv2d:Ote,setdiff1dAsync:ngt,sigmoid:ih,sign:YTe,sin:Rte,sinh:Pte,slice:sn,slice1d:t7,slice2d:Lte,slice3d:n7,slice4d:ST,softmax:r7,softplus:k_,spaceToBatchND:Qz,fft:i7,ifft:kT,irfft:Bte,rfft:s7,split:Jo,sqrt:qs,square:Gn,squaredDifference:zte,squeeze:qb,stack:Mp,step:E_,stridedSlice:XTe,sub:We,sum:qe,tan:KTe,tanh:Ow,tensor:vp,tensor1d:so,tensor2d:oA,tensor3d:ZTe,tensor4d:$gt,tensor5d:Cgt,tensor6d:_gt,tensorScatterUpdate:Egt,tile:mu,topk:QTe,truncatedNormal:Wte,unique:JTe,unsortedSegmentSum:Vte,unstack:q0,upperBound:Mgt,variable:e3e,where:Ws,whereAsync:t3e,zeros:di,zerosLike:en,op:ee,OP_SCOPE_SUFFIX:FAe,booleanMaskAsync:Rgt,transpose:Zt,norm:AI,movingAverage:Bgt,scatterND:Ugt,searchSorted:kte,sparseToDense:jgt,gatherND:qgt,dropout:n3e,enclosingPowerOfTwo:r3e,cosineWindow:jte,inTopKAsync:Kgt,image:Jf,linalg:f3e,losses:Mmt,spectral:Nmt,fused:i0t,signal:Imt,sparse:Fmt,string:Omt,train:Rg,enableProdMode:Hct,enableDebugMode:qct,disableDeprecationWarnings:Gct,deprecationWarn:Yct,disposeVariables:Xct,engine:dc,memory:T5,profile:Kct,tidy:ce,dispose:Bt,keep:Uc,time:Zct,setBackend:Qct,ready:Jct,getBackend:eft,removeBackend:tft,findBackend:nft,findBackendFactory:rft,registerBackend:hte,backend:XAe,setPlatform:ift,getKernel:mT,getGradient:_Y,getKernelsForBackend:k5,registerKernel:zz,registerGradient:yAe,unregisterKernel:Rut,unregisterGradient:Put,copyRegisteredKernels:Lut,Abs:bN,Acos:DC,Acosh:NC,Add:Ub,AddN:xN,All:OB,Any:RB,ArgMax:wN,ArgMin:$N,Asin:IC,Asinh:MC,Atan:FC,Atanh:OC,Atan2:RC,AvgPool:CN,AvgPoolGrad:PB,AvgPool3D:_N,AvgPool3DGrad:LB,BatchMatMul:SN,BatchToSpaceND:kN,Bincount:BB,BitwiseAnd:EN,BroadcastTo:mAe,BroadcastArgs:zB,Cast:PC,Ceil:LC,ClipByValue:BC,Complex:UB,ComplexAbs:AN,Concat:TN,Conv2D:DN,Conv2DBackpropFilter:WB,Conv2DBackpropInput:NN,Conv3D:IN,Conv3DBackpropFilterV2:VB,Conv3DBackpropInputV2:jB,Cos:zC,Cosh:UC,Cumprod:HB,Cumsum:MN,CropAndResize:qB,DenseBincount:GB,DepthToSpace:YB,DepthwiseConv2dNative:FN,DepthwiseConv2dNativeBackpropFilter:XB,DepthwiseConv2dNativeBackpropInput:KB,Diag:ZB,Dilation2D:ON,Dilation2DBackpropInput:C5,Dilation2DBackpropFilter:_5,Draw:QB,RealDiv:WC,Einsum:JB,Elu:VC,EluGrad:ez,Erf:jC,Equal:RN,Exp:HC,ExpandDims:PN,Expm1:qC,FFT:tz,Fill:nz,FlipLeftRight:rz,Floor:GC,FloorDiv:YC,FusedBatchNorm:LN,GatherV2:BN,GatherNd:iz,Greater:zN,GreaterEqual:XC,Identity:KC,IFFT:sz,Imag:az,IsFinite:ZC,IsInf:QC,IsNan:JC,LeakyRelu:UN,Less:WN,LessEqual:VN,LinSpace:oz,Log:e_,Log1p:t_,LogicalAnd:jN,LogicalNot:HN,LogicalOr:qN,LogicalXor:Dut,LogSoftmax:vAe,LowerBound:Nut,LRN:GN,LRNGrad:lz,MatrixBandPart:Iut,Max:YN,Maximum:n_,MaxPool:XN,MaxPoolGrad:uz,MaxPool3D:KN,MaxPool3DGrad:cz,MaxPoolWithArgmax:fz,Mean:ZN,Min:QN,Minimum:r_,MirrorPad:JN,Mod:i_,Multinomial:hz,Multiply:s_,Neg:eI,NotEqual:tI,NonMaxSuppressionV3:dz,NonMaxSuppressionV4:pz,NonMaxSuppressionV5:gz,OnesLike:nI,OneHot:rI,Pack:iI,PadV2:sI,Pool:Mut,Pow:a_,Prelu:aI,Prod:oI,RaggedGather:mz,RaggedRange:vz,RaggedTensorToTensor:yz,Range:bz,Real:xz,Reciprocal:o_,Relu:l_,Reshape:lI,ResizeNearestNeighbor:uI,ResizeNearestNeighborGrad:wz,ResizeBilinear:cI,ResizeBilinearGrad:$z,Relu6:u_,Reverse:fI,Round:c_,Rsqrt:f_,ScatterNd:Cz,TensorScatterUpdate:_z,SearchSorted:Sz,Select:hI,Selu:h_,Slice:dI,Sin:d_,Sinh:p_,Sign:g_,Sigmoid:m_,Softplus:v_,Sqrt:y_,Sum:pI,SpaceToBatchND:gI,SplitV:mI,Softmax:vI,SparseFillEmptyRows:kz,SparseReshape:Ez,SparseSegmentMean:Az,SparseSegmentSum:Tz,SparseToDense:Dz,SquaredDifference:b_,Square:Nz,StaticRegexReplace:yI,StridedSlice:Iz,StringNGrams:Mz,StringSplit:Fz,StringToHashBucketFast:Oz,Sub:x_,Tan:w_,Tanh:$_,Tile:C_,TopK:Rz,Transform:Pz,Transpose:K1,Unique:Lz,Unpack:bI,UnsortedSegmentSum:xI,UpperBound:Fut,ZerosLike:wI,Step:__,FromPixels:S5,RotateWithOffset:Bz,_FusedMatMul:hT,FusedConv2D:dT,FusedDepthwiseConv2D:pT,version_core:$vt,browser:mvt,io:rvt,math:avt,serialization:Lmt,test_util:Ept,util:Gut,backend_util:J3e,broadcast_util:yht,tensor_util:act,slice_util:E3e,gather_util:vvt,scatter_util:Sgt,device_util:fct,kernel_impls:Evt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eDe={kernelName:bN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,E_(Oe(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tvt={kernelName:DC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=Gn(Oe(n,"float32")),i=qs(We(xt(1),r));return ur(Qe(e,i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dvt={kernelName:NC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=qs(We(Gn(Oe(n,"float32")),1));return Qe(e,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nvt={kernelName:Ub,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{let o=e;const l=ui(n.shape,i);return l.length>0&&(o=qe(o,l)),ie(o,n.shape)},b:()=>{let o=e;const l=ui(r.shape,i);return l.length>0&&(o=qe(o,l)),ie(o,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ivt={kernelName:xN,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach((r,i)=>{n[i]=()=>e.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mvt={kernelName:wN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>en(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fvt={kernelName:$N,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>en(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ovt={kernelName:IC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,qs(We(xt(1),Gn(Oe(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rvt={kernelName:MC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=qs(ke(xt(1),Gn(Oe(n,"float32"))));return Qe(e,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pvt={kernelName:RC,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{const o=ke(Gn(n),Gn(r));let l=ne(e,Qe(r,o));const u=ui(n.shape,i);return u.length>0&&(l=qe(l,u)),ie(l,n.shape)},b:()=>{const o=ke(Gn(n),Gn(r));let l=ur(ne(e,Qe(n,o)));const u=ui(r.shape,i);return u.length>0&&(l=qe(l,u)),ie(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lvt={kernelName:FC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,ke(Gn(Oe(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bvt={kernelName:OC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,We(xt(1),Gn(Oe(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zvt(e,t,n,r,i,s){const a=U(e,"dy","avgPool3dGrad"),o=U(t,"input","avgPool3dGrad");let l=a,u=o,c=!1;o.rank===4&&(c=!0,l=ie(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),u=ie(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),B(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),B(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),La("avgPool3dGrad",i,s);const f={dy:l,input:u},h={filterSize:n,strides:r,pad:i,dimRoundingMode:s},d=J.runKernel(LB,f,h);return c?ie(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Uvt=ee({avgPool3dGrad_:zvt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wvt={kernelName:_N,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:s,pad:a,dimRoundingMode:o}=n;return{x:()=>Uvt(e,r,i,s,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vvt(e,t,n,r,i){const s=U(e,"dy","avgPoolGrad"),a=U(t,"input","avgPoolGrad");B(a.rank===s.rank,()=>`Rank of input (${a.rank}) does not match rank of dy (${s.rank})`);let o=a,l=s,u=!1;a.rank===3&&(u=!0,o=ie(a,[1,a.shape[0],a.shape[1],a.shape[2]]),l=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]])),B(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),B(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const c={dy:l,input:o},f={filterSize:n,strides:r,pad:i},h=J.runKernel(PB,c,f);return u?ie(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const jvt=ee({avgPoolGrad_:Vvt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hvt={kernelName:CN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:s,pad:a}=n;return{x:()=>jvt(e,r,i,s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qvt={kernelName:SN,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[r,i]=t,{transposeA:s,transposeB:a}=n;return!s&&!a?{a:()=>Pt(e,i,!1,!0),b:()=>Pt(r,e,!0,!1)}:!s&&a?{a:()=>Pt(e,i,!1,!1),b:()=>Pt(e,r,!0,!1)}:s&&!a?{a:()=>Pt(i,e,!1,!0),b:()=>Pt(r,e,!1,!1)}:{a:()=>Pt(i,e,!0,!0),b:()=>Pt(e,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gvt={kernelName:kN,gradFunc:(e,t,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>Qz(e,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yvt={kernelName:mAe,gradFunc:(e,t,n)=>{const r=n,i=r.inputShape,s=r.shape,a=Array.from(s);for(let l=i.length-1;l>=0;l--)if(i[l]===s[l])a[l]=1;else if(i[l]!==1)throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${s}].`);const o=[];for(let l=0;l<a.length;l++)a[l]>1&&o.push(l);return{x:()=>qe(e,o,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xvt={kernelName:PC,gradFunc:e=>({x:()=>e.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kvt={kernelName:LC,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zvt={kernelName:BC,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{clipValueMin:i,clipValueMax:s}=n;return{x:()=>Ws(Fh(Hm(r,i),Vb(r,s)),e,en(e))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qvt={kernelName:AN,inputsToSave:["x"],gradFunc:eDe.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jvt={kernelName:TN,saveAllInputs:!0,gradFunc:(e,t,n)=>{const r=t.map(l=>l.shape),{axis:i}=n,s=Ot(i,t[0].shape)[0],a=r.map(l=>l[s]);return Jo(e,a,s).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e1t={kernelName:DN,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{dilations:s,strides:a,pad:o,dataFormat:l}=n;return B(V0(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>vte(r.shape,e,i,a,o,l),filter:()=>Hte(r,e,i.shape,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t1t={kernelName:NN,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{strides:s,pad:a,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>j0(e,i,s,a,o,1,l),filter:()=>Hte(e,r,i.shape,s,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n1t(e,t,n,r,i){let s=e;e.rank===4&&(s=ie(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let a=t;a.rank===4&&(a=ie(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),B(s.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),B(a.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${a.shape}.`),B(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),B(s.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${n[3]}.`),B(a.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${a.shape[4]}) must match output depth for filter (${n[4]}).`);const o={x:s,dy:a},l={strides:r,pad:i,filterShape:n};return J.runKernel(VB,o,l)}const r1t=ee({conv3DBackpropFilter_:n1t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i1t={kernelName:IN,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:s}=n;B(V0(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[a,o]=t;return{x:()=>gTe(a.shape,e,o,i,s),filter:()=>r1t(a,e,o.shape,i,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s1t={kernelName:zC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(ur(Rte(Oe(n,"float32"))),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a1t={kernelName:UC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(Pte(Oe(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o1t={kernelName:MN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i,exclusive:s,reverse:a}=n;return{x:()=>{const o=Fr([i],r.rank);let l=xte(e,i,s,!a);return o!=null&&(l=Zt(l,o)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l1t={kernelName:FN,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:s,dimRoundingMode:a}=n,o=r==null?[1,1]:r;B(V0(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,u]=t;return B(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),B(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),B(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),B(ms(i,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${o}'.`),La("depthwiseConv2d",s,a),{x:()=>a3e(l.shape,e,u,i,s,o,a),filter:()=>s3e(l,e,u.shape,i,s,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u1t={kernelName:ON,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,s={x:r,filter:i,dy:e},a={x:r,filter:i,dy:e};return{x:()=>J.runKernel(C5,s,n),filter:()=>J.runKernel(_5,a,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c1t={kernelName:VC,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,r={dy:e,y:n};return{x:()=>J.runKernel(ez,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f1t={kernelName:jC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=ne(Vl(ur(Gn(n))),2/Math.sqrt(Math.PI));return{x:()=>ne(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h1t={kernelName:HC,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d1t={kernelName:PN,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>ie(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p1t={kernelName:qC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,Vl(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g1t={kernelName:GC,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m1t={kernelName:YC,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{const o=Qe(e,Oe(r,"float32")),l=ui(n.shape,i);return l.length>0?ie(qe(o,l),n.shape):o},b:()=>{let o=ne(e,Oe(n,"float32"));const l=ui(r.shape,i);l.length>0&&(o=ie(qe(o,l),r.shape));const u=Gn(r);return ur(Qe(o,Oe(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v1t={kernelName:LN,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:r}=n,[i,s,a,o]=t,l=o==null?xt(1):o,u=ui(s.shape,i.shape),c=[];if(s.rank===1){for(let x=0;x<i.shape.length-1;++x)c.push(i.shape[x]);c.push(1)}const f=We(i,s),h=ne(e,l),d=Mte(ke(a,xt(r))),p=ne(ne(ne(d,d),d),xt(-.5));return{x:()=>s.rank===1?ie(ne(ne(e,mu(ie(d,[1,1,1,s.shape[0]]),c)),l),i.shape):ie(ne(ne(e,d),l),i.shape),mean:()=>{let x=ne(ne(d,xt(-1)),h);return s.rank===1&&(x=qe(x,u)),ie(x,s.shape)},variance:()=>{let x=ne(ne(p,f),h);return s.rank===1&&(x=qe(x,u)),ie(x,s.shape)},scale:()=>{const x=ne(f,d);let w=ne(e,x);return s.rank===1&&(w=qe(w,u)),ie(w,s.shape)},offset:()=>{let x=e;return s.rank===1&&(x=qe(x,u)),ie(x,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y1t={kernelName:BN,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[r,i]=t,{axis:s}=n,a=Ot(s,r.shape)[0];return{x:()=>{const l=r.shape,u=i.size,c=l.slice(0,a),f=c.length,h=l.slice(s,l.length).slice(1),d=h.length,p=Ege(0,f),g=Ege(f+1,f+1+d),m=Age([c,[u],h]),v=ie(e,m),y=ie(i,[u]),b=Age([[f],p,g]),x=Zt(v,b);let w=Vte(x,y,r.shape[a]);const C=jm(b);return w=Zt(w,C),w},indices:()=>i}}};function Ege(e,t){const n=[];for(let r=e;r<t;++r)n.push(r);return n}function Age(e){const t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b1t={kernelName:XC,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>en(n),b:()=>en(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x1t={kernelName:KC,gradFunc:e=>({x:()=>Oe(e,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w1t={kernelName:ZC,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $1t={kernelName:QC,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C1t={kernelName:JC,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _1t={kernelName:UN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{alpha:i}=n,s=yl(r,0);return{x:()=>Ws(s,e,ne(e,i))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S1t={kernelName:t_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,ke(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k1t={kernelName:e_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,Oe(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E1t={kernelName:vAe,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;return{logits:()=>{const a=Vl(r);return We(e,ne(qe(e,i,!0),a))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A1t(e,t,n,r=5,i=1,s=1,a=.5){const o={x:e,y:t,dy:n},l={depthRadius:r,bias:i,alpha:s,beta:a};return J.runKernel(lz,o,l)}const T1t=ee({localResponseNormalizationBackprop_:A1t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D1t={kernelName:GN,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{depthRadius:s,bias:a,alpha:o,beta:l}=n;return{x:()=>T1t(r,i,e,s,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tDe(e,t,n,r){return t.rank<n.rank&&(t=ie(t,Zr(t.shape,r))),e.rank<n.rank&&(e=ie(e,Zr(e.shape,r))),{x:()=>ne(e,Oe(Kc(n,t),e.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tge={kernelName:YN,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{reductionIndices:i}=r,s=t[0],a=t[1],o=Ot(i,s.shape),l=tDe(e,a,s,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N1t={kernelName:n_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>ne(e,Oe(Hm(n,r),"float32")),b:()=>ne(e,Oe($T(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I1t(e,t,n,r,i,s,a){const o=U(e,"dy","maxPool3dGrad"),l=U(t,"input","maxPool3dGrad"),u=U(n,"output","maxPool3dGrad");let c=o,f=l,h=u,d=!1;l.rank===4&&(d=!0,c=ie(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),f=ie(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=ie(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),B(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),B(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),B(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),La("maxPool3dGrad",s,a);const p={dy:c,input:f,output:h},g={filterSize:r,strides:i,pad:s,dimRoundingMode:a},m=J.runKernel(cz,p,g);return d?ie(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const M1t=ee({maxPool3dGrad_:I1t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F1t={kernelName:KN,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=n;return{x:()=>M1t(e,r,i,s,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O1t(e,t,n,r,i,s,a){const o=U(e,"dy","maxPoolGrad"),l=U(t,"input","maxPoolGrad"),u=U(n,"output","maxPoolGrad");B(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),B(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),B(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),La("maxPoolGrad",s,a);const c={dy:o,input:l,output:u},f={filterSize:r,strides:i,pad:s,dimRoundingMode:a};return J.runKernel(uz,c,f)}const R1t=ee({maxPoolGrad_:O1t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P1t={kernelName:XN,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:s,strides:a,pad:o}=n;return{x:()=>R1t(e,r,i,s,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L1t={kernelName:ZN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n,s=Ot(i,r.shape),o=Li(r.shape,s)[1],l=de(o);return{x:()=>{const c=r.shape.slice();s.forEach(d=>{c[d]=1});const f=ie(e,c);return Qe(ne(f,Dl(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B1t={kernelName:QN,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{axis:i}=r,[s,a]=t,o=Ot(i,s.shape),l=tDe(e,a,s,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z1t={kernelName:r_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>ne(e,Oe(Vb(n,r),"float32")),b:()=>ne(e,Oe(yl(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U1t={kernelName:JN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,s=i.map(a=>a[0]);return{x:()=>sn(e,s,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W1t={kernelName:i_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{const o=ui(n.shape,i);return o.length>0?ie(qe(e,o),n.shape):e},b:()=>{const o=ne(e,ur(TI(Qe(n,r)))),l=ui(r.shape,i);return l.length>0?ie(qe(o,l),r.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V1t={kernelName:s_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{const o=ne(e,Oe(r,"float32")),l=ui(n.shape,i);return l.length>0?ie(qe(o,l),n.shape):o},b:()=>{const o=ne(e,Oe(n,"float32")),l=ui(r.shape,i);return l.length>0?ie(qe(o,l),r.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j1t={kernelName:eI,gradFunc:e=>({x:()=>ur(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H1t={kernelName:rI,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>di(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q1t={kernelName:nI,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G1t={kernelName:iI,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:r}=n;return q0(e,r).map(s=>()=>s)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dge={kernelName:sI,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,s=i.map(a=>a[0]);return{x:()=>sn(e,s,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y1t={kernelName:a_,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,r,i]=t,s=n,a=r,o=Ct(s.shape,a.shape);return{a:()=>{const c=Oe(a,"float32");let f=ne(e,ne(c,H0(s,We(c,xt(1)))));const h=ui(s.shape,o);return h.length>0&&(f=qe(f,h)),ie(f,s.shape)},b:()=>{const c=yl(s,0),f=Ws(c,jl(s),en(s));let h=ne(e,ne(i,f));const d=ui(a.shape,o);return d.length>0&&(h=qe(h,d)),ie(h,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X1t={kernelName:aI,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,r]=t,i=yl(n,0);return{x:()=>Ws(i,e,ne(e,r)),alpha:()=>{let s=Ws(i,en(e),ne(e,n));const a=ui(r.shape,e.shape);return a.length>0&&(s=qe(s,a)),ie(s,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K1t(e,t,n){const r=e.shape.slice();r[n]=1;const i=ie(t,r),s=N5(e,n,!0,!1),a=N5(e,n,!0,!0),o=ne(s,a);return ne(i,o)}function Z1t(e,t,n){const r=e.shape.length,i=r-n.length,s=Fr(n,r);let a=e;s!=null&&(a=Zt(e,s));const o=a.shape.slice(),u=o.splice(r-n.length,n.length).reduce((h,d)=>h*d,1);o.push(u);const c=a.reshape(o);let f=K1t(c,t,i);if(f=f.reshape(a.shape),s!=null){const h=jm(s);f=Zt(f,h)}return f}const Q1t={kernelName:oI,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;let s=[];return i==null?s=r.shape.map((a,o)=>o):typeof i=="number"?s=[i]:s=i,{x:()=>Z1t(r,e,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J1t={kernelName:WC,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{const o=Qe(e,Oe(r,"float32")),l=ui(n.shape,i);return l.length>0?ie(qe(o,l),n.shape):o},b:()=>{let o=ne(e,Oe(n,"float32"));const l=ui(r.shape,i);l.length>0&&(o=ie(qe(o,l),r.shape));const u=Gn(r);return ur(Qe(o,Oe(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eyt={kernelName:o_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,ur(Gn(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tyt={kernelName:u_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=ne(Vb(n,6),E_(n));return{x:()=>ne(e,Oe(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nyt={kernelName:l_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,Oe(E_(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ryt={kernelName:lI,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ie(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iyt={kernelName:cI,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>J.runKernel($z,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const syt={kernelName:uI,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>J.runKernel(wz,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ayt={kernelName:fI,gradFunc:(e,t,n)=>{const{dims:r}=n,i=Ot(r,e.shape);return{x:()=>Ru(e,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oyt={kernelName:c_,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lyt={kernelName:f_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ur(Qe(e,ne(H0(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uyt={kernelName:hI,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>Oe(en(n),"float32"),t:()=>ne(e,Oe(n,e.dtype)),e:()=>ne(e,Oe(Xz(n),e.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cyt={kernelName:h_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=yl(n,xt(0)),i=xt(b7),s=xt(x7),a=ne(e,s),o=ne(ne(e,i),Vl(Oe(n,"float32")));return Ws(r,a,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fyt={kernelName:m_,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,ne(n,We(xt(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hyt={kernelName:g_,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dyt={kernelName:d_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(jz(Oe(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pyt={kernelName:p_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(bte(Oe(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gyt={kernelName:dI,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{begin:i,size:s}=n,a=r.shape,[o,l]=v7(r,i,s),u=[];for(let c=0;c<e.rank;c++)u.push([o[c],a[c]-o[c]-l[c]]);return{x:()=>qm(e,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const myt={kernelName:vI,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{dim:i}=n,s=!0,a=ne(e,r);return{logits:()=>We(a,ne(qe(a,[i],s),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vyt={kernelName:v_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,ih(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nge={kernelName:gI,gradFunc:(e,t,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>Vz(e,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ige={kernelName:mI,gradFunc:(e,t,n)=>{const{axis:r}=n;return{x:()=>Di(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yyt={kernelName:y_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,ne(qs(Oe(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const byt={kernelName:Nz,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,ne(Oe(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xyt={kernelName:b_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=xt(2);return{a:()=>ne(e,ne(i,We(n,r))),b:()=>ne(e,ne(i,We(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wyt={kernelName:__,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $yt={kernelName:x_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{let o=e;const l=ui(n.shape,i);return l.length>0&&(o=qe(o,l)),ie(o,n.shape)},b:()=>{let o=e;const l=ui(r.shape,i);return l.length>0&&(o=qe(o,l)),ie(ur(o),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cyt={kernelName:pI,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,i=r.shape.slice(),{axis:s}=n;Ot(s,r.shape).forEach(u=>{i[u]=1});const o=ie(e,i),l=ne(o,Dl(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _yt={kernelName:w_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,Gn(jz(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Syt={kernelName:$_,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(We(xt(1),Gn(n)),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kyt={kernelName:C_,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{reps:i}=n;return{x:()=>{let a=en(r);if(r.rank===1)for(let o=0;o<i[0];++o)a=ke(a,sn(e,[o*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let o=0;o<i[0];++o)for(let l=0;l<i[1];++l)a=ke(a,sn(e,[o*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let o=0;o<i[0];++o)for(let l=0;l<i[1];++l)for(let u=0;u<i[2];++u)a=ke(a,sn(e,[o*r.shape[0],l*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let o=0;o<i[0];++o)for(let l=0;l<i[1];++l)for(let u=0;u<i[2];++u)for(let c=0;c<i[3];++c)a=ke(a,sn(e,[o*r.shape[0],l*r.shape[1],u*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eyt={kernelName:K1,gradFunc:(e,t,n)=>{const r=n,{perm:i}=r,s=jm(i);return{x:()=>Zt(e,s)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ayt={kernelName:bI,gradFunc:(e,t,n)=>{const r=n,{axis:i}=r;return{value:()=>Mp(e,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tyt={kernelName:xI,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Dyt(e,n)}}};function Dyt(e,t){const n=ig(t,en(t)),r=DI(e,n);let i=Hm(t,xt(0,"int32"));const s=r.rank-i.rank;for(let o=0;o<s;++o)i=Ga(i,o+1);i=Fh(i,Dl(r.shape,"bool"));const a=en(r);return Ws(i,r,a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nyt={kernelName:wI,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iyt=[eDe,Tvt,Dvt,Nvt,Ivt,Mvt,Fvt,Ovt,Rvt,Pvt,Lvt,Bvt,Wvt,Hvt,qvt,Gvt,Yvt,Xvt,Kvt,Zvt,Qvt,Jvt,t1t,e1t,i1t,s1t,a1t,o1t,l1t,u1t,J1t,c1t,f1t,h1t,d1t,p1t,m1t,g1t,v1t,y1t,b1t,x1t,w1t,$1t,C1t,_1t,S1t,k1t,E1t,D1t,Tge,Tge,N1t,F1t,P1t,L1t,B1t,z1t,U1t,W1t,V1t,j1t,H1t,q1t,G1t,Dge,Dge,Y1t,X1t,Q1t,eyt,tyt,nyt,ryt,iyt,syt,ayt,oyt,lyt,uyt,cyt,fyt,hyt,dyt,pyt,gyt,myt,vyt,Nge,Nge,Ige,Ige,yyt,xyt,byt,wyt,$yt,Cyt,_yt,Syt,kyt,Eyt,Ayt,Tyt,Nyt];for(const e of Iyt)yAe(e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.abs=function(){return this.throwIfDisposed(),hi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.acos=function(){return this.throwIfDisposed(),KAe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.acosh=function(){return this.throwIfDisposed(),ZAe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.add=function(e){return this.throwIfDisposed(),ke(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.all=function(e,t){return this.throwIfDisposed(),pte(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.any=function(e,t){return this.throwIfDisposed(),D5(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.argMax=function(e){return this.throwIfDisposed(),Fw(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.argMin=function(e){return this.throwIfDisposed(),QAe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.asScalar=function(){return this.throwIfDisposed(),B(this.size===1,()=>"The array must have only 1 element."),ie(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.asType=function(e){return this.throwIfDisposed(),Oe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.as1D=function(){return this.throwIfDisposed(),ie(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.as2D=function(e,t){return this.throwIfDisposed(),ie(this,[e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),ie(this,[e,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),ie(this,[e,t,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.as5D=function(e,t,n,r,i){return this.throwIfDisposed(),ie(this,[e,t,n,r,i])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.asin=function(){return this.throwIfDisposed(),JAe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.asinh=function(){return this.throwIfDisposed(),eTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.atan=function(){return this.throwIfDisposed(),tTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.atan2=function(e){return this.throwIfDisposed(),nTe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.atanh=function(){return this.throwIfDisposed(),rTe(this)};ge().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),Wz(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Vz(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.batchNorm=function(e,t,n,r,i){return this.throwIfDisposed(),SI(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.broadcastTo=function(e){return this.throwIfDisposed(),X2(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.cast=function(e){return this.throwIfDisposed(),Oe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.ceil=function(){return this.throwIfDisposed(),uTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),sl(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof On&&(e=[e]),Di([this,...e],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.conv1d=function(e,t,n,r,i,s){return this.throwIfDisposed(),mte(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.conv2dTranspose=function(e,t,n,r,i){return this.throwIfDisposed(),yte(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.conv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),j0(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.cos=function(){return this.throwIfDisposed(),jz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.cosh=function(){return this.throwIfDisposed(),bte(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),N5(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),xte(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),vTe(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.depthwiseConv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),kI(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.dilation2d=function(e,t,n,r,i){return this.throwIfDisposed(),yTe(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.divNoNan=function(e){return this.throwIfDisposed(),bTe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.div=function(e){return this.throwIfDisposed(),Qe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.dot=function(e){return this.throwIfDisposed(),xTe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.elu=function(){return this.throwIfDisposed(),EI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.equal=function(e){return this.throwIfDisposed(),Kc(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.erf=function(){return this.throwIfDisposed(),wTe(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),_Te(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.exp=function(){return this.throwIfDisposed(),Vl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.expandDims=function(e){return this.throwIfDisposed(),Ga(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.expm1=function(){return this.throwIfDisposed(),STe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.fft=function(){return this.throwIfDisposed(),i7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.flatten=function(){return this.throwIfDisposed(),ie(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.floor=function(){return this.throwIfDisposed(),TI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.floorDiv=function(e){return this.throwIfDisposed(),dte(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.gather=function(e,t,n){return this.throwIfDisposed(),DI(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.greaterEqual=function(e){return this.throwIfDisposed(),Hm(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.greater=function(e){return this.throwIfDisposed(),yl(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.ifft=function(){return this.throwIfDisposed(),kT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.irfft=function(){return this.throwIfDisposed(),Bte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.isFinite=function(){return this.throwIfDisposed(),kTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.isInf=function(){return this.throwIfDisposed(),ETe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.isNaN=function(){return this.throwIfDisposed(),ATe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.leakyRelu=function(e){return this.throwIfDisposed(),qz(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.lessEqual=function(e){return this.throwIfDisposed(),Vb(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.less=function(e){return this.throwIfDisposed(),$T(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),TTe(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logSigmoid=function(){return this.throwIfDisposed(),NTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logSoftmax=function(e){return this.throwIfDisposed(),Cte(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),_te(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.log=function(){return this.throwIfDisposed(),jl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.log1p=function(){return this.throwIfDisposed(),Gz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logicalAnd=function(e){return this.throwIfDisposed(),Fh(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logicalNot=function(){return this.throwIfDisposed(),Xz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logicalOr=function(e){return this.throwIfDisposed(),Ste(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logicalXor=function(e){return this.throwIfDisposed(),ITe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Pt(this,e,t,n)};ge().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Kz(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.max=function(e,t){return this.throwIfDisposed(),Du(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.maximum=function(e){return this.throwIfDisposed(),ig(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.mean=function(e,t){return this.throwIfDisposed(),Lr(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.min=function(e,t){return this.throwIfDisposed(),wT(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.minimum=function(e){return this.throwIfDisposed(),Py(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),FTe(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.mod=function(e){return this.throwIfDisposed(),OTe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.mul=function(e){return this.throwIfDisposed(),ne(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.neg=function(){return this.throwIfDisposed(),ur(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.norm=function(e,t,n){return this.throwIfDisposed(),AI(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.notEqual=function(e){return this.throwIfDisposed(),Rw(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),CT(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.onesLike=function(){return this.throwIfDisposed(),Hl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.pad=function(e,t){return this.throwIfDisposed(),qm(this,e,t)};ge().prototype.pool=function(e,t,n,r,i,s){return this.throwIfDisposed(),RTe(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.pow=function(e){return this.throwIfDisposed(),H0(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.prelu=function(e){return this.throwIfDisposed(),Jz(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.prod=function(e,t){return this.throwIfDisposed(),PTe(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.reciprocal=function(){return this.throwIfDisposed(),GTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.relu=function(){return this.throwIfDisposed(),id(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.relu6=function(){return this.throwIfDisposed(),Nte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.reshapeAs=function(e){return this.throwIfDisposed(),ie(this,e.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.reshape=function(e){return this.throwIfDisposed(),ie(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),u3e(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),c3e(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.reverse=function(e){return this.throwIfDisposed(),Ru(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.rfft=function(){return this.throwIfDisposed(),s7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.round=function(){return this.throwIfDisposed(),Ite(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.rsqrt=function(){return this.throwIfDisposed(),Mte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.selu=function(){return this.throwIfDisposed(),Fte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.separableConv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),Ote(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sigmoid=function(){return this.throwIfDisposed(),ih(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sign=function(){return this.throwIfDisposed(),YTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sin=function(){return this.throwIfDisposed(),Rte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sinh=function(){return this.throwIfDisposed(),Pte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.slice=function(e,t){return this.throwIfDisposed(),sn(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.softmax=function(e){return this.throwIfDisposed(),r7(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.softplus=function(){return this.throwIfDisposed(),k_(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Qz(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.split=function(e,t){return this.throwIfDisposed(),Jo(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sqrt=function(){return this.throwIfDisposed(),qs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.square=function(){return this.throwIfDisposed(),Gn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.squaredDifference=function(e){return this.throwIfDisposed(),zte(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.squeeze=function(e){return this.throwIfDisposed(),qb(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof On?[this,e]:[this,...e];return Mp(n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.step=function(e){return this.throwIfDisposed(),E_(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.stridedSlice=function(e,t,n,r,i,s,a,o){return this.throwIfDisposed(),XTe(this,e,t,n,r,i,s,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sub=function(e){return this.throwIfDisposed(),We(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sum=function(e,t){return this.throwIfDisposed(),qe(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.tan=function(){return this.throwIfDisposed(),KTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.tanh=function(){return this.throwIfDisposed(),Ow(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.tile=function(e){return this.throwIfDisposed(),mu(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.toBool=function(){return this.throwIfDisposed(),Oe(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.toFloat=function(){return this.throwIfDisposed(),Oe(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.toInt=function(){return this.throwIfDisposed(),Oe(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.topk=function(e,t){return this.throwIfDisposed(),QTe(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.transpose=function(e){return this.throwIfDisposed(),Zt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.unique=function(e){return this.throwIfDisposed(),JTe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Vte(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.unstack=function(e){return this.throwIfDisposed(),q0(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.where=function(e,t){return this.throwIfDisposed(),Ws(e,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.zerosLike=function(){return this.throwIfDisposed(),en(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Of extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Of.prototype)}}class vu extends Error{constructor(t){super(t),Object.setPrototypeOf(this,vu.prototype)}}class re extends Error{constructor(t){super(t),Object.setPrototypeOf(this,re.prototype)}}class Tt extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Tt.prototype)}}class kne extends Error{constructor(t){super(t),Object.setPrototypeOf(this,kne.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class nDe{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let n;return this.cache.has(t)&&(n=this.cache.get(t),this.cache.delete(t),this.cache.set(t,n)),n}put(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(t,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let n=0;n<this.maxEntries-t;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function By(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}else{const n=new Array(t);return n.fill(e),n}}function Rf(e,t){if(!e)throw new kne(t)}function Mge(e,t){let n=0;for(const r of e)r===t&&n++;return n}function Ya(e){return e.length===1?e[0]:e}function sr(e){return Array.isArray(e)?e:[e]}function Bd(e){const n=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function i1(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}let ru={};function Ene(e){if(e==null)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function GY(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>GY(t));else{const t=Object.keys(e);for(const n of t){const r=e[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?e[n]=r.value:GY(r))}}}function FI(e,t={},n={},r="object",i=!1){if(typeof e=="string"){const s=e;let a;if(s in n)a=n[s];else if(s in ru)a=ru[s];else if(a=t[s],a==null)throw new re(`Unknown ${r}: ${e}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}else{const s=e;if(s.className==null||s.config==null)throw new re(`${r}: Improper config format: ${JSON.stringify(s)}.
'className' and 'config' must set.`);const a=s.className;let o,l;if(a in n?[o,l]=n[a]:a in ru?[o,l]=ru.className:a in t&&([o,l]=t[a]),o==null)throw new re(`Unknown ${r}: ${a}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const d of Object.keys(ru))u[d]=ru[d];for(const d of Object.keys(n))u[d]=n[d];const c=s.config;c.customObjects=u;const f=Object.assign({},ru);for(const d of Object.keys(n))ru[d]=n[d];GY(s.config);const h=l(o,s.config,n,i);return ru=Object.assign({},f),h}else{const u=Object.assign({},ru);for(const f of Object.keys(n))ru[f]=n[f];const c=new o(s.config);return ru=Object.assign({},u),c}}}function Myt(e,t){return e<t?-1:e>t?1:0}function sO(e,t){return-1*Myt(e,t)}function y0(e){if(e==null)return e;const t=[];for(const n of e)t.indexOf(n)===-1&&t.push(n);return t}function Fyt(e){if(e==null)throw new re(`Invalid value in obj: ${JSON.stringify(e)}`);for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function Yb(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new re(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function Ane(e,t,n=0,r=1/0){return Rf(n>=0),Rf(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(i=>typeof i===t)}function Ai(e,t){Array.isArray(e)?(B(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((n,r)=>Ai(n,`element ${r+1} of ${t}`))):B(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${rDe(e)}.`)}function rDe(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>rDe(t)).join(",")+"]":typeof e=="string"?`"${e}"`:`${e}`}function Oyt(e,t,n){let r=n!=null?n():ca(),i;return(...a)=>{const o=n!=null?n():ca();return o-r<t||(r=o,i=e(...a)),i}}function iDe(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Ryt=0;function sDe(){return Ryt++}const aO={};function w7(e=""){return e in aO||(aO[e]=0),aO[e]+=1,e+aO[e].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Pyt=["channelsFirst","channelsLast"],Lyt=["nearest","bilinear"],Byt=["valid","same","causal"],zyt=["max","avg"],Uyt=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const e2=new Map;function ei(e){Yb(Pyt,"DataFormat",e)}function Wyt(e){Yb(Lyt,"InterpolationFormat",e)}function Jl(e){Yb(Byt,"PaddingMode",e)}function aDe(e){Yb(zyt,"PoolMode",e)}const lA=[],Fge="/";function Z1(e,t){lA.push(e);try{const n=t();return lA.pop(),n}catch(n){throw lA.pop(),n}}function Vyt(){return lA.length===0?"":lA.join(Fge)+Fge}function oDe(e){if(!uDe(e))throw new Error("Not a valid tensor name: '"+e+"'");return Vyt()+e}function lDe(e){if(!uDe(e))throw new Error("Not a valid tensor name: '"+e+"'");e2.has(e)||e2.set(e,0);const t=e2.get(e);if(e2.set(e,e2.get(e)+1),t>0){const n=`${e}_${t}`;return e2.set(n,1),n}else return e}const jyt=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function uDe(e){return!!e.match(jyt)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Hyt(e){return e===parseInt(e.toString(),10)}function b0(e,t,n){t==null&&(t=0),n==null&&(n=e.length);let r=1;for(let i=t;i<n;++i)r*=e[i];return r}function Lw(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r<t&&(t=r)}return t}function G0(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r>t&&(t=r)}return t}function Zc(e,t){if(t<e)throw new re(`end (${t}) < begin (${e}) is forbidden.`);const n=[];for(let r=e;r<t;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let pj;function pi(){return pj==null&&(pj=XAe().epsilon()),pj}function Qc(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ah(e,t){return Oe(e,t)}function OI(e,t=-1){const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),ie(e,n)}function qyt(e,t){return ce(()=>{if(e.shape.length!==2)throw new re(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);const n=OI(e,1);return YY(n,[1,t,1])})}function Gyt(e){const t=[b0(e.shape)];return ie(e,t)}function Yyt(e){if(e.rank<=1)throw new re(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);const t=[e.shape[0],b0(e.shape,1)];return ie(e,t)}function Q1(e,t,n){return ce(()=>{switch(e.rank){case 1:return t7(e,t,n);case 2:return Lte(e,[t,0],[n,e.shape[1]]);case 3:return n7(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return ST(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return sn(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return sn(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new re(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function gj(e,t,n){return ce(()=>{switch(e.rank){case 1:return t7(e,t,n);case 2:return Lte(e,[0,t],[e.shape[0],n]);case 3:return n7(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return ST(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new re(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function oO(e,t,n,r){return ce(()=>{switch(e.rank){case 1:return t7(e,t,n);case 2:switch(r){case 1:return Q1(e,t,n);case 2:return gj(e,t,n);default:throw new re(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return Q1(e,t,n);case 2:return n7(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return gj(e,t,n);default:throw new re(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return Q1(e,t,n);case 2:return ST(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return ST(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return gj(e,t,n);default:throw new re(`The axis is not within the rank of the tensor ${r}`)}default:throw new re(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function Tne(e,t=-1){let n;return t<0&&(n=e[0].rank,n!==0?t=n:t=0),t===e[0].rank&&(t=-1),Di(e,t)}function Oge(e,t){switch(e.rank){case 1:return cTe([e,t]);case 2:return fTe([e,t],0);case 3:return hTe([e,t],0);case 4:return dTe([e,t],0);default:throw new re(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function YY(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new re(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return mu(e,t)}function $7(e,t=0,n=1,r,i){return Dte(e,t,n,r,i)}function oh(e,t,n,r){if(e.rank<2||t.rank<2)throw new Tt(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){const i=e.shape.slice(-1)[0],s=t.shape.slice(-2)[0];if(i!==s)throw new Tt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return WY({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?XY(e.rank,r,Qc()):null,activation:n});{const i=e.shape.slice(),s=i.pop();e=ie(e,[-1,s]);const a=t.shape.slice(),o=a.pop(),l=a.pop(),u=[...a,o],c=Array.from({length:t.rank},(p,g)=>g===0?t.rank-2:g<=t.rank-2?g-1:g);t=ie(Zt(t,c),[l,-1]);const f=[...i,...u];return ie(WY({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?XY(e.rank,r,Qc()):null,activation:n}),f)}}function cDe(e,t,n){return ce(()=>(Array.isArray(t)?t=so(t,"int32"):t=Oe(t,"int32"),DI(e,t,n)))}function RI(e){return ne(e,e)}function XY(e,t,n){const r=t.shape;if(t.rank!==1&&t.rank!==e)throw new re(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(n==="channelsFirst")return r.length===1?ie(t,[1,r[0],1,1,1]):ie(t,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?ie(t,[1,1,1,1,r[0]]):ie(t,[1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?ie(t,[1,r[0],1,1]):ie(t,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?ie(t,[1,1,1,r[0]]):ie(t,[1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?ie(t,[1,r[0],1]):ie(t,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?ie(t,[1,1,r[0]]):ie(t,[1].concat(r))}else if(e<3)return t;throw new re(`Unsupported input rank by biasAdd: ${t.rank}`)}function hf(e,t,n){return ce(()=>(n==null&&(n=Qc()),ei(n),ke(e,XY(e.rank,t,n))))}function Xyt(e,t=1){if(t!==1)throw new Tt(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return EI(e)}function Kyt(e){return ce(()=>Qe(e,ke(hi(e),1)))}function fDe(e,t,n,r){return ce(()=>n3e(e,t,n,r))}function Zyt(e){return ce(()=>{const t=ke(.5,ne(.2,e));return sl(t,0,1)})}function PI(e,t,n=!1){return n?e():t()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Qyt=["fanIn","fanOut","fanAvg"],Jyt=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ebt(e){Yb(Qyt,"FanMode",e)}function tbt(e){Yb(Jyt,"Distribution",e)}class Yu extends Gb{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class hDe extends Yu{apply(t,n){return di(t,n)}}hDe.className="Zeros";Ee(hDe);class Dne extends Yu{apply(t,n){return Dl(t,n)}}Dne.className="Ones";Ee(Dne);class dDe extends Yu{constructor(t){if(super(),typeof t!="object")throw new re(`Expected argument of type ConstantConfig but got ${t}`);if(t.value===void 0)throw new re(`config must have value set but got ${t}`);this.value=t.value}apply(t,n){return ce(()=>ne(xt(this.value),Dl(t,n)))}getConfig(){return{value:this.value}}}dDe.className="Constant";Ee(dDe);class pDe extends Yu{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,n){return Hb(t,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}pDe.className="RandomUniform";Ee(pDe);class gDe extends Yu{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Tt(`randomNormal does not support dType ${n}.`);return $7(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}gDe.className="RandomNormal";Ee(gDe);class mDe extends Yu{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Tt(`truncatedNormal does not support dType ${n}.`);return Wte(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}mDe.className="TruncatedNormal";Ee(mDe);class vDe extends Yu{constructor(t){super(),this.gain=t.gain!=null?t.gain:1}apply(t,n){return ce(()=>{if(t.length!==2||t[0]!==t[1])throw new re("Identity matrix initializer can only be used for 2D square matrices.");return ne(this.gain,$te(t[0]))})}getConfig(){return{gain:this.gain}}}vDe.className="Identity";Ee(vDe);function nbt(e,t="channelsLast"){let n,r;if(ei(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){const i=b0(e,2);n=e[1]*i,r=e[0]*i}else if(t==="channelsLast"){const i=b0(e,0,e.length-2);n=e[e.length-2]*i,r=e[e.length-1]*i}}else{const i=b0(e);n=Math.sqrt(i),r=Math.sqrt(i)}return[n,r]}class al extends Yu{constructor(t){if(super(),t.scale<0)throw new re(`scale must be a positive float. Got: ${t.scale}`);this.scale=t.scale==null?1:t.scale,this.mode=t.mode==null?"fanIn":t.mode,ebt(this.mode),this.distribution=t.distribution==null?"normal":t.distribution,tbt(this.distribution),this.seed=t.seed}apply(t,n){const r=nbt(t),i=r[0],s=r[1];let a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,i):this.mode==="fanOut"?a/=Math.max(1,s):a/=Math.max(1,(i+s)/2),this.distribution==="normal"){const o=Math.sqrt(a);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Tt(`${this.getClassName()} does not support dType ${n}.`);return Wte(t,0,o,n,this.seed)}else{const o=Math.sqrt(3*a);return Hb(t,-o,o,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}al.className="VarianceScaling";Ee(al);class Nne extends al{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return al.className}}Nne.className="GlorotUniform";Ee(Nne);class Ine extends al{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return al.className}}Ine.className="GlorotNormal";Ee(Ine);class Mne extends al{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return al.className}}Mne.className="HeNormal";Ee(Mne);class Fne extends al{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return al.className}}Fne.className="HeUniform";Ee(Fne);class One extends al{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return al.className}}One.className="LeCunNormal";Ee(One);class Rne extends al{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return al.className}}Rne.className="LeCunUniform";Ee(Rne);class yDe extends Yu{constructor(t){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=t.gain==null?this.DEFAULT_GAIN:t.gain,this.seed=t.seed}apply(t,n){return ce(()=>{if(t.length<2)throw new Tt("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=de(t.slice(0,-1)),i=t[t.length-1],s=r*i;s>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${s}) elements: Slowness may result.`);const a=[Math.max(i,r),Math.min(i,r)],o=$7(a,0,1,n,this.seed),l=f3e.qr(o,!1);let u=l[0];const f=l[1].flatten().stridedSlice([0],[Math.min(i,r)*Math.min(i,r)],[Math.min(i,r)+1]);return u=ne(u,f.sign()),r<i&&(u=u.transpose()),ne(xt(this.gain),u.reshape(t))})}getConfig(){return{gain:this.gain,seed:this.seed}}}yDe.className="Orthogonal";Ee(yDe);const Rge={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Pge(e,t={}){return FI(e,El.getMap().classNameMap,t,"initializer")}function Tr(e){return Ene(e)}function yr(e){if(typeof e=="string"){const t=e in Rge?Rge[e]:e;if(t==="GlorotNormal")return new Ine;if(t==="GlorotUniform")return new Nne;if(t==="HeNormal")return new Mne;if(t==="HeUniform")return new Fne;if(t==="LeCunNormal")return new One;if(t==="LeCunUniform")return new Rne;{const n={};return n.className=t,n.config={},Pge(n)}}else return e instanceof Yu?e:Pge(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function KY(e){return Array.isArray(e)&&Array.isArray(e[0])}function I5(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function vt(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new re(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function cn(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new re(`Expected exactly 1 Shape; got ${e.length}`)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function M5(e){let t=0;for(const n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((r,i)=>r*i);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Lge="Variable";class rbt{constructor(t,n="float32",r=Lge,i=!0,s=null){this.dtype=n==null?"float32":n,this.shape=t.shape,this.id=sDe(),r=r==null?Lge:r,this.originalName=oDe(r),this.name=lDe(this.originalName),this.trainable_=i,this.constraint=s,this.val=e3e(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),ibt(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function ibt(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function ZY(e){return e.map(t=>t.read())}function Pne(e){e.forEach(t=>{t[0].write(t[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gi{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class eh{constructor(t,n,r,i,s,a,o){this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=i,this.callArgs=s,this.outputTensorIndex=o,this.id=sDe(),a!=null&&(this.originalName=oDe(a),this.name=lDe(this.originalName)),this.rank=n.length}}let sbt=0;class C7{constructor(t,n){this.callArgs=n,this.id=sbt++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const r of t.inboundLayers)r!=null&&r.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const n of this.inboundLayers)n!=null?t.push(n.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let abt=0;class Vt extends Gb{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=abt++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=t.name;if(!n){const r=this.getClassName();n=Bd(r)+"_"+w7(r)}if(this.name=n,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let r;if(t.batchInputShape!=null)r=t.batchInputShape;else if(t.inputShape!=null){let s=null;t.batchSize!=null&&(s=t.batchSize),r=[s].concat(t.inputShape)}this.batchInputShape=r;let i=t.dtype;i==null&&(i=t.inputDType),i==null&&(i="float32"),this.dtype=i}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,n){return t.name+"_ib-"+n.toString()}getNodeAtIndex(t,n){if(this.inboundNodes.length===0)throw new vu(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=t)throw new re(`Asked to get ${n} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return Ya(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return Ya(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Of(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Of(`Layer ${this.name} is not connected, no input to return.`);return Ya(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Of(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Of(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Ya(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(n=>n.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=sr(t),this.inputSpec==null||this.inputSpec.length===0)return;const n=sr(this.inputSpec);if(t.length!==n.length)throw new re(`Layer ${this.name} expects ${n.length} inputs, but it received ${t.length} input tensors. Input received: ${t}`);for(let r=0;r<t.length;r++){const i=t[r],s=n[r];if(s==null)continue;const a=i.rank;if(s.ndim!=null&&a!==s.ndim)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${s.ndim}, found ndim=${a}`);if(s.maxNDim!=null&&a>s.maxNDim)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${s.maxNDim}, found ndim=${a}`);if(s.minNDim!=null&&a<s.minNDim)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${s.minNDim}, found ndim=${a}.`);if(s.dtype!=null&&i.dtype!==s.dtype)throw new re(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${s.dtype}, found dtype=${i.dtype}.`);if(s.axes){const o=i.shape;for(const l in s.axes){const u=Number(l),c=s.axes[l],f=u>=0?o[u]:o[o.length+u];if(c!=null&&[c,null].indexOf(f)===-1)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${c} but got shape ${o}.`)}}if(s.shape!=null)for(let o=0;o<s.shape.length;++o){const l=s.shape[o],u=i.shape[o];if(l!=null&&u!=null&&l!==u)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected shape=${s.shape}, found shape=${i.shape}.`)}}}call(t,n){return t}invokeCallHook(t,n){this._callHook!=null&&this._callHook(t,n)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,n){n=n||{},this.assertNotDisposed();const r=sr(t);let i=!0;for(const a of r)if(!(a instanceof eh)){i=!1;break}let s=!0;for(const a of r)if(a instanceof eh){s=!1;break}if(i===s)throw new re("Arguments to apply() must be all SymbolicTensors or all Tensors");return Z1(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const a=[];for(const o of sr(t))a.push(o.shape);this.build(Ya(a)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&s&&(this._refCount=1)}if(this.assertInputCompatibility(t),s){let a=this.call(t,n);const o=sr(a),l=[];for(let u of o)r.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(a=Ya(l),this.activityRegularizer!=null)throw new Tt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}else{const a=obt(t),o=this.computeOutputShape(a);let l;const u=lbt(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?a[0]:a),o!=null&&o.length>0&&Array.isArray(o[0])?l=o.map((c,f)=>new eh(u,c,this,sr(t),n,this.name,f)):l=new eh(u,o,this,sr(t),n,this.name),this.addInboundNode(t,l,null,null,a,o,n),this._refCount++,this.activityRegularizer!=null)throw new Tt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,i)=>{r!=null&&t[i]!=null&&t[i]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Of(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);t.indexOf(r)===-1&&t.push(r)}if(t.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new Of(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new vu(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return M5(this.weights)}build(t){this.built=!0}getWeights(t=!1){return ZY(t?this.trainableWeights:this.weights)}setWeights(t){ce(()=>{const n=this.weights;if(n.length!==t.length)throw new re(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${n.length} weights. Provided weights: ${t}...`);if(n.length===0)return;const r=[],i=ZY(n);for(let s=0;s<i.length;++s){const a=i[s],o=n[s],l=t[s];if(!Qt(a.shape,l.shape))throw new re(`Layer weight shape ${a.shape} not compatible with provided weight shape ${l.shape}`);r.push([o,l])}Pne(r)})}addWeight(t,n,r,i,s,a,o,l){if(this._addedWeightNames.indexOf(t)!==-1)throw new re(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(i=l!=null?l():yr("zeros"));const u=i.apply(n,r),c=new rbt(u,r,t,a,o);return u.dispose(),s!=null&&this.addLoss(()=>s.apply(c.read())),a==null&&(a=!0),a?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=sr(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}addInboundNode(t,n,r,i,s,a,o=null){const l=sr(t);n=sr(n),r=sr(r),i=sr(i),s=I5(s),a=I5(a);const u=[],c=[],f=[];for(const h of l)u.push(h.sourceLayer),c.push(h.nodeIndex),f.push(h.tensorIndex);new C7({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:f,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:i,inputShapes:s,outputShapes:a},o);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount===0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function obt(e){e=sr(e);const t=[];for(const n of e)t.push(n.shape);return Ya(t)}function lbt(e){return"float32"}function bDe(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{const r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const i=[];for(let s=0;s<r.inboundLayers.length;s++){const a=r.inputTensors[s],o=r.inboundLayers[s],l=r.nodeIndices[s],u=bDe(a,o,l);for(const c of u)i.indexOf(c)===-1&&i.push(c)}return i}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class LI extends Vt{constructor(t){if(super({dtype:t.dtype,name:t.name!=null?t.name:w7("input").toString()}),t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new re("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=t.batchInputShape;if(n==null){if(t.inputShape==null)throw new re("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new re("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=t.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const i=new eh(this.dtype,this.batchInputShape,this,[],{},this.name);i.nodeIndex=0,i.tensorIndex=0,new C7({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(t,n){throw new re(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}LI.className="InputLayer";Ee(LI);function xDe(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new re("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n==null&&(n="float32"),new LI({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ubt(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return Oe(t,e.dtype)}catch{throw new re(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}class Zg{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof Zg)for(const n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(const n of t)this.add(n.key,n.value)}}add(t,n,r){if(this.id2Value[t.id]==null)this.id2Value[t.id]=ubt(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r);else throw new re(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof eh){if(this.id2Value[t.id]==null)throw new re(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{const n=this.name2Id[t];if(n==null)throw new re(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof eh){if(this.id2Value[t.id]==null)throw new re(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{const n=this.name2Id[t];if(n==null)throw new re(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Bt(this.id2Mask)}}const F5=new nDe,O5=new nDe;function cbt(e){F5!=null&&F5.setMaxEntries(e),O5!=null&&O5.setMaxEntries(e)}function aE(e,t,n,r){const i=n==null?!1:n.training,s=Array.isArray(e),a=s?e:[e],o=a.map(p=>p.name),l=[],u=t.names();for(const p of o)u.indexOf(p)!==-1?l.push(t.getValue(p)):l.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const c=o.join(",")+"|"+t.names().sort().join(",");let f=F5.get(c),h;if(f==null){const p=fbt(a,t);f=p.sorted,h=p.recipientCounts,F5.put(c,f),O5.put(c,h)}h={},i||Object.assign(h,O5.get(c));const d=new Zg(t);for(let p=0;p<f.length;++p){if(r!=null){const k=T5().numTensors;k>r.maxNumTensors&&(r.maxNumTensors=k),k<r.minNumTensors&&(r.minNumTensors=k)}const g=f[p],m=g.sourceLayer;if(m instanceof LI)continue;const v=[],y=[],b=[];let x=!1;for(const k of g.inputs){const E=d.getValue(k),S=d.getMask(k);v.push(E),y.push(S),S!=null&&(x=!0),i||(h[k.name]--,h[k.name]===0&&!t.hasKey(k)&&o.indexOf(k.name)===-1&&!E.isDisposed&&k.sourceLayer.stateful!==!0&&b.push(E))}x&&(n=n||{},n.mask=y[0]);const w=sr(m.apply(v,n));let C=null;m.supportsMasking&&(C=m.computeMask(v,y));const $=dbt(g),_=Array.isArray($)?$:[$];for(let k=0;k<_.length;++k){d.hasKey(_[k])||d.add(_[k],w[k],Array.isArray(C)?C[0]:C);const E=o.indexOf(_[k].name);E!==-1&&(l[E]=w[k])}i||Bt(b)}return d.disposeMasks(),s?l:l[0]}function fbt(e,t){B(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(e.length===1){const i=Bge(e[0],t);n=i.sorted,r=i.recipientMap}else{const i=new Set;for(const s of e){const{sorted:a,recipientMap:o}=Bge(s,t);for(const l of a)i.has(l.name)||(n.push(l),i.add(l.name));for(const l in o)r[l]==null&&(r[l]=new Set),o[l].forEach(u=>r[l].add(u))}}return{sorted:n,recipientCounts:hbt(r)}}function hbt(e){const t={};for(const n in e)t[n]=e[n].size;return t}function Bge(e,t){const n=new Set,r=[],i={};for(const o of t.names())n.add(o);const s=[],a=[];for(s.push(e);s.length>0;){const o=s[s.length-1];if(n.has(o.name)){s.pop();continue}const l=a[a.length-1]===s.length-1;if(o.inputs.length===0||l)s.pop(),r.push(o),n.add(o.name),l&&a.pop();else{a.push(s.length-1);for(const u of o.inputs)i[u.name]==null&&(i[u.name]=new Set),i[u.name].add(o.name),!n.has(u.name)&&s.push(u)}}return{sorted:r,recipientMap:i}}function dbt(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let r=0;r<e.sourceLayer.inboundNodes.length;++r)for(const i of e.sourceLayer.inboundNodes[r].outputTensors)if(i.id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pbt=le();pbt.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,cbt);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lne(e,t){return ce(()=>qs(qe(ne(e,e),t,!0)))}class BI extends Gb{getConfig(){return{}}}class wDe extends BI{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return ce(()=>{const n=Lne(t,this.axis),r=sl(n,0,this.maxValue);return ne(t,Qe(r,ke(pi(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}wDe.className="MaxNorm";Ee(wDe);class $De extends BI{constructor(t){super(),this.defaultAxis=0,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return ce(()=>Qe(t,ke(pi(),Lne(t,this.axis))))}getConfig(){return{axis:this.axis}}}$De.className="UnitNorm";Ee($De);class CDe extends BI{apply(t){return id(t)}}CDe.className="NonNeg";Ee(CDe);class _De extends BI{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=t.minValue!=null?t.minValue:this.defaultMinValue,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.rate=t.rate!=null?t.rate:this.defaultRate,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return ce(()=>{const n=Lne(t,this.axis),r=ke(ne(this.rate,sl(n,this.minValue,this.maxValue)),ne(1-this.rate,n));return ne(t,Qe(r,ke(pi(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}_De.className="MinMaxNorm";Ee(_De);const zge={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function mi(e){return Ene(e)}function Uge(e,t={}){return FI(e,El.getMap().classNameMap,t,"constraint")}function vi(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in zge?zge[e]:e,config:{}};return Uge(n)}else return e instanceof BI?e:Uge(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Ev(e){if(e==null)return;const t=[],n=[],r=[];for(const i in e){const s=e[i];if(typeof s!="number"){const a=s;t.push(a.data()),n.push(i),r.push(a)}}if(t.length>0){const i=await Promise.all(t);for(let s=0;s<i.length;++s)e[n[s]]=i[s][0];Bt(r)}}function SDe(e){if(e!=null)for(const t in e){const n=e[t];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Wge;(function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"})(Wge||(Wge={}));const gbt=125;class ET{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,n){}async onEpochEnd(t,n){}async onBatchBegin(t,n){}async onBatchEnd(t,n){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class mbt{constructor(t,n=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=n}append(t){this.callbacks.push(t)}setParams(t){for(const n of this.callbacks)n.setParams(t)}setModel(t){for(const n of this.callbacks)n.setModel(t)}async onEpochBegin(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(t,n)}async onEpochEnd(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(t,n)}async onBatchBegin(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(t,n)}async onBatchEnd(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(t,n)}async onTrainBegin(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainBegin(t)}async onTrainEnd(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainEnd(t)}}class vbt extends ET{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const i in n){const s=n[i];if(typeof s=="number")this.totals.hasOwnProperty(i)||(this.totals[i]=0),this.totals[i]=this.totals[i]+s*r;else{let a;i in this.totals?a=this.totals[i]:this.totals[i]=0;const o=ce(()=>ke(this.totals[i],ne(s,r)));this.totals[i]=o,a!=null&&a.dispose()}}}async onEpochEnd(t,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:ce(()=>{const i=ne(Qe(1,this.seen),this.totals[r]);n[r]=i,this.totals[r].dispose(),Uc(n[r])}))}}class ybt extends ET{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,n){n==null&&(n={}),this.epoch.push(t);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const t=[],n=[],r=[];for(const s in this.history){const a=this.history[s];for(let o=0;o<a.length;++o)if(typeof a[o]!="number"){const l=a[o];t.push(l.data()),n.push(s),r.push(o)}}const i=await Promise.all(t);for(let s=0;s<i.length;++s)this.history[n[s]][r[s]].dispose(),this.history[n[s]][r[s]]=i[s][0]}}class bbt extends ET{constructor(t,n){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||ane,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=gbt),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");w5(this.yieldEvery)&&(this.maybeWait=Oyt(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,n,r){const i=[];this.yield!=null&&(await Ev(r),i.push(this.yield(t,n,r))),i.push(this.nextFrameFunc()),await Promise.all(i)}async onEpochBegin(t,n){this.currentEpoch=t,this.epochBegin!=null&&(await Ev(n),await this.epochBegin(t,n))}async onEpochEnd(t,n){const r=[];this.epochEnd!=null&&(await Ev(n),r.push(this.epochEnd(t,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(t,n){this.batchBegin!=null&&(await Ev(n),await this.batchBegin(t,n))}async onBatchEnd(t,n){const r=[];this.batchEnd!=null&&(await Ev(n),r.push(this.batchEnd(t,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):w5(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),await Promise.all(r)}async onTrainBegin(t){this.trainBegin!=null&&(await Ev(t),await this.trainBegin(t))}async onTrainEnd(t){this.trainEnd!=null&&(await Ev(t),await this.trainEnd(t))}}function kDe(e,t){return e==null&&(e={}),e instanceof ET?[e]:Array.isArray(e)&&e[0]instanceof ET?e:sr(e).map(r=>new bbt(r,t))}class uu{constructor(){}static registerCallbackConstructor(t,n){B(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),uu.checkForDuplicate(n),uu.constructors[t]==null&&(uu.constructors[t]=[]),uu.constructors[t].push(n)}static checkForDuplicate(t){for(const n in uu.constructors)uu.constructors[+n].forEach(i=>{if(i===t)throw new re("Duplicate callback constructor.")})}static clear(){uu.constructors={}}static createCallbacks(t){const n=[];for(const r in uu.constructors){const i=+r;t>=i&&n.push(...uu.constructors[i])}return n.map(r=>new r)}}uu.constructors={};function EDe(e,t,n,r,i,s,a,o,l){const u=new ybt,c=[new vbt,...uu.createCallbacks(t)];e!=null&&c.push(...e),c.push(u);const f=new mbt(c);return f.setParams({epochs:n,initialEpoch:r,samples:i,steps:s,batchSize:a,verbose:t,doValidation:o,metrics:l}),{callbackList:f,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yp(e,t={},n=!1){return FI(e,El.getMap().classNameMap,t,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function R5(e,t){return ce(()=>{e.dtype!=="float32"&&(e=Oe(e,"float32"));const n=qe(RI(e),t,!0),r=S_(n.shape,pi()),i=qs(ig(n,r));return Qe(e,i)})}function _7(e,t){return ce(()=>Lr(RI(We(t,e)),-1))}function Bne(e,t){return ce(()=>Lr(hi(We(t,e)),-1))}function zne(e,t){return ce(()=>{const n=We(e,t),r=sl(hi(e),pi(),Number.MAX_VALUE),i=hi(Qe(n,r));return ne(100,Lr(i,-1))})}function xbt(e,t){return ce(()=>{const n=sl(t,pi(),Number.MAX_VALUE),r=jl(ke(1,n)),i=sl(e,pi(),Number.MAX_VALUE),s=jl(ke(1,i));return Lr(RI(We(r,s)),-1)})}function wbt(e,t){return ce(()=>{const n=ig(0,We(1,ne(e,t)));return Lr(RI(n),-1)})}function $bt(e,t){return ce(()=>{const n=ig(0,We(1,ne(e,t)));return Lr(n,-1)})}function Cbt(e,t){return ce(()=>{const n=qe(ne(e,t),-1),r=Du(ne(We(1,e),t),-1);return ig(0,ke(1,We(r,n)))})}function _bt(e,t){return ce(()=>{const n=Math.log(2),r=We(t,e),i=We(ke(r,k_(ne(-2,r))),n);return Lr(i,-1)})}function AT(e,t,n=!1){return ce(()=>{if(n)t=r7(t);else{const r=qe(t,t.shape.length-1,!0);t=Qe(t,r)}return t=sl(t,pi(),1-pi()),ur(qe(ne(Oe(e,"float32"),jl(t)),t.shape.length-1))})}function P5(e,t,n=!1){return ce(()=>{const r=Oe(TI(Gyt(e)),"int32");t=sl(t,pi(),1-pi());const i=t.shape,s=ie(CT(r,i[i.length-1]),i);return AT(s,t,n)})}function Sbt(e,t){if(!Qt(e.shape,t.shape))throw new re(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return ce(()=>{const n=id(t),r=ur(hi(t));return ke(We(n,ne(t,e)),Gz(Vl(r)))})}function S7(e,t){return ce(()=>{let n;return n=sl(t,pi(),1-pi()),n=jl(Qe(n,We(1,n))),Lr(Sbt(e,n),-1)})}function kbt(e,t){return ce(()=>{const n=sl(e,pi(),1),r=sl(t,pi(),1);return qe(ne(e,jl(Qe(n,r))),-1)})}function Ebt(e,t){return ce(()=>{const n=jl(ke(pi(),t));return Lr(We(t,ne(e,n)),-1)})}function ADe(e,t){return ce(()=>{const n=R5(e,-1),r=R5(t,-1),i=ne(n,r);return ur(qe(i,-1))})}const L5={meanSquaredError:_7,meanAbsoluteError:Bne,meanAbsolutePercentageError:zne,meanSquaredLogarithmicError:xbt,squaredHinge:wbt,hinge:$bt,categoricalHinge:Cbt,logcosh:_bt,categoricalCrossentropy:AT,sparseCategoricalCrossentropy:P5,binaryCrossentropy:S7,kullbackLeiblerDivergence:kbt,poisson:Ebt,cosineProximity:ADe};function mj(e){if(typeof e=="string"){if(e in L5)return L5[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new re(t)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function TDe(e,t){return ce(()=>{const n=ne(.5,Hl(t)),r=ah(yl(t,n),e.dtype);return Lr(Kc(e,r),-1)})}function DDe(e,t){return ce(()=>ah(Kc(Fw(e,-1),Fw(t,-1)),"float32"))}function Abt(e,t){return ce(()=>Oe(qe(Fh(Kc(e,1),Kc(t,1))),"float32"))}function Tbt(e,t){return ce(()=>Oe(qe(Fh(Kc(e,0),Kc(t,1))),"float32"))}function Dbt(e,t){return ce(()=>{const n=Abt(e,t),r=Tbt(e,t),i=ke(n,r);return Oe(Ws(yl(i,0),Qe(n,i),0),"float32")})}function Nbt(e,t){return S7(e,t)}function Ibt(e,t){return e.rank===t.rank&&(e=qb(e,[e.rank-1])),t=Fw(t,-1),t.dtype!==e.dtype&&(t=Oe(t,e.dtype)),Oe(Kc(e,t),"float32")}const Mbt=_7,Fbt=_7,Obt=Bne,Rbt=Bne,Pbt=zne,Lbt=zne,NDe=AT,Bbt=ADe,IDe=P5,B5={binaryAccuracy:TDe,categoricalAccuracy:DDe,precision:Dbt,categoricalCrossentropy:NDe,sparseCategoricalCrossentropy:IDe,mse:Mbt,MSE:Fbt,mae:Obt,MAE:Rbt,mape:Pbt,MAPE:Lbt,cosine:Bbt};function zbt(e){if(typeof e=="string"&&e in B5)return B5[e];if(typeof e!="string"&&e!=null)return e;throw new re(`Unknown metric ${e}`)}function lO(e){if(Rf(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e=="string")return e;{let t;for(const n of Object.keys(L5))if(L5[n]===e){t=n;break}if(t!==void 0)return t;for(const n of Object.keys(B5))if(B5[n]===e){t=n;break}return t!==void 0?t:e.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ubt(e){const t={Adagrad:()=>Rg.adagrad(.01),Adadelta:()=>Rg.adadelta(1,.95,pi()),Adam:()=>Rg.adam(.001,.9,.999,pi()),Adamax:()=>Rg.adamax(.002,.9,.999,pi(),0),RMSProp:()=>Rg.rmsprop(.001,.9,0,pi()),SGD:()=>Rg.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new re(`Unknown Optimizer ${e}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Vge=1*1024*1024;function jge(e,t,n=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!QY(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(e);r.length>Vge&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${Vge}.`)}}function QY(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t)if(typeof n!="string"||!QY(e[n]))return!1;return!0}else if(Array.isArray(e)){for(const t of e)if(!QY(t))return!1;return!0}else return!1;else{const t=typeof e;return t==="string"||t==="number"||t==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Wbt(e,t,n,r=console.log){const i=jbt(e),s=["Layer (type)","Input Shape","Output shape","Param #"];i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(t*c)));let a;if(!i){s.push("Receives inputs"),a=[];for(const c in e.nodesByDepth)a.push(...e.nodesByDepth[c])}r("_".repeat(t)),z5(s,n,r),r("=".repeat(t));const o=e.layers;for(let c=0;c<o.length;++c)i?Hbt(o[c],n,r):qbt(o[c],n,a,r),r((c===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const l=Vbt(e),u=M5(e.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(t))}function Vbt(e){let t;return e.collectedTrainableWeights!=null?t=M5(e.collectedTrainableWeights):t=M5(e.trainableWeights),t}function jbt(e){let t=!0;const n=[],r=[];for(const i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(const i of n){if(i.length>1||i.length===1&&i[0].inboundLayers.length>1){t=!1;break}r.push(...i)}if(t)for(const i of e.layers){let s=!1;for(const a of i.inboundNodes)if(r.indexOf(a)!==-1)if(s){t=!1;break}else s=!0;if(!t)break}return t}function z5(e,t,n=console.log){let r="";for(let i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=e[i],r=r.slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function Hbt(e,t,n){let r,i;try{i=e.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(e.outputShape)}catch{r="multiple"}const s=e.name,a=e.getClassName(),o=[`${s} (${a})`,i,r,e.countParams().toString()];z5(o,t,n)}function qbt(e,t,n,r){let i,s;try{s=e.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{s="multiple"}try{i=JSON.stringify(e.outputShape)}catch{i="multiple"}const a=[];for(const f of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(f)===-1))for(let h=0;h<f.inboundLayers.length;++h){const d=f.inboundLayers[h].name,p=f.nodeIndices[h],g=f.tensorIndices[h];a.push(`${d}[${p}][${g}]`)}const o=e.name,l=e.getClassName(),u=a.length===0?"":a[0],c=[`${o} (${l})`,s,i,e.countParams().toString(),u];z5(c,t,r);for(let f=1;f<a.length;++f)z5(["","","","",a[f]],t,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function MDe(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function JY(e,t){if(e===null)return null;if(typeof e=="string")return i1(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const s=e[i];MDe(t,i,s)?n.push(s):n.push(JY(s,t))}return n}else{const n={};for(const r of Object.keys(e)){const i=e[r];if(r==="name"&&typeof i=="string")n[r]=i;else{const s=i1(r);n[s]=JY(i,s)}}return n}}function eX(e,t){if(e==null)return null;if(typeof e=="string")return Bd(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const s=e[i];MDe(t,i,s)?n.push(s):n.push(eX(s,t))}return n}else{const n={};for(const r of Object.keys(e)){const i=e[r],s=Bd(r);(r==="name"||r==="className")&&typeof i=="string"?n[s]=i:n[s]=eX(i,r)}return n}}/** @license See the LICENSE file. */const FDe="4.8.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cc extends Vt{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){const y=this.getClassName().toLowerCase();this.name=w7(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],y0(this.inputs).length!==this.inputs.length)throw new re(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(y=>y.name)}`);y0(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(y=>y.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const b=y.sourceLayer,x=y.nodeIndex,w=y.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(x),this.outputLayersTensorIndices.push(w)}for(const y of this.inputs){const b=y.sourceLayer,x=y.nodeIndex,w=y.tensorIndex;Rf(x===0,"input layer has >1 nodes"),Rf(w===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(x),this.inputLayersTensorIndices.push(w)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const b=this.inputLayers[y];if(!(b instanceof LI))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${y} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);const n={},r={},i={},s={},a={},o=[],l=(y,b,x,w,C,$)=>{(w==null||C==null||$==null)&&(w=y.sourceLayer,C=y.nodeIndex,$=y.tensorIndex);const _=w.inboundNodes[C];if(x.indexOf(_)!==-1)throw new vu(`The tensor ${y.name} at layer "${w.name}" is part of a cycle.`);if(b.indexOf(_)!==-1)return;this.containerNodes.add(cc.nodeKey(w,C)),w.id in a||(a[w.id]=Object.keys(a).length),x.indexOf(_)===-1&&x.push(_);const k=_.inboundLayers.length;for(let E=0;E<k;E++){const S=_.inputTensors[E],N=_.inboundLayers[E],A=_.nodeIndices[E],D=_.tensorIndices[E];l(S,b,x,N,A,D)}for(b.push(_);x.indexOf(_)>=0;)x.splice(x.indexOf(_),1);o.push(_)},u=[],c=[];for(const y of this.outputs)l(y,u,c);const f=o.slice().reverse();for(const y of f){r[y.id]=y,y.id in n||(n[y.id]=0);let b=n[y.id];const x=i[y.outboundLayer.id]==null?0:i[y.outboundLayer.id];b=Math.max(b,x),i[y.outboundLayer.id]=b,s[y.outboundLayer.id]=y.outboundLayer,n[y.id]=b;for(let w=0;w<y.inboundLayers.length;w++){const C=y.inboundLayers[w],$=y.nodeIndices[w],_=C.inboundNodes[$],k=n[_.id]==null?0:n[_.id];n[_.id]=Math.max(b+1,k),r[_.id]=_}}const h={};for(const y in n){const b=n[y];b in h||(h[b]=[]),h[b].push(r[y])}const d={};for(const y in i){const b=i[y];b in d||(d[b]=[]),d[b].push(s[y])}let p=Object.keys(d).map(y=>parseInt(y,10)).sort(sO);this.layers=[];for(const y of p){const b=d[y];b.sort((x,w)=>{const C=a[x.id],$=a[w.id];return C<$?-1:C>$?1:0});for(const x of b)x instanceof cc&&this.internalContainerRefs.push(x),this.layers.push(x)}this.layersByDepth=d,p=Object.keys(h).map(y=>parseInt(y,10)).sort(sO);const g=this.inputs.slice(),m=[];for(const y of p)for(const b of h[y]){const x=b.outboundLayer;if(x!=null){for(const w of b.inputTensors)if(g.indexOf(w)===-1)throw new vu(`Graph disconnected: cannot obtain value for tensor ${w} at layer "${x.name}". The following previous layers were accessed without issue: ${m}`);for(const w of b.outputTensors)g.push(w);m.push(x.name)}}this.nodesByDepth=h;const v=this.layers.map(y=>y.name);for(const y of v){const b=v.filter(x=>x===y).length;if(b!==1)throw new vu(`The name "${y}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(v))}this.outboundNodes=[],this.inboundNodes=[],new C7({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new re("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){const r={};let i=0;for(const a of this.layers)for(const o of a.weights){if(r[o.originalName]!=null)throw new re(`Duplicate weight name: ${o.originalName}`);r[o.originalName]=o,i++}const s=[];for(const a in t){let o=a;if(r[a]==null){const l=a.split("/");o=l.slice(0,-2).concat([l[l.length-1]]).join("/")}if(r[o]!=null)s.push([r[o],t[a]]);else if(n)throw new re(`Provided weight data has no target variable: ${a}`);delete r[o]}if(n){const a=[];for(const o in r)a.push(o);if(a.length>0)throw new re(`${a.length} of ${i} weights are not set: ${a}`)}Pne(s)}updatedConfig(){const t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${FDe}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){const r=eX(this.updatedConfig());return n?JSON.stringify(r):r}call(t,n){return ce(()=>{t=sr(t);const r=new Zg;for(let i=0;i<this.inputs.length;++i)r.add(this.inputs[i],t[i]);return aE(this.outputs,r,n)})}computeMask(t,n){return ce(()=>{t=sr(t);let r;return n==null?r=By(null,t.length):r=sr(n),this.runInternalGraph(t,r)[1]})}computeOutputShape(t){const n=I5(t);if(n.length!==this.inputLayers.length)throw new re(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let o=0;o<n.length;o++){const l=this.inputLayers[o],u=n[o],c=l.name+"_0_0";r[c]=u}const i=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(sO);if(i.length>1)for(const o of i){const l=this.nodesByDepth[o];for(const u of l){const c=u.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(c.id)!==-1)continue;const f=[];for(let g=0;g<u.inboundLayers.length;g++){const m=u.inboundLayers[g],v=u.nodeIndices[g],y=u.tensorIndices[g],b=`${m.name}_${v}_${y}`,x=r[b];f.push(x)}const h=c.computeOutputShape(Ya(f)),d=I5(h),p=c.inboundNodes.indexOf(u);for(let g=0;g<d.length;g++){const m=`${c.name}_${p}_${g}`;r[m]=d[g]}}}const s=[],a=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],u=this.outputLayersNodeIndices[o],c=this.outputLayersTensorIndices[o],f=`${l.name}_${u}_${c}`;a.push(f)}for(let o=0;o<a.length;o++){const l=a[o];Rf(l in r),s.push(r[l])}return Ya(s)}runInternalGraph(t,n){n==null&&(n=By(null,t.length));const r={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],c=t[l],f=n[l];r[u.id]=[c,f]}const i=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(sO);for(const l of i){const u=this.nodesByDepth[l];for(const c of u){const f=c.outboundLayer,h=c.inputTensors,d=c.outputTensors,p=new Array;for(const g of h)g.id in r&&p.push(r[g.id]);if(p.length===h.length){let g={},m,v,y,b;if(c.callArgs!=null&&(g=c.callArgs),p.length===1){const[x,w]=p[0];g.mask==null&&(g.mask=w),y=sr(f.call(x,g)),b=sr(f.computeMask(x,w)),m=[x],v=[w]}else m=p.map(x=>x[0]),v=p.map(x=>x[1]),g.mask==null&&(g.mask=v),y=sr(f.call(m,g)),b=sr(f.computeMask(m,v));if(f.activityRegularizer)throw new Tt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let x=0;x<d.length;++x){const w=d[x],C=y[x],$=b[x];r[w.id]=[C,$]}}}}const s=[],a=[],o=[];for(const l of this.outputs){Rf(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[u,c]=r[l.id];o.push(u.shape),s.push(u),a.push(c)}return[s,a,o]}buildNodeConversionMap(t){const n={};let r;for(const i of this.layers){r=i instanceof cc?1:0;for(let s=0;s<i.inboundNodes.length;s++){const a=cc.nodeKey(i,s);this.containerNodes.has(a)&&(n[a]=r,r+=1)}}return n}getLayer(t,n){if(n!=null)return this.findLayer(n);if(t==null)throw new re("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(const r of this.layers)if(r.name===t)return r;throw new re(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new re(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return ce(()=>{const t=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const i=cc.nodeKey(n,r);this.containerNodes.has(i)&&t.push(...n.calculateLosses())}return t})}getConfig(){const t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const a of this.layers){const o=a.getClassName(),l=a.getConfig(),u=[];for(let f=0;f<a.inboundNodes.length;f++){const h=a.inboundNodes[f],d=cc.nodeKey(a,f);let p={};if(this.containerNodes.has(d)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${a.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const g=[];for(let m=0;m<h.inboundLayers.length;m++){const v=h.inboundLayers[m],y=h.nodeIndices[m],b=h.tensorIndices[m],x=cc.nodeKey(v,y);let w=n[x];w==null&&(w=0),g.push([v.name,w,b,p])}u.push(g)}}}const c={};c.name=a.name,c.className=o,c.config=l,c.inboundNodes=u,r.push(c)}t.layers=r;const i=[];for(let a=0;a<this.inputLayers.length;a++){const o=this.inputLayers[a],l=this.inputLayersNodeIndices[a],u=cc.nodeKey(o,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const f=this.inputLayersTensorIndices[a];i.push([o.name,c,f])}t.inputLayers=i;const s=[];for(let a=0;a<this.outputLayers.length;a++){const o=this.outputLayers[a],l=this.outputLayersNodeIndices[a],u=cc.nodeKey(o,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const f=this.outputLayersTensorIndices[a];s.push([o.name,c,f])}return t.outputLayers=s,t}static fromConfig(t,n,r={},i=!1){const s={},a={};function o(m,v){m.name in a?a[m.name].push(v):a[m.name]=[v]}function l(m,v){const y=[];let b;for(const x of v){const w=x[0],C=x[1],$=x[2];if(b=x[3]==null?{}:x[3],!(w in s)){o(m,v);return}const _=s[w];if(_.inboundNodes.length<=C){o(m,v);return}const k=_.inboundNodes[C];y.push(k.outputTensors[$])}y.length>0&&m.apply(Ya(y),b)}function u(m){const v=m.name,y=yp(m,n.customObjects!=null?n.customObjects:{});y.setFastWeightInitDuringBuild(i),s[v]=y,m.inboundNodes.forEach(x=>{if(!(x instanceof Array))throw new re(`Corrupted configuration, expected array for nodeData: ${x}`);o(y,x)})}const c=n.name,f=n.layers;for(const m of f)u(m);for(;!Fyt(a);)for(const m of f){const v=s[m.name];if(v.name in a){const y=a[v.name];delete a[v.name];for(const b of y)l(v,b)}}const h=[],d=[],p=n.inputLayers;for(const m of p){const v=m[0],y=m[1],b=m[2];Rf(v in s);const w=s[v].inboundNodes[y].outputTensors;h.push(w[b])}const g=n.outputLayers;for(const m of g){const v=m[0],y=m[1],b=m[2];Rf(v in s);const w=s[v].inboundNodes[y].outputTensors;d.push(w[b])}return new t({inputs:h,outputs:d,name:c})}get stateful(){if(this._stateful)throw new re("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){ce(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gbt(e,t,n){const r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(i=>null);if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){const i=[];return t.forEach(s=>{s in e?i.push(e[s]):i.push(null)}),i}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function ODe(e,t){return Gbt(e,t,"classWeight")}async function RDe(e,t,n,r){if(t!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){const i=ce(()=>{if(e.shape.length===1)return v0(e);if(e.shape.length===2){if(e.shape[1]>1)return Fw(e,1);if(e.shape[1]===1)return ie(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(await i.data());Bt(i);const a=[];return s.forEach(o=>{if(n[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);a.push(n[o])}),so(a,"float32")}else return null}function Ybt(e,t){return ne(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Xbt=32;function PDe(e,t){let n,r;const i=t;n=i.xs,r=i.ys,B(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const s=Hge("input",e.inputNames,n),a=Hge("output",e.outputNames,r),o=s[0].shape[0];B(s.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),B(a.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${a.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let l=0;l<s.length;l++)B(s[l].shape[0]===o,()=>`Batch size mismatch: input ${e.inputNames[l]} has ${s[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);for(let l=0;l<a.length;l++)B(a[l].shape[0]===o,()=>`Batch size mismatch: output ${e.outputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);return{xs:s,ys:a}}function Hge(e,t,n){if(n instanceof On)return[n];if(Array.isArray(n))return B(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{const r=[];for(const i of t){if(n[i]==null)throw new re(`The feature data generated by the dataset lacks the required ${e} key '${i}'.`);r.push(n[i])}return r}}function Kbt(e){if(e.length===3)throw new Tt("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}async function Zbt(e,t,n){const r=n.batchesPerEpoch!=null;if(B(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),B(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),B(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),B(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),B(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const i=n.validationData!=null;let s,a;if(i)if(qge(n.validationData))B(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const m=Kbt(n.validationData);s=m.xs,a=m.ys}const o=e.makeTrainFunction(),l=e.getDedupedMetricsNames();let u;i?u=l.slice().concat(l.map(m=>"val_"+m)):u=l.slice();const c=kDe(n.callbacks,n.yieldEvery),f=n.verbose==null?1:n.verbose,{callbackList:h,history:d}=EDe(c,f,n.epochs,null,null,Qbt(t,n),null,i,u);h.setModel(e),e.history=d,await h.onTrainBegin(),e.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,g=await t.iterator();for(;p<n.epochs;){const m={};await h.onEpochBegin(p);let v=0,y=0;for(r||(g=await t.iterator());!r||v<n.batchesPerEpoch;){const b=await g.next();if(r&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${v} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:x,ys:w}=PDe(e,b.value),C={};C.batch=y,C.size=x[0].shape[0],await h.onBatchBegin(y,C);const $=[];if(n.classWeight!=null){const E=ODe(n.classWeight,e.outputNames);for(let S=0;S<E.length;++S)$.push(await RDe(w[S],null,E[S]))}const _=x.concat(w).concat($),k=o(_);Bt(_);for(let E=0;E<l.length;++E){const S=l[E],N=k[E];C[S]=N,Uc(N)}await h.onBatchEnd(y,C),SDe(C),y++,v++}if(r?v>=n.batchesPerEpoch:b.done){if(i){let x;qge(n.validationData)?x=sr(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):x=sr(e.evaluate(s,a,{batchSize:n.validationBatchSize==null?Xbt:n.validationBatchSize,verbose:0}));for(let w=0;w<e.metricsNames.length;++w)m[`val_${e.metricsNames[w]}`]=x[w]}break}if(e.stopTraining_)break}if(await h.onEpochEnd(p,m),p++,e.stopTraining_)break}return await h.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function Qbt(e,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function qge(e){return typeof e.iterator=="function"}function Jbt(e){return typeof e.next=="function"}async function ext(e,t,n){n=n||{};const r=n.batches!=null,i=e.testFunction;let s=[];if(n.verbose>0)throw new Tt("Verbose mode is not implemented yet.");B(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const a=Jbt(t)?t:await t.iterator();let o=0,l=0;for(;!r||l<n.batches;){const u=await a.next();if(s=ce(()=>{if(u.value){const{xs:c,ys:f}=PDe(e,u.value),h=c.concat(f),d=ce(()=>i(h));if(Bt(h),l===0)for(let g=0;g<d.length;++g)s.push(xt(0));const p=h[0].shape[0];for(let g=0;g<d.length;++g){const m=d[g],v=s[g];s[g]=ce(()=>ke(s[g],ne(p,m))),l>0&&Bt(v)}Bt(d),o+=p,++l}return s}),u.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<s.length;++u){const c=s[u];s[u]=Qe(s[u],o),Bt(c)}return Ya(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vj(e){B(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function QS(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(r=>Q1(r,t,n-t)):Q1(e,t,n-t)}function tX(e,t){return ce(()=>e==null?null:Array.isArray(e)?e.map(n=>tX(n,t)):cDe(e,t.dtype==="int32"?t:Oe(t,"int32")))}function yj(e,t){const n=[];let r=0,i=null;for(;r<e;)i=r+t,i>=e&&(i=e),n.push([r,i]),r=i;return n}function LDe(e){const t=[];e instanceof On&&(e=[e]);for(let n=0;n<e.length;++n){const r=e[n];if(r.rank===1)t.push(OI(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function ic(e,t){if(e==null)return;const n=[];if(t instanceof On)n.push(t.id);else if(Array.isArray(t))t.forEach(i=>n.push(i.id));else if(t!=null)for(const i in t){const s=t[i];n.push(s.id)}const r=[];if(e instanceof On)n.indexOf(e.id)===-1&&r.push(e);else if(Array.isArray(e))e.forEach(i=>{n.indexOf(i.id)===-1&&r.push(i)});else if(e!=null)for(const i in e){const s=e[i];n.indexOf(s.id)===-1&&r.push(s)}r.forEach(i=>{i.isDisposed||i.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function txt(e){return e instanceof On}function nX(e){return Array.isArray(e)}function Gge(e){return!txt(e)&&!nX(e)}function Yge(e,t,n,r=!0,i=""){if(t==null||t.length===0){if(e!=null){let a=!1;if(nX(e)&&e.length>0)a=!0;else if(Gge(e)){for(const o in e)if(e.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new re(`Error when checking model ${i} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(a=>null);let s;if(Gge(e)){e=e,s=[];for(const a of t){if(e[a]==null)throw new re(`No data provided for "${a}". Need data for each key in: ${t}`);s.push(e[a])}}else if(nX(e)){if(e=e,e.length!==t.length)throw new re(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);s=e}else{if(e=e,t.length>1)throw new re(`The model ${i} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);s=[e]}if(s=LDe(s),n!=null)for(let a=0;a<t.length;++a){if(n[a]==null)continue;const o=s[a];if(o.shape.length!==n[a].length)throw new re(`Error when checking ${i}: expected ${t[a]} to have ${n[a].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<n[a].length;++l){if(l===0&&!r)continue;const u=o.shape[l],c=n[a][l];if(c!=null&&c>=0&&u!==c)throw new re(`${i} expected a batch of elements where each example has shape [${n[a].slice(1,n[a].length)}] (i.e.,tensor shape [*,${n[a].slice(1,n[a].length)}]) but the ${i} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return s}function nxt(e,t,n){const r=y0(e.map(s=>s.shape[0]));r.sort();const i=y0(t.map(s=>s.shape[0]));if(i.sort(),r.length>1)throw new re(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(s=>s.shape))}`);if(i.length>1)throw new re(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(r.length>0&&i.length>0&&!Qt(r,i))throw new re(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}function rxt(e,t,n){const r=[_7,S7,AT];for(let i=0;i<e.length;++i){const s=e[i],a=t[i],o=n[i];if(a!=null){if(a===AT&&s.shape[s.shape.length-1]===1)throw new re(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(a)!==-1){const l=s.shape.slice(1),u=o.slice(1);for(let c=0;c<l.length;++c){const f=l[c],h=u[c];if(h!=null&&f!==h)throw new re(`A target Tensor with shape ${s.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function Xge(e,t,n,r=!0,i=""){let s;if(Array.isArray(e)){if(e.length!==t.length)throw new re(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);s=e}else{if(t.length>1)throw new re(`The model expects ${t.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);s=[e]}if(n!=null)for(let a=0;a<t.length;++a){if(n[a]==null)continue;const o=s[a];if(o.shape.length!==n[a].length)throw new re(`Error when checking ${i}: expected ${t[a]} to have ${n[a].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<n[a].length;++l){if(l===0&&!r)continue;const u=o.shape[l],c=n[a][l];if(c!=null&&c!==u)throw new re(`Error when checking ${i}: expected ${t[a]} to have shape ${JSON.stringify(n[a])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function ixt(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(r=>[]);let n;if(typeof e=="string"||typeof e=="function")n=[e];else if(Array.isArray(e)||typeof e=="object")n=e;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(n))return t.map(r=>n);{const r=[];for(const i of t){let s=n.hasOwnProperty(i)?n[i]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}}const sxt="layers-model";class J1 extends cc{constructor(t){super(t),this.isTraining=!1}summary(t,n,r=console.log){if(!this.built)throw new re("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Wbt(this,t,n,r)}compile(t){if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=Ubt(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof ag))throw new re("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(t.loss)&&typeof t.loss!="string"&&typeof t.loss!="function"){t.loss=t.loss;for(const a in t.loss)if(this.outputNames.indexOf(a)===-1)throw new re(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(const a of this.outputNames)t.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),n.push(mj(t.loss[a]))}else if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new re(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);n=t.loss.map(o=>mj(o))}else{const a=mj(t.loss);this.outputs.forEach(o=>{n.push(a)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const o=this.internalOutputShapes[a],l=this.outputNames[a];this.feedOutputNames.push(l),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[a])}const r=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Z1("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(r.indexOf(a)!==-1)continue;const o=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([o,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});const i=ixt(t.metrics,this.outputNames),s=(a,o,l)=>{this.outputNames.length>1&&(o=this.outputNames[a]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([l,a])};Z1("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(r.indexOf(a)!==-1)continue;const o=i[a];(u=>{const c="";let f,h,d;for(const p of u){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const m=this.internalOutputShapes[a];m[m.length-1]===1||this.lossFunctions[a]===S7?["accuracy","acc"].indexOf(p)!==-1?h=TDe:["crossentropy","ce"].indexOf(p)!==-1&&(h=Nbt):this.lossFunctions[a]===P5?["accuracy","acc"].indexOf(p)!==-1?h=Ibt:["crossentropy","ce"].indexOf(p)!==-1&&(h=IDe):["accuracy","acc"].indexOf(p)!==-1?h=DDe:["crossentropy","ce"].indexOf(p)!==-1&&(h=NDe);let v;["accuracy","acc"].indexOf(p)!==-1?v="acc":["crossentropy","ce"].indexOf(p)!==-1&&(v="ce"),d=h,f=c+v}else d=zbt(p),f=c+lO(p);let g;Z1(f,()=>{g=d}),s(a,f,g)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,n,r={}){const i=r.batchSize==null?32:r.batchSize;vj(i);const s=!0,a=this.standardizeUserDataXY(t,n,s,i);try{const o=a[0].concat(a[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,o,i,r.verbose,r.steps);return Ya(u)}finally{ic(a[0],t),ic(a[1],n)}}async evaluateDataset(t,n){return this.makeTestFunction(),ext(this,t,n)}checkNumSamples(t,n,r,i="steps"){let s;if(r!=null){if(s=null,n!=null)throw new re(`If ${i} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(t!=null)Array.isArray(t)?s=t[0].shape[0]:s=t.shape[0];else throw new re(`Either the input data should have a defined shape, or ${i} shoud be specified.`);return s}execute(t,n){if(Array.isArray(n)&&n.length===0)throw new re("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),i=r?n:[n],s=this.retrieveSymbolicTensors(i),a=new Zg;if(t instanceof On&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new re(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)a.add(this.inputs[l],t[l])}else for(const l of this.inputs){const u=t[l.name];if(u==null)throw new re(`No value is provided for the model's input ${l.name}`);a.add(l,u)}const o=aE(s,a);return r?o:o[0]}retrieveSymbolicTensors(t){const n=By(null,t.length);let r=t.length;for(const i of this.layers){const s=Array.isArray(i.output)?i.output:[i.output],a=s.map(o=>o.name);for(let o=0;o<t.length;++o){const l=a.indexOf(t[o]);if(l!==-1&&(n[o]=s[l],r--),r===0)break}if(r===0)break}if(r>0){const i=[];throw n.forEach((s,a)=>{s==null&&i.push(t[a])}),new re(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(i)}`)}return n}predictLoop(t,n=32,r=!1){return ce(()=>{const i=this.checkNumSamples(t);if(r)throw new Tt("Verbose predictLoop() is not implemented yet.");const s=yj(i,n),a=this.outputs.map(o=>[]);for(let o=0;o<s.length;++o)ce(()=>{const u=s[o][0],c=s[o][1],f=QS(t,u,c),h=[];if(Array.isArray(f))for(let p=0;p<f.length;++p)h.push({key:this.inputs[p],value:f[p]});else h.push({key:this.inputs[0],value:f});const d=new Zg(h);return aE(this.outputs,d)}).forEach((u,c)=>a[c].push(u));return Ya(a.map(o=>Di(o,0)))})}predict(t,n={}){const r=LDe(t);Xge(r,this.inputNames,this.feedInputShapes,!1);try{const i=n.batchSize==null?32:n.batchSize;return vj(i),this.predictLoop(r,i)}finally{ic(r,t)}}predictOnBatch(t){Xge(t,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,n)}standardizeUserDataXY(t,n,r=!0,i){if(this.optimizer_==null)throw new vu("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const s=[];for(let a=0;a<this.feedOutputShapes.length;++a){const o=this.feedOutputShapes[a];this.feedLossFns[a]===P5?s.push(o.slice(0,o.length-1).concat([1])):s.push(o)}if(t=Yge(t,this.feedInputNames,this.feedInputShapes,!1,"input"),n=Yge(n,this.feedOutputNames,s,!1,"target"),nxt(t,n),rxt(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&i!=null&&i>0&&t[0].shape[0]%i!==0)throw new re(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${i}. Found: ${t[0].shape[0]} sample(s).`);return[t,n]}async standardizeUserData(t,n,r,i,s=!0,a){const[o,l]=this.standardizeUserDataXY(t,n,s,a);if(r!=null)throw new Error("sample weight is not supported yet.");let u=null;if(i!=null){const c=ODe(i,this.outputNames);u=[];for(let f=0;f<c.length;++f)u.push(await RDe(l[f],null,c[f]))}return[o,l,u]}testLoop(t,n,r,i=0,s){return ce(()=>{const a=this.checkNumSamples(n,r,s,"steps"),o=[];if(i>0)throw new Tt("Verbose mode is not implemented yet.");if(s!=null)throw new Tt("steps mode in testLoop() is not implemented yet");{const l=yj(a,r),u=so(Zc(0,a));for(let c=0;c<l.length;++c){const f=l[c][0],h=l[c][1],d=Q1(u,f,h-f),p=tX(n,d),g=t(p);if(c===0)for(let m=0;m<g.length;++m)o.push(xt(0));for(let m=0;m<g.length;++m){const v=g[m];o[m]=ke(o[m],ne(h-f,v))}}for(let c=0;c<o.length;++c)o[c]=Qe(o[c],a)}return o})}getDedupedMetricsNames(){const t=this.metricsNames,n=[];for(let r=0;r<t.length;++r){const i=t[r];let s=i;if(Mge(t,i)>1){const a=Mge(t.slice(0,r),i);s+=`_${a}`}n.push(s)}return n}makeTrainFunction(){return t=>{const n=[],r=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],o=()=>{const f=[];for(let g=0;g<this.inputs.length;++g)f.push({key:this.inputs[g],value:r[g]});const h=new Zg(f),d=aE(this.outputs,h,{training:!0});let p;for(let g=0;g<this.lossFunctions.length;++g){const m=this.lossFunctions[g];let v=m(i[g],d[g]);s[g]!=null&&(v=Ybt(v,s[g]));const y=Lr(v);n.push(y),g===0?p=v:p=ke(p,v)}for(let g=0;g<this.metricsTensors.length;++g){let m;if(this.outputs.length>1&&g<this.outputs.length)m=n[g];else{const v=this.metricsTensors[g][0],y=this.metricsTensors[g][1];m=Lr(v(i[y],d[y]))}Uc(m),a.push(m)}return p=Lr(p),this.calculateLosses().forEach(g=>{p=ke(p,g)}),p},l=this.collectedTrainableWeights.map(f=>f.read()),u=!0;return[this.optimizer_.minimize(o,u,l)].concat(a)}}makeTestFunction(){this.testFunction=t=>ce(()=>{const n=[];let r;const i=t.slice(0,this.inputs.length),s=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let u=0;u<this.inputs.length;++u)a.push({key:this.inputs[u],value:i[u]});const o=new Zg(a),l=aE(this.outputs,o);for(let u=0;u<this.lossFunctions.length;++u){const c=this.lossFunctions[u],f=Lr(c(s[u],l[u]));u===0?r=f:r=ke(r,f),n.push(r)}for(let u=0;u<this.metricsTensors.length;++u){const c=this.metricsTensors[u][0],f=this.metricsTensors[u][1],h=Lr(c(s[f],l[f]));n.push(h)}return n})}async fit(t,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let i,s,a,o,l,u,c,f,h;try{const d=r.batchSize==null?32:r.batchSize;vj(d);const p=!1,g=await this.standardizeUserData(t,n,r.sampleWeight,r.classWeight,p,d);i=g[0],s=g[1],h=g[2];let m=!1,v;if(r.validationData!=null&&r.validationData.length>0){if(m=!0,r.validationData.length===2)l=r.validationData[0],u=r.validationData[1];else throw r.validationData.length===3?new Tt("validationData including sample weights is not supported yet."):new re(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const k=!0,E=await this.standardizeUserData(l,u,null,null,k,d);c=E[0],f=E[1],v=c.concat(f)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){m=!0;const k=Math.floor(i[0].shape[0]*(1-r.validationSplit)),E=i[0].shape[0];c=QS(i,k,E),a=i,i=QS(i,0,k),f=QS(s,k,E),o=s,s=QS(s,0,k),v=c.concat(f)}else r.validationSteps!=null&&(m=!0);const y=i.concat(s).concat(h);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),x=this.getDedupedMetricsNames();let w,C;m?(this.makeTestFunction(),w=this.testFunction,C=x.slice().concat(x.map(k=>"val_"+k))):(w=null,v=[],C=x.slice());const $=kDe(r.callbacks,r.yieldEvery);return await this.fitLoop(b,y,x,d,r.epochs,r.verbose,$,w,v,r.shuffle,C,r.initialEpoch,null,null)}finally{this.isTraining=!1,ic(i,t),ic(s,n),ic(a,t),ic(o,n),ic(c,l),ic(f,u),h!=null&&Bt(h)}}async fitLoop(t,n,r,i,s,a,o,l,u,c,f,h,d,p){i==null&&(i=32),s==null&&(s=1),c==null&&(c=!0),h==null&&(h=0);let g=!1;if(l!=null&&u!=null&&(g=!0),p!=null&&(g=!0,d==null))throw new re("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const m=this.checkNumSamples(n,i,d,"steps_per_epoch");let v;m!=null&&(v=Zc(0,m)),a==null&&(a=1);const{callbackList:y,history:b}=EDe(o,a,s,h,m,d,i,g,f);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let x=h;x<s;++x){await y.onEpochBegin(x);const w={};if(d!=null)throw new Tt("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Tt("batch shuffling is not implemneted yet");c&&Jee(v);const C=so(v),$=yj(m,i);for(let _=0;_<$.length;++_){const k={};if(await y.onBatchBegin(_,k),ce(()=>{const E=$[_][0],S=$[_][1],N=Q1(C,E,S-E);k.batch=_,k.size=S-E;const A=tX(n,N),D=t(A);for(let T=0;T<r.length;++T){const I=r[T],F=D[T];k[I]=F,Uc(F)}if(_===$.length-1&&g){const T=this.testLoop(l,u,i);for(let I=0;I<r.length;++I){const F=r[I],R=T[I];Uc(R),w["val_"+F]=R}}}),await y.onBatchEnd(_,k),SDe(k),this.stopTraining_)break}C.dispose()}if(await y.onEpochEnd(x,w),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(t,n){return Zbt(this,t,n)}async trainOnBatch(t,n){const r=await this.standardizeUserData(t,n),i=r[0],s=r[1],o=this.makeTrainFunction()(i.concat(s)),l=[];for(const u of o){const c=await u.data();l.push(c[0])}return Bt(o),ic(r[0],t),ic(r[1],n),Ya(l)}getNamedWeights(t){const n=[],r=t!=null&&t.trainableOnly,i=r?this.trainableWeights:this.weights,s=this.getWeights(r);for(let a=0;a<i.length;++a)r&&!i[a].trainable||n.push({name:i[a].originalName,tensor:s[a]});return n}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=T5().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=n-T5().numTensors}return t}getLossIdentifiers(){let t;if(typeof this.loss=="string")t=Bd(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(n=>Bd(n))}else{const n=Object.keys(this.loss);t={};const r=this.loss;for(const i of n)if(typeof r[i]=="string")t[i]=Bd(r[i]);else throw new Error("Serialization of non-string loss is not supported.")}return t}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Bd(lO(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>Bd(lO(t)));{const t={};for(const n in this.metrics)t[n]=Bd(lO(this.metrics[n]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=JY(t.optimizer_config),r=yp(n);let i;if(typeof t.loss=="string")i=i1(t.loss);else if(Array.isArray(t.loss))i=t.loss.map(a=>i1(a));else if(t.loss!=null){i={};for(const a in t.loss)i[a]=i1(t.loss[a])}let s;if(Array.isArray(t.metrics))s=t.metrics.map(a=>i1(a));else if(t.metrics!=null){s={};for(const a in t.metrics)s[a]=i1(t.metrics[a])}this.compile({loss:i,metrics:s,optimizer:r})}async save(t,n){if(typeof t=="string"){const u=zAe(t);if(u.length===0)throw new re(`Cannot find any save handlers for URL '${t}'`);if(u.length>1)throw new re(`Found more than one (${u.length}) save handlers for URL '${t}'`);t=u[0]}if(t.save==null)throw new re("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await OY(this.getNamedWeights(n)),i=!1,s=null,o={modelTopology:this.toJSON(s,i),format:sxt,generatedBy:`TensorFlow.js tfjs-layers v${FDe}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:c,specs:f}=await OY(await this.optimizer.getWeights(),u);r.specs.push(...f),r.data=RAe([r.data,c])}return this.userDefinedMetadata!=null&&(jge(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=r.data,o.weightSpecs=r.specs,t.save(o)}setUserDefinedMetadata(t){jge(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}J1.className="Model";Ee(J1);class BDe extends J1{}BDe.className="Functional";Ee(BDe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class TT extends J1{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:w7("sequential_"),t.layers!=null)for(const n of t.layers)this.add(n)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new re(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const n=t instanceof TT||t instanceof J1;let r;if(n){if(r=t,r.outputs.length!==1)throw new re("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new re("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new re("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const i=xDe({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(i)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(t.inboundNodes.length!==1)throw new re(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new re("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=bDe(this.outputs[0])}this.inboundNodes=[],new C7({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:By(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(i=>i.shape),outputShapes:this.outputs[0].shape})}else{const i=t.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,n){return this.model==null&&this.build(),this.model.call(t,n)}build(t){if(cn(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new J1({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,n,r=console.log){this.built||this.build(),super.summary(t,n,r)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,n,r={}){if(!this.built)throw new vu("The model needs to be compiled before being used.");return this.model.evaluate(t,n,r)}async evaluateDataset(t,n){if(!this.built)throw new vu("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,n)}predict(t,n={}){return this.model==null&&this.build(),this.model.predict(t,n)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,n,r={}){if(!this.built)throw new vu("The model needs to be compiled before being used.");return this.model.fit(t,n,r)}async fitDataset(t,n){if(!this.built)throw new vu("The model needs to be compiled before being used.");return this.model.fitDataset(t,n)}async trainOnBatch(t,n){return this.model.trainOnBatch(t,n)}static fromConfig(t,n,r={},i=!1){let s,a={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new re("Legacy serialization format not supported yet.");s=n}else B(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),s=n.layers,delete n.layers,a=n;const o=new t(a);if(!(o instanceof TT))throw new Tt(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const l of s){const c=yp(l,void 0,i);i&&c.setFastWeightInitDuringBuild(!0),o.add(c)}return o}set stopTraining(t){if(this.model==null)throw new re("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new re("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),t.push(r)}return{name:this.name,layers:t}}}TT.className="Sequential";Ee(TT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function axt(e){return new J1(e)}function oxt(e){return xDe(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ko extends Gb{getConfig(){return{}}}class zDe extends ko{apply(t,n=1){return Xyt(t,n)}}zDe.className="elu";Ee(zDe);class UDe extends ko{apply(t){return Fte(t)}}UDe.className="selu";Ee(UDe);class WDe extends ko{apply(t){return id(t)}}WDe.className="relu";Ee(WDe);class VDe extends ko{apply(t){return ce(()=>Py(6,id(t)))}}VDe.className="relu6";Ee(VDe);class jDe extends ko{apply(t){return t}}jDe.className="linear";Ee(jDe);class HDe extends ko{apply(t){return ih(t)}}HDe.className="sigmoid";Ee(HDe);class qDe extends ko{apply(t){return Zyt(t)}}qDe.className="hardSigmoid";Ee(qDe);class GDe extends ko{apply(t){return k_(t)}}GDe.className="softplus";Ee(GDe);class YDe extends ko{apply(t){return Kyt(t)}}YDe.className="softsign";Ee(YDe);class XDe extends ko{apply(t){return Ow(t)}}XDe.className="tanh";Ee(XDe);class Une extends ko{apply(t,n=-1){return r7(t,n)}}Une.className="softmax";Ee(Une);class KDe extends ko{apply(t,n=-1){return Cte(t,n)}}KDe.className="logSoftmax";Ee(KDe);class ZDe extends ko{apply(t,n=1){return ce(()=>ne(ih(ne(t,n)),t))}}ZDe.className="swish";Ee(ZDe);class QDe extends ko{apply(t){return ce(()=>ne(t,Ow(k_(t))))}}QDe.className="mish";Ee(QDe);function Y0(e){return e.getClassName()}function bj(e,t={}){return FI(e,El.getMap().classNameMap,t,"activation")}function X0(e){if(e==null){const t={};return t.className="linear",t.config={},bj(t)}if(typeof e=="string"){const t={};return t.className=e,t.config={},bj(t)}else return e instanceof ko?e:bj(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lxt(e){if(e!=null&&typeof e!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}class JDe extends Gb{}class eNe extends JDe{constructor(t){super(),lxt(t),this.l1=t==null||t.l1==null?.01:t.l1,this.l2=t==null||t.l2==null?.01:t.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(t){return ce(()=>{let n=di([1]);return this.hasL1&&(n=ke(n,qe(ne(this.l1,hi(t))))),this.hasL2&&(n=ke(n,qe(ne(this.l2,RI(t))))),ie(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,n){return new t({l1:n.l1,l2:n.l2})}}eNe.className="L1L2";Ee(eNe);const Kge={l1l2:"L1L2"};function Yn(e){return Ene(e)}function Zge(e,t={}){return FI(e,El.getMap().classNameMap,t,"regularizer")}function xr(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in Kge?Kge[e]:e,config:{}};return Zge(n)}else return e instanceof JDe?e:Zge(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class tNe extends Vt{constructor(t){super(t==null?{}:t),this.supportsMasking=!0,t!=null&&(this.maxValue=t.maxValue)}call(t,n){t=vt(t);let r=id(t);return this.maxValue!=null&&(r=sl(r,0,this.maxValue)),r}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},n=super.getConfig();return Object.assign(t,n),t}}tNe.className="ReLU";Ee(tNe);class nNe extends Vt{constructor(t){super(t==null?{}:t),this.DEFAULT_ALPHA=.3,t==null&&(t={}),this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const r=vt(t);return qz(r,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}nNe.className="LeakyReLU";Ee(nNe);class rNe extends Vt{constructor(t){if(super(t==null?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),this.supportsMasking=!0,this.alphaInitializer=yr(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=xr(t.alphaRegularizer),this.alphaConstraint=vi(t.alphaConstraint),t.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else if(typeof t.sharedAxes=="number")this.sharedAxes=[t.sharedAxes];else throw new re(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`)}build(t){t=cn(t);const n=t.slice(1);if(this.sharedAxes!=null)for(const i of this.sharedAxes)n[i-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let i=1;i<t.length;++i)r[i]=t[i];this.inputSpec=[new gi({ndim:t.length,axes:r})],this.built=!0}call(t,n){return t=vt(t),Jz(t,this.alpha.read())}getConfig(){const t={alphaInitializer:Tr(this.alphaInitializer),alphaRegularizer:Yn(this.alphaRegularizer),alphaConstraint:mi(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(t,n),t}}rNe.className="PReLU";Ee(rNe);class iNe extends Vt{constructor(t){if(super(t==null?{}:t),this.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==this.DEFAULT_ALPHA)throw new Tt(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const r=vt(t);return EI(r)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}iNe.className="ELU";Ee(iNe);class sNe extends Vt{constructor(t){super(t==null?{}:t),this.DEFAULT_THETA=1,t==null&&(t={}),this.theta=t.theta==null?this.DEFAULT_THETA:t.theta}call(t,n){const r=vt(t);return ne(r,Oe(yl(r,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},n=super.getConfig();return Object.assign(t,n),t}}sNe.className="ThresholdedReLU";Ee(sNe);class aNe extends Vt{constructor(t){super(t==null?{}:t),this.DEFAULT_AXIS=1,t==null&&(t={}),this.softmax=new Une().apply,this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis}call(t,n){const r=vt(t);return this.softmax(r,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}aNe.className="Softmax";Ee(aNe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function K2(e,t,n){if(typeof e=="number")return By(e,t);if(e.length!==t)throw new re(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let r=0;r<t;++r){const i=e[r];if(!Hyt(i))throw new re(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${i}`)}return e}function Wc(e,t,n,r,i=1){if(e==null)return e;const s=t+(t-1)*(i-1);let a;return n==="same"?a=e:a=e-s+1,Math.floor((a+r-1)/r)}function Pf(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+G0([n-t,0]);else if(r==="same")e=e*t;else throw new re(`Unsupport padding mode: ${r}.`);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Wne(e,t){return ce(()=>(ei(t),t==="channelsFirst"?Zt(e,[0,2,3,1]):e))}function oNe(e,t){return ce(()=>(ei(t),t==="channelsFirst"?Zt(e,[0,2,3,4,1]):e))}function uxt(e,t,n,r=1,i="valid",s,a=1){return ce(()=>{if(s==null&&(s=Qc()),ei(s),e.shape.length!==3)throw new re(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new re(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new re(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(s==="channelsFirst"&&(e=Zt(e,[0,2,1])),i==="causal")throw new Tt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=mte(e,t,r,i==="same"?"same":"valid","NWC",a);return n!=null&&(o=hf(o,n)),o})}function Qge(e,t,n,r=[1,1],i="valid",s,a,o=null){return ce(()=>{if(s==null&&(s=Qc()),ei(s),e.rank!==3&&e.rank!==4)throw new re(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new re(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let l=Wne(e,s);if(i==="causal")throw new Tt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=i3e({x:l,filter:t,strides:r,pad:i==="same"?"same":"valid",dilations:a,dataFormat:"NHWC",bias:n,activation:o}),s==="channelsFirst"&&(l=Zt(l,[0,3,1,2])),l})}function cxt(e,t,n,r=[1,1,1],i="valid",s,a){return ce(()=>{if(s==null&&(s=Qc()),ei(s),e.rank!==4&&e.rank!==5)throw new re(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new re(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let o=oNe(e,s);if(i==="causal")throw new Tt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=pTe(o,t,r,i==="same"?"same":"valid","NDHWC",a),n!=null&&(o=hf(o,n)),s==="channelsFirst"&&(o=Zt(o,[0,4,1,2,3])),o})}class k7 extends Vt{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",k7.verifyArgs(n),this.rank=t,Ai(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Tt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=K2(n.kernelSize,t,"kernelSize"),this.strides=K2(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,Jl(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,ei(this.dataFormat),this.activation=X0(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=yr(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=vi(n.biasConstraint),this.biasRegularizer=xr(n.biasRegularizer),this.activityRegularizer=xr(n.activityRegularizer),this.dilationRate=K2(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new re(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new re(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new re(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(Rf("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!Ane(t.kernelSize,"number",1,3))throw new re(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Y0(this.activation),useBias:this.useBias,biasInitializer:Tr(this.biasInitializer),biasRegularizer:Yn(this.biasRegularizer),activityRegularizer:Yn(this.activityRegularizer),biasConstraint:mi(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}class T_ extends k7{constructor(t,n){super(t,n),this.kernel=null,T_.verifyArgs(n),this.filters=n.filters,Ai(this.filters,"filters"),this.kernelInitializer=yr(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=vi(n.kernelConstraint),this.kernelRegularizer=xr(n.kernelRegularizer)}build(t){t=cn(t);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new re(`The channel dimension of the input should be defined. Found ${t[n]}`);const r=t[n],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(t,n){return ce(()=>{t=vt(t);let r;const i=this.bias==null?null:this.bias.read(),s=iDe(this.activation.getClassName());if(s!=null&&this.rank===2)r=Qge(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(this.rank===1)r=uxt(t,this.kernel.read(),i,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=Qge(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=cxt(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Tt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(t){t=cn(t);const n=[],r=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let s=0;s<r.length;++s){const a=Wc(r[s],this.kernelSize[s],this.padding,this.strides[s],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[s]);n.push(a)}let i=[t[0]];return this.dataFormat==="channelsLast"?(i=i.concat(n),i.push(this.filters)):(i.push(this.filters),i=i.concat(n)),i}getConfig(){const t={filters:this.filters,kernelInitializer:Tr(this.kernelInitializer),kernelRegularizer:Yn(this.kernelRegularizer),kernelConstraint:mi(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new re(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class zI extends T_{constructor(t){super(2,t),zI.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!Ane(t.kernelSize,"number",1,2))throw new re(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}zI.className="Conv2D";Ee(zI);class UI extends T_{constructor(t){super(3,t),UI.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new re(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}UI.className="Conv3D";Ee(UI);class lNe extends zI{constructor(t){if(super(t),this.inputSpec=[new gi({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new re(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=cn(t),t.length!==4)throw new re("Input should have rank 4; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new re("The channel dimension of the inputs should be defined. Found `None`.");const r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new gi({ndim:4,axes:{[n]:r}})],this.built=!0}call(t,n){return ce(()=>{let r=vt(t);if(r.shape.length!==4)throw new re(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const i=r.shape,s=i[0];let a,o;this.dataFormat==="channelsFirst"?(a=2,o=3):(a=1,o=2);const l=i[a],u=i[o],c=this.kernelSize[0],f=this.kernelSize[1],h=this.strides[0],d=this.strides[1],p=Pf(l,h,c,this.padding),g=Pf(u,d,f,this.padding),m=[s,p,g,this.filters];this.dataFormat!=="channelsLast"&&(r=Zt(r,[0,2,3,1]));let v=yte(r,this.kernel.read(),m,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(v=Zt(v,[0,3,1,2])),this.bias!=null&&(v=hf(v,this.bias.read(),this.dataFormat)),this.activation!=null&&(v=this.activation.apply(v)),v})}computeOutputShape(t){t=cn(t);const n=t.slice();let r,i,s;this.dataFormat==="channelsFirst"?(r=1,i=2,s=3):(r=3,i=1,s=2);const a=this.kernelSize[0],o=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return n[r]=this.filters,n[i]=Pf(n[i],l,a,this.padding),n[s]=Pf(n[s],u,o,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}lNe.className="Conv2DTranspose";Ee(lNe);class uNe extends UI{constructor(t){if(super(t),this.inputSpec=[new gi({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new re(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=cn(t),t.length!==5)throw new re("Input should have rank 5; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new re("The channel dimension of the inputs should be defined. Found `None`.");const r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new gi({ndim:5,axes:{[n]:r}})],this.built=!0}call(t,n){return ce(()=>{let r=vt(t);if(r.shape.length!==5)throw new re(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const i=r.shape,s=i[0];let a,o,l;this.dataFormat==="channelsFirst"?(l=2,a=3,o=4):(l=1,a=2,o=3);const u=i[l],c=i[a],f=i[o],h=this.kernelSize[0],d=this.kernelSize[1],p=this.kernelSize[2],g=this.strides[0],m=this.strides[1],v=this.strides[2],y=Pf(u,g,h,this.padding),b=Pf(c,m,d,this.padding),x=Pf(f,v,p,this.padding),w=[s,y,b,x,this.filters];this.dataFormat!=="channelsLast"&&(r=Zt(r,[0,2,3,4,1]));let C=mTe(r,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(C=Zt(C,[0,4,1,2,3])),this.bias!==null&&(C=hf(C,this.bias.read(),this.dataFormat)),this.activation!==null&&(C=this.activation.apply(C)),C})}computeOutputShape(t){t=cn(t);const n=t.slice();let r,i,s,a;this.dataFormat==="channelsFirst"?(r=1,i=2,s=3,a=4):(r=4,i=1,s=2,a=3);const o=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],f=this.strides[1],h=this.strides[2];return n[r]=this.filters,n[i]=Pf(n[i],c,o,this.padding),n[s]=Pf(n[s],f,l,this.padding),n[a]=Pf(n[a],h,u,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}uNe.className="Conv3DTranspose";Ee(uNe);class cNe extends T_{constructor(t,n){if(super(t,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new re("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new re("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new re(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=yr(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=xr(n.depthwiseRegularizer),this.depthwiseConstraint=vi(n.depthwiseConstraint),this.pointwiseInitializer=yr(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=xr(n.pointwiseRegularizer),this.pointwiseConstraint=vi(n.pointwiseConstraint)}build(t){if(t=cn(t),t.length<this.rank+2)throw new re(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null||t[n]<0)throw new re(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[n])}`);const r=t[n],i=this.kernelSize.concat([r,this.depthMultiplier]),s=[];for(let o=0;o<this.rank;++o)s.push(1);s.push(r*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new gi({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(t,n){return ce(()=>{t=vt(t);let r;if(this.rank===1)throw new Tt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(t=Zt(t,[0,2,3,1])),r=Ote(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=hf(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=Zt(r,[0,3,1,2])),r})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=Tr(this.depthwiseInitializer),t.pointwiseInitializer=Tr(this.pointwiseInitializer),t.depthwiseRegularizer=Yn(this.depthwiseRegularizer),t.pointwiseRegularizer=Yn(this.pointwiseRegularizer),t.depthwiseConstraint=mi(this.depthwiseConstraint),t.pointwiseConstraint=mi(this.pointwiseConstraint),t}}cNe.className="SeparableConv";class fNe extends cNe{constructor(t){super(2,t)}}fNe.className="SeparableConv2D";Ee(fNe);class E7 extends T_{constructor(t){super(1,t),E7.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!Ane(t.kernelSize,"number",1,1))throw new re(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}E7.className="Conv1D";Ee(E7);class hNe extends Vt{constructor(t){super(t),typeof t.cropping=="number"?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,n){return ce(()=>{if(t=vt(t),this.dataFormat==="channelsLast"){const r=oO(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return oO(r,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=oO(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return oO(r,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}hNe.className="Cropping2D";Ee(hNe);class dNe extends Vt{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=t.size==null?this.DEFAULT_SIZE:t.size,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,ei(this.dataFormat),this.interpolation=t.interpolation==null?"nearest":t.interpolation,Wyt(this.interpolation)}computeOutputShape(t){if(this.dataFormat==="channelsFirst"){const n=t[2]==null?null:this.size[0]*t[2],r=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],n,r]}else{const n=t[1]==null?null:this.size[0]*t[1],r=t[2]==null?null:this.size[1]*t[2];return[t[0],n,r,t[3]]}}call(t,n){return ce(()=>{let r=vt(t);const i=r.shape;if(this.dataFormat==="channelsFirst"){r=Zt(r,[0,2,3,1]);const s=this.size[0]*i[2],a=this.size[1]*i[3],o=this.interpolation==="nearest"?Jf.resizeNearestNeighbor(r,[s,a]):Jf.resizeBilinear(r,[s,a]);return Zt(o,[0,3,1,2])}else{const s=this.size[0]*i[1],a=this.size[1]*i[2];return this.interpolation==="nearest"?Jf.resizeNearestNeighbor(r,[s,a]):Jf.resizeBilinear(r,[s,a])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}}dNe.className="UpSampling2D";Ee(dNe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fxt(e,t,n=[1,1],r="valid",i,s){return ce(()=>{i==null&&(i=Qc()),ei(i);let a=Wne(e,i);if(e.rank!==4)throw new re(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new re(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return a=kI(a,t,n,r==="same"?"same":"valid","NHWC",s),i==="channelsFirst"&&(a=Zt(a,[0,3,1,2])),a})}class pNe extends k7{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=yr(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=vi(t.depthwiseConstraint),this.depthwiseRegularizer=xr(t.depthwiseRegularizer)}build(t){if(t=cn(t),t.length<4)throw new re(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(t[n]==null||t[n]<0)throw new re(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[n]}).`);const r=t[n],i=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",i,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return ce(()=>{t=vt(t);let r=fxt(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=hf(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(t){t=cn(t);const n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,s=Wc(n,this.kernelSize[0],this.padding,this.strides[0]),a=Wc(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],i,s,a]:[t[0],s,a,i]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=Tr(this.depthwiseInitializer),t.depthwiseRegularizer=Yn(this.depthwiseRegularizer),t.depthwiseConstraint=mi(this.depthwiseRegularizer),t}}pNe.className="DepthwiseConv2D";Ee(pNe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gNe(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new re("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(s){return s==null||Array.isArray(s)?s:[s]}return t=i(t),n=i(n),{inputs:e,initialState:t,constants:n}}function mNe(e,t,n,r=!1,i,s,a=!1,o=!1){return ce(()=>{const l=t.shape.length;if(l<3)throw new re(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(Zc(2,l));if(t=Zt(t,u),s!=null)throw new Tt("The rnn() functoin of the deeplearn.js backend does not support constants yet.");a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&(i=Oe(Oe(i,"bool"),"float32"),i.rank===l-1&&(i=Ga(i,-1)),i=Zt(i,u)),r&&(t=Ru(t,0),i!=null&&(i=Ru(i,0)));const c=[];let f,h=n;const d=t.shape[0],p=q0(t);let g;i!=null&&(g=q0(i));for(let v=0;v<d;++v){const y=p[v],b=ce(()=>e(y,h));if(i==null)f=b[0],h=b[1];else{const x=ce(()=>{const w=g[v],C=We(Hl(w),w),$=ke(ne(b[0],w),ne(h[0],C)),_=h.map((k,E)=>ke(ne(b[1][E],w),ne(k,C)));return{output:$,newStates:_}});f=x.output,h=x.newStates}o&&c.push(f)}let m;return o&&(m=Mp(c,1)),[f,m,h]})}class Ym extends Vt{constructor(t){super(t);let n;if(t.cell==null)throw new re("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?n=new Hne({cells:t.cell}):n=t.cell,n.stateSize==null)throw new re("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new gi({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Zc(0,t).map(n=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){KY(t)&&(t=t[0]),t=t;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let i;if(this.returnSequences?i=[t[0],t[1],r]:i=[t[0],r],this.returnState){const s=[];for(const a of n)s.push([t[0],a]);return[i].concat(s)}else return i}computeMask(t,n){return ce(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const i=this.states.map(s=>null);return[r].concat(i)}else return r})}get states(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<t;++r)n.push(null);return n}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new Tt("Constants support is not implemented in RNN yet.");KY(t)&&(t=t[0]),t=t;const n=this.stateful?t[0]:null,r=t.slice(2);this.inputSpec[0]=new gi({shape:[n,null,...r]});const i=[t[0]].concat(t.slice(2));this.cell.build(i);let s;if(Array.isArray(this.cell.stateSize)?s=this.cell.stateSize:s=[this.cell.stateSize],this.stateSpec!=null){if(!Qt(this.stateSpec.map(a=>a.shape[a.shape.length-1]),s))throw new re(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=s.map(a=>new gi({shape:[null,a]}));this.stateful&&this.resetStates()}resetStates(t,n=!1){ce(()=>{if(!this.stateful)throw new Of("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new re("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>di([r,i])):this.states_=[di([r,this.cell.stateSize])];else if(t==null)Bt(this.states_),this.keptStates!=null&&(Bt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>di([r,i])):this.states_[0]=di([r,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new re(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n===!0?this.keptStates.push(this.states_.slice()):Bt(this.states_);for(let i=0;i<this.states_.length;++i){const s=t[i],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[i]:this.cell.stateSize,o=[r,a];if(!Qt(s.shape,o))throw new re(`State ${i} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${s.shape}`);this.states_[i]=s}}this.states_=this.states_.map(i=>Uc(i.clone()))})}apply(t,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const s=gNe(t,r,i,this.numConstants);t=s.inputs,r=s.initialState,i=s.constants;let a=[],o=[];if(r!=null){n.initialState=r,a=a.concat(r),this.stateSpec=[];for(const u of r)this.stateSpec.push(new gi({shape:u.shape}));o=o.concat(this.stateSpec)}if(i!=null&&(n.constants=i,a=a.concat(i),this.numConstants=i.length),a[0]instanceof eh){const u=[t].concat(a),c=this.inputSpec.concat(o),f=this.inputSpec;this.inputSpec=c;const h=super.apply(u,n);return this.inputSpec=f,h}else return super.apply(t,n)}call(t,n){return ce(()=>{const r=n==null?null:n.mask,i=n==null?null:n.training;let s=n==null?null:n.initialState;t=vt(t),s==null&&(this.stateful?s=this.states_:s=this.getInitialState(t));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==a)throw new re(`RNN Layer has ${a} state(s) but was passed ${s.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:i},u=mNe((p,g)=>{const m=this.cell.call([p].concat(g),o);return[m[0],m.slice(1)]},t,s,this.goBackwards,r,null,this.unroll,this.returnSequences),c=u[0],f=u[1],h=u[2];this.stateful&&this.resetStates(h,i);const d=this.returnSequences?f:c;return this.returnState?[d].concat(h):d})}getInitialState(t){return ce(()=>{let n=di(t.shape);return n=qe(n,[1,2]),n=OI(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?YY(n,[1,r]):n):this.cell.stateSize>1?[YY(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===Ym.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),t),n)}static fromConfig(t,n,r={}){const i=n.cell,s=yp(i,r);return new t(Object.assign(n,{cell:s}))}}Ym.className="RNN";Ee(Ym);class A7 extends Vt{}class Vne extends A7{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Ai(this.units,"units"),this.activation=X0(t.activation==null?this.DEFAULT_ACTIVATION:t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=yr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=yr(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=yr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=xr(t.kernelRegularizer),this.recurrentRegularizer=xr(t.recurrentRegularizer),this.biasRegularizer=xr(t.biasRegularizer),this.kernelConstraint=vi(t.kernelConstraint),this.recurrentConstraint=vi(t.recurrentConstraint),this.biasConstraint=vi(t.biasConstraint),this.dropout=Lw([1,G0([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Lw([1,G0([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=cn(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return ce(()=>{if(t=t,t.length!==2)throw new re(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let r=t[1];t=t[0];const i=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=K0({ones:()=>Hl(t),rate:this.dropout,training:i,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=K0({ones:()=>Hl(r),rate:this.recurrentDropout,training:i,dropoutFunc:this.dropoutFunc}));let s;const a=this.dropoutMask,o=this.recurrentDropoutMask;a!=null?s=oh(ne(t,a),this.kernel.read()):s=oh(t,this.kernel.read()),this.bias!=null&&(s=hf(s,this.bias.read())),o!=null&&(r=ne(r,o));let l=ke(s,oh(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Y0(this.activation),useBias:this.useBias,kernelInitializer:Tr(this.kernelInitializer),recurrentInitializer:Tr(this.recurrentInitializer),biasInitializer:Tr(this.biasInitializer),kernelRegularizer:Yn(this.kernelRegularizer),recurrentRegularizer:Yn(this.recurrentRegularizer),biasRegularizer:Yn(this.biasRegularizer),activityRegularizer:Yn(this.activityRegularizer),kernelConstraint:mi(this.kernelConstraint),recurrentConstraint:mi(this.recurrentConstraint),biasConstraint:mi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},t),n)}}Vne.className="SimpleRNNCell";Ee(Vne);class vNe extends Ym{constructor(t){t.cell=new Vne(t),super(t)}call(t,n){return ce(()=>{this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}static fromConfig(t,n){return new t(n)}}vNe.className="SimpleRNN";Ee(vNe);class jne extends A7{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new re("GRUCell does not support reset_after parameter set to true.");this.units=t.units,Ai(this.units,"units"),this.activation=X0(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=X0(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=yr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=yr(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=yr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=xr(t.kernelRegularizer),this.recurrentRegularizer=xr(t.recurrentRegularizer),this.biasRegularizer=xr(t.biasRegularizer),this.kernelConstraint=vi(t.kernelConstraint),this.recurrentConstraint=vi(t.recurrentConstraint),this.biasConstraint=vi(t.biasConstraint),this.dropout=Lw([1,G0([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Lw([1,G0([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=cn(t);const n=t[t.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return ce(()=>{if(t=t,t.length!==2)throw new re(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const r=n.training==null?!1:n.training;let i=t[1];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=K0({ones:()=>Hl(t),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=K0({ones:()=>Hl(i),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,a=this.recurrentDropoutMask;let o,l,u;0<this.dropout&&this.dropout<1&&(t=ne(t,s[0]));let c=oh(t,this.kernel.read());this.useBias&&(c=hf(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=ne(i,a[0]));const f=this.recurrentKernel.read(),[h,d]=Jo(f,[2*this.units,this.units],f.rank-1),p=oh(i,h),[g,m,v]=Jo(c,3,c.rank-1),[y,b]=Jo(p,2,p.rank-1);o=this.recurrentActivation.apply(ke(g,y)),l=this.recurrentActivation.apply(ke(m,b));const x=oh(ne(l,i),d);u=this.activation.apply(ke(v,x));const w=ke(ne(o,i),ne(ke(1,ur(o)),u));return[w,w]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Y0(this.activation),recurrentActivation:Y0(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Tr(this.kernelInitializer),recurrentInitializer:Tr(this.recurrentInitializer),biasInitializer:Tr(this.biasInitializer),kernelRegularizer:Yn(this.kernelRegularizer),recurrentRegularizer:Yn(this.recurrentRegularizer),biasRegularizer:Yn(this.biasRegularizer),activityRegularizer:Yn(this.activityRegularizer),kernelConstraint:mi(this.kernelConstraint),recurrentConstraint:mi(this.recurrentConstraint),biasConstraint:mi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},t),n)}}jne.className="GRUCell";Ee(jne);class yNe extends Ym{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new jne(t),super(t)}call(t,n){return ce(()=>{this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}yNe.className="GRU";Ee(yNe);class T7 extends A7{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Ai(this.units,"units"),this.activation=X0(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=X0(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=yr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=yr(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=yr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=xr(t.kernelRegularizer),this.recurrentRegularizer=xr(t.recurrentRegularizer),this.biasRegularizer=xr(t.biasRegularizer),this.kernelConstraint=vi(t.kernelConstraint),this.recurrentConstraint=vi(t.recurrentConstraint),this.biasConstraint=vi(t.biasConstraint),this.dropout=Lw([1,G0([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Lw([1,G0([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var n;t=cn(t);const r=t[t.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let i;if(this.useBias){if(this.unitForgetBias){const s=this.biasInitializer,a=this.units;i=new(n=class extends Yu{apply(l,u){const c=s.apply([a]),f=new Dne().apply([a]),h=s.apply([a*2]);return Oge(Oge(c,f),h)}},n.className="CustomInit",n)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,n){return ce(()=>{const r=n.training==null?!1:n.training;if(t=t,t.length!==3)throw new re(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let i=t[1];const s=t[2];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=K0({ones:()=>Hl(t),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=K0({ones:()=>Hl(i),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,o=this.recurrentDropoutMask;let l,u,c,f;0<this.dropout&&this.dropout<1&&(t=ne(t,a[0]));let h=oh(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=ne(i,o[0])),h=ke(h,oh(i,this.recurrentKernel.read())),this.useBias&&(h=hf(h,this.bias.read()));const[d,p,g,m]=Jo(h,4,h.rank-1);l=this.recurrentActivation.apply(d),u=this.recurrentActivation.apply(p),c=ke(ne(u,s),ne(l,this.activation.apply(g))),f=this.recurrentActivation.apply(m);const v=ne(f,this.activation.apply(c));return[v,v,c]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Y0(this.activation),recurrentActivation:Y0(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Tr(this.kernelInitializer),recurrentInitializer:Tr(this.recurrentInitializer),biasInitializer:Tr(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Yn(this.kernelRegularizer),recurrentRegularizer:Yn(this.recurrentRegularizer),biasRegularizer:Yn(this.biasRegularizer),activityRegularizer:Yn(this.activityRegularizer),kernelConstraint:mi(this.kernelConstraint),recurrentConstraint:mi(this.recurrentConstraint),biasConstraint:mi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},t),n)}}T7.className="LSTMCell";Ee(T7);class bNe extends Ym{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new T7(t),super(t)}call(t,n){return ce(()=>{this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}bNe.className="LSTM";Ee(bNe);class Hne extends A7{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?t.push(...n.stateSize):t.push(n.stateSize);return t}call(t,n){return ce(()=>{t=t;let r=t.slice(1);const i=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?i.push(r.splice(0,o.stateSize.length)):i.push(r.splice(0,1));i.reverse();const s=[];let a;for(let o=0;o<this.cells.length;++o){const l=this.cells[o];r=i[o],o===0?a=[t[0]].concat(r):a=[a[0]].concat(r),a=l.call(a,n),s.push(a.slice(1))}r=[];for(const o of s.slice().reverse())r.push(...o);return[a[0]].concat(r)})}build(t){KY(t)&&(t=t[0]),t=t;let n;this.cells.forEach((r,i)=>{Z1(`RNNCell_${i}`,()=>{r.build(t),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,t=[t[0],n]})}),this.built=!0}getConfig(){const t=super.getConfig(),n=s=>({className:s.getClassName(),config:s.getConfig()}),i={cells:this.cells.map(n)};return Object.assign(Object.assign({},t),i)}static fromConfig(t,n,r={}){const i=[];for(const s of n.cells)i.push(yp(s,r));return new t({cells:i})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.cells)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(t)}return t}getWeights(){const t=[];for(const n of this.cells)t.push(...n.weights);return ZY(t)}setWeights(t){const n=[];for(const r of this.cells){const i=r.weights.length,s=t.splice(i);for(let a=0;a<r.weights.length;++a)n.push([r.weights[a],s[a]])}Pne(n)}}Hne.className="StackedRNNCells";Ee(Hne);function K0(e){const{ones:t,rate:n,training:r=!1,count:i=1,dropoutFunc:s}=e,a=()=>s!=null?s(t(),n):fDe(t(),n),o=()=>PI(a,t,r);return!i||i<=1?Uc(o().clone()):Array(i).fill(void 0).map(o).map(u=>Uc(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var hxt=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class xNe extends Ym{constructor(t){if(t.unroll)throw new Tt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new Tt("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new gi({ndim:5})]}call(t,n){return ce(()=>{if(this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new re("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}computeOutputShape(t){let n=this.computeSingleOutputShape(t);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([t[0],...n.slice(-3)])]),n}getInitialState(t){return ce(()=>{const{stateSize:n}=this.cell,r=t.shape,i=this.computeSingleOutputShape(r),s=[i[0],...i.slice(2)],a=di(s);return Array.isArray(n)?Array(n.length).fill(a):[a]})}resetStates(t,n=!1){ce(()=>{if(!this.stateful)throw new Of("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,i=this.computeSingleOutputShape(r),s=[i[0],...i.slice(2)];if(r[0]==null)throw new re("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>di(s)):this.states_=[di(s)];else if(t==null)Bt(this.states_),this.keptStates!=null&&(Bt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>di(s)):this.states_[0]=di(s);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new re(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n?this.keptStates.push(this.states_.slice()):Bt(this.states_);for(let o=0;o<this.states_.length;++o){const l=t[o],u=s;if(!Qt(l.shape,u))throw new re(`State ${o} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(o=>Uc(o.clone()))})}computeSingleOutputShape(t){const{dataFormat:n,filters:r,kernelSize:i,padding:s,strides:a,dilationRate:o}=this.cell,l=n==="channelsFirst",u=t[l?3:2],c=t[l?4:3],f=Wc(u,i[0],s,a[0],o[0]),h=Wc(c,i[1],s,a[1],o[1]);return[...t.slice(0,2),...l?[r,f,h]:[f,h,r]]}}xNe.className="ConvRNN2D";class qne extends T7{constructor(t){const{filters:n,kernelSize:r,strides:i,padding:s,dataFormat:a,dilationRate:o}=t;super(Object.assign(Object.assign({},t),{units:n})),this.filters=n,Ai(this.filters,"filters"),this.kernelSize=K2(r,2,"kernelSize"),this.kernelSize.forEach(l=>Ai(l,"kernelSize")),this.strides=K2(i||1,2,"strides"),this.strides.forEach(l=>Ai(l,"strides")),this.padding=s||"valid",Jl(this.padding),this.dataFormat=a||"channelsLast",ei(this.dataFormat),this.dilationRate=K2(o||1,2,"dilationRate"),this.dilationRate.forEach(l=>Ai(l,"dilationRate"))}build(t){var n;t=cn(t);const r=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[r]==null)throw new re(`The channel dimension of the input should be defined. Found ${t[r]}`);const i=t[r],s=4,a=this.kernelSize.concat([i,this.filters*s]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*s]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,c=this.filters;l=new(n=class extends Yu{apply(h,d){const p=u.apply([c]),g=Dl([c]),m=u.apply([c*2]);return Tne([p,g,m])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*s],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,n){return ce(()=>{if(t.length!==3)throw new re(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const r=n.training||!1,i=t[0],s=t[1],a=t[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=K0({ones:()=>Hl(i),rate:this.dropout,training:r,count:o,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(V,z,q)=>!z||!z[q]?V:ne(z[q],V);let c=u(i,l,0),f=u(i,l,1),h=u(i,l,2),d=u(i,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=K0({ones:()=>Hl(s),rate:this.recurrentDropout,training:r,count:o,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let g=u(s,p,0),m=u(s,p,1),v=u(s,p,2),y=u(s,p,3);const b=3,[x,w,C,$]=Jo(this.kernel.read(),o,b),[_,k,E,S]=this.useBias?Jo(this.bias.read(),o):[null,null,null,null];c=this.inputConv(c,x,_,this.padding),f=this.inputConv(f,w,k,this.padding),h=this.inputConv(h,C,E,this.padding),d=this.inputConv(d,$,S,this.padding);const[N,A,D,T]=Jo(this.recurrentKernel.read(),o,b);g=this.recurrentConv(g,N),m=this.recurrentConv(m,A),v=this.recurrentConv(v,D),y=this.recurrentConv(y,T);const I=this.recurrentActivation.apply(ke(c,g)),F=this.recurrentActivation.apply(ke(f,m)),R=ke(ne(F,a),ne(I,this.activation.apply(ke(h,v)))),P=ne(this.recurrentActivation.apply(ke(d,y)),this.activation.apply(R));return[P,P,R]})}getConfig(){const t=super.getConfig(),n=hxt(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(t,n,r,i){const s=j0(t,n,this.strides,i||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?hf(s,r,this.dataFormat):s}recurrentConv(t,n){return j0(t,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}qne.className="ConvLSTM2DCell";Ee(qne);class wNe extends xNe{constructor(t){const n=new qne(t);super(Object.assign(Object.assign({},t),{cell:n}))}static fromConfig(t,n){return new t(n)}}wNe.className="ConvLSTM2D";Ee(wNe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Gne extends Vt{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(this.noiseShape==null)return this.noiseShape;const n=t.shape,r=[];for(let i=0;i<this.noiseShape.length;++i)r.push(this.noiseShape[i]==null?n[i]:this.noiseShape[i]);return r}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t);if(0<this.rate&&this.rate<1){const i=n.training==null?!1:n.training,s=this.getNoiseShape(r);return PI(()=>fDe(r,this.rate,s,this.seed),()=>r,i)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(t,n),t}dispose(){return super.dispose()}}Gne.className="Dropout";Ee(Gne);class $Ne extends Gne{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const n=t.shape;return[n[0],1,n[2]]}}$Ne.className="SpatialDropout1D";Ee($Ne);class Yne extends Vt{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){let n=null;t.batchSize!=null&&(n=t.batchSize),this.batchInputShape=[n,t.inputDim]}this.units=t.units,Ai(this.units,"units"),this.activation=X0(t.activation),t.useBias!=null&&(this.useBias=t.useBias),this.kernelInitializer=yr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=yr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=vi(t.kernelConstraint),this.biasConstraint=vi(t.biasConstraint),this.kernelRegularizer=xr(t.kernelRegularizer),this.biasRegularizer=xr(t.biasRegularizer),this.activityRegularizer=xr(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=cn(t);const n=t[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(t){t=cn(t);const n=t.slice();return n[n.length-1]=this.units,n}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t),i=iDe(this.activation.getClassName());let s;return i!=null?s=oh(r,this.kernel.read(),i,this.bias?this.bias.read():null):(s=oh(r,this.kernel.read()),this.bias!=null&&(s=hf(s,this.bias.read())),this.activation!=null&&(s=this.activation.apply(s))),s})}getConfig(){const t={units:this.units,activation:Y0(this.activation),useBias:this.useBias,kernelInitializer:Tr(this.kernelInitializer),biasInitializer:Tr(this.biasInitializer),kernelRegularizer:Yn(this.kernelRegularizer),biasRegularizer:Yn(this.biasRegularizer),activityRegularizer:Yn(this.activityRegularizer),kernelConstraint:mi(this.kernelConstraint),biasConstraint:mi(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}Yne.className="Dense";Ee(Yne);class CNe extends Vt{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=cn(t);for(const n of t.slice(1))if(n==null)throw new re(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],b0(t,1)]}call(t,n){return ce(()=>{this.invokeCallHook(t,n);let r=vt(t);if(this.dataFormat==="channelsFirst"&&r.rank>1){const i=[0];for(let s=2;s<r.rank;++s)i.push(s);i.push(1),r=Zt(r,i)}return Yyt(r)})}getConfig(){const t={};this.dataFormat!=null&&(t.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(t,n),t}}CNe.className="Flatten";Ee(CNe);class _Ne extends Vt{constructor(t){super(t),this.supportsMasking=!0,this.activation=X0(t.activation)}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t);return this.activation.apply(r)})}getConfig(){const t={activation:Y0(this.activation)},n=super.getConfig();return Object.assign(t,n),t}}_Ne.className="Activation";Ee(_Ne);class SNe extends Vt{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,n){return ce(()=>(t=vt(t),qyt(t,this.n)))}getConfig(){const t={n:this.n},n=super.getConfig();return Object.assign(t,n),t}}SNe.className="RepeatVector";Ee(SNe);class kNe extends Vt{constructor(t){super(t),this.targetShape=t.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(t){return t<0||t==null}fixUnknownDimension(t,n){const r="Total size of new array must be unchanged.",i=n.slice();let s=1,a=null;for(let l=0;l<i.length;++l){const u=i[l];if(this.isUnknown(u))if(a===null)a=l;else throw new re("Can only specifiy one unknown dimension.");else s*=u}const o=b0(t);if(a!==null){if(s===0||o%s!==0)throw new re(r);i[a]=o/s}else if(o!==s)throw new re(r);return i}computeOutputShape(t){let n=!1;for(let r=0;r<t.length;++r)if(this.isUnknown(t[r])){n=!0;break}return n?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t),i=r.shape,s=i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape));return ie(r,s)})}getConfig(){const t={targetShape:this.targetShape},n=super.getConfig();return Object.assign(t,n),t}}kNe.className="Reshape";Ee(kNe);class ENe extends Vt{constructor(t){if(super(t),t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const n=Zc(1,t.dims.length+1);if(!Qt(t.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new gi({ndim:this.dims.length+1})]}computeOutputShape(t){t=cn(t);const n=t.slice();return this.dims.forEach((r,i)=>{n[i+1]=t[r]}),n}call(t,n){return Zt(vt(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},n=super.getConfig();return Object.assign(t,n),t}}ENe.className="Permute";Ee(ENe);class ANe extends Vt{constructor(t){super(t==null?{}:t),this.supportsMasking=!0,t!=null?this.maskValue=t.maskValue==null?0:t.maskValue:this.maskValue=0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,t),n}computeMask(t,n){const r=vt(t),i=-1;return D5(Rw(r,this.maskValue),i)}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t),i=-1,s=!0,a=D5(Rw(r,this.maskValue),i,s);return ne(r,Oe(a,r.dtype))})}}ANe.className="Masking";Ee(ANe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class TNe extends Vt{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){let n=null;t.batchSize!=null&&(n=t.batchSize),t.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(sr(t.inputLength))}this.inputDim=t.inputDim,Ai(this.inputDim,"inputDim"),this.outputDim=t.outputDim,Ai(this.outputDim,"outputDim"),this.embeddingsInitializer=yr(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=xr(t.embeddingsRegularizer),this.activityRegularizer=xr(t.activityRegularizer),this.embeddingsConstraint=vi(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,n){return ce(()=>this.maskZero?(t=vt(t),Rw(t,en(t))):null)}computeOutputShape(t){if(t=cn(t),this.inputLength==null)return[...t,this.outputDim];const n=sr(this.inputLength);if(n.length!==t.length-1)throw new re(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let r=0;for(let i=0;i<n.length;++i){const s=n[i],a=t[i+1];if(s!=null&&a!=null&&s!==a)throw new re(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);s==null&&(n[r]=a),r++}}return[t[0],...n,this.outputDim]}call(t,n){return ce(()=>{this.invokeCallHook(t,n);let r=vt(t);r.dtype!=="int32"&&(r=ah(r,"int32"));const i=cDe(this.embeddings.read(),ie(r,[r.size]));return ie(i,cn(this.computeOutputShape(r.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Tr(this.embeddingsInitializer),embeddingsRegularizer:Yn(this.embeddingsRegularizer),activityRegularizer:Yn(this.activityRegularizer),embeddingsConstraint:mi(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(t,n),t}}TNe.className="Embedding";Ee(TNe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Xb extends Vt{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new Tt}computeElementwiseOpOutputShape(t,n){if(t==null||n==null)return null;if(t.length<n.length)return this.computeElementwiseOpOutputShape(n,t);if(n.length===0)return t;const r=t.slice(0,t.length-n.length);for(let i=0;i<n.length;++i){const s=t[t.length-n.length+i],a=n[i];if(s==null||a==null||s<0||a<0)r.push(null);else if(s===1)r.push(a);else if(a===1)r.push(s);else{if(s!==a)throw new re("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(n));r.push(s)}}return r}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[cn(t)]),t=t,t.length<2)throw new re(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let n=[];for(const s of t)s!=null&&s[0]!==null&&n.push(s[0]);if(n=y0(n),n.length>1)throw new re(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let r=t[0]==null?null:t[0].slice(1);for(let s=1;s<t.length;++s){const a=t[s]==null?null:t[s].slice(1);r=this.computeElementwiseOpOutputShape(r,a)}const i=t.map(s=>s.length);t.indexOf(null)===-1&&y0(i).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,n){return ce(()=>{if(t=t,this.reshapeRequired){const r=[],i=t.map(s=>s.rank);if(i.indexOf(null)===-1){const s=G0(i);for(let a of t){const o=a.rank;for(let l=0;l<s-o;++l)a=OI(a,1);r.push(a)}return this.mergeFunction(r)}else{let s=!1;for(const l of t){const u=l.rank;if(u==null){const c=l.shape,f=c[0],h=c.slice(1).concat([f]);let d=ie(l,[f].concat(b0(c.slice(1))));d=Zt(d,[1,0]),d=ie(d,h),r.push(d),s=!0}else if(u>1){const c=Zc(1,u).concat([0]);r.push(Zt(l,c)),s=!0}else r.push(l)}let a=this.mergeFunction(r);const o=a.rank;if(s){if(o==null){const l=a.shape,u=l.length,c=l[u-1],f=[c].concat(l.slice(0,l.length-1));a=ie(Zt(ie(a,[-1,c]),[1,0]),f)}else if(o>1){const l=[o-1].concat(Zc(0,o-1));a=Zt(a,l)}}return a}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let n;t[0]==null?n=null:n=t[0].slice(1);for(let i=1;i<t.length;++i){const s=t[i]==null?null:t[i].slice(1);n=this.computeElementwiseOpOutputShape(n,s)}let r=[];for(const i of t)i!=null&&i[0]!==null&&r.push(i[0]);return r=y0(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(t,n){return ce(()=>{if(n==null)return null;if(!Array.isArray(n))throw new re("`mask` should be an Array");if(!Array.isArray(t))throw new re("`inputs` should be an Array");if(n.length!==t.length)throw new re(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${n.length})`);if(n.every(i=>i==null))return null;n=n.map(i=>i==null?i:Ga(i,0));let r=n[0];for(let i=1;i<n.length-1;++i)r=Fh(r,n[i]);return r})}}class DNe extends Xb{constructor(t){super(t)}mergeFunction(t){return ce(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=ke(n,t[r]);return n})}}DNe.className="Add";Ee(DNe);class NNe extends Xb{constructor(t){super(t)}mergeFunction(t){return ce(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=ne(n,t[r]);return n})}}NNe.className="Multiply";Ee(NNe);class INe extends Xb{constructor(t){super(t)}mergeFunction(t){return ce(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=ke(n,t[r]);return ne(1/t.length,n)})}}INe.className="Average";Ee(INe);class MNe extends Xb{constructor(t){super(t)}mergeFunction(t){return ce(()=>{let n=t[0];for(let r=1;r<t.length;++r)n=ig(n,t[r]);return n})}}MNe.className="Maximum";Ee(MNe);class FNe extends Xb{constructor(t){super(t)}mergeFunction(t){return ce(()=>{let n=t[0];for(let r=1;r<t.length;++r)n=Py(n,t[r]);return n})}}FNe.className="Minimum";Ee(FNe);class Xne extends Xb{constructor(t){super(t),this.DEFAULT_AXIS=-1,t==null&&(t={}),this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!(Array.isArray(t)&&Array.isArray(t[0]))||t.length===1)throw new re("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let n=!0;for(const i of t)if(i!=null){n=!1;break}if(n)return;const r=[];for(let i=0;i<t.length;++i){const s=t[i].slice();s.splice(this.axis,1);let a=!1;for(const o of r)if(Qt(o,s)){a=!0;break}a||r.push(s)}if(r.length>1)throw new re("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return ce(()=>Tne(t,this.axis))}computeOutputShape(t){if(!(Array.isArray(t)&&Array.isArray(t[0])))throw new re("A `Concatenate` layer should be called on a list of inputs.");const n=t,r=n[0].slice(),i=this.axis<0?r.length+this.axis:this.axis;for(const s of n.slice(1)){if(r[i]==null||s[i]==null){r[i]=null;break}r[i]+=s[i]}return r}computeMask(t,n){if(n==null)return null;if(!Array.isArray(n))throw new re("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new re("`inputs` should be an array for Concatenate");if(n.length!==t.length)throw new re(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${t.length})`);return ce(()=>{let r=!0;if(n.forEach(a=>{if(a!=null){r=!1;return}}),r)return null;const i=[];for(let a=0;a<t.length;++a)n[a]==null?i.push(Oe(Hl(t[a]),"bool")):n[a].rank<t[a].rank?i.push(Ga(n[a],-1)):i.push(n[a]);const s=Di(i,this.axis);return pte(s,-1,!1)})}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}Xne.className="Concatenate";Ee(Xne);function JS(e,t){for(;e<0;)e+=t;return e}function dxt(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Tt("batchDot is not implemented for tensors of 4D or higher rank yet");if(B(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),B(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new Tt("batchDot is not implemented for complex64-type Tensors yet.");const r=e.shape.length,i=t.shape.length;n==null&&(n=[r-1,i-2]);const s=n;return ce(()=>{let a;if(r>i){a=r-i;const l=[];for(let u=0;u<a;++u)l.push(1);t=ie(t,t.shape.concat(l))}else if(i>r){a=i-r;const l=[];for(let u=0;u<a;++u)l.push(1);e=ie(e,e.shape.concat(l))}else a=0;let o;if(e.shape.length===2&&t.shape.length===2)s[0]===s[1]?o=qe(ne(e,t),s[0]):o=qe(ne(Zt(e,[1,0]),t),s[1]);else{const l=s[0]!==e.shape.length-1,u=s[1]===t.shape.length-1;o=Pt(e,t,l,u)}if(a>0){let l;r>i?l=r+i-3:l=r-1;const u=[];for(let c=l;c<l+a;++c)u.push(c);o=qb(o,u)}return o.shape.length===1&&(o=Ga(o,1)),o})}class ONe extends Xb{constructor(t){super(t),this.axes=t.axes,this.normalize=t.normalize==null?!1:t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){B(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0],r=t[1];if(n.length>3||r.length>3)throw new Tt("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,r);if(n[i[0]]!==r[i[1]])throw new re(`Dimension incompatibility: ${n[i[0]]} !== ${r[i[1]]}`)}mergeFunction(t){if(t.length!==2)throw new re(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let n=t[0],r=t[1],i;return Array.isArray(this.axes)?i=this.axes.map((s,a)=>JS(s,t[a].shape.length)):i=[JS(this.axes,n.shape.length),JS(this.axes,r.shape.length)],this.normalize&&(n=R5(n,i[0]),r=R5(r,i[1])),dxt(n,r,i)}interpretAxes(t,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[JS(this.axes,t.length),JS(this.axes,n.length)],r}computeOutputShape(t){B(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0].slice(),r=t[1].slice();if(n.length>3||r.length>3)throw new Tt("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,r);n.splice(i[0],1),r.splice(i[1],1),r.splice(0,1);const s=n.concat(r);return s.length===1&&s.push(1),s}computeMask(t,n){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(t,n),t}}ONe.className="Dot";Ee(ONe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class RNe extends Vt{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,t),n}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t);return PI(()=>ke($7(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}RNe.className="GaussianNoise";Ee(RNe);class PNe extends Vt{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t);return this.rate>0&&this.rate<1?PI(()=>{const s=Math.sqrt(this.rate/(1-this.rate));return ne(r,$7(r.shape,1,s))},()=>r,n.training||!1):r})}}PNe.className="GaussianDropout";Ee(PNe);class LNe extends Vt{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||vt(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return ce(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(t);return PI(()=>{const s=vt(t),a=1.6732632423543772,o=1.0507009873554805,l=-a*o;let u=Hm(Hb(r),this.rate);u=ah(u,"float32");const c=((1-this.rate)*(1+this.rate*l**2))**-.5,f=-c*l*this.rate,h=ke(ne(s,u),ne(ke(u,-1),l));return ke(ne(h,c),f)},()=>vt(t),n.training||!1)}return t})}}LNe.className="AlphaDropout";Ee(LNe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function DT(e,t,n,r,i,s=.001){let a;if(e.rank===2)a=sTe(e,t,n,r,i,s);else if(e.rank===3)a=aTe(e,t,n,r,i,s);else if(e.rank===4)a=oTe(e,t,n,r,i,s);else throw new Tt(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return a}function pxt(e,t,n,r,i=.001){return ce(()=>{const s=Zz(e,r),a=s.mean,o=s.variance;return[DT(e,a,o,n,t,i),a,o]})}function gxt(e,t,n,r,i=.001){return ce(()=>{const s=Zz(e,r),a=s.mean,o=s.variance,l=[];for(const p of Zc(0,e.rank))r.indexOf(p)!==-1?l.push(1):l.push(e.shape[p]);const u=ie(a,l),c=ie(o,l),f=t==null?null:ie(t,l),h=n==null?null:ie(n,l);return[DT(e,u,c,h,f,i),a,o]})}function mxt(e,t,n,r,i=.001){return Qt(r.slice().sort(),Zc(0,e.rank-1))?pxt(e,t,n,r,i):gxt(e,t,n,r,i)}class BNe extends Vt{constructor(t){t==null&&(t={}),super(t),this.supportsMasking=!0,this.axis=t.axis==null?-1:t.axis,this.momentum=t.momentum==null?.99:t.momentum,this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=yr(t.betaInitializer||"zeros"),this.gammaInitializer=yr(t.gammaInitializer||"ones"),this.movingMeanInitializer=yr(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=yr(t.movingVarianceInitializer||"ones"),this.betaConstraint=vi(t.betaConstraint),this.gammaConstraint=vi(t.gammaConstraint),this.betaRegularizer=xr(t.betaRegularizer),this.gammaRegularizer=xr(t.gammaRegularizer)}build(t){t=cn(t);const n=this.axis>=0?this.axis:this.axis+t.length,r=t[n];if(r==null)throw new re(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new gi({ndim:t.length,axes:{[n]:r}})];const i=[r];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,n){return ce(()=>{const r=n.training==null?!1:n.training,i=vt(t),s=i.shape,a=s.length,o=Zc(0,a),l=this.axis>=0?this.axis:this.axis+a;o.splice(l,1);const u=By(1,a);u[l]=s[l];const c=o.slice();c.sort();const f=!Qt(c,Zc(0,a).slice(0,a-1)),h=()=>{if(f){const y=ie(this.movingMean.read(),u),b=ie(this.movingVariance.read(),u),x=this.center?ie(this.beta.read(),u):null,w=this.scale?ie(this.gamma.read(),u):null;return DT(i,y,b,x,w,this.epsilon)}else return DT(i,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return h();const[d,p,g]=mxt(i,this.gamma.read(),this.beta.read(),o,this.epsilon),m=(y,b,x)=>{ce(()=>{const w=1-x,C=y.read(),$=ne(We(C,b),w);y.write(We(C,$))})};return(()=>{m(this.movingMean,p,this.momentum),m(this.movingVariance,g,this.momentum)})(),d})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Tr(this.betaInitializer),gammaInitializer:Tr(this.gammaInitializer),movingMeanInitializer:Tr(this.movingMeanInitializer),movingVarianceInitializer:Tr(this.movingVarianceInitializer),betaRegularizer:Yn(this.betaRegularizer),gammaRegularizer:Yn(this.gammaRegularizer),betaConstraint:mi(this.betaConstraint),gammaConstraint:mi(this.gammaConstraint)},n=super.getConfig();return Object.assign(t,n),t}}BNe.className="BatchNormalization";Ee(BNe);class zNe extends Vt{constructor(t){if(t==null&&(t={}),super(t),this.axis=t.axis==null?-1:t.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=yr(t.betaInitializer||"zeros"),this.gammaInitializer=yr(t.gammaInitializer||"ones"),this.betaRegularizer=xr(t.betaRegularizer),this.gammaRegularizer=xr(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=cn(t);const n=t.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let s=0;s<this.axis.length;++s)this.axis[s]<0&&(this.axis[s]+=n);for(const s of this.axis)if(s<0||s>=n)throw new Error(`Invalid axis: ${s}`);if(this.axis.length!==y0(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(s=>t[s]),i=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,i):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,i):this.beta=null,this.built=!0}call(t,n){const r=vt(t),i=r.shape,s=i.length;return ce(()=>{let{mean:o,variance:l}=Zz(r,this.axis,!0);const u=By(1,s);for(const g of this.axis)u[g]=i[g];const c=g=>g!=null&&g.shape.length!==s?ie(g,u):g;let f=this.scale?c(this.gamma.read()):null,h=this.center?c(this.beta.read()):null;const d=[],p=[];for(let g=0;g<s;++g)this.axis.indexOf(g)!==-1?(d.push(i[g]),p.push(1)):(d.push(1),p.push(i[g]));return o=mu(o,d),l=mu(l,d),f!=null&&(f=mu(f,p)),h!=null&&(h=mu(h,p)),DT(r,o,l,h,f,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Tr(this.betaInitializer),gammaInitializer:Tr(this.gammaInitializer),betaRegularizer:Yn(this.betaRegularizer),gammaRegularizer:Yn(this.gammaRegularizer)},n=super.getConfig();return Object.assign(t,n),t}}zNe.className="LayerNormalization";Ee(zNe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vxt(e,t,n){return ce(()=>{if(e.rank!==4)throw new re(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new re("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Qc()),n!=="channelsLast"&&n!=="channelsFirst")throw new re(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],t[0],t[1]]:r=[[0,0],t[0],t[1],[0,0]],qm(e,r)})}class UNe extends Vt{constructor(t){if(t==null&&(t={}),super(t),this.dataFormat=t.dataFormat==null?Qc():t.dataFormat,t.padding==null)this.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new re(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let n,r;if(typeof t.padding[0]=="number")n=[t.padding[0],t.padding[0]],r=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new re(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(n=t.padding[0],t.padding[1].length!==2)throw new re(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);r=t.padding[1]}this.padding=[n,r]}this.inputSpec=[new gi({ndim:4})]}computeOutputShape(t){t=cn(t);let n,r;return this.dataFormat==="channelsFirst"?(t[2]!=null&&t[2]>=0?n=t[2]+this.padding[0][0]+this.padding[0][1]:n=null,t[3]!=null&&t[3]>=0?r=t[3]+this.padding[1][0]+this.padding[1][1]:r=null,[t[0],t[1],n,r]):(t[1]!=null&&t[1]>=0?n=t[1]+this.padding[0][0]+this.padding[0][1]:n=null,t[2]!=null&&t[2]>=0?r=t[2]+this.padding[1][0]+this.padding[1][1]:r=null,[t[0],n,r,t[3]])}call(t,n){return ce(()=>vxt(vt(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}UNe.className="ZeroPadding2D";Ee(UNe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function D7(e,t,n,r,i,s){return ce(()=>{ei(i),aDe(s),Jl(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=Qc()),s==null&&(s="max"),e=Wne(e,i);let a;const o=r==="same"?"same":"valid";return s==="max"?a=Kz(e,t,n,o):a=Wz(e,t,n,o),i==="channelsFirst"&&(a=Zt(a,[0,3,1,2])),a})}function WNe(e,t,n,r,i,s){return ce(()=>{ei(i),aDe(s),Jl(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=Qc()),s==null&&(s="max"),e=oNe(e,i);let a;const o=r==="same"?"same":"valid";return s==="max"?a=MTe(e,t,n,o):a=iTe(e,t,n,o),i==="channelsFirst"&&(a=Zt(a,[0,4,1,2,3])),a})}class VNe extends Vt{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new re(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(Ai(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new re(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);Ai(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,Jl(this.padding),this.inputSpec=[new gi({ndim:3})]}computeOutputShape(t){t=cn(t);const n=Wc(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],n,t[2]]}call(t,n){return ce(()=>{this.invokeCallHook(t,n),t=OI(vt(t),2);const r=this.poolingFunction(vt(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return qb(r,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(t,n),t}}class jNe extends VNe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return ei(s),Jl(i),D7(t,n,r,i,s,"max")}}jNe.className="MaxPooling1D";Ee(jNe);class HNe extends VNe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return ei(s),Jl(i),D7(t,n,r,i,s,"avg")}}HNe.className="AveragePooling1D";Ee(HNe);class qNe extends Vt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new re(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];Ai(this.poolSize,"poolSize"),Ai(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,ei(this.dataFormat),Jl(this.padding),this.inputSpec=[new gi({ndim:4})]}computeOutputShape(t){t=cn(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2];return n=Wc(n,this.poolSize[0],this.padding,this.strides[0]),r=Wc(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,r]:[t[0],n,r,t[3]]}call(t,n){return ce(()=>(this.invokeCallHook(t,n),this.poolingFunction(vt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class GNe extends qNe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return ei(s),Jl(i),D7(t,n,r,i,s,"max")}}GNe.className="MaxPooling2D";Ee(GNe);class YNe extends qNe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return ei(s),Jl(i),D7(t,n,r,i,s,"avg")}}YNe.className="AveragePooling2D";Ee(YNe);class XNe extends Vt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new re(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];Ai(this.poolSize,"poolSize"),Ai(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,ei(this.dataFormat),Jl(this.padding),this.inputSpec=[new gi({ndim:5})]}computeOutputShape(t){t=cn(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[4]:t[3];return n=Wc(n,this.poolSize[0],this.padding,this.strides[0]),r=Wc(r,this.poolSize[1],this.padding,this.strides[1]),i=Wc(i,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,r,i]:[t[0],n,r,i,t[4]]}call(t,n){return ce(()=>(this.invokeCallHook(t,n),this.poolingFunction(vt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class KNe extends XNe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return ei(s),Jl(i),WNe(t,n,r,i,s,"max")}}KNe.className="MaxPooling3D";Ee(KNe);class ZNe extends XNe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return ei(s),Jl(i),WNe(t,n,r,i,s,"avg")}}ZNe.className="AveragePooling3D";Ee(ZNe);class QNe extends Vt{constructor(t){super(t),this.inputSpec=[new gi({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,n){throw new Tt}}class JNe extends QNe{constructor(t){super(t||{})}call(t,n){return ce(()=>{const r=vt(t);return Lr(r,1)})}}JNe.className="GlobalAveragePooling1D";Ee(JNe);class eIe extends QNe{constructor(t){super(t||{})}call(t,n){return ce(()=>{const r=vt(t);return Du(r,1)})}}eIe.className="GlobalMaxPooling1D";Ee(eIe);class tIe extends Vt{constructor(t){super(t),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,ei(this.dataFormat),this.inputSpec=[new gi({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,n){throw new Tt}getConfig(){const t={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class nIe extends tIe{call(t,n){return ce(()=>{const r=vt(t);return this.dataFormat==="channelsLast"?Lr(r,[1,2]):Lr(r,[2,3])})}}nIe.className="GlobalAveragePooling2D";Ee(nIe);class rIe extends tIe{call(t,n){return ce(()=>{const r=vt(t);return this.dataFormat==="channelsLast"?Du(r,[1,2]):Du(r,[2,3])})}}rIe.className="GlobalMaxPooling2D";Ee(rIe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class iIe extends Vt{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(t,n),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,n,r={}){const i=n.layer,s=yp(i,r);delete n.layer;const a={layer:s};return Object.assign(a,n),new t(a)}}class sIe extends iIe{constructor(t){super(t),this.supportsMasking=!0}build(t){if(t=cn(t),t.length<3)throw new re(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=cn(t);const n=[t[0]].concat(t.slice(2)),r=this.layer.computeOutputShape(n),i=t[1];return[r[0],i].concat(r.slice(1))}call(t,n){return ce(()=>(t=vt(t),mNe((a,o)=>[vt(this.layer.call(a,n)),[]],t,[],!1,null,null,!1,!0)[1]))}}sIe.className="TimeDistributed";Ee(sIe);function yxt(e){Yb(Uyt,"BidirectionalMergeMode",e)}const bxt="concat";class aIe extends iIe{constructor(t){super(t);const n=t.layer.getConfig(),r={};r.className=t.layer.getClassName(),r.config=n,this.forwardLayer=yp(r),n.goBackwards=n.goBackwards!==!0;const i={};if(i.className=t.layer.getClassName(),i.config=n,this.backwardLayer=yp(i),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=t.mergeMode===void 0?bxt:t.mergeMode,yxt(this.mergeMode),t.weights)throw new Tt("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const n=t.length,r=Math.floor(n/2);this.forwardLayer.setWeights(t.slice(0,r)),this.backwardLayer.setWeights(t.slice(r))}computeOutputShape(t){let n=this.forwardLayer.computeOutputShape(t);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,i,s;return this.returnState&&(s=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):this.mergeMode==null?i=[r,r.slice()]:i=[r],this.returnState?this.mergeMode==null?i.concat(s).concat(s.slice()):[r].concat(s).concat(s.slice()):Ya(i)}apply(t,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const s=gNe(t,r,i,this.numConstants);if(t=s.inputs,r=s.initialState,i=s.constants,Array.isArray(t)&&(r=t.slice(1),t=t[0]),(r==null||r.length===0)&&i==null)return super.apply(t,n);const a=[],o=[];if(r!=null){const u=r.length;if(u%2>0)throw new re("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,a.push(...r);const c=r.map(f=>new gi({shape:f.shape}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),o.push(...c)}if(i!=null)throw new Tt("Support for constants in Bidirectional layers is not implemented yet.");const l=a[0]instanceof eh;for(const u of a)if(u instanceof eh!==l)throw new re("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[t].concat(a),c=this.inputSpec.concat(o),f=this.inputSpec;this.inputSpec=c;const h=super.apply(u,n);return this.inputSpec=f,h}else return super.apply(t,n)}call(t,n){return ce(()=>{const r=n.initialState;let i,s;if(r==null)i=this.forwardLayer.call(t,n),s=this.backwardLayer.call(t,n);else{const l=r.slice(0,r.length/2),u=r.slice(r.length/2);i=this.forwardLayer.call(t,Object.assign(n,{initialState:l})),s=this.backwardLayer.call(t,Object.assign(n,{initialState:u}))}let a;this.returnState&&(Array.isArray(i)&&(a=i.slice(1).concat(s.slice(1))),i=i[0],s=s[0]),this.returnSequences&&(s=Ru(s,1));let o;return this.mergeMode==="concat"?o=Tne([i,s]):this.mergeMode==="sum"?o=ke(i,s):this.mergeMode==="ave"?o=ne(.5,ke(i,s)):this.mergeMode==="mul"?o=ne(i,s):this.mergeMode==null&&(o=[i,s]),this.returnState?this.mergeMode==null?o.concat(a):[o].concat(a):o})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){Z1(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),Z1(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const s=this.forwardLayer.states.map(a=>null);return Array.isArray(r)?r.concat(s).concat(s):[r].concat(s).concat(s)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(t,n),t}static fromConfig(t,n){const r=yp(n.layer);if(delete n.layer,n.numConstants!=null)throw new Tt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const i=n;return i.layer=r,new t(i)}}aIe.className="Bidirectional";Ee(aIe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class oIe extends Vt{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return ce(()=>(t=vt(t),t.dtype!=="float32"&&(t=ah(t,"float32")),ke(ne(t,this.scale),this.offset)))}}oIe.className="Rescaling";Ee(oIe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:xxt,cropAndResize:wxt}=Jf;class lIe extends Vt{constructor(t){super(t),this.height=t.height,this.width=t.width}centerCrop(t,n,r,i,s,a,o,l){return ce(()=>{let u,c=!1;const f=n/a,h=r/o,d=(i+n)/a,p=(s+r)/o,g=[f,h,d,p],m=[];t.rank===3?(c=!0,u=Mp([t])):u=t;for(let w=0;w<u.shape[0];w++)m.push(g);const v=vp(m,[m.length,4]),y=Pw(0,m.length,1,"int32"),x=wxt(u,v,y,[i,s],"nearest");return ah(c?vt(q0(x)):x,l)})}upsize(t,n,r,i){return ce(()=>{const s=xxt(t,[n,r]);return ah(s,i)})}call(t,n){return ce(()=>{const r=vt(t),i=r.dtype,s=r.shape,a=s[s.length-3],o=s[s.length-2];let l=0;a!==this.height&&(l=Math.floor((a-this.height)/2));let u=0;return o!==this.width&&(u=Math.floor((o-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(r,l,u,this.height,this.width,a,o,i):this.upsize(t,this.height,this.width,i)})}getConfig(){const t={height:this.height,width:this.width},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=cn(t);const n=t.length-3,r=t.length-2;return t[n]=this.height,t[r]=this.width,t}}lIe.className="CenterCrop";Ee(lIe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $xt(e,t,n,r){let i=vt(e);if(i.dtype!=="int32"&&(i=ah(i,"int32")),t==="int")return i;const s=i.shape;if(i.rank===0&&(i=Ga(i,-1)),t==="oneHot"&&i.shape[i.shape.length-1]!==1&&(i=Ga(i,-1)),i.rank>2)throw new re(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${s} which would result in output rank ${i.rank}.`);const a=["multiHot","oneHot"].includes(t),o=i;let l;if(typeof r<"u"&&t==="count"?l=zY(o,r,n,a):l=zY(o,[],n,a),t!=="tfIdf")return l;if(r)return ne(l,r);throw new re("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class uIe extends Vt{constructor(t){super(t),this.numTokens=t.numTokens,t.outputMode?this.outputMode=t.outputMode:this.outputMode="multiHot"}getConfig(){const t={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){return t=cn(t),t==null?[this.numTokens]:this.outputMode==="oneHot"&&t[t.length-1]!==1?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)}call(t,n){return ce(()=>{t=vt(t),t.dtype!=="int32"&&(t=ah(t,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new re(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=vt(n.countWeights)}const i=Du(t),s=wT(t),a=yl(this.numTokens,i).bufferSync().get(0),o=Hm(s,0).bufferSync().get(0);if(!(a&&o))throw new re(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return $xt(t,this.outputMode,this.numTokens,r)})}}uIe.className="CategoryEncoding";Ee(uIe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Cxt=["bilinear","nearest"],Jge=new Set(Cxt);class cIe extends Vt{constructor(t){if(super(t),this.height=t.height,this.width=t.width,t.interpolation)if(Jge.has(t.interpolation))this.interpolation=t.interpolation;else throw new re(`Invalid interpolation parameter: ${t.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(t.cropToAspectRatio)}computeOutputShape(t){t=cn(t);const n=t[2];return[this.height,this.width,n]}getConfig(){const t={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return ce(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return Jf.resizeBilinear(t,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Jf.resizeNearestNeighbor(t,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...Jge]} are supported`)})}}cIe.className="Resizing";Ee(cIe);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fIe{constructor(t){this.seed=t}next(){if(this.seed!==void 0)return this.seed++}}fIe.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class hIe extends Vt{constructor(t){super(t),this.randomGenerator=new fIe(t.seed)}getConfig(){const t={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(t,n),t}}hIe.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const _xt=["bilinear","nearest"],e0e=new Set(_xt);class dIe extends hIe{constructor(t){super(t);const{factor:n,interpolation:r="bilinear"}=t;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new re(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new re(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new re(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(e0e.has(r))this.interpolation=r;else throw new re(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const t={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=cn(t);const n=t[2];return[this.imgHeight,-1,n]}call(t,n){return ce(()=>{const r=vt(t);this.imgHeight=r.shape[r.shape.length-3];const i=r.shape[r.shape.length-2];this.widthFactor=Hb([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let s=this.widthFactor.dataSync()[0]*i;s=Math.round(s);const a=[this.imgHeight,s];switch(this.interpolation){case"bilinear":return Jf.resizeBilinear(t,a);case"nearest":return Jf.resizeNearestNeighbor(t,a);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...e0e]} are supported`)}})}}dIe.className="RandomWidth";Ee(dIe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pIe(e){return new Yne(e)}function gIe(e){return new Xne(e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sxt=le();Sxt.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var t0e;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(t0e||(t0e={}));var n0e;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(n0e||(n0e={}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var r0e;(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(r0e||(r0e={}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ge(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&B(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kxt=o7;class N7 extends NB{nextDataId(){return N7.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Qee(this,dc())}write(t,n,r){this.firstUse&&(this.firstUse=!1,le().get("IS_NODE")&&kl(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const i={id:this.nextDataId()};return this.data.set(i,{values:t,dtype:r,refCount:1}),i}makeTensorInfo(t,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&Qf(r[0])){const s=r.map(a=>rh(a));i=this.write(s,t,n)}else i=this.write(r,t,n);return{dataId:i,shape:t,dtype:n}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){const n=this.data.get(t);n.refCount--}}move(t,n,r,i,s){this.data.set(t,{values:n,dtype:i,refCount:s})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:n,complexTensorInfos:r}=this.data.get(t);if(n==="complex64"){const i=this.readSync(r.real.dataId),s=this.readSync(r.imag.dataId);return Fp(i,s)}return dAe(this.data.get(t).values,n)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const r=n.map(i=>Ip(i));return Mt(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Mt(t.shape,t.dtype,n)}makeOutput(t,n,r){return dc().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,t),this)}disposeData(t,n=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!n&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(t);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const n=ca();return t(),{kernelMs:ca()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Ge([t],"where");const n=this.readSync(t.dataId);return kxt(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}N7.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mIe(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const Ext=e=>{const{x:t}=e.inputs,n=e.backend;Ge(t,"abs");let r=new Float32Array(de(t.shape));const i=n.data.get(t.dataId).values;return r=mIe(i),n.makeOutput(r,t.shape,t.dtype)},Axt={kernelName:bN,backendName:"cpu",kernelFunc:Ext};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ti(e){return(t,n,r,i,s)=>{const a=Ct(t,n),o=a.length,l=Je(a),u=de(a),c=Fi(s,u),f=t.length,h=n.length,d=Je(t),p=Je(n),g=Ry(t,a),m=Ry(n,a);if(g.length+m.length===0)for(let v=0;v<c.length;++v)c[v]=e(r[v%r.length],i[v%i.length]);else for(let v=0;v<c.length;++v){const y=zb(v,o,l),b=y.slice(-f);g.forEach($=>b[$]=0);const x=zc(b,f,d),w=y.slice(-h);m.forEach($=>w[$]=0);const C=zc(w,h,p);c[v]=e(r[x],i[C])}return[c,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wo(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,o=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(o.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",s),imag:n.makeTensorInfo(i.shape,"float32",a)},o}const Txt={kernelName:UB,backendName:"cpu",kernelFunc:Wo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U5(e,t,n="float32"){if(n==="complex64"){const i=U5(e,t,"float32"),s=U5(e,t,"float32");return Wo({inputs:{real:i,imag:s},backend:e})}const r=hs(de(t),n);return e.makeTensorInfo(t,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oh(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Dxt={kernelName:KC,backendName:"cpu",kernelFunc:Oh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zy(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.real,s=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,s)}const Nxt={kernelName:xz,backendName:"cpu",kernelFunc:zy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vIe(e,t,n,r){if(r==="int32"){const i=Int32Array.from(e);return[t,"int32",i]}if(r==="bool"){const i=Um([0],n),[s,a]=ti((o,l)=>o!==l?1:0)(t,[],e,i,"bool");return[a,"bool",s]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function Z0(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:s}=r;if(s==="complex64"){if(i.dtype==="complex64")return Oh({inputs:{x:i},backend:n});const c=U5(n,i.shape,i.dtype),f=Z0({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),h=Wo({inputs:{real:f,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),h}if(i.dtype==="complex64"){const c=zy({inputs:{input:i},backend:n}),f=Z0({inputs:{x:c},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(c),f}if(!tte(i.dtype,s)){const c=Oh({inputs:{x:i},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:s}}const a=n.data.get(i.dataId).values,[o,l,u]=vIe(a,i.shape,i.dtype,s);return n.makeTensorInfo(o,l,u)}const Ixt={kernelName:PC,backendName:"cpu",kernelFunc:Z0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xi(e,t,n,r){return n==null?({inputs:i,backend:s})=>{const{a,b:o}=i,l=s;Ge([a,o],e);const u=l.data.get(a.dataId).values,c=l.data.get(o.dataId).values,f=a.dtype==="string"?Op(u):u,h=a.dtype==="string"?Op(c):c,d=r||a.dtype,[p,g]=t(a.shape,o.shape,f,h,d);return l.makeTensorInfo(g,d,p)}:({inputs:i,backend:s})=>{const{a,b:o}=i,l=s;if(a.dtype==="complex64"||o.dtype==="complex64"){const u=Z0({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),f=c.complexTensorInfos.real,h=c.complexTensorInfos.imag,d=l.data.get(f.dataId).values,p=l.data.get(h.dataId).values,g=Z0({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),m=l.data.get(g.dataId),v=m.complexTensorInfos.real,y=m.complexTensorInfos.imag,b=l.data.get(v.dataId).values,x=l.data.get(y.dataId).values,[w,C,$]=n(a.shape,o.shape,d,p,b,x),_=l.makeTensorInfo($,"float32",w),k=l.makeTensorInfo($,"float32",C),E=Wo({inputs:{real:_,imag:k},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(_),l.disposeIntermediateTensorInfo(k),E}else{const u=l.data.get(a.dataId).values,c=l.data.get(o.dataId).values,f=r||a.dtype,[h,d]=t(a.shape,o.shape,u,c,f);return l.makeTensorInfo(d,f,h)}}}function Kne(e){return(t,n,r,i,s,a)=>{const o=Ct(t,n),l=de(o),u=o.length,c=Je(o),f=Fi("float32",l),h=Fi("float32",l),d=Ry(t,o),p=Ry(n,o),g=Fp(r,i),m=Fp(s,a),v=t.length,y=Je(t),b=n.length,x=Je(n);if(d.length+p.length===0)for(let w=0;w<f.length;w++){const C=w%g.length,$=w%m.length,_=e(g[C*2],g[C*2+1],m[$*2],m[$*2+1]);f[w]=_.real,h[w]=_.imag}else for(let w=0;w<f.length;w++){const C=zb(w,u,c),$=C.slice(-v);d.forEach(N=>$[N]=0);const _=zc($,v,y),k=C.slice(-b);p.forEach(N=>k[N]=0);const E=zc(k,b,x),S=e(g[_*2],g[_*2+1],m[E*2],m[E*2+1]);f[w]=S.real,h[w]=S.imag}return[f,h,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yIe=ti((e,t)=>e+t),Mxt=Kne((e,t,n,r)=>({real:e+n,imag:t+r})),Bw=xi(Ub,yIe,Mxt),Fxt={kernelName:Ub,backendName:"cpu",kernelFunc:Bw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zne(e,t,n,r,i){const s=de(r),a=hs(i,n);for(let o=0;o<e.length;o++){const l=e[o];if(l<0)throw new Error("Input x must be non-negative!");l>=i||(s>0?a[l]+=t[o]:a[l]+=1)}return a}function bIe(e,t,n,r=!1){const i=e.shape[0],s=e.shape[1],a=Mt([i,n],t.dtype);for(let o=0;o<i;o++)for(let l=0;l<s;l++){const u=e.get(o,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?a.set(1,o,u):t.size>0?a.set(a.get(o,u)+t.get(o,l),o,u):a.set(a.get(o,u)+1,o,u))}return a}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xIe=ti((e,t)=>e&t),Oxt=xi(EN,xIe),Rxt={kernelName:EN,backendName:"cpu",kernelFunc:Oxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sd(e){return(t,n,r)=>{const i=Br(n,t.length);for(let s=0;s<t.length;++s)i[s]=e(t[s],r);return i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bn(e,t,n){const r=sd(t);return Xm(e,r,n)}function Xm(e,t,n){return({inputs:r,attrs:i,backend:s})=>{const{x:a}=r;Ge(a,e);const o=s,l=o.data.get(a.dataId).values;let u;if(a.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=Op(l)}else u=l;const c=n||a.dtype,f=t(u,c,i);return o.makeTensorInfo(a.shape,c,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wIe=sd(e=>Math.ceil(e)),Pxt=Xm(LC,wIe),Lxt={kernelName:LC,backendName:"cpu",kernelFunc:Pxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ie(e,t,n,r){const i=Br(n,de(t));if(r&&n!=="string"){let s=0;e.forEach(a=>{const o=de(a.shape);i.set(a.vals,s),s+=o})}else{let s=0;e.forEach(a=>{const o=n==="string"?Op(a.vals):a.vals;let l=0;for(let u=0;u<a.shape[0];++u){const c=u*t[1]+s;for(let f=0;f<a.shape[1];++f)i[c+f]=o[l++]}s+=a.shape[1]})}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CIe=ti((e,t)=>e===t?1:0),_Ie=xi(RN,CIe,null,"bool"),Bxt={kernelName:RN,backendName:"cpu",kernelFunc:_Ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SIe=sd(e=>Math.exp(e)),kIe=Xm(HC,SIe,"float32"),zxt={kernelName:HC,backendName:"cpu",kernelFunc:kIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EIe=sd(e=>Math.expm1(e)),Uxt=Xm(qC,EIe),Wxt={kernelName:qC,backendName:"cpu",kernelFunc:Uxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AIe=sd(e=>Math.floor(e)),Vxt=Xm(GC,AIe),jxt={kernelName:GC,backendName:"cpu",kernelFunc:Vxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TIe=ti((e,t)=>Math.floor(e/t)),Hxt=xi(YC,TIe,null,"int32"),qxt={kernelName:YC,backendName:"cpu",kernelFunc:Hxt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DIe(e,t,n,r,i,s,a,o,l){const u=Mt([r,s],n);for(let c=0;c<r;c++){const f=[];let h=0;for(let d=0;d<i;d++){const p=e[c*i+d];h+=p*a[d],f.push(p)}if(h<0||h>=l/s)throw new Error(`Invalid indices: ${f} does not index into ${o}`);for(let d=0;d<s;d++)u.values[c*s+d]=t.get(...t.indexToLoc(h*s+d))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NIe(e,t,n){const r=Mt(n,e.dtype);for(let i=0;i<r.size;++i){const a=r.indexToLoc(i).slice(),o=a[0],l=a[2],u=t.locToIndex([o,l]);a[2]=t.values[u];const c=e.locToIndex(a);0<=c&&c<e.values.length&&(r.values[i]=e.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IIe=ti((e,t)=>e>t?1:0),Gxt=xi(zN,IIe,null,"bool"),Yxt={kernelName:zN,backendName:"cpu",kernelFunc:Gxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MIe=ti((e,t)=>e>=t?1:0),Xxt=xi(XC,MIe,null,"bool"),Kxt={kernelName:XC,backendName:"cpu",kernelFunc:Xxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FIe=ti((e,t)=>e<t?1:0),Zxt=xi(WN,FIe,null,"bool"),Qxt={kernelName:WN,backendName:"cpu",kernelFunc:Zxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OIe=ti((e,t)=>e<=t?1:0),Jxt=xi(VN,OIe,null,"bool"),e2t={kernelName:VN,backendName:"cpu",kernelFunc:Jxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RIe(e,t,n){const r=(t-e)/(n-1),i=hs(n,"float32");i[0]=e;for(let s=1;s<i.length;s++)i[s]=i[s-1]+r;return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PIe=sd(e=>Math.log(e)),t2t=Xm(e_,PIe),n2t={kernelName:e_,backendName:"cpu",kernelFunc:t2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LIe(e,t,n,r){const i=Fi(r,de(n));for(let s=0;s<i.length;++s){const a=s*t;let o=e[a];for(let l=0;l<t;++l){const u=e[a+l];(Number.isNaN(u)||u>o)&&(o=u)}i[s]=o}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BIe=ti((e,t)=>Math.max(e,t)),r2t=xi(n_,BIe),i2t={kernelName:n_,backendName:"cpu",kernelFunc:r2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zIe=ti((e,t)=>Math.min(e,t)),s2t=xi(r_,zIe),a2t={kernelName:r_,backendName:"cpu",kernelFunc:s2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qne=ti((e,t)=>e*t),o2t=Kne((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),I7=xi(s_,Qne,o2t),l2t={kernelName:s_,backendName:"cpu",kernelFunc:I7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UIe(e,t,n){const r=tg(-1,n);return Qne([],t,r,e,n)}function u2t(e){const{inputs:t,backend:n}=e,{x:r}=t;Ge(r,"neg");const i=n.data.get(r.dataId).values,[s,a]=UIe(i,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,s)}const c2t={kernelName:eI,backendName:"cpu",kernelFunc:u2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WIe=ti((e,t)=>e!==t?1:0),f2t=xi(tI,WIe,null,"bool"),h2t={kernelName:tI,backendName:"cpu",kernelFunc:f2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jne(e,t,n,r,i){const s=t.length,a=de(t),o=Je(t),l=Je(i),u=Fi(n,de(i));for(let c=0;c<a;++c){const f=zb(c,s,o),h=new Array(f.length);for(let p=0;p<h.length;p++)h[p]=f[r[p]];const d=zc(h,s,l);u[d]=e[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mo(e){const{inputs:t,attrs:n,backend:r}=e,{x:i}=t,{perm:s}=n;Ge(i,"transpose");const a=i.shape.length,o=new Array(a);for(let f=0;f<o.length;f++)o[f]=i.shape[s[f]];const l=r.data.get(i.dataId).values,u=Jne(l,i.shape,i.dtype,s,o);return{dataId:r.write(u,o,i.dtype),shape:o,dtype:i.dtype}}const d2t={kernelName:K1,backendName:"cpu",kernelFunc:mo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VIe(e,t,n,r){const[i,s]=Li(e,r),a=po(t,"int32"),o=hs(de(i),a),l=de(s);for(let u=0;u<o.length;++u){const c=u*l;let f=1;for(let h=0;h<l;++h)f*=n[c+h];o[u]=f}return{outVals:o,outShape:i,outDtype:a}}function p2t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r;Ge(i,"prod");const o=i.shape.length,l=Ot(s,i.shape),u=Fr(l,o);let c=l,f=i;const h=[];u!=null&&(f=mo({inputs:{x:i},backend:n,attrs:{perm:u}}),h.push(f),c=Jr(c.length,o));const d=n.data.get(f.dataId).values,{outVals:p,outShape:g,outDtype:m}=VIe(f.shape,f.dtype,d,c);let v=g;return a&&(v=Zr(g,l)),h.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(v,m,p)}const g2t={kernelName:oI,backendName:"cpu",kernelFunc:p2t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m2t(e,t,n){e.forEach((r,i)=>{if(r<0||r>=n){const s=zb(i,t.length,Je(t)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${n})`)}})}function v2t(e,t){for(let n=0;n<e.length;++n){const r=e[n],i=n===e.length-1?t:e[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}function y2t(e,t,n,r){const i=[];let s=0;const a=t.length-1+n.length,o=new Array(a).fill(null).map(()=>[0]);v2t(n,r);let l=1;for(let u=0;u<t.length-1;++u){l*=t[u];const c=t[u+1];for(let f=1;f<l+1;++f)o[u].push(f*c)}for(let u=0;u<e.length;++u){let c=e[u],f=e[u]+1;for(let h=0;h<n.length;++h){const d=n[h],p=h+t.length-1;if(p>=0){const g=o[p],m=g[g.length-1]-d[c];for(let v=c;v<f;++v)o[p].push(d[v+1]+m)}c=d[c],f=d[f]}f!==c&&(i.push([c,f]),s+=f-c)}return{outSplits:o,valueSlices:i,numValues:s}}function b2t(e){const t=[];for(let n=0;n<e.length;++n){const r=e[n].length,i=Br("int32",r);t.push(i),e[n].forEach((s,a)=>i[a]=s)}return t}function i0e(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function x2t(e,t,n,r,i,s){const a=i0e(t,2)[1],o=i0e(s,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let f=0;f<r;++f)i[l*o+f]=e[c*a+f];++l}}function w2t(e,t,n,r,i){const s=t.slice();s[0]=i;const a=Br(n,de(s)),o=e.length,l=o===0?0:o/t[0];return x2t(e,t,r,l,a,s),[a,s]}function jIe(e,t,n,r,i,s,a,o){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const l=t[0][0]-1;if(m2t(s,a,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:f,numValues:h}=y2t(s,a,e,u),d=b2t(c),p=w2t(n,r,i,f,h);return[d,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s0e=2147483647;function HIe(e,t,n,r,i,s,a){if(t.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(a.length>1)throw new Error("deltas must be a scalar or vector");const o=t.length===0,l=i.length===0,u=a.length===0,c=[];o||c.push(t[0]),l||c.push(i[0]),u||c.push(a[0]);for(let m=1;m<c.length;++m)if(c[m]!==c[m-1])throw new Error("starts, limits, and deltas must have the same shape");const f=c.length===0?1:c[0],h=Br("int32",f+1);h[0]=0;for(let m=0;m<f;++m){const v=o?e[0]:e[m],y=l?r[0]:r[m],b=u?s[0]:s[m];if(b===0)throw new Error("Requires delta != 0");let x;if(b>0&&y<v||b<0&&y>v)x=0;else if(x=Math.ceil(Math.abs((y-v)/b)),x>s0e)throw new Error(`Requires ((limit - start) / delta) <= ${s0e}`);h[m+1]=h[m]+x}const d=h[f],p=Br(n,d);let g=0;for(let m=0;m<f;++m){const v=h[m+1]-h[m];let y=o?e[0]:e[m];const b=u?s[0]:s[m];for(let x=0;x<v;++x)p[g++]=y,y+=b}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var iu=bc;class W5{constructor(t,n,r,i,s,a,o,l,u,c){this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=i,this.valuesDType=s,this.defaultValue=a,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=D3e(c),this.raggedRank=N3e(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===iu.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===iu.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case iu.VALUE_ROWIDS:return W5.getMaxWidthValueRowID(n);case iu.ROW_SPLITS:return W5.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${iu[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const n=t.length;if(n===0||n===1)return 0;let r=0;for(let i=0;i<n-1;++i){const s=t[i+1]-t[i];s>r&&(r=s)}return r}static getMaxWidthValueRowID(t){const n=t.length;if(n===0)return 0;let r=0,i=t[0],s=0;for(let a=1;a<n;++a){const o=t[a];o!==i&&(i=o,s=Math.max(a-r,s),r=a)}return Math.max(n-r,s)}tensorShapeFromTensor(t,n,r=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return o0e(t,r)}calculateOutputSize(t){const n=this.valuesShape,r=this.defaultValueShape;I3e(r,n);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=T3e(this.raggedRank,i,n);a[0]<0&&(a[0]=t);for(let o=1;o<=this.raggedRank;++o)a[o]<0&&(a[o]=this.getMaxWidth(o));return a}calculateFirstParentOutputIndex(t,n,r){const i=Math.min(t,r),s=[];let a=0;for(let o=0;o<i;++o,a+=n)s.push(a);for(let o=i;o<t;++o)s.push(-1);return B(s.length===t,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(t,n,r,i){const s=t.length,a=[];for(let o=0;o<s-1;++o){const l=t[o+1]-t[o];let u=Math.min(i,l),c=n[o];c===-1&&(u=0);for(let f=0;f<u;++f)a.push(c),c+=r;for(let f=0;f<l-u;++f)a.push(-1)}if(s>0&&a.length!==t[s-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(t,n,r,i){const s=t.length,a=[];if(s===0)return[];let o=0,l=t[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];a.push(u);for(let c=1;c<s;++c){const f=t[c];if(f===l)u>=0&&(++o,o<i?u+=r:u=-1);else{if(o=0,l=f,f>=n.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${n.length}`);u=n[f]}a.push(u)}if(a.length!==t.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(t,n,r,i){const s=this.getRowPartitionTensor(t),a=this.getRowPartitionTypeByDimension(t);switch(a){case iu.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,n,r,i);case iu.ROW_SPLITS:if(s.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(s,n,r,i);default:throw new Error(`Unsupported partition type: ${iu[a]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case iu.FIRST_DIM_SIZE:return t[0];case iu.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case iu.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${iu[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let l=i.length-2;l>=0;--l)i[l]=i[l+1]*r[l+1];const s=o0e(r,!1),a=Br(this.valuesDType,de(s));if(i[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,i[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,i[u],r[u]);this.setOutput(this.raggedRank,l,a,s)}return[s,a]}setOutput(t,n,r,i){if(r.length===0)return;const s=this.values,a=r;let o=i.slice();o=o.slice(t+1);const l=de(o),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const p=this.defaultValueShape;ce(()=>{const g=ie(c,p);c=X2(g,o).dataSync()})}let f=0,h=0,d=0;for(let p=0;p<=u;++p){let g=p<u?n[p]:-1;if(g===d){++d;continue}if(h<d){const m=s.subarray(f*l),v=a.subarray(h*l),y=(d-h)*l;a0e(v,m,y)}if(p>=u){const m=r.length;g=Math.floor(m/l)}if(g>d)if(this.defaultValue.length===1)a.subarray(d*l,g*l).fill(this.defaultValue[0]),d=g;else for(;g>d;){const m=a.slice(d*l);a0e(m,c,l),++d}g<0?(f=p+1,h=d):(f=p,h=d,d=h+1)}}}function a0e(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function o0e(e,t){const n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function qIe(e,t,n,r,i,s,a,o,l,u){return new W5(e,t,n,r,i,s,a,o,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GIe(e,t,n,r){const i=e===t,s=e<t&&n<0,a=t<e&&n>1;if(i||s||a)return hs(0,r);const o=Math.abs(Math.ceil((t-e)/n)),l=hs(o,r);t<e&&n===1&&(n=-1),l[0]=e;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YIe=sd(e=>1/Math.sqrt(e)),$2t=Xm(f_,YIe),C2t={kernelName:f_,backendName:"cpu",kernelFunc:$2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A1(e,t,n,r,i,s,a,o,l,u){const c=[r/i,i],f=e.values,h=t.values;if(r===0)return Mt(n,t.dtype);const d=l instanceof oi?l:Mt(c,t.dtype);typeof l=="string"||typeof l=="number"?d.values.fill(l):typeof l=="boolean"&&d.values.fill(+l);for(let p=0;p<s;p++){const g=[];let m=0;for(let v=0;v<a;v++){const y=f[p*a+v];g.push(y),m+=y*o[v]}if(m<0||m>=r/i)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let v=0;v<i;v++)u?d.values[m*i+v]+=h[p*i+v]:d.values[m*i+v]=t.rank===0?h[0]:h[p*i+v]}return d}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _2t=sd(e=>1/(1+Math.exp(-e))),XIe=Bn(m_,e=>1/(1+Math.exp(-e))),S2t={kernelName:m_,backendName:"cpu",kernelFunc:XIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KIe(e,t,n,r,i){const s=rne(r,t,n),a=de(n),o=Je(r);if(s){const f=ine(t,o);return i==="string"?e.slice(f,f+a):e.subarray(f,f+a)}const l=i==="string"?Op(e):e,u=Mt(r,i,l),c=Mt(n,i);for(let f=0;f<c.size;++f){const h=c.indexToLoc(f),d=h.map((p,g)=>p+t[g]);c.set(u.get(...d),...h)}return i==="string"?Q3e(c.values):c.values}function Uy(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,size:a}=r;Ge(i,"slice");const[o,l]=v7(i,s,a);tne(i,o,l);const u=n.data.get(i.dataId).values,c=KIe(u,o,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,c)}const k2t={kernelName:dI,backendName:"cpu",kernelFunc:Uy};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZIe(e,t,n,r,i,s,a){const o=t[0],l=s[0],u=new Array(l),c=new Array(o),f=t[1];if(l===0){if(o!==0)throw new Error(B3e(o));const m=Br(n,0),v=Br(i,0);return[m,[0,f],v,u,c]}let h=!0,d=0;const p=new Array(l).fill(0);for(let m=0;m<o;++m){const v=e[m*f];if(v<0)throw new Error(z3e(m,v));if(v>=l)throw new Error(U3e(m,v,l));++p[v],h=h&&v>=d,d=v}let g=!0;for(let m=0;m<l;++m){const v=p[m]===0;u[m]=v,g=g&&!v,p[m]=Math.max(p[m],1),m>0&&(p[m]+=p[m-1])}if(g&&h){const m=e,v=r;for(let y=0;y<o;++y)c[y]=y;return[m,[o,f],v,u,c]}else{const m=p[l-1],v=Br(n,m*f),y=Br(i,m),b=new Array(l).fill(0);for(let x=0;x<o;++x){const w=e[x*f],C=b[w],$=(w===0?0:p[w-1])+C;b[w]++;for(let _=0;_<f;++_)v[$*f+_]=e[x*f+_];y[$]=r[x],c[x]=$}for(let x=0;x<l;++x)if(b[x]===0){const C=x===0?0:p[x-1];v[C*f+0]=x;for(let $=1;$<f;++$)v[C*f+$]=0;y[C]=a}return[v,[m,f],y,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QIe(e,t,n,r,i){const s=de(r),a=t[0],o=i.length,l=[];let u=1,c=-1;for(let m=0;m<o;++m){const v=i[m];if(v===-1){if(c!==-1)throw new Error(W3e(c,m));c=m,l.push(1)}else{if(v<0)throw new Error(V3e(m,v));u*=v,l.push(v)}}if(c!==-1){if(u<=0)throw new Error(j3e());const m=Math.trunc(s/u);if(u*m!==s)throw new Error(H3e(r,l));l[c]=m}if(de(l)!==s)throw new Error(q3e(r,l));const h=r.length,d=[];if(h>0){d[h-1]=1;for(let m=h-2;m>=0;--m)d[m]=d[m+1]*r[m+1]}const p=[];if(o>0){p[o-1]=1;for(let m=o-2;m>=0;--m)p[m]=p[m+1]*l[m+1]}const g=Br(n,a*o);for(let m=0;m<a;++m){let v=0;for(let y=0;y<h;++y)v+=e[m*h+y]*d[y];for(let y=0;y<o;++y)g[m*o+y]=Math.trunc(v/p[y]),v%=p[y]}return[g,[a,o],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ere(e,t,n,r,i,s=!1,a=0){const o=r.length,l=[t[0],e.length/t[0]],u=l[1],f=o>0?i[o-1]+1:0;if(f<0)throw new Error(qY());const h=t.slice();h[0]=f;const d=h.reduce((b,x)=>b*x,1),p=Br(n,d);if(o===0)return f>0&&p.fill(a),[p,h];if(f<=0)throw new Error(qY());let g=0,m=1,v=0,y=i[g];for(;;){let b=0;if(m<o){if(b=i[m],y===b){++m;continue}if(y>=b)throw new Error(G3e())}if(y<0||y>=f)throw new Error(Y3e(y,f));y>v&&p.fill(a,v*u,y*u);for(let x=g;x<m;++x){const w=r[x];if(w<0||w>=l[0])throw new Error(X3e(x,r[x],l[0]));for(let C=0;C<u;C++)p[y*u+C]+=e[w*u+C]}if(s)for(let x=0;x<u;x++)p[y*u+x]/=m-g;if(g=m,++m,v=y+1,y=b,m>o)break}return v<f&&p.fill(a,v*u,f*u),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E2t=sd(e=>Math.sqrt(e)),A2t=Bn(y_,e=>Math.sqrt(e)),T2t={kernelName:y_,backendName:"cpu",kernelFunc:A2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JIe=ti((e,t)=>{const n=e-t;return n*n}),D2t=xi(b_,JIe),N2t={kernelName:b_,backendName:"cpu",kernelFunc:D2t};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eMe=sd((e,t)=>{const{pattern:n,replaceGlobal:r,rewrite:i}=t;return e.replace(new RegExp(n,r?"g":""),i)}),I2t=Xm(yI,eMe),M2t={kernelName:yI,backendName:"cpu",kernelFunc:I2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tMe(e,t,n,r){const i=Mt(e,t.dtype);for(let s=0;s<i.size;s++){const a=i.indexToLoc(s),o=new Array(a.length);for(let l=0;l<o.length;l++)o[l]=a[l]*n[l]+r[l];i.set(t.get(...o),...a)}return i}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F2t{constructor(t,n,r,i,s,a){this.separator=rh(t),this.nGramWidths=n,this.leftPad=rh(r),this.rightPad=rh(i),this.padWidth=s,this.preserveShort=a}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,n){const r=this.getPadWidth(n);return Math.max(0,t+2*r-n+1)}createNGrams(t,n,r,i,s,a){for(let o=0;o<s;++o){const l=this.getPadWidth(a),u=Math.max(0,l-o),c=Math.max(0,l-(s-(o+1))),f=a-(u+c),h=n+(u>0?0:o-l);let d=0;d+=u*this.leftPad.length;for(let y=0;y<f;++y)d+=t[h+y].length;d+=c*this.rightPad.length;const p=u+c+f-1;d+=p*this.separator.length,r[i+o]=new Uint8Array(d);const g=r[i+o];let m=0;const v=y=>y.forEach(b=>g[m++]=b);for(let y=0;y<u;++y)v(this.leftPad),v(this.separator);for(let y=0;y<f-1;++y)v(t[h+y]),v(this.separator);if(f>0){v(t[h+f-1]);for(let y=0;y<c;++y)v(this.separator),v(this.rightPad)}else{for(let y=0;y<c-1;++y)v(this.rightPad),v(this.separator);v(this.rightPad)}}}compute(t,n){const r=t.length,i=n.length;if(i>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<i;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const s=i-1,a=Br("int32",i);if(r===0||i===0){const l=new Array(r);for(let u=0;u<=s;++u)a[u]=0;return[l,a]}a[0]=0;for(let l=1;l<=s;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(f=>{c+=this.getNumNGrams(u,f)}),this.preserveShort&&u>0&&c===0&&(c=1),a[l]=a[l-1]+c}const o=new Array(a[s]);for(let l=0;l<s;++l){const u=n[l];let c=a[l];if(this.nGramWidths.forEach(f=>{const h=n[l+1]-n[l],d=this.getNumNGrams(h,f);this.createNGrams(t,u,o,c,d,f),c+=d}),this.preserveShort&&c===a[l]){const f=n[l+1]-n[l];if(f===0)continue;const h=f+2*this.padWidth,d=1;this.createNGrams(t,u,o,c,d,h)}}return[o,a]}}function nMe(e,t,n,r,i,s,a,o){return new F2t(n,r,i,s,a,o).compute(e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O2t(e,t,n,r){if(!e.length)return;if(t.length===0){for(let s=0;s<e.length;++s)r.push(e.subarray(s,s+1));return}if(t.length===1){const s=t[0];let a=e.indexOf(s);for(;a!==-1;){const o=e.subarray(0,a);(!n||o.length!==0)&&r.push(o),e=e.subarray(a+1),a=e.indexOf(s)}(!n||e.length!==0)&&r.push(e);return}let i=0;for(let s=0;s<e.length+1;s++)if(s===e.length||t.indexOf(e[s])!==-1){const a=e.subarray(i,s);(!n||a.length!==0)&&r.push(a),i=s+1}}function rMe(e,t,n){const r=e.length,i=[];let s=0,a=0;const o=new Array(r);for(let h=0;h<r;++h){const d=i.length;O2t(e[h],t,n,i);const p=i.length-d;o[h]=p,s+=p,a=Math.max(a,p)}const l=Br("int32",s*2),u=new Array(s),c=[r,a];let f=0;for(let h=0;h<r;++h)for(let d=0;d<o[h];++d)l[f*2]=h,l[f*2+1]=d,u[f]=i[f],++f;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iMe(e,t){const n=Br("int32",e.length);for(let r=0;r<e.length;++r)n[r]=kAe(e[r]).modulo(t).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sMe=ti((e,t)=>e-t),R2t=Kne((e,t,n,r)=>({real:e-n,imag:t-r})),tre=xi(x_,sMe,R2t),P2t={kernelName:x_,backendName:"cpu",kernelFunc:tre};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aMe(e,t){const n=new Array(e.rank);for(let i=0;i<n.length;i++)n[i]=e.shape[i]*t[i];const r=Mt(n,e.dtype);for(let i=0;i<r.values.length;++i){const s=r.indexToLoc(i),a=new Array(e.rank);for(let l=0;l<a.length;l++)a[l]=s[l]%e.shape[l];const o=e.locToIndex(a);r.values[i]=e.values[o]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oE=(e,t)=>{const n=t.value-e.value;return n===0?e.index-t.index:n};function oMe(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){const o=r-n+1,l=t-n+1,u=Math.log(o),c=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*c*(o-c)/o)*Math.sign(l-o/2),h=Math.max(n,Math.floor(t-l*c/o+f)),d=Math.min(r,Math.floor(t+(o-l)*c/o+f));oMe(e,t,h,d)}const i=e[t];let s=n,a=r;for(Gd(e,n,t),oE(e[r],i)>0&&Gd(e,n,r);s<a;){for(Gd(e,s,a),s++,a--;oE(e[s],i)<0;)s=s+1;for(;oE(e[a],i)>0;)a=a-1}oE(e[n],i)===0?Gd(e,n,a):(a=a+1,Gd(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}}function lMe(e,t,n,r,i){const s=t[t.length-1],[a,o]=[e.length/s,s],l=Fi(n,a*r),u=Fi("int32",a*r);for(let f=0;f<a;f++){const h=f*o,d=e.subarray(h,h+o);let p=new Array(d.length);d.forEach((y,b)=>p[b]={value:y,index:b}),r<p.length&&(oMe(p,r),p=p.slice(0,r)),i&&p.sort(oE);const g=f*r,m=l.subarray(g,g+r),v=u.subarray(g,g+r);for(let y=0;y<r;y++)m[y]=p[y].value,v[y]=p[y].index}const c=t.slice();return c[c.length-1]=r,[Mt(c,n,l),Mt(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uMe(e,t,n,r){const i=Ot(t,n)[0],s=[1,n[0],1];for(let p=0;p<i;p++)s[0]*=n[p];s[1]=n[i];for(let p=i+1;p<n.length;p++)s[2]*=n[p];const a=new Map,o=new Int32Array(n[i]),l=new oi(s,r,e),u=[],c=s[0]===1&&s[2]===1;for(let p=0;p<n[i];p++){let g;if(c)g=e[p].toString();else{const v=[];for(let y=0;y<s[0];y++)for(let b=0;b<s[2];b++)v.push(l.get(y,p,b));g=v.join(",")}const m=a.get(g);if(m!=null)o[p]=m;else{const v=a.size;a.set(g,v),o[p]=v,u.push(p)}}const f=s.slice();f[1]=a.size;const h=new oi(f,r);u.forEach((p,g)=>{for(let m=0;m<s[0];m++)for(let v=0;v<s[2];v++)h.set(l.get(m,p,v),m,g,v)});const d=n.slice();return d[i]=f[1],{outputValues:h.values,outputShape:d,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L2t=Object.freeze(Object.defineProperty({__proto__:null,simpleAbsImpl:mIe,addImpl:yIe,bincountImpl:Zne,bincountReduceImpl:bIe,bitwiseAndImpl:xIe,castImpl:vIe,ceilImpl:wIe,concatImpl:$Ie,equalImpl:CIe,expImpl:SIe,expm1Impl:EIe,floorImpl:AIe,floorDivImpl:TIe,gatherNdImpl:DIe,gatherV2Impl:NIe,greaterImpl:IIe,greaterEqualImpl:MIe,lessImpl:FIe,lessEqualImpl:OIe,linSpaceImpl:RIe,logImpl:PIe,maxImpl:LIe,maximumImpl:BIe,minimumImpl:zIe,multiplyImpl:Qne,negImpl:UIe,notEqualImpl:WIe,prodImpl:VIe,raggedGatherImpl:jIe,raggedRangeImpl:HIe,raggedTensorToTensorImpl:qIe,rangeImpl:GIe,rsqrtImpl:YIe,scatterImpl:A1,sigmoidImpl:_2t,sliceImpl:KIe,sparseFillEmptyRowsImpl:ZIe,sparseReshapeImpl:QIe,sparseSegmentReductionImpl:ere,sqrtImpl:E2t,squaredDifferenceImpl:JIe,staticRegexReplaceImpl:eMe,stridedSliceImpl:tMe,stringNGramsImpl:nMe,stringSplitImpl:rMe,stringToHashBucketFastImpl:iMe,subImpl:sMe,tileImpl:aMe,topKImpl:lMe,transposeImpl:Jne,uniqueImpl:uMe},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */hte("cpu",()=>new N7,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cMe=Bn(VC,e=>e>=0?e:Math.exp(e)-1),B2t={kernelName:VC,backendName:"cpu",kernelFunc:cMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fMe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:s}=r;Ge([i],"leakyRelu");const a=de(i.shape),o=n.data.get(i.dataId).values,l=Fi("float32",a);for(let u=0;u<o.length;u++)l[u]=o[u]<0?s*o[u]:o[u];return n.makeTensorInfo(i.shape,"float32",l)}const z2t={kernelName:UN,backendName:"cpu",kernelFunc:fMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U2t=ti((e,t)=>e<0?t*e:e);function hMe(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t;Ge([r,i],"prelu");const s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,[o,l]=U2t(r.shape,i.shape,s,a,"float32");return n.makeTensorInfo(l,"float32",o)}const W2t={kernelName:aI,backendName:"cpu",kernelFunc:hMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dMe=Bn(l_,e=>Math.max(0,e)),V2t={kernelName:l_,backendName:"cpu",kernelFunc:dMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pMe=Bn(u_,e=>Math.min(Math.max(0,e),6)),j2t={kernelName:u_,backendName:"cpu",kernelFunc:pMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V5(e,t,n,r,i){if(n==="linear")return Oh({inputs:{x:t},backend:e});if(n==="relu")return dMe({inputs:{x:t},backend:e});if(n==="elu")return cMe({inputs:{x:t},backend:e});if(n==="relu6")return pMe({inputs:{x:t},backend:e});if(n==="prelu")return hMe({inputs:{x:t,alpha:r},backend:e});if(n==="leakyrelu")return fMe({inputs:{x:t},backend:e,attrs:{alpha:i}});if(n==="sigmoid")return XIe({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nr(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:s}=r,a=de(i.shape),o=ete(s,a),l=de(o);B(a===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${i.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);const u=n.data.get(i.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,f=u.complexTensorInfos.imag;c.shape=o,f.shape=o}return{dataId:i.dataId,shape:o,dtype:i.dtype}}const H2t={kernelName:lI,backendName:"cpu",kernelFunc:nr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gMe(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s}=t,{transposeA:a,transposeB:o}=r;Ge([i,s],"matMul");const l=i.shape.length,u=s.shape.length,c=a?i.shape[l-2]:i.shape[l-1],f=o?s.shape[u-1]:s.shape[u-2],h=a?i.shape[l-1]:i.shape[l-2],d=o?s.shape[u-2]:s.shape[u-1],p=i.shape.slice(0,-2),g=s.shape.slice(0,-2),m=de(p),v=de(g),b=Ct(i.shape.slice(0,-2),s.shape.slice(0,-2)).concat([h,d]);B(c===f,()=>`Error in matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${i.shape} and ${s.shape} and transposeA=${a} and transposeB=${o} must match.`);const x=a?[m,c,h]:[m,h,c],w=o?[v,d,f]:[v,f,d],C=nr({inputs:{x:i},backend:n,attrs:{shape:x}}),$=nr({inputs:{x:s},backend:n,attrs:{shape:w}}),_=a?C.shape[1]:C.shape[2],k=a?C.shape[2]:C.shape[1],E=o?$.shape[1]:$.shape[2],S=Math.max(m,v),N=n.data.get(C.dataId).values,A=n.data.get($.dataId).values,D=Je(C.shape),T=Je($.shape),[I,F,R]=a?[D[0],1,D[1]]:[D[0],D[1],1],[P,V,z]=o?[1,T[1],T[0]]:[T[1],1,T[0]],q=k*E,G=Mt([S,k,E],C.dtype),K=G.values,Y=n.blockSize;for(let te=0;te<S;te++){const Z=te%m,ae=te%v;for(let O=0;O<k;O+=Y){const L=Math.min(O+Y,k);for(let W=0;W<E;W+=Y){const M=Math.min(W+Y,E);for(let ue=0;ue<_;ue+=Y){const X=Math.min(ue+Y,_);for(let se=O;se<L;se++)for(let oe=W;oe<M;oe++){let pe=0;for(let Ce=ue;Ce<X;Ce++){const Ue=N[Z*I+se*F+Ce*R],et=A[Ce*P+oe*V+ae*z];pe+=Ue*et}K[te*q+(se*E+oe)]+=pe}}}}}return n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo($),n.makeTensorInfo(b,G.dtype,G.values)}const q2t={kernelName:SN,backendName:"cpu",kernelFunc:gMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G2t(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s,bias:a,preluActivationWeights:o}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:f}=r;let h,d,p;const g=[];h=gMe({inputs:{a:i,b:s},attrs:{transposeA:l,transposeB:u},backend:n}),a&&(d=Bw({inputs:{a:h,b:a},backend:n}),g.push(h),h=d),c&&(p=V5(n,h,c,o,f),g.push(h),h=p);for(const v of g)n.disposeIntermediateTensorInfo(v);return h}const Y2t={kernelName:hT,backendName:"cpu",kernelFunc:G2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X2t=Bn(DC,e=>Math.acos(e)),K2t={kernelName:DC,backendName:"cpu",kernelFunc:X2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z2t=Bn(NC,e=>Math.acosh(e)),Q2t={kernelName:NC,backendName:"cpu",kernelFunc:Z2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J2t(e){const{inputs:t,backend:n}=e,r=t;Ge(t,"addN");const i=r.map(o=>n.data.get(o.dataId).values),s=Mt(r[0].shape,r[0].dtype),a=s.values;for(let o=0;o<r.length;o++){const l=i[o];for(let u=0;u<a.length;u++)a[u]+=l[u]}return n.makeTensorInfo(s.shape,s.dtype,s.values)}const ewt={kernelName:xN,backendName:"cpu",kernelFunc:J2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function twt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r;Ge(i,"all");const o=Ot(s,i.shape);let l=o;const u=Fr(l,i.shape.length);let c=i;u!=null&&(c=mo({inputs:{x:i},backend:n,attrs:{perm:u}}),l=Jr(l.length,i.shape.length)),vs("all",l,c.shape.length);const[f,h]=Li(c.shape,l),d=de(h),p=hs(de(f),c.dtype),g=n.data.get(c.dataId).values;for(let v=0;v<p.length;++v){const y=v*d;let b=g[y];for(let x=0;x<d;++x){const w=g[y+x];b=b&&w}p[v]=b}u!=null&&n.disposeIntermediateTensorInfo(c);const m=n.makeTensorInfo(f,c.dtype,p);if(a){const v=Zr(f,o),y=nr({inputs:{x:m},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(m),y}return m}const nwt={kernelName:OB,backendName:"cpu",kernelFunc:twt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r;Ge(i,"any");const o=Ot(s,i.shape);let l=o;const u=Fr(l,i.shape.length);let c=i;u!=null&&(c=mo({inputs:{x:i},backend:n,attrs:{perm:u}}),l=Jr(l.length,i.shape.length)),vs("any",l,c.shape.length);const[f,h]=Li(c.shape,l),d=de(h),p=hs(de(f),c.dtype),g=n.data.get(c.dataId).values;for(let v=0;v<p.length;++v){const y=v*d;let b=g[y];for(let x=0;x<d;++x){const w=g[y+x];b=b||w}p[v]=b}u!=null&&n.disposeIntermediateTensorInfo(c);const m=n.makeTensorInfo(f,c.dtype,p);if(a){const v=Zr(f,o),y=nr({inputs:{x:m},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(m),y}return m}const iwt={kernelName:RB,backendName:"cpu",kernelFunc:rwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function swt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;Ge(i,"argMax");let a=Ot(s,i.shape);const o=Fr(a,i.shape.length);let l=i;const u=[];o!=null&&(l=mo({inputs:{x:i},backend:n,attrs:{perm:o}}),u.push(l),a=Jr(a.length,l.shape.length)),a=[a[0]],vs("argMax",a,l.shape.length);const[c,f]=Li(l.shape,a),h=de(c),d=hs(h,"int32"),p=de(f),g=n.data.get(l.dataId).values;for(let m=0;m<d.length;++m){const v=m*p;let y=g[v],b=0;for(let x=0;x<p;++x){const w=g[v+x];w>y&&(y=w,b=x)}d[m]=b}return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),n.makeTensorInfo(c,"int32",d)}const awt={kernelName:wN,backendName:"cpu",kernelFunc:swt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function owt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;Ge(i,"argMin");let a=Ot(s,i.shape);const o=Fr(a,i.shape.length);let l=i;const u=[];o!=null&&(l=mo({inputs:{x:i},backend:n,attrs:{perm:o}}),u.push(l),a=Jr(a.length,l.shape.length)),a=[a[0]],vs("argMin",a,l.shape.length);const[c,f]=Li(l.shape,a),h=de(c),d=hs(h,"int32"),p=de(f),g=n.data.get(l.dataId).values;for(let m=0;m<d.length;++m){const v=m*p;let y=g[v],b=0;for(let x=0;x<p;++x){const w=g[v+x];w<y&&(y=w,b=x)}d[m]=b}return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),n.makeTensorInfo(c,"int32",d)}const lwt={kernelName:$N,backendName:"cpu",kernelFunc:owt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uwt=Bn(IC,e=>Math.asin(e)),cwt={kernelName:IC,backendName:"cpu",kernelFunc:uwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fwt=Bn(MC,e=>Math.asinh(e)),hwt={kernelName:MC,backendName:"cpu",kernelFunc:fwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dwt=Bn(FC,e=>Math.atan(e)),pwt={kernelName:FC,backendName:"cpu",kernelFunc:dwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gwt=ti((e,t)=>Math.atan2(e,t)),mwt=xi(RC,gwt),vwt={kernelName:RC,backendName:"cpu",kernelFunc:mwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ywt=Bn(OC,e=>Math.atanh(e)),bwt={kernelName:OC,backendName:"cpu",kernelFunc:ywt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nre(e,t,n,r,i,s){const a=i.strideHeight,o=i.strideWidth,l=i.dilationHeight,u=i.dilationWidth,c=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=i.padInfo.top,d=i.padInfo.left,p=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Mt(i.outShape,n),m=g.values,v=i.outShape[1]*i.outShape[2]*i.outShape[3],y=i.outShape[2]*i.outShape[3],b=i.outShape[3];for(let x=0;x<i.batchSize;++x){const w=x*v,C=x*r[0];for(let $=0;$<i.inChannels;++$)for(let _=0;_<i.outHeight;++_){const k=_*a-h,E=Math.max(0,k),S=Math.min(i.inHeight,c+k),N=w+_*y;for(let A=0;A<i.outWidth;++A){const D=A*o-d,T=Math.max(0,D),I=Math.min(i.inWidth,f+D);let F=p,R=0,P=0;for(let z=E;z<S;z+=l){const q=C+z*r[1];for(let G=T;G<I;G+=u){const K=q+G*r[2],Y=e[K+$];s==="max"&&Y>F?F=Y:s==="avg"&&(R+=Y,P++)}if(isNaN(F))break}const V=N+A*b+$;m[V]=s==="avg"?R/P:F}}}return g}function mMe(e,t,n,r,i=!1,s=!1){const a=Mt(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,g=Mt(t,n,e);for(let m=0;m<r.batchSize;++m)for(let v=0;v<r.inChannels;++v)for(let y=0;y<r.outHeight;++y){const b=y*o-d;let x=b;for(;x<0;)x+=u;const w=Math.min(r.inHeight,f+b);for(let C=0;C<r.outWidth;++C){const $=C*l-p;let _=$;for(;_<0;)_+=c;const k=Math.min(r.inWidth,h+$);let E=Number.NEGATIVE_INFINITY,S=-1;for(let N=x;N<w;N+=u){const A=N-b;for(let D=_;D<k;D+=c){const T=D-$,I=g.get(m,N,D,v);I>E&&(E=I,i?S=s?((m*r.inHeight+N)*r.inWidth+D)*r.inChannels+v:(N*r.inWidth+D)*r.inChannels+v:S=A*h+T)}}a.set(S,m,y,C,v)}}return a}function vMe(e,t,n,r,i,s){const a=i.strideDepth,o=i.strideHeight,l=i.strideWidth,u=i.dilationDepth,c=i.dilationHeight,f=i.dilationWidth,h=i.effectiveFilterDepth,d=i.effectiveFilterHeight,p=i.effectiveFilterWidth,g=i.padInfo.front,m=i.padInfo.top,v=i.padInfo.left,y=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Mt(i.outShape,n),x=b.values,w=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],C=i.outShape[2]*i.outShape[3]*i.outShape[4],$=i.outShape[3]*i.outShape[4],_=i.outShape[4];for(let k=0;k<i.batchSize;++k){const E=k*w,S=k*r[0];for(let N=0;N<i.inChannels;++N)for(let A=0;A<i.outDepth;++A){const D=A*a-g;let T=D;for(;T<0;)T+=u;const I=Math.min(i.inDepth,h+D),F=E+A*C;for(let R=0;R<i.outHeight;++R){const P=R*o-m;let V=P;for(;V<0;)V+=c;const z=Math.min(i.inHeight,d+P),q=F+R*$;for(let G=0;G<i.outWidth;++G){const K=G*l-v;let Y=K;for(;Y<0;)Y+=f;const te=Math.min(i.inWidth,p+K),Z=q+G*_;let ae=y,O=0,L=0;for(let M=T;M<I;M+=u){const ue=S+M*r[1];for(let X=V;X<z;X+=c){const se=ue+X*r[2];for(let oe=Y;oe<te;oe+=f){const pe=se+oe*r[3],Ce=e[pe+N];if(s==="max"&&Ce>ae?ae=Ce:s==="avg"&&(O+=Ce,L++),isNaN(ae))break}if(isNaN(ae))break}if(isNaN(ae))break}const W=Z+N;x[W]=s==="avg"?O/Math.max(L,1):ae}}}}return b}function xwt(e,t){const n=Mt(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,s=t.strideWidth,a=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,c=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,d=t.padInfo.top,p=t.padInfo.left;for(let g=0;g<t.batchSize;++g)for(let m=0;m<t.inChannels;++m)for(let v=0;v<t.outDepth;++v){const y=v*r-h;let b=y;for(;b<0;)b+=a;const x=Math.min(t.inDepth,u+y);for(let w=0;w<t.outHeight;++w){const C=w*i-d;let $=C;for(;$<0;)$+=o;const _=Math.min(t.inHeight,c+C);for(let k=0;k<t.outWidth;++k){const E=k*s-p;let S=E;for(;S<0;)S+=l;const N=Math.min(t.inWidth,f+E);let A=Number.NEGATIVE_INFINITY,D=-1;for(let T=b;T<x;T+=a){const I=T-y;for(let F=$;F<_;F+=o){const R=F-C;for(let P=S;P<N;P+=l){const V=P-E,z=e.get(g,T,F,P,m);z>=A&&(A=z,D=I*c*f+R*c+V)}}}n.set(D,g,v,w,k,m)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;Ge(i,"avgPool");const{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=r,u=1;B(ms(a,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const c=Gu(i.shape,s,a,u,o,l);let f;if(c.filterWidth===1&&c.filterHeight===1&&Qt(c.inShape,c.outShape))f=Oh({inputs:{x:i},backend:n});else{const h=n.data.get(i.dataId).values,d=Je(i.shape),p=nre(h,i.shape,i.dtype,d,c,"avg");f=n.makeTensorInfo(c.outShape,i.dtype,p.values)}return f}const $wt={kernelName:CN,backendName:"cpu",kernelFunc:wwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:a,pad:o,dimRoundingMode:l,dataFormat:u}=r;Ge(i,"avgPool3d");const c=ng(i.shape,s,a,1,o,l,u),f=n.data.get(i.dataId).values,h=vMe(f,i.shape,i.dtype,Je(i.shape),c,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const _wt={kernelName:_N,backendName:"cpu",kernelFunc:Cwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Swt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,{filterSize:a,strides:o,pad:l,dimRoundingMode:u}=r;Ge([i,s],"avgPool3DGrad");const c=ng(s.shape,a,o,1,l,u),f=c.strideDepth,h=c.strideHeight,d=c.strideWidth,p=c.filterDepth,g=c.filterHeight,m=c.filterWidth,v=c.dilationDepth,y=c.dilationHeight,b=c.dilationWidth,x=c.effectiveFilterDepth,w=c.effectiveFilterHeight,C=c.effectiveFilterWidth,$=x-1-c.padInfo.front,_=C-1-c.padInfo.left,k=w-1-c.padInfo.top,E=Mt(s.shape,"float32"),S=1/(p*g*m),N=n.bufferSync(i);for(let A=0;A<c.batchSize;++A)for(let D=0;D<c.inChannels;++D)for(let T=0;T<c.inDepth;++T)for(let I=0;I<c.inHeight;++I)for(let F=0;F<c.inWidth;++F){const R=T-$,P=I-k,V=F-_;let z=0;for(let q=0;q<x;q+=v){const G=(R+q)/f;if(!(G<0||G>=c.outDepth||Math.floor(G)!==G))for(let K=0;K<w;K+=y){const Y=(P+K)/h;if(!(Y<0||Y>=c.outHeight||Math.floor(Y)!==Y))for(let te=0;te<C;te+=b){const Z=(V+te)/d;if(Z<0||Z>=c.outWidth||Math.floor(Z)!==Z)continue;const ae=N.get(A,G,Y,Z,D);z+=ae}}}E.set(z*S,A,T,I,F,D)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const kwt={kernelName:LB,backendName:"cpu",kernelFunc:Swt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ewt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,a=s;Ge([i,s],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=r,c=Gu(a.shape,o,l,1,u),f=c.strideHeight,h=c.strideWidth,d=c.filterHeight,p=c.filterWidth,g=c.dilationHeight,m=c.dilationWidth,v=c.effectiveFilterHeight,y=c.effectiveFilterWidth,b=y-1-c.padInfo.left,x=v-1-c.padInfo.top,w=Mt(a.shape,"float32"),C=1/(d*p),$=n.data.get(i.dataId).values,_=Mt(i.shape,"float32",$);for(let k=0;k<c.batchSize;++k)for(let E=0;E<c.inChannels;++E)for(let S=0;S<c.inHeight;++S)for(let N=0;N<c.inWidth;++N){const A=S-x,D=N-b;let T=0;for(let I=0;I<v;I+=g){const F=(A+I)/f;if(!(F<0||F>=c.outHeight||Math.floor(F)!==F))for(let R=0;R<y;R+=m){const P=(D+R)/h;if(P<0||P>=c.outWidth||Math.floor(P)!==P)continue;const V=_.get(k,F,P,E);T+=V}}w.set(T*C,k,S,N,E)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const Awt={kernelName:PB,backendName:"cpu",kernelFunc:Ewt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Twt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,scale:s,offset:a,mean:o,variance:l}=t;B(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),B(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),B(s==null||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ge([i,o,l,s,a],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);const c=n.data.get(i.dataId).values,f=n.data.get(o.dataId).values,h=n.data.get(l.dataId).values,d=s?n.data.get(s.dataId).values:new Float32Array([1]),p=a?n.data.get(a.dataId).values:new Float32Array([0]),g=new Float32Array(c.length),m=p.length,v=d.length,y=h.length,b=f.length;let x=0,w=0,C=0,$=0;for(let _=0;_<c.length;++_)g[_]=p[x++]+(c[_]-f[w++])*d[C++]/Math.sqrt(h[$++]+u),x>=m&&(x=0),w>=b&&(w=0),C>=v&&(C=0),$>=y&&($=0);return n.makeTensorInfo(i.shape,i.dtype,g)}const Dwt={kernelName:LN,backendName:"cpu",kernelFunc:Twt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,crops:a}=r;Ge([i],"batchToSpaceND");const o=s.reduce((v,y)=>v*y),l=NI(i.shape,s,o),u=II(l.length,s.length),c=MI(i.shape,s,o),f=cne(a,s.length),h=fne(c,a,s.length),d=nr({inputs:{x:i},backend:n,attrs:{shape:l}}),p=mo({inputs:{x:d},backend:n,attrs:{perm:u}}),g=nr({inputs:{x:p},backend:n,attrs:{shape:c}}),m=Uy({inputs:{x:g},backend:n,attrs:{begin:f,size:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const Iwt={kernelName:kN,backendName:"cpu",kernelFunc:Nwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:a}=r,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,u=Zne(o,l,s.dtype,s.shape,a);return n.makeTensorInfo([a],s.dtype,u)}const Fwt={kernelName:BB,backendName:"cpu",kernelFunc:Mwt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Owt(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,o=Ct(Array.from(s),Array.from(a));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const Rwt={kernelName:zB,backendName:"cpu",kernelFunc:Owt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pwt=Bn(BC,(e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),Lwt={kernelName:BC,backendName:"cpu",kernelFunc:Pwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bwt=e=>{const{x:t}=e.inputs,n=e.backend,r=new Float32Array(de(t.shape)),i=n.data.get(t.dataId),s=i.complexTensorInfos.real,a=i.complexTensorInfos.imag,o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values;for(let u=0;u<o.length;u++){const c=o[u],f=l[u];r[u]=Math.hypot(c,f)}return n.makeOutput(r,t.shape,"float32")},zwt={kernelName:AN,backendName:"cpu",kernelFunc:Bwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zw(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.imag,s=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,s)}const Uwt={kernelName:az,backendName:"cpu",kernelFunc:zw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uw(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,s=Ot(i,t[0].shape)[0],a=t.map(g=>g.shape);one(a,s);let o=sh(t.map(g=>g.shape),s);if(de(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);const l=t.filter(g=>de(g.shape)>0);if(l.length===1)return Oh({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const g=l.map(x=>zy({inputs:{input:x},backend:n})),m=l.map(x=>zw({inputs:{input:x},backend:n})),v=Uw({inputs:g,backend:n,attrs:{axis:s}}),y=Uw({inputs:m,backend:n,attrs:{axis:s}}),b=Wo({inputs:{real:v,imag:y},backend:n});return g.forEach(x=>n.disposeIntermediateTensorInfo(x)),m.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),b}const u=l.map(g=>{const v=[-1,de(g.shape.slice(s))];return nr({inputs:{x:g},backend:n,attrs:{shape:v}})}),c=u.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));o=sh(u.map(g=>g.shape),1);const f=u[0].shape[0]===1,h=$Ie(c,o,t[0].dtype,f),d=sh(l.map(g=>g.shape),s),p=n.makeTensorInfo(d,t[0].dtype,h);return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const Wwt={kernelName:TN,backendName:"cpu",kernelFunc:Uw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yMe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=r;Ge([i,s],"conv2d");const f=rg(l),h=Pi(i.shape,s.shape,a,u,o,c,!1,f),d=h.filterHeight,p=h.filterWidth,g=h.dilationHeight,m=h.dilationWidth,v=h.padInfo.left,y=h.padInfo.top,b=h.dataFormat==="channelsLast",x=new oi(h.outShape,i.dtype),w=Je(i.shape),C=Je(s.shape),$=w[0],_=b?w[1]:w[2],k=b?w[2]:1,E=b?1:w[1],S=x.strides[0],N=b?x.strides[1]:x.strides[2],A=b?x.strides[2]:1,D=b?1:x.strides[1],T=n.data.get(i.dataId).values,I=n.data.get(s.dataId).values,F=x.values;for(let R=0;R<h.batchSize;++R){const P=R*$,V=R*S;for(let z=0;z<h.outHeight;++z){const q=V+z*N,G=z*h.strideHeight-y;for(let K=0;K<d;++K){const Y=G+K*g;if(Y<0||Y>=h.inHeight)continue;const te=K*C[0],Z=P+Y*_;for(let ae=0;ae<h.outWidth;++ae){const O=q+ae*A,L=ae*h.strideWidth-v;for(let W=0;W<p;++W){const M=L+W*m;if(M<0||M>=h.inWidth)continue;const ue=te+W*C[1],X=Z+M*k;let se=ue;for(let oe=0;oe<h.inChannels;++oe){const pe=T[X+oe*E];for(let Ce=0;Ce<h.outChannels;++Ce)F[O+Ce*D]+=pe*I[se+Ce];se+=h.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,F)}const Vwt={kernelName:DN,backendName:"cpu",kernelFunc:yMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:a,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;Ge([i,s],"conv2dBackpropFilter");const f=rg(l),h=Pi(i.shape,c,a,1,o,u,!1,f),{strideHeight:d,strideWidth:p,filterHeight:g,filterWidth:m}=h,v=h.dataFormat==="channelsLast",y=new oi(h.filterShape,"float32"),b=h.padInfo.left,x=h.padInfo.top,w=n.data.get(i.dataId).values,C=n.data.get(s.dataId).values,$=new oi(i.shape,i.dtype,w),_=new oi(s.shape,s.dtype,C);for(let k=0;k<g;++k){const E=Math.max(0,Math.ceil((x-k)/d)),S=Math.min(h.outHeight,(h.inHeight+x-k)/d);for(let N=0;N<m;++N){const A=Math.max(0,Math.ceil((b-N)/p)),D=Math.min(h.outWidth,(h.inWidth+b-N)/p);for(let T=0;T<h.inChannels;++T)for(let I=0;I<h.outChannels;++I){let F=0;for(let R=0;R<h.batchSize;++R)for(let P=E;P<S;++P){const V=k+P*d-x;for(let z=A;z<D;++z){const q=N+z*p-b;v?F+=$.get(R,V,q,T)*_.get(R,P,z,I):F+=$.get(R,T,V,q)*_.get(R,I,P,z)}}y.set(F,k,N,T,I)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const Hwt={kernelName:WB,backendName:"cpu",kernelFunc:jwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qwt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{inputShape:a,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=r;Ge([i,s],"conv2dBackpropInput");const f=Je(s.shape),h=Je(i.shape);let d=rg(u);const p=Pi(a,s.shape,o,1,l,c,!1,d),g=new oi(p.inShape,"float32"),m=g.values,v=n.data.get(i.dataId).values,y=n.data.get(s.dataId).values,[b,x,w]=f,{batchSize:C,filterHeight:$,filterWidth:_,inChannels:k,inHeight:E,inWidth:S,outChannels:N,outHeight:A,outWidth:D,strideHeight:T,strideWidth:I}=p;d=p.dataFormat;const F=$-1-p.padInfo.top,R=_-1-p.padInfo.left,P=d==="channelsLast",V=g.strides[0],z=P?g.strides[1]:g.strides[2],q=P?g.strides[2]:1,G=P?1:g.strides[1],K=h[0],Y=P?h[1]:h[2],te=P?h[2]:1,Z=P?1:h[1];for(let ae=0;ae<C;++ae)for(let O=0;O<k;++O)for(let L=0;L<E;++L){const W=L-F,M=Math.max(0,Math.ceil(W/T)),ue=Math.min(A,($+W)/T);for(let X=0;X<S;++X){const se=X-R,oe=Math.max(0,Math.ceil(se/I)),pe=Math.min(D,(_+se)/I);let Ce=0;for(let et=M;et<ue;++et){const dt=et*T-W;for(let He=oe;He<pe;++He){const Se=He*I-se,j=K*ae+Y*et+te*He,fe=b*($-1-dt)+x*(_-1-Se)+w*O;for(let _e=0;_e<N;++_e){const ve=v[j+Z*_e],ye=y[fe+_e];Ce+=ve*ye}}}const Ue=V*ae+z*L+q*X+G*O;m[Ue]=Ce}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const Gwt={kernelName:NN,backendName:"cpu",kernelFunc:qwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ywt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dilations:l}=r;Ge([i,s],"conv3d");const u=Vm(i.shape,s.shape,a,l,o),{filterDepth:c,filterHeight:f,filterWidth:h,dilationDepth:d,dilationHeight:p,dilationWidth:g,padInfo:m}=u,v=m.front,y=m.left,b=m.top,x=new oi(u.outShape,i.dtype),w=n.data.get(i.dataId).values,C=n.data.get(s.dataId).values,$=x.values,_=Je(i.shape),k=Je(s.shape);for(let E=0;E<u.batchSize;++E){const S=E*_[0],N=E*x.strides[0];for(let A=0;A<u.outDepth;++A){const D=N+A*x.strides[1],T=A*u.strideDepth-v;for(let I=0;I<c;++I){const F=T+I*d;if(F<0||F>=u.inDepth)continue;const R=I*k[0],P=S+F*_[1];for(let V=0;V<u.outHeight;++V){const z=D+V*x.strides[2],q=V*u.strideHeight-b;for(let G=0;G<f;++G){const K=q+G*p;if(K<0||K>=u.inHeight)continue;const Y=R+G*k[1],te=P+K*_[2];for(let Z=0;Z<u.outWidth;++Z){const ae=z+Z*u.outChannels,O=Z*u.strideWidth-y;for(let L=0;L<h;++L){const W=O+L*g;if(W<0||W>=u.inWidth)continue;const M=Y+L*k[2],ue=te+W*u.inChannels;let X=M;for(let se=0;se<u.inChannels;++se){const oe=w[ue+se];for(let pe=0;pe<u.outChannels;++pe)$[ae+pe]+=oe*C[X+pe];X+=u.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const Xwt={kernelName:IN,backendName:"cpu",kernelFunc:Ywt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:a,pad:o,filterShape:l}=r;Ge([i,s],"conv3dBackpropFilterV2");const u=Je(i.shape),c=Je(s.shape),f=Vm(i.shape,l,a,1,o),h=f.strideDepth,d=f.strideHeight,p=f.strideWidth,g=f.filterDepth,m=f.filterHeight,v=f.filterWidth,y=new oi(f.filterShape,"float32"),b=y.values,[x,w,C,$]=y.strides,_=n.data.get(s.dataId).values,[k,E,S,N]=c,A=n.data.get(i.dataId).values,[D,T,I,F]=u,R=f.padInfo.front,P=f.padInfo.left,V=f.padInfo.top;for(let z=0;z<g;++z){const q=Math.max(0,Math.ceil((R-z)/h)),G=Math.min(f.outDepth,(f.inDepth+R-z)/h),K=z*x;for(let Y=0;Y<m;++Y){const te=Math.max(0,Math.ceil((V-Y)/d)),Z=Math.min(f.outHeight,(f.inHeight+V-Y)/d),ae=Y*w+K;for(let O=0;O<v;++O){const L=Math.max(0,Math.ceil((P-O)/p)),W=Math.min(f.outWidth,(f.inWidth+P-O)/p),M=O*C+ae;for(let ue=0;ue<f.inChannels;++ue){const X=ue*$+M;for(let se=0;se<f.outChannels;++se){let oe=0;for(let pe=0;pe<f.batchSize;++pe){const Ce=pe*D,Ue=pe*k;for(let et=q;et<G;++et){const He=(z+et*h-R)*T+Ce,Se=et*E+Ue;for(let j=te;j<Z;++j){const _e=(Y+j*d-V)*I+He,ve=j*S+Se;for(let ye=L;ye<W;++ye){const Ae=(O+ye*p-P)*F+_e,Ve=ye*N+ve;oe+=A[Ae+ue]*_[Ve+se]}}}}b[X+se]=oe}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const Zwt={kernelName:VB,backendName:"cpu",kernelFunc:Kwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qwt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{pad:a,strides:o,inputShape:l}=r;Ge([i],"conv3dBackpropInputV2");const u=Je(i.shape),c=Je(s.shape),f=Vm(l,s.shape,o,1,a),h=new oi(f.inShape,"float32"),d=h.values,[p,g,m,v]=h.strides,y=n.data.get(i.dataId).values,[b,x,w,C]=u,$=n.data.get(s.dataId).values,[_,k,E,S]=c,{batchSize:N,filterDepth:A,filterHeight:D,filterWidth:T,inChannels:I,inDepth:F,inHeight:R,inWidth:P,outChannels:V,outDepth:z,outHeight:q,outWidth:G,strideDepth:K,strideHeight:Y,strideWidth:te}=f,Z=A-1-f.padInfo.front,ae=D-1-f.padInfo.top,O=T-1-f.padInfo.left;for(let L=0;L<N;++L)for(let W=0;W<I;++W)for(let M=0;M<F;++M){const ue=M-Z,X=Math.max(0,Math.ceil(ue/K)),se=Math.min(z,(A+ue)/K);for(let oe=0;oe<R;++oe){const pe=oe-ae,Ce=Math.max(0,Math.ceil(pe/Y)),Ue=Math.min(q,(D+pe)/Y);for(let et=0;et<P;++et){const dt=et-O,He=Math.max(0,Math.ceil(dt/te)),Se=Math.min(G,(T+dt)/te);let j=0;for(let fe=X;fe<se;++fe){const _e=fe*K-ue;for(let ve=Ce;ve<Ue;++ve){const ye=ve*Y-pe;for(let yt=He;yt<Se;++yt){const Ae=yt*te-dt,Ve=b*L+x*fe+w*ve+C*yt,Kt=_*(A-1-_e)+k*(D-1-ye)+E*(T-1-Ae)+S*W;for(let rn=0;rn<V;++rn){const Nt=y[Ve+rn],fn=$[Kt+rn];j+=Nt*fn}}}}d[p*L+g*M+m*oe+v*et+W]=j}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const Jwt={kernelName:jB,backendName:"cpu",kernelFunc:Qwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e$t=Bn(zC,e=>Math.cos(e)),t$t={kernelName:zC,backendName:"cpu",kernelFunc:e$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n$t=Bn(UC,e=>Math.cosh(e)),r$t={kernelName:UC,backendName:"cpu",kernelFunc:n$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i$t(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:s,boxInd:a}=t,{cropSize:o,method:l,extrapolationValue:u}=r,[c,f,h,d]=i.shape,p=s.shape[0],[g,m]=o,v=Mt([p,g,m,d],"float32"),y=n.data.get(s.dataId).values,b=n.data.get(a.dataId).values,x=n.data.get(i.dataId).values,w=Je(i.shape),C=Je(v.shape);for(let $=0;$<p;$++){const _=$*4,k=y[_],E=y[_+1],S=y[_+2],N=y[_+3],A=b[$];if(A>=c)continue;const D=g>1?(S-k)*(f-1)/(g-1):0,T=m>1?(N-E)*(h-1)/(m-1):0;for(let I=0;I<g;I++){const F=g>1?k*(f-1)+I*D:.5*(k+S)*(f-1);if(F<0||F>f-1){for(let R=0;R<m;R++)for(let P=0;P<d;P++){const V=P+R*C[2]+I*C[1]+$*C[0];v.values[V]=u}continue}if(l==="bilinear"){const R=Math.floor(F),P=Math.ceil(F),V=F-R;for(let z=0;z<m;z++){const q=m>1?E*(h-1)+z*T:.5*(E+N)*(h-1);if(q<0||q>h-1){for(let te=0;te<d;te++){const Z=te+z*C[2]+I*C[1]+$*C[0];v.values[Z]=u}continue}const G=Math.floor(q),K=Math.ceil(q),Y=q-G;for(let te=0;te<d;te++){let Z=te+G*w[2]+R*w[1]+A*w[0];const ae=x[Z];Z=te+K*w[2]+R*w[1]+A*w[0];const O=x[Z];Z=te+G*w[2]+P*w[1]+A*w[0];const L=x[Z];Z=te+K*w[2]+P*w[1]+A*w[0];const W=x[Z],M=ae+(O-ae)*Y,ue=L+(W-L)*Y;Z=te+z*C[2]+I*C[1]+$*C[0],v.values[Z]=M+(ue-M)*V}}}else for(let R=0;R<m;++R){const P=m>1?E*(h-1)+R*T:.5*(E+N)*(h-1);if(P<0||P>h-1){for(let q=0;q<d;q++){const G=q+R*C[2]+I*C[1]+$*C[0];v.values[G]=u}continue}const V=Math.round(P),z=Math.round(F);for(let q=0;q<d;q++){const G=q+V*w[2]+z*w[1]+A*w[0],K=q+R*C[2]+I*C[1]+$*C[0];v.values[K]=x[G]}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const s$t={kernelName:qB,backendName:"cpu",kernelFunc:i$t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:a,reverse:o}=r;Ge(i,"cumprod");const l=Fr([s],i.shape.length);let u=i;l!=null&&(u=mo({inputs:{x:i},backend:n,attrs:{perm:l}}));const c=Jr(1,i.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const f=po(u.dtype,"int32"),h=MB(de(u.shape),f),d=n.data.get(u.dataId).values,p=u.shape[u.shape.length-1],g=o?(v,y)=>v+p-y-1:(v,y)=>v+y;for(let v=0;v<d.length;v+=p)for(let y=0;y<p;y++){const b=g(v,y);if(y===0)h[b]=a?1:d[b];else{const x=g(v,y-1);h[b]=a?d[x]*h[x]:d[b]*h[x]}}const m=n.makeTensorInfo(u.shape,f,h);if(l!=null){const v=jm(l),y=mo({inputs:{x:m},backend:n,attrs:{perm:v}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(u),y}return m}const o$t={kernelName:HB,backendName:"cpu",kernelFunc:a$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:a,reverse:o}=r;Ge(i,"cumsum");const l=Fr([s],i.shape.length);let u=i;l!=null&&(u=mo({inputs:{x:i},backend:n,attrs:{perm:l}}));const c=Jr(1,i.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const f=po(u.dtype,"int32"),h=hs(de(u.shape),f),d=n.data.get(u.dataId).values,p=u.shape[u.shape.length-1],g=o?(v,y)=>v+p-y-1:(v,y)=>v+y;for(let v=0;v<d.length;v+=p)for(let y=0;y<p;y++){const b=g(v,y);if(y===0)h[b]=a?0:d[b];else{const x=g(v,y-1);h[b]=a?d[x]+h[x]:d[b]+h[x]}}const m=n.makeTensorInfo(u.shape,f,h);if(l!=null){const v=jm(l),y=mo({inputs:{x:m},backend:n,attrs:{perm:v}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(u),y}return m}const u$t={kernelName:MN,backendName:"cpu",kernelFunc:l$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:a,binaryOutput:o}=r;if(i.shape.length===1){const l=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,c=Zne(l,u,s.dtype,s.shape,a);return n.makeTensorInfo([a],s.dtype,c)}else if(i.shape.length===2){const l=n.bufferSync(i),u=n.bufferSync(s),c=bIe(l,u,a,o);return n.makeTensorInfo(c.shape,s.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const f$t={kernelName:GB,backendName:"cpu",kernelFunc:c$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:s,dataFormat:a}=r;B(a==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${a}`);const o=i.shape[0],l=i.shape[1],u=i.shape[2],c=i.shape[3],f=l*s,h=u*s,d=c/(s*s),p=n.data.get(i.dataId).values,g=new Float32Array(o*f*h*d);let m=0;for(let v=0;v<o;++v)for(let y=0;y<f;++y){const b=Math.floor(y/s),x=y%s;for(let w=0;w<h;++w){const C=Math.floor(w/s),$=w%s,_=(x*s+$)*d;for(let k=0;k<d;++k){const S=k+_+c*(C+u*(b+l*v));g[m++]=p[S]}}}return n.makeTensorInfo([o,f,h,d],i.dtype,g)}const d$t={kernelName:YB,backendName:"cpu",kernelFunc:h$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bMe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dilations:l,dimRoundingMode:u}=r;Ge([i,s],"depthwiseConv2DNative");const c=Je(i.shape),f=Je(s.shape);let h=l;h==null&&(h=[1,1]),B(ms(a,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${h}'`);const d=Pi(i.shape,s.shape,a,h,o,u,!0),{filterHeight:p,filterWidth:g,dilationHeight:m,dilationWidth:v,padInfo:y}=d,b=y.left,x=y.top,w=d.outChannels/d.inChannels,C=new oi(d.outShape,i.dtype),$=n.data.get(i.dataId).values,_=n.data.get(s.dataId).values,k=C.values;for(let E=0;E<d.batchSize;++E){const S=E*c[0],N=E*C.strides[0];for(let A=0;A<d.outHeight;++A){const D=N+A*C.strides[1],T=A*d.strideHeight-x;for(let I=0;I<p;++I){const F=T+I*m;if(F<0||F>=d.inHeight)continue;const R=I*f[0],P=S+F*c[1];for(let V=0;V<d.outWidth;++V){const z=D+V*C.strides[2],q=V*d.strideWidth-b;for(let G=0;G<g;++G){const K=q+G*v;if(K<0||K>=d.inWidth)continue;const Y=R+G*f[1],te=P+K*d.inChannels;let Z=z,ae=Y;for(let O=0;O<d.inChannels;++O){const L=$[te+O];for(let W=0;W<w;++W)k[Z+W]+=L*_[ae+W];Z+=w,ae+=w}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const p$t={kernelName:FN,backendName:"cpu",kernelFunc:bMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:a,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=r;Ge([i,s],"depthwiseConv2dNativeBackpropFilter");const f=Pi(i.shape,c,a,o,l,u,!0),{strideHeight:h,strideWidth:d,filterHeight:p,filterWidth:g}=f,m=new oi(f.filterShape,"float32"),v=f.padInfo.left,y=f.padInfo.top,b=f.outChannels/f.inChannels,x=n.data.get(i.dataId).values,w=new oi(i.shape,i.dtype,x),C=n.data.get(s.dataId).values,$=new oi(s.shape,s.dtype,C);for(let _=0;_<p;++_){const k=Math.max(0,Math.ceil((y-_)/h)),E=Math.min(f.outHeight,(f.inHeight+y-_)/h);for(let S=0;S<g;++S){const N=Math.max(0,Math.ceil((v-S)/d)),A=Math.min(f.outWidth,(f.inWidth+v-S)/d);for(let D=0;D<f.outChannels;++D){const T=Math.trunc(D/b),I=D%b;let F=0;for(let R=0;R<f.batchSize;++R)for(let P=k;P<E;++P){const V=_+P*h-y;for(let z=N;z<A;++z){const q=S+z*d-v;F+=w.get(R,V,q,T)*$.get(R,P,z,D)}}m.set(F,_,S,T,I)}}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const m$t={kernelName:XB,backendName:"cpu",kernelFunc:g$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v$t(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{strides:a,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=r;Ge([i,s],"depthwiseConv2DNativeBackpropInput");const f=Je(i.shape),h=Je(s.shape),d=Pi(c,s.shape,a,o,l,u,!0),p=new oi(d.inShape,"float32"),g=p.values,[m,v,y]=p.strides,b=n.data.get(i.dataId).values,[x,w,C]=f,$=n.data.get(s.dataId).values,[_,k,E]=h,{batchSize:S,filterHeight:N,filterWidth:A,inChannels:D,inHeight:T,inWidth:I,outChannels:F,outHeight:R,outWidth:P,strideHeight:V,strideWidth:z}=d,q=N-1-d.padInfo.top,G=A-1-d.padInfo.left,K=F/D;for(let Y=0;Y<S;++Y)for(let te=0;te<D;++te)for(let Z=0;Z<T;++Z){const ae=Z-q,O=Math.max(0,Math.ceil(ae/V)),L=Math.min(R,(N+ae)/V);for(let W=0;W<I;++W){const M=W-G,ue=Math.max(0,Math.ceil(M/z)),X=Math.min(P,(A+M)/z);let se=0;for(let oe=O;oe<L;++oe){const pe=oe*V-ae;for(let Ce=ue;Ce<X;++Ce){const Ue=Ce*z-M,et=x*Y+w*oe+C*Ce,dt=_*(N-1-pe)+k*(A-1-Ue)+E*te;for(let He=0;He<K;++He){const Se=te*K+He,j=b[et+Se],fe=$[dt+He];se+=j*fe}}}g[m*Y+v*Z+y*W+te]=se}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const y$t={kernelName:KB,backendName:"cpu",kernelFunc:v$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b$t(e){const{inputs:t,backend:n}=e,{x:r}=t,i=de(r.shape),s=n.data.get(r.dataId).values,a=Mt([i,i],r.dtype),o=a.values;for(let u=0;u<s.length;u++)o[u*i+u]=s[u];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,a.dtype,a.values)}const x$t={kernelName:ZB,backendName:"cpu",kernelFunc:b$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w$t={kernelName:ON,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i}=e,{strides:s,pad:a,dilations:o}=n,l=t,u=l.data.get(r.dataId).values,c=r.shape.length,f=l.data.get(i.dataId).values,h=i.shape.length,{batchSize:d,inHeight:p,inWidth:g,inChannels:m,outHeight:v,outWidth:y,padInfo:b,strideHeight:x,strideWidth:w,filterHeight:C,filterWidth:$,dilationHeight:_,dilationWidth:k,outShape:E}=_I(r.shape,i.shape,s,a,"NHWC",o),S=de(E),N=E.length,A=Br(r.dtype,S);for(let T=0;T<d;++T)for(let I=0;I<v;++I){const F=I*x-b.top;for(let R=0;R<y;++R){const P=R*w-b.left;for(let V=0;V<m;++V){let z=Number.MIN_SAFE_INTEGER;for(let G=0;G<C;++G){const K=F+G*_;if(K>=0&&K<p)for(let Y=0;Y<$;++Y){const te=P+Y*k;if(te>=0&&te<g){const Z=zc([T,K,te,V],c,Je(r.shape)),ae=zc([G,Y,V],h,Je(i.shape)),O=u[Z]+f[ae];O>z&&(z=O)}}}const q=zc([T,I,R,V],N,Je(E));A[q]=z}}}return{dataId:l.write(Um(A,r.dtype),E,r.dtype),shape:E,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $$t={kernelName:_5,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i,dy:s}=e,{strides:a,pad:o,dilations:l}=n,u=t,c=Tu(r.shape,u.data.get(r.dataId).values),f=Tu(i.shape,u.data.get(i.dataId).values),{batchSize:h,inHeight:d,inWidth:p,inChannels:g,outHeight:m,outWidth:v,padInfo:y,strideHeight:b,strideWidth:x,filterHeight:w,filterWidth:C,dilationHeight:$,dilationWidth:_,outShape:k}=_I(r.shape,i.shape,a,o,"NHWC",l);B(s.rank===k.length,()=>`Error in ${_5}, dy must have the same rank as output ${k.length}, but got ${s.rank}`);const E=Tu(k,u.data.get(s.dataId).values),S=nte(i.shape,i.dtype);for(let A=0;A<h;++A)for(let D=0;D<m;++D){const T=D*b-y.top;for(let I=0;I<v;++I){const F=I*x-y.left;for(let R=0;R<g;++R){let P=Number.MIN_SAFE_INTEGER,V=0,z=0;for(let q=0;q<w;++q){const G=T+q*$;if(G>=0&&G<d)for(let K=0;K<C;++K){const Y=F+K*_;if(Y>=0&&Y<p){const te=c[A][G][Y][R]+f[q][K][R];te>P&&(P=te,V=q,z=K)}}}S[V][z][R]+=E[A][D][I][R]}}}return{dataId:u.write(Um(S,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C$t={kernelName:C5,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i,dy:s}=e,{strides:a,pad:o,dilations:l}=n,u=t,c=Tu(r.shape,u.data.get(r.dataId).values),f=Tu(i.shape,u.data.get(i.dataId).values),{batchSize:h,inHeight:d,inWidth:p,inChannels:g,outHeight:m,outWidth:v,padInfo:y,strideHeight:b,strideWidth:x,filterHeight:w,filterWidth:C,dilationHeight:$,dilationWidth:_,outShape:k}=_I(r.shape,i.shape,a,o,"NHWC",l);B(s.rank===k.length,()=>`Error in ${C5}, dy must have the same rank as output ${k.length}, but got ${s.rank}`);const E=Tu(k,u.data.get(s.dataId).values),S=nte(r.shape,r.dtype);for(let A=0;A<h;++A)for(let D=0;D<m;++D){const T=D*b-y.top;for(let I=0;I<v;++I){const F=I*x-y.left;for(let R=0;R<g;++R){let P=Number.MIN_SAFE_INTEGER,V=T<0?0:T,z=F<0?0:F;for(let q=0;q<w;++q){const G=T+q*$;if(G>=0&&G<d)for(let K=0;K<C;++K){const Y=F+K*_;if(Y>=0&&Y<p){const te=c[A][G][Y][R]+f[q][K][R];te>P&&(P=te,V=G,z=Y)}}}S[A][V][z][R]+=E[A][D][I][R]}}}return{dataId:u.write(Um(S,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _$t(e){const{inputs:t,backend:n,attrs:r}=e,{image:i}=t,{canvas:s,options:a}=r,{contextOptions:o,imageOptions:l}=a||{},u=(l==null?void 0:l.alpha)||1,c=(o==null?void 0:o.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const f=s.getContext(c,(o==null?void 0:o.contextAttributes)||{});if(f==null)throw new Error(`Could not get the context with ${c} type.`);const[h,d]=i.shape.slice(0,2),p=i.shape.length===2?1:i.shape[2],g=n.data.get(i.dataId).values,m=i.dtype==="float32"?255:1,v=new Uint8ClampedArray(d*h*4);for(let b=0;b<h*d;++b){const x=[0,0,0,255*u];for(let C=0;C<p;C++){const $=g[b*p+C];if(i.dtype==="float32"){if($<0||$>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${$}.`)}else if(i.dtype==="int32"&&($<0||$>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${$}.`);p===1?(x[0]=$*m,x[1]=$*m,x[2]=$*m):x[C]=$*m}const w=b*4;v[w+0]=Math.round(x[0]),v[w+1]=Math.round(x[1]),v[w+2]=Math.round(x[2]),v[w+3]=Math.round(x[3])}s.width=d,s.height=h;const y=new ImageData(v,d,h);return f.putImageData(y,0,0),i}const S$t={kernelName:QB,backendName:"cpu",kernelFunc:_$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WI(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r;Ge(i,"sum");let o;i.dtype==="bool"?o=Z0({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):o=Oh({inputs:{x:i},backend:n});const l=o.shape.length,u=Ot(s,o.shape),c=Fr(u,l);let f=u,h=o;c!=null&&(h=mo({inputs:{x:o},backend:n,attrs:{perm:c}}),f=Jr(f.length,l)),vs("sum",f,h.shape.length);const[d,p]=Li(h.shape,f),g=po(h.dtype,"int32");let m=U5(n,d,g);const v=de(p),y=n.data.get(m.dataId).values,b=n.data.get(h.dataId).values;for(let x=0;x<y.length;++x){const w=x*v;let C=0;for(let $=0;$<v;++$)C+=b[w+$];y[x]=C}if(a){const x=Zr(m.shape,u),w=m;m=nr({inputs:{x:m},backend:n,attrs:{shape:x}}),n.disposeIntermediateTensorInfo(w)}return n.disposeIntermediateTensorInfo(o),c!=null&&n.disposeIntermediateTensorInfo(h),m}const k$t={kernelName:pI,backendName:"cpu",kernelFunc:WI};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E$t(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,s=t,{allDims:a,summedDims:o,idDims:l}=bne(i,s.length);wne(a.length,l,s);const{path:u,steps:c}=$ne(o,l),f=c.length;let h=null,d=a.length;const p=[];for(let g=0;g<f;++g){for(const m of c[g]){const{permutationIndices:v,expandDims:y}=xne(d,l[m]);let b;Cne(v)?b=s[m]:(b=mo({inputs:{x:s[m]},backend:n,attrs:{perm:v}}),p.push(b));const x=b.shape.slice();for(let w=0;w<y.length;++w)x.splice(y[w],0,1);Qt(b.shape,x)||(b=nr({inputs:{x:b},backend:n,attrs:{shape:x}}),p.push(b)),h===null?h=b:(h=I7({inputs:{a:b,b:h},backend:n}),p.push(h))}g<f-1&&(u[g]>=0&&(h=WI({inputs:{x:h},backend:n,attrs:{axis:u[g]-(a.length-d),keepDims:!1}}),p.push(h)),d--)}for(const g of p)g!==h&&n.disposeIntermediateTensorInfo(g);return h}const A$t={kernelName:JB,backendName:"cpu",kernelFunc:E$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T$t(e){const{inputs:t,backend:n}=e,{dy:r,y:i}=t;Ge([r,i],"eluGrad");const s=new Float32Array(de(i.shape)),a=n.data.get(i.dataId).values,o=n.data.get(r.dataId).values;for(let l=0;l<a.length;++l){const u=a[l];u>=0?s[l]=o[l]:s[l]=o[l]*(u+1)}return n.makeTensorInfo(i.shape,"float32",s)}const D$t={kernelName:ez,backendName:"cpu",kernelFunc:T$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N$t=hne,I$t=dne,M$t=pne,F$t=gne,O$t=mne,R$t=vne,P$t=Bn(jC,e=>{const t=Math.sign(e),n=Math.abs(e),r=1/(1+N$t*n);return t*(1-((((R$t*r+O$t)*r+F$t)*r+M$t)*r+I$t)*r*Math.exp(-n*n))}),L$t={kernelName:jC,backendName:"cpu",kernelFunc:P$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j5(e){const{inputs:t,backend:n,attrs:r}=e,{input:i}=t,{dim:s}=r,a=i.shape.length,o=i.shape.slice();let l=s;return s<0&&(B(-(a+1)<=s,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+s+1),o.splice(l,0,1),nr({inputs:{x:i},backend:n,attrs:{shape:o}})}const B$t={kernelName:PN,backendName:"cpu",kernelFunc:j5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z$t=ti((e,t)=>e/t),rre=xi(WC,z$t),rX={kernelName:WC,backendName:"cpu",kernelFunc:rre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xMe(e,t,n){const r=e.shape,i=r[0],s=r[1],a=n.data.get(e.dataId),o=a.complexTensorInfos.real,l=a.complexTensorInfos.imag,u=[i,s],c=de(u),f=Fi("float32",c),h=Fi("float32",c);for(let m=0;m<i;m++){const v=Uy({inputs:{x:o},backend:n,attrs:{begin:[m,0],size:[1,s]}}),y=Uy({inputs:{x:l},backend:n,attrs:{begin:[m,0],size:[1,s]}}),b=Wo({inputs:{real:v,imag:y},backend:n}),{real:x,imag:w}=U$t(b,t,n),C=Fp(x,w);for(let $=0;$<s;$++){const _=yne(C,$);f[m*s+$]=_.real,h[m*s+$]=_.imag}n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b)}const d=n.makeTensorInfo(u,"float32",f),p=n.makeTensorInfo(u,"float32",h),g=Wo({inputs:{real:d,imag:p},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),g}function U$t(e,t,n){const r=de(e.shape),i=n.data.get(e.dataId),s=n.data.get(i.complexTensorInfos.real.dataId).values,a=n.data.get(i.complexTensorInfos.imag.dataId).values;if(W$t(r)){const o=iX(s,a,r,t,n),l=[e.shape[0],e.shape[1]];if(t){const u=n.makeTensorInfo(l,"float32",o.real),c=n.makeTensorInfo(l,"float32",o.imag),f=n.makeTensorInfo([],"float32",tg(r,"float32")),h=Oh({inputs:{x:f},backend:n}),d=rX.kernelFunc({inputs:{a:u,b:f},backend:n}),p=rX.kernelFunc({inputs:{a:c,b:h},backend:n}),g=n.data.get(d.dataId).values,m=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),{real:g,imag:m}}return o}else{const o=Fp(s,a),l=V$t(o,r,t);return M3e(l)}}function W$t(e){return(e&e-1)===0}function iX(e,t,n,r,i){if(n===1)return{real:e,imag:t};const s=Fp(e,t),a=n/2,o=F3e(s),l=o.real,u=o.imag,c=[l.length],f=i.makeTensorInfo(c,"float32",l),h=i.makeTensorInfo(c,"float32",u),d=Wo({inputs:{real:f,imag:h},backend:i}),p=O3e(s),g=p.real,m=p.imag,v=[g.length],y=i.makeTensorInfo(v,"float32",g),b=i.makeTensorInfo(v,"float32",m),x=Wo({inputs:{real:y,imag:b},backend:i}),w=iX(l,u,a,r,i),C=w.real,$=w.imag,_=[C.length],k=i.makeTensorInfo(_,"float32",C),E=i.makeTensorInfo(_,"float32",$),S=Wo({inputs:{real:k,imag:E},backend:i}),N=iX(g,m,a,r,i),A=N.real,D=N.imag,T=[A.length],I=i.makeTensorInfo(T,"float32",A),F=i.makeTensorInfo(T,"float32",D),R=Wo({inputs:{real:I,imag:F},backend:i}),P=P3e(n,r),V=[P.real.length],z=i.makeTensorInfo(V,"float32",P.real),q=i.makeTensorInfo(V,"float32",P.imag),G=Wo({inputs:{real:z,imag:q},backend:i}),K=I7({inputs:{a:G,b:R},backend:i}),Y=Bw({inputs:{a:S,b:K},backend:i}),te=tre({inputs:{a:S,b:K},backend:i}),Z=zy({inputs:{input:Y},backend:i}),ae=zy({inputs:{input:te},backend:i}),O=zw({inputs:{input:Y},backend:i}),L=zw({inputs:{input:te},backend:i}),W=Uw({inputs:[Z,ae],backend:i,attrs:{axis:0}}),M=Uw({inputs:[O,L],backend:i,attrs:{axis:0}}),ue=i.data.get(W.dataId).values,X=i.data.get(M.dataId).values;return i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(h),i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(y),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(x),i.disposeIntermediateTensorInfo(k),i.disposeIntermediateTensorInfo(E),i.disposeIntermediateTensorInfo(S),i.disposeIntermediateTensorInfo(I),i.disposeIntermediateTensorInfo(F),i.disposeIntermediateTensorInfo(R),i.disposeIntermediateTensorInfo(z),i.disposeIntermediateTensorInfo(q),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(K),i.disposeIntermediateTensorInfo(Y),i.disposeIntermediateTensorInfo(te),i.disposeIntermediateTensorInfo(Z),i.disposeIntermediateTensorInfo(O),i.disposeIntermediateTensorInfo(ae),i.disposeIntermediateTensorInfo(L),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(M),{real:ue,imag:X}}function V$t(e,t,n){const r=new Float32Array(t*2);for(let i=0;i<t;i++){let s=0,a=0;for(let o=0;o<t;o++){const l=L3e(i*o,t,n),u=yne(e,o);s+=u.real*l.real-u.imag*l.imag,a+=u.real*l.imag+u.imag*l.real}n&&(s/=t,a/=t),R3e(r,s,a,i)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j$t(e){const{inputs:t,backend:n}=e,{input:r}=t,i=de(r.shape),s=r.shape[r.shape.length-1],a=i/s,o=nr({inputs:{x:r},backend:n,attrs:{shape:[a,s]}}),l=xMe(o,!1,n),u=nr({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const H$t={kernelName:tz,backendName:"cpu",kernelFunc:j$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ire(e){const{backend:t,attrs:n}=e,{shape:r,value:i,dtype:s}=n,a=s||Bb(i),o=Br(a,de(r));return G$t(o,i,a),t.makeTensorInfo(r,a,o)}const q$t={kernelName:nz,backendName:"cpu",kernelFunc:ire};function G$t(e,t,n){e.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y$t={kernelName:rz,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,i=n,s=Fi(r.dtype,de(r.shape)),[a,o,l,u]=r.shape,c=i.data.get(r.dataId).values;for(let h=0;h<a;h++){const d=h*l*o*u;for(let p=0;p<o;p++){const g=p*(l*u);for(let m=0;m<l;m++){const v=m*u;for(let y=0;y<u;y++){const b=Math.round(l-m-1),x=d+g+v+y;let w=c[x];if(b>=0&&b<l){const C=b*u,$=d+g+C+y;w=c[$]}s[x]=w}}}}return{dataId:i.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:a,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r;let g=yMe({inputs:{x:i,filter:s},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h}});if(a){const m=g;if(c==="NCHW"&&a.shape.length===1&&a.shape[0]!==1){const v=nr({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=Bw({inputs:{a:g,b:v},backend:n}),n.disposeIntermediateTensorInfo(v)}else g=Bw({inputs:{a:g,b:a},backend:n});n.disposeIntermediateTensorInfo(m)}if(d){const m=g;if(c==="NCHW"&&d==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const v=nr({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});g=V5(n,g,d,v,p),n.disposeIntermediateTensorInfo(v)}else g=V5(n,g,d,o,p);n.disposeIntermediateTensorInfo(m)}return g}const K$t={kernelName:dT,backendName:"cpu",kernelFunc:X$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:a,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r;let g=bMe({inputs:{x:i,filter:s},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h}});if(a){const m=g;g=Bw({inputs:{a:g,b:a},backend:n}),n.disposeIntermediateTensorInfo(m)}if(d){const m=g;g=V5(n,g,d,o,p),n.disposeIntermediateTensorInfo(m)}return g}const Q$t={kernelName:pT,backendName:"cpu",kernelFunc:Z$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J$t(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,s=de(r.shape),a=i.shape,o=a[a.length-1],[l,u,c,f]=m7(r,i);if(u===0)return n.makeTensorInfo(l,r.dtype,[]);const h=n.data.get(i.dataId).values,d=n.bufferSync(r),p=DIe(h,d,r.dtype,u,o,c,f,r.shape,s);return n.makeTensorInfo(l,r.dtype,p.values)}const eCt={kernelName:iz,backendName:"cpu",kernelFunc:J$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:s}=t,{axis:a,batchDims:o}=r;Ge([i,s],"gatherV2");const l=Ot(a,i.shape)[0],u=n.data.get(s.dataId).values,c=i.shape[l];for(let x=0;x<u.length;++x){const w=u[x];B(w<=c-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${c-1}]`)}let f=o;o==null&&(f=0);const h=de(s.shape),d=Sne(i,s,l,f),p=nr({inputs:{x:i},backend:n,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),g=nr({inputs:{x:s},backend:n,attrs:{shape:[d.batchSize,h/d.batchSize]}}),m=[d.batchSize,d.outerSize,h/d.batchSize,d.sliceSize],v=n.bufferSync(g),y=n.bufferSync(p),b=NIe(y,v,m);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(d.outputShape,b.dtype,b.values)}const nCt={kernelName:BN,backendName:"cpu",kernelFunc:tCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rCt(e){const{inputs:t,backend:n}=e,{input:r}=t,i=de(r.shape),s=r.shape[r.shape.length-1],a=i/s,o=nr({inputs:{x:r},backend:n,attrs:{shape:[a,s]}}),l=xMe(o,!0,n),u=nr({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const iCt={kernelName:sz,backendName:"cpu",kernelFunc:rCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sCt=Bn(ZC,e=>Number.isFinite(e)?1:0,"bool"),aCt={kernelName:ZC,backendName:"cpu",kernelFunc:sCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oCt=Bn(QC,e=>Math.abs(e)===1/0?1:0,"bool"),lCt={kernelName:QC,backendName:"cpu",kernelFunc:oCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uCt=Bn(JC,e=>Number.isNaN(e)?1:0,"bool"),cCt={kernelName:JC,backendName:"cpu",kernelFunc:uCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fCt(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:s}=n,a=RIe(r,i,s);return t.makeTensorInfo([a.length],"float32",a)}const hCt={kernelName:oz,backendName:"cpu",kernelFunc:fCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dCt=Bn(t_,e=>Math.log1p(e)),pCt={kernelName:t_,backendName:"cpu",kernelFunc:dCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gCt=ti((e,t)=>e&&t),mCt=xi(jN,gCt,null,"bool"),vCt={kernelName:jN,backendName:"cpu",kernelFunc:mCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yCt=Bn(HN,e=>e?0:1,"bool"),bCt={kernelName:HN,backendName:"cpu",kernelFunc:yCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xCt=ti((e,t)=>e||t),wCt=xi(qN,xCt,null,"bool"),$Ct={kernelName:qN,backendName:"cpu",kernelFunc:wCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:s,bias:a,alpha:o,beta:l}=r;Ge(i,"LRN");const u=i.shape[3],c=u-1,f=n.data.get(i.dataId).values,h=de(i.shape),d=new Float32Array(h);function p(g){const m=g%u;let v=g-m+Math.max(0,m-s);const y=g-m+Math.min(m+s,c);let b=0;for(;v<=y;v++){const x=f[v];b+=x*x}return b}for(let g=0;g<h;g++){const m=p(g),v=f[g]*Math.pow(a+o*m,-l);d[g]=v}return n.makeTensorInfo(i.shape,i.dtype,d)}const _Ct={kernelName:GN,backendName:"cpu",kernelFunc:CCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,y:s,dy:a}=t,{depthRadius:o,bias:l,alpha:u,beta:c}=r;Ge(a,"LRNGrad");const f=de(a.shape),h=a.shape[3],d=n.data.get(a.dataId).values,p=n.data.get(i.dataId).values,g=n.data.get(s.dataId).values,m=new Float32Array(f),v=f;for(let y=0;y<v;y++){const b=y%h,x=y-b+Math.max(0,b-o),w=y-b+Math.min(h,b+o+1);let C=0;for(let $=x;$<w;$++)C+=Math.pow(p[$],2);C=u*C+l;for(let $=x;$<w;$++){let _=-2*u*c*p[$]*g[y]/C;y===$&&(_+=Math.pow(C,-c)),_*=d[y],m[$]+=_}}return n.makeTensorInfo(a.shape,i.dtype,m)}const kCt={kernelName:lz,backendName:"cpu",kernelFunc:SCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wMe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:s,keepDims:a}=r,o=n;let l=i.shape;const u=l.length,c=Ot(s,l);let f=c;const h=Fr(f,u);let d=o.data.get(i.dataId).values;if(h!=null){const x=new Array(u);for(let w=0;w<x.length;w++)x[w]=l[h[w]];d=Jne(d,l,i.dtype,h,x),f=Jr(f.length,u),l=x}Ge(i,"max"),vs("max",f,u);const[p,g]=Li(l,f),m=de(g),v=LIe(d,m,p,i.dtype),y=o.write(v,p,i.dtype);let b=p;return a&&(b=Zr(p,c)),{dataId:y,shape:b,dtype:i.dtype}}const ECt={kernelName:YN,backendName:"cpu",kernelFunc:wMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ACt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;Ge(i,"maxPool");const{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=r,u=1;B(ms(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const c=Gu(i.shape,s,a,u,o,l);let f;if(c.filterWidth===1&&c.filterHeight===1&&Qt(c.inShape,c.outShape))f=Oh({inputs:{x:i},backend:n});else{const h=n.data.get(i.dataId).values,d=Je(i.shape),p=nre(h,i.shape,i.dtype,d,c,"max");f=n.makeTensorInfo(c.outShape,i.dtype,p.values)}return f}const TCt={kernelName:XN,backendName:"cpu",kernelFunc:ACt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:a,pad:o,dimRoundingMode:l,dataFormat:u}=r;Ge(i,"maxPool3d");const c=ng(i.shape,s,a,1,o,l,u),f=n.data.get(i.dataId).values,h=vMe(f,i.shape,i.dtype,Je(i.shape),c,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const NCt={kernelName:KN,backendName:"cpu",kernelFunc:DCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ICt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,{filterSize:a,strides:o,pad:l,dimRoundingMode:u}=r;Ge([i,s],"maxPool3DGrad");const c=ng(s.shape,a,o,1,l,u),f=n.bufferSync(s),h=xwt(f,c),d=c.strideDepth,p=c.strideHeight,g=c.strideWidth,m=c.dilationDepth,v=c.dilationHeight,y=c.dilationWidth,b=c.effectiveFilterDepth,x=c.effectiveFilterHeight,w=c.effectiveFilterWidth,C=b-1-c.padInfo.front,$=w-1-c.padInfo.left,_=x-1-c.padInfo.top,k=Mt(s.shape,"float32"),E=n.bufferSync(i);for(let S=0;S<c.batchSize;++S)for(let N=0;N<c.inChannels;++N)for(let A=0;A<c.inDepth;++A)for(let D=0;D<c.inHeight;++D)for(let T=0;T<c.inWidth;++T){const I=A-C,F=D-_,R=T-$;let P=0;for(let V=0;V<b;V+=m){const z=(I+V)/d;if(!(z<0||z>=c.outDepth||Math.floor(z)!==z))for(let q=0;q<x;q+=v){const G=(F+q)/p;if(!(G<0||G>=c.outHeight||Math.floor(G)!==G))for(let K=0;K<w;K+=y){const Y=(R+K)/g;if(Y<0||Y>=c.outWidth||Math.floor(Y)!==Y)continue;const te=b*x*w-1-h.get(S,z,G,Y,N),Z=V*x*w+q*w+K,ae=te===Z?1:0;if(ae===0)continue;const O=E.get(S,z,G,Y,N);P+=O*ae}}}k.set(P,S,A,D,T,N)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const MCt={kernelName:cz,backendName:"cpu",kernelFunc:ICt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FCt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s,output:a}=t,o=s;Ge([s,a],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:f}=r,h=Gu(o.shape,l,u,1,c,f),d=n.data.get(o.dataId).values,p=Mt(h.outShape,o.dtype,mMe(d,o.shape,o.dtype,h).values),g=h.strideHeight,m=h.strideWidth,v=h.dilationHeight,y=h.dilationWidth,b=h.effectiveFilterHeight,x=h.effectiveFilterWidth,w=x-1-h.padInfo.left,C=b-1-h.padInfo.top,$=Mt(o.shape,"float32"),_=n.data.get(i.dataId).values,k=Mt(i.shape,"float32",_);for(let E=0;E<h.batchSize;++E)for(let S=0;S<h.inChannels;++S)for(let N=0;N<h.inHeight;++N)for(let A=0;A<h.inWidth;++A){const D=N-C,T=A-w;let I=0;for(let F=0;F<b;F+=v){const R=(D+F)/g;if(!(R<0||R>=h.outHeight||Math.floor(R)!==R))for(let P=0;P<x;P+=y){const V=(T+P)/m;if(V<0||V>=h.outWidth||Math.floor(V)!==V)continue;const z=b*x-1-p.get(E,R,V,S),q=F*x+P,G=z===q?1:0;if(G===0)continue;const K=k.get(E,R,V,S);I+=K*G}}$.set(I,E,N,A,S)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const OCt={kernelName:uz,backendName:"cpu",kernelFunc:FCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RCt(e,t,n,r,i){const s=Je(t),a=nre(e,t,n,s,i,"max"),o=mMe(e,t,n,i,!0,r);return[a.values,o.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PCt={kernelName:fz,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{filterSize:i,strides:s,pad:a,includeBatchInIndex:o}=t,l=n;Ge(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,c=Gu(r.shape,i,s,[1,1],a),[f,h]=RCt(u,r.shape,r.dtype,o,c),d=l.write(f,c.outShape,r.dtype),p=l.write(h,c.outShape,r.dtype);return[{dataId:d,shape:c.outShape,dtype:r.dtype},{dataId:p,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r,o=Ot(s,i.shape),u=Li(i.shape,o)[1],c=de(u),f=[],h=n.makeTensorInfo([],"float32",new Float32Array([c]));f.push(h);const d=Z0({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});f.push(d);const p=rre({inputs:{a:d,b:h},backend:n});f.push(p);const g=WI({inputs:{x:p},backend:n,attrs:{axis:s,keepDims:a}});return f.forEach(m=>n.disposeIntermediateTensorInfo(m)),g}const BCt={kernelName:ZN,backendName:"cpu",kernelFunc:LCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r;Ge(i,"min");const o=Ot(s,i.shape);let l=o;const u=Fr(l,i.shape.length);let c=i;u!=null&&(c=mo({inputs:{x:i},backend:n,attrs:{perm:u}}),l=Jr(l.length,i.shape.length)),vs("min",l,c.shape.length);const[f,h]=Li(c.shape,l),d=de(h),p=hs(de(f),c.dtype),g=n.data.get(c.dataId).values;for(let v=0;v<p.length;++v){const y=v*d;let b=g[y];for(let x=0;x<d;++x){const w=g[y+x];(Number.isNaN(w)||w<b)&&(b=w)}p[v]=b}u!=null&&n.disposeIntermediateTensorInfo(c);const m=n.makeTensorInfo(f,c.dtype,p);if(a){const v=Zr(f,o),y=nr({inputs:{x:m},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(m),y}return m}const UCt={kernelName:QN,backendName:"cpu",kernelFunc:zCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,mode:a}=r;Ge(i,"mirrorPad");const o=s.map((b,x)=>b[0]+i.shape[x]+b[1]),l=s.map(b=>b[0]),u=s.map((b,x)=>b[0]+i.shape[x]),c=a==="reflect"?0:1,f=n.data.get(i.dataId).values,h=i.shape.length,d=Je(i.shape),p=de(o),g=o.length,m=Je(o),v=Fi(i.dtype,p);for(let b=0;b<p;b++){let x=zb(b,g,m);for(let C=0;C<g;C++)x[C]<l[C]?x[C]=l[C]*2-x[C]-c:x[C]>=u[C]&&(x[C]=(u[C]-1)*2-x[C]+c);x=x.map((C,$)=>C-l[$]);const w=zc(x,h,d);v[b]=f[w]}return{dataId:n.write(v,o,i.dtype),shape:o,dtype:i.dtype}}const VCt={kernelName:JN,backendName:"cpu",kernelFunc:WCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jCt=ti((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),HCt=xi(i_,jCt),qCt={kernelName:i_,backendName:"cpu",kernelFunc:HCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Me(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:s}=r,a=i.shape.length;let o=s;if(o===-1&&(o=a-1),o!==a-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${a} and dim was ${o}`);const l=Ot([o],i.shape),u=wMe({inputs:{x:i},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=Zr(u.shape,l),f=nr({inputs:{x:u},backend:n,attrs:{shape:c}}),h=tre({inputs:{a:i,b:f},backend:n}),d=kIe({inputs:{x:h},backend:n}),p=WI({inputs:{x:d},backend:n,attrs:{axis:l,keepDims:!1}}),g=nr({inputs:{x:p},backend:n,attrs:{shape:c}}),m=rre({inputs:{a:d,b:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const GCt={kernelName:vI,backendName:"cpu",kernelFunc:$Me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YCt(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:s,seed:a,normalized:o}=r;Ge(i,"multinomial");const l=o?i:$Me({inputs:{logits:i},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],f=n.data.get(l.dataId).values,h=[u,s],d=hs(de(h),"int32");for(let p=0;p<u;++p){const g=p*c,m=new Float32Array(c-1);m[0]=f[g];for(let b=1;b<m.length;++b)m[b]=m[b-1]+f[g+b];const v=e7.alea(a.toString()),y=p*s;for(let b=0;b<s;++b){const x=v();d[y+b]=m.length;for(let w=0;w<m.length;w++)if(x<m[w]){d[y+b]=w;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",d)}const XCt={kernelName:hz,backendName:"cpu",kernelFunc:YCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KCt=h7;function ZCt(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=r;Ge(i,"NonMaxSuppression");const u=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,{selectedIndices:f}=KCt(u,c,a,o,l);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const QCt={kernelName:dz,backendName:"cpu",kernelFunc:ZCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JCt=d7;function e_t(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r;Ge(i,"NonMaxSuppressionPadded");const c=n.data.get(i.dataId).values,f=n.data.get(s.dataId).values,{selectedIndices:h,validOutputs:d}=JCt(c,f,a,o,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([d]))]}const t_t={kernelName:pz,backendName:"cpu",kernelFunc:e_t};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n_t=p7;function r_t(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r;Ge(i,"NonMaxSuppressionWithScore");const c=n.data.get(i.dataId).values,f=n.data.get(s.dataId).values,h=a,d=o,p=l,g=u,{selectedIndices:m,selectedScores:v}=n_t(c,f,h,d,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}const i_t={kernelName:gz,backendName:"cpu",kernelFunc:r_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s_t(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:s,depth:a,onValue:o,offValue:l}=r;Ge(i,"oneHot");const u=de(i.shape),c=new Float32Array(u*a);c.fill(l);const f=n.data.get(i.dataId).values;for(let h=0;h<u;++h)f[h]>=0&&f[h]<a&&(c[h*a+f[h]]=o);return n.makeTensorInfo([...i.shape,a],s,c)}const a_t={kernelName:rI,backendName:"cpu",kernelFunc:s_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H5(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const i=zy({inputs:{input:r},backend:n}),s=H5({inputs:{x:i},backend:n}),a=zw({inputs:{input:r},backend:n}),o=H5({inputs:{x:a},backend:n}),l=Wo({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),l}else return ire({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const o_t={kernelName:wI,backendName:"cpu",kernelFunc:H5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CMe(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const i=zy({inputs:{input:r},backend:n}),s=CMe({inputs:{x:i},backend:n}),a=zw({inputs:{input:r},backend:n}),o=H5({inputs:{x:a},backend:n}),l=Wo({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),l}else return ire({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const l_t={kernelName:nI,backendName:"cpu",kernelFunc:CMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Me(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return j5({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const s=t[0].shape,a=t[0].dtype;t.forEach(c=>{gs(s,c.shape,"All tensors passed to stack must have matching shapes"),B(a===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=t.map(c=>{const f=j5({inputs:{input:c},backend:n,attrs:{dim:i}});return o.push(f),f}),u=Uw({inputs:l,backend:n,attrs:{axis:i}});return o.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const u_t={kernelName:iI,backendName:"cpu",kernelFunc:_Me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c_t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,constantValue:a}=r;Ge(i,"pad");const o=s.map((y,b)=>y[0]+i.shape[b]+y[1]),l=s.map(y=>y[0]),u=n.data.get(i.dataId).values,c=de(i.shape),f=i.shape.length,h=Je(i.shape),d=de(o),p=o.length,g=Je(o),m=Fi(i.dtype,d);a!==0&&m.fill(a);for(let y=0;y<c;y++){const x=zb(y,f,h).map((C,$)=>C+l[$]),w=zc(x,p,g);m[w]=u[y]}return{dataId:n.write(m,o,i.dtype),shape:o,dtype:i.dtype}}const SMe={kernelName:sI,backendName:"cpu",kernelFunc:c_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f_t=ti((e,t)=>Math.pow(e,t)),h_t=xi(a_,f_t),d_t={kernelName:a_,backendName:"cpu",kernelFunc:h_t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p_t(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:s,indices:a}=t,o=i.map(m=>n.data.get(m.dataId).values),l=i.map(m=>m.shape),u=n.data.get(s.dataId).values,c=n.data.get(a.dataId).values,[f,h,d]=jIe(o,l,u,s.shape,s.dtype,c,a.shape),p=f.map(m=>n.makeTensorInfo([m.length],"int32",m)),g=n.makeTensorInfo(d,s.dtype,h);return p.concat([g])}const g_t={kernelName:mz,backendName:"cpu",kernelFunc:p_t};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m_t(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:s}=t,a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,[u,c]=HIe(a,r.shape,r.dtype,o,i.shape,l,s.shape),f=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([c.length],r.dtype,c);return[f,h]}const v_t={kernelName:vz,backendName:"cpu",kernelFunc:m_t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y_t(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:s,defaultValue:a,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,u=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,f=n.data.get(a.dataId).values,h=o.map(m=>n.data.get(m.dataId).values),d=o.map(m=>m.shape),[p,g]=qIe(u,i.shape,c,s.shape,s.dtype,f,a.shape,h,d,l);return n.makeTensorInfo(p,s.dtype,g)}const b_t={kernelName:yz,backendName:"cpu",kernelFunc:y_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x_t(e){const{backend:t,attrs:n}=e,{start:r,stop:i,dtype:s,step:a}=n,o=GIe(r,i,a,s);return t.makeTensorInfo([o.length],s,o)}const w_t={kernelName:bz,backendName:"cpu",kernelFunc:x_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $_t=Bn(o_,e=>1/e),C_t={kernelName:o_,backendName:"cpu",kernelFunc:$_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function __t(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:a,size:o}=r;Ge(i,"resizeBilinear");const l=Je(i.shape),[u,c]=o,[f,h,d,p]=i.shape,g=n.data.get(i.dataId).values,m=new Float32Array(de([f,u,c,p])),v=[s&&u>1?h-1:h,s&&c>1?d-1:d],y=[s&&u>1?u-1:u,s&&c>1?c-1:c];let b=0;const x=v[0]/y[0],w=v[1]/y[1];for(let C=0;C<f;C++)for(let $=0;$<u;$++){let _;a?_=x*($+.5)-.5:_=x*$;const k=Math.max(0,Math.floor(_)),E=_-k,S=Math.min(h-1,Math.ceil(_)),N=C*l[0]+k*l[1],A=C*l[0]+S*l[1];for(let D=0;D<c;D++){let T;a?T=w*(D+.5)-.5:T=w*D;const I=Math.max(0,Math.floor(T)),F=T-I,R=Math.min(d-1,Math.ceil(T)),P=N+I*l[2],V=A+I*l[2],z=N+R*l[2],q=A+R*l[2];for(let G=0;G<p;G++){const K=g[P+G],Y=g[V+G],te=g[z+G],Z=g[q+G],ae=K+(te-K)*F,O=Y+(Z-Y)*F,L=ae+(O-ae)*E;m[b++]=L}}}return n.makeTensorInfo([f,u,c,p],"float32",m)}const S_t={kernelName:cI,backendName:"cpu",kernelFunc:__t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k_t(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:a}=r;Ge([s,i],"resizeBilinearGrad");const o=Je(i.shape),[l,u,c,f]=i.shape,[,h,d]=s.shape,p=new Float32Array(l*u*c*f),g=[a&&h>1?u-1:u,a&&d>1?c-1:c],m=[a&&h>1?h-1:h,a&&d>1?d-1:d],v=g[0]/m[0],y=g[1]/m[1],b=n.data.get(s.dataId).values;let x=0;for(let w=0;w<l;w++){const C=w*o[0];for(let $=0;$<h;$++){const _=$*v,k=Math.floor(_),E=Math.min(Math.ceil(_),u-1),S=C+k*o[1],N=C+E*o[1],A=_-k,D=1-A;for(let T=0;T<d;T++){const I=T*y,F=Math.floor(I),R=Math.min(Math.ceil(I),c-1),P=I-F,V=1-P,z=S+F*o[2],q=S+R*o[2],G=N+F*o[2],K=N+R*o[2],Y=D*V,te=D*P,Z=A*V,ae=A*P;for(let O=0;O<f;O++){const L=b[x++];p[z+O]+=L*Y,p[q+O]+=L*te,p[G+O]+=L*Z,p[K+O]+=L*ae}}}}return n.makeTensorInfo([l,c,u,f],"float32",p)}const E_t={kernelName:$z,backendName:"cpu",kernelFunc:k_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A_t(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:a,size:o}=r;Ge(i,"resizeNearestNeighbor");const l=Je(i.shape),[u,c]=o,[f,h,d,p]=i.shape,g=n.data.get(i.dataId).values,m=new Float32Array(f*u*c*p),v=[s&&u>1?h-1:h,s&&c>1?d-1:d],y=[s&&u>1?u-1:u,s&&c>1?c-1:c],b=v[0]/y[0],x=v[1]/y[1];let w=0;for(let C=0;C<f;C++){const $=C*l[0];for(let _=0;_<u;_++){const k=a?b*(_+.5):b*_;let E=Math.min(h-1,s?Math.round(k):Math.floor(k));a&&(E=Math.max(0,E));const S=$+E*l[1];for(let N=0;N<c;N++){const A=a?x*(N+.5):x*N;let D=Math.min(d-1,s?Math.round(A):Math.floor(A));a&&(D=Math.max(0,D));const T=S+D*l[2];for(let I=0;I<p;I++){const F=g[T+I];m[w++]=F}}}}return n.makeTensorInfo([f,u,c,p],i.dtype,m)}const T_t={kernelName:uI,backendName:"cpu",kernelFunc:A_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D_t(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:a}=r;Ge([s,i],"resizeNearestNeighborGrad");const o=Je(i.shape),l=Je(s.shape),[u,c,f,h]=i.shape,[,d,p]=s.shape,g=new Float32Array(u*c*f*h),m=n.data.get(s.dataId).values,v=[a&&d>1?c-1:c,a&&p>1?f-1:f],y=[a&&d>1?d-1:d,a&&p>1?p-1:p],b=v[0]/y[0],x=v[1]/y[1],w=1/b,C=1/x,$=Math.ceil(w)*2+2,_=Math.ceil(C)*2+2;for(let k=0;k<u;k++){const E=k*o[0];for(let S=0;S<c;S++){const N=E+S*o[1],A=Math.floor(S*w),D=Math.floor(A-$/2);for(let T=0;T<f;T++){const I=N+T*o[2],F=Math.floor(T*C),R=Math.floor(F-_/2);for(let P=0;P<h;P++){let V=0;for(let z=0;z<$;z++){const q=z+D;if(q<0||q>=d)continue;const G=E+q*l[1],K=q*b,Y=Math.min(c-1,a?Math.round(K):Math.floor(K));if(S===Y)for(let te=0;te<_;te++){const Z=te+R;if(Z<0||Z>=p)continue;const ae=G+Z*l[2],O=Z*x,L=Math.min(f-1,a?Math.round(O):Math.floor(O));T===L&&(V+=m[ae+P])}}g[I+P]=V}}}}return n.makeTensorInfo(i.shape,i.dtype,g)}const N_t={kernelName:wz,backendName:"cpu",kernelFunc:D_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I_t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:s}=r;Ge(i,"reverse");const a=i.shape.length,o=Ot(s,i.shape);if(a===0)return Oh({inputs:{x:i},backend:n});const l=new oi(i.shape,i.dtype),u=n.bufferSync(i);for(let c=0;c<l.size;c++){const f=l.indexToLoc(c),h=f.slice();o.forEach(d=>h[d]=i.shape[d]-1-h[d]),l.set(u.get(...h),...f)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const M_t={kernelName:fI,backendName:"cpu",kernelFunc:I_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F_t={kernelName:Bz,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,{radians:i,fillValue:s,center:a}=t,o=n,l=Fi(r.dtype,de(r.shape)),[u,c,f,h]=r.shape,[d,p]=une(a,c,f),g=255,m=Math.sin(i),v=Math.cos(i),y=o.data.get(r.dataId).values;for(let x=0;x<u;x++){const w=x*f*c*h;for(let C=0;C<c;C++){const $=C*(f*h);for(let _=0;_<f;_++){const k=_*h;for(let E=0;E<h;E++){const S=[u,C,_,E],N=S[2],A=S[1];let D=(N-d)*v-(A-p)*m,T=(N-d)*m+(A-p)*v;D=Math.round(D+d),T=Math.round(T+p);let I=s;if(typeof s!="number"&&(E===3?I=g:I=s[E]),D>=0&&D<f&&T>=0&&T<c){const R=T*(f*h),P=D*h,V=w+R+P+E;I=y[V]}const F=w+$+k+E;l[F]=I}}}}return{dataId:o.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O_t=Bn(c_,e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),R_t={kernelName:c_,backendName:"cpu",kernelFunc:O_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_t(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:s}=t,{shape:a}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=Gm(s,i,a),h=!0,d=n.bufferSync(i),p=n.bufferSync(s),g=A1(d,p,a,f,u,l,o,c,0,h);return n.makeTensorInfo(a,g.dtype,g.values)}const L_t={kernelName:Cz,backendName:"cpu",kernelFunc:P_t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B_t(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<t?n=i+1:r=i;return r}function z_t(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<=t?n=i+1:r=i;return r}function U_t(e,t,n,r,i,s){const a=Br("int32",n*i);for(let o=0;o<n;++o){const l=e.slice(o*r,(o+1)*r),u=o*i;for(let c=0;c<i;++c)a[u+c]=s==="left"?B_t(l,t[c+u]):z_t(l,t[c+u])}return a}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W_t(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:s}=t,{side:a}=r,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,u=U_t(o,l,i.shape[0],i.shape[1],s.shape[1],a);return n.makeTensorInfo(s.shape,"int32",u)}const V_t={kernelName:Sz,backendName:"cpu",kernelFunc:W_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j_t(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:s}=t;Ge([r,i,s],"select");const a=r.shape.length,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,c=po(i.dtype,s.dtype),f=hs(de(i.shape),c);let h=0;const d=a===0||a>1||i.shape.length===1?1:de(i.shape.slice(1));for(let p=0;p<o.length;p++)for(let g=0;g<d;g++)o[p]===1?f[h++]=l[p]:f[h++]=u[p];return n.makeTensorInfo(i.shape,c,f)}const H_t={kernelName:hI,backendName:"cpu",kernelFunc:j_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q_t=b7,G_t=x7,Y_t=Bn(h_,e=>e>=0?G_t*e:q_t*(Math.exp(e)-1)),X_t={kernelName:h_,backendName:"cpu",kernelFunc:Y_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K_t=Bn(g_,e=>e<0?-1:e>0?1:0),Z_t={kernelName:g_,backendName:"cpu",kernelFunc:K_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q_t=Bn(d_,e=>Math.sin(e)),J_t={kernelName:d_,backendName:"cpu",kernelFunc:Q_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eSt=Bn(p_,e=>Math.sinh(e)),tSt={kernelName:p_,backendName:"cpu",kernelFunc:eSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nSt=11920928955078125e-23,l0e=Math.log(nSt)+2,rSt=Bn(v_,e=>{const t=e>-l0e,n=e<l0e,r=Math.exp(e);let i;return n?i=r:t?i=e:i=Math.log(1+r),i}),iSt={kernelName:v_,backendName:"cpu",kernelFunc:rSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,paddings:a}=r;Ge([i],"spaceToBatchND");const o=de(s),l=[[0,0]];l.push(...a);for(let C=1+s.length;C<i.shape.length;++C)l.push([0,0]);const u=SMe.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),c=NI(u.shape,s,o,!1),f=II(c.length,s.length,!1),h=MI(u.shape,s,o,!1),g=nr({inputs:{x:u},backend:n,attrs:{shape:c}}),y=mo({inputs:{x:g},backend:n,attrs:{perm:f}}),w=nr({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),w}const aSt={kernelName:gI,backendName:"cpu",kernelFunc:sSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oSt(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:s,defaultValue:a}=t;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${i.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,c=n.data.get(a.dataId).values[0],[f,h,d,p,g]=ZIe(o,r.shape,r.dtype,l,i.dtype,u,c);return[n.makeTensorInfo(h,r.dtype,f),n.makeTensorInfo([h[0]],i.dtype,d),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const lSt={kernelName:kz,backendName:"cpu",kernelFunc:oSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uSt(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:s}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const a=Array.from(n.data.get(i.dataId).values),o=n.data.get(r.dataId).values,l=Array.from(n.data.get(s.dataId).values),[u,c,f]=QIe(o,r.shape,r.dtype,a,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([f.length],s.dtype,new Int32Array(f))]}const cSt={kernelName:Ez,backendName:"cpu",kernelFunc:uSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fSt(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,[u,c]=ere(a,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const hSt={kernelName:Az,backendName:"cpu",kernelFunc:fSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dSt(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,[u,c]=ere(a,r.shape,r.dtype,o,l);return n.makeTensorInfo(c,r.dtype,u)}const pSt={kernelName:Tz,backendName:"cpu",kernelFunc:dSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gSt(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:s,defaultValue:a}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:f,outputSize:h}=Gm(s,i,o),d=!1,p=n.bufferSync(i);let g;switch(s.dtype){case"bool":{const m=n.bufferSync(s),v=Boolean(n.data.get(a.dataId).values[0]);g=A1(p,m,o,h,c,u,l,f,v,d);break}case"float32":{const m=n.bufferSync(s),v=n.data.get(a.dataId).values[0];g=A1(p,m,o,h,c,u,l,f,v,d);break}case"int32":{const m=n.bufferSync(s),v=n.data.get(a.dataId).values[0];g=A1(p,m,o,h,c,u,l,f,v,d);break}case"string":{const m=n.bufferSync(s),v=Ip(n.data.get(a.dataId).values[0]);g=A1(p,m,o,h,c,u,l,f,v,d);break}default:throw new Error(`Unsupported type ${s.dtype}`)}return n.makeTensorInfo(o,g.dtype,g.values)}const mSt={kernelName:Dz,backendName:"cpu",kernelFunc:gSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:s,axis:a}=r,o=Ot(a,i.shape)[0],l=_ne(i,s,o),u=new Array(i.shape.length).fill(0),c=i.shape.slice();return l.map(f=>{const h=[...c];h[o]=f;const d=Uy({inputs:{x:i},backend:n,attrs:{begin:u,size:h}});return u[o]+=f,d})}const ySt={kernelName:mI,backendName:"cpu",kernelFunc:vSt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bSt={kernelName:Nz,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{const{x:n}=e,r=t;Ge(n,"square");const i=r.data.get(n.dataId).values,s=new Float32Array(i.length);for(let o=0;o<i.length;++o){const l=i[o];s[o]=l*l}return{dataId:r.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xSt=Bn(__,(e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),wSt={kernelName:__,backendName:"cpu",kernelFunc:xSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $St(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,end:a,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:h}=r;Ge(i,"stridedSlice");const{finalShapeSparse:d,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:v,begin:y,end:b,strides:x}=sne(i.shape,s,a,o,l,u,c,f,h);let w;if(g)w=nr({inputs:{x:i},backend:n,attrs:{shape:p}});else if(m||v){B(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const C=nne(y,b,x),$=Uy({inputs:{x:i},backend:n,attrs:{begin:y,size:C}});w=nr({inputs:{x:$},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo($)}else{const C=n.bufferSync(i),$=tMe(d,C,x,y);w=n.makeTensorInfo(p,$.dtype,$.values)}return w}const CSt={kernelName:Iz,backendName:"cpu",kernelFunc:$St};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _St(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:s,leftPad:a,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:f}=t,h=n.data.get(c.dataId).values,d=n.data.get(f.dataId).values,[p,g]=nMe(h,d,i,s,a,o,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(f.shape,"int32",g)]}const SSt={kernelName:Mz,backendName:"cpu",kernelFunc:_St};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kSt(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:s,delimiter:a}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values[0],[u,c,f]=rMe(o,l,i),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const ESt={kernelName:Fz,backendName:"cpu",kernelFunc:kSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ASt(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:s}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const a=n.data.get(s.dataId).values,o=iMe(a,i);return n.makeTensorInfo(s.shape,"int32",o)}const TSt={kernelName:Oz,backendName:"cpu",kernelFunc:ASt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DSt=Bn(w_,e=>Math.tan(e)),NSt={kernelName:w_,backendName:"cpu",kernelFunc:DSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ISt=Bn($_,e=>Math.tanh(e)),MSt={kernelName:$_,backendName:"cpu",kernelFunc:ISt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FSt(e){const{inputs:t,backend:n}=e,{tensor:r,indices:i,updates:s}=t,{sliceRank:a,numUpdates:o,sliceSize:l,strides:u,outputSize:c}=Gm(s,i,r.shape),f=!1,h=n.bufferSync(i),d=n.bufferSync(s),p=n.bufferSync(r),g=A1(h,d,r.shape,c,l,o,a,u,p,f);return n.makeTensorInfo(r.shape,g.dtype,g.values)}const OSt={kernelName:_z,backendName:"cpu",kernelFunc:FSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:s}=r;Ge(i,"tile");const a=aMe(n.bufferSync(i),s);return n.makeTensorInfo(a.shape,a.dtype,a.values)}const PSt={kernelName:C_,backendName:"cpu",kernelFunc:RSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:s,sorted:a}=r;Ge(i,"topk");const o=n.data.get(i.dataId).values,[l,u]=lMe(o,i.shape,i.dtype,s,a);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const BSt={kernelName:Rz,backendName:"cpu",kernelFunc:LSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zSt(e){const{inputs:t,attrs:n,backend:r}=e,{image:i,transforms:s}=t,{interpolation:a,fillMode:o,fillValue:l,outputShape:u}=n,[c,f,h,d]=i.shape,[p,g]=u!=null?u:[f,h],m=[c,p,g,d],v=Je(i.shape),y=v[0],b=v[1],x=v[2],w=Je(m),C=w[0],$=w[1],_=w[2],k=Fi(i.dtype,de(m));k.fill(l);const E=r.data.get(i.dataId).values,S=r.data.get(s.dataId).values;for(let A=0;A<c;++A){const D=s.shape[0]===1?S:S.subarray(A*8,A*8+8);for(let T=0;T<p;++T)for(let I=0;I<g;++I)for(let F=0;F<d;++F){let R;const P=D[6]*I+D[7]*T+1;if(P===0)continue;const V=(D[0]*I+D[1]*T+D[2])/P,z=(D[3]*I+D[4]*T+D[5])/P,q=u0e(V,h,o),G=u0e(z,f,o);switch(a){case"nearest":R=qSt(E,f,h,y,b,x,A,G,q,F,l);break;case"bilinear":R=GSt(E,f,h,y,b,x,A,G,q,F,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${a}`)}const K=A*C+T*$+I*_+F;k[K]=R}return r.makeTensorInfo(m,i.dtype,k)}return{dataId:r.write(k,m,i.dtype),shape:i.shape,dtype:i.dtype}}const USt={kernelName:Pz,backendName:"cpu",kernelFunc:zSt};function u0e(e,t,n){switch(n){case"reflect":return WSt(e,t);case"wrap":return VSt(e,t);case"nearest":return HSt(e,t);case"constant":default:return jSt(e)}}function WSt(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{const r=2*t;n-=r*Math.trunc(n/r),n>=t&&(n=r-n-1)}return z0(0,n,t-1)}function VSt(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{const r=t-1;n-=t*Math.trunc(n/r)}return z0(0,n,t-1)}function jSt(e,t){return e}function HSt(e,t){return z0(0,e,t-1)}function lE(e,t,n,r,i,s,a,o,l,u,c){const f=a*r+o*i+l*s+u;return 0<=o&&o<t&&0<=l&&l<n?e[f]:c}function qSt(e,t,n,r,i,s,a,o,l,u,c){const f=Math.round(o),h=Math.round(l);return lE(e,t,n,r,i,s,a,f,h,u,c)}function GSt(e,t,n,r,i,s,a,o,l,u,c){const f=Math.floor(o),h=Math.floor(l),d=f+1,p=h+1,g=(p-l)*lE(e,t,n,r,i,s,a,f,h,u,c)+(l-h)*lE(e,t,n,r,i,s,a,f,p,u,c),m=(p-l)*lE(e,t,n,r,i,s,a,d,h,u,c)+(l-h)*lE(e,t,n,r,i,s,a,d,p,u,c);return(d-o)*g+(o-f)*m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YSt(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:s}=t;Ge(s,"unique");const a=r.data.get(s.dataId).values,{outputValues:o,outputShape:l,indices:u}=uMe(a,i,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}const XSt={kernelName:Lz,backendName:"cpu",kernelFunc:YSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KSt(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const a=i.shape.length,o=i.shape[s],l=new Array(a-1);let u=0;for(let d=0;d<a;d++)d!==s&&(l[u++]=i.shape[d]);const c=new Array(a).fill(0),f=i.shape.slice();f[s]=1;const h=new Array(o);for(let d=0;d<h.length;d++){c[s]=d;const p=Uy({inputs:{x:i},backend:n,attrs:{begin:c,size:f}});h[d]=nr({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const ZSt={kernelName:bI,backendName:"cpu",kernelFunc:KSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:s}=t,{numSegments:a}=r;Ge(i,"unsortedSegmentSum");const o=i.shape.length,l=s.shape.length,u=[],c=[],f=o-l;let h=s;for(let p=0;p<f;++p){const g=j5({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=g,c.push(g)}for(let p=0;p<a;++p){const g=tg(p,"int32"),m=n.makeTensorInfo([],"int32",g),v=_Ie({inputs:{a:m,b:h},backend:n}),y=Z0({inputs:{x:v},backend:n,attrs:{dtype:"float32"}}),b=I7({inputs:{a:y,b:i},backend:n}),x=WI({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});u.push(x),c.push(m),c.push(v),c.push(y),c.push(b),c.push(x)}const d=_Me({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(p=>n.disposeIntermediateTensorInfo(p)),d}const JSt={kernelName:xI,backendName:"cpu",kernelFunc:QSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ekt=[Y2t,Axt,K2t,Q2t,Fxt,ewt,nwt,iwt,awt,lwt,cwt,hwt,pwt,vwt,bwt,$wt,_wt,kwt,Awt,q2t,Dwt,Iwt,Fwt,Rxt,Rwt,Ixt,Lxt,Lwt,Txt,zwt,Wwt,Vwt,Hwt,Gwt,Xwt,Zwt,Jwt,t$t,r$t,s$t,o$t,u$t,f$t,d$t,p$t,m$t,y$t,x$t,w$t,$$t,C$t,S$t,A$t,B2t,D$t,Bxt,L$t,zxt,B$t,Wxt,H$t,q$t,Y$t,jxt,qxt,K$t,Q$t,eCt,nCt,Yxt,Kxt,Dxt,iCt,Uwt,aCt,lCt,cCt,z2t,Qxt,e2t,hCt,n2t,pCt,vCt,bCt,$Ct,_Ct,kCt,ECt,i2t,TCt,NCt,MCt,OCt,PCt,BCt,UCt,a2t,VCt,qCt,XCt,l2t,c2t,QCt,t_t,i_t,h2t,a_t,l_t,u_t,SMe,d_t,W2t,g2t,g_t,v_t,b_t,w_t,Nxt,rX,C_t,V2t,j2t,H2t,S_t,E_t,T_t,N_t,M_t,F_t,R_t,C2t,L_t,V_t,H_t,X_t,S2t,Z_t,J_t,tSt,k2t,GCt,iSt,aSt,lSt,cSt,hSt,pSt,mSt,ySt,T2t,bSt,N2t,M2t,wSt,CSt,SSt,ESt,TSt,P2t,k$t,NSt,MSt,OSt,PSt,BSt,USt,d2t,XSt,ZSt,JSt,o_t];for(const e of ekt)zz(e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s1={},uO={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function tkt(e,t){s1[e]=t}function Jc(e,t){if(!(e in s1)||t!=null){const r=rkt(e,t);if(r!==null)s1[e]=r;else return console.log("Could not get context for WebGL version",e),null}const n=s1[e];return n==null||n.isContextLost()?(delete s1[e],Jc(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),s1[e])}function nkt(e){if(!le().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function rkt(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=t==null?nkt(e):t;return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete s1[e]},!1),le().getBool("SOFTWARE_WEBGL_ENABLED")&&(uO.failIfMajorPerformanceCaveat=!1),e===1?n.getContext("webgl",uO)||n.getContext("experimental-webgl",uO):n.getContext("webgl2",uO)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var NT;(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(NT||(NT={}));var Nl;(function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"})(Nl||(Nl={}));var Qi;(function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Qi||(Qi={}));function VI(e,t){return[t,e]}function ikt(e,t){return e*t}function cO(e){const t=de(e),n=Math.ceil(t/4);return x5(n)}function D_(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function skt(e,t){const[n,r]=D_(e,t);return n*r*4}function sre(e,t){const n=e;let r,i,s,a,o,l,u,c,f,h;return le().getNumber("WEBGL_VERSION")===2?(r=n.R32F,i=n.R16F,s=n.RGBA16F,a=n.RGBA32F,o=n.RED,u=4,c=1,f=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(r=e.RGBA,i=e.RGBA,s=e.RGBA,a=n.RGBA,o=e.RGBA,u=4,c=4,f=t!=null?t.HALF_FLOAT_OES:null,h=e.FLOAT,l=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Be(e,t){const n=t();return le().getBool("DEBUG")&&akt(e),n}function akt(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+ckt(e,t))}const okt=596e-10,lkt=65504;function ukt(e){return!!(le().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||okt<Math.abs(e)&&Math.abs(e)<lkt)}function ckt(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function fO(e,t){return og(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function fkt(e,t){const n=og(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Be(e,()=>e.shaderSource(n,t)),Be(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function hkt(e,t){const n=og(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Be(e,()=>e.shaderSource(n,t)),Be(e,()=>e.compileShader(n)),le().get("ENGINE_COMPILE_ONLY"))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw kMe(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const dkt=/ERROR: [0-9]+:([0-9]+):/g;function kMe(e,t){const n=dkt.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}const r=+n[1],i=e.split(`
`),s=i.length.toString().length+2,a=i.map((f,h)=>X1((h+1).toString(),s)+f);let o=0;for(let f=0;f<a.length;f++)o=Math.max(a[f].length,o);const l=a.slice(0,r-1),u=a.slice(r-1,r),c=a.slice(r);console.log(l.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${X1(u[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function pkt(e){return og(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function gkt(e,t){if(Be(e,()=>e.linkProgram(t)),!le().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function xj(e,t){if(Be(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function mkt(e,t){const n=og(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Be(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),Be(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function vkt(e,t){const n=og(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Be(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),Be(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function ykt(e){return og(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function bkt(e,t){const n=le().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){const r=`[${e}x${t}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){const r=`[${e}x${t}]`,i=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}function xkt(e){return og(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function c0e(e,t,n,r,i,s,a){const o=e.getAttribLocation(t,n);return o===-1?!1:(Be(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),Be(e,()=>e.vertexAttribPointer(o,i,e.FLOAT,!1,s,a)),Be(e,()=>e.enableVertexAttribArray(o)),!0)}function wkt(e,t,n){kkt(e,n),Be(e,()=>e.activeTexture(e.TEXTURE0+n)),Be(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function $kt(e,t,n){return og(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function Ckt(e,t,n){return e.getUniformLocation(t,n)}function _kt(e,t,n,r){Be(e,()=>wkt(e,t,r)),Be(e,()=>e.uniform1i(n,r))}function wj(e,t,n){Be(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),Be(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function f0e(e,t){Be(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),Be(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function hO(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Skt(e,t))}function Skt(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function og(e,t,n){const r=Be(e,()=>t());if(r==null)throw new Error(n);return r}function kkt(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){const i=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${i}.`)}}function Ww(e,t=2){return de(e.slice(0,e.length-t))}function Vw(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function dO(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[Ww(e),...Vw(e)]),t}function Ekt(e,t=!1){let n=le().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=le().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&le().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n=n*2,r=r*2,e=e.map((o,l)=>l>=e.length-2?IB(e[l]):e[l]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=eg(e).newShape);let i=de(e),s=null;e.length<=1&&i<=n?s=[1,i]:e.length===2&&e[0]<=n&&e[1]<=n?s=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?s=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?s=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?s=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(s=[e[0],e[1]*e[2]*e[3]]);const a=s!=null&&Math.max(...s)>r&&Math.min(...s)<=(t?2:1)&&Math.min(...s)>0;if(s==null||a)if(t){const o=Ww(e);let l=2,u=2;e.length&&([l,u]=Vw(e)),i=o*(l/2)*(u/2),s=x5(i).map(c=>c*2)}else s=x5(i);return s}function pO(e){return e%2===0}function q5(e,t){if(e=e.slice(-2),t=t.slice(-2),Qt(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){const n=e[e.length-1],r=t[t.length-1];if(n===r||pO(n)&&pO(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&pO(e[0])&&pO(t[0])}let $j,Cj;function Akt(e){if($j==null){const t=Jc(e);$j=t.getParameter(t.MAX_TEXTURE_SIZE)}return $j}function Tkt(e){if(Cj==null){const t=Jc(e);Cj=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Cj)}function Dkt(e){if(e===0)return 0;let t;const n=Jc(e);return yu(n,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:yu(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function yu(e,t){return e.getExtension(t)!=null}function h0e(e){try{if(Jc(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function Nkt(e){if(e===0)return!1;const t=Jc(e);if(e===1){if(!yu(t,"OES_texture_float"))return!1}else if(!yu(t,"EXT_color_buffer_float"))return!1;return sX(t)}function Ikt(e){if(e===0)return!1;const t=Jc(e);if(e===1){if(!yu(t,"OES_texture_float")||!yu(t,"WEBGL_color_buffer_float"))return!1}else{if(yu(t,"EXT_color_buffer_float"))return sX(t);const r="EXT_color_buffer_half_float";if(yu(t,r)){const i=t.getExtension(r);return Mkt(t,i)}return!1}return sX(t)}function sX(e){const t=sre(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);const r=1,i=1;e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,r,i,0,t.textureFormatFloat,t.textureTypeFloat,null);const s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(s),a}function Mkt(e,t){const n=sre(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const i=1,s=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,i,s,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(a),o}function Fkt(e){return e!==2?!1:Jc(e).fenceSync!=null}function jI(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&B(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ze=le();Ze.registerFlag("HAS_WEBGL",()=>Ze.getNumber("WEBGL_VERSION")>0);Ze.registerFlag("WEBGL_VERSION",()=>h0e(2)?2:h0e(1)?1:0);Ze.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ze.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ze.get("WEBGL_VERSION")===2);Ze.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ze.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ze.registerFlag("WEBGL_PACK",()=>Ze.getBool("HAS_WEBGL"));Ze.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_CLIP",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_REDUCE",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_CONV_IM2COL",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Akt(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Tkt(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const e=Ze.getNumber("WEBGL_VERSION");return e===0?0:Dkt(e)});Ze.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ze.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!lte());Ze.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Nkt(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ze.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ze.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ze.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Ikt(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Fkt(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ze.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ze.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(e<0&&e!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)});Ze.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>lte()?1:-1,e=>{if(e<0&&e!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)});Ze.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ze.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ze.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ze.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ze.registerFlag("WEBGL_EXP_CONV",()=>!1);Ze.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ze.getBool("IS_TEST"));Ze.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ze.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ze.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ze.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ba(){let e,t,n,r,i,s,a,o,l,u;return le().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",s="outputColor",a="out vec4 outputColor;",o=le().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",s="gl_FragColor",a="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:s,defineOutput:a,defineSpecialNaN:o,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kb(e,t,n="index"){const r=Je(t);return r.map((i,s)=>{const a=`int ${e[s]} = ${n} / ${i}`,o=s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * ${i}`:`index -= ${e[s]} * ${i}`;return`${a}; ${o};`}).join("")}function M7(e,t,n="index"){const r=Je(t);return r.map((i,s)=>{const a=`int ${e[s]} = ${n} / outShapeStrides[${s}]`,o=s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * outShapeStrides[${s}]`:`index -= ${e[s]} * outShapeStrides[${s}]`;return`${a}; ${o};`}).join("")}function Okt(e,t){const n=e.length,r=e.map(s=>`${t}[${s}]`),i=new Array(n-1);i[n-2]=r[n-1];for(let s=n-3;s>=0;--s)i[s]=`(${i[s+1]} * ${r[s+1]})`;return i}function Rkt(e,t,n="index"){const r=e.map((s,a)=>a),i=Okt(r,t);return i.map((s,a)=>{const o=`int ${e[a]} = ${n} / ${i[a]}`,l=a===i.length-1?`int ${e[a+1]} = ${n} - ${e[a]} * ${i[a]}`:`index -= ${e[a]} * ${i[a]}`;return`${o}; ${l};`}).join("")}function are(e){const t=Je(e).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function ore(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const EMe=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:AMe}=J3e;function Pkt(e,t,n){const r=[];if(e.forEach(d=>{const p=de(d.shapeInfo.logicalShape);if(d.shapeInfo.isUniform?r.push(`uniform float ${d.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${d.name};`),r.push(`uniform int offset${d.name};`)),n.enableShapeUniforms){const{uniformShape:g}=lre(n.packedInputs,d.shapeInfo.logicalShape,d.shapeInfo.texShape);switch(g.length){case 1:r.push(`uniform int ${d.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${d.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${d.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${d.name}Shape;`);break}r.push(`uniform ivec2 ${d.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(d=>{r.push(`uniform ${d.type} ${d.name}${d.arrayIndex?`[${d.arrayIndex}]`:""};`)});const i=r.join(`
`),s=e.map(d=>Lkt(d,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),a=t.texShape,o=Ba(),l=Ukt(o);let u,c,f=jkt(o);return t.isPacked?(u=Bkt(t.logicalShape,a,n.enableShapeUniforms),c=Vkt(o)):(u=zkt(t.logicalShape,a,n.enableShapeUniforms),c=Wkt(o)),n.packedInputs&&(f+=Ykt),[f,l,c,i,u,s,n.userCode].join(`
`)}function N_(e,t=!1){const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return aEt(e,t);case 1:return lEt(e,t);case 2:return cEt(e,t);case 3:return hEt(e,t);case 4:return pEt(e,t);case 5:return gEt(e);case 6:return mEt(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function TMe(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return sEt(e);case 1:return oEt(e,t);case 2:return uEt(e,t);case 3:return fEt(e,t);default:return dEt(e,t)}}function Lkt(e,t,n=!1,r){let i="";n?i+=TMe(e,r):i+=N_(e,r);const s=e.shapeInfo.logicalShape,a=t.logicalShape;return s.length<=a.length&&(n?i+=vEt(e,t):i+=yEt(e,t)),i}function Bkt(e,t,n){switch(e.length){case 0:return DMe();case 1:return Xkt(e,t,n);case 2:return rEt(e,t,n);case 3:return Zkt(e,t,n);default:return Jkt(e,t,n)}}function zkt(e,t,n){switch(e.length){case 0:return DMe();case 1:return Kkt(e,t,n);case 2:return iEt(e,t,n);case 3:return Qkt(e,t,n);case 4:return eEt(e,t,n);case 5:return tEt(e,t);case 6:return nEt(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}function Ukt(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function Wkt(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function Vkt(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function jkt(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Hkt}
    ${qkt}
    ${Gkt}
  `}const Hkt=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,qkt=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Gkt=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Ykt=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function DMe(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Xkt(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function Kkt(e,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function Zkt(e,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[2]/2),s=i*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec3(b, r, c);
    }
  `}function Qkt(e,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${M7(["r","c","d"],e)}
    return ivec3(r, c, d);
  }
`;const r=Kb(["r","c","d"],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function Jkt(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[e.length-1]/2),s=i*Math.ceil(e[e.length-2]/2);let a=s,o="",l="b, r, c";for(let u=2;u<e.length-1;u++)a*=e[e.length-u-1],o=`
      int b${u} = index / ${a};
      index -= b${u} * ${a};
    `+o,l=`b${u}, `+l;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${o}

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec${e.length}(${l});
    }
  `}function eEt(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${M7(["r","c","d","d2"],e)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Kb(["r","c","d","d2"],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function tEt(e,t){const n=Kb(["r","c","d","d2","d3"],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function nEt(e,t){const n=Kb(["r","c","d","d2","d3","d4"],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function rEt(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Qt(e,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const i=Math.ceil(e[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec2(r, c);
    }
  `}function iEt(e,t,n){return Qt(e,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function Zb(e){return`offset${e}`}function sEt(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Ba();return`
    vec4 ${n}() {
      return ${r.texture2D}(${t}, halfCR);
    }
  `}function aEt(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[i,s]=e.shapeInfo.texShape;if(i===1&&s===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Zb(n);if(t)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${a});
      return sampleTexture(${n}, uv);
    }
  `;const[o,l]=e.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${a});
      return sampleTexture(${n}, uv);
    }
  `}function oEt(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,s=Ba();if(t)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${s.texture2D}(${n}, uv);
    }
  `;const a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${a[0]}, ${a[1]}, index);
      return ${s.texture2D}(${n}, uv);
    }
  `}function lEt(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${I_(e)}
      }
    `;const i=e.shapeInfo.texShape,s=i[0],a=i[1];if(a===1&&s===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Zb(n);return a===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${s}.0);
        return sampleTexture(${n}, uv);
      }
    `:s===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${a}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${o});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${s}, ${a}, index + ${o});
      return sampleTexture(${n}, uv);
    }
  `}function uEt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape,a=s[0],o=s[1],l=Ba();if(s!=null&&Qt(n,s))return t?`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${a}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(t)return`
    vec4 ${i}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${i}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function cEt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape;if(s!=null&&Qt(n,s)){if(t)return`
      float ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const h=s[0],d=s[1];return`
    float ${i}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:a,keptDims:o}=eg(n),l=a;if(l.length<n.length){const h=M_(e,l),d=["row","col"];return`
      ${N_(h,t)}
      float ${i}(int row, int col) {
        return ${i}(${F_(d,o)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${I_(e)}
      }
    `;const u=s[0],c=s[1],f=Zb(r);return c===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:t?`
      float ${i}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${i}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${f};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function fEt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape,a=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(n[0]===1){const h=n.slice(1),d=[1,2],p=M_(e,h),g=["b","row","col"];return`
        ${TMe(p,t)}
        vec4 ${i}(int b, int row, int col) {
          return ${i}(${F_(g,d)});
        }
      `}const o=Ba();if(t)return`
    vec4 ${i}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `;const l=a[0],u=a[1],c=Math.ceil(n[2]/2),f=c*Math.ceil(n[1]/2);return`
    vec4 ${i}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${f}, ${c}, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `}function hEt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[1]*n[2],a=n[2],{newShape:o,keptDims:l}=eg(n),u=o;if(u.length<n.length){const g=M_(e,u),m=["row","col","depth"];return`
        ${N_(g,t)}
        float ${i}(int row, int col, int depth) {
          return ${i}(${F_(m,l)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${s}, ${a}, 1)));
        ${I_(e)}
      }
    `;const c=e.shapeInfo.texShape,f=c[0],h=c[1],d=e.shapeInfo.flatOffset;if(h===s&&d==null)return t?`
      float ${i}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${i}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${a}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${f}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(h===a&&d==null)return t?`
      float ${i}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=Zb(r);return t?`
    float ${i}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${i}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s} + col * ${a} + depth + ${p};
        vec2 uv = uvFromFlat(${f}, ${h}, index);
        return sampleTexture(${r}, uv);
      }
  `}function dEt(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=Ba();if(t)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);
    }
  `;const s=e.shapeInfo.logicalShape,a=s.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=l[0],c=l[1],f=Math.ceil(s[a-1]/2);let h=f*Math.ceil(s[a-2]/2),d="int b, int row, int col",p=`b * ${h} + (row / 2) * ${f} + (col / 2)`;for(let g=2;g<a-1;g++)d=`int b${g}, `+d,h*=s[a-g-1],p=`b${g} * ${h} + `+p;return`
    vec4 ${r}(${d}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${i.texture2D}(${n}, uv);
    }
  `}function pEt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[3],a=n[2]*s,o=n[1]*a,{newShape:l,keptDims:u}=eg(n);if(l.length<n.length){const y=M_(e,l),b=["row","col","depth","depth2"];return`
      ${N_(y,t)}
      float ${i}(int row, int col, int depth, int depth2) {
        return ${i}(${F_(b,u)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${a}, ${s}, 1)));
        ${I_(e)}
      }
    `;const c=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,h=f[0],d=f[1],p=`int stride2 = ${r}Shape[3];`,g=`int stride1 = ${r}Shape[2] * stride2;`,m=`int stride0 = ${r}Shape[1] * stride1;`;if(d===o&&c==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        ${p}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${a}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${d}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(d===s&&c==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${d}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;const v=Zb(r);return t?`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${g}
      ${m}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${v});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} +
          depth * ${s} + depth2;
      vec2 uv = uvFromFlat(${h}, ${d}, index + ${v});
      return sampleTexture(${r}, uv);
    }
  `}function gEt(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],s=t[3]*i,a=t[2]*s,o=t[1]*a,{newShape:l,keptDims:u}=eg(t);if(l.length<t.length){const g=M_(e,l),m=["row","col","depth","depth2","depth3"];return`
      ${N_(g)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${F_(m,u)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${a}, ${s}, ${i})) +
          depth3;
        ${I_(e)}
      }
    `;const c=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,h=f[0],d=f[1];if(d===o&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${a}, ${s}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${d}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(d===i&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${d}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Zb(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} + depth * ${s} +
          depth2 * ${i} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${d}, index);
      return sampleTexture(${n}, uv);
    }
  `}function mEt(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:s}=eg(t);if(i.length<t.length){const m=M_(e,i),v=["row","col","depth","depth2","depth3","depth4"];return`
      ${N_(m)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${F_(v,s)});
      }
    `}const a=t[5],o=t[4]*a,l=t[3]*o,u=t[2]*l,c=t[1]*u;if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${a}, 1)));
        ${I_(e)}
      }
    `;const f=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],p=h[1];if(p===c&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${o}, ${a})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===a&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=Zb(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${o} + depth3 * ${a} + depth4 + ${g};
      vec2 uv = uvFromFlat(${d}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function I_(e){const t=e.name,n=de(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function vEt(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",s=e.shapeInfo.logicalShape.length,a=t.logicalShape.length,o=AMe(e.shapeInfo.logicalShape,t.logicalShape),l=jn(a),u=a-s;let c;const f=["x","y","z","w","u","v"];s===0?c="":a<2&&o.length>=1?c="coords = 0;":c=o.map(y=>`coords.${f[y+u]} = 0;`).join(`
`);let h="";a<2&&s>0?h="coords":h=e.shapeInfo.logicalShape.map((y,b)=>`coords.${f[b+u]}`).join(", ");let d="return outputValue;";const g=de(e.shapeInfo.logicalShape)===1,v=de(t.logicalShape)===1;if(s===1&&!g&&!v)d=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!v)a===1?d=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:d=`
        return vec4(outputValue.x);
      `;else if(o.length){const y=s-2,b=s-1;o.indexOf(y)>-1&&o.indexOf(b)>-1?d="return vec4(outputValue.x);":o.indexOf(y)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(b)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${i}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${h});
      ${d}
    }
  `}function yEt(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",s=t.texShape,a=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===l&&e.shapeInfo.flatOffset==null&&Qt(a,s))return`
      float ${i}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=jn(l),c=AMe(e.shapeInfo.logicalShape,t.logicalShape),f=l-o;let h;const d=["x","y","z","w","u","v"];o===0?h="":l<2&&c.length>=1?h="coords = 0;":h=c.map(g=>`coords.${d[g+f]} = 0;`).join(`
`);let p="";return l<2&&o>0?p="coords":p=e.shapeInfo.logicalShape.map((g,m)=>`coords.${d[m+f]}`).join(", "),`
    float ${i}() {
      ${u} coords = getOutputCoords();
      ${h}
      return get${r}(${p});
    }
  `}function jn(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function lre(e,t,n){const{newShape:r,keptDims:i}=eg(t),s=t.length,a=e&&s===3&&t[0]===1,o=a?t.slice(1):r,l=!e&&s>1&&!Qt(t,n)&&r.length<s||a;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:i}}function M_(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function F_(e,t){return t.map(n=>e[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bEt(e,t,n,r){const i=n.map((c,f)=>{const h={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(h.flatOffset=c.texData.slice.flatOffset),{name:t.variableNames[f],shapeInfo:h}}),s=i.map(c=>c.shapeInfo),a={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=Pkt(i,a,t),l=hkt(e.gl,o),u=e.createProgram(l);return le().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:s,outShapeInfo:a,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(u),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:s,outShapeInfo:a},NMe(e,t,u)))}function NMe(e,t,n){const r=[],i=[];let s,a,o,l=null,u=null;u=e.getUniformLocation(n,"NAN",!1),le().getNumber("WEBGL_VERSION")===1&&(l=e.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const f of t.variableNames){const h={name:f,uniform:e.getUniformLocation(n,f,c),offset:e.getUniformLocation(n,`offset${f}`,c)};t.enableShapeUniforms&&(h.shape=e.getUniformLocation(n,`${f}Shape`,c),h.texShape=e.getUniformLocation(n,`${f}TexShape`,c)),r.push(h)}if(t.enableShapeUniforms&&(s=e.getUniformLocation(n,"outShape",c),o=e.getUniformLocation(n,"outShapeStrides",c),a=e.getUniformLocation(n,"outTexShape",c)),t.customUniforms)for(const f of t.customUniforms)i.push(e.getUniformLocation(n,f.name,c));return{variablesLocations:r,customUniformLocations:i,infLoc:l,nanLoc:u,outShapeLocation:s,outShapeStridesLocation:o,outTexShapeLocation:a}}function d0e(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((n,r)=>{const i=n.logicalShape,s=t[r],a=s.shape;if(!Qt(i,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${a} must match`);if(n.isUniform&&s.isUniform)return;const o=n.texShape,l=s.isUniform?null:s.texData.texShape;if(!Qt(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function xEt(e,t,n,r,i){t.program.enableShapeUniforms||(d0e(t.inShapeInfos,n),d0e([t.outShapeInfo],[r]));const s=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(s.texture,a[0],a[1]):e.setOutputMatrixTexture(s.texture,a[0],a[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),le().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:f,shape:h,texShape:d}=t.variablesLocations[l];if(h){const{uniformShape:p}=lre(t.program.packedInputs,u.shape,u.texData.texShape);switch(p.length){case 1:e.gl.uniform1iv(h,new Int32Array(p));break;case 2:e.gl.uniform2iv(h,new Int32Array(p));break;case 3:e.gl.uniform3iv(h,new Int32Array(p));break;case 4:e.gl.uniform4iv(h,new Int32Array(p));break}}if(d&&e.gl.uniform2i(d,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(de(u.shape)<2)e.gl.uniform1f(c,u.uniformValues[0]);else{let p=u.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),e.gl.uniform1fv(c,p)}continue}u.texData.slice!=null&&f!=null&&e.gl.uniform1i(f,u.texData.slice.flatOffset),e.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const o=t.outShapeLocation;if(o)switch(r.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(r.shape));break}if(t.outShapeStridesLocation){const l=Je(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l));break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i)for(let l=0;l<t.program.customUniforms.length;++l){const u=t.program.customUniforms[l],c=t.customUniformLocations[l],f=i[l];if(u.type==="float")e.gl.uniform1fv(c,f);else if(u.type==="vec2")e.gl.uniform2fv(c,f);else if(u.type==="vec3")e.gl.uniform3fv(c,f);else if(u.type==="vec4")e.gl.uniform4fv(c,f);else if(u.type==="int")e.gl.uniform1iv(c,f);else if(u.type==="ivec2")e.gl.uniform2iv(c,f);else if(u.type==="ivec3")e.gl.uniform3iv(c,f);else if(u.type==="ivec4")e.gl.uniform4iv(c,f);else throw Error(`uniform type ${u.type} is not supported yet.`)}e.executeProgram()}function wEt(e,t,n){let r="";t.concat(n).forEach(a=>{const o=a.texData!=null&&a.texData.slice!=null&&a.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!a.isUniform){const l=a.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:f}=lre(e.packedInputs,a.shape,l);let h="",d="",p="";if(c.length===1&&e.packedInputs){const w=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${w[0]>1}_${w[1]>1}`}else if(c.length===2&&!e.packedInputs)d=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!e.packedInputs){const w=Je(c);p=`${w[0]===l[1]}_${w[w.length-1]===l[1]}`}const g=a.shape.length,m=c.length===2&&Qt(a.shape,l),v=de(a.shape)===1,y=Ry(a.shape,n.shape),b=!e.packedInputs&&g===n.shape.length&&Qt(l,n.texData.texShape),x=e.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${g}_${b}_${u?f:""}_${c.length}_${v}_${y}_${m}_${h}_${d}_${p}_${x}_${o}`}else{const l=a.isUniform?"uniform":a.texData.texShape;r+=`${a.shape}_${l}_${o}`}});const i=e.userCode;let s=e.constructor.name;return s+="_"+r+"_"+i+`${le().getNumber("WEBGL_VERSION")}`,s}function Ks(e){return le().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Et{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=NT.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Ba();this.outputShape=t,this.enableShapeUniforms=Ks(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?M7(["r","c","d"],t):Kb(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CEt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=NT.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Ba();this.outputShape=t,this.enableShapeUniforms=Ks(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?M7(["r","c","d"],t):Kb(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Et{constructor(t){this.variableNames=["A"],this.outTexUsage=Nl.DOWNLOAD;const n=Ba();this.outputShape=t,this.userCode=`
      ${EMe}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SEt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Nl.DOWNLOAD;const n=Ba();this.outputShape=t,this.userCode=`
      ${EMe}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kEt={R:0,G:1,B:2,A:3};class p0e{constructor(t,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const i=Ba();this.outputShape=t,this.enableShapeUniforms=Ks(this.outputShape.length);let s="result";n&&(s="floor(result * 255. + 0.5)");let a="";for(let o=0;o<r.length;o++){const l=r[o];a+=`
          if(offset == ${o}) {
            result = values[${kEt[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?ore():are(t)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${i.texture2D}(A, uv);
          ${a}
        }
        ${i.output} = vec4(${s}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EEt{constructor(t,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Ba();this.outputShape=t,this.enableShapeUniforms=Ks(this.outputShape.length);let i="",s="result";n&&(s="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let o=0;o<=1;o++){const l=a*2+o;i+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${a} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {
            localCoords[1] += ${a};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?ore():are(t)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${i}

          ${r.output} = ${s};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AEt(e){const t=Ba(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return fkt(e,n)}function TEt(e){const t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return mkt(e,t)}function DEt(e){const t=new Uint16Array([0,1,2,2,1,3]);return vkt(e,t)}function HI(e,t,n,r,i,s){bkt(t,n);const a=ykt(e),o=e.TEXTURE_2D;return Be(e,()=>e.bindTexture(o,a)),Be(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),Be(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),Be(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),Be(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),le().getNumber("WEBGL_VERSION")===1?Be(e,()=>e.texImage2D(o,0,r,t,n,0,i,s,null)):Be(e,()=>e.texStorage2D(o,1,r,t,n)),Be(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:a,texShape:[n,t]}}function IMe(e){return e.internalFormatFloat}function NEt(e,t,n,r){const[i,s]=VI(t,n);return HI(e,i,s,IMe(r),r.textureFormatFloat,e.FLOAT)}function MMe(e){return e.internalFormatHalfFloat}function IEt(e,t,n,r){const[i,s]=VI(t,n);return HI(e,i,s,MMe(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function FMe(e){return e.downloadTextureFormat}function MEt(e,t,n,r){const[i,s]=VI(t,n);return HI(e,i,s,FMe(r),e.RGBA,e.UNSIGNED_BYTE)}function OMe(e){return e.internalFormatPackedFloat}function FEt(e,t,n,r){const[i,s]=D_(t,n);return HI(e,i,s,OMe(r),e.RGBA,e.FLOAT)}function RMe(e){return e.internalFormatPackedHalfFloat}function OEt(e,t,n,r){const[i,s]=D_(t,n);return HI(e,i,s,RMe(r),e.RGBA,r.textureTypeHalfFloat)}function REt(e,t,n){return Be(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),c0e(e,t,"clipSpacePos",n,3,20,0)&&c0e(e,t,"uv",n,2,20,12)}function PEt(e,t,n,r,i,s){Be(e,()=>e.bindTexture(e.TEXTURE_2D,t));let a,o,l;i instanceof Uint8Array?(a=new Uint8Array(n*r*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(a=new Float32Array(n*r*4),o=e.FLOAT,l=s.internalFormatPackedFloat),a.set(i),le().getNumber("WEBGL_VERSION")===2?Be(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,o,a)):Be(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,r,0,e.RGBA,o,a)),Be(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function LEt(e,t,n){Be(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?le().getNumber("WEBGL_VERSION")===2?Be(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):Be(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):le().getNumber("WEBGL_VERSION")===2?Be(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):Be(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),Be(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function BEt(e,t,n,r){const i=e.createBuffer();Be(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,i));const o=4*4*t*n;return Be(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)),Be(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),Be(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),i}function zEt(e,t,n){const r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function UEt(e,t,n,r){const[i,s]=VI(t,n),a=4,o=new Uint8Array(ikt(t*n,a));return Be(e,()=>e.readPixels(0,0,i,s,r.downloadTextureFormat,e.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function WEt(e,t,n,r,i,s,a,o){const l=e,u=new Float32Array(skt(s,a));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function VEt(e,t,n){const r=new Float32Array(t*n*4);return Be(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _j{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=le().getNumber("WEBGL_VERSION");if(t!=null?(this.gl=t,tkt(n,t)):this.gl=Jc(n),t=this.gl,le().getNumber("WEBGL_VERSION")===2){const s=t;this.createVertexArray=()=>Be(s,()=>s.createVertexArray()),this.bindVertexArray=a=>Be(s,()=>s.bindVertexArray(a)),this.deleteVertexArray=a=>Be(s,()=>s.deleteVertexArray(a)),this.getVertexArray=()=>Be(s,()=>s.getParameter(s.VERTEX_ARRAY_BINDING))}else if(t!=null){const s=t.getExtension("OES_vertex_array_object");if(s==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Be(t,()=>s.createVertexArrayOES()),this.bindVertexArray=a=>Be(t,()=>s.bindVertexArrayOES(a)),this.deleteVertexArray=a=>Be(t,()=>s.deleteVertexArrayOES(a)),this.getVertexArray=()=>Be(t,()=>t.getParameter(s.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),le().getNumber("WEBGL_VERSION")===1){const s="OES_texture_float",a="OES_texture_half_float";if(this.textureFloatExtension=fO(this.gl,s),yu(this.gl,a))this.textureHalfFloatExtension=fO(this.gl,a);else if(le().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),yu(this.gl,i))this.colorBufferHalfFloatExtension=fO(this.gl,i);else if(le().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",yu(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(yu(this.gl,i))this.colorBufferHalfFloatExtension=this.gl.getExtension(i);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=TEt(this.gl),this.indexBuffer=DEt(this.gl),this.framebuffer=xkt(this.gl),this.textureConfig=sre(this.gl,this.textureHalfFloatExtension)}get debug(){return le().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;Be(t,()=>t.finish()),Be(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),Be(t,()=>t.deleteFramebuffer(this.framebuffer)),Be(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),Be(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),Be(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,n){return this.throwIfDisposed(),NEt(this.gl,t,n,this.textureConfig)}createFloat16MatrixTexture(t,n){return this.throwIfDisposed(),IEt(this.gl,t,n,this.textureConfig)}createUnsignedBytesMatrixTexture(t,n){return this.throwIfDisposed(),MEt(this.gl,t,n,this.textureConfig)}uploadPixelDataToTexture(t,n){this.throwIfDisposed(),LEt(this.gl,t,n)}uploadDenseMatrixToTexture(t,n,r,i){this.throwIfDisposed(),PEt(this.gl,t,n,r,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,n){return this.throwIfDisposed(),OEt(this.gl,t,n,this.textureConfig)}createPackedMatrixTexture(t,n){return this.throwIfDisposed(),FEt(this.gl,t,n,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(f0e(this.gl,this.framebuffer),this.outputTexture=null),Be(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,n,r){return this.downloadMatrixDriver(t,()=>UEt(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(t,n,r,i,s,a){return WEt(this.gl,t,n,r,i,s,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,n){return zEt(this.gl,t,n)}createBufferFromTexture(t,n,r){this.bindTextureToFrameBuffer(t);const i=BEt(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let n,r;if(le().getBool("WEBGL_FENCE_API_ENABLED")){const i=t,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=()=>{const a=i.clientWaitSync(s,0,0);return a===i.ALREADY_SIGNALED||a===i.CONDITION_SATISFIED},n=s}else le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(t,n,r){return this.downloadMatrixDriver(t,()=>VEt(this.gl,n,r))}createProgram(t){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=AEt(n));const r=pkt(n);Be(n,()=>n.attachShader(r,this.vertexShader)),Be(n,()=>n.attachShader(r,t)),gkt(n,r);const i=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&xj(n,i),i}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const n=this.gl;Be(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),REt(n,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&(Be(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&xj(this.gl,this.program),Be(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,n,r=!0){return this.throwIfDisposed(),r?$kt(this.gl,t,n):Ckt(this.gl,t,n)}getAttributeLocation(t,n){return this.throwIfDisposed(),Be(this.gl,()=>this.gl.getAttribLocation(t,n))}getUniformLocationNoThrow(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)}setInputMatrixTexture(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),_kt(this.gl,t,n,r)}setOutputMatrixTexture(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)}setOutputPackedMatrixTexture(t,n,r){this.throwIfDisposed();const[i,s]=D_(n,r);this.setOutputMatrixTextureDriver(t,i,s)}setOutputMatrixWriteRegion(t,n,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,n)}setOutputPackedMatrixWriteRegion(t,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&xj(this.gl,this.program),hO(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Be(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Be(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=fO(this.gl,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.createQuery();return r.beginQuery(i.TIME_ELAPSED_EXT,s),s}const t=this.getQueryTimerExtensionWebGL1(),n=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,n),n}endQuery(){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await CY(()=>this.disposed||this.isQueryAvailable(t,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,n){if(n===0)return!0;if(n===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),s&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),i=r.getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}}pollFence(t){return new Promise(n=>{this.addItemToPoll(()=>t.isFencePassed(),()=>n())})}pollItems(){const t=jEt(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=t;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,n){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in le().platform&&(r=le().platform.setTimeoutCustom.bind(le().platform)),CY(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),wj(this.gl,t,this.framebuffer),this.debug&&hO(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(wj(this.gl,this.outputTexture,this.framebuffer),this.debug&&hO(this.gl)):f0e(this.gl,this.framebuffer)}downloadMatrixDriver(t,n){this.bindTextureToFrameBuffer(t);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(t,n,r){this.throwIfDisposed();const i=this.gl;wj(i,t,this.framebuffer),this.debug&&hO(i),this.outputTexture=t,Be(i,()=>i.viewport(0,0,n,r)),Be(i,()=>i.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(t,n,r,i){this.throwIfDisposed(),Be(this.gl,()=>this.gl.scissor(t,n,r,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function jEt(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:HEt,bincountImpl:PMe,bincountReduceImpl:qEt,bitwiseAndImpl:GEt,castImpl:YEt,ceilImpl:XEt,concatImpl:KEt,equalImpl:ZEt,expImpl:QEt,expm1Impl:JEt,floorImpl:eAt,gatherNdImpl:tAt,gatherV2Impl:nAt,greaterImpl:rAt,greaterEqualImpl:iAt,lessImpl:sAt,lessEqualImpl:aAt,linSpaceImpl:oAt,logImpl:lAt,maxImpl:uAt,maximumImpl:cAt,minimumImpl:fAt,multiplyImpl:hAt,negImpl:dAt,notEqualImpl:pAt,prodImpl:gAt,raggedGatherImpl:mAt,raggedRangeImpl:vAt,raggedTensorToTensorImpl:yAt,rangeImpl:bAt,rsqrtImpl:xAt,scatterImpl:wAt,sigmoidImpl:$At,simpleAbsImpl:LMe,sliceImpl:CAt,sparseFillEmptyRowsImpl:_At,sparseReshapeImpl:SAt,sparseSegmentReductionImpl:BMe,sqrtImpl:kAt,staticRegexReplaceImpl:EAt,stridedSliceImpl:AAt,stringNGramsImpl:TAt,stringSplitImpl:DAt,stringToHashBucketFastImpl:NAt,subImpl:IAt,tileImpl:MAt,topKImpl:FAt,transposeImpl:ure,uniqueImpl:OAt}=L2t;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zMe(e,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${e}.${n}`)}function ga(e,t){return t===1?[e]:zMe(e,t)}function RAt(e,t){if(e===1)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PAt{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=Ks(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=ga("rc",this.rank),r=jn(this.rank),i=this.getOutOfBoundsCondition(n),s=this.getSetup(n),a=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${i}) {
            setOutput(vec4(0));
          } else {
            ${s}

            setOutput(vec4(${a}));
          }
        }
      `}}getSourceCoordsArr(t){const n=[];for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){let s=`${r===0?"r":"rp1"}, ${i===0?"c":"cp1"}`;for(let a=2;a<this.rank;a++)s=`${t[t.length-1-a]},`+s;n.push(s)}return n}getOutOfBoundsCondition(t){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${t[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(t){if(this.rank===1)return"";const n=t.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],i=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${i};
    `}getOutput(t){const n=this.getSourceCoordsArr(t);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UMe{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=Ks(this.outputShape.length);let r="";for(let i=0;i<4;i++){let s="thisRC = rc;";i%2===1&&(s+="thisRC.z += 1;"),i>1&&(s+="thisRC.y += 1;"),r+=`
        ${s}
        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${i}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${i>0?"}":""}
      `}this.userCode=`
      ${LAt(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?ore():are(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};

        ${r}

        setOutput(result);
      }
    `}}function LAt(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?Rkt(["r","c","d"],"inputShape"):Kb(["r","c","d"],e)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BAt{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,n,r){const i=m0e(n,r),s=v0e(t,i,r);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);const a=g0e(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const l=this.freeTextures[s].pop();return this.usedTextures[s].push(l),l}let o;return i===Qi.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Qi.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Qi.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Qi.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Qi.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(o),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),o}releaseTexture(t,n,r,i){if(this.freeTextures==null)return;const s=m0e(r,i),a=v0e(n,s,i);a in this.freeTextures||(this.freeTextures[a]=[]);const o=g0e(n,s,this.gpgpu.gl,this.gpgpu.textureConfig,i),l=le().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=o):(this.freeTextures[a].push(t),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const u=this.usedTextures[a],c=u&&u.indexOf(t);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const t in this.freeTextures)this.freeTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function zAt(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function g0e(e,t,n,r,i){const s=UAt(t,r);let a;if(i){const[l,u]=D_(e[0],e[1]);a=l*u}else{const[l,u]=VI(e[0],e[1]);a=l*u}const o=zAt(n,s);return a*o}function UAt(e,t){switch(e){case Qi.PACKED_2X2_FLOAT32:return OMe(t);case Qi.PACKED_2X2_FLOAT16:return RMe(t);case Qi.UNPACKED_FLOAT32:return IMe(t);case Qi.UNPACKED_FLOAT16:return MMe(t);case Qi.PACKED_4X1_UNSIGNED_BYTE:return FMe(t);default:throw new Error(`Unknown physical texture type ${e}`)}}function WAt(e){return le().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Qi.PACKED_2X2_FLOAT32:Qi.UNPACKED_FLOAT32:e?Qi.PACKED_2X2_FLOAT16:Qi.UNPACKED_FLOAT16}function m0e(e,t){if(e===Nl.UPLOAD)return Qi.PACKED_2X2_FLOAT32;if(e===Nl.RENDER||e==null)return WAt(t);if(e===Nl.DOWNLOAD||e===Nl.PIXELS)return Qi.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function v0e(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class th{constructor(t,n){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=Ks(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Xu="if (isnan(x)) return x;",VAt="return x;",y0e="return abs(x);",jAt="return (x >= 0.0) ? x : (exp(x) - 1.0);",HAt=Xu+`
  return (x < 0.0) ? 0.0 : x;
`,qAt=Xu+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Pg="return x;",GAt="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YAt="return x;",XAt=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,KAt=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ZAt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,QAt="return 1.0 / (1.0 + exp(-1.0 * x));";class Qg{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=Ks(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JAt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=Ks(this.outputShape.length);const n=t.length,r=ga("rc",n),i=jn(n),s=RAt(n,r),a=r.slice(-2),o=n<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`
      void main() {
        ${i} rc = getOutputCoords();
        vec4 packedInput = getA(${s});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eTt=o7,tTt=1e-7,nTt=1e-4,gO={};function rTt(e){return e in gO||(gO[e]={}),gO[e]}const iTt=le().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),sTt=600;function aTt(){return le().global.screen==null?1024:le().global.screen.height*le().global.screen.width*window.devicePixelRatio*sTt/1024/1024}class F7 extends NB{nextDataId(){return F7.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!le().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(t!=null){if(t instanceof _j)n=t;else{const r=Jc(le().getNumber("WEBGL_VERSION"),t);n=new _j(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Jc(le().getNumber("WEBGL_VERSION"));n=new _j(r),this.binaryCache=rTt(le().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new BAt(this.gpgpu),this.numMBBeforeWarning=aTt(),this.texData=new Qee(this,dc())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,n,r,i,s,a){const o=this.makeTensorInfo(n,r),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:t,texShape:[i,s]},l.texShape=[i,s];const u=dO(n),c=new p0e(u,!1,a),f=this.runWebGLProgram(c,[o],r,[[i,s]]);return f.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(o),f.dataId}write(t,n,r){if((le().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||le().getBool("DEBUG"))&&this.checkNumericalProblems(t),r==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={id:this.nextDataId()};return this.texData.set(i,{shape:n,dtype:r,values:t,usage:Nl.UPLOAD,refCount:1}),i}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){const n=this.texData.get(t);n.refCount++}decRef(t){if(this.texData.has(t)){const n=this.texData.get(t);n.refCount--}}move(t,n,r,i,s){if(le().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:r,dtype:i,values:n,usage:Nl.UPLOAD,refCount:s})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const n=this.texData.get(t),{values:r,dtype:i,complexTensorInfos:s,slice:a,shape:o,isPacked:l}=n;if(a!=null){let h;l?h=new Qg(o,Pg):h=new th(o,Pg);const d=this.runWebGLProgram(h,[{dataId:t,shape:o,dtype:i}],i),p=this.readSync(d.dataId);return this.disposeIntermediateTensorInfo(d),p}if(r!=null)return this.convertAndCacheOnCPU(t);if(i==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=ca());let f;if(i==="complex64"){const h=this.readSync(s.real.dataId),d=this.readSync(s.imag.dataId);f=Fp(h,d)}else f=this.getValuesFromTexture(t);return u&&(this.downloadWaitMs+=ca()-c),this.convertAndCacheOnCPU(t,f)}async read(t){if(this.pendingRead.has(t)){const p=this.pendingRead.get(t);return new Promise(g=>p.push(g))}const n=this.texData.get(t),{values:r,shape:i,slice:s,dtype:a,complexTensorInfos:o,isPacked:l}=n;if(s!=null){let p;l?p=new Qg(i,Pg):p=new th(i,Pg);const g=this.runWebGLProgram(p,[{dataId:t,shape:i,dtype:a}],a),m=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),m}if(r!=null)return this.convertAndCacheOnCPU(t);if(le().getBool("DEBUG")&&!le().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&le().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(a!=="complex64"&&le().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(t);const p=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(p.texture.texture,...cO(i))}this.pendingRead.set(t,[]),a!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(a==="complex64"){const p=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),g=p[0],m=p[1];f=Fp(g,m)}else if(u==null)f=this.getValuesFromTexture(t);else{const p=de(i);f=this.gpgpu.downloadFloat32MatrixFromBuffer(u,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const p=this.gpgpu.gl;Be(p,()=>p.deleteBuffer(u))}const h=this.convertAndCacheOnCPU(t,f),d=this.pendingRead.get(t);return this.pendingRead.delete(t),d.forEach(p=>p(h)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&dc().removeDataId(t,this),this.pendingDeletes--),h}readToGPU(t,n={}){const r=this.texData.get(t),{values:i,shape:s,slice:a,dtype:o,isPacked:l,texture:u}=r;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(a!=null){let d;l?d=new Qg(s,Pg):d=new th(s,Pg);const p=this.runWebGLProgram(d,[{dataId:t,shape:s,dtype:o}],o),g=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),g}if(u==null)throw i!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(t,n.customTexShape),f=dc().makeTensorFromTensorInfo(c),h=this.texData.get(c.dataId);return Object.assign({tensorRef:f},h.texture)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const r=n.map(i=>Ip(i));return Mt(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Mt(t.shape,t.dtype,n)}checkNumericalProblems(t){if(t!=null)for(let n=0;n<t.length;n++){const r=t[n];if(!ukt(r))throw le().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(t){const{shape:n,dtype:r,isPacked:i}=this.texData.get(t),s=de(n);if(le().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(t),d=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(d.texture.texture,...cO(n)).subarray(0,s);return this.disposeIntermediateTensorInfo(h),p}const a=le().getBool("WEBGL_PACK")&&i===!0,o=a?dO(n):n,l=a?new SEt(o):new _Et(o),u=this.runWebGLProgram(l,[{shape:o,dtype:r,dataId:t}],"float32"),c=this.texData.get(u.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(u),f}timerAvailable(){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const n=this.activeTimers,r=[];let i=!1;this.programTimersStack==null?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,t();const s=Nh(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),a=Nh(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,i&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(s);o.kernelMs=aAe(l),o.getExtraProfileInfo=()=>l.map((u,c)=>({name:a[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ca(),endMs:null}}endTimer(t){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=ca(),t)}async getQueryTime(t){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const n=t;return n.endMs-n.startMs}disposeData(t,n=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(n?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!n&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:r}=this.texData.get(t);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:n,dtype:r,texShape:i,usage:s,isPacked:a,slice:o}=this.texData.get(t),l=o&&o.origDataId||t,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,s,a)));const c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,n=iTt){return le().getBool("WEBGL_CPU_FORWARD")&&t.every(r=>this.texData.get(r.dataId).texture==null&&de(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(t){kl("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=t.dataSync();return eTt(t.shape,n)}packedUnaryOp(t,n,r){const i=new Qg(t.shape,n),s=this.compileAndRun(i,[t],r);return dc().makeTensorFromTensorInfo(s)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){const i=LMe(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,i)}if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,y0e,t.dtype);const n=new th(t.shape,y0e),r=this.compileAndRun(n,[t]);return dc().makeTensorFromTensorInfo(r)}makeTensorInfo(t,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&Qf(r[0])){const s=r.map(a=>rh(a));i=this.write(s,t,n)}else i=this.write(r,t,n);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:n}}makeOutput(t,n,r){return dc().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,r),this)}unpackTensor(t){const n=new JAt(t.shape);return this.runWebGLProgram(n,[t],t.dtype)}packTensor(t){const n=new PAt(t.shape),r=!0;return this.runWebGLProgram(n,[t],t.dtype,null,r)}packedReshape(t,n){const r=[Ww(t.shape),...Vw(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},s=[Ww(n),...Vw(n)],a=new UMe(s,r),o=!0,l=[r],u=this.runWebGLProgram(a,[i],t.dtype,l,o);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(t,n){const r=this.texData.get(t),{isPacked:i,shape:s,dtype:a}=r;if(n!=null){const h=de(s),d=n[0]*n[1]*4;B(h<=d,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=dO(s);let l;i?l=new CEt(o):l=new $Et(o);const u=!0,c=[n!=null?n:cO(o)],f=this.runWebGLProgram(l,[{shape:o,dtype:a,dataId:t}],a,c,u,n);return{dtype:a,shape:s,dataId:f.dataId}}runWebGLProgram(t,n,r,i,s=!1,a){const o=this.makeTensorInfo(t.outputShape,r),l=this.texData.get(o.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===NT.DENSE){const v=a!=null?a:cO(t.outputShape);l.texShape=v.map(y=>y*2)}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),de(o.shape)===0)return l.values=Fi(o.dtype,0),o;const u=[],c=n.map(v=>{if(v.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(v.dataId);if(y.texture==null){if(!t.packedInputs&&de(v.shape)<=le().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:v.shape,texData:null,isUniform:!0,uniformValues:y.values};t.packedInputs&&(y.isPacked=!0,y.shape=v.shape)}if(this.uploadToGPU(v.dataId),!!y.isPacked!=!!t.packedInputs)v=y.isPacked?this.unpackTensor(v):this.packTensor(v),u.push(v),y=this.texData.get(v.dataId);else if(y.isPacked&&!q5(y.shape,v.shape)){const b=v,x=v.shape;v.shape=y.shape,v=this.packedReshape(v,x),u.push(v),y=this.texData.get(v.dataId),b.shape=x}return{shape:v.shape,texData:y,isUniform:!1}});this.uploadToGPU(o.dataId);const f={shape:o.shape,texData:l,isUniform:!1},h=wEt(t,c,f),d=this.getAndSaveBinary(h,()=>bEt(this.gpgpu,t,c,f)),p=this.activeTimers!=null;let g;p&&(g=this.startTimer()),le().get("ENGINE_COMPILE_ONLY")||xEt(this.gpgpu,d,c,f,i),u.forEach(v=>this.disposeIntermediateTensorInfo(v)),p&&(g=this.endTimer(g),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(g)}));const m=le().get("WEBGL_FLUSH_THRESHOLD");if(m>0){const v=ca();v-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=v)}if(!le().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&s===!1){const v=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),v}return o}compileAndRun(t,n,r,i,s=!1){return r=r||n[0].dtype,this.runWebGLProgram(t,n,r,i,s)}getAndSaveBinary(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(le().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ce(()=>{if(!le().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=le().getBool("DEBUG");le().set("DEBUG",!1);const n=this.abs(xt(1e-8)).dataSync()[0];if(le().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?tTt:nTt}uploadToGPU(t){const n=this.texData.get(t),{shape:r,dtype:i,values:s,texture:a,usage:o,isPacked:l}=n;if(a!=null)return;const u=this.activeTimers!=null;let c;u&&(c=ca());let f=n.texShape;if(f==null&&(f=Ekt(r,l),n.texShape=f),s!=null){const h=dO(r);let d,p=f[1],g=f[0];const m=s instanceof Uint8Array||s instanceof Uint8ClampedArray;(l||!m)&&([p,g]=D_(f[0],f[1])),l?d=new EEt(h,m):d=new p0e(h,m);const v=m?[g,p]:f,y=this.makeTensorInfo(v,i),b=this.texData.get(y.dataId);m?b.usage=Nl.PIXELS:b.usage=Nl.UPLOAD,b.texShape=v,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),p,g,s);const x=[[g,p]],w=!0,C=this.runWebGLProgram(d,[y],i,x,w),$=this.texData.get(C.dataId);n.texShape=$.texShape,n.isPacked=$.isPacked,n.usage=$.usage,le().get("ENGINE_COMPILE_ONLY")?this.disposeData(C.dataId):(n.texture=$.texture,n.values=null,this.texData.delete(C.dataId)),this.disposeIntermediateTensorInfo(y),u&&(this.uploadWaitMs+=ca()-c)}else{const h=this.acquireTexture(f,o,i,l);n.texture=h}}convertAndCacheOnCPU(t,n){const r=this.texData.get(t),{dtype:i}=r;return n!=null&&(r.values=oTt(n,i)),r.values}acquireTexture(t,n,r,i){if(this.numBytesInGPU+=this.computeBytes(t,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${s} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,n,i)}computeBytes(t,n){return t[0]*t[1]*fT(n)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(n));return Promise.all(t)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(i=>{try{this.checkCompletion_(n),i(!0)}catch(s){throw s}});t.push(r)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await ane(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(kMe(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:i,nanLoc:s,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:l}=NMe(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=n,t.customUniformLocations=r,t.infLoc=i,t.nanLoc=s,t.outShapeLocation=a,t.outShapeStridesLocation=o,t.outTexShapeLocation=l}}createTensorFromGPUData(t,n,r){t.channels=t.channels||"RGBA";const{texture:i,height:s,width:a,channels:o}=t,l=dc().backend;if(!l.gpgpu.gl.isTexture(i))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(i,n,r,s,a,o);return dc().makeTensorFromDataId(u,n,r,l)}}F7.nextDataId=0;function oTt(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){const n=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}else throw new Error(`Unknown dtype ${t}`)}/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ute()&&hte("webgl",()=>new F7,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cre=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Wy{constructor(t,n,r){this.variableNames=["A","B"],this.outputShape=Ct(n,r),this.enableShapeUniforms=Ks(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qb=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class O_{constructor(t,n,r,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ct(n,r);const s=this.outputShape.length;this.enableShapeUniforms=Ks(s);let a="";if(i)if(s===0||de(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          ${jn(s)} coords = getOutputCoords();
        `,s===1)this.enableShapeUniforms?a+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:a+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=ga("coords",s);this.enableShapeUniforms?a+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= outShape[${s} - 2];
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= outShape[${s} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:a+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= ${this.outputShape[s-2]};
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= ${this.outputShape[s-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${a}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ol(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const lTt={kernelName:KC,backendName:"webgl",kernelFunc:ol};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Km(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,s=n.makeTensorInfo(r.shape,"complex64"),a=n.texData.get(s.dataId),o=ol({inputs:{x:r},backend:n}),l=ol({inputs:{x:i},backend:n});return a.complexTensorInfos={real:o,imag:l},s}const uTt={kernelName:UB,backendName:"webgl",kernelFunc:Km};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WMe="return (a < 0.) ? b * a : a;",VMe=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function cTt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:s}=r,a=n.makeTensorInfo([],"float32",tg(s,"float32")),o=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new O_(VMe,i.shape,a.shape):new Wy(WMe,i.shape,a.shape),l=n.runWebGLProgram(o,[i,a],"float32");return n.disposeIntermediateTensorInfo(a),l}const fTt={kernelName:UN,backendName:"webgl",kernelFunc:cTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jMe="return (a < 0.) ? b * a : a;",HMe=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function hTt(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t,s=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new O_(HMe,r.shape,i.shape):new Wy(jMe,r.shape,i.shape);return n.runWebGLProgram(s,[r,i],"float32")}const dTt={kernelName:aI,backendName:"webgl",kernelFunc:hTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R_="if (isnan(x)) return x;";function nn({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:s})=>{const{x:a}=i,o=s,l=r||a.dtype;if(o.shouldExecuteOnCPU([a])&&n!=null){const f=o.texData.get(a.dataId),h=n(f.values,l);return o.makeTensorInfo(a.shape,l,h)}const u=le().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null;let c;return u?c=new Qg(a.shape,t):c=new th(a.shape,e),o.runWebGLProgram(c,[a],l)}}function ys({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:s}){return({inputs:a,backend:o})=>{const{a:l,b:u}=a,c=o;if(r&&l.dtype==="complex64"){const p=c.texData.get(l.dataId),g=c.texData.get(u.dataId),[m,v]=[[p.complexTensorInfos.real,g.complexTensorInfos.real],[p.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(b=>{const[x,w]=b,C={dataId:x.dataId,dtype:x.dtype,shape:l.shape},$={dataId:w.dataId,dtype:w.dtype,shape:u.shape},_=new Wy(e,l.shape,u.shape);return c.runWebGLProgram(_,[C,$],po(x.dtype,w.dtype))}),y=Km({inputs:{real:m,imag:v},backend:c});return c.disposeIntermediateTensorInfo(m),c.disposeIntermediateTensorInfo(v),y}const f=s||po(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&i!=null){const p=c.texData.get(l.dataId).values,g=c.texData.get(u.dataId).values,m=l.dtype==="string"?Op(p):p,v=l.dtype==="string"?Op(g):g,[y,b]=i(l.shape,u.shape,m,v,f),x=c.makeTensorInfo(b,f),w=c.texData.get(x.dataId);return w.values=y,x}const h=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null;let d;return h?d=new O_(t,l.shape,u.shape,n):d=new Wy(e,l.shape,u.shape),c.runWebGLProgram(d,[l,u],f)}}function IT(e,t=!1){if(e==="linear")return t?YAt:VAt;if(e==="relu")return t?KAt:HAt;if(e==="elu")return t?XAt:jAt;if(e==="relu6")return t?ZAt:qAt;if(e==="prelu")return t?HMe:jMe;if(e==="leakyrelu")return t?VMe:WMe;if(e==="sigmoid")return t?QAt:GAt;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qMe{constructor(t,n,r,i=!1,s=!1,a=!1,o=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Ks(this.outputShape.length);const c=i?t[1]:t[2],f=Math.ceil(c/2),h=i?"i * 2, rc.y":"rc.y, i * 2",d=s?"rc.z, i * 2":"i * 2, rc.z",p=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",v="";o&&(l?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:u?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:m=`vec4 activation(vec4 x) {
          ${o}
        }`,v="result = activation(result);");const y=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let b="rc.x",x="rc.x";t[0]<n[0]?b=`imod(rc.x, ${t[0]})`:n[0]<t[0]&&(x=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${m}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${x};
        for (int i = 0; i < ${f}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${d});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${g[0]});
          result += (${p[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${v}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b0e={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class x0e{constructor(t,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ct(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w0e="return a * b;";function fre(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,s=po(r.dtype,i.dtype);if(r.dtype==="complex64"){const o=n.texData.get(r.dataId),l=n.texData.get(i.dataId),u=new x0e(b0e.REAL,r.shape,i.shape),c=new x0e(b0e.IMAG,r.shape,i.shape),f=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:r.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:i.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:i.shape}],h=n.runWebGLProgram(u,f,"float32"),d=n.runWebGLProgram(c,f,"float32"),p=Km({inputs:{real:h,imag:d},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),p}if(n.shouldExecuteOnCPU([r,i])){const o=n.texData.get(r.dataId),l=n.texData.get(i.dataId),[u,c]=hAt(r.shape,i.shape,o.values,l.values,s),f=n.makeTensorInfo(c,s),h=n.texData.get(f.dataId);return h.values=u,f}let a;return le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?a=new O_(w0e,r.shape,i.shape):a=new Wy(w0e,r.shape,i.shape),n.runWebGLProgram(a,[r,i],s)}const pTt={kernelName:s_,backendName:"webgl",kernelFunc:fre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gTt(e,t,n){const r=[Ww(e.shape),...Vw(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},s=[Ww(t),...Vw(t)],a=new UMe(s,r),o=!0,l=[r],u=n.runWebGLProgram(a,[i],e.dtype,l,o);return{dataId:u.dataId,shape:t,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:s}=r,a=n,o=de(i.shape),l=ete(s,o),u=de(l);B(o===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const c=a.texData.get(i.dataId);return c.isPacked&&!q5(i.shape,l)&&!(c.texture!==null&&q5(c.shape,l))?gTt(i,l,a):(a.incRef(i.dataId),{dataId:i.dataId,shape:l,dtype:i.dtype})}const mTt={kernelName:lI,backendName:"webgl",kernelFunc:Fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $0e{constructor(t,n){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:a}=t;this.outputShape=[i,a];const o=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const f=1/n;u=`sumValue += dot(values * ${Iy(f)?f.toPrecision(2):f}, ones);`}let c="";s%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vTt{constructor(t,n){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:a}=t;this.outputShape=[i,a];let o="0.0",l="";n==="prod"?o="1.0":n==="min"?(o="1.0 / 1e-20",l="min"):n==="max"&&(o="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,f=r%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,d="vec4";n==="all"?(o="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):n==="any"&&(o="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${f===2}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${f===3}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yTt(e){const t=[];for(;t.length===0||t[t.length-1].outSize!==1;){const n=t.length?t[t.length-1].outSize:e[1],r=y7(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}function Jb(e,t,n,r){const i=yTt(e.shape);let s=e;for(let a=0;a<i.length;a++){const{inSize:o,windowSize:l,outSize:u}=i[a];let c,f;n==="mean"?c=a===0?new $0e({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:u},o):new $0e({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:u}):c=new vTt({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:u},n),f=s,s=r.runWebGLProgram(c,[s],t),f.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(f)}return s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bTt{constructor(t,n){this.variableNames=["A"];const r=new Array(t.length);for(let a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;const i=jn(this.rank),s=xTt(n);this.userCode=`
    void main() {
      ${i} resRC = getOutputCoords();
      setOutput(getA(${s}));
    }
    `}}function xTt(e){const t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let i=0;i<e.length;i++)r[e[i]]=n[i];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wTt{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(t.length);for(let c=0;c<r.length;c++)r[c]=t[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=jn(this.rank),s=zMe("rc",this.rank),a=new Array(this.rank);for(let c=0;c<n.length;c++)a[n[c]]=s[c];const o=`vec2(${a.slice(-2).join()})`,l=`++${s[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${a.join()}), ${o})`;this.userCode=`
    void main() {
      ${i} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${s[this.rank-1]};
      if(++${s[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O7(e,t,n){const r=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wTt(e.shape,t):new bTt(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Tt(e,t,n,r){const i=t,s=e.shape.length,a=Ot(i,e.shape);let o=a;const l=Fr(o,s),u=l!=null;let c=e;u&&(c=O7(e,l,r),o=Jr(o.length,s)),vs("sum",o,s);const[f,h]=Li(c.shape,o);let d=f;n&&(d=Zr(f,a));const p=de(h),m=de(e.shape)/p,v=Fe({inputs:{x:c},attrs:{shape:[m,p]},backend:r}),y=Uz(e.dtype),b=Jb(v,y,"sum",r),x=Fe({inputs:{x:b},attrs:{shape:d},backend:r});return r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(b),u&&r.disposeIntermediateTensorInfo(c),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R7(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r;return $Tt(i,s,a,n)}const CTt={kernelName:pI,backendName:"webgl",kernelFunc:R7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ma(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{perm:s}=r,a=n,o=i.shape.length,l=new Array(o);for(let c=0;c<l.length;c++)l[c]=i.shape[s[c]];let u;if(a.shouldExecuteOnCPU([i])){const f=a.texData.get(i.dataId).values,h=ure(f,i.shape,i.dtype,s,l);u=a.makeTensorInfo(l,i.dtype);const d=a.texData.get(u.dataId);d.values=h}else u=O7(i,s,a);return u}const _Tt={kernelName:K1,backendName:"webgl",kernelFunc:Ma};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GMe=1e3;function G5({a:e,b:t,transposeA:n,transposeB:r,backend:i,bias:s=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:l=null}){const u=e.shape.length,c=t.shape.length,f=n?e.shape[u-2]:e.shape[u-1],h=r?t.shape[c-1]:t.shape[c-2],d=n?e.shape[u-1]:e.shape[u-2],p=r?t.shape[c-2]:t.shape[c-1],g=e.shape.slice(0,-2),m=t.shape.slice(0,-2),v=de(g),y=de(m),x=Ct(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([d,p]);B(f===h,()=>`Error in matMul: inner shapes (${f}) and (${h}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`);const w=n?[v,f,d]:[v,d,f],C=r?[y,p,h]:[y,h,p],$=Fe({inputs:{x:e},backend:i,attrs:{shape:w}}),_=Fe({inputs:{x:t},backend:i,attrs:{shape:C}}),k=[$,_],E=Math.max(v,y),S=n?$.shape[1]:$.shape[2],N=s!=null,A=a!=null,D=l==="leakyrelu",T=l!=null?IT(l,!0):null,I=N||A||D||T!=null;let F;if((d===1||p===1)&&S>GMe&&I===!1){let P=$,V=_;n&&(P=Ma({inputs:{x:$},backend:i,attrs:{perm:[0,2,1]}}),k.push(P)),r&&(V=Ma({inputs:{x:_},backend:i,attrs:{perm:[0,2,1]}}),k.push(V));const z=p!==1,q=p===1;let G=P;z&&(G=Fe({inputs:{x:P},backend:i,attrs:{shape:[E,S,1]}}),k.push(G));const K=p===1?2:1;let Y=V;q&&(Y=Fe({inputs:{x:V},backend:i,attrs:{shape:[E,1,S]}}),k.push(Y));const te=fre({inputs:{a:G,b:Y},backend:i});F=R7({inputs:{x:te},backend:i,attrs:{axis:K,keepDims:!0}}),k.push(te)}else{const P=po(e.dtype,t.dtype),V=new qMe(w,C,[E,d,p],n,r,N,T,A,D),z=[$,_];if(s!=null&&z.push(s),A&&z.push(a),D){const q=i.makeTensorInfo([],"float32",tg(o,"float32"));z.push(q),k.push(q)}F=i.runWebGLProgram(V,z,P)}const R=Fe({inputs:{x:F},backend:i,attrs:{shape:x}});k.push(F);for(const P of k)i.disposeIntermediateTensorInfo(P);return R}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function STt(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s,bias:a,preluActivationWeights:o}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:f}=r;return G5({a:i,b:s,transposeA:l,transposeB:u,backend:n,bias:a,preluActivationWeights:o,leakyreluAlpha:f,activation:c})}const kTt={kernelName:hT,backendName:"webgl",kernelFunc:STt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C0e="return abs(x);";function ETt(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const s=n.texData.get(r.dataId),a=LMe(s.values);return n.makeTensorInfo(r.shape,r.dtype,a)}let i;return le().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new Qg(r.shape,C0e):i=new th(r.shape,C0e),n.runWebGLProgram(i,[r],r.dtype)}const ATt={kernelName:bN,backendName:"webgl",kernelFunc:ETt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TTt=Xu+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,DTt=nn({opSnippet:TTt}),NTt={kernelName:DC,backendName:"webgl",kernelFunc:DTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ITt=Xu+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,MTt=nn({opSnippet:ITt}),FTt={kernelName:NC,backendName:"webgl",kernelFunc:MTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _0e="return a + b;",OTt=ys({opSnippet:_0e,packedOpSnippet:_0e,supportsComplex:!0,cpuKernelImpl:HEt}),RTt={kernelName:Ub,backendName:"webgl",kernelFunc:OTt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PTt{constructor(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map((s,a)=>`T${a}`);const r=[];this.variableNames.forEach(s=>{r.push(`float v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LTt{constructor(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((s,a)=>`T${a}`);const r=[];this.variableNames.forEach(s=>{r.push(`vec4 v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a4(e){const{inputs:t,backend:n}=e,r=t;if(r.length===1)return ol({inputs:{x:r[0]},backend:n});if(r.length>le().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=a4({inputs:r.slice(0,l),backend:n}),c=a4({inputs:r.slice(l),backend:n});return a4({inputs:[u,c],backend:n})}const i=r.map(l=>l.dtype).reduce((l,u)=>po(l,u)),s=r.map(l=>l.shape),o=le().getBool("WEBGL_PACK")?new LTt(r[0].shape,s):new PTt(r[0].shape,s);return n.runWebGLProgram(o,r,i)}const BTt={kernelName:xN,backendName:"webgl",kernelFunc:a4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zTt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r,o=i.shape.length,l=Ot(s,i.shape);let u=l;const c=Fr(u,o);let f=i;c!=null&&(f=Ma({inputs:{x:i},backend:n,attrs:{perm:c}}),u=Jr(u.length,o)),vs("all",u,o);const[h,d]=Li(f.shape,u),p=de(d),g=Fe({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),m=Jb(g,g.dtype,"all",n);let v;if(a){const y=Zr(h,l);v=Fe({inputs:{x:m},backend:n,attrs:{shape:y}})}else v=Fe({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),c!=null&&n.disposeIntermediateTensorInfo(f),v}const UTt={kernelName:OB,backendName:"webgl",kernelFunc:zTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WTt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r,o=i.shape.length,l=Ot(s,i.shape);let u=l;const c=Fr(u,o);let f=i;c!=null&&(f=Ma({inputs:{x:i},backend:n,attrs:{perm:c}}),u=Jr(u.length,o)),vs("any",u,o);const[h,d]=Li(f.shape,u),p=de(d),g=Fe({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),m=Jb(g,g.dtype,"any",n);let v;if(a){const y=Zr(h,l);v=Fe({inputs:{x:m},backend:n,attrs:{shape:y}})}else v=Fe({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),c!=null&&n.disposeIntermediateTensorInfo(f),v}const VTt={kernelName:RB,backendName:"webgl",kernelFunc:WTt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jTt{constructor(t,n,r){this.variableNames=["A"];const{windowSize:i,batchSize:s,outSize:a}=t;r||this.variableNames.push("bestIndicesA"),this.outputShape=[s,a];const o=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${i};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${i}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HTt{constructor(t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,B(t.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const s=t[t.length-1],a=Math.ceil(s/n);this.outputShape=t.slice(0,-1),a>1&&this.outputShape.push(a),i||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,u=jn(l),c=ga("coords",l);let f,h;if(a===1){h=l+1;const _=jn(h);f=`
        ${_} sourceLocR = ${_}(${c.join()}, 0);
        ++${c[l-1]};
        ${_} sourceLocG = ${_}(${c.join()}, 0);
        ++${c[l-2]};
        ${_} sourceLocA = ${_}(${c.join()}, 0);
        --${c[l-1]};
        ${_} sourceLocB = ${_}(${c.join()}, 0);
        --${c[l-2]};`}else h=l,f=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const d=["x","y","z","w","u","v"].slice(0,h),p="."+d[h-1],g=d.map(_=>"int "+_),m=ga("sourceLocR",h-1).concat("inIdx.r"),v=ga("sourceLocG",h-1).concat("inIdx.g"),y=ga("sourceLocB",h-1).concat("inIdx.b"),b=ga("sourceLocA",h-1).concat("inIdx.a"),x=r==="max"?"greaterThan":"lessThan",w=i?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()})));`,C=`vec4(
            getAChannel(${m.join()}),
            hasNextCol ? getAChannel(${v.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,$=i?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${d.join()}),
                                          vec2(${d.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${d.join()}),
                               vec2(${d.slice(-2).join()}));
      }
      ${$}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${o[l-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${C};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${C};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${x}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YMe(e,t,n,r=null){let i=t.shape[0],s=t.shape[1];r!=null&&(i=r.shape[0],s=r.shape[1]);const a=y7(s),o={windowSize:a,inSize:s,batchSize:i,outSize:Math.ceil(s/a)},l=new jTt(o,n,r==null),u=[t];r!=null&&u.push(r);const c=e.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const f=YMe(e,t,n,c);return e.disposeIntermediateTensorInfo(c),f}function XMe(e,t,n,r=null){const i=r!=null?r.shape:t.shape,s=i[i.length-1],a=y7(s),o=new HTt(i,a,n,r==null),l=r==null?[t]:[t,r],u=e.runWebGLProgram(o,l,"int32");if(u.shape.length===t.shape.length){const c=XMe(e,t,n,u);return e.disposeIntermediateTensorInfo(u),c}return u}function KMe(e,t,n,r){const i=[n];if(vs("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!le().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const s=[],a=e.texData.get(t.dataId),o=a!==null&&a.isPacked;let l=t;o&&(l=e.unpackTensor(t),s.push(l));const[u,c]=Li(l.shape,i),f=de(c),h=Fe({inputs:{x:l},backend:e,attrs:{shape:[-1,f]}});s.push(h);const d=YMe(e,h,r);s.push(d);const p=Fe({inputs:{x:d},backend:e,attrs:{shape:u}});return s.forEach(g=>e.disposeIntermediateTensorInfo(g)),p}return XMe(e,t,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qTt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;let a=Ot(s,i.shape);const o=Fr(a,i.shape.length);let l=i;const u=[];o!=null&&(l=Ma({inputs:{x:i},backend:n,attrs:{perm:o}}),u.push(l),a=Jr(a.length,l.shape.length)),vs("argMax",[a[0]],l.shape.length);const c=KMe(n,l,a[0],"max");return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}const GTt={kernelName:wN,backendName:"webgl",kernelFunc:qTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YTt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;let a=Ot(s,i.shape);const o=Fr(a,i.shape.length);let l=i;const u=[];o!=null&&(l=Ma({inputs:{x:i},backend:n,attrs:{perm:o}}),u.push(l),a=Jr(a.length,l.shape.length)),vs("argMin",[a[0]],l.shape.length);const c=KMe(n,l,a[0],"min");return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}const XTt={kernelName:$N,backendName:"webgl",kernelFunc:YTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KTt=Xu+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,ZTt=nn({opSnippet:KTt}),QTt={kernelName:IC,backendName:"webgl",kernelFunc:ZTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JTt=Xu+"return log(x + sqrt(x * x + 1.0));",e3t=nn({opSnippet:JTt}),t3t={kernelName:MC,backendName:"webgl",kernelFunc:e3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n3t=Xu+`
  return atan(x);
`,r3t=nn({opSnippet:n3t}),i3t={kernelName:FC,backendName:"webgl",kernelFunc:r3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s3t=cre+`
  return atan(a, b);
`,a3t=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Qb+`
  return result;
`,o3t=ys({opSnippet:s3t,packedOpSnippet:a3t}),l3t={kernelName:RC,backendName:"webgl",kernelFunc:o3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u3t=Xu+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,c3t=nn({opSnippet:u3t}),f3t={kernelName:OC,backendName:"webgl",kernelFunc:c3t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MT{constructor(t,n,r,i=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const a=t.filterWidth,o=t.strideHeight,l=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,f=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const g=n==="avg",m=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,v=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let y="0.0";if(g||(y="-1.0 / 1e-20"),r){const _=">=";this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${d}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${_} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${i?s?m:v:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let x=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(x="avgValue / max(count, 1.0)");const w=Math.floor(a/4)*4,C=a%4,$=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${d}, ${p});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${w}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${$}
          }

          int xC = xCCorner + ${w};
          if (${C===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${C===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${C===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${$}
          }
        }
        setOutput(${x});
      }
    `}}class hre{constructor(t,n,r,i=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const a=t.filterWidth,o=t.strideDepth,l=t.strideHeight,u=t.strideWidth,c=t.dilationDepth,f=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,g=t.effectiveFilterWidth,m=t.padInfo.front,v=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const b=n==="avg";let x="0.0";if(b||(x="-1.0 / 1e-20"),r){const E=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${u});
        const ivec3 pads = ivec3(${m}, ${v}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${d};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${E} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${i?s?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${p} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / max(count, 1.0)");const $=Math.floor(a/4)*4,_=a%4,k=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${u});
      const ivec3 pads = ivec3(${m}, ${v}, ${y});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${$}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${k}
            }

            int xC = xCCorner + ${$};
            if (${_===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${_===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${_===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${k}
            }
          }
        }
        setOutput(${C});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h3t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;jI(i,"avgPool");const{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=r,u=1;B(ms(a,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const c=Gu(i.shape,s,a,u,o,l);if(c.filterWidth===1&&c.filterHeight===1&&Qt(c.inShape,c.outShape))return ol({inputs:{x:i},backend:n});const f=new MT(c,"avg",!1);return n.runWebGLProgram(f,[i],"float32")}const d3t={kernelName:CN,backendName:"webgl",kernelFunc:h3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p3t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:a,pad:o,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],f=ng(i.shape,s,a,c,o,l,u),h=new hre(f,"avg",!1);return n.runWebGLProgram(h,[i],"float32")}const g3t={kernelName:_N,backendName:"webgl",kernelFunc:p3t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m3t{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,s=t.strideWidth,a=t.dilationHeight,o=t.dilationWidth,l=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=l-1-t.padInfo.top,f=u-1-t.padInfo.left,h=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${f});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class v3t{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterDepth,r=t.filterHeight,i=t.filterWidth,s=t.strideDepth,a=t.strideHeight,o=t.strideWidth,l=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,f=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=f-1-t.padInfo.front,g=h-1-t.padInfo.top,m=d-1-t.padInfo.left,v=1/(n*r*i);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${g}, ${m});
      const float avgMultiplier = float(${v});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${s}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y3t(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,a=s,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=r,f=[1,1,1],h=ng(a.shape,o,l,f,u,c),d=new v3t(h);return n.runWebGLProgram(d,[i],a.dtype)}const b3t={kernelName:LB,backendName:"webgl",kernelFunc:y3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x3t(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,a=s;jI([i,s],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=r,c=Gu(a.shape,o,l,1,u),f=new m3t(c);return n.runWebGLProgram(f,[i],a.dtype)}const w3t={kernelName:PB,backendName:"webgl",kernelFunc:x3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $3t(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s}=t,{transposeA:a,transposeB:o}=r;return G5({a:i,b:s,transposeA:a,transposeB:o,backend:n})}const C3t={kernelName:SN,backendName:"webgl",kernelFunc:$3t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _3t{constructor(t,n,r,i,s,a){this.outputShape=[],this.variableNames=["x","mean","variance"],Ct(t,n),Ct(t,r);let o="0.0";i!=null&&(Ct(t,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";s!=null&&(Ct(t,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${a}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S3t{constructor(t,n,r,i,s,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ct(t,n),Ct(t,r);let o="vec4(0.0)";i!=null&&(Ct(t,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";s!=null&&(Ct(t,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${a}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k3t=({inputs:e,backend:t,attrs:n})=>{const{x:r,mean:i,variance:s,offset:a,scale:o}=e;B(i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),B(a==null||i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),B(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,i,s];let c=null;a!=null&&(c=a.shape,u.push(a));let f=null;o!=null&&(f=o.shape,u.push(o));const h=le().getBool("WEBGL_PACK_NORMALIZATION")?new S3t(r.shape,i.shape,s.shape,c,f,l):new _3t(r.shape,i.shape,s.shape,c,f,l);return t.runWebGLProgram(h,u,u[0].dtype)},E3t={kernelName:LN,backendName:"webgl",kernelFunc:k3t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A3t{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const n=jn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=T3t(this.rank);let i;const s=t.map((a,o)=>`sourceLoc.${aX[o]} = start[${o}] + coords.${aX[o]};`);i=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${s.join(`
`)}
      `,this.userCode=`
      void main() {
        ${i}
        setOutput(getSource(${r}));
      }
    `}}const aX=["x","y","z","w","u","v"];function T3t(e){if(e===1)return"sourceLoc";if(e<=6)return aX.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D3t{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=jn(this.rank),r=ga("coords",this.rank),i=ga("sourceLoc",this.rank),s=this.rank===1?"sourceLoc":`vec2(${i.slice(-2).join()})`,a=`getChannel(getSource(${i.join()}), ${s})`,o=`
      result.x = ${a};
      if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
        ++${i[this.rank-1]};
        result.y = ${a};
        --${i[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${t[this.rank-2]}) {
        ++${i[this.rank-2]};
        result.z = ${a};
        if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
          ++${i[this.rank-1]};
          result.w = ${a};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${t.map((c,f)=>`start[${f}]`).join()});`:t.map((c,f)=>`${i[f]} = ${r[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N3t(e,t,n,r){const i=r.texData.get(e.dataId),s=r.makeTensorInfo(n,e.dtype),a=r.texData.get(s.dataId);Object.assign(a,i),a.refCount=1,a.shape=n,a.dtype=e.dtype;let o=ine(t,Je(e.shape));i.slice&&(o+=i.slice.flatOffset),a.slice={flatOffset:o,origDataId:i.slice&&i.slice.origDataId||e.dataId};const l=r.dataRefCount.get(a.slice.origDataId)||1;return r.dataRefCount.set(a.slice.origDataId,l+1),s}function P_(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,size:a}=r,[o,l]=v7(i,s,a);if(tne(i,o,l),de(l)===0)return n.makeTensorInfo(l,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||i.dtype==="string"){const f=n.texData.get(i.dataId),h=CAt(f.values,o,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,h)}const{isPacked:u}=n.texData.get(i.dataId),c=rne(i.shape,o,l);if(u||!c){const f=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new D3t(l):new A3t(l),h=[o];return n.runWebGLProgram(f,[i],i.dtype,h)}return n.uploadToGPU(i.dataId),N3t(i,o,l,n)}const I3t={kernelName:dI,backendName:"webgl",kernelFunc:P_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M3t=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,crops:a}=r;B(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=s.reduce((y,b)=>y*b),l=NI(i.shape,s,o),u=II(l.length,s.length),c=MI(i.shape,s,o),f=cne(a,s.length),h=fne(c,a,s.length),d=[],p=Fe({inputs:{x:i},backend:n,attrs:{shape:l}}),g=Ma({inputs:{x:p},backend:n,attrs:{perm:u}}),m=Fe({inputs:{x:g},backend:n,attrs:{shape:c}}),v=P_({inputs:{x:m},backend:n,attrs:{begin:f,size:h}});return d.push(p),d.push(g),d.push(m),d.forEach(y=>n.disposeIntermediateTensorInfo(y)),v},F3t={kernelName:kN,backendName:"webgl",kernelFunc:M3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O3t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:a}=r,o=n.readSync(i.dataId),l=n.readSync(s.dataId),u=PMe(o,l,s.dtype,s.shape,a);return n.makeTensorInfo([a],s.dtype,u)}const R3t={kernelName:BB,backendName:"webgl",kernelFunc:O3t};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P3t=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,L3t=`
  return float(int(a.r) & int(b.r));
`;function B3t(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,s=le().getBool("WEBGL_PACK_BINARY_OPERATIONS"),a=le().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||a===1){const l=n.texData.get(r.dataId).values,u=n.texData.get(i.dataId).values,[c,f]=GEt(r.shape,i.shape,l,u,r.dtype),h=n.makeTensorInfo(f,r.dtype),d=n.texData.get(h.dataId);return d.values=c,h}let o;return s?o=new O_(P3t,r.shape,i.shape,!1):o=new Wy(L3t,r.shape,i.shape),n.runWebGLProgram(o,[r,i],r.dtype)}const z3t={kernelName:EN,backendName:"webgl",kernelFunc:B3t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U3t(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,s=n.readSync(r.dataId),a=n.readSync(i.dataId),o=Ct(Array.from(s),Array.from(a));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const W3t={kernelName:zB,backendName:"webgl",kernelFunc:U3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V3t="return float(a != b);",ZMe=ys({opSnippet:V3t,cpuKernelImpl:pAt,dtype:"bool"}),j3t={kernelName:tI,backendName:"webgl",kernelFunc:ZMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qI(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return ol({inputs:{x:i.complexTensorInfos.real},backend:n})}const H3t={kernelName:xz,backendName:"webgl",kernelFunc:qI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q3t="return float(int(x));";function G3t(e,t){const n=new th(e.shape,q3t),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oX(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:s}=r;if(s==="complex64"){if(i.dtype==="complex64")return ol({inputs:{x:i},backend:n});const a=di(i.shape),o=oX({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),l=Km({inputs:{real:o,imag:a},backend:n});return a.dispose(),n.disposeIntermediateTensorInfo(o),l}if(i.dtype==="complex64"){const a=qI({inputs:{input:i},backend:n}),o=oX({inputs:{x:a},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(a),o}if(!tte(i.dtype,s)){const a=ol({inputs:{x:i},backend:n});return{dataId:a.dataId,shape:a.shape,dtype:s}}if(n.shouldExecuteOnCPU([i])){const a=n.texData.get(i.dataId).values,[o,l,u]=YEt(a,i.shape,i.dtype,s);return n.makeTensorInfo(o,l,u)}if(s==="int32")return G3t(i,n);if(s==="bool"){const a=n.makeTensorInfo([],"bool",Fi("bool",1)),l=ZMe({inputs:{a:i,b:a},backend:n});return n.disposeIntermediateTensorInfo(a),l}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${s}`)}const Y3t={kernelName:PC,backendName:"webgl",kernelFunc:oX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S0e="return ceil(x);",X3t=nn({opSnippet:S0e,packedOpSnippet:S0e,cpuKernelImpl:XEt}),K3t={kernelName:LC,backendName:"webgl",kernelFunc:X3t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z3t{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q3t{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J3t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{clipValueMin:s,clipValueMax:a}=r;let o;le().getBool("WEBGL_PACK_CLIP")?o=new Q3t(i.shape):o=new Z3t(i.shape);const l=[[s],[a]];return n.runWebGLProgram(o,[i],i.dtype,l)}const eDt={kernelName:BC,backendName:"webgl",kernelFunc:J3t};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tDt{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k0e(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function nDt(e){const{inputs:t,backend:n}=e,{x:r}=t,i=n.texData.get(r.dataId),s=new tDt(r.shape),a=[k0e(r,i.complexTensorInfos.real),k0e(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(s,a,a[0].dtype)}const rDt={kernelName:AN,backendName:"webgl",kernelFunc:nDt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iDt{constructor(t){this.outputShape=[],this.outputShape=sh(t,1),this.variableNames=t.map((a,o)=>`T${o}`);const n=new Array(t.length-1);n[0]=t[0][1];for(let a=1;a<n.length;a++)n[a]=n[a-1]+t[a][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let a=1;a<n.length;a++){const o=n[a-1];r.push(`else if (yC < ${n[a]}) setOutput(getT${a}(yR, yC-${o}));`)}const i=n.length,s=n[n.length-1];r.push(`else setOutput(getT${i}(yR, yC-${s}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sDt{constructor(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=sh(t,n);const r=this.outputShape,i=r.length,s=jn(i),a=ga("coords",i),o=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((g,m)=>`T${m}`);const l=new Array(t.length-1);l[0]=t[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+t[g][n];const u=o[n],c=o.slice(-2),f=o.join();let h=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${f}), vec2(${c.join()}));
        }`;for(let g=1;g<l.length;g++){const m=l[g-1];h+=`
        if (${u} < ${l[g]}  && ${u} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${mO(o,u,m)}),
            vec2(${mO(c,u,m)}));
        }`}const d=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${d}(${mO(o,u,p)}),
          vec2(${mO(c,u,p)}));`,this.userCode=`
      float getValue(${o.map(g=>"int "+g)}) {
        ${h}
      }

      void main() {
        ${s} coords = getOutputCoords();
        vec4 result = vec4(getValue(${a}), 0., 0., 0.);

        ${a[i-1]} = ${a[i-1]} + 1;
        if (${a[i-1]} < ${r[i-1]}) {
          result.g = getValue(${a});
        }

        ${a[i-2]} = ${a[i-2]} + 1;
        if (${a[i-2]} < ${r[i-2]}) {
          result.a = getValue(${a});
        }

        ${a[i-1]} = ${a[i-1]} - 1;
        if (${a[i-2]} < ${r[i-2]} &&
            ${a[i-1]} < ${r[i-1]}) {
          result.b = getValue(${a});
        }
        setOutput(result);
      }
    `}}function mO(e,t,n){const r=e.indexOf(t);return e.map((s,a)=>a===r?`${s} - ${n}`:s).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P7(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return ol({inputs:{x:i.complexTensorInfos.imag},backend:n})}const aDt={kernelName:az,backendName:"webgl",kernelFunc:P7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uE(e,t,n){const r=e[0].dtype;if(r==="complex64"){const d=e.map(y=>qI({inputs:{input:y},backend:n})),p=e.map(y=>P7({inputs:{input:y},backend:n})),g=uE(d,t,n),m=uE(p,t,n),v=Km({inputs:{real:g,imag:m},backend:n});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),p.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),v}let i=n.shouldExecuteOnCPU(e);if(r==="string"&&(i=!0),i){const d=e.map(x=>{const C=[-1,de(x.shape.slice(t))];return Fe({inputs:{x},backend:n,attrs:{shape:C}})}),p=d.map(x=>({vals:n.readSync(x.dataId),shape:x.shape})),g=sh(d.map(x=>x.shape),1),m=d[0].shape[0]===1,v=KEt(p,g,r,m),y=sh(e.map(x=>x.shape),t),b=n.makeTensorInfo(y,r,v);return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),b}const s=e.filter(d=>de(d.shape)>0),a=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(s.length===1){const d=a?new th(e[0].shape,Pg):new Qg(e[0].shape,Pg);return n.runWebGLProgram(d,e,r)}const o=le().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>o){const d=[];for(let g=0;g<s.length;g+=o){const m=s.slice(g,g+o);d.push(uE(m,t,n))}const p=uE(d,t,n);for(const g of d)n.disposeIntermediateTensorInfo(g);return p}if(a){const d=new sDt(s.map(p=>p.shape),t);return n.runWebGLProgram(d,s,r)}const{tensors2D:l,outShape:u}=oDt(s,t,n),c=new iDt(l.map(d=>d.shape)),f=n.runWebGLProgram(c,l,r);l.forEach(d=>n.disposeIntermediateTensorInfo(d));const h=Fe({inputs:{x:f},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(f),h}function oDt(e,t,n){const r=sh(e.map(s=>s.shape),t);return{tensors2D:e.map(s=>Fe({inputs:{x:s},attrs:{shape:[-1,de(s.shape.slice(t))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QMe(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,s=Ot(i,t[0].shape)[0],a=t.map(u=>u.shape);one(a,s);const o=sh(t.map(u=>u.shape),s);if(de(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);const l=t.filter(u=>de(u.shape)>0);return l.length===1?ol({inputs:{x:l[0]},backend:n}):uE(l,s,n)}const lDt={kernelName:TN,backendName:"webgl",kernelFunc:QMe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JMe{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const a=t.padInfo.top,o=t.padInfo.left,l=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,f=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,p=Math.floor(t.inChannels/4)*4,g=t.inChannels%4,m=t.dataFormat==="channelsLast",v=m?1:2,y=m?2:3,b=m?3:1;let x="",w="";r&&(i?x=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?x=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:x=`
          float activation(float x) {
            ${r}
          }
        `,w="result = activation(result);");const C=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${x}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${v}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${d}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${m}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${m}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${m}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${m}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${C}
        ${w}
        setOutput(result);
      }
    `}}class uDt{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const n=t.padInfo.front,r=t.padInfo.top,i=t.padInfo.left,s=t.strideDepth,a=t.strideHeight,o=t.strideWidth,l=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,f=t.filterDepth,h=t.filterHeight,d=t.filterWidth,p=Math.floor(t.inChannels/4)*4,g=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${s}, ${a}, ${o});
      const ivec3 pads = ivec3(${n}, ${r}, ${i});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eFe{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Ks(this.outputShape.length);const a=t.padInfo.left,o=t.strideWidth,l=t.dilationWidth,u=t.filterHeight,c=t.filterWidth,f=c;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<c;m++)h+=`
           vec4 xTexelC${m*2};
           int xTexelC${m*2}Ready;
           vec4 xTexelC${m*2+1};
           int xTexelC${m*2+1}Ready;
           vec4 xC${m};`;h+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {
       `;for(let m=0;m<c;m++)h+=`
           xTexelC${m*2} = vec4(0.0);
           xTexelC${m*2}Ready = 0;
           xTexelC${m*2+1} = vec4(0.0);
           xTexelC${m*2+1}Ready = 0;
           xC${m} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let m=0;m<(f+1)/2;m++){const v=m*2;if(h+=`
           xC = xCCorner + ${v*l};
           `,o===1){if(v<c&&(a%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }
               `,l===1&&v>0?h+=`
                 xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                   } else {
                     xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 xC${v} = xTexelC${v};
                 `,v+1<c)){const y=a%2===0?IB(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                     xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${v+1}.zw = vec2(0.0);
                     }
                     xTexelC${v+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                     } else {
                      xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                     }
                     `:h+=`
                     xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                     `):y===1?h+=`
                     xC${v+1} = xTexelC${v};
                     `:h+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                       xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${v+1}.zw = vec2(0.0);
                       }
                       xTexelC${v+1}Ready = 1;
                     }

                     xC${v+1} = xTexelC${v+1};
                     `}}else v<c&&(a%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                   xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${v+1}.zw = vec2(0.0);
                   }
                   xTexelC${v+1}Ready = 1;
                 }

                 xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
               `,v+1<c&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                   xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v+1}.zw = vec2(0.);
                   }
                   xTexelC${v+1}Ready = 1;
                 }

                 xC${v} = vec4(
                   xTexelC${v}.xy, xTexelC${v+1}.xy);
               `,v+1<c&&(h+=`
                   xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                 `)));v<c&&(h+=`
             wTexel = getW(r, ${v}, d1, d2);
             dotProd += xC${v}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${t.inChannels}) {
               dotProd += xC${v}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,v+1<c&&(h+=`
               wTexel = getW(r, ${v+1}, d1, d2);
               dotProd += xC${v+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${t.inChannels}) {
                 dotProd += xC${v+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let d="",p="";r&&(i?d=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:s?d=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:d=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${d}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cDt{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=Ks(this.outputShape.length);const{dataFormat:r}=n,i=Ba(),s=r==="channelsLast",a=s?1:2,o=s?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let f=0;f<=1;f++)u+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${a}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${s}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${i.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y5(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function tFe({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:o=null}){const l=e.shape,u=r.texData.get(e.dataId),c=n.inChannels,f=l[0]*l[1]*l[2],h=n.outChannels,d=n.dataFormat==="channelsLast",p=!1,g=!1;let m;const v=[];if(s!=null){const x=Y5(s.shape,d);x!=null&&(s=Fe({inputs:{x:s},backend:r,attrs:{shape:x}}),v.push(s))}if(i!=null){const x=Y5(i.shape,d);x!=null&&(i=Fe({inputs:{x:i},backend:r,attrs:{shape:x}}),v.push(i))}if(!((f===1||h===1)&&c>GMe)&&u.isPacked&&d&&u.texture!=null&&l[2]%2!==0&&Qt(u.shape.slice(-3),l.slice(-3))){const x=l[0]*l[1]*(l[2]+1),w={dataId:e.dataId,shape:[1,x,n.inChannels],dtype:e.dtype},C=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,B(q5(u.shape,w.shape),()=>`packed reshape ${u.shape} to ${w.shape} isn't free`);const $=Fe({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});v.push($);const _=G5({a:w,b:$,backend:r,transposeA:p,transposeB:g,bias:i,activation:o,preluActivationWeights:s,leakyreluAlpha:a}),k=r.texData.get(_.dataId);B(k.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=C,k.shape=n.outShape,m=ol({inputs:{x:_},backend:r}),m.shape=n.outShape,v.push(_)}else{const x=n.outHeight*n.outWidth,w=Fe({inputs:{x:e},backend:r,attrs:{shape:d?[n.batchSize,x,n.inChannels]:[n.batchSize,n.inChannels,x]}}),C=Fe({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),$=G5({a:d?w:C,b:d?C:w,transposeA:!d,transposeB:g,backend:r,bias:i,activation:o,preluActivationWeights:s,leakyreluAlpha:a});m=Fe({inputs:{x:$},backend:r,attrs:{shape:n.outShape}}),v.push(w),v.push(C),v.push($)}for(const x of v)r.disposeIntermediateTensorInfo(x);return m}function nFe({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:o=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:f,outHeight:h,dataFormat:d}=n,p=d==="channelsLast",g=l*u*c,m=h*f,v=[n.batchSize,g,m],y=!0,b=!1,x=[];if(s!=null){const R=Y5(s.shape,p);R!=null&&(s=Fe({inputs:{x:s},backend:r,attrs:{shape:R}}),x.push(s))}if(i!=null){const R=Y5(i.shape,p);R!=null&&(i=Fe({inputs:{x:i},backend:r,attrs:{shape:R}}),x.push(i))}const w=Fe({inputs:{x:t},backend:r,attrs:{shape:[1,g,de(t.shape)/g]}});x.push(w);const C=new cDt(v,n),$=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],_=r.runWebGLProgram(C,[e],"float32",$),k=Fe({inputs:{x:_},backend:r,attrs:{shape:v}});x.push(_),x.push(k);const E=i!=null,S=s!=null,N=o==="leakyrelu",A=o?IT(o,!0):null,D=new qMe(p?k.shape:w.shape,p?w.shape:k.shape,p?[n.batchSize,m,n.outChannels]:[n.batchSize,n.outChannels,m],y,b,E,A,S,N),T=p?[k,w]:[w,k];if(i&&T.push(i),S&&T.push(s),N){const R=r.makeTensorInfo([],"float32",tg(a,"float32"));T.push(R),x.push(R)}const I=r.runWebGLProgram(D,T,"float32"),F=Fe({inputs:{x:I},backend:r,attrs:{shape:n.outShape}});x.push(I);for(const R of x)r.disposeIntermediateTensorInfo(R);return F}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=r,f=rg(l),h=Pi(i.shape,s.shape,a,u,o,c,!1,f);let d;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))d=tFe({x:i,filter:s,convInfo:h,backend:n});else if(h.strideWidth<=2&&f==="channelsLast"&&le().getBool("WEBGL_EXP_CONV")){const g=new eFe(h),m=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];d=n.runWebGLProgram(g,[i,s],"float32",m)}else if(le().getBool("WEBGL_CONV_IM2COL"))d=nFe({x:i,filter:s,convInfo:h,backend:n});else{const g=new JMe(h);d=n.runWebGLProgram(g,[i,s],"float32")}const p=Fe({inputs:{x:d},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(d),p}const hDt={kernelName:DN,backendName:"webgl",kernelFunc:fDt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dDt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,s=t.padInfo.left,a=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              ${a?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class pDt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,s=t.strideWidth,a=t.dataFormat==="channelsLast",o=n-1-t.padInfo.top,l=r-1-t.padInfo.left,u=a?1:2,c=a?2:3,f=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${a}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class gDt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideDepth,r=t.strideHeight,i=t.strideWidth,s=t.padInfo.front,a=t.padInfo.top,o=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${s};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${a};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${i} - ${o};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class mDt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterDepth,r=t.filterHeight,i=t.filterWidth,s=t.strideDepth,a=t.strideHeight,o=t.strideWidth,l=n-1-t.padInfo.front,u=r-1-t.padInfo.top,c=i-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${s}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${i}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${i} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:a,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,f=rg(l),h=Pi(i.shape,c,a,1,o,u,!1,f),d=new dDt(h);return n.runWebGLProgram(d,[i,s],"float32")}const yDt={kernelName:WB,backendName:"webgl",kernelFunc:vDt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bDt{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=Ks(this.outputShape.length);const n=t.filterHeight,r=t.filterWidth,i=n-1-t.padInfo.top,s=r-1-t.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xDt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{inputShape:a,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=r,f=rg(u),h=Pi(a,s.shape,o,1,l,c,!1,f);if(le().getBool("WEBGL_PACK")&&f==="channelsLast"){const d=[[h.strideHeight,h.strideWidth]],p=new bDt(h);return n.runWebGLProgram(p,[i,s],"float32",d)}else{const d=new pDt(h);return n.runWebGLProgram(d,[i,s],"float32")}}const wDt={kernelName:NN,backendName:"webgl",kernelFunc:xDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Dt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dilations:l}=r,u=Vm(i.shape,s.shape,a,l,o),c=new uDt(u);return n.runWebGLProgram(c,[i,s],"float32")}const CDt={kernelName:IN,backendName:"webgl",kernelFunc:$Dt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Dt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:a,pad:o,filterShape:l}=r,u=Vm(i.shape,l,a,1,o),c=new gDt(u);return n.runWebGLProgram(c,[i,s],"float32")}const SDt={kernelName:VB,backendName:"webgl",kernelFunc:_Dt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kDt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{pad:a,strides:o,inputShape:l}=r,u=Vm(l,s.shape,o,1,a),c=new mDt(u);return n.runWebGLProgram(c,[i,s],"float32")}const EDt={kernelName:jB,backendName:"webgl",kernelFunc:kDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ADt=R_+`
  return cos(x);
`,TDt=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Qb}
  return result;
`,DDt=nn({opSnippet:ADt,packedOpSnippet:TDt}),NDt={kernelName:zC,backendName:"webgl",kernelFunc:DDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IDt=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,MDt=nn({opSnippet:IDt}),FDt={kernelName:UC,backendName:"webgl",kernelFunc:MDt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ODt{constructor(t,n,r,i,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,o,l,u]=t,[c]=n,[f,h]=r;this.outputShape=[c,f,h,u];const d=i==="bilinear"?1:0,[p,g]=[`${o-1}.0`,`${l-1}.0`],[m,v,y]=f>1?[`${(o-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,x,w]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${m});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${a}) {
          return;
        }

        float height_scale = ${v};
        float width_scale = ${x};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${s}));
          return;
        }
        float in_x = ${w};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${s}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${d} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RDt=e=>{const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:s,boxInd:a}=t,{cropSize:o,method:l,extrapolationValue:u}=r,c=new ODt(i.shape,s.shape,o,l,u);return n.runWebGLProgram(c,[i,s,a],"float32")},PDt={kernelName:qB,backendName:"webgl",kernelFunc:RDt};var FT;(function(e){e.Prod="*",e.Sum="+"})(FT||(FT={}));class E0e{constructor(t,n,r,i){this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const s=this.outputShape.length,a=this.op===FT.Prod?"1.0":"0.0",o=r?a:`getX(${A0e(s,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=i?`end != ${l-1}`:"end != 0",c=i?"end + 1":"end - 1"):(u=i?`end + pow2 < ${l}`:"end >= pow2",c=i?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${jn(s)} coords = getOutputCoords();
        int end = ${T0e(s,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${T0e(s,"coords",this.op)} = idx;
          val ${this.op}= getX(${A0e(s,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function A0e(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function T0e(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rFe(e,t,n,r,i,s){const a=t.shape.length,o=Fr([r],a);let l=t;o!=null&&(l=Ma({inputs:{x:t},backend:n,attrs:{perm:o}}));const u=Jr(1,a)[0];if(u!==a-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);const c=l.shape[u];let f=ol({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){const d=new E0e(e,l.shape,!1,s),p=[[h]],g=f;f=n.runWebGLProgram(d,[f],f.dtype,p),n.disposeIntermediateTensorInfo(g)}if(i){const h=new E0e(e,l.shape,i,s),d=f;f=n.runWebGLProgram(h,[f],f.dtype),n.disposeIntermediateTensorInfo(d)}if(o!=null){const h=jm(o),d=Ma({inputs:{x:f},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(l),d}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:a,reverse:o}=r;return rFe(FT.Prod,i,n,s,a,o)}const BDt={kernelName:HB,backendName:"webgl",kernelFunc:LDt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:a,reverse:o}=r;return rFe(FT.Sum,i,n,s,a,o)}const UDt={kernelName:MN,backendName:"webgl",kernelFunc:zDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:a,binaryOutput:o}=r;if(i.shape.length===1){const l=n.readSync(i.dataId),u=n.readSync(s.dataId),c=PMe(l,u,s.dtype,s.shape,a);return n.makeTensorInfo([a],s.dtype,c)}else if(i.shape.length===2){const l=n.bufferSync(i),u=n.bufferSync(s),c=qEt(l,u,a,o);return n.makeTensorInfo(c.shape,s.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const VDt={kernelName:GB,backendName:"webgl",kernelFunc:WDt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jDt{constructor(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:s,dataFormat:a}=r,o=i.shape[0],l=a==="NHWC"?i.shape[1]:i.shape[2],u=a==="NHWC"?i.shape[2]:i.shape[3],c=a==="NHWC"?i.shape[3]:i.shape[1],f=l*s,h=u*s,d=c/(s*s),p=a==="NHWC"?[o,f,h,d]:[o,d,f,h],g=new jDt(p,s,a);return n.runWebGLProgram(g,[i],i.dtype)}const qDt={kernelName:YB,backendName:"webgl",kernelFunc:HDt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iFe{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Ks(this.outputShape.length);const a=t.filterHeight,o=t.filterWidth,l=t.outChannels/t.inChannels;let u="",c="";r&&(i?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const f=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${a}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sFe{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Ks(this.outputShape.length);const a=t.outChannels/t.inChannels,o=t.padInfo.left,l=t.strideWidth,u=t.dilationWidth,c=t.filterHeight,f=t.filterWidth,h=f;let d=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<f;v++)d+=`
          vec4 xTexelC${v*2};
          int xTexelC${v*2}Ready;
          vec4 xTexelC${v*2+1};
          int xTexelC${v*2+1}Ready;
          vec4 xC${v};`;d+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let v=0;v<f;v++)d+=`
          xTexelC${v*2} = vec4(0.0);
          xTexelC${v*2}Ready = 0;
          xTexelC${v*2+1} = vec4(0.0);
          xTexelC${v*2+1}Ready = 0;
          xC${v} = vec4(0.0);`;d+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let v=0;v<(h+1)/2;v++){const y=v*2;if(d+=`
          xC = xCCorner + ${y*u};
          `,l===1){if(y<f&&(o%2===1?(d+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,u===1&&y>0?d+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:d+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):d+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<f)){const b=o%2===0?IB(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(d+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,u>1?d+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:d+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):b===1?d+=`
                    xC${y+1} = xTexelC${y};
                    `:d+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<f&&(o%2===1?(d+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<f&&(d+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(d+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<f&&(d+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<f&&(d+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<f&&(d+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}d+=`
    }
  `,d+=`
      }
    `;let p="",g="";r&&(i?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,g="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${a};
        int q = d2 - d1 * ${a};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${d}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${m}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),B(ms(a,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const f=Pi(i.shape,s.shape,a,c,o,u,!0);let h;le().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?h=new sFe(f):h=new iFe(f);const d=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return n.runWebGLProgram(h,[i,s],"float32",d)}const YDt={kernelName:FN,backendName:"webgl",kernelFunc:GDt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XDt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,s=t.padInfo.left,a=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${a} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class KDt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,s=t.strideWidth,a=n-1-t.padInfo.top,o=r-1-t.padInfo.left,l=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:a,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=r,f=Pi(i.shape,c,a,o,l,u,!0),h=new XDt(f);return n.runWebGLProgram(h,[i,s],"float32")}const QDt={kernelName:XB,backendName:"webgl",kernelFunc:ZDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JDt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{strides:a,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=r,f=Pi(c,s.shape,a,o,l,u,!0),h=new KDt(f);return n.runWebGLProgram(h,[i,s],"float32")}const eNt={kernelName:KB,backendName:"webgl",kernelFunc:JDt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tNt{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nNt(e){const{inputs:t,backend:n}=e,{x:r}=t,i=[...r.shape,...r.shape],s=de(r.shape),a=Fe({inputs:{x:r},backend:n,attrs:{shape:[s]}}),o=new tNt(s),l=n.runWebGLProgram(o,[a],a.dtype),u=Fe({inputs:{x:l},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const rNt={kernelName:ZB,backendName:"webgl",kernelFunc:nNt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iNt{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:n,inWidth:r,padInfo:i,strideHeight:s,strideWidth:a,filterHeight:o,filterWidth:l,dilationHeight:u,dilationWidth:c}=t,{top:f,left:h}=i;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${a});
      const ivec2 pads = ivec2(${f}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sNt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dilations:l}=r,u=_I(i.shape,s.shape,a,o,"NHWC",l);let c;const f=new iNt(u);c=n.runWebGLProgram(f,[i,s],"float32");const h=Fe({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),h}const aNt={kernelName:ON,backendName:"webgl",kernelFunc:sNt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oNt(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,s=t,{allDims:a,summedDims:o,idDims:l}=bne(i,s.length);wne(a.length,l,s);const{path:u,steps:c}=$ne(o,l),f=c.length;let h=null,d=a.length;const p=[];for(let g=0;g<f;++g){for(const m of c[g]){const{permutationIndices:v,expandDims:y}=xne(d,l[m]);let b;Cne(v)?b=s[m]:(b=Ma({inputs:{x:s[m]},backend:n,attrs:{perm:v}}),p.push(b));const x=b.shape.slice();for(let w=0;w<y.length;++w)x.splice(y[w],0,1);Qt(b.shape,x)||(b=Fe({inputs:{x:b},backend:n,attrs:{shape:x}}),p.push(b)),h===null?h=b:(h=fre({inputs:{a:b,b:h},backend:n}),p.push(h))}g<f-1&&(u[g]>=0&&(h=R7({inputs:{x:h},backend:n,attrs:{axis:u[g]-(a.length-d),keepDims:!1}}),p.push(h)),d--)}for(const g of p)g!==h&&n.disposeIntermediateTensorInfo(g);return h}const lNt={kernelName:JB,backendName:"webgl",kernelFunc:oNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uNt="return (x >= 0.0) ? x : (exp(x) - 1.0);",cNt=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,fNt=nn({opSnippet:uNt,packedOpSnippet:cNt}),hNt={kernelName:VC,backendName:"webgl",kernelFunc:fNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dNt="return (b >= 0.0) ? a : a * (b + 1.0);",pNt=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,gNt=e=>{const{inputs:t,backend:n}=e,{dy:r,y:i}=t,s=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new O_(pNt,r.shape,i.shape):new Wy(dNt,r.shape,i.shape);return n.runWebGLProgram(s,[r,i],r.dtype)},mNt={kernelName:ez,backendName:"webgl",kernelFunc:gNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vNt=`
  return vec4(equal(a, b));
`,yNt="return float(a == b);",bNt=ys({opSnippet:yNt,packedOpSnippet:vNt,dtype:"bool",cpuKernelImpl:ZEt}),xNt={kernelName:RN,backendName:"webgl",kernelFunc:bNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wNt=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${hne};
  float a1 = ${dne};
  float a2 = ${pne};
  float a3 = ${gne};
  float a4 = ${mne};
  float a5 = ${vne};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,$Nt=nn({opSnippet:wNt}),CNt={kernelName:jC,backendName:"webgl",kernelFunc:$Nt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Nt=R_+`
  return exp(x);
`,SNt=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,aFe=nn({opSnippet:_Nt,packedOpSnippet:SNt,cpuKernelImpl:QEt,dtype:"float32"}),kNt={kernelName:HC,backendName:"webgl",kernelFunc:aFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lX(e){const{inputs:t,attrs:n,backend:r}=e,{dim:i}=n,{input:s}=t,a=s.shape.length,o=s.shape.slice();let l=i;return i<0&&(B(-(a+1)<=i,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+i+1),o.splice(l,0,1),Fe({inputs:{x:s},backend:r,attrs:{shape:o}})}const ENt={kernelName:PN,backendName:"webgl",kernelFunc:lX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D0e="return exp(x) - 1.0;",ANt=nn({opSnippet:D0e,packedOpSnippet:D0e,cpuKernelImpl:JEt}),TNt={kernelName:qC,backendName:"webgl",kernelFunc:ANt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N0e{constructor(t,n,r){this.variableNames=["real","imag"];const i=n[1];this.outputShape=n;const s=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,a=r?`${i}.0`:"1.0";let o;if(t==="real")o="return real * expR - imag * expI;";else if(t==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${s};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${i});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${i}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${a};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oFe(e,t,n){const r=n.texData.get(e.dataId),i=de(e.shape),s=e.shape[e.shape.length-1],a=i/s,o=Fe({inputs:{x:e},backend:n,attrs:{shape:[a,s]}}),l=o.shape,u=new N0e("real",l,t),c=new N0e("imag",l,t),f=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(u,f,"float32"),d=n.runWebGLProgram(c,f,"float32"),p=Km({inputs:{real:h,imag:d},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d);const g=Fe({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(p),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DNt(e){const{inputs:t,backend:n}=e,{input:r}=t;return oFe(r,!1,n)}const NNt={kernelName:tz,backendName:"webgl",kernelFunc:DNt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class INt{constructor(t,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GI(e){const{backend:t,attrs:n}=e,{shape:r,value:i}=n;let{dtype:s}=n;if(s=s||Bb(i),s==="string"){const a=Br(s,de(r));return a.fill(i),t.makeTensorInfo(r,s,a)}else{const a=new INt(r,i),o=[[i]];return t.runWebGLProgram(a,[],s,o)}}const MNt={kernelName:nz,backendName:"webgl",kernelFunc:GI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FNt{constructor(t){this.variableNames=["Image"],this.outputShape=[];const n=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ONt={kernelName:rz,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{const{image:n}=e,r=t,i=new FNt(n.shape);return r.runWebGLProgram(i,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I0e="return floor(x);",RNt=nn({opSnippet:I0e,packedOpSnippet:I0e,cpuKernelImpl:eAt}),PNt={kernelName:GC,backendName:"webgl",kernelFunc:RNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LNt=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,BNt=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,zNt=ys({opSnippet:LNt,packedOpSnippet:BNt,dtype:"int32"}),UNt={kernelName:YC,backendName:"webgl",kernelFunc:zNt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WNt{constructor(t){this.variableNames=["A"];const n=Ba(),[r,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VNt{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Ba(),[r,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${i}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jNt={kernelName:S5,backendName:"webgl",kernelFunc:HNt};let t2,Sj=le().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function HNt(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:i}=t;const{numChannels:s}=r,a=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,[l,u]=a?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=[u,l],f=[u,l,s];if(o||a){const g=le().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(t2==null||g!==Sj)&&(Sj=g,t2=document.createElement("canvas").getContext("2d",{willReadFrequently:Sj})),t2.canvas.width=l,t2.canvas.height=u,t2.drawImage(i,0,0,l,u),i=t2.canvas}const h=n.makeTensorInfo(c,"int32");n.texData.get(h.dataId).usage=Nl.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),i);const d=le().getBool("WEBGL_PACK")?new VNt(f):new WNt(f),p=n.runWebGLProgram(d,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qNt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:a,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r,g=rg(c),m=Pi(i.shape,s.shape,l,f,u,h,!1,g);let v;const y=[],b=a!=null,x=o!=null,w=d==="leakyrelu",C=()=>{const _=[i,s],k=(E,S)=>{if(S==="NCHW"&&E.shape.length===1&&E.shape[0]!==1){const N=Fe({inputs:{x:E},backend:n,attrs:{shape:[E.shape[0],1,1]}});return y.push(N),N}return E};if(b&&_.push(k(a,c)),x&&_.push(k(o,c)),w){const E=n.makeTensorInfo([],"float32",tg(p,"float32"));_.push(E),y.push(E)}return _};if(m.filterHeight===1&&m.filterWidth===1&&m.dilationHeight===1&&m.dilationWidth===1&&m.strideHeight===1&&m.strideWidth===1&&(m.padInfo.type==="SAME"||m.padInfo.type==="VALID"))v=tFe({x:i,filter:s,convInfo:m,backend:n,bias:a,activation:d,preluActivationWeights:o,leakyreluAlpha:p});else if(m.strideWidth<=2&&g==="channelsLast"&&le().getBool("WEBGL_EXP_CONV")){const _=d?IT(d,!0):null,k=new eFe(m,b,_,x,w),E=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],S=C();v=n.runWebGLProgram(k,S,"float32",E)}else if(le().getBool("WEBGL_CONV_IM2COL"))v=nFe({x:i,filter:s,convInfo:m,backend:n,bias:a,activation:d,preluActivationWeights:o,leakyreluAlpha:p});else{const _=d?IT(d,!1):null,k=new JMe(m,b,_,x,w),E=C();v=n.runWebGLProgram(k,E,"float32")}const $=Fe({inputs:{x:v},backend:n,attrs:{shape:m.outShape}});return y.push(v),y.forEach(_=>n.disposeIntermediateTensorInfo(_)),$}const GNt={kernelName:dT,backendName:"webgl",kernelFunc:qNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YNt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:a,preluActivationWeights:o}=t,{strides:l,pad:u,dilations:c,dimRoundingMode:f,activation:h,leakyreluAlpha:d}=r,p=[];let g=c;g==null&&(g=[1,1]),B(ms(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const m=Pi(i.shape,s.shape,l,g,u,f,!0),v=le().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1,y=h?IT(h,v):null,b=[i,s],x=a!=null,w=o!=null,C=h==="leakyrelu";if(x&&b.push(a),w&&b.push(o),C){const E=n.makeTensorInfo([],"float32",tg(d,"float32"));b.push(E),p.push(E)}let $;v?$=new sFe(m,x,y,w,C):$=new iFe(m,x,y,w,C);const _=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],k=n.runWebGLProgram($,b,"float32",_);return p.forEach(E=>n.disposeIntermediateTensorInfo(E)),k}const XNt={kernelName:pT,backendName:"webgl",kernelFunc:YNt};class KNt{constructor(t,n,r,i){this.sliceDim=t,this.strides=n,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=r;const s=jn(r.length);let a=`
    int index;`;for(let o=0;o<this.sliceDim;o++)a+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${s} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${a}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZNt(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,s=i.shape,a=s[s.length-1],o=de(r.shape),[l,u,c,f]=m7(r,i),h=Fe({inputs:{x:i},backend:n,attrs:{shape:[u,a]}}),d=Fe({inputs:{x:r},backend:n,attrs:{shape:[de(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const v=n.readSync(i.dataId),y=n.bufferSync(r),b=tAt(v,y,r.dtype,u,a,c,f,r.shape,o);return n.makeTensorInfo(l,r.dtype,b.values)}const p=new KNt(a,f,[u,c],r.shape),g=n.runWebGLProgram(p,[d,h],d.dtype),m=Fe({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(g),m}const QNt={kernelName:iz,backendName:"webgl",kernelFunc:ZNt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JNt{constructor(t,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=jn(this.rank),i=eIt(t);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${i}));
      }
    `}}function eIt(e,t){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<e.length;i++)i===2?r.push("index"):r.push(`${n[i]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lFe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:s}=t,{axis:a,batchDims:o}=r,l=Ot(a,i.shape)[0];if(le().get("DEBUG")){const y=n.readSync(s.dataId),b=i.shape[l];for(let x=0;x<y.length;++x){const w=y[x];B(w<=b-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${b-1}]`)}}const u=Sne(i,s,l,o),c=de(s.shape),f=[],h=Fe({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),d=Fe({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});f.push(h),f.push(d);const p=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([i,s])||i.dtype==="string"){const y=n.bufferSync(d),b=n.bufferSync(h),x=nAt(b,y,p);return f.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(u.outputShape,x.dtype,x.values)}const g=new JNt(h.shape,p),m=n.runWebGLProgram(g,[h,d],h.dtype);f.push(m);const v=Fe({inputs:{x:m},backend:n,attrs:{shape:u.outputShape}});return f.forEach(y=>n.disposeIntermediateTensorInfo(y)),v}const tIt={kernelName:BN,backendName:"webgl",kernelFunc:lFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nIt="return float(a > b);",rIt=`
  return vec4(greaterThan(a, b));
`,iIt=ys({opSnippet:nIt,packedOpSnippet:rIt,cpuKernelImpl:rAt,dtype:"bool"}),sIt={kernelName:zN,backendName:"webgl",kernelFunc:iIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aIt="return float(a >= b);",oIt=`
  return vec4(greaterThanEqual(a, b));
`,lIt=ys({opSnippet:aIt,packedOpSnippet:oIt,dtype:"bool",cpuKernelImpl:iAt}),uIt={kernelName:XC,backendName:"webgl",kernelFunc:lIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cIt(e){const{inputs:t,backend:n}=e,{input:r}=t;return oFe(r,!0,n)}const fIt={kernelName:sz,backendName:"webgl",kernelFunc:cIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hIt="return float(!isnan(x) && !isinf(x));",dIt=nn({opSnippet:hIt,dtype:"bool"}),pIt={kernelName:ZC,backendName:"webgl",kernelFunc:dIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gIt="return float(isinf(x));",mIt=nn({opSnippet:gIt,dtype:"bool"}),vIt={kernelName:QC,backendName:"webgl",kernelFunc:mIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yIt="return float(isnan(x));",bIt=nn({opSnippet:yIt,dtype:"bool"}),xIt={kernelName:JC,backendName:"webgl",kernelFunc:bIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wIt="return float(a < b);",$It=`
  return vec4(lessThan(a, b));
`,CIt=ys({opSnippet:wIt,packedOpSnippet:$It,cpuKernelImpl:sAt,dtype:"bool"}),_It={kernelName:WN,backendName:"webgl",kernelFunc:CIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SIt="return float(a <= b);",kIt=`
  return vec4(lessThanEqual(a, b));
`,EIt=ys({opSnippet:SIt,packedOpSnippet:kIt,cpuKernelImpl:aAt,dtype:"bool"}),AIt={kernelName:VN,backendName:"webgl",kernelFunc:EIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TIt(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:s}=n,a=oAt(r,i,s);return t.makeTensorInfo([a.length],"float32",a)}const DIt={kernelName:oz,backendName:"webgl",kernelFunc:TIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NIt=R_+`
  return x < 0.0 ? 0./0. : log(x);
`,IIt=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,MIt=nn({opSnippet:NIt,packedOpSnippet:IIt,cpuKernelImpl:lAt}),FIt={kernelName:e_,backendName:"webgl",kernelFunc:MIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OIt=R_+`
  return log(1.0 + x);
`,RIt=nn({opSnippet:OIt}),PIt={kernelName:t_,backendName:"webgl",kernelFunc:RIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LIt="return float(a >= 1.0 && b >= 1.0);",BIt=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,zIt=ys({opSnippet:LIt,packedOpSnippet:BIt,dtype:"bool"}),UIt={kernelName:jN,backendName:"webgl",kernelFunc:zIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WIt="return float(!(x >= 1.0));",VIt=nn({opSnippet:WIt}),jIt={kernelName:HN,backendName:"webgl",kernelFunc:VIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HIt="return float(a >= 1.0 || b >= 1.0);",qIt=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,GIt=ys({opSnippet:HIt,packedOpSnippet:qIt,dtype:"bool"}),YIt={kernelName:qN,backendName:"webgl",kernelFunc:GIt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XIt{constructor(t,n,r,i,s){this.variableNames=["x"],this.outputShape=[];const a=n,o=t[3]-1;this.outputShape=t;let l;const u=`float(${r}) + float(${i}) * sum`;s===.5?l=`inversesqrt(${u})`:s===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${a}; j <= ${a}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KIt{constructor(t,n,r,i,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=n,o=t[3]-1;this.outputShape=t;let l;const u=`float(${r}) + float(${i}) * sum`;s===.5?l=`inversesqrt(${u})`:s===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${a};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${a}; j <= ${a}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZIt=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:s,bias:a,alpha:o,beta:l}=r,u=le().getBool("WEBGL_PACK_NORMALIZATION")?new KIt(i.shape,s,a,o,l):new XIt(i.shape,s,a,o,l);return n.runWebGLProgram(u,[i],i.dtype)},QIt={kernelName:GN,backendName:"webgl",kernelFunc:ZIt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JIt{constructor(t,n,r,i,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=i,this.beta=s,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${i}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${i})
                * float(${s})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${s});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eMt=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i,y:s,dy:a}=t,{depthRadius:o,bias:l,alpha:u,beta:c}=r,f=new JIt(i.shape,o,l,u,c);return n.runWebGLProgram(f,[i,s,a],i.dtype)},tMt={kernelName:lz,backendName:"webgl",kernelFunc:eMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nMt(e,t,n,r){const i=de(t),a=de(e.shape)/i,o=Fe({inputs:{x:e},attrs:{shape:[a,i]},backend:r}),l=Jb(o,e.dtype,"max",r),u=Fe({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uFe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:s,keepDims:a}=r,o=i.shape.length,l=Ot(s,i.shape);let u=l;const c=Fr(u,o),f=c!=null,h=n.shouldExecuteOnCPU([i]);let d=i;if(f){if(h){const b=n.texData.get(d.dataId).values,x=new Array(o);for(let $=0;$<x.length;$++)x[$]=i.shape[c[$]];const w=ure(b,i.shape,i.dtype,c,x);d=n.makeTensorInfo(x,i.dtype);const C=n.texData.get(d.dataId);C.values=w}else d=O7(i,c,n);u=Jr(u.length,o)}vs("max",u,o);const[p,g]=Li(d.shape,u);let m=p;a&&(m=Zr(p,l));let v;if(h){const b=n.texData.get(d.dataId).values,x=uAt(b,de(g),m,i.dtype);v=n.makeTensorInfo(m,i.dtype);const w=n.texData.get(v.dataId);w.values=x}else v=nMt(d,g,m,n);return f&&n.disposeIntermediateTensorInfo(d),v}const rMt={kernelName:YN,backendName:"webgl",kernelFunc:uFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iMt=cre+`
  return max(a, b);
`,sMt=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Qb+`
  return result;
`,aMt=ys({opSnippet:iMt,packedOpSnippet:sMt,cpuKernelImpl:cAt}),oMt={kernelName:n_,backendName:"webgl",kernelFunc:aMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lMt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;jI(i,"maxPool");const{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=r,u=1;B(ms(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const c=Gu(i.shape,s,a,u,o,l);if(c.filterWidth===1&&c.filterHeight===1&&Qt(c.inShape,c.outShape))return ol({inputs:{x:i},backend:n});const f=new MT(c,"max",!1);return n.runWebGLProgram(f,[i],i.dtype)}const uMt={kernelName:XN,backendName:"webgl",kernelFunc:lMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cMt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:a,pad:o,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],f=ng(i.shape,s,a,c,o,u,l),h=new hre(f,"max",!1);return n.runWebGLProgram(h,[i],i.dtype)}const fMt={kernelName:KN,backendName:"webgl",kernelFunc:cMt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hMt{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideHeight,r=t.strideWidth,i=t.dilationHeight,s=t.effectiveFilterHeight,a=t.effectiveFilterWidth,o=s-1-t.padInfo.top,l=a-1-t.padInfo.left,u=s*a-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${s};
          wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${a}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${a} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class dMt{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideDepth,r=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,a=t.dilationHeight,o=t.dilationWidth,l=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,f=l-1-t.padInfo.front,h=u-1-t.padInfo.top,d=c-1-t.padInfo.left,p=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${h}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${s}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${a}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pMt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,a=s,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=r,f=[1,1,1],h=ng(a.shape,o,l,f,u,c),d=new hre(h,"max",!0),p=n.runWebGLProgram(d,[a],a.dtype),g=new dMt(h),m=n.runWebGLProgram(g,[i,p],a.dtype);return n.disposeIntermediateTensorInfo(p),m}const gMt={kernelName:cz,backendName:"webgl",kernelFunc:pMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mMt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s,output:a}=t,o=s;jI([s,a],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:f}=r,h=Gu(o.shape,l,u,1,c,f),d=!0,p=new MT(h,"max",d),g=n.runWebGLProgram(p,[o],o.dtype),m=new hMt(h),v=n.runWebGLProgram(m,[i,g],o.dtype);return n.disposeIntermediateTensorInfo(g),v}const vMt={kernelName:uz,backendName:"webgl",kernelFunc:mMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yMt(e,t,n,r){let i=new MT(n,"max",!1);const s=r.runWebGLProgram(i,[e],"float32");i=new MT(n,"max",!0,!0,t);const a=r.runWebGLProgram(i,[e],"float32");return[s,a]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bMt={kernelName:fz,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{filterSize:i,strides:s,pad:a,includeBatchInIndex:o}=t,l=n;B(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];B(ms(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);const c=Gu(r.shape,i,s,u,a),[f,h]=yMt(r,o,c,l);return[f,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xMt(e,t,n,r){const i=de(t),a=de(e.shape)/i,o=Fe({inputs:{x:e},attrs:{shape:[a,i]},backend:r}),l=Jb(o,"float32","mean",r),u=Fe({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wMt={kernelName:ZN,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{keepDims:i,axis:s}=t,a=n,o=r.shape.length,l=Ot(s,r.shape);let u=l;const c=Fr(u,o),f=c!=null,h=a.shouldExecuteOnCPU([r]),d=[];let p=r;if(f){if(h){const x=a.texData.get(p.dataId).values,w=new Array(o);for(let _=0;_<w.length;_++)w[_]=r.shape[c[_]];const C=ure(x,r.shape,r.dtype,c,w);p=a.makeTensorInfo(w,r.dtype);const $=a.texData.get(p.dataId);$.values=C}else p=O7(r,c,a);d.push(p),u=Jr(u.length,o)}vs("sum",u,o);const[g,m]=Li(p.shape,u);let v=g;i&&(v=Zr(g,l));const y=xMt(p,m,v,a);for(const b of d)a.disposeIntermediateTensorInfo(b);return y}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Mt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r,o=i.shape.length,l=Ot(s,i.shape);let u=l;const c=Fr(u,o);let f=i;c!=null&&(f=Ma({inputs:{x:i},backend:n,attrs:{perm:c}}),u=Jr(u.length,i.shape.length)),vs("min",u,o);const[h,d]=Li(f.shape,u),p=de(d),g=Fe({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),m=Jb(g,g.dtype,"min",n);let v;if(a){const y=Zr(h,l);v=Fe({inputs:{x:m},backend:n,attrs:{shape:y}})}else v=Fe({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),c!=null&&n.disposeIntermediateTensorInfo(f),v}const CMt={kernelName:QN,backendName:"webgl",kernelFunc:$Mt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Mt=cre+`
  return min(a, b);
`,SMt=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Qb+`
  return result;
`,kMt=ys({opSnippet:_Mt,packedOpSnippet:SMt,cpuKernelImpl:fAt}),EMt={kernelName:r_,backendName:"webgl",kernelFunc:kMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AMt{constructor(t,n,r){this.variableNames=["x"],this.outputShape=n.map((c,f)=>c[0]+t[f]+c[1]);const i=t.length,s=jn(i),a=n.map(c=>c[0]).join(","),o=n.map((c,f)=>c[0]+t[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),u=r==="reflect"?0:1;if(i===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${a});
      ${s} end = ${s}(${o});

      void main() {
        ${s} outC = getOutputCoords();
        for (int i = 0; i < ${i}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${s} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TMt{constructor(t,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,g)=>p[0]+t[g]+p[1]);const i=t.length,s=jn(i),a=n.map(p=>p[0]).join(","),o=n.map((p,g)=>p[0]+t[g]).join(","),l=ga("rc",i),u=ga("source",i),c=`${l[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${u.slice(-2).join()})`,h=r==="reflect"?0:1;let d="";if(i===1){const p=`
        ${s} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;d=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[i-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
      `}else{const p=`
        ${s} source = rc;
        ${s} lt = ${s}(lessThan(source, start));
        ${s} gte = ${s}(greaterThanEqual(source, end));
        ${s} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;d=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[i-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
        rc = outputLoc;
        ${l[i-2]} += 1;
        if(${l[i-2]} < ${this.outputShape[i-2]}) {
          ${p}
          result[2] = getChannel(getX(${u.join()}), ${f});
          ${l[i-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${u.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${s} start = ${s}(${a});
      const ${s} end = ${s}(${o});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${d}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DMt=({inputs:e,backend:t,attrs:n})=>{const{x:r}=e,{paddings:i,mode:s}=n,a=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new TMt(r.shape,i,s):new AMt(r.shape,i,s);return t.runWebGLProgram(a,[r],r.dtype)},NMt={kernelName:JN,backendName:"webgl",kernelFunc:DMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IMt=`if (b == 0.0) return NAN;
  return mod(a, b);`,MMt=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Qb+`
  return result;
`,FMt=ys({opSnippet:IMt,packedOpSnippet:MMt}),OMt={kernelName:i_,backendName:"webgl",kernelFunc:FMt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RMt{constructor(t,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PMt=`
if (a == b) {
  return 1.0;
};
return a / b;`,LMt=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,cFe=ys({opSnippet:PMt,packedOpSnippet:LMt,checkOutOfBounds:!0}),BMt={kernelName:WC,backendName:"webgl",kernelFunc:cFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M0e="return a - b;",fFe=ys({opSnippet:M0e,packedOpSnippet:M0e,supportsComplex:!0,cpuKernelImpl:IAt}),zMt={kernelName:x_,backendName:"webgl",kernelFunc:fFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hFe(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:s}=r,a=Ot([s],i.shape),o=uFe({inputs:{x:i},backend:n,attrs:{reductionIndices:a,keepDims:!1}}),l=Zr(o.shape,a),u=Fe({inputs:{x:o},backend:n,attrs:{shape:l}}),c=fFe({inputs:{a:i,b:u},backend:n}),f=aFe({inputs:{x:c},backend:n}),h=R7({inputs:{x:f},backend:n,attrs:{axis:a,keepDims:!1}}),d=Fe({inputs:{x:h},backend:n,attrs:{shape:l}}),p=cFe({inputs:{a:f,b:d},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),p}const UMt={kernelName:vI,backendName:"webgl",kernelFunc:hFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WMt(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:s,seed:a,normalized:o}=r,l=o?i:hFe({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),u=l.shape[0],c=l.shape[1],f=new RMt(u,c,s),h=[[a]],d=n.runWebGLProgram(f,[l],"int32",h);return o||n.disposeIntermediateTensorInfo(l),d}const VMt={kernelName:hz,backendName:"webgl",kernelFunc:WMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jMt=Xu+`
  return -x;
`,HMt=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function qMt(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const s=n.texData.get(r.dataId),[a,o]=dAt(s.values,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,a)}let i;return le().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new Qg(r.shape,HMt):i=new th(r.shape,jMt),n.runWebGLProgram(i,[r],r.dtype)}const GMt={kernelName:eI,backendName:"webgl",kernelFunc:qMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YMt=h7;function XMt(e){kl("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=r,u=n.readSync(i.dataId),c=n.readSync(s.dataId),{selectedIndices:f}=YMt(u,c,a,o,l);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const KMt={kernelName:dz,backendName:"webgl",kernelFunc:XMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZMt=d7;function QMt(e){kl("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(i.dataId),f=n.readSync(s.dataId),{selectedIndices:h,validOutputs:d}=ZMt(c,f,a,o,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([d]))]}const JMt={kernelName:pz,backendName:"webgl",kernelFunc:QMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eFt=p7;function tFt(e){kl("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(i.dataId),f=n.readSync(s.dataId),h=a,d=o,p=l,g=u,{selectedIndices:m,selectedScores:v}=eFt(c,f,h,d,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}const nFt={kernelName:gz,backendName:"webgl",kernelFunc:tFt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rFt{constructor(t,n,r,i){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${i}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iFt=e=>{const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:s,depth:a,onValue:o,offValue:l}=r,u=de(i.shape),c=new rFt(u,a,o,l),f=Fe({inputs:{x:i},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(c,[f],s);n.disposeIntermediateTensorInfo(f);const d=[...i.shape,a],p=Fe({inputs:{x:h},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(h),p},sFt={kernelName:rI,backendName:"webgl",kernelFunc:iFt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X5(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="complex64"){const i=qI({inputs:{input:r},backend:n}),s=X5({inputs:{x:i},backend:n}),a=P7({inputs:{input:r},backend:n}),o=X5({inputs:{x:a},backend:n}),l=Km({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),l}else return GI({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const aFt={kernelName:wI,backendName:"webgl",kernelFunc:X5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dFe(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const i=qI({inputs:{input:r},backend:n}),s=dFe({inputs:{x:i},backend:n}),a=P7({inputs:{input:r},backend:n}),o=X5({inputs:{x:a},backend:n}),l=Km({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),l}else return GI({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const oFt={kernelName:nI,backendName:"webgl",kernelFunc:dFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lFt(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return lX({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const s=t[0].shape,a=t[0].dtype;t.forEach(c=>{gs(s,c.shape,"All tensors passed to stack must have matching shapes"),B(a===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=t.map(c=>{const f=lX({inputs:{input:c},backend:n,attrs:{dim:i}});return o.push(f),f}),u=QMe({inputs:l,backend:n,attrs:{axis:i}});return o.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const uFt={kernelName:iI,backendName:"webgl",kernelFunc:lFt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cFt{constructor(t,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+t[c]+u[1]);const i=t.length,s=jn(i),a=n.map(u=>u[0]).join(","),o=n.map((u,c)=>u[0]+t[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);if(i===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${a});
      ${s} end = ${s}(${o});

      void main() {
        ${s} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${s} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fFt{constructor(t,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,m)=>g[0]+t[m]+g[1]);const i=t.length,s=jn(i),a=n.map(g=>g[0]).join(","),o=n.map((g,m)=>g[0]+t[m]).join(","),l=ga("rc",i),u=ga("source",i),c=`${l[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${u.slice(-2).join()})`,h=[`${s} rc = outputLoc;`,`${l[i-1]} += 1;
       if(${c}) {
      `,i===1?"":`}
       rc = outputLoc;
       ${l[i-2]} += 1;
       if(${l[i-2]} < ${this.outputShape[i-2]}) {`,i===1?"":`  ${l[i-1]} += 1;
         if(${c}) {`],d=i===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let g=0,m=i===1?2:4;g<m;g++)p+=`
        ${h[g]}
        if (${d}) {
          result[${g}] = float(value);
        } else {
          ${s} source = rc - start;
          result[${g}] = getChannel(getX(${u.join()}), ${f});
        }
      `;p+=i===1?"} ":"}}",this.userCode=`
      const ${s} start = ${s}(${a});
      const ${s} end = ${s}(${o});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pFe=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,constantValue:a}=r;if(de(i.shape)===0){const u=s.map((c,f)=>c[0]+i.shape[f]+c[1]);return GI({backend:n,attrs:{shape:u,value:a,dtype:i.dtype}})}const o=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new fFt(i.shape,s,a):new cFt(i.shape,s,a),l=[[a]];return n.runWebGLProgram(o,[i],i.dtype,l)},hFt={kernelName:sI,backendName:"webgl",kernelFunc:pFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dFt=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,pFt=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Qb+`
  return result;
`,gFt=ys({opSnippet:dFt,packedOpSnippet:pFt}),mFt={kernelName:a_,backendName:"webgl",kernelFunc:gFt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vFt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r,o=i.shape.length,l=[],u=Ot(s,i.shape);let c=u;const f=Fr(c,o);let h=i;f!=null&&(h=Ma({inputs:{x:i},backend:n,attrs:{perm:f}}),c=Jr(c.length,o),l.push(h)),vs("prod",c,o);let d;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:g,outShape:m,outDtype:v}=gAt(h.shape,h.dtype,p,c);d=n.makeTensorInfo(m,v,g)}else{const[p,g]=Li(h.shape,c),m=de(g),v=Fe({inputs:{x:h},backend:n,attrs:{shape:[-1,m]}}),y=Uz(i.dtype),b=Jb(v,y,"prod",n);d=Fe({inputs:{x:b},backend:n,attrs:{shape:p}}),l.push(v),l.push(b)}if(a){l.push(d);const p=Zr(d.shape,u);d=Fe({inputs:{x:d},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),d}const yFt={kernelName:oI,backendName:"webgl",kernelFunc:vFt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bFt(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:s,indices:a}=t,{outputRaggedRank:o}=r,l=i.map(v=>n.readSync(v.dataId)),u=i.map(v=>v.shape),c=n.readSync(s.dataId),f=n.readSync(a.dataId),[h,d,p]=mAt(l,u,c,s.shape,s.dtype,f,a.shape,o),g=h.map(v=>n.makeTensorInfo([v.length],"int32",v)),m=n.makeTensorInfo(p,s.dtype,d);return g.concat([m])}const xFt={kernelName:mz,backendName:"webgl",kernelFunc:bFt};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wFt(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:s}=t,a=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(s.dataId),[u,c]=vAt(a,r.shape,r.dtype,o,i.shape,l,s.shape),f=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([c.length],r.dtype,c);return[f,h]}const $Ft={kernelName:vz,backendName:"webgl",kernelFunc:wFt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CFt(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:s,defaultValue:a,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,u=n.readSync(i.dataId),c=n.readSync(s.dataId),f=n.readSync(a.dataId),h=o.map(m=>n.readSync(m.dataId)),d=o.map(m=>m.shape),[p,g]=yAt(u,i.shape,c,s.shape,s.dtype,f,a.shape,h,d,l);return n.makeTensorInfo(p,s.dtype,g)}const _Ft={kernelName:yz,backendName:"webgl",kernelFunc:CFt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gFe=e=>{const{backend:t,attrs:n}=e,{start:r,stop:i,step:s,dtype:a}=n,o=bAt(r,i,s,a);return t.makeTensorInfo([o.length],a,o)},SFt={kernelName:bz,backendName:"webgl",kernelFunc:gFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kFt="return 1.0 / x;",EFt=nn({opSnippet:kFt}),AFt={kernelName:o_,backendName:"webgl",kernelFunc:EFt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TFt=Xu+`
  return (x < 0.0) ? 0.0 : x;
`,DFt=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,NFt=nn({opSnippet:TFt,packedOpSnippet:DFt}),IFt={kernelName:l_,backendName:"webgl",kernelFunc:NFt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MFt=Xu+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,FFt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,OFt=nn({opSnippet:MFt,packedOpSnippet:FFt}),RFt={kernelName:u_,backendName:"webgl",kernelFunc:OFt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PFt{constructor(t,n,r,i,s){this.variableNames=["A"],this.outputShape=[];const[a,o,l,u]=t;this.outputShape=[a,n,r,u];const c=[i&&n>1?o-1:o,i&&r>1?l-1:l],f=[i&&n>1?n-1:n,i&&r>1?r-1:r];let h;s?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LFt{constructor(t,n,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,l,u]=t;this.outputShape=[a,n,r,u];const c=[i&&n>1?o-1:o,i&&r>1?l-1:l],f=[i&&n>1?n-1:n,i&&r>1?r-1:r];let h;s?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BFt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:a,size:o}=r,[l,u]=o,c=le().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new LFt(i.shape,l,u,s,a):new PFt(i.shape,l,u,s,a);return n.runWebGLProgram(c,[i],"float32")}const zFt={kernelName:cI,backendName:"webgl",kernelFunc:BFt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UFt{constructor(t,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,s]=n,[,a,o]=t,l=[r&&a>1?i-1:i,r&&o>1?s-1:s],u=[r&&a>1?a-1:a,r&&o>1?o-1:o],c=l[0]/u[0],f=l[1]/u[1],h=1/c,d=1/f,p=Math.ceil(h)*2+2,g=Math.ceil(d)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${d});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WFt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:a}=r,o=new UFt(s.shape,i.shape,a);return n.runWebGLProgram(o,[s],s.dtype)}const VFt={kernelName:$z,backendName:"webgl",kernelFunc:WFt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jFt{constructor(t,n,r,i,s){this.variableNames=["A"],this.outputShape=[];const[a,o,l,u]=t;this.outputShape=[a,n,r,u];const c=[i&&n>1?o-1:o,i&&r>1?l-1:l],f=[i&&n>1?n-1:n,i&&r>1?r-1:r],h=i?"0.5":"0.0";let d;s?d="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HFt{constructor(t,n,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,l,u]=t;this.outputShape=[a,n,r,u];const c=[i&&n>1?o-1:o,i&&r>1?l-1:l],f=[i&&n>1?n-1:n,i&&r>1?r-1:r],h=i?"0.5":"0.0";let d;s?d="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qFt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:a,size:o}=r,[l,u]=o,c=le().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new HFt(i.shape,l,u,s,a):new jFt(i.shape,l,u,s,a);return n.runWebGLProgram(c,[i],i.dtype)}const GFt={kernelName:uI,backendName:"webgl",kernelFunc:qFt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YFt{constructor(t,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,s]=n,[,a,o]=t,l=[r&&a>1?i-1:i,r&&o>1?s-1:s],u=[r&&a>1?a-1:a,r&&o>1?o-1:o],c=l[0]/u[0],f=l[1]/u[1],h=1/c,d=1/f,p=Math.ceil(h)*2+2,g=Math.ceil(d)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${d});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XFt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:a}=r,o=new YFt(s.shape,i.shape,a);return n.runWebGLProgram(o,[s],s.dtype)}const KFt={kernelName:wz,backendName:"webgl",kernelFunc:XFt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZFt{constructor(t,n){this.variableNames=["x"];const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=t,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}const i=o=>n.indexOf(o)!==-1&&t[o]!==1?`${t[o]} - coords[${o}] - 1`:`coords[${o}]`,s=t.map((o,l)=>i(l)).join(","),a=jn(r);this.userCode=`
      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QFt{constructor(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=t;const i=ga("rc",r),s=`${i[r-1]} + 1 < ${this.outputShape[r-1]}`,a=`${i[r-2]} + 1 < ${this.outputShape[r-2]}`,o=jn(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${s}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(i.slice())};
          if(${s}){
            result.g = ${u(i.slice())};
          }
          if(${a}) {
            result.b = ${c(i.slice())};
            if(${s}) {
              result.a = ${f(i.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function u(p){return p[r-1]="("+p[r-1]+" + 1)",h(p)}function c(p){return p[r-2]="("+p[r-2]+" + 1)",h(p)}function f(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",h(p)}function h(p){const g=t.map((y,b)=>d(b,p)),m=g.join(","),v=g.slice(-2).join(",");return`getChannel(getX(${m}), vec2(${v}))`}function d(p,g){return n.indexOf(p)!==-1&&t[p]!==1?`${t[p]} - ${g[p]} - 1`:`${g[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JFt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:s}=r,a=i.shape.length,o=Ot(s,i.shape);if(a===0)return ol({inputs:{x:i},backend:n});const l=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new QFt(i.shape,o):new ZFt(i.shape,o);return n.runWebGLProgram(l,[i],i.dtype)}const eOt={kernelName:fI,backendName:"webgl",kernelFunc:JFt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tOt{constructor(t,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=t[1],i=t[2];this.outputShape=t;let s="";typeof n=="number"?s=`float outputValue = ${n.toFixed(2)};`:s=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${s}
          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nOt={kernelName:Bz,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,{radians:i,fillValue:s,center:a}=t,o=n,l=new tOt(r.shape,s),[u,c]=une(a,r.shape[1],r.shape[2]),f=[[u,c,Math.sin(i),Math.cos(i)]];return o.runWebGLProgram(l,[r],r.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rOt=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,iOt=nn({opSnippet:rOt}),sOt={kernelName:c_,backendName:"webgl",kernelFunc:iOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aOt="return inversesqrt(x);",oOt=nn({opSnippet:aOt,cpuKernelImpl:xAt}),lOt={kernelName:f_,backendName:"webgl",kernelFunc:oOt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dre{constructor(t,n,r,i,s,a,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const u=jn(s.length),c=jn(a.length);let f="";r===1?f="i":r===2&&(f="i, j");const h=`getIndices(${f})`;let d="";i===1?d="i":i===2&&(d="i, coords[1]");const p=`getUpdates(${d})`;let g="";l&&(g="coords[0], coords[1]");const m=`getDefaultValue(${g})`,v=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${s});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${v};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${m}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uOt{constructor(t,n,r,i,s,a,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;const u=jn(s.length),c=jn(a.length);let f="";r===1?f="i":r===2&&(f="i, j");const h=`getIndices(${f})`;let d="";i===1?d="i":i===2&&(d="i, coords[1]");const p=`getUpdates(${d})`;let g="";l&&(g="coords[0], coords[1]");const m=`getDefaultValue(${g})`,v=n>1?"strides[j]":"strides",y=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${s});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${t}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${v};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${m}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cOt(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:s}=t,{shape:a}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=Gm(s,i,a),h=[f/u,u];if(f===0)return n.makeTensorInfo(a,i.dtype);const d=Fe({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),p=Fe({inputs:{x:s},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let m;le().getBool("WEBGL_PACK")?m=new uOt(l,o,d.shape.length,p.shape.length,c,h):m=new dre(l,o,d.shape.length,p.shape.length,c,h);const v=n.runWebGLProgram(m,[p,d,g],p.dtype),y=Fe({inputs:{x:v},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),y}const fOt={kernelName:Cz,backendName:"webgl",kernelFunc:cOt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hOt{constructor(t,n,r,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];const s="while (left < right) {",a=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,o=le().getNumber("WEBGL_VERSION")===2?s:a,l=i==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dOt(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:s}=t,{side:a}=r,o=new hOt(i.shape[0],i.shape[1],s.shape[1],a),l=[[i.shape[1]]];return n.runWebGLProgram(o,[i,s],"int32",l)}const pOt={kernelName:Sz,backendName:"webgl",kernelFunc:dOt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gOt{constructor(t,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let i,s;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)s="resRC",i="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${o[c]}`),c<t&&l.push(`${o[c]}`);i=l.join(),s=u.join()}const a=jn(r);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        float cVal = getC(${i});
        if (cVal >= 1.0) {
          setOutput(getA(${s}));
        } else {
          setOutput(getB(${s}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mOt(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:s}=t,a=new gOt(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(a,[r,i,s],po(i.dtype,s.dtype))}const vOt={kernelName:hI,backendName:"webgl",kernelFunc:mOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yOt=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${b7};
  float scale = ${x7};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,bOt=nn({opSnippet:yOt}),xOt={kernelName:h_,backendName:"webgl",kernelFunc:bOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wOt=R_+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,$Ot=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,COt=nn({opSnippet:wOt,packedOpSnippet:$Ot,cpuKernelImpl:$At}),_Ot={kernelName:m_,backendName:"webgl",kernelFunc:COt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SOt=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,kOt=nn({opSnippet:SOt}),EOt={kernelName:g_,backendName:"webgl",kernelFunc:kOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AOt=R_+`
  return sin(x);
`,TOt=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Qb}
  return result;
`,DOt=nn({opSnippet:AOt,packedOpSnippet:TOt}),NOt={kernelName:d_,backendName:"webgl",kernelFunc:DOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IOt=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,MOt=nn({opSnippet:IOt}),FOt={kernelName:p_,backendName:"webgl",kernelFunc:MOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OOt=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,ROt=nn({opSnippet:OOt}),POt={kernelName:v_,backendName:"webgl",kernelFunc:ROt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LOt=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,paddings:a}=r;B(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=s.reduce((v,y)=>v*y),l=[[0,0]];l.push(...a);for(let v=1+s.length;v<i.shape.length;++v)l.push([0,0]);const u=[],c=pFe({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),f=NI(c.shape,s,o,!1),h=II(f.length,s.length,!1),d=MI(c.shape,s,o,!1),p=Fe({inputs:{x:c},backend:n,attrs:{shape:f}}),g=Ma({inputs:{x:p},backend:n,attrs:{perm:h}}),m=Fe({inputs:{x:g},backend:n,attrs:{shape:d}});return u.push(c),u.push(p),u.push(g),u.forEach(v=>n.disposeIntermediateTensorInfo(v)),m},BOt={kernelName:gI,backendName:"webgl",kernelFunc:LOt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zOt(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:s,defaultValue:a}=t;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${i.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=n.readSync(r.dataId),l=n.readSync(i.dataId),u=n.readSync(s.dataId),c=n.readSync(a.dataId)[0],[f,h,d,p,g]=_At(o,r.shape,r.dtype,l,i.dtype,u,c);return[n.makeTensorInfo(h,r.dtype,f),n.makeTensorInfo([h[0]],i.dtype,d),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const UOt={kernelName:kz,backendName:"webgl",kernelFunc:zOt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WOt(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:s}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const a=Array.from(n.readSync(i.dataId)),o=n.readSync(r.dataId),l=Array.from(n.readSync(s.dataId)),[u,c,f]=SAt(o,r.shape,r.dtype,a,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([f.length],s.dtype,new Int32Array(f))]}const VOt={kernelName:Ez,backendName:"webgl",kernelFunc:WOt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jOt(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${s.shape}`);const a=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(s.dataId),[u,c]=BMe(a,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const HOt={kernelName:Az,backendName:"webgl",kernelFunc:jOt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qOt(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${s.shape}`);const a=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(s.dataId),[u,c]=BMe(a,r.shape,r.dtype,o,l);return n.makeTensorInfo(c,r.dtype,u)}const GOt={kernelName:Tz,backendName:"webgl",kernelFunc:qOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YOt(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:s,defaultValue:a}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:f,outputSize:h}=Gm(s,i,o),d=!1;if(s.dtype==="string"){const v=n.bufferSync(i),y=n.bufferSync(s),b=Ip(n.readSync(a.dataId)[0]),x=wAt(v,y,o,h,c,u,l,f,b,d);return n.makeTensorInfo(o,x.dtype,x.values)}const p=new dre(u,l,i.shape.length,s.shape.length,f,[h,1],d),g=n.runWebGLProgram(p,[s,i,a],s.dtype),m=Fe({inputs:{x:g},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(g),m}const XOt={kernelName:Dz,backendName:"webgl",kernelFunc:YOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KOt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:s,axis:a}=r,o=Ot(a,i.shape)[0],l=_ne(i,s,o),u=i.shape.length,c=new Array(u).fill(0),f=i.shape.slice();return l.map(h=>{const d=[...f];d[o]=h;const p=P_({inputs:{x:i},backend:n,attrs:{begin:c,size:d}});return c[o]+=h,p})}const ZOt={kernelName:mI,backendName:"webgl",kernelFunc:KOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F0e="return sqrt(x);",QOt=nn({opSnippet:F0e,packedOpSnippet:F0e,cpuKernelImpl:kAt}),JOt={kernelName:y_,backendName:"webgl",kernelFunc:QOt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eRt="return x * x;",tRt=nn({opSnippet:eRt}),nRt={kernelName:Nz,backendName:"webgl",kernelFunc:tRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O0e="return (a - b) * (a - b);",rRt=ys({opSnippet:O0e,packedOpSnippet:O0e}),iRt={kernelName:b_,backendName:"webgl",kernelFunc:rRt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sRt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");const s=n.readSync(i.dataId),a=Op(s),o=EAt(a,"string",r);return n.makeTensorInfo(i.shape,"string",o)}const aRt={kernelName:yI,backendName:"webgl",kernelFunc:sRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oRt({inputs:e,attrs:t,backend:n}){const{x:r}=e,i=Xu+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,s=new th(r.shape,i);return n.runWebGLProgram(s,[r],r.dtype)}const lRt={kernelName:__,backendName:"webgl",kernelFunc:oRt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uRt{constructor(t,n,r){this.variableNames=["x"],this.outputShape=r;const i=r.length,s=jn(r.length),a=jn(r.length);let o="";if(i===1)o="coords * strides + begin";else{let l=0;o=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${s} begin = ${s}(${t});
      ${s} strides = ${s}(${n});

      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cRt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,end:a,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:h}=r,{finalShapeSparse:d,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:v,begin:y,end:b,strides:x}=sne(i.shape,s,a,o,l,u,c,f,h);let w;if(g)w=Fe({inputs:{x:i},backend:n,attrs:{shape:p}});else if(m||v){B(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const $=nne(y,b,x),_=P_({inputs:{x:i},backend:n,attrs:{begin:y,size:$}});w=Fe({inputs:{x:_},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(_)}else if(n.shouldExecuteOnCPU([i])){const _=n.readSync(i.dataId),k=Mt(i.shape,i.dtype,_),E=AAt(d,k,x,y);w=n.makeTensorInfo(p,i.dtype,E.values)}else{const _=new uRt(y,x,d);w=n.runWebGLProgram(_,[i],i.dtype)}const C=Fe({inputs:{x:w},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(w),C}const fRt={kernelName:Iz,backendName:"webgl",kernelFunc:cRt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hRt(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:s,leftPad:a,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:f}=t,h=n.readSync(c.dataId),d=n.readSync(f.dataId),[p,g]=TAt(h,d,i,s,a,o,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(f.shape,"int32",g)]}const dRt={kernelName:Mz,backendName:"webgl",kernelFunc:hRt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pRt(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:s,delimiter:a}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=n.readSync(s.dataId),l=n.readSync(a.dataId)[0],[u,c,f]=DAt(o,l,i),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const gRt={kernelName:Fz,backendName:"webgl",kernelFunc:pRt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mRt(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:s}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const a=n.readSync(s.dataId),o=NAt(a,i);return n.makeTensorInfo(s.shape,"int32",o)}const vRt={kernelName:Oz,backendName:"webgl",kernelFunc:mRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yRt="return tan(x);",bRt=nn({opSnippet:yRt}),xRt={kernelName:w_,backendName:"webgl",kernelFunc:bRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wRt=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,$Rt=nn({opSnippet:wRt}),CRt={kernelName:$_,backendName:"webgl",kernelFunc:$Rt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Rt(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:i,indices:s,updates:a}=t,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=Gm(a,s,i.shape),h=[f/u,u];if(f===0)return n.makeTensorInfo(i.shape,s.dtype);const d=Fe({inputs:{x:s},backend:n,attrs:{shape:[l,o]}}),p=Fe({inputs:{x:a},backend:n,attrs:{shape:[l,u]}}),g=Fe({inputs:{x:i},backend:n,attrs:{shape:h}}),m=new dre(l,o,d.shape.length,p.shape.length,c,h,!1,!0),v=n.runWebGLProgram(m,[p,d,g],g.dtype),y=Fe({inputs:{x:v},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),y}const SRt={kernelName:_z,backendName:"webgl",kernelFunc:_Rt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kRt{constructor(t,n){this.variableNames=["A"];const r=new Array(t.length);for(let a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;const i=jn(this.rank),s=ERt(t);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        setOutput(getA(${s}));
      }
    `}}function ERt(e){const t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<e.length;i++)r.push(`imod(${n[i]}, ${e[i]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mFe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:s}=r;if(i.dtype==="string"||i.shape.length>5){const l=n.readSync(i.dataId),u=i.dtype==="string"?l.map(h=>Ip(h)):l,c=Mt(i.shape,i.dtype,u),f=MAt(c,s);return n.makeTensorInfo(f.shape,f.dtype,f.values)}const a=new kRt(i.shape,s);return n.runWebGLProgram(a,[i],i.dtype)}const ARt={kernelName:C_,backendName:"webgl",kernelFunc:mFe};class TRt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class DRt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Av(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function R0e(e){let t=1;for(;t<e;)t*=2;return t}function NRt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:s,sorted:a}=r,o=le().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=le().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=i.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([i])||c<o||s>l){const E=n.readSync(i.dataId),[S,N]=FAt(E,u,i.dtype,s,a);return[n.makeTensorInfo(S.shape,S.dtype,S.values),n.makeTensorInfo(N.shape,N.dtype,N.values)]}if(s===0)return u[u.length-1]=0,[n.makeTensorInfo(u,i.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[i,GI({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const f=n.texData.get(i.dataId),h=f!==null&&f.isPacked,d=h?n.unpackTensor(i):i,g=de(u)/c,m=Fe({inputs:{x:d},attrs:{shape:[g,c]},backend:n});h&&Av(n,d);const v=R0e(s),y=R0e(c);let b=null;const x=()=>b===null?[m,m]:[m,b],w=(E,S,N)=>{const A=x(),D=new TRt(N),I=[[c],[b===null?1:0],[Number.NEGATIVE_INFINITY],[E],[S]],F=b;b=n.runWebGLProgram(D,A,"int32",I),Av(n,F)};for(let E=1;E<v;E*=2){const S=E*2;for(let N=E;N>=1;N/=2)w(S,N,[g,y])}for(let E=y;E>v;E/=2){const S=x(),N=new DRt([g,E/2]),D=[[c],[b===null?1:0],[v]],T=b;b=n.runWebGLProgram(N,S,"int32",D),Av(n,T);const I=v/2,F=I*2;for(let R=I;R>=1;R/=2)w(F,R,b.shape)}let C=b;b=P_({inputs:{x:b},backend:n,attrs:{begin:0,size:[g,s]}}),Av(n,C);let $=lFe({inputs:{x:m,indices:b},backend:n,attrs:{axis:1,batchDims:1}});Av(n,m);const _=u.slice(0,-1);_.push(s),C=b,b=Fe({inputs:{x:b},attrs:{shape:_},backend:n}),Av(n,C);const k=$;return $=Fe({inputs:{x:$},attrs:{shape:_},backend:n}),Av(n,k),[$,b]}const IRt={kernelName:Rz,backendName:"webgl",kernelFunc:NRt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MRt{constructor(t,n,r,i,s,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const o=r==="nearest"?1:2;let l;switch(i){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${s});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${s});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${t}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FRt(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,transforms:s}=t,{interpolation:a,fillMode:o,fillValue:l,outputShape:u}=r,[c,f,h,d]=i.shape,[p,g]=u!=null?u:[f,h],m=[c,p,g,d],v=new MRt(f,h,a,o,l,m);return n.runWebGLProgram(v,[i,s],"float32")}const ORt={kernelName:Pz,backendName:"webgl",kernelFunc:FRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RRt(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:s}=t;jI(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=r.readSync(s.dataId),{outputValues:o,outputShape:l,indices:u}=OAt(a,i,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}const PRt={kernelName:Lz,backendName:"webgl",kernelFunc:RRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LRt(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const a=i,o=a.shape.length,l=i.shape[s],u=new Array(o-1);let c=0;for(let g=0;g<o;g++)g!==s&&(u[c++]=a.shape[g]);const f=[],h=new Array(o).fill(0),d=a.shape.slice();d[s]=1;const p=new Array(l);for(let g=0;g<p.length;g++){h[s]=g;const m=P_({inputs:{x:a},backend:n,attrs:{begin:h,size:d}}),v=Fe({inputs:{x:m},backend:n,attrs:{shape:u}});p[g]=v,f.push(m)}return f.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const BRt={kernelName:bI,backendName:"webgl",kernelFunc:LRt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zRt{constructor(t,n){this.variableNames=["x","segmentIds"];const r=t.windowSize,i=t.batchSize,s=t.inSize,a=t.numSegments,o=a*Math.ceil(s/r);this.outputShape=[i,o];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,f=r%4,h=`
        sumValue += dot(values, segFilter);
    `;let d="";s%r>0&&(d=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `);let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${a})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${a})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function URt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:s}=t,{numSegments:a}=r,o=i.shape.length,l=[];let u=0;const c=Fr([u],o);let f=i;c!=null&&(f=Ma({inputs:{x:i},backend:n,attrs:{perm:c}}),l.push(f),u=Jr(1,o)[0]);const h=Z3e(f.shape,u,a),d=de([f.shape[u]]),p=Fe({inputs:{x:f},backend:n,attrs:{shape:[-1,d]}});l.push(p);const g=Uz(i.dtype),m=(x,w,C,$,_)=>{const k=x.shape[0],E=x.shape[1],S=K3e(E,_),N={windowSize:S,inSize:E,batchSize:k,numSegments:_},A=new zRt(N,w),D=n.compileAndRun(A,[x,C],$);if(l.push(D),D.shape[1]===_)return D;const T=gFe({backend:n,attrs:{start:0,stop:_,step:1,dtype:"float32"}}),I=mFe({inputs:{x:T},backend:n,attrs:{reps:[E/S]}});return l.push(T),l.push(I),m(D,w,I,$,_)},v=m(p,"unsortedSegmentSum",s,g,a),y=Fe({inputs:{x:v},backend:n,attrs:{shape:h}});let b=y;if(c!=null){l.push(y);const x=jm(c);b=Ma({inputs:{x:b},backend:n,attrs:{perm:x}})}return l.forEach(x=>n.disposeIntermediateTensorInfo(x)),b}const WRt={kernelName:xI,backendName:"webgl",kernelFunc:URt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VRt=[kTt,ATt,NTt,FTt,RTt,BTt,UTt,VTt,GTt,XTt,QTt,t3t,i3t,l3t,f3t,d3t,g3t,b3t,w3t,C3t,E3t,F3t,R3t,z3t,W3t,Y3t,K3t,eDt,uTt,rDt,lDt,hDt,yDt,wDt,CDt,SDt,EDt,NDt,FDt,PDt,BDt,UDt,VDt,qDt,YDt,QDt,eNt,rNt,aNt,lNt,hNt,mNt,xNt,CNt,kNt,ENt,TNt,NNt,MNt,ONt,PNt,UNt,jNt,GNt,XNt,QNt,tIt,sIt,uIt,lTt,fIt,aDt,pIt,vIt,xIt,fTt,_It,AIt,DIt,FIt,PIt,UIt,jIt,YIt,QIt,tMt,rMt,oMt,uMt,fMt,gMt,vMt,bMt,wMt,CMt,EMt,NMt,OMt,VMt,pTt,GMt,KMt,JMt,nFt,j3t,sFt,oFt,uFt,hFt,mFt,dTt,yFt,xFt,$Ft,_Ft,SFt,H3t,BMt,AFt,IFt,RFt,mTt,zFt,VFt,GFt,KFt,eOt,nOt,sOt,lOt,fOt,pOt,vOt,xOt,_Ot,EOt,NOt,FOt,I3t,UMt,POt,BOt,UOt,VOt,HOt,GOt,XOt,ZOt,JOt,nRt,iRt,aRt,lRt,fRt,dRt,gRt,vRt,zMt,CTt,xRt,CRt,SRt,ARt,IRt,ORt,_Tt,PRt,BRt,WRt,aFt];for(const e of VRt)zz(e);/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var jRt=Object.defineProperty,HRt=Object.getOwnPropertyDescriptor,vFe=(e,t,n,r)=>{for(var i=r>1?void 0:r?HRt(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&jRt(t,n,i),i};let Vs=class extends Bc{constructor(){super(...arguments),this.dataSetKeys=[]}updated(e){e.has("dataSetKeys")&&(this.dataSetKeys.length?this.handleKeysChange():(this.dispatchEvent(new Event("query-layer-deletion",{bubbles:!0,composed:!0})),Ms({message:`Layer ${this.getCyId()} was deleted because no data could be assigned to it!`,variant:"warning",icon:"x-circle"})))}static create({activation:e="None",pos:t=null,alert:n=!0}={}){const r=document.createElement("input-layer");return r.activation=e,r.firstNeuronPos=t,r.alert=n,dispatchEvent(new CustomEvent("layer-created",{detail:r,bubbles:!0,composed:!0})),r}getName(){return`${this.layerId} - ${this.constructor.LAYER_NAME}`}getDescription(){return"An input layer is a layer that just takes data provided from outside the network and passes it on to the next layer(s)"}getAssignedInputs(){return this.neurons.map(e=>e.label)}handleKeysChange(){console.log("handling keys change"),console.log(this.dataSetKeys);for(let e=this.neurons.length-1;e>=0;e--)this.removeNeuron({force:!0});for(const e of this.dataSetKeys)this.addNeuron({label:e});this.requestUpdate()}build(e){console.log(`Building layer ${this.getName()}`),this.tensor=oxt({shape:[this.neurons.length],name:this.getTensorName()}),this.tensor.layer_id=this.layerId,console.log("This input tensor:"),console.log(this.tensor)}render(){return super.render()}};Vs.LAYER_TYPE="Input";Vs.LAYER_NAME="Input layer";Vs.styles=[St];vFe([Q()],Vs.prototype,"dataSetKeys",2);Vs=vFe([ze("input-layer")],Vs);const qRt=["None","ReLu","Sigmoid","Softmax"],L_=new Map;L_.set("None",null);L_.set("ReLu","relu");L_.set("Sigmoid","sigmoid");L_.set("Softmax","softmax");var GRt=Object.defineProperty,YRt=Object.getOwnPropertyDescriptor,yFe=(e,t,n,r)=>{for(var i=r>1?void 0:r?YRt(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&GRt(t,n,i),i};let $a=class extends Bc{updated(e){e.has("dataSetLabel")&&(this.dataSetLabel?this.handleLabelChange():(this.dispatchEvent(new Event("query-layer-deletion",{bubbles:!0,composed:!0})),Ms({message:`Layer ${this.getCyId()} was deleted because no data could be assigned to it!`,variant:"warning",icon:"x-circle"})))}static create({activation:e="None",pos:t=null,alert:n=!0}={}){const r=document.createElement("output-layer");return r.activation=e,r.firstNeuronPos=t,r.alert=n,dispatchEvent(new CustomEvent("layer-created",{detail:r,bubbles:!0,composed:!0})),r}getName(){return`${this.dataSetLabel.key} ${this.constructor.LAYER_NAME} ${this.activation!="None"?`(${this.activation})`:""}`}getDescription(){let e="An output layer in this simulation is just a normal dense layer, additionally equipped with the ability to output the incoming data out of the network.";return cY(this.dataSetLabel)&&(e+=" Since the purpose if this layer is to output a classifiction, we should combine it with a softmax activation function in order to provide a probability distribution."),e}handleLabelChange(){for(let e=this.neurons.length-1;e>=0;e--)this.removeNeuron({force:!0});if(xke(this.dataSetLabel))this.addNeuron({label:this.dataSetLabel.key});else if(cY(this.dataSetLabel))for(const e of this.dataSetLabel.classes)this.addNeuron({label:e.key});this.canvas.cy.getElementById(`${this.id}`).data("label",this.getName())}build(e){console.log(`Building layer ${this.getName()}`);let t;e.length>1?t=gIe({axis:1,name:`concatinputs-${this.getTensorName()}`}).apply(e):t=e[0],console.log("Input tensor:"),console.log(t),this.tensor=pIe({units:this.neurons.length,activation:L_.get(this.activation),name:this.getTensorName()}).apply(t),this.tensor.layer_id=this.id,console.log("This tensor (returned):"),console.log(this.tensor)}render(){return super.render()}};$a.LAYER_TYPE="Output";$a.LAYER_NAME="Output layer";$a.styles=[St];yFe([Q()],$a.prototype,"dataSetLabel",2);$a=yFe([ze("output-layer")],$a);var XRt=Object.defineProperty,KRt=Object.getOwnPropertyDescriptor,bFe=(e,t,n,r)=>{for(var i=r>1?void 0:r?KRt(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&XRt(t,n,i),i};let Pl=class extends Bc{firstUpdated(){super.firstUpdated();for(let e=1;e<=this.units;e++)this.addNeuron()}static create({units:e=2,activation:t="None",pos:n=null,alert:r=!0}={}){const i=document.createElement("dense-layer");return i.units=e,i.activation=t,i.firstNeuronPos=n,i.alert=r,dispatchEvent(new CustomEvent("layer-created",{detail:i,bubbles:!0,composed:!0})),i}getDescription(){return"A dense layer, also called fully-connected layer, is a layer whose inside neurons connect to every neuron in the preceding layer."}setNeurons(e){if(e>=1){if(e>this.neurons.length)for(let t=this.neurons.length+1;t<=e;t++)this.addNeuron();else if(e<this.neurons.length)for(let t=this.neurons.length;t>e;t--)this.removeNeuron();Ms({message:`The number of neurons in '${this.getName()}' has been updated to ${e}!`,variant:"success",icon:"check-circle"})}else Ms({message:`The number of neurons in '${this.getName()}' could not be updated to ${e}! Layer needs at least one neuron!`,variant:"warning",icon:"x-circle"})}duplicate(){const e={x:this.canvas.cy.getElementById(this.getCyId()).position().x,y:this.firstNeuronPos.y-this.canvas.getHeight(this.getCyId())-this.canvas.LAYER_DISTANCE};Pl.create({units:this.neurons.length,activation:this.activation,pos:e})}build(e){console.log(`Building layer ${this.getName()}`);let t;e.length>1?t=gIe({axis:1,name:`concatinputs-${this.getTensorName()}`}).apply(e):t=e[0],console.log("Input tensor:"),console.log(t),this.tensor=pIe({units:this.neurons.length,activation:L_.get(this.activation),name:this.getTensorName()}).apply(t),this.tensor.layer_id=this.id,console.log("This tensor:"),console.log(this.tensor)}render(){return super.render()}};Pl.LAYER_TYPE="Dense";Pl.LAYER_NAME="Dense layer";Pl.styles=[St];bFe([Q()],Pl.prototype,"units",2);Pl=bFe([ze("dense-layer")],Pl);var ZRt=Object.defineProperty,QRt=Object.getOwnPropertyDescriptor,L7=(e,t,n,r)=>{for(var i=r>1?void 0:r?QRt(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&ZRt(t,n,i),i};let jw=class extends _t{disconnectedCallback(){super.disconnectedCallback(),this.removeFromCanvas()}removeFromCanvas(){this.canvas.cy.filter(t=>t.isEdge()&&t.data("sourceLayer")==this.sourceLayer.layerId&&t.data("targetLayer")==this.targetLayer.layerId,this).remove()}render(){if(this.canvas.cy.getElementById(this.sourceLayer.getCyId()).length&&this.canvas.cy.getElementById(this.targetLayer.getCyId()).length){this.removeFromCanvas();const e=this.sourceLayer.getConnectionIds(),t=this.targetLayer.getConnectionIds();for(const n of e)for(const r of t)this.canvas.cy.add({group:"edges",data:{id:`${n}e${r}`,source:n,target:r,sourceLayer:this.sourceLayer.layerId,targetLayer:this.targetLayer.layerId}})}}};jw.styles=[St];L7([tn({context:Lm,subscribe:!0})],jw.prototype,"canvas",2);L7([Q()],jw.prototype,"sourceLayer",2);L7([Q()],jw.prototype,"targetLayer",2);jw=L7([ze("c-layer-connection")],jw);var JRt=Object.defineProperty,e4t=Object.getOwnPropertyDescriptor,YI=(e,t,n,r)=>{for(var i=r>1?void 0:r?e4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&JRt(t,n,i),i};let Vy=class extends _t{connectedCallback(){super.connectedCallback();const e=new CustomEvent("network-created",{detail:this,bubbles:!0,composed:!0});this.dispatchEvent(e),window.addEventListener("layer-created",t=>this.handleLayerCreated(t.detail)),this.renderRoot.addEventListener("layer-updated",t=>this.handleLayerUpdated(t.detail))}getInputLayers(){return Array.from(this.networkConf.layers.values()).filter(e=>e instanceof Vs)}getOutputLayer(){return Array.from(this.networkConf.layers.values()).find(e=>e instanceof $a)}getFreshId(){return this.networkConf.layers.size?Math.max(...this.networkConf.layers.keys())+1:1}removeLayer(e){for(const[t,n]of this.networkConf.layerConnections.entries())(n.sourceLayer==e||n.targetLayer==e)&&(console.log("removing connection"),console.log(t),this.networkConf.removeLayerConnection(t),console.log(this.networkConf.layerConnections));if(e instanceof Vs)for(const t of e.dataSetKeys)this.dataSet.unassignKey(t);e instanceof $a&&this.dataSet.unassignKey(e.dataSetLabel.key),this.networkConf.removeLayer(e.layerId),this.selected.select()}getTargetsFor(e){return Array.from(this.networkConf.layerConnections.keys()).filter(([t,n])=>t==e.layerId).map(([t,n])=>this.networkConf.layers.get(n))}getSourcesFor(e){return Array.from(this.networkConf.layerConnections.keys()).filter(([t,n])=>n==e.layerId).map(([t,n])=>this.networkConf.layers.get(t))}addLayerConnection(e,t){const n=document.createElement("c-layer-connection");n.sourceLayer=e,n.targetLayer=t,this.networkConf.addLayerConnection(n)}removeLayerConnection(e,t){this.networkConf.removeLayerConnection([e.layerId,t.layerId])}buildModel(){if(console.log("building network"),!this.getInputLayers().length)return Ms({message:"Your network must contain at least one input layer",variant:"warning",icon:"x-circle"}),null;if(!this.getOutputLayer())return Ms({message:"Your network must contain at least one output layer",variant:"warning",icon:"x-circle"}),null;Array.from(this.networkConf.layers.values()).forEach(i=>{i.tensor=null});const e=this.getInputLayers();for(;e.length;){const i=e[0];this.getSourcesFor(i).every(s=>s.tensor)&&i.build(this.getSourcesFor(i).map(s=>s.tensor)),this.getTargetsFor(i).forEach(s=>e.push(s)),e.shift()}if(!this.getOutputLayer().tensor)return Ms({message:"Make sure to have an output layer connected to the network!",variant:"warning",icon:"x-circle"}),null;const t=this.getInputLayers().map(i=>i.tensor),n=this.getOutputLayer().tensor,r=axt({inputs:t,outputs:n});return console.log(r),r}handleLayerCreated(e){e.layerId=this.getFreshId(),e instanceof Vs?e.dataSetKeys=this.dataSet.getNonAssignedInputKeys():e instanceof $a&&(e.dataSetLabel=this.dataSet.getLabelByKey(this.dataSet.getNonAssignedLabelKey())),this.networkConf.addLayer(e)}handleLayerUpdated(e){const t=Array.from(this.networkConf.layerConnections.keys()).filter(([n,r])=>n==e||r==e);for(const n of t)this.networkConf.layerConnections.get(n).requestUpdate()}handleDataSetChange(){if(this.dataSet){let e=`The data set has been set to '${this.dataSet.name}'!`;this.getInputLayers().length>=2&&(e+=" All inputs of this dataSet were assigned to the first input layer - all other input layers were deleted!"),Ms({message:e,variant:"success",icon:"check-circle"});for(let n=0;n<this.getInputLayers().length;n++)n==0?this.getInputLayers()[n].dataSetKeys=this.dataSet.getNonAssignedInputKeys():this.removeLayer(this.getInputLayers()[n]);const t=this.getOutputLayer();t&&(t.dataSetLabel=this.dataSet.getLabelByKey(this.dataSet.getNonAssignedLabelKey()))}}handleQueryLayerDeletion(e){this.removeLayer(e)}render(){return he` ${Array.from(this.networkConf.layers.values())}
    ${Array.from(this.networkConf.layerConnections.values())}`}};Vy.styles=[St];YI([tn({context:Lm,subscribe:!0})],Vy.prototype,"canvas",2);YI([tn({context:Jp,subscribe:!0})],Vy.prototype,"networkConf",2);YI([tn({context:Bm,subscribe:!0})],Vy.prototype,"dataSet",2);YI([tn({context:AC,subscribe:!0})],Vy.prototype,"selected",2);Vy=YI([ze("c-network")],Vy);var t4t=Object.defineProperty,n4t=Object.getOwnPropertyDescriptor,r4t=(e,t,n,r)=>{for(var i=r>1?void 0:r?n4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&t4t(t,n,i),i};let uX=class extends _t{render(){return he`
      <c-card>
        <div slot="title">Welcome :)</div>
        <div slot="content">
          Your network is currently empty - select an option below to get
          started! You can also find these and a few more options (like for
          building your network from scratch) in the right menu under the tab
          'network'.
        </div>
      </c-card>
    `}};uX.styles=[St];uX=r4t([ze("canvas-info-card")],uX);var i4t=Object.defineProperty,s4t=Object.getOwnPropertyDescriptor,B7=(e,t,n,r)=>{for(var i=r>1?void 0:r?s4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&i4t(t,n,i),i};let Hw=class extends _t{_handleImport(){}_handleExport(){}async _handleClear(){this.dispatchEvent(new CustomEvent("clear-network",{bubbles:!0,composed:!0}));let e;this.dataSet.name?e=await q2.getDataSetByName(this.dataSet.name):e=await q2.getDataSetByName(q2.getOptions()[0]);const t=new CustomEvent("change-data-set",{detail:e,bubbles:!0,composed:!0});this.dispatchEvent(t)}async _handleCreateFeedForwardNetwork(e){await this._handleClear();const t=Vs.create({pos:{x:0,y:0},alert:!1}),n=Pl.create({units:5,pos:{x:0,y:-300},alert:!1}),r=Pl.create({pos:{x:-350,y:-600},alert:!1}),i=Pl.create({units:3,pos:{x:300,y:-600},alert:!1}),s=$a.create({pos:{x:0,y:-900},alert:!1});this.networkConf.network.addLayerConnection(t,n),this.networkConf.network.addLayerConnection(n,r),this.networkConf.network.addLayerConnection(n,i),this.networkConf.network.addLayerConnection(r,s),this.networkConf.network.addLayerConnection(i,s),Ms({message:"A new feed forward network has been created!",variant:"success",icon:"check-circle"}),setTimeout(()=>{this.canvas.fit()},50)}render(){return he`
      <c-card>
        <div slot="title">Get started</div>
        <div slot="content">
          <c-button-group>
            <sl-button
              @click="${e=>{this._handleImport()}}"
            >
              <sl-icon slot="prefix" name="file-earmark-arrow-up"></sl-icon>
              Import
            </sl-button>
            <sl-button
              @click="${e=>{this._handleExport()}}"
            >
              <sl-icon slot="prefix" name="file-earmark-arrow-down"></sl-icon>
              Export
            </sl-button>
            <sl-button
              @click="${e=>{this._handleClear()}}"
            >
              <sl-icon slot="prefix" name="file-earmark-arrow-up"></sl-icon>
              Clear
            </sl-button>
          </c-button-group>
          <sl-button
            variant="primary"
            @click="${e=>{this._handleCreateFeedForwardNetwork()}}"
          >
            <sl-icon slot="prefix" name="file-earmark-plus"></sl-icon>
            Create feed forward network
          </sl-button>
        </div>
      </c-card>
    `}};Hw.styles=[St];B7([tn({context:Lm,subscribe:!0})],Hw.prototype,"canvas",2);B7([tn({context:Jp,subscribe:!0})],Hw.prototype,"networkConf",2);B7([tn({context:Bm,subscribe:!0})],Hw.prototype,"dataSet",2);Hw=B7([ze("get-started-card")],Hw);var a4t=Object.defineProperty,o4t=Object.getOwnPropertyDescriptor,z7=(e,t,n,r)=>{for(var i=r>1?void 0:r?o4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&a4t(t,n,i),i};let qw=class extends _t{async connectedCallback(){super.connectedCallback(),await this.updateComplete,this.dispatchEvent(new CustomEvent("canvas-created",{detail:this._canvasElm,bubbles:!0,composed:!0}))}_handleZoomIn(){this.canvas.zoomIn()}_handleCenter(){this.canvas.fit()}_handleZoomOut(){this.canvas.zoomOut()}render(){return he`
      <div id="canvasElm"></div>
      ${this.networkConf.layers.size?he``:he`
            <c-panel id="welcomeArea">
              <canvas-info-card></canvas-info-card>
              <get-started-card></get-started-card>
            </c-panel>
          `}
      <div id="canvasActions">
        <sl-tooltip content="Zoom in">
          <sl-button
            @click="${e=>this._handleZoomIn()}"
            circle
          >
            <sl-icon name="zoom-in"></sl-icon>
          </sl-button>
        </sl-tooltip>
        <sl-tooltip content="Zoom to network">
          <sl-button
            @click="${e=>this._handleCenter()}"
            circle
          >
            <sl-icon name="arrows-collapse"></sl-icon>
          </sl-button>
        </sl-tooltip>
        <sl-tooltip content="Zoom out">
          <sl-button
            @click="${e=>this._handleZoomOut()}"
            circle
          >
            <sl-icon name="zoom-out"></sl-icon>
          </sl-button>
        </sl-tooltip>
      </div>
    `}};qw.styles=[St,Xt`
      :host {
        position: relative;
      }

      #canvasElm {
        height: 100%;
        width: 100%;
        display: flex;
        align-items: center;
      }

      #welcomeArea {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
      }

      #canvasActions {
        position: absolute;
        bottom: 10px;
        right: 10px;
        display: grid;
        gap: 10px;
      }
    `];z7([pt("#canvasElm")],qw.prototype,"_canvasElm",2);z7([tn({context:Jp,subscribe:!0})],qw.prototype,"networkConf",2);z7([tn({context:Lm,subscribe:!0})],qw.prototype,"canvas",2);qw=z7([ze("canvas-area")],qw);var l4t=Object.defineProperty,u4t=Object.getOwnPropertyDescriptor,c4t=(e,t,n,r)=>{for(var i=r>1?void 0:r?u4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&l4t(t,n,i),i};let cX=class extends _t{render(){return he`
      <c-card>
        <div slot="title">Settings</div>
        <div slot="content">
          <p>
            Configure which options the users of this widget are allowed to view
            and edit
          </p>
          <h2>Network</h2>
          <sl-switch checked
            >Allow creating / changing the network topology using the 'quick
            setup' options</sl-switch
          >
          <sl-switch checked
            >Allow manual adding and removing of layers</sl-switch
          >
          <h2>DataSet</h2>
          <h2>Training</h2>
        </div>
      </c-card>
    `}};cX.styles=[St];cX=c4t([ze("settings-card")],cX);var f4t=Object.defineProperty,h4t=Object.getOwnPropertyDescriptor,d4t=(e,t,n,r)=>{for(var i=r>1?void 0:r?h4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&f4t(t,n,i),i};let fX=class extends _t{render(){return he`
      <c-panel name="settings">
        <settings-card></settings-card>
      </c-panel>
    `}};fX.styles=[St];fX=d4t([ze("settings-panel")],fX);var p4t=Object.defineProperty,g4t=Object.getOwnPropertyDescriptor,m4t=(e,t,n,r)=>{for(var i=r>1?void 0:r?g4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&p4t(t,n,i),i};let hX=class extends _t{render(){return he`
      <c-card>
        <div slot="title">Info</div>
        <div slot="content">
          Build your network by adding layers or choose a quick setup option
          below. Select layers in the graph to edit their properties and connect
          them with other layers.
        </div>
      </c-card>
    `}};hX.styles=[St];hX=m4t([ze("network-info-card")],hX);var v4t=Object.defineProperty,y4t=Object.getOwnPropertyDescriptor,xFe=(e,t,n,r)=>{for(var i=r>1?void 0:r?y4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&v4t(t,n,i),i};let K5=class extends _t{_handleAddInputLayer(){Vs.create()}_handleAddDenseLayer(){Pl.create()}_handleAddOutputLayer(){$a.create()}render(){return he`
      <c-card>
        <div slot="title">Add layer</div>
        <div slot="content">
          <c-button-group>
            <sl-button
              @click="${e=>this._handleAddInputLayer()}"
            >
              <sl-icon slot="prefix" name="plus-lg"></sl-icon>
              Input
            </sl-button>
            <sl-button
              @click="${e=>this._handleAddDenseLayer()}"
            >
              <sl-icon slot="prefix" name="plus-lg"></sl-icon>
              Dense
            </sl-button>
            <sl-button
              @click="${e=>this._handleAddOutputLayer()}"
            >
              <sl-icon slot="prefix" name="plus-lg"></sl-icon>
              Output
            </sl-button>
          </c-button-group>
        </div>
      </c-card>
    `}};K5.styles=[St];xFe([tn({context:Jp,subscribe:!0})],K5.prototype,"networkConf",2);K5=xFe([ze("network-add-layer-card")],K5);var b4t=Object.defineProperty,x4t=Object.getOwnPropertyDescriptor,w4t=(e,t,n,r)=>{for(var i=r>1?void 0:r?x4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&b4t(t,n,i),i};let dX=class extends _t{render(){return he`
      <c-panel name="network">
        <network-info-card></network-info-card>
        <get-started-card></get-started-card>
        <network-add-layer-card> </network-add-layer-card>
      </c-panel>
    `}};dX.styles=[St];dX=w4t([ze("network-panel")],dX);var $4t=Object.defineProperty,C4t=Object.getOwnPropertyDescriptor,wFe=(e,t,n,r)=>{for(var i=r>1?void 0:r?C4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&$4t(t,n,i),i};let Z5=class extends _t{_handleSelectDataProperty(e){this.dispatchEvent(new CustomEvent("clicked-data-property",{detail:e.key}))}render(){return he`
      <c-card>
        <div slot="title">Info</div>
        <div slot="content">
          <div>
            <p>${this.dataSet.description}</p>
            <h2>Inputs</h2>
            <div class="data-pills">
              ${this.dataSet.inputs.map(e=>he`
                  <c-data-info
                    .dataProperty="${e}"
                    class="clickable"
                    @click="${t=>this._handleSelectDataProperty(e)}"
                  ></c-data-info>
                `)}
            </div>
            <h2>Output</h2>
            <div class="data-pills">
              <c-data-info .dataProperty="${this.dataSet.label}"></c-data-info>
            </div>
          </div>
        </div>
      </c-card>
    `}};Z5.styles=[St,Xt`
      .data-pills {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        gap: 5px;
      }

      .clickable:hover {
        cursor: pointer;
      }
    `];wFe([Q()],Z5.prototype,"dataSet",2);Z5=wFe([ze("data-set-info-card")],Z5);var pre={};const $Fe=Ob(Avt);var gre={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var _4t=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),S4t=Object.prototype.hasOwnProperty;function pX(e,t){return S4t.call(e,t)}function gX(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)pX(e,i)&&r.push(i);return r}function Il(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function mX(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function Yv(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function CFe(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function vX(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(vX(e[t]))return!0}else if(typeof e=="object"){for(var r=gX(e),i=r.length,s=0;s<i;s++)if(vX(e[r[s]]))return!0}}return!1}function P0e(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var _Fe=function(e){_4t(t,e);function t(n,r,i,s,a){var o=this.constructor,l=e.call(this,P0e(n,{name:r,index:i,operation:s,tree:a}))||this;return l.name=r,l.index=i,l.operation=s,l.tree=a,Object.setPrototypeOf(l,o.prototype),l.message=P0e(n,{name:r,index:i,operation:s,tree:a}),l}return t}(Error),Hr=_Fe,k4t=Il,I2={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=Q5(n,this.path);r&&(r=Il(r));var i=ey(n,{op:"remove",path:this.from}).removed;return ey(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=Q5(n,this.from);return ey(n,{op:"add",path:this.path,value:Il(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:OT(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},E4t={add:function(e,t,n){return mX(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:I2.move,copy:I2.copy,test:I2.test,_get:I2._get};function Q5(e,t){if(t=="")return e;var n={op:"_get",path:t};return ey(e,n),n.value}function ey(e,t,n,r,i,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):J5(t,0)),t.path===""){var a={newDocument:e};if(t.op==="add")return a.newDocument=t.value,a;if(t.op==="replace")return a.newDocument=t.value,a.removed=e,a;if(t.op==="move"||t.op==="copy")return a.newDocument=Q5(e,t.from),t.op==="move"&&(a.removed=e),a;if(t.op==="test"){if(a.test=OT(e,t.value),a.test===!1)throw new Hr("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return a.newDocument=e,a}else{if(t.op==="remove")return a.removed=e,a.newDocument=null,a;if(t.op==="_get")return t.value=e,a;if(n)throw new Hr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return a}}else{r||(e=Il(e));var o=t.path||"",l=o.split("/"),u=e,c=1,f=l.length,h=void 0,d=void 0,p=void 0;for(typeof n=="function"?p=n:p=J5;;){if(d=l[c],d&&d.indexOf("~")!=-1&&(d=CFe(d)),i&&(d=="__proto__"||d=="prototype"&&c>0&&l[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&h===void 0&&(u[d]===void 0?h=l.slice(0,c).join("/"):c==f-1&&(h=t.path),h!==void 0&&p(t,0,e,h)),c++,Array.isArray(u)){if(d==="-")d=u.length;else{if(n&&!mX(d))throw new Hr("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);mX(d)&&(d=~~d)}if(c>=f){if(n&&t.op==="add"&&d>u.length)throw new Hr("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var a=E4t[t.op].call(t,u,d,e);if(a.test===!1)throw new Hr("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return a}}else if(c>=f){var a=I2[t.op].call(t,u,d,e);if(a.test===!1)throw new Hr("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return a}if(u=u[d],n&&c<f&&(!u||typeof u!="object"))throw new Hr("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function U7(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new Hr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Il(e));for(var s=new Array(t.length),a=0,o=t.length;a<o;a++)s[a]=ey(e,t[a],n,!0,i,a),e=s[a].newDocument;return s.newDocument=e,s}function A4t(e,t,n){var r=ey(e,t);if(r.test===!1)throw new Hr("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function J5(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Hr("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(I2[e.op]){if(typeof e.path!="string")throw new Hr("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Hr('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Hr("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Hr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&vX(e.value))throw new Hr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new Hr("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Hr("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var a={op:"_get",path:e.from,value:void 0},o=SFe([a],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new Hr("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Hr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function SFe(e,t,n){try{if(!Array.isArray(e))throw new Hr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)U7(Il(t),Il(e),n||!0);else{n=n||J5;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof Hr)return i;throw i}}function OT(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,s,a;if(n&&r){if(s=e.length,s!=t.length)return!1;for(i=s;i--!==0;)if(!OT(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var o=Object.keys(e);if(s=o.length,s!==Object.keys(t).length)return!1;for(i=s;i--!==0;)if(!t.hasOwnProperty(o[i]))return!1;for(i=s;i--!==0;)if(a=o[i],!OT(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}const T4t=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:Hr,deepClone:k4t,getValueByPointer:Q5,applyOperation:ey,applyPatch:U7,applyReducer:A4t,validator:J5,validate:SFe,_areEquals:OT},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var mre=new WeakMap,D4t=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),N4t=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function I4t(e){return mre.get(e)}function M4t(e,t){return e.observers.get(t)}function F4t(e,t){e.observers.delete(t.callback)}function O4t(e,t){t.unobserve()}function R4t(e,t){var n=[],r,i=I4t(e);if(!i)i=new D4t(e),mre.set(e,i);else{var s=M4t(i,t);r=s&&s.observer}if(r)return r;if(r={},i.value=Il(e),t){r.callback=t,r.next=null;var a=function(){yX(r)},o=function(){clearTimeout(r.next),r.next=setTimeout(a)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return r.patches=n,r.object=e,r.unobserve=function(){yX(r),clearTimeout(r.next),F4t(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},i.observers.set(t,new N4t(t,r)),r}function yX(e,t){t===void 0&&(t=!1);var n=mre.get(e.object);vre(n.value,e.object,e.patches,"",t),e.patches.length&&U7(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function vre(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=gX(t),a=gX(e),o=!1,l=a.length-1;l>=0;l--){var u=a[l],c=e[u];if(pX(t,u)&&!(t[u]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[u];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?vre(c,f,n,r+"/"+Yv(u),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+Yv(u),value:Il(c)}),n.push({op:"replace",path:r+"/"+Yv(u),value:Il(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+Yv(u),value:Il(c)}),n.push({op:"remove",path:r+"/"+Yv(u)}),o=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!o&&s.length==a.length))for(var l=0;l<s.length;l++){var u=s[l];!pX(e,u)&&t[u]!==void 0&&n.push({op:"add",path:r+"/"+Yv(u),value:Il(t[u])})}}}function P4t(e,t,n){n===void 0&&(n=!1);var r=[];return vre(e,t,r,"",n),r}const L4t=Object.freeze(Object.defineProperty({__proto__:null,unobserve:O4t,observe:R4t,generate:yX,compare:P4t},Symbol.toStringTag,{value:"Module"}));Object.assign({},T4t,L4t,{JsonPatchError:_Fe,deepClone:Il,escapePathComponent:Yv,unescapePathComponent:CFe});var B4t=/("(?:[^\\"]|\\.)*")|[:,]/g,kj=function(t,n){var r,i,s;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,s=n.replacer,function a(o,l,u){var c,f,h,d,p,g,m,v,y,b,x,w;if(o&&typeof o.toJSON=="function"&&(o=o.toJSON()),x=JSON.stringify(o,s),x===void 0)return x;if(m=i-l.length-u,x.length<=m&&(y=x.replace(B4t,function(C,$){return $||C+" "}),y.length<=m))return y;if(s!=null&&(o=JSON.parse(x),s=void 0),typeof o=="object"&&o!==null){if(v=l+r,h=[],f=0,Array.isArray(o))for(b="[",c="]",m=o.length;f<m;f++)h.push(a(o[f],v,f===m-1?0:1)||"null");else for(b="{",c="}",g=Object.keys(o),m=g.length;f<m;f++)d=g[f],p=JSON.stringify(d)+": ",w=a(o[d],v,p.length+(f===m-1?0:1)),w!==void 0&&h.push(p+w);if(h.length>0)return[b,r+h.join(`,
`+v),c].join(`
`+l)}return x}(t,"",0)},jy={exports:{}};const z4t="2.0.0",kFe=256,U4t=Number.MAX_SAFE_INTEGER||9007199254740991,W4t=16,V4t=kFe-6,j4t=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var W7={MAX_LENGTH:kFe,MAX_SAFE_COMPONENT_LENGTH:W4t,MAX_SAFE_BUILD_LENGTH:V4t,MAX_SAFE_INTEGER:U4t,RELEASE_TYPES:j4t,SEMVER_SPEC_VERSION:z4t,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const H4t=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var V7=H4t;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=W7,s=V7;t=e.exports={};const a=t.re=[],o=t.safeRe=[],l=t.src=[],u=t.t={};let c=0;const f="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",i],[f,r]],d=g=>{for(const[m,v]of h)g=g.split(`${m}*`).join(`${m}{0,${v}}`).split(`${m}+`).join(`${m}{1,${v}}`);return g},p=(g,m,v)=>{const y=d(m),b=c++;s(g,b,m),u[g]=b,l[b]=m,a[b]=new RegExp(m,v?"g":void 0),o[b]=new RegExp(y,v?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),p("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${l[u.NUMERICIDENTIFIER]}|${l[u.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NUMERICIDENTIFIERLOOSE]}|${l[u.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${f}+`),p("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),p("FULL",`^${l[u.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),p("LOOSE",`^${l[u.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),p("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),p("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),p("COERCERTL",l[u.COERCE],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(jy,jy.exports);const q4t=Object.freeze({loose:!0}),G4t=Object.freeze({}),Y4t=e=>e?typeof e!="object"?q4t:e:G4t;var yre=Y4t;const L0e=/^[0-9]+$/,EFe=(e,t)=>{const n=L0e.test(e),r=L0e.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},X4t=(e,t)=>EFe(t,e);var AFe={compareIdentifiers:EFe,rcompareIdentifiers:X4t};const vO=V7,{MAX_LENGTH:B0e,MAX_SAFE_INTEGER:yO}=W7,{safeRe:z0e,t:U0e}=jy.exports,K4t=yre,{compareIdentifiers:n2}=AFe;class fc{constructor(t,n){if(n=K4t(n),t instanceof fc){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>B0e)throw new TypeError(`version is longer than ${B0e} characters`);vO("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?z0e[U0e.LOOSE]:z0e[U0e.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>yO||this.major<0)throw new TypeError("Invalid major version");if(this.minor>yO||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>yO||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const s=+i;if(s>=0&&s<yO)return s}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(vO("SemVer.compare",this.version,this.options,t),!(t instanceof fc)){if(typeof t=="string"&&t===this.version)return 0;t=new fc(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof fc||(t=new fc(t,this.options)),n2(this.major,t.major)||n2(this.minor,t.minor)||n2(this.patch,t.patch)}comparePre(t){if(t instanceof fc||(t=new fc(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(vO("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return n2(r,i)}while(++n)}compareBuild(t){t instanceof fc||(t=new fc(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(vO("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return n2(r,i)}while(++n)}inc(t,n,r){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(r)?1:0;if(!n&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(n===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(n){let s=[n,i];r===!1&&(s=[n]),n2(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}var Eo=fc;const W0e=Eo,Z4t=(e,t,n=!1)=>{if(e instanceof W0e)return e;try{return new W0e(e,t)}catch(r){if(!n)return null;throw r}};var B_=Z4t;const Q4t=B_,J4t=(e,t)=>{const n=Q4t(e,t);return n?n.version:null};var e5t=J4t;const t5t=B_,n5t=(e,t)=>{const n=t5t(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var r5t=n5t;const V0e=Eo,i5t=(e,t,n,r,i)=>{typeof n=="string"&&(i=r,r=n,n=void 0);try{return new V0e(e instanceof V0e?e.version:e,n).inc(t,r,i).version}catch{return null}};var s5t=i5t;const j0e=B_,a5t=(e,t)=>{const n=j0e(e,null,!0),r=j0e(t,null,!0),i=n.compare(r);if(i===0)return null;const s=i>0,a=s?n:r,o=s?r:n,l=!!a.prerelease.length;if(!!o.prerelease.length&&!l)return!o.patch&&!o.minor?"major":a.patch?"patch":a.minor?"minor":"major";const c=l?"pre":"";return n.major!==r.major?c+"major":n.minor!==r.minor?c+"minor":n.patch!==r.patch?c+"patch":"prerelease"};var o5t=a5t;const l5t=Eo,u5t=(e,t)=>new l5t(e,t).major;var c5t=u5t;const f5t=Eo,h5t=(e,t)=>new f5t(e,t).minor;var d5t=h5t;const p5t=Eo,g5t=(e,t)=>new p5t(e,t).patch;var m5t=g5t;const v5t=B_,y5t=(e,t)=>{const n=v5t(e,t);return n&&n.prerelease.length?n.prerelease:null};var b5t=y5t;const H0e=Eo,x5t=(e,t,n)=>new H0e(e,n).compare(new H0e(t,n));var df=x5t;const w5t=df,$5t=(e,t,n)=>w5t(t,e,n);var C5t=$5t;const _5t=df,S5t=(e,t)=>_5t(e,t,!0);var k5t=S5t;const q0e=Eo,E5t=(e,t,n)=>{const r=new q0e(e,n),i=new q0e(t,n);return r.compare(i)||r.compareBuild(i)};var bre=E5t;const A5t=bre,T5t=(e,t)=>e.sort((n,r)=>A5t(n,r,t));var D5t=T5t;const N5t=bre,I5t=(e,t)=>e.sort((n,r)=>N5t(r,n,t));var M5t=I5t;const F5t=df,O5t=(e,t,n)=>F5t(e,t,n)>0;var j7=O5t;const R5t=df,P5t=(e,t,n)=>R5t(e,t,n)<0;var xre=P5t;const L5t=df,B5t=(e,t,n)=>L5t(e,t,n)===0;var TFe=B5t;const z5t=df,U5t=(e,t,n)=>z5t(e,t,n)!==0;var DFe=U5t;const W5t=df,V5t=(e,t,n)=>W5t(e,t,n)>=0;var wre=V5t;const j5t=df,H5t=(e,t,n)=>j5t(e,t,n)<=0;var $re=H5t;const q5t=TFe,G5t=DFe,Y5t=j7,X5t=wre,K5t=xre,Z5t=$re,Q5t=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return q5t(e,n,r);case"!=":return G5t(e,n,r);case">":return Y5t(e,n,r);case">=":return X5t(e,n,r);case"<":return K5t(e,n,r);case"<=":return Z5t(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var NFe=Q5t;const J5t=Eo,ePt=B_,{safeRe:bO,t:xO}=jy.exports,tPt=(e,t)=>{if(e instanceof J5t)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(bO[xO.COERCE]);else{let r;for(;(r=bO[xO.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||r.index+r[0].length!==n.index+n[0].length)&&(n=r),bO[xO.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;bO[xO.COERCERTL].lastIndex=-1}return n===null?null:ePt(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var nPt=tPt,Ej,G0e;function rPt(){return G0e||(G0e=1,Ej=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}),Ej}var iPt=wn;wn.Node=Hy;wn.create=wn;function wn(e){var t=this;if(t instanceof wn||(t=new wn),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}wn.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};wn.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};wn.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};wn.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)aPt(this,arguments[e]);return this.length};wn.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)oPt(this,arguments[e]);return this.length};wn.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};wn.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};wn.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next};wn.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev};wn.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};wn.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};wn.prototype.map=function(e,t){t=t||this;for(var n=new wn,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n};wn.prototype.mapReverse=function(e,t){t=t||this;for(var n=new wn,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n};wn.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=e(n,r.value,i),r=r.next;return n};wn.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=e(n,r.value,i),r=r.prev;return n};wn.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};wn.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};wn.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new wn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(;i!==null&&r<t;r++,i=i.next)n.push(i.value);return n};wn.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new wn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;i!==null&&r>t;r--)i=i.prev;for(;i!==null&&r>e;r--,i=i.prev)n.push(i.value);return n};wn.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(var s=[],r=0;i&&r<t;r++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=sPt(this,i,n[r]);return s};wn.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function sPt(e,t,n){var r=t===e.head?new Hy(n,null,t,e):new Hy(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function aPt(e,t){e.tail=new Hy(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function oPt(e,t){e.head=new Hy(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Hy(e,t,n,r){if(!(this instanceof Hy))return new Hy(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{rPt()(wn)}catch{}const lPt=iPt,a1=Symbol("max"),zd=Symbol("length"),r2=Symbol("lengthCalculator"),uA=Symbol("allowStale"),T1=Symbol("maxAge"),Pd=Symbol("dispose"),Y0e=Symbol("noDisposeOnSet"),Yi=Symbol("lruList"),hc=Symbol("cache"),IFe=Symbol("updateAgeOnGet"),Aj=()=>1;class uPt{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[a1]=t.max||1/0;const n=t.length||Aj;if(this[r2]=typeof n!="function"?Aj:n,this[uA]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[T1]=t.maxAge||0,this[Pd]=t.dispose,this[Y0e]=t.noDisposeOnSet||!1,this[IFe]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[a1]=t||1/0,ek(this)}get max(){return this[a1]}set allowStale(t){this[uA]=!!t}get allowStale(){return this[uA]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[T1]=t,ek(this)}get maxAge(){return this[T1]}set lengthCalculator(t){typeof t!="function"&&(t=Aj),t!==this[r2]&&(this[r2]=t,this[zd]=0,this[Yi].forEach(n=>{n.length=this[r2](n.value,n.key),this[zd]+=n.length})),ek(this)}get lengthCalculator(){return this[r2]}get length(){return this[zd]}get itemCount(){return this[Yi].length}rforEach(t,n){n=n||this;for(let r=this[Yi].tail;r!==null;){const i=r.prev;X0e(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(let r=this[Yi].head;r!==null;){const i=r.next;X0e(this,t,r,n),r=i}}keys(){return this[Yi].toArray().map(t=>t.key)}values(){return this[Yi].toArray().map(t=>t.value)}reset(){this[Pd]&&this[Yi]&&this[Yi].length&&this[Yi].forEach(t=>this[Pd](t.key,t.value)),this[hc]=new Map,this[Yi]=new lPt,this[zd]=0}dump(){return this[Yi].map(t=>eP(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Yi]}set(t,n,r){if(r=r||this[T1],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,s=this[r2](n,t);if(this[hc].has(t)){if(s>this[a1])return Z2(this,this[hc].get(t)),!1;const l=this[hc].get(t).value;return this[Pd]&&(this[Y0e]||this[Pd](t,l.value)),l.now=i,l.maxAge=r,l.value=n,this[zd]+=s-l.length,l.length=s,this.get(t),ek(this),!0}const a=new cPt(t,n,s,i,r);return a.length>this[a1]?(this[Pd]&&this[Pd](t,n),!1):(this[zd]+=a.length,this[Yi].unshift(a),this[hc].set(t,this[Yi].head),ek(this),!0)}has(t){if(!this[hc].has(t))return!1;const n=this[hc].get(t).value;return!eP(this,n)}get(t){return Tj(this,t,!0)}peek(t){return Tj(this,t,!1)}pop(){const t=this[Yi].tail;return t?(Z2(this,t),t.value):null}del(t){Z2(this,this[hc].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const i=t[r],s=i.e||0;if(s===0)this.set(i.k,i.v);else{const a=s-n;a>0&&this.set(i.k,i.v,a)}}}prune(){this[hc].forEach((t,n)=>Tj(this,n,!1))}}const Tj=(e,t,n)=>{const r=e[hc].get(t);if(r){const i=r.value;if(eP(e,i)){if(Z2(e,r),!e[uA])return}else n&&(e[IFe]&&(r.value.now=Date.now()),e[Yi].unshiftNode(r));return i.value}},eP=(e,t)=>{if(!t||!t.maxAge&&!e[T1])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[T1]&&n>e[T1]},ek=e=>{if(e[zd]>e[a1])for(let t=e[Yi].tail;e[zd]>e[a1]&&t!==null;){const n=t.prev;Z2(e,t),t=n}},Z2=(e,t)=>{if(t){const n=t.value;e[Pd]&&e[Pd](n.key,n.value),e[zd]-=n.length,e[hc].delete(n.key),e[Yi].removeNode(t)}};class cPt{constructor(t,n,r,i,s){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=s||0}}const X0e=(e,t,n,r)=>{let i=n.value;eP(e,i)&&(Z2(e,n),e[uA]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var fPt=uPt,Dj,K0e;function pf(){if(K0e)return Dj;K0e=1;class e{constructor(D,T){if(T=r(T),D instanceof e)return D.loose===!!T.loose&&D.includePrerelease===!!T.includePrerelease?D:new e(D.raw,T);if(D instanceof i)return this.raw=D.value,this.set=[[D]],this.format(),this;if(this.options=T,this.loose=!!T.loose,this.includePrerelease=!!T.includePrerelease,this.raw=D.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(I=>this.parseRange(I.trim())).filter(I=>I.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const I=this.set[0];if(this.set=this.set.filter(F=>!p(F[0])),this.set.length===0)this.set=[I];else if(this.set.length>1){for(const F of this.set)if(F.length===1&&g(F[0])){this.set=[F];break}}}this.format()}format(){return this.range=this.set.map(D=>D.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(D){const I=((this.options.includePrerelease&&h)|(this.options.loose&&d))+":"+D,F=n.get(I);if(F)return F;const R=this.options.loose,P=R?o[l.HYPHENRANGELOOSE]:o[l.HYPHENRANGE];D=D.replace(P,S(this.options.includePrerelease)),s("hyphen replace",D),D=D.replace(o[l.COMPARATORTRIM],u),s("comparator trim",D),D=D.replace(o[l.TILDETRIM],c),s("tilde trim",D),D=D.replace(o[l.CARETTRIM],f),s("caret trim",D);let V=D.split(" ").map(K=>v(K,this.options)).join(" ").split(/\s+/).map(K=>E(K,this.options));R&&(V=V.filter(K=>(s("loose invalid filter",K,this.options),!!K.match(o[l.COMPARATORLOOSE])))),s("range list",V);const z=new Map,q=V.map(K=>new i(K,this.options));for(const K of q){if(p(K))return[K];z.set(K.value,K)}z.size>1&&z.has("")&&z.delete("");const G=[...z.values()];return n.set(I,G),G}intersects(D,T){if(!(D instanceof e))throw new TypeError("a Range is required");return this.set.some(I=>m(I,T)&&D.set.some(F=>m(F,T)&&I.every(R=>F.every(P=>R.intersects(P,T)))))}test(D){if(!D)return!1;if(typeof D=="string")try{D=new a(D,this.options)}catch{return!1}for(let T=0;T<this.set.length;T++)if(N(this.set[T],D,this.options))return!0;return!1}}Dj=e;const t=fPt,n=new t({max:1e3}),r=yre,i=H7(),s=V7,a=Eo,{safeRe:o,t:l,comparatorTrimReplace:u,tildeTrimReplace:c,caretTrimReplace:f}=jy.exports,{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:d}=W7,p=A=>A.value==="<0.0.0-0",g=A=>A.value==="",m=(A,D)=>{let T=!0;const I=A.slice();let F=I.pop();for(;T&&I.length;)T=I.every(R=>F.intersects(R,D)),F=I.pop();return T},v=(A,D)=>(s("comp",A,D),A=w(A,D),s("caret",A),A=b(A,D),s("tildes",A),A=$(A,D),s("xrange",A),A=k(A,D),s("stars",A),A),y=A=>!A||A.toLowerCase()==="x"||A==="*",b=(A,D)=>A.trim().split(/\s+/).map(T=>x(T,D)).join(" "),x=(A,D)=>{const T=D.loose?o[l.TILDELOOSE]:o[l.TILDE];return A.replace(T,(I,F,R,P,V)=>{s("tilde",A,I,F,R,P,V);let z;return y(F)?z="":y(R)?z=`>=${F}.0.0 <${+F+1}.0.0-0`:y(P)?z=`>=${F}.${R}.0 <${F}.${+R+1}.0-0`:V?(s("replaceTilde pr",V),z=`>=${F}.${R}.${P}-${V} <${F}.${+R+1}.0-0`):z=`>=${F}.${R}.${P} <${F}.${+R+1}.0-0`,s("tilde return",z),z})},w=(A,D)=>A.trim().split(/\s+/).map(T=>C(T,D)).join(" "),C=(A,D)=>{s("caret",A,D);const T=D.loose?o[l.CARETLOOSE]:o[l.CARET],I=D.includePrerelease?"-0":"";return A.replace(T,(F,R,P,V,z)=>{s("caret",A,F,R,P,V,z);let q;return y(R)?q="":y(P)?q=`>=${R}.0.0${I} <${+R+1}.0.0-0`:y(V)?R==="0"?q=`>=${R}.${P}.0${I} <${R}.${+P+1}.0-0`:q=`>=${R}.${P}.0${I} <${+R+1}.0.0-0`:z?(s("replaceCaret pr",z),R==="0"?P==="0"?q=`>=${R}.${P}.${V}-${z} <${R}.${P}.${+V+1}-0`:q=`>=${R}.${P}.${V}-${z} <${R}.${+P+1}.0-0`:q=`>=${R}.${P}.${V}-${z} <${+R+1}.0.0-0`):(s("no pr"),R==="0"?P==="0"?q=`>=${R}.${P}.${V}${I} <${R}.${P}.${+V+1}-0`:q=`>=${R}.${P}.${V}${I} <${R}.${+P+1}.0-0`:q=`>=${R}.${P}.${V} <${+R+1}.0.0-0`),s("caret return",q),q})},$=(A,D)=>(s("replaceXRanges",A,D),A.split(/\s+/).map(T=>_(T,D)).join(" ")),_=(A,D)=>{A=A.trim();const T=D.loose?o[l.XRANGELOOSE]:o[l.XRANGE];return A.replace(T,(I,F,R,P,V,z)=>{s("xRange",A,I,F,R,P,V,z);const q=y(R),G=q||y(P),K=G||y(V),Y=K;return F==="="&&Y&&(F=""),z=D.includePrerelease?"-0":"",q?F===">"||F==="<"?I="<0.0.0-0":I="*":F&&Y?(G&&(P=0),V=0,F===">"?(F=">=",G?(R=+R+1,P=0,V=0):(P=+P+1,V=0)):F==="<="&&(F="<",G?R=+R+1:P=+P+1),F==="<"&&(z="-0"),I=`${F+R}.${P}.${V}${z}`):G?I=`>=${R}.0.0${z} <${+R+1}.0.0-0`:K&&(I=`>=${R}.${P}.0${z} <${R}.${+P+1}.0-0`),s("xRange return",I),I})},k=(A,D)=>(s("replaceStars",A,D),A.trim().replace(o[l.STAR],"")),E=(A,D)=>(s("replaceGTE0",A,D),A.trim().replace(o[D.includePrerelease?l.GTE0PRE:l.GTE0],"")),S=A=>(D,T,I,F,R,P,V,z,q,G,K,Y,te)=>(y(I)?T="":y(F)?T=`>=${I}.0.0${A?"-0":""}`:y(R)?T=`>=${I}.${F}.0${A?"-0":""}`:P?T=`>=${T}`:T=`>=${T}${A?"-0":""}`,y(q)?z="":y(G)?z=`<${+q+1}.0.0-0`:y(K)?z=`<${q}.${+G+1}.0-0`:Y?z=`<=${q}.${G}.${K}-${Y}`:A?z=`<${q}.${G}.${+K+1}-0`:z=`<=${z}`,`${T} ${z}`.trim()),N=(A,D,T)=>{for(let I=0;I<A.length;I++)if(!A[I].test(D))return!1;if(D.prerelease.length&&!T.includePrerelease){for(let I=0;I<A.length;I++)if(s(A[I].semver),A[I].semver!==i.ANY&&A[I].semver.prerelease.length>0){const F=A[I].semver;if(F.major===D.major&&F.minor===D.minor&&F.patch===D.patch)return!0}return!1}return!0};return Dj}var Nj,Z0e;function H7(){if(Z0e)return Nj;Z0e=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=n(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),a("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(c){const f=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],h=c.match(f);if(!h)throw new TypeError(`Invalid comparator: ${c}`);this.operator=h[1]!==void 0?h[1]:"",this.operator==="="&&(this.operator=""),h[2]?this.semver=new o(h[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(a("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new o(c,this.options)}catch{return!1}return s(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new l(this.value,f).test(c.semver):(f=n(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||s(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||s(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}Nj=t;const n=yre,{safeRe:r,t:i}=jy.exports,s=NFe,a=V7,o=Eo,l=pf();return Nj}const hPt=pf(),dPt=(e,t,n)=>{try{t=new hPt(t,n)}catch{return!1}return t.test(e)};var q7=dPt;const pPt=pf(),gPt=(e,t)=>new pPt(e,t).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));var mPt=gPt;const vPt=Eo,yPt=pf(),bPt=(e,t,n)=>{let r=null,i=null,s=null;try{s=new yPt(t,n)}catch{return null}return e.forEach(a=>{s.test(a)&&(!r||i.compare(a)===-1)&&(r=a,i=new vPt(r,n))}),r};var xPt=bPt;const wPt=Eo,$Pt=pf(),CPt=(e,t,n)=>{let r=null,i=null,s=null;try{s=new $Pt(t,n)}catch{return null}return e.forEach(a=>{s.test(a)&&(!r||i.compare(a)===1)&&(r=a,i=new wPt(r,n))}),r};var _Pt=CPt;const Ij=Eo,SPt=pf(),Q0e=j7,kPt=(e,t)=>{e=new SPt(e,t);let n=new Ij("0.0.0");if(e.test(n)||(n=new Ij("0.0.0-0"),e.test(n)))return n;n=null;for(let r=0;r<e.set.length;++r){const i=e.set[r];let s=null;i.forEach(a=>{const o=new Ij(a.semver.version);switch(a.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!s||Q0e(o,s))&&(s=o);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!n||Q0e(n,s))&&(n=s)}return n&&e.test(n)?n:null};var EPt=kPt;const APt=pf(),TPt=(e,t)=>{try{return new APt(e,t).range||"*"}catch{return null}};var DPt=TPt;const NPt=Eo,MFe=H7(),{ANY:IPt}=MFe,MPt=pf(),FPt=q7,J0e=j7,eme=xre,OPt=$re,RPt=wre,PPt=(e,t,n,r)=>{e=new NPt(e,r),t=new MPt(t,r);let i,s,a,o,l;switch(n){case">":i=J0e,s=OPt,a=eme,o=">",l=">=";break;case"<":i=eme,s=RPt,a=J0e,o="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(FPt(e,t,r))return!1;for(let u=0;u<t.set.length;++u){const c=t.set[u];let f=null,h=null;if(c.forEach(d=>{d.semver===IPt&&(d=new MFe(">=0.0.0")),f=f||d,h=h||d,i(d.semver,f.semver,r)?f=d:a(d.semver,h.semver,r)&&(h=d)}),f.operator===o||f.operator===l||(!h.operator||h.operator===o)&&s(e,h.semver))return!1;if(h.operator===l&&a(e,h.semver))return!1}return!0};var Cre=PPt;const LPt=Cre,BPt=(e,t,n)=>LPt(e,t,">",n);var zPt=BPt;const UPt=Cre,WPt=(e,t,n)=>UPt(e,t,"<",n);var VPt=WPt;const tme=pf(),jPt=(e,t,n)=>(e=new tme(e,n),t=new tme(t,n),e.intersects(t,n));var HPt=jPt;const qPt=q7,GPt=df;var YPt=(e,t,n)=>{const r=[];let i=null,s=null;const a=e.sort((c,f)=>GPt(c,f,n));for(const c of a)qPt(c,t,n)?(s=c,i||(i=c)):(s&&r.push([i,s]),s=null,i=null);i&&r.push([i,null]);const o=[];for(const[c,f]of r)c===f?o.push(c):!f&&c===a[0]?o.push("*"):f?c===a[0]?o.push(`<=${f}`):o.push(`${c} - ${f}`):o.push(`>=${c}`);const l=o.join(" || "),u=typeof t.raw=="string"?t.raw:String(t);return l.length<u.length?l:t};const nme=pf(),_re=H7(),{ANY:Mj}=_re,tk=q7,Sre=df,XPt=(e,t,n={})=>{if(e===t)return!0;e=new nme(e,n),t=new nme(t,n);let r=!1;e:for(const i of e.set){for(const s of t.set){const a=ZPt(i,s,n);if(r=r||a!==null,a)continue e}if(r)return!1}return!0},KPt=[new _re(">=0.0.0-0")],rme=[new _re(">=0.0.0")],ZPt=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===Mj){if(t.length===1&&t[0].semver===Mj)return!0;n.includePrerelease?e=KPt:e=rme}if(t.length===1&&t[0].semver===Mj){if(n.includePrerelease)return!0;t=rme}const r=new Set;let i,s;for(const d of e)d.operator===">"||d.operator===">="?i=ime(i,d,n):d.operator==="<"||d.operator==="<="?s=sme(s,d,n):r.add(d.semver);if(r.size>1)return null;let a;if(i&&s){if(a=Sre(i.semver,s.semver,n),a>0)return null;if(a===0&&(i.operator!==">="||s.operator!=="<="))return null}for(const d of r){if(i&&!tk(d,String(i),n)||s&&!tk(d,String(s),n))return null;for(const p of t)if(!tk(d,String(p),n))return!1;return!0}let o,l,u,c,f=s&&!n.includePrerelease&&s.semver.prerelease.length?s.semver:!1,h=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&s.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const d of t){if(c=c||d.operator===">"||d.operator===">=",u=u||d.operator==="<"||d.operator==="<=",i){if(h&&d.semver.prerelease&&d.semver.prerelease.length&&d.semver.major===h.major&&d.semver.minor===h.minor&&d.semver.patch===h.patch&&(h=!1),d.operator===">"||d.operator===">="){if(o=ime(i,d,n),o===d&&o!==i)return!1}else if(i.operator===">="&&!tk(i.semver,String(d),n))return!1}if(s){if(f&&d.semver.prerelease&&d.semver.prerelease.length&&d.semver.major===f.major&&d.semver.minor===f.minor&&d.semver.patch===f.patch&&(f=!1),d.operator==="<"||d.operator==="<="){if(l=sme(s,d,n),l===d&&l!==s)return!1}else if(s.operator==="<="&&!tk(s.semver,String(d),n))return!1}if(!d.operator&&(s||i)&&a!==0)return!1}return!(i&&u&&!s&&a!==0||s&&c&&!i&&a!==0||h||f)},ime=(e,t,n)=>{if(!e)return t;const r=Sre(e.semver,t.semver,n);return r>0?e:r<0||t.operator===">"&&e.operator===">="?t:e},sme=(e,t,n)=>{if(!e)return t;const r=Sre(e.semver,t.semver,n);return r<0?e:r>0||t.operator==="<"&&e.operator==="<="?t:e};var QPt=XPt;const Fj=jy.exports,ame=W7,JPt=Eo,ome=AFe,eLt=B_,tLt=e5t,nLt=r5t,rLt=s5t,iLt=o5t,sLt=c5t,aLt=d5t,oLt=m5t,lLt=b5t,uLt=df,cLt=C5t,fLt=k5t,hLt=bre,dLt=D5t,pLt=M5t,gLt=j7,mLt=xre,vLt=TFe,yLt=DFe,bLt=wre,xLt=$re,wLt=NFe,$Lt=nPt,CLt=H7(),_Lt=pf(),SLt=q7,kLt=mPt,ELt=xPt,ALt=_Pt,TLt=EPt,DLt=DPt,NLt=Cre,ILt=zPt,MLt=VPt,FLt=HPt,OLt=YPt,RLt=QPt;var FFe={parse:eLt,valid:tLt,clean:nLt,inc:rLt,diff:iLt,major:sLt,minor:aLt,patch:oLt,prerelease:lLt,compare:uLt,rcompare:cLt,compareLoose:fLt,compareBuild:hLt,sort:dLt,rsort:pLt,gt:gLt,lt:mLt,eq:vLt,neq:yLt,gte:bLt,lte:xLt,cmp:wLt,coerce:$Lt,Comparator:CLt,Range:_Lt,satisfies:SLt,toComparators:kLt,maxSatisfying:ELt,minSatisfying:ALt,minVersion:TLt,validRange:DLt,outside:NLt,gtr:ILt,ltr:MLt,intersects:FLt,simplifyRange:OLt,subset:RLt,SemVer:JPt,re:Fj.re,src:Fj.src,tokens:Fj.t,SEMVER_SPEC_VERSION:ame.SEMVER_SPEC_VERSION,RELEASE_TYPES:ame.RELEASE_TYPES,compareIdentifiers:ome.compareIdentifiers,rcompareIdentifiers:ome.rcompareIdentifiers};function lg(e,t,n){return e.fields=t||[],e.fname=n,e}function PLt(e){return e==null?null:e.fname}function OFe(e){return e==null?null:e.fields}function RFe(e){return e.length===1?LLt(e[0]):BLt(e)}const LLt=e=>function(t){return t[e]},BLt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function o4(e){throw Error(e)}function kre(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o),s+=e.substring(++o,++o),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||o4("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&o4("Access path missing closing bracket: "+e),r&&o4("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function Ere(e,t,n){const r=kre(e);return e=r.length===1?r[0]:e,lg((n&&n.get||RFe)(r),[e],t||e)}const zLt=Ere("id"),Are=lg(e=>e,[],"identity"),ULt=lg(()=>0,[],"zero"),WLt=lg(()=>1,[],"one"),VLt=lg(()=>!0,[],"true"),jLt=lg(()=>!1,[],"false");function wO(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const PFe=0,LFe=1,BFe=2,zFe=3,UFe=4;function HLt(e,t){let n=e||PFe;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=LFe&&wO(t||"error","ERROR",arguments),this},warn(){return n>=BFe&&wO(t||"warn","WARN",arguments),this},info(){return n>=zFe&&wO(t||"log","INFO",arguments),this},debug(){return n>=UFe&&wO(t||"log","DEBUG",arguments),this}}}var G7=Array.isArray;function tP(e){return e===Object(e)}const lme=e=>e!=="__proto__";function Tre(...e){return e.reduce((t,n)=>{for(const r in n)if(r==="signals")t.signals=qLt(t.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;Y7(t,r,n[r],i)}return t},{})}function Y7(e,t,n,r){if(!lme(t))return;let i,s;if(tP(n)&&!G7(n)){s=tP(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?Y7(s,i,n[i]):lme(i)&&(s[i]=n[i])}else e[t]=n}function qLt(e,t){if(e==null)return t;const n={},r=[];function i(s){n[s.name]||(n[s.name]=1,r.push(s))}return t.forEach(i),e.forEach(i),r}function z_(e){return e[e.length-1]}function Dre(e){return e==null||e===""?null:+e}const WFe=e=>t=>e*Math.exp(t),VFe=e=>t=>Math.log(e*t),jFe=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),HFe=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,nP=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function X7(e,t,n,r){const i=n(e[0]),s=n(z_(e)),a=(s-i)*t;return[r(i-a),r(s-a)]}function GLt(e,t){return X7(e,t,Dre,Are)}function YLt(e,t){var n=Math.sign(e[0]);return X7(e,t,VFe(n),WFe(n))}function XLt(e,t,n){return X7(e,t,nP(n),nP(1/n))}function KLt(e,t,n){return X7(e,t,jFe(n),HFe(n))}function K7(e,t,n,r,i){const s=r(e[0]),a=r(z_(e)),o=t!=null?r(t):(s+a)/2;return[i(o+(s-o)*n),i(o+(a-o)*n)]}function ZLt(e,t,n){return K7(e,t,n,Dre,Are)}function QLt(e,t,n){const r=Math.sign(e[0]);return K7(e,t,n,VFe(r),WFe(r))}function JLt(e,t,n,r){return K7(e,t,n,nP(r),nP(1/r))}function e6t(e,t,n,r){return K7(e,t,n,jFe(r),HFe(r))}function t6t(e){return 1+~~(new Date(e).getMonth()/3)}function n6t(e){return 1+~~(new Date(e).getUTCMonth()/3)}function RT(e){return e!=null?G7(e)?e:[e]:[]}function r6t(e,t,n){let r=e[0],i=e[1],s;return i<r&&(s=i,i=r,r=s),s=i-r,s>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-s),r+s]}function Z7(e){return typeof e=="function"}const i6t="descending";function s6t(e,t,n){n=n||{},t=RT(t)||[];const r=[],i=[],s={},a=n.comparator||a6t;return RT(e).forEach((o,l)=>{o!=null&&(r.push(t[l]===i6t?-1:1),i.push(o=Z7(o)?o:Ere(o,null,n)),(OFe(o)||[]).forEach(u=>s[u]=1))}),i.length===0?null:lg(a(i,r),Object.keys(s))}const Nre=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),a6t=(e,t)=>e.length===1?o6t(e[0],t[0]):l6t(e,t,e.length),o6t=(e,t)=>function(n,r){return Nre(e(n),e(r))*t},l6t=(e,t,n)=>(t.push(0),function(r,i){let s,a=0,o=-1;for(;a===0&&++o<n;)s=e[o],a=Nre(s(r),s(i));return a*t[o]});function u6t(e){return Z7(e)?e:()=>e}function c6t(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function Ire(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function f6t(e,t){let n=0,r,i,s,a;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(s=a=i;n<r;++n)i=e[n],i!=null&&(i<s&&(s=i),i>a&&(a=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(s=a=i;n<r;++n)i=t(e[n]),i!=null&&(i<s&&(s=i),i>a&&(a=i))}return[s,a]}function h6t(e,t){const n=e.length;let r=-1,i,s,a,o,l;if(t==null){for(;++r<n;)if(s=e[r],s!=null&&s>=s){i=a=s;break}if(r===n)return[-1,-1];for(o=l=r;++r<n;)s=e[r],s!=null&&(i>s&&(i=s,o=r),a<s&&(a=s,l=r))}else{for(;++r<n;)if(s=t(e[r],r,e),s!=null&&s>=s){i=a=s;break}if(r===n)return[-1,-1];for(o=l=r;++r<n;)s=t(e[r],r,e),s!=null&&(i>s&&(i=s,o=r),a<s&&(a=s,l=r))}return[o,l]}const d6t=Object.prototype.hasOwnProperty;function o1(e,t){return d6t.call(e,t)}const $O={};function p6t(e){let t={},n;function r(s){return o1(t,s)&&t[s]!==$O}const i={size:0,empty:0,object:t,has:r,get(s){return r(s)?t[s]:void 0},set(s,a){return r(s)||(++i.size,t[s]===$O&&--i.empty),t[s]=a,this},delete(s){return r(s)&&(--i.size,++i.empty,t[s]=$O),this},clear(){i.size=i.empty=0,i.object=t={}},test(s){return arguments.length?(n=s,i):n},clean(){const s={};let a=0;for(const o in t){const l=t[o];l!==$O&&(!n||!n(l))&&(s[o]=l,++a)}i.size=a,i.empty=0,i.object=t=s}};return e&&Object.keys(e).forEach(s=>{i.set(s,e[s])}),i}function g6t(e,t,n,r,i,s){if(!n&&n!==0)return s;const a=+n;let o=e[0],l=z_(e),u;l<o&&(u=o,o=l,l=u),u=Math.abs(t-o);const c=Math.abs(l-t);return u<c&&u<=a?r:c<=a?i:s}function m6t(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ire(r,n)}function v6t(e,t,n,r){let i=t[0],s=t[t.length-1],a;return i>s&&(a=i,i=s,s=a),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=s:e<s)}function qFe(e){return typeof e=="boolean"}function GFe(e){return Object.prototype.toString.call(e)==="[object Date]"}function y6t(e){return e&&Z7(e[Symbol.iterator])}function YFe(e){return typeof e=="number"}function b6t(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function PT(e){return typeof e=="string"}function x6t(e,t,n){e&&(e=t?RT(e).map(o=>o.replace(/\\(.)/g,"$1")):RT(e));const r=e&&e.length,i=n&&n.get||RFe,s=o=>i(t?[o]:kre(o));let a;if(!r)a=function(){return""};else if(r===1){const o=s(e[0]);a=function(l){return""+o(l)}}else{const o=e.map(s);a=function(l){let u=""+o[0](l),c=0;for(;++c<r;)u+="|"+o[c](l);return u}}return lg(a,e,"key")}function w6t(e,t){const n=e[0],r=z_(e),i=+t;return i?i===1?r:n+i*(r-n):n}const $6t=1e4;function C6t(e){e=+e||$6t;let t,n,r;const i=()=>{t={},n={},r=0},s=(a,o)=>(++r>e&&(n=t,t={},r=1),t[a]=o);return i(),{clear:i,has:a=>o1(t,a)||o1(n,a),get:a=>o1(t,a)?t[a]:o1(n,a)?s(a,n[a]):void 0,set:(a,o)=>o1(t,a)?t[a]=o:s(a,o)}}function _6t(e,t,n,r){const i=t.length,s=n.length;if(!s)return t;if(!i)return n;const a=r||new t.constructor(i+s);let o=0,l=0,u=0;for(;o<i&&l<s;++u)a[u]=e(t[o],n[l])>0?n[l++]:t[o++];for(;o<i;++o,++u)a[u]=t[o];for(;l<s;++l,++u)a[u]=n[l];return a}function cE(e,t){let n="";for(;--t>=0;)n+=e;return n}function S6t(e,t,n,r){const i=n||" ",s=e+"",a=t-s.length;return a<=0?s:r==="left"?cE(i,a)+s:r==="center"?cE(i,~~(a/2))+s+cE(i,Math.ceil(a/2)):s+cE(i,a)}function k6t(e){return e&&z_(e)-e[0]||0}function XFe(e){return G7(e)?"["+e.map(XFe)+"]":tP(e)||PT(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function E6t(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const A6t=e=>YFe(e)||GFe(e)?e:Date.parse(e);function T6t(e,t){return t=t||A6t,e==null||e===""?null:t(e)}function D6t(e){return e==null||e===""?null:e+""}function N6t(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function I6t(e,t,n,r){const i=r!=null?r:"\u2026",s=e+"",a=s.length,o=Math.max(0,t-i.length);return a<=t?s:n==="left"?i+s.slice(a-o):n==="center"?s.slice(0,Math.ceil(o/2))+i+s.slice(a-~~(o/2)):s.slice(0,o)+i}function M6t(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const s=t(e[i]);s&&n(s,i,e)}}else e.forEach(n)}function eu(e,t,n){return e.fields=t||[],e.fname=n,e}function li(e){return e==null?null:e.fname}function lo(e){return e==null?null:e.fields}function KFe(e){return e.length===1?F6t(e[0]):O6t(e)}const F6t=e=>function(t){return t[e]},O6t=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function $e(e){throw Error(e)}function Mre(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||$e("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&$e("Access path missing closing bracket: "+e),r&&$e("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function ql(e,t,n){const r=Mre(e);return e=r.length===1?r[0]:e,eu((n&&n.get||KFe)(r),[e],t||e)}const Q7=ql("id"),ll=eu(e=>e,[],"identity"),l1=eu(()=>0,[],"zero"),XI=eu(()=>1,[],"one"),ef=eu(()=>!0,[],"true"),Tv=eu(()=>!1,[],"false");function R6t(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const P6t=0,ZFe=1,L6t=2,B6t=3,z6t=4;function U6t(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:R6t,r=e||P6t;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=ZFe&&n(t||"error","ERROR",arguments),this},warn(){return r>=L6t&&n(t||"warn","WARN",arguments),this},info(){return r>=B6t&&n(t||"log","INFO",arguments),this},debug(){return r>=z6t&&n(t||"log","DEBUG",arguments),this}}}var at=Array.isArray;function Ft(e){return e===Object(e)}const ume=e=>e!=="__proto__";function W6t(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((r,i)=>{for(const s in i)if(s==="signals")r.signals=V6t(r.signals,i.signals);else{const a=s==="legend"?{layout:1}:s==="style"?!0:null;QFe(r,s,i[s],a)}return r},{})}function QFe(e,t,n,r){if(!ume(t))return;let i,s;if(Ft(n)&&!at(n)){s=Ft(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?QFe(s,i,n[i]):ume(i)&&(s[i]=n[i])}else e[t]=n}function V6t(e,t){if(e==null)return t;const n={},r=[];function i(s){n[s.name]||(n[s.name]=1,r.push(s))}return t.forEach(i),e.forEach(i),r}function un(e){return e[e.length-1]}function ao(e){return e==null||e===""?null:+e}const JFe=e=>t=>e*Math.exp(t),eOe=e=>t=>Math.log(e*t),tOe=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),nOe=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,rP=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function J7(e,t,n,r){const i=n(e[0]),s=n(un(e)),a=(s-i)*t;return[r(i-a),r(s-a)]}function j6t(e,t){return J7(e,t,ao,ll)}function H6t(e,t){var n=Math.sign(e[0]);return J7(e,t,eOe(n),JFe(n))}function q6t(e,t,n){return J7(e,t,rP(n),rP(1/n))}function G6t(e,t,n){return J7(e,t,tOe(n),nOe(n))}function e9(e,t,n,r,i){const s=r(e[0]),a=r(un(e)),o=t!=null?r(t):(s+a)/2;return[i(o+(s-o)*n),i(o+(a-o)*n)]}function rOe(e,t,n){return e9(e,t,n,ao,ll)}function iOe(e,t,n){const r=Math.sign(e[0]);return e9(e,t,n,eOe(r),JFe(r))}function bX(e,t,n,r){return e9(e,t,n,rP(r),rP(1/r))}function sOe(e,t,n,r){return e9(e,t,n,tOe(r),nOe(r))}function Y6t(e){return 1+~~(new Date(e).getMonth()/3)}function X6t(e){return 1+~~(new Date(e).getUTCMonth()/3)}function ct(e){return e!=null?at(e)?e:[e]:[]}function K6t(e,t,n){let r=e[0],i=e[1],s;return i<r&&(s=i,i=r,r=s),s=i-r,s>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-s),r+s]}function Ut(e){return typeof e=="function"}const Z6t="descending";function aOe(e,t,n){n=n||{},t=ct(t)||[];const r=[],i=[],s={},a=n.comparator||Q6t;return ct(e).forEach((o,l)=>{o!=null&&(r.push(t[l]===Z6t?-1:1),i.push(o=Ut(o)?o:ql(o,null,n)),(lo(o)||[]).forEach(u=>s[u]=1))}),i.length===0?null:eu(a(i,r),Object.keys(s))}const Fre=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),Q6t=(e,t)=>e.length===1?J6t(e[0],t[0]):e8t(e,t,e.length),J6t=(e,t)=>function(n,r){return Fre(e(n),e(r))*t},e8t=(e,t,n)=>(t.push(0),function(r,i){let s,a=0,o=-1;for(;a===0&&++o<n;)s=e[o],a=Fre(s(r),s(i));return a*t[o]});function vo(e){return Ut(e)?e:()=>e}function oOe(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function zt(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function Rp(e,t){let n=0,r,i,s,a;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(s=a=i;n<r;++n)i=e[n],i!=null&&(i<s&&(s=i),i>a&&(a=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(s=a=i;n<r;++n)i=t(e[n]),i!=null&&(i<s&&(s=i),i>a&&(a=i))}return[s,a]}function t8t(e,t){const n=e.length;let r=-1,i,s,a,o,l;if(t==null){for(;++r<n;)if(s=e[r],s!=null&&s>=s){i=a=s;break}if(r===n)return[-1,-1];for(o=l=r;++r<n;)s=e[r],s!=null&&(i>s&&(i=s,o=r),a<s&&(a=s,l=r))}else{for(;++r<n;)if(s=t(e[r],r,e),s!=null&&s>=s){i=a=s;break}if(r===n)return[-1,-1];for(o=l=r;++r<n;)s=t(e[r],r,e),s!=null&&(i>s&&(i=s,o=r),a<s&&(a=s,l=r))}return[o,l]}const n8t=Object.prototype.hasOwnProperty;function bt(e,t){return n8t.call(e,t)}const CO={};function KI(e){let t={},n;function r(s){return bt(t,s)&&t[s]!==CO}const i={size:0,empty:0,object:t,has:r,get(s){return r(s)?t[s]:void 0},set(s,a){return r(s)||(++i.size,t[s]===CO&&--i.empty),t[s]=a,this},delete(s){return r(s)&&(--i.size,++i.empty,t[s]=CO),this},clear(){i.size=i.empty=0,i.object=t={}},test(s){return arguments.length?(n=s,i):n},clean(){const s={};let a=0;for(const o in t){const l=t[o];l!==CO&&(!n||!n(l))&&(s[o]=l,++a)}i.size=a,i.empty=0,i.object=t=s}};return e&&Object.keys(e).forEach(s=>{i.set(s,e[s])}),i}function r8t(e,t,n,r,i,s){if(!n&&n!==0)return s;const a=+n;let o=e[0],l=un(e),u;l<o&&(u=o,o=l,l=u),u=Math.abs(t-o);const c=Math.abs(l-t);return u<c&&u<=a?r:c<=a?i:s}function Ne(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),zt(r,n)}function fE(e,t,n,r){let i=t[0],s=t[t.length-1],a;return i>s&&(a=i,i=s,s=a),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=s:e<s)}function i8t(e){return typeof e=="boolean"}function ty(e){return Object.prototype.toString.call(e)==="[object Date]"}function s8t(e){return e&&Ut(e[Symbol.iterator])}function LT(e){return typeof e=="number"}function a8t(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function $r(e){return typeof e=="string"}function lOe(e,t,n){e&&(e=t?ct(e).map(o=>o.replace(/\\(.)/g,"$1")):ct(e));const r=e&&e.length,i=n&&n.get||KFe,s=o=>i(t?[o]:Mre(o));let a;if(!r)a=function(){return""};else if(r===1){const o=s(e[0]);a=function(l){return""+o(l)}}else{const o=e.map(s);a=function(l){let u=""+o[0](l),c=0;for(;++c<r;)u+="|"+o[c](l);return u}}return eu(a,e,"key")}function o8t(e,t){const n=e[0],r=un(e),i=+t;return i?i===1?r:n+i*(r-n):n}const l8t=1e4;function u8t(e){e=+e||l8t;let t,n,r;const i=()=>{t={},n={},r=0},s=(a,o)=>(++r>e&&(n=t,t={},r=1),t[a]=o);return i(),{clear:i,has:a=>bt(t,a)||bt(n,a),get:a=>bt(t,a)?t[a]:bt(n,a)?s(a,n[a]):void 0,set:(a,o)=>bt(t,a)?t[a]=o:s(a,o)}}function c8t(e,t,n,r){const i=t.length,s=n.length;if(!s)return t;if(!i)return n;const a=r||new t.constructor(i+s);let o=0,l=0,u=0;for(;o<i&&l<s;++u)a[u]=e(t[o],n[l])>0?n[l++]:t[o++];for(;o<i;++o,++u)a[u]=t[o];for(;l<s;++l,++u)a[u]=n[l];return a}function _O(e,t){let n="";for(;--t>=0;)n+=e;return n}function f8t(e,t,n,r){const i=n||" ",s=e+"",a=t-s.length;return a<=0?s:r==="left"?_O(i,a)+s:r==="center"?_O(i,~~(a/2))+s+_O(i,Math.ceil(a/2)):s+_O(i,a)}function t9(e){return e&&un(e)-e[0]||0}function ot(e){return at(e)?"["+e.map(ot)+"]":Ft(e)||$r(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function uOe(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const h8t=e=>LT(e)||ty(e)?e:Date.parse(e);function cOe(e,t){return t=t||h8t,e==null||e===""?null:t(e)}function fOe(e){return e==null||e===""?null:e+""}function Rh(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function d8t(e,t,n,r){const i=r!=null?r:"\u2026",s=e+"",a=s.length,o=Math.max(0,t-i.length);return a<=t?s:n==="left"?i+s.slice(a-o):n==="center"?s.slice(0,Math.ceil(o/2))+i+s.slice(a-~~(o/2)):s.slice(0,o)+i}function Xv(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const s=t(e[i]);s&&n(s,i,e)}}else e.forEach(n)}var cme={},Oj={},Rj=34,nk=10,Pj=13;function hOe(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function p8t(e,t){var n=hOe(e);return function(r,i){return t(n(r),i,e)}}function fme(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Fo(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function g8t(e){return e<0?"-"+Fo(-e,6):e>9999?"+"+Fo(e,6):Fo(e,4)}function m8t(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":g8t(e.getUTCFullYear())+"-"+Fo(e.getUTCMonth()+1,2)+"-"+Fo(e.getUTCDate(),2)+(i?"T"+Fo(t,2)+":"+Fo(n,2)+":"+Fo(r,2)+"."+Fo(i,3)+"Z":r?"T"+Fo(t,2)+":"+Fo(n,2)+":"+Fo(r,2)+"Z":n||t?"T"+Fo(t,2)+":"+Fo(n,2)+"Z":"")}function v8t(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,h){var d,p,g=i(f,function(m,v){if(d)return d(m,v-1);p=m,d=h?p8t(m,h):hOe(m)});return g.columns=p||[],g}function i(f,h){var d=[],p=f.length,g=0,m=0,v,y=p<=0,b=!1;f.charCodeAt(p-1)===nk&&--p,f.charCodeAt(p-1)===Pj&&--p;function x(){if(y)return Oj;if(b)return b=!1,cme;var C,$=g,_;if(f.charCodeAt($)===Rj){for(;g++<p&&f.charCodeAt(g)!==Rj||f.charCodeAt(++g)===Rj;);return(C=g)>=p?y=!0:(_=f.charCodeAt(g++))===nk?b=!0:_===Pj&&(b=!0,f.charCodeAt(g)===nk&&++g),f.slice($+1,C-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(C=g++))===nk)b=!0;else if(_===Pj)b=!0,f.charCodeAt(g)===nk&&++g;else if(_!==n)continue;return f.slice($,C)}return y=!0,f.slice($,p)}for(;(v=x())!==Oj;){for(var w=[];v!==cme&&v!==Oj;)w.push(v),v=x();h&&(w=h(w,m++))==null||d.push(w)}return d}function s(f,h){return f.map(function(d){return h.map(function(p){return c(d[p])}).join(e)})}function a(f,h){return h==null&&(h=fme(f)),[h.map(c).join(e)].concat(s(f,h)).join(`
`)}function o(f,h){return h==null&&(h=fme(f)),s(f,h).join(`
`)}function l(f){return f.map(u).join(`
`)}function u(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?m8t(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:a,formatBody:o,formatRows:l,formatRow:u,formatValue:c}}function y8t(e){return e}function b8t(e){if(e==null)return y8t;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],a=e.translate[1];return function(o,l){l||(t=n=0);var u=2,c=o.length,f=new Array(c);for(f[0]=(t+=o[0])*r+s,f[1]=(n+=o[1])*i+a;u<c;)f[u]=o[u],++u;return f}}function x8t(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function dOe(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return hme(e,n)})}:hme(e,t)}function hme(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,s=pOe(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function pOe(e,t){var n=b8t(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var h=r[c<0?~c:c],d=0,p=h.length;d<p;++d)f.push(n(h[d],d));c<0&&x8t(f,p)}function s(c){return n(c)}function a(c){for(var f=[],h=0,d=c.length;h<d;++h)i(c[h],f);return f.length<2&&f.push(f[0]),f}function o(c){for(var f=a(c);f.length<4;)f.push(f[0]);return f}function l(c){return c.map(o)}function u(c){var f=c.type,h;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(u)};case"Point":h=s(c.coordinates);break;case"MultiPoint":h=c.coordinates.map(s);break;case"LineString":h=a(c.arcs);break;case"MultiLineString":h=c.arcs.map(a);break;case"Polygon":h=l(c.arcs);break;case"MultiPolygon":h=c.arcs.map(l);break;default:return null}return{type:f,coordinates:h}}return u(t)}function w8t(e,t){var n={},r={},i={},s=[],a=-1;t.forEach(function(u,c){var f=e.arcs[u<0?~u:u],h;f.length<3&&!f[1][0]&&!f[1][1]&&(h=t[++a],t[a]=u,t[c]=h)}),t.forEach(function(u){var c=o(u),f=c[0],h=c[1],d,p;if(d=i[f])if(delete i[d.end],d.push(u),d.end=h,p=r[h]){delete r[p.start];var g=p===d?d:d.concat(p);r[g.start=d.start]=i[g.end=p.end]=g}else r[d.start]=i[d.end]=d;else if(d=r[h])if(delete r[d.start],d.unshift(u),d.start=f,p=i[f]){delete i[p.end];var m=p===d?d:p.concat(d);r[m.start=p.start]=i[m.end=d.end]=m}else r[d.start]=i[d.end]=d;else d=[u],r[d.start=f]=i[d.end=h]=d});function o(u){var c=e.arcs[u<0?~u:u],f=c[0],h;return e.transform?(h=[0,0],c.forEach(function(d){h[0]+=d[0],h[1]+=d[1]})):h=c[c.length-1],u<0?[h,f]:[f,h]}function l(u,c){for(var f in u){var h=u[f];delete c[h.start],delete h.start,delete h.end,h.forEach(function(d){n[d<0?~d:d]=1}),s.push(h)}}return l(i,r),l(r,i),t.forEach(function(u){n[u<0?~u:u]||s.push([u])}),s}function gOe(e){return pOe(e,$8t.apply(this,arguments))}function $8t(e,t,n){var r,i,s;if(arguments.length>1)r=C8t(e,t,n);else for(i=0,r=new Array(s=e.arcs.length);i<s;++i)r[i]=i;return{type:"MultiLineString",arcs:w8t(e,r)}}function C8t(e,t,n){var r=[],i=[],s;function a(f){var h=f<0?~f:f;(i[h]||(i[h]=[])).push({i:f,g:s})}function o(f){f.forEach(a)}function l(f){f.forEach(o)}function u(f){f.forEach(l)}function c(f){switch(s=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":o(f.arcs);break;case"MultiLineString":case"Polygon":l(f.arcs);break;case"MultiPolygon":u(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}class Gw extends Map{constructor(t,n=yOe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(xX(this,t))}has(t){return super.has(xX(this,t))}set(t,n){return super.set(mOe(this,t),n)}delete(t){return super.delete(vOe(this,t))}}class iP extends Set{constructor(t,n=yOe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(xX(this,t))}add(t){return super.add(mOe(this,t))}delete(t){return super.delete(vOe(this,t))}}function xX({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function mOe({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function vOe({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function yOe(e){return e!==null&&typeof e=="object"?e.valueOf():e}const _8t=Math.sqrt(50),S8t=Math.sqrt(10),k8t=Math.sqrt(2);function bOe(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=_8t?10:s>=S8t?5:s>=k8t?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?bOe(e,t,n*2):[o,l,u]}function dme(e,t,n){return t=+t,e=+e,n=+n,bOe(e,t,n)[2]}function E8t(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?dme(t,e,n):dme(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function A8t(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function sP(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Yw(e){return e=sP(Math.abs(e)),e?e[1]:NaN}function T8t(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function D8t(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var N8t=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function BT(e){if(!(t=N8t.exec(e)))throw new Error("invalid format: "+e);var t;return new Ore({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}BT.prototype=Ore.prototype;function Ore(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Ore.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function I8t(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var xOe;function M8t(e,t){var n=sP(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(xOe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+sP(e,Math.max(0,t+s-1))[0]}function pme(e,t){var n=sP(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const gme={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:A8t,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>pme(e*100,t),r:pme,s:M8t,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function mme(e){return e}var vme=Array.prototype.map,yme=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function wOe(e){var t=e.grouping===void 0||e.thousands===void 0?mme:T8t(vme.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?mme:D8t(vme.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=BT(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):gme[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var C=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=g==="$"?r:/[%p]/.test(w)?a:"",_=gme[w],k=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(S){var N=C,A=$,D,T,I;if(w==="c")A=_(S)+A,S="";else{S=+S;var F=S<0||1/S<0;if(S=isNaN(S)?l:_(Math.abs(S),b),x&&(S=I8t(S)),F&&+S==0&&p!=="+"&&(F=!1),N=(F?p==="("?p:o:p==="-"||p==="("?"":p)+N,A=(w==="s"?yme[8+xOe/3]:"")+A+(F&&p==="("?")":""),k){for(D=-1,T=S.length;++D<T;)if(I=S.charCodeAt(D),48>I||I>57){A=(I===46?i+S.slice(D+1):S.slice(D))+A,S=S.slice(0,D);break}}}y&&!m&&(S=t(S,1/0));var R=N.length+S.length+A.length,P=R<v?new Array(v-R+1).join(h):"";switch(y&&m&&(S=t(P+S,P.length?v-A.length:1/0),P=""),d){case"<":S=N+S+A+P;break;case"=":S=N+P+S+A;break;case"^":S=P.slice(0,R=P.length>>1)+N+S+A+P.slice(R);break;default:S=P+N+S+A;break}return s(S)}return E.toString=function(){return f+""},E}function c(f,h){var d=u((f=BT(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Yw(h)/3)))*3,g=Math.pow(10,-p),m=yme[8+p/3];return function(v){return d(g*v)+m}}return{format:u,formatPrefix:c}}var SO,$Oe,COe;F8t({thousands:",",grouping:[3],currency:["$",""]});function F8t(e){return SO=wOe(e),$Oe=SO.format,COe=SO.formatPrefix,SO}function O8t(e){return Math.max(0,-Yw(Math.abs(e)))}function R8t(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Yw(t)/3)))*3-Yw(Math.abs(e)))}function P8t(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Yw(t)-Yw(e))+1}const Lj=new Date,Bj=new Date;function Bi(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>Bi(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(Lj.setTime(+s),Bj.setTime(+a),e(Lj),e(Bj),Math.floor(n(Lj,Bj))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const zT=Bi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);zT.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Bi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):zT);zT.range;const UT=1e3,Q0=UT*60,WT=Q0*60,VT=WT*24,_Oe=VT*7,Rre=Bi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*UT)},(e,t)=>(t-e)/UT,e=>e.getUTCSeconds());Rre.range;const SOe=Bi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*UT)},(e,t)=>{e.setTime(+e+t*Q0)},(e,t)=>(t-e)/Q0,e=>e.getMinutes());SOe.range;const kOe=Bi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Q0)},(e,t)=>(t-e)/Q0,e=>e.getUTCMinutes());kOe.range;const EOe=Bi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*UT-e.getMinutes()*Q0)},(e,t)=>{e.setTime(+e+t*WT)},(e,t)=>(t-e)/WT,e=>e.getHours());EOe.range;const AOe=Bi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*WT)},(e,t)=>(t-e)/WT,e=>e.getUTCHours());AOe.range;const cA=Bi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Q0)/VT,e=>e.getDate()-1);cA.range;const fA=Bi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/VT,e=>e.getUTCDate()-1);fA.range;const L8t=Bi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/VT,e=>Math.floor(e/VT));L8t.range;function ex(e){return Bi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Q0)/_Oe)}const Pre=ex(0),B8t=ex(1),z8t=ex(2),U8t=ex(3),W8t=ex(4),V8t=ex(5),j8t=ex(6);Pre.range;B8t.range;z8t.range;U8t.range;W8t.range;V8t.range;j8t.range;function tx(e){return Bi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/_Oe)}const Lre=tx(0),H8t=tx(1),q8t=tx(2),G8t=tx(3),Y8t=tx(4),X8t=tx(5),K8t=tx(6);Lre.range;H8t.range;q8t.range;G8t.range;Y8t.range;X8t.range;K8t.range;const wX=Bi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());wX.range;const $X=Bi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());$X.range;const Bre=Bi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Bre.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Bi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Bre.range;const zre=Bi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());zre.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Bi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});zre.range;function zj(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Z8t(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Q8t(e){let t,n,r;e.length!==2?(t=zj,n=(o,l)=>zj(e(o),l),r=(o,l)=>e(o)-l):(t=e===zj||e===Z8t?e:J8t,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function J8t(){return 0}const eBt=Math.sqrt(50),tBt=Math.sqrt(10),nBt=Math.sqrt(2);function TOe(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=eBt?10:s>=tBt?5:s>=nBt?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?TOe(e,t,n*2):[o,l,u]}function bme(e,t,n){return t=+t,e=+e,n=+n,TOe(e,t,n)[2]}function xme(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?bme(t,e,n):bme(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}const Ca="year",Gl="quarter",uo="month",es="week",Yl="date",no="day",Pp="dayofyear",Pu="hours",Lu="minutes",tf="seconds",Ph="milliseconds",DOe=[Ca,Gl,uo,es,Yl,no,Pp,Pu,Lu,tf,Ph],Uj=DOe.reduce((e,t,n)=>(e[t]=1+n,e),{});function NOe(e){const t=ct(e).slice(),n={};return t.length||$e("Missing time unit."),t.forEach(i=>{bt(Uj,i)?n[i]=1:$e(`Invalid time unit: ${i}.`)}),(n[es]||n[no]?1:0)+(n[Gl]||n[uo]||n[Yl]?1:0)+(n[Pp]?1:0)>1&&$e(`Incompatible time units: ${e}`),t.sort((i,s)=>Uj[i]-Uj[s]),t}const rBt={[Ca]:"%Y ",[Gl]:"Q%q ",[uo]:"%b ",[Yl]:"%d ",[es]:"W%U ",[no]:"%a ",[Pp]:"%j ",[Pu]:"%H:00",[Lu]:"00:%M",[tf]:":%S",[Ph]:".%L",[`${Ca}-${uo}`]:"%Y-%m ",[`${Ca}-${uo}-${Yl}`]:"%Y-%m-%d ",[`${Pu}-${Lu}`]:"%H:%M"};function iBt(e,t){const n=zt({},rBt,t),r=NOe(e),i=r.length;let s="",a=0,o,l;for(a=0;a<i;)for(o=r.length;o>a;--o)if(l=r.slice(a,o).join("-"),n[l]!=null){s+=n[l],a=o;break}return s.trim()}const u1=new Date;function Ure(e){return u1.setFullYear(e),u1.setMonth(0),u1.setDate(1),u1.setHours(0,0,0,0),u1}function sBt(e){return IOe(new Date(e))}function aBt(e){return CX(new Date(e))}function IOe(e){return cA.count(Ure(e.getFullYear())-1,e)}function CX(e){return Pre.count(Ure(e.getFullYear())-1,e)}function _X(e){return Ure(e).getDay()}function oBt(e,t,n,r,i,s,a){if(0<=e&&e<100){const o=new Date(-1,t,n,r,i,s,a);return o.setFullYear(e),o}return new Date(e,t,n,r,i,s,a)}function lBt(e){return MOe(new Date(e))}function uBt(e){return SX(new Date(e))}function MOe(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return fA.count(t-1,e)}function SX(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Lre.count(t-1,e)}function kX(e){return u1.setTime(Date.UTC(e,0,1)),u1.getUTCDay()}function cBt(e,t,n,r,i,s,a){if(0<=e&&e<100){const o=new Date(Date.UTC(-1,t,n,r,i,s,a));return o.setUTCFullYear(n.y),o}return new Date(Date.UTC(e,t,n,r,i,s,a))}function FOe(e,t,n,r,i){const s=t||1,a=un(e),o=(v,y,b)=>(b=b||v,fBt(n[b],r[b],v===a&&s,y)),l=new Date,u=Rh(e),c=u[Ca]?o(Ca):vo(2012),f=u[uo]?o(uo):u[Gl]?o(Gl):l1,h=u[es]&&u[no]?o(no,1,es+no):u[es]?o(es,1):u[no]?o(no,1):u[Yl]?o(Yl,1):u[Pp]?o(Pp,1):XI,d=u[Pu]?o(Pu):l1,p=u[Lu]?o(Lu):l1,g=u[tf]?o(tf):l1,m=u[Ph]?o(Ph):l1;return function(v){l.setTime(+v);const y=c(l);return i(y,f(l),h(l,y),d(l),p(l),g(l),m(l))}}function fBt(e,t,n,r){const i=n<=1?e:r?(s,a)=>r+n*Math.floor((e(s,a)-r)/n):(s,a)=>n*Math.floor(e(s,a)/n);return t?(s,a)=>t(i(s,a),a):i}function Xw(e,t,n){return t+e*7-(n+6)%7}const hBt={[Ca]:e=>e.getFullYear(),[Gl]:e=>Math.floor(e.getMonth()/3),[uo]:e=>e.getMonth(),[Yl]:e=>e.getDate(),[Pu]:e=>e.getHours(),[Lu]:e=>e.getMinutes(),[tf]:e=>e.getSeconds(),[Ph]:e=>e.getMilliseconds(),[Pp]:e=>IOe(e),[es]:e=>CX(e),[es+no]:(e,t)=>Xw(CX(e),e.getDay(),_X(t)),[no]:(e,t)=>Xw(1,e.getDay(),_X(t))},dBt={[Gl]:e=>3*e,[es]:(e,t)=>Xw(e,0,_X(t))};function pBt(e,t){return FOe(e,t||1,hBt,dBt,oBt)}const gBt={[Ca]:e=>e.getUTCFullYear(),[Gl]:e=>Math.floor(e.getUTCMonth()/3),[uo]:e=>e.getUTCMonth(),[Yl]:e=>e.getUTCDate(),[Pu]:e=>e.getUTCHours(),[Lu]:e=>e.getUTCMinutes(),[tf]:e=>e.getUTCSeconds(),[Ph]:e=>e.getUTCMilliseconds(),[Pp]:e=>MOe(e),[es]:e=>SX(e),[no]:(e,t)=>Xw(1,e.getUTCDay(),kX(t)),[es+no]:(e,t)=>Xw(SX(e),e.getUTCDay(),kX(t))},mBt={[Gl]:e=>3*e,[es]:(e,t)=>Xw(e,0,kX(t))};function vBt(e,t){return FOe(e,t||1,gBt,mBt,cBt)}const yBt={[Ca]:Bre,[Gl]:wX.every(3),[uo]:wX,[es]:Pre,[Yl]:cA,[no]:cA,[Pp]:cA,[Pu]:EOe,[Lu]:SOe,[tf]:Rre,[Ph]:zT},bBt={[Ca]:zre,[Gl]:$X.every(3),[uo]:$X,[es]:Lre,[Yl]:fA,[no]:fA,[Pp]:fA,[Pu]:AOe,[Lu]:kOe,[tf]:Rre,[Ph]:zT};function ZI(e){return yBt[e]}function QI(e){return bBt[e]}function OOe(e,t,n){return e?e.offset(t,n):void 0}function xBt(e,t,n){return OOe(ZI(e),t,n)}function wBt(e,t,n){return OOe(QI(e),t,n)}function ROe(e,t,n,r){return e?e.range(t,n,r):void 0}function $Bt(e,t,n,r){return ROe(ZI(e),t,n,r)}function CBt(e,t,n,r){return ROe(QI(e),t,n,r)}const hE=1e3,dE=hE*60,pE=dE*60,n9=pE*24,_Bt=n9*7,wme=n9*30,EX=n9*365,POe=[Ca,uo,Yl,Pu,Lu,tf,Ph],gE=POe.slice(0,-1),mE=gE.slice(0,-1),vE=mE.slice(0,-1),SBt=vE.slice(0,-1),kBt=[Ca,es],$me=[Ca,uo],LOe=[Ca],rk=[[gE,1,hE],[gE,5,5*hE],[gE,15,15*hE],[gE,30,30*hE],[mE,1,dE],[mE,5,5*dE],[mE,15,15*dE],[mE,30,30*dE],[vE,1,pE],[vE,3,3*pE],[vE,6,6*pE],[vE,12,12*pE],[SBt,1,n9],[kBt,1,_Bt],[$me,1,wme],[$me,3,3*wme],[LOe,1,EX]];function EBt(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(t9(t))/n;let i=Q8t(o=>o[2]).right(rk,r),s,a;return i===rk.length?(s=LOe,a=xme(t[0]/EX,t[1]/EX,n)):i?(i=rk[r/rk[i-1][2]<rk[i][2]/r?i-1:i],s=i[0],a=i[1]):(s=POe,a=Math.max(xme(t[0],t[1],n),1)),{units:s,step:a}}const Wj=new Date,Vj=new Date;function ad(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>ad(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(Wj.setTime(+s),Vj.setTime(+a),e(Wj),e(Vj),Math.floor(n(Wj,Vj))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const ABt=1e3,Wre=ABt*60,TBt=Wre*60,jT=TBt*24,BOe=jT*7,Vre=ad(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Wre)/jT,e=>e.getDate()-1);Vre.range;const jre=ad(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/jT,e=>e.getUTCDate()-1);jre.range;const DBt=ad(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/jT,e=>Math.floor(e/jT));DBt.range;function nx(e){return ad(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Wre)/BOe)}const zOe=nx(0),aP=nx(1),NBt=nx(2),IBt=nx(3),Kw=nx(4),MBt=nx(5),FBt=nx(6);zOe.range;aP.range;NBt.range;IBt.range;Kw.range;MBt.range;FBt.range;function rx(e){return ad(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/BOe)}const UOe=rx(0),oP=rx(1),OBt=rx(2),RBt=rx(3),Zw=rx(4),PBt=rx(5),LBt=rx(6);UOe.range;oP.range;OBt.range;RBt.range;Zw.range;PBt.range;LBt.range;const qy=ad(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());qy.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ad(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});qy.range;const Gy=ad(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Gy.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ad(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Gy.range;function jj(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Hj(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ik(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function WOe(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=sk(i),c=ak(i),f=sk(s),h=ak(s),d=sk(a),p=ak(a),g=sk(o),m=ak(o),v=sk(l),y=ak(l),b={a:F,A:R,b:P,B:V,c:null,d:Ame,e:Ame,f:ozt,g:vzt,G:bzt,H:izt,I:szt,j:azt,L:VOe,m:lzt,M:uzt,p:z,q,Q:Nme,s:Ime,S:czt,u:fzt,U:hzt,V:dzt,w:pzt,W:gzt,x:null,X:null,y:mzt,Y:yzt,Z:xzt,"%":Dme},x={a:G,A:K,b:Y,B:te,c:null,d:Tme,e:Tme,f:_zt,g:Fzt,G:Rzt,H:wzt,I:$zt,j:Czt,L:HOe,m:Szt,M:kzt,p:Z,q:ae,Q:Nme,s:Ime,S:Ezt,u:Azt,U:Tzt,V:Dzt,w:Nzt,W:Izt,x:null,X:null,y:Mzt,Y:Ozt,Z:Pzt,"%":Dme},w={a:E,A:S,b:N,B:A,c:D,d:kme,e:kme,f:ezt,g:Sme,G:_me,H:Eme,I:Eme,j:KBt,L:JBt,m:XBt,M:ZBt,p:k,q:YBt,Q:nzt,s:rzt,S:QBt,u:VBt,U:jBt,V:HBt,w:WBt,W:qBt,x:T,X:I,y:Sme,Y:_me,Z:GBt,"%":tzt};b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x);function C(O,L){return function(W){var M=[],ue=-1,X=0,se=O.length,oe,pe,Ce;for(W instanceof Date||(W=new Date(+W));++ue<se;)O.charCodeAt(ue)===37&&(M.push(O.slice(X,ue)),(pe=Cme[oe=O.charAt(++ue)])!=null?oe=O.charAt(++ue):pe=oe==="e"?" ":"0",(Ce=L[oe])&&(oe=Ce(W,pe)),M.push(oe),X=ue+1);return M.push(O.slice(X,ue)),M.join("")}}function $(O,L){return function(W){var M=ik(1900,void 0,1),ue=_(M,O,W+="",0),X,se;if(ue!=W.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(L&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(X=Hj(ik(M.y,0,1)),se=X.getUTCDay(),X=se>4||se===0?oP.ceil(X):oP(X),X=jre.offset(X,(M.V-1)*7),M.y=X.getUTCFullYear(),M.m=X.getUTCMonth(),M.d=X.getUTCDate()+(M.w+6)%7):(X=jj(ik(M.y,0,1)),se=X.getDay(),X=se>4||se===0?aP.ceil(X):aP(X),X=Vre.offset(X,(M.V-1)*7),M.y=X.getFullYear(),M.m=X.getMonth(),M.d=X.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),se="Z"in M?Hj(ik(M.y,0,1)).getUTCDay():jj(ik(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(se+5)%7:M.w+M.U*7-(se+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,Hj(M)):jj(M)}}function _(O,L,W,M){for(var ue=0,X=L.length,se=W.length,oe,pe;ue<X;){if(M>=se)return-1;if(oe=L.charCodeAt(ue++),oe===37){if(oe=L.charAt(ue++),pe=w[oe in Cme?L.charAt(ue++):oe],!pe||(M=pe(O,W,M))<0)return-1}else if(oe!=W.charCodeAt(M++))return-1}return M}function k(O,L,W){var M=u.exec(L.slice(W));return M?(O.p=c.get(M[0].toLowerCase()),W+M[0].length):-1}function E(O,L,W){var M=d.exec(L.slice(W));return M?(O.w=p.get(M[0].toLowerCase()),W+M[0].length):-1}function S(O,L,W){var M=f.exec(L.slice(W));return M?(O.w=h.get(M[0].toLowerCase()),W+M[0].length):-1}function N(O,L,W){var M=v.exec(L.slice(W));return M?(O.m=y.get(M[0].toLowerCase()),W+M[0].length):-1}function A(O,L,W){var M=g.exec(L.slice(W));return M?(O.m=m.get(M[0].toLowerCase()),W+M[0].length):-1}function D(O,L,W){return _(O,t,L,W)}function T(O,L,W){return _(O,n,L,W)}function I(O,L,W){return _(O,r,L,W)}function F(O){return a[O.getDay()]}function R(O){return s[O.getDay()]}function P(O){return l[O.getMonth()]}function V(O){return o[O.getMonth()]}function z(O){return i[+(O.getHours()>=12)]}function q(O){return 1+~~(O.getMonth()/3)}function G(O){return a[O.getUTCDay()]}function K(O){return s[O.getUTCDay()]}function Y(O){return l[O.getUTCMonth()]}function te(O){return o[O.getUTCMonth()]}function Z(O){return i[+(O.getUTCHours()>=12)]}function ae(O){return 1+~~(O.getUTCMonth()/3)}return{format:function(O){var L=C(O+="",b);return L.toString=function(){return O},L},parse:function(O){var L=$(O+="",!1);return L.toString=function(){return O},L},utcFormat:function(O){var L=C(O+="",x);return L.toString=function(){return O},L},utcParse:function(O){var L=$(O+="",!0);return L.toString=function(){return O},L}}}var Cme={"-":"",_:" ",0:"0"},bs=/^\s*\d+/,BBt=/^%/,zBt=/[\\^$*+?|[\]().{}]/g;function $n(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function UBt(e){return e.replace(zBt,"\\$&")}function sk(e){return new RegExp("^(?:"+e.map(UBt).join("|")+")","i")}function ak(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function WBt(e,t,n){var r=bs.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function VBt(e,t,n){var r=bs.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function jBt(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function HBt(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function qBt(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function _me(e,t,n){var r=bs.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Sme(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function GBt(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function YBt(e,t,n){var r=bs.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function XBt(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function kme(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function KBt(e,t,n){var r=bs.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Eme(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function ZBt(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function QBt(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function JBt(e,t,n){var r=bs.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function ezt(e,t,n){var r=bs.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function tzt(e,t,n){var r=BBt.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function nzt(e,t,n){var r=bs.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function rzt(e,t,n){var r=bs.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Ame(e,t){return $n(e.getDate(),t,2)}function izt(e,t){return $n(e.getHours(),t,2)}function szt(e,t){return $n(e.getHours()%12||12,t,2)}function azt(e,t){return $n(1+Vre.count(qy(e),e),t,3)}function VOe(e,t){return $n(e.getMilliseconds(),t,3)}function ozt(e,t){return VOe(e,t)+"000"}function lzt(e,t){return $n(e.getMonth()+1,t,2)}function uzt(e,t){return $n(e.getMinutes(),t,2)}function czt(e,t){return $n(e.getSeconds(),t,2)}function fzt(e){var t=e.getDay();return t===0?7:t}function hzt(e,t){return $n(zOe.count(qy(e)-1,e),t,2)}function jOe(e){var t=e.getDay();return t>=4||t===0?Kw(e):Kw.ceil(e)}function dzt(e,t){return e=jOe(e),$n(Kw.count(qy(e),e)+(qy(e).getDay()===4),t,2)}function pzt(e){return e.getDay()}function gzt(e,t){return $n(aP.count(qy(e)-1,e),t,2)}function mzt(e,t){return $n(e.getFullYear()%100,t,2)}function vzt(e,t){return e=jOe(e),$n(e.getFullYear()%100,t,2)}function yzt(e,t){return $n(e.getFullYear()%1e4,t,4)}function bzt(e,t){var n=e.getDay();return e=n>=4||n===0?Kw(e):Kw.ceil(e),$n(e.getFullYear()%1e4,t,4)}function xzt(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+$n(t/60|0,"0",2)+$n(t%60,"0",2)}function Tme(e,t){return $n(e.getUTCDate(),t,2)}function wzt(e,t){return $n(e.getUTCHours(),t,2)}function $zt(e,t){return $n(e.getUTCHours()%12||12,t,2)}function Czt(e,t){return $n(1+jre.count(Gy(e),e),t,3)}function HOe(e,t){return $n(e.getUTCMilliseconds(),t,3)}function _zt(e,t){return HOe(e,t)+"000"}function Szt(e,t){return $n(e.getUTCMonth()+1,t,2)}function kzt(e,t){return $n(e.getUTCMinutes(),t,2)}function Ezt(e,t){return $n(e.getUTCSeconds(),t,2)}function Azt(e){var t=e.getUTCDay();return t===0?7:t}function Tzt(e,t){return $n(UOe.count(Gy(e)-1,e),t,2)}function qOe(e){var t=e.getUTCDay();return t>=4||t===0?Zw(e):Zw.ceil(e)}function Dzt(e,t){return e=qOe(e),$n(Zw.count(Gy(e),e)+(Gy(e).getUTCDay()===4),t,2)}function Nzt(e){return e.getUTCDay()}function Izt(e,t){return $n(oP.count(Gy(e)-1,e),t,2)}function Mzt(e,t){return $n(e.getUTCFullYear()%100,t,2)}function Fzt(e,t){return e=qOe(e),$n(e.getUTCFullYear()%100,t,2)}function Ozt(e,t){return $n(e.getUTCFullYear()%1e4,t,4)}function Rzt(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Zw(e):Zw.ceil(e),$n(e.getUTCFullYear()%1e4,t,4)}function Pzt(){return"+0000"}function Dme(){return"%"}function Nme(e){return+e}function Ime(e){return Math.floor(+e/1e3)}var i2,GOe,YOe,XOe,KOe;Lzt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Lzt(e){return i2=WOe(e),GOe=i2.format,YOe=i2.parse,XOe=i2.utcFormat,KOe=i2.utcParse,i2}function yE(e){const t={};return n=>t[n]||(t[n]=e(n))}function Bzt(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=zzt(r,i);const a=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+a}}function zzt(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function ZOe(e){const t=yE(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=BT(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return Bzt(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,a){a=BT(a==null?",f":a);const o=E8t(r,i,s),l=Math.max(Math.abs(r),Math.abs(i));let u;if(a.precision==null)switch(a.type){case"s":return isNaN(u=R8t(o,l))||(a.precision=u),n(a,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=P8t(o,l))||(a.precision=u-(a.type==="e"));break}case"f":case"%":{isNaN(u=O8t(o))||(a.precision=u-(a.type==="%")*2);break}}return t(a)}}}let AX;Uzt();function Uzt(){return AX=ZOe({format:$Oe,formatPrefix:COe})}function QOe(e){return ZOe(wOe(e))}function TX(e){return arguments.length?AX=QOe(e):AX}function Mme(e,t,n){n=n||{},Ft(n)||$e(`Invalid time multi-format specifier: ${n}`);const r=t(tf),i=t(Lu),s=t(Pu),a=t(Yl),o=t(es),l=t(uo),u=t(Gl),c=t(Ca),f=e(n[Ph]||".%L"),h=e(n[tf]||":%S"),d=e(n[Lu]||"%I:%M"),p=e(n[Pu]||"%I %p"),g=e(n[Yl]||n[no]||"%a %d"),m=e(n[es]||"%b %d"),v=e(n[uo]||"%B"),y=e(n[Gl]||"%B"),b=e(n[Ca]||"%Y");return x=>(r(x)<x?f:i(x)<x?h:s(x)<x?d:a(x)<x?p:l(x)<x?o(x)<x?g:m:c(x)<x?u(x)<x?v:y:b)(x)}function JOe(e){const t=yE(e.format),n=yE(e.utcFormat);return{timeFormat:r=>$r(r)?t(r):Mme(t,ZI,r),utcFormat:r=>$r(r)?n(r):Mme(n,QI,r),timeParse:yE(e.parse),utcParse:yE(e.utcParse)}}let DX;Wzt();function Wzt(){return DX=JOe({format:GOe,parse:YOe,utcFormat:XOe,utcParse:KOe})}function eRe(e){return JOe(WOe(e))}function lP(e){return arguments.length?DX=eRe(e):DX}const NX=(e,t)=>zt({},e,t);function Vzt(e,t){const n=e?QOe(e):TX(),r=t?eRe(t):lP();return NX(n,r)}function jzt(e,t){const n=arguments.length;return n&&n!==2&&$e("defaultLocale expects either zero or two arguments."),n?NX(TX(e),lP(t)):NX(TX(),lP())}const Hzt=/^(data:|([A-Za-z]+:)?\/\/)/,qzt=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Gzt=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Fme="file://";function Yzt(e,t){return n=>({options:n||{},sanitize:Kzt,load:Xzt,fileAccess:!!t,file:Zzt(t),http:Jzt(e)})}async function Xzt(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function Kzt(e,t){t=zt({},this.options,t);const n=this.fileAccess,r={href:null};let i,s,a;const o=qzt.test(e.replace(Gzt,""));(e==null||typeof e!="string"||!o)&&$e("Sanitize failure, invalid URI: "+ot(e));const l=Hzt.test(e);return(a=t.baseURL)&&!l&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),s=(i=e.startsWith(Fme))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice(Fme.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!s}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function Zzt(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,s)=>{i?r(i):n(s)})}):Qzt}async function Qzt(){$e("No file system access.")}function Jzt(e){return e?async function(t,n){const r=zt({},this.options.http,n),i=n&&n.response,s=await e(t,r);return s.ok?Ut(s[i])?s[i]():s.text():$e(s.status+""+s.statusText)}:e7t}async function e7t(){$e("No HTTP fetch method available.")}const t7t=e=>e!=null&&e===e,n7t=e=>e==="true"||e==="false"||e===!0||e===!1,r7t=e=>!Number.isNaN(Date.parse(e)),tRe=e=>!Number.isNaN(+e)&&!(e instanceof Date),i7t=e=>tRe(e)&&Number.isInteger(+e),Ome={boolean:uOe,integer:ao,number:ao,date:cOe,string:fOe,unknown:ll},kO=[n7t,i7t,tRe,r7t],s7t=["boolean","integer","number","date"];function a7t(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=kO.length,i=kO.map((s,a)=>a+1);for(let s=0,a=0,o,l;s<n;++s)for(l=t?e[s][t]:e[s],o=0;o<r;++o)if(i[o]&&t7t(l)&&!kO[o](l)&&(i[o]=0,++a,a===kO.length))return"string";return s7t[i.reduce((s,a)=>s===0?a:s,0)-1]}function o7t(e,t){return t.reduce((n,r)=>(n[r]=a7t(e,r),n),{})}function Rme(e){const t=function(n,r){const i={delimiter:e};return Hre(n,r?zt(r,i):i)};return t.responseType="text",t}function Hre(e,t){return t.header&&(e=t.header.map(ot).join(t.delimiter)+`
`+e),v8t(t.delimiter).parse(e+"")}Hre.responseType="text";function l7t(e){return typeof Buffer=="function"&&Ut(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function qre(e,t){const n=t&&t.property?ql(t.property):ll;return Ft(e)&&!l7t(e)?u7t(n(e),t):n(JSON.parse(e))}qre.responseType="json";function u7t(e,t){return!at(e)&&s8t(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const c7t={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function nRe(e,t){let n,r,i,s;return e=qre(e,t),t&&t.feature?(n=dOe,i=t.feature):t&&t.mesh?(n=gOe,i=t.mesh,s=c7t[t.filter]):$e("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,s):$e("Invalid TopoJSON object: "+i),r&&r.features||[r]}nRe.responseType="json";const qj={dsv:Hre,csv:Rme(","),tsv:Rme("	"),json:qre,topojson:nRe};function rRe(e,t){return arguments.length>1?(qj[e]=t,this):bt(qj,e)?qj[e]:null}function f7t(e){const t=rRe(e);return t&&t.responseType||"text"}function h7t(e,t,n,r){t=t||{};const i=rRe(t.type||"json");return i||$e("Unknown data format type: "+t.type),e=i(e,t),t.parse&&d7t(e,t.parse,n,r),bt(e,"columns")&&delete e.columns,e}function d7t(e,t,n,r){if(!e.length)return;const i=lP();n=n||i.timeParse,r=r||i.utcParse;let s=e.columns||Object.keys(e[0]),a,o,l,u,c,f;t==="auto"&&(t=o7t(e,s)),s=Object.keys(t);const h=s.map(d=>{const p=t[d];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?r:n)(m);if(!Ome[p])throw Error("Illegal format pattern: "+d+":"+p);return Ome[p]});for(l=0,c=e.length,f=s.length;l<c;++l)for(a=e[l],u=0;u<f;++u)o=s[u],a[o]=h[u](a[o])}const Gre=Yzt(typeof fetch<"u"&&fetch,null);function r9(e){const t=e||ll,n=[],r={};return n.add=i=>{const s=t(i);return r[s]||(r[s]=1,n.push(i)),n},n.remove=i=>{const s=t(i);if(r[s]){r[s]=0;const a=n.indexOf(i);a>=0&&n.splice(a,1)}return n},n}async function l4(e,t){try{await t(e)}catch(n){e.error(n)}}const iRe=Symbol("vega_id");let p7t=1;function U_(e){return!!(e&&nt(e))}function nt(e){return e[iRe]}function sRe(e,t){return e[iRe]=t,e}function Tn(e){const t=e===Object(e)?e:{data:e};return nt(t)?t:sRe(t,p7t++)}function Yre(e){return i9(e,Tn({}))}function i9(e,t){for(const n in e)t[n]=e[n];return t}function aRe(e,t){return sRe(t,nt(e))}function ix(e,t){return e?t?(n,r)=>e(n,r)||nt(t(n))-nt(t(r)):(n,r)=>e(n,r)||nt(n)-nt(r):null}function oRe(e){return e&&e.constructor===sx}function sx(){const e=[],t=[],n=[],r=[],i=[];let s=null,a=!1;return{constructor:sx,insert(o){const l=ct(o),u=l.length;for(let c=0;c<u;++c)e.push(l[c]);return this},remove(o){const l=Ut(o)?r:t,u=ct(o),c=u.length;for(let f=0;f<c;++f)l.push(u[f]);return this},modify(o,l,u){const c={field:l,value:vo(u)};return Ut(o)?(c.filter=o,i.push(c)):(c.tuple=o,n.push(c)),this},encode(o,l){return Ut(o)?i.push({filter:o,field:l}):n.push({tuple:o,field:l}),this},clean(o){return s=o,this},reflow(){return a=!0,this},pulse(o,l){const u={},c={};let f,h,d,p,g,m;for(f=0,h=l.length;f<h;++f)u[nt(l[f])]=1;for(f=0,h=t.length;f<h;++f)g=t[f],u[nt(g)]=-1;for(f=0,h=r.length;f<h;++f)p=r[f],l.forEach(y=>{p(y)&&(u[nt(y)]=-1)});for(f=0,h=e.length;f<h;++f)g=e[f],m=nt(g),u[m]?u[m]=1:o.add.push(Tn(e[f]));for(f=0,h=l.length;f<h;++f)g=l[f],u[nt(g)]<0&&o.rem.push(g);function v(y,b,x){x?y[b]=x(y):o.encode=b,a||(c[nt(y)]=y)}for(f=0,h=n.length;f<h;++f)d=n[f],g=d.tuple,p=d.field,m=u[nt(g)],m>0&&(v(g,p,d.value),o.modifies(p));for(f=0,h=i.length;f<h;++f)d=i[f],p=d.filter,l.forEach(y=>{p(y)&&u[nt(y)]>0&&v(y,d.field,d.value)}),o.modifies(d.field);if(a)o.mod=t.length||r.length?l.filter(y=>u[nt(y)]>0):l.slice();else for(m in c)o.mod.push(c[m]);return(s||s==null&&(t.length||r.length))&&o.clean(!0),o}}}const u4="_:mod:_";function s9(){Object.defineProperty(this,u4,{writable:!0,value:{}})}s9.prototype={set(e,t,n,r){const i=this,s=i[e],a=i[u4];return t!=null&&t>=0?(s[t]!==n||r)&&(s[t]=n,a[t+":"+e]=-1,a[e]=-1):(s!==n||r)&&(i[e]=n,a[e]=at(n)?1+n.length:-1),i},modified(e,t){const n=this[u4];if(arguments.length){if(at(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[u4]={},this}};let g7t=0;const m7t="pulse",v7t=new s9,y7t=1,b7t=2;function er(e,t,n,r){this.id=++g7t,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function Pme(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}er.prototype={targets(){return this._targets||(this._targets=r9(Q7))},set(e){return this.value!==e?(this.value=e,1):0},skip:Pme(y7t),modified:Pme(b7t),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new s9,i=this._argops=this._argops||[],s=[];let a,o,l,u;const c=(f,h,d)=>{d instanceof er?(d!==this&&(t&&d.targets().add(this),s.push(d)),i.push({op:d,name:f,index:h})):r.set(f,h,d)};for(a in e)if(o=e[a],a===m7t)ct(o).forEach(f=>{f instanceof er?f!==this&&(f.targets().add(this),s.push(f)):$e("Pulse parameters must be operator instances.")}),this.source=o;else if(at(o))for(r.set(a,-1,Array(l=o.length)),u=0;u<l;++u)c(a,u,o[u]);else c(a,-1,o);return this.marshall().clear(),n&&(i.initonly=!0),s},marshall(e){const t=this._argval||v7t,n=this._argops;let r,i,s,a;if(n){const o=n.length;for(i=0;i<o;++i)r=n[i],s=r.op,a=s.modified()&&s.stamp===e,t.set(r.name,r.index,s.value,a);if(n.initonly){for(i=0;i<o;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function x7t(e,t,n,r){let i=1,s;return e instanceof er?s=e:e&&e.prototype instanceof er?s=new e:Ut(e)?s=new er(null,e):(i=0,s=new er(e,t)),this.rank(s),i&&(r=n,n=t),n&&this.connect(s,s.parameters(n,r)),this.touch(s),s}function w7t(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let $7t=0;function a9(e,t,n){this.id=++$7t,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Mg(e,t,n){return new a9(e,t,n)}a9.prototype={_filter:ef,_apply:ll,targets(){return this._targets||(this._targets=r9(Q7))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Mg(e);return this.targets().add(t),t},apply(e){const t=Mg(null,e);return this.targets().add(t),t},merge(){const e=Mg();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Mg();return this.targets().add(Mg(null,null,oOe(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(Mg(null,null,()=>n=!0)),t.targets().add(Mg(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=ef,this._targets=null}};function C7t(e,t,n,r){const i=this,s=Mg(n,r),a=function(u){u.dataflow=i;try{s.receive(u)}catch(c){i.error(c)}finally{i.run()}};let o;typeof e=="string"&&typeof document<"u"?o=document.querySelectorAll(e):o=ct(e);const l=o.length;for(let u=0;u<l;++u)o[u].addEventListener(t,a);return s}function _7t(e,t){const n=this.locale();return h7t(e,t,n.timeParse,n.utcParse)}function S7t(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function k7t(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:f7t(t&&t.type)});try{i=n.parse(i,t)}catch(s){r=-2,n.warn("Data ingestion failed",e,s)}}catch(s){r=-1,n.warn("Loading failed",e,s)}return{data:i,status:r}}async function E7t(e,t,n){const r=this,i=r._pending||A7t(r);i.requests+=1;const s=await r.request(t,n);return r.pulse(e,r.changeset().remove(ef).insert(s.data||[])),i.done(),s}function A7t(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const T7t={skip:!0};function D7t(e,t,n,r,i){return(e instanceof er?I7t:N7t)(this,e,t,n,r,i),this}function N7t(e,t,n,r,i,s){const a=zt({},s,T7t);let o,l;Ut(n)||(n=vo(n)),r===void 0?o=u=>e.touch(n(u)):Ut(r)?(l=new er(null,r,i,!1),o=u=>{l.evaluate(u);const c=n(u),f=l.value;oRe(f)?e.pulse(c,f,s):e.update(c,f,a)}):o=u=>e.update(n(u),r,a),t.apply(o)}function I7t(e,t,n,r,i,s){if(r===void 0)t.targets().add(n);else{const a=s||{},o=new er(null,M7t(n,r),i,!1);o.modified(a.force),o.rank=t.rank,t.targets().add(o),n&&(o.skip(!0),o.value=n.value,o.targets().add(n),e.connect(n,[o]))}}function M7t(e,t){return t=Ut(t)?t:vo(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function F7t(e){e.rank=++this._rank}function O7t(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&$e("Cycle detected in dataflow graph.")}const uP={},Ff=1<<0,Lg=1<<1,Ld=1<<2,R7t=Ff|Lg,Lme=Ff|Ld,s2=Ff|Lg|Ld,Bme=1<<3,ok=1<<4,zme=1<<5,Ume=1<<6;function x0(e,t,n){this.dataflow=e,this.stamp=t==null?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Gj(e,t){const n=[];return Xv(e,t,r=>n.push(r)),n}function Wme(e,t){const n={};return e.visit(t,r=>{n[nt(r)]=1}),r=>n[nt(r)]?null:r}function EO(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}x0.prototype={StopPropagation:uP,ADD:Ff,REM:Lg,MOD:Ld,ADD_REM:R7t,ADD_MOD:Lme,ALL:s2,REFLOW:Bme,SOURCE:ok,NO_SOURCE:zme,NO_FIELDS:Ume,fork(e){return new x0(this.dataflow).init(this,e)},clone(){const e=this.fork(s2);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(s2|ok)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new x0(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&Ume)&&(n.fields=e.fields),t&Ff?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Lg?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Ld?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&zme?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||s2;return t&Ff&&this.add.length||t&Lg&&this.rem.length||t&Ld&&this.mod.length},reflow(e){if(e)return this.fork(s2).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Ld,Wme(this,Ff))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return at(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?at(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Ff&&(n.addF=EO(n.addF,t)),e&Lg&&(n.remF=EO(n.remF,t)),e&Ld&&(n.modF=EO(n.modF,t)),e&ok&&(n.srcF=EO(n.srcF,t)),n},materialize(e){e=e||s2;const t=this;return e&Ff&&t.addF&&(t.add=Gj(t.add,t.addF),t.addF=null),e&Lg&&t.remF&&(t.rem=Gj(t.rem,t.remF),t.remF=null),e&Ld&&t.modF&&(t.mod=Gj(t.mod,t.modF),t.modF=null),e&ok&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&ok)return Xv(n.source,n.srcF,r),n;e&Ff&&Xv(n.add,n.addF,r),e&Lg&&Xv(n.rem,n.remF,r),e&Ld&&Xv(n.mod,n.modF,r);const i=n.source;if(e&Bme&&i){const s=n.add.length+n.mod.length;s===i.length||(s?Xv(i,Wme(n,Lme),r):Xv(i,n.srcF,r))}return n}};function Xre(e,t,n,r){const i=this;let s=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(const a of n)if(a.stamp===t){if(a.fields){const o=i.fields||(i.fields={});for(const l in a.fields)o[l]=1}a.changed(i.ADD)&&(s|=i.ADD),a.changed(i.REM)&&(s|=i.REM),a.changed(i.MOD)&&(s|=i.MOD)}this.changes=s}Ne(Xre,x0,{fork(e){const t=new x0(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?at(e)?e.some(r=>n[r]):n[e]:0},filter(){$e("MultiPulse does not support filtering.")},materialize(){$e("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let s=0;if(e&n.SOURCE)for(;s<i;++s)r[s].visit(e,t);else for(;s<i;++s)r[s].stamp===n.stamp&&r[s].visit(e,t);return n}});async function P7t(e,t,n){const r=this,i=[];if(r._pulse)return lRe(r);if(r._pending&&await r._pending,t&&await l4(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const s=++r._clock;r._pulse=new x0(r,s,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=r9(Q7);let a=0,o,l,u;try{for(;r._heap.size()>0;){if(o=r._heap.pop(),o.rank!==o.qrank){r._enqueue(o,!0);continue}l=o.run(r._getPulse(o,e)),l.then?l=await l:l.async&&(i.push(l.async),l=uP),l!==uP&&o._targets&&o._targets.forEach(c=>r._enqueue(c)),++a}}catch(c){r._heap.clear(),u=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${s}: ${a} operators`),u&&(r._postrun=[],r.error(u)),r._postrun.length){const c=r._postrun.sort((f,h)=>h.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await l4(r,c[f].callback)}return n&&await l4(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(h){r.error(h)}})})),r}async function L7t(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function B7t(e,t,n){return this._pulse?lRe(this):(this.evaluate(e,t,n),this)}function z7t(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function lRe(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function U7t(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function W7t(e,t){const n=e.source,r=this._clock;return n&&at(n)?new Xre(this,r,n.map(i=>i.pulse),t):this._input[e.id]||V7t(this._pulse,n&&n.pulse)}function V7t(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==uP&&(e.source=t.source),e)}const Kre={skip:!1,force:!1};function j7t(e,t){const n=t||Kre;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function H7t(e,t,n){const r=n||Kre;return(e.set(t)||r.force)&&this.touch(e,r),this}function q7t(e,t,n){this.touch(e,n||Kre);const r=new x0(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function G7t(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),uRe(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,Y7t(t,0,e)):r=n,r}}}function uRe(e,t,n,r){let i,s;const a=e[n];for(;n>t;){if(s=n-1>>1,i=e[s],r(a,i)<0){e[n]=i,n=s;continue}break}return e[n]=a}function Y7t(e,t,n){const r=t,i=e.length,s=e[t];let a=(t<<1)+1,o;for(;a<i;)o=a+1,o<i&&n(e[a],e[o])>=0&&(a=o),e[t]=e[a],t=a,a=(t<<1)+1;return e[t]=s,uRe(e,r,t,n)}function Q2(){this.logger(U6t()),this.logLevel(ZFe),this._clock=0,this._rank=0,this._locale=jzt();try{this._loader=Gre()}catch{}this._touched=r9(Q7),this._input={},this._pulse=null,this._heap=G7t((e,t)=>e.qrank-t.qrank),this._postrun=[]}function lk(e){return function(){return this._log[e].apply(this,arguments)}}Q2.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:lk("error"),warn:lk("warn"),info:lk("info"),debug:lk("debug"),logLevel:lk("level"),cleanThreshold:1e4,add:x7t,connect:w7t,rank:F7t,rerank:O7t,pulse:q7t,touch:j7t,update:H7t,changeset:sx,ingest:S7t,parse:_7t,preload:E7t,request:k7t,events:C7t,on:D7t,evaluate:P7t,run:B7t,runAsync:L7t,runAfter:z7t,_enqueue:U7t,_getPulse:W7t};function me(e,t){er.call(this,e,null,t)}Ne(me,er,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Qw={};function cRe(e){const t=fRe(e);return t&&t.Definition||null}function fRe(e){return e=e&&e.toLowerCase(),bt(Qw,e)?Qw[e]:null}function cP(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function X7t(e){return e===null?NaN:+e}function*K7t(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}function Z7t(e,t){let n=0,r,i=0,s=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,s+=r*(a-i));else{let a=-1;for(let o of e)(o=t(o,++a,e))!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,s+=r*(o-i))}if(n>1)return s/(n-1)}function Q7t(e,t){const n=Z7t(e,t);return n&&Math.sqrt(n)}function J7t(e=cP){if(e===cP)return hRe;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function hRe(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function Vme(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function jme(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function dRe(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?hRe:J7t(i);r>n;){if(r-n>600){const l=r-n+1,u=t-n+1,c=Math.log(l),f=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*f*(l-f)/l)*(u-l/2<0?-1:1),d=Math.max(n,Math.floor(t-u*f/l+h)),p=Math.min(r,Math.floor(t+(l-u)*f/l+h));dRe(e,t,d,p,i)}const s=e[t];let a=n,o=r;for(uk(e,n,t),i(e[r],s)>0&&uk(e,n,r);a<o;){for(uk(e,a,o),++a,--o;i(e[a],s)<0;)++a;for(;i(e[o],s)>0;)--o}i(e[n],s)===0?uk(e,n,o):(++o,uk(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}return e}function uk(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function IX(e,t,n){if(e=Float64Array.from(K7t(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return jme(e);if(t>=1)return Vme(e);var r,i=(r-1)*t,s=Math.floor(i),a=Vme(dRe(e,s).subarray(0,s+1)),o=jme(e.subarray(s+1));return a+(o-a)*(i-s)}}function e9t(e,t,n=X7t){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function t9t(e,t){return IX(e,.5,t)}function*pRe(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function gRe(e,t,n){const r=Float64Array.from(pRe(e,n));return r.sort(cP),t.map(i=>e9t(r,i))}function mRe(e,t){return gRe(e,[.25,.5,.75],t)}function vRe(e,t){const n=e.length,r=Q7t(e,t),i=mRe(e,t),s=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,s)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function n9t(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let s=e.extent[0],a=e.extent[1],o,l,u,c,f,h;const d=e.span||a-s||Math.abs(s)||1;if(e.step)o=e.step;else if(e.steps){for(c=d/t,f=0,h=e.steps.length;f<h&&e.steps[f]<c;++f);o=e.steps[Math.max(0,f-1)]}else{for(l=Math.ceil(Math.log(t)/r),u=e.minstep||0,o=Math.max(u,Math.pow(n,Math.round(Math.log(d)/r)-l));Math.ceil(d/o)>t;)o*=n;for(f=0,h=i.length;f<h;++f)c=o/i[f],c>=u&&d/c<=t&&(o=c)}c=Math.log(o);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/o+g)*o,s=s<c?c-o:c,a=Math.ceil(a/o)*o),{start:s,stop:a===s?s+o:a,step:o}}var Lp=Math.random;function r9t(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(pRe(e,r)),s=i.length,a=t;let o,l,u,c;for(u=0,c=Array(a);u<a;++u){for(o=0,l=0;l<s;++l)o+=i[~~(Lp()*s)];c[u]=o/s}return c.sort(cP),[IX(c,n/2),IX(c,1-n/2)]}function i9t(e,t,n,r){r=r||(h=>h);const i=e.length,s=new Float64Array(i);let a=0,o=1,l=r(e[0]),u=l,c=l+t,f;for(;o<i;++o){if(f=r(e[o]),f>=c){for(u=(l+u)/2;a<o;++a)s[a]=u;c=f+t,l=f}u=f}for(u=(l+u)/2;a<o;++a)s[a]=u;return n?s9t(s,t+t/4):s}function s9t(e,t){const n=e.length;let r=0,i=1,s,a;for(;e[r]===e[i];)++i;for(;i<n;){for(s=i+1;e[i]===e[s];)++s;if(e[i]-e[i-1]<t){for(a=i+(r+s-i-i>>1);a<i;)e[a++]=e[i];for(;a>i;)e[a--]=e[r]}r=i,i=s}return e}const yRe=Math.sqrt(2*Math.PI),a9t=Math.SQRT2;let ck=NaN;function Zre(e,t){e=e||0,t=t==null?1:t;let n=0,r=0,i,s;if(ck===ck)n=ck,ck=NaN;else{do n=Lp()*2-1,r=Lp()*2-1,i=n*n+r*r;while(i===0||i>1);s=Math.sqrt(-2*Math.log(i)/i),n*=s,ck=r*s}return e+n*t}function bRe(e,t,n){n=n==null?1:n;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*yRe)}function Qre(e,t,n){t=t||0,n=n==null?1:n;const r=(e-t)/n,i=Math.abs(r);let s;if(i>37)s=0;else{const a=Math.exp(-i*i/2);let o;i<7.07106781186547?(o=.0352624965998911*i+.700383064443688,o=o*i+6.37396220353165,o=o*i+33.912866078383,o=o*i+112.079291497871,o=o*i+221.213596169931,o=o*i+220.206867912376,s=a*o,o=.0883883476483184*i+1.75566716318264,o=o*i+16.064177579207,o=o*i+86.7807322029461,o=o*i+296.564248779674,o=o*i+637.333633378831,o=o*i+793.826512519948,o=o*i+440.413735824752,s=s/o):(o=i+.65,o=i+4/o,o=i+3/o,o=i+2/o,o=i+1/o,s=a/o/2.506628274631)}return r>0?1-s:s}function Jre(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*a9t*o9t(2*e-1)}function o9t(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function xRe(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s==null?1:s,i):r},sample:()=>Zre(n,r),pdf:s=>bRe(s,n,r),cdf:s=>Qre(s,n,r),icdf:s=>Jre(s,n,r)};return i.mean(e).stdev(t)}function wRe(e,t){const n=xRe();let r=0;const i={data(s){return arguments.length?(e=s,r=s?s.length:0,i.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=vRe(e)),i):t},sample(){return e[~~(Lp()*r)]+t*n.sample()},pdf(s){let a=0,o=0;for(;o<r;++o)a+=n.pdf((s-e[o])/t);return a/t/r},cdf(s){let a=0,o=0;for(;o<r;++o)a+=n.cdf((s-e[o])/t);return a/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function $Re(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+Zre()*t)}function CRe(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*yRe*e)}function _Re(e,t,n){return Qre(Math.log(e),t,n)}function SRe(e,t,n){return Math.exp(Jre(e,t,n))}function l9t(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s==null?1:s,i):r},sample:()=>$Re(n,r),pdf:s=>CRe(s,n,r),cdf:s=>_Re(s,n,r),icdf:s=>SRe(s,n,r)};return i.mean(e).stdev(t)}function u9t(e,t){let n=0,r;function i(a){const o=[];let l=0,u;for(u=0;u<n;++u)l+=o[u]=a[u]==null?1:+a[u];for(u=0;u<n;++u)o[u]/=l;return o}const s={weights(a){return arguments.length?(r=i(t=a||[]),s):t},distributions(a){return arguments.length?(a?(n=a.length,e=a):(n=0,e=[]),s.weights(t)):e},sample(){const a=Lp();let o=e[n-1],l=r[0],u=0;for(;u<n-1;l+=r[++u])if(a<l){o=e[u];break}return o.sample()},pdf(a){let o=0,l=0;for(;l<n;++l)o+=r[l]*e[l].pdf(a);return o},cdf(a){let o=0,l=0;for(;l<n;++l)o+=r[l]*e[l].cdf(a);return o},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function kRe(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*Lp()}function ERe(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function ARe(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function TRe(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function c9t(e,t){let n,r;const i={min(s){return arguments.length?(n=s||0,i):n},max(s){return arguments.length?(r=s==null?1:s,i):r},sample:()=>kRe(n,r),pdf:s=>ERe(s,n,r),cdf:s=>ARe(s,n,r),icdf:s=>TRe(s,n,r)};return t==null&&(t=e==null?1:e,e=0),i.min(e).max(t)}function f9t(e,t,n){let r=0,i=0;for(const s of e){const a=n(s);t(s)==null||a==null||isNaN(a)||(r+=(a-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function JI(e,t,n,r){const i=r-e*e,s=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-s*e,s]}function o9(e,t,n,r){e=e.filter(d=>{let p=t(d),g=n(d);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((d,p)=>t(d)-t(p));const i=e.length,s=new Float64Array(i),a=new Float64Array(i);let o=0,l=0,u=0,c,f,h;for(h of e)s[o]=c=+t(h),a[o]=f=+n(h),++o,l+=(c-l)/o,u+=(f-u)/o;for(o=0;o<i;++o)s[o]-=l,a[o]-=u;return[s,a,l,u]}function eM(e,t,n,r){let i=-1,s,a;for(const o of e)s=t(o),a=n(o),s!=null&&(s=+s)>=s&&a!=null&&(a=+a)>=a&&r(s,a,++i)}function W_(e,t,n,r,i){let s=0,a=0;return eM(e,t,n,(o,l)=>{const u=l-i(o),c=l-r;s+=u*u,a+=c*c}),1-s/a}function DRe(e,t,n){let r=0,i=0,s=0,a=0,o=0;eM(e,t,n,(c,f)=>{++o,r+=(c-r)/o,i+=(f-i)/o,s+=(c*f-s)/o,a+=(c*c-a)/o});const l=JI(r,i,s,a),u=c=>l[0]+l[1]*c;return{coef:l,predict:u,rSquared:W_(e,t,n,i,u)}}function h9t(e,t,n){let r=0,i=0,s=0,a=0,o=0;eM(e,t,n,(c,f)=>{++o,c=Math.log(c),r+=(c-r)/o,i+=(f-i)/o,s+=(c*f-s)/o,a+=(c*c-a)/o});const l=JI(r,i,s,a),u=c=>l[0]+l[1]*Math.log(c);return{coef:l,predict:u,rSquared:W_(e,t,n,i,u)}}function d9t(e,t,n){const[r,i,s,a]=o9(e,t,n);let o=0,l=0,u=0,c=0,f=0,h,d,p;eM(e,t,n,(y,b)=>{h=r[f++],d=Math.log(b),p=h*b,o+=(b*d-o)/f,l+=(p-l)/f,u+=(p*d-u)/f,c+=(h*p-c)/f});const[g,m]=JI(l/a,o/a,u/a,c/a),v=y=>Math.exp(g+m*(y-s));return{coef:[Math.exp(g-m*s),m],predict:v,rSquared:W_(e,t,n,a,v)}}function p9t(e,t,n){let r=0,i=0,s=0,a=0,o=0,l=0;eM(e,t,n,(f,h)=>{const d=Math.log(f),p=Math.log(h);++l,r+=(d-r)/l,i+=(p-i)/l,s+=(d*p-s)/l,a+=(d*d-a)/l,o+=(h-o)/l});const u=JI(r,i,s,a),c=f=>u[0]*Math.pow(f,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:W_(e,t,n,o,c)}}function NRe(e,t,n){const[r,i,s,a]=o9(e,t,n),o=r.length;let l=0,u=0,c=0,f=0,h=0,d,p,g,m;for(d=0;d<o;)p=r[d],g=i[d++],m=p*p,l+=(m-l)/d,u+=(m*p-u)/d,c+=(m*m-c)/d,f+=(p*g-f)/d,h+=(m*g-h)/d;const v=c-l*l,y=l*v-u*u,b=(h*l-f*u)/y,x=(f*v-h*u)/y,w=-b*l,C=$=>($=$-s,b*$*$+x*$+w+a);return{coef:[w-x*s+b*s*s+a,x-2*b*s,b],predict:C,rSquared:W_(e,t,n,a,C)}}function g9t(e,t,n,r){if(r===0)return f9t(e,t,n);if(r===1)return DRe(e,t,n);if(r===2)return NRe(e,t,n);const[i,s,a,o]=o9(e,t,n),l=i.length,u=[],c=[],f=r+1;let h,d,p,g,m;for(h=0;h<f;++h){for(p=0,g=0;p<l;++p)g+=Math.pow(i[p],h)*s[p];for(u.push(g),m=new Float64Array(f),d=0;d<f;++d){for(p=0,g=0;p<l;++p)g+=Math.pow(i[p],h+d);m[d]=g}c.push(m)}c.push(u);const v=v9t(c),y=b=>{b-=a;let x=o+v[0]+v[1]*b+v[2]*b*b;for(h=3;h<f;++h)x+=v[h]*Math.pow(b,h);return x};return{coef:m9t(f,v,-a,o),predict:y,rSquared:W_(e,t,n,o,y)}}function m9t(e,t,n,r){const i=Array(e);let s,a,o,l;for(s=0;s<e;++s)i[s]=0;for(s=e-1;s>=0;--s)for(o=t[s],l=1,i[s]+=o,a=1;a<=s;++a)l*=(s+1-a)/a,i[s-a]+=o*Math.pow(n,a)*l;return i[0]+=r,i}function v9t(e){const t=e.length-1,n=[];let r,i,s,a,o;for(r=0;r<t;++r){for(a=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][a])&&(a=i);for(s=r;s<t+1;++s)o=e[s][r],e[s][r]=e[s][a],e[s][a]=o;for(i=r+1;i<t;++i)for(s=t;s>=r;s--)e[s][i]-=e[s][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(o=0,s=i+1;s<t;++s)o+=e[s][i]*n[s];n[i]=(e[t][i]-o)/e[i][i]}return n}const Hme=2,qme=1e-12;function y9t(e,t,n,r){const[i,s,a,o]=o9(e,t,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),h=new Float64Array(l).fill(1);for(let d=-1;++d<=Hme;){const p=[0,u-1];for(let m=0;m<l;++m){const v=i[m],y=p[0],b=p[1],x=v-i[y]>i[b]-v?y:b;let w=0,C=0,$=0,_=0,k=0;const E=1/Math.abs(i[x]-v||1);for(let A=y;A<=b;++A){const D=i[A],T=s[A],I=b9t(Math.abs(v-D)*E)*h[A],F=D*I;w+=I,C+=F,$+=T*I,_+=T*F,k+=D*F}const[S,N]=JI(C/w,$/w,_/w,k/w);c[m]=S+N*v,f[m]=Math.abs(s[m]-c[m]),x9t(i,m+1,p)}if(d===Hme)break;const g=t9t(f);if(Math.abs(g)<qme)break;for(let m=0,v,y;m<l;++m)v=f[m]/(6*g),h[m]=v>=1?qme:(y=1-v*v)*y}return w9t(i,c,a,o)}function b9t(e){return(e=1-e*e*e)*e*e}function x9t(e,t,n){const r=e[t];let i=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>i&&e[s]-r<=r-e[i];)n[0]=++i,n[1]=s,++s}function w9t(e,t,n,r){const i=e.length,s=[];let a=0,o=0,l=[],u;for(;a<i;++a)u=e[a]+n,l[0]===u?l[1]+=(t[a]-l[1])/++o:(o=0,l[1]+=r,l=[u,t[a]],s.push(l));return l[1]+=r,s}const $9t=.5*Math.PI/180;function eie(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=g=>[g,e(g)],s=t[0],a=t[1],o=a-s,l=o/r,u=[i(s)],c=[];if(n===r){for(let g=1;g<r;++g)u.push(i(s+g/n*o));return u.push(i(a)),u}else{c.push(i(a));for(let g=n;--g>0;)c.push(i(s+g/n*o))}let f=u[0],h=c[c.length-1];const d=1/o,p=C9t(f[1],c);for(;h;){const g=i((f[0]+h[0])/2);g[0]-f[0]>=l&&_9t(f,g,h,d,p)>$9t?c.push(g):(f=h,u.push(h),c.pop()),h=c[c.length-1]}return u}function C9t(e,t){let n=e,r=e;const i=t.length;for(let s=0;s<i;++s){const a=t[s][1];a<n&&(n=a),a>r&&(r=a)}return 1/(r-n)}function _9t(e,t,n,r,i){const s=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),a=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(s-a)}function V_(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function tM(e){let t=e,n=e;e.length===1&&(t=(a,o)=>e(a)-o,n=S9t(e));function r(a,o,l,u){for(l==null&&(l=0),u==null&&(u=a.length);l<u;){const c=l+u>>>1;n(a[c],o)<0?l=c+1:u=c}return l}function i(a,o,l,u){for(l==null&&(l=0),u==null&&(u=a.length);l<u;){const c=l+u>>>1;n(a[c],o)>0?u=c:l=c+1}return l}function s(a,o,l,u){l==null&&(l=0),u==null&&(u=a.length);const c=r(a,o,l,u-1);return c>l&&t(a[c-1],o)>-t(a[c],o)?c-1:c}return{left:r,center:s,right:i}}function S9t(e){return(t,n)=>V_(e(t),n)}function IRe(e){return e===null?NaN:+e}function*k9t(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const MRe=tM(V_),fP=MRe.right,E9t=MRe.left;tM(IRe).center;const nM=fP;function A9t(e,t){let n=0,r,i=0,s=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,s+=r*(a-i));else{let a=-1;for(let o of e)(o=t(o,++a,e))!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,s+=r*(o-i))}if(n>1)return s/(n-1)}function T9t(e,t){const n=A9t(e,t);return n&&Math.sqrt(n)}class co{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],a=t+s,o=Math.abs(t)<Math.abs(s)?t-(a-s):s-(a-t);o&&(n[r++]=o),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,s=i-(a-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=a+i,i==r-a&&(a=r))}return a}}function D9t(e,t){return Array.from(t,n=>e[n])}var MX=Math.sqrt(50),FX=Math.sqrt(10),OX=Math.sqrt(2);function RX(e,t,n){var r,i=-1,s,a,o;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(s=e,e=t,t=s),(o=FRe(e,t,n))===0||!isFinite(o))return[];if(o>0){let l=Math.round(e/o),u=Math.round(t/o);for(l*o<e&&++l,u*o>t&&--u,a=new Array(s=u-l+1);++i<s;)a[i]=(l+i)*o}else{o=-o;let l=Math.round(e*o),u=Math.round(t*o);for(l/o<e&&++l,u/o>t&&--u,a=new Array(s=u-l+1);++i<s;)a[i]=(l+i)/o}return r&&a.reverse(),a}function FRe(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,i);return i>=0?(s>=MX?10:s>=FX?5:s>=OX?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=MX?10:s>=FX?5:s>=OX?2:1)}function J0(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=MX?i*=10:s>=FX?i*=5:s>=OX&&(i*=2),t<e?-i:i}function ny(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function PX(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function ORe(e,t,n=0,r=e.length-1,i=V_){for(;r>n;){if(r-n>600){const l=r-n+1,u=t-n+1,c=Math.log(l),f=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*f*(l-f)/l)*(u-l/2<0?-1:1),d=Math.max(n,Math.floor(t-u*f/l+h)),p=Math.min(r,Math.floor(t+(l-u)*f/l+h));ORe(e,t,d,p,i)}const s=e[t];let a=n,o=r;for(fk(e,n,t),i(e[r],s)>0&&fk(e,n,r);a<o;){for(fk(e,a,o),++a,--o;i(e[a],s)<0;)++a;for(;i(e[o],s)>0;)--o}i(e[n],s)===0?fk(e,n,o):(++o,fk(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}return e}function fk(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function LX(e,t,n){if(e=Float64Array.from(k9t(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return PX(e);if(t>=1)return ny(e);var r,i=(r-1)*t,s=Math.floor(i),a=ny(ORe(e,s).subarray(0,s+1)),o=PX(e.subarray(s+1));return a+(o-a)*(i-s)}}function RRe(e,t,n=IRe){if(!!(r=e.length)){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function N9t(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n}function PRe(e,t){return LX(e,.5,t)}function*I9t(e){for(const t of e)yield*t}function LRe(e){return Array.from(I9t(e))}function Ml(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function BRe(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function M9t(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function BX(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:M9t(e)}function zRe(e,t,n){return n||e+(t?"_"+t:"")}const Yj=()=>{},F9t={init:Yj,add:Yj,rem:Yj,idx:0},HT={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},rM=Object.keys(HT);function O9t(e,t){return n=>zt({name:e,out:n||e},F9t,t)}rM.forEach(e=>{HT[e]=O9t(e,HT[e])});function URe(e,t){return HT[e](t)}function WRe(e,t){return e.idx-t.idx}function R9t(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{!r.req||r.req.forEach(i=>{t[i]||n(t[i]=HT[i]())})};return e.forEach(n),Object.values(t).sort(WRe)}function P9t(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function L9t(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function B9t(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function z9t(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function VRe(e,t){const n=t||ll,r=R9t(e),i=e.slice().sort(WRe);function s(a){this._ops=r,this._out=i,this.cell=a,this.init()}return s.prototype.init=P9t,s.prototype.add=L9t,s.prototype.rem=B9t,s.prototype.set=z9t,s.prototype.get=n,s.fields=e.map(a=>a.out),s}function tie(e){this._key=e?ql(e):nt,this.reset()}const Zs=tie.prototype;Zs.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Zs.add=function(e){this._add.push(e)};Zs.rem=function(e){this._rem.push(e)};Zs.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,s=Array(r-i),a={};let o,l,u;for(o=0;o<i;++o)a[n(t[o])]=1;for(o=0,l=0;o<r;++o)a[n(u=e[o])]?a[n(u)]=0:s[l++]=u;return this._rem=[],this._add=s};Zs.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,s;for(;--r>=0;)s=e(t[r])+"",bt(n,s)||(n[s]=1,++i);return i};Zs.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=t8t(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Zs.argmin=function(e){return this.extent(e)[0]||{}};Zs.argmax=function(e){return this.extent(e)[1]||{}};Zs.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Zs.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Zs.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=mRe(this.values(),e),this._get=e),this._q};Zs.q1=function(e){return this.quartile(e)[0]};Zs.q2=function(e){return this.quartile(e)[1]};Zs.q3=function(e){return this.quartile(e)[2]};Zs.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=r9t(this.values(),1e3,.05,e),this._get=e),this._ci};Zs.ci0=function(e){return this.ci(e)[0]};Zs.ci1=function(e){return this.ci(e)[1]};function em(e){me.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}em.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:rM},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};Ne(em,me,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function s(o){let l,u,c,f;for(l in o)for(c=o[l].tuple,u=0;u<i;++u)r[u][f=c[n[u]]]=f}s(e._prev),s(t);function a(o,l,u){const c=n[u],f=r[u++];for(const h in f){const d=o?o+"|"+h:h;l[c]=f[h],u<i?a(d,l,u):t[d]||e.cell(d,l)}}a("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(m){const v=ct(lo(m)),y=v.length;let b=0,x;for(;b<y;++b)r[x=v[b]]||(r[x]=1,t.push(x))}this._dims=ct(e.groupby),this._dnames=this._dims.map(m=>{const v=li(m);return i(m),n.push(v),v}),this.cellkey=e.key?e.key:BX(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],a=e.ops||["count"],o=e.as||[],l=s.length,u={};let c,f,h,d,p,g;for(l!==a.length&&$e("Unmatched number of fields and aggregate ops."),g=0;g<l;++g){if(c=s[g],f=a[g],c==null&&f!=="count"&&$e("Null aggregate field specified."),d=li(c),p=zRe(f,d,o[g]),n.push(p),f==="count"){this._counts.push(p);continue}h=u[d],h||(i(c),h=u[d]=[],h.field=c,this._measures.push(h)),f!=="count"&&(this._countOnly=!1),h.push(URe(f,p))}return this._measures=this._measures.map(m=>VRe(m,m.field)),{}},cellkey:BX(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let s=0;s<i;++s)n.agg[s]=new r[s](n)}return n.store&&(n.data=new tie),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,s={};for(let a=0;a<i;++a)s[n[a]]=r[a](e);return t?aRe(t.tuple,s):Tn(s)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,s=r.length;i<s;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,s=r.length;i<s;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,s=r.length;i<s;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,s=e.add,a=e.rem,o=e.mod;let l,u,c,f;if(r)for(u in r)l=r[u],(!i||l.num)&&a.push(l.tuple);for(c=0,f=this._alen;c<f;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)l=n[c],(l.num===0&&i?a:o).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const U9t=1e-14;function nie(e){me.call(this,null,e)}nie.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};Ne(nie,me,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,s=r.step,a=e.as||["bin0","bin1"],o=a[0],l=a[1];let u;return e.modified()?(t=t.reflow(!0),u=t.SOURCE):u=t.modified(lo(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?c=>{const f=r(c);c[o]=f,c[l]=f==null?null:i+s*(1+(f-i)/s)}:c=>c[o]=r(c)),t.modifies(n?a:o)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=n9t(e),r=n.step;let i=n.start,s=i+Math.ceil((n.stop-i)/r)*r,a,o;(a=e.anchor)!=null&&(o=a-(i+r*Math.floor((a-i)/r)),i+=o,s+=o);const l=function(u){let c=ao(t(u));return c==null?null:c<i?-1/0:c>s?1/0:(c=Math.max(i,Math.min(c,s-r)),i+r*Math.floor(U9t+(c-i)/r))};return l.start=i,l.stop=n.stop,l.step=r,this.value=eu(l,lo(t),e.name||"bin_"+li(t))}});function jRe(e,t,n){const r=e;let i=t||[],s=n||[],a={},o=0;return{add:l=>s.push(l),remove:l=>a[r(l)]=++o,size:()=>i.length,data:(l,u)=>(o&&(i=i.filter(c=>!a[r(c)]),a={},o=0),u&&l&&i.sort(l),s.length&&(i=l?c8t(l,i,s.sort(l)):i.concat(s),s=[]),i)}}function rie(e){me.call(this,[],e)}rie.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};Ne(rie,me,{transform(e,t){const n=t.fork(t.ALL),r=jRe(nt,this.value,n.materialize(n.ADD).add),i=e.sort,s=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(s),this.value=n.source=r.data(ix(i),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function HRe(e){er.call(this,null,W9t,e)}Ne(HRe,er);function W9t(e){return this.value&&!e.modified()?this.value:aOe(e.fields,e.orders)}function iie(e){me.call(this,null,e)}iie.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function V9t(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}Ne(iie,me,{transform(e,t){const n=f=>h=>{for(var d=V9t(o(h),e.case,s)||[],p,g=0,m=d.length;g<m;++g)a.test(p=d[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,s=this._match,a=this._stop,o=e.field,l=e.as||["text","count"],u=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,u):(t.visit(t.ADD,u),t.visit(t.REM,c)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],s=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let o,l,u;for(o in n)l=r[o],u=n[o]||0,!l&&u?(r[o]=l=Tn({}),l[i]=o,l[s]=u,a.add.push(l)):u===0?(l&&a.rem.push(l),n[o]=null,r[o]=null):l[s]!==u&&(l[s]=u,a.mod.push(l));return a.modifies(t)}});function sie(e){me.call(this,null,e)}sie.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};Ne(sie,me,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],s=r[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let o=this.value;return a?(o&&(n.rem=o),o=t.materialize(t.SOURCE).source,n.add=this.value=j9t(o,i,s,e.filter||ef)):n.mod=o,n.source=this.value,n.modifies(r)}});function j9t(e,t,n,r){for(var i=[],s={},a=e.length,o=0,l,u;o<a;++o)for(s[t]=u=e[o],l=0;l<a;++l)s[n]=e[l],r(s)&&(i.push(Tn(s)),s={},s[t]=u);return i}const Gme={kde:wRe,mixture:u9t,normal:xRe,lognormal:l9t,uniform:c9t},H9t="distributions",Yme="function",q9t="field";function qRe(e,t){const n=e[Yme];bt(Gme,n)||$e("Unknown distribution function: "+n);const r=Gme[n]();for(const i in e)i===q9t?r.data((e.from||t()).map(e[i])):i===H9t?r[i](e[i].map(s=>qRe(s,t))):typeof r[i]===Yme&&r[i](e[i]);return r}function aie(e){me.call(this,null,e)}const GRe=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],G9t={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:GRe},{name:"weights",type:"number",array:!0}]};aie.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:GRe.concat(G9t)},{name:"as",type:"string",array:!0,default:["value","density"]}]};Ne(aie,me,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=qRe(e.distribution,Y9t(t)),i=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let a=e.method||"pdf";a!=="pdf"&&a!=="cdf"&&$e("Invalid density method: "+a),!e.extent&&!r.data&&$e("Missing density extent parameter."),a=r[a];const o=e.as||["value","density"],l=e.extent||Rp(r.data()),u=eie(a,l,i,s).map(c=>{const f={};return f[o[0]]=c[0],f[o[1]]=c[1],Tn(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function Y9t(e){return()=>e.materialize(e.SOURCE).source}function YRe(e,t){return e?e.map((n,r)=>t[r]||li(n)):null}function oie(e,t,n){const r=[],i=f=>f(l);let s,a,o,l,u,c;if(t==null)r.push(e.map(n));else for(s={},a=0,o=e.length;a<o;++a)l=e[a],u=t.map(i),c=s[u],c||(s[u]=c=[],c.dims=u,r.push(c)),c.push(n(l));return r}const XRe="bin";function lie(e){me.call(this,null,e)}lie.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:XRe}]};const X9t=(e,t)=>t9(Rp(e,t))/30;Ne(lie,me,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=oie(t.source,e.groupby,ll),i=e.smooth||!1,s=e.field,a=e.step||X9t(n,s),o=ix((p,g)=>s(p)-s(g)),l=e.as||XRe,u=r.length;let c=1/0,f=-1/0,h=0,d;for(;h<u;++h){const p=r[h].sort(o);d=-1;for(const g of i9t(p,a,i,s))g<c&&(c=g),g>f&&(f=g),p[++d][l]=g}return this.value={start:c,stop:f,step:a},t.reflow(!0).modifies(l)}});function KRe(e){er.call(this,null,K9t,e),this.modified(!0)}Ne(KRe,er);function K9t(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:eu(n=>t(n,e),lo(t),li(t))}function uie(e){me.call(this,[void 0,void 0],e)}uie.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};Ne(uie,me,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let s=n[0],a=n[1];if((i||s==null)&&(s=1/0,a=-1/0),t.visit(i?t.SOURCE:t.ADD,o=>{const l=ao(r(o));l!=null&&(l<s&&(s=l),l>a&&(a=l))}),!Number.isFinite(s)||!Number.isFinite(a)){let o=li(r);o&&(o=` for field "${o}"`),t.dataflow.warn(`Infinite extent${o}: [${s}, ${a}]`),s=a=void 0}this.value=[s,a]}});function cie(e,t){er.call(this,e),this.parent=t,this.count=0}Ne(cie,er,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function l9(e){me.call(this,{},e),this._keys=KI();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}Ne(l9,me,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let s=bt(i,e)&&i[e],a,o;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(o=r||(o=this._group[e])&&o.tuple,a=n.dataflow,s=new cie(n.fork(n.NO_SOURCE),this),a.add(s).connect(t(a,e,o)),i[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,s=this._keys,a=e.modified("key"),o=l=>this.subflow(l,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,l=>{const u=nt(l),c=s.get(u);c!==void 0&&(s.delete(u),o(c).rem(l))}),t.visit(t.ADD,l=>{const u=r(l);s.set(nt(l),u),o(u).add(l)}),a||t.modified(r.fields)?t.visit(t.MOD,l=>{const u=nt(l),c=s.get(u),f=r(l);c===f?o(f).mod(l):(s.set(u,f),o(c).rem(l),o(f).add(l))}):t.changed(t.MOD)&&t.visit(t.MOD,l=>{o(s.get(nt(l))).mod(l)}),a&&t.visit(t.REFLOW,l=>{const u=nt(l),c=s.get(u),f=r(l);c!==f&&(s.set(u,f),o(c).rem(l),o(f).add(l))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}});function ZRe(e){er.call(this,null,Z9t,e)}Ne(ZRe,er);function Z9t(e){return this.value&&!e.modified()?this.value:at(e.name)?ct(e.name).map(t=>ql(t)):ql(e.name,e.as)}function fie(e){me.call(this,KI(),e)}fie.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};Ne(fie,me,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),s=i.add,a=i.rem,o=i.mod,l=e.expr;let u=!0;t.visit(t.REM,f=>{const h=nt(f);r.has(h)?r.delete(h):a.push(f)}),t.visit(t.ADD,f=>{l(f,e)?s.push(f):r.set(nt(f),1)});function c(f){const h=nt(f),d=l(f,e),p=r.get(h);d&&p?(r.delete(h),s.push(f)):!d&&!p?(r.set(h,1),a.push(f)):u&&d&&!p&&o.push(f)}return t.visit(t.MOD,c),e.modified()&&(u=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function hie(e){me.call(this,[],e)}hie.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};Ne(hie,me,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=YRe(r,e.as||[]),s=e.index||null,a=i.length;return n.rem=this.value,t.visit(t.SOURCE,o=>{const l=r.map(p=>p(o)),u=l.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,h,d;for(;c<u;++c){for(h=Yre(o),f=0;f<a;++f)h[i[f]]=(d=l[f][c])==null?null:d;s&&(h[s]=c),n.add.push(h)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(i)}});function die(e){me.call(this,[],e)}die.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};Ne(die,me,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(li),s=e.as||["key","value"],a=s[0],o=s[1],l=r.length;return n.rem=this.value,t.visit(t.SOURCE,u=>{for(let c=0,f;c<l;++c)f=Yre(u),f[a]=i[c],f[o]=r[c](u),n.add.push(f)}),this.value=n.source=n.add,n.modifies(s)}});function pie(e){me.call(this,null,e)}pie.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};Ne(pie,me,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),s=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(s,a=>a[r]=n(a,e))}});function QRe(e){me.call(this,[],e)}Ne(QRe,me,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,s=e.size-i.length,a,o,l;if(s>0){for(a=[];--s>=0;)a.push(l=Tn(r(e))),i.push(l);n.add=n.add.length?n.materialize(n.ADD).add.concat(a):a}else o=i.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,i=i.slice(-s);return n.source=this.value=i,n}});const AO={value:"value",median:PRe,mean:N9t,min:PX,max:ny},Q9t=[];function gie(e){me.call(this,[],e)}gie.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function J9t(e){var t=e.method||AO.value,n;if(AO[t]==null)$e("Unrecognized imputation method: "+t);else return t===AO.value?(n=e.value!==void 0?e.value:0,()=>n):AO[t]}function eUt(e){const t=e.field;return n=>n?t(n):NaN}Ne(gie,me,{transform(e,t){var n=t.fork(t.ALL),r=J9t(e),i=eUt(e),s=li(e.field),a=li(e.key),o=(e.groupby||[]).map(li),l=tUt(t.source,e.groupby,e.key,e.keyvals),u=[],c=this.value,f=l.domain.length,h,d,p,g,m,v,y,b,x,w;for(m=0,b=l.length;m<b;++m)for(h=l[m],p=h.values,d=NaN,y=0;y<f;++y)if(h[y]==null){for(g=l.domain[y],w={_impute:!0},v=0,x=p.length;v<x;++v)w[o[v]]=p[v];w[a]=g,w[s]=Number.isNaN(d)?d=r(h,i):d,u.push(Tn(w))}return u.length&&(n.add=n.materialize(n.ADD).add.concat(u)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=u,n}});function tUt(e,t,n,r){var i=v=>v(m),s=[],a=r?r.slice():[],o={},l={},u,c,f,h,d,p,g,m;for(a.forEach((v,y)=>o[v]=y+1),h=0,g=e.length;h<g;++h)m=e[h],p=n(m),d=o[p]||(o[p]=a.push(p)),c=(u=t?t.map(i):Q9t)+"",(f=l[c])||(f=l[c]=[],s.push(f),f.values=u),f[d-1]=m;return s.domain=a,s}function mie(e){em.call(this,e)}mie.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:rM},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};Ne(mie,em,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(i=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{zt(s,i[n.cellkey(s)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function vie(e){me.call(this,null,e)}vie.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};Ne(vie,me,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=oie(r,e.groupby,e.field),s=(e.groupby||[]).map(li),a=e.bandwidth,o=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],u=[];let c=e.extent,f=e.steps||e.minsteps||25,h=e.steps||e.maxsteps||200;o!=="pdf"&&o!=="cdf"&&$e("Invalid density method: "+o),e.resolve==="shared"&&(c||(c=Rp(r,e.field)),f=h=e.steps||h),i.forEach(d=>{const p=wRe(d,a)[o],g=e.counts?d.length:1,m=c||Rp(d);eie(p,m,f,h).forEach(v=>{const y={};for(let b=0;b<s.length;++b)y[s[b]]=d.dims[b];y[l[0]]=v[0],y[l[1]]=v[1]*g,u.push(Tn(y))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function JRe(e){er.call(this,null,nUt,e)}Ne(JRe,er);function nUt(e){return this.value&&!e.modified()?this.value:lOe(e.fields,e.flat)}function e4e(e){me.call(this,[],e),this._pending=null}Ne(e4e,me,{transform(e,t){const n=t.dataflow;return this._pending?Xj(this,t,this._pending):rUt(e)?t.StopPropagation:e.values?Xj(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=ct(i.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(r=>Xj(this,t,ct(r.data)))}});function rUt(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function Xj(e,t,n){n.forEach(Tn);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function yie(e){me.call(this,{},e)}yie.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};Ne(yie,me,{transform(e,t){const n=e.fields,r=e.index,i=e.values,s=e.default==null?null:e.default,a=e.modified(),o=n.length;let l=a?t.SOURCE:t.ADD,u=t,c=e.as,f,h,d;return i?(h=i.length,o>1&&!c&&$e('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==o*h&&$e('The "as" parameter has too few output field names.'),c=c||i.map(li),f=function(p){for(var g=0,m=0,v,y;g<o;++g)if(y=r.get(n[g](p)),y==null)for(v=0;v<h;++v,++m)p[c[m]]=s;else for(v=0;v<h;++v,++m)p[c[m]]=i[v](y)}):(c||$e("Missing output field names."),f=function(p){for(var g=0,m;g<o;++g)m=r.get(n[g](p)),p[c[g]]=m==null?s:m}),a?u=t.reflow(!0):(d=n.some(p=>t.modified(p.fields)),l|=d?t.MOD:0),t.visit(l,f),u.modifies(c)}});function t4e(e){er.call(this,null,iUt,e)}Ne(t4e,er);function iUt(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,s,a;for(s=0;s<n;++s)a=t[s],a[0]<r&&(r=a[0]),a[1]>i&&(i=a[1]);return[r,i]}function n4e(e){er.call(this,null,sUt,e)}Ne(n4e,er);function sUt(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function r4e(e){me.call(this,null,e)}Ne(r4e,me,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function bie(e){em.call(this,e)}bie.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:rM,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};Ne(bie,em,{_transform:em.prototype.transform,transform(e,t){return this._transform(aUt(e,t),t)}});function aUt(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",s=lo(n).concat(lo(r)),a=lUt(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:a.map(()=>i),fields:a.map(o=>oUt(o,n,r,s)),as:a.map(o=>o+""),modified:e.modified.bind(e)}}function oUt(e,t,n,r){return eu(i=>t(i)===e?n(i):NaN,r,e+"")}function lUt(e,t,n){const r={},i=[];return n.visit(n.SOURCE,s=>{const a=e(s);r[a]||(r[a]=1,i.push(a))}),i.sort(Fre),t?i.slice(0,t):i}function i4e(e){l9.call(this,e)}Ne(i4e,l9,{transform(e,t){const n=e.subflow,r=e.field,i=s=>this.subflow(nt(s),n,t,s);return(e.modified("field")||r&&t.modified(lo(r)))&&$e("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,s=>{const a=i(s);r(s).forEach(o=>a.mod(o))}),t.visit(t.ADD,s=>{const a=i(s);r(s).forEach(o=>a.add(Tn(o)))}),t.visit(t.REM,s=>{const a=i(s);r(s).forEach(o=>a.rem(o))})):(t.visit(t.MOD,s=>i(s).mod(s)),t.visit(t.ADD,s=>i(s).add(s)),t.visit(t.REM,s=>i(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}});function xie(e){me.call(this,null,e)}xie.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};Ne(xie,me,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=YRe(e.fields,e.as||[]),s=r?(o,l)=>uUt(o,l,r,i):i9;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,o=>{const l=nt(o);n.rem.push(a[l]),a[l]=null}),t.visit(t.ADD,o=>{const l=s(o,Tn({}));a[nt(o)]=l,n.add.push(l)}),t.visit(t.MOD,o=>{n.mod.push(s(o,a[nt(o)]))}),n}});function uUt(e,t,n,r){for(let i=0,s=n.length;i<s;++i)t[r[i]]=n[i](e);return t}function s4e(e){me.call(this,null,e)}Ne(s4e,me,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function wie(e){me.call(this,null,e)}wie.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const cUt=1e-14;Ne(wie,me,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,s=oie(i,e.groupby,e.field),a=(e.groupby||[]).map(li),o=[],l=e.step||.01,u=e.probs||Ml(l/2,1-cUt,l),c=u.length;return s.forEach(f=>{const h=gRe(f,u);for(let d=0;d<c;++d){const p={};for(let g=0;g<a.length;++g)p[a[g]]=f.dims[g];p[r[0]]=u[d],p[r[1]]=h[d],o.push(Tn(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=o,n}});function a4e(e){me.call(this,null,e)}Ne(a4e,me,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const s=nt(i);n.rem.push(r[s]),r[s]=null}),t.visit(t.ADD,i=>{const s=Yre(i);r[nt(i)]=s,n.add.push(s)}),t.visit(t.MOD,i=>{const s=r[nt(i)];for(const a in i)s[a]=i[a],n.modifies(a);n.mod.push(s)})),n}});function $ie(e){me.call(this,[],e),this.count=0}$ie.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};Ne($ie,me,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,s=this.value.reduce((c,f)=>(c[nt(f)]=1,c),{});let a=this.value,o=this.count,l=0;function u(c){let f,h;a.length<i?a.push(c):(h=~~((o+1)*Lp()),h<a.length&&h>=l&&(f=a[h],s[nt(f)]&&n.rem.push(f),a[h]=c)),++o}if(t.rem.length&&(t.visit(t.REM,c=>{const f=nt(c);s[f]&&(s[f]=-1,n.rem.push(c)),--o}),a=a.filter(c=>s[nt(c)]!==-1)),(t.rem.length||r)&&a.length<i&&t.source&&(l=o=a.length,t.visit(t.SOURCE,c=>{s[nt(c)]||u(c)}),l=-1),r&&a.length>i){const c=a.length-i;for(let f=0;f<c;++f)s[nt(a[f])]=-1,n.rem.push(a[f]);a=a.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[nt(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(n.add=a.filter(c=>!s[nt(c)])),this.count=o,this.value=n.source=a,n}});function Cie(e){me.call(this,null,e)}Cie.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};Ne(Cie,me,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Ml(e.start,e.stop,e.step||1).map(i=>{const s={};return s[r]=i,Tn(s)}),n.add=t.add.concat(this.value),n}});function o4e(e){me.call(this,null,e),this.modified(!0)}Ne(o4e,me,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function _ie(e){me.call(this,null,e)}const l4e=["unit0","unit1"];_ie.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:DOe,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:l4e}]};Ne(_ie,me,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",s=this._floor(e,t),a=(i?QI:ZI)(s.unit).offset,o=e.as||l4e,l=o[0],u=o[1],c=s.step;let f=s.start||1/0,h=s.stop||-1/0,d=t.ADD;return(e.modified()||t.modified(lo(n)))&&(t=t.reflow(!0),d=t.SOURCE,f=1/0,h=-1/0),t.visit(d,p=>{const g=n(p);let m,v;g==null?(p[l]=null,r&&(p[u]=null)):(p[l]=m=v=s(g),r&&(p[u]=v=a(m,c)),m<f&&(f=m),v>h&&(h=v))}),s.start=f,s.stop=h,t.modifies(r?o:l)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:EBt({extent:e.extent||Rp(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=NOe(r),a=this.value||{},o=(n?vBt:pBt)(s,i);return o.unit=un(s),o.units=s,o.step=i,o.start=a.start,o.stop=a.stop,this.value=o}});function u4e(e){me.call(this,KI(),e)}Ne(u4e,me,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,s=o=>i.set(r(o),o);let a=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,o=>i.delete(r(o))),t.visit(t.ADD,s)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function c4e(e){me.call(this,null,e)}Ne(c4e,me,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(ix(e.sort)):t.source).map(e.field))}});function fUt(e,t,n,r){const i=qT[e](t,n);return{init:i.init||l1,update:function(s,a){a[r]=i.next(s)}}}const qT={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=qT.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||$e("ntile num must be greater than zero.");const n=qT.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||$e("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=hUt(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function hUt(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const dUt=Object.keys(qT);function f4e(e){const t=ct(e.ops),n=ct(e.fields),r=ct(e.params),i=ct(e.as),s=this.outputs=[],a=this.windows=[],o={},l={},u=[],c=[];let f=!0;function h(d){ct(lo(d)).forEach(p=>o[p]=1)}h(e.sort),t.forEach((d,p)=>{const g=n[p],m=li(g),v=zRe(d,m,i[p]);if(h(g),s.push(v),bt(qT,d))a.push(fUt(d,n[p],r[p],v));else{if(g==null&&d!=="count"&&$e("Null aggregate field specified."),d==="count"){u.push(v);return}f=!1;let y=l[m];y||(y=l[m]=[],y.field=g,c.push(y)),y.push(URe(d,v))}}),(u.length||c.length)&&(this.cell=pUt(c,u,f)),this.inputs=Object.keys(o)}const h4e=f4e.prototype;h4e.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};h4e.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,s=r&&r.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(i[a]);for(a=e.p1;a<e.i1;++a)n.add(i[a]);n.set(t)}for(a=0;a<s;++a)r[a].update(e,t)};function pUt(e,t,n){e=e.map(l=>VRe(l,l.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,s=r.agg=Array(i),a=0;a<i;++a)s[a]=new e[a](r);if(r.store)var o=r.data=new tie;return r.add=function(l){if(r.num+=1,!n){o&&o.add(l);for(let u=0;u<i;++u)s[u].add(s[u].get(l),l)}},r.rem=function(l){if(r.num-=1,!n){o&&o.rem(l);for(let u=0;u<i;++u)s[u].rem(s[u].get(l),l)}},r.set=function(l){let u,c;for(o&&o.values(),u=0,c=t.length;u<c;++u)l[t[u]]=r.num;if(!n)for(u=0,c=s.length;u<c;++u)s[u].set(l)},r.init=function(){r.num=0,o&&o.reset();for(let l=0;l<i;++l)s[l].init()},r}function Sie(e){me.call(this,{},e),this._mlen=0,this._mods=[]}Sie.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:dUt.concat(rM)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};Ne(Sie,me,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=ix(e.sort),i=BX(e.groupby),s=o=>this.group(i(o));let a=this.state;(!a||n)&&(a=this.state=new f4e(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,o=>s(o).add(o))):(t.visit(t.REM,o=>s(o).remove(o)),t.visit(t.ADD,o=>s(o).add(o)));for(let o=0,l=this._mlen;o<l;++o)gUt(this._mods[o],a,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=jRe(nt),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function gUt(e,t,n,r){const i=r.sort,s=i&&!r.ignorePeers,a=r.frame||[null,0],o=e.data(n),l=o.length,u=s?tM(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:o,compare:i||vo(-1)};t.init();for(let f=0;f<l;++f)mUt(c,a,f,l),s&&vUt(c,u),t.update(c,o[f])}function mUt(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function vUt(e,t){const n=e.i0,r=e.i1-1,i=e.compare,s=e.data,a=s.length-1;n>0&&!i(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),r<a&&!i(s[r],s[r+1])&&(e.i1=t.right(s,s[r]))}const yUt=Object.freeze(Object.defineProperty({__proto__:null,aggregate:em,bin:nie,collect:rie,compare:HRe,countpattern:iie,cross:sie,density:aie,dotbin:lie,expression:KRe,extent:uie,facet:l9,field:ZRe,filter:fie,flatten:hie,fold:die,formula:pie,generate:QRe,impute:gie,joinaggregate:mie,kde:vie,key:JRe,load:e4e,lookup:yie,multiextent:t4e,multivalues:n4e,params:r4e,pivot:bie,prefacet:i4e,project:xie,proxy:s4e,quantile:wie,relay:a4e,sample:$ie,sequence:Cie,sieve:o4e,subflow:cie,timeunit:_ie,tupleindex:u4e,values:c4e,window:Sie},Symbol.toStringTag,{value:"Module"}));function Nn(e){return function(){return e}}const Xme=Math.abs,Js=Math.atan2,Dv=Math.cos,bUt=Math.max,Kj=Math.min,Ef=Math.sin,D1=Math.sqrt,na=1e-12,Jw=Math.PI,hP=Jw/2,d4e=2*Jw;function xUt(e){return e>1?0:e<-1?Jw:Math.acos(e)}function Kme(e){return e>=1?hP:e<=-1?-hP:Math.asin(e)}const zX=Math.PI,UX=2*zX,Kv=1e-6,wUt=UX-Kv;function p4e(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function $Ut(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return p4e;const n=10**t;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class CUt{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?p4e:$Ut(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,a){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,l=r-t,u=i-n,c=a-t,f=o-n,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>Kv)if(!(Math.abs(f*l-u*c)>Kv)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let d=r-a,p=i-o,g=l*l+u*u,m=d*d+p*p,v=Math.sqrt(g),y=Math.sqrt(h),b=s*Math.tan((zX-Math.acos((g+h-m)/(2*v*y)))/2),x=b/y,w=b/v;Math.abs(x-1)>Kv&&this._append`L${t+x*c},${n+x*f}`,this._append`A${s},${s},0,0,${+(f*d>c*p)},${this._x1=t+w*l},${this._y1=n+w*u}`}}arc(t,n,r,i,s,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),l=r*Math.sin(i),u=t+o,c=n+l,f=1^a,h=a?i-s:s-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>Kv||Math.abs(this._y1-c)>Kv)&&this._append`L${u},${c}`,r&&(h<0&&(h=h%UX+UX),h>wUt?this._append`A${r},${r},0,1,${f},${t-o},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:h>Kv&&this._append`A${r},${r},0,${+(h>=zX)},${f},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function u9(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new CUt(t)}function _Ut(e){return e.innerRadius}function SUt(e){return e.outerRadius}function kUt(e){return e.startAngle}function EUt(e){return e.endAngle}function AUt(e){return e&&e.padAngle}function TUt(e,t,n,r,i,s,a,o){var l=n-e,u=r-t,c=a-i,f=o-s,h=f*l-c*u;if(!(h*h<na))return h=(c*(t-s)-f*(e-i))/h,[e+h*l,t+h*u]}function TO(e,t,n,r,i,s,a){var o=e-n,l=t-r,u=(a?s:-s)/D1(o*o+l*l),c=u*l,f=-u*o,h=e+c,d=t+f,p=n+c,g=r+f,m=(h+p)/2,v=(d+g)/2,y=p-h,b=g-d,x=y*y+b*b,w=i-s,C=h*g-p*d,$=(b<0?-1:1)*D1(bUt(0,w*w*x-C*C)),_=(C*b-y*$)/x,k=(-C*y-b*$)/x,E=(C*b+y*$)/x,S=(-C*y+b*$)/x,N=_-m,A=k-v,D=E-m,T=S-v;return N*N+A*A>D*D+T*T&&(_=E,k=S),{cx:_,cy:k,x01:-c,y01:-f,x11:_*(i/w-1),y11:k*(i/w-1)}}function DUt(){var e=_Ut,t=SUt,n=Nn(0),r=null,i=kUt,s=EUt,a=AUt,o=null,l=u9(u);function u(){var c,f,h=+e.apply(this,arguments),d=+t.apply(this,arguments),p=i.apply(this,arguments)-hP,g=s.apply(this,arguments)-hP,m=Xme(g-p),v=g>p;if(o||(o=c=l()),d<h&&(f=d,d=h,h=f),!(d>na))o.moveTo(0,0);else if(m>d4e-na)o.moveTo(d*Dv(p),d*Ef(p)),o.arc(0,0,d,p,g,!v),h>na&&(o.moveTo(h*Dv(g),h*Ef(g)),o.arc(0,0,h,g,p,v));else{var y=p,b=g,x=p,w=g,C=m,$=m,_=a.apply(this,arguments)/2,k=_>na&&(r?+r.apply(this,arguments):D1(h*h+d*d)),E=Kj(Xme(d-h)/2,+n.apply(this,arguments)),S=E,N=E,A,D;if(k>na){var T=Kme(k/h*Ef(_)),I=Kme(k/d*Ef(_));(C-=T*2)>na?(T*=v?1:-1,x+=T,w-=T):(C=0,x=w=(p+g)/2),($-=I*2)>na?(I*=v?1:-1,y+=I,b-=I):($=0,y=b=(p+g)/2)}var F=d*Dv(y),R=d*Ef(y),P=h*Dv(w),V=h*Ef(w);if(E>na){var z=d*Dv(b),q=d*Ef(b),G=h*Dv(x),K=h*Ef(x),Y;if(m<Jw)if(Y=TUt(F,R,G,K,z,q,P,V)){var te=F-Y[0],Z=R-Y[1],ae=z-Y[0],O=q-Y[1],L=1/Ef(xUt((te*ae+Z*O)/(D1(te*te+Z*Z)*D1(ae*ae+O*O)))/2),W=D1(Y[0]*Y[0]+Y[1]*Y[1]);S=Kj(E,(h-W)/(L-1)),N=Kj(E,(d-W)/(L+1))}else S=N=0}$>na?N>na?(A=TO(G,K,F,R,d,N,v),D=TO(z,q,P,V,d,N,v),o.moveTo(A.cx+A.x01,A.cy+A.y01),N<E?o.arc(A.cx,A.cy,N,Js(A.y01,A.x01),Js(D.y01,D.x01),!v):(o.arc(A.cx,A.cy,N,Js(A.y01,A.x01),Js(A.y11,A.x11),!v),o.arc(0,0,d,Js(A.cy+A.y11,A.cx+A.x11),Js(D.cy+D.y11,D.cx+D.x11),!v),o.arc(D.cx,D.cy,N,Js(D.y11,D.x11),Js(D.y01,D.x01),!v))):(o.moveTo(F,R),o.arc(0,0,d,y,b,!v)):o.moveTo(F,R),!(h>na)||!(C>na)?o.lineTo(P,V):S>na?(A=TO(P,V,z,q,h,-S,v),D=TO(F,R,G,K,h,-S,v),o.lineTo(A.cx+A.x01,A.cy+A.y01),S<E?o.arc(A.cx,A.cy,S,Js(A.y01,A.x01),Js(D.y01,D.x01),!v):(o.arc(A.cx,A.cy,S,Js(A.y01,A.x01),Js(A.y11,A.x11),!v),o.arc(0,0,h,Js(A.cy+A.y11,A.cx+A.x11),Js(D.cy+D.y11,D.cx+D.x11),v),o.arc(D.cx,D.cy,S,Js(D.y11,D.x11),Js(D.y01,D.x01),!v))):o.arc(0,0,h,w,x,v)}if(o.closePath(),c)return o=null,c+""||null}return u.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-Jw/2;return[Dv(f)*c,Ef(f)*c]},u.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Nn(+c),u):e},u.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Nn(+c),u):t},u.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Nn(+c),u):n},u.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Nn(+c),u):r},u.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:Nn(+c),u):i},u.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Nn(+c),u):s},u.padAngle=function(c){return arguments.length?(a=typeof c=="function"?c:Nn(+c),u):a},u.context=function(c){return arguments.length?(o=c==null?null:c,u):o},u}function g4e(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function m4e(e){this._context=e}m4e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function kie(e){return new m4e(e)}function v4e(e){return e[0]}function y4e(e){return e[1]}function b4e(e,t){var n=Nn(!0),r=null,i=kie,s=null,a=u9(o);e=typeof e=="function"?e:e===void 0?v4e:Nn(e),t=typeof t=="function"?t:t===void 0?y4e:Nn(t);function o(l){var u,c=(l=g4e(l)).length,f,h=!1,d;for(r==null&&(s=i(d=a())),u=0;u<=c;++u)!(u<c&&n(f=l[u],u,l))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(f,u,l),+t(f,u,l));if(d)return s=null,d+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:Nn(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:Nn(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:Nn(!!l),o):n},o.curve=function(l){return arguments.length?(i=l,r!=null&&(s=i(r)),o):i},o.context=function(l){return arguments.length?(l==null?r=s=null:s=i(r=l),o):r},o}function x4e(e,t,n){var r=null,i=Nn(!0),s=null,a=kie,o=null,l=u9(u);e=typeof e=="function"?e:e===void 0?v4e:Nn(+e),t=typeof t=="function"?t:Nn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?y4e:Nn(+n);function u(f){var h,d,p,g=(f=g4e(f)).length,m,v=!1,y,b=new Array(g),x=new Array(g);for(s==null&&(o=a(y=l())),h=0;h<=g;++h){if(!(h<g&&i(m=f[h],h,f))===v)if(v=!v)d=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=h-1;p>=d;--p)o.point(b[p],x[p]);o.lineEnd(),o.areaEnd()}v&&(b[h]=+e(m,h,f),x[h]=+t(m,h,f),o.point(r?+r(m,h,f):b[h],n?+n(m,h,f):x[h]))}if(y)return o=null,y+""||null}function c(){return b4e().defined(i).curve(a).context(s)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:Nn(+f),r=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Nn(+f),u):e},u.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Nn(+f),u):r},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:Nn(+f),n=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Nn(+f),u):t},u.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Nn(+f),u):n},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(n)},u.lineX1=function(){return c().x(r).y(t)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:Nn(!!f),u):i},u.curve=function(f){return arguments.length?(a=f,s!=null&&(o=a(s)),u):a},u.context=function(f){return arguments.length?(f==null?s=o=null:o=a(s=f),u):s},u}const NUt={draw(e,t){const n=D1(t/Jw);e.moveTo(n,0),e.arc(0,0,n,0,d4e)}};function IUt(e,t){let n=null,r=u9(i);e=typeof e=="function"?e:Nn(e||NUt),t=typeof t=="function"?t:Nn(t===void 0?64:+t);function i(){let s;if(n||(n=s=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:Nn(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:Nn(+s),i):t},i.context=function(s){return arguments.length?(n=s==null?null:s,i):n},i}function tm(){}function dP(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function c9(e){this._context=e}c9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:dP(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:dP(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function MUt(e){return new c9(e)}function w4e(e){this._context=e}w4e.prototype={areaStart:tm,areaEnd:tm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:dP(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function FUt(e){return new w4e(e)}function $4e(e){this._context=e}$4e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:dP(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function OUt(e){return new $4e(e)}function C4e(e,t){this._basis=new c9(e),this._beta=t}C4e.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,a=t[n]-i,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*s),this._beta*t[o]+(1-this._beta)*(i+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const RUt=function e(t){function n(r){return t===1?new c9(r):new C4e(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function pP(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Eie(e,t){this._context=e,this._k=(1-t)/6}Eie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:pP(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:pP(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const PUt=function e(t){function n(r){return new Eie(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Aie(e,t){this._context=e,this._k=(1-t)/6}Aie.prototype={areaStart:tm,areaEnd:tm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:pP(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const LUt=function e(t){function n(r){return new Aie(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Tie(e,t){this._context=e,this._k=(1-t)/6}Tie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:pP(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const BUt=function e(t){function n(r){return new Tie(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Die(e,t,n){var r=e._x1,i=e._y1,s=e._x2,a=e._y2;if(e._l01_a>na){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>na){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,s,a,e._x2,e._y2)}function _4e(e,t){this._context=e,this._alpha=t}_4e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Die(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const zUt=function e(t){function n(r){return t?new _4e(r,t):new Eie(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function S4e(e,t){this._context=e,this._alpha=t}S4e.prototype={areaStart:tm,areaEnd:tm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Die(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const UUt=function e(t){function n(r){return t?new S4e(r,t):new Aie(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function k4e(e,t){this._context=e,this._alpha=t}k4e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Die(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const WUt=function e(t){function n(r){return t?new k4e(r,t):new Tie(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function E4e(e){this._context=e}E4e.prototype={areaStart:tm,areaEnd:tm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function VUt(e){return new E4e(e)}function Zme(e){return e<0?-1:1}function Qme(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),o=(s*i+a*r)/(r+i);return(Zme(s)+Zme(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function Jme(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Zj(e,t,n){var r=e._x0,i=e._y0,s=e._x1,a=e._y1,o=(s-r)/3;e._context.bezierCurveTo(r+o,i+o*t,s-o,a-o*n,s,a)}function gP(e){this._context=e}gP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Zj(this,this._t0,Jme(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Zj(this,Jme(this,n=Qme(this,e,t)),n);break;default:Zj(this,this._t0,n=Qme(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function A4e(e){this._context=new T4e(e)}(A4e.prototype=Object.create(gP.prototype)).point=function(e,t){gP.prototype.point.call(this,t,e)};function T4e(e){this._context=e}T4e.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function jUt(e){return new gP(e)}function HUt(e){return new A4e(e)}function D4e(e){this._context=e}D4e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=eve(e),i=eve(t),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function eve(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),a=new Array(n);for(i[0]=0,s[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function qUt(e){return new D4e(e)}function f9(e,t){this._context=e,this._t=t}f9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function GUt(e){return new f9(e,.5)}function YUt(e){return new f9(e,0)}function XUt(e){return new f9(e,1)}const WX=Math.PI,VX=2*WX,Zv=1e-6,KUt=VX-Zv;function N4e(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function ZUt(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return N4e;const n=10**t;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class I4e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?N4e:ZUt(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,a){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,l=r-t,u=i-n,c=a-t,f=o-n,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>Zv)if(!(Math.abs(f*l-u*c)>Zv)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let d=r-a,p=i-o,g=l*l+u*u,m=d*d+p*p,v=Math.sqrt(g),y=Math.sqrt(h),b=s*Math.tan((WX-Math.acos((g+h-m)/(2*v*y)))/2),x=b/y,w=b/v;Math.abs(x-1)>Zv&&this._append`L${t+x*c},${n+x*f}`,this._append`A${s},${s},0,0,${+(f*d>c*p)},${this._x1=t+w*l},${this._y1=n+w*u}`}}arc(t,n,r,i,s,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),l=r*Math.sin(i),u=t+o,c=n+l,f=1^a,h=a?i-s:s-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>Zv||Math.abs(this._y1-c)>Zv)&&this._append`L${u},${c}`,r&&(h<0&&(h=h%VX+VX),h>KUt?this._append`A${r},${r},0,1,${f},${t-o},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:h>Zv&&this._append`A${r},${r},0,${+(h>=WX)},${f},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Nie(){return new I4e}Nie.prototype=I4e.prototype;function Ku(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const Iie=()=>typeof Image<"u"?Image:null;function c4(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function QUt(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function M4e(e){let t,n,r;e.length!==2?(t=c4,n=(o,l)=>c4(e(o),l),r=(o,l)=>e(o)-l):(t=e===c4||e===QUt?e:JUt,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function JUt(){return 0}function eWt(e){return e===null?NaN:+e}const tWt=M4e(c4),jX=tWt.right;M4e(eWt).center;const nWt=jX;function rWt(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function hA(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function iWt(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Mie(e){let t,n,r;e.length!==2?(t=hA,n=(o,l)=>hA(e(o),l),r=(o,l)=>e(o)-l):(t=e===hA||e===iWt?e:sWt,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function sWt(){return 0}function F4e(e){return e===null?NaN:+e}const aWt=Mie(hA),oWt=aWt.right;Mie(F4e).center;const h9=oWt,lWt=Math.sqrt(50),uWt=Math.sqrt(10),cWt=Math.sqrt(2);function mP(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=lWt?10:s>=uWt?5:s>=cWt?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?mP(e,t,n*2):[o,l,u]}function HX(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,a]=r?mP(t,e,n):mP(e,t,n);if(!(s>=i))return[];const o=s-i+1,l=new Array(o);if(r)if(a<0)for(let u=0;u<o;++u)l[u]=(s-u)/-a;else for(let u=0;u<o;++u)l[u]=(s-u)*a;else if(a<0)for(let u=0;u<o;++u)l[u]=(i+u)/-a;else for(let u=0;u<o;++u)l[u]=(i+u)*a;return l}function qX(e,t,n){return t=+t,e=+e,n=+n,mP(e,t,n)[2]}function GX(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?qX(t,e,n):qX(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function fWt(e,t,n=F4e){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function od(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Zm(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const YX=Symbol("implicit");function Fie(){var e=new Gw,t=[],n=[],r=YX;function i(s){let a=e.get(s);if(a===void 0){if(r!==YX)return r;e.set(s,a=t.push(s)-1)}return n[a%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new Gw;for(const a of s)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return Fie(t,n).unknown(r)},od.apply(i,arguments),i}function Oie(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function O4e(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function iM(){}var GT=.7,vP=1/GT,J2="\\s*([+-]?\\d+)\\s*",YT="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",lh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hWt=/^#([0-9a-f]{3,8})$/,dWt=new RegExp(`^rgb\\(${J2},${J2},${J2}\\)$`),pWt=new RegExp(`^rgb\\(${lh},${lh},${lh}\\)$`),gWt=new RegExp(`^rgba\\(${J2},${J2},${J2},${YT}\\)$`),mWt=new RegExp(`^rgba\\(${lh},${lh},${lh},${YT}\\)$`),vWt=new RegExp(`^hsl\\(${YT},${lh},${lh}\\)$`),yWt=new RegExp(`^hsla\\(${YT},${lh},${lh},${YT}\\)$`),tve={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Oie(iM,XT,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:nve,formatHex:nve,formatHex8:bWt,formatHsl:xWt,formatRgb:rve,toString:rve});function nve(){return this.rgb().formatHex()}function bWt(){return this.rgb().formatHex8()}function xWt(){return R4e(this).formatHsl()}function rve(){return this.rgb().formatRgb()}function XT(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=hWt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?ive(t):n===3?new Yo(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?DO(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?DO(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=dWt.exec(e))?new Yo(t[1],t[2],t[3],1):(t=pWt.exec(e))?new Yo(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=gWt.exec(e))?DO(t[1],t[2],t[3],t[4]):(t=mWt.exec(e))?DO(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=vWt.exec(e))?ove(t[1],t[2]/100,t[3]/100,1):(t=yWt.exec(e))?ove(t[1],t[2]/100,t[3]/100,t[4]):tve.hasOwnProperty(e)?ive(tve[e]):e==="transparent"?new Yo(NaN,NaN,NaN,0):null}function ive(e){return new Yo(e>>16&255,e>>8&255,e&255,1)}function DO(e,t,n,r){return r<=0&&(e=t=n=NaN),new Yo(e,t,n,r)}function wWt(e){return e instanceof iM||(e=XT(e)),e?(e=e.rgb(),new Yo(e.r,e.g,e.b,e.opacity)):new Yo}function XX(e,t,n,r){return arguments.length===1?wWt(e):new Yo(e,t,n,r==null?1:r)}function Yo(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Oie(Yo,XX,O4e(iM,{brighter(e){return e=e==null?vP:Math.pow(vP,e),new Yo(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?GT:Math.pow(GT,e),new Yo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Yo(ry(this.r),ry(this.g),ry(this.b),yP(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:sve,formatHex:sve,formatHex8:$Wt,formatRgb:ave,toString:ave}));function sve(){return`#${N1(this.r)}${N1(this.g)}${N1(this.b)}`}function $Wt(){return`#${N1(this.r)}${N1(this.g)}${N1(this.b)}${N1((isNaN(this.opacity)?1:this.opacity)*255)}`}function ave(){const e=yP(this.opacity);return`${e===1?"rgb(":"rgba("}${ry(this.r)}, ${ry(this.g)}, ${ry(this.b)}${e===1?")":`, ${e})`}`}function yP(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ry(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function N1(e){return e=ry(e),(e<16?"0":"")+e.toString(16)}function ove(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new _c(e,t,n,r)}function R4e(e){if(e instanceof _c)return new _c(e.h,e.s,e.l,e.opacity);if(e instanceof iM||(e=XT(e)),!e)return new _c;if(e instanceof _c)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new _c(a,o,l,e.opacity)}function CWt(e,t,n,r){return arguments.length===1?R4e(e):new _c(e,t,n,r==null?1:r)}function _c(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Oie(_c,CWt,O4e(iM,{brighter(e){return e=e==null?vP:Math.pow(vP,e),new _c(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?GT:Math.pow(GT,e),new _c(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Yo(Qj(e>=240?e-240:e+120,i,r),Qj(e,i,r),Qj(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new _c(lve(this.h),NO(this.s),NO(this.l),yP(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=yP(this.opacity);return`${e===1?"hsl(":"hsla("}${lve(this.h)}, ${NO(this.s)*100}%, ${NO(this.l)*100}%${e===1?")":`, ${e})`}`}}));function lve(e){return e=(e||0)%360,e<0?e+360:e}function NO(e){return Math.max(0,Math.min(1,e||0))}function Qj(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Rie=e=>()=>e;function _Wt(e,t){return function(n){return e+n*t}}function SWt(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function kWt(e){return(e=+e)==1?P4e:function(t,n){return n-t?SWt(t,n,e):Rie(isNaN(t)?n:t)}}function P4e(e,t){var n=t-e;return n?_Wt(e,n):Rie(isNaN(e)?t:e)}const uve=function e(t){var n=kWt(t);function r(i,s){var a=n((i=XX(i)).r,(s=XX(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=P4e(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function EWt(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function AWt(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function TWt(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=j_(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function DWt(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function bP(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function NWt(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=j_(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var KX=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jj=new RegExp(KX.source,"g");function IWt(e){return function(){return e}}function MWt(e){return function(t){return e(t)+""}}function FWt(e,t){var n=KX.lastIndex=Jj.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=KX.exec(e))&&(i=Jj.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:bP(r,i)})),n=Jj.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?MWt(l[0].x):IWt(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)o[(f=l[c]).i]=f.x(u);return o.join("")})}function j_(e,t){var n=typeof t,r;return t==null||n==="boolean"?Rie(t):(n==="number"?bP:n==="string"?(r=XT(t))?(t=r,uve):FWt:t instanceof XT?uve:t instanceof Date?DWt:AWt(t)?EWt:Array.isArray(t)?TWt:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?NWt:bP)(e,t)}function Pie(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function OWt(e,t){t===void 0&&(t=e,e=j_);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function RWt(e){return function(){return e}}function ZX(e){return+e}var cve=[0,1];function Xo(e){return e}function QX(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:RWt(isNaN(t)?NaN:.5)}function PWt(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function LWt(e,t,n){var r=e[0],i=e[1],s=t[0],a=t[1];return i<r?(r=QX(i,r),s=n(a,s)):(r=QX(r,i),s=n(s,a)),function(o){return s(r(o))}}function BWt(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=QX(e[a],e[a+1]),s[a]=n(t[a],t[a+1]);return function(o){var l=h9(e,o,1,r)-1;return s[l](i[l](o))}}function sM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function d9(){var e=cve,t=cve,n=j_,r,i,s,a=Xo,o,l,u;function c(){var h=Math.min(e.length,t.length);return a!==Xo&&(a=PWt(e[0],e[h-1])),o=h>2?BWt:LWt,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?s:(l||(l=o(e.map(r),t,n)))(r(a(h)))}return f.invert=function(h){return a(i((u||(u=o(t,e.map(r),bP)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,ZX),c()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),n=Pie,c()},f.clamp=function(h){return arguments.length?(a=h?!0:Xo,c()):a!==Xo},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,d){return r=h,i=d,c()}}function L4e(){return d9()(Xo,Xo)}function zWt(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function xP(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function e$(e){return e=xP(Math.abs(e)),e?e[1]:NaN}function UWt(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function WWt(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var VWt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function KT(e){if(!(t=VWt.exec(e)))throw new Error("invalid format: "+e);var t;return new Lie({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}KT.prototype=Lie.prototype;function Lie(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Lie.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function jWt(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var B4e;function HWt(e,t){var n=xP(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(B4e=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+xP(e,Math.max(0,t+s-1))[0]}function fve(e,t){var n=xP(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const hve={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:zWt,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>fve(e*100,t),r:fve,s:HWt,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function dve(e){return e}var pve=Array.prototype.map,gve=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function qWt(e){var t=e.grouping===void 0||e.thousands===void 0?dve:UWt(pve.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?dve:WWt(pve.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=KT(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):hve[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var C=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=g==="$"?r:/[%p]/.test(w)?a:"",_=hve[w],k=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(S){var N=C,A=$,D,T,I;if(w==="c")A=_(S)+A,S="";else{S=+S;var F=S<0||1/S<0;if(S=isNaN(S)?l:_(Math.abs(S),b),x&&(S=jWt(S)),F&&+S==0&&p!=="+"&&(F=!1),N=(F?p==="("?p:o:p==="-"||p==="("?"":p)+N,A=(w==="s"?gve[8+B4e/3]:"")+A+(F&&p==="("?")":""),k){for(D=-1,T=S.length;++D<T;)if(I=S.charCodeAt(D),48>I||I>57){A=(I===46?i+S.slice(D+1):S.slice(D))+A,S=S.slice(0,D);break}}}y&&!m&&(S=t(S,1/0));var R=N.length+S.length+A.length,P=R<v?new Array(v-R+1).join(h):"";switch(y&&m&&(S=t(P+S,P.length?v-A.length:1/0),P=""),d){case"<":S=N+S+A+P;break;case"=":S=N+P+S+A;break;case"^":S=P.slice(0,R=P.length>>1)+N+S+A+P.slice(R);break;default:S=P+N+S+A;break}return s(S)}return E.toString=function(){return f+""},E}function c(f,h){var d=u((f=KT(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(e$(h)/3)))*3,g=Math.pow(10,-p),m=gve[8+p/3];return function(v){return d(g*v)+m}}return{format:u,formatPrefix:c}}var IO,Bie,z4e;GWt({thousands:",",grouping:[3],currency:["$",""]});function GWt(e){return IO=qWt(e),Bie=IO.format,z4e=IO.formatPrefix,IO}function YWt(e){return Math.max(0,-e$(Math.abs(e)))}function XWt(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(e$(t)/3)))*3-e$(Math.abs(e)))}function KWt(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,e$(t)-e$(e))+1}function U4e(e,t,n,r){var i=GX(e,t,n),s;switch(r=KT(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=XWt(i,a))&&(r.precision=s),z4e(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=KWt(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=YWt(i))&&(r.precision=s-(r.type==="%")*2);break}}return Bie(r)}function ax(e){var t=e.domain;return e.ticks=function(n){var r=t();return HX(r[0],r[r.length-1],n==null?10:n)},e.tickFormat=function(n,r){var i=t();return U4e(i[0],i[i.length-1],n==null?10:n,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,a=r[i],o=r[s],l,u,c=10;for(o<a&&(u=a,a=o,o=u,u=i,i=s,s=u);c-- >0;){if(u=qX(a,o,n),u===l)return r[i]=a,r[s]=o,t(r);if(u>0)a=Math.floor(a/u)*u,o=Math.ceil(o/u)*u;else if(u<0)a=Math.ceil(a*u)/u,o=Math.floor(o*u)/u;else break;l=u}return e},e}function W4e(){var e=L4e();return e.copy=function(){return sM(e,W4e())},od.apply(e,arguments),ax(e)}function V4e(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,ZX),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return V4e(e).unknown(t)},e=arguments.length?Array.from(e,ZX):[0,1],ax(n)}function j4e(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),e[n]=t.floor(i),e[r]=t.ceil(s),e}function mve(e){return Math.log(e)}function vve(e){return Math.exp(e)}function ZWt(e){return-Math.log(-e)}function QWt(e){return-Math.exp(-e)}function JWt(e){return isFinite(e)?+("1e"+e):e<0?0:e}function eVt(e){return e===10?JWt:e===Math.E?Math.exp:t=>Math.pow(e,t)}function tVt(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function yve(e){return(t,n)=>-e(-t,n)}function zie(e){const t=e(mve,vve),n=t.domain;let r=10,i,s;function a(){return i=tVt(r),s=eVt(r),n()[0]<0?(i=yve(i),s=yve(s),e(ZWt,QWt)):e(mve,vve),t}return t.base=function(o){return arguments.length?(r=+o,a()):r},t.domain=function(o){return arguments.length?(n(o),a()):n()},t.ticks=o=>{const l=n();let u=l[0],c=l[l.length-1];const f=c<u;f&&([u,c]=[c,u]);let h=i(u),d=i(c),p,g;const m=o==null?10:+o;let v=[];if(!(r%1)&&d-h<m){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(p=1;p<r;++p)if(g=h<0?p/s(-h):p*s(h),!(g<u)){if(g>c)break;v.push(g)}}else for(;h<=d;++h)for(p=r-1;p>=1;--p)if(g=h>0?p/s(-h):p*s(h),!(g<u)){if(g>c)break;v.push(g)}v.length*2<m&&(v=HX(u,c,m))}else v=HX(h,d,Math.min(d-h,m)).map(s);return f?v.reverse():v},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=KT(l)).precision==null&&(l.trim=!0),l=Bie(l)),o===1/0)return l;const u=Math.max(1,r*o/t.ticks().length);return c=>{let f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=()=>n(j4e(n(),{floor:o=>s(Math.floor(i(o))),ceil:o=>s(Math.ceil(i(o)))})),t}function H4e(){const e=zie(d9()).domain([1,10]);return e.copy=()=>sM(e,H4e()).base(e.base()),od.apply(e,arguments),e}function bve(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function xve(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Uie(e){var t=1,n=e(bve(t),xve(t));return n.constant=function(r){return arguments.length?e(bve(t=+r),xve(t)):t},ax(n)}function q4e(){var e=Uie(d9());return e.copy=function(){return sM(e,q4e()).constant(e.constant())},od.apply(e,arguments)}function wve(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function nVt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function rVt(e){return e<0?-e*e:e*e}function Wie(e){var t=e(Xo,Xo),n=1;function r(){return n===1?e(Xo,Xo):n===.5?e(nVt,rVt):e(wve(n),wve(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},ax(t)}function Vie(){var e=Wie(d9());return e.copy=function(){return sM(e,Vie()).exponent(e.exponent())},od.apply(e,arguments),e}function iVt(){return Vie.apply(null,arguments).exponent(.5)}function G4e(){var e=[],t=[],n=[],r;function i(){var a=0,o=Math.max(1,t.length);for(n=new Array(o-1);++a<o;)n[a-1]=fWt(e,a/o);return s}function s(a){return a==null||isNaN(a=+a)?r:t[h9(n,a)]}return s.invertExtent=function(a){var o=t.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},s.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let o of a)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(hA),i()},s.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return G4e().domain(e).range(t).unknown(r)},od.apply(s,arguments)}function Y4e(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function a(l){return l!=null&&l<=l?i[h9(r,l,0,n)]:s}function o(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return a}return a.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},a.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,o()):i.slice()},a.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},a.unknown=function(l){return arguments.length&&(s=l),a},a.thresholds=function(){return r.slice()},a.copy=function(){return Y4e().domain([e,t]).range(i).unknown(s)},od.apply(ax(a),arguments)}function X4e(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[h9(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var a=t.indexOf(s);return[e[a-1],e[a]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return X4e().domain(e).range(t).unknown(n)},od.apply(i,arguments)}const eH=new Date,tH=new Date;function zi(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>zi(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(eH.setTime(+s),tH.setTime(+a),e(eH),e(tH),Math.floor(n(eH,tH))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const wP=zi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);wP.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?zi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):wP);wP.range;const Zd=1e3,bu=Zd*60,Qd=bu*60,Bp=Qd*24,jie=Bp*7,$ve=Bp*30,nH=Bp*365,I1=zi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Zd)},(e,t)=>(t-e)/Zd,e=>e.getUTCSeconds());I1.range;const Hie=zi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Zd)},(e,t)=>{e.setTime(+e+t*bu)},(e,t)=>(t-e)/bu,e=>e.getMinutes());Hie.range;const qie=zi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*bu)},(e,t)=>(t-e)/bu,e=>e.getUTCMinutes());qie.range;const Gie=zi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Zd-e.getMinutes()*bu)},(e,t)=>{e.setTime(+e+t*Qd)},(e,t)=>(t-e)/Qd,e=>e.getHours());Gie.range;const Yie=zi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Qd)},(e,t)=>(t-e)/Qd,e=>e.getUTCHours());Yie.range;const aM=zi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*bu)/Bp,e=>e.getDate()-1);aM.range;const p9=zi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Bp,e=>e.getUTCDate()-1);p9.range;const K4e=zi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Bp,e=>Math.floor(e/Bp));K4e.range;function ox(e){return zi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*bu)/jie)}const g9=ox(0),$P=ox(1),sVt=ox(2),aVt=ox(3),t$=ox(4),oVt=ox(5),lVt=ox(6);g9.range;$P.range;sVt.range;aVt.range;t$.range;oVt.range;lVt.range;function lx(e){return zi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/jie)}const m9=lx(0),CP=lx(1),uVt=lx(2),cVt=lx(3),n$=lx(4),fVt=lx(5),hVt=lx(6);m9.range;CP.range;uVt.range;cVt.range;n$.range;fVt.range;hVt.range;const Xie=zi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Xie.range;const Kie=zi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Kie.range;const zp=zi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());zp.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:zi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});zp.range;const Up=zi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Up.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:zi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Up.range;function Z4e(e,t,n,r,i,s){const a=[[I1,1,Zd],[I1,5,5*Zd],[I1,15,15*Zd],[I1,30,30*Zd],[s,1,bu],[s,5,5*bu],[s,15,15*bu],[s,30,30*bu],[i,1,Qd],[i,3,3*Qd],[i,6,6*Qd],[i,12,12*Qd],[r,1,Bp],[r,2,2*Bp],[n,1,jie],[t,1,$ve],[t,3,3*$ve],[e,1,nH]];function o(u,c,f){const h=c<u;h&&([u,c]=[c,u]);const d=f&&typeof f.range=="function"?f:l(u,c,f),p=d?d.range(u,+c+1):[];return h?p.reverse():p}function l(u,c,f){const h=Math.abs(c-u)/f,d=Mie(([,,m])=>m).right(a,h);if(d===a.length)return e.every(GX(u/nH,c/nH,f));if(d===0)return wP.every(Math.max(GX(u,c,f),1));const[p,g]=a[h/a[d-1][2]<a[d][2]/h?d-1:d];return p.every(g)}return[o,l]}const[dVt,pVt]=Z4e(Up,Kie,m9,K4e,Yie,qie),[gVt,mVt]=Z4e(zp,Xie,g9,aM,Gie,Hie);function rH(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function iH(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function hk(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function vVt(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=dk(i),c=pk(i),f=dk(s),h=pk(s),d=dk(a),p=pk(a),g=dk(o),m=pk(o),v=dk(l),y=pk(l),b={a:F,A:R,b:P,B:V,c:null,d:Ave,e:Ave,f:zVt,g:KVt,G:QVt,H:PVt,I:LVt,j:BVt,L:Q4e,m:UVt,M:WVt,p:z,q,Q:Nve,s:Ive,S:VVt,u:jVt,U:HVt,V:qVt,w:GVt,W:YVt,x:null,X:null,y:XVt,Y:ZVt,Z:JVt,"%":Dve},x={a:G,A:K,b:Y,B:te,c:null,d:Tve,e:Tve,f:rjt,g:djt,G:gjt,H:ejt,I:tjt,j:njt,L:e5e,m:ijt,M:sjt,p:Z,q:ae,Q:Nve,s:Ive,S:ajt,u:ojt,U:ljt,V:ujt,w:cjt,W:fjt,x:null,X:null,y:hjt,Y:pjt,Z:mjt,"%":Dve},w={a:E,A:S,b:N,B:A,c:D,d:kve,e:kve,f:MVt,g:Sve,G:_ve,H:Eve,I:Eve,j:TVt,L:IVt,m:AVt,M:DVt,p:k,q:EVt,Q:OVt,s:RVt,S:NVt,u:$Vt,U:CVt,V:_Vt,w:wVt,W:SVt,x:T,X:I,y:Sve,Y:_ve,Z:kVt,"%":FVt};b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x);function C(O,L){return function(W){var M=[],ue=-1,X=0,se=O.length,oe,pe,Ce;for(W instanceof Date||(W=new Date(+W));++ue<se;)O.charCodeAt(ue)===37&&(M.push(O.slice(X,ue)),(pe=Cve[oe=O.charAt(++ue)])!=null?oe=O.charAt(++ue):pe=oe==="e"?" ":"0",(Ce=L[oe])&&(oe=Ce(W,pe)),M.push(oe),X=ue+1);return M.push(O.slice(X,ue)),M.join("")}}function $(O,L){return function(W){var M=hk(1900,void 0,1),ue=_(M,O,W+="",0),X,se;if(ue!=W.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(L&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(X=iH(hk(M.y,0,1)),se=X.getUTCDay(),X=se>4||se===0?CP.ceil(X):CP(X),X=p9.offset(X,(M.V-1)*7),M.y=X.getUTCFullYear(),M.m=X.getUTCMonth(),M.d=X.getUTCDate()+(M.w+6)%7):(X=rH(hk(M.y,0,1)),se=X.getDay(),X=se>4||se===0?$P.ceil(X):$P(X),X=aM.offset(X,(M.V-1)*7),M.y=X.getFullYear(),M.m=X.getMonth(),M.d=X.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),se="Z"in M?iH(hk(M.y,0,1)).getUTCDay():rH(hk(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(se+5)%7:M.w+M.U*7-(se+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,iH(M)):rH(M)}}function _(O,L,W,M){for(var ue=0,X=L.length,se=W.length,oe,pe;ue<X;){if(M>=se)return-1;if(oe=L.charCodeAt(ue++),oe===37){if(oe=L.charAt(ue++),pe=w[oe in Cve?L.charAt(ue++):oe],!pe||(M=pe(O,W,M))<0)return-1}else if(oe!=W.charCodeAt(M++))return-1}return M}function k(O,L,W){var M=u.exec(L.slice(W));return M?(O.p=c.get(M[0].toLowerCase()),W+M[0].length):-1}function E(O,L,W){var M=d.exec(L.slice(W));return M?(O.w=p.get(M[0].toLowerCase()),W+M[0].length):-1}function S(O,L,W){var M=f.exec(L.slice(W));return M?(O.w=h.get(M[0].toLowerCase()),W+M[0].length):-1}function N(O,L,W){var M=v.exec(L.slice(W));return M?(O.m=y.get(M[0].toLowerCase()),W+M[0].length):-1}function A(O,L,W){var M=g.exec(L.slice(W));return M?(O.m=m.get(M[0].toLowerCase()),W+M[0].length):-1}function D(O,L,W){return _(O,t,L,W)}function T(O,L,W){return _(O,n,L,W)}function I(O,L,W){return _(O,r,L,W)}function F(O){return a[O.getDay()]}function R(O){return s[O.getDay()]}function P(O){return l[O.getMonth()]}function V(O){return o[O.getMonth()]}function z(O){return i[+(O.getHours()>=12)]}function q(O){return 1+~~(O.getMonth()/3)}function G(O){return a[O.getUTCDay()]}function K(O){return s[O.getUTCDay()]}function Y(O){return l[O.getUTCMonth()]}function te(O){return o[O.getUTCMonth()]}function Z(O){return i[+(O.getUTCHours()>=12)]}function ae(O){return 1+~~(O.getUTCMonth()/3)}return{format:function(O){var L=C(O+="",b);return L.toString=function(){return O},L},parse:function(O){var L=$(O+="",!1);return L.toString=function(){return O},L},utcFormat:function(O){var L=C(O+="",x);return L.toString=function(){return O},L},utcParse:function(O){var L=$(O+="",!0);return L.toString=function(){return O},L}}}var Cve={"-":"",_:" ",0:"0"},xs=/^\s*\d+/,yVt=/^%/,bVt=/[\\^$*+?|[\]().{}]/g;function Cn(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function xVt(e){return e.replace(bVt,"\\$&")}function dk(e){return new RegExp("^(?:"+e.map(xVt).join("|")+")","i")}function pk(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function wVt(e,t,n){var r=xs.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function $Vt(e,t,n){var r=xs.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function CVt(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function _Vt(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function SVt(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function _ve(e,t,n){var r=xs.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Sve(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function kVt(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function EVt(e,t,n){var r=xs.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function AVt(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function kve(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function TVt(e,t,n){var r=xs.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Eve(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function DVt(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function NVt(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function IVt(e,t,n){var r=xs.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function MVt(e,t,n){var r=xs.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function FVt(e,t,n){var r=yVt.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function OVt(e,t,n){var r=xs.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function RVt(e,t,n){var r=xs.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Ave(e,t){return Cn(e.getDate(),t,2)}function PVt(e,t){return Cn(e.getHours(),t,2)}function LVt(e,t){return Cn(e.getHours()%12||12,t,2)}function BVt(e,t){return Cn(1+aM.count(zp(e),e),t,3)}function Q4e(e,t){return Cn(e.getMilliseconds(),t,3)}function zVt(e,t){return Q4e(e,t)+"000"}function UVt(e,t){return Cn(e.getMonth()+1,t,2)}function WVt(e,t){return Cn(e.getMinutes(),t,2)}function VVt(e,t){return Cn(e.getSeconds(),t,2)}function jVt(e){var t=e.getDay();return t===0?7:t}function HVt(e,t){return Cn(g9.count(zp(e)-1,e),t,2)}function J4e(e){var t=e.getDay();return t>=4||t===0?t$(e):t$.ceil(e)}function qVt(e,t){return e=J4e(e),Cn(t$.count(zp(e),e)+(zp(e).getDay()===4),t,2)}function GVt(e){return e.getDay()}function YVt(e,t){return Cn($P.count(zp(e)-1,e),t,2)}function XVt(e,t){return Cn(e.getFullYear()%100,t,2)}function KVt(e,t){return e=J4e(e),Cn(e.getFullYear()%100,t,2)}function ZVt(e,t){return Cn(e.getFullYear()%1e4,t,4)}function QVt(e,t){var n=e.getDay();return e=n>=4||n===0?t$(e):t$.ceil(e),Cn(e.getFullYear()%1e4,t,4)}function JVt(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Cn(t/60|0,"0",2)+Cn(t%60,"0",2)}function Tve(e,t){return Cn(e.getUTCDate(),t,2)}function ejt(e,t){return Cn(e.getUTCHours(),t,2)}function tjt(e,t){return Cn(e.getUTCHours()%12||12,t,2)}function njt(e,t){return Cn(1+p9.count(Up(e),e),t,3)}function e5e(e,t){return Cn(e.getUTCMilliseconds(),t,3)}function rjt(e,t){return e5e(e,t)+"000"}function ijt(e,t){return Cn(e.getUTCMonth()+1,t,2)}function sjt(e,t){return Cn(e.getUTCMinutes(),t,2)}function ajt(e,t){return Cn(e.getUTCSeconds(),t,2)}function ojt(e){var t=e.getUTCDay();return t===0?7:t}function ljt(e,t){return Cn(m9.count(Up(e)-1,e),t,2)}function t5e(e){var t=e.getUTCDay();return t>=4||t===0?n$(e):n$.ceil(e)}function ujt(e,t){return e=t5e(e),Cn(n$.count(Up(e),e)+(Up(e).getUTCDay()===4),t,2)}function cjt(e){return e.getUTCDay()}function fjt(e,t){return Cn(CP.count(Up(e)-1,e),t,2)}function hjt(e,t){return Cn(e.getUTCFullYear()%100,t,2)}function djt(e,t){return e=t5e(e),Cn(e.getUTCFullYear()%100,t,2)}function pjt(e,t){return Cn(e.getUTCFullYear()%1e4,t,4)}function gjt(e,t){var n=e.getUTCDay();return e=n>=4||n===0?n$(e):n$.ceil(e),Cn(e.getUTCFullYear()%1e4,t,4)}function mjt(){return"+0000"}function Dve(){return"%"}function Nve(e){return+e}function Ive(e){return Math.floor(+e/1e3)}var a2,n5e,r5e;vjt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function vjt(e){return a2=vVt(e),n5e=a2.format,a2.parse,r5e=a2.utcFormat,a2.utcParse,a2}function yjt(e){return new Date(e)}function bjt(e){return e instanceof Date?+e:+new Date(+e)}function Zie(e,t,n,r,i,s,a,o,l,u){var c=L4e(),f=c.invert,h=c.domain,d=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),x=u("%Y");function w(C){return(l(C)<C?d:o(C)<C?p:a(C)<C?g:s(C)<C?m:r(C)<C?i(C)<C?v:y:n(C)<C?b:x)(C)}return c.invert=function(C){return new Date(f(C))},c.domain=function(C){return arguments.length?h(Array.from(C,bjt)):h().map(yjt)},c.ticks=function(C){var $=h();return e($[0],$[$.length-1],C==null?10:C)},c.tickFormat=function(C,$){return $==null?w:u($)},c.nice=function(C){var $=h();return(!C||typeof C.range!="function")&&(C=t($[0],$[$.length-1],C==null?10:C)),C?h(j4e($,C)):c},c.copy=function(){return sM(c,Zie(e,t,n,r,i,s,a,o,l,u))},c}function xjt(){return od.apply(Zie(gVt,mVt,zp,Xie,g9,aM,Gie,Hie,I1,n5e).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function wjt(){return od.apply(Zie(dVt,pVt,Up,Kie,m9,p9,Yie,qie,I1,r5e).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function v9(){var e=0,t=1,n,r,i,s,a=Xo,o=!1,l;function u(f){return f==null||isNaN(f=+f)?l:a(i===0?.5:(f=(s(f)-n)*i,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(a=f,u):a};function c(f){return function(h){var d,p;return arguments.length?([d,p]=h,a=f(d,p),u):[a(0),a(1)]}}return u.range=c(j_),u.rangeRound=c(Pie),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function Qm(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Qie(){var e=ax(v9()(Xo));return e.copy=function(){return Qm(e,Qie())},Zm.apply(e,arguments)}function i5e(){var e=zie(v9()).domain([1,10]);return e.copy=function(){return Qm(e,i5e()).base(e.base())},Zm.apply(e,arguments)}function s5e(){var e=Uie(v9());return e.copy=function(){return Qm(e,s5e()).constant(e.constant())},Zm.apply(e,arguments)}function Jie(){var e=Wie(v9());return e.copy=function(){return Qm(e,Jie()).exponent(e.exponent())},Zm.apply(e,arguments)}function $jt(){return Jie.apply(null,arguments).exponent(.5)}function y9(){var e=0,t=.5,n=1,r=1,i,s,a,o,l,u=Xo,c,f=!1,h;function d(g){return isNaN(g=+g)?h:(g=.5+((g=+c(g))-s)*(r*g<r*s?o:l),u(f?Math.max(0,Math.min(1,g)):g))}d.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),s=c(t=+t),a=c(n=+n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d):[e,t,n]},d.clamp=function(g){return arguments.length?(f=!!g,d):f},d.interpolator=function(g){return arguments.length?(u=g,d):u};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,u=OWt(g,[v,y,b]),d):[u(0),u(.5),u(1)]}}return d.range=p(j_),d.rangeRound=p(Pie),d.unknown=function(g){return arguments.length?(h=g,d):h},function(g){return c=g,i=g(e),s=g(t),a=g(n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d}}function a5e(){var e=ax(y9()(Xo));return e.copy=function(){return Qm(e,a5e())},Zm.apply(e,arguments)}function o5e(){var e=zie(y9()).domain([.1,1,10]);return e.copy=function(){return Qm(e,o5e()).base(e.base())},Zm.apply(e,arguments)}function l5e(){var e=Uie(y9());return e.copy=function(){return Qm(e,l5e()).constant(e.constant())},Zm.apply(e,arguments)}function ese(){var e=Wie(y9());return e.copy=function(){return Qm(e,ese()).exponent(e.exponent())},Zm.apply(e,arguments)}function Cjt(){return ese.apply(null,arguments).exponent(.5)}function H_(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function oM(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Jm(){}var Yy=.7,r$=1/Yy,ew="\\s*([+-]?\\d+)\\s*",ZT="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",uh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_jt=/^#([0-9a-f]{3,8})$/,Sjt=new RegExp(`^rgb\\(${ew},${ew},${ew}\\)$`),kjt=new RegExp(`^rgb\\(${uh},${uh},${uh}\\)$`),Ejt=new RegExp(`^rgba\\(${ew},${ew},${ew},${ZT}\\)$`),Ajt=new RegExp(`^rgba\\(${uh},${uh},${uh},${ZT}\\)$`),Tjt=new RegExp(`^hsl\\(${ZT},${uh},${uh}\\)$`),Djt=new RegExp(`^hsla\\(${ZT},${uh},${uh},${ZT}\\)$`),Mve={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};H_(Jm,QT,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Fve,formatHex:Fve,formatHex8:Njt,formatHsl:Ijt,formatRgb:Ove,toString:Ove});function Fve(){return this.rgb().formatHex()}function Njt(){return this.rgb().formatHex8()}function Ijt(){return u5e(this).formatHsl()}function Ove(){return this.rgb().formatRgb()}function QT(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=_jt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Rve(t):n===3?new ts(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?MO(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?MO(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Sjt.exec(e))?new ts(t[1],t[2],t[3],1):(t=kjt.exec(e))?new ts(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ejt.exec(e))?MO(t[1],t[2],t[3],t[4]):(t=Ajt.exec(e))?MO(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Tjt.exec(e))?Bve(t[1],t[2]/100,t[3]/100,1):(t=Djt.exec(e))?Bve(t[1],t[2]/100,t[3]/100,t[4]):Mve.hasOwnProperty(e)?Rve(Mve[e]):e==="transparent"?new ts(NaN,NaN,NaN,0):null}function Rve(e){return new ts(e>>16&255,e>>8&255,e&255,1)}function MO(e,t,n,r){return r<=0&&(e=t=n=NaN),new ts(e,t,n,r)}function tse(e){return e instanceof Jm||(e=QT(e)),e?(e=e.rgb(),new ts(e.r,e.g,e.b,e.opacity)):new ts}function _P(e,t,n,r){return arguments.length===1?tse(e):new ts(e,t,n,r==null?1:r)}function ts(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}H_(ts,_P,oM(Jm,{brighter(e){return e=e==null?r$:Math.pow(r$,e),new ts(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Yy:Math.pow(Yy,e),new ts(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ts(iy(this.r),iy(this.g),iy(this.b),SP(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pve,formatHex:Pve,formatHex8:Mjt,formatRgb:Lve,toString:Lve}));function Pve(){return`#${M1(this.r)}${M1(this.g)}${M1(this.b)}`}function Mjt(){return`#${M1(this.r)}${M1(this.g)}${M1(this.b)}${M1((isNaN(this.opacity)?1:this.opacity)*255)}`}function Lve(){const e=SP(this.opacity);return`${e===1?"rgb(":"rgba("}${iy(this.r)}, ${iy(this.g)}, ${iy(this.b)}${e===1?")":`, ${e})`}`}function SP(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function iy(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function M1(e){return e=iy(e),(e<16?"0":"")+e.toString(16)}function Bve(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Sc(e,t,n,r)}function u5e(e){if(e instanceof Sc)return new Sc(e.h,e.s,e.l,e.opacity);if(e instanceof Jm||(e=QT(e)),!e)return new Sc;if(e instanceof Sc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new Sc(a,o,l,e.opacity)}function JX(e,t,n,r){return arguments.length===1?u5e(e):new Sc(e,t,n,r==null?1:r)}function Sc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}H_(Sc,JX,oM(Jm,{brighter(e){return e=e==null?r$:Math.pow(r$,e),new Sc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Yy:Math.pow(Yy,e),new Sc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ts(sH(e>=240?e-240:e+120,i,r),sH(e,i,r),sH(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Sc(zve(this.h),FO(this.s),FO(this.l),SP(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=SP(this.opacity);return`${e===1?"hsl(":"hsla("}${zve(this.h)}, ${FO(this.s)*100}%, ${FO(this.l)*100}%${e===1?")":`, ${e})`}`}}));function zve(e){return e=(e||0)%360,e<0?e+360:e}function FO(e){return Math.max(0,Math.min(1,e||0))}function sH(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const c5e=Math.PI/180,f5e=180/Math.PI,kP=18,h5e=.96422,d5e=1,p5e=.82521,g5e=4/29,tw=6/29,m5e=3*tw*tw,Fjt=tw*tw*tw;function v5e(e){if(e instanceof ch)return new ch(e.l,e.a,e.b,e.opacity);if(e instanceof Jd)return y5e(e);e instanceof ts||(e=tse(e));var t=uH(e.r),n=uH(e.g),r=uH(e.b),i=aH((.2225045*t+.7168786*n+.0606169*r)/d5e),s,a;return t===n&&n===r?s=a=i:(s=aH((.4360747*t+.3850649*n+.1430804*r)/h5e),a=aH((.0139322*t+.0971045*n+.7141733*r)/p5e)),new ch(116*i-16,500*(s-i),200*(i-a),e.opacity)}function eK(e,t,n,r){return arguments.length===1?v5e(e):new ch(e,t,n,r==null?1:r)}function ch(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}H_(ch,eK,oM(Jm,{brighter(e){return new ch(this.l+kP*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new ch(this.l-kP*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=h5e*oH(t),e=d5e*oH(e),n=p5e*oH(n),new ts(lH(3.1338561*t-1.6168667*e-.4906146*n),lH(-.9787684*t+1.9161415*e+.033454*n),lH(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function aH(e){return e>Fjt?Math.pow(e,1/3):e/m5e+g5e}function oH(e){return e>tw?e*e*e:m5e*(e-g5e)}function lH(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function uH(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ojt(e){if(e instanceof Jd)return new Jd(e.h,e.c,e.l,e.opacity);if(e instanceof ch||(e=v5e(e)),e.a===0&&e.b===0)return new Jd(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*f5e;return new Jd(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function tK(e,t,n,r){return arguments.length===1?Ojt(e):new Jd(e,t,n,r==null?1:r)}function Jd(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function y5e(e){if(isNaN(e.h))return new ch(e.l,0,0,e.opacity);var t=e.h*c5e;return new ch(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}H_(Jd,tK,oM(Jm,{brighter(e){return new Jd(this.h,this.c,this.l+kP*(e==null?1:e),this.opacity)},darker(e){return new Jd(this.h,this.c,this.l-kP*(e==null?1:e),this.opacity)},rgb(){return y5e(this).rgb()}}));var b5e=-.14861,nse=1.78277,rse=-.29227,b9=-.90649,JT=1.97294,Uve=JT*b9,Wve=JT*nse,Vve=nse*rse-b9*b5e;function Rjt(e){if(e instanceof sy)return new sy(e.h,e.s,e.l,e.opacity);e instanceof ts||(e=tse(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Vve*r+Uve*t-Wve*n)/(Vve+Uve-Wve),s=r-i,a=(JT*(n-i)-rse*s)/b9,o=Math.sqrt(a*a+s*s)/(JT*i*(1-i)),l=o?Math.atan2(a,s)*f5e-120:NaN;return new sy(l<0?l+360:l,o,i,e.opacity)}function nK(e,t,n,r){return arguments.length===1?Rjt(e):new sy(e,t,n,r==null?1:r)}function sy(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}H_(sy,nK,oM(Jm,{brighter(e){return e=e==null?r$:Math.pow(r$,e),new sy(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Yy:Math.pow(Yy,e),new sy(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*c5e,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new ts(255*(t+n*(b5e*r+nse*i)),255*(t+n*(rse*r+b9*i)),255*(t+n*(JT*r)),this.opacity)}}));function x5e(e,t,n,r,i){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*n+(1+3*e+3*s-3*a)*r+a*i)/6}function w5e(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],a=r>0?e[r-1]:2*i-s,o=r<t-1?e[r+2]:2*s-i;return x5e((n-r/t)*t,a,i,s,o)}}function $5e(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],a=e[(r+1)%t],o=e[(r+2)%t];return x5e((n-r/t)*t,i,s,a,o)}}const x9=e=>()=>e;function C5e(e,t){return function(n){return e+n*t}}function Pjt(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function w9(e,t){var n=t-e;return n?C5e(e,n>180||n<-180?n-360*Math.round(n/360):n):x9(isNaN(e)?t:e)}function Ljt(e){return(e=+e)==1?ns:function(t,n){return n-t?Pjt(t,n,e):x9(isNaN(t)?n:t)}}function ns(e,t){var n=t-e;return n?C5e(e,n):x9(isNaN(e)?t:e)}const rK=function e(t){var n=Ljt(t);function r(i,s){var a=n((i=_P(i)).r,(s=_P(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=ns(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function _5e(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),a,o;for(a=0;a<n;++a)o=_P(t[a]),r[a]=o.r||0,i[a]=o.g||0,s[a]=o.b||0;return r=e(r),i=e(i),s=e(s),o.opacity=1,function(l){return o.r=r(l),o.g=i(l),o.b=s(l),o+""}}}var Bjt=_5e(w5e),zjt=_5e($5e);function ise(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function S5e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ujt(e,t){return(S5e(t)?ise:k5e)(e,t)}function k5e(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=$9(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function E5e(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Lf(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function A5e(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=$9(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var iK=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,cH=new RegExp(iK.source,"g");function Wjt(e){return function(){return e}}function Vjt(e){return function(t){return e(t)+""}}function T5e(e,t){var n=iK.lastIndex=cH.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=iK.exec(e))&&(i=cH.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:Lf(r,i)})),n=cH.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?Vjt(l[0].x):Wjt(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)o[(f=l[c]).i]=f.x(u);return o.join("")})}function $9(e,t){var n=typeof t,r;return t==null||n==="boolean"?x9(t):(n==="number"?Lf:n==="string"?(r=QT(t))?(t=r,rK):T5e:t instanceof QT?rK:t instanceof Date?E5e:S5e(t)?ise:Array.isArray(t)?k5e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?A5e:Lf)(e,t)}function jjt(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Hjt(e,t){var n=w9(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function qjt(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var jve=180/Math.PI,sK={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function D5e(e,t,n,r,i,s){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*jve,skewX:Math.atan(l)*jve,scaleX:a,scaleY:o}}var OO;function Gjt(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?sK:D5e(t.a,t.b,t.c,t.d,t.e,t.f)}function Yjt(e){return e==null||(OO||(OO=document.createElementNS("http://www.w3.org/2000/svg","g")),OO.setAttribute("transform",e),!(e=OO.transform.baseVal.consolidate()))?sK:(e=e.matrix,D5e(e.a,e.b,e.c,e.d,e.e,e.f))}function N5e(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push("translate(",null,t,null,n);p.push({i:g-4,x:Lf(u,f)},{i:g-2,x:Lf(c,h)})}else(f||h)&&d.push("translate("+f+t+h+n)}function a(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:Lf(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function o(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:Lf(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push(i(d)+"scale(",null,",",null,")");p.push({i:g-4,x:Lf(u,f)},{i:g-2,x:Lf(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=e(u),c=e(c),s(u.translateX,u.translateY,c.translateX,c.translateY,f,h),a(u.rotate,c.rotate,f,h),o(u.skewX,c.skewX,f,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,g=h.length,m;++p<g;)f[(m=h[p]).i]=m.x(d);return f.join("")}}}var Xjt=N5e(Gjt,"px, ","px)","deg)"),Kjt=N5e(Yjt,", ",")",")"),Zjt=1e-12;function Hve(e){return((e=Math.exp(e))+1/e)/2}function Qjt(e){return((e=Math.exp(e))-1/e)/2}function Jjt(e){return((e=Math.exp(2*e))-1)/(e+1)}const eHt=function e(t,n,r){function i(s,a){var o=s[0],l=s[1],u=s[2],c=a[0],f=a[1],h=a[2],d=c-o,p=f-l,g=d*d+p*p,m,v;if(g<Zjt)v=Math.log(h/u)/t,m=function($){return[o+$*d,l+$*p,u*Math.exp(t*$*v)]};else{var y=Math.sqrt(g),b=(h*h-u*u+r*g)/(2*u*n*y),x=(h*h-u*u-r*g)/(2*h*n*y),w=Math.log(Math.sqrt(b*b+1)-b),C=Math.log(Math.sqrt(x*x+1)-x);v=(C-w)/t,m=function($){var _=$*v,k=Hve(w),E=u/(n*y)*(k*Jjt(t*_+w)-Qjt(w));return[o+E*d,l+E*p,u*k/Hve(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(s){var a=Math.max(.001,+s),o=a*a,l=o*o;return e(a,o,l)},i}(Math.SQRT2,2,4);function I5e(e){return function(t,n){var r=e((t=JX(t)).h,(n=JX(n)).h),i=ns(t.s,n.s),s=ns(t.l,n.l),a=ns(t.opacity,n.opacity);return function(o){return t.h=r(o),t.s=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const tHt=I5e(w9);var nHt=I5e(ns);function rHt(e,t){var n=ns((e=eK(e)).l,(t=eK(t)).l),r=ns(e.a,t.a),i=ns(e.b,t.b),s=ns(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=s(a),e+""}}function M5e(e){return function(t,n){var r=e((t=tK(t)).h,(n=tK(n)).h),i=ns(t.c,n.c),s=ns(t.l,n.l),a=ns(t.opacity,n.opacity);return function(o){return t.h=r(o),t.c=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const iHt=M5e(w9);var sHt=M5e(ns);function F5e(e){return function t(n){n=+n;function r(i,s){var a=e((i=nK(i)).h,(s=nK(s)).h),o=ns(i.s,s.s),l=ns(i.l,s.l),u=ns(i.opacity,s.opacity);return function(c){return i.h=a(c),i.s=o(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}const aHt=F5e(w9);var oHt=F5e(ns);function O5e(e,t){t===void 0&&(t=e,e=$9);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function lHt(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const uHt=Object.freeze(Object.defineProperty({__proto__:null,interpolate:$9,interpolateArray:Ujt,interpolateBasis:w5e,interpolateBasisClosed:$5e,interpolateDate:E5e,interpolateDiscrete:jjt,interpolateHue:Hjt,interpolateNumber:Lf,interpolateNumberArray:ise,interpolateObject:A5e,interpolateRound:qjt,interpolateString:T5e,interpolateTransformCss:Xjt,interpolateTransformSvg:Kjt,interpolateZoom:eHt,interpolateRgb:rK,interpolateRgbBasis:Bjt,interpolateRgbBasisClosed:zjt,interpolateHsl:tHt,interpolateHslLong:nHt,interpolateLab:rHt,interpolateHcl:iHt,interpolateHclLong:sHt,interpolateCubehelix:aHt,interpolateCubehelixLong:oHt,piecewise:O5e,quantize:lHt},Symbol.toStringTag,{value:"Module"}));function sse(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const cHt="identity",i$="linear",Wp="log",lM="pow",uM="sqrt",C9="symlog",Xy="time",Ky="utc",fh="sequential",q_="diverging",s$="quantile",_9="quantize",S9="threshold",ase="ordinal",aK="point",R5e="band",ose="bin-ordinal",Ui="continuous",cM="discrete",fM="discretizing",Zu="interpolating",lse="temporal";function fHt(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function hHt(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,a,o,l,u;for(i<r&&(o=r,r=i,i=o),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(s<0&&(s=l),a=l);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[a]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function use(){const e=Fie().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,a=!1,o=0,l=0,u=.5;delete e.unknown;function c(){const f=t().length,h=r[1]<r[0],d=r[1-h],p=sse(f,o,l);let g=r[h-0];i=(d-g)/(p||1),a&&(i=Math.floor(i)),g+=(d-g-i*(f-o))*u,s=i*(1-o),a&&(g=Math.round(g),s=Math.round(s));const m=rWt(f).map(v=>g+i*v);return n(h?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),o=l,c()):o},e.paddingInner=function(f){return arguments.length?(o=Math.max(0,Math.min(1,f)),c()):o},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const h=r[1]<r[0],d=h?n().reverse():n(),p=d.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<d[0]||g>r[1-h])))return v=Math.max(0,jX(d,g)-1),y=g===m?v:jX(d,m)-1,g-d[v]>s+1e-10&&++v,h&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const h=e.invertRange([f,f]);return h&&h[0]},e.copy=function(){return use().domain(t()).range(r).round(a).paddingInner(o).paddingOuter(l).align(u)},c()}function P5e(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return P5e(t())},e}function dHt(){return P5e(use().paddingInner(1))}var pHt=Array.prototype.map;function gHt(e){return pHt.call(e,ao)}const mHt=Array.prototype.slice;function L5e(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(nWt(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=gHt(r),n):e.slice()},n.range=function(r){return arguments.length?(t=mHt.call(r),n):t.slice()},n.tickFormat=function(r,i){return U4e(e[0],un(e),r==null?10:r,i)},n.copy=function(){return L5e().domain(n.domain()).range(n.range())},n}const EP=new Map,B5e=Symbol("vega_scale");function z5e(e){return e[B5e]=!0,e}function vHt(e){return e&&e[B5e]===!0}function yHt(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?fHt(s):s.invertExtent?hHt(s):void 0),s.type=e,z5e(s)};return r.metadata=Rh(ct(n)),r}function Dn(e,t,n){return arguments.length>1?(EP.set(e,yHt(e,t,n)),this):U5e(e)?EP.get(e):void 0}Dn(cHt,V4e);Dn(i$,W4e,Ui);Dn(Wp,H4e,[Ui,Wp]);Dn(lM,Vie,Ui);Dn(uM,iVt,Ui);Dn(C9,q4e,Ui);Dn(Xy,xjt,[Ui,lse]);Dn(Ky,wjt,[Ui,lse]);Dn(fh,Qie,[Ui,Zu]);Dn(`${fh}-${i$}`,Qie,[Ui,Zu]);Dn(`${fh}-${Wp}`,i5e,[Ui,Zu,Wp]);Dn(`${fh}-${lM}`,Jie,[Ui,Zu]);Dn(`${fh}-${uM}`,$jt,[Ui,Zu]);Dn(`${fh}-${C9}`,s5e,[Ui,Zu]);Dn(`${q_}-${i$}`,a5e,[Ui,Zu]);Dn(`${q_}-${Wp}`,o5e,[Ui,Zu,Wp]);Dn(`${q_}-${lM}`,ese,[Ui,Zu]);Dn(`${q_}-${uM}`,Cjt,[Ui,Zu]);Dn(`${q_}-${C9}`,l5e,[Ui,Zu]);Dn(s$,G4e,[fM,s$]);Dn(_9,Y4e,fM);Dn(S9,X4e,fM);Dn(ose,L5e,[cM,fM]);Dn(ase,Fie,cM);Dn(R5e,use,cM);Dn(aK,dHt,cM);function U5e(e){return EP.has(e)}function ux(e,t){const n=EP.get(e);return n&&n.metadata[t]}function cse(e){return ux(e,Ui)}function a$(e){return ux(e,cM)}function oK(e){return ux(e,fM)}function W5e(e){return ux(e,Wp)}function bHt(e){return ux(e,lse)}function V5e(e){return ux(e,Zu)}function j5e(e){return ux(e,s$)}const xHt=["clamp","base","constant","exponent"];function wHt(e,t){const n=t[0],r=un(t)-n;return function(i){return e(n+i*r)}}function fse(e,t,n){return O5e(q5e(t||"rgb",n),e)}function $Ht(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function H5e(e,t,n){const r=n-t;let i,s,a;return!r||!Number.isFinite(r)?vo(.5):(i=(s=e.type).indexOf("-"),s=i<0?s:s.slice(i+1),a=Dn(s)().domain([t,n]).range([0,1]),xHt.forEach(o=>e[o]?a[o](e[o]()):0),a)}function q5e(e,t){const n=uHt[CHt(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function CHt(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const _Ht={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},SHt={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function G5e(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function Y5e(e,t){for(const n in e)X5e(n,t(e[n]))}const qve={};Y5e(SHt,G5e);Y5e(_Ht,e=>fse(G5e(e)));function X5e(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(qve[e]=t,this):qve[e]}const f4="symbol",kHt="discrete",EHt="gradient",AHt=e=>at(e)?e.map(t=>String(t)):String(e),THt=(e,t)=>e[1]-t[1],DHt=(e,t)=>t[1]-e[1];function hse(e,t,n){let r;return LT(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(t9(e.domain())/n||1)))),Ft(t)&&(r=t.step,t=t.interval),$r(t)&&(t=e.type===Xy?ZI(t):e.type==Ky?QI(t):$e("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function K5e(e,t,n){let r=e.range(),i=r[0],s=un(r),a=THt;if(i>s&&(r=s,s=i,i=r,a=DHt),i=Math.floor(i),s=Math.ceil(s),t=t.map(o=>[o,e(o)]).filter(o=>i<=o[1]&&o[1]<=s).sort(a).map(o=>o[0]),n>0&&t.length>1){const o=[t[0],un(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=o)}return t}function dse(e,t){return e.bins?K5e(e,e.bins):e.ticks?e.ticks(t):e.domain()}function Z5e(e,t,n,r,i,s){const a=t.type;let o=AHt;if(a===Xy||i===Xy)o=e.timeFormat(r);else if(a===Ky||i===Ky)o=e.utcFormat(r);else if(W5e(a)){const l=e.formatFloat(r);if(s||t.bins)o=l;else{const u=Q5e(t,n,!1);o=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();o=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(o=e.format(r));return o}function Q5e(e,t,n){const r=dse(e,t),i=e.base(),s=Math.log(i),a=Math.max(1,i*t/r.length),o=l=>{let u=l/Math.pow(i,Math.round(Math.log(l)/s));return u*i<i-.5&&(u*=i),u<=a};return n?r.filter(o):o}const lK={[s$]:"quantiles",[_9]:"thresholds",[S9]:"domain"},J5e={[s$]:"quantiles",[_9]:"domain"};function ePe(e,t){return e.bins?MHt(e.bins):e.type===Wp?Q5e(e,t,!0):lK[e.type]?IHt(e[lK[e.type]]()):dse(e,t)}function NHt(e,t,n){const r=t[J5e[t.type]](),i=r.length;let s=i>1?r[1]-r[0]:r[0],a;for(a=1;a<i;++a)s=Math.min(s,r[a]-r[a-1]);return e.formatSpan(0,s,3*10,n)}function IHt(e){const t=[-1/0].concat(e);return t.max=1/0,t}function MHt(e){const t=e.slice(0,-1);return t.max=un(e),t}const FHt=e=>lK[e.type]||e.bins;function tPe(e,t,n,r,i,s,a){const o=J5e[t.type]&&s!==Xy&&s!==Ky?NHt(e,t,i):Z5e(e,t,n,i,s,a);return r===f4&&FHt(t)?OHt(o):r===kHt?RHt(o):PHt(o)}const OHt=e=>(t,n,r)=>{const i=Gve(r[n+1],Gve(r.max,1/0)),s=Yve(t,e),a=Yve(i,e);return s&&a?s+" \u2013 "+a:a?"< "+a:"\u2265 "+s},Gve=(e,t)=>e!=null?e:t,RHt=e=>(t,n)=>n?e(t):null,PHt=e=>t=>e(t),Yve=(e,t)=>Number.isFinite(e)?t(e):null;function LHt(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+un(t),s=i-r;if(e.type===S9){const a=n?s/n:.1;r-=a,i+=a,s=i-r}return a=>(a-r)/s}function BHt(e,t,n,r){const i=r||t.type;return $r(n)&&bHt(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===Xy?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===Ky?e.utcFormat("%A, %d %B %Y, %X UTC"):tPe(e,t,5,null,n,r,!0)}function nPe(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=BHt(e,t,n.format,n.formatType);if(oK(t.type)){const s=ePe(t).slice(1).map(i),a=s.length;return`${a} boundar${a===1?"y":"ies"}: ${s.join(", ")}`}else if(a$(t.type)){const s=t.domain(),a=s.length,o=a>r?s.slice(0,r-2).map(i).join(", ")+", ending with "+s.slice(-1).map(i):s.map(i).join(", ");return`${a} value${a===1?"":"s"}: ${o}`}else{const s=t.domain();return`values from ${i(s[0])} to ${i(un(s))}`}}let zHt=0;const AP="p_";function pse(e){return e&&e.gradient}function rPe(e,t,n){const r=e.gradient;let i=e.id,s=r==="radial"?AP:"";return i||(i=e.id="gradient_"+zHt++,r==="radial"?(e.x1=Af(e.x1,.5),e.y1=Af(e.y1,.5),e.r1=Af(e.r1,0),e.x2=Af(e.x2,.5),e.y2=Af(e.y2,.5),e.r2=Af(e.r2,.5),s=AP):(e.x1=Af(e.x1,0),e.y1=Af(e.y1,0),e.x2=Af(e.x2,1),e.y2=Af(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+s+i+")"}function Af(e,t){return e!=null?e:t}function UHt(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,s){return n.push({offset:i,color:s}),r}}}const Xve={basis:{curve:MUt},"basis-closed":{curve:FUt},"basis-open":{curve:OUt},bundle:{curve:RUt,tension:"beta",value:.85},cardinal:{curve:PUt,tension:"tension",value:0},"cardinal-open":{curve:BUt,tension:"tension",value:0},"cardinal-closed":{curve:LUt,tension:"tension",value:0},"catmull-rom":{curve:zUt,tension:"alpha",value:.5},"catmull-rom-closed":{curve:UUt,tension:"alpha",value:.5},"catmull-rom-open":{curve:WUt,tension:"alpha",value:.5},linear:{curve:kie},"linear-closed":{curve:VUt},monotone:{horizontal:HUt,vertical:jUt},natural:{curve:qUt},step:{curve:GUt},"step-after":{curve:XUt},"step-before":{curve:YUt}};function iPe(e,t,n){var r=bt(Xve,e)&&Xve[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const WHt={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},VHt=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,jHt=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,HHt=/^((\s+,?\s*)|(,\s*))/,qHt=/^[01]/;function gse(e){const t=[];return(e.match(VHt)||[]).forEach(r=>{let i=r[0];const s=i.toLowerCase(),a=WHt[s],o=GHt(s,a,r.slice(1).trim()),l=o.length;if(l<a||l&&l%a!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...o.slice(0,a)]),l!==a){s==="m"&&(i=i==="M"?"L":"l");for(let u=a;u<l;u+=a)t.push([i,...o.slice(u,u+a)])}}),t}function GHt(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let s=0;s<t;++s){const a=e==="a"&&(s===3||s===4)?qHt:jHt,o=n.slice(i).match(a);if(o===null)throw Error("Invalid SVG path, incorrect parameter type");i+=o[0].length,r.push(+o[0]);const l=n.slice(i).match(HHt);l!==null&&(i+=l[0].length)}return r}const nm=Math.PI/180,YHt=1e-14,c1=Math.PI/2,zf=Math.PI*2,o2=Math.sqrt(3)/2;var fH={},hH={},sPe=[].join;function XHt(e,t,n,r,i,s,a,o,l){const u=sPe.call(arguments);if(fH[u])return fH[u];const c=a*nm,f=Math.sin(c),h=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const d=h*(o-e)*.5+f*(l-t)*.5,p=h*(l-t)*.5-f*(o-e)*.5;let g=d*d/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=h/n,v=f/n,y=-f/r,b=h/r,x=m*o+v*l,w=y*o+b*l,C=m*e+v*t,$=y*e+b*t;let k=1/((C-x)*(C-x)+($-w)*($-w))-.25;k<0&&(k=0);let E=Math.sqrt(k);s==i&&(E=-E);const S=.5*(x+C)-E*($-w),N=.5*(w+$)+E*(C-x),A=Math.atan2(w-N,x-S);let T=Math.atan2($-N,C-S)-A;T<0&&s===1?T+=zf:T>0&&s===0&&(T-=zf);const I=Math.ceil(Math.abs(T/(c1+.001))),F=[];for(let R=0;R<I;++R){const P=A+R*T/I,V=A+(R+1)*T/I;F[R]=[S,N,P,V,n,r,f,h]}return fH[u]=F}function KHt(e){const t=sPe.call(e);if(hH[t])return hH[t];var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7];const c=u*a,f=-l*o,h=l*a,d=u*o,p=Math.cos(i),g=Math.sin(i),m=Math.cos(s),v=Math.sin(s),y=.5*(s-i),b=Math.sin(y*.5),x=8/3*b*b/Math.sin(y),w=n+p-x*g,C=r+g+x*p,$=n+m,_=r+v,k=$+x*v,E=_-x*m;return hH[t]=[c*w+f*C,h*w+d*C,c*k+f*E,h*k+d*E,c*$+f*_,h*$+d*_]}const su=["l",0,0,0,0,0,0,0];function ZHt(e,t,n){const r=su[0]=e[0];if(r==="a"||r==="A")su[1]=t*e[1],su[2]=n*e[2],su[3]=e[3],su[4]=e[4],su[5]=e[5],su[6]=t*e[6],su[7]=n*e[7];else if(r==="h"||r==="H")su[1]=t*e[1];else if(r==="v"||r==="V")su[1]=n*e[1];else for(var i=1,s=e.length;i<s;++i)su[i]=(i%2==1?t:n)*e[i];return su}function TP(e,t,n,r,i,s){var a,o=null,l=0,u=0,c=0,f=0,h,d,p,g,m=0,v=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),s==null&&(s=i),e.beginPath&&e.beginPath();for(var y=0,b=t.length;y<b;++y){switch(a=t[y],(i!==1||s!==1)&&(a=ZHt(a,i,s)),a[0]){case"l":l+=a[1],u+=a[2],e.lineTo(l+n,u+r);break;case"L":l=a[1],u=a[2],e.lineTo(l+n,u+r);break;case"h":l+=a[1],e.lineTo(l+n,u+r);break;case"H":l=a[1],e.lineTo(l+n,u+r);break;case"v":u+=a[1],e.lineTo(l+n,u+r);break;case"V":u=a[1],e.lineTo(l+n,u+r);break;case"m":l+=a[1],u+=a[2],m=l,v=u,e.moveTo(l+n,u+r);break;case"M":l=a[1],u=a[2],m=l,v=u,e.moveTo(l+n,u+r);break;case"c":h=l+a[5],d=u+a[6],c=l+a[3],f=u+a[4],e.bezierCurveTo(l+a[1]+n,u+a[2]+r,c+n,f+r,h+n,d+r),l=h,u=d;break;case"C":l=a[5],u=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,c+n,f+r,l+n,u+r);break;case"s":h=l+a[3],d=u+a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,l+a[1]+n,u+a[2]+r,h+n,d+r),c=l+a[1],f=u+a[2],l=h,u=d;break;case"S":h=a[3],d=a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,a[1]+n,a[2]+r,h+n,d+r),l=h,u=d,c=a[1],f=a[2];break;case"q":h=l+a[3],d=u+a[4],c=l+a[1],f=u+a[2],e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d;break;case"Q":h=a[3],d=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,h+n,d+r),l=h,u=d,c=a[1],f=a[2];break;case"t":h=l+a[1],d=u+a[2],o[0].match(/[QqTt]/)===null?(c=l,f=u):o[0]==="t"?(c=2*l-p,f=2*u-g):o[0]==="q"&&(c=2*l-c,f=2*u-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d,c=l+a[1],f=u+a[2];break;case"T":h=a[1],d=a[2],c=2*l-c,f=2*u-f,e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d;break;case"a":Kve(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+l+n,a[7]+u+r]),l+=a[6],u+=a[7];break;case"A":Kve(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),l=a[6],u=a[7];break;case"z":case"Z":l=m,u=v,e.closePath();break}o=a}}function Kve(e,t,n,r){const i=XHt(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let s=0;s<i.length;++s){const a=KHt(i[s]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const Zve=.5773502691896257,Qve={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,zf)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,s=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-s),e.lineTo(i,-s),e.lineTo(0,-n),e.lineTo(-i,-s),e.lineTo(-r,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=o2*n,i=r-n*Zve,s=n/4;e.moveTo(0,-r-i),e.lineTo(-s,r-i),e.lineTo(s,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=o2*n,i=r-n*Zve;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=o2*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=o2*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=o2*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=o2*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function QHt(e){return bt(Qve,e)?Qve[e]:JHt(e)}var dH={};function JHt(e){if(!bt(dH,e)){const t=gse(e);dH[e]={draw:function(n,r){TP(n,t,0,0,Math.sqrt(r)/2)}}}return dH[e]}const Tg=.448084975506;function eqt(e){return e.x}function tqt(e){return e.y}function nqt(e){return e.width}function rqt(e){return e.height}function Td(e){return typeof e=="function"?e:()=>+e}function RO(e,t,n){return Math.max(t,Math.min(e,n))}function iqt(){var e=eqt,t=tqt,n=nqt,r=rqt,i=Td(0),s=i,a=i,o=i,l=null;function u(c,f,h){var d,p=f!=null?f:+e.call(this,c),g=h!=null?h:+t.call(this,c),m=+n.call(this,c),v=+r.call(this,c),y=Math.min(m,v)/2,b=RO(+i.call(this,c),0,y),x=RO(+s.call(this,c),0,y),w=RO(+a.call(this,c),0,y),C=RO(+o.call(this,c),0,y);if(l||(l=d=Nie()),b<=0&&x<=0&&w<=0&&C<=0)l.rect(p,g,m,v);else{var $=p+m,_=g+v;l.moveTo(p+b,g),l.lineTo($-x,g),l.bezierCurveTo($-Tg*x,g,$,g+Tg*x,$,g+x),l.lineTo($,_-C),l.bezierCurveTo($,_-Tg*C,$-Tg*C,_,$-C,_),l.lineTo(p+w,_),l.bezierCurveTo(p+Tg*w,_,p,_-Tg*w,p,_-w),l.lineTo(p,g+b),l.bezierCurveTo(p,g+Tg*b,p+Tg*b,g,p+b,g),l.closePath()}if(d)return l=null,d+""||null}return u.x=function(c){return arguments.length?(e=Td(c),u):e},u.y=function(c){return arguments.length?(t=Td(c),u):t},u.width=function(c){return arguments.length?(n=Td(c),u):n},u.height=function(c){return arguments.length?(r=Td(c),u):r},u.cornerRadius=function(c,f,h,d){return arguments.length?(i=Td(c),s=f!=null?Td(f):i,o=h!=null?Td(h):i,a=d!=null?Td(d):s,u):i},u.context=function(c){return arguments.length?(l=c==null?null:c,u):l},u}function sqt(){var e,t,n,r,i=null,s,a,o,l;function u(f,h,d){const p=d/2;if(s){var g=o-h,m=f-a;if(g||m){var v=Math.sqrt(g*g+m*m),y=(g/=v)*l,b=(m/=v)*l,x=Math.atan2(m,g);i.moveTo(a-y,o-b),i.lineTo(f-g*p,h-m*p),i.arc(f,h,p,x-Math.PI,x),i.lineTo(a+y,o+b),i.arc(a,o,l,x,x+Math.PI)}else i.arc(f,h,p,0,zf);i.closePath()}else s=1;a=f,o=h,l=p}function c(f){var h,d=f.length,p,g=!1,m;for(i==null&&(i=m=Nie()),h=0;h<=d;++h)!(h<d&&r(p=f[h],h,f))===g&&(g=!g)&&(s=0),g&&u(+e(p,h,f),+t(p,h,f),+n(p,h,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function hM(e,t){return e!=null?e:t}const dM=e=>e.x||0,pM=e=>e.y||0,aqt=e=>e.width||0,oqt=e=>e.height||0,lqt=e=>(e.x||0)+(e.width||0),uqt=e=>(e.y||0)+(e.height||0),cqt=e=>e.startAngle||0,fqt=e=>e.endAngle||0,hqt=e=>e.padAngle||0,dqt=e=>e.innerRadius||0,pqt=e=>e.outerRadius||0,gqt=e=>e.cornerRadius||0,mqt=e=>hM(e.cornerRadiusTopLeft,e.cornerRadius)||0,vqt=e=>hM(e.cornerRadiusTopRight,e.cornerRadius)||0,yqt=e=>hM(e.cornerRadiusBottomRight,e.cornerRadius)||0,bqt=e=>hM(e.cornerRadiusBottomLeft,e.cornerRadius)||0,xqt=e=>hM(e.size,64),wqt=e=>e.size||1,k9=e=>e.defined!==!1,$qt=e=>QHt(e.shape||"circle"),Cqt=DUt().startAngle(cqt).endAngle(fqt).padAngle(hqt).innerRadius(dqt).outerRadius(pqt).cornerRadius(gqt),_qt=x4e().x(dM).y1(pM).y0(uqt).defined(k9),Sqt=x4e().y(pM).x1(dM).x0(lqt).defined(k9),kqt=b4e().x(dM).y(pM).defined(k9),Eqt=iqt().x(dM).y(pM).width(aqt).height(oqt).cornerRadius(mqt,vqt,yqt,bqt),Aqt=IUt().type($qt).size(xqt),Tqt=sqt().x(dM).y(pM).defined(k9).size(wqt);function mse(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Dqt(e,t){return Cqt.context(e)(t)}function Nqt(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?Sqt:_qt).curve(iPe(r,n.orient,n.tension)).context(e)(t)}function Iqt(e,t){const n=t[0],r=n.interpolate||"linear";return kqt.curve(iPe(r,n.orient,n.tension)).context(e)(t)}function G_(e,t,n,r){return Eqt.context(e)(t,n,r)}function Mqt(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Fqt(e,t){return Aqt.context(e)(t)}function Oqt(e,t){return Tqt.context(e)(t)}var Rqt=1;function vse(e,t,n){var r=t.clip,i=e._defs,s=t.clip_id||(t.clip_id="clip"+Rqt++),a=i.clipping[s]||(i.clipping[s]={id:s});return Ut(r)?a.path=r(null):mse(n)?a.path=G_(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+s+")"}function Oi(e){this.clear(),e&&this.union(e)}Oi.prototype={clone(){return new Oi(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:s,y2:a}=this,o=Math.cos(e),l=Math.sin(e),u=t-t*o+n*l,c=n-t*l-n*o;return[o*r-l*i+u,l*r+o*i+c,o*r-l*a+u,l*r+o*a+c,o*s-l*i+u,l*s+o*i+c,o*s-l*a+u,l*s+o*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function yse(e){this.mark=e,this.bounds=this.bounds||new Oi}function bse(e){yse.call(this,e),this.items=this.items||[]}Ne(bse,yse);function aPe(e){this._pending=0,this._loader=e||Gre()}function Jve(e){e._pending+=1}function gk(e){e._pending-=1}aPe.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return Jve(t),t._loader.sanitize(e,{context:"href"}).then(n=>(gk(t),n)).catch(()=>(gk(t),null))},loadImage(e){const t=this,n=Iie();return Jve(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const s=new n,a=bt(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(s.crossOrigin=a),s.onload=()=>gk(t),s.onerror=()=>gk(t),s.src=i,s}).catch(r=>(gk(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function ev(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Pqt(t,r):0))}return e}function Pqt(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const Lqt=zf-1e-8;let E9,h4,d4,F1,uK,p4,cK,fK;const Jg=(e,t)=>E9.add(e,t),g4=(e,t)=>Jg(h4=e,d4=t),e1e=e=>Jg(e,E9.y1),t1e=e=>Jg(E9.x1,e),f1=(e,t)=>uK*e+cK*t,h1=(e,t)=>p4*e+fK*t,pH=(e,t)=>Jg(f1(e,t),h1(e,t)),gH=(e,t)=>g4(f1(e,t),h1(e,t));function A9(e,t){return E9=e,t?(F1=t*nm,uK=fK=Math.cos(F1),p4=Math.sin(F1),cK=-p4):(uK=fK=1,F1=p4=cK=0),Bqt}const Bqt={beginPath(){},closePath(){},moveTo:gH,lineTo:gH,rect(e,t,n,r){F1?(pH(e+n,t),pH(e+n,t+r),pH(e,t+r),gH(e,t)):(Jg(e+n,t+r),g4(e,t))},quadraticCurveTo(e,t,n,r){const i=f1(e,t),s=h1(e,t),a=f1(n,r),o=h1(n,r);n1e(h4,i,a,e1e),n1e(d4,s,o,t1e),g4(a,o)},bezierCurveTo(e,t,n,r,i,s){const a=f1(e,t),o=h1(e,t),l=f1(n,r),u=h1(n,r),c=f1(i,s),f=h1(i,s);r1e(h4,a,l,c,e1e),r1e(d4,o,u,f,t1e),g4(c,f)},arc(e,t,n,r,i,s){if(r+=F1,i+=F1,h4=n*Math.cos(i)+e,d4=n*Math.sin(i)+t,Math.abs(i-r)>Lqt)Jg(e-n,t-n),Jg(e+n,t+n);else{const a=u=>Jg(n*Math.cos(u)+e,n*Math.sin(u)+t);let o,l;if(a(r),a(i),i!==r)if(r=r%zf,r<0&&(r+=zf),i=i%zf,i<0&&(i+=zf),i<r&&(s=!s,o=r,r=i,i=o),s)for(i-=zf,o=r-r%c1,l=0;l<4&&o>i;++l,o-=c1)a(o);else for(o=r-r%c1+c1,l=0;l<4&&o<i;++l,o=o+c1)a(o)}}};function n1e(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function r1e(e,t,n,r,i){const s=r-e+3*t-3*n,a=e+n-2*t,o=e-t;let l=0,u=0,c;Math.abs(s)>YHt?(c=a*a+o*s,c>=0&&(c=Math.sqrt(c),l=(-a+c)/s,u=(-a-c)/s)):l=.5*o/a,0<l&&l<1&&i(i1e(l,e,t,n,r)),0<u&&u<1&&i(i1e(u,e,t,n,r))}function i1e(e,t,n,r,i){const s=1-e,a=s*s,o=e*e;return a*s*t+3*a*e*n+3*s*o*r+o*e*i}var w0=(w0=Ku(1,1))?w0.getContext("2d"):null;const hK=new Oi;function oPe(e){return function(t,n){if(!w0)return!0;e(w0,t),hK.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:s,y2:a}=hK;for(let o=i;o<=a;++o)for(let l=r;l<=s;++l)if(w0.isPointInPath(l,o))return!0;return!1}}function lPe(e,t){return t.contains(e.x||0,e.y||0)}function uPe(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,s=e.height||0;return t.intersects(hK.set(n,r,n+i,r+s))}function zqt(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:r;return bE(t,n,r,i,s)}function bE(e,t,n,r,i){const{x1:s,y1:a,x2:o,y2:l}=e,u=r-t,c=i-n;let f=0,h=1,d,p,g,m;for(m=0;m<4;++m){if(m===0&&(d=-u,p=-(s-t)),m===1&&(d=u,p=o-t),m===2&&(d=-c,p=-(a-n)),m===3&&(d=c,p=l-n),Math.abs(d)<1e-10&&p<0)return!1;if(g=p/d,d<0){if(g>h)return!1;g>f&&(f=g)}else if(d>0){if(g<f)return!1;g<h&&(h=g)}}return!0}function o$(e,t){e.globalCompositeOperation=t.blend||"source-over"}function ac(e,t){return e==null?t:e}function s1e(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function Uqt(e,t,n){const r=n.width(),i=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+ac(t.x1,.5)*r,n.y1+ac(t.y1,.5)*i,Math.max(r,i)*ac(t.r1,0),n.x1+ac(t.x2,.5)*r,n.y1+ac(t.y2,.5)*i,Math.max(r,i)*ac(t.r2,.5));else{const a=ac(t.x1,0),o=ac(t.y1,0),l=ac(t.x2,1),u=ac(t.y2,0);if(a===l||o===u||r===i)s=e.createLinearGradient(n.x1+a*r,n.y1+o*i,n.x1+l*r,n.y1+u*i);else{const c=Ku(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=s1e(f.createLinearGradient(a,o,l,u),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return s1e(s,t.stops)}function cPe(e,t,n){return pse(n)?Uqt(e,n,t.bounds):n}function DP(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=cPe(e,t,t.fill),!0):!1}var Wqt=[];function l$(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=cPe(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Wqt),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function Vqt(e,t){return e.zindex-t.zindex||e.index-t.index}function fPe(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,s;for(i=0,s=t.length;i<s;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(Vqt)}function Lh(e,t){var n=e.items,r,i;if(!n||!n.length)return;const s=fPe(e);if(s&&s.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=s}for(r=0,i=n.length;r<i;++r)t(n[r])}function dK(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const s=fPe(e);for(s&&s.length&&(n=s),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===s){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function xse(e){return function(t,n,r){Lh(n,i=>{(!r||r.intersects(i.bounds))&&hPe(e,t,i,i)})}}function jqt(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&hPe(e,t,n.items[0],n.items)}}function hPe(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(o$(t,n),n.fill&&DP(t,n,i)&&t.fill(),n.stroke&&l$(t,n,i)&&t.stroke()))}function T9(e){return e=e||ef,function(t,n,r,i,s,a){return r*=t.pixelRatio,i*=t.pixelRatio,dK(n,o=>{const l=o.bounds;if(!(l&&!l.contains(s,a)||!l)&&e(t,o,r,i,s,a))return o})}}function gM(e,t){return function(n,r,i,s){var a=Array.isArray(r)?r[0]:r,o=t==null?a.fill:t,l=a.stroke&&n.isPointInStroke,u,c;return l&&(u=a.strokeWidth,c=a.strokeCap,n.lineWidth=u!=null?u:1,n.lineCap=c!=null?c:"butt"),e(n,r)?!1:o&&n.isPointInPath(i,s)||l&&n.isPointInStroke(i,s)}}function wse(e){return T9(gM(e))}function ay(e,t){return"translate("+e+","+t+")"}function $se(e){return"rotate("+e+")"}function Hqt(e,t){return"scale("+e+","+t+")"}function dPe(e){return ay(e.x||0,e.y||0)}function qqt(e){return ay(e.x||0,e.y||0)+(e.angle?" "+$se(e.angle):"")}function Gqt(e){return ay(e.x||0,e.y||0)+(e.angle?" "+$se(e.angle):"")+(e.scaleX||e.scaleY?" "+Hqt(e.scaleX||1,e.scaleY||1):"")}function Cse(e,t,n){function r(a,o){a("transform",qqt(o)),a("d",t(null,o))}function i(a,o){return t(A9(a,o.angle),o),ev(a,o).translate(o.x||0,o.y||0)}function s(a,o){var l=o.x||0,u=o.y||0,c=o.angle||0;a.translate(l,u),c&&a.rotate(c*=nm),a.beginPath(),t(a,o),c&&a.rotate(-c),a.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:xse(s),pick:wse(s),isect:n||oPe(s)}}var Yqt=Cse("arc",Dqt);function Xqt(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,s=1/0,a,o;--i>=0;)e[i].defined!==!1&&(o=Math.abs(e[i][r]-n),o<s&&(s=o,a=e[i]));return a}function Kqt(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,s,a;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],s=e[r].y-t[1],a=i*i+s*s,a<n))return e[r];return null}function Zqt(e,t){for(var n=e.length,r,i,s;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],s=r*r+i*i,r=e[n].size||1,s<r*r))return e[n];return null}function _se(e,t,n){function r(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))}function i(l,u){var c=u.items;return c.length===0?l:(t(A9(l),c),ev(l,c[0]))}function s(l,u){l.beginPath(),t(l,u)}const a=gM(s);function o(l,u,c,f,h,d){var p=u.items,g=u.bounds;return!p||!p.length||g&&!g.contains(h,d)?null:(c*=l.pixelRatio,f*=l.pixelRatio,a(l,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:jqt(s),pick:o,isect:lPe,tip:n}}var Qqt=_se("area",Nqt,Xqt);function Jqt(e,t){var n=t.clip;e.save(),Ut(n)?(e.beginPath(),n(e),e.clip()):pPe(e,t.group)}function pPe(e,t){e.beginPath(),mse(t)?G_(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function gPe(e){const t=ac(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function eGt(e,t){e("transform",dPe(t))}function mPe(e,t){const n=gPe(t);e("d",G_(null,t,n,n))}function tGt(e,t){e("class","background"),e("aria-hidden",!0),mPe(e,t)}function nGt(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?mPe(e,t):e("d","")}function rGt(e,t,n){const r=t.clip?vse(n,t,t):null;e("clip-path",r)}function iGt(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),ev(e,t),e.translate(t.x||0,t.y||0)}function e3(e,t,n,r){const i=gPe(t);e.beginPath(),G_(e,t,(n||0)+i,(r||0)+i)}const sGt=gM(e3),aGt=gM(e3,!1),oGt=gM(e3,!0);function lGt(e,t,n){Lh(t,r=>{const i=r.x||0,s=r.y||0,a=r.strokeForeground,o=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&o&&(e3(e,r,i,s),o$(e,r),r.fill&&DP(e,r,o)&&e.fill(),r.stroke&&!a&&l$(e,r,o)&&e.stroke()),e.save(),e.translate(i,s),r.clip&&pPe(e,r),n&&n.translate(-i,-s),Lh(r,l=>{this.draw(e,l,n)}),n&&n.translate(i,s),e.restore(),a&&r.stroke&&o&&(e3(e,r,i,s),o$(e,r),l$(e,r,o)&&e.stroke())})}function uGt(e,t,n,r,i,s){if(t.bounds&&!t.bounds.contains(i,s)||!t.items)return null;const a=n*e.pixelRatio,o=r*e.pixelRatio;return dK(t,l=>{let u,c,f;const h=l.bounds;if(h&&!h.contains(i,s))return;c=l.x||0,f=l.y||0;const d=c+(l.width||0),p=f+(l.height||0),g=l.clip;if(g&&(i<c||i>d||s<f||s>p))return;if(e.save(),e.translate(c,f),c=i-c,f=s-f,g&&mse(l)&&!oGt(e,l,a,o))return e.restore(),null;const m=l.strokeForeground,v=t.interactive!==!1;return v&&m&&l.stroke&&aGt(e,l,a,o)?(e.restore(),l):(u=dK(l,y=>cGt(y,c,f)?this.pick(y,n,r,c,f):null),!u&&v&&(l.fill||!m&&l.stroke)&&sGt(e,l,a,o)&&(u=l),e.restore(),u||null)})}function cGt(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var fGt={type:"group",tag:"g",nested:!1,attr:eGt,bound:iGt,draw:lGt,pick:uGt,isect:uPe,content:rGt,background:tGt,foreground:nGt},t3={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Sse(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function kse(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function Ese(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function D9(e,t){return e==="center"?t/2:e==="right"?t:0}function N9(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function hGt(e,t,n){const r=Sse(t,n),i=kse(t,r),s=Ese(t,r),a=(t.x||0)-D9(t.align,i),o=(t.y||0)-N9(t.baseline,s),l=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",l,t3["xmlns:xlink"],"xlink:href"),e("transform",ay(a,o)),e("width",i),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function dGt(e,t){const n=t.image,r=kse(t,n),i=Ese(t,n),s=(t.x||0)-D9(t.align,r),a=(t.y||0)-N9(t.baseline,i);return e.set(s,a,s+r,a+i)}function pGt(e,t,n){Lh(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=Sse(r,this);let s=kse(r,i),a=Ese(r,i);if(s===0||a===0)return;let o=(r.x||0)-D9(r.align,s),l=(r.y||0)-N9(r.baseline,a),u,c,f,h;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(h=s/c,l+=(a-h)/2,a=h):(h=a*c,o+=(s-h)/2,s=h))),(i.complete||i.toDataURL)&&(o$(e,r),e.globalAlpha=(u=r.opacity)!=null?u:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,o,l,s,a))})}var gGt={type:"image",tag:"image",nested:!1,attr:hGt,bound:dGt,draw:pGt,pick:T9(),isect:ef,get:Sse,xOffset:D9,yOffset:N9},mGt=_se("line",Iqt,Kqt);function vGt(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",Gqt(t)),e("d",t.path)}function m4(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,s=t.scaleX||1,a=t.scaleY||1,o=(t.angle||0)*nm,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=gse(n)).path=n),o&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(o),TP(e,l,0,0,s,a),e.rotate(-o),e.translate(-r,-i)):TP(e,l,r,i,s,a)}function yGt(e,t){return m4(A9(e,t.angle),t)?e.set(0,0,0,0):ev(e,t,!0)}var bGt={type:"path",tag:"path",nested:!1,attr:vGt,bound:yGt,draw:xse(m4),pick:wse(m4),isect:oPe(m4)};function xGt(e,t){e("d",G_(null,t))}function wGt(e,t){var n,r;return ev(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function a1e(e,t){e.beginPath(),G_(e,t)}var $Gt={type:"rect",tag:"path",nested:!1,attr:xGt,bound:wGt,draw:xse(a1e),pick:wse(a1e),isect:uPe};function CGt(e,t){e("transform",dPe(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function _Gt(e,t){var n,r;return ev(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function vPe(e,t,n){var r,i,s,a;return t.stroke&&l$(e,t,n)?(r=t.x||0,i=t.y||0,s=t.x2!=null?t.x2:r,a=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(s,a),!0):!1}function SGt(e,t,n){Lh(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&vPe(e,r,i)&&(o$(e,r),e.stroke())}})}function kGt(e,t,n,r){return e.isPointInStroke?vPe(e,t,1)&&e.isPointInStroke(n,r):!1}var EGt={type:"rule",tag:"line",nested:!1,attr:CGt,bound:_Gt,draw:SGt,pick:T9(kGt),isect:zqt},AGt=Cse("shape",Mqt),TGt=Cse("symbol",Fqt,lPe);const o1e=u8t();var bp={height:ug,measureWidth:Ase,estimateWidth:pK,width:pK,canvas:yPe};yPe(!0);function yPe(e){bp.width=e&&w0?Ase:pK}function pK(e,t){return bPe(rm(e,t),ug(e))}function bPe(e,t){return~~(.8*e.length*t)}function Ase(e,t){return ug(e)<=0||!(t=rm(e,t))?0:xPe(t,Tse(e))}function xPe(e,t){const n=`(${t}) ${e}`;let r=o1e.get(n);return r===void 0&&(w0.font=t,r=w0.measureText(e).width,o1e.set(n,r)),r}function ug(e){return e.fontSize!=null?+e.fontSize||0:11}function Zy(e){return e.lineHeight!=null?e.lineHeight:ug(e)+2}function DGt(e){return at(e)?e.length>1?e:e[0]:e}function mM(e){return DGt(e.lineBreak&&e.text&&!at(e.text)?e.text.split(e.lineBreak):e.text)}function wPe(e){const t=mM(e);return(at(t)?t.length-1:0)*Zy(e)}function rm(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?IGt(e,n):n}function NGt(e){if(bp.width===Ase){const t=Tse(e);return n=>xPe(n,t)}else{const t=ug(e);return n=>bPe(n,t)}}function IGt(e,t){var n=+e.limit,r=NGt(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",s=e.dir==="rtl",a=0,o=t.length,l;if(n-=r(i),s){for(;a<o;)l=a+o>>>1,r(t.slice(l))>n?a=l+1:o=l;return i+t.slice(a)}else{for(;a<o;)l=1+(a+o>>>1),r(t.slice(0,l))<n?a=l:o=l-1;return t.slice(0,a)+i}}function I9(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Tse(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+ug(e)+"px "+I9(e,t)}function Dse(e){var t=e.baseline,n=ug(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Zy(e):t==="line-bottom"?.29*n-.5*Zy(e):0)}const MGt={left:"start",center:"middle",right:"end"},dA=new Oi;function M9(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-c1,t+=r*Math.cos(i),n+=r*Math.sin(i)),dA.x1=t,dA.y1=n,dA}function FGt(e,t){var n=t.dx||0,r=(t.dy||0)+Dse(t),i=M9(t),s=i.x1,a=i.y1,o=t.angle||0,l;e("text-anchor",MGt[t.align]||"start"),o?(l=ay(s,a)+" "+$se(o),(n||r)&&(l+=" "+ay(n,r))):l=ay(s+n,a+r),e("transform",l)}function Nse(e,t,n){var r=bp.height(t),i=t.align,s=M9(t),a=s.x1,o=s.y1,l=t.dx||0,u=(t.dy||0)+Dse(t)-Math.round(.8*r),c=mM(t),f;if(at(c)?(r+=Zy(t)*(c.length-1),f=c.reduce((h,d)=>Math.max(h,bp.width(t,d)),0)):f=bp.width(t,c),i==="center"?l-=f/2:i==="right"&&(l-=f),e.set(l+=a,u+=o,l+f,u+r),t.angle&&!n)e.rotate(t.angle*nm,a,o);else if(n===2)return e.rotatedPoints(t.angle*nm,a,o);return e}function OGt(e,t,n){Lh(t,r=>{var i=r.opacity==null?1:r.opacity,s,a,o,l,u,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=Tse(r),e.textAlign=r.align||"left",s=M9(r),a=s.x1,o=s.y1,r.angle&&(e.save(),e.translate(a,o),e.rotate(r.angle*nm),a=o=0),a+=r.dx||0,o+=(r.dy||0)+Dse(r),c=mM(r),o$(e,r),at(c))for(u=Zy(r),l=0;l<c.length;++l)f=rm(r,c[l]),r.fill&&DP(e,r,i)&&e.fillText(f,a,o),r.stroke&&l$(e,r,i)&&e.strokeText(f,a,o),o+=u;else f=rm(r,c),r.fill&&DP(e,r,i)&&e.fillText(f,a,o),r.stroke&&l$(e,r,i)&&e.strokeText(f,a,o);r.angle&&e.restore()}})}function RGt(e,t,n,r,i,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=M9(t),o=a.x1,l=a.y1,u=Nse(dA,t,1),c=-t.angle*nm,f=Math.cos(c),h=Math.sin(c),d=f*i-h*s+(o-f*o+h*l),p=h*i+f*s+(l-h*o-f*l);return u.contains(d,p)}function PGt(e,t){const n=Nse(dA,e,2);return bE(t,n[0],n[1],n[2],n[3])||bE(t,n[0],n[1],n[4],n[5])||bE(t,n[4],n[5],n[6],n[7])||bE(t,n[2],n[3],n[6],n[7])}var LGt={type:"text",tag:"text",nested:!1,attr:FGt,bound:Nse,draw:OGt,pick:T9(RGt),isect:PGt},BGt=_se("trail",Oqt,Zqt),Bu={arc:Yqt,area:Qqt,group:fGt,image:gGt,line:mGt,path:bGt,rect:$Gt,rule:EGt,shape:AGt,symbol:TGt,text:LGt,trail:BGt};function l1e(e,t,n){var r=Bu[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Oi),e,n)}var u1e={mark:null};function zGt(e,t,n){var r=Bu[e.marktype],i=r.bound,s=e.items,a=s&&s.length,o,l,u,c;if(r.nested)return a?u=s[0]:(u1e.mark=e,u=u1e),c=l1e(u,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Oi,a)for(o=0,l=s.length;o<l;++o)t.union(l1e(s[o],i,n));return e.bounds=t}const UGt=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function WGt(e,t){return JSON.stringify(e,UGt,t)}function VGt(e){const t=typeof e=="string"?JSON.parse(e):e;return $Pe(t)}function $Pe(e){var t=e.marktype,n=e.items,r,i,s;if(n)for(i=0,s=n.length;i<s;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&$Pe(n[i]);return t&&zGt(e),e}function CPe(e){arguments.length?this.root=VGt(e):(this.root=_Pe({marktype:"group",name:"root",role:"frame"}),this.root.items=[new bse(this.root)])}CPe.prototype={toJSON(e){return WGt(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=_Pe(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function _Pe(e,t){const n={bounds:new Oi,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function O1(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function SPe(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Al(e,t,n,r){var i=e.childNodes[t],s;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(s=i||null,i=O1(e.ownerDocument,n,r),e.insertBefore(i,s)),i}function Uf(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function kPe(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Ise(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function jGt(e,t,n,r){var i=e&&e.mark,s,a;if(i&&(s=Bu[i.marktype]).tip){for(a=Ise(t,n),a[0]-=r[0],a[1]-=r[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=s.tip(i.items,a)}return e}function Qy(e,t){this._active=null,this._handlers={},this._loader=e||Gre(),this._tooltip=t||HGt}function HGt(e,t,n,r){e.element().setAttribute("title",r||"")}Qy.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),s=O1(null,"a");for(const a in r)s.setAttribute(a,r[a]);s.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=jGt(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,s=i.width(),a=i.height();let o=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)o+=e.x||0,l+=e.y||0;return{x:o,y:l,width:s,height:a,left:o,top:l,right:o+s,bottom:l+a}}};function cg(e){this._el=null,this._bgcolor=null,this._loader=new aPe(e)}cg.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(s=>{s&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const qGt="keydown",GGt="keypress",YGt="keyup",EPe="dragenter",v4="dragleave",APe="dragover",gK="mousedown",XGt="mouseup",NP="mousemove",pA="mouseout",TPe="mouseover",IP="click",KGt="dblclick",ZGt="wheel",DPe="mousewheel",MP="touchstart",FP="touchmove",OP="touchend",QGt=[qGt,GGt,YGt,EPe,v4,APe,gK,XGt,NP,pA,TPe,IP,KGt,ZGt,DPe,MP,FP,OP],mK=NP,n3=pA,vK=IP;function F9(e,t){Qy.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const JGt=e=>e===MP||e===FP||e===OP?[MP,FP,OP]:[e];function c1e(e,t){JGt(t).forEach(n=>eYt(e,n))}function eYt(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function f1e(e,t,n){return function(r){const i=this._active,s=this.pickEvent(r);s===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=s,this.fire(t,r),this.fire(e,r))}}function h1e(e){return function(t){this.fire(e,t),this._active=null}}Ne(F9,Qy,{initialize(e,t,n){return this._canvas=e&&SPe(e,"canvas"),[IP,gK,NP,pA,v4].forEach(r=>c1e(this,r)),Qy.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:QGt,DOMMouseScroll(e){this.fire(DPe,e)},mousemove:f1e(NP,TPe,pA),dragover:f1e(APe,EPe,v4),mouseout:h1e(pA),dragleave:h1e(v4),mousedown(e){this._down=this._active,this.fire(gK,e)},click(e){this._down===this._active&&(this.fire(IP,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(MP,e,!0)},touchmove(e){this.fire(FP,e,!0)},touchend(e){this.fire(OP,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===vK&&r&&r.href?this.handleHref(t,r,r.href):(e===mK||e===n3)&&this.handleTooltip(t,r,e!==n3),i)for(let s=0,a=i.length;s<a;++s)i[s].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(c1e(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=Ise(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const s=this.context();return Bu[e.marktype].pick.call(this,s,e,t,n,r,i)}});function tYt(){return typeof window<"u"&&window.devicePixelRatio||1}var nYt=tYt();function rYt(e,t,n,r,i,s){const a=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,o=e.getContext("2d"),l=a?nYt:i;e.width=t*l,e.height=n*l;for(const u in s)o[u]=s[u];return a&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),o.pixelRatio=l,o.setTransform(l,0,0,l,l*r[0],l*r[1]),e}function yK(e){cg.call(this,e),this._options={},this._redraw=!1,this._dirty=new Oi,this._tempb=new Oi}const d1e=cg.prototype,iYt=(e,t,n)=>new Oi().set(0,0,t,n).translate(-e[0],-e[1]);function sYt(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}Ne(yK,cg,{initialize(e,t,n,r,i,s){return this._options=s||{},this._canvas=this._options.externalContext?null:Ku(1,1,this._options.type),e&&this._canvas&&(Uf(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),d1e.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(d1e.resize.call(this,e,t,n,r),this._canvas)rYt(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||$e("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,s=this._dirty,a=iYt(n,r,i);t.save();const o=this._redraw||s.empty()?(this._redraw=!1,a.expand(1)):sYt(t,a.intersect(s),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,o),t.restore(),s.clear(),this},draw(e,t,n){const r=Bu[t.marktype];t.clip&&Jqt(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,s=this.context();i.type!=="pdf"&&!i.externalContext&&s.clearRect(e,t,n,r),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,r))}});function NPe(e,t){Qy.call(this,e,t);const n=this;n._hrefHandler=bK(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=bK(n,(r,i)=>{n.handleTooltip(r,i,r.type!==n3)})}const bK=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};Ne(NPe,Qy,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(vK,this._hrefHandler),r.removeEventListener(mK,this._tooltipHandler),r.removeEventListener(n3,this._tooltipHandler)),this._svg=r=e&&SPe(e,"svg"),r&&(r.addEventListener(vK,this._hrefHandler),r.addEventListener(mK,this._tooltipHandler),r.addEventListener(n3,this._tooltipHandler)),Qy.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const s={type:e,handler:t,listener:bK(this,t)};(r[n]||(r[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const IPe="aria-hidden",Mse="aria-label",Fse="role",Ose="aria-roledescription",MPe="graphics-object",Rse="graphics-symbol",FPe=(e,t,n)=>({[Fse]:e,[Ose]:t,[Mse]:n||void 0}),aYt=Rh(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),p1e={axis:{desc:"axis",caption:uYt},legend:{desc:"legend",caption:cYt},"title-text":{desc:"title",caption:e=>`Title text '${m1e(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${m1e(e)}'`}},g1e={ariaRole:Fse,ariaRoleDescription:Ose,description:Mse};function OPe(e,t){const n=t.aria===!1;if(e(IPe,n||void 0),n||t.description==null)for(const r in g1e)e(g1e[r],void 0);else{const r=t.mark.marktype;e(Mse,t.description),e(Fse,t.ariaRole||(r==="group"?MPe:Rse)),e(Ose,t.ariaRoleDescription||`${r} mark`)}}function RPe(e){return e.aria===!1?{[IPe]:!0}:aYt[e.role]?null:p1e[e.role]?lYt(e,p1e[e.role]):oYt(e)}function oYt(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return FPe(n?MPe:Rse,`${t} mark container`,e.description)}function lYt(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return FPe(t.role||Rse,t.desc,n.description||r(n))}catch{return null}}function m1e(e){return ct(e.text).join(" ")}function uYt(e){const t=e.datum,n=e.orient,r=t.title?PPe(e):null,i=e.context,s=i.scales[t.scale].value,a=i.dataflow.locale(),o=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${a$(o)?"discrete":o} scale with ${nPe(a,s,e)}`}function cYt(e){const t=e.datum,n=t.title?PPe(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,s=Object.keys(i),a=e.context,o=a.scales[i[s[0]]].value,l=a.dataflow.locale();return hYt(r)+(n?` titled '${n}'`:"")+` for ${fYt(s)} with ${nPe(l,o,e)}`}function PPe(e){try{return ct(un(e.items).items[0].text).join(" ")}catch{return null}}function fYt(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+un(e)}function hYt(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const LPe=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),dYt=e=>LPe(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function BPe(){let e="",t="",n="";const r=[],i=()=>t=n="",s=l=>{t&&(e+=`${t}>${n}`,i()),r.push(l)},a=(l,u)=>(u!=null&&(t+=` ${l}="${dYt(u)}"`),o),o={open(l){s(l),t="<"+l;for(var u=arguments.length,c=new Array(u>1?u-1:0),f=1;f<u;f++)c[f-1]=arguments[f];for(const h of c)for(const d in h)a(d,h[d]);return o},close(){const l=r.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,i(),o},attr:a,text:l=>(n+=LPe(l),o),toString:()=>e};return o}const pYt=e=>zPe(BPe(),e)+"";function zPe(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const r of n)r.nodeType===3?e.text(r.nodeValue):zPe(e,r)}return e.close()}const RP={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},PP={blend:"mix-blend-mode"},UPe={fill:"none","stroke-miterlimit":10},mk=0,v1e="http://www.w3.org/2000/xmlns/",_i=t3.xmlns;function WPe(e){cg.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const mH=cg.prototype;Ne(WPe,cg,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=Al(e,0,"svg",_i),this._svg.setAttributeNS(v1e,"xmlns",_i),this._svg.setAttributeNS(v1e,"xmlns:xlink",t3["xmlns:xlink"]),this._svg.setAttribute("version",t3.version),this._svg.setAttribute("class","marks"),Uf(e,1),this._root=Al(this._svg,mk,"g",_i),e0(this._root,UPe),Uf(this._svg,mk+1)),this.background(this._bgcolor),mH.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),mH.background.apply(this,arguments)},resize(e,t,n,r){return mH.resize.call(this,e,t,n,r),this._svg&&(e0(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Al(e,mk,"rect",_i),e0(n,{width:this._width,height:this._height,fill:t}));const r=pYt(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Uf(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,s,a,o,l;for(a=0,o=e.length;a<o;++a)if(n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,s=Bu[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,y1e(n,t),r.items.forEach(u=>{u.dirty=t})),!r.zdirty){if(n.exit){s.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(s,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null;continue}n=s.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,y1e(n,t)):this._update(s,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Bu[t.marktype],s=t.interactive===!1?"none":null,a=i.tag==="g",o=b1e(t,e,n,"g",r);o.setAttribute("class",kPe(t));const l=RPe(t);for(const h in l)Va(o,h,l[h]);a||Va(o,"pointer-events",s),Va(o,"clip-path",t.clip?vse(this,t,t.group):null);let u=null,c=0;const f=h=>{const d=this.isDirty(h),p=b1e(h,o,u,i.tag,r);d&&(this._update(i,p,h),a&&vYt(this,p,h)),u=p,++c};return i.nested?t.items.length&&f(t.items[0]):Lh(t,f),Uf(o,c),o},_update(e,t,n){ep=t,aa=t.__values__,OPe(gA,n),e.attr(gA,n,this);const r=bYt[e.type];r&&r.call(this,e,t,n),ep&&this.style(ep,n)},style(e,t){if(t!=null){for(const n in RP){let r=n==="font"?I9(t):t[n];if(r===aa[n])continue;const i=RP[n];r==null?e.removeAttribute(i):(pse(r)&&(r=rPe(r,this._defs.gradient,VPe())),e.setAttribute(i,r+"")),aa[n]=r}for(const n in PP)y4(e,PP[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=Al(e,mk+1,"defs",_i)),r=gYt(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=Al(e,mk+1,"defs",_i)),r=mYt(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):Uf(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function y1e(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function gYt(e,t,n){let r,i,s;if(t.gradient==="radial"){let a=Al(e,n++,"pattern",_i);e0(a,{id:AP+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=Al(a,0,"rect",_i),e0(a,{width:1,height:1,fill:`url(${VPe()}#${t.id})`}),e=Al(e,n++,"radialGradient",_i),e0(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Al(e,n++,"linearGradient",_i),e0(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)s=Al(e,r,"stop",_i),s.setAttribute("offset",t.stops[r].offset),s.setAttribute("stop-color",t.stops[r].color);return Uf(e,r),n}function mYt(e,t,n){let r;return e=Al(e,n,"clipPath",_i),e.setAttribute("id",t.id),t.path?(r=Al(e,0,"path",_i),r.setAttribute("d",t.path)):(r=Al(e,0,"rect",_i),e0(r,{x:0,y:0,width:t.width,height:t.height})),Uf(e,1),n+1}function vYt(e,t,n){t=t.lastChild.previousSibling;let r,i=0;Lh(n,s=>{r=e.mark(t,s,r),++i}),Uf(t,1+i)}function b1e(e,t,n,r,i){let s=e._svg,a;if(!s&&(a=t.ownerDocument,s=O1(a,r,_i),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},r==="g"))){const o=O1(a,"path",_i);s.appendChild(o),o.__data__=e;const l=O1(a,"g",_i);s.appendChild(l),l.__data__=e;const u=O1(a,"path",_i);s.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(s.ownerSVGElement!==i||yYt(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function yYt(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let ep=null,aa=null;const bYt={group(e,t,n){const r=ep=t.childNodes[2];aa=r.__values__,e.foreground(gA,n,this),aa=t.__values__,ep=t.childNodes[1],e.content(gA,n,this);const i=ep=t.childNodes[0];e.background(gA,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==aa.events&&(Va(r,"pointer-events",s),Va(i,"pointer-events",s),aa.events=s),n.strokeForeground&&n.stroke){const a=n.fill;Va(r,"display",null),this.style(i,n),Va(i,"stroke",null),a&&(n.fill=null),aa=r.__values__,this.style(r,n),a&&(n.fill=a),ep=null}else Va(r,"display","none")},image(e,t,n){n.smooth===!1?(y4(t,"image-rendering","optimizeSpeed"),y4(t,"image-rendering","pixelated")):y4(t,"image-rendering",null)},text(e,t,n){const r=mM(n);let i,s,a,o;at(r)?(s=r.map(l=>rm(n,l)),i=s.join(`
`),i!==aa.text&&(Uf(t,0),a=t.ownerDocument,o=Zy(n),s.forEach((l,u)=>{const c=O1(a,"tspan",_i);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",o)),t.appendChild(c)}),aa.text=i)):(s=rm(n,r),s!==aa.text&&(t.textContent=s,aa.text=s)),Va(t,"font-family",I9(n)),Va(t,"font-size",ug(n)+"px"),Va(t,"font-style",n.fontStyle),Va(t,"font-variant",n.fontVariant),Va(t,"font-weight",n.fontWeight)}};function gA(e,t,n){t!==aa[e]&&(n?xYt(ep,e,t,n):Va(ep,e,t),aa[e]=t)}function y4(e,t,n){n!==aa[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),aa[t]=n)}function e0(e,t){for(const n in t)Va(e,n,t[n])}function Va(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function xYt(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function VPe(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function jPe(e){cg.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}Ne(jPe,cg,{svg(){return this._text},_render(e){const t=BPe();t.open("svg",zt({},t3,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",UPe,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Bu[t.marktype],r=n.tag,i=[OPe,n.attr];e.open("g",{class:kPe(t),"clip-path":t.clip?vse(this,t,t.group):null},RPe(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const s=a=>{const o=this.href(a);if(o&&e.open("a",o),e.open(r,this.attr(t,a,i,r!=="g"?r:null)),r==="text"){const l=mM(a);if(at(l)){const u={x:0,dy:Zy(a)};for(let c=0;c<l.length;++c)e.open("tspan",c?u:null).text(rm(a,l[c])).close()}else e.text(rm(a,l))}else if(r==="g"){const l=a.strokeForeground,u=a.fill,c=a.stroke;l&&c&&(a.stroke=null),e.open("path",this.attr(t,a,n.background,"bgrect")).close(),e.open("g",this.attr(t,a,n.content)),Lh(a,f=>this.mark(e,f)),e.close(),l&&c?(u&&(a.fill=null),a.stroke=c,e.open("path",this.attr(t,a,n.foreground,"bgrect")).close(),u&&(a.fill=u)):e.open("path",this.attr(t,a,n.foreground,"bgfore")).close()}e.close(),o&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):Lh(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},s=(a,o,l,u)=>{i[u||a]=o};return Array.isArray(n)?n.forEach(a=>a(s,t,this)):n(s,t,this),r&&wYt(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const s=t[i],a=s.stops;s.gradient==="radial"?(e.open("pattern",{id:AP+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:i,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let o=0;o<a.length;++o)e.open("stop",{offset:a[o].offset,"stop-color":a[o].color}).close();e.close()}for(const i in n){const s=n[i];e.open("clipPath",{id:i}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});function wYt(e,t,n,r,i){let s;if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=I9(t),e["font-size"]=ug(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in RP){let o=t[a];const l=RP[a];o==="transparent"&&(l==="fill"||l==="stroke")||o!=null&&(pse(o)&&(o=rPe(o,i.gradient,"")),e[l]=o)}for(const a in PP){const o=t[a];o!=null&&(s=s||[],s.push(`${PP[a]}: ${o};`))}return s&&(e.style=s.join(" ")),e}const HPe="canvas",qPe="png",GPe="svg",YPe="none",R1={Canvas:HPe,PNG:qPe,SVG:GPe,None:YPe},u$={};u$[HPe]=u$[qPe]={renderer:yK,headless:yK,handler:F9};u$[GPe]={renderer:WPe,headless:jPe,handler:NPe};u$[YPe]={};function Pse(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(u$[e]=t,this):u$[e]}function $Yt(e,t,n){const r=[],i=new Oi().union(t),s=e.marktype;return s?XPe(e,i,n,r):s==="group"?KPe(e,i,n,r):$e("Intersect scene must be mark node or group item.")}function XPe(e,t,n,r){if(CYt(e,t,n)){const i=e.items,s=e.marktype,a=i.length;let o=0;if(s==="group")for(;o<a;++o)KPe(i[o],t,n,r);else for(const l=Bu[s].isect;o<a;++o){const u=i[o];ZPe(u,t,l)&&r.push(u)}}return r}function CYt(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function KPe(e,t,n,r){n&&n(e.mark)&&ZPe(e,t,Bu.group.isect)&&r.push(e);const i=e.items,s=i&&i.length;if(s){const a=e.x||0,o=e.y||0;t.translate(-a,-o);for(let l=0;l<s;++l)XPe(i[l],t,n,r);t.translate(a,o)}return r}function ZPe(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const vH=new Oi;function _Yt(e){const t=e.clip;if(Ut(t))t(A9(vH.clear()));else if(t)vH.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(vH)}const c$="top",kc="left",Mc="right",im="bottom",SYt="top-left",kYt="top-right",EYt="bottom-left",AYt="bottom-right",Lse="start",xK="middle",qa="end",TYt="x",DYt="y",O9="group",Bse="axis",zse="title",NYt="frame",IYt="scope",Use="legend",QPe="row-header",JPe="row-footer",eLe="row-title",tLe="column-header",nLe="column-footer",rLe="column-title",MYt="padding",FYt="symbol",iLe="fit",sLe="fit-x",aLe="fit-y",OYt="pad",Wse="none",PO="all",wK="each",Vse="flush",t0="column",n0="row";function oLe(e){me.call(this,null,e)}Ne(oLe,me,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,s=Bu[i],a=s.bound;let o=r.bounds,l;if(s.nested)r.items.length&&n.dirty(r.items[0]),o=LO(r,a),r.items.forEach(u=>{u.bounds.clear().union(o)});else if(i===O9||e.modified())switch(t.visit(t.MOD,u=>n.dirty(u)),o.clear(),r.items.forEach(u=>o.union(LO(u,a))),r.role){case Bse:case Use:case zse:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,u=>{o.union(LO(u,a))}),t.visit(t.MOD,u=>{l=l||o.alignsWith(u.bounds),n.dirty(u),o.union(LO(u,a))}),l&&(o.clear(),r.items.forEach(u=>o.union(u.bounds)));return _Yt(r),t.modifies("bounds")}});function LO(e,t,n){return t(e.bounds.clear(),e,n)}const x1e=":vega_identifier:";function jse(e){me.call(this,0,e)}jse.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};Ne(jse,me,{transform(e,t){const n=RYt(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,s=>s[r]=s[r]||++i),n.set(this.value=i),t}});function RYt(e){return e._signals[x1e]||(e._signals[x1e]=e.add(0))}function lLe(e){me.call(this,null,e)}Ne(lLe,me,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,PYt(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===O9?bse:yse;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function PYt(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function uLe(e){me.call(this,null,e)}const w1e={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!cLe(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},cLe=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),$1e=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,s;n<r;i=s,++n)if(cLe(i,s=e[n].bounds,t))return!0},LYt=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},BYt=(e,t,n)=>{var r=e.range(),i=new Oi;return t===c$||t===im?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),s=>i.encloses(s.bounds)},C1e=e=>(e.forEach(t=>t.opacity=1),e),_1e=(e,t)=>e.reflow(t.modified()).modifies("opacity");Ne(uLe,me,{transform(e,t){const n=w1e[e.method]||w1e.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,s,a;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(C1e(i),t=_1e(t,e)),t;if(i=i.filter(LYt),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),s=C1e(i),t=_1e(t,e),s.length>=3&&$1e(s,r)){do s=n(s,r);while(s.length>=3&&$1e(s,r));s.length<3&&!un(i).opacity&&(s.length>1&&(un(s).opacity=0),un(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(a=BYt(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(l=>{a(l)||(l.opacity=0)}));const o=s[0].mark.bounds.clear();return i.forEach(l=>{l.opacity&&o.union(l.bounds)}),t}});function fLe(e){me.call(this,null,e)}Ne(fLe,me,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const ra=new Oi;function M2(e,t,n){return e[t]===n?0:(e[t]=n,1)}function zYt(e){var t=e.items[0].orient;return t===kc||t===Mc}function UYt(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function WYt(e,t,n,r){var i=t.items[0],s=i.datum,a=i.translate!=null?i.translate:.5,o=i.orient,l=UYt(s),u=i.range,c=i.offset,f=i.position,h=i.minExtent,d=i.maxExtent,p=s.title&&i.items[l[2]].items[0],g=i.titlePadding,m=i.bounds,v=p&&wPe(p),y=0,b=0,x,w;switch(ra.clear().union(m),m.clear(),(x=l[0])>-1&&m.union(i.items[x].bounds),(x=l[1])>-1&&m.union(i.items[x].bounds),o){case c$:y=f||0,b=-c,w=Math.max(h,Math.min(d,-m.y1)),m.add(0,-w).add(u,0),p&&BO(e,p,w,g,v,0,-1,m);break;case kc:y=-c,b=f||0,w=Math.max(h,Math.min(d,-m.x1)),m.add(-w,0).add(0,u),p&&BO(e,p,w,g,v,1,-1,m);break;case Mc:y=n+c,b=f||0,w=Math.max(h,Math.min(d,m.x2)),m.add(0,0).add(w,u),p&&BO(e,p,w,g,v,1,1,m);break;case im:y=f||0,b=r+c,w=Math.max(h,Math.min(d,m.y2)),m.add(0,0).add(u,w),p&&BO(e,p,w,g,0,0,1,m);break;default:y=i.x,b=i.y}return ev(m.translate(y,b),i),M2(i,"x",y+a)|M2(i,"y",b+a)&&(i.bounds=ra,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function BO(e,t,n,r,i,s,a,o){const l=t.bounds;if(t.auto){const u=a*(n+i+r);let c=0,f=0;e.dirty(t),s?c=(t.x||0)-(t.x=u):f=(t.y||0)-(t.y=u),t.mark.bounds.clear().union(l.translate(-c,-f)),e.dirty(t)}o.union(l)}const S1e=(e,t)=>Math.floor(Math.min(e,t)),k1e=(e,t)=>Math.ceil(Math.max(e,t));function VYt(e){var t=e.items,n=t.length,r=0,i,s;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],s=i.items,i.marktype===O9)switch(i.role){case Bse:case Use:case zse:break;case QPe:a.rowheaders.push(...s);break;case JPe:a.rowfooters.push(...s);break;case tLe:a.colheaders.push(...s);break;case nLe:a.colfooters.push(...s);break;case eLe:a.rowtitle=s[0];break;case rLe:a.coltitle=s[0];break;default:a.marks.push(...s)}return a}function jYt(e){return new Oi().set(0,0,e.width||0,e.height||0)}function HYt(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Sr(e,t,n){const r=Ft(e)?e[t]:e;return r!=null?r:n!==void 0?n:0}function E1e(e){return e<0?Math.ceil(-e):0}function hLe(e,t,n){var r=!n.nodirty,i=n.bounds===Vse?jYt:HYt,s=ra.set(0,0,0,0),a=Sr(n.align,t0),o=Sr(n.align,n0),l=Sr(n.padding,t0),u=Sr(n.padding,n0),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),h=t.length,d=Array(h),p=Array(c),g=0,m=Array(h),v=Array(f),y=0,b=Array(h),x=Array(h),w=Array(h),C,$,_,k,E,S,N,A,D,T,I;for($=0;$<c;++$)p[$]=0;for($=0;$<f;++$)v[$]=0;for($=0;$<h;++$)S=t[$],E=w[$]=i(S),S.x=S.x||0,b[$]=0,S.y=S.y||0,x[$]=0,_=$%c,k=~~($/c),g=Math.max(g,N=Math.ceil(E.x2)),y=Math.max(y,A=Math.ceil(E.y2)),p[_]=Math.max(p[_],N),v[k]=Math.max(v[k],A),d[$]=l+E1e(E.x1),m[$]=u+E1e(E.y1),r&&e.dirty(t[$]);for($=0;$<h;++$)$%c===0&&(d[$]=0),$<c&&(m[$]=0);if(a===wK)for(_=1;_<c;++_){for(I=0,$=_;$<h;$+=c)I<d[$]&&(I=d[$]);for($=_;$<h;$+=c)d[$]=I+p[_-1]}else if(a===PO){for(I=0,$=0;$<h;++$)$%c&&I<d[$]&&(I=d[$]);for($=0;$<h;++$)$%c&&(d[$]=I+g)}else for(a=!1,_=1;_<c;++_)for($=_;$<h;$+=c)d[$]+=p[_-1];if(o===wK)for(k=1;k<f;++k){for(I=0,$=k*c,C=$+c;$<C;++$)I<m[$]&&(I=m[$]);for($=k*c;$<C;++$)m[$]=I+v[k-1]}else if(o===PO){for(I=0,$=c;$<h;++$)I<m[$]&&(I=m[$]);for($=c;$<h;++$)m[$]=I+y}else for(o=!1,k=1;k<f;++k)for($=k*c,C=$+c;$<C;++$)m[$]+=v[k-1];for(D=0,$=0;$<h;++$)D=d[$]+($%c?D:0),b[$]+=D-t[$].x;for(_=0;_<c;++_)for(T=0,$=_;$<h;$+=c)T+=m[$],x[$]+=T-t[$].y;if(a&&Sr(n.center,t0)&&f>1)for($=0;$<h;++$)E=a===PO?g:p[$%c],D=E-w[$].x2-t[$].x-b[$],D>0&&(b[$]+=D/2);if(o&&Sr(n.center,n0)&&c!==1)for($=0;$<h;++$)E=o===PO?y:v[~~($/c)],T=E-w[$].y2-t[$].y-x[$],T>0&&(x[$]+=T/2);for($=0;$<h;++$)s.union(w[$].translate(b[$],x[$]));switch(D=Sr(n.anchor,TYt),T=Sr(n.anchor,DYt),Sr(n.anchor,t0)){case qa:D-=s.width();break;case xK:D-=s.width()/2}switch(Sr(n.anchor,n0)){case qa:T-=s.height();break;case xK:T-=s.height()/2}for(D=Math.round(D),T=Math.round(T),s.clear(),$=0;$<h;++$)t[$].mark.bounds.clear();for($=0;$<h;++$)S=t[$],S.x+=b[$]+=D,S.y+=x[$]+=T,s.union(S.mark.bounds.union(S.bounds.translate(b[$],x[$]))),r&&e.dirty(S);return s}function qYt(e,t,n){var r=VYt(t),i=r.marks,s=n.bounds===Vse?GYt:YYt,a=n.offset,o=n.columns||i.length,l=o<=0?1:Math.ceil(i.length/o),u=l*o,c,f,h,d,p,g,m;const v=hLe(e,i,n);v.empty()&&v.set(0,0,0,0),r.rowheaders&&(g=Sr(n.headerBand,n0,null),c=zO(e,r.rowheaders,i,o,l,-Sr(a,"rowHeader"),S1e,0,s,"x1",0,o,1,g)),r.colheaders&&(g=Sr(n.headerBand,t0,null),f=zO(e,r.colheaders,i,o,o,-Sr(a,"columnHeader"),S1e,1,s,"y1",0,1,o,g)),r.rowfooters&&(g=Sr(n.footerBand,n0,null),h=zO(e,r.rowfooters,i,o,l,Sr(a,"rowFooter"),k1e,0,s,"x2",o-1,o,1,g)),r.colfooters&&(g=Sr(n.footerBand,t0,null),d=zO(e,r.colfooters,i,o,o,Sr(a,"columnFooter"),k1e,1,s,"y2",u-o,1,o,g)),r.rowtitle&&(p=Sr(n.titleAnchor,n0),m=Sr(a,"rowTitle"),m=p===qa?h+m:c-m,g=Sr(n.titleBand,n0,.5),A1e(e,r.rowtitle,m,0,v,g)),r.coltitle&&(p=Sr(n.titleAnchor,t0),m=Sr(a,"columnTitle"),m=p===qa?d+m:f-m,g=Sr(n.titleBand,t0,.5),A1e(e,r.coltitle,m,1,v,g))}function GYt(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function YYt(e,t){return e.bounds[t]}function zO(e,t,n,r,i,s,a,o,l,u,c,f,h,d){var p=n.length,g=0,m=0,v,y,b,x,w,C,$,_,k;if(!p)return g;for(v=c;v<p;v+=f)n[v]&&(g=a(g,l(n[v],u)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=s,y=0,x=t.length;y<x;++y)e.dirty(t[y]),t[y].mark.bounds.clear();for(v=c,y=0,x=t.length;y<x;++y,v+=f){for(C=t[y],w=C.mark.bounds,b=v;b>=0&&($=n[b])==null;b-=h);o?(_=d==null?$.x:Math.round($.bounds.x1+d*$.bounds.width()),k=g):(_=g,k=d==null?$.y:Math.round($.bounds.y1+d*$.bounds.height())),w.union(C.bounds.translate(_-(C.x||0),k-(C.y||0))),C.x=_,C.y=k,e.dirty(C),m=a(m,w[u])}return m}function A1e(e,t,n,r,i,s){if(!!t){e.dirty(t);var a=n,o=n;r?a=Math.round(i.x1+s*i.width()):o=Math.round(i.y1+s*i.height()),t.bounds.translate(a-(t.x||0),o-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=o,e.dirty(t)}}function XYt(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function KYt(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function ZYt(e,t,n,r,i,s,a){const o=XYt(n,t),l=KYt(e,o("offset",0)),u=o("anchor",Lse),c=u===qa?1:u===xK?.5:0,f={align:wK,bounds:o("bounds",Vse),columns:o("direction")==="vertical"?1:e.length,padding:o("margin",8),center:o("center"),nodirty:!0};switch(t){case kc:f.anchor={x:Math.floor(r.x1)-l,column:qa,y:c*(a||r.height()+2*r.y1),row:u};break;case Mc:f.anchor={x:Math.ceil(r.x2)+l,y:c*(a||r.height()+2*r.y1),row:u};break;case c$:f.anchor={y:Math.floor(i.y1)-l,row:qa,x:c*(s||i.width()+2*i.x1),column:u};break;case im:f.anchor={y:Math.ceil(i.y2)+l,x:c*(s||i.width()+2*i.x1),column:u};break;case SYt:f.anchor={x:l,y:l};break;case kYt:f.anchor={x:s-l,y:l,column:qa};break;case EYt:f.anchor={x:l,y:a-l,row:qa};break;case AYt:f.anchor={x:s-l,y:a-l,column:qa,row:qa};break}return f}function QYt(e,t){var n=t.items[0],r=n.datum,i=n.orient,s=n.bounds,a=n.x,o=n.y,l,u;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),eXt(e,n,n.items[0].items[0]),s=JYt(n,s),l=2*n.padding,u=2*n.padding,s.empty()||(l=Math.ceil(s.width()+l),u=Math.ceil(s.height()+u)),r.type===FYt&&tXt(n.items[0].items[0].items[0].items),i!==Wse&&(n.x=a=0,n.y=o=0),n.width=l,n.height=u,ev(s.set(a,o,a+l,o+u),n),n.mark.bounds.clear().union(s),n}function JYt(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function eXt(e,t,n){var r=t.padding,i=r-n.x,s=r-n.y;if(!t.datum.title)(i||s)&&vk(e,n,i,s);else{var a=t.items[1].items[0],o=a.anchor,l=t.titlePadding||0,u=r-a.x,c=r-a.y;switch(a.orient){case kc:i+=Math.ceil(a.bounds.width())+l;break;case Mc:case im:break;default:s+=a.bounds.height()+l}switch((i||s)&&vk(e,n,i,s),a.orient){case kc:c+=l2(t,n,a,o,1,1);break;case Mc:u+=l2(t,n,a,qa,0,0)+l,c+=l2(t,n,a,o,1,1);break;case im:u+=l2(t,n,a,o,0,0),c+=l2(t,n,a,qa,-1,0,1)+l;break;default:u+=l2(t,n,a,o,0,0)}(u||c)&&vk(e,a,u,c),(u=Math.round(a.bounds.x1-r))<0&&(vk(e,n,-u,0),vk(e,a,-u,0))}}function l2(e,t,n,r,i,s,a){const o=e.datum.type!=="symbol",l=n.datum.vgrad,u=o&&(s||!l)&&!a?t.items[0]:t,c=u.bounds[i?"y2":"x2"]-e.padding,f=l&&s?c:0,h=l&&s?0:c,d=i<=0?0:wPe(n);return Math.round(r===Lse?f:r===qa?h-d:.5*(c-d))}function vk(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function tXt(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function nXt(e,t,n,r,i){var s=t.items[0],a=s.frame,o=s.orient,l=s.anchor,u=s.offset,c=s.padding,f=s.items[0].items[0],h=s.items[1]&&s.items[1].items[0],d=o===kc||o===Mc?r:n,p=0,g=0,m=0,v=0,y=0,b;if(a!==O9?o===kc?(p=i.y2,d=i.y1):o===Mc?(p=i.y1,d=i.y2):(p=i.x1,d=i.x2):o===kc&&(p=r,d=0),b=l===Lse?p:l===qa?d:(p+d)/2,h&&h.text){switch(o){case c$:case im:y=f.bounds.height()+c;break;case kc:v=f.bounds.width()+c;break;case Mc:v=-f.bounds.width()-c;break}ra.clear().union(h.bounds),ra.translate(v-(h.x||0),y-(h.y||0)),M2(h,"x",v)|M2(h,"y",y)&&(e.dirty(h),h.bounds.clear().union(ra),h.mark.bounds.clear().union(ra),e.dirty(h)),ra.clear().union(h.bounds)}else ra.clear();switch(ra.union(f.bounds),o){case c$:g=b,m=i.y1-ra.height()-u;break;case kc:g=i.x1-ra.width()-u,m=b;break;case Mc:g=i.x2+ra.width()+u,m=b;break;case im:g=b,m=i.y2+u;break;default:g=s.x,m=s.y}return M2(s,"x",g)|M2(s,"y",m)&&(ra.translate(g,m),e.dirty(s),s.bounds.clear().union(ra),t.bounds.clear().union(ra),e.dirty(s)),s.bounds}function dLe(e){me.call(this,null,e)}Ne(dLe,me,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&qYt(n,r,e.layout),iXt(n,r,e)}),rXt(e.mark.group)?t.reflow():t}});function rXt(e){return e&&e.mark.role!=="legend-entry"}function iXt(e,t,n){var r=t.items,i=Math.max(0,t.width||0),s=Math.max(0,t.height||0),a=new Oi().set(0,0,i,s),o=a.clone(),l=a.clone(),u=[],c,f,h,d,p,g;for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case Bse:d=zYt(f)?o:l,d.union(WYt(e,f,i,s));break;case zse:c=f;break;case Use:u.push(QYt(e,f));break;case NYt:case IYt:case QPe:case JPe:case eLe:case tLe:case nLe:case rLe:o.union(f.bounds),l.union(f.bounds);break;default:a.union(f.bounds)}if(u.length){const m={};u.forEach(v=>{h=v.orient||Mc,h!==Wse&&(m[h]||(m[h]=[])).push(v)});for(const v in m){const y=m[v];hLe(e,y,ZYt(y,v,n.legends,o,l,i,s))}u.forEach(v=>{const y=v.bounds;if(y.equals(v._bounds)||(v.bounds=v._bounds,e.dirty(v),v.bounds=y,e.dirty(v)),n.autosize&&(n.autosize.type===iLe||n.autosize.type===sLe||n.autosize.type===aLe))switch(v.orient){case kc:case Mc:a.add(y.x1,0).add(y.x2,0);break;case c$:case im:a.add(0,y.y1).add(0,y.y2)}else a.union(y)})}a.union(o).union(l),c&&a.union(nXt(e,c,i,s,a)),t.clip&&a.set(0,0,t.width||0,t.height||0),sXt(e,t,a,n)}function sXt(e,t,n,r){const i=r.autosize||{},s=i.type;if(e._autosize<1||!s)return;let a=e._width,o=e._height,l=Math.max(0,t.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const h=Math.max(0,Math.ceil(n.x2-l)),d=Math.max(0,Math.ceil(n.y2-c));if(i.contains===MYt){const p=e.padding();a-=p.left+p.right,o-=p.top+p.bottom}s===Wse?(u=0,f=0,l=a,c=o):s===iLe?(l=Math.max(0,a-u-h),c=Math.max(0,o-f-d)):s===sLe?(l=Math.max(0,a-u-h),o=c+f+d):s===aLe?(a=l+u+h,c=Math.max(0,o-f-d)):s===OYt&&(a=l+u+h,o=c+f+d),e._resizeView(a,o,l,c,[u,f],i.resize)}const aXt=Object.freeze(Object.defineProperty({__proto__:null,bound:oLe,identifier:jse,mark:lLe,overlap:uLe,render:fLe,viewlayout:dLe},Symbol.toStringTag,{value:"Module"}));function Y_(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function vM(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function tv(){}var Jy=.7,f$=1/Jy,nw="\\s*([+-]?\\d+)\\s*",r3="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",hh="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oXt=/^#([0-9a-f]{3,8})$/,lXt=new RegExp("^rgb\\("+[nw,nw,nw]+"\\)$"),uXt=new RegExp("^rgb\\("+[hh,hh,hh]+"\\)$"),cXt=new RegExp("^rgba\\("+[nw,nw,nw,r3]+"\\)$"),fXt=new RegExp("^rgba\\("+[hh,hh,hh,r3]+"\\)$"),hXt=new RegExp("^hsl\\("+[r3,hh,hh]+"\\)$"),dXt=new RegExp("^hsla\\("+[r3,hh,hh,r3]+"\\)$"),T1e={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Y_(tv,i3,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:D1e,formatHex:D1e,formatHsl:pXt,formatRgb:N1e,toString:N1e});function D1e(){return this.rgb().formatHex()}function pXt(){return pLe(this).formatHsl()}function N1e(){return this.rgb().formatRgb()}function i3(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=oXt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?I1e(t):n===3?new Fs(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?UO(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?UO(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=lXt.exec(e))?new Fs(t[1],t[2],t[3],1):(t=uXt.exec(e))?new Fs(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=cXt.exec(e))?UO(t[1],t[2],t[3],t[4]):(t=fXt.exec(e))?UO(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=hXt.exec(e))?O1e(t[1],t[2]/100,t[3]/100,1):(t=dXt.exec(e))?O1e(t[1],t[2]/100,t[3]/100,t[4]):T1e.hasOwnProperty(e)?I1e(T1e[e]):e==="transparent"?new Fs(NaN,NaN,NaN,0):null}function I1e(e){return new Fs(e>>16&255,e>>8&255,e&255,1)}function UO(e,t,n,r){return r<=0&&(e=t=n=NaN),new Fs(e,t,n,r)}function Hse(e){return e instanceof tv||(e=i3(e)),e?(e=e.rgb(),new Fs(e.r,e.g,e.b,e.opacity)):new Fs}function sm(e,t,n,r){return arguments.length===1?Hse(e):new Fs(e,t,n,r==null?1:r)}function Fs(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Y_(Fs,sm,vM(tv,{brighter:function(e){return e=e==null?f$:Math.pow(f$,e),new Fs(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Jy:Math.pow(Jy,e),new Fs(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:M1e,formatHex:M1e,formatRgb:F1e,toString:F1e}));function M1e(){return"#"+yH(this.r)+yH(this.g)+yH(this.b)}function F1e(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function yH(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function O1e(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Wf(e,t,n,r)}function pLe(e){if(e instanceof Wf)return new Wf(e.h,e.s,e.l,e.opacity);if(e instanceof tv||(e=i3(e)),!e)return new Wf;if(e instanceof Wf)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new Wf(a,o,l,e.opacity)}function LP(e,t,n,r){return arguments.length===1?pLe(e):new Wf(e,t,n,r==null?1:r)}function Wf(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Y_(Wf,LP,vM(tv,{brighter:function(e){return e=e==null?f$:Math.pow(f$,e),new Wf(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Jy:Math.pow(Jy,e),new Wf(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Fs(bH(e>=240?e-240:e+120,i,r),bH(e,i,r),bH(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function bH(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const gLe=Math.PI/180,mLe=180/Math.PI,BP=18,vLe=.96422,yLe=1,bLe=.82521,xLe=4/29,rw=6/29,wLe=3*rw*rw,gXt=rw*rw*rw;function $Le(e){if(e instanceof dh)return new dh(e.l,e.a,e.b,e.opacity);if(e instanceof tp)return CLe(e);e instanceof Fs||(e=Hse(e));var t=CH(e.r),n=CH(e.g),r=CH(e.b),i=xH((.2225045*t+.7168786*n+.0606169*r)/yLe),s,a;return t===n&&n===r?s=a=i:(s=xH((.4360747*t+.3850649*n+.1430804*r)/vLe),a=xH((.0139322*t+.0971045*n+.7141733*r)/bLe)),new dh(116*i-16,500*(s-i),200*(i-a),e.opacity)}function zP(e,t,n,r){return arguments.length===1?$Le(e):new dh(e,t,n,r==null?1:r)}function dh(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Y_(dh,zP,vM(tv,{brighter:function(e){return new dh(this.l+BP*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new dh(this.l-BP*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=vLe*wH(t),e=yLe*wH(e),n=bLe*wH(n),new Fs($H(3.1338561*t-1.6168667*e-.4906146*n),$H(-.9787684*t+1.9161415*e+.033454*n),$H(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function xH(e){return e>gXt?Math.pow(e,1/3):e/wLe+xLe}function wH(e){return e>rw?e*e*e:wLe*(e-xLe)}function $H(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function CH(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function mXt(e){if(e instanceof tp)return new tp(e.h,e.c,e.l,e.opacity);if(e instanceof dh||(e=$Le(e)),e.a===0&&e.b===0)return new tp(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*mLe;return new tp(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function UP(e,t,n,r){return arguments.length===1?mXt(e):new tp(e,t,n,r==null?1:r)}function tp(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function CLe(e){if(isNaN(e.h))return new dh(e.l,0,0,e.opacity);var t=e.h*gLe;return new dh(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Y_(tp,UP,vM(tv,{brighter:function(e){return new tp(this.h,this.c,this.l+BP*(e==null?1:e),this.opacity)},darker:function(e){return new tp(this.h,this.c,this.l-BP*(e==null?1:e),this.opacity)},rgb:function(){return CLe(this).rgb()}}));var _Le=-.14861,qse=1.78277,Gse=-.29227,R9=-.90649,s3=1.97294,R1e=s3*R9,P1e=s3*qse,L1e=qse*Gse-R9*_Le;function vXt(e){if(e instanceof oy)return new oy(e.h,e.s,e.l,e.opacity);e instanceof Fs||(e=Hse(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(L1e*r+R1e*t-P1e*n)/(L1e+R1e-P1e),s=r-i,a=(s3*(n-i)-Gse*s)/R9,o=Math.sqrt(a*a+s*s)/(s3*i*(1-i)),l=o?Math.atan2(a,s)*mLe-120:NaN;return new oy(l<0?l+360:l,o,i,e.opacity)}function $K(e,t,n,r){return arguments.length===1?vXt(e):new oy(e,t,n,r==null?1:r)}function oy(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Y_(oy,$K,vM(tv,{brighter:function(e){return e=e==null?f$:Math.pow(f$,e),new oy(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Jy:Math.pow(Jy,e),new oy(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*gLe,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Fs(255*(t+n*(_Le*r+qse*i)),255*(t+n*(Gse*r+R9*i)),255*(t+n*(s3*r)),this.opacity)}}));function SLe(e,t,n,r,i){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*n+(1+3*e+3*s-3*a)*r+a*i)/6}function kLe(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],a=r>0?e[r-1]:2*i-s,o=r<t-1?e[r+2]:2*s-i;return SLe((n-r/t)*t,a,i,s,o)}}function ELe(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],a=e[(r+1)%t],o=e[(r+2)%t];return SLe((n-r/t)*t,i,s,a,o)}}const P9=e=>()=>e;function ALe(e,t){return function(n){return e+n*t}}function yXt(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function L9(e,t){var n=t-e;return n?ALe(e,n>180||n<-180?n-360*Math.round(n/360):n):P9(isNaN(e)?t:e)}function bXt(e){return(e=+e)==1?rs:function(t,n){return n-t?yXt(t,n,e):P9(isNaN(t)?n:t)}}function rs(e,t){var n=t-e;return n?ALe(e,n):P9(isNaN(e)?t:e)}const CK=function e(t){var n=bXt(t);function r(i,s){var a=n((i=sm(i)).r,(s=sm(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=rs(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function TLe(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),a,o;for(a=0;a<n;++a)o=sm(t[a]),r[a]=o.r||0,i[a]=o.g||0,s[a]=o.b||0;return r=e(r),i=e(i),s=e(s),o.opacity=1,function(l){return o.r=r(l),o.g=i(l),o.b=s(l),o+""}}}var xXt=TLe(kLe),wXt=TLe(ELe);function Yse(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function DLe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function $Xt(e,t){return(DLe(t)?Yse:NLe)(e,t)}function NLe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=nv(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function ILe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function xc(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function MLe(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=nv(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var _K=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_H=new RegExp(_K.source,"g");function CXt(e){return function(){return e}}function _Xt(e){return function(t){return e(t)+""}}function FLe(e,t){var n=_K.lastIndex=_H.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=_K.exec(e))&&(i=_H.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:xc(r,i)})),n=_H.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?_Xt(l[0].x):CXt(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)o[(f=l[c]).i]=f.x(u);return o.join("")})}function nv(e,t){var n=typeof t,r;return t==null||n==="boolean"?P9(t):(n==="number"?xc:n==="string"?(r=i3(t))?(t=r,CK):FLe:t instanceof i3?CK:t instanceof Date?ILe:DLe(t)?Yse:Array.isArray(t)?NLe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?MLe:xc)(e,t)}function SXt(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function kXt(e,t){var n=L9(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function yM(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var B1e=180/Math.PI,SK={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function OLe(e,t,n,r,i,s){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*B1e,skewX:Math.atan(l)*B1e,scaleX:a,scaleY:o}}var WO;function EXt(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?SK:OLe(t.a,t.b,t.c,t.d,t.e,t.f)}function AXt(e){return e==null||(WO||(WO=document.createElementNS("http://www.w3.org/2000/svg","g")),WO.setAttribute("transform",e),!(e=WO.transform.baseVal.consolidate()))?SK:(e=e.matrix,OLe(e.a,e.b,e.c,e.d,e.e,e.f))}function RLe(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push("translate(",null,t,null,n);p.push({i:g-4,x:xc(u,f)},{i:g-2,x:xc(c,h)})}else(f||h)&&d.push("translate("+f+t+h+n)}function a(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:xc(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function o(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:xc(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push(i(d)+"scale(",null,",",null,")");p.push({i:g-4,x:xc(u,f)},{i:g-2,x:xc(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=e(u),c=e(c),s(u.translateX,u.translateY,c.translateX,c.translateY,f,h),a(u.rotate,c.rotate,f,h),o(u.skewX,c.skewX,f,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,g=h.length,m;++p<g;)f[(m=h[p]).i]=m.x(d);return f.join("")}}}var TXt=RLe(EXt,"px, ","px)","deg)"),DXt=RLe(AXt,", ",")",")"),NXt=1e-12;function z1e(e){return((e=Math.exp(e))+1/e)/2}function IXt(e){return((e=Math.exp(e))-1/e)/2}function MXt(e){return((e=Math.exp(2*e))-1)/(e+1)}const FXt=function e(t,n,r){function i(s,a){var o=s[0],l=s[1],u=s[2],c=a[0],f=a[1],h=a[2],d=c-o,p=f-l,g=d*d+p*p,m,v;if(g<NXt)v=Math.log(h/u)/t,m=function($){return[o+$*d,l+$*p,u*Math.exp(t*$*v)]};else{var y=Math.sqrt(g),b=(h*h-u*u+r*g)/(2*u*n*y),x=(h*h-u*u-r*g)/(2*h*n*y),w=Math.log(Math.sqrt(b*b+1)-b),C=Math.log(Math.sqrt(x*x+1)-x);v=(C-w)/t,m=function($){var _=$*v,k=z1e(w),E=u/(n*y)*(k*MXt(t*_+w)-IXt(w));return[o+E*d,l+E*p,u*k/z1e(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(s){var a=Math.max(.001,+s),o=a*a,l=o*o;return e(a,o,l)},i}(Math.SQRT2,2,4);function PLe(e){return function(t,n){var r=e((t=LP(t)).h,(n=LP(n)).h),i=rs(t.s,n.s),s=rs(t.l,n.l),a=rs(t.opacity,n.opacity);return function(o){return t.h=r(o),t.s=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const OXt=PLe(L9);var RXt=PLe(rs);function PXt(e,t){var n=rs((e=zP(e)).l,(t=zP(t)).l),r=rs(e.a,t.a),i=rs(e.b,t.b),s=rs(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=s(a),e+""}}function LLe(e){return function(t,n){var r=e((t=UP(t)).h,(n=UP(n)).h),i=rs(t.c,n.c),s=rs(t.l,n.l),a=rs(t.opacity,n.opacity);return function(o){return t.h=r(o),t.c=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const LXt=LLe(L9);var BXt=LLe(rs);function BLe(e){return function t(n){n=+n;function r(i,s){var a=e((i=$K(i)).h,(s=$K(s)).h),o=rs(i.s,s.s),l=rs(i.l,s.l),u=rs(i.opacity,s.opacity);return function(c){return i.h=a(c),i.s=o(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}const zXt=BLe(L9);var UXt=BLe(rs);function Xse(e,t){t===void 0&&(t=e,e=nv);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function WXt(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const VXt=Object.freeze(Object.defineProperty({__proto__:null,interpolate:nv,interpolateArray:$Xt,interpolateBasis:kLe,interpolateBasisClosed:ELe,interpolateDate:ILe,interpolateDiscrete:SXt,interpolateHue:kXt,interpolateNumber:xc,interpolateNumberArray:Yse,interpolateObject:MLe,interpolateRound:yM,interpolateString:FLe,interpolateTransformCss:TXt,interpolateTransformSvg:DXt,interpolateZoom:FXt,interpolateRgb:CK,interpolateRgbBasis:xXt,interpolateRgbBasisClosed:wXt,interpolateHsl:OXt,interpolateHslLong:RXt,interpolateLab:PXt,interpolateHcl:LXt,interpolateHclLong:BXt,interpolateCubehelix:zXt,interpolateCubehelixLong:UXt,piecewise:Xse,quantize:WXt},Symbol.toStringTag,{value:"Module"}));function zLe(e){me.call(this,null,e)}Ne(zLe,me,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,s=e.scale,a=e.count==null?e.values?e.values.length:10:e.count,o=hse(s,a,e.minstep),l=e.format||Z5e(n,s,o,e.formatSpecifier,e.formatType,!!e.values),u=e.values?K5e(s,e.values,o):dse(s,o);return i&&(r.rem=i),i=u.map((c,f)=>Tn({index:f/(u.length-1||1),value:c,label:l(c)})),e.extra&&i.length&&i.push(Tn({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function ULe(e){me.call(this,null,e)}function jXt(){return Tn({})}function HXt(e){const t=KI().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}Ne(ULe,me,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||jXt,s=e.key||nt,a=this.value;return at(r.encode)&&(r.encode=null),a&&(e.modified("key")||t.modified(s))&&$e("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=HXt(s)),t.visit(t.ADD,o=>{const l=s(o);let u=a.get(l);u?u.exit?(a.empty--,r.add.push(u)):r.mod.push(u):(u=i(o),a.set(l,u),r.add.push(u)),u.datum=o,u.exit=!1}),t.visit(t.MOD,o=>{const l=s(o),u=a.get(l);u&&(u.datum=o,r.mod.push(u))}),t.visit(t.REM,o=>{const l=s(o),u=a.get(l);o===u.datum&&!u.exit&&(r.rem.push(u),u.exit=!0,++a.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}});function WLe(e){me.call(this,null,e)}Ne(WLe,me,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,s=t.encode;if(at(s))if(n.changed()||s.every(f=>i[f]))s=s[0],n.encode=null;else return t.StopPropagation;var a=s==="enter",o=i.update||Tv,l=i.enter||Tv,u=i.exit||Tv,c=(s&&!a?i[s]:o)||Tv;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{l(f,e),o(f,e)}),n.modifies(l.output),n.modifies(o.output),c!==Tv&&c!==o&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&u!==Tv&&(t.visit(t.REM,f=>{u(f,e)}),n.modifies(u.output)),a||c!==Tv){const f=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(f,h=>{const d=l(h,e)||r;(c(h,e)||d)&&n.mod.push(h)}),n.mod.length&&n.modifies(l.output)):t.visit(f,h=>{(c(h,e)||r)&&n.mod.push(h)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function VLe(e){me.call(this,[],e)}Ne(VLe,me,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,s=e.type||f4,a=e.scale,o=+e.limit,l=hse(a,e.count==null?5:e.count,e.minstep),u=!!e.values||s===f4,c=e.format||tPe(n,a,l,s,e.formatSpecifier,e.formatType,u),f=e.values||ePe(a,l),h,d,p,g,m;return i&&(r.rem=i),s===f4?(o&&f.length>o?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,o-1),m=!0):i=f,Ut(p=e.size)?(!e.values&&a(i[0])===0&&(i=i.slice(1)),g=i.reduce((v,y)=>Math.max(v,p(y,e)),0)):p=vo(g=p||8),i=i.map((v,y)=>Tn({index:y,label:c(v,y,i),value:v,offset:g,size:p(v,e)})),m&&(m=f[i.length],i.push(Tn({index:i.length,label:"\u2026".concat(f.length-i.length," entries"),value:m,offset:g,size:p(m,e)})))):s===EHt?(h=a.domain(),d=H5e(a,h[0],un(h)),f.length<3&&!e.values&&h[0]!==un(h)&&(f=[h[0],un(h)]),i=f.map((v,y)=>Tn({index:y,label:c(v,y,f),value:v,perc:d(v)}))):(p=f.length-1,d=LHt(a),i=f.map((v,y)=>Tn({index:y,label:c(v,y,f),value:v,perc:y?d(v):0,perc2:y===p?1:d(f[y+1])}))),r.source=i,r.add=i,this.value=i,r}});const qXt=e=>e.source.x,GXt=e=>e.source.y,YXt=e=>e.target.x,XXt=e=>e.target.y;function Kse(e){me.call(this,{},e)}Kse.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};Ne(Kse,me,{transform(e,t){var n=e.sourceX||qXt,r=e.sourceY||GXt,i=e.targetX||YXt,s=e.targetY||XXt,a=e.as||"path",o=e.orient||"vertical",l=e.shape||"line",u=U1e.get(l+"-"+o)||U1e.get(l);return u||$e("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[a]=u(n(c),r(c),i(c),s(c))}),t.reflow(e.modified()).modifies(a)}});const jLe=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,KXt=(e,t,n,r)=>jLe(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),HLe=(e,t,n,r)=>{var i=n-e,s=r-t,a=Math.sqrt(i*i+s*s)/2,o=180*Math.atan2(s,i)/Math.PI;return"M"+e+","+t+"A"+a+","+a+" "+o+" 0 1 "+n+","+r},ZXt=(e,t,n,r)=>HLe(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),qLe=(e,t,n,r)=>{const i=n-e,s=r-t,a=.2*(i+s),o=.2*(s-i);return"M"+e+","+t+"C"+(e+a)+","+(t+o)+" "+(n+o)+","+(r-a)+" "+n+","+r},QXt=(e,t,n,r)=>qLe(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),JXt=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,eKt=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,tKt=(e,t,n,r)=>{const i=Math.cos(e),s=Math.sin(e),a=Math.cos(n),o=Math.sin(n),l=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*s+"A"+t+","+t+" 0 0,"+(l?1:0)+" "+t*a+","+t*o+"L"+r*a+","+r*o},nKt=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},rKt=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},iKt=(e,t,n,r)=>{const i=Math.cos(e),s=Math.sin(e),a=Math.cos(n),o=Math.sin(n),l=(t+r)/2;return"M"+t*i+","+t*s+"C"+l*i+","+l*s+" "+l*a+","+l*o+" "+r*a+","+r*o},U1e=KI({line:jLe,"line-radial":KXt,arc:HLe,"arc-radial":ZXt,curve:qLe,"curve-radial":QXt,"orthogonal-horizontal":JXt,"orthogonal-vertical":eKt,"orthogonal-radial":tKt,"diagonal-horizontal":nKt,"diagonal-vertical":rKt,"diagonal-radial":iKt});function Zse(e){me.call(this,null,e)}Zse.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};Ne(Zse,me,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],s=e.field||XI,a=e.startAngle||0,o=e.endAngle!=null?e.endAngle:2*Math.PI,l=t.source,u=l.map(s),c=u.length,f=a,h=(o-a)/BRe(u),d=Ml(c),p,g,m;for(e.sort&&d.sort((v,y)=>u[v]-u[y]),p=0;p<c;++p)m=u[d[p]],g=l[d[p]],g[r]=f,g[i]=f+=m*h;return this.value=u,t.reflow(e.modified()).modifies(n)}});const sKt=5;function aKt(e){const t=e.type;return!e.bins&&(t===i$||t===lM||t===uM)}function GLe(e){return cse(e)&&e!==fh}const oKt=Rh(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function YLe(e){me.call(this,null,e),this.modified(!0)}Ne(YLe,me,{transform(e,t){var n=t.dataflow,r=this.value,i=lKt(e);(!r||i!==r.type)&&(this.value=r=Dn(i)());for(i in e)if(!oKt[i]){if(i==="padding"&&GLe(r.type))continue;Ut(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return pKt(r,e,dKt(r,e,cKt(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function lKt(e){var t=e.type,n="",r;return t===fh?fh+"-"+i$:(uKt(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?fh+"-":r===3?q_+"-":""),(n+t||i$).toLowerCase())}function uKt(e){const t=e.type;return cse(t)&&t!==Xy&&t!==Ky&&(e.scheme||e.range&&e.range.length&&e.range.every($r))}function cKt(e,t,n){const r=fKt(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,s=e.type,a=t.zero||t.zero===void 0&&aKt(e),o,l;if(!i)return 0;if(GLe(s)&&t.padding&&i[0]!==un(i)&&(i=hKt(s,i,t.range,t.padding,t.exponent,t.constant)),(a||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(o=(i=i.slice()).length-1||1,a&&(i[0]>0&&(i[0]=0),i[o]<0&&(i[o]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[o]=t.domainMax),t.domainMid!=null)){l=t.domainMid;const u=l>i[o]?o+1:l<i[0]?0:o;u!==o&&n.warn("Scale domainMid exceeds domain min or max.",l),i.splice(u,0,l)}return e.domain(XLe(s,i,n)),s===ase&&e.unknown(t.domainImplicit?YX:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&hse(e,t.nice)||null),i.length}function fKt(e,t,n){return t?(e.domain(XLe(e.type,t,n)),t.length):-1}function hKt(e,t,n,r,i,s){var a=Math.abs(un(n)-n[0]),o=a/(a-2*r),l=e===Wp?iOe(t,null,o):e===uM?bX(t,null,o,.5):e===lM?bX(t,null,o,i||1):e===C9?sOe(t,null,o,s||1):rOe(t,null,o);return t=t.slice(),t[0]=l[0],t[t.length-1]=l[1],t}function XLe(e,t,n){if(W5e(e)){var r=Math.abs(t.reduce((i,s)=>i+(s<0?-1:s>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+ot(t))}return t}function dKt(e,t,n){let r=t.bins;if(r&&!at(r)){const i=e.domain(),s=i[0],a=un(i),o=r.step;let l=r.start==null?s:r.start,u=r.stop==null?a:r.stop;o||$e("Scale bins parameter missing step property."),l<s&&(l=o*Math.ceil(s/o)),u>a&&(u=o*Math.floor(a/o)),r=Ml(l,u+o/2,o)}return r?e.bins=r:e.bins&&delete e.bins,e.type===ose&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function pKt(e,t,n){var r=e.type,i=t.round||!1,s=t.range;if(t.rangeStep!=null)s=gKt(r,t,n);else if(t.scheme&&(s=mKt(r,t,n),Ut(s))){if(e.interpolator)return e.interpolator(s);$e("Scale type ".concat(r," does not support interpolating color schemes."))}if(s&&V5e(r))return e.interpolator(fse(kK(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(q5e(t.interpolate,t.interpolateGamma)):Ut(e.round)?e.round(i):Ut(e.rangeRound)&&e.interpolate(i?yM:nv),s&&e.range(kK(s,t.reverse))}function gKt(e,t,n){e!==R5e&&e!==aK&&$e("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===aK?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*sse(n,i,r)]}function mKt(e,t,n){var r=t.schemeExtent,i,s;return at(t.scheme)?s=fse(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),s=X5e(i),s||$e("Unrecognized scheme name: ".concat(t.scheme))),n=e===S9?n+1:e===ose?n-1:e===s$||e===_9?+t.schemeCount||sKt:n,V5e(e)?W1e(s,r,t.reverse):Ut(s)?$Ht(W1e(s,r),n):e===ase?s:s.slice(0,n)}function W1e(e,t,n){return Ut(e)&&(t||n)?wHt(e,kK(t||[0,1],n)):e}function kK(e,t){return t?e.slice().reverse():e}function KLe(e){me.call(this,null,e)}Ne(KLe,me,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(ix(e.sort)),this.modified(n),t}});const V1e="zero",ZLe="center",QLe="normalize",JLe=["y0","y1"];function Qse(e){me.call(this,null,e)}Qse.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:V1e,values:[V1e,ZLe,QLe]},{name:"as",type:"string",array:!0,length:2,default:JLe}]};Ne(Qse,me,{transform(e,t){var n=e.as||JLe,r=n[0],i=n[1],s=ix(e.sort),a=e.field||XI,o=e.offset===ZLe?vKt:e.offset===QLe?yKt:bKt,l,u,c,f;for(l=xKt(t.source,e.groupby,s,a),u=0,c=l.length,f=l.max;u<c;++u)o(l[u],f,a,r,i);return t.reflow(e.modified()).modifies(n)}});function vKt(e,t,n,r,i){for(var s=(t-e.sum)/2,a=e.length,o=0,l;o<a;++o)l=e[o],l[r]=s,l[i]=s+=Math.abs(n(l))}function yKt(e,t,n,r,i){for(var s=1/e.sum,a=0,o=e.length,l=0,u=0,c;l<o;++l)c=e[l],c[r]=a,c[i]=a=s*(u+=Math.abs(n(c)))}function bKt(e,t,n,r,i){for(var s=0,a=0,o=e.length,l=0,u,c;l<o;++l)c=e[l],u=+n(c),u<0?(c[r]=a,c[i]=a+=u):(c[r]=s,c[i]=s+=u)}function xKt(e,t,n,r){var i=[],s=g=>g(c),a,o,l,u,c,f,h,d,p;if(t==null)i.push(e.slice());else for(a={},o=0,l=e.length;o<l;++o)c=e[o],f=t.map(s),h=a[f],h||(a[f]=h=[],i.push(h)),h.push(c);for(f=0,p=0,u=i.length;f<u;++f){for(h=i[f],o=0,d=0,l=h.length;o<l;++o)d+=Math.abs(r(h[o]));h.sum=d,d>p&&(p=d),n&&h.sort(n)}return i.max=p,i}const wKt=Object.freeze(Object.defineProperty({__proto__:null,axisticks:zLe,datajoin:ULe,encode:WLe,legendentries:VLe,linkpath:Kse,pie:Zse,scale:YLe,sortitems:KLe,stack:Qse},Symbol.toStringTag,{value:"Module"}));class eb{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],a=t+s,o=Math.abs(t)<Math.abs(s)?t-(a-s):s-(a-t);o&&(n[r++]=o),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,s=i-(a-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=a+i,i==r-a&&(a=r))}return a}}function*$Kt(e){for(const t of e)yield*t}function e6e(e){return Array.from($Kt(e))}var It=1e-6,t6e=1e-12,Yt=Math.PI,Gr=Yt/2,j1e=Yt/4,Xl=Yt*2,oa=180/Yt,Pr=Yt/180,Pn=Math.abs,X_=Math.atan,Vp=Math.atan2,Lt=Math.cos,n6e=Math.exp,WP=Math.log,SH=Math.pow,Dt=Math.sin,xu=Math.sign||function(e){return e>0?1:e<0?-1:0},ul=Math.sqrt,Jse=Math.tan;function r6e(e){return e>1?0:e<-1?Yt:Math.acos(e)}function zu(e){return e>1?Gr:e<-1?-Gr:Math.asin(e)}function wu(){}function VP(e,t){e&&q1e.hasOwnProperty(e.type)&&q1e[e.type](e,t)}var H1e={Feature:function(e,t){VP(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)VP(n[r].geometry,t)}},q1e={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){EK(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)EK(n[r],t,0)},Polygon:function(e,t){G1e(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)G1e(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)VP(n[r],t)}};function EK(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function G1e(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)EK(e[n],t,1);t.polygonEnd()}function _2(e,t){e&&H1e.hasOwnProperty(e.type)?H1e[e.type](e,t):VP(e,t)}function AK(e){return[Vp(e[1],e[0]),zu(e[2])]}function h$(e){var t=e[0],n=e[1],r=Lt(n);return[r*Lt(t),r*Dt(t),Dt(n)]}function VO(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function jP(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function kH(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function jO(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function TK(e){var t=ul(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function DK(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function NK(e,t){return Pn(e)>Yt&&(e-=Math.round(e/Xl)*Xl),[e,t]}NK.invert=NK;function i6e(e,t,n){return(e%=Xl)?t||n?DK(X1e(e),K1e(t,n)):X1e(e):t||n?K1e(t,n):NK}function Y1e(e){return function(t,n){return t+=e,Pn(t)>Yt&&(t-=Math.round(t/Xl)*Xl),[t,n]}}function X1e(e){var t=Y1e(e);return t.invert=Y1e(-e),t}function K1e(e,t){var n=Lt(e),r=Dt(e),i=Lt(t),s=Dt(t);function a(o,l){var u=Lt(l),c=Lt(o)*u,f=Dt(o)*u,h=Dt(l),d=h*n+c*r;return[Vp(f*i-d*s,c*n-h*r),zu(d*i+f*s)]}return a.invert=function(o,l){var u=Lt(l),c=Lt(o)*u,f=Dt(o)*u,h=Dt(l),d=h*i-f*s;return[Vp(f*i+h*s,c*n+d*r),zu(d*n-c*r)]},a}function CKt(e){e=i6e(e[0]*Pr,e[1]*Pr,e.length>2?e[2]*Pr:0);function t(n){return n=e(n[0]*Pr,n[1]*Pr),n[0]*=oa,n[1]*=oa,n}return t.invert=function(n){return n=e.invert(n[0]*Pr,n[1]*Pr),n[0]*=oa,n[1]*=oa,n},t}function _Kt(e,t,n,r,i,s){if(!!n){var a=Lt(t),o=Dt(t),l=r*n;i==null?(i=t+r*Xl,s=t-l/2):(i=Z1e(a,i),s=Z1e(a,s),(r>0?i<s:i>s)&&(i+=r*Xl));for(var u,c=i;r>0?c>s:c<s;c-=l)u=AK([a,-o*Lt(c),-o*Dt(c)]),e.point(u[0],u[1])}}function Z1e(e,t){t=h$(t),t[0]-=e,TK(t);var n=r6e(-t[1]);return((-t[2]<0?-n:n)+Xl-It)%Xl}function s6e(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:wu,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function b4(e,t){return Pn(e[0]-t[0])<It&&Pn(e[1]-t[1])<It}function HO(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function a6e(e,t,n,r,i){var s=[],a=[],o,l;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],v=p[g],y;if(b4(m,v)){if(!m[2]&&!v[2]){for(i.lineStart(),o=0;o<g;++o)i.point((m=p[o])[0],m[1]);i.lineEnd();return}v[0]+=2*It}s.push(y=new HO(m,p,null,!0)),a.push(y.o=new HO(m,null,y,!1)),s.push(y=new HO(v,p,null,!1)),a.push(y.o=new HO(v,null,y,!0))}}),!!s.length){for(a.sort(t),Q1e(s),Q1e(a),o=0,l=a.length;o<l;++o)a[o].e=n=!n;for(var u=s[0],c,f;;){for(var h=u,d=!0;h.v;)if((h=h.n)===u)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,l=c.length;o<l;++o)i.point((f=c[o])[0],f[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(c=h.p.z,o=c.length-1;o>=0;--o)i.point((f=c[o])[0],f[1]);else r(h.x,h.p.x,-1,i);h=h.p}h=h.o,c=h.z,d=!d}while(!h.v);i.lineEnd()}}}function Q1e(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function EH(e){return Pn(e[0])<=Yt?e[0]:xu(e[0])*((Pn(e[0])+Yt)%Xl-Yt)}function SKt(e,t){var n=EH(t),r=t[1],i=Dt(r),s=[Dt(n),-Lt(n),0],a=0,o=0,l=new eb;i===1?r=Gr+It:i===-1&&(r=-Gr-It);for(var u=0,c=e.length;u<c;++u)if(!!(h=(f=e[u]).length))for(var f,h,d=f[h-1],p=EH(d),g=d[1]/2+j1e,m=Dt(g),v=Lt(g),y=0;y<h;++y,p=x,m=C,v=$,d=b){var b=f[y],x=EH(b),w=b[1]/2+j1e,C=Dt(w),$=Lt(w),_=x-p,k=_>=0?1:-1,E=k*_,S=E>Yt,N=m*C;if(l.add(Vp(N*k*Dt(E),v*$+N*Lt(E))),a+=S?_+k*Xl:_,S^p>=n^x>=n){var A=jP(h$(d),h$(b));TK(A);var D=jP(s,A);TK(D);var T=(S^_>=0?-1:1)*zu(D[2]);(r>T||r===T&&(A[0]||A[1]))&&(o+=S^_>=0?1:-1)}}return(a<-It||a<It&&l<-t6e)^o&1}function o6e(e,t,n,r){return function(i){var s=t(i),a=s6e(),o=t(a),l=!1,u,c,f,h={point:d,lineStart:g,lineEnd:m,polygonStart:function(){h.point=v,h.lineStart=y,h.lineEnd=b,c=[],u=[]},polygonEnd:function(){h.point=d,h.lineStart=g,h.lineEnd=m,c=e6e(c);var x=SKt(u,r);c.length?(l||(i.polygonStart(),l=!0),a6e(c,EKt,x,n,i)):x&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),c=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(x,w){e(x,w)&&i.point(x,w)}function p(x,w){s.point(x,w)}function g(){h.point=p,s.lineStart()}function m(){h.point=d,s.lineEnd()}function v(x,w){f.push([x,w]),o.point(x,w)}function y(){o.lineStart(),f=[]}function b(){v(f[0][0],f[0][1]),o.lineEnd();var x=o.clean(),w=a.result(),C,$=w.length,_,k,E;if(f.pop(),u.push(f),f=null,!!$){if(x&1){if(k=w[0],(_=k.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),C=0;C<_;++C)i.point((E=k[C])[0],E[1]);i.lineEnd()}return}$>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(kKt))}}return h}}function kKt(e){return e.length>1}function EKt(e,t){return((e=e.x)[0]<0?e[1]-Gr-It:Gr-e[1])-((t=t.x)[0]<0?t[1]-Gr-It:Gr-t[1])}const J1e=o6e(function(){return!0},AKt,DKt,[-Yt,-Gr]);function AKt(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,a){var o=s>0?Yt:-Yt,l=Pn(s-t);Pn(l-Yt)<It?(e.point(t,n=(n+a)/2>0?Gr:-Gr),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(s,n),i=0):r!==o&&l>=Yt&&(Pn(t-r)<It&&(t-=r*It),Pn(s-o)<It&&(s-=o*It),n=TKt(t,n,s,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),i=0),e.point(t=s,n=a),r=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function TKt(e,t,n,r){var i,s,a=Dt(e-n);return Pn(a)>It?X_((Dt(t)*(s=Lt(r))*Dt(n)-Dt(r)*(i=Lt(t))*Dt(e))/(i*s*a)):(t+r)/2}function DKt(e,t,n,r){var i;if(e==null)i=n*Gr,r.point(-Yt,i),r.point(0,i),r.point(Yt,i),r.point(Yt,0),r.point(Yt,-i),r.point(0,-i),r.point(-Yt,-i),r.point(-Yt,0),r.point(-Yt,i);else if(Pn(e[0]-t[0])>It){var s=e[0]<t[0]?Yt:-Yt;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function NKt(e){var t=Lt(e),n=6*Pr,r=t>0,i=Pn(t)>It;function s(c,f,h,d){_Kt(d,e,n,h,c,f)}function a(c,f){return Lt(c)*Lt(f)>t}function o(c){var f,h,d,p,g;return{lineStart:function(){p=d=!1,g=1},point:function(m,v){var y=[m,v],b,x=a(m,v),w=r?x?0:u(m,v):x?u(m+(m<0?Yt:-Yt),v):0;if(!f&&(p=d=x)&&c.lineStart(),x!==d&&(b=l(f,y),(!b||b4(f,b)||b4(y,b))&&(y[2]=1)),x!==d)g=0,x?(c.lineStart(),b=l(y,f),c.point(b[0],b[1])):(b=l(f,y),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var C;!(w&h)&&(C=l(y,f,!0))&&(g=0,r?(c.lineStart(),c.point(C[0][0],C[0][1]),c.point(C[1][0],C[1][1]),c.lineEnd()):(c.point(C[1][0],C[1][1]),c.lineEnd(),c.lineStart(),c.point(C[0][0],C[0][1],3)))}x&&(!f||!b4(f,y))&&c.point(y[0],y[1]),f=y,d=x,h=w},lineEnd:function(){d&&c.lineEnd(),f=null},clean:function(){return g|(p&&d)<<1}}}function l(c,f,h){var d=h$(c),p=h$(f),g=[1,0,0],m=jP(d,p),v=VO(m,m),y=m[0],b=v-y*y;if(!b)return!h&&c;var x=t*v/b,w=-t*y/b,C=jP(g,m),$=jO(g,x),_=jO(m,w);kH($,_);var k=C,E=VO($,k),S=VO(k,k),N=E*E-S*(VO($,$)-1);if(!(N<0)){var A=ul(N),D=jO(k,(-E-A)/S);if(kH(D,$),D=AK(D),!h)return D;var T=c[0],I=f[0],F=c[1],R=f[1],P;I<T&&(P=T,T=I,I=P);var V=I-T,z=Pn(V-Yt)<It,q=z||V<It;if(!z&&R<F&&(P=F,F=R,R=P),q?z?F+R>0^D[1]<(Pn(D[0]-T)<It?F:R):F<=D[1]&&D[1]<=R:V>Yt^(T<=D[0]&&D[0]<=I)){var G=jO(k,(-E+A)/S);return kH(G,$),[D,AK(G)]}}}function u(c,f){var h=r?e:Yt-e,d=0;return c<-h?d|=1:c>h&&(d|=2),f<-h?d|=4:f>h&&(d|=8),d}return o6e(a,o,s,r?[0,-e]:[-Yt,e-Yt])}function IKt(e,t,n,r,i,s){var a=e[0],o=e[1],l=t[0],u=t[1],c=0,f=1,h=l-a,d=u-o,p;if(p=n-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=i-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}if(p=r-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=s-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=a+c*h,e[1]=o+c*d),f<1&&(t[0]=a+f*h,t[1]=o+f*d),!0}}}}}var xE=1e9,qO=-xE;function l6e(e,t,n,r){function i(u,c){return e<=u&&u<=n&&t<=c&&c<=r}function s(u,c,f,h){var d=0,p=0;if(u==null||(d=a(u,f))!==(p=a(c,f))||l(u,c)<0^f>0)do h.point(d===0||d===3?e:n,d>1?r:t);while((d=(d+f+4)%4)!==p);else h.point(c[0],c[1])}function a(u,c){return Pn(u[0]-e)<It?c>0?0:3:Pn(u[0]-n)<It?c>0?2:1:Pn(u[1]-t)<It?c>0?1:0:c>0?3:2}function o(u,c){return l(u.x,c.x)}function l(u,c){var f=a(u,1),h=a(c,1);return f!==h?f-h:f===0?c[1]-u[1]:f===1?u[0]-c[0]:f===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,f=s6e(),h,d,p,g,m,v,y,b,x,w,C,$={point:_,lineStart:N,lineEnd:A,polygonStart:E,polygonEnd:S};function _(T,I){i(T,I)&&c.point(T,I)}function k(){for(var T=0,I=0,F=d.length;I<F;++I)for(var R=d[I],P=1,V=R.length,z=R[0],q,G,K=z[0],Y=z[1];P<V;++P)q=K,G=Y,z=R[P],K=z[0],Y=z[1],G<=r?Y>r&&(K-q)*(r-G)>(Y-G)*(e-q)&&++T:Y<=r&&(K-q)*(r-G)<(Y-G)*(e-q)&&--T;return T}function E(){c=f,h=[],d=[],C=!0}function S(){var T=k(),I=C&&T,F=(h=e6e(h)).length;(I||F)&&(u.polygonStart(),I&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),F&&a6e(h,o,T,s,u),u.polygonEnd()),c=u,h=d=p=null}function N(){$.point=D,d&&d.push(p=[]),w=!0,x=!1,y=b=NaN}function A(){h&&(D(g,m),v&&x&&f.rejoin(),h.push(f.result())),$.point=_,x&&c.lineEnd()}function D(T,I){var F=i(T,I);if(d&&p.push([T,I]),w)g=T,m=I,v=F,w=!1,F&&(c.lineStart(),c.point(T,I));else if(F&&x)c.point(T,I);else{var R=[y=Math.max(qO,Math.min(xE,y)),b=Math.max(qO,Math.min(xE,b))],P=[T=Math.max(qO,Math.min(xE,T)),I=Math.max(qO,Math.min(xE,I))];IKt(R,P,e,t,n,r)?(x||(c.lineStart(),c.point(R[0],R[1])),c.point(P[0],P[1]),F||c.lineEnd(),C=!1):F&&(c.lineStart(),c.point(T,I),C=!1)}y=T,b=I,x=F}return $}}const a3=e=>e;var AH=new eb,IK=new eb,u6e,c6e,MK,FK,qg={point:wu,lineStart:wu,lineEnd:wu,polygonStart:function(){qg.lineStart=MKt,qg.lineEnd=OKt},polygonEnd:function(){qg.lineStart=qg.lineEnd=qg.point=wu,AH.add(Pn(IK)),IK=new eb},result:function(){var e=AH/2;return AH=new eb,e}};function MKt(){qg.point=FKt}function FKt(e,t){qg.point=f6e,u6e=MK=e,c6e=FK=t}function f6e(e,t){IK.add(FK*e-MK*t),MK=e,FK=t}function OKt(){f6e(u6e,c6e)}const eye=qg;var d$=1/0,HP=d$,o3=-d$,qP=o3,RKt={point:PKt,lineStart:wu,lineEnd:wu,polygonStart:wu,polygonEnd:wu,result:function(){var e=[[d$,HP],[o3,qP]];return o3=qP=-(HP=d$=1/0),e}};function PKt(e,t){e<d$&&(d$=e),e>o3&&(o3=e),t<HP&&(HP=t),t>qP&&(qP=t)}const GP=RKt;var OK=0,RK=0,wE=0,YP=0,XP=0,F2=0,PK=0,LK=0,$E=0,h6e,d6e,Vf,jf,Ec={point:tb,lineStart:tye,lineEnd:nye,polygonStart:function(){Ec.lineStart=zKt,Ec.lineEnd=UKt},polygonEnd:function(){Ec.point=tb,Ec.lineStart=tye,Ec.lineEnd=nye},result:function(){var e=$E?[PK/$E,LK/$E]:F2?[YP/F2,XP/F2]:wE?[OK/wE,RK/wE]:[NaN,NaN];return OK=RK=wE=YP=XP=F2=PK=LK=$E=0,e}};function tb(e,t){OK+=e,RK+=t,++wE}function tye(){Ec.point=LKt}function LKt(e,t){Ec.point=BKt,tb(Vf=e,jf=t)}function BKt(e,t){var n=e-Vf,r=t-jf,i=ul(n*n+r*r);YP+=i*(Vf+e)/2,XP+=i*(jf+t)/2,F2+=i,tb(Vf=e,jf=t)}function nye(){Ec.point=tb}function zKt(){Ec.point=WKt}function UKt(){p6e(h6e,d6e)}function WKt(e,t){Ec.point=p6e,tb(h6e=Vf=e,d6e=jf=t)}function p6e(e,t){var n=e-Vf,r=t-jf,i=ul(n*n+r*r);YP+=i*(Vf+e)/2,XP+=i*(jf+t)/2,F2+=i,i=jf*e-Vf*t,PK+=i*(Vf+e),LK+=i*(jf+t),$E+=i*3,tb(Vf=e,jf=t)}const rye=Ec;function g6e(e){this._context=e}g6e.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Xl);break}}},result:wu};var BK=new eb,TH,m6e,v6e,CE,_E,KP={point:wu,lineStart:function(){KP.point=VKt},lineEnd:function(){TH&&y6e(m6e,v6e),KP.point=wu},polygonStart:function(){TH=!0},polygonEnd:function(){TH=null},result:function(){var e=+BK;return BK=new eb,e}};function VKt(e,t){KP.point=y6e,m6e=CE=e,v6e=_E=t}function y6e(e,t){CE-=e,_E-=t,BK.add(ul(CE*CE+_E*_E)),CE=e,_E=t}const iye=KP;let sye,ZP,aye,oye;class lye{constructor(t){this._append=t==null?b6e:jKt(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==aye||this._append!==ZP){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,aye=r,ZP=this._append,oye=this._,this._=i}this._+=oye;break}}}result(){const t=this._;return this._="",t.length?t:null}}function b6e(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function jKt(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return b6e;if(t!==sye){const n=10**t;sye=t,ZP=function(i){let s=1;this._+=i[0];for(const a=i.length;s<a;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return ZP}function x6e(e,t){let n=3,r=4.5,i,s;function a(o){return o&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),_2(o,i(s))),s.result()}return a.area=function(o){return _2(o,i(eye)),eye.result()},a.measure=function(o){return _2(o,i(iye)),iye.result()},a.bounds=function(o){return _2(o,i(GP)),GP.result()},a.centroid=function(o){return _2(o,i(rye)),rye.result()},a.projection=function(o){return arguments.length?(i=o==null?(e=null,a3):(e=o).stream,a):e},a.context=function(o){return arguments.length?(s=o==null?(t=null,new lye(n)):new g6e(t=o),typeof r!="function"&&s.pointRadius(r),a):t},a.pointRadius=function(o){return arguments.length?(r=typeof o=="function"?o:(s.pointRadius(+o),+o),a):r},a.digits=function(o){if(!arguments.length)return n;if(o==null)n=null;else{const l=Math.floor(o);if(!(l>=0))throw new RangeError(`invalid digits: ${o}`);n=l}return t===null&&(s=new lye(n)),a},a.projection(e).digits(n).context(t)}function B9(e){return function(t){var n=new zK;for(var r in e)n[r]=e[r];return n.stream=t,n}}function zK(){}zK.prototype={constructor:zK,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function eae(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),_2(n,e.stream(GP)),t(GP.result()),r!=null&&e.clipExtent(r),e}function z9(e,t,n){return eae(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),o=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(s-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,l])},n)}function tae(e,t,n){return z9(e,[[0,0],t],n)}function nae(e,t,n){return eae(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),a=(i-s*(r[1][0]+r[0][0]))/2,o=-s*r[0][1];e.scale(150*s).translate([a,o])},n)}function rae(e,t,n){return eae(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),a=-s*r[0][0],o=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,o])},n)}var uye=16,HKt=Lt(30*Pr);function cye(e,t){return+t?GKt(e,t):qKt(e)}function qKt(e){return B9({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function GKt(e,t){function n(r,i,s,a,o,l,u,c,f,h,d,p,g,m){var v=u-r,y=c-i,b=v*v+y*y;if(b>4*t&&g--){var x=a+h,w=o+d,C=l+p,$=ul(x*x+w*w+C*C),_=zu(C/=$),k=Pn(Pn(C)-1)<It||Pn(s-f)<It?(s+f)/2:Vp(w,x),E=e(k,_),S=E[0],N=E[1],A=S-r,D=N-i,T=y*A-v*D;(T*T/b>t||Pn((v*A+y*D)/b-.5)>.3||a*h+o*d+l*p<HKt)&&(n(r,i,s,a,o,l,S,N,k,x/=$,w/=$,C,g,m),m.point(S,N),n(S,N,k,x,w,C,u,c,f,h,d,p,g,m))}}return function(r){var i,s,a,o,l,u,c,f,h,d,p,g,m={point:v,lineStart:y,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=y}};function v(_,k){_=e(_,k),r.point(_[0],_[1])}function y(){f=NaN,m.point=b,r.lineStart()}function b(_,k){var E=h$([_,k]),S=e(_,k);n(f,h,c,d,p,g,f=S[0],h=S[1],c=_,d=E[0],p=E[1],g=E[2],uye,r),r.point(f,h)}function x(){m.point=v,r.lineEnd()}function w(){y(),m.point=C,m.lineEnd=$}function C(_,k){b(i=_,k),s=f,a=h,o=d,l=p,u=g,m.point=b}function $(){n(f,h,c,d,p,g,s,a,i,o,l,u,uye,r),m.lineEnd=x,x()}return m}}var YKt=B9({point:function(e,t){this.stream.point(e*Pr,t*Pr)}});function XKt(e){return B9({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function KKt(e,t,n,r,i){function s(a,o){return a*=r,o*=i,[t+e*a,n-e*o]}return s.invert=function(a,o){return[(a-t)/e*r,(n-o)/e*i]},s}function fye(e,t,n,r,i,s){if(!s)return KKt(e,t,n,r,i);var a=Lt(s),o=Dt(s),l=a*e,u=o*e,c=a/e,f=o/e,h=(o*n-a*t)/e,d=(o*t+a*n)/e;function p(g,m){return g*=r,m*=i,[l*g-u*m+t,n-u*g-l*m]}return p.invert=function(g,m){return[r*(c*g-f*m+h),i*(d-f*g-c*m)]},p}function fg(e){return w6e(function(){return e})()}function w6e(e){var t,n=150,r=480,i=250,s=0,a=0,o=0,l=0,u=0,c,f=0,h=1,d=1,p=null,g=J1e,m=null,v,y,b,x=a3,w=.5,C,$,_,k,E;function S(T){return _(T[0]*Pr,T[1]*Pr)}function N(T){return T=_.invert(T[0],T[1]),T&&[T[0]*oa,T[1]*oa]}S.stream=function(T){return k&&E===T?k:k=YKt(XKt(c)(g(C(x(E=T)))))},S.preclip=function(T){return arguments.length?(g=T,p=void 0,D()):g},S.postclip=function(T){return arguments.length?(x=T,m=v=y=b=null,D()):x},S.clipAngle=function(T){return arguments.length?(g=+T?NKt(p=T*Pr):(p=null,J1e),D()):p*oa},S.clipExtent=function(T){return arguments.length?(x=T==null?(m=v=y=b=null,a3):l6e(m=+T[0][0],v=+T[0][1],y=+T[1][0],b=+T[1][1]),D()):m==null?null:[[m,v],[y,b]]},S.scale=function(T){return arguments.length?(n=+T,A()):n},S.translate=function(T){return arguments.length?(r=+T[0],i=+T[1],A()):[r,i]},S.center=function(T){return arguments.length?(s=T[0]%360*Pr,a=T[1]%360*Pr,A()):[s*oa,a*oa]},S.rotate=function(T){return arguments.length?(o=T[0]%360*Pr,l=T[1]%360*Pr,u=T.length>2?T[2]%360*Pr:0,A()):[o*oa,l*oa,u*oa]},S.angle=function(T){return arguments.length?(f=T%360*Pr,A()):f*oa},S.reflectX=function(T){return arguments.length?(h=T?-1:1,A()):h<0},S.reflectY=function(T){return arguments.length?(d=T?-1:1,A()):d<0},S.precision=function(T){return arguments.length?(C=cye($,w=T*T),D()):ul(w)},S.fitExtent=function(T,I){return z9(S,T,I)},S.fitSize=function(T,I){return tae(S,T,I)},S.fitWidth=function(T,I){return nae(S,T,I)},S.fitHeight=function(T,I){return rae(S,T,I)};function A(){var T=fye(n,0,0,h,d,f).apply(null,t(s,a)),I=fye(n,r-T[0],i-T[1],h,d,f);return c=i6e(o,l,u),$=DK(t,I),_=DK(c,$),C=cye($,w),D()}function D(){return k=E=null,S}return function(){return t=e.apply(this,arguments),S.invert=t.invert&&N,A()}}function iae(e){var t=0,n=Yt/3,r=w6e(e),i=r(t,n);return i.parallels=function(s){return arguments.length?r(t=s[0]*Pr,n=s[1]*Pr):[t*oa,n*oa]},i}function ZKt(e){var t=Lt(e);function n(r,i){return[r*t,Dt(i)/t]}return n.invert=function(r,i){return[r/t,zu(i*t)]},n}function QKt(e,t){var n=Dt(e),r=(n+Dt(t))/2;if(Pn(r)<It)return ZKt(e);var i=1+n*(2*r-n),s=ul(i)/r;function a(o,l){var u=ul(i-2*r*Dt(l))/r;return[u*Dt(o*=r),s-u*Lt(o)]}return a.invert=function(o,l){var u=s-l,c=Vp(o,Pn(u))*xu(u);return u*r<0&&(c-=Yt*xu(o)*xu(u)),[c/r,zu((i-(o*o+u*u)*r*r)/(2*r))]},a}function QP(){return iae(QKt).scale(155.424).center([0,33.6442])}function $6e(){return QP().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function JKt(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function eZt(){var e,t,n=$6e(),r,i=QP().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,a=QP().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o,l,u={point:function(h,d){l=[h,d]}};function c(h){var d=h[0],p=h[1];return l=null,r.point(d,p),l||(s.point(d,p),l)||(o.point(d,p),l)}c.invert=function(h){var d=n.scale(),p=n.translate(),g=(h[0]-p[0])/d,m=(h[1]-p[1])/d;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?a:n).invert(h)},c.stream=function(h){return e&&t===h?e:e=JKt([n.stream(t=h),i.stream(h),a.stream(h)])},c.precision=function(h){return arguments.length?(n.precision(h),i.precision(h),a.precision(h),f()):n.precision()},c.scale=function(h){return arguments.length?(n.scale(h),i.scale(h*.35),a.scale(h),c.translate(n.translate())):n.scale()},c.translate=function(h){if(!arguments.length)return n.translate();var d=n.scale(),p=+h[0],g=+h[1];return r=n.translate(h).clipExtent([[p-.455*d,g-.238*d],[p+.455*d,g+.238*d]]).stream(u),s=i.translate([p-.307*d,g+.201*d]).clipExtent([[p-.425*d+It,g+.12*d+It],[p-.214*d-It,g+.234*d-It]]).stream(u),o=a.translate([p-.205*d,g+.212*d]).clipExtent([[p-.214*d+It,g+.166*d+It],[p-.115*d-It,g+.234*d-It]]).stream(u),f()},c.fitExtent=function(h,d){return z9(c,h,d)},c.fitSize=function(h,d){return tae(c,h,d)},c.fitWidth=function(h,d){return nae(c,h,d)},c.fitHeight=function(h,d){return rae(c,h,d)};function f(){return e=t=null,c}return c.scale(1070)}function C6e(e){return function(t,n){var r=Lt(t),i=Lt(n),s=e(r*i);return s===1/0?[2,0]:[s*i*Dt(t),s*Dt(n)]}}function bM(e){return function(t,n){var r=ul(t*t+n*n),i=e(r),s=Dt(i),a=Lt(i);return[Vp(t*s,r*a),zu(r&&n*s/r)]}}var _6e=C6e(function(e){return ul(2/(1+e))});_6e.invert=bM(function(e){return 2*zu(e/2)});function tZt(){return fg(_6e).scale(124.75).clipAngle(180-.001)}var S6e=C6e(function(e){return(e=r6e(e))&&e/Dt(e)});S6e.invert=bM(function(e){return e});function nZt(){return fg(S6e).scale(79.4188).clipAngle(180-.001)}function U9(e,t){return[e,WP(Jse((Gr+t)/2))]}U9.invert=function(e,t){return[e,2*X_(n6e(t))-Gr]};function rZt(){return k6e(U9).scale(961/Xl)}function k6e(e){var t=fg(e),n=t.center,r=t.scale,i=t.translate,s=t.clipExtent,a=null,o,l,u;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=o=l=u=null:(a=+f[0][0],o=+f[0][1],l=+f[1][0],u=+f[1][1]),c()):a==null?null:[[a,o],[l,u]]};function c(){var f=Yt*r(),h=t(CKt(t.rotate()).invert([0,0]));return s(a==null?[[h[0]-f,h[1]-f],[h[0]+f,h[1]+f]]:e===U9?[[Math.max(h[0]-f,a),o],[Math.min(h[0]+f,l),u]]:[[a,Math.max(h[1]-f,o)],[l,Math.min(h[1]+f,u)]])}return c()}function GO(e){return Jse((Gr+e)/2)}function iZt(e,t){var n=Lt(e),r=e===t?Dt(e):WP(n/Lt(t))/WP(GO(t)/GO(e)),i=n*SH(GO(e),r)/r;if(!r)return U9;function s(a,o){i>0?o<-Gr+It&&(o=-Gr+It):o>Gr-It&&(o=Gr-It);var l=i/SH(GO(o),r);return[l*Dt(r*a),i-l*Lt(r*a)]}return s.invert=function(a,o){var l=i-o,u=xu(r)*ul(a*a+l*l),c=Vp(a,Pn(l))*xu(l);return l*r<0&&(c-=Yt*xu(a)*xu(l)),[c/r,2*X_(SH(i/u,1/r))-Gr]},s}function sZt(){return iae(iZt).scale(109.5).parallels([30,30])}function JP(e,t){return[e,t]}JP.invert=JP;function aZt(){return fg(JP).scale(152.63)}function oZt(e,t){var n=Lt(e),r=e===t?Dt(e):(n-Lt(t))/(t-e),i=n/r+e;if(Pn(r)<It)return JP;function s(a,o){var l=i-o,u=r*a;return[l*Dt(u),i-l*Lt(u)]}return s.invert=function(a,o){var l=i-o,u=Vp(a,Pn(l))*xu(l);return l*r<0&&(u-=Yt*xu(a)*xu(l)),[u/r,i-xu(r)*ul(a*a+l*l)]},s}function lZt(){return iae(oZt).scale(131.154).center([0,13.9389])}var mA=1.340264,vA=-.081106,yA=893e-6,bA=.003796,eL=ul(3)/2,uZt=12;function E6e(e,t){var n=zu(eL*Dt(t)),r=n*n,i=r*r*r;return[e*Lt(n)/(eL*(mA+3*vA*r+i*(7*yA+9*bA*r))),n*(mA+vA*r+i*(yA+bA*r))]}E6e.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,s=0,a,o,l;s<uZt&&(o=n*(mA+vA*r+i*(yA+bA*r))-t,l=mA+3*vA*r+i*(7*yA+9*bA*r),n-=a=o/l,r=n*n,i=r*r*r,!(Pn(a)<t6e));++s);return[eL*e*(mA+3*vA*r+i*(7*yA+9*bA*r))/Lt(n),zu(Dt(n)/eL)]};function cZt(){return fg(E6e).scale(177.158)}function A6e(e,t){var n=Lt(t),r=Lt(e)*n;return[n*Dt(e)/r,Dt(t)/r]}A6e.invert=bM(X_);function fZt(){return fg(A6e).scale(144.049).clipAngle(60)}function hZt(){var e=1,t=0,n=0,r=1,i=1,s=0,a,o,l=null,u,c,f,h=1,d=1,p=B9({point:function(x,w){var C=b([x,w]);this.stream.point(C[0],C[1])}}),g=a3,m,v;function y(){return h=e*r,d=e*i,m=v=null,b}function b(x){var w=x[0]*h,C=x[1]*d;if(s){var $=C*a-w*o;w=w*a+C*o,C=$}return[w+t,C+n]}return b.invert=function(x){var w=x[0]-t,C=x[1]-n;if(s){var $=C*a+w*o;w=w*a-C*o,C=$}return[w/h,C/d]},b.stream=function(x){return m&&v===x?m:m=p(g(v=x))},b.postclip=function(x){return arguments.length?(g=x,l=u=c=f=null,y()):g},b.clipExtent=function(x){return arguments.length?(g=x==null?(l=u=c=f=null,a3):l6e(l=+x[0][0],u=+x[0][1],c=+x[1][0],f=+x[1][1]),y()):l==null?null:[[l,u],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,y()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],y()):[t,n]},b.angle=function(x){return arguments.length?(s=x%360*Pr,o=Dt(s),a=Lt(s),y()):s*oa},b.reflectX=function(x){return arguments.length?(r=x?-1:1,y()):r<0},b.reflectY=function(x){return arguments.length?(i=x?-1:1,y()):i<0},b.fitExtent=function(x,w){return z9(b,x,w)},b.fitSize=function(x,w){return tae(b,x,w)},b.fitWidth=function(x,w){return nae(b,x,w)},b.fitHeight=function(x,w){return rae(b,x,w)},b}function T6e(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}T6e.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,a=s*s;n-=i=(n*(1.007226+s*(.015085+a*(-.044475+.028874*s-.005916*a)))-t)/(1.007226+s*(.015085*3+a*(-.044475*7+.028874*9*s-.005916*11*a)))}while(Pn(i)>It&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function dZt(){return fg(T6e).scale(175.295)}function D6e(e,t){return[Lt(t)*Dt(e),Dt(t)]}D6e.invert=bM(zu);function pZt(){return fg(D6e).scale(249.5).clipAngle(90+It)}function N6e(e,t){var n=Lt(t),r=1+Lt(e)*n;return[n*Dt(e)/r,Dt(t)/r]}N6e.invert=bM(function(e){return 2*X_(e)});function gZt(){return fg(N6e).scale(250).clipAngle(142)}function I6e(e,t){return[WP(Jse((Gr+t)/2)),-e]}I6e.invert=function(e,t){return[-t,2*X_(n6e(e))-Gr]};function mZt(){var e=k6e(I6e),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}class vZt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],a=t+s,o=Math.abs(t)<Math.abs(s)?t-(a-s):s-(a-t);o&&(n[r++]=o),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,s=i-(a-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=a+i,i==r-a&&(a=r))}return a}}function*yZt(e){for(const t of e)yield*t}function M6e(e){return Array.from(yZt(e))}var ar=1e-6,bZt=1e-12,dn=Math.PI,$u=dn/2,hye=dn/4,nf=dn*2,Dd=180/dn,wl=dn/180,Kr=Math.abs,xZt=Math.atan,l3=Math.atan2,ii=Math.cos,si=Math.sin,wZt=Math.sign||function(e){return e>0?1:e<0?-1:0},W9=Math.sqrt;function $Zt(e){return e>1?0:e<-1?dn:Math.acos(e)}function u3(e){return e>1?$u:e<-1?-$u:Math.asin(e)}function SE(){}function tL(e,t){e&&pye.hasOwnProperty(e.type)&&pye[e.type](e,t)}var dye={Feature:function(e,t){tL(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)tL(n[r].geometry,t)}},pye={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){UK(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)UK(n[r],t,0)},Polygon:function(e,t){gye(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)gye(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)tL(n[r],t)}};function UK(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function gye(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)UK(e[n],t,1);t.polygonEnd()}function CZt(e,t){e&&dye.hasOwnProperty(e.type)?dye[e.type](e,t):tL(e,t)}function WK(e){return[l3(e[1],e[0]),u3(e[2])]}function p$(e){var t=e[0],n=e[1],r=ii(n);return[r*ii(t),r*si(t),si(n)]}function YO(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function nL(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function DH(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function XO(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function VK(e){var t=W9(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function jK(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function HK(e,t){return Kr(e)>dn&&(e-=Math.round(e/nf)*nf),[e,t]}HK.invert=HK;function _Zt(e,t,n){return(e%=nf)?t||n?jK(vye(e),yye(t,n)):vye(e):t||n?yye(t,n):HK}function mye(e){return function(t,n){return t+=e,Kr(t)>dn&&(t-=Math.round(t/nf)*nf),[t,n]}}function vye(e){var t=mye(e);return t.invert=mye(-e),t}function yye(e,t){var n=ii(e),r=si(e),i=ii(t),s=si(t);function a(o,l){var u=ii(l),c=ii(o)*u,f=si(o)*u,h=si(l),d=h*n+c*r;return[l3(f*i-d*s,c*n-h*r),u3(d*i+f*s)]}return a.invert=function(o,l){var u=ii(l),c=ii(o)*u,f=si(o)*u,h=si(l),d=h*i-f*s;return[l3(f*i+h*s,c*n+d*r),u3(d*n-c*r)]},a}function SZt(e,t,n,r,i,s){if(!!n){var a=ii(t),o=si(t),l=r*n;i==null?(i=t+r*nf,s=t-l/2):(i=bye(a,i),s=bye(a,s),(r>0?i<s:i>s)&&(i+=r*nf));for(var u,c=i;r>0?c>s:c<s;c-=l)u=WK([a,-o*ii(c),-o*si(c)]),e.point(u[0],u[1])}}function bye(e,t){t=p$(t),t[0]-=e,VK(t);var n=$Zt(-t[1]);return((-t[2]<0?-n:n)+nf-ar)%nf}function F6e(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:SE,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function x4(e,t){return Kr(e[0]-t[0])<ar&&Kr(e[1]-t[1])<ar}function KO(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function O6e(e,t,n,r,i){var s=[],a=[],o,l;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],v=p[g],y;if(x4(m,v)){if(!m[2]&&!v[2]){for(i.lineStart(),o=0;o<g;++o)i.point((m=p[o])[0],m[1]);i.lineEnd();return}v[0]+=2*ar}s.push(y=new KO(m,p,null,!0)),a.push(y.o=new KO(m,null,y,!1)),s.push(y=new KO(v,p,null,!1)),a.push(y.o=new KO(v,null,y,!0))}}),!!s.length){for(a.sort(t),xye(s),xye(a),o=0,l=a.length;o<l;++o)a[o].e=n=!n;for(var u=s[0],c,f;;){for(var h=u,d=!0;h.v;)if((h=h.n)===u)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,l=c.length;o<l;++o)i.point((f=c[o])[0],f[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(c=h.p.z,o=c.length-1;o>=0;--o)i.point((f=c[o])[0],f[1]);else r(h.x,h.p.x,-1,i);h=h.p}h=h.o,c=h.z,d=!d}while(!h.v);i.lineEnd()}}}function xye(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function NH(e){return Kr(e[0])<=dn?e[0]:wZt(e[0])*((Kr(e[0])+dn)%nf-dn)}function kZt(e,t){var n=NH(t),r=t[1],i=si(r),s=[si(n),-ii(n),0],a=0,o=0,l=new vZt;i===1?r=$u+ar:i===-1&&(r=-$u-ar);for(var u=0,c=e.length;u<c;++u)if(!!(h=(f=e[u]).length))for(var f,h,d=f[h-1],p=NH(d),g=d[1]/2+hye,m=si(g),v=ii(g),y=0;y<h;++y,p=x,m=C,v=$,d=b){var b=f[y],x=NH(b),w=b[1]/2+hye,C=si(w),$=ii(w),_=x-p,k=_>=0?1:-1,E=k*_,S=E>dn,N=m*C;if(l.add(l3(N*k*si(E),v*$+N*ii(E))),a+=S?_+k*nf:_,S^p>=n^x>=n){var A=nL(p$(d),p$(b));VK(A);var D=nL(s,A);VK(D);var T=(S^_>=0?-1:1)*u3(D[2]);(r>T||r===T&&(A[0]||A[1]))&&(o+=S^_>=0?1:-1)}}return(a<-ar||a<ar&&l<-bZt)^o&1}function R6e(e,t,n,r){return function(i){var s=t(i),a=F6e(),o=t(a),l=!1,u,c,f,h={point:d,lineStart:g,lineEnd:m,polygonStart:function(){h.point=v,h.lineStart=y,h.lineEnd=b,c=[],u=[]},polygonEnd:function(){h.point=d,h.lineStart=g,h.lineEnd=m,c=M6e(c);var x=kZt(u,r);c.length?(l||(i.polygonStart(),l=!0),O6e(c,AZt,x,n,i)):x&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),c=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(x,w){e(x,w)&&i.point(x,w)}function p(x,w){s.point(x,w)}function g(){h.point=p,s.lineStart()}function m(){h.point=d,s.lineEnd()}function v(x,w){f.push([x,w]),o.point(x,w)}function y(){o.lineStart(),f=[]}function b(){v(f[0][0],f[0][1]),o.lineEnd();var x=o.clean(),w=a.result(),C,$=w.length,_,k,E;if(f.pop(),u.push(f),f=null,!!$){if(x&1){if(k=w[0],(_=k.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),C=0;C<_;++C)i.point((E=k[C])[0],E[1]);i.lineEnd()}return}$>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(EZt))}}return h}}function EZt(e){return e.length>1}function AZt(e,t){return((e=e.x)[0]<0?e[1]-$u-ar:$u-e[1])-((t=t.x)[0]<0?t[1]-$u-ar:$u-t[1])}const wye=R6e(function(){return!0},TZt,NZt,[-dn,-$u]);function TZt(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,a){var o=s>0?dn:-dn,l=Kr(s-t);Kr(l-dn)<ar?(e.point(t,n=(n+a)/2>0?$u:-$u),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(s,n),i=0):r!==o&&l>=dn&&(Kr(t-r)<ar&&(t-=r*ar),Kr(s-o)<ar&&(s-=o*ar),n=DZt(t,n,s,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),i=0),e.point(t=s,n=a),r=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function DZt(e,t,n,r){var i,s,a=si(e-n);return Kr(a)>ar?xZt((si(t)*(s=ii(r))*si(n)-si(r)*(i=ii(t))*si(e))/(i*s*a)):(t+r)/2}function NZt(e,t,n,r){var i;if(e==null)i=n*$u,r.point(-dn,i),r.point(0,i),r.point(dn,i),r.point(dn,0),r.point(dn,-i),r.point(0,-i),r.point(-dn,-i),r.point(-dn,0),r.point(-dn,i);else if(Kr(e[0]-t[0])>ar){var s=e[0]<t[0]?dn:-dn;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function IZt(e){var t=ii(e),n=6*wl,r=t>0,i=Kr(t)>ar;function s(c,f,h,d){SZt(d,e,n,h,c,f)}function a(c,f){return ii(c)*ii(f)>t}function o(c){var f,h,d,p,g;return{lineStart:function(){p=d=!1,g=1},point:function(m,v){var y=[m,v],b,x=a(m,v),w=r?x?0:u(m,v):x?u(m+(m<0?dn:-dn),v):0;if(!f&&(p=d=x)&&c.lineStart(),x!==d&&(b=l(f,y),(!b||x4(f,b)||x4(y,b))&&(y[2]=1)),x!==d)g=0,x?(c.lineStart(),b=l(y,f),c.point(b[0],b[1])):(b=l(f,y),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var C;!(w&h)&&(C=l(y,f,!0))&&(g=0,r?(c.lineStart(),c.point(C[0][0],C[0][1]),c.point(C[1][0],C[1][1]),c.lineEnd()):(c.point(C[1][0],C[1][1]),c.lineEnd(),c.lineStart(),c.point(C[0][0],C[0][1],3)))}x&&(!f||!x4(f,y))&&c.point(y[0],y[1]),f=y,d=x,h=w},lineEnd:function(){d&&c.lineEnd(),f=null},clean:function(){return g|(p&&d)<<1}}}function l(c,f,h){var d=p$(c),p=p$(f),g=[1,0,0],m=nL(d,p),v=YO(m,m),y=m[0],b=v-y*y;if(!b)return!h&&c;var x=t*v/b,w=-t*y/b,C=nL(g,m),$=XO(g,x),_=XO(m,w);DH($,_);var k=C,E=YO($,k),S=YO(k,k),N=E*E-S*(YO($,$)-1);if(!(N<0)){var A=W9(N),D=XO(k,(-E-A)/S);if(DH(D,$),D=WK(D),!h)return D;var T=c[0],I=f[0],F=c[1],R=f[1],P;I<T&&(P=T,T=I,I=P);var V=I-T,z=Kr(V-dn)<ar,q=z||V<ar;if(!z&&R<F&&(P=F,F=R,R=P),q?z?F+R>0^D[1]<(Kr(D[0]-T)<ar?F:R):F<=D[1]&&D[1]<=R:V>dn^(T<=D[0]&&D[0]<=I)){var G=XO(k,(-E+A)/S);return DH(G,$),[D,WK(G)]}}}function u(c,f){var h=r?e:dn-e,d=0;return c<-h?d|=1:c>h&&(d|=2),f<-h?d|=4:f>h&&(d|=8),d}return R6e(a,o,s,r?[0,-e]:[-dn,e-dn])}function MZt(e,t,n,r,i,s){var a=e[0],o=e[1],l=t[0],u=t[1],c=0,f=1,h=l-a,d=u-o,p;if(p=n-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=i-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}if(p=r-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=s-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=a+c*h,e[1]=o+c*d),f<1&&(t[0]=a+f*h,t[1]=o+f*d),!0}}}}}var kE=1e9,ZO=-kE;function FZt(e,t,n,r){function i(u,c){return e<=u&&u<=n&&t<=c&&c<=r}function s(u,c,f,h){var d=0,p=0;if(u==null||(d=a(u,f))!==(p=a(c,f))||l(u,c)<0^f>0)do h.point(d===0||d===3?e:n,d>1?r:t);while((d=(d+f+4)%4)!==p);else h.point(c[0],c[1])}function a(u,c){return Kr(u[0]-e)<ar?c>0?0:3:Kr(u[0]-n)<ar?c>0?2:1:Kr(u[1]-t)<ar?c>0?1:0:c>0?3:2}function o(u,c){return l(u.x,c.x)}function l(u,c){var f=a(u,1),h=a(c,1);return f!==h?f-h:f===0?c[1]-u[1]:f===1?u[0]-c[0]:f===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,f=F6e(),h,d,p,g,m,v,y,b,x,w,C,$={point:_,lineStart:N,lineEnd:A,polygonStart:E,polygonEnd:S};function _(T,I){i(T,I)&&c.point(T,I)}function k(){for(var T=0,I=0,F=d.length;I<F;++I)for(var R=d[I],P=1,V=R.length,z=R[0],q,G,K=z[0],Y=z[1];P<V;++P)q=K,G=Y,z=R[P],K=z[0],Y=z[1],G<=r?Y>r&&(K-q)*(r-G)>(Y-G)*(e-q)&&++T:Y<=r&&(K-q)*(r-G)<(Y-G)*(e-q)&&--T;return T}function E(){c=f,h=[],d=[],C=!0}function S(){var T=k(),I=C&&T,F=(h=M6e(h)).length;(I||F)&&(u.polygonStart(),I&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),F&&O6e(h,o,T,s,u),u.polygonEnd()),c=u,h=d=p=null}function N(){$.point=D,d&&d.push(p=[]),w=!0,x=!1,y=b=NaN}function A(){h&&(D(g,m),v&&x&&f.rejoin(),h.push(f.result())),$.point=_,x&&c.lineEnd()}function D(T,I){var F=i(T,I);if(d&&p.push([T,I]),w)g=T,m=I,v=F,w=!1,F&&(c.lineStart(),c.point(T,I));else if(F&&x)c.point(T,I);else{var R=[y=Math.max(ZO,Math.min(kE,y)),b=Math.max(ZO,Math.min(kE,b))],P=[T=Math.max(ZO,Math.min(kE,T)),I=Math.max(ZO,Math.min(kE,I))];MZt(R,P,e,t,n,r)?(x||(c.lineStart(),c.point(R[0],R[1])),c.point(P[0],P[1]),F||c.lineEnd(),C=!1):F&&(c.lineStart(),c.point(T,I),C=!1)}y=T,b=I,x=F}return $}}const $ye=e=>e;var g$=1/0,rL=g$,c3=-g$,iL=c3,OZt={point:RZt,lineStart:SE,lineEnd:SE,polygonStart:SE,polygonEnd:SE,result:function(){var e=[[g$,rL],[c3,iL]];return c3=iL=-(rL=g$=1/0),e}};function RZt(e,t){e<g$&&(g$=e),e>c3&&(c3=e),t<rL&&(rL=t),t>iL&&(iL=t)}const Cye=OZt;function sae(e){return function(t){var n=new qK;for(var r in e)n[r]=e[r];return n.stream=t,n}}function qK(){}qK.prototype={constructor:qK,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function aae(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),CZt(n,e.stream(Cye)),t(Cye.result()),r!=null&&e.clipExtent(r),e}function P6e(e,t,n){return aae(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),o=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(s-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,l])},n)}function PZt(e,t,n){return P6e(e,[[0,0],t],n)}function LZt(e,t,n){return aae(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),a=(i-s*(r[1][0]+r[0][0]))/2,o=-s*r[0][1];e.scale(150*s).translate([a,o])},n)}function BZt(e,t,n){return aae(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),a=-s*r[0][0],o=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,o])},n)}var _ye=16,zZt=ii(30*wl);function Sye(e,t){return+t?WZt(e,t):UZt(e)}function UZt(e){return sae({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function WZt(e,t){function n(r,i,s,a,o,l,u,c,f,h,d,p,g,m){var v=u-r,y=c-i,b=v*v+y*y;if(b>4*t&&g--){var x=a+h,w=o+d,C=l+p,$=W9(x*x+w*w+C*C),_=u3(C/=$),k=Kr(Kr(C)-1)<ar||Kr(s-f)<ar?(s+f)/2:l3(w,x),E=e(k,_),S=E[0],N=E[1],A=S-r,D=N-i,T=y*A-v*D;(T*T/b>t||Kr((v*A+y*D)/b-.5)>.3||a*h+o*d+l*p<zZt)&&(n(r,i,s,a,o,l,S,N,k,x/=$,w/=$,C,g,m),m.point(S,N),n(S,N,k,x,w,C,u,c,f,h,d,p,g,m))}}return function(r){var i,s,a,o,l,u,c,f,h,d,p,g,m={point:v,lineStart:y,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=y}};function v(_,k){_=e(_,k),r.point(_[0],_[1])}function y(){f=NaN,m.point=b,r.lineStart()}function b(_,k){var E=p$([_,k]),S=e(_,k);n(f,h,c,d,p,g,f=S[0],h=S[1],c=_,d=E[0],p=E[1],g=E[2],_ye,r),r.point(f,h)}function x(){m.point=v,r.lineEnd()}function w(){y(),m.point=C,m.lineEnd=$}function C(_,k){b(i=_,k),s=f,a=h,o=d,l=p,u=g,m.point=b}function $(){n(f,h,c,d,p,g,s,a,i,o,l,u,_ye,r),m.lineEnd=x,x()}return m}}var VZt=sae({point:function(e,t){this.stream.point(e*wl,t*wl)}});function jZt(e){return sae({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function HZt(e,t,n,r,i){function s(a,o){return a*=r,o*=i,[t+e*a,n-e*o]}return s.invert=function(a,o){return[(a-t)/e*r,(n-o)/e*i]},s}function kye(e,t,n,r,i,s){if(!s)return HZt(e,t,n,r,i);var a=ii(s),o=si(s),l=a*e,u=o*e,c=a/e,f=o/e,h=(o*n-a*t)/e,d=(o*t+a*n)/e;function p(g,m){return g*=r,m*=i,[l*g-u*m+t,n-u*g-l*m]}return p.invert=function(g,m){return[r*(c*g-f*m+h),i*(d-f*g-c*m)]},p}function qZt(e){return GZt(function(){return e})()}function GZt(e){var t,n=150,r=480,i=250,s=0,a=0,o=0,l=0,u=0,c,f=0,h=1,d=1,p=null,g=wye,m=null,v,y,b,x=$ye,w=.5,C,$,_,k,E;function S(T){return _(T[0]*wl,T[1]*wl)}function N(T){return T=_.invert(T[0],T[1]),T&&[T[0]*Dd,T[1]*Dd]}S.stream=function(T){return k&&E===T?k:k=VZt(jZt(c)(g(C(x(E=T)))))},S.preclip=function(T){return arguments.length?(g=T,p=void 0,D()):g},S.postclip=function(T){return arguments.length?(x=T,m=v=y=b=null,D()):x},S.clipAngle=function(T){return arguments.length?(g=+T?IZt(p=T*wl):(p=null,wye),D()):p*Dd},S.clipExtent=function(T){return arguments.length?(x=T==null?(m=v=y=b=null,$ye):FZt(m=+T[0][0],v=+T[0][1],y=+T[1][0],b=+T[1][1]),D()):m==null?null:[[m,v],[y,b]]},S.scale=function(T){return arguments.length?(n=+T,A()):n},S.translate=function(T){return arguments.length?(r=+T[0],i=+T[1],A()):[r,i]},S.center=function(T){return arguments.length?(s=T[0]%360*wl,a=T[1]%360*wl,A()):[s*Dd,a*Dd]},S.rotate=function(T){return arguments.length?(o=T[0]%360*wl,l=T[1]%360*wl,u=T.length>2?T[2]%360*wl:0,A()):[o*Dd,l*Dd,u*Dd]},S.angle=function(T){return arguments.length?(f=T%360*wl,A()):f*Dd},S.reflectX=function(T){return arguments.length?(h=T?-1:1,A()):h<0},S.reflectY=function(T){return arguments.length?(d=T?-1:1,A()):d<0},S.precision=function(T){return arguments.length?(C=Sye($,w=T*T),D()):W9(w)},S.fitExtent=function(T,I){return P6e(S,T,I)},S.fitSize=function(T,I){return PZt(S,T,I)},S.fitWidth=function(T,I){return LZt(S,T,I)},S.fitHeight=function(T,I){return BZt(S,T,I)};function A(){var T=kye(n,0,0,h,d,f).apply(null,t(s,a)),I=kye(n,r-T[0],i-T[1],h,d,f);return c=_Zt(o,l,u),$=jK(t,I),_=jK(c,$),C=Sye($,w),D()}function D(){return k=E=null,S}return function(){return t=e.apply(this,arguments),S.invert=t.invert&&N,A()}}var YZt=Math.abs,GK=Math.cos,sL=Math.sin,XZt=1e-6,L6e=Math.PI,YK=L6e/2,Eye=KZt(2);function Aye(e){return e>1?YK:e<-1?-YK:Math.asin(e)}function KZt(e){return e>0?Math.sqrt(e):0}function ZZt(e,t){var n=e*sL(t),r=30,i;do t-=i=(t+sL(t)-n)/(1+GK(t));while(YZt(i)>XZt&&--r>0);return t/2}function QZt(e,t,n){function r(i,s){return[e*i*GK(s=ZZt(n,s)),t*sL(s)]}return r.invert=function(i,s){return s=Aye(s/t),[i/(e*GK(s)),Aye((2*s+sL(2*s))/n)]},r}var JZt=QZt(Eye/YK,Eye,L6e);function eQt(){return qZt(JZt).scale(169.529)}const tQt=x6e(),XK=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function nQt(e,t){return function n(){const r=t();return r.type=e,r.path=x6e().projection(r),r.copy=r.copy||function(){const i=n();return XK.forEach(s=>{r[s]&&i[s](r[s]())}),i.path.pointRadius(r.path.pointRadius()),i},z5e(r)}}function B6e(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(aL[e]=nQt(e,t),this):aL[e]||null}function z6e(e){return e&&e.path||tQt}const aL={albers:$6e,albersusa:eZt,azimuthalequalarea:tZt,azimuthalequidistant:nZt,conicconformal:sZt,conicequalarea:QP,conicequidistant:lZt,equalEarth:cZt,equirectangular:aZt,gnomonic:fZt,identity:hZt,mercator:rZt,mollweide:eQt,naturalEarth1:dZt,orthographic:pZt,stereographic:gZt,transversemercator:mZt};for(const e in aL)B6e(e,aL[e]);var lt=1e-6,oL=1e-12,jt=Math.PI,Yr=jt/2,lL=jt/4,yo=jt*2,ni=180/jt,Ht=jt/180,ln=Math.abs,K_=Math.atan,Uu=Math.atan2,ft=Math.cos,QO=Math.ceil,U6e=Math.exp,KK=Math.hypot,uL=Math.log,IH=Math.pow,st=Math.sin,Cu=Math.sign||function(e){return e>0?1:e<0?-1:0},bo=Math.sqrt,oae=Math.tan;function W6e(e){return e>1?0:e<-1?jt:Math.acos(e)}function cl(e){return e>1?Yr:e<-1?-Yr:Math.asin(e)}function Os(){}function cL(e,t){e&&Dye.hasOwnProperty(e.type)&&Dye[e.type](e,t)}var Tye={Feature:function(e,t){cL(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)cL(n[r].geometry,t)}},Dye={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){ZK(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)ZK(n[r],t,0)},Polygon:function(e,t){Nye(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Nye(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)cL(n[r],t)}};function ZK(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function Nye(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)ZK(e[n],t,1);t.polygonEnd()}function Xd(e,t){e&&Tye.hasOwnProperty(e.type)?Tye[e.type](e,t):cL(e,t)}var fL=new co,hL=new co,V6e,j6e,QK,JK,eZ,Bh={point:Os,lineStart:Os,lineEnd:Os,polygonStart:function(){fL=new co,Bh.lineStart=rQt,Bh.lineEnd=iQt},polygonEnd:function(){var e=+fL;hL.add(e<0?yo+e:e),this.lineStart=this.lineEnd=this.point=Os},sphere:function(){hL.add(yo)}};function rQt(){Bh.point=sQt}function iQt(){H6e(V6e,j6e)}function sQt(e,t){Bh.point=H6e,V6e=e,j6e=t,e*=Ht,t*=Ht,QK=e,JK=ft(t=t/2+lL),eZ=st(t)}function H6e(e,t){e*=Ht,t*=Ht,t=t/2+lL;var n=e-QK,r=n>=0?1:-1,i=r*n,s=ft(t),a=st(t),o=eZ*a,l=JK*s+o*ft(i),u=o*r*st(i);fL.add(Uu(u,l)),QK=e,JK=s,eZ=a}function aQt(e){return hL=new co,Xd(e,Bh),hL*2}function dL(e){return[Uu(e[1],e[0]),cl(e[2])]}function nb(e){var t=e[0],n=e[1],r=ft(n);return[r*ft(t),r*st(t),st(n)]}function JO(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function m$(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function MH(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function eR(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function pL(e){var t=bo(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Or,zo,Vr,_l,Qv,q6e,G6e,iw,xA,Bg,jp,Ud={point:tZ,lineStart:Iye,lineEnd:Mye,polygonStart:function(){Ud.point=X6e,Ud.lineStart=oQt,Ud.lineEnd=lQt,xA=new co,Bh.polygonStart()},polygonEnd:function(){Bh.polygonEnd(),Ud.point=tZ,Ud.lineStart=Iye,Ud.lineEnd=Mye,fL<0?(Or=-(Vr=180),zo=-(_l=90)):xA>lt?_l=90:xA<-lt&&(zo=-90),jp[0]=Or,jp[1]=Vr},sphere:function(){Or=-(Vr=180),zo=-(_l=90)}};function tZ(e,t){Bg.push(jp=[Or=e,Vr=e]),t<zo&&(zo=t),t>_l&&(_l=t)}function Y6e(e,t){var n=nb([e*Ht,t*Ht]);if(iw){var r=m$(iw,n),i=[r[1],-r[0],0],s=m$(i,r);pL(s),s=dL(s);var a=e-Qv,o=a>0?1:-1,l=s[0]*ni*o,u,c=ln(a)>180;c^(o*Qv<l&&l<o*e)?(u=s[1]*ni,u>_l&&(_l=u)):(l=(l+360)%360-180,c^(o*Qv<l&&l<o*e)?(u=-s[1]*ni,u<zo&&(zo=u)):(t<zo&&(zo=t),t>_l&&(_l=t))),c?e<Qv?$l(Or,e)>$l(Or,Vr)&&(Vr=e):$l(e,Vr)>$l(Or,Vr)&&(Or=e):Vr>=Or?(e<Or&&(Or=e),e>Vr&&(Vr=e)):e>Qv?$l(Or,e)>$l(Or,Vr)&&(Vr=e):$l(e,Vr)>$l(Or,Vr)&&(Or=e)}else Bg.push(jp=[Or=e,Vr=e]);t<zo&&(zo=t),t>_l&&(_l=t),iw=n,Qv=e}function Iye(){Ud.point=Y6e}function Mye(){jp[0]=Or,jp[1]=Vr,Ud.point=tZ,iw=null}function X6e(e,t){if(iw){var n=e-Qv;xA.add(ln(n)>180?n+(n>0?360:-360):n)}else q6e=e,G6e=t;Bh.point(e,t),Y6e(e,t)}function oQt(){Bh.lineStart()}function lQt(){X6e(q6e,G6e),Bh.lineEnd(),ln(xA)>lt&&(Or=-(Vr=180)),jp[0]=Or,jp[1]=Vr,iw=null}function $l(e,t){return(t-=e)<0?t+360:t}function uQt(e,t){return e[0]-t[0]}function Fye(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function cQt(e){var t,n,r,i,s,a,o;if(_l=Vr=-(Or=zo=1/0),Bg=[],Xd(e,Ud),n=Bg.length){for(Bg.sort(uQt),t=1,r=Bg[0],s=[r];t<n;++t)i=Bg[t],Fye(r,i[0])||Fye(r,i[1])?($l(r[0],i[1])>$l(r[0],r[1])&&(r[1]=i[1]),$l(i[0],r[1])>$l(r[0],r[1])&&(r[0]=i[0])):s.push(r=i);for(a=-1/0,n=s.length-1,t=0,r=s[n];t<=n;r=i,++t)i=s[t],(o=$l(r[1],i[0]))>a&&(a=o,Or=i[0],Vr=r[1])}return Bg=jp=null,Or===1/0||zo===1/0?[[NaN,NaN],[NaN,NaN]]:[[Or,zo],[Vr,_l]]}var EE,gL,mL,vL,yL,bL,xL,wL,nZ,rZ,iZ,K6e,Z6e,Xa,Ka,Za,Fc={sphere:Os,point:lae,lineStart:Oye,lineEnd:Rye,polygonStart:function(){Fc.lineStart=dQt,Fc.lineEnd=pQt},polygonEnd:function(){Fc.lineStart=Oye,Fc.lineEnd=Rye}};function lae(e,t){e*=Ht,t*=Ht;var n=ft(t);xM(n*ft(e),n*st(e),st(t))}function xM(e,t,n){++EE,mL+=(e-mL)/EE,vL+=(t-vL)/EE,yL+=(n-yL)/EE}function Oye(){Fc.point=fQt}function fQt(e,t){e*=Ht,t*=Ht;var n=ft(t);Xa=n*ft(e),Ka=n*st(e),Za=st(t),Fc.point=hQt,xM(Xa,Ka,Za)}function hQt(e,t){e*=Ht,t*=Ht;var n=ft(t),r=n*ft(e),i=n*st(e),s=st(t),a=Uu(bo((a=Ka*s-Za*i)*a+(a=Za*r-Xa*s)*a+(a=Xa*i-Ka*r)*a),Xa*r+Ka*i+Za*s);gL+=a,bL+=a*(Xa+(Xa=r)),xL+=a*(Ka+(Ka=i)),wL+=a*(Za+(Za=s)),xM(Xa,Ka,Za)}function Rye(){Fc.point=lae}function dQt(){Fc.point=gQt}function pQt(){Q6e(K6e,Z6e),Fc.point=lae}function gQt(e,t){K6e=e,Z6e=t,e*=Ht,t*=Ht,Fc.point=Q6e;var n=ft(t);Xa=n*ft(e),Ka=n*st(e),Za=st(t),xM(Xa,Ka,Za)}function Q6e(e,t){e*=Ht,t*=Ht;var n=ft(t),r=n*ft(e),i=n*st(e),s=st(t),a=Ka*s-Za*i,o=Za*r-Xa*s,l=Xa*i-Ka*r,u=KK(a,o,l),c=cl(u),f=u&&-c/u;nZ.add(f*a),rZ.add(f*o),iZ.add(f*l),gL+=c,bL+=c*(Xa+(Xa=r)),xL+=c*(Ka+(Ka=i)),wL+=c*(Za+(Za=s)),xM(Xa,Ka,Za)}function mQt(e){EE=gL=mL=vL=yL=bL=xL=wL=0,nZ=new co,rZ=new co,iZ=new co,Xd(e,Fc);var t=+nZ,n=+rZ,r=+iZ,i=KK(t,n,r);return i<oL&&(t=bL,n=xL,r=wL,gL<lt&&(t=mL,n=vL,r=yL),i=KK(t,n,r),i<oL)?[NaN,NaN]:[Uu(n,t)*ni,cl(r/i)*ni]}function sZ(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function aZ(e,t){return[ln(e)>jt?e+Math.round(-e/yo)*yo:e,t]}aZ.invert=aZ;function J6e(e,t,n){return(e%=yo)?t||n?sZ(Lye(e),Bye(t,n)):Lye(e):t||n?Bye(t,n):aZ}function Pye(e){return function(t,n){return t+=e,[t>jt?t-yo:t<-jt?t+yo:t,n]}}function Lye(e){var t=Pye(e);return t.invert=Pye(-e),t}function Bye(e,t){var n=ft(e),r=st(e),i=ft(t),s=st(t);function a(o,l){var u=ft(l),c=ft(o)*u,f=st(o)*u,h=st(l),d=h*n+c*r;return[Uu(f*i-d*s,c*n-h*r),cl(d*i+f*s)]}return a.invert=function(o,l){var u=ft(l),c=ft(o)*u,f=st(o)*u,h=st(l),d=h*i-f*s;return[Uu(f*i+h*s,c*n+d*r),cl(d*n-c*r)]},a}function vQt(e){e=J6e(e[0]*Ht,e[1]*Ht,e.length>2?e[2]*Ht:0);function t(n){return n=e(n[0]*Ht,n[1]*Ht),n[0]*=ni,n[1]*=ni,n}return t.invert=function(n){return n=e.invert(n[0]*Ht,n[1]*Ht),n[0]*=ni,n[1]*=ni,n},t}function yQt(e,t,n,r,i,s){if(!!n){var a=ft(t),o=st(t),l=r*n;i==null?(i=t+r*yo,s=t-l/2):(i=zye(a,i),s=zye(a,s),(r>0?i<s:i>s)&&(i+=r*yo));for(var u,c=i;r>0?c>s:c<s;c-=l)u=dL([a,-o*ft(c),-o*st(c)]),e.point(u[0],u[1])}}function zye(e,t){t=nb(t),t[0]-=e,pL(t);var n=W6e(-t[1]);return((-t[2]<0?-n:n)+yo-lt)%yo}function e8e(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Os,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function w4(e,t){return ln(e[0]-t[0])<lt&&ln(e[1]-t[1])<lt}function tR(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function t8e(e,t,n,r,i){var s=[],a=[],o,l;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],v=p[g],y;if(w4(m,v)){if(!m[2]&&!v[2]){for(i.lineStart(),o=0;o<g;++o)i.point((m=p[o])[0],m[1]);i.lineEnd();return}v[0]+=2*lt}s.push(y=new tR(m,p,null,!0)),a.push(y.o=new tR(m,null,y,!1)),s.push(y=new tR(v,p,null,!1)),a.push(y.o=new tR(v,null,y,!0))}}),!!s.length){for(a.sort(t),Uye(s),Uye(a),o=0,l=a.length;o<l;++o)a[o].e=n=!n;for(var u=s[0],c,f;;){for(var h=u,d=!0;h.v;)if((h=h.n)===u)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,l=c.length;o<l;++o)i.point((f=c[o])[0],f[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(c=h.p.z,o=c.length-1;o>=0;--o)i.point((f=c[o])[0],f[1]);else r(h.x,h.p.x,-1,i);h=h.p}h=h.o,c=h.z,d=!d}while(!h.v);i.lineEnd()}}}function Uye(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function FH(e){return ln(e[0])<=jt?e[0]:Cu(e[0])*((ln(e[0])+jt)%yo-jt)}function bQt(e,t){var n=FH(t),r=t[1],i=st(r),s=[st(n),-ft(n),0],a=0,o=0,l=new co;i===1?r=Yr+lt:i===-1&&(r=-Yr-lt);for(var u=0,c=e.length;u<c;++u)if(!!(h=(f=e[u]).length))for(var f,h,d=f[h-1],p=FH(d),g=d[1]/2+lL,m=st(g),v=ft(g),y=0;y<h;++y,p=x,m=C,v=$,d=b){var b=f[y],x=FH(b),w=b[1]/2+lL,C=st(w),$=ft(w),_=x-p,k=_>=0?1:-1,E=k*_,S=E>jt,N=m*C;if(l.add(Uu(N*k*st(E),v*$+N*ft(E))),a+=S?_+k*yo:_,S^p>=n^x>=n){var A=m$(nb(d),nb(b));pL(A);var D=m$(s,A);pL(D);var T=(S^_>=0?-1:1)*cl(D[2]);(r>T||r===T&&(A[0]||A[1]))&&(o+=S^_>=0?1:-1)}}return(a<-lt||a<lt&&l<-oL)^o&1}function n8e(e,t,n,r){return function(i){var s=t(i),a=e8e(),o=t(a),l=!1,u,c,f,h={point:d,lineStart:g,lineEnd:m,polygonStart:function(){h.point=v,h.lineStart=y,h.lineEnd=b,c=[],u=[]},polygonEnd:function(){h.point=d,h.lineStart=g,h.lineEnd=m,c=LRe(c);var x=bQt(u,r);c.length?(l||(i.polygonStart(),l=!0),t8e(c,wQt,x,n,i)):x&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),c=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(x,w){e(x,w)&&i.point(x,w)}function p(x,w){s.point(x,w)}function g(){h.point=p,s.lineStart()}function m(){h.point=d,s.lineEnd()}function v(x,w){f.push([x,w]),o.point(x,w)}function y(){o.lineStart(),f=[]}function b(){v(f[0][0],f[0][1]),o.lineEnd();var x=o.clean(),w=a.result(),C,$=w.length,_,k,E;if(f.pop(),u.push(f),f=null,!!$){if(x&1){if(k=w[0],(_=k.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),C=0;C<_;++C)i.point((E=k[C])[0],E[1]);i.lineEnd()}return}$>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(xQt))}}return h}}function xQt(e){return e.length>1}function wQt(e,t){return((e=e.x)[0]<0?e[1]-Yr-lt:Yr-e[1])-((t=t.x)[0]<0?t[1]-Yr-lt:Yr-t[1])}const Wye=n8e(function(){return!0},$Qt,_Qt,[-jt,-Yr]);function $Qt(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,a){var o=s>0?jt:-jt,l=ln(s-t);ln(l-jt)<lt?(e.point(t,n=(n+a)/2>0?Yr:-Yr),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(s,n),i=0):r!==o&&l>=jt&&(ln(t-r)<lt&&(t-=r*lt),ln(s-o)<lt&&(s-=o*lt),n=CQt(t,n,s,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),i=0),e.point(t=s,n=a),r=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function CQt(e,t,n,r){var i,s,a=st(e-n);return ln(a)>lt?K_((st(t)*(s=ft(r))*st(n)-st(r)*(i=ft(t))*st(e))/(i*s*a)):(t+r)/2}function _Qt(e,t,n,r){var i;if(e==null)i=n*Yr,r.point(-jt,i),r.point(0,i),r.point(jt,i),r.point(jt,0),r.point(jt,-i),r.point(0,-i),r.point(-jt,-i),r.point(-jt,0),r.point(-jt,i);else if(ln(e[0]-t[0])>lt){var s=e[0]<t[0]?jt:-jt;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function SQt(e){var t=ft(e),n=6*Ht,r=t>0,i=ln(t)>lt;function s(c,f,h,d){yQt(d,e,n,h,c,f)}function a(c,f){return ft(c)*ft(f)>t}function o(c){var f,h,d,p,g;return{lineStart:function(){p=d=!1,g=1},point:function(m,v){var y=[m,v],b,x=a(m,v),w=r?x?0:u(m,v):x?u(m+(m<0?jt:-jt),v):0;if(!f&&(p=d=x)&&c.lineStart(),x!==d&&(b=l(f,y),(!b||w4(f,b)||w4(y,b))&&(y[2]=1)),x!==d)g=0,x?(c.lineStart(),b=l(y,f),c.point(b[0],b[1])):(b=l(f,y),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var C;!(w&h)&&(C=l(y,f,!0))&&(g=0,r?(c.lineStart(),c.point(C[0][0],C[0][1]),c.point(C[1][0],C[1][1]),c.lineEnd()):(c.point(C[1][0],C[1][1]),c.lineEnd(),c.lineStart(),c.point(C[0][0],C[0][1],3)))}x&&(!f||!w4(f,y))&&c.point(y[0],y[1]),f=y,d=x,h=w},lineEnd:function(){d&&c.lineEnd(),f=null},clean:function(){return g|(p&&d)<<1}}}function l(c,f,h){var d=nb(c),p=nb(f),g=[1,0,0],m=m$(d,p),v=JO(m,m),y=m[0],b=v-y*y;if(!b)return!h&&c;var x=t*v/b,w=-t*y/b,C=m$(g,m),$=eR(g,x),_=eR(m,w);MH($,_);var k=C,E=JO($,k),S=JO(k,k),N=E*E-S*(JO($,$)-1);if(!(N<0)){var A=bo(N),D=eR(k,(-E-A)/S);if(MH(D,$),D=dL(D),!h)return D;var T=c[0],I=f[0],F=c[1],R=f[1],P;I<T&&(P=T,T=I,I=P);var V=I-T,z=ln(V-jt)<lt,q=z||V<lt;if(!z&&R<F&&(P=F,F=R,R=P),q?z?F+R>0^D[1]<(ln(D[0]-T)<lt?F:R):F<=D[1]&&D[1]<=R:V>jt^(T<=D[0]&&D[0]<=I)){var G=eR(k,(-E+A)/S);return MH(G,$),[D,dL(G)]}}}function u(c,f){var h=r?e:jt-e,d=0;return c<-h?d|=1:c>h&&(d|=2),f<-h?d|=4:f>h&&(d|=8),d}return n8e(a,o,s,r?[0,-e]:[-jt,e-jt])}function kQt(e,t,n,r,i,s){var a=e[0],o=e[1],l=t[0],u=t[1],c=0,f=1,h=l-a,d=u-o,p;if(p=n-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=i-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}if(p=r-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=s-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=a+c*h,e[1]=o+c*d),f<1&&(t[0]=a+f*h,t[1]=o+f*d),!0}}}}}var AE=1e9,nR=-AE;function r8e(e,t,n,r){function i(u,c){return e<=u&&u<=n&&t<=c&&c<=r}function s(u,c,f,h){var d=0,p=0;if(u==null||(d=a(u,f))!==(p=a(c,f))||l(u,c)<0^f>0)do h.point(d===0||d===3?e:n,d>1?r:t);while((d=(d+f+4)%4)!==p);else h.point(c[0],c[1])}function a(u,c){return ln(u[0]-e)<lt?c>0?0:3:ln(u[0]-n)<lt?c>0?2:1:ln(u[1]-t)<lt?c>0?1:0:c>0?3:2}function o(u,c){return l(u.x,c.x)}function l(u,c){var f=a(u,1),h=a(c,1);return f!==h?f-h:f===0?c[1]-u[1]:f===1?u[0]-c[0]:f===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,f=e8e(),h,d,p,g,m,v,y,b,x,w,C,$={point:_,lineStart:N,lineEnd:A,polygonStart:E,polygonEnd:S};function _(T,I){i(T,I)&&c.point(T,I)}function k(){for(var T=0,I=0,F=d.length;I<F;++I)for(var R=d[I],P=1,V=R.length,z=R[0],q,G,K=z[0],Y=z[1];P<V;++P)q=K,G=Y,z=R[P],K=z[0],Y=z[1],G<=r?Y>r&&(K-q)*(r-G)>(Y-G)*(e-q)&&++T:Y<=r&&(K-q)*(r-G)<(Y-G)*(e-q)&&--T;return T}function E(){c=f,h=[],d=[],C=!0}function S(){var T=k(),I=C&&T,F=(h=LRe(h)).length;(I||F)&&(u.polygonStart(),I&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),F&&t8e(h,o,T,s,u),u.polygonEnd()),c=u,h=d=p=null}function N(){$.point=D,d&&d.push(p=[]),w=!0,x=!1,y=b=NaN}function A(){h&&(D(g,m),v&&x&&f.rejoin(),h.push(f.result())),$.point=_,x&&c.lineEnd()}function D(T,I){var F=i(T,I);if(d&&p.push([T,I]),w)g=T,m=I,v=F,w=!1,F&&(c.lineStart(),c.point(T,I));else if(F&&x)c.point(T,I);else{var R=[y=Math.max(nR,Math.min(AE,y)),b=Math.max(nR,Math.min(AE,b))],P=[T=Math.max(nR,Math.min(AE,T)),I=Math.max(nR,Math.min(AE,I))];kQt(R,P,e,t,n,r)?(x||(c.lineStart(),c.point(R[0],R[1])),c.point(P[0],P[1]),F||c.lineEnd(),C=!1):F&&(c.lineStart(),c.point(T,I),C=!1)}y=T,b=I,x=F}return $}}function Vye(e,t,n){var r=Ml(e,t-lt,n).concat(t);return function(i){return r.map(function(s){return[i,s]})}}function jye(e,t,n){var r=Ml(e,t-lt,n).concat(t);return function(i){return r.map(function(s){return[s,i]})}}function EQt(){var e,t,n,r,i,s,a,o,l=10,u=l,c=90,f=360,h,d,p,g,m=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return Ml(QO(r/c)*c,n,c).map(p).concat(Ml(QO(o/f)*f,a,f).map(g)).concat(Ml(QO(t/l)*l,e,l).filter(function(b){return ln(b%c)>lt}).map(h)).concat(Ml(QO(s/u)*u,i,u).filter(function(b){return ln(b%f)>lt}).map(d))}return v.lines=function(){return y().map(function(b){return{type:"LineString",coordinates:b}})},v.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(a).slice(1),p(n).reverse().slice(1),g(o).reverse().slice(1))]}},v.extent=function(b){return arguments.length?v.extentMajor(b).extentMinor(b):v.extentMinor()},v.extentMajor=function(b){return arguments.length?(r=+b[0][0],n=+b[1][0],o=+b[0][1],a=+b[1][1],r>n&&(b=r,r=n,n=b),o>a&&(b=o,o=a,a=b),v.precision(m)):[[r,o],[n,a]]},v.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],s=+b[0][1],i=+b[1][1],t>e&&(b=t,t=e,e=b),s>i&&(b=s,s=i,i=b),v.precision(m)):[[t,s],[e,i]]},v.step=function(b){return arguments.length?v.stepMajor(b).stepMinor(b):v.stepMinor()},v.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],v):[c,f]},v.stepMinor=function(b){return arguments.length?(l=+b[0],u=+b[1],v):[l,u]},v.precision=function(b){return arguments.length?(m=+b,h=Vye(s,i,90),d=jye(t,e,m),p=Vye(o,a,90),g=jye(r,n,m),v):m},v.extentMajor([[-180,-90+lt],[180,90-lt]]).extentMinor([[-180,-80-lt],[180,80+lt]])}const f3=e=>e;var OH=new co,oZ=new co,i8e,s8e,lZ,uZ,Gg={point:Os,lineStart:Os,lineEnd:Os,polygonStart:function(){Gg.lineStart=AQt,Gg.lineEnd=DQt},polygonEnd:function(){Gg.lineStart=Gg.lineEnd=Gg.point=Os,OH.add(ln(oZ)),oZ=new co},result:function(){var e=OH/2;return OH=new co,e}};function AQt(){Gg.point=TQt}function TQt(e,t){Gg.point=a8e,i8e=lZ=e,s8e=uZ=t}function a8e(e,t){oZ.add(uZ*e-lZ*t),lZ=e,uZ=t}function DQt(){a8e(i8e,s8e)}const Hye=Gg;var v$=1/0,$L=v$,h3=-v$,CL=h3,NQt={point:IQt,lineStart:Os,lineEnd:Os,polygonStart:Os,polygonEnd:Os,result:function(){var e=[[v$,$L],[h3,CL]];return h3=CL=-($L=v$=1/0),e}};function IQt(e,t){e<v$&&(v$=e),e>h3&&(h3=e),t<$L&&($L=t),t>CL&&(CL=t)}const _L=NQt;var cZ=0,fZ=0,TE=0,SL=0,kL=0,O2=0,hZ=0,dZ=0,DE=0,o8e,l8e,Hf,qf,Ac={point:rb,lineStart:qye,lineEnd:Gye,polygonStart:function(){Ac.lineStart=OQt,Ac.lineEnd=RQt},polygonEnd:function(){Ac.point=rb,Ac.lineStart=qye,Ac.lineEnd=Gye},result:function(){var e=DE?[hZ/DE,dZ/DE]:O2?[SL/O2,kL/O2]:TE?[cZ/TE,fZ/TE]:[NaN,NaN];return cZ=fZ=TE=SL=kL=O2=hZ=dZ=DE=0,e}};function rb(e,t){cZ+=e,fZ+=t,++TE}function qye(){Ac.point=MQt}function MQt(e,t){Ac.point=FQt,rb(Hf=e,qf=t)}function FQt(e,t){var n=e-Hf,r=t-qf,i=bo(n*n+r*r);SL+=i*(Hf+e)/2,kL+=i*(qf+t)/2,O2+=i,rb(Hf=e,qf=t)}function Gye(){Ac.point=rb}function OQt(){Ac.point=PQt}function RQt(){u8e(o8e,l8e)}function PQt(e,t){Ac.point=u8e,rb(o8e=Hf=e,l8e=qf=t)}function u8e(e,t){var n=e-Hf,r=t-qf,i=bo(n*n+r*r);SL+=i*(Hf+e)/2,kL+=i*(qf+t)/2,O2+=i,i=qf*e-Hf*t,hZ+=i*(Hf+e),dZ+=i*(qf+t),DE+=i*3,rb(Hf=e,qf=t)}const Yye=Ac;function c8e(e){this._context=e}c8e.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,yo);break}}},result:Os};var pZ=new co,RH,f8e,h8e,NE,IE,EL={point:Os,lineStart:function(){EL.point=LQt},lineEnd:function(){RH&&d8e(f8e,h8e),EL.point=Os},polygonStart:function(){RH=!0},polygonEnd:function(){RH=null},result:function(){var e=+pZ;return pZ=new co,e}};function LQt(e,t){EL.point=d8e,f8e=NE=e,h8e=IE=t}function d8e(e,t){NE-=e,IE-=t,pZ.add(bo(NE*NE+IE*IE)),NE=e,IE=t}const Xye=EL;function p8e(){this._string=[]}p8e.prototype={_radius:4.5,_circle:Kye(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=Kye(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function Kye(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function g8e(e,t){var n=4.5,r,i;function s(a){return a&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),Xd(a,r(i))),i.result()}return s.area=function(a){return Xd(a,r(Hye)),Hye.result()},s.measure=function(a){return Xd(a,r(Xye)),Xye.result()},s.bounds=function(a){return Xd(a,r(_L)),_L.result()},s.centroid=function(a){return Xd(a,r(Yye)),Yye.result()},s.projection=function(a){return arguments.length?(r=a==null?(e=null,f3):(e=a).stream,s):e},s.context=function(a){return arguments.length?(i=a==null?(t=null,new p8e):new c8e(t=a),typeof n!="function"&&i.pointRadius(n),s):t},s.pointRadius=function(a){return arguments.length?(n=typeof a=="function"?a:(i.pointRadius(+a),+a),s):n},s.projection(e).context(t)}function V9(e){return function(t){var n=new gZ;for(var r in e)n[r]=e[r];return n.stream=t,n}}function gZ(){}gZ.prototype={constructor:gZ,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function uae(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Xd(n,e.stream(_L)),t(_L.result()),r!=null&&e.clipExtent(r),e}function j9(e,t,n){return uae(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),o=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(s-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,l])},n)}function cae(e,t,n){return j9(e,[[0,0],t],n)}function fae(e,t,n){return uae(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),a=(i-s*(r[1][0]+r[0][0]))/2,o=-s*r[0][1];e.scale(150*s).translate([a,o])},n)}function hae(e,t,n){return uae(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),a=-s*r[0][0],o=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,o])},n)}var Zye=16,BQt=ft(30*Ht);function Qye(e,t){return+t?UQt(e,t):zQt(e)}function zQt(e){return V9({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function UQt(e,t){function n(r,i,s,a,o,l,u,c,f,h,d,p,g,m){var v=u-r,y=c-i,b=v*v+y*y;if(b>4*t&&g--){var x=a+h,w=o+d,C=l+p,$=bo(x*x+w*w+C*C),_=cl(C/=$),k=ln(ln(C)-1)<lt||ln(s-f)<lt?(s+f)/2:Uu(w,x),E=e(k,_),S=E[0],N=E[1],A=S-r,D=N-i,T=y*A-v*D;(T*T/b>t||ln((v*A+y*D)/b-.5)>.3||a*h+o*d+l*p<BQt)&&(n(r,i,s,a,o,l,S,N,k,x/=$,w/=$,C,g,m),m.point(S,N),n(S,N,k,x,w,C,u,c,f,h,d,p,g,m))}}return function(r){var i,s,a,o,l,u,c,f,h,d,p,g,m={point:v,lineStart:y,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=y}};function v(_,k){_=e(_,k),r.point(_[0],_[1])}function y(){f=NaN,m.point=b,r.lineStart()}function b(_,k){var E=nb([_,k]),S=e(_,k);n(f,h,c,d,p,g,f=S[0],h=S[1],c=_,d=E[0],p=E[1],g=E[2],Zye,r),r.point(f,h)}function x(){m.point=v,r.lineEnd()}function w(){y(),m.point=C,m.lineEnd=$}function C(_,k){b(i=_,k),s=f,a=h,o=d,l=p,u=g,m.point=b}function $(){n(f,h,c,d,p,g,s,a,i,o,l,u,Zye,r),m.lineEnd=x,x()}return m}}var WQt=V9({point:function(e,t){this.stream.point(e*Ht,t*Ht)}});function VQt(e){return V9({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function jQt(e,t,n,r,i){function s(a,o){return a*=r,o*=i,[t+e*a,n-e*o]}return s.invert=function(a,o){return[(a-t)/e*r,(n-o)/e*i]},s}function Jye(e,t,n,r,i,s){if(!s)return jQt(e,t,n,r,i);var a=ft(s),o=st(s),l=a*e,u=o*e,c=a/e,f=o/e,h=(o*n-a*t)/e,d=(o*t+a*n)/e;function p(g,m){return g*=r,m*=i,[l*g-u*m+t,n-u*g-l*m]}return p.invert=function(g,m){return[r*(c*g-f*m+h),i*(d-f*g-c*m)]},p}function ld(e){return m8e(function(){return e})()}function m8e(e){var t,n=150,r=480,i=250,s=0,a=0,o=0,l=0,u=0,c,f=0,h=1,d=1,p=null,g=Wye,m=null,v,y,b,x=f3,w=.5,C,$,_,k,E;function S(T){return _(T[0]*Ht,T[1]*Ht)}function N(T){return T=_.invert(T[0],T[1]),T&&[T[0]*ni,T[1]*ni]}S.stream=function(T){return k&&E===T?k:k=WQt(VQt(c)(g(C(x(E=T)))))},S.preclip=function(T){return arguments.length?(g=T,p=void 0,D()):g},S.postclip=function(T){return arguments.length?(x=T,m=v=y=b=null,D()):x},S.clipAngle=function(T){return arguments.length?(g=+T?SQt(p=T*Ht):(p=null,Wye),D()):p*ni},S.clipExtent=function(T){return arguments.length?(x=T==null?(m=v=y=b=null,f3):r8e(m=+T[0][0],v=+T[0][1],y=+T[1][0],b=+T[1][1]),D()):m==null?null:[[m,v],[y,b]]},S.scale=function(T){return arguments.length?(n=+T,A()):n},S.translate=function(T){return arguments.length?(r=+T[0],i=+T[1],A()):[r,i]},S.center=function(T){return arguments.length?(s=T[0]%360*Ht,a=T[1]%360*Ht,A()):[s*ni,a*ni]},S.rotate=function(T){return arguments.length?(o=T[0]%360*Ht,l=T[1]%360*Ht,u=T.length>2?T[2]%360*Ht:0,A()):[o*ni,l*ni,u*ni]},S.angle=function(T){return arguments.length?(f=T%360*Ht,A()):f*ni},S.reflectX=function(T){return arguments.length?(h=T?-1:1,A()):h<0},S.reflectY=function(T){return arguments.length?(d=T?-1:1,A()):d<0},S.precision=function(T){return arguments.length?(C=Qye($,w=T*T),D()):bo(w)},S.fitExtent=function(T,I){return j9(S,T,I)},S.fitSize=function(T,I){return cae(S,T,I)},S.fitWidth=function(T,I){return fae(S,T,I)},S.fitHeight=function(T,I){return hae(S,T,I)};function A(){var T=Jye(n,0,0,h,d,f).apply(null,t(s,a)),I=Jye(n,r-T[0],i-T[1],h,d,f);return c=J6e(o,l,u),$=sZ(t,I),_=sZ(c,$),C=Qye($,w),D()}function D(){return k=E=null,S}return function(){return t=e.apply(this,arguments),S.invert=t.invert&&N,A()}}function dae(e){var t=0,n=jt/3,r=m8e(e),i=r(t,n);return i.parallels=function(s){return arguments.length?r(t=s[0]*Ht,n=s[1]*Ht):[t*ni,n*ni]},i}function HQt(e){var t=ft(e);function n(r,i){return[r*t,st(i)/t]}return n.invert=function(r,i){return[r/t,cl(i*t)]},n}function qQt(e,t){var n=st(e),r=(n+st(t))/2;if(ln(r)<lt)return HQt(e);var i=1+n*(2*r-n),s=bo(i)/r;function a(o,l){var u=bo(i-2*r*st(l))/r;return[u*st(o*=r),s-u*ft(o)]}return a.invert=function(o,l){var u=s-l,c=Uu(o,ln(u))*Cu(u);return u*r<0&&(c-=jt*Cu(o)*Cu(u)),[c/r,cl((i-(o*o+u*u)*r*r)/(2*r))]},a}function AL(){return dae(qQt).scale(155.424).center([0,33.6442])}function v8e(){return AL().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function GQt(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function YQt(){var e,t,n=v8e(),r,i=AL().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,a=AL().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o,l,u={point:function(h,d){l=[h,d]}};function c(h){var d=h[0],p=h[1];return l=null,r.point(d,p),l||(s.point(d,p),l)||(o.point(d,p),l)}c.invert=function(h){var d=n.scale(),p=n.translate(),g=(h[0]-p[0])/d,m=(h[1]-p[1])/d;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?a:n).invert(h)},c.stream=function(h){return e&&t===h?e:e=GQt([n.stream(t=h),i.stream(h),a.stream(h)])},c.precision=function(h){return arguments.length?(n.precision(h),i.precision(h),a.precision(h),f()):n.precision()},c.scale=function(h){return arguments.length?(n.scale(h),i.scale(h*.35),a.scale(h),c.translate(n.translate())):n.scale()},c.translate=function(h){if(!arguments.length)return n.translate();var d=n.scale(),p=+h[0],g=+h[1];return r=n.translate(h).clipExtent([[p-.455*d,g-.238*d],[p+.455*d,g+.238*d]]).stream(u),s=i.translate([p-.307*d,g+.201*d]).clipExtent([[p-.425*d+lt,g+.12*d+lt],[p-.214*d-lt,g+.234*d-lt]]).stream(u),o=a.translate([p-.205*d,g+.212*d]).clipExtent([[p-.214*d+lt,g+.166*d+lt],[p-.115*d-lt,g+.234*d-lt]]).stream(u),f()},c.fitExtent=function(h,d){return j9(c,h,d)},c.fitSize=function(h,d){return cae(c,h,d)},c.fitWidth=function(h,d){return fae(c,h,d)},c.fitHeight=function(h,d){return hae(c,h,d)};function f(){return e=t=null,c}return c.scale(1070)}function y8e(e){return function(t,n){var r=ft(t),i=ft(n),s=e(r*i);return s===1/0?[2,0]:[s*i*st(t),s*st(n)]}}function wM(e){return function(t,n){var r=bo(t*t+n*n),i=e(r),s=st(i),a=ft(i);return[Uu(t*s,r*a),cl(r&&n*s/r)]}}var b8e=y8e(function(e){return bo(2/(1+e))});b8e.invert=wM(function(e){return 2*cl(e/2)});function XQt(){return ld(b8e).scale(124.75).clipAngle(180-.001)}var x8e=y8e(function(e){return(e=W6e(e))&&e/st(e)});x8e.invert=wM(function(e){return e});function KQt(){return ld(x8e).scale(79.4188).clipAngle(180-.001)}function H9(e,t){return[e,uL(oae((Yr+t)/2))]}H9.invert=function(e,t){return[e,2*K_(U6e(t))-Yr]};function ZQt(){return w8e(H9).scale(961/yo)}function w8e(e){var t=ld(e),n=t.center,r=t.scale,i=t.translate,s=t.clipExtent,a=null,o,l,u;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=o=l=u=null:(a=+f[0][0],o=+f[0][1],l=+f[1][0],u=+f[1][1]),c()):a==null?null:[[a,o],[l,u]]};function c(){var f=jt*r(),h=t(vQt(t.rotate()).invert([0,0]));return s(a==null?[[h[0]-f,h[1]-f],[h[0]+f,h[1]+f]]:e===H9?[[Math.max(h[0]-f,a),o],[Math.min(h[0]+f,l),u]]:[[a,Math.max(h[1]-f,o)],[l,Math.min(h[1]+f,u)]])}return c()}function rR(e){return oae((Yr+e)/2)}function QQt(e,t){var n=ft(e),r=e===t?st(e):uL(n/ft(t))/uL(rR(t)/rR(e)),i=n*IH(rR(e),r)/r;if(!r)return H9;function s(a,o){i>0?o<-Yr+lt&&(o=-Yr+lt):o>Yr-lt&&(o=Yr-lt);var l=i/IH(rR(o),r);return[l*st(r*a),i-l*ft(r*a)]}return s.invert=function(a,o){var l=i-o,u=Cu(r)*bo(a*a+l*l),c=Uu(a,ln(l))*Cu(l);return l*r<0&&(c-=jt*Cu(a)*Cu(l)),[c/r,2*K_(IH(i/u,1/r))-Yr]},s}function JQt(){return dae(QQt).scale(109.5).parallels([30,30])}function TL(e,t){return[e,t]}TL.invert=TL;function eJt(){return ld(TL).scale(152.63)}function tJt(e,t){var n=ft(e),r=e===t?st(e):(n-ft(t))/(t-e),i=n/r+e;if(ln(r)<lt)return TL;function s(a,o){var l=i-o,u=r*a;return[l*st(u),i-l*ft(u)]}return s.invert=function(a,o){var l=i-o,u=Uu(a,ln(l))*Cu(l);return l*r<0&&(u-=jt*Cu(a)*Cu(l)),[u/r,i-Cu(r)*bo(a*a+l*l)]},s}function nJt(){return dae(tJt).scale(131.154).center([0,13.9389])}var wA=1.340264,$A=-.081106,CA=893e-6,_A=.003796,DL=bo(3)/2,rJt=12;function $8e(e,t){var n=cl(DL*st(t)),r=n*n,i=r*r*r;return[e*ft(n)/(DL*(wA+3*$A*r+i*(7*CA+9*_A*r))),n*(wA+$A*r+i*(CA+_A*r))]}$8e.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,s=0,a,o,l;s<rJt&&(o=n*(wA+$A*r+i*(CA+_A*r))-t,l=wA+3*$A*r+i*(7*CA+9*_A*r),n-=a=o/l,r=n*n,i=r*r*r,!(ln(a)<oL));++s);return[DL*e*(wA+3*$A*r+i*(7*CA+9*_A*r))/ft(n),cl(st(n)/DL)]};function iJt(){return ld($8e).scale(177.158)}function C8e(e,t){var n=ft(t),r=ft(e)*n;return[n*st(e)/r,st(t)/r]}C8e.invert=wM(K_);function sJt(){return ld(C8e).scale(144.049).clipAngle(60)}function aJt(){var e=1,t=0,n=0,r=1,i=1,s=0,a,o,l=null,u,c,f,h=1,d=1,p=V9({point:function(x,w){var C=b([x,w]);this.stream.point(C[0],C[1])}}),g=f3,m,v;function y(){return h=e*r,d=e*i,m=v=null,b}function b(x){var w=x[0]*h,C=x[1]*d;if(s){var $=C*a-w*o;w=w*a+C*o,C=$}return[w+t,C+n]}return b.invert=function(x){var w=x[0]-t,C=x[1]-n;if(s){var $=C*a+w*o;w=w*a-C*o,C=$}return[w/h,C/d]},b.stream=function(x){return m&&v===x?m:m=p(g(v=x))},b.postclip=function(x){return arguments.length?(g=x,l=u=c=f=null,y()):g},b.clipExtent=function(x){return arguments.length?(g=x==null?(l=u=c=f=null,f3):r8e(l=+x[0][0],u=+x[0][1],c=+x[1][0],f=+x[1][1]),y()):l==null?null:[[l,u],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,y()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],y()):[t,n]},b.angle=function(x){return arguments.length?(s=x%360*Ht,o=st(s),a=ft(s),y()):s*ni},b.reflectX=function(x){return arguments.length?(r=x?-1:1,y()):r<0},b.reflectY=function(x){return arguments.length?(i=x?-1:1,y()):i<0},b.fitExtent=function(x,w){return j9(b,x,w)},b.fitSize=function(x,w){return cae(b,x,w)},b.fitWidth=function(x,w){return fae(b,x,w)},b.fitHeight=function(x,w){return hae(b,x,w)},b}function _8e(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}_8e.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,a=s*s;n-=i=(n*(1.007226+s*(.015085+a*(-.044475+.028874*s-.005916*a)))-t)/(1.007226+s*(.015085*3+a*(-.044475*7+.028874*9*s-.005916*11*a)))}while(ln(i)>lt&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function oJt(){return ld(_8e).scale(175.295)}function S8e(e,t){return[ft(t)*st(e),st(t)]}S8e.invert=wM(cl);function lJt(){return ld(S8e).scale(249.5).clipAngle(90+lt)}function k8e(e,t){var n=ft(t),r=1+ft(e)*n;return[n*st(e)/r,st(t)/r]}k8e.invert=wM(function(e){return 2*K_(e)});function uJt(){return ld(k8e).scale(250).clipAngle(142)}function E8e(e,t){return[uL(oae((Yr+t)/2)),-e]}E8e.invert=function(e,t){return[-t,2*K_(U6e(e))-Yr]};function cJt(){var e=w8e(E8e),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}function fJt(){}const Nd=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function A8e(){var e=1,t=1,n=o;function r(l,u){return u.map(c=>i(l,c))}function i(l,u){var c=[],f=[];return s(l,u,h=>{n(h,l,u),hJt(h)>0?c.push([h]):f.push(h)}),f.forEach(h=>{for(var d=0,p=c.length,g;d<p;++d)if(dJt((g=c[d])[0],h)!==-1){g.push(h);return}}),{type:"MultiPolygon",value:u,coordinates:c}}function s(l,u,c){var f=new Array,h=new Array,d,p,g,m,v,y;for(d=p=-1,m=l[0]>=u,Nd[m<<1].forEach(b);++d<e-1;)g=m,m=l[d+1]>=u,Nd[g|m<<1].forEach(b);for(Nd[m<<0].forEach(b);++p<t-1;){for(d=-1,m=l[p*e+e]>=u,v=l[p*e]>=u,Nd[m<<1|v<<2].forEach(b);++d<e-1;)g=m,m=l[p*e+e+d+1]>=u,y=v,v=l[p*e+d+1]>=u,Nd[g|m<<1|v<<2|y<<3].forEach(b);Nd[m|v<<3].forEach(b)}for(d=-1,v=l[p*e]>=u,Nd[v<<2].forEach(b);++d<e-1;)y=v,v=l[p*e+d+1]>=u,Nd[v<<2|y<<3].forEach(b);Nd[v<<3].forEach(b);function b(x){var w=[x[0][0]+d,x[0][1]+p],C=[x[1][0]+d,x[1][1]+p],$=a(w),_=a(C),k,E;(k=h[$])?(E=f[_])?(delete h[k.end],delete f[E.start],k===E?(k.ring.push(C),c(k.ring)):f[k.start]=h[E.end]={start:k.start,end:E.end,ring:k.ring.concat(E.ring)}):(delete h[k.end],k.ring.push(C),h[k.end=_]=k):(k=f[_])?(E=h[$])?(delete f[k.start],delete h[E.end],k===E?(k.ring.push(C),c(k.ring)):f[E.start]=h[k.end]={start:E.start,end:k.end,ring:E.ring.concat(k.ring)}):(delete f[k.start],k.ring.unshift(w),f[k.start=$]=k):f[$]=h[_]={start:$,end:_,ring:[w,C]}}}function a(l){return l[0]*2+l[1]*(e+1)*4}function o(l,u,c){l.forEach(f=>{var h=f[0],d=f[1],p=h|0,g=d|0,m,v=u[g*e+p];h>0&&h<e&&p===h&&(m=u[g*e+p-1],f[0]=h+(c-m)/(v-m)-.5),d>0&&d<t&&g===d&&(m=u[(g-1)*e+p],f[1]=d+(c-m)/(v-m)-.5)})}return r.contour=i,r.size=function(l){if(!arguments.length)return[e,t];var u=Math.floor(l[0]),c=Math.floor(l[1]);return u>=0&&c>=0||$e("invalid size"),e=u,t=c,r},r.smooth=function(l){return arguments.length?(n=l?o:fJt,r):n===o},r}function hJt(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function dJt(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=pJt(e,t[n]))return i;return 0}function pJt(e,t){for(var n=t[0],r=t[1],i=-1,s=0,a=e.length,o=a-1;s<a;o=s++){var l=e[s],u=l[0],c=l[1],f=e[o],h=f[0],d=f[1];if(gJt(l,f,t))return 0;c>r!=d>r&&n<(h-u)*(r-c)/(d-c)+u&&(i=-i)}return i}function gJt(e,t,n){var r;return mJt(e,t,n)&&vJt(e[r=+(e[0]===t[0])],n[r],t[r])}function mJt(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function vJt(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function T8e(e,t,n){return function(r){var i=Rp(r),s=n?Math.min(i[0],0):i[0],a=i[1],o=a-s,l=t?J0(s,a,e):o/(e+1);return Ml(s+l,a,l)}}function pae(e){me.call(this,null,e)}pae.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};Ne(pae,me,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||ll,s=A8e().smooth(e.smooth!==!1),a=e.thresholds||yJt(r,i,e),o=e.as===null?null:e.as||"contour",l=[];return r.forEach(u=>{const c=i(u),f=s.size([c.width,c.height])(c.values,at(a)?a:a(c.values));bJt(f,c,u,e),f.forEach(h=>{l.push(i9(u,Tn(o!=null?{[o]:h}:h)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function yJt(e,t,n){const r=T8e(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>ny(t(i).values)))}function bJt(e,t,n,r){let i=r.scale||t.scale,s=r.translate||t.translate;if(Ut(i)&&(i=i(n,r)),Ut(s)&&(s=s(n,r)),(i===1||i==null)&&!s)return;const a=(LT(i)?i:i[0])||1,o=(LT(i)?i:i[1])||1,l=s&&s[0]||0,u=s&&s[1]||0;e.forEach(D8e(t,a,o,l,u))}function D8e(e,t,n,r,i){const s=e.x1||0,a=e.y1||0,o=t*n<0;function l(f){f.forEach(u)}function u(f){o&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-s)*t+r,f[1]=(f[1]-a)*n+i}return function(f){return f.coordinates.forEach(l),f}}function ebe(e,t,n){const r=e>=0?e:vRe(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function PH(e){return Ut(e)?e:vo(+e)}function N8e(){var e=l=>l[0],t=l=>l[1],n=XI,r=[-1,-1],i=960,s=500,a=2;function o(l,u){const c=ebe(r[0],l,e)>>a,f=ebe(r[1],l,t)>>a,h=c?c+2:0,d=f?f+2:0,p=2*h+(i>>a),g=2*d+(s>>a),m=new Float32Array(p*g),v=new Float32Array(p*g);let y=m;l.forEach(x=>{const w=h+(+e(x)>>a),C=d+(+t(x)>>a);w>=0&&w<p&&C>=0&&C<g&&(m[w+C*p]+=+n(x))}),c>0&&f>0?(u2(p,g,m,v,c),c2(p,g,v,m,f),u2(p,g,m,v,c),c2(p,g,v,m,f),u2(p,g,m,v,c),c2(p,g,v,m,f)):c>0?(u2(p,g,m,v,c),u2(p,g,v,m,c),u2(p,g,m,v,c),y=v):f>0&&(c2(p,g,m,v,f),c2(p,g,v,m,f),c2(p,g,m,v,f),y=v);const b=u?Math.pow(2,-2*a):1/BRe(y);for(let x=0,w=p*g;x<w;++x)y[x]*=b;return{values:y,scale:1<<a,width:p,height:g,x1:h,y1:d,x2:h+(i>>a),y2:d+(s>>a)}}return o.x=function(l){return arguments.length?(e=PH(l),o):e},o.y=function(l){return arguments.length?(t=PH(l),o):t},o.weight=function(l){return arguments.length?(n=PH(l),o):n},o.size=function(l){if(!arguments.length)return[i,s];var u=+l[0],c=+l[1];return u>=0&&c>=0||$e("invalid size"),i=u,s=c,o},o.cellSize=function(l){return arguments.length?((l=+l)>=1||$e("invalid cell size"),a=Math.floor(Math.log(l)/Math.LN2),o):1<<a},o.bandwidth=function(l){return arguments.length?(l=ct(l),l.length===1&&(l=[+l[0],+l[0]]),l.length!==2&&$e("invalid bandwidth"),r=l,o):r},o}function u2(e,t,n,r,i){const s=(i<<1)+1;for(let a=0;a<t;++a)for(let o=0,l=0;o<e+i;++o)o<e&&(l+=n[o+a*e]),o>=i&&(o>=s&&(l-=n[o-s+a*e]),r[o-i+a*e]=l/Math.min(o+1,e-1+s-o,s))}function c2(e,t,n,r,i){const s=(i<<1)+1;for(let a=0;a<e;++a)for(let o=0,l=0;o<t+i;++o)o<t&&(l+=n[a+o*e]),o>=i&&(o>=s&&(l-=n[a+(o-s)*e]),r[a+(o-i)*e]=l/Math.min(o+1,t-1+s-o,s))}function gae(e){me.call(this,null,e)}gae.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const xJt=["x","y","weight","size","cellSize","bandwidth"];function I8e(e,t){return xJt.forEach(n=>t[n]!=null?e[n](t[n]):0),e}Ne(gae,me,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=wJt(r,e.groupby),s=(e.groupby||[]).map(li),a=I8e(N8e(),e),o=e.as||"grid",l=[];function u(c,f){for(let h=0;h<s.length;++h)c[s[h]]=f[h];return c}return l=i.map(c=>Tn(u({[o]:a(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function wJt(e,t){var n=[],r=c=>c(o),i,s,a,o,l,u;if(t==null)n.push(e);else for(i={},s=0,a=e.length;s<a;++s)o=e[s],l=t.map(r),u=i[l],u||(i[l]=u=[],u.dims=l,n.push(u)),u.push(o);return n}function mae(e){me.call(this,null,e)}mae.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};Ne(mae,me,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=A8e().smooth(e.smooth!==!1),i=e.values,s=e.thresholds||T8e(e.count||10,e.nice,!!i),a=e.size,o,l;return i||(i=t.materialize(t.SOURCE).source,o=I8e(N8e(),e)(i,!0),l=D8e(o,o.scale||1,o.scale||1,0,0),a=[o.width,o.height],i=o.values),s=at(s)?s:s(i),i=r.size(a)(i,s),l&&i.forEach(l),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(Tn),n}});const mZ="Feature",vae="FeatureCollection",$Jt="MultiPoint";function yae(e){me.call(this,null,e)}yae.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};Ne(yae,me,{transform(e,t){var n=this._features,r=this._points,i=e.fields,s=i&&i[0],a=i&&i[1],o=e.geojson||!i&&ll,l=t.ADD,u;u=e.modified()||t.changed(t.REM)||t.modified(lo(o))||s&&t.modified(lo(s))||a&&t.modified(lo(a)),(!this.value||u)&&(l=t.SOURCE,this._features=n=[],this._points=r=[]),o&&t.visit(l,c=>n.push(o(c))),s&&a&&(t.visit(l,c=>{var f=s(c),h=a(c);f!=null&&h!=null&&(f=+f)===f&&(h=+h)===h&&r.push([f,h])}),n=n.concat({type:mZ,geometry:{type:$Jt,coordinates:r}})),this.value={type:vae,features:n}}});function bae(e){me.call(this,null,e)}bae.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};Ne(bae,me,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||ll,s=e.as||"path",a=n.SOURCE;!r||e.modified()?(this.value=r=z6e(e.projection),n.materialize().reflow()):a=i===ll||t.modified(i.fields)?n.ADD_MOD:n.ADD;const o=CJt(r,e.pointRadius);return n.visit(a,l=>l[s]=r(i(l))),r.pointRadius(o),n.modifies(s)}});function CJt(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function xae(e){me.call(this,null,e)}xae.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};Ne(xae,me,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],s=e.as||["x","y"],a=s[0],o=s[1],l;function u(c){const f=n([r(c),i(c)]);f?(c[a]=f[0],c[o]=f[1]):(c[a]=void 0,c[o]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(l=t.modified(r.fields)||t.modified(i.fields),t.visit(l?t.ADD_MOD:t.ADD,u)),t.modifies(s)}});function wae(e){me.call(this,null,e)}wae.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};Ne(wae,me,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",s=n.ADD;return(!r||e.modified())&&(this.value=r=_Jt(z6e(e.projection),e.field||ql("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,a=>a[i]=r),n.modifies(i)}});function _Jt(e,t,n){const r=n==null?i=>e(t(i)):i=>{var s=e.pointRadius(),a=e.pointRadius(n)(t(i));return e.pointRadius(s),a};return r.context=i=>(e.context(i),r),r}function $ae(e){me.call(this,[],e),this.generator=EQt()}$ae.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};Ne($ae,me,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const s in e)Ut(r[s])&&r[s](e[s]);return i=r(),n.length?t.mod.push(aRe(n[0],i)):t.add.push(Tn(i)),n[0]=i,t}});function Cae(e){me.call(this,null,e)}Cae.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};Ne(Cae,me,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||ll,s=kJt(e.opacity,e),a=SJt(e.color,e),o=e.as||"image",l={$x:0,$y:0,$value:0,$max:r?ny(n.map(u=>ny(i(u).values))):0};return n.forEach(u=>{const c=i(u),f=zt({},u,l);r||(f.$max=ny(c.values||[])),u[o]=EJt(c,f,a.dep?a:vo(a(f)),s.dep?s:vo(s(f)))}),t.reflow(!0).modifies(o)}});function SJt(e,t){let n;return Ut(e)?(n=r=>sm(e(r,t)),n.dep=M8e(e)):n=vo(sm(e||"#888")),n}function kJt(e,t){let n;return Ut(e)?(n=r=>e(r,t),n.dep=M8e(e)):e?n=vo(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function M8e(e){if(!Ut(e))return!1;const t=Rh(lo(e));return t.$x||t.$y||t.$value||t.$max}function EJt(e,t,n,r){const i=e.width,s=e.height,a=e.x1||0,o=e.y1||0,l=e.x2||i,u=e.y2||s,c=e.values,f=c?m=>c[m]:l1,h=Ku(l-a,u-o),d=h.getContext("2d"),p=d.getImageData(0,0,l-a,u-o),g=p.data;for(let m=o,v=0;m<u;++m){t.$y=m-o;for(let y=a,b=m*i;y<l;++y,v+=4){t.$x=y-a,t.$value=f(y+b);const x=n(t);g[v+0]=x.r,g[v+1]=x.g,g[v+2]=x.b,g[v+3]=~~(255*r(t))}}return d.putImageData(p,0,0),h}function F8e(e){me.call(this,null,e),this.modified(!0)}Ne(F8e,me,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=TJt(e.type),XK.forEach(r=>{e[r]!=null&&tbe(n,r,e[r])})):XK.forEach(r=>{e.modified(r)&&tbe(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&AJt(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function AJt(e,t){const n=DJt(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function TJt(e){const t=B6e((e||"mercator").toLowerCase());return t||$e("Unrecognized projection type: "+e),t()}function tbe(e,t,n){Ut(e[t])&&e[t](n)}function DJt(e){return e=ct(e),e.length===1?e[0]:{type:vae,features:e.reduce((t,n)=>t.concat(NJt(n)),[])}}function NJt(e){return e.type===vae?e.features:ct(e).filter(t=>t!=null).map(t=>t.type===mZ?t:{type:mZ,geometry:t})}const IJt=Object.freeze(Object.defineProperty({__proto__:null,contour:mae,geojson:yae,geopath:bae,geopoint:xae,geoshape:wae,graticule:$ae,heatmap:Cae,isocontour:pae,kde2d:gae,projection:F8e},Symbol.toStringTag,{value:"Module"}));function MJt(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,a=n.length,o,l=0,u=0;for(s=0;s<a;++s)o=n[s],l+=o.x,u+=o.y;for(l=(l/a-e)*r,u=(u/a-t)*r,s=0;s<a;++s)o=n[s],o.x-=l,o.y-=u}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function FJt(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return O8e(this.cover(t,n),t,n,e)}function O8e(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,a={data:r},o=e._x0,l=e._y0,u=e._x1,c=e._y1,f,h,d,p,g,m,v,y;if(!s)return e._root=a,e;for(;s.length;)if((g=t>=(f=(o+u)/2))?o=f:u=f,(m=n>=(h=(l+c)/2))?l=h:c=h,i=s,!(s=s[v=m<<1|g]))return i[v]=a,e;if(d=+e._x.call(null,s.data),p=+e._y.call(null,s.data),t===d&&n===p)return a.next=s,i?i[v]=a:e._root=a,e;do i=i?i[v]=new Array(4):e._root=new Array(4),(g=t>=(f=(o+u)/2))?o=f:u=f,(m=n>=(h=(l+c)/2))?l=h:c=h;while((v=m<<1|g)===(y=(p>=h)<<1|d>=f));return i[y]=s,i[v]=a,e}function OJt(e){var t,n,r=e.length,i,s,a=new Array(r),o=new Array(r),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(a[n]=i,o[n]=s,i<l&&(l=i),i>c&&(c=i),s<u&&(u=s),s>f&&(f=s));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<r;++n)O8e(this,a[n],o[n],e[n]);return this}function RJt(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var a=i-n||1,o=this._root,l,u;n>e||e>=i||r>t||t>=s;)switch(u=(t<r)<<1|e<n,l=new Array(4),l[u]=o,o=l,a*=2,u){case 0:i=n+a,s=r+a;break;case 1:n=i-a,s=r+a;break;case 2:i=n+a,r=s-a;break;case 3:n=i-a,r=s-a;break}this._root&&this._root.length&&(this._root=o)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function PJt(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function LJt(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ro(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function BJt(e,t,n){var r,i=this._x0,s=this._y0,a,o,l,u,c=this._x1,f=this._y1,h=[],d=this._root,p,g;for(d&&h.push(new ro(d,i,s,c,f)),n==null?n=1/0:(i=e-n,s=t-n,c=e+n,f=t+n,n*=n);p=h.pop();)if(!(!(d=p.node)||(a=p.x0)>c||(o=p.y0)>f||(l=p.x1)<i||(u=p.y1)<s))if(d.length){var m=(a+l)/2,v=(o+u)/2;h.push(new ro(d[3],m,v,l,u),new ro(d[2],a,v,m,u),new ro(d[1],m,o,l,v),new ro(d[0],a,o,m,v)),(g=(t>=v)<<1|e>=m)&&(p=h[h.length-1],h[h.length-1]=h[h.length-1-g],h[h.length-1-g]=p)}else{var y=e-+this._x.call(null,d.data),b=t-+this._y.call(null,d.data),x=y*y+b*b;if(x<n){var w=Math.sqrt(n=x);i=e-w,s=t-w,c=e+w,f=t+w,r=d.data}}return r}function zJt(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,a=this._x0,o=this._y0,l=this._x1,u=this._y1,c,f,h,d,p,g,m,v;if(!n)return this;if(n.length)for(;;){if((p=c>=(h=(a+l)/2))?a=h:l=h,(g=f>=(d=(o+u)/2))?o=d:u=d,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,v=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[m]=s:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[v]=n:this._root=n),this):(this._root=s,this)}function UJt(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function WJt(){return this._root}function VJt(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function jJt(e){var t=[],n,r=this._root,i,s,a,o,l;for(r&&t.push(new ro(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,a=n.y0,o=n.x1,l=n.y1)&&r.length){var u=(s+o)/2,c=(a+l)/2;(i=r[3])&&t.push(new ro(i,u,c,o,l)),(i=r[2])&&t.push(new ro(i,s,c,u,l)),(i=r[1])&&t.push(new ro(i,u,a,o,c)),(i=r[0])&&t.push(new ro(i,s,a,u,c))}return this}function HJt(e){var t=[],n=[],r;for(this._root&&t.push(new ro(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,a=r.x0,o=r.y0,l=r.x1,u=r.y1,c=(a+l)/2,f=(o+u)/2;(s=i[0])&&t.push(new ro(s,a,o,c,f)),(s=i[1])&&t.push(new ro(s,c,o,l,f)),(s=i[2])&&t.push(new ro(s,a,f,c,u)),(s=i[3])&&t.push(new ro(s,c,f,l,u))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function qJt(e){return e[0]}function GJt(e){return arguments.length?(this._x=e,this):this._x}function YJt(e){return e[1]}function XJt(e){return arguments.length?(this._y=e,this):this._y}function _ae(e,t,n){var r=new Sae(t==null?qJt:t,n==null?YJt:n,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function Sae(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function nbe(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Ao=_ae.prototype=Sae.prototype;Ao.copy=function(){var e=new Sae(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=nbe(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=nbe(r));return e};Ao.add=FJt;Ao.addAll=OJt;Ao.cover=RJt;Ao.data=PJt;Ao.extent=LJt;Ao.find=BJt;Ao.remove=zJt;Ao.removeAll=UJt;Ao.root=WJt;Ao.size=VJt;Ao.visit=jJt;Ao.visitAfter=HJt;Ao.x=GJt;Ao.y=XJt;function oo(e){return function(){return e}}function r0(e){return(e()-.5)*1e-6}function KJt(e){return e.x+e.vx}function ZJt(e){return e.y+e.vy}function QJt(e){var t,n,r,i=1,s=1;typeof e!="function"&&(e=oo(e==null?1:+e));function a(){for(var u,c=t.length,f,h,d,p,g,m,v=0;v<s;++v)for(f=_ae(t,KJt,ZJt).visitAfter(o),u=0;u<c;++u)h=t[u],g=n[h.index],m=g*g,d=h.x+h.vx,p=h.y+h.vy,f.visit(y);function y(b,x,w,C,$){var _=b.data,k=b.r,E=g+k;if(_){if(_.index>h.index){var S=d-_.x-_.vx,N=p-_.y-_.vy,A=S*S+N*N;A<E*E&&(S===0&&(S=r0(r),A+=S*S),N===0&&(N=r0(r),A+=N*N),A=(E-(A=Math.sqrt(A)))/A*i,h.vx+=(S*=A)*(E=(k*=k)/(m+k)),h.vy+=(N*=A)*E,_.vx-=S*(E=1-E),_.vy-=N*E)}return}return x>d+E||C<d-E||w>p+E||$<p-E}}function o(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(!!t){var u,c=t.length,f;for(n=new Array(c),u=0;u<c;++u)f=t[u],n[f.index]=+e(f,u,t)}}return a.initialize=function(u,c){t=u,r=c,l()},a.iterations=function(u){return arguments.length?(s=+u,a):s},a.strength=function(u){return arguments.length?(i=+u,a):i},a.radius=function(u){return arguments.length?(e=typeof u=="function"?u:oo(+u),l(),a):e},a}function JJt(e){return e.index}function rbe(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function een(e){var t=JJt,n=f,r,i=oo(30),s,a,o,l,u,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(o[m.source.index],o[m.target.index])}function h(m){for(var v=0,y=e.length;v<c;++v)for(var b=0,x,w,C,$,_,k,E;b<y;++b)x=e[b],w=x.source,C=x.target,$=C.x+C.vx-w.x-w.vx||r0(u),_=C.y+C.vy-w.y-w.vy||r0(u),k=Math.sqrt($*$+_*_),k=(k-s[b])/k*m*r[b],$*=k,_*=k,C.vx-=$*(E=l[b]),C.vy-=_*E,w.vx+=$*(E=1-E),w.vy+=_*E}function d(){if(!!a){var m,v=a.length,y=e.length,b=new Map(a.map((w,C)=>[t(w,C,a),w])),x;for(m=0,o=new Array(v);m<y;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=rbe(b,x.source)),typeof x.target!="object"&&(x.target=rbe(b,x.target)),o[x.source.index]=(o[x.source.index]||0)+1,o[x.target.index]=(o[x.target.index]||0)+1;for(m=0,l=new Array(y);m<y;++m)x=e[m],l[m]=o[x.source.index]/(o[x.source.index]+o[x.target.index]);r=new Array(y),p(),s=new Array(y),g()}}function p(){if(!!a)for(var m=0,v=e.length;m<v;++m)r[m]=+n(e[m],m,e)}function g(){if(!!a)for(var m=0,v=e.length;m<v;++m)s[m]=+i(e[m],m,e)}return h.initialize=function(m,v){a=m,u=v,d()},h.links=function(m){return arguments.length?(e=m,d(),h):e},h.id=function(m){return arguments.length?(t=m,h):t},h.iterations=function(m){return arguments.length?(c=+m,h):c},h.strength=function(m){return arguments.length?(n=typeof m=="function"?m:oo(+m),p(),h):n},h.distance=function(m){return arguments.length?(i=typeof m=="function"?m:oo(+m),g(),h):i},h}var ten={value:()=>{}};function R8e(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new $4(n)}function $4(e){this._=e}function nen(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}$4.prototype=R8e.prototype={constructor:$4,on:function(e,t){var n=this._,r=nen(e+"",n),i,s=-1,a=r.length;if(arguments.length<2){for(;++s<a;)if((i=(e=r[s]).type)&&(i=ren(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<a;)if(i=(e=r[s]).type)n[i]=ibe(n[i],e.name,t);else if(t==null)for(i in n)n[i]=ibe(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new $4(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function ren(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function ibe(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=ten,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var y$=0,ME=0,yk=0,P8e=1e3,NL,FE,IL=0,ib=0,q9=0,d3=typeof performance=="object"&&performance.now?performance:Date,L8e=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function kae(){return ib||(L8e(ien),ib=d3.now()+q9)}function ien(){ib=0}function ML(){this._call=this._time=this._next=null}ML.prototype=B8e.prototype={constructor:ML,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?kae():+n)+(t==null?0:+t),!this._next&&FE!==this&&(FE?FE._next=this:NL=this,FE=this),this._call=e,this._time=n,vZ()},stop:function(){this._call&&(this._call=null,this._time=1/0,vZ())}};function B8e(e,t,n){var r=new ML;return r.restart(e,t,n),r}function sen(){kae(),++y$;for(var e=NL,t;e;)(t=ib-e._time)>=0&&e._call.call(null,t),e=e._next;--y$}function sbe(){ib=(IL=d3.now())+q9,y$=ME=0;try{sen()}finally{y$=0,oen(),ib=0}}function aen(){var e=d3.now(),t=e-IL;t>P8e&&(q9-=t,IL=e)}function oen(){for(var e,t=NL,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:NL=n);FE=e,vZ(r)}function vZ(e){if(!y$){ME&&(ME=clearTimeout(ME));var t=e-ib;t>24?(e<1/0&&(ME=setTimeout(sbe,e-d3.now()-q9)),yk&&(yk=clearInterval(yk))):(yk||(IL=d3.now(),yk=setInterval(aen,P8e)),y$=1,L8e(sbe))}}function len(e,t,n){var r=new ML,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(s,a,o){a=+a,o=o==null?kae():+o,r._restart(function l(u){u+=i,r._restart(l,i+=a,o),s(u)},a,o)},r.restart(e,t,n),r)}const uen=1664525,cen=1013904223,abe=4294967296;function fen(){let e=1;return()=>(e=(uen*e+cen)%abe)/abe}function hen(e){return e.x}function den(e){return e.y}var pen=10,gen=Math.PI*(3-Math.sqrt(5));function men(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,a=.6,o=new Map,l=B8e(f),u=R8e("tick","end"),c=fen();e==null&&(e=[]);function f(){h(),u.call("tick",t),n<r&&(l.stop(),u.call("end",t))}function h(g){var m,v=e.length,y;g===void 0&&(g=1);for(var b=0;b<g;++b)for(n+=(s-n)*i,o.forEach(function(x){x(n)}),m=0;m<v;++m)y=e[m],y.fx==null?y.x+=y.vx*=a:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=a:(y.y=y.fy,y.vy=0);return t}function d(){for(var g=0,m=e.length,v;g<m;++g){if(v=e[g],v.index=g,v.fx!=null&&(v.x=v.fx),v.fy!=null&&(v.y=v.fy),isNaN(v.x)||isNaN(v.y)){var y=pen*Math.sqrt(.5+g),b=g*gen;v.x=y*Math.cos(b),v.y=y*Math.sin(b)}(isNaN(v.vx)||isNaN(v.vy))&&(v.vx=v.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return d(),t={tick:h,restart:function(){return l.restart(f),t},stop:function(){return l.stop(),t},nodes:function(g){return arguments.length?(e=g,d(),o.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(s=+g,t):s},velocityDecay:function(g){return arguments.length?(a=1-g,t):1-a},randomSource:function(g){return arguments.length?(c=g,o.forEach(p),t):c},force:function(g,m){return arguments.length>1?(m==null?o.delete(g):o.set(g,p(m)),t):o.get(g)},find:function(g,m,v){var y=0,b=e.length,x,w,C,$,_;for(v==null?v=1/0:v*=v,y=0;y<b;++y)$=e[y],x=g-$.x,w=m-$.y,C=x*x+w*w,C<v&&(_=$,v=C);return _},on:function(g,m){return arguments.length>1?(u.on(g,m),t):u.on(g)}}}function ven(){var e,t,n,r,i=oo(-30),s,a=1,o=1/0,l=.81;function u(d){var p,g=e.length,m=_ae(e,hen,den).visitAfter(f);for(r=d,p=0;p<g;++p)t=e[p],m.visit(h)}function c(){if(!!e){var d,p=e.length,g;for(s=new Array(p),d=0;d<p;++d)g=e[d],s[g.index]=+i(g,d,e)}}function f(d){var p=0,g,m,v=0,y,b,x;if(d.length){for(y=b=x=0;x<4;++x)(g=d[x])&&(m=Math.abs(g.value))&&(p+=g.value,v+=m,y+=m*g.x,b+=m*g.y);d.x=y/v,d.y=b/v}else{g=d,g.x=g.data.x,g.y=g.data.y;do p+=s[g.data.index];while(g=g.next)}d.value=p}function h(d,p,g,m){if(!d.value)return!0;var v=d.x-t.x,y=d.y-t.y,b=m-p,x=v*v+y*y;if(b*b/l<x)return x<o&&(v===0&&(v=r0(n),x+=v*v),y===0&&(y=r0(n),x+=y*y),x<a&&(x=Math.sqrt(a*x)),t.vx+=v*d.value*r/x,t.vy+=y*d.value*r/x),!0;if(d.length||x>=o)return;(d.data!==t||d.next)&&(v===0&&(v=r0(n),x+=v*v),y===0&&(y=r0(n),x+=y*y),x<a&&(x=Math.sqrt(a*x)));do d.data!==t&&(b=s[d.data.index]*r/x,t.vx+=v*b,t.vy+=y*b);while(d=d.next)}return u.initialize=function(d,p){e=d,n=p,c()},u.strength=function(d){return arguments.length?(i=typeof d=="function"?d:oo(+d),c(),u):i},u.distanceMin=function(d){return arguments.length?(a=d*d,u):Math.sqrt(a)},u.distanceMax=function(d){return arguments.length?(o=d*d,u):Math.sqrt(o)},u.theta=function(d){return arguments.length?(l=d*d,u):Math.sqrt(l)},u}function yen(e){var t=oo(.1),n,r,i;typeof e!="function"&&(e=oo(e==null?0:+e));function s(o){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vx+=(i[l]-c.x)*r[l]*o}function a(){if(!!n){var o,l=n.length;for(r=new Array(l),i=new Array(l),o=0;o<l;++o)r[o]=isNaN(i[o]=+e(n[o],o,n))?0:+t(n[o],o,n)}}return s.initialize=function(o){n=o,a()},s.strength=function(o){return arguments.length?(t=typeof o=="function"?o:oo(+o),a(),s):t},s.x=function(o){return arguments.length?(e=typeof o=="function"?o:oo(+o),a(),s):e},s}function ben(e){var t=oo(.1),n,r,i;typeof e!="function"&&(e=oo(e==null?0:+e));function s(o){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vy+=(i[l]-c.y)*r[l]*o}function a(){if(!!n){var o,l=n.length;for(r=new Array(l),i=new Array(l),o=0;o<l;++o)r[o]=isNaN(i[o]=+e(n[o],o,n))?0:+t(n[o],o,n)}}return s.initialize=function(o){n=o,a()},s.strength=function(o){return arguments.length?(t=typeof o=="function"?o:oo(+o),a(),s):t},s.y=function(o){return arguments.length?(e=typeof o=="function"?o:oo(+o),a(),s):e},s}const obe={center:MJt,collide:QJt,nbody:ven,link:een,x:yen,y:ben},OE="forces",yZ=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],xen=["static","iterations"],z8e=["x","y","vx","vy"];function Eae(e){me.call(this,null,e)}Eae.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:z8e}]};Ne(Eae,me,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(yZ),s=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&U8e(n,e,0,t)):(this.value=n=$en(t.source,e),n.on("tick",wen(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(xen)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let o=this._argops,l=0,u=o.length,c;l<u;++l)if(c=o[l],!(c.name!==OE||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,s=r.length,a;i<s;++i)if(r[i].name==="links"&&(a=r[i].op.source)){n.pulse(a,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(z8e)}});function wen(e,t){return()=>e.touch(t).run()}function $en(e,t){const n=men(e),r=n.stop,i=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,i()),n.stop=()=>(s=!0,r()),U8e(n,t,!0).on("end",()=>s=!0)}function U8e(e,t,n,r){var i=ct(t.forces),s,a,o,l;for(s=0,a=yZ.length;s<a;++s)o=yZ[s],o!==OE&&t.modified(o)&&e[o](t[o]);for(s=0,a=i.length;s<a;++s)l=OE+s,o=n||t.modified(OE,s)?_en(i[s]):r&&Cen(i[s],r)?e.force(l):null,o&&e.force(l,o);for(a=e.numForces||0;s<a;++s)e.force(OE+s,null);return e.numForces=i.length,e}function Cen(e,t){var n,r;for(n in e)if(Ut(r=e[n])&&t.modified(lo(r)))return 1;return 0}function _en(e){var t,n;bt(obe,e.force)||$e("Unrecognized force: "+e.force),t=obe[e.force]();for(n in e)Ut(t[n])&&Sen(t[n],e[n],e);return t}function Sen(e,t,n){e(Ut(t)?r=>t(r,n):t)}const ken=Object.freeze(Object.defineProperty({__proto__:null,force:Eae},Symbol.toStringTag,{value:"Module"}));function Een(e,t){return e.parent===t.parent?1:2}function Aen(e){return e.reduce(Ten,0)/e.length}function Ten(e,t){return e+t.x}function Den(e){return 1+e.reduce(Nen,0)}function Nen(e,t){return Math.max(e,t.y)}function Ien(e){for(var t;t=e.children;)e=t[0];return e}function Men(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Fen(){var e=Een,t=1,n=1,r=!1;function i(s){var a,o=0;s.eachAfter(function(h){var d=h.children;d?(h.x=Aen(d),h.y=Den(d)):(h.x=a?o+=e(h,a):0,h.y=0,a=h)});var l=Ien(s),u=Men(s),c=l.x-e(l,u)/2,f=u.x+e(u,l)/2;return s.eachAfter(r?function(h){h.x=(h.x-s.x)*t,h.y=(s.y-h.y)*n}:function(h){h.x=(h.x-c)/(f-c)*t,h.y=(1-(s.y?h.y/s.y:1))*n})}return i.separation=function(s){return arguments.length?(e=s,i):e},i.size=function(s){return arguments.length?(r=!1,t=+s[0],n=+s[1],i):r?null:[t,n]},i.nodeSize=function(s){return arguments.length?(r=!0,t=+s[0],n=+s[1],i):r?[t,n]:null},i}function Oen(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function Ren(){return this.eachAfter(Oen)}function Pen(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function Len(e,t){for(var n=this,r=[n],i,s,a=-1;n=r.pop();)if(e.call(t,n,++a,this),i=n.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function Ben(e,t){for(var n=this,r=[n],i=[],s,a,o,l=-1;n=r.pop();)if(i.push(n),s=n.children)for(a=0,o=s.length;a<o;++a)r.push(s[a]);for(;n=i.pop();)e.call(t,n,++l,this);return this}function zen(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function Uen(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Wen(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Ven(e){for(var t=this,n=jen(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function jen(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function Hen(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function qen(){return Array.from(this)}function Gen(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Yen(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*Xen(){var e=this,t,n=[e],r,i,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,s=r.length;i<s;++i)n.push(r[i]);while(n.length)}function Aae(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Qen)):t===void 0&&(t=Zen);for(var n=new b$(e),r,i=[n],s,a,o,l;r=i.pop();)if((a=t(r.data))&&(l=(a=Array.from(a)).length))for(r.children=a,o=l-1;o>=0;--o)i.push(s=a[o]=new b$(a[o])),s.parent=r,s.depth=r.depth+1;return n.eachBefore(W8e)}function Ken(){return Aae(this).eachBefore(Jen)}function Zen(e){return e.children}function Qen(e){return Array.isArray(e)?e[1]:null}function Jen(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function W8e(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function b$(e){this.data=e,this.depth=this.height=0,this.parent=null}b$.prototype=Aae.prototype={constructor:b$,count:Ren,each:Pen,eachAfter:Ben,eachBefore:Len,find:zen,sum:Uen,sort:Wen,path:Ven,ancestors:Hen,descendants:qen,leaves:Gen,links:Yen,copy:Ken,[Symbol.iterator]:Xen};function etn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ttn(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function ntn(e){for(var t=0,n=(e=ttn(Array.from(e))).length,r=[],i,s;t<n;)i=e[t],s&&V8e(s,i)?++t:(s=itn(r=rtn(r,i)),t=0);return s}function rtn(e,t){var n,r;if(LH(t,e))return[t];for(n=0;n<e.length;++n)if(iR(t,e[n])&&LH(RE(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(iR(RE(e[n],e[r]),t)&&iR(RE(e[n],t),e[r])&&iR(RE(e[r],t),e[n])&&LH(j8e(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function iR(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function V8e(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function LH(e,t){for(var n=0;n<t.length;++n)if(!V8e(e,t[n]))return!1;return!0}function itn(e){switch(e.length){case 1:return stn(e[0]);case 2:return RE(e[0],e[1]);case 3:return j8e(e[0],e[1],e[2])}}function stn(e){return{x:e.x,y:e.y,r:e.r}}function RE(e,t){var n=e.x,r=e.y,i=e.r,s=t.x,a=t.y,o=t.r,l=s-n,u=a-r,c=o-i,f=Math.sqrt(l*l+u*u);return{x:(n+s+l/f*c)/2,y:(r+a+u/f*c)/2,r:(f+i+o)/2}}function j8e(e,t,n){var r=e.x,i=e.y,s=e.r,a=t.x,o=t.y,l=t.r,u=n.x,c=n.y,f=n.r,h=r-a,d=r-u,p=i-o,g=i-c,m=l-s,v=f-s,y=r*r+i*i-s*s,b=y-a*a-o*o+l*l,x=y-u*u-c*c+f*f,w=d*p-h*g,C=(p*x-g*b)/(w*2)-r,$=(g*m-p*v)/w,_=(d*b-h*x)/(w*2)-i,k=(h*v-d*m)/w,E=$*$+k*k-1,S=2*(s+C*$+_*k),N=C*C+_*_-s*s,A=-(E?(S+Math.sqrt(S*S-4*E*N))/(2*E):N/S);return{x:r+C+$*A,y:i+_+k*A,r:A}}function lbe(e,t,n){var r=e.x-t.x,i,s,a=e.y-t.y,o,l,u=r*r+a*a;u?(s=t.r+n.r,s*=s,l=e.r+n.r,l*=l,s>l?(i=(u+l-s)/(2*u),o=Math.sqrt(Math.max(0,l/u-i*i)),n.x=e.x-i*r-o*a,n.y=e.y-i*a+o*r):(i=(u+s-l)/(2*u),o=Math.sqrt(Math.max(0,s/u-i*i)),n.x=t.x+i*r-o*a,n.y=t.y+i*a+o*r)):(n.x=t.x+n.r,n.y=t.y)}function ube(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function cbe(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,s=(t.y*n.r+n.y*t.r)/r;return i*i+s*s}function sR(e){this._=e,this.next=null,this.previous=null}function atn(e){if(!(i=(e=etn(e)).length))return 0;var t,n,r,i,s,a,o,l,u,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;lbe(n,t,r=e[2]),t=new sR(t),n=new sR(n),r=new sR(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(o=3;o<i;++o){lbe(t._,n._,r=e[o]),r=new sR(r),l=n.next,u=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(ube(l._,r._)){n=l,t.next=n,n.previous=t,--o;continue e}c+=l._.r,l=l.next}else{if(ube(u._,r._)){t=u,t.next=n,n.previous=t,--o;continue e}f+=u._.r,u=u.previous}while(l!==u.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,s=cbe(t);(r=r.next)!==n;)(a=cbe(r))<s&&(t=r,s=a);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=ntn(t),o=0;o<i;++o)t=e[o],t.x-=r.x,t.y-=r.y;return r.r}function otn(e){return e==null?null:FL(e)}function FL(e){if(typeof e!="function")throw new Error;return e}function d1(){return 0}function S2(e){return function(){return e}}function ltn(e){return Math.sqrt(e.value)}function utn(){var e=null,t=1,n=1,r=d1;function i(s){return s.x=t/2,s.y=n/2,e?s.eachBefore(fbe(e)).eachAfter(BH(r,.5)).eachBefore(hbe(1)):s.eachBefore(fbe(ltn)).eachAfter(BH(d1,1)).eachAfter(BH(r,s.r/Math.min(t,n))).eachBefore(hbe(Math.min(t,n)/(2*s.r))),s}return i.radius=function(s){return arguments.length?(e=otn(s),i):e},i.size=function(s){return arguments.length?(t=+s[0],n=+s[1],i):[t,n]},i.padding=function(s){return arguments.length?(r=typeof s=="function"?s:S2(+s),i):r},i}function fbe(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function BH(e,t){return function(n){if(r=n.children){var r,i,s=r.length,a=e(n)*t||0,o;if(a)for(i=0;i<s;++i)r[i].r+=a;if(o=atn(r),a)for(i=0;i<s;++i)r[i].r-=a;n.r=o+a}}}function hbe(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function H8e(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function $M(e,t,n,r,i){for(var s=e.children,a,o=-1,l=s.length,u=e.value&&(r-t)/e.value;++o<l;)a=s[o],a.y0=n,a.y1=i,a.x0=t,a.x1=t+=a.value*u}function ctn(){var e=1,t=1,n=0,r=!1;function i(a){var o=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/o,a.eachBefore(s(t,o)),r&&a.eachBefore(H8e),a}function s(a,o){return function(l){l.children&&$M(l,l.x0,a*(l.depth+1)/o,l.x1,a*(l.depth+2)/o);var u=l.x0,c=l.y0,f=l.x1-n,h=l.y1-n;f<u&&(u=f=(u+f)/2),h<c&&(c=h=(c+h)/2),l.x0=u,l.y0=c,l.x1=f,l.y1=h}}return i.round=function(a){return arguments.length?(r=!!a,i):r},i.size=function(a){return arguments.length?(e=+a[0],t=+a[1],i):[e,t]},i.padding=function(a){return arguments.length?(n=+a,i):n},i}var ftn={depth:-1},dbe={};function htn(e){return e.id}function dtn(e){return e.parentId}function pbe(){var e=htn,t=dtn;function n(r){var i=Array.from(r),s=i.length,a,o,l,u,c,f,h,d=new Map;for(o=0;o<s;++o)a=i[o],c=i[o]=new b$(a),(f=e(a,o,r))!=null&&(f+="")&&(h=c.id=f,d.set(h,d.has(h)?dbe:c)),(f=t(a,o,r))!=null&&(f+="")&&(c.parent=f);for(o=0;o<s;++o)if(c=i[o],f=c.parent){if(u=d.get(f),!u)throw new Error("missing: "+f);if(u===dbe)throw new Error("ambiguous: "+f);u.children?u.children.push(c):u.children=[c],c.parent=u}else{if(l)throw new Error("multiple roots");l=c}if(!l)throw new Error("no root");if(l.parent=ftn,l.eachBefore(function(p){p.depth=p.parent.depth+1,--s}).eachBefore(W8e),l.parent=null,s>0)throw new Error("cycle");return l}return n.id=function(r){return arguments.length?(e=FL(r),n):e},n.parentId=function(r){return arguments.length?(t=FL(r),n):t},n}function ptn(e,t){return e.parent===t.parent?1:2}function zH(e){var t=e.children;return t?t[0]:e.t}function UH(e){var t=e.children;return t?t[t.length-1]:e.t}function gtn(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function mtn(e){for(var t=0,n=0,r=e.children,i=r.length,s;--i>=0;)s=r[i],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function vtn(e,t,n){return e.a.parent===t.parent?e.a:n}function C4(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}C4.prototype=Object.create(b$.prototype);function ytn(e){for(var t=new C4(e,0),n,r=[t],i,s,a,o;n=r.pop();)if(s=n._.children)for(n.children=new Array(o=s.length),a=o-1;a>=0;--a)r.push(i=n.children[a]=new C4(s[a],a)),i.parent=n;return(t.parent=new C4(null,0)).children=[t],t}function btn(){var e=ptn,t=1,n=1,r=null;function i(u){var c=ytn(u);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(a),r)u.eachBefore(l);else{var f=u,h=u,d=u;u.eachBefore(function(y){y.x<f.x&&(f=y),y.x>h.x&&(h=y),y.depth>d.depth&&(d=y)});var p=f===h?1:e(f,h)/2,g=p-f.x,m=t/(h.x+p+g),v=n/(d.depth||1);u.eachBefore(function(y){y.x=(y.x+g)*m,y.y=y.depth*v})}return u}function s(u){var c=u.children,f=u.parent.children,h=u.i?f[u.i-1]:null;if(c){mtn(u);var d=(c[0].z+c[c.length-1].z)/2;h?(u.z=h.z+e(u._,h._),u.m=u.z-d):u.z=d}else h&&(u.z=h.z+e(u._,h._));u.parent.A=o(u,h,u.parent.A||f[0])}function a(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function o(u,c,f){if(c){for(var h=u,d=u,p=c,g=h.parent.children[0],m=h.m,v=d.m,y=p.m,b=g.m,x;p=UH(p),h=zH(h),p&&h;)g=zH(g),d=UH(d),d.a=u,x=p.z+y-h.z-m+e(p._,h._),x>0&&(gtn(vtn(p,u,f),u,x),m+=x,v+=x),y+=p.m,m+=h.m,b+=g.m,v+=d.m;p&&!UH(d)&&(d.t=p,d.m+=y-v),h&&!zH(g)&&(g.t=h,g.m+=m-b,f=u)}return f}function l(u){u.x*=t,u.y=u.depth*n}return i.separation=function(u){return arguments.length?(e=u,i):e},i.size=function(u){return arguments.length?(r=!1,t=+u[0],n=+u[1],i):r?null:[t,n]},i.nodeSize=function(u){return arguments.length?(r=!0,t=+u[0],n=+u[1],i):r?[t,n]:null},i}function G9(e,t,n,r,i){for(var s=e.children,a,o=-1,l=s.length,u=e.value&&(i-n)/e.value;++o<l;)a=s[o],a.x0=t,a.x1=r,a.y0=n,a.y1=n+=a.value*u}var q8e=(1+Math.sqrt(5))/2;function G8e(e,t,n,r,i,s){for(var a=[],o=t.children,l,u,c=0,f=0,h=o.length,d,p,g=t.value,m,v,y,b,x,w,C;c<h;){d=i-n,p=s-r;do m=o[f++].value;while(!m&&f<h);for(v=y=m,w=Math.max(p/d,d/p)/(g*e),C=m*m*w,x=Math.max(y/C,C/v);f<h;++f){if(m+=u=o[f].value,u<v&&(v=u),u>y&&(y=u),C=m*m*w,b=Math.max(y/C,C/v),b>x){m-=u;break}x=b}a.push(l={value:m,dice:d<p,children:o.slice(c,f)}),l.dice?$M(l,n,r,i,g?r+=p*m/g:s):G9(l,n,r,g?n+=d*m/g:i,s),g-=m,c=f}return a}const Y8e=function e(t){function n(r,i,s,a,o){G8e(t,r,i,s,a,o)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(q8e);function xtn(){var e=Y8e,t=!1,n=1,r=1,i=[0],s=d1,a=d1,o=d1,l=d1,u=d1;function c(h){return h.x0=h.y0=0,h.x1=n,h.y1=r,h.eachBefore(f),i=[0],t&&h.eachBefore(H8e),h}function f(h){var d=i[h.depth],p=h.x0+d,g=h.y0+d,m=h.x1-d,v=h.y1-d;m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),h.x0=p,h.y0=g,h.x1=m,h.y1=v,h.children&&(d=i[h.depth+1]=s(h)/2,p+=u(h)-d,g+=a(h)-d,m-=o(h)-d,v-=l(h)-d,m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),e(h,p,g,m,v))}return c.round=function(h){return arguments.length?(t=!!h,c):t},c.size=function(h){return arguments.length?(n=+h[0],r=+h[1],c):[n,r]},c.tile=function(h){return arguments.length?(e=FL(h),c):e},c.padding=function(h){return arguments.length?c.paddingInner(h).paddingOuter(h):c.paddingInner()},c.paddingInner=function(h){return arguments.length?(s=typeof h=="function"?h:S2(+h),c):s},c.paddingOuter=function(h){return arguments.length?c.paddingTop(h).paddingRight(h).paddingBottom(h).paddingLeft(h):c.paddingTop()},c.paddingTop=function(h){return arguments.length?(a=typeof h=="function"?h:S2(+h),c):a},c.paddingRight=function(h){return arguments.length?(o=typeof h=="function"?h:S2(+h),c):o},c.paddingBottom=function(h){return arguments.length?(l=typeof h=="function"?h:S2(+h),c):l},c.paddingLeft=function(h){return arguments.length?(u=typeof h=="function"?h:S2(+h),c):u},c}function wtn(e,t,n,r,i){var s=e.children,a,o=s.length,l,u=new Array(o+1);for(u[0]=l=a=0;a<o;++a)u[a+1]=l+=s[a].value;c(0,o,e.value,t,n,r,i);function c(f,h,d,p,g,m,v){if(f>=h-1){var y=s[f];y.x0=p,y.y0=g,y.x1=m,y.y1=v;return}for(var b=u[f],x=d/2+b,w=f+1,C=h-1;w<C;){var $=w+C>>>1;u[$]<x?w=$+1:C=$}x-u[w-1]<u[w]-x&&f+1<w&&--w;var _=u[w]-b,k=d-_;if(m-p>v-g){var E=d?(p*k+m*_)/d:m;c(f,w,_,p,g,E,v),c(w,h,k,E,g,m,v)}else{var S=d?(g*k+v*_)/d:v;c(f,w,_,p,g,m,S),c(w,h,k,p,S,m,v)}}}function $tn(e,t,n,r,i){(e.depth&1?G9:$M)(e,t,n,r,i)}const Ctn=function e(t){function n(r,i,s,a,o){if((l=r._squarify)&&l.ratio===t)for(var l,u,c,f,h=-1,d,p=l.length,g=r.value;++h<p;){for(u=l[h],c=u.children,f=u.value=0,d=c.length;f<d;++f)u.value+=c[f].value;u.dice?$M(u,i,s,a,g?s+=(o-s)*u.value/g:o):G9(u,i,s,g?i+=(a-i)*u.value/g:a,o),g-=u.value}else r._squarify=l=G8e(t,r,i,s,a,o),l.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(q8e);function bZ(e,t,n){const r={};return e.each(i=>{const s=i.data;n(s)&&(r[t(s)]=i)}),e.lookup=r,e}function Tae(e){me.call(this,null,e)}Tae.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const _tn=e=>e.values;Ne(Tae,me,{transform(e,t){t.source||$e("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),s=this.value;return(!s||r||t.changed())&&(s&&s.each(a=>{a.children&&U_(a.data)&&i.rem.push(a.data)}),this.value=s=Aae({values:ct(e.keys).reduce((a,o)=>(a.key(o),a),Stn()).entries(i.source)},_tn),n&&s.each(a=>{a.children&&(a=Tn(a.data),i.add.push(a),i.source.push(a))}),bZ(s,nt,nt)),i.source.root=s,i}});function Stn(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,s){if(s>=e.length)return i;const a=i.length,o=e[s++],l={},u={};let c=-1,f,h,d;for(;++c<a;)f=o(h=i[c])+"",(d=l[f])?d.push(h):l[f]=[h];for(f in l)u[f]=n(l[f],s);return u}function r(i,s){if(++s>e.length)return i;const a=[];for(const o in i)a.push({key:o,values:r(i[o],s)});return a}return t}function hg(e){me.call(this,null,e)}const ktn=(e,t)=>e.parent===t.parent?1:2;Ne(hg,me,{transform(e,t){(!t.source||!t.source.root)&&$e(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,s=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(ix(e.sort,a=>a.data)),Etn(n,this.params,e),n.separation&&n.separation(e.separation!==!1?ktn:XI);try{this.value=n(i)}catch(a){$e(a)}return i.each(a=>Atn(a,r,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});function Etn(e,t,n){for(let r,i=0,s=t.length;i<s;++i)r=t[i],r in n&&e[r](n[r])}function Atn(e,t,n){const r=e.data,i=t.length-1;for(let s=0;s<i;++s)r[n[s]]=e[t[s]];r[n[i]]=e.children?e.children.length:0}const xZ=["x","y","r","depth","children"];function Dae(e){hg.call(this,e)}Dae.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:xZ.length,default:xZ}]};Ne(Dae,hg,{layout:utn,params:["radius","size","padding"],fields:xZ});const wZ=["x0","y0","x1","y1","depth","children"];function Nae(e){hg.call(this,e)}Nae.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:wZ.length,default:wZ}]};Ne(Nae,hg,{layout:ctn,params:["size","round","padding"],fields:wZ});function Iae(e){me.call(this,null,e)}Iae.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};Ne(Iae,me,{transform(e,t){t.source||$e("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),s=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),s&&(n=i.source.length?bZ(pbe().id(e.key).parentId(e.parentKey)(i.source),e.key,ef):bZ(pbe()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const gbe={tidy:btn,cluster:Fen},$Z=["x","y","depth","children"];function Mae(e){hg.call(this,e)}Mae.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:$Z.length,default:$Z}]};Ne(Mae,hg,{layout(e){const t=e||"tidy";if(bt(gbe,t))return gbe[t]();$e("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:$Z});function Fae(e){me.call(this,[],e)}Fae.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};Ne(Fae,me,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),s={};return r||$e("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,a=>s[nt(a)]=1),r.each(a=>{const o=a.data,l=a.parent&&a.parent.data;l&&s[nt(o)]&&s[nt(l)]&&i.add.push(Tn({source:l,target:o}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,a=>s[nt(a)]=1),n.forEach(a=>{(s[nt(a.source)]||s[nt(a.target)])&&i.mod.push(a)})),i}});const mbe={binary:wtn,dice:$M,slice:G9,slicedice:$tn,squarify:Y8e,resquarify:Ctn},CZ=["x0","y0","x1","y1","depth","children"];function Oae(e){hg.call(this,e)}Oae.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:CZ.length,default:CZ}]};Ne(Oae,hg,{layout(){const e=xtn();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{bt(mbe,t)?e.tile(mbe[t]):$e("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:CZ});const Ttn=Object.freeze(Object.defineProperty({__proto__:null,nest:Tae,pack:Dae,partition:Nae,stratify:Iae,tree:Mae,treelinks:Fae,treemap:Oae},Symbol.toStringTag,{value:"Module"})),Dtn=4278190080,Ntn=268435456,Itn=.0625;function Mtn(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function Ftn(e,t,n,r){const i=e.width,s=e.height,a=n||r,o=Ku(i,s).getContext("2d");t.forEach(m=>X8e(o,m,a));const l=new Uint32Array(o.getImageData(0,0,i,s).data.buffer),u=e.bitmap(),c=a&&e.bitmap();let f,h,d,p,g;for(h=0;h<s;++h)for(f=0;f<i;++f)g=l[h*i+f]&Dtn,g&&(d=e(f),p=e(h),r||u.set(d,p),a&&g^Ntn&&c.set(d,p));return[u,c]}function X8e(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(s=>X8e(e,s.items,n))}):Bu[r].draw(e,{items:n?t.map(Otn):t})}function Otn(e){const t=i9(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=Itn,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const Id=5,Ua=31,p3=32,zg=new Uint32Array(p3+1),wc=new Uint32Array(p3+1);wc[0]=0;zg[0]=~wc[0];for(let e=1;e<=p3;++e)wc[e]=wc[e-1]<<1|1,zg[e]=~wc[e];function Rtn(e,t){const n=new Uint32Array(~~((e*t+p3)/p3));function r(s,a){n[s]|=a}function i(s,a){n[s]&=a}return{array:n,get:(s,a)=>{const o=a*e+s;return n[o>>>Id]&1<<(o&Ua)},set:(s,a)=>{const o=a*e+s;r(o>>>Id,1<<(o&Ua))},clear:(s,a)=>{const o=a*e+s;i(o>>>Id,~(1<<(o&Ua)))},getRange:(s,a,o,l)=>{let u=l,c,f,h,d;for(;u>=a;--u)if(c=u*e+s,f=u*e+o,h=c>>>Id,d=f>>>Id,h===d){if(n[h]&zg[c&Ua]&wc[(f&Ua)+1])return!0}else{if(n[h]&zg[c&Ua]||n[d]&wc[(f&Ua)+1])return!0;for(let p=h+1;p<d;++p)if(n[p])return!0}return!1},setRange:(s,a,o,l)=>{let u,c,f,h,d;for(;a<=l;++a)if(u=a*e+s,c=a*e+o,f=u>>>Id,h=c>>>Id,f===h)r(f,zg[u&Ua]&wc[(c&Ua)+1]);else for(r(f,zg[u&Ua]),r(h,wc[(c&Ua)+1]),d=f+1;d<h;++d)r(d,4294967295)},clearRange:(s,a,o,l)=>{let u,c,f,h,d;for(;a<=l;++a)if(u=a*e+s,c=a*e+o,f=u>>>Id,h=c>>>Id,f===h)i(f,wc[u&Ua]|zg[(c&Ua)+1]);else for(i(f,wc[u&Ua]),i(h,zg[(c&Ua)+1]),d=f+1;d<h;++d)i(d,0)},outOfBounds:(s,a,o,l)=>s<0||a<0||l>=t||o>=e}}function Ptn(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),s=~~((t+2*n+r)/r),a=o=>~~((o+n)/r);return a.invert=o=>o*r-n,a.bitmap=()=>Rtn(i,s),a.ratio=r,a.padding=n,a.width=e,a.height=t,a}function Ltn(e,t,n,r){const i=e.width,s=e.height;return function(a){const o=a.datum.datum.items[r].items,l=o.length,u=a.datum.fontSize,c=bp.width(a.datum,a.datum.text);let f=0,h,d,p,g,m,v,y;for(let b=0;b<l;++b)h=o[b].x,p=o[b].y,d=o[b].x2===void 0?h:o[b].x2,g=o[b].y2===void 0?p:o[b].y2,m=(h+d)/2,v=(p+g)/2,y=Math.abs(d-h+g-p),y>=f&&(f=y,a.x=m,a.y=v);return m=c/2,v=u/2,h=a.x-m,d=a.x+m,p=a.y-v,g=a.y+v,a.align="center",h<0&&d<=i?a.align="left":0<=h&&i<d&&(a.align="right"),a.baseline="middle",p<0&&g<=s?a.baseline="top":0<=p&&s<g&&(a.baseline="bottom"),!0}}function OL(e,t,n,r,i,s){let a=n/2;return e-a<0||e+a>i||t-(a=r/2)<0||t+a>s}function i0(e,t,n,r,i,s,a,o){const l=i*s/(r*2),u=e(t-l),c=e(t+l),f=e(n-(s=s/2)),h=e(n+s);return a.outOfBounds(u,f,c,h)||a.getRange(u,f,c,h)||o&&o.getRange(u,f,c,h)}function Btn(e,t,n,r){const i=e.width,s=e.height,a=t[0],o=t[1];function l(u,c,f,h,d){const p=e.invert(u),g=e.invert(c);let m=f,v=s,y;if(!OL(p,g,h,d,i,s)&&!i0(e,p,g,d,h,m,a,o)&&!i0(e,p,g,d,h,d,a,null)){for(;v-m>=1;)y=(m+v)/2,i0(e,p,g,d,h,y,a,o)?v=y:m=y;if(m>f)return[p,g,m,!0]}}return function(u){const c=u.datum.datum.items[r].items,f=c.length,h=u.datum.fontSize,d=bp.width(u.datum,u.datum.text);let p=n?h:0,g=!1,m=!1,v=0,y,b,x,w,C,$,_,k,E,S,N,A,D,T,I,F,R;for(let P=0;P<f;++P){for(y=c[P].x,x=c[P].y,b=c[P].x2===void 0?y:c[P].x2,w=c[P].y2===void 0?x:c[P].y2,y>b&&(R=y,y=b,b=R),x>w&&(R=x,x=w,w=R),E=e(y),N=e(b),S=~~((E+N)/2),A=e(x),T=e(w),D=~~((A+T)/2),_=S;_>=E;--_)for(k=D;k>=A;--k)F=l(_,k,p,d,h),F&&([u.x,u.y,p,g]=F);for(_=S;_<=N;++_)for(k=D;k<=T;++k)F=l(_,k,p,d,h),F&&([u.x,u.y,p,g]=F);!g&&!n&&(I=Math.abs(b-y+w-x),C=(y+b)/2,$=(x+w)/2,I>=v&&!OL(C,$,d,h,i,s)&&!i0(e,C,$,h,d,h,a,null)&&(v=I,u.x=C,u.y=$,m=!0))}return g||m?(C=d/2,$=h/2,a.setRange(e(u.x-C),e(u.y-$),e(u.x+C),e(u.y+$)),u.align="center",u.baseline="middle",!0):!1}}const ztn=[-1,-1,1,1],Utn=[-1,1,-1,1];function Wtn(e,t,n,r){const i=e.width,s=e.height,a=t[0],o=t[1],l=e.bitmap();return function(u){const c=u.datum.datum.items[r].items,f=c.length,h=u.datum.fontSize,d=bp.width(u.datum,u.datum.text),p=[];let g=n?h:0,m=!1,v=!1,y=0,b,x,w,C,$,_,k,E,S,N,A,D;for(let T=0;T<f;++T){for(b=c[T].x,w=c[T].y,x=c[T].x2===void 0?b:c[T].x2,C=c[T].y2===void 0?w:c[T].y2,p.push([e((b+x)/2),e((w+C)/2)]);p.length;)if([k,E]=p.pop(),!(a.get(k,E)||o.get(k,E)||l.get(k,E))){l.set(k,E);for(let I=0;I<4;++I)$=k+ztn[I],_=E+Utn[I],l.outOfBounds($,_,$,_)||p.push([$,_]);if($=e.invert(k),_=e.invert(E),S=g,N=s,!OL($,_,d,h,i,s)&&!i0(e,$,_,h,d,S,a,o)&&!i0(e,$,_,h,d,h,a,null)){for(;N-S>=1;)A=(S+N)/2,i0(e,$,_,h,d,A,a,o)?N=A:S=A;S>g&&(u.x=$,u.y=_,g=S,m=!0)}}!m&&!n&&(D=Math.abs(x-b+C-w),$=(b+x)/2,_=(w+C)/2,D>=y&&!OL($,_,d,h,i,s)&&!i0(e,$,_,h,d,h,a,null)&&(y=D,u.x=$,u.y=_,v=!0))}return m||v?($=d/2,_=h/2,a.setRange(e(u.x-$),e(u.y-_),e(u.x+$),e(u.y+_)),u.align="center",u.baseline="middle",!0):!1}}const Vtn=["right","center","left"],jtn=["bottom","middle","top"];function Htn(e,t,n,r){const i=e.width,s=e.height,a=t[0],o=t[1],l=r.length;return function(u){const c=u.boundary,f=u.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>s)return!1;let h=0,d,p,g,m,v,y,b,x,w,C,$,_,k,E,S;for(let N=0;N<l;++N){if(d=(n[N]&3)-1,p=(n[N]>>>2&3)-1,g=d===0&&p===0||r[N]<0,m=d&&p?Math.SQRT1_2:1,v=r[N]<0?-1:1,y=c[1+d]+r[N]*d*m,$=c[4+p]+v*f*p/2+r[N]*p*m,x=$-f/2,w=$+f/2,_=e(y),E=e(x),S=e(w),!h)if(vbe(_,_,E,S,a,o,y,y,x,w,c,g))h=bp.width(u.datum,u.datum.text);else continue;if(C=y+v*h*d/2,y=C-h/2,b=C+h/2,_=e(y),k=e(b),vbe(_,k,E,S,a,o,y,b,x,w,c,g))return u.x=d?d*v<0?b:y:C,u.y=p?p*v<0?w:x:$,u.align=Vtn[d*v+1],u.baseline=jtn[p*v+1],a.setRange(_,E,k,S),!0}return!1}}function vbe(e,t,n,r,i,s,a,o,l,u,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&s?s.getRange(e,n,t,r)||!qtn(a,l,o,u,c):i.getRange(e,n,t,r)))}function qtn(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}const WH=0,VH=4,jH=8,HH=0,qH=1,GH=2,Gtn={"top-left":WH+HH,top:WH+qH,"top-right":WH+GH,left:VH+HH,middle:VH+qH,right:VH+GH,"bottom-left":jH+HH,bottom:jH+qH,"bottom-right":jH+GH},Ytn={naive:Ltn,"reduced-search":Btn,floodfill:Wtn};function Xtn(e,t,n,r,i,s,a,o,l,u,c){if(!e.length)return e;const f=Math.max(r.length,i.length),h=Ktn(r,f),d=Ztn(i,f),p=Qtn(e[0].datum),g=p==="group"&&e[0].datum.items[l].marktype,m=g==="area",v=Jtn(p,g,o,l),y=Ptn(t[0],t[1],u),b=m&&c==="naive",x=e.map($=>({datum:$,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:v($)}));let w;if(!b){n&&x.sort((_,k)=>n(_.datum,k.datum));let $=!1;for(let _=0;_<d.length&&!$;++_)$=d[_]===5||h[_]<0;p&&(a||m)&&(s=[e.map(_=>_.datum)].concat(s)),w=s.length?Ftn(y,s,$,m):Mtn(y,a&&x)}const C=m?Ytn[c](y,w,a,l):Htn(y,w,d,h);return x.forEach($=>$.opacity=+C($)),x}function Ktn(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Ztn(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=Gtn[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Qtn(e){return e&&e.mark&&e.mark.marktype}function Jtn(e,t,n,r){const i=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?e==="line"||e==="area"?s=>i(s.datum):t==="line"?s=>{const a=s.datum.items[r].items;return i(a.length?a[n==="start"?0:a.length-1]:{x:NaN,y:NaN})}:s=>{const a=s.datum.bounds;return[a.x1,(a.x1+a.x2)/2,a.x2,a.y1,(a.y1+a.y2)/2,a.y2]}:i}const _Z=["x","y","opacity","align","baseline"],K8e=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function Rae(e){me.call(this,null,e)}Rae.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:K8e},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:_Z.length,default:_Z}]};Ne(Rae,me,{transform(e,t){function n(s){const a=e[s];return Ut(a)&&t.modified(a.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&$e("Size parameter should be specified as a [width, height] array.");const i=e.as||_Z;return Xtn(t.materialize(t.SOURCE).source,e.size,e.sort,ct(e.offset||1),ct(e.anchor||K8e),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach(s=>{const a=s.datum;a[i[0]]=s.x,a[i[1]]=s.y,a[i[2]]=s.opacity,a[i[3]]=s.align,a[i[4]]=s.baseline}),t.reflow(r).modifies(i)}});const enn=Object.freeze(Object.defineProperty({__proto__:null,label:Rae},Symbol.toStringTag,{value:"Module"}));function Z8e(e,t){var n=[],r=function(c){return c(o)},i,s,a,o,l,u;if(t==null)n.push(e);else for(i={},s=0,a=e.length;s<a;++s)o=e[s],l=t.map(r),u=i[l],u||(i[l]=u=[],u.dims=l,n.push(u)),u.push(o);return n}function Pae(e){me.call(this,null,e)}Pae.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};Ne(Pae,me,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Z8e(r,e.groupby),s=(e.groupby||[]).map(li),a=s.length,o=e.as||[li(e.x),li(e.y)],l=[];i.forEach(u=>{y9t(u,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let h=0;h<a;++h)f[s[h]]=u.dims[h];f[o[0]]=c[0],f[o[1]]=c[1],l.push(Tn(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const SZ={linear:DRe,log:h9t,exp:d9t,pow:p9t,quad:NRe,poly:g9t},tnn=(e,t)=>e==="poly"?t:e==="quad"?2:1;function Lae(e){me.call(this,null,e)}Lae.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(SZ)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};Ne(Lae,me,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Z8e(r,e.groupby),s=(e.groupby||[]).map(li),a=e.method||"linear",o=e.order||3,l=tnn(a,o),u=e.as||[li(e.x),li(e.y)],c=SZ[a],f=[];let h=e.extent;bt(SZ,a)||$e("Invalid regression method: "+a),h!=null&&a==="log"&&h[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),h=null),i.forEach(d=>{if(d.length<=l){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(d,e.x,e.y,o);if(e.params){f.push(Tn({keys:d.dims,coef:g.coef,rSquared:g.rSquared}));return}const m=h||Rp(d,e.x),v=y=>{const b={};for(let x=0;x<s.length;++x)b[s[x]]=d.dims[x];b[u[0]]=y[0],b[u[1]]=y[1],f.push(Tn(b))};a==="linear"?m.forEach(y=>v([y,g.predict(y)])):eie(g.predict,m,25,200).forEach(v)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const nnn=Object.freeze(Object.defineProperty({__proto__:null,loess:Pae,regression:Lae},Symbol.toStringTag,{value:"Module"})),ybe=Math.pow(2,-52),aR=new Uint32Array(512);class RL{static from(t,n=onn,r=lnn){const i=t.length,s=new Float64Array(i*2);for(let a=0;a<i;a++){const o=t[a];s[2*a]=n(o),s[2*a+1]=r(o)}return new RL(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:s}=this,a=t.length>>1;let o=1/0,l=1/0,u=-1/0,c=-1/0;for(let E=0;E<a;E++){const S=t[2*E],N=t[2*E+1];S<o&&(o=S),N<l&&(l=N),S>u&&(u=S),N>c&&(c=N),this._ids[E]=E}const f=(o+u)/2,h=(l+c)/2;let d=1/0,p,g,m;for(let E=0;E<a;E++){const S=YH(f,h,t[2*E],t[2*E+1]);S<d&&(p=E,d=S)}const v=t[2*p],y=t[2*p+1];d=1/0;for(let E=0;E<a;E++){if(E===p)continue;const S=YH(v,y,t[2*E],t[2*E+1]);S<d&&S>0&&(g=E,d=S)}let b=t[2*g],x=t[2*g+1],w=1/0;for(let E=0;E<a;E++){if(E===p||E===g)continue;const S=snn(v,y,b,x,t[2*E],t[2*E+1]);S<w&&(m=E,w=S)}let C=t[2*m],$=t[2*m+1];if(w===1/0){for(let N=0;N<a;N++)this._dists[N]=t[2*N]-t[0]||t[2*N+1]-t[1];R2(this._ids,this._dists,0,a-1);const E=new Uint32Array(a);let S=0;for(let N=0,A=-1/0;N<a;N++){const D=this._ids[N];this._dists[D]>A&&(E[S++]=D,A=this._dists[D])}this.hull=E.subarray(0,S),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(oR(v,y,b,x,C,$)){const E=g,S=b,N=x;g=m,b=C,x=$,m=E,C=S,$=N}const _=ann(v,y,b,x,C,$);this._cx=_.x,this._cy=_.y;for(let E=0;E<a;E++)this._dists[E]=YH(t[2*E],t[2*E+1],_.x,_.y);R2(this._ids,this._dists,0,a-1),this._hullStart=p;let k=3;r[p]=n[m]=g,r[g]=n[p]=m,r[m]=n[g]=p,i[p]=0,i[g]=1,i[m]=2,s.fill(-1),s[this._hashKey(v,y)]=p,s[this._hashKey(b,x)]=g,s[this._hashKey(C,$)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let E=0,S,N;E<this._ids.length;E++){const A=this._ids[E],D=t[2*A],T=t[2*A+1];if(E>0&&Math.abs(D-S)<=ybe&&Math.abs(T-N)<=ybe||(S=D,N=T,A===p||A===g||A===m))continue;let I=0;for(let z=0,q=this._hashKey(D,T);z<this._hashSize&&(I=s[(q+z)%this._hashSize],!(I!==-1&&I!==r[I]));z++);I=n[I];let F=I,R;for(;R=r[F],!oR(D,T,t[2*F],t[2*F+1],t[2*R],t[2*R+1]);)if(F=R,F===I){F=-1;break}if(F===-1)continue;let P=this._addTriangle(F,A,r[F],-1,-1,i[F]);i[A]=this._legalize(P+2),i[F]=P,k++;let V=r[F];for(;R=r[V],oR(D,T,t[2*V],t[2*V+1],t[2*R],t[2*R+1]);)P=this._addTriangle(V,A,R,i[A],-1,i[V]),i[A]=this._legalize(P+2),r[V]=V,k--,V=R;if(F===I)for(;R=n[F],oR(D,T,t[2*R],t[2*R+1],t[2*F],t[2*F+1]);)P=this._addTriangle(R,A,F,-1,i[F],i[R]),this._legalize(P+2),i[R]=P,r[F]=F,k--,F=R;this._hullStart=n[A]=F,r[F]=n[V]=A,r[A]=V,s[this._hashKey(D,T)]=A,s[this._hashKey(t[2*F],t[2*F+1])]=F}this.hull=new Uint32Array(k);for(let E=0,S=this._hullStart;E<k;E++)this.hull[E]=S,S=r[S];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(rnn(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let s=0,a=0;for(;;){const o=r[t],l=t-t%3;if(a=l+(t+2)%3,o===-1){if(s===0)break;t=aR[--s];continue}const u=o-o%3,c=l+(t+1)%3,f=u+(o+2)%3,h=n[a],d=n[t],p=n[c],g=n[f];if(inn(i[2*h],i[2*h+1],i[2*d],i[2*d+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[o]=h;const v=r[f];if(v===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,v),this._link(o,r[a]),this._link(a,f);const y=u+(o+1)%3;s<aR.length&&(aR[s++]=y)}else{if(s===0)break;t=aR[--s]}}return a}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,s,a){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=n,this._triangles[o+2]=r,this._link(o,i),this._link(o+1,s),this._link(o+2,a),this.trianglesLen+=3,o}}function rnn(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function YH(e,t,n,r){const i=e-n,s=t-r;return i*i+s*s}function XH(e,t,n,r,i,s){const a=(r-t)*(i-e),o=(n-e)*(s-t);return Math.abs(a-o)>=33306690738754716e-32*Math.abs(a+o)?a-o:0}function oR(e,t,n,r,i,s){return(XH(i,s,e,t,n,r)||XH(e,t,n,r,i,s)||XH(n,r,i,s,e,t))<0}function inn(e,t,n,r,i,s,a,o){const l=e-a,u=t-o,c=n-a,f=r-o,h=i-a,d=s-o,p=l*l+u*u,g=c*c+f*f,m=h*h+d*d;return l*(f*m-g*d)-u*(c*m-g*h)+p*(c*d-f*h)<0}function snn(e,t,n,r,i,s){const a=n-e,o=r-t,l=i-e,u=s-t,c=a*a+o*o,f=l*l+u*u,h=.5/(a*u-o*l),d=(u*c-o*f)*h,p=(a*f-l*c)*h;return d*d+p*p}function ann(e,t,n,r,i,s){const a=n-e,o=r-t,l=i-e,u=s-t,c=a*a+o*o,f=l*l+u*u,h=.5/(a*u-o*l),d=e+(u*c-o*f)*h,p=t+(a*f-l*c)*h;return{x:d,y:p}}function R2(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const s=e[i],a=t[s];let o=i-1;for(;o>=n&&t[e[o]]>a;)e[o+1]=e[o--];e[o+1]=s}else{const i=n+r>>1;let s=n+1,a=r;bk(e,i,s),t[e[n]]>t[e[r]]&&bk(e,n,r),t[e[s]]>t[e[r]]&&bk(e,s,r),t[e[n]]>t[e[s]]&&bk(e,n,s);const o=e[s],l=t[o];for(;;){do s++;while(t[e[s]]<l);do a--;while(t[e[a]]>l);if(a<s)break;bk(e,s,a)}e[n+1]=e[a],e[a]=o,r-s+1>=a-n?(R2(e,t,s,r),R2(e,t,n,a-1)):(R2(e,t,n,a-1),R2(e,t,s,r))}}function bk(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function onn(e){return e[0]}function lnn(e){return e[1]}const bbe=1e-6;class P1{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,s=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${s}`:(Math.abs(this._x1-i)>bbe||Math.abs(this._y1-s)>bbe)&&(this._+="L"+i+","+s),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=s}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class kZ{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class unn{constructor(t,[n,r,i,s]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((s=+s)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=s,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,s=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let d=0,p=0,g=r.length,m,v;d<g;d+=3,p+=2){const y=r[d]*2,b=r[d+1]*2,x=r[d+2]*2,w=t[y],C=t[y+1],$=t[b],_=t[b+1],k=t[x],E=t[x+1],S=$-w,N=_-C,A=k-w,D=E-C,T=S*S+N*N,I=A*A+D*D,F=(S*D-N*A)*2;if(!F)m=(w+k)/2-1e8*D,v=(C+E)/2+1e8*A;else if(Math.abs(F)<1e-8)m=(w+k)/2,v=(C+E)/2;else{const R=1/F;m=w+(D*T-N*I)*R,v=C+(S*I-A*T)*R}s[p]=m,s[p+1]=v}let a=n[n.length-1],o,l=a*4,u,c=t[2*a],f,h=t[2*a+1];i.fill(0);for(let d=0;d<n.length;++d)a=n[d],o=l,u=c,f=h,l=a*4,c=t[2*a],h=t[2*a+1],i[o+2]=i[l]=f-h,i[o+3]=i[l+1]=c-u}render(t){const n=t==null?t=new P1:void 0,{delaunay:{halfedges:r,inedges:i,hull:s},circumcenters:a,vectors:o}=this;if(s.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const h=r[c];if(h<c)continue;const d=Math.floor(c/3)*2,p=Math.floor(h/3)*2,g=a[d],m=a[d+1],v=a[p],y=a[p+1];this._renderSegment(g,m,v,y,t)}let l,u=s[s.length-1];for(let c=0;c<s.length;++c){l=u,u=s[c];const f=Math.floor(i[u]/3)*2,h=a[f],d=a[f+1],p=l*4,g=this._project(h,d,o[p+2],o[p+3]);g&&this._renderSegment(h,d,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new P1:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new P1:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let s=i.length;for(;i[0]===i[s-2]&&i[1]===i[s-1]&&s>1;)s-=2;for(let a=2;a<s;a+=2)(i[a]!==i[a-2]||i[a+1]!==i[a-1])&&n.lineTo(i[a],i[a+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new kZ;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,s){let a;const o=this._regioncode(t,n),l=this._regioncode(r,i);o===0&&l===0?(s.moveTo(t,n),s.lineTo(r,i)):(a=this._clipSegment(t,n,r,i,o,l))&&(s.moveTo(a[0],a[1]),s.lineTo(a[2],a[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i){e:for(let s=0,a=n.length;s<a;s+=2)for(let o=0,l=i.length;o<l;o+=2)if(n[s]==i[o]&&n[s+1]==i[o+1]&&n[(s+2)%a]==i[(o+l-2)%l]&&n[(s+3)%a]==i[(o+l-1)%l]){yield r;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:s}}=this,a=r[t];if(a===-1)return null;const o=[];let l=a;do{const u=Math.floor(l/3);if(o.push(n[u*2],n[u*2+1]),l=l%3===2?l-2:l+1,s[l]!==t)break;l=i[l]}while(l!==a&&l!==-1);return o}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let i=null,s,a,o=n[r-2],l=n[r-1],u,c=this._regioncode(o,l),f,h;for(let d=0;d<r;d+=2)if(s=o,a=l,o=n[d],l=n[d+1],u=c,c=this._regioncode(o,l),u===0&&c===0)f=h,h=0,i?i.push(o,l):i=[o,l];else{let p,g,m,v,y;if(u===0){if((p=this._clipSegment(s,a,o,l,u,c))===null)continue;[g,m,v,y]=p}else{if((p=this._clipSegment(o,l,s,a,c,u))===null)continue;[v,y,g,m]=p,f=h,h=this._edgecode(g,m),f&&h&&this._edge(t,f,h,i,i.length),i?i.push(g,m):i=[g,m]}f=h,h=this._edgecode(v,y),f&&h&&this._edge(t,f,h,i,i.length),i?i.push(v,y):i=[v,y]}if(i)f=h,h=this._edgecode(i[0],i[1]),f&&h&&this._edge(t,f,h,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,s,a){for(;;){if(s===0&&a===0)return[t,n,r,i];if(s&a)return null;let o,l,u=s||a;u&8?(o=t+(r-t)*(this.ymax-n)/(i-n),l=this.ymax):u&4?(o=t+(r-t)*(this.ymin-n)/(i-n),l=this.ymin):u&2?(l=n+(i-n)*(this.xmax-t)/(r-t),o=this.xmax):(l=n+(i-n)*(this.xmin-t)/(r-t),o=this.xmin),s?(t=o,n=l,s=this._regioncode(t,n)):(r=o,i=l,a=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,s,a){let o=Array.from(n),l;if((l=this._project(o[0],o[1],r,i))&&o.unshift(l[0],l[1]),(l=this._project(o[o.length-2],o[o.length-1],s,a))&&o.push(l[0],l[1]),o=this._clipFinite(t,o))for(let u=0,c=o.length,f,h=this._edgecode(o[c-2],o[c-1]);u<c;u+=2)f=h,h=this._edgecode(o[u],o[u+1]),f&&h&&(u=this._edge(t,f,h,o,u),c=o.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return o}_edge(t,n,r,i,s){for(;n!==r;){let a,o;switch(n){case 5:n=4;continue;case 4:n=6,a=this.xmax,o=this.ymin;break;case 6:n=2;continue;case 2:n=10,a=this.xmax,o=this.ymax;break;case 10:n=8;continue;case 8:n=9,a=this.xmin,o=this.ymax;break;case 9:n=1;continue;case 1:n=5,a=this.xmin,o=this.ymin;break}(i[s]!==a||i[s+1]!==o)&&this.contains(t,a,o)&&(i.splice(s,0,a,o),s+=2)}if(i.length>4)for(let a=0;a<i.length;a+=2){const o=(a+2)%i.length,l=(a+4)%i.length;(i[a]===i[o]&&i[o]===i[l]||i[a+1]===i[o+1]&&i[o+1]===i[l+1])&&(i.splice(o,2),a-=2)}return s}_project(t,n,r,i){let s=1/0,a,o,l;if(i<0){if(n<=this.ymin)return null;(a=(this.ymin-n)/i)<s&&(l=this.ymin,o=t+(s=a)*r)}else if(i>0){if(n>=this.ymax)return null;(a=(this.ymax-n)/i)<s&&(l=this.ymax,o=t+(s=a)*r)}if(r>0){if(t>=this.xmax)return null;(a=(this.xmax-t)/r)<s&&(o=this.xmax,l=n+(s=a)*i)}else if(r<0){if(t<=this.xmin)return null;(a=(this.xmin-t)/r)<s&&(o=this.xmin,l=n+(s=a)*i)}return[o,l]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const cnn=2*Math.PI,f2=Math.pow;function fnn(e){return e[0]}function hnn(e){return e[1]}function dnn(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],s=2*t[r+1],a=2*t[r+2];if((n[a]-n[i])*(n[s+1]-n[i+1])-(n[s]-n[i])*(n[a+1]-n[i+1])>1e-10)return!1}return!0}function pnn(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class Bae{static from(t,n=fnn,r=hnn,i){return new Bae("length"in t?gnn(t,n,r,i):Float64Array.from(mnn(t,n,r,i)))}constructor(t){this._delaunator=new RL(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&dnn(t)){this.collinear=Int32Array.from({length:n.length/2},(h,d)=>d).sort((h,d)=>n[2*h]-n[2*d]||n[2*h+1]-n[2*d+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[n[2*l],n[2*l+1],n[2*u],n[2*u+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let h=0,d=n.length/2;h<d;++h){const p=pnn(n[2*h],n[2*h+1],f);n[2*h]=p[0],n[2*h+1]=p[1]}this._delaunator=new RL(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let l=0,u=r.length;l<u;++l){const c=s[l%3===2?l-2:l+1];(r[l]===-1||a[c]===-1)&&(a[c]=l)}for(let l=0,u=i.length;l<u;++l)o[i[l]]=l;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],a[i[0]]=1,i.length===2&&(a[i[1]]=0))}voronoi(t){return new unn(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:s,triangles:a,collinear:o}=this;if(o){const f=o.indexOf(t);f>0&&(yield o[f-1]),f<o.length-1&&(yield o[f+1]);return}const l=n[t];if(l===-1)return;let u=l,c=-1;do{if(yield c=a[u],u=u%3===2?u-2:u+1,a[u]!==t)return;if(u=s[u],u===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(u!==l)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let s;for(;(s=this._step(r,t,n))>=0&&s!==r&&s!==i;)r=s;return s}_step(t,n,r){const{inedges:i,hull:s,_hullIndex:a,halfedges:o,triangles:l,points:u}=this;if(i[t]===-1||!u.length)return(t+1)%(u.length>>1);let c=t,f=f2(n-u[t*2],2)+f2(r-u[t*2+1],2);const h=i[t];let d=h;do{let p=l[d];const g=f2(n-u[p*2],2)+f2(r-u[p*2+1],2);if(g<f&&(f=g,c=p),d=d%3===2?d-2:d+1,l[d]!==t)break;if(d=o[d],d===-1){if(d=s[(a[t]+1)%s.length],d!==p&&f2(n-u[d*2],2)+f2(r-u[d*2+1],2)<f)return d;break}}while(d!==h);return c}render(t){const n=t==null?t=new P1:void 0,{points:r,halfedges:i,triangles:s}=this;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l<a)continue;const u=s[a]*2,c=s[l]*2;t.moveTo(r[u],r[u+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=t==null?t=new P1:void 0,{points:i}=this;for(let s=0,a=i.length;s<a;s+=2){const o=i[s],l=i[s+1];t.moveTo(o+n,l),t.arc(o,l,n,0,cnn)}return r&&r.value()}renderHull(t){const n=t==null?t=new P1:void 0,{hull:r,points:i}=this,s=r[0]*2,a=r.length;t.moveTo(i[s],i[s+1]);for(let o=1;o<a;++o){const l=2*r[o];t.lineTo(i[l],i[l+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new kZ;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new P1:void 0,{points:i,triangles:s}=this,a=s[t*=3]*2,o=s[t+1]*2,l=s[t+2]*2;return n.moveTo(i[a],i[a+1]),n.lineTo(i[o],i[o+1]),n.lineTo(i[l],i[l+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new kZ;return this.renderTriangle(t,n),n.value()}}function gnn(e,t,n,r){const i=e.length,s=new Float64Array(i*2);for(let a=0;a<i;++a){const o=e[a];s[a*2]=t.call(r,o,a,e),s[a*2+1]=n.call(r,o,a,e)}return s}function*mnn(e,t,n,r){let i=0;for(const s of e)yield t.call(r,s,i,e),yield n.call(r,s,i,e),++i}function zae(e){me.call(this,null,e)}zae.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const vnn=[-1e5,-1e5,1e5,1e5];Ne(zae,me,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:vnn;const s=this.value=Bae.from(r,e.x,e.y).voronoi(i);for(let a=0,o=r.length;a<o;++a){const l=s.cellPolygon(a);r[a][n]=l?ynn(l):null}return t.reflow(e.modified()).modifies(n)}});function ynn(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}const bnn=Object.freeze(Object.defineProperty({__proto__:null,voronoi:zae},Symbol.toStringTag,{value:"Module"}));var KH=Math.PI/180,PE=1<<11>>5,_4=1<<11;function xnn(){var e=[256,256],t,n,r,i,s,a,o,l=Q8e,u=[],c=Math.random,f={};f.layout=function(){for(var p=h(Ku()),g=knn((e[0]>>5)*e[1]),m=null,v=u.length,y=-1,b=[],x=u.map(C=>({text:t(C),font:n(C),style:i(C),weight:s(C),rotate:a(C),size:~~(r(C)+1e-14),padding:o(C),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:C})).sort((C,$)=>$.size-C.size);++y<v;){var w=x[y];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,wnn(p,w,x,y),w.hasText&&d(g,w,m)&&(b.push(w),m?Cnn(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return b};function h(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(PE<<5)/g,p.height=_4/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}function d(p,g,m){for(var v=g.x,y=g.y,b=Math.sqrt(e[0]*e[0]+e[1]*e[1]),x=l(e),w=c()<.5?1:-1,C=-w,$,_,k;($=x(C+=w))&&(_=~~$[0],k=~~$[1],!(Math.min(Math.abs(_),Math.abs(k))>=b));)if(g.x=v+_,g.y=y+k,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!$nn(g,p,e[0]))&&(!m||_nn(g,m))){for(var E=g.sprite,S=g.width>>5,N=e[0]>>5,A=g.x-(S<<4),D=A&127,T=32-D,I=g.y1-g.y0,F=(g.y+g.y0)*N+(A>>5),R,P=0;P<I;P++){R=0;for(var V=0;V<=S;V++)p[F+V]|=R<<T|(V<S?(R=E[P*S+V])>>>D:0);F+=N}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(u=p,f):u},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=Nv(p),f):n},f.fontStyle=function(p){return arguments.length?(i=Nv(p),f):i},f.fontWeight=function(p){return arguments.length?(s=Nv(p),f):s},f.rotate=function(p){return arguments.length?(a=Nv(p),f):a},f.text=function(p){return arguments.length?(t=Nv(p),f):t},f.spiral=function(p){return arguments.length?(l=Enn[p]||p,f):l},f.fontSize=function(p){return arguments.length?(r=Nv(p),f):r},f.padding=function(p){return arguments.length?(o=Nv(p),f):o},f.random=function(p){return arguments.length?(c=p,f):c},f}function wnn(e,t,n,r){if(!t.sprite){var i=e.context,s=e.ratio;i.clearRect(0,0,(PE<<5)/s,_4/s);var a=0,o=0,l=0,u=n.length,c,f,h,d,p;for(--r;++r<u;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=i.measureText(t.text+"m").width*s,h=t.size<<1,t.rotate){var g=Math.sin(t.rotate*KH),m=Math.cos(t.rotate*KH),v=c*m,y=c*g,b=h*m,x=h*g;c=Math.max(Math.abs(v+x),Math.abs(v-x))+31>>5<<5,h=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else c=c+31>>5<<5;if(h>l&&(l=h),a+c>=PE<<5&&(a=0,o+=l,l=0),o+h>=_4)break;i.translate((a+(c>>1))/s,(o+(h>>1))/s),t.rotate&&i.rotate(t.rotate*KH),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=h,t.xoff=a,t.yoff=o,t.x1=c>>1,t.y1=h>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,a+=c}for(var w=i.getImageData(0,0,(PE<<5)/s,_4/s).data,C=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,h=t.y1-t.y0,d=0;d<h*f;d++)C[d]=0;if(a=t.xoff,a==null)return;o=t.yoff;var $=0,_=-1;for(p=0;p<h;p++){for(d=0;d<c;d++){var k=f*p+(d>>5),E=w[(o+p)*(PE<<5)+(a+d)<<2]?1<<31-d%32:0;C[k]|=E,$|=E}$?_=p:(t.y0++,h--,p--,o++)}t.y1=t.y0+_,t.sprite=C.slice(0,(t.y1-t.y0)*f)}}}function $nn(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,s=e.x-(i<<4),a=s&127,o=32-a,l=e.y1-e.y0,u=(e.y+e.y0)*n+(s>>5),c,f=0;f<l;f++){c=0;for(var h=0;h<=i;h++)if((c<<o|(h<i?(c=r[f*i+h])>>>a:0))&t[u+h])return!0;u+=n}return!1}function Cnn(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function _nn(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Q8e(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Snn(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(s){var a=s<0?-1:1;switch(Math.sqrt(1+4*a*s)-a&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function knn(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Nv(e){return typeof e=="function"?e:function(){return e}}var Enn={archimedean:Q8e,rectangular:Snn};const J8e=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Ann=["text","font","rotate","fontSize","fontStyle","fontWeight"];function Uae(e){me.call(this,xnn(),e)}Uae.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:J8e}]};Ne(Uae,me,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&$e("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return Ut(g)&&t.modified(g.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||Ann.some(n)))return;const i=t.materialize(t.SOURCE).source,s=this.value,a=e.as||J8e;let o=e.fontSize||14,l;if(Ut(o)?l=e.fontSizeRange:o=vo(o),l){const p=o,g=Dn("sqrt")().domain(Rp(i,p)).range(l);o=m=>g(p(m))}i.forEach(p=>{p[a[0]]=NaN,p[a[1]]=NaN,p[a[3]]=0});const u=s.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(o).random(Lp).layout(),c=s.size(),f=c[0]>>1,h=c[1]>>1,d=u.length;for(let p=0,g,m;p<d;++p)g=u[p],m=g.datum,m[a[0]]=g.x+f,m[a[1]]=g.y+h,m[a[2]]=g.font,m[a[3]]=g.size,m[a[4]]=g.style,m[a[5]]=g.weight,m[a[6]]=g.rotate;return t.reflow(r).modifies(a)}});const Tnn=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:Uae},Symbol.toStringTag,{value:"Module"})),Dnn=e=>new Uint8Array(e),Nnn=e=>new Uint16Array(e),SA=e=>new Uint32Array(e);function Inn(){let e=8,t=[],n=SA(0),r=lR(0,e),i=lR(0,e);return{data:()=>t,seen:()=>n=Mnn(n,t.length),add(s){for(let a=0,o=t.length,l=s.length,u;a<l;++a)u=s[a],u._index=o++,t.push(u)},remove(s,a){const o=t.length,l=Array(o-s),u=t;let c,f,h;for(f=0;!a[f]&&f<o;++f)l[f]=t[f],u[f]=f;for(h=f;f<o;++f)c=t[f],a[f]?u[f]=-1:(u[f]=h,r[h]=r[f],i[h]=i[f],l[h]=c,c._index=h++),r[f]=0;return t=l,u},size:()=>t.length,curr:()=>r,prev:()=>i,reset:s=>i[s]=r[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,a){r[s]|=a},clear(s,a){r[s]&=~a},resize(s,a){const o=r.length;(s>o||a>e)&&(e=Math.max(a,e),r=lR(s,e,r),i=lR(s,e))}}}function Mnn(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function lR(e,t,n){const r=(t<257?Dnn:t<65537?Nnn:SA)(e);return n&&r.set(n),r}function xbe(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,s){const a=this,o=a.bisect(a.range,i.value),l=i.index,u=o[0],c=o[1],f=l.length;let h;for(h=0;h<u;++h)s[l[h]]|=r;for(h=c;h<f;++h)s[l[h]]|=r;return a}}}function wbe(){let e=SA(0),t=[],n=0;function r(o,l,u){if(!l.length)return[];const c=n,f=l.length,h=SA(f);let d=Array(f),p,g,m;for(m=0;m<f;++m)d[m]=o(l[m]),h[m]=m;if(d=Fnn(d,h),c)p=t,g=e,t=Array(c+f),e=SA(c+f),Onn(u,p,g,c,d,h,f,t,e);else{if(u>0)for(m=0;m<f;++m)h[m]+=u;t=d,e=h}return n=c+f,{index:h,value:d}}function i(o,l){const u=n;let c,f,h;for(f=0;!l[e[f]]&&f<u;++f);for(h=f;f<u;++f)l[c=e[f]]||(e[h]=c,t[h]=t[f],++h);n=u-o}function s(o){for(let l=0,u=n;l<u;++l)e[l]=o[e[l]]}function a(o,l){let u;return l?u=l.length:(l=t,u=n),[E9t(l,o[0],0,u),fP(l,o[1],0,u)]}return{insert:r,remove:i,bisect:a,reindex:s,index:()=>e,size:()=>n}}function Fnn(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],s=e[r];return i<s?-1:i>s?1:0}),D9t(e,t)}function Onn(e,t,n,r,i,s,a,o,l){let u=0,c=0,f;for(f=0;u<r&&c<a;++f)t[u]<i[c]?(o[f]=t[u],l[f]=n[u++]):(o[f]=i[c],l[f]=s[c++]+e);for(;u<r;++u,++f)o[f]=t[u],l[f]=n[u];for(;c<a;++c,++f)o[f]=i[c],l[f]=s[c]+e}function Wae(e){me.call(this,Inn(),e),this._indices=null,this._dims=null}Wae.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};Ne(Wae,me,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},s=this._dims=[],a=r.length;let o=0,l,u;for(;o<a;++o)l=n[o].fname,u=i[l]||(i[l]=wbe()),s.push(xbe(u,o,r[o]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,s=this._indices,a=this._dims,o=this.value,l=o.curr(),u=o.prev(),c=o.all(),f=n.rem=n.add,h=n.mod,d=i.length,p={};let g,m,v,y,b,x,w,C,$;if(u.set(l),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&o.add(t.add),t.mod.length)for(x={},y=t.mod,w=0,C=y.length;w<C;++w)x[y[w]._index]=1;for(w=0;w<d;++w)$=r[w],(!a[w]||e.modified("fields",w)||t.modified($.fields))&&(v=$.fname,(g=p[v])||(s[v]=m=wbe(),p[v]=g=m.insert($,t.source,0)),a[w]=xbe(m,w,i[w]).onAdd(g,l));for(w=0,C=o.data().length;w<C;++w)b[w]||(u[w]!==l[w]?f.push(w):x[w]&&l[w]!==c&&h.push(w));return o.mask=(1<<d)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,s=this._dims,a=this._indices,o=e.fields,l={},u=n.add,c=i.size()+r.length,f=s.length;let h=i.size(),d,p,g;i.resize(c,f),i.add(r);const m=i.curr(),v=i.prev(),y=i.all();for(d=0;d<f;++d)p=o[d].fname,g=l[p]||(l[p]=a[p].insert(o[d],r,h)),s[d].onAdd(g,m);for(;h<c;++h)v[h]=y,m[h]!==y&&u.push(h)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),s=r.all(),a=e.mod;let o,l,u;for(o=0,l=a.length;o<l;++o)u=a[o]._index,i[u]!==s&&n.push(u)},remove(e,t,n){const r=this._indices,i=this.value,s=i.curr(),a=i.prev(),o=i.all(),l={},u=n.rem,c=t.rem;let f,h,d,p;for(f=0,h=c.length;f<h;++f)d=c[f]._index,l[d]=1,a[d]=p=s[d],s[d]=o,p!==o&&u.push(d);for(d in r)r[d].remove(h,l);return this.reindex(t,h,l),l},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const s=i.remove(t,n);for(const a in r)r[a].reindex(s)})},update(e,t,n){const r=this._dims,i=e.query,s=t.stamp,a=r.length;let o=0,l,u;for(n.filters=0,u=0;u<a;++u)e.modified("query",u)&&(l=u,++o);if(o===1)o=r[l].one,this.incrementOne(r[l],i[l],n.add,n.rem);else for(u=0,o=0;u<a;++u)!e.modified("query",u)||(o|=r[u].one,this.incrementAll(r[u],i[u],s,n.add),n.rem=n.add);return o},incrementAll(e,t,n,r){const i=this.value,s=i.seen(),a=i.curr(),o=i.prev(),l=e.index(),u=e.bisect(e.range),c=e.bisect(t),f=c[0],h=c[1],d=u[0],p=u[1],g=e.one;let m,v,y;if(f<d)for(m=f,v=Math.min(d,h);m<v;++m)y=l[m],s[y]!==n&&(o[y]=a[y],s[y]=n,r.push(y)),a[y]^=g;else if(f>d)for(m=d,v=Math.min(f,p);m<v;++m)y=l[m],s[y]!==n&&(o[y]=a[y],s[y]=n,r.push(y)),a[y]^=g;if(h>p)for(m=Math.max(f,p),v=h;m<v;++m)y=l[m],s[y]!==n&&(o[y]=a[y],s[y]=n,r.push(y)),a[y]^=g;else if(h<p)for(m=Math.max(d,h),v=p;m<v;++m)y=l[m],s[y]!==n&&(o[y]=a[y],s[y]=n,r.push(y)),a[y]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,s=i.curr(),a=e.index(),o=e.bisect(e.range),l=e.bisect(t),u=l[0],c=l[1],f=o[0],h=o[1],d=e.one;let p,g,m;if(u<f)for(p=u,g=Math.min(f,c);p<g;++p)m=a[p],s[m]^=d,n.push(m);else if(u>f)for(p=f,g=Math.min(u,h);p<g;++p)m=a[p],s[m]^=d,r.push(m);if(c>h)for(p=Math.max(u,h),g=c;p<g;++p)m=a[p],s[m]^=d,n.push(m);else if(c<h)for(p=Math.max(f,c),g=h;p<g;++p)m=a[p],s[m]^=d,r.push(m);e.range=t.slice()}});function Vae(e){me.call(this,null,e)}Vae.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};Ne(Vae,me,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)===0)return t.StopPropagation;const s=t.fork(t.ALL),a=r.data(),o=r.curr(),l=r.prev(),u=c=>o[c]&n?null:a[c];return s.filter(s.MOD,u),i&i-1?(s.filter(s.ADD,c=>{const f=o[c]&n;return!f&&f^l[c]&n?a[c]:null}),s.filter(s.REM,c=>{const f=o[c]&n;return f&&!(f^(f^l[c]&n))?a[c]:null})):(s.filter(s.ADD,u),s.filter(s.REM,c=>(o[c]&n)===i?a[c]:null)),s.filter(s.SOURCE,c=>u(c._index))}});const Rnn=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:Wae,resolvefilter:Vae},Symbol.toStringTag,{value:"Module"}));function*eBe(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function tBe(e,t,n){const r=Float64Array.from(eBe(e,n));return r.sort(V_),t.map(i=>RRe(r,i))}function nBe(e,t){return tBe(e,[.25,.5,.75],t)}function rBe(e,t){const n=e.length,r=T9t(e,t),i=nBe(e,t),s=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,s)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function Pnn(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let s=e.extent[0],a=e.extent[1],o,l,u,c,f,h;const d=e.span||a-s||Math.abs(s)||1;if(e.step)o=e.step;else if(e.steps){for(c=d/t,f=0,h=e.steps.length;f<h&&e.steps[f]<c;++f);o=e.steps[Math.max(0,f-1)]}else{for(l=Math.ceil(Math.log(t)/r),u=e.minstep||0,o=Math.max(u,Math.pow(n,Math.round(Math.log(d)/r)-l));Math.ceil(d/o)>t;)o*=n;for(f=0,h=i.length;f<h;++f)c=o/i[f],c>=u&&d/c<=t&&(o=c)}c=Math.log(o);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/o+g)*o,s=s<c?c-o:c,a=Math.ceil(a/o)*o),{start:s,stop:a===s?s+o:a,step:o}}var Hp=Math.random;function Lnn(e){Hp=e}function Bnn(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(eBe(e,r)),s=i.length,a=t;let o,l,u,c;for(u=0,c=Array(a);u<a;++u){for(o=0,l=0;l<s;++l)o+=i[~~(Hp()*s)];c[u]=o/s}return c.sort(V_),[LX(c,n/2),LX(c,1-n/2)]}function znn(e,t,n,r){r=r||(h=>h);const i=e.length,s=new Float64Array(i);let a=0,o=1,l=r(e[0]),u=l,c=l+t,f;for(;o<i;++o){if(f=r(e[o]),f>=c){for(u=(l+u)/2;a<o;++a)s[a]=u;c=f+t,l=f}u=f}for(u=(l+u)/2;a<o;++a)s[a]=u;return n?Unn(s,t+t/4):s}function Unn(e,t){const n=e.length;let r=0,i=1,s,a;for(;e[r]===e[i];)++i;for(;i<n;){for(s=i+1;e[i]===e[s];)++s;if(e[i]-e[i-1]<t){for(a=i+(r+s-i-i>>1);a<i;)e[a++]=e[i];for(;a>i;)e[a--]=e[r]}r=i,i=s}return e}function Wnn(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function Vnn(e,t){t==null&&(t=e,e=0);let n,r,i;const s={min(a){return arguments.length?(n=a||0,i=r-n,s):n},max(a){return arguments.length?(r=a||0,i=r-n,s):r},sample(){return n+Math.floor(i*Hp())},pdf(a){return a===Math.floor(a)&&a>=n&&a<r?1/i:0},cdf(a){const o=Math.floor(a);return o<n?0:o>=r?1:(o-n+1)/i},icdf(a){return a>=0&&a<=1?n-1+Math.floor(a*i):NaN}};return s.min(e).max(t)}const iBe=Math.sqrt(2*Math.PI),jnn=Math.SQRT2;let xk=NaN;function jae(e,t){e=e||0,t=t==null?1:t;let n=0,r=0,i,s;if(xk===xk)n=xk,xk=NaN;else{do n=Hp()*2-1,r=Hp()*2-1,i=n*n+r*r;while(i===0||i>1);s=Math.sqrt(-2*Math.log(i)/i),n*=s,xk=r*s}return e+n*t}function sBe(e,t,n){n=n==null?1:n;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*iBe)}function Hae(e,t,n){t=t||0,n=n==null?1:n;const r=(e-t)/n,i=Math.abs(r);let s;if(i>37)s=0;else{const a=Math.exp(-i*i/2);let o;i<7.07106781186547?(o=.0352624965998911*i+.700383064443688,o=o*i+6.37396220353165,o=o*i+33.912866078383,o=o*i+112.079291497871,o=o*i+221.213596169931,o=o*i+220.206867912376,s=a*o,o=.0883883476483184*i+1.75566716318264,o=o*i+16.064177579207,o=o*i+86.7807322029461,o=o*i+296.564248779674,o=o*i+637.333633378831,o=o*i+793.826512519948,o=o*i+440.413735824752,s=s/o):(o=i+.65,o=i+4/o,o=i+3/o,o=i+2/o,o=i+1/o,s=a/o/2.506628274631)}return r>0?1-s:s}function qae(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*jnn*Hnn(2*e-1)}function Hnn(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function aBe(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s==null?1:s,i):r},sample:()=>jae(n,r),pdf:s=>sBe(s,n,r),cdf:s=>Hae(s,n,r),icdf:s=>qae(s,n,r)};return i.mean(e).stdev(t)}function qnn(e,t){const n=aBe();let r=0;const i={data(s){return arguments.length?(e=s,r=s?s.length:0,i.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=rBe(e)),i):t},sample(){return e[~~(Hp()*r)]+t*n.sample()},pdf(s){let a=0,o=0;for(;o<r;++o)a+=n.pdf((s-e[o])/t);return a/t/r},cdf(s){let a=0,o=0;for(;o<r;++o)a+=n.cdf((s-e[o])/t);return a/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function oBe(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+jae()*t)}function lBe(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*iBe*e)}function uBe(e,t,n){return Hae(Math.log(e),t,n)}function cBe(e,t,n){return Math.exp(qae(e,t,n))}function Gnn(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s==null?1:s,i):r},sample:()=>oBe(n,r),pdf:s=>lBe(s,n,r),cdf:s=>uBe(s,n,r),icdf:s=>cBe(s,n,r)};return i.mean(e).stdev(t)}function Ynn(e,t){let n=0,r;function i(a){const o=[];let l=0,u;for(u=0;u<n;++u)l+=o[u]=a[u]==null?1:+a[u];for(u=0;u<n;++u)o[u]/=l;return o}const s={weights(a){return arguments.length?(r=i(t=a||[]),s):t},distributions(a){return arguments.length?(a?(n=a.length,e=a):(n=0,e=[]),s.weights(t)):e},sample(){const a=Hp();let o=e[n-1],l=r[0],u=0;for(;u<n-1;l+=r[++u])if(a<l){o=e[u];break}return o.sample()},pdf(a){let o=0,l=0;for(;l<n;++l)o+=r[l]*e[l].pdf(a);return o},cdf(a){let o=0,l=0;for(;l<n;++l)o+=r[l]*e[l].cdf(a);return o},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function fBe(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*Hp()}function hBe(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function dBe(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function pBe(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function Xnn(e,t){let n,r;const i={min(s){return arguments.length?(n=s||0,i):n},max(s){return arguments.length?(r=s==null?1:s,i):r},sample:()=>fBe(n,r),pdf:s=>hBe(s,n,r),cdf:s=>dBe(s,n,r),icdf:s=>pBe(s,n,r)};return t==null&&(t=e==null?1:e,e=0),i.min(e).max(t)}function CM(e,t,n,r){const i=r-e*e,s=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-s*e,s]}function Y9(e,t,n,r){e=e.filter(d=>{let p=t(d),g=n(d);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((d,p)=>t(d)-t(p));const i=e.length,s=new Float64Array(i),a=new Float64Array(i);let o=0,l=0,u=0,c,f,h;for(h of e)s[o]=c=+t(h),a[o]=f=+n(h),++o,l+=(c-l)/o,u+=(f-u)/o;for(o=0;o<i;++o)s[o]-=l,a[o]-=u;return[s,a,l,u]}function _M(e,t,n,r){let i=-1,s,a;for(const o of e)s=t(o),a=n(o),s!=null&&(s=+s)>=s&&a!=null&&(a=+a)>=a&&r(s,a,++i)}function Z_(e,t,n,r,i){let s=0,a=0;return _M(e,t,n,(o,l)=>{const u=l-i(o),c=l-r;s+=u*u,a+=c*c}),1-s/a}function gBe(e,t,n){let r=0,i=0,s=0,a=0,o=0;_M(e,t,n,(c,f)=>{++o,r+=(c-r)/o,i+=(f-i)/o,s+=(c*f-s)/o,a+=(c*c-a)/o});const l=CM(r,i,s,a),u=c=>l[0]+l[1]*c;return{coef:l,predict:u,rSquared:Z_(e,t,n,i,u)}}function Knn(e,t,n){let r=0,i=0,s=0,a=0,o=0;_M(e,t,n,(c,f)=>{++o,c=Math.log(c),r+=(c-r)/o,i+=(f-i)/o,s+=(c*f-s)/o,a+=(c*c-a)/o});const l=CM(r,i,s,a),u=c=>l[0]+l[1]*Math.log(c);return{coef:l,predict:u,rSquared:Z_(e,t,n,i,u)}}function Znn(e,t,n){const[r,i,s,a]=Y9(e,t,n);let o=0,l=0,u=0,c=0,f=0,h,d,p;_M(e,t,n,(y,b)=>{h=r[f++],d=Math.log(b),p=h*b,o+=(b*d-o)/f,l+=(p-l)/f,u+=(p*d-u)/f,c+=(h*p-c)/f});const[g,m]=CM(l/a,o/a,u/a,c/a),v=y=>Math.exp(g+m*(y-s));return{coef:[Math.exp(g-m*s),m],predict:v,rSquared:Z_(e,t,n,a,v)}}function Qnn(e,t,n){let r=0,i=0,s=0,a=0,o=0,l=0;_M(e,t,n,(f,h)=>{const d=Math.log(f),p=Math.log(h);++l,r+=(d-r)/l,i+=(p-i)/l,s+=(d*p-s)/l,a+=(d*d-a)/l,o+=(h-o)/l});const u=CM(r,i,s,a),c=f=>u[0]*Math.pow(f,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:Z_(e,t,n,o,c)}}function mBe(e,t,n){const[r,i,s,a]=Y9(e,t,n),o=r.length;let l=0,u=0,c=0,f=0,h=0,d,p,g,m;for(d=0;d<o;)p=r[d],g=i[d++],m=p*p,l+=(m-l)/d,u+=(m*p-u)/d,c+=(m*m-c)/d,f+=(p*g-f)/d,h+=(m*g-h)/d;const v=c-l*l,y=l*v-u*u,b=(h*l-f*u)/y,x=(f*v-h*u)/y,w=-b*l,C=$=>($=$-s,b*$*$+x*$+w+a);return{coef:[w-x*s+b*s*s+a,x-2*b*s,b],predict:C,rSquared:Z_(e,t,n,a,C)}}function Jnn(e,t,n,r){if(r===1)return gBe(e,t,n);if(r===2)return mBe(e,t,n);const[i,s,a,o]=Y9(e,t,n),l=i.length,u=[],c=[],f=r+1;let h,d,p,g,m;for(h=0;h<f;++h){for(p=0,g=0;p<l;++p)g+=Math.pow(i[p],h)*s[p];for(u.push(g),m=new Float64Array(f),d=0;d<f;++d){for(p=0,g=0;p<l;++p)g+=Math.pow(i[p],h+d);m[d]=g}c.push(m)}c.push(u);const v=trn(c),y=b=>{b-=a;let x=o+v[0]+v[1]*b+v[2]*b*b;for(h=3;h<f;++h)x+=v[h]*Math.pow(b,h);return x};return{coef:ern(f,v,-a,o),predict:y,rSquared:Z_(e,t,n,o,y)}}function ern(e,t,n,r){const i=Array(e);let s,a,o,l;for(s=0;s<e;++s)i[s]=0;for(s=e-1;s>=0;--s)for(o=t[s],l=1,i[s]+=o,a=1;a<=s;++a)l*=(s+1-a)/a,i[s-a]+=o*Math.pow(n,a)*l;return i[0]+=r,i}function trn(e){const t=e.length-1,n=[];let r,i,s,a,o;for(r=0;r<t;++r){for(a=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][a])&&(a=i);for(s=r;s<t+1;++s)o=e[s][r],e[s][r]=e[s][a],e[s][a]=o;for(i=r+1;i<t;++i)for(s=t;s>=r;s--)e[s][i]-=e[s][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(o=0,s=i+1;s<t;++s)o+=e[s][i]*n[s];n[i]=(e[t][i]-o)/e[i][i]}return n}const $be=2,Cbe=1e-12;function nrn(e,t,n,r){const[i,s,a,o]=Y9(e,t,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),h=new Float64Array(l).fill(1);for(let d=-1;++d<=$be;){const p=[0,u-1];for(let m=0;m<l;++m){const v=i[m],y=p[0],b=p[1],x=v-i[y]>i[b]-v?y:b;let w=0,C=0,$=0,_=0,k=0;const E=1/Math.abs(i[x]-v||1);for(let A=y;A<=b;++A){const D=i[A],T=s[A],I=rrn(Math.abs(v-D)*E)*h[A],F=D*I;w+=I,C+=F,$+=T*I,_+=T*F,k+=D*F}const[S,N]=CM(C/w,$/w,_/w,k/w);c[m]=S+N*v,f[m]=Math.abs(s[m]-c[m]),irn(i,m+1,p)}if(d===$be)break;const g=PRe(f);if(Math.abs(g)<Cbe)break;for(let m=0,v,y;m<l;++m)v=f[m]/(6*g),h[m]=v>=1?Cbe:(y=1-v*v)*y}return srn(i,c,a,o)}function rrn(e){return(e=1-e*e*e)*e*e}function irn(e,t,n){const r=e[t];let i=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>i&&e[s]-r<=r-e[i];)n[0]=++i,n[1]=s,++s}function srn(e,t,n,r){const i=e.length,s=[];let a=0,o=0,l=[],u;for(;a<i;++a)u=e[a]+n,l[0]===u?l[1]+=(t[a]-l[1])/++o:(o=0,l[1]+=r,l=[u,t[a]],s.push(l));return l[1]+=r,s}const arn=.5*Math.PI/180;function orn(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=g=>[g,e(g)],s=t[0],a=t[1],o=a-s,l=o/r,u=[i(s)],c=[];if(n===r){for(let g=1;g<r;++g)u.push(i(s+g/n*o));return u.push(i(a)),u}else{c.push(i(a));for(let g=n;--g>0;)c.push(i(s+g/n*o))}let f=u[0],h=c[c.length-1];const d=1/o,p=lrn(f[1],c);for(;h;){const g=i((f[0]+h[0])/2);g[0]-f[0]>=l&&urn(f,g,h,d,p)>arn?c.push(g):(f=h,u.push(h),c.pop()),h=c[c.length-1]}return u}function lrn(e,t){let n=e,r=e;const i=t.length;for(let s=0;s<i;++s){const a=t[s][1];a<n&&(n=a),a>r&&(r=a)}return 1/(r-n)}function urn(e,t,n,r,i){const s=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),a=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(s-a)}function Q_(e,t,n){return e.fields=t||[],e.fname=n,e}function crn(e){return e.length===1?frn(e[0]):hrn(e)}const frn=e=>function(t){return t[e]},hrn=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function sw(e){throw Error(e)}function drn(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||sw("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&sw("Access path missing closing bracket: "+e),r&&sw("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function prn(e,t,n){const r=drn(e);return e=r.length===1?r[0]:e,Q_((n&&n.get||crn)(r),[e],t||e)}prn("id");Q_(e=>e,[],"identity");const wk=Q_(()=>0,[],"zero"),grn=Q_(()=>1,[],"one");Q_(()=>!0,[],"true");Q_(()=>!1,[],"false");var mrn=Array.isArray;function vBe(e){return e[e.length-1]}function vrn(e){return e!=null?mrn(e)?e:[e]:[]}function yrn(e){return typeof e=="function"}function brn(e){return yrn(e)?e:()=>e}function xrn(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}const wrn=Object.prototype.hasOwnProperty;function $rn(e,t){return wrn.call(e,t)}function Crn(e){return e&&vBe(e)-e[0]||0}function _rn(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}var ZH=new Date,QH=new Date;function ws(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=function(s){return e(s=new Date(+s)),s},i.ceil=function(s){return e(s=new Date(s-1)),t(s,1),e(s),s},i.round=function(s){var a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=function(s,a){return t(s=new Date(+s),a==null?1:Math.floor(a)),s},i.range=function(s,a,o){var l=[],u;if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=function(s){return ws(function(a){if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},function(a,o){if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););})},n&&(i.count=function(s,a){return ZH.setTime(+s),QH.setTime(+a),e(ZH),e(QH),Math.floor(n(ZH,QH))},i.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?function(a){return r(a)%s===0}:function(a){return i.count(0,a)%s===0}):i}),i}var PL=ws(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});PL.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ws(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):PL};const Gae=PL;PL.range;const np=1e3,_u=np*60,rp=_u*60,sb=rp*24,Yae=sb*7,_be=sb*30,JH=sb*365;var yBe=ws(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*np)},function(e,t){return(t-e)/np},function(e){return e.getUTCSeconds()});const s0=yBe;yBe.range;var bBe=ws(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*np)},function(e,t){e.setTime(+e+t*_u)},function(e,t){return(t-e)/_u},function(e){return e.getMinutes()});const Xae=bBe;bBe.range;var xBe=ws(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*np-e.getMinutes()*_u)},function(e,t){e.setTime(+e+t*rp)},function(e,t){return(t-e)/rp},function(e){return e.getHours()});const Kae=xBe;xBe.range;var wBe=ws(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*_u)/sb,e=>e.getDate()-1);const $0=wBe;wBe.range;function cx(e){return ws(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*_u)/Yae})}var J_=cx(0),LL=cx(1),Srn=cx(2),krn=cx(3),x$=cx(4),Ern=cx(5),Arn=cx(6);J_.range;LL.range;Srn.range;krn.range;x$.range;Ern.range;Arn.range;var $Be=ws(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()});const BL=$Be;$Be.range;var Zae=ws(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Zae.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ws(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};const am=Zae;Zae.range;var CBe=ws(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*_u)},function(e,t){return(t-e)/_u},function(e){return e.getUTCMinutes()});const Qae=CBe;CBe.range;var _Be=ws(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*rp)},function(e,t){return(t-e)/rp},function(e){return e.getUTCHours()});const Jae=_Be;_Be.range;var SBe=ws(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/sb},function(e){return e.getUTCDate()-1});const C0=SBe;SBe.range;function fx(e){return ws(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/Yae})}var eS=fx(0),zL=fx(1),Trn=fx(2),Drn=fx(3),w$=fx(4),Nrn=fx(5),Irn=fx(6);eS.range;zL.range;Trn.range;Drn.range;w$.range;Nrn.range;Irn.range;var kBe=ws(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()});const UL=kBe;kBe.range;var eoe=ws(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});eoe.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ws(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};const om=eoe;eoe.range;function EBe(e,t,n,r,i,s){const a=[[s0,1,np],[s0,5,5*np],[s0,15,15*np],[s0,30,30*np],[s,1,_u],[s,5,5*_u],[s,15,15*_u],[s,30,30*_u],[i,1,rp],[i,3,3*rp],[i,6,6*rp],[i,12,12*rp],[r,1,sb],[r,2,2*sb],[n,1,Yae],[t,1,_be],[t,3,3*_be],[e,1,JH]];function o(u,c,f){const h=c<u;h&&([u,c]=[c,u]);const d=f&&typeof f.range=="function"?f:l(u,c,f),p=d?d.range(u,+c+1):[];return h?p.reverse():p}function l(u,c,f){const h=Math.abs(c-u)/f,d=tM(([,,m])=>m).right(a,h);if(d===a.length)return e.every(J0(u/JH,c/JH,f));if(d===0)return Gae.every(Math.max(J0(u,c,f),1));const[p,g]=a[h/a[d-1][2]<a[d][2]/h?d-1:d];return p.every(g)}return[o,l]}const[Mrn,Frn]=EBe(om,UL,eS,C0,Jae,Qae),[Orn,Rrn]=EBe(am,BL,J_,$0,Kae,Xae),fo="year",Wu="quarter",el="month",Rs="week",Vu="date",io="day",zh="dayofyear",rf="hours",sf="minutes",Uh="seconds",Wh="milliseconds",ABe=[fo,Wu,el,Rs,Vu,io,zh,rf,sf,Uh,Wh],eq=ABe.reduce((e,t,n)=>(e[t]=1+n,e),{});function TBe(e){const t=vrn(e).slice(),n={};return t.length||sw("Missing time unit."),t.forEach(i=>{$rn(eq,i)?n[i]=1:sw("Invalid time unit: ".concat(i,"."))}),(n[Rs]||n[io]?1:0)+(n[Wu]||n[el]||n[Vu]?1:0)+(n[zh]?1:0)>1&&sw("Incompatible time units: ".concat(e)),t.sort((i,s)=>eq[i]-eq[s]),t}const Prn={[fo]:"%Y ",[Wu]:"Q%q ",[el]:"%b ",[Vu]:"%d ",[Rs]:"W%U ",[io]:"%a ",[zh]:"%j ",[rf]:"%H:00",[sf]:"00:%M",[Uh]:":%S",[Wh]:".%L",["".concat(fo,"-").concat(el)]:"%Y-%m ",["".concat(fo,"-").concat(el,"-").concat(Vu)]:"%Y-%m-%d ",["".concat(rf,"-").concat(sf)]:"%H:%M"};function Lrn(e,t){const n=xrn({},Prn,t),r=TBe(e),i=r.length;let s="",a=0,o,l;for(a=0;a<i;)for(o=r.length;o>a;--o)if(l=r.slice(a,o).join("-"),n[l]!=null){s+=n[l],a=o;break}return s.trim()}const p1=new Date;function toe(e){return p1.setFullYear(e),p1.setMonth(0),p1.setDate(1),p1.setHours(0,0,0,0),p1}function Brn(e){return DBe(new Date(e))}function zrn(e){return EZ(new Date(e))}function DBe(e){return $0.count(toe(e.getFullYear())-1,e)}function EZ(e){return J_.count(toe(e.getFullYear())-1,e)}function AZ(e){return toe(e).getDay()}function Urn(e,t,n,r,i,s,a){if(0<=e&&e<100){const o=new Date(-1,t,n,r,i,s,a);return o.setFullYear(e),o}return new Date(e,t,n,r,i,s,a)}function Wrn(e){return NBe(new Date(e))}function Vrn(e){return TZ(new Date(e))}function NBe(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return C0.count(t-1,e)}function TZ(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return eS.count(t-1,e)}function DZ(e){return p1.setTime(Date.UTC(e,0,1)),p1.getUTCDay()}function jrn(e,t,n,r,i,s,a){if(0<=e&&e<100){const o=new Date(Date.UTC(-1,t,n,r,i,s,a));return o.setUTCFullYear(n.y),o}return new Date(Date.UTC(e,t,n,r,i,s,a))}function IBe(e,t,n,r,i){const s=t||1,a=vBe(e),o=(v,y,b)=>(b=b||v,Hrn(n[b],r[b],v===a&&s,y)),l=new Date,u=_rn(e),c=u[fo]?o(fo):brn(2012),f=u[el]?o(el):u[Wu]?o(Wu):wk,h=u[Rs]&&u[io]?o(io,1,Rs+io):u[Rs]?o(Rs,1):u[io]?o(io,1):u[Vu]?o(Vu,1):u[zh]?o(zh,1):grn,d=u[rf]?o(rf):wk,p=u[sf]?o(sf):wk,g=u[Uh]?o(Uh):wk,m=u[Wh]?o(Wh):wk;return function(v){l.setTime(+v);const y=c(l);return i(y,f(l),h(l,y),d(l),p(l),g(l),m(l))}}function Hrn(e,t,n,r){const i=n<=1?e:r?(s,a)=>r+n*Math.floor((e(s,a)-r)/n):(s,a)=>n*Math.floor(e(s,a)/n);return t?(s,a)=>t(i(s,a),a):i}function $$(e,t,n){return t+e*7-(n+6)%7}const qrn={[fo]:e=>e.getFullYear(),[Wu]:e=>Math.floor(e.getMonth()/3),[el]:e=>e.getMonth(),[Vu]:e=>e.getDate(),[rf]:e=>e.getHours(),[sf]:e=>e.getMinutes(),[Uh]:e=>e.getSeconds(),[Wh]:e=>e.getMilliseconds(),[zh]:e=>DBe(e),[Rs]:e=>EZ(e),[Rs+io]:(e,t)=>$$(EZ(e),e.getDay(),AZ(t)),[io]:(e,t)=>$$(1,e.getDay(),AZ(t))},Grn={[Wu]:e=>3*e,[Rs]:(e,t)=>$$(e,0,AZ(t))};function Yrn(e,t){return IBe(e,t||1,qrn,Grn,Urn)}const Xrn={[fo]:e=>e.getUTCFullYear(),[Wu]:e=>Math.floor(e.getUTCMonth()/3),[el]:e=>e.getUTCMonth(),[Vu]:e=>e.getUTCDate(),[rf]:e=>e.getUTCHours(),[sf]:e=>e.getUTCMinutes(),[Uh]:e=>e.getUTCSeconds(),[Wh]:e=>e.getUTCMilliseconds(),[zh]:e=>NBe(e),[Rs]:e=>TZ(e),[io]:(e,t)=>$$(1,e.getUTCDay(),DZ(t)),[Rs+io]:(e,t)=>$$(TZ(e),e.getUTCDay(),DZ(t))},Krn={[Wu]:e=>3*e,[Rs]:(e,t)=>$$(e,0,DZ(t))};function Zrn(e,t){return IBe(e,t||1,Xrn,Krn,jrn)}const Qrn={[fo]:am,[Wu]:BL.every(3),[el]:BL,[Rs]:J_,[Vu]:$0,[io]:$0,[zh]:$0,[rf]:Kae,[sf]:Xae,[Uh]:s0,[Wh]:Gae},Jrn={[fo]:om,[Wu]:UL.every(3),[el]:UL,[Rs]:eS,[Vu]:C0,[io]:C0,[zh]:C0,[rf]:Jae,[sf]:Qae,[Uh]:s0,[Wh]:Gae};function noe(e){return Qrn[e]}function roe(e){return Jrn[e]}function MBe(e,t,n){return e?e.offset(t,n):void 0}function ein(e,t,n){return MBe(noe(e),t,n)}function tin(e,t,n){return MBe(roe(e),t,n)}function FBe(e,t,n,r){return e?e.range(t,n,r):void 0}function nin(e,t,n,r){return FBe(noe(e),t,n,r)}function rin(e,t,n,r){return FBe(roe(e),t,n,r)}const LE=1e3,BE=LE*60,zE=BE*60,X9=zE*24,iin=X9*7,Sbe=X9*30,NZ=X9*365,OBe=[fo,el,Vu,rf,sf,Uh,Wh],UE=OBe.slice(0,-1),WE=UE.slice(0,-1),VE=WE.slice(0,-1),sin=VE.slice(0,-1),ain=[fo,Rs],kbe=[fo,el],RBe=[fo],$k=[[UE,1,LE],[UE,5,5*LE],[UE,15,15*LE],[UE,30,30*LE],[WE,1,BE],[WE,5,5*BE],[WE,15,15*BE],[WE,30,30*BE],[VE,1,zE],[VE,3,3*zE],[VE,6,6*zE],[VE,12,12*zE],[sin,1,X9],[ain,1,iin],[kbe,1,Sbe],[kbe,3,3*Sbe],[RBe,1,NZ]];function oin(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(Crn(t))/n;let i=tM(o=>o[2]).right($k,r),s,a;return i===$k.length?(s=RBe,a=J0(t[0]/NZ,t[1]/NZ,n)):i?(i=$k[r/$k[i-1][2]<$k[i][2]/r?i-1:i],s=i[0],a=i[1]):(s=OBe,a=Math.max(J0(t[0],t[1],n),1)),{units:s,step:a}}function tS(e,t,n){return e.fields=t||[],e.fname=n,e}function lin(e){return e.length===1?uin(e[0]):cin(e)}const uin=e=>function(t){return t[e]},cin=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Vc(e){throw Error(e)}function fin(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||Vc("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&Vc("Access path missing closing bracket: "+e),r&&Vc("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function PBe(e,t,n){const r=fin(e);return e=r.length===1?r[0]:e,tS((n&&n.get||lin)(r),[e],t||e)}PBe("id");const LBe=tS(e=>e,[],"identity");tS(()=>0,[],"zero");tS(()=>1,[],"one");tS(()=>!0,[],"true");tS(()=>!1,[],"false");var BBe=Array.isArray;function ioe(e){return e===Object(e)}function Ebe(e){return e==null||e===""?null:+e}function soe(e){return typeof e=="function"}function aoe(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}const hin=Object.prototype.hasOwnProperty;function zBe(e,t){return hin.call(e,t)}function din(e){return Object.prototype.toString.call(e)==="[object Date]"}function pin(e){return e&&soe(e[Symbol.iterator])}function gin(e){return typeof e=="number"}function IZ(e){return typeof e=="string"}function ooe(e){return BBe(e)?"["+e.map(ooe)+"]":ioe(e)||IZ(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function min(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const vin=e=>gin(e)||din(e)?e:Date.parse(e);function yin(e,t){return t=t||vin,e==null||e===""?null:t(e)}function bin(e){return e==null||e===""?null:e+""}var Abe={},tq={},nq=34,Ck=10,rq=13;function UBe(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function xin(e,t){var n=UBe(e);return function(r,i){return t(n(r),i,e)}}function Tbe(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Oo(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function win(e){return e<0?"-"+Oo(-e,6):e>9999?"+"+Oo(e,6):Oo(e,4)}function $in(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":win(e.getUTCFullYear())+"-"+Oo(e.getUTCMonth()+1,2)+"-"+Oo(e.getUTCDate(),2)+(i?"T"+Oo(t,2)+":"+Oo(n,2)+":"+Oo(r,2)+"."+Oo(i,3)+"Z":r?"T"+Oo(t,2)+":"+Oo(n,2)+":"+Oo(r,2)+"Z":n||t?"T"+Oo(t,2)+":"+Oo(n,2)+"Z":"")}function Cin(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,h){var d,p,g=i(f,function(m,v){if(d)return d(m,v-1);p=m,d=h?xin(m,h):UBe(m)});return g.columns=p||[],g}function i(f,h){var d=[],p=f.length,g=0,m=0,v,y=p<=0,b=!1;f.charCodeAt(p-1)===Ck&&--p,f.charCodeAt(p-1)===rq&&--p;function x(){if(y)return tq;if(b)return b=!1,Abe;var C,$=g,_;if(f.charCodeAt($)===nq){for(;g++<p&&f.charCodeAt(g)!==nq||f.charCodeAt(++g)===nq;);return(C=g)>=p?y=!0:(_=f.charCodeAt(g++))===Ck?b=!0:_===rq&&(b=!0,f.charCodeAt(g)===Ck&&++g),f.slice($+1,C-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(C=g++))===Ck)b=!0;else if(_===rq)b=!0,f.charCodeAt(g)===Ck&&++g;else if(_!==n)continue;return f.slice($,C)}return y=!0,f.slice($,p)}for(;(v=x())!==tq;){for(var w=[];v!==Abe&&v!==tq;)w.push(v),v=x();h&&(w=h(w,m++))==null||d.push(w)}return d}function s(f,h){return f.map(function(d){return h.map(function(p){return c(d[p])}).join(e)})}function a(f,h){return h==null&&(h=Tbe(f)),[h.map(c).join(e)].concat(s(f,h)).join(`
`)}function o(f,h){return h==null&&(h=Tbe(f)),s(f,h).join(`
`)}function l(f){return f.map(u).join(`
`)}function u(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?$in(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:a,formatBody:o,formatRows:l,formatRow:u,formatValue:c}}const _in=Math.sqrt(50),Sin=Math.sqrt(10),kin=Math.sqrt(2);function WBe(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=_in?10:s>=Sin?5:s>=kin?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?WBe(e,t,n*2):[o,l,u]}function Dbe(e,t,n){return t=+t,e=+e,n=+n,WBe(e,t,n)[2]}function Ein(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?Dbe(t,e,n):Dbe(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function Ain(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function WL(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function C$(e){return e=WL(Math.abs(e)),e?e[1]:NaN}function Tin(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function Din(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Nin=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function g3(e){if(!(t=Nin.exec(e)))throw new Error("invalid format: "+e);var t;return new loe({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}g3.prototype=loe.prototype;function loe(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}loe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Iin(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var VBe;function Min(e,t){var n=WL(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(VBe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+WL(e,Math.max(0,t+s-1))[0]}function Nbe(e,t){var n=WL(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Ibe={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Ain,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Nbe(e*100,t),r:Nbe,s:Min,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Mbe(e){return e}var Fbe=Array.prototype.map,Obe=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Fin(e){var t=e.grouping===void 0||e.thousands===void 0?Mbe:Tin(Fbe.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?Mbe:Din(Fbe.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=g3(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):Ibe[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var C=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=g==="$"?r:/[%p]/.test(w)?a:"",_=Ibe[w],k=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(S){var N=C,A=$,D,T,I;if(w==="c")A=_(S)+A,S="";else{S=+S;var F=S<0||1/S<0;if(S=isNaN(S)?l:_(Math.abs(S),b),x&&(S=Iin(S)),F&&+S==0&&p!=="+"&&(F=!1),N=(F?p==="("?p:o:p==="-"||p==="("?"":p)+N,A=(w==="s"?Obe[8+VBe/3]:"")+A+(F&&p==="("?")":""),k){for(D=-1,T=S.length;++D<T;)if(I=S.charCodeAt(D),48>I||I>57){A=(I===46?i+S.slice(D+1):S.slice(D))+A,S=S.slice(0,D);break}}}y&&!m&&(S=t(S,1/0));var R=N.length+S.length+A.length,P=R<v?new Array(v-R+1).join(h):"";switch(y&&m&&(S=t(P+S,P.length?v-A.length:1/0),P=""),d){case"<":S=N+S+A+P;break;case"=":S=N+P+S+A;break;case"^":S=P.slice(0,R=P.length>>1)+N+S+A+P.slice(R);break;default:S=P+N+S+A;break}return s(S)}return E.toString=function(){return f+""},E}function c(f,h){var d=u((f=g3(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(C$(h)/3)))*3,g=Math.pow(10,-p),m=Obe[8+p/3];return function(v){return d(g*v)+m}}return{format:u,formatPrefix:c}}var uR,jBe,HBe;Oin({thousands:",",grouping:[3],currency:["$",""]});function Oin(e){return uR=Fin(e),jBe=uR.format,HBe=uR.formatPrefix,uR}function Rin(e){return Math.max(0,-C$(Math.abs(e)))}function Pin(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(C$(t)/3)))*3-C$(Math.abs(e)))}function Lin(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,C$(t)-C$(e))+1}const iq=new Date,sq=new Date;function Wi(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>Wi(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(iq.setTime(+s),sq.setTime(+a),e(iq),e(sq),Math.floor(n(iq,sq))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const m3=Wi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);m3.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Wi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):m3);m3.range;const v3=1e3,lm=v3*60,y3=lm*60,b3=y3*24,qBe=b3*7,uoe=Wi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*v3)},(e,t)=>(t-e)/v3,e=>e.getUTCSeconds());uoe.range;const GBe=Wi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*v3)},(e,t)=>{e.setTime(+e+t*lm)},(e,t)=>(t-e)/lm,e=>e.getMinutes());GBe.range;const YBe=Wi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*lm)},(e,t)=>(t-e)/lm,e=>e.getUTCMinutes());YBe.range;const XBe=Wi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*v3-e.getMinutes()*lm)},(e,t)=>{e.setTime(+e+t*y3)},(e,t)=>(t-e)/y3,e=>e.getHours());XBe.range;const KBe=Wi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*y3)},(e,t)=>(t-e)/y3,e=>e.getUTCHours());KBe.range;const aw=Wi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*lm)/b3,e=>e.getDate()-1);aw.range;const ow=Wi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/b3,e=>e.getUTCDate()-1);ow.range;const Bin=Wi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/b3,e=>Math.floor(e/b3));Bin.range;function hx(e){return Wi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*lm)/qBe)}const coe=hx(0),VL=hx(1),zin=hx(2),Uin=hx(3),_$=hx(4),Win=hx(5),Vin=hx(6);coe.range;VL.range;zin.range;Uin.range;_$.range;Win.range;Vin.range;function dx(e){return Wi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/qBe)}const foe=dx(0),jL=dx(1),jin=dx(2),Hin=dx(3),S$=dx(4),qin=dx(5),Gin=dx(6);foe.range;jL.range;jin.range;Hin.range;S$.range;qin.range;Gin.range;const MZ=Wi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());MZ.range;const FZ=Wi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());FZ.range;const um=Wi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());um.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Wi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});um.range;const cm=Wi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());cm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Wi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});cm.range;const x3="year",w3="quarter",$3="month",C3="week",_3="date",K9="day",hoe="dayofyear",S3="hours",k3="minutes",E3="seconds",Z9="milliseconds",Yin=[x3,w3,$3,C3,_3,K9,hoe,S3,k3,E3,Z9];Yin.reduce((e,t,n)=>(e[t]=1+n,e),{});const Xin={[x3]:um,[w3]:MZ.every(3),[$3]:MZ,[C3]:coe,[_3]:aw,[K9]:aw,[hoe]:aw,[S3]:XBe,[k3]:GBe,[E3]:uoe,[Z9]:m3},Kin={[x3]:cm,[w3]:FZ.every(3),[$3]:FZ,[C3]:foe,[_3]:ow,[K9]:ow,[hoe]:ow,[S3]:KBe,[k3]:YBe,[E3]:uoe,[Z9]:m3};function Zin(e){return Xin[e]}function Qin(e){return Kin[e]}function aq(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function oq(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function _k(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function ZBe(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=Sk(i),c=kk(i),f=Sk(s),h=kk(s),d=Sk(a),p=kk(a),g=Sk(o),m=kk(o),v=Sk(l),y=kk(l),b={a:F,A:R,b:P,B:V,c:null,d:Ube,e:Ube,f:wsn,g:Nsn,G:Msn,H:ysn,I:bsn,j:xsn,L:QBe,m:$sn,M:Csn,p:z,q,Q:jbe,s:Hbe,S:_sn,u:Ssn,U:ksn,V:Esn,w:Asn,W:Tsn,x:null,X:null,y:Dsn,Y:Isn,Z:Fsn,"%":Vbe},x={a:G,A:K,b:Y,B:te,c:null,d:Wbe,e:Wbe,f:Lsn,g:Ysn,G:Ksn,H:Osn,I:Rsn,j:Psn,L:eze,m:Bsn,M:zsn,p:Z,q:ae,Q:jbe,s:Hbe,S:Usn,u:Wsn,U:Vsn,V:jsn,w:Hsn,W:qsn,x:null,X:null,y:Gsn,Y:Xsn,Z:Zsn,"%":Vbe},w={a:E,A:S,b:N,B:A,c:D,d:Bbe,e:Bbe,f:psn,g:Lbe,G:Pbe,H:zbe,I:zbe,j:csn,L:dsn,m:usn,M:fsn,p:k,q:lsn,Q:msn,s:vsn,S:hsn,u:rsn,U:isn,V:ssn,w:nsn,W:asn,x:T,X:I,y:Lbe,Y:Pbe,Z:osn,"%":gsn};b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x);function C(O,L){return function(W){var M=[],ue=-1,X=0,se=O.length,oe,pe,Ce;for(W instanceof Date||(W=new Date(+W));++ue<se;)O.charCodeAt(ue)===37&&(M.push(O.slice(X,ue)),(pe=Rbe[oe=O.charAt(++ue)])!=null?oe=O.charAt(++ue):pe=oe==="e"?" ":"0",(Ce=L[oe])&&(oe=Ce(W,pe)),M.push(oe),X=ue+1);return M.push(O.slice(X,ue)),M.join("")}}function $(O,L){return function(W){var M=_k(1900,void 0,1),ue=_(M,O,W+="",0),X,se;if(ue!=W.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(L&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(X=oq(_k(M.y,0,1)),se=X.getUTCDay(),X=se>4||se===0?jL.ceil(X):jL(X),X=ow.offset(X,(M.V-1)*7),M.y=X.getUTCFullYear(),M.m=X.getUTCMonth(),M.d=X.getUTCDate()+(M.w+6)%7):(X=aq(_k(M.y,0,1)),se=X.getDay(),X=se>4||se===0?VL.ceil(X):VL(X),X=aw.offset(X,(M.V-1)*7),M.y=X.getFullYear(),M.m=X.getMonth(),M.d=X.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),se="Z"in M?oq(_k(M.y,0,1)).getUTCDay():aq(_k(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(se+5)%7:M.w+M.U*7-(se+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,oq(M)):aq(M)}}function _(O,L,W,M){for(var ue=0,X=L.length,se=W.length,oe,pe;ue<X;){if(M>=se)return-1;if(oe=L.charCodeAt(ue++),oe===37){if(oe=L.charAt(ue++),pe=w[oe in Rbe?L.charAt(ue++):oe],!pe||(M=pe(O,W,M))<0)return-1}else if(oe!=W.charCodeAt(M++))return-1}return M}function k(O,L,W){var M=u.exec(L.slice(W));return M?(O.p=c.get(M[0].toLowerCase()),W+M[0].length):-1}function E(O,L,W){var M=d.exec(L.slice(W));return M?(O.w=p.get(M[0].toLowerCase()),W+M[0].length):-1}function S(O,L,W){var M=f.exec(L.slice(W));return M?(O.w=h.get(M[0].toLowerCase()),W+M[0].length):-1}function N(O,L,W){var M=v.exec(L.slice(W));return M?(O.m=y.get(M[0].toLowerCase()),W+M[0].length):-1}function A(O,L,W){var M=g.exec(L.slice(W));return M?(O.m=m.get(M[0].toLowerCase()),W+M[0].length):-1}function D(O,L,W){return _(O,t,L,W)}function T(O,L,W){return _(O,n,L,W)}function I(O,L,W){return _(O,r,L,W)}function F(O){return a[O.getDay()]}function R(O){return s[O.getDay()]}function P(O){return l[O.getMonth()]}function V(O){return o[O.getMonth()]}function z(O){return i[+(O.getHours()>=12)]}function q(O){return 1+~~(O.getMonth()/3)}function G(O){return a[O.getUTCDay()]}function K(O){return s[O.getUTCDay()]}function Y(O){return l[O.getUTCMonth()]}function te(O){return o[O.getUTCMonth()]}function Z(O){return i[+(O.getUTCHours()>=12)]}function ae(O){return 1+~~(O.getUTCMonth()/3)}return{format:function(O){var L=C(O+="",b);return L.toString=function(){return O},L},parse:function(O){var L=$(O+="",!1);return L.toString=function(){return O},L},utcFormat:function(O){var L=C(O+="",x);return L.toString=function(){return O},L},utcParse:function(O){var L=$(O+="",!0);return L.toString=function(){return O},L}}}var Rbe={"-":"",_:" ",0:"0"},$s=/^\s*\d+/,Jin=/^%/,esn=/[\\^$*+?|[\]().{}]/g;function _n(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function tsn(e){return e.replace(esn,"\\$&")}function Sk(e){return new RegExp("^(?:"+e.map(tsn).join("|")+")","i")}function kk(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function nsn(e,t,n){var r=$s.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function rsn(e,t,n){var r=$s.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function isn(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function ssn(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function asn(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Pbe(e,t,n){var r=$s.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Lbe(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function osn(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function lsn(e,t,n){var r=$s.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function usn(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Bbe(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function csn(e,t,n){var r=$s.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function zbe(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function fsn(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function hsn(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function dsn(e,t,n){var r=$s.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function psn(e,t,n){var r=$s.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function gsn(e,t,n){var r=Jin.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function msn(e,t,n){var r=$s.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function vsn(e,t,n){var r=$s.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Ube(e,t){return _n(e.getDate(),t,2)}function ysn(e,t){return _n(e.getHours(),t,2)}function bsn(e,t){return _n(e.getHours()%12||12,t,2)}function xsn(e,t){return _n(1+aw.count(um(e),e),t,3)}function QBe(e,t){return _n(e.getMilliseconds(),t,3)}function wsn(e,t){return QBe(e,t)+"000"}function $sn(e,t){return _n(e.getMonth()+1,t,2)}function Csn(e,t){return _n(e.getMinutes(),t,2)}function _sn(e,t){return _n(e.getSeconds(),t,2)}function Ssn(e){var t=e.getDay();return t===0?7:t}function ksn(e,t){return _n(coe.count(um(e)-1,e),t,2)}function JBe(e){var t=e.getDay();return t>=4||t===0?_$(e):_$.ceil(e)}function Esn(e,t){return e=JBe(e),_n(_$.count(um(e),e)+(um(e).getDay()===4),t,2)}function Asn(e){return e.getDay()}function Tsn(e,t){return _n(VL.count(um(e)-1,e),t,2)}function Dsn(e,t){return _n(e.getFullYear()%100,t,2)}function Nsn(e,t){return e=JBe(e),_n(e.getFullYear()%100,t,2)}function Isn(e,t){return _n(e.getFullYear()%1e4,t,4)}function Msn(e,t){var n=e.getDay();return e=n>=4||n===0?_$(e):_$.ceil(e),_n(e.getFullYear()%1e4,t,4)}function Fsn(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+_n(t/60|0,"0",2)+_n(t%60,"0",2)}function Wbe(e,t){return _n(e.getUTCDate(),t,2)}function Osn(e,t){return _n(e.getUTCHours(),t,2)}function Rsn(e,t){return _n(e.getUTCHours()%12||12,t,2)}function Psn(e,t){return _n(1+ow.count(cm(e),e),t,3)}function eze(e,t){return _n(e.getUTCMilliseconds(),t,3)}function Lsn(e,t){return eze(e,t)+"000"}function Bsn(e,t){return _n(e.getUTCMonth()+1,t,2)}function zsn(e,t){return _n(e.getUTCMinutes(),t,2)}function Usn(e,t){return _n(e.getUTCSeconds(),t,2)}function Wsn(e){var t=e.getUTCDay();return t===0?7:t}function Vsn(e,t){return _n(foe.count(cm(e)-1,e),t,2)}function tze(e){var t=e.getUTCDay();return t>=4||t===0?S$(e):S$.ceil(e)}function jsn(e,t){return e=tze(e),_n(S$.count(cm(e),e)+(cm(e).getUTCDay()===4),t,2)}function Hsn(e){return e.getUTCDay()}function qsn(e,t){return _n(jL.count(cm(e)-1,e),t,2)}function Gsn(e,t){return _n(e.getUTCFullYear()%100,t,2)}function Ysn(e,t){return e=tze(e),_n(e.getUTCFullYear()%100,t,2)}function Xsn(e,t){return _n(e.getUTCFullYear()%1e4,t,4)}function Ksn(e,t){var n=e.getUTCDay();return e=n>=4||n===0?S$(e):S$.ceil(e),_n(e.getUTCFullYear()%1e4,t,4)}function Zsn(){return"+0000"}function Vbe(){return"%"}function jbe(e){return+e}function Hbe(e){return Math.floor(+e/1e3)}var h2,nze,rze,ize,sze;Qsn({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Qsn(e){return h2=ZBe(e),nze=h2.format,rze=h2.parse,ize=h2.utcFormat,sze=h2.utcParse,h2}function jE(e){const t={};return n=>t[n]||(t[n]=e(n))}function Jsn(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=ean(r,i);const a=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+a}}function ean(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function tan(e){const t=jE(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=g3(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return Jsn(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,a){a=g3(a==null?",f":a);const o=Ein(r,i,s),l=Math.max(Math.abs(r),Math.abs(i));let u;if(a.precision==null)switch(a.type){case"s":return isNaN(u=Pin(o,l))||(a.precision=u),n(a,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=Lin(o,l))||(a.precision=u-(a.type==="e"));break}case"f":case"%":{isNaN(u=Rin(o))||(a.precision=u-(a.type==="%")*2);break}}return t(a)}}}nan();function nan(){return tan({format:jBe,formatPrefix:HBe})}function qbe(e,t,n){n=n||{},ioe(n)||Vc(`Invalid time multi-format specifier: ${n}`);const r=t(E3),i=t(k3),s=t(S3),a=t(_3),o=t(C3),l=t($3),u=t(w3),c=t(x3),f=e(n[Z9]||".%L"),h=e(n[E3]||":%S"),d=e(n[k3]||"%I:%M"),p=e(n[S3]||"%I %p"),g=e(n[_3]||n[K9]||"%a %d"),m=e(n[C3]||"%b %d"),v=e(n[$3]||"%B"),y=e(n[w3]||"%B"),b=e(n[x3]||"%Y");return x=>(r(x)<x?f:i(x)<x?h:s(x)<x?d:a(x)<x?p:l(x)<x?o(x)<x?g:m:c(x)<x?u(x)<x?v:y:b)(x)}function aze(e){const t=jE(e.format),n=jE(e.utcFormat);return{timeFormat:r=>IZ(r)?t(r):qbe(t,Zin,r),utcFormat:r=>IZ(r)?n(r):qbe(n,Qin,r),timeParse:jE(e.parse),utcParse:jE(e.utcParse)}}let OZ;ran();function ran(){return OZ=aze({format:nze,parse:rze,utcFormat:ize,utcParse:sze})}function ian(e){return aze(ZBe(e))}function san(e){return arguments.length?OZ=ian(e):OZ}const aan=/^(data:|([A-Za-z]+:)?\/\/)/,oan=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,lan=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Gbe="file://";function uan(e,t){return n=>({options:n||{},sanitize:fan,load:can,fileAccess:!!t,file:han(t),http:pan(e)})}async function can(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function fan(e,t){t=aoe({},this.options,t);const n=this.fileAccess,r={href:null};let i,s,a;const o=oan.test(e.replace(lan,""));(e==null||typeof e!="string"||!o)&&Vc("Sanitize failure, invalid URI: "+ooe(e));const l=aan.test(e);return(a=t.baseURL)&&!l&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),s=(i=e.startsWith(Gbe))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice(Gbe.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!s}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function han(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,s)=>{i?r(i):n(s)})}):dan}async function dan(){Vc("No file system access.")}function pan(e){return e?async function(t,n){const r=aoe({},this.options.http,n),i=n&&n.response,s=await e(t,r);return s.ok?soe(s[i])?s[i]():s.text():Vc(s.status+""+s.statusText)}:gan}async function gan(){Vc("No HTTP fetch method available.")}const man=e=>e!=null&&e===e,van=e=>e==="true"||e==="false"||e===!0||e===!1,yan=e=>!Number.isNaN(Date.parse(e)),oze=e=>!Number.isNaN(+e)&&!(e instanceof Date),ban=e=>oze(e)&&Number.isInteger(+e),RZ={boolean:min,integer:Ebe,number:Ebe,date:yin,string:bin,unknown:LBe},cR=[van,ban,oze,yan],xan=["boolean","integer","number","date"];function lze(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=cR.length,i=cR.map((s,a)=>a+1);for(let s=0,a=0,o,l;s<n;++s)for(l=t?e[s][t]:e[s],o=0;o<r;++o)if(i[o]&&man(l)&&!cR[o](l)&&(i[o]=0,++a,a===cR.length))return"string";return xan[i.reduce((s,a)=>s===0?a:s,0)-1]}function uze(e,t){return t.reduce((n,r)=>(n[r]=lze(e,r),n),{})}function Ybe(e){const t=function(n,r){const i={delimiter:e};return doe(n,r?aoe(r,i):i)};return t.responseType="text",t}function doe(e,t){return t.header&&(e=t.header.map(ooe).join(t.delimiter)+`
`+e),Cin(t.delimiter).parse(e+"")}doe.responseType="text";function wan(e){return typeof Buffer=="function"&&soe(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function poe(e,t){const n=t&&t.property?PBe(t.property):LBe;return ioe(e)&&!wan(e)?$an(n(e),t):n(JSON.parse(e))}poe.responseType="json";function $an(e,t){return!BBe(e)&&pin(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const Can={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function cze(e,t){let n,r,i,s;return e=poe(e,t),t&&t.feature?(n=dOe,i=t.feature):t&&t.mesh?(n=gOe,i=t.mesh,s=Can[t.filter]):Vc("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,s):Vc("Invalid TopoJSON object: "+i),r&&r.features||[r]}cze.responseType="json";const S4={dsv:doe,csv:Ybe(","),tsv:Ybe("	"),json:poe,topojson:cze};function goe(e,t){return arguments.length>1?(S4[e]=t,this):zBe(S4,e)?S4[e]:null}function _an(e){const t=goe(e);return t&&t.responseType||"text"}function San(e,t,n,r){t=t||{};const i=goe(t.type||"json");return i||Vc("Unknown data format type: "+t.type),e=i(e,t),t.parse&&kan(e,t.parse,n,r),zBe(e,"columns")&&delete e.columns,e}function kan(e,t,n,r){if(!e.length)return;const i=san();n=n||i.timeParse,r=r||i.utcParse;let s=e.columns||Object.keys(e[0]),a,o,l,u,c,f;t==="auto"&&(t=uze(e,s)),s=Object.keys(t);const h=s.map(d=>{const p=t[d];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?r:n)(m);if(!RZ[p])throw Error("Illegal format pattern: "+d+":"+p);return RZ[p]});for(l=0,c=e.length,f=s.length;l<c;++l)for(a=e[l],u=0;u<f;++u)o=s[u],a[o]=h[u](a[o])}const Ean=uan(typeof fetch<"u"&&fetch,null);function nS(e,t,n){return e.fields=t||[],e.fname=n,e}function Aan(e){return e.length===1?Tan(e[0]):Dan(e)}const Tan=e=>function(t){return t[e]},Dan=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function ph(e){throw Error(e)}function Nan(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||ph("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&ph("Access path missing closing bracket: "+e),r&&ph("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function Ian(e,t,n){const r=Nan(e);return e=r.length===1?r[0]:e,nS((n&&n.get||Aan)(r),[e],t||e)}Ian("id");nS(e=>e,[],"identity");nS(()=>0,[],"zero");nS(()=>1,[],"one");const fze=nS(()=>!0,[],"true");nS(()=>!1,[],"false");var ud=Array.isArray;function HL(e){return e===Object(e)}function ab(e){return e[e.length-1]}function Man(e){return e==null||e===""?null:+e}function moe(e){return e!=null?ud(e)?e:[e]:[]}function Q9(e){return typeof e=="function"}function J9(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}const Fan=Object.prototype.hasOwnProperty;function Kd(e,t){return Fan.call(e,t)}function rS(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),J9(r,n)}function Xbe(e){return typeof e=="number"}function qL(e){return typeof e=="string"}const Oan=1e4;function Ran(e){e=+e||Oan;let t,n,r;const i=()=>{t={},n={},r=0},s=(a,o)=>(++r>e&&(n=t,t={},r=1),t[a]=o);return i(),{clear:i,has:a=>Kd(t,a)||Kd(n,a),get:a=>Kd(t,a)?t[a]:Kd(n,a)?s(a,n[a]):void 0,set:(a,o)=>Kd(t,a)?t[a]=o:s(a,o)}}function hze(e){return ud(e)?"["+e.map(hze)+"]":HL(e)||qL(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function dze(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}const PZ=Math.PI,LZ=2*PZ,Jv=1e-6,Pan=LZ-Jv;function BZ(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function px(){return new BZ}BZ.prototype=px.prototype={constructor:BZ,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,s){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var s=this._x1,a=this._y1,o=n-e,l=r-t,u=s-e,c=a-t,f=u*u+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>Jv)if(!(Math.abs(c*o-l*u)>Jv)||!i)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var h=n-s,d=r-a,p=o*o+l*l,g=h*h+d*d,m=Math.sqrt(p),v=Math.sqrt(f),y=i*Math.tan((PZ-Math.acos((p+f-g)/(2*m*v)))/2),b=y/v,x=y/m;Math.abs(b-1)>Jv&&(this._+="L"+(e+b*u)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*h>u*d)+","+(this._x1=e+x*o)+","+(this._y1=t+x*l)}},arc:function(e,t,n,r,i,s){e=+e,t=+t,n=+n,s=!!s;var a=n*Math.cos(r),o=n*Math.sin(r),l=e+a,u=t+o,c=1^s,f=s?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+l+","+u:(Math.abs(this._x1-l)>Jv||Math.abs(this._y1-u)>Jv)&&(this._+="L"+l+","+u),n&&(f<0&&(f=f%LZ+LZ),f>Pan?this._+="A"+n+","+n+",0,1,"+c+","+(e-a)+","+(t-o)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):f>Jv&&(this._+="A"+n+","+n+",0,"+ +(f>=PZ)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function In(e){return function(){return e}}var Kbe=Math.abs,ea=Math.atan2,Iv=Math.cos,Lan=Math.max,lq=Math.min,Tf=Math.sin,P2=Math.sqrt,ia=1e-12,k$=Math.PI,GL=k$/2,pze=2*k$;function Ban(e){return e>1?0:e<-1?k$:Math.acos(e)}function Zbe(e){return e>=1?GL:e<=-1?-GL:Math.asin(e)}function zan(e){return e.innerRadius}function Uan(e){return e.outerRadius}function Wan(e){return e.startAngle}function Van(e){return e.endAngle}function jan(e){return e&&e.padAngle}function Han(e,t,n,r,i,s,a,o){var l=n-e,u=r-t,c=a-i,f=o-s,h=f*l-c*u;if(!(h*h<ia))return h=(c*(t-s)-f*(e-i))/h,[e+h*l,t+h*u]}function fR(e,t,n,r,i,s,a){var o=e-n,l=t-r,u=(a?s:-s)/P2(o*o+l*l),c=u*l,f=-u*o,h=e+c,d=t+f,p=n+c,g=r+f,m=(h+p)/2,v=(d+g)/2,y=p-h,b=g-d,x=y*y+b*b,w=i-s,C=h*g-p*d,$=(b<0?-1:1)*P2(Lan(0,w*w*x-C*C)),_=(C*b-y*$)/x,k=(-C*y-b*$)/x,E=(C*b+y*$)/x,S=(-C*y+b*$)/x,N=_-m,A=k-v,D=E-m,T=S-v;return N*N+A*A>D*D+T*T&&(_=E,k=S),{cx:_,cy:k,x01:-c,y01:-f,x11:_*(i/w-1),y11:k*(i/w-1)}}function qan(){var e=zan,t=Uan,n=In(0),r=null,i=Wan,s=Van,a=jan,o=null;function l(){var u,c,f=+e.apply(this,arguments),h=+t.apply(this,arguments),d=i.apply(this,arguments)-GL,p=s.apply(this,arguments)-GL,g=Kbe(p-d),m=p>d;if(o||(o=u=px()),h<f&&(c=h,h=f,f=c),!(h>ia))o.moveTo(0,0);else if(g>pze-ia)o.moveTo(h*Iv(d),h*Tf(d)),o.arc(0,0,h,d,p,!m),f>ia&&(o.moveTo(f*Iv(p),f*Tf(p)),o.arc(0,0,f,p,d,m));else{var v=d,y=p,b=d,x=p,w=g,C=g,$=a.apply(this,arguments)/2,_=$>ia&&(r?+r.apply(this,arguments):P2(f*f+h*h)),k=lq(Kbe(h-f)/2,+n.apply(this,arguments)),E=k,S=k,N,A;if(_>ia){var D=Zbe(_/f*Tf($)),T=Zbe(_/h*Tf($));(w-=D*2)>ia?(D*=m?1:-1,b+=D,x-=D):(w=0,b=x=(d+p)/2),(C-=T*2)>ia?(T*=m?1:-1,v+=T,y-=T):(C=0,v=y=(d+p)/2)}var I=h*Iv(v),F=h*Tf(v),R=f*Iv(x),P=f*Tf(x);if(k>ia){var V=h*Iv(y),z=h*Tf(y),q=f*Iv(b),G=f*Tf(b),K;if(g<k$&&(K=Han(I,F,q,G,V,z,R,P))){var Y=I-K[0],te=F-K[1],Z=V-K[0],ae=z-K[1],O=1/Tf(Ban((Y*Z+te*ae)/(P2(Y*Y+te*te)*P2(Z*Z+ae*ae)))/2),L=P2(K[0]*K[0]+K[1]*K[1]);E=lq(k,(f-L)/(O-1)),S=lq(k,(h-L)/(O+1))}}C>ia?S>ia?(N=fR(q,G,I,F,h,S,m),A=fR(V,z,R,P,h,S,m),o.moveTo(N.cx+N.x01,N.cy+N.y01),S<k?o.arc(N.cx,N.cy,S,ea(N.y01,N.x01),ea(A.y01,A.x01),!m):(o.arc(N.cx,N.cy,S,ea(N.y01,N.x01),ea(N.y11,N.x11),!m),o.arc(0,0,h,ea(N.cy+N.y11,N.cx+N.x11),ea(A.cy+A.y11,A.cx+A.x11),!m),o.arc(A.cx,A.cy,S,ea(A.y11,A.x11),ea(A.y01,A.x01),!m))):(o.moveTo(I,F),o.arc(0,0,h,v,y,!m)):o.moveTo(I,F),!(f>ia)||!(w>ia)?o.lineTo(R,P):E>ia?(N=fR(R,P,V,z,f,-E,m),A=fR(I,F,q,G,f,-E,m),o.lineTo(N.cx+N.x01,N.cy+N.y01),E<k?o.arc(N.cx,N.cy,E,ea(N.y01,N.x01),ea(A.y01,A.x01),!m):(o.arc(N.cx,N.cy,E,ea(N.y01,N.x01),ea(N.y11,N.x11),!m),o.arc(0,0,f,ea(N.cy+N.y11,N.cx+N.x11),ea(A.cy+A.y11,A.cx+A.x11),m),o.arc(A.cx,A.cy,E,ea(A.y11,A.x11),ea(A.y01,A.x01),!m))):o.arc(0,0,f,x,b,m)}if(o.closePath(),u)return o=null,u+""||null}return l.centroid=function(){var u=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-k$/2;return[Iv(c)*u,Tf(c)*u]},l.innerRadius=function(u){return arguments.length?(e=typeof u=="function"?u:In(+u),l):e},l.outerRadius=function(u){return arguments.length?(t=typeof u=="function"?u:In(+u),l):t},l.cornerRadius=function(u){return arguments.length?(n=typeof u=="function"?u:In(+u),l):n},l.padRadius=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:In(+u),l):r},l.startAngle=function(u){return arguments.length?(i=typeof u=="function"?u:In(+u),l):i},l.endAngle=function(u){return arguments.length?(s=typeof u=="function"?u:In(+u),l):s},l.padAngle=function(u){return arguments.length?(a=typeof u=="function"?u:In(+u),l):a},l.context=function(u){return arguments.length?(o=u==null?null:u,l):o},l}function gze(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function mze(e){this._context=e}mze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function voe(e){return new mze(e)}function vze(e){return e[0]}function yze(e){return e[1]}function bze(e,t){var n=In(!0),r=null,i=voe,s=null;e=typeof e=="function"?e:e===void 0?vze:In(e),t=typeof t=="function"?t:t===void 0?yze:In(t);function a(o){var l,u=(o=gze(o)).length,c,f=!1,h;for(r==null&&(s=i(h=px())),l=0;l<=u;++l)!(l<u&&n(c=o[l],l,o))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+e(c,l,o),+t(c,l,o));if(h)return s=null,h+""||null}return a.x=function(o){return arguments.length?(e=typeof o=="function"?o:In(+o),a):e},a.y=function(o){return arguments.length?(t=typeof o=="function"?o:In(+o),a):t},a.defined=function(o){return arguments.length?(n=typeof o=="function"?o:In(!!o),a):n},a.curve=function(o){return arguments.length?(i=o,r!=null&&(s=i(r)),a):i},a.context=function(o){return arguments.length?(o==null?r=s=null:s=i(r=o),a):r},a}function xze(e,t,n){var r=null,i=In(!0),s=null,a=voe,o=null;e=typeof e=="function"?e:e===void 0?vze:In(+e),t=typeof t=="function"?t:In(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?yze:In(+n);function l(c){var f,h,d,p=(c=gze(c)).length,g,m=!1,v,y=new Array(p),b=new Array(p);for(s==null&&(o=a(v=px())),f=0;f<=p;++f){if(!(f<p&&i(g=c[f],f,c))===m)if(m=!m)h=f,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),d=f-1;d>=h;--d)o.point(y[d],b[d]);o.lineEnd(),o.areaEnd()}m&&(y[f]=+e(g,f,c),b[f]=+t(g,f,c),o.point(r?+r(g,f,c):y[f],n?+n(g,f,c):b[f]))}if(v)return o=null,v+""||null}function u(){return bze().defined(i).curve(a).context(s)}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:In(+c),r=null,l):e},l.x0=function(c){return arguments.length?(e=typeof c=="function"?c:In(+c),l):e},l.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:In(+c),l):r},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:In(+c),n=null,l):t},l.y0=function(c){return arguments.length?(t=typeof c=="function"?c:In(+c),l):t},l.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:In(+c),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(c){return arguments.length?(i=typeof c=="function"?c:In(!!c),l):i},l.curve=function(c){return arguments.length?(a=c,s!=null&&(o=a(s)),l):a},l.context=function(c){return arguments.length?(c==null?s=o=null:o=a(s=c),l):s},l}const Gan={draw:function(e,t){var n=Math.sqrt(t/k$);e.moveTo(n,0),e.arc(0,0,n,0,pze)}};function Yan(e,t){var n=null;e=typeof e=="function"?e:In(e||Gan),t=typeof t=="function"?t:In(t===void 0?64:+t);function r(){var i;if(n||(n=i=px()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:In(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:In(+i),r):t},r.context=function(i){return arguments.length?(n=i==null?null:i,r):n},r}function fm(){}function YL(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function eU(e){this._context=e}eU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:YL(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:YL(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Xan(e){return new eU(e)}function wze(e){this._context=e}wze.prototype={areaStart:fm,areaEnd:fm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:YL(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Kan(e){return new wze(e)}function $ze(e){this._context=e}$ze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:YL(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Zan(e){return new $ze(e)}function Cze(e,t){this._basis=new eU(e),this._beta=t}Cze.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,a=t[n]-i,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*s),this._beta*t[o]+(1-this._beta)*(i+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const Qan=function e(t){function n(r){return t===1?new eU(r):new Cze(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function XL(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function yoe(e,t){this._context=e,this._k=(1-t)/6}yoe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:XL(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:XL(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Jan=function e(t){function n(r){return new yoe(r,t)}return n.tension=function(r){return e(+r)},n}(0);function boe(e,t){this._context=e,this._k=(1-t)/6}boe.prototype={areaStart:fm,areaEnd:fm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:XL(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const eon=function e(t){function n(r){return new boe(r,t)}return n.tension=function(r){return e(+r)},n}(0);function xoe(e,t){this._context=e,this._k=(1-t)/6}xoe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:XL(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const ton=function e(t){function n(r){return new xoe(r,t)}return n.tension=function(r){return e(+r)},n}(0);function woe(e,t,n){var r=e._x1,i=e._y1,s=e._x2,a=e._y2;if(e._l01_a>ia){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>ia){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,s,a,e._x2,e._y2)}function _ze(e,t){this._context=e,this._alpha=t}_ze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:woe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const non=function e(t){function n(r){return t?new _ze(r,t):new yoe(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Sze(e,t){this._context=e,this._alpha=t}Sze.prototype={areaStart:fm,areaEnd:fm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:woe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const ron=function e(t){function n(r){return t?new Sze(r,t):new boe(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function kze(e,t){this._context=e,this._alpha=t}kze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:woe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const ion=function e(t){function n(r){return t?new kze(r,t):new xoe(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Eze(e){this._context=e}Eze.prototype={areaStart:fm,areaEnd:fm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function son(e){return new Eze(e)}function Qbe(e){return e<0?-1:1}function Jbe(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),o=(s*i+a*r)/(r+i);return(Qbe(s)+Qbe(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function exe(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function uq(e,t,n){var r=e._x0,i=e._y0,s=e._x1,a=e._y1,o=(s-r)/3;e._context.bezierCurveTo(r+o,i+o*t,s-o,a-o*n,s,a)}function KL(e){this._context=e}KL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:uq(this,this._t0,exe(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,uq(this,exe(this,n=Jbe(this,e,t)),n);break;default:uq(this,this._t0,n=Jbe(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Aze(e){this._context=new Tze(e)}(Aze.prototype=Object.create(KL.prototype)).point=function(e,t){KL.prototype.point.call(this,t,e)};function Tze(e){this._context=e}Tze.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function aon(e){return new KL(e)}function oon(e){return new Aze(e)}function Dze(e){this._context=e}Dze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=txe(e),i=txe(t),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function txe(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),a=new Array(n);for(i[0]=0,s[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function lon(e){return new Dze(e)}function tU(e,t){this._context=e,this._t=t}tU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function uon(e){return new tU(e,.5)}function con(e){return new tU(e,0)}function fon(e){return new tU(e,1)}function kA(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function hon(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function $oe(e){let t,n,r;e.length!==2?(t=kA,n=(o,l)=>kA(e(o),l),r=(o,l)=>e(o)-l):(t=e===kA||e===hon?e:don,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function don(){return 0}function Nze(e){return e===null?NaN:+e}const pon=$oe(kA),zZ=pon.right;$oe(Nze).center;const SM=zZ,gon=Math.sqrt(50),mon=Math.sqrt(10),von=Math.sqrt(2);function ZL(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=gon?10:s>=mon?5:s>=von?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?ZL(e,t,n*2):[o,l,u]}function UZ(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,a]=r?ZL(t,e,n):ZL(e,t,n);if(!(s>=i))return[];const o=s-i+1,l=new Array(o);if(r)if(a<0)for(let u=0;u<o;++u)l[u]=(s-u)/-a;else for(let u=0;u<o;++u)l[u]=(s-u)*a;else if(a<0)for(let u=0;u<o;++u)l[u]=(i+u)/-a;else for(let u=0;u<o;++u)l[u]=(i+u)*a;return l}function WZ(e,t,n){return t=+t,e=+e,n=+n,ZL(e,t,n)[2]}function QL(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?WZ(t,e,n):WZ(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function yon(e,t,n=Nze){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function bon(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function xon(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function JL(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function E$(e){return e=JL(Math.abs(e)),e?e[1]:NaN}function won(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function $on(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Con=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ob(e){if(!(t=Con.exec(e)))throw new Error("invalid format: "+e);var t;return new Coe({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ob.prototype=Coe.prototype;function Coe(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Coe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function _on(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var Ize;function Son(e,t){var n=JL(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(Ize=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+JL(e,Math.max(0,t+s-1))[0]}function nxe(e,t){var n=JL(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const rxe={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:xon,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>nxe(e*100,t),r:nxe,s:Son,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function ixe(e){return e}var sxe=Array.prototype.map,axe=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function kon(e){var t=e.grouping===void 0||e.thousands===void 0?ixe:won(sxe.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?ixe:$on(sxe.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=ob(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):rxe[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var C=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=g==="$"?r:/[%p]/.test(w)?a:"",_=rxe[w],k=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(S){var N=C,A=$,D,T,I;if(w==="c")A=_(S)+A,S="";else{S=+S;var F=S<0||1/S<0;if(S=isNaN(S)?l:_(Math.abs(S),b),x&&(S=_on(S)),F&&+S==0&&p!=="+"&&(F=!1),N=(F?p==="("?p:o:p==="-"||p==="("?"":p)+N,A=(w==="s"?axe[8+Ize/3]:"")+A+(F&&p==="("?")":""),k){for(D=-1,T=S.length;++D<T;)if(I=S.charCodeAt(D),48>I||I>57){A=(I===46?i+S.slice(D+1):S.slice(D))+A,S=S.slice(0,D);break}}}y&&!m&&(S=t(S,1/0));var R=N.length+S.length+A.length,P=R<v?new Array(v-R+1).join(h):"";switch(y&&m&&(S=t(P+S,P.length?v-A.length:1/0),P=""),d){case"<":S=N+S+A+P;break;case"=":S=N+P+S+A;break;case"^":S=P.slice(0,R=P.length>>1)+N+S+A+P.slice(R);break;default:S=P+N+S+A;break}return s(S)}return E.toString=function(){return f+""},E}function c(f,h){var d=u((f=ob(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(E$(h)/3)))*3,g=Math.pow(10,-p),m=axe[8+p/3];return function(v){return d(g*v)+m}}return{format:u,formatPrefix:c}}var hR,nU,_oe;Eon({thousands:",",grouping:[3],currency:["$",""]});function Eon(e){return hR=kon(e),nU=hR.format,_oe=hR.formatPrefix,hR}function Mze(e){return Math.max(0,-E$(Math.abs(e)))}function Fze(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(E$(t)/3)))*3-E$(Math.abs(e)))}function Oze(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,E$(t)-E$(e))+1}const cq=new Date,fq=new Date;function Vi(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>Vi(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(cq.setTime(+s),fq.setTime(+a),e(cq),e(fq),Math.floor(n(cq,fq))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const A$=Vi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);A$.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Vi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):A$);A$.range;const ip=1e3,Su=ip*60,sp=Su*60,qp=sp*24,Soe=qp*7,oxe=qp*30,hq=qp*365,ap=Vi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ip)},(e,t)=>(t-e)/ip,e=>e.getUTCSeconds());ap.range;const rU=Vi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ip)},(e,t)=>{e.setTime(+e+t*Su)},(e,t)=>(t-e)/Su,e=>e.getMinutes());rU.range;const iU=Vi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Su)},(e,t)=>(t-e)/Su,e=>e.getUTCMinutes());iU.range;const sU=Vi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ip-e.getMinutes()*Su)},(e,t)=>{e.setTime(+e+t*sp)},(e,t)=>(t-e)/sp,e=>e.getHours());sU.range;const aU=Vi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*sp)},(e,t)=>(t-e)/sp,e=>e.getUTCHours());aU.range;const _0=Vi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Su)/qp,e=>e.getDate()-1);_0.range;const ly=Vi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/qp,e=>e.getUTCDate()-1);ly.range;const Rze=Vi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/qp,e=>Math.floor(e/qp));Rze.range;function gx(e){return Vi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Su)/Soe)}const kM=gx(0),e6=gx(1),Aon=gx(2),Ton=gx(3),T$=gx(4),Don=gx(5),Non=gx(6);kM.range;e6.range;Aon.range;Ton.range;T$.range;Don.range;Non.range;function mx(e){return Vi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/Soe)}const EM=mx(0),t6=mx(1),Ion=mx(2),Mon=mx(3),D$=mx(4),Fon=mx(5),Oon=mx(6);EM.range;t6.range;Ion.range;Mon.range;D$.range;Fon.range;Oon.range;const A3=Vi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());A3.range;const T3=Vi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());T3.range;const Vh=Vi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Vh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Vh.range;const jh=Vi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());jh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});jh.range;function Pze(e,t,n,r,i,s){const a=[[ap,1,ip],[ap,5,5*ip],[ap,15,15*ip],[ap,30,30*ip],[s,1,Su],[s,5,5*Su],[s,15,15*Su],[s,30,30*Su],[i,1,sp],[i,3,3*sp],[i,6,6*sp],[i,12,12*sp],[r,1,qp],[r,2,2*qp],[n,1,Soe],[t,1,oxe],[t,3,3*oxe],[e,1,hq]];function o(u,c,f){const h=c<u;h&&([u,c]=[c,u]);const d=f&&typeof f.range=="function"?f:l(u,c,f),p=d?d.range(u,+c+1):[];return h?p.reverse():p}function l(u,c,f){const h=Math.abs(c-u)/f,d=$oe(([,,m])=>m).right(a,h);if(d===a.length)return e.every(QL(u/hq,c/hq,f));if(d===0)return A$.every(Math.max(QL(u,c,f),1));const[p,g]=a[h/a[d-1][2]<a[d][2]/h?d-1:d];return p.every(g)}return[o,l]}const[Ron,Pon]=Pze(jh,T3,EM,Rze,aU,iU),[Lon,Bon]=Pze(Vh,A3,kM,_0,sU,rU),D3="year",N3="quarter",I3="month",M3="week",F3="date",oU="day",koe="dayofyear",O3="hours",R3="minutes",P3="seconds",lU="milliseconds",zon=[D3,N3,I3,M3,F3,oU,koe,O3,R3,P3,lU];zon.reduce((e,t,n)=>(e[t]=1+n,e),{});const Uon={[D3]:Vh,[N3]:A3.every(3),[I3]:A3,[M3]:kM,[F3]:_0,[oU]:_0,[koe]:_0,[O3]:sU,[R3]:rU,[P3]:ap,[lU]:A$},Won={[D3]:jh,[N3]:T3.every(3),[I3]:T3,[M3]:EM,[F3]:ly,[oU]:ly,[koe]:ly,[O3]:aU,[R3]:iU,[P3]:ap,[lU]:A$};function Von(e){return Uon[e]}function jon(e){return Won[e]}function dq(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function pq(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ek(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Hon(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=Ak(i),c=Tk(i),f=Ak(s),h=Tk(s),d=Ak(a),p=Tk(a),g=Ak(o),m=Tk(o),v=Ak(l),y=Tk(l),b={a:F,A:R,b:P,B:V,c:null,d:dxe,e:dxe,f:pln,g:_ln,G:kln,H:fln,I:hln,j:dln,L:Lze,m:gln,M:mln,p:z,q,Q:mxe,s:vxe,S:vln,u:yln,U:bln,V:xln,w:wln,W:$ln,x:null,X:null,y:Cln,Y:Sln,Z:Eln,"%":gxe},x={a:G,A:K,b:Y,B:te,c:null,d:pxe,e:pxe,f:Nln,g:Uln,G:Vln,H:Aln,I:Tln,j:Dln,L:zze,m:Iln,M:Mln,p:Z,q:ae,Q:mxe,s:vxe,S:Fln,u:Oln,U:Rln,V:Pln,w:Lln,W:Bln,x:null,X:null,y:zln,Y:Wln,Z:jln,"%":gxe},w={a:E,A:S,b:N,B:A,c:D,d:fxe,e:fxe,f:oln,g:cxe,G:uxe,H:hxe,I:hxe,j:rln,L:aln,m:nln,M:iln,p:k,q:tln,Q:uln,s:cln,S:sln,u:Kon,U:Zon,V:Qon,w:Xon,W:Jon,x:T,X:I,y:cxe,Y:uxe,Z:eln,"%":lln};b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x);function C(O,L){return function(W){var M=[],ue=-1,X=0,se=O.length,oe,pe,Ce;for(W instanceof Date||(W=new Date(+W));++ue<se;)O.charCodeAt(ue)===37&&(M.push(O.slice(X,ue)),(pe=lxe[oe=O.charAt(++ue)])!=null?oe=O.charAt(++ue):pe=oe==="e"?" ":"0",(Ce=L[oe])&&(oe=Ce(W,pe)),M.push(oe),X=ue+1);return M.push(O.slice(X,ue)),M.join("")}}function $(O,L){return function(W){var M=Ek(1900,void 0,1),ue=_(M,O,W+="",0),X,se;if(ue!=W.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(L&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(X=pq(Ek(M.y,0,1)),se=X.getUTCDay(),X=se>4||se===0?t6.ceil(X):t6(X),X=ly.offset(X,(M.V-1)*7),M.y=X.getUTCFullYear(),M.m=X.getUTCMonth(),M.d=X.getUTCDate()+(M.w+6)%7):(X=dq(Ek(M.y,0,1)),se=X.getDay(),X=se>4||se===0?e6.ceil(X):e6(X),X=_0.offset(X,(M.V-1)*7),M.y=X.getFullYear(),M.m=X.getMonth(),M.d=X.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),se="Z"in M?pq(Ek(M.y,0,1)).getUTCDay():dq(Ek(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(se+5)%7:M.w+M.U*7-(se+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,pq(M)):dq(M)}}function _(O,L,W,M){for(var ue=0,X=L.length,se=W.length,oe,pe;ue<X;){if(M>=se)return-1;if(oe=L.charCodeAt(ue++),oe===37){if(oe=L.charAt(ue++),pe=w[oe in lxe?L.charAt(ue++):oe],!pe||(M=pe(O,W,M))<0)return-1}else if(oe!=W.charCodeAt(M++))return-1}return M}function k(O,L,W){var M=u.exec(L.slice(W));return M?(O.p=c.get(M[0].toLowerCase()),W+M[0].length):-1}function E(O,L,W){var M=d.exec(L.slice(W));return M?(O.w=p.get(M[0].toLowerCase()),W+M[0].length):-1}function S(O,L,W){var M=f.exec(L.slice(W));return M?(O.w=h.get(M[0].toLowerCase()),W+M[0].length):-1}function N(O,L,W){var M=v.exec(L.slice(W));return M?(O.m=y.get(M[0].toLowerCase()),W+M[0].length):-1}function A(O,L,W){var M=g.exec(L.slice(W));return M?(O.m=m.get(M[0].toLowerCase()),W+M[0].length):-1}function D(O,L,W){return _(O,t,L,W)}function T(O,L,W){return _(O,n,L,W)}function I(O,L,W){return _(O,r,L,W)}function F(O){return a[O.getDay()]}function R(O){return s[O.getDay()]}function P(O){return l[O.getMonth()]}function V(O){return o[O.getMonth()]}function z(O){return i[+(O.getHours()>=12)]}function q(O){return 1+~~(O.getMonth()/3)}function G(O){return a[O.getUTCDay()]}function K(O){return s[O.getUTCDay()]}function Y(O){return l[O.getUTCMonth()]}function te(O){return o[O.getUTCMonth()]}function Z(O){return i[+(O.getUTCHours()>=12)]}function ae(O){return 1+~~(O.getUTCMonth()/3)}return{format:function(O){var L=C(O+="",b);return L.toString=function(){return O},L},parse:function(O){var L=$(O+="",!1);return L.toString=function(){return O},L},utcFormat:function(O){var L=C(O+="",x);return L.toString=function(){return O},L},utcParse:function(O){var L=$(O+="",!0);return L.toString=function(){return O},L}}}var lxe={"-":"",_:" ",0:"0"},Cs=/^\s*\d+/,qon=/^%/,Gon=/[\\^$*+?|[\]().{}]/g;function Sn(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function Yon(e){return e.replace(Gon,"\\$&")}function Ak(e){return new RegExp("^(?:"+e.map(Yon).join("|")+")","i")}function Tk(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Xon(e,t,n){var r=Cs.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Kon(e,t,n){var r=Cs.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Zon(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Qon(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Jon(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function uxe(e,t,n){var r=Cs.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function cxe(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function eln(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function tln(e,t,n){var r=Cs.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function nln(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function fxe(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function rln(e,t,n){var r=Cs.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function hxe(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function iln(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function sln(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function aln(e,t,n){var r=Cs.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function oln(e,t,n){var r=Cs.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function lln(e,t,n){var r=qon.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function uln(e,t,n){var r=Cs.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function cln(e,t,n){var r=Cs.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function dxe(e,t){return Sn(e.getDate(),t,2)}function fln(e,t){return Sn(e.getHours(),t,2)}function hln(e,t){return Sn(e.getHours()%12||12,t,2)}function dln(e,t){return Sn(1+_0.count(Vh(e),e),t,3)}function Lze(e,t){return Sn(e.getMilliseconds(),t,3)}function pln(e,t){return Lze(e,t)+"000"}function gln(e,t){return Sn(e.getMonth()+1,t,2)}function mln(e,t){return Sn(e.getMinutes(),t,2)}function vln(e,t){return Sn(e.getSeconds(),t,2)}function yln(e){var t=e.getDay();return t===0?7:t}function bln(e,t){return Sn(kM.count(Vh(e)-1,e),t,2)}function Bze(e){var t=e.getDay();return t>=4||t===0?T$(e):T$.ceil(e)}function xln(e,t){return e=Bze(e),Sn(T$.count(Vh(e),e)+(Vh(e).getDay()===4),t,2)}function wln(e){return e.getDay()}function $ln(e,t){return Sn(e6.count(Vh(e)-1,e),t,2)}function Cln(e,t){return Sn(e.getFullYear()%100,t,2)}function _ln(e,t){return e=Bze(e),Sn(e.getFullYear()%100,t,2)}function Sln(e,t){return Sn(e.getFullYear()%1e4,t,4)}function kln(e,t){var n=e.getDay();return e=n>=4||n===0?T$(e):T$.ceil(e),Sn(e.getFullYear()%1e4,t,4)}function Eln(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Sn(t/60|0,"0",2)+Sn(t%60,"0",2)}function pxe(e,t){return Sn(e.getUTCDate(),t,2)}function Aln(e,t){return Sn(e.getUTCHours(),t,2)}function Tln(e,t){return Sn(e.getUTCHours()%12||12,t,2)}function Dln(e,t){return Sn(1+ly.count(jh(e),e),t,3)}function zze(e,t){return Sn(e.getUTCMilliseconds(),t,3)}function Nln(e,t){return zze(e,t)+"000"}function Iln(e,t){return Sn(e.getUTCMonth()+1,t,2)}function Mln(e,t){return Sn(e.getUTCMinutes(),t,2)}function Fln(e,t){return Sn(e.getUTCSeconds(),t,2)}function Oln(e){var t=e.getUTCDay();return t===0?7:t}function Rln(e,t){return Sn(EM.count(jh(e)-1,e),t,2)}function Uze(e){var t=e.getUTCDay();return t>=4||t===0?D$(e):D$.ceil(e)}function Pln(e,t){return e=Uze(e),Sn(D$.count(jh(e),e)+(jh(e).getUTCDay()===4),t,2)}function Lln(e){return e.getUTCDay()}function Bln(e,t){return Sn(t6.count(jh(e)-1,e),t,2)}function zln(e,t){return Sn(e.getUTCFullYear()%100,t,2)}function Uln(e,t){return e=Uze(e),Sn(e.getUTCFullYear()%100,t,2)}function Wln(e,t){return Sn(e.getUTCFullYear()%1e4,t,4)}function Vln(e,t){var n=e.getUTCDay();return e=n>=4||n===0?D$(e):D$.ceil(e),Sn(e.getUTCFullYear()%1e4,t,4)}function jln(){return"+0000"}function gxe(){return"%"}function mxe(e){return+e}function vxe(e){return Math.floor(+e/1e3)}var d2,Eoe,Wze,Aoe,Vze;Hln({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Hln(e){return d2=Hon(e),Eoe=d2.format,Wze=d2.parse,Aoe=d2.utcFormat,Vze=d2.utcParse,d2}function HE(e){const t={};return n=>t[n]||(t[n]=e(n))}function qln(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=Gln(r,i);const a=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+a}}function Gln(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function Yln(e){const t=HE(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=ob(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return qln(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,a){a=ob(a==null?",f":a);const o=QL(r,i,s),l=Math.max(Math.abs(r),Math.abs(i));let u;if(a.precision==null)switch(a.type){case"s":return isNaN(u=Fze(o,l))||(a.precision=u),n(a,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=Oze(o,l))||(a.precision=u-(a.type==="e"));break}case"f":case"%":{isNaN(u=Mze(o))||(a.precision=u-(a.type==="%")*2);break}}return t(a)}}}Xln();function Xln(){return Yln({format:nU,formatPrefix:_oe})}function yxe(e,t,n){n=n||{},HL(n)||ph(`Invalid time multi-format specifier: ${n}`);const r=t(P3),i=t(R3),s=t(O3),a=t(F3),o=t(M3),l=t(I3),u=t(N3),c=t(D3),f=e(n[lU]||".%L"),h=e(n[P3]||":%S"),d=e(n[R3]||"%I:%M"),p=e(n[O3]||"%I %p"),g=e(n[F3]||n[oU]||"%a %d"),m=e(n[M3]||"%b %d"),v=e(n[I3]||"%B"),y=e(n[N3]||"%B"),b=e(n[D3]||"%Y");return x=>(r(x)<x?f:i(x)<x?h:s(x)<x?d:a(x)<x?p:l(x)<x?o(x)<x?g:m:c(x)<x?u(x)<x?v:y:b)(x)}function Kln(e){const t=HE(e.format),n=HE(e.utcFormat);return{timeFormat:r=>qL(r)?t(r):yxe(t,Von,r),utcFormat:r=>qL(r)?n(r):yxe(n,jon,r),timeParse:HE(e.parse),utcParse:HE(e.utcParse)}}Zln();function Zln(){return Kln({format:Eoe,parse:Wze,utcFormat:Aoe,utcParse:Vze})}const Qln=/^(data:|([A-Za-z]+:)?\/\/)/,Jln=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,eun=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,bxe="file://";function tun(e,t){return n=>({options:n||{},sanitize:run,load:nun,fileAccess:!!t,file:iun(t),http:aun(e)})}async function nun(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function run(e,t){t=J9({},this.options,t);const n=this.fileAccess,r={href:null};let i,s,a;const o=Jln.test(e.replace(eun,""));(e==null||typeof e!="string"||!o)&&ph("Sanitize failure, invalid URI: "+hze(e));const l=Qln.test(e);return(a=t.baseURL)&&!l&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),s=(i=e.startsWith(bxe))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice(bxe.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!s}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function iun(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,s)=>{i?r(i):n(s)})}):sun}async function sun(){ph("No file system access.")}function aun(e){return e?async function(t,n){const r=J9({},this.options.http,n),i=n&&n.response,s=await e(t,r);return s.ok?Q9(s[i])?s[i]():s.text():ph(s.status+""+s.statusText)}:oun}async function oun(){ph("No HTTP fetch method available.")}const jze=tun(typeof fetch<"u"&&fetch,null);function cd(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function rv(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const xxe=Symbol("implicit");function Toe(){var e=new Gw,t=[],n=[],r=xxe;function i(s){let a=e.get(s);if(a===void 0){if(r!==xxe)return r;e.set(s,a=t.push(s)-1)}return n[a%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new Gw;for(const a of s)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return Toe(t,n).unknown(r)},cd.apply(i,arguments),i}function iS(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function AM(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function iv(){}var lb=.7,N$=1/lb,lw="\\s*([+-]?\\d+)\\s*",L3="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",lun=/^#([0-9a-f]{3,8})$/,uun=new RegExp(`^rgb\\(${lw},${lw},${lw}\\)$`),cun=new RegExp(`^rgb\\(${gh},${gh},${gh}\\)$`),fun=new RegExp(`^rgba\\(${lw},${lw},${lw},${L3}\\)$`),hun=new RegExp(`^rgba\\(${gh},${gh},${gh},${L3}\\)$`),dun=new RegExp(`^hsl\\(${L3},${gh},${gh}\\)$`),pun=new RegExp(`^hsla\\(${L3},${gh},${gh},${L3}\\)$`),wxe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};iS(iv,B3,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:$xe,formatHex:$xe,formatHex8:gun,formatHsl:mun,formatRgb:Cxe,toString:Cxe});function $xe(){return this.rgb().formatHex()}function gun(){return this.rgb().formatHex8()}function mun(){return Hze(this).formatHsl()}function Cxe(){return this.rgb().formatRgb()}function B3(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=lun.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?_xe(t):n===3?new is(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?dR(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?dR(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=uun.exec(e))?new is(t[1],t[2],t[3],1):(t=cun.exec(e))?new is(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=fun.exec(e))?dR(t[1],t[2],t[3],t[4]):(t=hun.exec(e))?dR(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=dun.exec(e))?Exe(t[1],t[2]/100,t[3]/100,1):(t=pun.exec(e))?Exe(t[1],t[2]/100,t[3]/100,t[4]):wxe.hasOwnProperty(e)?_xe(wxe[e]):e==="transparent"?new is(NaN,NaN,NaN,0):null}function _xe(e){return new is(e>>16&255,e>>8&255,e&255,1)}function dR(e,t,n,r){return r<=0&&(e=t=n=NaN),new is(e,t,n,r)}function Doe(e){return e instanceof iv||(e=B3(e)),e?(e=e.rgb(),new is(e.r,e.g,e.b,e.opacity)):new is}function n6(e,t,n,r){return arguments.length===1?Doe(e):new is(e,t,n,r==null?1:r)}function is(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}iS(is,n6,AM(iv,{brighter(e){return e=e==null?N$:Math.pow(N$,e),new is(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?lb:Math.pow(lb,e),new is(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new is(uy(this.r),uy(this.g),uy(this.b),r6(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Sxe,formatHex:Sxe,formatHex8:vun,formatRgb:kxe,toString:kxe}));function Sxe(){return`#${L1(this.r)}${L1(this.g)}${L1(this.b)}`}function vun(){return`#${L1(this.r)}${L1(this.g)}${L1(this.b)}${L1((isNaN(this.opacity)?1:this.opacity)*255)}`}function kxe(){const e=r6(this.opacity);return`${e===1?"rgb(":"rgba("}${uy(this.r)}, ${uy(this.g)}, ${uy(this.b)}${e===1?")":`, ${e})`}`}function r6(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function uy(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function L1(e){return e=uy(e),(e<16?"0":"")+e.toString(16)}function Exe(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Tc(e,t,n,r)}function Hze(e){if(e instanceof Tc)return new Tc(e.h,e.s,e.l,e.opacity);if(e instanceof iv||(e=B3(e)),!e)return new Tc;if(e instanceof Tc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new Tc(a,o,l,e.opacity)}function VZ(e,t,n,r){return arguments.length===1?Hze(e):new Tc(e,t,n,r==null?1:r)}function Tc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}iS(Tc,VZ,AM(iv,{brighter(e){return e=e==null?N$:Math.pow(N$,e),new Tc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?lb:Math.pow(lb,e),new Tc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new is(gq(e>=240?e-240:e+120,i,r),gq(e,i,r),gq(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Tc(Axe(this.h),pR(this.s),pR(this.l),r6(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=r6(this.opacity);return`${e===1?"hsl(":"hsla("}${Axe(this.h)}, ${pR(this.s)*100}%, ${pR(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Axe(e){return e=(e||0)%360,e<0?e+360:e}function pR(e){return Math.max(0,Math.min(1,e||0))}function gq(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const qze=Math.PI/180,Gze=180/Math.PI,i6=18,Yze=.96422,Xze=1,Kze=.82521,Zze=4/29,uw=6/29,Qze=3*uw*uw,yun=uw*uw*uw;function Jze(e){if(e instanceof mh)return new mh(e.l,e.a,e.b,e.opacity);if(e instanceof op)return e7e(e);e instanceof is||(e=Doe(e));var t=bq(e.r),n=bq(e.g),r=bq(e.b),i=mq((.2225045*t+.7168786*n+.0606169*r)/Xze),s,a;return t===n&&n===r?s=a=i:(s=mq((.4360747*t+.3850649*n+.1430804*r)/Yze),a=mq((.0139322*t+.0971045*n+.7141733*r)/Kze)),new mh(116*i-16,500*(s-i),200*(i-a),e.opacity)}function jZ(e,t,n,r){return arguments.length===1?Jze(e):new mh(e,t,n,r==null?1:r)}function mh(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}iS(mh,jZ,AM(iv,{brighter(e){return new mh(this.l+i6*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new mh(this.l-i6*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Yze*vq(t),e=Xze*vq(e),n=Kze*vq(n),new is(yq(3.1338561*t-1.6168667*e-.4906146*n),yq(-.9787684*t+1.9161415*e+.033454*n),yq(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function mq(e){return e>yun?Math.pow(e,1/3):e/Qze+Zze}function vq(e){return e>uw?e*e*e:Qze*(e-Zze)}function yq(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function bq(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function bun(e){if(e instanceof op)return new op(e.h,e.c,e.l,e.opacity);if(e instanceof mh||(e=Jze(e)),e.a===0&&e.b===0)return new op(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Gze;return new op(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function HZ(e,t,n,r){return arguments.length===1?bun(e):new op(e,t,n,r==null?1:r)}function op(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function e7e(e){if(isNaN(e.h))return new mh(e.l,0,0,e.opacity);var t=e.h*qze;return new mh(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}iS(op,HZ,AM(iv,{brighter(e){return new op(this.h,this.c,this.l+i6*(e==null?1:e),this.opacity)},darker(e){return new op(this.h,this.c,this.l-i6*(e==null?1:e),this.opacity)},rgb(){return e7e(this).rgb()}}));var t7e=-.14861,Noe=1.78277,Ioe=-.29227,uU=-.90649,z3=1.97294,Txe=z3*uU,Dxe=z3*Noe,Nxe=Noe*Ioe-uU*t7e;function xun(e){if(e instanceof cy)return new cy(e.h,e.s,e.l,e.opacity);e instanceof is||(e=Doe(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Nxe*r+Txe*t-Dxe*n)/(Nxe+Txe-Dxe),s=r-i,a=(z3*(n-i)-Ioe*s)/uU,o=Math.sqrt(a*a+s*s)/(z3*i*(1-i)),l=o?Math.atan2(a,s)*Gze-120:NaN;return new cy(l<0?l+360:l,o,i,e.opacity)}function qZ(e,t,n,r){return arguments.length===1?xun(e):new cy(e,t,n,r==null?1:r)}function cy(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}iS(cy,qZ,AM(iv,{brighter(e){return e=e==null?N$:Math.pow(N$,e),new cy(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?lb:Math.pow(lb,e),new cy(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*qze,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new is(255*(t+n*(t7e*r+Noe*i)),255*(t+n*(Ioe*r+uU*i)),255*(t+n*(z3*r)),this.opacity)}}));function n7e(e,t,n,r,i){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*n+(1+3*e+3*s-3*a)*r+a*i)/6}function r7e(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],a=r>0?e[r-1]:2*i-s,o=r<t-1?e[r+2]:2*s-i;return n7e((n-r/t)*t,a,i,s,o)}}function i7e(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],a=e[(r+1)%t],o=e[(r+2)%t];return n7e((n-r/t)*t,i,s,a,o)}}const cU=e=>()=>e;function s7e(e,t){return function(n){return e+n*t}}function wun(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function fU(e,t){var n=t-e;return n?s7e(e,n>180||n<-180?n-360*Math.round(n/360):n):cU(isNaN(e)?t:e)}function $un(e){return(e=+e)==1?ss:function(t,n){return n-t?wun(t,n,e):cU(isNaN(t)?n:t)}}function ss(e,t){var n=t-e;return n?s7e(e,n):cU(isNaN(e)?t:e)}const GZ=function e(t){var n=$un(t);function r(i,s){var a=n((i=n6(i)).r,(s=n6(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=ss(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function a7e(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),a,o;for(a=0;a<n;++a)o=n6(t[a]),r[a]=o.r||0,i[a]=o.g||0,s[a]=o.b||0;return r=e(r),i=e(i),s=e(s),o.opacity=1,function(l){return o.r=r(l),o.g=i(l),o.b=s(l),o+""}}}var Cun=a7e(r7e),_un=a7e(i7e);function Moe(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function o7e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Sun(e,t){return(o7e(t)?Moe:l7e)(e,t)}function l7e(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=vx(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function u7e(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function $c(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function c7e(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=vx(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var YZ=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xq=new RegExp(YZ.source,"g");function kun(e){return function(){return e}}function Eun(e){return function(t){return e(t)+""}}function f7e(e,t){var n=YZ.lastIndex=xq.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=YZ.exec(e))&&(i=xq.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:$c(r,i)})),n=xq.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?Eun(l[0].x):kun(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)o[(f=l[c]).i]=f.x(u);return o.join("")})}function vx(e,t){var n=typeof t,r;return t==null||n==="boolean"?cU(t):(n==="number"?$c:n==="string"?(r=B3(t))?(t=r,GZ):f7e:t instanceof B3?GZ:t instanceof Date?u7e:o7e(t)?Moe:Array.isArray(t)?l7e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?c7e:$c)(e,t)}function Aun(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Tun(e,t){var n=fU(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function hU(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Ixe=180/Math.PI,XZ={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function h7e(e,t,n,r,i,s){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*Ixe,skewX:Math.atan(l)*Ixe,scaleX:a,scaleY:o}}var gR;function Dun(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?XZ:h7e(t.a,t.b,t.c,t.d,t.e,t.f)}function Nun(e){return e==null||(gR||(gR=document.createElementNS("http://www.w3.org/2000/svg","g")),gR.setAttribute("transform",e),!(e=gR.transform.baseVal.consolidate()))?XZ:(e=e.matrix,h7e(e.a,e.b,e.c,e.d,e.e,e.f))}function d7e(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push("translate(",null,t,null,n);p.push({i:g-4,x:$c(u,f)},{i:g-2,x:$c(c,h)})}else(f||h)&&d.push("translate("+f+t+h+n)}function a(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:$c(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function o(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:$c(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push(i(d)+"scale(",null,",",null,")");p.push({i:g-4,x:$c(u,f)},{i:g-2,x:$c(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=e(u),c=e(c),s(u.translateX,u.translateY,c.translateX,c.translateY,f,h),a(u.rotate,c.rotate,f,h),o(u.skewX,c.skewX,f,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,g=h.length,m;++p<g;)f[(m=h[p]).i]=m.x(d);return f.join("")}}}var Iun=d7e(Dun,"px, ","px)","deg)"),Mun=d7e(Nun,", ",")",")"),Fun=1e-12;function Mxe(e){return((e=Math.exp(e))+1/e)/2}function Oun(e){return((e=Math.exp(e))-1/e)/2}function Run(e){return((e=Math.exp(2*e))-1)/(e+1)}const Pun=function e(t,n,r){function i(s,a){var o=s[0],l=s[1],u=s[2],c=a[0],f=a[1],h=a[2],d=c-o,p=f-l,g=d*d+p*p,m,v;if(g<Fun)v=Math.log(h/u)/t,m=function($){return[o+$*d,l+$*p,u*Math.exp(t*$*v)]};else{var y=Math.sqrt(g),b=(h*h-u*u+r*g)/(2*u*n*y),x=(h*h-u*u-r*g)/(2*h*n*y),w=Math.log(Math.sqrt(b*b+1)-b),C=Math.log(Math.sqrt(x*x+1)-x);v=(C-w)/t,m=function($){var _=$*v,k=Mxe(w),E=u/(n*y)*(k*Run(t*_+w)-Oun(w));return[o+E*d,l+E*p,u*k/Mxe(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(s){var a=Math.max(.001,+s),o=a*a,l=o*o;return e(a,o,l)},i}(Math.SQRT2,2,4);function p7e(e){return function(t,n){var r=e((t=VZ(t)).h,(n=VZ(n)).h),i=ss(t.s,n.s),s=ss(t.l,n.l),a=ss(t.opacity,n.opacity);return function(o){return t.h=r(o),t.s=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const Lun=p7e(fU);var Bun=p7e(ss);function zun(e,t){var n=ss((e=jZ(e)).l,(t=jZ(t)).l),r=ss(e.a,t.a),i=ss(e.b,t.b),s=ss(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=s(a),e+""}}function g7e(e){return function(t,n){var r=e((t=HZ(t)).h,(n=HZ(n)).h),i=ss(t.c,n.c),s=ss(t.l,n.l),a=ss(t.opacity,n.opacity);return function(o){return t.h=r(o),t.c=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const Uun=g7e(fU);var Wun=g7e(ss);function m7e(e){return function t(n){n=+n;function r(i,s){var a=e((i=qZ(i)).h,(s=qZ(s)).h),o=ss(i.s,s.s),l=ss(i.l,s.l),u=ss(i.opacity,s.opacity);return function(c){return i.h=a(c),i.s=o(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}const Vun=m7e(fU);var jun=m7e(ss);function Foe(e,t){t===void 0&&(t=e,e=vx);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function Hun(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const qun=Object.freeze(Object.defineProperty({__proto__:null,interpolate:vx,interpolateArray:Sun,interpolateBasis:r7e,interpolateBasisClosed:i7e,interpolateDate:u7e,interpolateDiscrete:Aun,interpolateHue:Tun,interpolateNumber:$c,interpolateNumberArray:Moe,interpolateObject:c7e,interpolateRound:hU,interpolateString:f7e,interpolateTransformCss:Iun,interpolateTransformSvg:Mun,interpolateZoom:Pun,interpolateRgb:GZ,interpolateRgbBasis:Cun,interpolateRgbBasisClosed:_un,interpolateHsl:Lun,interpolateHslLong:Bun,interpolateLab:zun,interpolateHcl:Uun,interpolateHclLong:Wun,interpolateCubehelix:Vun,interpolateCubehelixLong:jun,piecewise:Foe,quantize:Hun},Symbol.toStringTag,{value:"Module"}));function Gun(e){return function(){return e}}function KZ(e){return+e}var Fxe=[0,1];function Ko(e){return e}function ZZ(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Gun(isNaN(t)?NaN:.5)}function Yun(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Xun(e,t,n){var r=e[0],i=e[1],s=t[0],a=t[1];return i<r?(r=ZZ(i,r),s=n(a,s)):(r=ZZ(r,i),s=n(s,a)),function(o){return s(r(o))}}function Kun(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=ZZ(e[a],e[a+1]),s[a]=n(t[a],t[a+1]);return function(o){var l=SM(e,o,1,r)-1;return s[l](i[l](o))}}function TM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function dU(){var e=Fxe,t=Fxe,n=vx,r,i,s,a=Ko,o,l,u;function c(){var h=Math.min(e.length,t.length);return a!==Ko&&(a=Yun(e[0],e[h-1])),o=h>2?Kun:Xun,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?s:(l||(l=o(e.map(r),t,n)))(r(a(h)))}return f.invert=function(h){return a(i((u||(u=o(t,e.map(r),$c)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,KZ),c()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),n=hU,c()},f.clamp=function(h){return arguments.length?(a=h?!0:Ko,c()):a!==Ko},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,d){return r=h,i=d,c()}}function v7e(){return dU()(Ko,Ko)}function y7e(e,t,n,r){var i=QL(e,t,n),s;switch(r=ob(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=Fze(i,a))&&(r.precision=s),_oe(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=Oze(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=Mze(i))&&(r.precision=s-(r.type==="%")*2);break}}return nU(r)}function yx(e){var t=e.domain;return e.ticks=function(n){var r=t();return UZ(r[0],r[r.length-1],n==null?10:n)},e.tickFormat=function(n,r){var i=t();return y7e(i[0],i[i.length-1],n==null?10:n,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,a=r[i],o=r[s],l,u,c=10;for(o<a&&(u=a,a=o,o=u,u=i,i=s,s=u);c-- >0;){if(u=WZ(a,o,n),u===l)return r[i]=a,r[s]=o,t(r);if(u>0)a=Math.floor(a/u)*u,o=Math.ceil(o/u)*u;else if(u<0)a=Math.ceil(a*u)/u,o=Math.floor(o*u)/u;else break;l=u}return e},e}function b7e(){var e=v7e();return e.copy=function(){return TM(e,b7e())},cd.apply(e,arguments),yx(e)}function x7e(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,KZ),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return x7e(e).unknown(t)},e=arguments.length?Array.from(e,KZ):[0,1],yx(n)}function w7e(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),e[n]=t.floor(i),e[r]=t.ceil(s),e}function Oxe(e){return Math.log(e)}function Rxe(e){return Math.exp(e)}function Zun(e){return-Math.log(-e)}function Qun(e){return-Math.exp(-e)}function Jun(e){return isFinite(e)?+("1e"+e):e<0?0:e}function ecn(e){return e===10?Jun:e===Math.E?Math.exp:t=>Math.pow(e,t)}function tcn(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Pxe(e){return(t,n)=>-e(-t,n)}function Ooe(e){const t=e(Oxe,Rxe),n=t.domain;let r=10,i,s;function a(){return i=tcn(r),s=ecn(r),n()[0]<0?(i=Pxe(i),s=Pxe(s),e(Zun,Qun)):e(Oxe,Rxe),t}return t.base=function(o){return arguments.length?(r=+o,a()):r},t.domain=function(o){return arguments.length?(n(o),a()):n()},t.ticks=o=>{const l=n();let u=l[0],c=l[l.length-1];const f=c<u;f&&([u,c]=[c,u]);let h=i(u),d=i(c),p,g;const m=o==null?10:+o;let v=[];if(!(r%1)&&d-h<m){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(p=1;p<r;++p)if(g=h<0?p/s(-h):p*s(h),!(g<u)){if(g>c)break;v.push(g)}}else for(;h<=d;++h)for(p=r-1;p>=1;--p)if(g=h>0?p/s(-h):p*s(h),!(g<u)){if(g>c)break;v.push(g)}v.length*2<m&&(v=UZ(u,c,m))}else v=UZ(h,d,Math.min(d-h,m)).map(s);return f?v.reverse():v},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=ob(l)).precision==null&&(l.trim=!0),l=nU(l)),o===1/0)return l;const u=Math.max(1,r*o/t.ticks().length);return c=>{let f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=()=>n(w7e(n(),{floor:o=>s(Math.floor(i(o))),ceil:o=>s(Math.ceil(i(o)))})),t}function $7e(){const e=Ooe(dU()).domain([1,10]);return e.copy=()=>TM(e,$7e()).base(e.base()),cd.apply(e,arguments),e}function Lxe(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Bxe(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Roe(e){var t=1,n=e(Lxe(t),Bxe(t));return n.constant=function(r){return arguments.length?e(Lxe(t=+r),Bxe(t)):t},yx(n)}function C7e(){var e=Roe(dU());return e.copy=function(){return TM(e,C7e()).constant(e.constant())},cd.apply(e,arguments)}function zxe(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function ncn(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function rcn(e){return e<0?-e*e:e*e}function Poe(e){var t=e(Ko,Ko),n=1;function r(){return n===1?e(Ko,Ko):n===.5?e(ncn,rcn):e(zxe(n),zxe(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},yx(t)}function Loe(){var e=Poe(dU());return e.copy=function(){return TM(e,Loe()).exponent(e.exponent())},cd.apply(e,arguments),e}function icn(){return Loe.apply(null,arguments).exponent(.5)}function _7e(){var e=[],t=[],n=[],r;function i(){var a=0,o=Math.max(1,t.length);for(n=new Array(o-1);++a<o;)n[a-1]=yon(e,a/o);return s}function s(a){return a==null||isNaN(a=+a)?r:t[SM(n,a)]}return s.invertExtent=function(a){var o=t.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},s.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let o of a)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(kA),i()},s.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return _7e().domain(e).range(t).unknown(r)},cd.apply(s,arguments)}function S7e(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function a(l){return l!=null&&l<=l?i[SM(r,l,0,n)]:s}function o(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return a}return a.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},a.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,o()):i.slice()},a.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},a.unknown=function(l){return arguments.length&&(s=l),a},a.thresholds=function(){return r.slice()},a.copy=function(){return S7e().domain([e,t]).range(i).unknown(s)},cd.apply(yx(a),arguments)}function k7e(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[SM(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var a=t.indexOf(s);return[e[a-1],e[a]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return k7e().domain(e).range(t).unknown(n)},cd.apply(i,arguments)}function scn(e){return new Date(e)}function acn(e){return e instanceof Date?+e:+new Date(+e)}function Boe(e,t,n,r,i,s,a,o,l,u){var c=v7e(),f=c.invert,h=c.domain,d=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),x=u("%Y");function w(C){return(l(C)<C?d:o(C)<C?p:a(C)<C?g:s(C)<C?m:r(C)<C?i(C)<C?v:y:n(C)<C?b:x)(C)}return c.invert=function(C){return new Date(f(C))},c.domain=function(C){return arguments.length?h(Array.from(C,acn)):h().map(scn)},c.ticks=function(C){var $=h();return e($[0],$[$.length-1],C==null?10:C)},c.tickFormat=function(C,$){return $==null?w:u($)},c.nice=function(C){var $=h();return(!C||typeof C.range!="function")&&(C=t($[0],$[$.length-1],C==null?10:C)),C?h(w7e($,C)):c},c.copy=function(){return TM(c,Boe(e,t,n,r,i,s,a,o,l,u))},c}function ocn(){return cd.apply(Boe(Lon,Bon,Vh,A3,kM,_0,sU,rU,ap,Eoe).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function lcn(){return cd.apply(Boe(Ron,Pon,jh,T3,EM,ly,aU,iU,ap,Aoe).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function pU(){var e=0,t=1,n,r,i,s,a=Ko,o=!1,l;function u(f){return f==null||isNaN(f=+f)?l:a(i===0?.5:(f=(s(f)-n)*i,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(a=f,u):a};function c(f){return function(h){var d,p;return arguments.length?([d,p]=h,a=f(d,p),u):[a(0),a(1)]}}return u.range=c(vx),u.rangeRound=c(hU),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function sv(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function zoe(){var e=yx(pU()(Ko));return e.copy=function(){return sv(e,zoe())},rv.apply(e,arguments)}function E7e(){var e=Ooe(pU()).domain([1,10]);return e.copy=function(){return sv(e,E7e()).base(e.base())},rv.apply(e,arguments)}function A7e(){var e=Roe(pU());return e.copy=function(){return sv(e,A7e()).constant(e.constant())},rv.apply(e,arguments)}function Uoe(){var e=Poe(pU());return e.copy=function(){return sv(e,Uoe()).exponent(e.exponent())},rv.apply(e,arguments)}function ucn(){return Uoe.apply(null,arguments).exponent(.5)}function gU(){var e=0,t=.5,n=1,r=1,i,s,a,o,l,u=Ko,c,f=!1,h;function d(g){return isNaN(g=+g)?h:(g=.5+((g=+c(g))-s)*(r*g<r*s?o:l),u(f?Math.max(0,Math.min(1,g)):g))}d.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),s=c(t=+t),a=c(n=+n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d):[e,t,n]},d.clamp=function(g){return arguments.length?(f=!!g,d):f},d.interpolator=function(g){return arguments.length?(u=g,d):u};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,u=Foe(g,[v,y,b]),d):[u(0),u(.5),u(1)]}}return d.range=p(vx),d.rangeRound=p(hU),d.unknown=function(g){return arguments.length?(h=g,d):h},function(g){return c=g,i=g(e),s=g(t),a=g(n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d}}function T7e(){var e=yx(gU()(Ko));return e.copy=function(){return sv(e,T7e())},rv.apply(e,arguments)}function D7e(){var e=Ooe(gU()).domain([.1,1,10]);return e.copy=function(){return sv(e,D7e()).base(e.base())},rv.apply(e,arguments)}function N7e(){var e=Roe(gU());return e.copy=function(){return sv(e,N7e()).constant(e.constant())},rv.apply(e,arguments)}function Woe(){var e=Poe(gU());return e.copy=function(){return sv(e,Woe()).exponent(e.exponent())},rv.apply(e,arguments)}function ccn(){return Woe.apply(null,arguments).exponent(.5)}function fcn(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const hcn="identity",Voe="linear",hm="log",joe="pow",Hoe="sqrt",qoe="symlog",U3="time",W3="utc",sS="sequential",DM="diverging",s6="quantile",Goe="quantize",I7e="threshold",dcn="ordinal",pcn="point",gcn="band",mcn="bin-ordinal",_s="continuous",NM="discrete",IM="discretizing",gf="interpolating",Yoe="temporal";function vcn(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function ycn(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,a,o,l,u;for(i<r&&(o=r,r=i,i=o),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(s<0&&(s=l),a=l);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[a]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function Xoe(){const e=Toe().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,a=!1,o=0,l=0,u=.5;delete e.unknown;function c(){const f=t().length,h=r[1]<r[0],d=r[1-h],p=fcn(f,o,l);let g=r[h-0];i=(d-g)/(p||1),a&&(i=Math.floor(i)),g+=(d-g-i*(f-o))*u,s=i*(1-o),a&&(g=Math.round(g),s=Math.round(s));const m=bon(f).map(v=>g+i*v);return n(h?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),o=l,c()):o},e.paddingInner=function(f){return arguments.length?(o=Math.max(0,Math.min(1,f)),c()):o},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const h=r[1]<r[0],d=h?n().reverse():n(),p=d.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<d[0]||g>r[1-h])))return v=Math.max(0,zZ(d,g)-1),y=g===m?v:zZ(d,m)-1,g-d[v]>s+1e-10&&++v,h&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const h=e.invertRange([f,f]);return h&&h[0]},e.copy=function(){return Xoe().domain(t()).range(r).round(a).paddingInner(o).paddingOuter(l).align(u)},c()}function M7e(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return M7e(t())},e}function bcn(){return M7e(Xoe().paddingInner(1))}var xcn=Array.prototype.map;function wcn(e){return xcn.call(e,Man)}const $cn=Array.prototype.slice;function F7e(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(SM(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=wcn(r),n):e.slice()},n.range=function(r){return arguments.length?(t=$cn.call(r),n):t.slice()},n.tickFormat=function(r,i){return y7e(e[0],ab(e),r==null?10:r,i)},n.copy=function(){return F7e().domain(n.domain()).range(n.range())},n}const a6=new Map,Ccn=Symbol("vega_scale");function _cn(e){return e[Ccn]=!0,e}function Scn(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?vcn(s):s.invertExtent?ycn(s):void 0),s.type=e,_cn(s)};return r.metadata=dze(moe(n)),r}function dr(e,t,n){return arguments.length>1?(a6.set(e,Scn(e,t,n)),this):kcn(e)?a6.get(e):void 0}dr(hcn,x7e);dr(Voe,b7e,_s);dr(hm,$7e,[_s,hm]);dr(joe,Loe,_s);dr(Hoe,icn,_s);dr(qoe,C7e,_s);dr(U3,ocn,[_s,Yoe]);dr(W3,lcn,[_s,Yoe]);dr(sS,zoe,[_s,gf]);dr(`${sS}-${Voe}`,zoe,[_s,gf]);dr(`${sS}-${hm}`,E7e,[_s,gf,hm]);dr(`${sS}-${joe}`,Uoe,[_s,gf]);dr(`${sS}-${Hoe}`,ucn,[_s,gf]);dr(`${sS}-${qoe}`,A7e,[_s,gf]);dr(`${DM}-${Voe}`,T7e,[_s,gf]);dr(`${DM}-${hm}`,D7e,[_s,gf,hm]);dr(`${DM}-${joe}`,Woe,[_s,gf]);dr(`${DM}-${Hoe}`,ccn,[_s,gf]);dr(`${DM}-${qoe}`,N7e,[_s,gf]);dr(s6,_7e,[IM,s6]);dr(Goe,S7e,IM);dr(I7e,k7e,IM);dr(mcn,F7e,[NM,IM]);dr(dcn,Toe,NM);dr(gcn,Xoe,NM);dr(pcn,bcn,NM);function kcn(e){return a6.has(e)}function mU(e,t){const n=a6.get(e);return n&&n.metadata[t]}function O7e(e){return mU(e,NM)}function Ecn(e){return mU(e,IM)}function Acn(e){return mU(e,hm)}function Tcn(e){return mU(e,Yoe)}function Dcn(e,t,n){return Foe(Ncn(t||"rgb",n),e)}function Ncn(e,t){const n=qun[Icn(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function Icn(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const Mcn={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},Fcn={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function R7e(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function P7e(e,t){for(const n in e)Ocn(n,t(e[n]))}const Uxe={};P7e(Fcn,R7e);P7e(Mcn,e=>Dcn(R7e(e)));function Ocn(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(Uxe[e]=t,this):Uxe[e]}const Rcn="symbol",Pcn="discrete",Lcn=e=>ud(e)?e.map(t=>String(t)):String(e),Bcn=(e,t)=>e[1]-t[1],zcn=(e,t)=>t[1]-e[1];function Ucn(e,t,n){let r=e.range(),i=r[0],s=ab(r),a=Bcn;if(i>s&&(r=s,s=i,i=r,a=zcn),i=Math.floor(i),s=Math.ceil(s),t=t.map(o=>[o,e(o)]).filter(o=>i<=o[1]&&o[1]<=s).sort(a).map(o=>o[0]),n>0&&t.length>1){const o=[t[0],ab(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=o)}return t}function L7e(e,t){return e.bins?Ucn(e,e.bins):e.ticks?e.ticks(t):e.domain()}function Wcn(e,t,n,r,i,s){const a=t.type;let o=Lcn;if(a===U3||i===U3)o=e.timeFormat(r);else if(a===W3||i===W3)o=e.utcFormat(r);else if(Acn(a)){const l=e.formatFloat(r);if(s||t.bins)o=l;else{const u=B7e(t,n,!1);o=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();o=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(o=e.format(r));return o}function B7e(e,t,n){const r=L7e(e,t),i=e.base(),s=Math.log(i),a=Math.max(1,i*t/r.length),o=l=>{let u=l/Math.pow(i,Math.round(Math.log(l)/s));return u*i<i-.5&&(u*=i),u<=a};return n?r.filter(o):o}const QZ={[s6]:"quantiles",[Goe]:"thresholds",[I7e]:"domain"},z7e={[s6]:"quantiles",[Goe]:"domain"};function Vcn(e,t){return e.bins?qcn(e.bins):e.type===hm?B7e(e,t,!0):QZ[e.type]?Hcn(e[QZ[e.type]]()):L7e(e,t)}function jcn(e,t,n){const r=t[z7e[t.type]](),i=r.length;let s=i>1?r[1]-r[0]:r[0],a;for(a=1;a<i;++a)s=Math.min(s,r[a]-r[a-1]);return e.formatSpan(0,s,3*10,n)}function Hcn(e){const t=[-1/0].concat(e);return t.max=1/0,t}function qcn(e){const t=e.slice(0,-1);return t.max=ab(e),t}const Gcn=e=>QZ[e.type]||e.bins;function Ycn(e,t,n,r,i,s,a){const o=z7e[t.type]&&s!==U3&&s!==W3?jcn(e,t,i):Wcn(e,t,n,i,s,a);return r===Rcn&&Gcn(t)?Xcn(o):r===Pcn?Kcn(o):Zcn(o)}const Xcn=e=>(t,n,r)=>{const i=Wxe(r[n+1],Wxe(r.max,1/0)),s=Vxe(t,e),a=Vxe(i,e);return s&&a?s+" \u2013 "+a:a?"< "+a:"\u2265 "+s},Wxe=(e,t)=>e!=null?e:t,Kcn=e=>(t,n)=>n?e(t):null,Zcn=e=>t=>e(t),Vxe=(e,t)=>Number.isFinite(e)?t(e):null;function Qcn(e,t,n,r){const i=r||t.type;return qL(n)&&Tcn(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===U3?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===W3?e.utcFormat("%A, %d %B %Y, %X UTC"):Ycn(e,t,5,null,n,r,!0)}function U7e(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=Qcn(e,t,n.format,n.formatType);if(Ecn(t.type)){const s=Vcn(t).slice(1).map(i),a=s.length;return`${a} boundar${a===1?"y":"ies"}: ${s.join(", ")}`}else if(O7e(t.type)){const s=t.domain(),a=s.length,o=a>r?s.slice(0,r-2).map(i).join(", ")+", ending with "+s.slice(-1).map(i):s.map(i).join(", ");return`${a} value${a===1?"":"s"}: ${o}`}else{const s=t.domain();return`values from ${i(s[0])} to ${i(ab(s))}`}}let W7e=0;function Jcn(){W7e=0}const o6="p_";function Koe(e){return e&&e.gradient}function V7e(e,t,n){const r=e.gradient;let i=e.id,s=r==="radial"?o6:"";return i||(i=e.id="gradient_"+W7e++,r==="radial"?(e.x1=Df(e.x1,.5),e.y1=Df(e.y1,.5),e.r1=Df(e.r1,0),e.x2=Df(e.x2,.5),e.y2=Df(e.y2,.5),e.r2=Df(e.r2,.5),s=o6):(e.x1=Df(e.x1,0),e.y1=Df(e.y1,0),e.x2=Df(e.x2,1),e.y2=Df(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+s+i+")"}function Df(e,t){return e!=null?e:t}function efn(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,s){return n.push({offset:i,color:s}),r}}}const jxe={basis:{curve:Xan},"basis-closed":{curve:Kan},"basis-open":{curve:Zan},bundle:{curve:Qan,tension:"beta",value:.85},cardinal:{curve:Jan,tension:"tension",value:0},"cardinal-open":{curve:ton,tension:"tension",value:0},"cardinal-closed":{curve:eon,tension:"tension",value:0},"catmull-rom":{curve:non,tension:"alpha",value:.5},"catmull-rom-closed":{curve:ron,tension:"alpha",value:.5},"catmull-rom-open":{curve:ion,tension:"alpha",value:.5},linear:{curve:voe},"linear-closed":{curve:son},monotone:{horizontal:oon,vertical:aon},natural:{curve:lon},step:{curve:uon},"step-after":{curve:fon},"step-before":{curve:con}};function Zoe(e,t,n){var r=Kd(jxe,e)&&jxe[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const tfn={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Dk=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function V3(e){const t=[];let n,r,i,s,a,o,l,u,c,f;const h=e.slice().replace(Dk[0],"###$1").split(Dk[1]).slice(1);for(l=0,c=h.length;l<c;++l){for(n=h[l],r=n.slice(1).trim().replace(Dk[2],"$1###$2").replace(Dk[3],"$1###$2").split(Dk[4]),a=n.charAt(0),i=[a],u=0,f=r.length;u<f;++u)(s=+r[u])===s&&i.push(s);if(o=tfn[a.toLowerCase()],i.length-1>o){const d=i.length;for(u=1,t.push([a].concat(i.slice(u,u+=o))),a=a==="M"?"L":a==="m"?"l":a;u<d;u+=o)t.push([a].concat(i.slice(u,u+o)))}else t.push(i)}return t}const dm=Math.PI/180,nfn=1e-14,g1=Math.PI/2,Gf=Math.PI*2,p2=Math.sqrt(3)/2;var wq={},$q={},j7e=[].join;function rfn(e,t,n,r,i,s,a,o,l){const u=j7e.call(arguments);if(wq[u])return wq[u];const c=a*dm,f=Math.sin(c),h=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const d=h*(o-e)*.5+f*(l-t)*.5,p=h*(l-t)*.5-f*(o-e)*.5;let g=d*d/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=h/n,v=f/n,y=-f/r,b=h/r,x=m*o+v*l,w=y*o+b*l,C=m*e+v*t,$=y*e+b*t;let k=1/((C-x)*(C-x)+($-w)*($-w))-.25;k<0&&(k=0);let E=Math.sqrt(k);s==i&&(E=-E);const S=.5*(x+C)-E*($-w),N=.5*(w+$)+E*(C-x),A=Math.atan2(w-N,x-S);let T=Math.atan2($-N,C-S)-A;T<0&&s===1?T+=Gf:T>0&&s===0&&(T-=Gf);const I=Math.ceil(Math.abs(T/(g1+.001))),F=[];for(let R=0;R<I;++R){const P=A+R*T/I,V=A+(R+1)*T/I;F[R]=[S,N,P,V,n,r,f,h]}return wq[u]=F}function ifn(e){const t=j7e.call(e);if($q[t])return $q[t];var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7];const c=u*a,f=-l*o,h=l*a,d=u*o,p=Math.cos(i),g=Math.sin(i),m=Math.cos(s),v=Math.sin(s),y=.5*(s-i),b=Math.sin(y*.5),x=8/3*b*b/Math.sin(y),w=n+p-x*g,C=r+g+x*p,$=n+m,_=r+v,k=$+x*v,E=_-x*m;return $q[t]=[c*w+f*C,h*w+d*C,c*k+f*E,h*k+d*E,c*$+f*_,h*$+d*_]}const au=["l",0,0,0,0,0,0,0];function sfn(e,t,n){const r=au[0]=e[0];if(r==="a"||r==="A")au[1]=t*e[1],au[2]=n*e[2],au[3]=e[3],au[4]=e[4],au[5]=e[5],au[6]=t*e[6],au[7]=n*e[7];else if(r==="h"||r==="H")au[1]=t*e[1];else if(r==="v"||r==="V")au[1]=n*e[1];else for(var i=1,s=e.length;i<s;++i)au[i]=(i%2==1?t:n)*e[i];return au}function l6(e,t,n,r,i,s){var a,o=null,l=0,u=0,c=0,f=0,h,d,p,g;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),s==null&&(s=i),e.beginPath&&e.beginPath();for(var m=0,v=t.length;m<v;++m){switch(a=t[m],(i!==1||s!==1)&&(a=sfn(a,i,s)),a[0]){case"l":l+=a[1],u+=a[2],e.lineTo(l+n,u+r);break;case"L":l=a[1],u=a[2],e.lineTo(l+n,u+r);break;case"h":l+=a[1],e.lineTo(l+n,u+r);break;case"H":l=a[1],e.lineTo(l+n,u+r);break;case"v":u+=a[1],e.lineTo(l+n,u+r);break;case"V":u=a[1],e.lineTo(l+n,u+r);break;case"m":l+=a[1],u+=a[2],e.moveTo(l+n,u+r);break;case"M":l=a[1],u=a[2],e.moveTo(l+n,u+r);break;case"c":h=l+a[5],d=u+a[6],c=l+a[3],f=u+a[4],e.bezierCurveTo(l+a[1]+n,u+a[2]+r,c+n,f+r,h+n,d+r),l=h,u=d;break;case"C":l=a[5],u=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,c+n,f+r,l+n,u+r);break;case"s":h=l+a[3],d=u+a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,l+a[1]+n,u+a[2]+r,h+n,d+r),c=l+a[1],f=u+a[2],l=h,u=d;break;case"S":h=a[3],d=a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,a[1]+n,a[2]+r,h+n,d+r),l=h,u=d,c=a[1],f=a[2];break;case"q":h=l+a[3],d=u+a[4],c=l+a[1],f=u+a[2],e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d;break;case"Q":h=a[3],d=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,h+n,d+r),l=h,u=d,c=a[1],f=a[2];break;case"t":h=l+a[1],d=u+a[2],o[0].match(/[QqTt]/)===null?(c=l,f=u):o[0]==="t"?(c=2*l-p,f=2*u-g):o[0]==="q"&&(c=2*l-c,f=2*u-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d,c=l+a[1],f=u+a[2];break;case"T":h=a[1],d=a[2],c=2*l-c,f=2*u-f,e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d;break;case"a":Hxe(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+l+n,a[7]+u+r]),l+=a[6],u+=a[7];break;case"A":Hxe(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),l=a[6],u=a[7];break;case"z":case"Z":e.closePath();break}o=a}}function Hxe(e,t,n,r){const i=rfn(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let s=0;s<i.length;++s){const a=ifn(i[s]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const qxe=.5773502691896257,Gxe={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Gf)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,s=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-s),e.lineTo(i,-s),e.lineTo(0,-n),e.lineTo(-i,-s),e.lineTo(-r,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=p2*n,i=r-n*qxe,s=n/4;e.moveTo(0,-r-i),e.lineTo(-s,r-i),e.lineTo(s,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=p2*n,i=r-n*qxe;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=p2*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=p2*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=p2*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=p2*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function H7e(e){return Kd(Gxe,e)?Gxe[e]:afn(e)}var Cq={};function afn(e){if(!Kd(Cq,e)){const t=V3(e);Cq[e]={draw:function(n,r){l6(n,t,0,0,Math.sqrt(r)/2)}}}return Cq[e]}const Dg=.448084975506;function ofn(e){return e.x}function lfn(e){return e.y}function ufn(e){return e.width}function cfn(e){return e.height}function Md(e){return typeof e=="function"?e:()=>+e}function mR(e,t,n){return Math.max(t,Math.min(e,n))}function q7e(){var e=ofn,t=lfn,n=ufn,r=cfn,i=Md(0),s=i,a=i,o=i,l=null;function u(c,f,h){var d,p=f!=null?f:+e.call(this,c),g=h!=null?h:+t.call(this,c),m=+n.call(this,c),v=+r.call(this,c),y=Math.min(m,v)/2,b=mR(+i.call(this,c),0,y),x=mR(+s.call(this,c),0,y),w=mR(+a.call(this,c),0,y),C=mR(+o.call(this,c),0,y);if(l||(l=d=px()),b<=0&&x<=0&&w<=0&&C<=0)l.rect(p,g,m,v);else{var $=p+m,_=g+v;l.moveTo(p+b,g),l.lineTo($-x,g),l.bezierCurveTo($-Dg*x,g,$,g+Dg*x,$,g+x),l.lineTo($,_-C),l.bezierCurveTo($,_-Dg*C,$-Dg*C,_,$-C,_),l.lineTo(p+w,_),l.bezierCurveTo(p+Dg*w,_,p,_-Dg*w,p,_-w),l.lineTo(p,g+b),l.bezierCurveTo(p,g+Dg*b,p+Dg*b,g,p+b,g),l.closePath()}if(d)return l=null,d+""||null}return u.x=function(c){return arguments.length?(e=Md(c),u):e},u.y=function(c){return arguments.length?(t=Md(c),u):t},u.width=function(c){return arguments.length?(n=Md(c),u):n},u.height=function(c){return arguments.length?(r=Md(c),u):r},u.cornerRadius=function(c,f,h,d){return arguments.length?(i=Md(c),s=f!=null?Md(f):i,o=h!=null?Md(h):i,a=d!=null?Md(d):s,u):i},u.context=function(c){return arguments.length?(l=c==null?null:c,u):l},u}function G7e(){var e,t,n,r,i=null,s,a,o,l;function u(f,h,d){const p=d/2;if(s){var g=o-h,m=f-a;if(g||m){var v=Math.sqrt(g*g+m*m),y=(g/=v)*l,b=(m/=v)*l,x=Math.atan2(m,g);i.moveTo(a-y,o-b),i.lineTo(f-g*p,h-m*p),i.arc(f,h,p,x-Math.PI,x),i.lineTo(a+y,o+b),i.arc(a,o,l,x,x+Math.PI)}else i.arc(f,h,p,0,Gf);i.closePath()}else s=1;a=f,o=h,l=p}function c(f){var h,d=f.length,p,g=!1,m;for(i==null&&(i=m=px()),h=0;h<=d;++h)!(h<d&&r(p=f[h],h,f))===g&&(g=!g)&&(s=0),g&&u(+e(p,h,f),+t(p,h,f),+n(p,h,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function MM(e,t){return e!=null?e:t}const FM=e=>e.x||0,OM=e=>e.y||0,ffn=e=>e.width||0,hfn=e=>e.height||0,dfn=e=>(e.x||0)+(e.width||0),pfn=e=>(e.y||0)+(e.height||0),gfn=e=>e.startAngle||0,mfn=e=>e.endAngle||0,vfn=e=>e.padAngle||0,yfn=e=>e.innerRadius||0,bfn=e=>e.outerRadius||0,xfn=e=>e.cornerRadius||0,wfn=e=>MM(e.cornerRadiusTopLeft,e.cornerRadius)||0,$fn=e=>MM(e.cornerRadiusTopRight,e.cornerRadius)||0,Cfn=e=>MM(e.cornerRadiusBottomRight,e.cornerRadius)||0,_fn=e=>MM(e.cornerRadiusBottomLeft,e.cornerRadius)||0,Sfn=e=>MM(e.size,64),kfn=e=>e.size||1,vU=e=>e.defined!==!1,Efn=e=>H7e(e.shape||"circle"),Afn=qan().startAngle(gfn).endAngle(mfn).padAngle(vfn).innerRadius(yfn).outerRadius(bfn).cornerRadius(xfn),Tfn=xze().x(FM).y1(OM).y0(pfn).defined(vU),Dfn=xze().y(OM).x1(FM).x0(dfn).defined(vU),Nfn=bze().x(FM).y(OM).defined(vU),Ifn=q7e().x(FM).y(OM).width(ffn).height(hfn).cornerRadius(wfn,$fn,Cfn,_fn),Mfn=Yan().type(Efn).size(Sfn),Ffn=G7e().x(FM).y(OM).defined(vU).size(kfn);function Qoe(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Ofn(e,t){return Afn.context(e)(t)}function Rfn(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?Dfn:Tfn).curve(Zoe(r,n.orient,n.tension)).context(e)(t)}function Pfn(e,t){const n=t[0],r=n.interpolate||"linear";return Nfn.curve(Zoe(r,n.orient,n.tension)).context(e)(t)}function aS(e,t,n,r){return Ifn.context(e)(t,n,r)}function Lfn(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Bfn(e,t){return Mfn.context(e)(t)}function zfn(e,t){return Ffn.context(e)(t)}var Y7e=1;function X7e(){Y7e=1}function Joe(e,t,n){var r=t.clip,i=e._defs,s=t.clip_id||(t.clip_id="clip"+Y7e++),a=i.clipping[s]||(i.clipping[s]={id:s});return Q9(r)?a.path=r(null):Qoe(n)?a.path=aS(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+s+")"}function fl(e){this.clear(),e&&this.union(e)}fl.prototype={clone(){return new fl(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:s,y2:a}=this,o=Math.cos(e),l=Math.sin(e),u=t-t*o+n*l,c=n-t*l-n*o;return[o*r-l*i+u,l*r+o*i+c,o*r-l*a+u,l*r+o*a+c,o*s-l*i+u,l*s+o*i+c,o*s-l*a+u,l*s+o*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function ele(e){this.mark=e,this.bounds=this.bounds||new fl}function tle(e){ele.call(this,e),this.items=this.items||[]}rS(tle,ele);function nle(e){this._pending=0,this._loader=e||jze()}function Yxe(e){e._pending+=1}function Nk(e){e._pending-=1}nle.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return Yxe(t),t._loader.sanitize(e,{context:"href"}).then(n=>(Nk(t),n)).catch(()=>(Nk(t),null))},loadImage(e){const t=this,n=Iie();return Yxe(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const s=new n,a=Kd(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(s.crossOrigin=a),s.onload=()=>Nk(t),s.onerror=()=>Nk(t),s.src=i,s}).catch(r=>(Nk(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function bx(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Ufn(t,r):0))}return e}function Ufn(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const Wfn=Gf-1e-8;let yU,k4,E4,B1,JZ,A4,eQ,tQ;const a0=(e,t)=>yU.add(e,t),T4=(e,t)=>a0(k4=e,E4=t),Xxe=e=>a0(e,yU.y1),Kxe=e=>a0(yU.x1,e),m1=(e,t)=>JZ*e+eQ*t,v1=(e,t)=>A4*e+tQ*t,_q=(e,t)=>a0(m1(e,t),v1(e,t)),Sq=(e,t)=>T4(m1(e,t),v1(e,t));function RM(e,t){return yU=e,t?(B1=t*dm,JZ=tQ=Math.cos(B1),A4=Math.sin(B1),eQ=-A4):(JZ=tQ=1,B1=A4=eQ=0),Vfn}const Vfn={beginPath(){},closePath(){},moveTo:Sq,lineTo:Sq,rect(e,t,n,r){B1?(_q(e+n,t),_q(e+n,t+r),_q(e,t+r),Sq(e,t)):(a0(e+n,t+r),T4(e,t))},quadraticCurveTo(e,t,n,r){const i=m1(e,t),s=v1(e,t),a=m1(n,r),o=v1(n,r);Zxe(k4,i,a,Xxe),Zxe(E4,s,o,Kxe),T4(a,o)},bezierCurveTo(e,t,n,r,i,s){const a=m1(e,t),o=v1(e,t),l=m1(n,r),u=v1(n,r),c=m1(i,s),f=v1(i,s);Qxe(k4,a,l,c,Xxe),Qxe(E4,o,u,f,Kxe),T4(c,f)},arc(e,t,n,r,i,s){if(r+=B1,i+=B1,k4=n*Math.cos(i)+e,E4=n*Math.sin(i)+t,Math.abs(i-r)>Wfn)a0(e-n,t-n),a0(e+n,t+n);else{const a=u=>a0(n*Math.cos(u)+e,n*Math.sin(u)+t);let o,l;if(a(r),a(i),i!==r)if(r=r%Gf,r<0&&(r+=Gf),i=i%Gf,i<0&&(i+=Gf),i<r&&(s=!s,o=r,r=i,i=o),s)for(i-=Gf,o=r-r%g1,l=0;l<4&&o>i;++l,o-=g1)a(o);else for(o=r-r%g1+g1,l=0;l<4&&o<i;++l,o=o+g1)a(o)}}};function Zxe(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function Qxe(e,t,n,r,i){const s=r-e+3*t-3*n,a=e+n-2*t,o=e-t;let l=0,u=0,c;Math.abs(s)>nfn?(c=a*a+o*s,c>=0&&(c=Math.sqrt(c),l=(-a+c)/s,u=(-a-c)/s)):l=.5*o/a,0<l&&l<1&&i(Jxe(l,e,t,n,r)),0<u&&u<1&&i(Jxe(u,e,t,n,r))}function Jxe(e,t,n,r,i){const s=1-e,a=s*s,o=e*e;return a*s*t+3*a*e*n+3*s*o*r+o*e*i}var S0=(S0=Ku(1,1))?S0.getContext("2d"):null;const nQ=new fl;function rle(e){return function(t,n){if(!S0)return!0;e(S0,t),nQ.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:s,y2:a}=nQ;for(let o=i;o<=a;++o)for(let l=r;l<=s;++l)if(S0.isPointInPath(l,o))return!0;return!1}}function ile(e,t){return t.contains(e.x||0,e.y||0)}function K7e(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,s=e.height||0;return t.intersects(nQ.set(n,r,n+i,r+s))}function Z7e(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:r;return L2(t,n,r,i,s)}function L2(e,t,n,r,i){const{x1:s,y1:a,x2:o,y2:l}=e,u=r-t,c=i-n;let f=0,h=1,d,p,g,m;for(m=0;m<4;++m){if(m===0&&(d=-u,p=-(s-t)),m===1&&(d=u,p=o-t),m===2&&(d=-c,p=-(a-n)),m===3&&(d=c,p=l-n),Math.abs(d)<1e-10&&p<0)return!1;if(g=p/d,d<0){if(g>h)return!1;g>f&&(f=g)}else if(d>0){if(g<f)return!1;g<h&&(h=g)}}return!0}function I$(e,t){e.globalCompositeOperation=t.blend||"source-over"}function oc(e,t){return e==null?t:e}function e2e(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function jfn(e,t,n){const r=n.width(),i=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+oc(t.x1,.5)*r,n.y1+oc(t.y1,.5)*i,Math.max(r,i)*oc(t.r1,0),n.x1+oc(t.x2,.5)*r,n.y1+oc(t.y2,.5)*i,Math.max(r,i)*oc(t.r2,.5));else{const a=oc(t.x1,0),o=oc(t.y1,0),l=oc(t.x2,1),u=oc(t.y2,0);if(a===l||o===u||r===i)s=e.createLinearGradient(n.x1+a*r,n.y1+o*i,n.x1+l*r,n.y1+u*i);else{const c=Ku(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=e2e(f.createLinearGradient(a,o,l,u),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return e2e(s,t.stops)}function Q7e(e,t,n){return Koe(n)?jfn(e,n,t.bounds):n}function u6(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=Q7e(e,t,t.fill),!0):!1}var Hfn=[];function M$(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=Q7e(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Hfn),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function qfn(e,t){return e.zindex-t.zindex||e.index-t.index}function sle(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,s;for(i=0,s=t.length;i<s;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(qfn)}function af(e,t){var n=e.items,r,i;if(!n||!n.length)return;const s=sle(e);if(s&&s.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=s}for(r=0,i=n.length;r<i;++r)t(n[r])}function c6(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const s=sle(e);for(s&&s.length&&(n=s),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===s){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function ale(e){return function(t,n,r){af(n,i=>{(!r||r.intersects(i.bounds))&&J7e(e,t,i,i)})}}function Gfn(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&J7e(e,t,n.items[0],n.items)}}function J7e(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(I$(t,n),n.fill&&u6(t,n,i)&&t.fill(),n.stroke&&M$(t,n,i)&&t.stroke()))}function bU(e){return e=e||fze,function(t,n,r,i,s,a){return r*=t.pixelRatio,i*=t.pixelRatio,c6(n,o=>{const l=o.bounds;if(!(l&&!l.contains(s,a)||!l)&&e(t,o,r,i,s,a))return o})}}function PM(e,t){return function(n,r,i,s){var a=Array.isArray(r)?r[0]:r,o=t==null?a.fill:t,l=a.stroke&&n.isPointInStroke,u,c;return l&&(u=a.strokeWidth,c=a.strokeCap,n.lineWidth=u!=null?u:1,n.lineCap=c!=null?c:"butt"),e(n,r)?!1:o&&n.isPointInPath(i,s)||l&&n.isPointInStroke(i,s)}}function ole(e){return bU(PM(e))}function fy(e,t){return"translate("+e+","+t+")"}function lle(e){return"rotate("+e+")"}function Yfn(e,t){return"scale("+e+","+t+")"}function e9e(e){return fy(e.x||0,e.y||0)}function Xfn(e){return fy(e.x||0,e.y||0)+(e.angle?" "+lle(e.angle):"")}function Kfn(e){return fy(e.x||0,e.y||0)+(e.angle?" "+lle(e.angle):"")+(e.scaleX||e.scaleY?" "+Yfn(e.scaleX||1,e.scaleY||1):"")}function ule(e,t,n){function r(a,o){a("transform",Xfn(o)),a("d",t(null,o))}function i(a,o){return t(RM(a,o.angle),o),bx(a,o).translate(o.x||0,o.y||0)}function s(a,o){var l=o.x||0,u=o.y||0,c=o.angle||0;a.translate(l,u),c&&a.rotate(c*=dm),a.beginPath(),t(a,o),c&&a.rotate(-c),a.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:ale(s),pick:ole(s),isect:n||rle(s)}}var Zfn=ule("arc",Ofn);function Qfn(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,s=1/0,a,o;--i>=0;)e[i].defined!==!1&&(o=Math.abs(e[i][r]-n),o<s&&(s=o,a=e[i]));return a}function Jfn(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,s,a;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],s=e[r].y-t[1],a=i*i+s*s,a<n))return e[r];return null}function ehn(e,t){for(var n=e.length,r,i,s;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],s=r*r+i*i,r=e[n].size||1,s<r*r))return e[n];return null}function cle(e,t,n){function r(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))}function i(l,u){var c=u.items;return c.length===0?l:(t(RM(l),c),bx(l,c[0]))}function s(l,u){l.beginPath(),t(l,u)}const a=PM(s);function o(l,u,c,f,h,d){var p=u.items,g=u.bounds;return!p||!p.length||g&&!g.contains(h,d)?null:(c*=l.pixelRatio,f*=l.pixelRatio,a(l,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:Gfn(s),pick:o,isect:ile,tip:n}}var thn=cle("area",Rfn,Qfn);function nhn(e,t){var n=t.clip;e.save(),Q9(n)?(e.beginPath(),n(e),e.clip()):t9e(e,t.group)}function t9e(e,t){e.beginPath(),Qoe(t)?aS(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function n9e(e){const t=oc(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function rhn(e,t){e("transform",e9e(t))}function r9e(e,t){const n=n9e(t);e("d",aS(null,t,n,n))}function ihn(e,t){e("class","background"),e("aria-hidden",!0),r9e(e,t)}function shn(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?r9e(e,t):e("d","")}function ahn(e,t,n){const r=t.clip?Joe(n,t,t):null;e("clip-path",r)}function ohn(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),bx(e,t),e.translate(t.x||0,t.y||0)}function j3(e,t,n,r){const i=n9e(t);e.beginPath(),aS(e,t,(n||0)+i,(r||0)+i)}const lhn=PM(j3),uhn=PM(j3,!1),chn=PM(j3,!0);function fhn(e,t,n){af(t,r=>{const i=r.x||0,s=r.y||0,a=r.strokeForeground,o=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&o&&(j3(e,r,i,s),I$(e,r),r.fill&&u6(e,r,o)&&e.fill(),r.stroke&&!a&&M$(e,r,o)&&e.stroke()),e.save(),e.translate(i,s),r.clip&&t9e(e,r),n&&n.translate(-i,-s),af(r,l=>{this.draw(e,l,n)}),n&&n.translate(i,s),e.restore(),a&&r.stroke&&o&&(j3(e,r,i,s),I$(e,r),M$(e,r,o)&&e.stroke())})}function hhn(e,t,n,r,i,s){if(t.bounds&&!t.bounds.contains(i,s)||!t.items)return null;const a=n*e.pixelRatio,o=r*e.pixelRatio;return c6(t,l=>{let u,c,f;const h=l.bounds;if(h&&!h.contains(i,s))return;c=l.x||0,f=l.y||0;const d=c+(l.width||0),p=f+(l.height||0),g=l.clip;if(g&&(i<c||i>d||s<f||s>p))return;if(e.save(),e.translate(c,f),c=i-c,f=s-f,g&&Qoe(l)&&!chn(e,l,a,o))return e.restore(),null;const m=l.strokeForeground,v=t.interactive!==!1;return v&&m&&l.stroke&&uhn(e,l,a,o)?(e.restore(),l):(u=c6(l,y=>dhn(y,c,f)?this.pick(y,n,r,c,f):null),!u&&v&&(l.fill||!m&&l.stroke)&&lhn(e,l,a,o)&&(u=l),e.restore(),u||null)})}function dhn(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var phn={type:"group",tag:"g",nested:!1,attr:rhn,bound:ohn,draw:fhn,pick:hhn,isect:K7e,content:ahn,background:ihn,foreground:shn},H3={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function fle(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function hle(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function dle(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function xU(e,t){return e==="center"?t/2:e==="right"?t:0}function wU(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function ghn(e,t,n){const r=fle(t,n),i=hle(t,r),s=dle(t,r),a=(t.x||0)-xU(t.align,i),o=(t.y||0)-wU(t.baseline,s),l=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",l,H3["xmlns:xlink"],"xlink:href"),e("transform",fy(a,o)),e("width",i),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function mhn(e,t){const n=t.image,r=hle(t,n),i=dle(t,n),s=(t.x||0)-xU(t.align,r),a=(t.y||0)-wU(t.baseline,i);return e.set(s,a,s+r,a+i)}function vhn(e,t,n){af(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=fle(r,this);let s=hle(r,i),a=dle(r,i);if(s===0||a===0)return;let o=(r.x||0)-xU(r.align,s),l=(r.y||0)-wU(r.baseline,a),u,c,f,h;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(h=s/c,l+=(a-h)/2,a=h):(h=a*c,o+=(s-h)/2,s=h))),(i.complete||i.toDataURL)&&(I$(e,r),e.globalAlpha=(u=r.opacity)!=null?u:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,o,l,s,a))})}var yhn={type:"image",tag:"image",nested:!1,attr:ghn,bound:mhn,draw:vhn,pick:bU(),isect:fze,get:fle,xOffset:xU,yOffset:wU},bhn=cle("line",Pfn,Jfn);function xhn(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",Kfn(t)),e("d",t.path)}function D4(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,s=t.scaleX||1,a=t.scaleY||1,o=(t.angle||0)*dm,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=V3(n)).path=n),o&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(o),l6(e,l,0,0,s,a),e.rotate(-o),e.translate(-r,-i)):l6(e,l,r,i,s,a)}function whn(e,t){return D4(RM(e,t.angle),t)?e.set(0,0,0,0):bx(e,t,!0)}var $hn={type:"path",tag:"path",nested:!1,attr:xhn,bound:whn,draw:ale(D4),pick:ole(D4),isect:rle(D4)};function Chn(e,t){e("d",aS(null,t))}function _hn(e,t){var n,r;return bx(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function t2e(e,t){e.beginPath(),aS(e,t)}var Shn={type:"rect",tag:"path",nested:!1,attr:Chn,bound:_hn,draw:ale(t2e),pick:ole(t2e),isect:K7e};function khn(e,t){e("transform",e9e(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Ehn(e,t){var n,r;return bx(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function i9e(e,t,n){var r,i,s,a;return t.stroke&&M$(e,t,n)?(r=t.x||0,i=t.y||0,s=t.x2!=null?t.x2:r,a=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(s,a),!0):!1}function Ahn(e,t,n){af(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&i9e(e,r,i)&&(I$(e,r),e.stroke())}})}function Thn(e,t,n,r){return e.isPointInStroke?i9e(e,t,1)&&e.isPointInStroke(n,r):!1}var Dhn={type:"rule",tag:"line",nested:!1,attr:khn,bound:Ehn,draw:Ahn,pick:bU(Thn),isect:Z7e},Nhn=ule("shape",Lfn),Ihn=ule("symbol",Bfn,ile);const n2e=Ran();var cw={height:fd,measureWidth:ple,estimateWidth:rQ,width:rQ,canvas:s9e};s9e(!0);function s9e(e){cw.width=e&&S0?ple:rQ}function rQ(e,t){return a9e(gm(e,t),fd(e))}function a9e(e,t){return~~(.8*e.length*t)}function ple(e,t){return fd(e)<=0||!(t=gm(e,t))?0:o9e(t,$U(e))}function o9e(e,t){const n=`(${t}) ${e}`;let r=n2e.get(n);return r===void 0&&(S0.font=t,r=S0.measureText(e).width,n2e.set(n,r)),r}function fd(e){return e.fontSize!=null?+e.fontSize||0:11}function pm(e){return e.lineHeight!=null?e.lineHeight:fd(e)+2}function Mhn(e){return ud(e)?e.length>1?e:e[0]:e}function LM(e){return Mhn(e.lineBreak&&e.text&&!ud(e.text)?e.text.split(e.lineBreak):e.text)}function Fhn(e){const t=LM(e);return(ud(t)?t.length-1:0)*pm(e)}function gm(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Rhn(e,n):n}function Ohn(e){if(cw.width===ple){const t=$U(e);return n=>o9e(n,t)}else{const t=fd(e);return n=>a9e(n,t)}}function Rhn(e,t){var n=+e.limit,r=Ohn(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",s=e.dir==="rtl",a=0,o=t.length,l;if(n-=r(i),s){for(;a<o;)l=a+o>>>1,r(t.slice(l))>n?a=l+1:o=l;return i+t.slice(a)}else{for(;a<o;)l=1+(a+o>>>1),r(t.slice(0,l))<n?a=l:o=l-1;return t.slice(0,a)+i}}function BM(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function $U(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+fd(e)+"px "+BM(e,t)}function gle(e){var t=e.baseline,n=fd(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*pm(e):t==="line-bottom"?.29*n-.5*pm(e):0)}const Phn={left:"start",center:"middle",right:"end"},EA=new fl;function CU(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-g1,t+=r*Math.cos(i),n+=r*Math.sin(i)),EA.x1=t,EA.y1=n,EA}function Lhn(e,t){var n=t.dx||0,r=(t.dy||0)+gle(t),i=CU(t),s=i.x1,a=i.y1,o=t.angle||0,l;e("text-anchor",Phn[t.align]||"start"),o?(l=fy(s,a)+" "+lle(o),(n||r)&&(l+=" "+fy(n,r))):l=fy(s+n,a+r),e("transform",l)}function mle(e,t,n){var r=cw.height(t),i=t.align,s=CU(t),a=s.x1,o=s.y1,l=t.dx||0,u=(t.dy||0)+gle(t)-Math.round(.8*r),c=LM(t),f;if(ud(c)?(r+=pm(t)*(c.length-1),f=c.reduce((h,d)=>Math.max(h,cw.width(t,d)),0)):f=cw.width(t,c),i==="center"?l-=f/2:i==="right"&&(l-=f),e.set(l+=a,u+=o,l+f,u+r),t.angle&&!n)e.rotate(t.angle*dm,a,o);else if(n===2)return e.rotatedPoints(t.angle*dm,a,o);return e}function Bhn(e,t,n){af(t,r=>{var i=r.opacity==null?1:r.opacity,s,a,o,l,u,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=$U(r),e.textAlign=r.align||"left",s=CU(r),a=s.x1,o=s.y1,r.angle&&(e.save(),e.translate(a,o),e.rotate(r.angle*dm),a=o=0),a+=r.dx||0,o+=(r.dy||0)+gle(r),c=LM(r),I$(e,r),ud(c))for(u=pm(r),l=0;l<c.length;++l)f=gm(r,c[l]),r.fill&&u6(e,r,i)&&e.fillText(f,a,o),r.stroke&&M$(e,r,i)&&e.strokeText(f,a,o),o+=u;else f=gm(r,c),r.fill&&u6(e,r,i)&&e.fillText(f,a,o),r.stroke&&M$(e,r,i)&&e.strokeText(f,a,o);r.angle&&e.restore()}})}function zhn(e,t,n,r,i,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=CU(t),o=a.x1,l=a.y1,u=mle(EA,t,1),c=-t.angle*dm,f=Math.cos(c),h=Math.sin(c),d=f*i-h*s+(o-f*o+h*l),p=h*i+f*s+(l-h*o-f*l);return u.contains(d,p)}function Uhn(e,t){const n=mle(EA,e,2);return L2(t,n[0],n[1],n[2],n[3])||L2(t,n[0],n[1],n[4],n[5])||L2(t,n[4],n[5],n[6],n[7])||L2(t,n[2],n[3],n[6],n[7])}var Whn={type:"text",tag:"text",nested:!1,attr:Lhn,bound:mle,draw:Bhn,pick:bU(zhn),isect:Uhn},Vhn=cle("trail",zfn,ehn),of={arc:Zfn,area:thn,group:phn,image:yhn,line:bhn,path:$hn,rect:Shn,rule:Dhn,shape:Nhn,symbol:Ihn,text:Whn,trail:Vhn};function iQ(e,t,n){var r=of[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new fl),e,n)}var r2e={mark:null};function l9e(e,t,n){var r=of[e.marktype],i=r.bound,s=e.items,a=s&&s.length,o,l,u,c;if(r.nested)return a?u=s[0]:(r2e.mark=e,u=r2e),c=iQ(u,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new fl,a)for(o=0,l=s.length;o<l;++o)t.union(iQ(s[o],i,n));return e.bounds=t}const jhn=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function u9e(e,t){return JSON.stringify(e,jhn,t)}function c9e(e){const t=typeof e=="string"?JSON.parse(e):e;return f9e(t)}function f9e(e){var t=e.marktype,n=e.items,r,i,s;if(n)for(i=0,s=n.length;i<s;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&f9e(n[i]);return t&&l9e(e),e}function h9e(e){arguments.length?this.root=c9e(e):(this.root=d9e({marktype:"group",name:"root",role:"frame"}),this.root.items=[new tle(this.root)])}h9e.prototype={toJSON(e){return u9e(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=d9e(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function d9e(e,t){const n={bounds:new fl,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function o0(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function vle(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Vo(e,t,n,r){var i=e.childNodes[t],s;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(s=i||null,i=o0(e.ownerDocument,n,r),e.insertBefore(i,s)),i}function Dc(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function p9e(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function yle(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Hhn(e,t,n,r){var i=e&&e.mark,s,a;if(i&&(s=of[i.marktype]).tip){for(a=yle(t,n),a[0]-=r[0],a[1]-=r[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=s.tip(i.items,a)}return e}function mm(e,t){this._active=null,this._handlers={},this._loader=e||jze(),this._tooltip=t||qhn}function qhn(e,t,n,r){e.element().setAttribute("title",r||"")}mm.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),s=o0(null,"a");for(const a in r)s.setAttribute(a,r[a]);s.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=Hhn(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,s=i.width(),a=i.height();let o=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)o+=e.x||0,l+=e.y||0;return{x:o,y:l,width:s,height:a,left:o,top:l,right:o+s,bottom:l+a}}};function hd(e){this._el=null,this._bgcolor=null,this._loader=new nle(e)}hd.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(s=>{s&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const Ghn="keydown",Yhn="keypress",Xhn="keyup",g9e="dragenter",N4="dragleave",m9e="dragover",sQ="mousedown",Khn="mouseup",f6="mousemove",AA="mouseout",v9e="mouseover",h6="click",Zhn="dblclick",Qhn="wheel",y9e="mousewheel",d6="touchstart",p6="touchmove",g6="touchend",Jhn=[Ghn,Yhn,Xhn,g9e,N4,m9e,sQ,Khn,f6,AA,v9e,h6,Zhn,Qhn,y9e,d6,p6,g6],aQ=f6,q3=AA,oQ=h6;function ble(e,t){mm.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const edn=e=>e===d6||e===p6||e===g6?[d6,p6,g6]:[e];function i2e(e,t){edn(t).forEach(n=>tdn(e,n))}function tdn(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function s2e(e,t,n){return function(r){const i=this._active,s=this.pickEvent(r);s===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=s,this.fire(t,r),this.fire(e,r))}}function a2e(e){return function(t){this.fire(e,t),this._active=null}}rS(ble,mm,{initialize(e,t,n){return this._canvas=e&&vle(e,"canvas"),[h6,sQ,f6,AA,N4].forEach(r=>i2e(this,r)),mm.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:Jhn,DOMMouseScroll(e){this.fire(y9e,e)},mousemove:s2e(f6,v9e,AA),dragover:s2e(m9e,g9e,N4),mouseout:a2e(AA),dragleave:a2e(N4),mousedown(e){this._down=this._active,this.fire(sQ,e)},click(e){this._down===this._active&&(this.fire(h6,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(d6,e,!0)},touchmove(e){this.fire(p6,e,!0)},touchend(e){this.fire(g6,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===oQ&&r&&r.href?this.handleHref(t,r,r.href):(e===aQ||e===q3)&&this.handleTooltip(t,r,e!==q3),i)for(let s=0,a=i.length;s<a;++s)i[s].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(i2e(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=yle(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const s=this.context();return of[e.marktype].pick.call(this,s,e,t,n,r,i)}});function ndn(){return typeof window<"u"&&window.devicePixelRatio||1}var rdn=ndn();function idn(e,t,n,r,i,s){const a=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,o=e.getContext("2d"),l=a?rdn:i;e.width=t*l,e.height=n*l;for(const u in s)o[u]=s[u];return a&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),o.pixelRatio=l,o.setTransform(l,0,0,l,l*r[0],l*r[1]),e}function m6(e){hd.call(this,e),this._options={},this._redraw=!1,this._dirty=new fl,this._tempb=new fl}const o2e=hd.prototype,sdn=(e,t,n)=>new fl().set(0,0,t,n).translate(-e[0],-e[1]);function adn(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}rS(m6,hd,{initialize(e,t,n,r,i,s){return this._options=s||{},this._canvas=this._options.externalContext?null:Ku(1,1,this._options.type),e&&this._canvas&&(Dc(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),o2e.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(o2e.resize.call(this,e,t,n,r),this._canvas)idn(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||ph("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,s=this._dirty,a=sdn(n,r,i);t.save();const o=this._redraw||s.empty()?(this._redraw=!1,a.expand(1)):adn(t,a.intersect(s),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,o),t.restore(),s.clear(),this},draw(e,t,n){const r=of[t.marktype];t.clip&&nhn(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,s=this.context();i.type!=="pdf"&&!i.externalContext&&s.clearRect(e,t,n,r),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,r))}});function xle(e,t){mm.call(this,e,t);const n=this;n._hrefHandler=lQ(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=lQ(n,(r,i)=>{n.handleTooltip(r,i,r.type!==q3)})}const lQ=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};rS(xle,mm,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(oQ,this._hrefHandler),r.removeEventListener(aQ,this._tooltipHandler),r.removeEventListener(q3,this._tooltipHandler)),this._svg=r=e&&vle(e,"svg"),r&&(r.addEventListener(oQ,this._hrefHandler),r.addEventListener(aQ,this._tooltipHandler),r.addEventListener(q3,this._tooltipHandler)),mm.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const s={type:e,handler:t,listener:lQ(this,t)};(r[n]||(r[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const b9e="aria-hidden",wle="aria-label",$le="role",Cle="aria-roledescription",x9e="graphics-object",_le="graphics-symbol",w9e=(e,t,n)=>({[$le]:e,[Cle]:t,[wle]:n||void 0}),odn=dze(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),l2e={axis:{desc:"axis",caption:cdn},legend:{desc:"legend",caption:fdn},"title-text":{desc:"title",caption:e=>`Title text '${c2e(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${c2e(e)}'`}},u2e={ariaRole:$le,ariaRoleDescription:Cle,description:wle};function $9e(e,t){const n=t.aria===!1;if(e(b9e,n||void 0),n||t.description==null)for(const r in u2e)e(u2e[r],void 0);else{const r=t.mark.marktype;e(wle,t.description),e($le,t.ariaRole||(r==="group"?x9e:_le)),e(Cle,t.ariaRoleDescription||`${r} mark`)}}function C9e(e){return e.aria===!1?{[b9e]:!0}:odn[e.role]?null:l2e[e.role]?udn(e,l2e[e.role]):ldn(e)}function ldn(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return w9e(n?x9e:_le,`${t} mark container`,e.description)}function udn(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return w9e(t.role||_le,t.desc,n.description||r(n))}catch{return null}}function c2e(e){return moe(e.text).join(" ")}function cdn(e){const t=e.datum,n=e.orient,r=t.title?_9e(e):null,i=e.context,s=i.scales[t.scale].value,a=i.dataflow.locale(),o=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${O7e(o)?"discrete":o} scale with ${U7e(a,s,e)}`}function fdn(e){const t=e.datum,n=t.title?_9e(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,s=Object.keys(i),a=e.context,o=a.scales[i[s[0]]].value,l=a.dataflow.locale();return ddn(r)+(n?` titled '${n}'`:"")+` for ${hdn(s)} with ${U7e(l,o,e)}`}function _9e(e){try{return moe(ab(e.items).items[0].text).join(" ")}catch{return null}}function hdn(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+ab(e)}function ddn(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const S9e=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),pdn=e=>S9e(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function Sle(){let e="",t="",n="";const r=[],i=()=>t=n="",s=l=>{t&&(e+=`${t}>${n}`,i()),r.push(l)},a=(l,u)=>(u!=null&&(t+=` ${l}="${pdn(u)}"`),o),o={open(l,...u){s(l),t="<"+l;for(const c of u)for(const f in c)a(f,c[f]);return o},close(){const l=r.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,i(),o},attr:a,text:l=>(n+=S9e(l),o),toString:()=>e};return o}const k9e=e=>E9e(Sle(),e)+"";function E9e(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let i=0;i<r;i++){const s=n[i];s.nodeType===3?e.text(s.nodeValue):E9e(e,s)}}return e.close()}const v6={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},A9e={fill:"none","stroke-miterlimit":10},Ik=0,f2e="http://www.w3.org/2000/xmlns/",Si=H3.xmlns;function kle(e){hd.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const kq=hd.prototype;rS(kle,hd,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=Vo(e,0,"svg",Si),this._svg.setAttributeNS(f2e,"xmlns",Si),this._svg.setAttributeNS(f2e,"xmlns:xlink",H3["xmlns:xlink"]),this._svg.setAttribute("version",H3.version),this._svg.setAttribute("class","marks"),Dc(e,1),this._root=Vo(this._svg,Ik,"g",Si),l0(this._root,A9e),Dc(this._svg,Ik+1)),this.background(this._bgcolor),kq.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),kq.background.apply(this,arguments)},resize(e,t,n,r){return kq.resize.call(this,e,t,n,r),this._svg&&(l0(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Vo(e,Ik,"rect",Si),l0(n,{width:this._width,height:this._height,fill:t}));const r=k9e(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Dc(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,s,a,o,l;for(a=0,o=e.length;a<o;++a)if(n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,s=of[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,h2e(n,t),r.items.forEach(u=>{u.dirty=t})),!r.zdirty){if(n.exit){s.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(s,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null;continue}n=s.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,h2e(n,t)):this._update(s,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=of[t.marktype],s=t.interactive===!1?"none":null,a=i.tag==="g";let o=null,l=0;const u=d2e(t,e,n,"g",r);u.setAttribute("class",p9e(t));const c=C9e(t);for(const h in c)ja(u,h,c[h]);a||ja(u,"pointer-events",s),ja(u,"clip-path",t.clip?Joe(this,t,t.group):null);const f=h=>{const d=this.isDirty(h),p=d2e(h,u,o,i.tag,r);d&&(this._update(i,p,h),a&&vdn(this,p,h)),o=p,++l};return i.nested?t.items.length&&f(t.items[0]):af(t,f),Dc(u,l),u},_update(e,t,n){lp=t,la=t.__values__,$9e(TA,n),e.attr(TA,n,this);const r=bdn[e.type];r&&r.call(this,e,t,n),lp&&this.style(lp,n)},style(e,t){if(t!=null)for(const n in v6){let r=n==="font"?BM(t):t[n];if(r===la[n])continue;const i=v6[n];r==null?e.removeAttribute(i):(Koe(r)&&(r=V7e(r,this._defs.gradient,T9e())),e.setAttribute(i,r+"")),la[n]=r}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=Vo(e,Ik+1,"defs",Si)),r=gdn(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=Vo(e,Ik+1,"defs",Si)),r=mdn(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):Dc(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function h2e(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function gdn(e,t,n){let r,i,s;if(t.gradient==="radial"){let a=Vo(e,n++,"pattern",Si);l0(a,{id:o6+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=Vo(a,0,"rect",Si),l0(a,{width:1,height:1,fill:`url(${T9e()}#${t.id})`}),e=Vo(e,n++,"radialGradient",Si),l0(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Vo(e,n++,"linearGradient",Si),l0(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)s=Vo(e,r,"stop",Si),s.setAttribute("offset",t.stops[r].offset),s.setAttribute("stop-color",t.stops[r].color);return Dc(e,r),n}function mdn(e,t,n){let r;return e=Vo(e,n,"clipPath",Si),e.setAttribute("id",t.id),t.path?(r=Vo(e,0,"path",Si),r.setAttribute("d",t.path)):(r=Vo(e,0,"rect",Si),l0(r,{x:0,y:0,width:t.width,height:t.height})),Dc(e,1),n+1}function vdn(e,t,n){t=t.lastChild.previousSibling;let r,i=0;af(n,s=>{r=e.mark(t,s,r),++i}),Dc(t,1+i)}function d2e(e,t,n,r,i){let s=e._svg,a;if(!s&&(a=t.ownerDocument,s=o0(a,r,Si),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},r==="g"))){const o=o0(a,"path",Si);s.appendChild(o),o.__data__=e;const l=o0(a,"g",Si);s.appendChild(l),l.__data__=e;const u=o0(a,"path",Si);s.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(s.ownerSVGElement!==i||ydn(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function ydn(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let lp=null,la=null;const bdn={group(e,t,n){const r=lp=t.childNodes[2];la=r.__values__,e.foreground(TA,n,this),la=t.__values__,lp=t.childNodes[1],e.content(TA,n,this);const i=lp=t.childNodes[0];e.background(TA,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==la.events&&(ja(r,"pointer-events",s),ja(i,"pointer-events",s),la.events=s),n.strokeForeground&&n.stroke){const a=n.fill;ja(r,"display",null),this.style(i,n),ja(i,"stroke",null),a&&(n.fill=null),la=r.__values__,this.style(r,n),a&&(n.fill=a),lp=null}else ja(r,"display","none")},image(e,t,n){n.smooth===!1?(Eq(t,"image-rendering","optimizeSpeed"),Eq(t,"image-rendering","pixelated")):Eq(t,"image-rendering",null)},text(e,t,n){const r=LM(n);let i,s,a,o;ud(r)?(s=r.map(l=>gm(n,l)),i=s.join(`
`),i!==la.text&&(Dc(t,0),a=t.ownerDocument,o=pm(n),s.forEach((l,u)=>{const c=o0(a,"tspan",Si);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",o)),t.appendChild(c)}),la.text=i)):(s=gm(n,r),s!==la.text&&(t.textContent=s,la.text=s)),ja(t,"font-family",BM(n)),ja(t,"font-size",fd(n)+"px"),ja(t,"font-style",n.fontStyle),ja(t,"font-variant",n.fontVariant),ja(t,"font-weight",n.fontWeight)}};function TA(e,t,n){t!==la[e]&&(n?xdn(lp,e,t,n):ja(lp,e,t),la[e]=t)}function Eq(e,t,n){n!==la[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),la[t]=n)}function l0(e,t){for(const n in t)ja(e,n,t[n])}function ja(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function xdn(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function T9e(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Ele(e){hd.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}rS(Ele,hd,{svg(){return this._text},_render(e){const t=Sle();t.open("svg",J9({},H3,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",A9e,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=of[t.marktype],r=n.tag,i=[$9e,n.attr];e.open("g",{class:p9e(t),"clip-path":t.clip?Joe(this,t,t.group):null},C9e(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const s=a=>{const o=this.href(a);if(o&&e.open("a",o),e.open(r,this.attr(t,a,i,r!=="g"?r:null)),r==="text"){const l=LM(a);if(ud(l)){const u={x:0,dy:pm(a)};for(let c=0;c<l.length;++c)e.open("tspan",c?u:null).text(gm(a,l[c])).close()}else e.text(gm(a,l))}else if(r==="g"){const l=a.strokeForeground,u=a.fill,c=a.stroke;l&&c&&(a.stroke=null),e.open("path",this.attr(t,a,n.background,"bgrect")).close(),e.open("g",this.attr(t,a,n.content)),af(a,f=>this.mark(e,f)),e.close(),l&&c?(u&&(a.fill=null),a.stroke=c,e.open("path",this.attr(t,a,n.foreground,"bgrect")).close(),u&&(a.fill=u)):e.open("path",this.attr(t,a,n.foreground,"bgfore")).close()}e.close(),o&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):af(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},s=(a,o,l,u)=>{i[u||a]=o};return Array.isArray(n)?n.forEach(a=>a(s,t,this)):n(s,t,this),r&&wdn(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const s=t[i],a=s.stops;s.gradient==="radial"?(e.open("pattern",{id:o6+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:i,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let o=0;o<a.length;++o)e.open("stop",{offset:a[o].offset,"stop-color":a[o].color}).close();e.close()}for(const i in n){const s=n[i];e.open("clipPath",{id:i}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});function wdn(e,t,n,r,i){if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),r==="text"&&(e["font-family"]=BM(t),e["font-size"]=fd(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const s in v6){let a=t[s];const o=v6[s];a==="transparent"&&(o==="fill"||o==="stroke")||a!=null&&(Koe(a)&&(a=V7e(a,i.gradient,"")),e[o]=a)}return e}const D9e="canvas",N9e="png",I9e="svg",M9e="none",$dn={Canvas:D9e,PNG:N9e,SVG:I9e,None:M9e},F$={};F$[D9e]=F$[N9e]={renderer:m6,headless:m6,handler:ble};F$[I9e]={renderer:kle,headless:Ele,handler:xle};F$[M9e]={};function Cdn(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(F$[e]=t,this):F$[e]}function _dn(e,t,n){const r=[],i=new fl().union(t),s=e.marktype;return s?F9e(e,i,n,r):s==="group"?O9e(e,i,n,r):ph("Intersect scene must be mark node or group item.")}function F9e(e,t,n,r){if(Sdn(e,t,n)){const i=e.items,s=e.marktype,a=i.length;let o=0;if(s==="group")for(;o<a;++o)O9e(i[o],t,n,r);else for(const l=of[s].isect;o<a;++o){const u=i[o];R9e(u,t,l)&&r.push(u)}}return r}function Sdn(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function O9e(e,t,n,r){n&&n(e.mark)&&R9e(e,t,of.group.isect)&&r.push(e);const i=e.items,s=i&&i.length;if(s){const a=e.x||0,o=e.y||0;t.translate(-a,-o);for(let l=0;l<s;++l)F9e(i[l],t,n,r);t.translate(a,o)}return r}function R9e(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const Aq=new fl;function kdn(e){const t=e.clip;if(Q9(t))t(RM(Aq.clear()));else if(t)Aq.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(Aq)}const Edn=1e-9;function Ale(e,t,n){return e===t?!0:n==="path"?P9e(e,t):e instanceof Date&&t instanceof Date?+e==+t:Xbe(e)&&Xbe(t)?Math.abs(e-t)<=Edn:!e||!t||!HL(e)&&!HL(t)?e==t:Adn(e,t)}function P9e(e,t){return Ale(V3(e),V3(t))}function Adn(e,t){var n=Object.keys(e),r=Object.keys(t),i,s;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),s=n.length-1;s>=0;s--)if(n[s]!=r[s])return!1;for(s=n.length-1;s>=0;s--)if(i=n[s],!Ale(e[i],t[i],i))return!1;return typeof e==typeof t}function Tdn(){X7e(),Jcn()}function oS(e,t,n){return e.fields=t||[],e.fname=n,e}function Ddn(e){return e.length===1?Ndn(e[0]):Idn(e)}const Ndn=e=>function(t){return t[e]},Idn=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Tq(e){throw Error(e)}function Mdn(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||Tq("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&Tq("Access path missing closing bracket: "+e),r&&Tq("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function Fdn(e,t,n){const r=Mdn(e);return e=r.length===1?r[0]:e,oS((n&&n.get||Ddn)(r),[e],t||e)}Fdn("id");oS(e=>e,[],"identity");oS(()=>0,[],"zero");oS(()=>1,[],"one");oS(()=>!0,[],"true");oS(()=>!1,[],"false");var Odn=Array.isArray;function L9e(e){return e[e.length-1]}function Rdn(e){return e==null||e===""?null:+e}function Pdn(e){return e!=null?Odn(e)?e:[e]:[]}const Ldn=Object.prototype.hasOwnProperty;function Bdn(e,t){return Ldn.call(e,t)}function zdn(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function dd(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function av(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const p2e=Symbol("implicit");function Tle(){var e=new Map,t=[],n=[],r=p2e;function i(s){var a=s+"",o=e.get(a);if(!o){if(r!==p2e)return r;e.set(a,o=t.push(s))}return n[(o-1)%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new Map;for(const a of s){const o=a+"";e.has(o)||e.set(o,t.push(a))}return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return Tle(t,n).unknown(r)},dd.apply(i,arguments),i}function Udn(e){return function(){return e}}function uQ(e){return+e}var g2e=[0,1];function Zo(e){return e}function cQ(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Udn(isNaN(t)?NaN:.5)}function Wdn(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Vdn(e,t,n){var r=e[0],i=e[1],s=t[0],a=t[1];return i<r?(r=cQ(i,r),s=n(a,s)):(r=cQ(r,i),s=n(s,a)),function(o){return s(r(o))}}function jdn(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=cQ(e[a],e[a+1]),s[a]=n(t[a],t[a+1]);return function(o){var l=nM(e,o,1,r)-1;return s[l](i[l](o))}}function zM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function _U(){var e=g2e,t=g2e,n=nv,r,i,s,a=Zo,o,l,u;function c(){var h=Math.min(e.length,t.length);return a!==Zo&&(a=Wdn(e[0],e[h-1])),o=h>2?jdn:Vdn,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?s:(l||(l=o(e.map(r),t,n)))(r(a(h)))}return f.invert=function(h){return a(i((u||(u=o(t,e.map(r),xc)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,uQ),c()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),n=yM,c()},f.clamp=function(h){return arguments.length?(a=h?!0:Zo,c()):a!==Zo},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,d){return r=h,i=d,c()}}function B9e(){return _U()(Zo,Zo)}function Hdn(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function y6(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function O$(e){return e=y6(Math.abs(e)),e?e[1]:NaN}function qdn(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function Gdn(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Ydn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function R$(e){if(!(t=Ydn.exec(e)))throw new Error("invalid format: "+e);var t;return new Dle({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}R$.prototype=Dle.prototype;function Dle(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Dle.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Xdn(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var z9e;function Kdn(e,t){var n=y6(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(z9e=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+y6(e,Math.max(0,t+s-1))[0]}function m2e(e,t){var n=y6(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const v2e={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Hdn,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>m2e(e*100,t),r:m2e,s:Kdn,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function y2e(e){return e}var b2e=Array.prototype.map,x2e=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function U9e(e){var t=e.grouping===void 0||e.thousands===void 0?y2e:qdn(b2e.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?y2e:Gdn(b2e.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=R$(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):v2e[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var C=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=g==="$"?r:/[%p]/.test(w)?a:"",_=v2e[w],k=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(S){var N=C,A=$,D,T,I;if(w==="c")A=_(S)+A,S="";else{S=+S;var F=S<0||1/S<0;if(S=isNaN(S)?l:_(Math.abs(S),b),x&&(S=Xdn(S)),F&&+S==0&&p!=="+"&&(F=!1),N=(F?p==="("?p:o:p==="-"||p==="("?"":p)+N,A=(w==="s"?x2e[8+z9e/3]:"")+A+(F&&p==="("?")":""),k){for(D=-1,T=S.length;++D<T;)if(I=S.charCodeAt(D),48>I||I>57){A=(I===46?i+S.slice(D+1):S.slice(D))+A,S=S.slice(0,D);break}}}y&&!m&&(S=t(S,1/0));var R=N.length+S.length+A.length,P=R<v?new Array(v-R+1).join(h):"";switch(y&&m&&(S=t(P+S,P.length?v-A.length:1/0),P=""),d){case"<":S=N+S+A+P;break;case"=":S=N+P+S+A;break;case"^":S=P.slice(0,R=P.length>>1)+N+S+A+P.slice(R);break;default:S=P+N+S+A;break}return s(S)}return E.toString=function(){return f+""},E}function c(f,h){var d=u((f=R$(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(O$(h)/3)))*3,g=Math.pow(10,-p),m=x2e[8+p/3];return function(v){return d(g*v)+m}}return{format:u,formatPrefix:c}}var vR,SU,Nle;Zdn({thousands:",",grouping:[3],currency:["$",""]});function Zdn(e){return vR=U9e(e),SU=vR.format,Nle=vR.formatPrefix,vR}function W9e(e){return Math.max(0,-O$(Math.abs(e)))}function V9e(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(O$(t)/3)))*3-O$(Math.abs(e)))}function j9e(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,O$(t)-O$(e))+1}function H9e(e,t,n,r){var i=J0(e,t,n),s;switch(r=R$(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=V9e(i,a))&&(r.precision=s),Nle(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=j9e(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=W9e(i))&&(r.precision=s-(r.type==="%")*2);break}}return SU(r)}function xx(e){var t=e.domain;return e.ticks=function(n){var r=t();return RX(r[0],r[r.length-1],n==null?10:n)},e.tickFormat=function(n,r){var i=t();return H9e(i[0],i[i.length-1],n==null?10:n,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,a=r[i],o=r[s],l,u,c=10;for(o<a&&(u=a,a=o,o=u,u=i,i=s,s=u);c-- >0;){if(u=FRe(a,o,n),u===l)return r[i]=a,r[s]=o,t(r);if(u>0)a=Math.floor(a/u)*u,o=Math.ceil(o/u)*u;else if(u<0)a=Math.ceil(a*u)/u,o=Math.floor(o*u)/u;else break;l=u}return e},e}function q9e(){var e=B9e();return e.copy=function(){return zM(e,q9e())},dd.apply(e,arguments),xx(e)}function G9e(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,uQ),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return G9e(e).unknown(t)},e=arguments.length?Array.from(e,uQ):[0,1],xx(n)}function Y9e(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),e[n]=t.floor(i),e[r]=t.ceil(s),e}function w2e(e){return Math.log(e)}function $2e(e){return Math.exp(e)}function Qdn(e){return-Math.log(-e)}function Jdn(e){return-Math.exp(-e)}function epn(e){return isFinite(e)?+("1e"+e):e<0?0:e}function tpn(e){return e===10?epn:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function npn(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function C2e(e){return function(t){return-e(-t)}}function Ile(e){var t=e(w2e,$2e),n=t.domain,r=10,i,s;function a(){return i=npn(r),s=tpn(r),n()[0]<0?(i=C2e(i),s=C2e(s),e(Qdn,Jdn)):e(w2e,$2e),t}return t.base=function(o){return arguments.length?(r=+o,a()):r},t.domain=function(o){return arguments.length?(n(o),a()):n()},t.ticks=function(o){var l=n(),u=l[0],c=l[l.length-1],f;(f=c<u)&&(h=u,u=c,c=h);var h=i(u),d=i(c),p,g,m,v=o==null?10:+o,y=[];if(!(r%1)&&d-h<v){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(g=1,p=s(h);g<r;++g)if(m=p*g,!(m<u)){if(m>c)break;y.push(m)}}else for(;h<=d;++h)for(g=r-1,p=s(h);g>=1;--g)if(m=p*g,!(m<u)){if(m>c)break;y.push(m)}y.length*2<v&&(y=RX(u,c,v))}else y=RX(h,d,Math.min(d-h,v)).map(s);return f?y.reverse():y},t.tickFormat=function(o,l){if(l==null&&(l=r===10?".0e":","),typeof l!="function"&&(l=SU(l)),o===1/0)return l;o==null&&(o=10);var u=Math.max(1,r*o/t.ticks().length);return function(c){var f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=function(){return n(Y9e(n(),{floor:function(o){return s(Math.floor(i(o)))},ceil:function(o){return s(Math.ceil(i(o)))}}))},t}function X9e(){var e=Ile(_U()).domain([1,10]);return e.copy=function(){return zM(e,X9e()).base(e.base())},dd.apply(e,arguments),e}function _2e(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function S2e(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Mle(e){var t=1,n=e(_2e(t),S2e(t));return n.constant=function(r){return arguments.length?e(_2e(t=+r),S2e(t)):t},xx(n)}function K9e(){var e=Mle(_U());return e.copy=function(){return zM(e,K9e()).constant(e.constant())},dd.apply(e,arguments)}function k2e(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function rpn(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ipn(e){return e<0?-e*e:e*e}function Fle(e){var t=e(Zo,Zo),n=1;function r(){return n===1?e(Zo,Zo):n===.5?e(rpn,ipn):e(k2e(n),k2e(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},xx(t)}function Ole(){var e=Fle(_U());return e.copy=function(){return zM(e,Ole()).exponent(e.exponent())},dd.apply(e,arguments),e}function spn(){return Ole.apply(null,arguments).exponent(.5)}function Z9e(){var e=[],t=[],n=[],r;function i(){var a=0,o=Math.max(1,t.length);for(n=new Array(o-1);++a<o;)n[a-1]=RRe(e,a/o);return s}function s(a){return a==null||isNaN(a=+a)?r:t[nM(n,a)]}return s.invertExtent=function(a){var o=t.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},s.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let o of a)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(V_),i()},s.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return Z9e().domain(e).range(t).unknown(r)},dd.apply(s,arguments)}function Q9e(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function a(l){return l!=null&&l<=l?i[nM(r,l,0,n)]:s}function o(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return a}return a.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},a.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,o()):i.slice()},a.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},a.unknown=function(l){return arguments.length&&(s=l),a},a.thresholds=function(){return r.slice()},a.copy=function(){return Q9e().domain([e,t]).range(i).unknown(s)},dd.apply(xx(a),arguments)}function J9e(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[nM(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var a=t.indexOf(s);return[e[a-1],e[a]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return J9e().domain(e).range(t).unknown(n)},dd.apply(i,arguments)}function Dq(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Nq(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Mk(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function eUe(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=Fk(i),c=Ok(i),f=Fk(s),h=Ok(s),d=Fk(a),p=Ok(a),g=Fk(o),m=Ok(o),v=Fk(l),y=Ok(l),b={a:F,A:R,b:P,B:V,c:null,d:I2e,e:I2e,f:Apn,g:Lpn,G:zpn,H:Spn,I:kpn,j:Epn,L:tUe,m:Tpn,M:Dpn,p:z,q,Q:O2e,s:R2e,S:Npn,u:Ipn,U:Mpn,V:Fpn,w:Opn,W:Rpn,x:null,X:null,y:Ppn,Y:Bpn,Z:Upn,"%":F2e},x={a:G,A:K,b:Y,B:te,c:null,d:M2e,e:M2e,f:Hpn,g:tgn,G:rgn,H:Wpn,I:Vpn,j:jpn,L:rUe,m:qpn,M:Gpn,p:Z,q:ae,Q:O2e,s:R2e,S:Ypn,u:Xpn,U:Kpn,V:Zpn,w:Qpn,W:Jpn,x:null,X:null,y:egn,Y:ngn,Z:ign,"%":F2e},w={a:E,A:S,b:N,B:A,c:D,d:D2e,e:D2e,f:wpn,g:T2e,G:A2e,H:N2e,I:N2e,j:vpn,L:xpn,m:mpn,M:ypn,p:k,q:gpn,Q:Cpn,s:_pn,S:bpn,u:cpn,U:fpn,V:hpn,w:upn,W:dpn,x:T,X:I,y:T2e,Y:A2e,Z:ppn,"%":$pn};b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x);function C(O,L){return function(W){var M=[],ue=-1,X=0,se=O.length,oe,pe,Ce;for(W instanceof Date||(W=new Date(+W));++ue<se;)O.charCodeAt(ue)===37&&(M.push(O.slice(X,ue)),(pe=E2e[oe=O.charAt(++ue)])!=null?oe=O.charAt(++ue):pe=oe==="e"?" ":"0",(Ce=L[oe])&&(oe=Ce(W,pe)),M.push(oe),X=ue+1);return M.push(O.slice(X,ue)),M.join("")}}function $(O,L){return function(W){var M=Mk(1900,void 0,1),ue=_(M,O,W+="",0),X,se;if(ue!=W.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(L&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(X=Nq(Mk(M.y,0,1)),se=X.getUTCDay(),X=se>4||se===0?zL.ceil(X):zL(X),X=C0.offset(X,(M.V-1)*7),M.y=X.getUTCFullYear(),M.m=X.getUTCMonth(),M.d=X.getUTCDate()+(M.w+6)%7):(X=Dq(Mk(M.y,0,1)),se=X.getDay(),X=se>4||se===0?LL.ceil(X):LL(X),X=$0.offset(X,(M.V-1)*7),M.y=X.getFullYear(),M.m=X.getMonth(),M.d=X.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),se="Z"in M?Nq(Mk(M.y,0,1)).getUTCDay():Dq(Mk(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(se+5)%7:M.w+M.U*7-(se+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,Nq(M)):Dq(M)}}function _(O,L,W,M){for(var ue=0,X=L.length,se=W.length,oe,pe;ue<X;){if(M>=se)return-1;if(oe=L.charCodeAt(ue++),oe===37){if(oe=L.charAt(ue++),pe=w[oe in E2e?L.charAt(ue++):oe],!pe||(M=pe(O,W,M))<0)return-1}else if(oe!=W.charCodeAt(M++))return-1}return M}function k(O,L,W){var M=u.exec(L.slice(W));return M?(O.p=c.get(M[0].toLowerCase()),W+M[0].length):-1}function E(O,L,W){var M=d.exec(L.slice(W));return M?(O.w=p.get(M[0].toLowerCase()),W+M[0].length):-1}function S(O,L,W){var M=f.exec(L.slice(W));return M?(O.w=h.get(M[0].toLowerCase()),W+M[0].length):-1}function N(O,L,W){var M=v.exec(L.slice(W));return M?(O.m=y.get(M[0].toLowerCase()),W+M[0].length):-1}function A(O,L,W){var M=g.exec(L.slice(W));return M?(O.m=m.get(M[0].toLowerCase()),W+M[0].length):-1}function D(O,L,W){return _(O,t,L,W)}function T(O,L,W){return _(O,n,L,W)}function I(O,L,W){return _(O,r,L,W)}function F(O){return a[O.getDay()]}function R(O){return s[O.getDay()]}function P(O){return l[O.getMonth()]}function V(O){return o[O.getMonth()]}function z(O){return i[+(O.getHours()>=12)]}function q(O){return 1+~~(O.getMonth()/3)}function G(O){return a[O.getUTCDay()]}function K(O){return s[O.getUTCDay()]}function Y(O){return l[O.getUTCMonth()]}function te(O){return o[O.getUTCMonth()]}function Z(O){return i[+(O.getUTCHours()>=12)]}function ae(O){return 1+~~(O.getUTCMonth()/3)}return{format:function(O){var L=C(O+="",b);return L.toString=function(){return O},L},parse:function(O){var L=$(O+="",!1);return L.toString=function(){return O},L},utcFormat:function(O){var L=C(O+="",x);return L.toString=function(){return O},L},utcParse:function(O){var L=$(O+="",!0);return L.toString=function(){return O},L}}}var E2e={"-":"",_:" ",0:"0"},Ss=/^\s*\d+/,apn=/^%/,opn=/[\\^$*+?|[\]().{}]/g;function kn(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function lpn(e){return e.replace(opn,"\\$&")}function Fk(e){return new RegExp("^(?:"+e.map(lpn).join("|")+")","i")}function Ok(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function upn(e,t,n){var r=Ss.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function cpn(e,t,n){var r=Ss.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function fpn(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function hpn(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function dpn(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function A2e(e,t,n){var r=Ss.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function T2e(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function ppn(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function gpn(e,t,n){var r=Ss.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function mpn(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function D2e(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function vpn(e,t,n){var r=Ss.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function N2e(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function ypn(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function bpn(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function xpn(e,t,n){var r=Ss.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function wpn(e,t,n){var r=Ss.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function $pn(e,t,n){var r=apn.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Cpn(e,t,n){var r=Ss.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function _pn(e,t,n){var r=Ss.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function I2e(e,t){return kn(e.getDate(),t,2)}function Spn(e,t){return kn(e.getHours(),t,2)}function kpn(e,t){return kn(e.getHours()%12||12,t,2)}function Epn(e,t){return kn(1+$0.count(am(e),e),t,3)}function tUe(e,t){return kn(e.getMilliseconds(),t,3)}function Apn(e,t){return tUe(e,t)+"000"}function Tpn(e,t){return kn(e.getMonth()+1,t,2)}function Dpn(e,t){return kn(e.getMinutes(),t,2)}function Npn(e,t){return kn(e.getSeconds(),t,2)}function Ipn(e){var t=e.getDay();return t===0?7:t}function Mpn(e,t){return kn(J_.count(am(e)-1,e),t,2)}function nUe(e){var t=e.getDay();return t>=4||t===0?x$(e):x$.ceil(e)}function Fpn(e,t){return e=nUe(e),kn(x$.count(am(e),e)+(am(e).getDay()===4),t,2)}function Opn(e){return e.getDay()}function Rpn(e,t){return kn(LL.count(am(e)-1,e),t,2)}function Ppn(e,t){return kn(e.getFullYear()%100,t,2)}function Lpn(e,t){return e=nUe(e),kn(e.getFullYear()%100,t,2)}function Bpn(e,t){return kn(e.getFullYear()%1e4,t,4)}function zpn(e,t){var n=e.getDay();return e=n>=4||n===0?x$(e):x$.ceil(e),kn(e.getFullYear()%1e4,t,4)}function Upn(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+kn(t/60|0,"0",2)+kn(t%60,"0",2)}function M2e(e,t){return kn(e.getUTCDate(),t,2)}function Wpn(e,t){return kn(e.getUTCHours(),t,2)}function Vpn(e,t){return kn(e.getUTCHours()%12||12,t,2)}function jpn(e,t){return kn(1+C0.count(om(e),e),t,3)}function rUe(e,t){return kn(e.getUTCMilliseconds(),t,3)}function Hpn(e,t){return rUe(e,t)+"000"}function qpn(e,t){return kn(e.getUTCMonth()+1,t,2)}function Gpn(e,t){return kn(e.getUTCMinutes(),t,2)}function Ypn(e,t){return kn(e.getUTCSeconds(),t,2)}function Xpn(e){var t=e.getUTCDay();return t===0?7:t}function Kpn(e,t){return kn(eS.count(om(e)-1,e),t,2)}function iUe(e){var t=e.getUTCDay();return t>=4||t===0?w$(e):w$.ceil(e)}function Zpn(e,t){return e=iUe(e),kn(w$.count(om(e),e)+(om(e).getUTCDay()===4),t,2)}function Qpn(e){return e.getUTCDay()}function Jpn(e,t){return kn(zL.count(om(e)-1,e),t,2)}function egn(e,t){return kn(e.getUTCFullYear()%100,t,2)}function tgn(e,t){return e=iUe(e),kn(e.getUTCFullYear()%100,t,2)}function ngn(e,t){return kn(e.getUTCFullYear()%1e4,t,4)}function rgn(e,t){var n=e.getUTCDay();return e=n>=4||n===0?w$(e):w$.ceil(e),kn(e.getUTCFullYear()%1e4,t,4)}function ign(){return"+0000"}function F2e(){return"%"}function O2e(e){return+e}function R2e(e){return Math.floor(+e/1e3)}var g2,Rle,sUe,Ple,aUe;sgn({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function sgn(e){return g2=eUe(e),Rle=g2.format,sUe=g2.parse,Ple=g2.utcFormat,aUe=g2.utcParse,g2}function agn(e){return new Date(e)}function ogn(e){return e instanceof Date?+e:+new Date(+e)}function Lle(e,t,n,r,i,s,a,o,l,u){var c=B9e(),f=c.invert,h=c.domain,d=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),x=u("%Y");function w(C){return(l(C)<C?d:o(C)<C?p:a(C)<C?g:s(C)<C?m:r(C)<C?i(C)<C?v:y:n(C)<C?b:x)(C)}return c.invert=function(C){return new Date(f(C))},c.domain=function(C){return arguments.length?h(Array.from(C,ogn)):h().map(agn)},c.ticks=function(C){var $=h();return e($[0],$[$.length-1],C==null?10:C)},c.tickFormat=function(C,$){return $==null?w:u($)},c.nice=function(C){var $=h();return(!C||typeof C.range!="function")&&(C=t($[0],$[$.length-1],C==null?10:C)),C?h(Y9e($,C)):c},c.copy=function(){return zM(c,Lle(e,t,n,r,i,s,a,o,l,u))},c}function lgn(){return dd.apply(Lle(Orn,Rrn,am,BL,J_,$0,Kae,Xae,s0,Rle).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ugn(){return dd.apply(Lle(Mrn,Frn,om,UL,eS,C0,Jae,Qae,s0,Ple).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function kU(){var e=0,t=1,n,r,i,s,a=Zo,o=!1,l;function u(f){return f==null||isNaN(f=+f)?l:a(i===0?.5:(f=(s(f)-n)*i,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(a=f,u):a};function c(f){return function(h){var d,p;return arguments.length?([d,p]=h,a=f(d,p),u):[a(0),a(1)]}}return u.range=c(nv),u.rangeRound=c(yM),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function ov(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Ble(){var e=xx(kU()(Zo));return e.copy=function(){return ov(e,Ble())},av.apply(e,arguments)}function oUe(){var e=Ile(kU()).domain([1,10]);return e.copy=function(){return ov(e,oUe()).base(e.base())},av.apply(e,arguments)}function lUe(){var e=Mle(kU());return e.copy=function(){return ov(e,lUe()).constant(e.constant())},av.apply(e,arguments)}function zle(){var e=Fle(kU());return e.copy=function(){return ov(e,zle()).exponent(e.exponent())},av.apply(e,arguments)}function cgn(){return zle.apply(null,arguments).exponent(.5)}function EU(){var e=0,t=.5,n=1,r=1,i,s,a,o,l,u=Zo,c,f=!1,h;function d(g){return isNaN(g=+g)?h:(g=.5+((g=+c(g))-s)*(r*g<r*s?o:l),u(f?Math.max(0,Math.min(1,g)):g))}d.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),s=c(t=+t),a=c(n=+n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d):[e,t,n]},d.clamp=function(g){return arguments.length?(f=!!g,d):f},d.interpolator=function(g){return arguments.length?(u=g,d):u};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,u=Xse(g,[v,y,b]),d):[u(0),u(.5),u(1)]}}return d.range=p(nv),d.rangeRound=p(yM),d.unknown=function(g){return arguments.length?(h=g,d):h},function(g){return c=g,i=g(e),s=g(t),a=g(n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d}}function uUe(){var e=xx(EU()(Zo));return e.copy=function(){return ov(e,uUe())},av.apply(e,arguments)}function cUe(){var e=Ile(EU()).domain([.1,1,10]);return e.copy=function(){return ov(e,cUe()).base(e.base())},av.apply(e,arguments)}function fUe(){var e=Mle(EU());return e.copy=function(){return ov(e,fUe()).constant(e.constant())},av.apply(e,arguments)}function Ule(){var e=Fle(EU());return e.copy=function(){return ov(e,Ule()).exponent(e.exponent())},av.apply(e,arguments)}function fgn(){return Ule.apply(null,arguments).exponent(.5)}const Iq=new Date,Mq=new Date;function ji(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>ji(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(Iq.setTime(+s),Mq.setTime(+a),e(Iq),e(Mq),Math.floor(n(Iq,Mq))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const G3=ji(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);G3.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ji(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):G3);G3.range;const Y3=1e3,vm=Y3*60,X3=vm*60,K3=X3*24,hUe=K3*7,Wle=ji(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Y3)},(e,t)=>(t-e)/Y3,e=>e.getUTCSeconds());Wle.range;const dUe=ji(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Y3)},(e,t)=>{e.setTime(+e+t*vm)},(e,t)=>(t-e)/vm,e=>e.getMinutes());dUe.range;const pUe=ji(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*vm)},(e,t)=>(t-e)/vm,e=>e.getUTCMinutes());pUe.range;const gUe=ji(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Y3-e.getMinutes()*vm)},(e,t)=>{e.setTime(+e+t*X3)},(e,t)=>(t-e)/X3,e=>e.getHours());gUe.range;const mUe=ji(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*X3)},(e,t)=>(t-e)/X3,e=>e.getUTCHours());mUe.range;const I4=ji(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*vm)/K3,e=>e.getDate()-1);I4.range;const M4=ji(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/K3,e=>e.getUTCDate()-1);M4.range;const hgn=ji(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/K3,e=>Math.floor(e/K3));hgn.range;function wx(e){return ji(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*vm)/hUe)}const vUe=wx(0),dgn=wx(1),pgn=wx(2),ggn=wx(3),mgn=wx(4),vgn=wx(5),ygn=wx(6);vUe.range;dgn.range;pgn.range;ggn.range;mgn.range;vgn.range;ygn.range;function $x(e){return ji(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/hUe)}const yUe=$x(0),bgn=$x(1),xgn=$x(2),wgn=$x(3),$gn=$x(4),Cgn=$x(5),_gn=$x(6);yUe.range;bgn.range;xgn.range;wgn.range;$gn.range;Cgn.range;_gn.range;const fQ=ji(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());fQ.range;const hQ=ji(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());hQ.range;const Vle=ji(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Vle.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ji(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Vle.range;const jle=ji(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());jle.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ji(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});jle.range;const Hle="year",qle="quarter",Gle="month",Yle="week",Xle="date",Kle="day",Zle="dayofyear",Qle="hours",Jle="minutes",eue="seconds",tue="milliseconds",Sgn=[Hle,qle,Gle,Yle,Xle,Kle,Zle,Qle,Jle,eue,tue];Sgn.reduce((e,t,n)=>(e[t]=1+n,e),{});Hle+"",qle+"",fQ.every(3),Gle+"",Yle+"",Xle+"",Kle+"",Zle+"",Qle+"",Jle+"",eue+"",tue+"";Hle+"",qle+"",hQ.every(3),Gle+"",Yle+"",Xle+"",Kle+"",Zle+"",Qle+"",Jle+"",eue+"",tue+"";function kgn(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const Egn="identity",nue="linear",P$="log",rue="pow",iue="sqrt",sue="symlog",Agn="time",Tgn="utc",lS="sequential",UM="diverging",P2e="quantile",Dgn="quantize",Ngn="threshold",Ign="ordinal",Mgn="point",Fgn="band",Ogn="bin-ordinal",ks="continuous",AU="discrete",TU="discretizing",mf="interpolating",bUe="temporal";function Rgn(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function Pgn(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,a,o,l,u;for(i<r&&(o=r,r=i,i=o),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(s<0&&(s=l),a=l);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[a]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function aue(){const e=Tle().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,a=!1,o=0,l=0,u=.5;delete e.unknown;function c(){const f=t().length,h=r[1]<r[0],d=r[1-h],p=kgn(f,o,l);let g=r[h-0];i=(d-g)/(p||1),a&&(i=Math.floor(i)),g+=(d-g-i*(f-o))*u,s=i*(1-o),a&&(g=Math.round(g),s=Math.round(s));const m=Ml(f).map(v=>g+i*v);return n(h?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),o=l,c()):o},e.paddingInner=function(f){return arguments.length?(o=Math.max(0,Math.min(1,f)),c()):o},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const h=r[1]<r[0],d=h?n().reverse():n(),p=d.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<d[0]||g>r[1-h])))return v=Math.max(0,fP(d,g)-1),y=g===m?v:fP(d,m)-1,g-d[v]>s+1e-10&&++v,h&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const h=e.invertRange([f,f]);return h&&h[0]},e.copy=function(){return aue().domain(t()).range(r).round(a).paddingInner(o).paddingOuter(l).align(u)},c()}function xUe(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return xUe(t())},e}function Lgn(){return xUe(aue().paddingInner(1))}var Bgn=Array.prototype.map;function zgn(e){return Bgn.call(e,Rdn)}const Ugn=Array.prototype.slice;function wUe(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(nM(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=zgn(r),n):e.slice()},n.range=function(r){return arguments.length?(t=Ugn.call(r),n):t.slice()},n.tickFormat=function(r,i){return H9e(e[0],L9e(e),r==null?10:r,i)},n.copy=function(){return wUe().domain(n.domain()).range(n.range())},n}const dQ={};function Wgn(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?Rgn(s):s.invertExtent?Pgn(s):void 0),s.type=e,s};return r.metadata=zdn(Pdn(n)),r}function rr(e,t,n){return arguments.length>1?(dQ[e]=Wgn(e,t,n),this):Vgn(e)?dQ[e]:void 0}rr(Egn,G9e);rr(nue,q9e,ks);rr(P$,X9e,[ks,P$]);rr(rue,Ole,ks);rr(iue,spn,ks);rr(sue,K9e,ks);rr(Agn,lgn,[ks,bUe]);rr(Tgn,ugn,[ks,bUe]);rr(lS,Ble,[ks,mf]);rr("".concat(lS,"-").concat(nue),Ble,[ks,mf]);rr("".concat(lS,"-").concat(P$),oUe,[ks,mf,P$]);rr("".concat(lS,"-").concat(rue),zle,[ks,mf]);rr("".concat(lS,"-").concat(iue),cgn,[ks,mf]);rr("".concat(lS,"-").concat(sue),lUe,[ks,mf]);rr("".concat(UM,"-").concat(nue),uUe,[ks,mf]);rr("".concat(UM,"-").concat(P$),cUe,[ks,mf,P$]);rr("".concat(UM,"-").concat(rue),Ule,[ks,mf]);rr("".concat(UM,"-").concat(iue),fgn,[ks,mf]);rr("".concat(UM,"-").concat(sue),fUe,[ks,mf]);rr(P2e,Z9e,[TU,P2e]);rr(Dgn,Q9e,TU);rr(Ngn,J9e,TU);rr(Ogn,wUe,[AU,TU]);rr(Ign,Tle,AU);rr(Fgn,aue,AU);rr(Mgn,Lgn,AU);function Vgn(e){return Bdn(dQ,e)}function jgn(e,t){const n=t[0],r=L9e(t)-n;return function(i){return e(n+i*r)}}function $Ue(e,t,n){return Xse(CUe(t||"rgb",n),e)}function Hgn(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function CUe(e,t){const n=VXt[qgn(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function qgn(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const Ggn={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},Ygn={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function _Ue(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function SUe(e,t){for(const n in e)kUe(n,t(e[n]))}const L2e={};SUe(Ygn,_Ue);SUe(Ggn,e=>$Ue(_Ue(e)));function kUe(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(L2e[e]=t,this):L2e[e]}var Xgn=Math.abs,pQ=Math.cos,b6=Math.sin,Kgn=1e-6,EUe=Math.PI,gQ=EUe/2,B2e=Zgn(2);function z2e(e){return e>1?gQ:e<-1?-gQ:Math.asin(e)}function Zgn(e){return e>0?Math.sqrt(e):0}function Qgn(e,t){var n=e*b6(t),r=30,i;do t-=i=(t+b6(t)-n)/(1+pQ(t));while(Xgn(i)>Kgn&&--r>0);return t/2}function Jgn(e,t,n){function r(i,s){return[e*i*pQ(s=Qgn(n,s)),t*b6(s)]}return r.invert=function(i,s){return s=z2e(s/t),[i/(e*pQ(s)),z2e((2*s+b6(2*s))/n)]},r}var e0n=Jgn(B2e/gQ,B2e,EUe);function t0n(){return ld(e0n).scale(169.529)}g8e();const n0n=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function r0n(e,t){return function n(){const r=t();return r.type=e,r.path=g8e().projection(r),r.copy=r.copy||function(){const i=n();return n0n.forEach(s=>{r[s]&&i[s](r[s]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function AUe(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(x6[e]=r0n(e,t),this):x6[e]||null}const x6={albers:v8e,albersusa:YQt,azimuthalequalarea:XQt,azimuthalequidistant:KQt,conicconformal:JQt,conicequalarea:AL,conicequidistant:nJt,equalEarth:iJt,equirectangular:eJt,gnomonic:sJt,identity:aJt,mercator:ZQt,mollweide:t0n,naturalEarth1:oJt,orthographic:lJt,stereographic:uJt,transversemercator:cJt};for(const e in x6)AUe(e,x6[e]);const i0n="RawCode",ub="Literal",s0n="Property",a0n="Identifier",o0n="ArrayExpression",l0n="BinaryExpression",TUe="CallExpression",u0n="ConditionalExpression",c0n="LogicalExpression",f0n="MemberExpression",h0n="ObjectExpression",d0n="UnaryExpression";function vf(e){this.type=e}vf.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=p0n(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function p0n(e){switch(e.type){case o0n:return e.elements;case l0n:case c0n:return[e.left,e.right];case TUe:return[e.callee].concat(e.arguments);case u0n:return[e.test,e.consequent,e.alternate];case f0n:return[e.object,e.property];case h0n:return e.properties;case s0n:return[e.key,e.value];case d0n:return[e.argument];case a0n:case ub:case i0n:default:return[]}}var pd,Ye,be,_a,zn,DU=1,WM=2,cb=3,lv=4,NU=5,Cx=6,Ro=7,VM=8,g0n=9;pd={};pd[DU]="Boolean";pd[WM]="<end>";pd[cb]="Identifier";pd[lv]="Keyword";pd[NU]="Null";pd[Cx]="Numeric";pd[Ro]="Punctuator";pd[VM]="String";pd[g0n]="RegularExpression";var m0n="ArrayExpression",v0n="BinaryExpression",y0n="CallExpression",b0n="ConditionalExpression",DUe="Identifier",x0n="Literal",w0n="LogicalExpression",$0n="MemberExpression",C0n="ObjectExpression",_0n="Property",S0n="UnaryExpression",as="Unexpected token %0",k0n="Unexpected number",E0n="Unexpected string",A0n="Unexpected identifier",T0n="Unexpected reserved word",D0n="Unexpected end of input",mQ="Invalid regular expression",Fq="Invalid regular expression: missing /",NUe="Octal literals are not allowed in strict mode.",N0n="Duplicate data property in object literal not allowed in strict mode",Ps="ILLEGAL",Z3="Disabled.",I0n=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),M0n=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function IU(e,t){if(!e)throw new Error("ASSERT: "+t)}function Wd(e){return e>=48&&e<=57}function oue(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function DA(e){return"01234567".indexOf(e)>=0}function F0n(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Q3(e){return e===10||e===13||e===8232||e===8233}function jM(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&I0n.test(String.fromCharCode(e))}function w6(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&M0n.test(String.fromCharCode(e))}const O0n={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function IUe(){for(;be<_a;){const e=Ye.charCodeAt(be);if(F0n(e)||Q3(e))++be;else break}}function vQ(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)be<_a&&oue(Ye[be])?(r=Ye[be++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):bn({},as,Ps);return String.fromCharCode(i)}function R0n(){var e,t,n,r;for(e=Ye[be],t=0,e==="}"&&bn({},as,Ps);be<_a&&(e=Ye[be++],!!oue(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&bn({},as,Ps),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function MUe(){var e,t;for(e=Ye.charCodeAt(be++),t=String.fromCharCode(e),e===92&&(Ye.charCodeAt(be)!==117&&bn({},as,Ps),++be,e=vQ("u"),(!e||e==="\\"||!jM(e.charCodeAt(0)))&&bn({},as,Ps),t=e);be<_a&&(e=Ye.charCodeAt(be),!!w6(e));)++be,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Ye.charCodeAt(be)!==117&&bn({},as,Ps),++be,e=vQ("u"),(!e||e==="\\"||!w6(e.charCodeAt(0)))&&bn({},as,Ps),t+=e);return t}function P0n(){var e,t;for(e=be++;be<_a;){if(t=Ye.charCodeAt(be),t===92)return be=e,MUe();if(w6(t))++be;else break}return Ye.slice(e,be)}function L0n(){var e,t,n;return e=be,t=Ye.charCodeAt(be)===92?MUe():P0n(),t.length===1?n=cb:O0n.hasOwnProperty(t)?n=lv:t==="null"?n=NU:t==="true"||t==="false"?n=DU:n=cb,{type:n,value:t,start:e,end:be}}function Oq(){var e=be,t=Ye.charCodeAt(be),n,r=Ye[be],i,s,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++be,{type:Ro,value:String.fromCharCode(t),start:e,end:be};default:if(n=Ye.charCodeAt(be+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return be+=2,{type:Ro,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:be};case 33:case 61:return be+=2,Ye.charCodeAt(be)===61&&++be,{type:Ro,value:Ye.slice(e,be),start:e,end:be}}}if(a=Ye.substr(be,4),a===">>>=")return be+=4,{type:Ro,value:a,start:e,end:be};if(s=a.substr(0,3),s===">>>"||s==="<<="||s===">>=")return be+=3,{type:Ro,value:s,start:e,end:be};if(i=s.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return be+=2,{type:Ro,value:i,start:e,end:be};if(i==="//"&&bn({},as,Ps),"<>=!+-*%&|^/".indexOf(r)>=0)return++be,{type:Ro,value:r,start:e,end:be};bn({},as,Ps)}function B0n(e){let t="";for(;be<_a&&oue(Ye[be]);)t+=Ye[be++];return t.length===0&&bn({},as,Ps),jM(Ye.charCodeAt(be))&&bn({},as,Ps),{type:Cx,value:parseInt("0x"+t,16),start:e,end:be}}function z0n(e){let t="0"+Ye[be++];for(;be<_a&&DA(Ye[be]);)t+=Ye[be++];return(jM(Ye.charCodeAt(be))||Wd(Ye.charCodeAt(be)))&&bn({},as,Ps),{type:Cx,value:parseInt(t,8),octal:!0,start:e,end:be}}function U2e(){var e,t,n;if(n=Ye[be],IU(Wd(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=be,e="",n!=="."){if(e=Ye[be++],n=Ye[be],e==="0"){if(n==="x"||n==="X")return++be,B0n(t);if(DA(n))return z0n(t);n&&Wd(n.charCodeAt(0))&&bn({},as,Ps)}for(;Wd(Ye.charCodeAt(be));)e+=Ye[be++];n=Ye[be]}if(n==="."){for(e+=Ye[be++];Wd(Ye.charCodeAt(be));)e+=Ye[be++];n=Ye[be]}if(n==="e"||n==="E")if(e+=Ye[be++],n=Ye[be],(n==="+"||n==="-")&&(e+=Ye[be++]),Wd(Ye.charCodeAt(be)))for(;Wd(Ye.charCodeAt(be));)e+=Ye[be++];else bn({},as,Ps);return jM(Ye.charCodeAt(be))&&bn({},as,Ps),{type:Cx,value:parseFloat(e),start:t,end:be}}function U0n(){var e="",t,n,r,i,s=!1;for(t=Ye[be],IU(t==="'"||t==='"',"String literal must starts with a quote"),n=be,++be;be<_a;)if(r=Ye[be++],r===t){t="";break}else if(r==="\\")if(r=Ye[be++],!r||!Q3(r.charCodeAt(0)))switch(r){case"u":case"x":Ye[be]==="{"?(++be,e+=R0n()):e+=vQ(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:DA(r)?(i="01234567".indexOf(r),i!==0&&(s=!0),be<_a&&DA(Ye[be])&&(s=!0,i=i*8+"01234567".indexOf(Ye[be++]),"0123".indexOf(r)>=0&&be<_a&&DA(Ye[be])&&(i=i*8+"01234567".indexOf(Ye[be++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&Ye[be]===`
`&&++be;else{if(Q3(r.charCodeAt(0)))break;e+=r}return t!==""&&bn({},as,Ps),{type:VM,value:e,octal:s,start:n,end:be}}function W0n(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";bn({},mQ)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{bn({},mQ)}try{return new RegExp(e,t)}catch{return null}}function V0n(){var e,t,n,r,i;for(e=Ye[be],IU(e==="/","Regular expression literal must start with a slash"),t=Ye[be++],n=!1,r=!1;be<_a;)if(e=Ye[be++],t+=e,e==="\\")e=Ye[be++],Q3(e.charCodeAt(0))&&bn({},Fq),t+=e;else if(Q3(e.charCodeAt(0)))bn({},Fq);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||bn({},Fq),i=t.substr(1,t.length-2),{value:i,literal:t}}function j0n(){var e,t,n;for(t="",n="";be<_a&&(e=Ye[be],!!w6(e.charCodeAt(0)));)++be,e==="\\"&&be<_a?bn({},as,Ps):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&bn({},mQ,n),{value:n,literal:t}}function H0n(){var e,t,n,r;return zn=null,IUe(),e=be,t=V0n(),n=j0n(),r=W0n(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:be}}function q0n(e){return e.type===cb||e.type===lv||e.type===DU||e.type===NU}function FUe(){if(IUe(),be>=_a)return{type:WM,start:be,end:be};const e=Ye.charCodeAt(be);return jM(e)?L0n():e===40||e===41||e===59?Oq():e===39||e===34?U0n():e===46?Wd(Ye.charCodeAt(be+1))?U2e():Oq():Wd(e)?U2e():Oq()}function jo(){const e=zn;return be=e.end,zn=FUe(),be=e.end,e}function OUe(){const e=be;zn=FUe(),be=e}function G0n(e){const t=new vf(m0n);return t.elements=e,t}function W2e(e,t,n){const r=new vf(e==="||"||e==="&&"?w0n:v0n);return r.operator=e,r.left=t,r.right=n,r}function Y0n(e,t){const n=new vf(y0n);return n.callee=e,n.arguments=t,n}function X0n(e,t,n){const r=new vf(b0n);return r.test=e,r.consequent=t,r.alternate=n,r}function lue(e){const t=new vf(DUe);return t.name=e,t}function qE(e){const t=new vf(x0n);return t.value=e.value,t.raw=Ye.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function V2e(e,t,n){const r=new vf($0n);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function K0n(e){const t=new vf(C0n);return t.properties=e,t}function j2e(e,t,n){const r=new vf(_0n);return r.key=t,r.value=n,r.kind=e,r}function Z0n(e,t){const n=new vf(S0n);return n.operator=e,n.argument=t,n.prefix=!0,n}function bn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(s,a)=>(IU(a<r.length,"Message reference must be in range"),r[a]));throw n=new Error(i),n.index=be,n.description=i,n}function MU(e){e.type===WM&&bn(e,D0n),e.type===Cx&&bn(e,k0n),e.type===VM&&bn(e,E0n),e.type===cb&&bn(e,A0n),e.type===lv&&bn(e,T0n),bn(e,as,e.value)}function Sa(e){const t=jo();(t.type!==Ro||t.value!==e)&&MU(t)}function pr(e){return zn.type===Ro&&zn.value===e}function Rq(e){return zn.type===lv&&zn.value===e}function Q0n(){const e=[];for(be=zn.start,Sa("[");!pr("]");)pr(",")?(jo(),e.push(null)):(e.push(fb()),pr("]")||Sa(","));return jo(),G0n(e)}function H2e(){be=zn.start;const e=jo();return e.type===VM||e.type===Cx?(e.octal&&bn(e,NUe),qE(e)):lue(e.value)}function J0n(){var e,t,n,r;if(be=zn.start,e=zn,e.type===cb)return n=H2e(),Sa(":"),r=fb(),j2e("init",n,r);if(e.type===WM||e.type===Ro)MU(e);else return t=H2e(),Sa(":"),r=fb(),j2e("init",t,r)}function emn(){var e=[],t,n,r,i={},s=String;for(be=zn.start,Sa("{");!pr("}");)t=J0n(),t.key.type===DUe?n=t.key.name:n=s(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?bn({},N0n):i[r]=!0,e.push(t),pr("}")||Sa(",");return Sa("}"),K0n(e)}function tmn(){Sa("(");const e=uue();return Sa(")"),e}const nmn={if:1};function rmn(){var e,t,n;if(pr("("))return tmn();if(pr("["))return Q0n();if(pr("{"))return emn();if(e=zn.type,be=zn.start,e===cb||nmn[zn.value])n=lue(jo().value);else if(e===VM||e===Cx)zn.octal&&bn(zn,NUe),n=qE(jo());else{if(e===lv)throw new Error(Z3);e===DU?(t=jo(),t.value=t.value==="true",n=qE(t)):e===NU?(t=jo(),t.value=null,n=qE(t)):pr("/")||pr("/=")?(n=qE(H0n()),OUe()):MU(jo())}return n}function imn(){const e=[];if(Sa("("),!pr(")"))for(;be<_a&&(e.push(fb()),!pr(")"));)Sa(",");return Sa(")"),e}function smn(){be=zn.start;const e=jo();return q0n(e)||MU(e),lue(e.value)}function amn(){return Sa("."),smn()}function omn(){Sa("[");const e=uue();return Sa("]"),e}function lmn(){var e,t,n;for(e=rmn();;)if(pr("."))n=amn(),e=V2e(".",e,n);else if(pr("("))t=imn(),e=Y0n(e,t);else if(pr("["))n=omn(),e=V2e("[",e,n);else break;return e}function q2e(){const e=lmn();if(zn.type===Ro&&(pr("++")||pr("--")))throw new Error(Z3);return e}function F4(){var e,t;if(zn.type!==Ro&&zn.type!==lv)t=q2e();else{if(pr("++")||pr("--"))throw new Error(Z3);if(pr("+")||pr("-")||pr("~")||pr("!"))e=jo(),t=F4(),t=Z0n(e.value,t);else{if(Rq("delete")||Rq("void")||Rq("typeof"))throw new Error(Z3);t=q2e()}}return t}function G2e(e){let t=0;if(e.type!==Ro&&e.type!==lv)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function umn(){var e,t,n,r,i,s,a,o,l,u;if(e=zn,l=F4(),r=zn,i=G2e(r),i===0)return l;for(r.prec=i,jo(),t=[e,zn],a=F4(),s=[l,r,a];(i=G2e(zn))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)a=s.pop(),o=s.pop().value,l=s.pop(),t.pop(),n=W2e(o,l,a),s.push(n);r=jo(),r.prec=i,s.push(r),t.push(zn),n=F4(),s.push(n)}for(u=s.length-1,n=s[u],t.pop();u>1;)t.pop(),n=W2e(s[u-1].value,s[u-2],n),u-=2;return n}function fb(){var e,t,n;return e=umn(),pr("?")&&(jo(),t=fb(),Sa(":"),n=fb(),e=X0n(e,t,n)),e}function uue(){const e=fb();if(pr(","))throw new Error(Z3);return e}function cmn(e){Ye=e,be=0,_a=Ye.length,zn=null,OUe();const t=uue();if(zn.type!==WM)throw new Error("Unexpect token after expression.");return t}var RUe={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function PUe(e){function t(a,o,l,u){let c=e(o[0]);return l&&(c=l+"("+c+")",l.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(u<0?"":u===0?"()":"("+o.slice(1).map(e).join(",")+")")}function n(a,o,l){return u=>t(a,u,o,l)}const r="new Date",i="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&$e("Missing arguments to clamp function."),a.length>3&&$e("Too many arguments to clamp function.");const o=a.map(e);return"Math.max("+o[1]+", Math.min("+o[2]+","+o[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:s,test:n("test",s),if:function(a){a.length<3&&$e("Missing arguments to if function."),a.length>3&&$e("Too many arguments to if function.");const o=a.map(e);return"("+o[0]+"?"+o[1]+":"+o[2]+")"}}}function fmn(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function hmn(e){e=e||{};const t=e.allowed?Rh(e.allowed):{},n=e.forbidden?Rh(e.forbidden):{},r=e.constants||RUe,i=(e.functions||PUe)(f),s=e.globalvar,a=e.fieldvar,o=Ut(s)?s:p=>`${s}["${p}"]`;let l={},u={},c=0;function f(p){if($r(p))return p;const g=h[p.type];return g==null&&$e("Unsupported type: "+p.type),g(p)}const h={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:bt(n,g)?$e("Illegal identifier: "+g):bt(r,g)?r[g]:bt(t,g)?g:(l[g]=1,o(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const v=f(p.property);return m===a&&(u[fmn(v)]=1),g&&(c-=1),m+(g?"."+v:"["+v+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&$e("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,v=bt(i,g)&&i[g];return v||$e("Unrecognized function: "+g),Ut(v)?v(m):v+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function d(p){const g={code:f(p),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},g}return d.functions=i,d.constants=r,d}class k0{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],a=t+s,o=Math.abs(t)<Math.abs(s)?t-(a-s):s-(a-t);o&&(n[r++]=o),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,s=i-(a-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=a+i,i==r-a&&(a=r))}return a}}function dmn(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}var $6=1e-6,Y2e=1e-12,HM=Math.PI,X2e=HM/2,LUe=HM/4,K2e=HM*2,NA=180/HM,Fa=HM/180,cue=Math.abs,FU=Math.atan2,xo=Math.cos,yQ=Math.hypot,wo=Math.sin,BUe=Math.sqrt;function fue(e){return e>1?X2e:e<-1?-X2e:Math.asin(e)}function GE(){}function C6(e,t){e&&Q2e.hasOwnProperty(e.type)&&Q2e[e.type](e,t)}var Z2e={Feature:function(e,t){C6(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)C6(n[r].geometry,t)}},Q2e={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){bQ(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)bQ(n[r],t,0)},Polygon:function(e,t){J2e(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)J2e(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)C6(n[r],t)}};function bQ(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function J2e(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)bQ(e[n],t,1);t.polygonEnd()}function hue(e,t){e&&Z2e.hasOwnProperty(e.type)?Z2e[e.type](e,t):C6(e,t)}var _6=new k0,S6=new k0,zUe,UUe,xQ,wQ,$Q,Hh={point:GE,lineStart:GE,lineEnd:GE,polygonStart:function(){_6=new k0,Hh.lineStart=pmn,Hh.lineEnd=gmn},polygonEnd:function(){var e=+_6;S6.add(e<0?K2e+e:e),this.lineStart=this.lineEnd=this.point=GE},sphere:function(){S6.add(K2e)}};function pmn(){Hh.point=mmn}function gmn(){WUe(zUe,UUe)}function mmn(e,t){Hh.point=WUe,zUe=e,UUe=t,e*=Fa,t*=Fa,xQ=e,wQ=xo(t=t/2+LUe),$Q=wo(t)}function WUe(e,t){e*=Fa,t*=Fa,t=t/2+LUe;var n=e-xQ,r=n>=0?1:-1,i=r*n,s=xo(t),a=wo(t),o=$Q*a,l=wQ*s+o*xo(i),u=o*r*wo(i);_6.add(FU(u,l)),xQ=e,wQ=s,$Q=a}function vmn(e){return S6=new k0,hue(e,Hh),S6*2}function ymn(e){return[FU(e[1],e[0]),fue(e[2])]}function bmn(e){var t=e[0],n=e[1],r=xo(n);return[r*xo(t),r*wo(t),wo(n)]}function ewe(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function xmn(e){var t=BUe(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Rr,Uo,jr,Sl,e1,VUe,jUe,fw,IA,Ug,Gp,Vd={point:CQ,lineStart:twe,lineEnd:nwe,polygonStart:function(){Vd.point=qUe,Vd.lineStart=wmn,Vd.lineEnd=$mn,IA=new k0,Hh.polygonStart()},polygonEnd:function(){Hh.polygonEnd(),Vd.point=CQ,Vd.lineStart=twe,Vd.lineEnd=nwe,_6<0?(Rr=-(jr=180),Uo=-(Sl=90)):IA>$6?Sl=90:IA<-$6&&(Uo=-90),Gp[0]=Rr,Gp[1]=jr},sphere:function(){Rr=-(jr=180),Uo=-(Sl=90)}};function CQ(e,t){Ug.push(Gp=[Rr=e,jr=e]),t<Uo&&(Uo=t),t>Sl&&(Sl=t)}function HUe(e,t){var n=bmn([e*Fa,t*Fa]);if(fw){var r=ewe(fw,n),i=[r[1],-r[0],0],s=ewe(i,r);xmn(s),s=ymn(s);var a=e-e1,o=a>0?1:-1,l=s[0]*NA*o,u,c=cue(a)>180;c^(o*e1<l&&l<o*e)?(u=s[1]*NA,u>Sl&&(Sl=u)):(l=(l+360)%360-180,c^(o*e1<l&&l<o*e)?(u=-s[1]*NA,u<Uo&&(Uo=u)):(t<Uo&&(Uo=t),t>Sl&&(Sl=t))),c?e<e1?Cl(Rr,e)>Cl(Rr,jr)&&(jr=e):Cl(e,jr)>Cl(Rr,jr)&&(Rr=e):jr>=Rr?(e<Rr&&(Rr=e),e>jr&&(jr=e)):e>e1?Cl(Rr,e)>Cl(Rr,jr)&&(jr=e):Cl(e,jr)>Cl(Rr,jr)&&(Rr=e)}else Ug.push(Gp=[Rr=e,jr=e]);t<Uo&&(Uo=t),t>Sl&&(Sl=t),fw=n,e1=e}function twe(){Vd.point=HUe}function nwe(){Gp[0]=Rr,Gp[1]=jr,Vd.point=CQ,fw=null}function qUe(e,t){if(fw){var n=e-e1;IA.add(cue(n)>180?n+(n>0?360:-360):n)}else VUe=e,jUe=t;Hh.point(e,t),HUe(e,t)}function wmn(){Hh.lineStart()}function $mn(){qUe(VUe,jUe),Hh.lineEnd(),cue(IA)>$6&&(Rr=-(jr=180)),Gp[0]=Rr,Gp[1]=jr,fw=null}function Cl(e,t){return(t-=e)<0?t+360:t}function Cmn(e,t){return e[0]-t[0]}function rwe(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function _mn(e){var t,n,r,i,s,a,o;if(Sl=jr=-(Rr=Uo=1/0),Ug=[],hue(e,Vd),n=Ug.length){for(Ug.sort(Cmn),t=1,r=Ug[0],s=[r];t<n;++t)i=Ug[t],rwe(r,i[0])||rwe(r,i[1])?(Cl(r[0],i[1])>Cl(r[0],r[1])&&(r[1]=i[1]),Cl(i[0],r[1])>Cl(r[0],r[1])&&(r[0]=i[0])):s.push(r=i);for(a=-1/0,n=s.length-1,t=0,r=s[n];t<=n;r=i,++t)i=s[t],(o=Cl(r[1],i[0]))>a&&(a=o,Rr=i[0],jr=r[1])}return Ug=Gp=null,Rr===1/0||Uo===1/0?[[NaN,NaN],[NaN,NaN]]:[[Rr,Uo],[jr,Sl]]}var YE,k6,E6,A6,T6,D6,N6,I6,_Q,SQ,kQ,GUe,YUe,Qa,Ja,eo,Oc={sphere:GE,point:due,lineStart:iwe,lineEnd:swe,polygonStart:function(){Oc.lineStart=Emn,Oc.lineEnd=Amn},polygonEnd:function(){Oc.lineStart=iwe,Oc.lineEnd=swe}};function due(e,t){e*=Fa,t*=Fa;var n=xo(t);qM(n*xo(e),n*wo(e),wo(t))}function qM(e,t,n){++YE,E6+=(e-E6)/YE,A6+=(t-A6)/YE,T6+=(n-T6)/YE}function iwe(){Oc.point=Smn}function Smn(e,t){e*=Fa,t*=Fa;var n=xo(t);Qa=n*xo(e),Ja=n*wo(e),eo=wo(t),Oc.point=kmn,qM(Qa,Ja,eo)}function kmn(e,t){e*=Fa,t*=Fa;var n=xo(t),r=n*xo(e),i=n*wo(e),s=wo(t),a=FU(BUe((a=Ja*s-eo*i)*a+(a=eo*r-Qa*s)*a+(a=Qa*i-Ja*r)*a),Qa*r+Ja*i+eo*s);k6+=a,D6+=a*(Qa+(Qa=r)),N6+=a*(Ja+(Ja=i)),I6+=a*(eo+(eo=s)),qM(Qa,Ja,eo)}function swe(){Oc.point=due}function Emn(){Oc.point=Tmn}function Amn(){XUe(GUe,YUe),Oc.point=due}function Tmn(e,t){GUe=e,YUe=t,e*=Fa,t*=Fa,Oc.point=XUe;var n=xo(t);Qa=n*xo(e),Ja=n*wo(e),eo=wo(t),qM(Qa,Ja,eo)}function XUe(e,t){e*=Fa,t*=Fa;var n=xo(t),r=n*xo(e),i=n*wo(e),s=wo(t),a=Ja*s-eo*i,o=eo*r-Qa*s,l=Qa*i-Ja*r,u=yQ(a,o,l),c=fue(u),f=u&&-c/u;_Q.add(f*a),SQ.add(f*o),kQ.add(f*l),k6+=c,D6+=c*(Qa+(Qa=r)),N6+=c*(Ja+(Ja=i)),I6+=c*(eo+(eo=s)),qM(Qa,Ja,eo)}function Dmn(e){YE=k6=E6=A6=T6=D6=N6=I6=0,_Q=new k0,SQ=new k0,kQ=new k0,hue(e,Oc);var t=+_Q,n=+SQ,r=+kQ,i=yQ(t,n,r);return i<Y2e&&(t=D6,n=N6,r=I6,k6<$6&&(t=E6,n=A6,r=T6),i=yQ(t,n,r),i<Y2e)?[NaN,NaN]:[FU(n,t)*NA,fue(r/i)*NA]}function GM(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function OU(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function _x(){}var J3=.7,M6=1/J3,hw="\\s*([+-]?\\d+)\\s*",eD="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",vh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Nmn=/^#([0-9a-f]{3,8})$/,Imn=new RegExp(`^rgb\\(${hw},${hw},${hw}\\)$`),Mmn=new RegExp(`^rgb\\(${vh},${vh},${vh}\\)$`),Fmn=new RegExp(`^rgba\\(${hw},${hw},${hw},${eD}\\)$`),Omn=new RegExp(`^rgba\\(${vh},${vh},${vh},${eD}\\)$`),Rmn=new RegExp(`^hsl\\(${eD},${vh},${vh}\\)$`),Pmn=new RegExp(`^hsla\\(${eD},${vh},${vh},${eD}\\)$`),awe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};GM(_x,pue,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:owe,formatHex:owe,formatHex8:Lmn,formatHsl:Bmn,formatRgb:lwe,toString:lwe});function owe(){return this.rgb().formatHex()}function Lmn(){return this.rgb().formatHex8()}function Bmn(){return ZUe(this).formatHsl()}function lwe(){return this.rgb().formatRgb()}function pue(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Nmn.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?uwe(t):n===3?new va(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?yR(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?yR(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Imn.exec(e))?new va(t[1],t[2],t[3],1):(t=Mmn.exec(e))?new va(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Fmn.exec(e))?yR(t[1],t[2],t[3],t[4]):(t=Omn.exec(e))?yR(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Rmn.exec(e))?hwe(t[1],t[2]/100,t[3]/100,1):(t=Pmn.exec(e))?hwe(t[1],t[2]/100,t[3]/100,t[4]):awe.hasOwnProperty(e)?uwe(awe[e]):e==="transparent"?new va(NaN,NaN,NaN,0):null}function uwe(e){return new va(e>>16&255,e>>8&255,e&255,1)}function yR(e,t,n,r){return r<=0&&(e=t=n=NaN),new va(e,t,n,r)}function KUe(e){return e instanceof _x||(e=pue(e)),e?(e=e.rgb(),new va(e.r,e.g,e.b,e.opacity)):new va}function gue(e,t,n,r){return arguments.length===1?KUe(e):new va(e,t,n,r==null?1:r)}function va(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}GM(va,gue,OU(_x,{brighter(e){return e=e==null?M6:Math.pow(M6,e),new va(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?J3:Math.pow(J3,e),new va(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new va(hy(this.r),hy(this.g),hy(this.b),F6(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:cwe,formatHex:cwe,formatHex8:zmn,formatRgb:fwe,toString:fwe}));function cwe(){return`#${z1(this.r)}${z1(this.g)}${z1(this.b)}`}function zmn(){return`#${z1(this.r)}${z1(this.g)}${z1(this.b)}${z1((isNaN(this.opacity)?1:this.opacity)*255)}`}function fwe(){const e=F6(this.opacity);return`${e===1?"rgb(":"rgba("}${hy(this.r)}, ${hy(this.g)}, ${hy(this.b)}${e===1?")":`, ${e})`}`}function F6(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function hy(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function z1(e){return e=hy(e),(e<16?"0":"")+e.toString(16)}function hwe(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Nc(e,t,n,r)}function ZUe(e){if(e instanceof Nc)return new Nc(e.h,e.s,e.l,e.opacity);if(e instanceof _x||(e=pue(e)),!e)return new Nc;if(e instanceof Nc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new Nc(a,o,l,e.opacity)}function QUe(e,t,n,r){return arguments.length===1?ZUe(e):new Nc(e,t,n,r==null?1:r)}function Nc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}GM(Nc,QUe,OU(_x,{brighter(e){return e=e==null?M6:Math.pow(M6,e),new Nc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?J3:Math.pow(J3,e),new Nc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new va(Pq(e>=240?e-240:e+120,i,r),Pq(e,i,r),Pq(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Nc(dwe(this.h),bR(this.s),bR(this.l),F6(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=F6(this.opacity);return`${e===1?"hsl(":"hsla("}${dwe(this.h)}, ${bR(this.s)*100}%, ${bR(this.l)*100}%${e===1?")":`, ${e})`}`}}));function dwe(e){return e=(e||0)%360,e<0?e+360:e}function bR(e){return Math.max(0,Math.min(1,e||0))}function Pq(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Umn=Math.PI/180,Wmn=180/Math.PI,O6=18,JUe=.96422,eWe=1,tWe=.82521,nWe=4/29,dw=6/29,rWe=3*dw*dw,Vmn=dw*dw*dw;function iWe(e){if(e instanceof yh)return new yh(e.l,e.a,e.b,e.opacity);if(e instanceof up)return oWe(e);e instanceof va||(e=KUe(e));var t=Uq(e.r),n=Uq(e.g),r=Uq(e.b),i=Lq((.2225045*t+.7168786*n+.0606169*r)/eWe),s,a;return t===n&&n===r?s=a=i:(s=Lq((.4360747*t+.3850649*n+.1430804*r)/JUe),a=Lq((.0139322*t+.0971045*n+.7141733*r)/tWe)),new yh(116*i-16,500*(s-i),200*(i-a),e.opacity)}function sWe(e,t,n,r){return arguments.length===1?iWe(e):new yh(e,t,n,r==null?1:r)}function yh(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}GM(yh,sWe,OU(_x,{brighter(e){return new yh(this.l+O6*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new yh(this.l-O6*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=JUe*Bq(t),e=eWe*Bq(e),n=tWe*Bq(n),new va(zq(3.1338561*t-1.6168667*e-.4906146*n),zq(-.9787684*t+1.9161415*e+.033454*n),zq(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Lq(e){return e>Vmn?Math.pow(e,1/3):e/rWe+nWe}function Bq(e){return e>dw?e*e*e:rWe*(e-nWe)}function zq(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Uq(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function jmn(e){if(e instanceof up)return new up(e.h,e.c,e.l,e.opacity);if(e instanceof yh||(e=iWe(e)),e.a===0&&e.b===0)return new up(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Wmn;return new up(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function aWe(e,t,n,r){return arguments.length===1?jmn(e):new up(e,t,n,r==null?1:r)}function up(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function oWe(e){if(isNaN(e.h))return new yh(e.l,0,0,e.opacity);var t=e.h*Umn;return new yh(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}GM(up,aWe,OU(_x,{brighter(e){return new up(this.h,this.c,this.l+O6*(e==null?1:e),this.opacity)},darker(e){return new up(this.h,this.c,this.l-O6*(e==null?1:e),this.opacity)},rgb(){return oWe(this).rgb()}}));function Wq(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Hmn(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function qmn(e){let t,n,r;e.length!==2?(t=Wq,n=(o,l)=>Wq(e(o),l),r=(o,l)=>e(o)-l):(t=e===Wq||e===Hmn?e:Gmn,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function Gmn(){return 0}function Ymn(e,...t){e=new iP(e),t=t.map(Xmn);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e}function Xmn(e){return e instanceof iP?e:new iP(e)}function Kmn(...e){const t=new iP;for(const n of e)for(const r of n)t.add(r);return t}const mue="intersect",pwe="union",Zmn="vlMulti",Qmn="vlPoint",gwe="or",Jmn="and",Bf="_vgsid_",tD=ql(Bf),evn="E",tvn="R",nvn="R-E",rvn="R-LE",ivn="R-RE",R6="index:unit";function mwe(e,t){for(var n=t.fields,r=t.values,i=n.length,s=0,a,o;s<i;++s)if(o=n[s],o.getter=ql.getter||ql(o.field),a=o.getter(e),ty(a)&&(a=ao(a)),ty(r[s])&&(r[s]=ao(r[s])),ty(r[s][0])&&(r[s]=r[s].map(ao)),o.type===evn){if(at(r[s])?r[s].indexOf(a)<0:a!==r[s])return!1}else if(o.type===tvn){if(!fE(a,r[s]))return!1}else if(o.type===ivn){if(!fE(a,r[s],!0,!1))return!1}else if(o.type===nvn){if(!fE(a,r[s],!1,!1))return!1}else if(o.type===rvn&&!fE(a,r[s],!1,!0))return!1;return!0}function lWe(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],s=r?r[R6]&&r[R6].value:void 0,a=n===mue,o=i.length,l=0,u,c,f,h,d;l<o;++l)if(u=i[l],s&&a){if(c=c||{},f=c[h=u.unit]||0,f===-1)continue;if(d=mwe(t,u),c[h]=d?-1:++f,d&&s.size===1)return!0;if(!d&&f===s.get(h).count)return!1}else if(d=mwe(t,u),a^d)return d;return o&&a}const uWe=qmn(tD),svn=uWe.left,avn=uWe.right;function cWe(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],s=r?r[R6]&&r[R6].value:void 0,a=n===mue,o=tD(t),l=svn(i,o);if(l===i.length||tD(i[l])!==o)return!1;if(s&&a){if(s.size===1)return!0;if(avn(i,o)-l<s.size)return!1}return!0}function fWe(e,t){return e.map(n=>zt(t.fields?{values:t.fields.map(r=>(r.getter||(r.getter=ql(r.field)))(n.datum))}:{[Bf]:tD(n.datum)},t))}function hWe(e,t,n,r){for(var i=this.context.data[e],s=i?i.values.value:[],a={},o={},l={},u,c,f,h,d,p,g,m,v,y,b=s.length,x=0,w,C;x<b;++x)if(u=s[x],h=u.unit,c=u.fields,f=u.values,c&&f){for(w=0,C=c.length;w<C;++w)d=c[w],g=a[d.field]||(a[d.field]={}),m=g[h]||(g[h]=[]),l[d.field]=v=d.type.charAt(0),y=Vq[`${v}_union`],g[h]=y(m,ct(f[w]));n&&(m=o[h]||(o[h]=[]),m.push(ct(f).reduce(($,_,k)=>($[c[k].field]=_,$),{})))}else d=Bf,p=tD(u),g=a[d]||(a[d]={}),m=g[h]||(g[h]=[]),m.push(p),n&&(m=o[h]||(o[h]=[]),m.push({[Bf]:p}));if(t=t||pwe,a[Bf]?a[Bf]=Vq[`${Bf}_${t}`](...Object.values(a[Bf])):Object.keys(a).forEach($=>{a[$]=Object.keys(a[$]).map(_=>a[$][_]).reduce((_,k)=>_===void 0?k:Vq[`${l[$]}_${t}`](_,k))}),s=Object.keys(o),n&&s.length){const $=r?Qmn:Zmn;a[$]=t===pwe?{[gwe]:s.reduce((_,k)=>(_.push(...o[k]),_),[])}:{[Jmn]:s.map(_=>({[gwe]:o[_]}))}}return a}var Vq={[`${Bf}_union`]:Kmn,[`${Bf}_intersect`]:Ymn,E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=ao(t[0]),r=ao(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=ao(t[0]),r=ao(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const ovn=":",lvn="@";function uS(e,t,n,r){t[0].type!==ub&&$e("First argument to selection functions must be a string literal.");const i=t[0].value,s=t.length>=2&&un(t).value,a="unit",o=lvn+a,l=ovn+i;s===mue&&!bt(r,o)&&(r[o]=n.getData(i).indataRef(n,a)),bt(r,l)||(r[l]=n.getData(i).tuplesRef())}function dWe(e){const t=this.context.data[e];return t?t.values.value:[]}function uvn(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function cvn(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(ef).insert(t)),1}function fvn(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const YM=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},hvn=YM("format"),pWe=YM("timeFormat"),dvn=YM("utcFormat"),pvn=YM("timeParse"),gvn=YM("utcParse"),xR=new Date(2e3,0,1);function RU(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(xR.setYear(2e3),xR.setMonth(e),xR.setDate(t),pWe.call(this,xR,n))}function mvn(e){return RU.call(this,e,1,"%B")}function vvn(e){return RU.call(this,e,1,"%b")}function yvn(e){return RU.call(this,0,2+e,"%A")}function bvn(e){return RU.call(this,0,2+e,"%a")}const xvn=":",wvn="@",EQ="%",gWe="$";function vue(e,t,n,r){t[0].type!==ub&&$e("First argument to data functions must be a string literal.");const i=t[0].value,s=xvn+i;if(!bt(s,r))try{r[s]=n.getData(i).tuplesRef()}catch{}}function $vn(e,t,n,r){t[0].type!==ub&&$e("First argument to indata must be a string literal."),t[1].type!==ub&&$e("Second argument to indata must be a string literal.");const i=t[0].value,s=t[1].value,a=wvn+s;bt(a,r)||(r[a]=n.getData(i).indataRef(n,s))}function tl(e,t,n,r){if(t[0].type===ub)vwe(n,r,t[0].value);else for(e in n.scales)vwe(n,r,e)}function vwe(e,t,n){const r=EQ+n;if(!bt(t,r))try{t[r]=e.scaleRef(n)}catch{}}function dg(e,t){if(Ut(e))return e;if($r(e)){const n=t.scales[e];return n&&vHt(n.value)?n.value:void 0}}function Cvn(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=tl,n._range=tl,n._scale=tl;const r=i=>"_["+(i.type===ub?ot(EQ+i.value):ot(EQ)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function yue(e,t){return function(n,r,i){if(n){const s=dg(n,(i||this).context);return s&&s.path[e](r)}else return t(r)}}const _vn=yue("area",vmn),Svn=yue("bounds",_mn),kvn=yue("centroid",Dmn);function Evn(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function bue(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function Avn(){return bue(this.context.dataflow,"warn",arguments)}function Tvn(){return bue(this.context.dataflow,"info",arguments)}function Dvn(){return bue(this.context.dataflow,"debug",arguments)}function jq(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function AQ(e){const t=gue(e),n=jq(t.r),r=jq(t.g),i=jq(t.b);return .2126*n+.7152*r+.0722*i}function Nvn(e,t){const n=AQ(e),r=AQ(t),i=Math.max(n,r),s=Math.min(n,r);return(i+.05)/(s+.05)}function Ivn(){const e=[].slice.call(arguments);return e.unshift({}),zt(...e)}function mWe(e,t){return e===t||e!==e&&t!==t?!0:at(e)?at(t)&&e.length===t.length?Mvn(e,t):!1:Ft(e)&&Ft(t)?vWe(e,t):!1}function Mvn(e,t){for(let n=0,r=e.length;n<r;++n)if(!mWe(e[n],t[n]))return!1;return!0}function vWe(e,t){for(const n in e)if(!mWe(e[n],t[n]))return!1;return!0}function ywe(e){return t=>vWe(e,t)}function Fvn(e,t,n,r,i,s){const a=this.context.dataflow,o=this.context.data[e],l=o.input,u=a.stamp();let c=o.changes,f,h;if(a._trigger===!1||!(l.value.length||t||r))return 0;if((!c||c.stamp<u)&&(o.changes=c=a.changeset(),c.stamp=u,a.runAfter(()=>{o.modified=!0,a.pulse(l,c).run()},!0,1)),n&&(f=n===!0?ef:at(n)||U_(n)?n:ywe(n),c.remove(f)),t&&c.insert(t),r&&(f=ywe(r),l.value.some(f)?c.remove(f):c.insert(r)),i)for(h in s)c.modify(i,h,s[h]);return 1}function Ovn(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)}function Rvn(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const bwe={};function Pvn(e,t){const n=bwe[t]||(bwe[t]=ql(t));return at(e)?e.map(n):n(e)}function xue(e){return at(e)||ArrayBuffer.isView(e)?e:null}function wue(e){return xue(e)||($r(e)?e:null)}function Lvn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return xue(e).join(...n)}function Bvn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return wue(e).indexOf(...n)}function zvn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return wue(e).lastIndexOf(...n)}function Uvn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return wue(e).slice(...n)}function Wvn(e,t,n){return Ut(n)&&$e("Function argument passed to replace."),String(e).replace(t,n)}function Vvn(e){return xue(e).slice().reverse()}function jvn(e,t,n){return sse(e||0,t||0,n||0)}function Hvn(e,t){const n=dg(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function qvn(e,t){const n=dg(e,(t||this).context);return n?n.copy():void 0}function Gvn(e,t){const n=dg(e,(t||this).context);return n?n.domain():[]}function Yvn(e,t,n){const r=dg(e,(n||this).context);return r?at(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function Xvn(e,t){const n=dg(e,(t||this).context);return n&&n.range?n.range():[]}function Kvn(e,t,n){const r=dg(e,(n||this).context);return r?r(t):void 0}function Zvn(e,t,n,r,i){e=dg(e,(i||this).context);const s=UHt(t,n);let a=e.domain(),o=a[0],l=un(a),u=ll;return l-o?u=H5e(e,o,l):e=(e.interpolator?Dn("sequential")().interpolator(e.interpolator()):Dn("linear")().interpolate(e.interpolate()).range(e.range())).domain([o=0,l=1]),e.ticks&&(a=e.ticks(+r||15),o!==a[0]&&a.unshift(o),l!==un(a)&&a.push(l)),a.forEach(c=>s.stop(u(c),e(c))),s}function Qvn(e,t,n){const r=dg(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function Jvn(e){let t=null;return function(n){return n?TP(n,t=t||gse(e)):e}}const yWe=e=>e.data;function bWe(e,t){const n=dWe.call(t,e);return n.root&&n.root.lookup||{}}function e1n(e,t,n){const r=bWe(e,this),i=r[t],s=r[n];return i&&s?i.path(s).map(yWe):void 0}function t1n(e,t){const n=bWe(e,this)[t];return n?n.ancestors().map(yWe):void 0}const xWe=()=>typeof window<"u"&&window||null;function n1n(){const e=xWe();return e?e.screen:{}}function r1n(){const e=xWe();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function i1n(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function wWe(e,t,n){if(!e)return[];const[r,i]=e,s=new Oi().set(r[0],r[1],i[0],i[1]),a=n||this.context.dataflow.scenegraph().root;return $Yt(a,s,s1n(t))}function s1n(e){let t=null;if(e){const n=ct(e.marktype),r=ct(e.markname);t=i=>(!n.length||n.some(s=>i.marktype===s))&&(!r.length||r.some(s=>i.name===s))}return t}function a1n(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=ct(e);const i=e[e.length-1];return i===void 0||Math.hypot(i[0]-t,i[1]-n)>r?[...e,[t,n]]:e}function o1n(e){return ct(e).reduce((t,n,r)=>{let[i,s]=n;return t+=r==0?`M ${i},${s} `:r===e.length-1?" Z":`L ${i},${s} `},"")}function l1n(e,t,n){const{x:r,y:i,mark:s}=n,a=new Oi().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[l,u]of t)l<a.x1&&(a.x1=l),l>a.x2&&(a.x2=l),u<a.y1&&(a.y1=u),u>a.y2&&(a.y2=u);return a.translate(r,i),wWe([[a.x1,a.y1],[a.x2,a.y2]],e,s).filter(l=>u1n(l.x,l.y,t))}function u1n(e,t,n){let r=0;for(let i=0,s=n.length-1;i<n.length;s=i++){const[a,o]=n[s],[l,u]=n[i];u>t!=o>t&&e<(a-l)*(t-u)/(o-u)+l&&r++}return r&1}const nD={random(){return Lp()},cumulativeNormal:Qre,cumulativeLogNormal:_Re,cumulativeUniform:ARe,densityNormal:bRe,densityLogNormal:CRe,densityUniform:ERe,quantileNormal:Jre,quantileLogNormal:SRe,quantileUniform:TRe,sampleNormal:Zre,sampleLogNormal:$Re,sampleUniform:kRe,isArray:at,isBoolean:i8t,isDate:ty,isDefined(e){return e!==void 0},isNumber:LT,isObject:Ft,isRegExp:a8t,isString:$r,isTuple:U_,isValid(e){return e!=null&&e===e},toBoolean:uOe,toDate(e){return cOe(e)},toNumber:ao,toString:fOe,indexof:Bvn,join:Lvn,lastindexof:zvn,replace:Wvn,reverse:Vvn,slice:Uvn,flush:r8t,lerp:o8t,merge:Ivn,pad:f8t,peek:un,pluck:Pvn,span:t9,inrange:fE,truncate:d8t,rgb:gue,lab:sWe,hcl:aWe,hsl:QUe,luminance:AQ,contrast:Nvn,sequence:dmn,format:hvn,utcFormat:dvn,utcParse:gvn,utcOffset:wBt,utcSequence:CBt,timeFormat:pWe,timeParse:pvn,timeOffset:xBt,timeSequence:$Bt,timeUnitSpecifier:iBt,monthFormat:mvn,monthAbbrevFormat:vvn,dayFormat:yvn,dayAbbrevFormat:bvn,quarter:Y6t,utcquarter:X6t,week:aBt,utcweek:uBt,dayofyear:sBt,utcdayofyear:lBt,warn:Avn,info:Tvn,debug:Dvn,extent(e){return Rp(e)},inScope:Evn,intersect:wWe,clampRange:K6t,pinchDistance:Ovn,pinchAngle:Rvn,screen:n1n,containerSize:i1n,windowSize:r1n,bandspace:jvn,setdata:cvn,pathShape:Jvn,panLinear:j6t,panLog:H6t,panPow:q6t,panSymlog:G6t,zoomLinear:rOe,zoomLog:iOe,zoomPow:bX,zoomSymlog:sOe,encode:fvn,modify:Fvn,lassoAppend:a1n,lassoPath:o1n,intersectLasso:l1n},c1n=["view","item","group","xy","x","y"],f1n="event.vega.",$We="this.",$ue={},CWe={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${ot(gWe+e)}]`,functions:h1n,constants:RUe,visitors:$ue},TQ=hmn(CWe);function h1n(e){const t=PUe(e);c1n.forEach(n=>t[n]=f1n+n);for(const n in nD)t[n]=$We+n;return zt(t,Cvn(e,nD,$ue)),t}function Hi(e,t,n){return arguments.length===1?nD[e]:(nD[e]=t,n&&($ue[e]=n),TQ&&(TQ.functions[e]=$We+e),this)}Hi("bandwidth",Hvn,tl);Hi("copy",qvn,tl);Hi("domain",Gvn,tl);Hi("range",Xvn,tl);Hi("invert",Yvn,tl);Hi("scale",Kvn,tl);Hi("gradient",Zvn,tl);Hi("geoArea",_vn,tl);Hi("geoBounds",Svn,tl);Hi("geoCentroid",kvn,tl);Hi("geoShape",Qvn,tl);Hi("indata",uvn,$vn);Hi("data",dWe,vue);Hi("treePath",e1n,vue);Hi("treeAncestors",t1n,vue);Hi("vlSelectionTest",lWe,uS);Hi("vlSelectionIdTest",cWe,uS);Hi("vlSelectionResolve",hWe,uS);Hi("vlSelectionTuples",fWe);function qh(e,t){const n={};let r;try{e=$r(e)?e:ot(e)+"",r=cmn(e)}catch{$e("Expression parse error: "+e)}r.visit(s=>{if(s.type!==TUe)return;const a=s.callee.name,o=CWe.visitors[a];o&&o(a,s.arguments,t,n)});const i=TQ(r);return i.globals.forEach(s=>{const a=gWe+s;!bt(n,a)&&t.getSignal(s)&&(n[a]=t.signalRef(s))}),{$expr:zt({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function d1n(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const p1n=Rh(["rule"]),xwe=Rh(["group","image","rect"]);function g1n(e,t){let n="";return p1n[t]||(e.x2&&(e.x?(xwe[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(xwe[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function Cue(e){return(e+"").toLowerCase()}function m1n(e){return Cue(e)==="operator"}function v1n(e){return Cue(e)==="collect"}function Rk(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function y1n(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${r}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${r} : `}var b1n={operator:(e,t)=>Rk(e,["_"],t.code),parameter:(e,t)=>Rk(e,["datum","_"],t.code),event:(e,t)=>Rk(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return Rk(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const s in r){const a="o["+ot(s)+"]";i+=`$=${r[s].code};if(${a}!==$)${a}=$,m=1;`}return i+=g1n(r,n),i+="return m;",Rk(e,["item","_"],i)},codegen:{get(e){const t=`[${e.map(ot).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const r=(s,a)=>{const o=t[a];let l,u;return s.path?(l=`a${s.path}`,u=`b${s.path}`):((n=n||{})["f"+a]=s,l=`this.f${a}(a)`,u=`this.f${a}(b)`),y1n(l,u,-o,o)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function x1n(e){const t=this;m1n(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function w1n(e){const t=this;if(e.params){const n=t.get(e.id);n||$e("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function $1n(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=at(i)?i.map(s=>wwe(s,n,t)):wwe(i,n,t)}return t}function wwe(e,t,n){if(!e||!Ft(e))return e;for(let r=0,i=$we.length,s;r<i;++r)if(s=$we[r],bt(e,s.key))return s.parse(e,t,n);return e}var $we=[{key:"$ref",parse:C1n},{key:"$key",parse:S1n},{key:"$expr",parse:_1n},{key:"$field",parse:k1n},{key:"$encode",parse:A1n},{key:"$compare",parse:E1n},{key:"$context",parse:T1n},{key:"$subflow",parse:D1n},{key:"$tupleid",parse:N1n}];function C1n(e,t){return t.get(e.$ref)||$e("Operator not defined: "+e.$ref)}function _1n(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=eu(t.parameterExpression(e.$expr),e.$fields))}function S1n(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=lOe(e.$key,e.$flat,t.expr.codegen))}function k1n(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=ql(e.$field,e.$name,t.expr.codegen))}function E1n(e,t){const n="c:"+e.$compare+"_"+e.$order,r=ct(e.$compare).map(i=>i&&i.$tupleid?nt:i);return t.fn[n]||(t.fn[n]=aOe(r,e.$order,t.expr.codegen))}function A1n(e,t){const n=e.$encode,r={};for(const i in n){const s=n[i];r[i]=eu(t.encodeExpression(s.$expr),s.$fields),r[i].output=s.$output}return r}function T1n(e,t){return t}function D1n(e,t){const n=e.$subflow;return function(r,i,s){const a=t.fork().parse(n),o=a.get(n.operators[0].id),l=a.signals.parent;return l&&l.set(s),o.detachSubflow=()=>t.detach(a),o}}function N1n(){return nt}function I1n(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(s=>t.get(s)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(s=>t.get(s)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&$e("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function M1n(e){var t=this,n=Ft(n=e.source)?n.$ref:n,r=t.get(n),i=null,s=e.update,a=void 0;r||$e("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(a=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,r,i,s,a)}const F1n={skip:!0};function O1n(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(s=>{const a=t.signals[s];e.signals(s,a)&&(r[s]=a.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(s=>{const a=t.data[s];e.data(s,a)&&(i[s]=a.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n}function R1n(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(s=>{n.update(t.signals[s],i[s],F1n)}),Object.keys(r||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(ef).insert(r[s]))}),(e.subcontext||[]).forEach((s,a)=>{const o=t.subcontext[a];o&&o.setState(s)})}function _We(e,t,n,r){return new SWe(e,t,n,r)}function SWe(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||b1n,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Cwe(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}SWe.prototype=Cwe.prototype={fork(){const e=new Cwe(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),v1n(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(r.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),r.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const a=n.data[s]||(n.data[s]={});e.data[s].forEach(o=>a[o]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[Cue(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:d1n,parseOperator:x1n,parseOperatorParameters:w1n,parseParameters:$1n,parseStream:I1n,parseUpdate:M1n,getState:O1n,setState:R1n};function P1n(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),kWe(t,e.description()))}function kWe(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function L1n(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const Hq="default";function B1n(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:Hq,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,s=i?$r(i)?i:i.user:Hq,a=r.item&&r.item.cursor||null;return i&&s===i.user&&a==i.item?i:{user:s,item:a}}),e.add(null,function(n){let r=n.cursor,i=this.value;return $r(r)||(i=r.item,r=r.user),DQ(e,r&&r!==Hq?r:i||r),i},{cursor:t})}function DQ(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function P6(e,t){var n=e._runtime.data;return bt(n,t)||$e("Unrecognized data set: "+t),n[t]}function z1n(e,t){return arguments.length<2?P6(this,e).values.value:PU.call(this,e,sx().remove(ef).insert(t))}function PU(e,t){oRe(t)||$e("Second argument to changes must be a changeset.");const n=P6(this,e);return n.modified=!0,this.pulse(n.input,t)}function U1n(e,t){return PU.call(this,e,sx().insert(t))}function W1n(e,t){return PU.call(this,e,sx().remove(t))}function EWe(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function AWe(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function LU(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function V1n(e){var t=LU(e),n=EWe(e),r=AWe(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(s){e.error(s)}})}function j1n(e,t,n){var r=e._renderer,i=r&&r.canvas(),s,a,o;return i&&(o=LU(e),a=t.changedTouches?t.changedTouches[0]:t,s=Ise(a,i),s[0]-=o[0],s[1]-=o[1]),t.dataflow=e,t.item=n,t.vega=H1n(e,n,s),t}function H1n(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(a){var o=r,l;if(a){for(l=t;l;l=l.mark.group)if(l.mark.name===a){o=l;break}}return o&&o.mark&&o.mark.interactive?o:{}}function s(a){if(!a)return n;$r(a)&&(a=i(a));const o=n.slice();for(;a;)o[0]-=a.x||0,o[1]-=a.y||0,a=a.mark&&a.mark.group;return o}return{view:vo(e),item:vo(t||{}),group:i,xy:s,x:a=>s(a)[0],y:a=>s(a)[1]}}const _we="view",q1n="timer",G1n="window",Y1n={trap:!1};function X1n(e){const t=zt({defaults:{}},e),n=(r,i)=>{i.forEach(s=>{at(r[s])&&(r[s]=Rh(r[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function TWe(e,t,n,r){e._eventListeners.push({type:n,sources:ct(t),handler:r})}function K1n(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function wR(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||Ft(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Z1n(e,t,n){var r=this,i=new a9(n),s=function(u,c){r.runAsync(null,()=>{e===_we&&K1n(r,t)&&u.preventDefault(),i.receive(j1n(r,u,c))})},a;if(e===q1n)wR(r,"timer",t)&&r.timer(s,t);else if(e===_we)wR(r,"view",t)&&r.addEventListener(t,s,Y1n);else if(e===G1n?wR(r,"window",t)&&typeof window<"u"&&(a=[window]):typeof document<"u"&&wR(r,"selector",t)&&(a=document.querySelectorAll(e)),!a)r.warn("Can not resolve event source: "+e);else{for(var o=0,l=a.length;o<l;++o)a[o].addEventListener(t,s);TWe(r,a,t,s)}return i}function Swe(e){return e.item}function kwe(e){return e.item.mark.source}function Ewe(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Q1n(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",Swe),kwe,Ewe(e)),this.on(this.events("view","mouseout",Swe),kwe,Ewe(t)),this}function J1n(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,s;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(s=n[r],i=s.sources.length;--i>=0;)s.sources[i].removeEventListener(s.type,s.handler);return e&&e.call(this,this._handler,null,null,null),this}function Ll(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const eyn="vega-bind",tyn="vega-bind-name",nyn="vega-bind-radio";function ryn(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:a=>{a!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,a)})}},r.debounce&&(i.update=oOe(r.debounce,i.update))),(r.input==null&&r.element?iyn:ayn)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function iyn(e,t,n,r){const i=n.event||"input",s=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,s),TWe(r,t,i,s),e.set=a=>{t.value=a,t.dispatchEvent(syn(i))}}function syn(e){return typeof Event<"u"?new Event(e):{type:e}}function ayn(e,t,n,r){const i=r.signal(n.signal),s=Ll("div",{class:eyn}),a=n.input==="radio"?s:s.appendChild(Ll("label"));a.appendChild(Ll("span",{class:tyn},n.name||n.signal)),t.appendChild(s);let o=oyn;switch(n.input){case"checkbox":o=lyn;break;case"select":o=uyn;break;case"radio":o=cyn;break;case"range":o=fyn;break}o(e,a,n,i)}function oyn(e,t,n,r){const i=Ll("input");for(const s in n)s!=="signal"&&s!=="element"&&i.setAttribute(s==="input"?"type":s,n[s]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=s=>i.value=s}function lyn(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const s=Ll("input",i);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=a=>s.checked=!!a||null}function uyn(e,t,n,r){const i=Ll("select",{name:n.signal}),s=n.labels||[];n.options.forEach((a,o)=>{const l={value:a};L6(a,r)&&(l.selected=!0),i.appendChild(Ll("option",l,(s[o]||a)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=a=>{for(let o=0,l=n.options.length;o<l;++o)if(L6(n.options[o],a)){i.selectedIndex=o;return}}}function cyn(e,t,n,r){const i=Ll("span",{class:nyn}),s=n.labels||[];t.appendChild(i),e.elements=n.options.map((a,o)=>{const l={type:"radio",name:n.signal,value:a};L6(a,r)&&(l.checked=!0);const u=Ll("input",l);u.addEventListener("change",()=>e.update(a));const c=Ll("label",{},(s[o]||a)+"");return c.prepend(u),i.appendChild(c),u}),e.set=a=>{const o=e.elements,l=o.length;for(let u=0;u<l;++u)L6(o[u].value,a)&&(o[u].checked=!0)}}function fyn(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,s=n.min||Math.min(0,i,+r)||0,a=n.step||J0(s,i,100),o=Ll("input",{type:"range",name:n.signal,min:s,max:i,step:a});o.value=r;const l=Ll("span",{},+r);t.appendChild(o),t.appendChild(l);const u=()=>{l.textContent=o.value,e.update(+o.value)};o.addEventListener("input",u),o.addEventListener("change",u),e.elements=[o],e.set=c=>{o.value=c,l.textContent=c}}function L6(e,t){return e===t||e+""==t+""}function DWe(e,t,n,r,i,s){return t=t||new r(e.loader()),t.initialize(n,EWe(e),AWe(e),LU(e),i,s).background(e.background())}function _ue(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function hyn(e,t,n,r){const i=new r(e.loader(),_ue(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,LU(e),e);return t&&t.handlers().forEach(s=>{i.on(s.type,s.handler)}),i}function dyn(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,s=Pse(r);e=n._el=e?qq(n,e,!0):null,P1n(n),s||n.error("Unrecognized renderer type: "+r);const a=s.handler||F9,o=e?s.renderer:s.headless;return n._renderer=o?DWe(n,n._renderer,e,o):null,n._handler=hyn(n,n._handler,e,a),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=qq(n,t,!0):e.appendChild(Ll("form",{class:"vega-bindings"})),n._bind.forEach(l=>{l.param.element&&i!=="container"&&(l.element=qq(n,l.param.element,!!l.param.input))}),n._bind.forEach(l=>{ryn(n,l.element||t,l)})),n}function qq(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}const Pk=e=>+e||0,pyn=e=>({top:e,bottom:e,left:e,right:e});function Awe(e){return Ft(e)?{top:Pk(e.top),bottom:Pk(e.bottom),left:Pk(e.left),right:Pk(e.right)}:pyn(Pk(e))}async function Sue(e,t,n,r){const i=Pse(t),s=i&&i.headless;return s||$e("Unrecognized renderer type: "+t),await e.runAsync(),DWe(e,null,null,s,n,r).renderAsync(e._scenegraph.root)}async function gyn(e,t){e!==R1.Canvas&&e!==R1.SVG&&e!==R1.PNG&&$e("Unrecognized image type: "+e);const n=await Sue(this,e,t);return e===R1.SVG?myn(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function myn(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function vyn(e,t){return(await Sue(this,R1.Canvas,e,t)).canvas()}async function yyn(e){return(await Sue(this,R1.SVG,e)).svg()}function byn(e,t,n){return _We(e,Qw,nD,n).parse(t)}function xyn(e){var t=this._runtime.scales;return bt(t,e)||$e("Unrecognized scale or projection: "+e),t[e].value}var NWe="width",IWe="height",kue="padding",Twe={skip:!0};function MWe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===kue?r.left+r.right:0)}function FWe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===kue?r.top+r.bottom:0)}function wyn(e){var t=e._signals,n=t[NWe],r=t[IWe],i=t[kue];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,o=>{e._width=o.size,e._viewWidth=MWe(e,o.size),s()},{size:n}),e._resizeHeight=e.add(null,o=>{e._height=o.size,e._viewHeight=FWe(e,o.size),s()},{size:r});const a=e.add(null,s,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}function $yn(e,t,n,r,i,s){this.runAfter(a=>{let o=0;a._autosize=0,a.width()!==n&&(o=1,a.signal(NWe,n,Twe),a._resizeWidth.skip(!0)),a.height()!==r&&(o=1,a.signal(IWe,r,Twe),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),(a._origin[0]!==i[0]||a._origin[1]!==i[1])&&(a._resize=1,a._origin=i),o&&a.run("enter"),s&&a.runAfter(l=>l.resize())},!1,1)}function Cyn(e){return this._runtime.getState(e||{data:_yn,signals:Syn,recurse:!0})}function _yn(e,t){return t.modified&&at(t.input.value)&&e.indexOf("_:vega:_")}function Syn(e,t){return!(e==="parent"||t instanceof Qw.proxy)}function kyn(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Eyn(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(len(n,t))}function Ayn(e,t,n,r){const i=e.element();i&&i.setAttribute("title",Tyn(r))}function Tyn(e){return e==null?"":at(e)?OWe(e):Ft(e)&&!ty(e)?Dyn(e):e+""}function Dyn(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(at(n)?OWe(n):RWe(n))}).join(`
`)}function OWe(e){return"["+e.map(RWe).join(", ")+"]"}function RWe(e){return at(e)?"[\u2026]":Ft(e)&&!ty(e)?"{\u2026}":e}function PWe(e,t){const n=this;if(t=t||{},Q2.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const s=zt({},e.locale,t.locale);n.locale(Vzt(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||R1.Canvas,n._scenegraph=new CPe;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Ayn,n._redraw=!0,n._handler=new F9().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=X1n(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=byn(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:zt({},s)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=MWe(n,n._width),n._viewHeight=FWe(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,wyn(n),L1n(n),B1n(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function $R(e,t){return bt(e._signals,t)?e._signals[t]:$e("Unrecognized signal name: "+ot(t))}function LWe(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function Dwe(e,t,n,r){let i=LWe(n,r);return i||(i=_ue(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function Nwe(e,t,n){const r=LWe(t,n);return r&&t._targets.remove(r),e}Ne(PWe,Q2,{async evaluate(e,t,n){if(await Q2.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,V1n(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&l4(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&kWe(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=$R(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",Awe(e)):Awe(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Pse(e)||$e("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Q2.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch($R(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:$yn,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=_ue(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,s;--r>=0;)if(s=n[r].type,i=n[r].handler,e===s&&(t===i||t===i.raw)){this._handler.off(s,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return Dwe(this,e,$R(this,e),t)},removeSignalListener(e,t){return Nwe(this,$R(this,e),t)},addDataListener(e,t){return Dwe(this,e,P6(this,e).values,t)},removeDataListener(e,t){return Nwe(this,P6(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=DQ(this,null);this._globalCursor=!!e,t&&DQ(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Eyn,events:Z1n,finalize:J1n,hover:Q1n,data:z1n,change:PU,insert:U1n,remove:W1n,scale:xyn,initialize:dyn,toImageURL:gyn,toCanvas:vyn,toSVG:yyn,getState:Cyn,setState:kyn});function cS(e,t,n){return e.fields=t||[],e.fname=n,e}function Nyn(e){return e.length===1?Iyn(e[0]):Myn(e)}const Iyn=e=>function(t){return t[e]},Myn=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function MA(e){throw Error(e)}function Fyn(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||MA("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&MA("Access path missing closing bracket: "+e),r&&MA("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function Oyn(e,t,n){const r=Fyn(e);return e=r.length===1?r[0]:e,cS((n&&n.get||Nyn)(r),[e],t||e)}Oyn("id");cS(e=>e,[],"identity");cS(()=>0,[],"zero");cS(()=>1,[],"one");cS(()=>!0,[],"true");cS(()=>!1,[],"false");function Ryn(e){return e===Object(e)}function Pyn(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function Iwe(e){return typeof e=="string"}const Gq=new Date,Yq=new Date;function qi(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>qi(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(Gq.setTime(+s),Yq.setTime(+a),e(Gq),e(Yq),Math.floor(n(Gq,Yq))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const rD=qi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);rD.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?qi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):rD);rD.range;const iD=1e3,ym=iD*60,sD=ym*60,aD=sD*24,BWe=aD*7,Eue=qi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*iD)},(e,t)=>(t-e)/iD,e=>e.getUTCSeconds());Eue.range;const zWe=qi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*iD)},(e,t)=>{e.setTime(+e+t*ym)},(e,t)=>(t-e)/ym,e=>e.getMinutes());zWe.range;const UWe=qi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ym)},(e,t)=>(t-e)/ym,e=>e.getUTCMinutes());UWe.range;const WWe=qi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*iD-e.getMinutes()*ym)},(e,t)=>{e.setTime(+e+t*sD)},(e,t)=>(t-e)/sD,e=>e.getHours());WWe.range;const VWe=qi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*sD)},(e,t)=>(t-e)/sD,e=>e.getUTCHours());VWe.range;const O4=qi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ym)/aD,e=>e.getDate()-1);O4.range;const R4=qi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/aD,e=>e.getUTCDate()-1);R4.range;const Lyn=qi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/aD,e=>Math.floor(e/aD));Lyn.range;function Sx(e){return qi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*ym)/BWe)}const jWe=Sx(0),Byn=Sx(1),zyn=Sx(2),Uyn=Sx(3),Wyn=Sx(4),Vyn=Sx(5),jyn=Sx(6);jWe.range;Byn.range;zyn.range;Uyn.range;Wyn.range;Vyn.range;jyn.range;function kx(e){return qi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/BWe)}const HWe=kx(0),Hyn=kx(1),qyn=kx(2),Gyn=kx(3),Yyn=kx(4),Xyn=kx(5),Kyn=kx(6);HWe.range;Hyn.range;qyn.range;Gyn.range;Yyn.range;Xyn.range;Kyn.range;const NQ=qi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());NQ.range;const IQ=qi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());IQ.range;const Aue=qi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Aue.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:qi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Aue.range;const Tue=qi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Tue.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:qi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Tue.range;const oD="year",lD="quarter",uD="month",cD="week",fD="date",BU="day",Due="dayofyear",hD="hours",dD="minutes",pD="seconds",zU="milliseconds",Zyn=[oD,lD,uD,cD,fD,BU,Due,hD,dD,pD,zU];Zyn.reduce((e,t,n)=>(e[t]=1+n,e),{});const Qyn={[oD]:Aue,[lD]:NQ.every(3),[uD]:NQ,[cD]:jWe,[fD]:O4,[BU]:O4,[Due]:O4,[hD]:WWe,[dD]:zWe,[pD]:Eue,[zU]:rD},Jyn={[oD]:Tue,[lD]:IQ.every(3),[uD]:IQ,[cD]:HWe,[fD]:R4,[BU]:R4,[Due]:R4,[hD]:VWe,[dD]:UWe,[pD]:Eue,[zU]:rD};function ebn(e){return Qyn[e]}function tbn(e){return Jyn[e]}function XE(e){const t={};return n=>t[n]||(t[n]=e(n))}function nbn(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=rbn(r,i);const a=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+a}}function rbn(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function qWe(e){const t=XE(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=R$(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return nbn(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,a){a=R$(a==null?",f":a);const o=J0(r,i,s),l=Math.max(Math.abs(r),Math.abs(i));let u;if(a.precision==null)switch(a.type){case"s":return isNaN(u=V9e(o,l))||(a.precision=u),n(a,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=j9e(o,l))||(a.precision=u-(a.type==="e"));break}case"f":case"%":{isNaN(u=W9e(o))||(a.precision=u-(a.type==="%")*2);break}}return t(a)}}}let MQ;GWe();function GWe(){return MQ=qWe({format:SU,formatPrefix:Nle})}function YWe(e){return qWe(U9e(e))}function B6(e){return arguments.length?MQ=YWe(e):MQ}function Mwe(e,t,n){n=n||{},Ryn(n)||MA("Invalid time multi-format specifier: ".concat(n));const r=t(pD),i=t(dD),s=t(hD),a=t(fD),o=t(cD),l=t(uD),u=t(lD),c=t(oD),f=e(n[zU]||".%L"),h=e(n[pD]||":%S"),d=e(n[dD]||"%I:%M"),p=e(n[hD]||"%I %p"),g=e(n[fD]||n[BU]||"%a %d"),m=e(n[cD]||"%b %d"),v=e(n[uD]||"%B"),y=e(n[lD]||"%B"),b=e(n[oD]||"%Y");return x=>(r(x)<x?f:i(x)<x?h:s(x)<x?d:a(x)<x?p:l(x)<x?o(x)<x?g:m:c(x)<x?u(x)<x?v:y:b)(x)}function XWe(e){const t=XE(e.format),n=XE(e.utcFormat);return{timeFormat:r=>Iwe(r)?t(r):Mwe(t,ebn,r),utcFormat:r=>Iwe(r)?n(r):Mwe(n,tbn,r),timeParse:XE(e.parse),utcParse:XE(e.utcParse)}}let FQ;KWe();function KWe(){return FQ=XWe({format:Rle,parse:sUe,utcFormat:Ple,utcParse:aUe})}function ZWe(e){return XWe(eUe(e))}function z6(e){return arguments.length?FQ=ZWe(e):FQ}const OQ=(e,t)=>Pyn({},e,t);function ibn(e,t){const n=e?YWe(e):B6(),r=t?ZWe(t):z6();return OQ(n,r)}function QWe(e,t){const n=arguments.length;return n&&n!==2&&MA("defaultLocale expects either zero or two arguments."),n?OQ(B6(e),z6(t)):OQ(B6(),z6())}function sbn(){return GWe(),KWe(),QWe()}function fS(e,t,n){return e.fields=t||[],e.fname=n,e}function abn(e){return e.length===1?obn(e[0]):lbn(e)}const obn=e=>function(t){return t[e]},lbn=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function br(e){throw Error(e)}function ubn(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||br("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&br("Access path missing closing bracket: "+e),r&&br("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function JWe(e,t,n){const r=ubn(e);return e=r.length===1?r[0]:e,fS((n&&n.get||abn)(r),[e],t||e)}JWe("id");const Nue=fS(e=>e,[],"identity");fS(()=>0,[],"zero");fS(()=>1,[],"one");const UU=fS(()=>!0,[],"true");fS(()=>!1,[],"false");var Oa=Array.isArray;function gD(e){return e===Object(e)}function $o(e){return e[e.length-1]}function WU(e){return e==null||e===""?null:+e}const eVe=e=>t=>e*Math.exp(t),tVe=e=>t=>Math.log(e*t),nVe=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),rVe=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,U6=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function VU(e,t,n,r){const i=n(e[0]),s=n($o(e)),a=(s-i)*t;return[r(i-a),r(s-a)]}function cbn(e,t){return VU(e,t,WU,Nue)}function fbn(e,t){var n=Math.sign(e[0]);return VU(e,t,tVe(n),eVe(n))}function hbn(e,t,n){return VU(e,t,U6(n),U6(1/n))}function dbn(e,t,n){return VU(e,t,nVe(n),rVe(n))}function jU(e,t,n,r,i){const s=r(e[0]),a=r($o(e)),o=t!=null?r(t):(s+a)/2;return[i(o+(s-o)*n),i(o+(a-o)*n)]}function pbn(e,t,n){return jU(e,t,n,WU,Nue)}function gbn(e,t,n){const r=Math.sign(e[0]);return jU(e,t,n,tVe(r),eVe(r))}function mbn(e,t,n,r){return jU(e,t,n,U6(r),U6(1/r))}function vbn(e,t,n,r){return jU(e,t,n,nVe(r),rVe(r))}function ybn(e){return 1+~~(new Date(e).getMonth()/3)}function bbn(e){return 1+~~(new Date(e).getUTCMonth()/3)}function L$(e){return e!=null?Oa(e)?e:[e]:[]}function xbn(e,t,n){let r=e[0],i=e[1],s;return i<r&&(s=i,i=r,r=s),s=i-r,s>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-s),r+s]}function bm(e){return typeof e=="function"}function wbn(e){return bm(e)?e:()=>e}function Ex(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function $bn(e,t){let n=0,r,i,s,a;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(s=a=i;n<r;++n)i=e[n],i!=null&&(i<s&&(s=i),i>a&&(a=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(s=a=i;n<r;++n)i=t(e[n]),i!=null&&(i<s&&(s=i),i>a&&(a=i))}return[s,a]}const Cbn=Object.prototype.hasOwnProperty;function Is(e,t){return Cbn.call(e,t)}function _bn(e,t,n,r,i,s){if(!n&&n!==0)return s;const a=+n;let o=e[0],l=$o(e),u;l<o&&(u=o,o=l,l=u),u=Math.abs(t-o);const c=Math.abs(l-t);return u<c&&u<=a?r:c<=a?i:s}function hS(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ex(r,n)}function Sbn(e,t,n,r){let i=t[0],s=t[t.length-1],a;return i>s&&(a=i,i=s,s=a),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=s:e<s)}function kbn(e){return typeof e=="boolean"}function iVe(e){return Object.prototype.toString.call(e)==="[object Date]"}function sVe(e){return typeof e=="number"}function Ebn(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function xm(e){return typeof e=="string"}function Abn(e,t){const n=e[0],r=$o(e),i=+t;return i?i===1?r:n+i*(r-n):n}const Tbn=1e4;function Dbn(e){e=+e||Tbn;let t,n,r;const i=()=>{t={},n={},r=0},s=(a,o)=>(++r>e&&(n=t,t={},r=1),t[a]=o);return i(),{clear:i,has:a=>Is(t,a)||Is(n,a),get:a=>Is(t,a)?t[a]:Is(n,a)?s(a,n[a]):void 0,set:(a,o)=>Is(t,a)?t[a]=o:s(a,o)}}function CR(e,t){let n="";for(;--t>=0;)n+=e;return n}function Nbn(e,t,n,r){const i=n||" ",s=e+"",a=t-s.length;return a<=0?s:r==="left"?CR(i,a)+s:r==="center"?CR(i,~~(a/2))+s+CR(i,Math.ceil(a/2)):s+CR(i,a)}function Ibn(e){return e&&$o(e)-e[0]||0}function mD(e){return Oa(e)?"["+e.map(mD)+"]":gD(e)||xm(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Mbn(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const Fbn=e=>sVe(e)||iVe(e)?e:Date.parse(e);function Obn(e,t){return t=t||Fbn,e==null||e===""?null:t(e)}function Rbn(e){return e==null||e===""?null:e+""}function W6(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function Pbn(e,t,n,r){const i=r!=null?r:"\u2026",s=e+"",a=s.length,o=Math.max(0,t-i.length);return a<=t?s:n==="left"?i+s.slice(a-o):n==="center"?s.slice(0,Math.ceil(o/2))+i+s.slice(a-~~(o/2)):s.slice(0,o)+i}const vD="Literal";var gd,Lbn=1,Bbn=2,zbn=3,Ubn=4,Wbn=5,Vbn=6,jbn=7,Hbn=8,qbn=9;gd={};gd[Lbn]="Boolean";gd[Bbn]="<end>";gd[zbn]="Identifier";gd[Ubn]="Keyword";gd[Wbn]="Null";gd[Vbn]="Numeric";gd[jbn]="Punctuator";gd[Hbn]="String";gd[qbn]="RegularExpression";var aVe={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function oVe(e){function t(a,o,l,u){let c=e(o[0]);return l&&(c=l+"("+c+")",l.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(u<0?"":u===0?"()":"("+o.slice(1).map(e).join(",")+")")}function n(a,o,l){return u=>t(a,u,o,l)}const r="new Date",i="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&br("Missing arguments to clamp function."),a.length>3&&br("Too many arguments to clamp function.");const o=a.map(e);return"Math.max("+o[1]+", Math.min("+o[2]+","+o[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:s,test:n("test",s),if:function(a){a.length<3&&br("Missing arguments to if function."),a.length>3&&br("Too many arguments to if function.");const o=a.map(e);return"("+o[0]+"?"+o[1]+":"+o[2]+")"}}}function Gbn(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function Ybn(e){e=e||{};const t=e.allowed?W6(e.allowed):{},n=e.forbidden?W6(e.forbidden):{},r=e.constants||aVe,i=(e.functions||oVe)(f),s=e.globalvar,a=e.fieldvar,o=bm(s)?s:p=>`${s}["${p}"]`;let l={},u={},c=0;function f(p){if(xm(p))return p;const g=h[p.type];return g==null&&br("Unsupported type: "+p.type),g(p)}const h={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:Is(n,g)?br("Illegal identifier: "+g):Is(r,g)?r[g]:Is(t,g)?g:(l[g]=1,o(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const v=f(p.property);return m===a&&(u[Gbn(v)]=1),g&&(c-=1),m+(g?"."+v:"["+v+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&br("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,v=Is(i,g)&&i[g];return v||br("Unrecognized function: "+g),bm(v)?v(m):v+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function d(p){const g={code:f(p),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},g}return d.functions=i,d.constants=r,d}function P4(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Xbn(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function lVe(e){let t,n,r;e.length!==2?(t=P4,n=(o,l)=>P4(e(o),l),r=(o,l)=>e(o)-l):(t=e===P4||e===Xbn?e:Kbn,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function Kbn(){return 0}function Zbn(e){return e===null?NaN:+e}const Qbn=lVe(P4),RQ=Qbn.right;lVe(Zbn).center;const Jbn=RQ;function exn(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function FA(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function txn(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function uVe(e){let t,n,r;e.length!==2?(t=FA,n=(o,l)=>FA(e(o),l),r=(o,l)=>e(o)-l):(t=e===FA||e===txn?e:nxn,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function nxn(){return 0}function cVe(e){return e===null?NaN:+e}const rxn=uVe(FA),ixn=rxn.right;uVe(cVe).center;const HU=ixn,sxn=Math.sqrt(50),axn=Math.sqrt(10),oxn=Math.sqrt(2);function V6(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=sxn?10:s>=axn?5:s>=oxn?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?V6(e,t,n*2):[o,l,u]}function PQ(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,a]=r?V6(t,e,n):V6(e,t,n);if(!(s>=i))return[];const o=s-i+1,l=new Array(o);if(r)if(a<0)for(let u=0;u<o;++u)l[u]=(s-u)/-a;else for(let u=0;u<o;++u)l[u]=(s-u)*a;else if(a<0)for(let u=0;u<o;++u)l[u]=(i+u)/-a;else for(let u=0;u<o;++u)l[u]=(i+u)*a;return l}function LQ(e,t,n){return t=+t,e=+e,n=+n,V6(e,t,n)[2]}function lxn(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?LQ(t,e,n):LQ(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function uxn(e,t,n=cVe){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function md(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function uv(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Fwe=Symbol("implicit");function Iue(){var e=new Gw,t=[],n=[],r=Fwe;function i(s){let a=e.get(s);if(a===void 0){if(r!==Fwe)return r;e.set(s,a=t.push(s)-1)}return n[a%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new Gw;for(const a of s)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return Iue(t,n).unknown(r)},md.apply(i,arguments),i}function dS(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function XM(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function cv(){}var hb=.7,B$=1/hb,pw="\\s*([+-]?\\d+)\\s*",yD="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",bh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",cxn=/^#([0-9a-f]{3,8})$/,fxn=new RegExp(`^rgb\\(${pw},${pw},${pw}\\)$`),hxn=new RegExp(`^rgb\\(${bh},${bh},${bh}\\)$`),dxn=new RegExp(`^rgba\\(${pw},${pw},${pw},${yD}\\)$`),pxn=new RegExp(`^rgba\\(${bh},${bh},${bh},${yD}\\)$`),gxn=new RegExp(`^hsl\\(${yD},${bh},${bh}\\)$`),mxn=new RegExp(`^hsla\\(${yD},${bh},${bh},${yD}\\)$`),Owe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};dS(cv,bD,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Rwe,formatHex:Rwe,formatHex8:vxn,formatHsl:yxn,formatRgb:Pwe,toString:Pwe});function Rwe(){return this.rgb().formatHex()}function vxn(){return this.rgb().formatHex8()}function yxn(){return fVe(this).formatHsl()}function Pwe(){return this.rgb().formatRgb()}function bD(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=cxn.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Lwe(t):n===3?new os(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?_R(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?_R(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=fxn.exec(e))?new os(t[1],t[2],t[3],1):(t=hxn.exec(e))?new os(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=dxn.exec(e))?_R(t[1],t[2],t[3],t[4]):(t=pxn.exec(e))?_R(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=gxn.exec(e))?Uwe(t[1],t[2]/100,t[3]/100,1):(t=mxn.exec(e))?Uwe(t[1],t[2]/100,t[3]/100,t[4]):Owe.hasOwnProperty(e)?Lwe(Owe[e]):e==="transparent"?new os(NaN,NaN,NaN,0):null}function Lwe(e){return new os(e>>16&255,e>>8&255,e&255,1)}function _R(e,t,n,r){return r<=0&&(e=t=n=NaN),new os(e,t,n,r)}function Mue(e){return e instanceof cv||(e=bD(e)),e?(e=e.rgb(),new os(e.r,e.g,e.b,e.opacity)):new os}function j6(e,t,n,r){return arguments.length===1?Mue(e):new os(e,t,n,r==null?1:r)}function os(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}dS(os,j6,XM(cv,{brighter(e){return e=e==null?B$:Math.pow(B$,e),new os(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?hb:Math.pow(hb,e),new os(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new os(dy(this.r),dy(this.g),dy(this.b),H6(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Bwe,formatHex:Bwe,formatHex8:bxn,formatRgb:zwe,toString:zwe}));function Bwe(){return`#${U1(this.r)}${U1(this.g)}${U1(this.b)}`}function bxn(){return`#${U1(this.r)}${U1(this.g)}${U1(this.b)}${U1((isNaN(this.opacity)?1:this.opacity)*255)}`}function zwe(){const e=H6(this.opacity);return`${e===1?"rgb(":"rgba("}${dy(this.r)}, ${dy(this.g)}, ${dy(this.b)}${e===1?")":`, ${e})`}`}function H6(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function dy(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function U1(e){return e=dy(e),(e<16?"0":"")+e.toString(16)}function Uwe(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ic(e,t,n,r)}function fVe(e){if(e instanceof Ic)return new Ic(e.h,e.s,e.l,e.opacity);if(e instanceof cv||(e=bD(e)),!e)return new Ic;if(e instanceof Ic)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new Ic(a,o,l,e.opacity)}function BQ(e,t,n,r){return arguments.length===1?fVe(e):new Ic(e,t,n,r==null?1:r)}function Ic(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}dS(Ic,BQ,XM(cv,{brighter(e){return e=e==null?B$:Math.pow(B$,e),new Ic(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?hb:Math.pow(hb,e),new Ic(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new os(Xq(e>=240?e-240:e+120,i,r),Xq(e,i,r),Xq(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Ic(Wwe(this.h),SR(this.s),SR(this.l),H6(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=H6(this.opacity);return`${e===1?"hsl(":"hsla("}${Wwe(this.h)}, ${SR(this.s)*100}%, ${SR(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Wwe(e){return e=(e||0)%360,e<0?e+360:e}function SR(e){return Math.max(0,Math.min(1,e||0))}function Xq(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const hVe=Math.PI/180,dVe=180/Math.PI,q6=18,pVe=.96422,gVe=1,mVe=.82521,vVe=4/29,gw=6/29,yVe=3*gw*gw,xxn=gw*gw*gw;function bVe(e){if(e instanceof xh)return new xh(e.l,e.a,e.b,e.opacity);if(e instanceof cp)return xVe(e);e instanceof os||(e=Mue(e));var t=Jq(e.r),n=Jq(e.g),r=Jq(e.b),i=Kq((.2225045*t+.7168786*n+.0606169*r)/gVe),s,a;return t===n&&n===r?s=a=i:(s=Kq((.4360747*t+.3850649*n+.1430804*r)/pVe),a=Kq((.0139322*t+.0971045*n+.7141733*r)/mVe)),new xh(116*i-16,500*(s-i),200*(i-a),e.opacity)}function zQ(e,t,n,r){return arguments.length===1?bVe(e):new xh(e,t,n,r==null?1:r)}function xh(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}dS(xh,zQ,XM(cv,{brighter(e){return new xh(this.l+q6*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new xh(this.l-q6*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=pVe*Zq(t),e=gVe*Zq(e),n=mVe*Zq(n),new os(Qq(3.1338561*t-1.6168667*e-.4906146*n),Qq(-.9787684*t+1.9161415*e+.033454*n),Qq(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Kq(e){return e>xxn?Math.pow(e,1/3):e/yVe+vVe}function Zq(e){return e>gw?e*e*e:yVe*(e-vVe)}function Qq(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Jq(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function wxn(e){if(e instanceof cp)return new cp(e.h,e.c,e.l,e.opacity);if(e instanceof xh||(e=bVe(e)),e.a===0&&e.b===0)return new cp(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*dVe;return new cp(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function UQ(e,t,n,r){return arguments.length===1?wxn(e):new cp(e,t,n,r==null?1:r)}function cp(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function xVe(e){if(isNaN(e.h))return new xh(e.l,0,0,e.opacity);var t=e.h*hVe;return new xh(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}dS(cp,UQ,XM(cv,{brighter(e){return new cp(this.h,this.c,this.l+q6*(e==null?1:e),this.opacity)},darker(e){return new cp(this.h,this.c,this.l-q6*(e==null?1:e),this.opacity)},rgb(){return xVe(this).rgb()}}));var wVe=-.14861,Fue=1.78277,Oue=-.29227,qU=-.90649,xD=1.97294,Vwe=xD*qU,jwe=xD*Fue,Hwe=Fue*Oue-qU*wVe;function $xn(e){if(e instanceof py)return new py(e.h,e.s,e.l,e.opacity);e instanceof os||(e=Mue(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Hwe*r+Vwe*t-jwe*n)/(Hwe+Vwe-jwe),s=r-i,a=(xD*(n-i)-Oue*s)/qU,o=Math.sqrt(a*a+s*s)/(xD*i*(1-i)),l=o?Math.atan2(a,s)*dVe-120:NaN;return new py(l<0?l+360:l,o,i,e.opacity)}function WQ(e,t,n,r){return arguments.length===1?$xn(e):new py(e,t,n,r==null?1:r)}function py(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}dS(py,WQ,XM(cv,{brighter(e){return e=e==null?B$:Math.pow(B$,e),new py(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?hb:Math.pow(hb,e),new py(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*hVe,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new os(255*(t+n*(wVe*r+Fue*i)),255*(t+n*(Oue*r+qU*i)),255*(t+n*(xD*r)),this.opacity)}}));function $Ve(e,t,n,r,i){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*n+(1+3*e+3*s-3*a)*r+a*i)/6}function CVe(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],a=r>0?e[r-1]:2*i-s,o=r<t-1?e[r+2]:2*s-i;return $Ve((n-r/t)*t,a,i,s,o)}}function _Ve(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],a=e[(r+1)%t],o=e[(r+2)%t];return $Ve((n-r/t)*t,i,s,a,o)}}const GU=e=>()=>e;function SVe(e,t){return function(n){return e+n*t}}function Cxn(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function YU(e,t){var n=t-e;return n?SVe(e,n>180||n<-180?n-360*Math.round(n/360):n):GU(isNaN(e)?t:e)}function _xn(e){return(e=+e)==1?ls:function(t,n){return n-t?Cxn(t,n,e):GU(isNaN(t)?n:t)}}function ls(e,t){var n=t-e;return n?SVe(e,n):GU(isNaN(e)?t:e)}const VQ=function e(t){var n=_xn(t);function r(i,s){var a=n((i=j6(i)).r,(s=j6(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=ls(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function kVe(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),a,o;for(a=0;a<n;++a)o=j6(t[a]),r[a]=o.r||0,i[a]=o.g||0,s[a]=o.b||0;return r=e(r),i=e(i),s=e(s),o.opacity=1,function(l){return o.r=r(l),o.g=i(l),o.b=s(l),o+""}}}var Sxn=kVe(CVe),kxn=kVe(_Ve);function Rue(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function EVe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Exn(e,t){return(EVe(t)?Rue:AVe)(e,t)}function AVe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=Ax(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function TVe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Cc(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function DVe(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Ax(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var jQ=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,eG=new RegExp(jQ.source,"g");function Axn(e){return function(){return e}}function Txn(e){return function(t){return e(t)+""}}function NVe(e,t){var n=jQ.lastIndex=eG.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=jQ.exec(e))&&(i=eG.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:Cc(r,i)})),n=eG.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?Txn(l[0].x):Axn(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)o[(f=l[c]).i]=f.x(u);return o.join("")})}function Ax(e,t){var n=typeof t,r;return t==null||n==="boolean"?GU(t):(n==="number"?Cc:n==="string"?(r=bD(t))?(t=r,VQ):NVe:t instanceof bD?VQ:t instanceof Date?TVe:EVe(t)?Rue:Array.isArray(t)?AVe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?DVe:Cc)(e,t)}function Dxn(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Nxn(e,t){var n=YU(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function XU(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var qwe=180/Math.PI,HQ={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function IVe(e,t,n,r,i,s){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*qwe,skewX:Math.atan(l)*qwe,scaleX:a,scaleY:o}}var kR;function Ixn(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?HQ:IVe(t.a,t.b,t.c,t.d,t.e,t.f)}function Mxn(e){return e==null||(kR||(kR=document.createElementNS("http://www.w3.org/2000/svg","g")),kR.setAttribute("transform",e),!(e=kR.transform.baseVal.consolidate()))?HQ:(e=e.matrix,IVe(e.a,e.b,e.c,e.d,e.e,e.f))}function MVe(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push("translate(",null,t,null,n);p.push({i:g-4,x:Cc(u,f)},{i:g-2,x:Cc(c,h)})}else(f||h)&&d.push("translate("+f+t+h+n)}function a(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:Cc(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function o(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:Cc(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push(i(d)+"scale(",null,",",null,")");p.push({i:g-4,x:Cc(u,f)},{i:g-2,x:Cc(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=e(u),c=e(c),s(u.translateX,u.translateY,c.translateX,c.translateY,f,h),a(u.rotate,c.rotate,f,h),o(u.skewX,c.skewX,f,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,g=h.length,m;++p<g;)f[(m=h[p]).i]=m.x(d);return f.join("")}}}var Fxn=MVe(Ixn,"px, ","px)","deg)"),Oxn=MVe(Mxn,", ",")",")"),Rxn=1e-12;function Gwe(e){return((e=Math.exp(e))+1/e)/2}function Pxn(e){return((e=Math.exp(e))-1/e)/2}function Lxn(e){return((e=Math.exp(2*e))-1)/(e+1)}const Bxn=function e(t,n,r){function i(s,a){var o=s[0],l=s[1],u=s[2],c=a[0],f=a[1],h=a[2],d=c-o,p=f-l,g=d*d+p*p,m,v;if(g<Rxn)v=Math.log(h/u)/t,m=function($){return[o+$*d,l+$*p,u*Math.exp(t*$*v)]};else{var y=Math.sqrt(g),b=(h*h-u*u+r*g)/(2*u*n*y),x=(h*h-u*u-r*g)/(2*h*n*y),w=Math.log(Math.sqrt(b*b+1)-b),C=Math.log(Math.sqrt(x*x+1)-x);v=(C-w)/t,m=function($){var _=$*v,k=Gwe(w),E=u/(n*y)*(k*Lxn(t*_+w)-Pxn(w));return[o+E*d,l+E*p,u*k/Gwe(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(s){var a=Math.max(.001,+s),o=a*a,l=o*o;return e(a,o,l)},i}(Math.SQRT2,2,4);function FVe(e){return function(t,n){var r=e((t=BQ(t)).h,(n=BQ(n)).h),i=ls(t.s,n.s),s=ls(t.l,n.l),a=ls(t.opacity,n.opacity);return function(o){return t.h=r(o),t.s=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const zxn=FVe(YU);var Uxn=FVe(ls);function Wxn(e,t){var n=ls((e=zQ(e)).l,(t=zQ(t)).l),r=ls(e.a,t.a),i=ls(e.b,t.b),s=ls(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=s(a),e+""}}function OVe(e){return function(t,n){var r=e((t=UQ(t)).h,(n=UQ(n)).h),i=ls(t.c,n.c),s=ls(t.l,n.l),a=ls(t.opacity,n.opacity);return function(o){return t.h=r(o),t.c=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const Vxn=OVe(YU);var jxn=OVe(ls);function RVe(e){return function t(n){n=+n;function r(i,s){var a=e((i=WQ(i)).h,(s=WQ(s)).h),o=ls(i.s,s.s),l=ls(i.l,s.l),u=ls(i.opacity,s.opacity);return function(c){return i.h=a(c),i.s=o(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}const Hxn=RVe(YU);var qxn=RVe(ls);function Pue(e,t){t===void 0&&(t=e,e=Ax);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function Gxn(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const Yxn=Object.freeze(Object.defineProperty({__proto__:null,interpolate:Ax,interpolateArray:Exn,interpolateBasis:CVe,interpolateBasisClosed:_Ve,interpolateDate:TVe,interpolateDiscrete:Dxn,interpolateHue:Nxn,interpolateNumber:Cc,interpolateNumberArray:Rue,interpolateObject:DVe,interpolateRound:XU,interpolateString:NVe,interpolateTransformCss:Fxn,interpolateTransformSvg:Oxn,interpolateZoom:Bxn,interpolateRgb:VQ,interpolateRgbBasis:Sxn,interpolateRgbBasisClosed:kxn,interpolateHsl:zxn,interpolateHslLong:Uxn,interpolateLab:Wxn,interpolateHcl:Vxn,interpolateHclLong:jxn,interpolateCubehelix:Hxn,interpolateCubehelixLong:qxn,piecewise:Pue,quantize:Gxn},Symbol.toStringTag,{value:"Module"}));function Xxn(e){return function(){return e}}function qQ(e){return+e}var Ywe=[0,1];function Qo(e){return e}function GQ(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Xxn(isNaN(t)?NaN:.5)}function Kxn(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Zxn(e,t,n){var r=e[0],i=e[1],s=t[0],a=t[1];return i<r?(r=GQ(i,r),s=n(a,s)):(r=GQ(r,i),s=n(s,a)),function(o){return s(r(o))}}function Qxn(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=GQ(e[a],e[a+1]),s[a]=n(t[a],t[a+1]);return function(o){var l=HU(e,o,1,r)-1;return s[l](i[l](o))}}function KM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function KU(){var e=Ywe,t=Ywe,n=Ax,r,i,s,a=Qo,o,l,u;function c(){var h=Math.min(e.length,t.length);return a!==Qo&&(a=Kxn(e[0],e[h-1])),o=h>2?Qxn:Zxn,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?s:(l||(l=o(e.map(r),t,n)))(r(a(h)))}return f.invert=function(h){return a(i((u||(u=o(t,e.map(r),Cc)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,qQ),c()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),n=XU,c()},f.clamp=function(h){return arguments.length?(a=h?!0:Qo,c()):a!==Qo},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,d){return r=h,i=d,c()}}function PVe(){return KU()(Qo,Qo)}function Jxn(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function G6(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function z$(e){return e=G6(Math.abs(e)),e?e[1]:NaN}function e2n(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function t2n(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var n2n=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function db(e){if(!(t=n2n.exec(e)))throw new Error("invalid format: "+e);var t;return new Lue({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}db.prototype=Lue.prototype;function Lue(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Lue.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function r2n(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var LVe;function i2n(e,t){var n=G6(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(LVe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+G6(e,Math.max(0,t+s-1))[0]}function Xwe(e,t){var n=G6(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Kwe={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Jxn,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Xwe(e*100,t),r:Xwe,s:i2n,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Zwe(e){return e}var Qwe=Array.prototype.map,Jwe=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function s2n(e){var t=e.grouping===void 0||e.thousands===void 0?Zwe:e2n(Qwe.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?Zwe:t2n(Qwe.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=db(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):Kwe[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var C=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=g==="$"?r:/[%p]/.test(w)?a:"",_=Kwe[w],k=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(S){var N=C,A=$,D,T,I;if(w==="c")A=_(S)+A,S="";else{S=+S;var F=S<0||1/S<0;if(S=isNaN(S)?l:_(Math.abs(S),b),x&&(S=r2n(S)),F&&+S==0&&p!=="+"&&(F=!1),N=(F?p==="("?p:o:p==="-"||p==="("?"":p)+N,A=(w==="s"?Jwe[8+LVe/3]:"")+A+(F&&p==="("?")":""),k){for(D=-1,T=S.length;++D<T;)if(I=S.charCodeAt(D),48>I||I>57){A=(I===46?i+S.slice(D+1):S.slice(D))+A,S=S.slice(0,D);break}}}y&&!m&&(S=t(S,1/0));var R=N.length+S.length+A.length,P=R<v?new Array(v-R+1).join(h):"";switch(y&&m&&(S=t(P+S,P.length?v-A.length:1/0),P=""),d){case"<":S=N+S+A+P;break;case"=":S=N+P+S+A;break;case"^":S=P.slice(0,R=P.length>>1)+N+S+A+P.slice(R);break;default:S=P+N+S+A;break}return s(S)}return E.toString=function(){return f+""},E}function c(f,h){var d=u((f=db(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(z$(h)/3)))*3,g=Math.pow(10,-p),m=Jwe[8+p/3];return function(v){return d(g*v)+m}}return{format:u,formatPrefix:c}}var ER,ZU,Bue;a2n({thousands:",",grouping:[3],currency:["$",""]});function a2n(e){return ER=s2n(e),ZU=ER.format,Bue=ER.formatPrefix,ER}function BVe(e){return Math.max(0,-z$(Math.abs(e)))}function zVe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(z$(t)/3)))*3-z$(Math.abs(e)))}function UVe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,z$(t)-z$(e))+1}function WVe(e,t,n,r){var i=lxn(e,t,n),s;switch(r=db(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=zVe(i,a))&&(r.precision=s),Bue(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=UVe(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=BVe(i))&&(r.precision=s-(r.type==="%")*2);break}}return ZU(r)}function Tx(e){var t=e.domain;return e.ticks=function(n){var r=t();return PQ(r[0],r[r.length-1],n==null?10:n)},e.tickFormat=function(n,r){var i=t();return WVe(i[0],i[i.length-1],n==null?10:n,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,a=r[i],o=r[s],l,u,c=10;for(o<a&&(u=a,a=o,o=u,u=i,i=s,s=u);c-- >0;){if(u=LQ(a,o,n),u===l)return r[i]=a,r[s]=o,t(r);if(u>0)a=Math.floor(a/u)*u,o=Math.ceil(o/u)*u;else if(u<0)a=Math.ceil(a*u)/u,o=Math.floor(o*u)/u;else break;l=u}return e},e}function VVe(){var e=PVe();return e.copy=function(){return KM(e,VVe())},md.apply(e,arguments),Tx(e)}function jVe(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,qQ),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return jVe(e).unknown(t)},e=arguments.length?Array.from(e,qQ):[0,1],Tx(n)}function HVe(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),e[n]=t.floor(i),e[r]=t.ceil(s),e}function e$e(e){return Math.log(e)}function t$e(e){return Math.exp(e)}function o2n(e){return-Math.log(-e)}function l2n(e){return-Math.exp(-e)}function u2n(e){return isFinite(e)?+("1e"+e):e<0?0:e}function c2n(e){return e===10?u2n:e===Math.E?Math.exp:t=>Math.pow(e,t)}function f2n(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function n$e(e){return(t,n)=>-e(-t,n)}function zue(e){const t=e(e$e,t$e),n=t.domain;let r=10,i,s;function a(){return i=f2n(r),s=c2n(r),n()[0]<0?(i=n$e(i),s=n$e(s),e(o2n,l2n)):e(e$e,t$e),t}return t.base=function(o){return arguments.length?(r=+o,a()):r},t.domain=function(o){return arguments.length?(n(o),a()):n()},t.ticks=o=>{const l=n();let u=l[0],c=l[l.length-1];const f=c<u;f&&([u,c]=[c,u]);let h=i(u),d=i(c),p,g;const m=o==null?10:+o;let v=[];if(!(r%1)&&d-h<m){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(p=1;p<r;++p)if(g=h<0?p/s(-h):p*s(h),!(g<u)){if(g>c)break;v.push(g)}}else for(;h<=d;++h)for(p=r-1;p>=1;--p)if(g=h>0?p/s(-h):p*s(h),!(g<u)){if(g>c)break;v.push(g)}v.length*2<m&&(v=PQ(u,c,m))}else v=PQ(h,d,Math.min(d-h,m)).map(s);return f?v.reverse():v},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=db(l)).precision==null&&(l.trim=!0),l=ZU(l)),o===1/0)return l;const u=Math.max(1,r*o/t.ticks().length);return c=>{let f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=()=>n(HVe(n(),{floor:o=>s(Math.floor(i(o))),ceil:o=>s(Math.ceil(i(o)))})),t}function qVe(){const e=zue(KU()).domain([1,10]);return e.copy=()=>KM(e,qVe()).base(e.base()),md.apply(e,arguments),e}function r$e(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function i$e(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Uue(e){var t=1,n=e(r$e(t),i$e(t));return n.constant=function(r){return arguments.length?e(r$e(t=+r),i$e(t)):t},Tx(n)}function GVe(){var e=Uue(KU());return e.copy=function(){return KM(e,GVe()).constant(e.constant())},md.apply(e,arguments)}function s$e(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function h2n(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function d2n(e){return e<0?-e*e:e*e}function Wue(e){var t=e(Qo,Qo),n=1;function r(){return n===1?e(Qo,Qo):n===.5?e(h2n,d2n):e(s$e(n),s$e(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Tx(t)}function Vue(){var e=Wue(KU());return e.copy=function(){return KM(e,Vue()).exponent(e.exponent())},md.apply(e,arguments),e}function p2n(){return Vue.apply(null,arguments).exponent(.5)}function YVe(){var e=[],t=[],n=[],r;function i(){var a=0,o=Math.max(1,t.length);for(n=new Array(o-1);++a<o;)n[a-1]=uxn(e,a/o);return s}function s(a){return a==null||isNaN(a=+a)?r:t[HU(n,a)]}return s.invertExtent=function(a){var o=t.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},s.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let o of a)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(FA),i()},s.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return YVe().domain(e).range(t).unknown(r)},md.apply(s,arguments)}function XVe(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function a(l){return l!=null&&l<=l?i[HU(r,l,0,n)]:s}function o(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return a}return a.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},a.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,o()):i.slice()},a.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},a.unknown=function(l){return arguments.length&&(s=l),a},a.thresholds=function(){return r.slice()},a.copy=function(){return XVe().domain([e,t]).range(i).unknown(s)},md.apply(Tx(a),arguments)}function KVe(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[HU(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var a=t.indexOf(s);return[e[a-1],e[a]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return KVe().domain(e).range(t).unknown(n)},md.apply(i,arguments)}const tG=new Date,nG=new Date;function Gi(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>Gi(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(tG.setTime(+s),nG.setTime(+a),e(tG),e(nG),Math.floor(n(tG,nG))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const U$=Gi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);U$.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Gi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):U$);U$.range;const fp=1e3,ku=fp*60,hp=ku*60,Yp=hp*24,jue=Yp*7,a$e=Yp*30,rG=Yp*365,dp=Gi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*fp)},(e,t)=>(t-e)/fp,e=>e.getUTCSeconds());dp.range;const QU=Gi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*fp)},(e,t)=>{e.setTime(+e+t*ku)},(e,t)=>(t-e)/ku,e=>e.getMinutes());QU.range;const JU=Gi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ku)},(e,t)=>(t-e)/ku,e=>e.getUTCMinutes());JU.range;const eW=Gi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*fp-e.getMinutes()*ku)},(e,t)=>{e.setTime(+e+t*hp)},(e,t)=>(t-e)/hp,e=>e.getHours());eW.range;const tW=Gi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*hp)},(e,t)=>(t-e)/hp,e=>e.getUTCHours());tW.range;const xp=Gi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ku)/Yp,e=>e.getDate()-1);xp.range;const E0=Gi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Yp,e=>e.getUTCDate()-1);E0.range;const ZVe=Gi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Yp,e=>Math.floor(e/Yp));ZVe.range;function Dx(e){return Gi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*ku)/jue)}const pS=Dx(0),Y6=Dx(1),g2n=Dx(2),m2n=Dx(3),W$=Dx(4),v2n=Dx(5),y2n=Dx(6);pS.range;Y6.range;g2n.range;m2n.range;W$.range;v2n.range;y2n.range;function Nx(e){return Gi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/jue)}const gS=Nx(0),X6=Nx(1),b2n=Nx(2),x2n=Nx(3),V$=Nx(4),w2n=Nx(5),$2n=Nx(6);gS.range;X6.range;b2n.range;x2n.range;V$.range;w2n.range;$2n.range;const wD=Gi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());wD.range;const $D=Gi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());$D.range;const Gh=Gi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Gh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Gi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Gh.range;const Yh=Gi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Yh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Gi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Yh.range;function iG(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function C2n(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function _2n(e){let t,n,r;e.length!==2?(t=iG,n=(o,l)=>iG(e(o),l),r=(o,l)=>e(o)-l):(t=e===iG||e===C2n?e:S2n,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function S2n(){return 0}const k2n=Math.sqrt(50),E2n=Math.sqrt(10),A2n=Math.sqrt(2);function QVe(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=k2n?10:s>=E2n?5:s>=A2n?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?QVe(e,t,n*2):[o,l,u]}function o$e(e,t,n){return t=+t,e=+e,n=+n,QVe(e,t,n)[2]}function l$e(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?o$e(t,e,n):o$e(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function JVe(e,t,n,r,i,s){const a=[[dp,1,fp],[dp,5,5*fp],[dp,15,15*fp],[dp,30,30*fp],[s,1,ku],[s,5,5*ku],[s,15,15*ku],[s,30,30*ku],[i,1,hp],[i,3,3*hp],[i,6,6*hp],[i,12,12*hp],[r,1,Yp],[r,2,2*Yp],[n,1,jue],[t,1,a$e],[t,3,3*a$e],[e,1,rG]];function o(u,c,f){const h=c<u;h&&([u,c]=[c,u]);const d=f&&typeof f.range=="function"?f:l(u,c,f),p=d?d.range(u,+c+1):[];return h?p.reverse():p}function l(u,c,f){const h=Math.abs(c-u)/f,d=_2n(([,,m])=>m).right(a,h);if(d===a.length)return e.every(l$e(u/rG,c/rG,f));if(d===0)return U$.every(Math.max(l$e(u,c,f),1));const[p,g]=a[h/a[d-1][2]<a[d][2]/h?d-1:d];return p.every(g)}return[o,l]}const[T2n,D2n]=JVe(Yh,$D,gS,ZVe,tW,JU),[N2n,I2n]=JVe(Gh,wD,pS,xp,eW,QU);function sG(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function aG(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Lk(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function M2n(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=Bk(i),c=zk(i),f=Bk(s),h=zk(s),d=Bk(a),p=zk(a),g=Bk(o),m=zk(o),v=Bk(l),y=zk(l),b={a:F,A:R,b:P,B:V,c:null,d:p$e,e:p$e,f:nwn,g:hwn,G:pwn,H:J2n,I:ewn,j:twn,L:eje,m:rwn,M:iwn,p:z,q,Q:v$e,s:y$e,S:swn,u:awn,U:own,V:lwn,w:uwn,W:cwn,x:null,X:null,y:fwn,Y:dwn,Z:gwn,"%":m$e},x={a:G,A:K,b:Y,B:te,c:null,d:g$e,e:g$e,f:bwn,g:Twn,G:Nwn,H:mwn,I:vwn,j:ywn,L:nje,m:xwn,M:wwn,p:Z,q:ae,Q:v$e,s:y$e,S:$wn,u:Cwn,U:_wn,V:Swn,w:kwn,W:Ewn,x:null,X:null,y:Awn,Y:Dwn,Z:Iwn,"%":m$e},w={a:E,A:S,b:N,B:A,c:D,d:h$e,e:h$e,f:X2n,g:f$e,G:c$e,H:d$e,I:d$e,j:H2n,L:Y2n,m:j2n,M:q2n,p:k,q:V2n,Q:Z2n,s:Q2n,S:G2n,u:L2n,U:B2n,V:z2n,w:P2n,W:U2n,x:T,X:I,y:f$e,Y:c$e,Z:W2n,"%":K2n};b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x);function C(O,L){return function(W){var M=[],ue=-1,X=0,se=O.length,oe,pe,Ce;for(W instanceof Date||(W=new Date(+W));++ue<se;)O.charCodeAt(ue)===37&&(M.push(O.slice(X,ue)),(pe=u$e[oe=O.charAt(++ue)])!=null?oe=O.charAt(++ue):pe=oe==="e"?" ":"0",(Ce=L[oe])&&(oe=Ce(W,pe)),M.push(oe),X=ue+1);return M.push(O.slice(X,ue)),M.join("")}}function $(O,L){return function(W){var M=Lk(1900,void 0,1),ue=_(M,O,W+="",0),X,se;if(ue!=W.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(L&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(X=aG(Lk(M.y,0,1)),se=X.getUTCDay(),X=se>4||se===0?X6.ceil(X):X6(X),X=E0.offset(X,(M.V-1)*7),M.y=X.getUTCFullYear(),M.m=X.getUTCMonth(),M.d=X.getUTCDate()+(M.w+6)%7):(X=sG(Lk(M.y,0,1)),se=X.getDay(),X=se>4||se===0?Y6.ceil(X):Y6(X),X=xp.offset(X,(M.V-1)*7),M.y=X.getFullYear(),M.m=X.getMonth(),M.d=X.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),se="Z"in M?aG(Lk(M.y,0,1)).getUTCDay():sG(Lk(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(se+5)%7:M.w+M.U*7-(se+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,aG(M)):sG(M)}}function _(O,L,W,M){for(var ue=0,X=L.length,se=W.length,oe,pe;ue<X;){if(M>=se)return-1;if(oe=L.charCodeAt(ue++),oe===37){if(oe=L.charAt(ue++),pe=w[oe in u$e?L.charAt(ue++):oe],!pe||(M=pe(O,W,M))<0)return-1}else if(oe!=W.charCodeAt(M++))return-1}return M}function k(O,L,W){var M=u.exec(L.slice(W));return M?(O.p=c.get(M[0].toLowerCase()),W+M[0].length):-1}function E(O,L,W){var M=d.exec(L.slice(W));return M?(O.w=p.get(M[0].toLowerCase()),W+M[0].length):-1}function S(O,L,W){var M=f.exec(L.slice(W));return M?(O.w=h.get(M[0].toLowerCase()),W+M[0].length):-1}function N(O,L,W){var M=v.exec(L.slice(W));return M?(O.m=y.get(M[0].toLowerCase()),W+M[0].length):-1}function A(O,L,W){var M=g.exec(L.slice(W));return M?(O.m=m.get(M[0].toLowerCase()),W+M[0].length):-1}function D(O,L,W){return _(O,t,L,W)}function T(O,L,W){return _(O,n,L,W)}function I(O,L,W){return _(O,r,L,W)}function F(O){return a[O.getDay()]}function R(O){return s[O.getDay()]}function P(O){return l[O.getMonth()]}function V(O){return o[O.getMonth()]}function z(O){return i[+(O.getHours()>=12)]}function q(O){return 1+~~(O.getMonth()/3)}function G(O){return a[O.getUTCDay()]}function K(O){return s[O.getUTCDay()]}function Y(O){return l[O.getUTCMonth()]}function te(O){return o[O.getUTCMonth()]}function Z(O){return i[+(O.getUTCHours()>=12)]}function ae(O){return 1+~~(O.getUTCMonth()/3)}return{format:function(O){var L=C(O+="",b);return L.toString=function(){return O},L},parse:function(O){var L=$(O+="",!1);return L.toString=function(){return O},L},utcFormat:function(O){var L=C(O+="",x);return L.toString=function(){return O},L},utcParse:function(O){var L=$(O+="",!0);return L.toString=function(){return O},L}}}var u$e={"-":"",_:" ",0:"0"},Es=/^\s*\d+/,F2n=/^%/,O2n=/[\\^$*+?|[\]().{}]/g;function En(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function R2n(e){return e.replace(O2n,"\\$&")}function Bk(e){return new RegExp("^(?:"+e.map(R2n).join("|")+")","i")}function zk(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function P2n(e,t,n){var r=Es.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function L2n(e,t,n){var r=Es.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function B2n(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function z2n(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function U2n(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function c$e(e,t,n){var r=Es.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function f$e(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function W2n(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function V2n(e,t,n){var r=Es.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function j2n(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function h$e(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function H2n(e,t,n){var r=Es.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function d$e(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function q2n(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function G2n(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Y2n(e,t,n){var r=Es.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function X2n(e,t,n){var r=Es.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function K2n(e,t,n){var r=F2n.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Z2n(e,t,n){var r=Es.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Q2n(e,t,n){var r=Es.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function p$e(e,t){return En(e.getDate(),t,2)}function J2n(e,t){return En(e.getHours(),t,2)}function ewn(e,t){return En(e.getHours()%12||12,t,2)}function twn(e,t){return En(1+xp.count(Gh(e),e),t,3)}function eje(e,t){return En(e.getMilliseconds(),t,3)}function nwn(e,t){return eje(e,t)+"000"}function rwn(e,t){return En(e.getMonth()+1,t,2)}function iwn(e,t){return En(e.getMinutes(),t,2)}function swn(e,t){return En(e.getSeconds(),t,2)}function awn(e){var t=e.getDay();return t===0?7:t}function own(e,t){return En(pS.count(Gh(e)-1,e),t,2)}function tje(e){var t=e.getDay();return t>=4||t===0?W$(e):W$.ceil(e)}function lwn(e,t){return e=tje(e),En(W$.count(Gh(e),e)+(Gh(e).getDay()===4),t,2)}function uwn(e){return e.getDay()}function cwn(e,t){return En(Y6.count(Gh(e)-1,e),t,2)}function fwn(e,t){return En(e.getFullYear()%100,t,2)}function hwn(e,t){return e=tje(e),En(e.getFullYear()%100,t,2)}function dwn(e,t){return En(e.getFullYear()%1e4,t,4)}function pwn(e,t){var n=e.getDay();return e=n>=4||n===0?W$(e):W$.ceil(e),En(e.getFullYear()%1e4,t,4)}function gwn(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+En(t/60|0,"0",2)+En(t%60,"0",2)}function g$e(e,t){return En(e.getUTCDate(),t,2)}function mwn(e,t){return En(e.getUTCHours(),t,2)}function vwn(e,t){return En(e.getUTCHours()%12||12,t,2)}function ywn(e,t){return En(1+E0.count(Yh(e),e),t,3)}function nje(e,t){return En(e.getUTCMilliseconds(),t,3)}function bwn(e,t){return nje(e,t)+"000"}function xwn(e,t){return En(e.getUTCMonth()+1,t,2)}function wwn(e,t){return En(e.getUTCMinutes(),t,2)}function $wn(e,t){return En(e.getUTCSeconds(),t,2)}function Cwn(e){var t=e.getUTCDay();return t===0?7:t}function _wn(e,t){return En(gS.count(Yh(e)-1,e),t,2)}function rje(e){var t=e.getUTCDay();return t>=4||t===0?V$(e):V$.ceil(e)}function Swn(e,t){return e=rje(e),En(V$.count(Yh(e),e)+(Yh(e).getUTCDay()===4),t,2)}function kwn(e){return e.getUTCDay()}function Ewn(e,t){return En(X6.count(Yh(e)-1,e),t,2)}function Awn(e,t){return En(e.getUTCFullYear()%100,t,2)}function Twn(e,t){return e=rje(e),En(e.getUTCFullYear()%100,t,2)}function Dwn(e,t){return En(e.getUTCFullYear()%1e4,t,4)}function Nwn(e,t){var n=e.getUTCDay();return e=n>=4||n===0?V$(e):V$.ceil(e),En(e.getUTCFullYear()%1e4,t,4)}function Iwn(){return"+0000"}function m$e(){return"%"}function v$e(e){return+e}function y$e(e){return Math.floor(+e/1e3)}var m2,Hue,ije,que,sje;Mwn({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Mwn(e){return m2=M2n(e),Hue=m2.format,ije=m2.parse,que=m2.utcFormat,sje=m2.utcParse,m2}function Fwn(e){return new Date(e)}function Own(e){return e instanceof Date?+e:+new Date(+e)}function Gue(e,t,n,r,i,s,a,o,l,u){var c=PVe(),f=c.invert,h=c.domain,d=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),x=u("%Y");function w(C){return(l(C)<C?d:o(C)<C?p:a(C)<C?g:s(C)<C?m:r(C)<C?i(C)<C?v:y:n(C)<C?b:x)(C)}return c.invert=function(C){return new Date(f(C))},c.domain=function(C){return arguments.length?h(Array.from(C,Own)):h().map(Fwn)},c.ticks=function(C){var $=h();return e($[0],$[$.length-1],C==null?10:C)},c.tickFormat=function(C,$){return $==null?w:u($)},c.nice=function(C){var $=h();return(!C||typeof C.range!="function")&&(C=t($[0],$[$.length-1],C==null?10:C)),C?h(HVe($,C)):c},c.copy=function(){return KM(c,Gue(e,t,n,r,i,s,a,o,l,u))},c}function Rwn(){return md.apply(Gue(N2n,I2n,Gh,wD,pS,xp,eW,QU,dp,Hue).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Pwn(){return md.apply(Gue(T2n,D2n,Yh,$D,gS,E0,tW,JU,dp,que).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function nW(){var e=0,t=1,n,r,i,s,a=Qo,o=!1,l;function u(f){return f==null||isNaN(f=+f)?l:a(i===0?.5:(f=(s(f)-n)*i,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(a=f,u):a};function c(f){return function(h){var d,p;return arguments.length?([d,p]=h,a=f(d,p),u):[a(0),a(1)]}}return u.range=c(Ax),u.rangeRound=c(XU),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function fv(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Yue(){var e=Tx(nW()(Qo));return e.copy=function(){return fv(e,Yue())},uv.apply(e,arguments)}function aje(){var e=zue(nW()).domain([1,10]);return e.copy=function(){return fv(e,aje()).base(e.base())},uv.apply(e,arguments)}function oje(){var e=Uue(nW());return e.copy=function(){return fv(e,oje()).constant(e.constant())},uv.apply(e,arguments)}function Xue(){var e=Wue(nW());return e.copy=function(){return fv(e,Xue()).exponent(e.exponent())},uv.apply(e,arguments)}function Lwn(){return Xue.apply(null,arguments).exponent(.5)}function rW(){var e=0,t=.5,n=1,r=1,i,s,a,o,l,u=Qo,c,f=!1,h;function d(g){return isNaN(g=+g)?h:(g=.5+((g=+c(g))-s)*(r*g<r*s?o:l),u(f?Math.max(0,Math.min(1,g)):g))}d.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),s=c(t=+t),a=c(n=+n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d):[e,t,n]},d.clamp=function(g){return arguments.length?(f=!!g,d):f},d.interpolator=function(g){return arguments.length?(u=g,d):u};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,u=Pue(g,[v,y,b]),d):[u(0),u(.5),u(1)]}}return d.range=p(Ax),d.rangeRound=p(XU),d.unknown=function(g){return arguments.length?(h=g,d):h},function(g){return c=g,i=g(e),s=g(t),a=g(n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d}}function lje(){var e=Tx(rW()(Qo));return e.copy=function(){return fv(e,lje())},uv.apply(e,arguments)}function uje(){var e=zue(rW()).domain([.1,1,10]);return e.copy=function(){return fv(e,uje()).base(e.base())},uv.apply(e,arguments)}function cje(){var e=Uue(rW());return e.copy=function(){return fv(e,cje()).constant(e.constant())},uv.apply(e,arguments)}function Kue(){var e=Wue(rW());return e.copy=function(){return fv(e,Kue()).exponent(e.exponent())},uv.apply(e,arguments)}function Bwn(){return Kue.apply(null,arguments).exponent(.5)}const A0="year",pb="quarter",wp="month",gb="week",wm="date",mS="day",ZM="dayofyear",mb="hours",vb="minutes",j$="seconds",QM="milliseconds",zwn=[A0,pb,wp,gb,wm,mS,ZM,mb,vb,j$,QM],oG=zwn.reduce((e,t,n)=>(e[t]=1+n,e),{});function Uwn(e){const t=L$(e).slice(),n={};return t.length||br("Missing time unit."),t.forEach(i=>{Is(oG,i)?n[i]=1:br(`Invalid time unit: ${i}.`)}),(n[gb]||n[mS]?1:0)+(n[pb]||n[wp]||n[wm]?1:0)+(n[ZM]?1:0)>1&&br(`Incompatible time units: ${e}`),t.sort((i,s)=>oG[i]-oG[s]),t}const Wwn={[A0]:"%Y ",[pb]:"Q%q ",[wp]:"%b ",[wm]:"%d ",[gb]:"W%U ",[mS]:"%a ",[ZM]:"%j ",[mb]:"%H:00",[vb]:"00:%M",[j$]:":%S",[QM]:".%L",[`${A0}-${wp}`]:"%Y-%m ",[`${A0}-${wp}-${wm}`]:"%Y-%m-%d ",[`${mb}-${vb}`]:"%H:%M"};function Vwn(e,t){const n=Ex({},Wwn,t),r=Uwn(e),i=r.length;let s="",a=0,o,l;for(a=0;a<i;)for(o=r.length;o>a;--o)if(l=r.slice(a,o).join("-"),n[l]!=null){s+=n[l],a=o;break}return s.trim()}const Uk=new Date;function fje(e){return Uk.setFullYear(e),Uk.setMonth(0),Uk.setDate(1),Uk.setHours(0,0,0,0),Uk}function jwn(e){return qwn(new Date(e))}function Hwn(e){return Gwn(new Date(e))}function qwn(e){return xp.count(fje(e.getFullYear())-1,e)}function Gwn(e){return pS.count(fje(e.getFullYear())-1,e)}function Ywn(e){return Kwn(new Date(e))}function Xwn(e){return Zwn(new Date(e))}function Kwn(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return E0.count(t-1,e)}function Zwn(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return gS.count(t-1,e)}const Qwn={[A0]:Gh,[pb]:wD.every(3),[wp]:wD,[gb]:pS,[wm]:xp,[mS]:xp,[ZM]:xp,[mb]:eW,[vb]:QU,[j$]:dp,[QM]:U$},Jwn={[A0]:Yh,[pb]:$D.every(3),[wp]:$D,[gb]:gS,[wm]:E0,[mS]:E0,[ZM]:E0,[mb]:tW,[vb]:JU,[j$]:dp,[QM]:U$};function Zue(e){return Qwn[e]}function Que(e){return Jwn[e]}function hje(e,t,n){return e?e.offset(t,n):void 0}function e$n(e,t,n){return hje(Zue(e),t,n)}function t$n(e,t,n){return hje(Que(e),t,n)}function dje(e,t,n,r){return e?e.range(t,n,r):void 0}function n$n(e,t,n,r){return dje(Zue(e),t,n,r)}function r$n(e,t,n,r){return dje(Que(e),t,n,r)}function pje(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const i$n="identity",Jue="linear",$m="log",ece="pow",tce="sqrt",nce="symlog",CD="time",_D="utc",vS="sequential",JM="diverging",K6="quantile",rce="quantize",gje="threshold",s$n="ordinal",a$n="point",o$n="band",l$n="bin-ordinal",As="continuous",eF="discrete",tF="discretizing",yf="interpolating",ice="temporal";function u$n(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function c$n(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,a,o,l,u;for(i<r&&(o=r,r=i,i=o),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(s<0&&(s=l),a=l);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[a]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function sce(){const e=Iue().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,a=!1,o=0,l=0,u=.5;delete e.unknown;function c(){const f=t().length,h=r[1]<r[0],d=r[1-h],p=pje(f,o,l);let g=r[h-0];i=(d-g)/(p||1),a&&(i=Math.floor(i)),g+=(d-g-i*(f-o))*u,s=i*(1-o),a&&(g=Math.round(g),s=Math.round(s));const m=exn(f).map(v=>g+i*v);return n(h?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),o=l,c()):o},e.paddingInner=function(f){return arguments.length?(o=Math.max(0,Math.min(1,f)),c()):o},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const h=r[1]<r[0],d=h?n().reverse():n(),p=d.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<d[0]||g>r[1-h])))return v=Math.max(0,RQ(d,g)-1),y=g===m?v:RQ(d,m)-1,g-d[v]>s+1e-10&&++v,h&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const h=e.invertRange([f,f]);return h&&h[0]},e.copy=function(){return sce().domain(t()).range(r).round(a).paddingInner(o).paddingOuter(l).align(u)},c()}function mje(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return mje(t())},e}function f$n(){return mje(sce().paddingInner(1))}var h$n=Array.prototype.map;function d$n(e){return h$n.call(e,WU)}const p$n=Array.prototype.slice;function vje(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(Jbn(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=d$n(r),n):e.slice()},n.range=function(r){return arguments.length?(t=p$n.call(r),n):t.slice()},n.tickFormat=function(r,i){return WVe(e[0],$o(e),r==null?10:r,i)},n.copy=function(){return vje().domain(n.domain()).range(n.range())},n}const Z6=new Map,g$n=Symbol("vega_scale");function m$n(e){return e[g$n]=!0,e}function v$n(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?u$n(s):s.invertExtent?c$n(s):void 0),s.type=e,m$n(s)};return r.metadata=W6(L$(n)),r}function Hn(e,t,n){return arguments.length>1?(Z6.set(e,v$n(e,t,n)),this):y$n(e)?Z6.get(e):void 0}Hn(i$n,jVe);Hn(Jue,VVe,As);Hn($m,qVe,[As,$m]);Hn(ece,Vue,As);Hn(tce,p2n,As);Hn(nce,GVe,As);Hn(CD,Rwn,[As,ice]);Hn(_D,Pwn,[As,ice]);Hn(vS,Yue,[As,yf]);Hn(`${vS}-${Jue}`,Yue,[As,yf]);Hn(`${vS}-${$m}`,aje,[As,yf,$m]);Hn(`${vS}-${ece}`,Xue,[As,yf]);Hn(`${vS}-${tce}`,Lwn,[As,yf]);Hn(`${vS}-${nce}`,oje,[As,yf]);Hn(`${JM}-${Jue}`,lje,[As,yf]);Hn(`${JM}-${$m}`,uje,[As,yf,$m]);Hn(`${JM}-${ece}`,Kue,[As,yf]);Hn(`${JM}-${tce}`,Bwn,[As,yf]);Hn(`${JM}-${nce}`,cje,[As,yf]);Hn(K6,YVe,[tF,K6]);Hn(rce,XVe,tF);Hn(gje,KVe,tF);Hn(l$n,vje,[eF,tF]);Hn(s$n,Iue,eF);Hn(o$n,sce,eF);Hn(a$n,f$n,eF);function y$n(e){return Z6.has(e)}function iW(e,t){const n=Z6.get(e);return n&&n.metadata[t]}function yje(e){return iW(e,eF)}function b$n(e){return iW(e,tF)}function x$n(e){return iW(e,$m)}function w$n(e){return iW(e,ice)}const $$n=["clamp","base","constant","exponent"];function C$n(e,t,n){return Pue(S$n(t||"rgb",n),e)}function _$n(e,t,n){const r=n-t;let i,s,a;return!r||!Number.isFinite(r)?wbn(.5):(i=(s=e.type).indexOf("-"),s=i<0?s:s.slice(i+1),a=Hn(s)().domain([t,n]).range([0,1]),$$n.forEach(o=>e[o]?a[o](e[o]()):0),a)}function S$n(e,t){const n=Yxn[k$n(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function k$n(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const E$n={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},A$n={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function bje(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function xje(e,t){for(const n in e)T$n(n,t(e[n]))}const b$e={};xje(A$n,bje);xje(E$n,e=>C$n(bje(e)));function T$n(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(b$e[e]=t,this):b$e[e]}const D$n="symbol",N$n="discrete",I$n=e=>Oa(e)?e.map(t=>String(t)):String(e),M$n=(e,t)=>e[1]-t[1],F$n=(e,t)=>t[1]-e[1];function O$n(e,t,n){let r=e.range(),i=r[0],s=$o(r),a=M$n;if(i>s&&(r=s,s=i,i=r,a=F$n),i=Math.floor(i),s=Math.ceil(s),t=t.map(o=>[o,e(o)]).filter(o=>i<=o[1]&&o[1]<=s).sort(a).map(o=>o[0]),n>0&&t.length>1){const o=[t[0],$o(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=o)}return t}function wje(e,t){return e.bins?O$n(e,e.bins):e.ticks?e.ticks(t):e.domain()}function R$n(e,t,n,r,i,s){const a=t.type;let o=I$n;if(a===CD||i===CD)o=e.timeFormat(r);else if(a===_D||i===_D)o=e.utcFormat(r);else if(x$n(a)){const l=e.formatFloat(r);if(s||t.bins)o=l;else{const u=$je(t,n,!1);o=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();o=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(o=e.format(r));return o}function $je(e,t,n){const r=wje(e,t),i=e.base(),s=Math.log(i),a=Math.max(1,i*t/r.length),o=l=>{let u=l/Math.pow(i,Math.round(Math.log(l)/s));return u*i<i-.5&&(u*=i),u<=a};return n?r.filter(o):o}const YQ={[K6]:"quantiles",[rce]:"thresholds",[gje]:"domain"},Cje={[K6]:"quantiles",[rce]:"domain"};function P$n(e,t){return e.bins?z$n(e.bins):e.type===$m?$je(e,t,!0):YQ[e.type]?B$n(e[YQ[e.type]]()):wje(e,t)}function L$n(e,t,n){const r=t[Cje[t.type]](),i=r.length;let s=i>1?r[1]-r[0]:r[0],a;for(a=1;a<i;++a)s=Math.min(s,r[a]-r[a-1]);return e.formatSpan(0,s,3*10,n)}function B$n(e){const t=[-1/0].concat(e);return t.max=1/0,t}function z$n(e){const t=e.slice(0,-1);return t.max=$o(e),t}const U$n=e=>YQ[e.type]||e.bins;function W$n(e,t,n,r,i,s,a){const o=Cje[t.type]&&s!==CD&&s!==_D?L$n(e,t,i):R$n(e,t,n,i,s,a);return r===D$n&&U$n(t)?V$n(o):r===N$n?j$n(o):H$n(o)}const V$n=e=>(t,n,r)=>{const i=x$e(r[n+1],x$e(r.max,1/0)),s=w$e(t,e),a=w$e(i,e);return s&&a?s+" \u2013 "+a:a?"< "+a:"\u2265 "+s},x$e=(e,t)=>e!=null?e:t,j$n=e=>(t,n)=>n?e(t):null,H$n=e=>t=>e(t),w$e=(e,t)=>Number.isFinite(e)?t(e):null;function q$n(e,t,n,r){const i=r||t.type;return xm(n)&&w$n(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===CD?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===_D?e.utcFormat("%A, %d %B %Y, %X UTC"):W$n(e,t,5,null,n,r,!0)}function _je(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=q$n(e,t,n.format,n.formatType);if(b$n(t.type)){const s=P$n(t).slice(1).map(i),a=s.length;return`${a} boundar${a===1?"y":"ies"}: ${s.join(", ")}`}else if(yje(t.type)){const s=t.domain(),a=s.length,o=a>r?s.slice(0,r-2).map(i).join(", ")+", ending with "+s.slice(-1).map(i):s.map(i).join(", ");return`${a} value${a===1?"":"s"}: ${o}`}else{const s=t.domain();return`values from ${i(s[0])} to ${i($o(s))}`}}function Mn(e){return function(){return e}}const $$e=Math.abs,ta=Math.atan2,Mv=Math.cos,G$n=Math.max,lG=Math.min,Nf=Math.sin,W1=Math.sqrt,sa=1e-12,H$=Math.PI,Q6=H$/2,Sje=2*H$;function Y$n(e){return e>1?0:e<-1?H$:Math.acos(e)}function C$e(e){return e>=1?Q6:e<=-1?-Q6:Math.asin(e)}const XQ=Math.PI,KQ=2*XQ,t1=1e-6,X$n=KQ-t1;function kje(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function K$n(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return kje;const n=10**t;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class ace{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?kje:K$n(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,a){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,l=r-t,u=i-n,c=a-t,f=o-n,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>t1)if(!(Math.abs(f*l-u*c)>t1)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let d=r-a,p=i-o,g=l*l+u*u,m=d*d+p*p,v=Math.sqrt(g),y=Math.sqrt(h),b=s*Math.tan((XQ-Math.acos((g+h-m)/(2*v*y)))/2),x=b/y,w=b/v;Math.abs(x-1)>t1&&this._append`L${t+x*c},${n+x*f}`,this._append`A${s},${s},0,0,${+(f*d>c*p)},${this._x1=t+w*l},${this._y1=n+w*u}`}}arc(t,n,r,i,s,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),l=r*Math.sin(i),u=t+o,c=n+l,f=1^a,h=a?i-s:s-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>t1||Math.abs(this._y1-c)>t1)&&this._append`L${u},${c}`,r&&(h<0&&(h=h%KQ+KQ),h>X$n?this._append`A${r},${r},0,1,${f},${t-o},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:h>t1&&this._append`A${r},${r},0,${+(h>=XQ)},${f},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function oce(){return new ace}oce.prototype=ace.prototype;function sW(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new ace(t)}function Z$n(e){return e.innerRadius}function Q$n(e){return e.outerRadius}function J$n(e){return e.startAngle}function eCn(e){return e.endAngle}function tCn(e){return e&&e.padAngle}function nCn(e,t,n,r,i,s,a,o){var l=n-e,u=r-t,c=a-i,f=o-s,h=f*l-c*u;if(!(h*h<sa))return h=(c*(t-s)-f*(e-i))/h,[e+h*l,t+h*u]}function AR(e,t,n,r,i,s,a){var o=e-n,l=t-r,u=(a?s:-s)/W1(o*o+l*l),c=u*l,f=-u*o,h=e+c,d=t+f,p=n+c,g=r+f,m=(h+p)/2,v=(d+g)/2,y=p-h,b=g-d,x=y*y+b*b,w=i-s,C=h*g-p*d,$=(b<0?-1:1)*W1(G$n(0,w*w*x-C*C)),_=(C*b-y*$)/x,k=(-C*y-b*$)/x,E=(C*b+y*$)/x,S=(-C*y+b*$)/x,N=_-m,A=k-v,D=E-m,T=S-v;return N*N+A*A>D*D+T*T&&(_=E,k=S),{cx:_,cy:k,x01:-c,y01:-f,x11:_*(i/w-1),y11:k*(i/w-1)}}function rCn(){var e=Z$n,t=Q$n,n=Mn(0),r=null,i=J$n,s=eCn,a=tCn,o=null,l=sW(u);function u(){var c,f,h=+e.apply(this,arguments),d=+t.apply(this,arguments),p=i.apply(this,arguments)-Q6,g=s.apply(this,arguments)-Q6,m=$$e(g-p),v=g>p;if(o||(o=c=l()),d<h&&(f=d,d=h,h=f),!(d>sa))o.moveTo(0,0);else if(m>Sje-sa)o.moveTo(d*Mv(p),d*Nf(p)),o.arc(0,0,d,p,g,!v),h>sa&&(o.moveTo(h*Mv(g),h*Nf(g)),o.arc(0,0,h,g,p,v));else{var y=p,b=g,x=p,w=g,C=m,$=m,_=a.apply(this,arguments)/2,k=_>sa&&(r?+r.apply(this,arguments):W1(h*h+d*d)),E=lG($$e(d-h)/2,+n.apply(this,arguments)),S=E,N=E,A,D;if(k>sa){var T=C$e(k/h*Nf(_)),I=C$e(k/d*Nf(_));(C-=T*2)>sa?(T*=v?1:-1,x+=T,w-=T):(C=0,x=w=(p+g)/2),($-=I*2)>sa?(I*=v?1:-1,y+=I,b-=I):($=0,y=b=(p+g)/2)}var F=d*Mv(y),R=d*Nf(y),P=h*Mv(w),V=h*Nf(w);if(E>sa){var z=d*Mv(b),q=d*Nf(b),G=h*Mv(x),K=h*Nf(x),Y;if(m<H$)if(Y=nCn(F,R,G,K,z,q,P,V)){var te=F-Y[0],Z=R-Y[1],ae=z-Y[0],O=q-Y[1],L=1/Nf(Y$n((te*ae+Z*O)/(W1(te*te+Z*Z)*W1(ae*ae+O*O)))/2),W=W1(Y[0]*Y[0]+Y[1]*Y[1]);S=lG(E,(h-W)/(L-1)),N=lG(E,(d-W)/(L+1))}else S=N=0}$>sa?N>sa?(A=AR(G,K,F,R,d,N,v),D=AR(z,q,P,V,d,N,v),o.moveTo(A.cx+A.x01,A.cy+A.y01),N<E?o.arc(A.cx,A.cy,N,ta(A.y01,A.x01),ta(D.y01,D.x01),!v):(o.arc(A.cx,A.cy,N,ta(A.y01,A.x01),ta(A.y11,A.x11),!v),o.arc(0,0,d,ta(A.cy+A.y11,A.cx+A.x11),ta(D.cy+D.y11,D.cx+D.x11),!v),o.arc(D.cx,D.cy,N,ta(D.y11,D.x11),ta(D.y01,D.x01),!v))):(o.moveTo(F,R),o.arc(0,0,d,y,b,!v)):o.moveTo(F,R),!(h>sa)||!(C>sa)?o.lineTo(P,V):S>sa?(A=AR(P,V,z,q,h,-S,v),D=AR(F,R,G,K,h,-S,v),o.lineTo(A.cx+A.x01,A.cy+A.y01),S<E?o.arc(A.cx,A.cy,S,ta(A.y01,A.x01),ta(D.y01,D.x01),!v):(o.arc(A.cx,A.cy,S,ta(A.y01,A.x01),ta(A.y11,A.x11),!v),o.arc(0,0,h,ta(A.cy+A.y11,A.cx+A.x11),ta(D.cy+D.y11,D.cx+D.x11),v),o.arc(D.cx,D.cy,S,ta(D.y11,D.x11),ta(D.y01,D.x01),!v))):o.arc(0,0,h,w,x,v)}if(o.closePath(),c)return o=null,c+""||null}return u.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-H$/2;return[Mv(f)*c,Nf(f)*c]},u.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Mn(+c),u):e},u.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Mn(+c),u):t},u.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Mn(+c),u):n},u.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Mn(+c),u):r},u.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:Mn(+c),u):i},u.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Mn(+c),u):s},u.padAngle=function(c){return arguments.length?(a=typeof c=="function"?c:Mn(+c),u):a},u.context=function(c){return arguments.length?(o=c==null?null:c,u):o},u}function Eje(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Aje(e){this._context=e}Aje.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function lce(e){return new Aje(e)}function Tje(e){return e[0]}function Dje(e){return e[1]}function Nje(e,t){var n=Mn(!0),r=null,i=lce,s=null,a=sW(o);e=typeof e=="function"?e:e===void 0?Tje:Mn(e),t=typeof t=="function"?t:t===void 0?Dje:Mn(t);function o(l){var u,c=(l=Eje(l)).length,f,h=!1,d;for(r==null&&(s=i(d=a())),u=0;u<=c;++u)!(u<c&&n(f=l[u],u,l))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(f,u,l),+t(f,u,l));if(d)return s=null,d+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:Mn(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:Mn(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:Mn(!!l),o):n},o.curve=function(l){return arguments.length?(i=l,r!=null&&(s=i(r)),o):i},o.context=function(l){return arguments.length?(l==null?r=s=null:s=i(r=l),o):r},o}function Ije(e,t,n){var r=null,i=Mn(!0),s=null,a=lce,o=null,l=sW(u);e=typeof e=="function"?e:e===void 0?Tje:Mn(+e),t=typeof t=="function"?t:Mn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?Dje:Mn(+n);function u(f){var h,d,p,g=(f=Eje(f)).length,m,v=!1,y,b=new Array(g),x=new Array(g);for(s==null&&(o=a(y=l())),h=0;h<=g;++h){if(!(h<g&&i(m=f[h],h,f))===v)if(v=!v)d=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=h-1;p>=d;--p)o.point(b[p],x[p]);o.lineEnd(),o.areaEnd()}v&&(b[h]=+e(m,h,f),x[h]=+t(m,h,f),o.point(r?+r(m,h,f):b[h],n?+n(m,h,f):x[h]))}if(y)return o=null,y+""||null}function c(){return Nje().defined(i).curve(a).context(s)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:Mn(+f),r=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Mn(+f),u):e},u.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Mn(+f),u):r},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:Mn(+f),n=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Mn(+f),u):t},u.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Mn(+f),u):n},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(n)},u.lineX1=function(){return c().x(r).y(t)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:Mn(!!f),u):i},u.curve=function(f){return arguments.length?(a=f,s!=null&&(o=a(s)),u):a},u.context=function(f){return arguments.length?(f==null?s=o=null:o=a(s=f),u):s},u}const iCn={draw(e,t){const n=W1(t/H$);e.moveTo(n,0),e.arc(0,0,n,0,Sje)}};function sCn(e,t){let n=null,r=sW(i);e=typeof e=="function"?e:Mn(e||iCn),t=typeof t=="function"?t:Mn(t===void 0?64:+t);function i(){let s;if(n||(n=s=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:Mn(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:Mn(+s),i):t},i.context=function(s){return arguments.length?(n=s==null?null:s,i):n},i}function Cm(){}function J6(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function aW(e){this._context=e}aW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:J6(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:J6(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function aCn(e){return new aW(e)}function Mje(e){this._context=e}Mje.prototype={areaStart:Cm,areaEnd:Cm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:J6(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function oCn(e){return new Mje(e)}function Fje(e){this._context=e}Fje.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:J6(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function lCn(e){return new Fje(e)}function Oje(e,t){this._basis=new aW(e),this._beta=t}Oje.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,a=t[n]-i,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*s),this._beta*t[o]+(1-this._beta)*(i+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const uCn=function e(t){function n(r){return t===1?new aW(r):new Oje(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function e8(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function uce(e,t){this._context=e,this._k=(1-t)/6}uce.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:e8(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:e8(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const cCn=function e(t){function n(r){return new uce(r,t)}return n.tension=function(r){return e(+r)},n}(0);function cce(e,t){this._context=e,this._k=(1-t)/6}cce.prototype={areaStart:Cm,areaEnd:Cm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:e8(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const fCn=function e(t){function n(r){return new cce(r,t)}return n.tension=function(r){return e(+r)},n}(0);function fce(e,t){this._context=e,this._k=(1-t)/6}fce.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:e8(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const hCn=function e(t){function n(r){return new fce(r,t)}return n.tension=function(r){return e(+r)},n}(0);function hce(e,t,n){var r=e._x1,i=e._y1,s=e._x2,a=e._y2;if(e._l01_a>sa){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>sa){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,s,a,e._x2,e._y2)}function Rje(e,t){this._context=e,this._alpha=t}Rje.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:hce(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const dCn=function e(t){function n(r){return t?new Rje(r,t):new uce(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Pje(e,t){this._context=e,this._alpha=t}Pje.prototype={areaStart:Cm,areaEnd:Cm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:hce(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const pCn=function e(t){function n(r){return t?new Pje(r,t):new cce(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Lje(e,t){this._context=e,this._alpha=t}Lje.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:hce(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const gCn=function e(t){function n(r){return t?new Lje(r,t):new fce(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Bje(e){this._context=e}Bje.prototype={areaStart:Cm,areaEnd:Cm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function mCn(e){return new Bje(e)}function _$e(e){return e<0?-1:1}function S$e(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),o=(s*i+a*r)/(r+i);return(_$e(s)+_$e(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function k$e(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function uG(e,t,n){var r=e._x0,i=e._y0,s=e._x1,a=e._y1,o=(s-r)/3;e._context.bezierCurveTo(r+o,i+o*t,s-o,a-o*n,s,a)}function t8(e){this._context=e}t8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:uG(this,this._t0,k$e(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,uG(this,k$e(this,n=S$e(this,e,t)),n);break;default:uG(this,this._t0,n=S$e(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function zje(e){this._context=new Uje(e)}(zje.prototype=Object.create(t8.prototype)).point=function(e,t){t8.prototype.point.call(this,t,e)};function Uje(e){this._context=e}Uje.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function vCn(e){return new t8(e)}function yCn(e){return new zje(e)}function Wje(e){this._context=e}Wje.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=E$e(e),i=E$e(t),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function E$e(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),a=new Array(n);for(i[0]=0,s[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function bCn(e){return new Wje(e)}function oW(e,t){this._context=e,this._t=t}oW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function xCn(e){return new oW(e,.5)}function wCn(e){return new oW(e,0)}function $Cn(e){return new oW(e,1)}const CCn=Math.sqrt(50),_Cn=Math.sqrt(10),SCn=Math.sqrt(2);function Vje(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=CCn?10:s>=_Cn?5:s>=SCn?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?Vje(e,t,n*2):[o,l,u]}function A$e(e,t,n){return t=+t,e=+e,n=+n,Vje(e,t,n)[2]}function kCn(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?A$e(t,e,n):A$e(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function KE(e){const t={};return n=>t[n]||(t[n]=e(n))}function ECn(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=ACn(r,i);const a=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+a}}function ACn(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function TCn(e){const t=KE(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=db(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return ECn(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,a){a=db(a==null?",f":a);const o=kCn(r,i,s),l=Math.max(Math.abs(r),Math.abs(i));let u;if(a.precision==null)switch(a.type){case"s":return isNaN(u=zVe(o,l))||(a.precision=u),n(a,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=UVe(o,l))||(a.precision=u-(a.type==="e"));break}case"f":case"%":{isNaN(u=BVe(o))||(a.precision=u-(a.type==="%")*2);break}}return t(a)}}}DCn();function DCn(){return TCn({format:ZU,formatPrefix:Bue})}function T$e(e,t,n){n=n||{},gD(n)||br(`Invalid time multi-format specifier: ${n}`);const r=t(j$),i=t(vb),s=t(mb),a=t(wm),o=t(gb),l=t(wp),u=t(pb),c=t(A0),f=e(n[QM]||".%L"),h=e(n[j$]||":%S"),d=e(n[vb]||"%I:%M"),p=e(n[mb]||"%I %p"),g=e(n[wm]||n[mS]||"%a %d"),m=e(n[gb]||"%b %d"),v=e(n[wp]||"%B"),y=e(n[pb]||"%B"),b=e(n[A0]||"%Y");return x=>(r(x)<x?f:i(x)<x?h:s(x)<x?d:a(x)<x?p:l(x)<x?o(x)<x?g:m:c(x)<x?u(x)<x?v:y:b)(x)}function NCn(e){const t=KE(e.format),n=KE(e.utcFormat);return{timeFormat:r=>xm(r)?t(r):T$e(t,Zue,r),utcFormat:r=>xm(r)?n(r):T$e(n,Que,r),timeParse:KE(e.parse),utcParse:KE(e.utcParse)}}ICn();function ICn(){return NCn({format:Hue,parse:ije,utcFormat:que,utcParse:sje})}const MCn=/^(data:|([A-Za-z]+:)?\/\/)/,FCn=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,OCn=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,D$e="file://";function RCn(e,t){return n=>({options:n||{},sanitize:LCn,load:PCn,fileAccess:!!t,file:BCn(t),http:UCn(e)})}async function PCn(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function LCn(e,t){t=Ex({},this.options,t);const n=this.fileAccess,r={href:null};let i,s,a;const o=FCn.test(e.replace(OCn,""));(e==null||typeof e!="string"||!o)&&br("Sanitize failure, invalid URI: "+mD(e));const l=MCn.test(e);return(a=t.baseURL)&&!l&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),s=(i=e.startsWith(D$e))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice(D$e.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!s}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function BCn(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,s)=>{i?r(i):n(s)})}):zCn}async function zCn(){br("No file system access.")}function UCn(e){return e?async function(t,n){const r=Ex({},this.options.http,n),i=n&&n.response,s=await e(t,r);return s.ok?bm(s[i])?s[i]():s.text():br(s.status+""+s.statusText)}:WCn}async function WCn(){br("No HTTP fetch method available.")}const jje=RCn(typeof fetch<"u"&&fetch,null);let VCn=0;const n8="p_";function dce(e){return e&&e.gradient}function Hje(e,t,n){const r=e.gradient;let i=e.id,s=r==="radial"?n8:"";return i||(i=e.id="gradient_"+VCn++,r==="radial"?(e.x1=If(e.x1,.5),e.y1=If(e.y1,.5),e.r1=If(e.r1,0),e.x2=If(e.x2,.5),e.y2=If(e.y2,.5),e.r2=If(e.r2,.5),s=n8):(e.x1=If(e.x1,0),e.y1=If(e.y1,0),e.x2=If(e.x2,1),e.y2=If(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+s+i+")"}function If(e,t){return e!=null?e:t}function jCn(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,s){return n.push({offset:i,color:s}),r}}}const N$e={basis:{curve:aCn},"basis-closed":{curve:oCn},"basis-open":{curve:lCn},bundle:{curve:uCn,tension:"beta",value:.85},cardinal:{curve:cCn,tension:"tension",value:0},"cardinal-open":{curve:hCn,tension:"tension",value:0},"cardinal-closed":{curve:fCn,tension:"tension",value:0},"catmull-rom":{curve:dCn,tension:"alpha",value:.5},"catmull-rom-closed":{curve:pCn,tension:"alpha",value:.5},"catmull-rom-open":{curve:gCn,tension:"alpha",value:.5},linear:{curve:lce},"linear-closed":{curve:mCn},monotone:{horizontal:yCn,vertical:vCn},natural:{curve:bCn},step:{curve:xCn},"step-after":{curve:$Cn},"step-before":{curve:wCn}};function qje(e,t,n){var r=Is(N$e,e)&&N$e[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const HCn={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},qCn=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,GCn=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,YCn=/^((\s+,?\s*)|(,\s*))/,XCn=/^[01]/;function pce(e){const t=[];return(e.match(qCn)||[]).forEach(r=>{let i=r[0];const s=i.toLowerCase(),a=HCn[s],o=KCn(s,a,r.slice(1).trim()),l=o.length;if(l<a||l&&l%a!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...o.slice(0,a)]),l!==a){s==="m"&&(i=i==="M"?"L":"l");for(let u=a;u<l;u+=a)t.push([i,...o.slice(u,u+a)])}}),t}function KCn(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let s=0;s<t;++s){const a=e==="a"&&(s===3||s===4)?XCn:GCn,o=n.slice(i).match(a);if(o===null)throw Error("Invalid SVG path, incorrect parameter type");i+=o[0].length,r.push(+o[0]);const l=n.slice(i).match(YCn);l!==null&&(i+=l[0].length)}return r}const _m=Math.PI/180,ZCn=1e-14,y1=Math.PI/2,Yf=Math.PI*2,v2=Math.sqrt(3)/2;var cG={},fG={},Gje=[].join;function QCn(e,t,n,r,i,s,a,o,l){const u=Gje.call(arguments);if(cG[u])return cG[u];const c=a*_m,f=Math.sin(c),h=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const d=h*(o-e)*.5+f*(l-t)*.5,p=h*(l-t)*.5-f*(o-e)*.5;let g=d*d/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=h/n,v=f/n,y=-f/r,b=h/r,x=m*o+v*l,w=y*o+b*l,C=m*e+v*t,$=y*e+b*t;let k=1/((C-x)*(C-x)+($-w)*($-w))-.25;k<0&&(k=0);let E=Math.sqrt(k);s==i&&(E=-E);const S=.5*(x+C)-E*($-w),N=.5*(w+$)+E*(C-x),A=Math.atan2(w-N,x-S);let T=Math.atan2($-N,C-S)-A;T<0&&s===1?T+=Yf:T>0&&s===0&&(T-=Yf);const I=Math.ceil(Math.abs(T/(y1+.001))),F=[];for(let R=0;R<I;++R){const P=A+R*T/I,V=A+(R+1)*T/I;F[R]=[S,N,P,V,n,r,f,h]}return cG[u]=F}function JCn(e){const t=Gje.call(e);if(fG[t])return fG[t];var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7];const c=u*a,f=-l*o,h=l*a,d=u*o,p=Math.cos(i),g=Math.sin(i),m=Math.cos(s),v=Math.sin(s),y=.5*(s-i),b=Math.sin(y*.5),x=8/3*b*b/Math.sin(y),w=n+p-x*g,C=r+g+x*p,$=n+m,_=r+v,k=$+x*v,E=_-x*m;return fG[t]=[c*w+f*C,h*w+d*C,c*k+f*E,h*k+d*E,c*$+f*_,h*$+d*_]}const ou=["l",0,0,0,0,0,0,0];function e_n(e,t,n){const r=ou[0]=e[0];if(r==="a"||r==="A")ou[1]=t*e[1],ou[2]=n*e[2],ou[3]=e[3],ou[4]=e[4],ou[5]=e[5],ou[6]=t*e[6],ou[7]=n*e[7];else if(r==="h"||r==="H")ou[1]=t*e[1];else if(r==="v"||r==="V")ou[1]=n*e[1];else for(var i=1,s=e.length;i<s;++i)ou[i]=(i%2==1?t:n)*e[i];return ou}function r8(e,t,n,r,i,s){var a,o=null,l=0,u=0,c=0,f=0,h,d,p,g,m=0,v=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),s==null&&(s=i),e.beginPath&&e.beginPath();for(var y=0,b=t.length;y<b;++y){switch(a=t[y],(i!==1||s!==1)&&(a=e_n(a,i,s)),a[0]){case"l":l+=a[1],u+=a[2],e.lineTo(l+n,u+r);break;case"L":l=a[1],u=a[2],e.lineTo(l+n,u+r);break;case"h":l+=a[1],e.lineTo(l+n,u+r);break;case"H":l=a[1],e.lineTo(l+n,u+r);break;case"v":u+=a[1],e.lineTo(l+n,u+r);break;case"V":u=a[1],e.lineTo(l+n,u+r);break;case"m":l+=a[1],u+=a[2],m=l,v=u,e.moveTo(l+n,u+r);break;case"M":l=a[1],u=a[2],m=l,v=u,e.moveTo(l+n,u+r);break;case"c":h=l+a[5],d=u+a[6],c=l+a[3],f=u+a[4],e.bezierCurveTo(l+a[1]+n,u+a[2]+r,c+n,f+r,h+n,d+r),l=h,u=d;break;case"C":l=a[5],u=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,c+n,f+r,l+n,u+r);break;case"s":h=l+a[3],d=u+a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,l+a[1]+n,u+a[2]+r,h+n,d+r),c=l+a[1],f=u+a[2],l=h,u=d;break;case"S":h=a[3],d=a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,a[1]+n,a[2]+r,h+n,d+r),l=h,u=d,c=a[1],f=a[2];break;case"q":h=l+a[3],d=u+a[4],c=l+a[1],f=u+a[2],e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d;break;case"Q":h=a[3],d=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,h+n,d+r),l=h,u=d,c=a[1],f=a[2];break;case"t":h=l+a[1],d=u+a[2],o[0].match(/[QqTt]/)===null?(c=l,f=u):o[0]==="t"?(c=2*l-p,f=2*u-g):o[0]==="q"&&(c=2*l-c,f=2*u-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d,c=l+a[1],f=u+a[2];break;case"T":h=a[1],d=a[2],c=2*l-c,f=2*u-f,e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d;break;case"a":I$e(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+l+n,a[7]+u+r]),l+=a[6],u+=a[7];break;case"A":I$e(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),l=a[6],u=a[7];break;case"z":case"Z":l=m,u=v,e.closePath();break}o=a}}function I$e(e,t,n,r){const i=QCn(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let s=0;s<i.length;++s){const a=JCn(i[s]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const M$e=.5773502691896257,F$e={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Yf)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,s=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-s),e.lineTo(i,-s),e.lineTo(0,-n),e.lineTo(-i,-s),e.lineTo(-r,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=v2*n,i=r-n*M$e,s=n/4;e.moveTo(0,-r-i),e.lineTo(-s,r-i),e.lineTo(s,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=v2*n,i=r-n*M$e;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=v2*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=v2*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=v2*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=v2*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function t_n(e){return Is(F$e,e)?F$e[e]:n_n(e)}var hG={};function n_n(e){if(!Is(hG,e)){const t=pce(e);hG[e]={draw:function(n,r){r8(n,t,0,0,Math.sqrt(r)/2)}}}return hG[e]}const Ng=.448084975506;function r_n(e){return e.x}function i_n(e){return e.y}function s_n(e){return e.width}function a_n(e){return e.height}function Fd(e){return typeof e=="function"?e:()=>+e}function TR(e,t,n){return Math.max(t,Math.min(e,n))}function o_n(){var e=r_n,t=i_n,n=s_n,r=a_n,i=Fd(0),s=i,a=i,o=i,l=null;function u(c,f,h){var d,p=f!=null?f:+e.call(this,c),g=h!=null?h:+t.call(this,c),m=+n.call(this,c),v=+r.call(this,c),y=Math.min(m,v)/2,b=TR(+i.call(this,c),0,y),x=TR(+s.call(this,c),0,y),w=TR(+a.call(this,c),0,y),C=TR(+o.call(this,c),0,y);if(l||(l=d=oce()),b<=0&&x<=0&&w<=0&&C<=0)l.rect(p,g,m,v);else{var $=p+m,_=g+v;l.moveTo(p+b,g),l.lineTo($-x,g),l.bezierCurveTo($-Ng*x,g,$,g+Ng*x,$,g+x),l.lineTo($,_-C),l.bezierCurveTo($,_-Ng*C,$-Ng*C,_,$-C,_),l.lineTo(p+w,_),l.bezierCurveTo(p+Ng*w,_,p,_-Ng*w,p,_-w),l.lineTo(p,g+b),l.bezierCurveTo(p,g+Ng*b,p+Ng*b,g,p+b,g),l.closePath()}if(d)return l=null,d+""||null}return u.x=function(c){return arguments.length?(e=Fd(c),u):e},u.y=function(c){return arguments.length?(t=Fd(c),u):t},u.width=function(c){return arguments.length?(n=Fd(c),u):n},u.height=function(c){return arguments.length?(r=Fd(c),u):r},u.cornerRadius=function(c,f,h,d){return arguments.length?(i=Fd(c),s=f!=null?Fd(f):i,o=h!=null?Fd(h):i,a=d!=null?Fd(d):s,u):i},u.context=function(c){return arguments.length?(l=c==null?null:c,u):l},u}function l_n(){var e,t,n,r,i=null,s,a,o,l;function u(f,h,d){const p=d/2;if(s){var g=o-h,m=f-a;if(g||m){var v=Math.sqrt(g*g+m*m),y=(g/=v)*l,b=(m/=v)*l,x=Math.atan2(m,g);i.moveTo(a-y,o-b),i.lineTo(f-g*p,h-m*p),i.arc(f,h,p,x-Math.PI,x),i.lineTo(a+y,o+b),i.arc(a,o,l,x,x+Math.PI)}else i.arc(f,h,p,0,Yf);i.closePath()}else s=1;a=f,o=h,l=p}function c(f){var h,d=f.length,p,g=!1,m;for(i==null&&(i=m=oce()),h=0;h<=d;++h)!(h<d&&r(p=f[h],h,f))===g&&(g=!g)&&(s=0),g&&u(+e(p,h,f),+t(p,h,f),+n(p,h,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function nF(e,t){return e!=null?e:t}const rF=e=>e.x||0,iF=e=>e.y||0,u_n=e=>e.width||0,c_n=e=>e.height||0,f_n=e=>(e.x||0)+(e.width||0),h_n=e=>(e.y||0)+(e.height||0),d_n=e=>e.startAngle||0,p_n=e=>e.endAngle||0,g_n=e=>e.padAngle||0,m_n=e=>e.innerRadius||0,v_n=e=>e.outerRadius||0,y_n=e=>e.cornerRadius||0,b_n=e=>nF(e.cornerRadiusTopLeft,e.cornerRadius)||0,x_n=e=>nF(e.cornerRadiusTopRight,e.cornerRadius)||0,w_n=e=>nF(e.cornerRadiusBottomRight,e.cornerRadius)||0,$_n=e=>nF(e.cornerRadiusBottomLeft,e.cornerRadius)||0,C_n=e=>nF(e.size,64),__n=e=>e.size||1,lW=e=>e.defined!==!1,S_n=e=>t_n(e.shape||"circle"),k_n=rCn().startAngle(d_n).endAngle(p_n).padAngle(g_n).innerRadius(m_n).outerRadius(v_n).cornerRadius(y_n),E_n=Ije().x(rF).y1(iF).y0(h_n).defined(lW),A_n=Ije().y(iF).x1(rF).x0(f_n).defined(lW),T_n=Nje().x(rF).y(iF).defined(lW),D_n=o_n().x(rF).y(iF).width(u_n).height(c_n).cornerRadius(b_n,x_n,w_n,$_n),N_n=sCn().type(S_n).size(C_n),I_n=l_n().x(rF).y(iF).defined(lW).size(__n);function gce(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function M_n(e,t){return k_n.context(e)(t)}function F_n(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?A_n:E_n).curve(qje(r,n.orient,n.tension)).context(e)(t)}function O_n(e,t){const n=t[0],r=n.interpolate||"linear";return T_n.curve(qje(r,n.orient,n.tension)).context(e)(t)}function yS(e,t,n,r){return D_n.context(e)(t,n,r)}function R_n(e,t){return(t.mark.shape||t.shape).context(e)(t)}function P_n(e,t){return N_n.context(e)(t)}function L_n(e,t){return I_n.context(e)(t)}var B_n=1;function mce(e,t,n){var r=t.clip,i=e._defs,s=t.clip_id||(t.clip_id="clip"+B_n++),a=i.clipping[s]||(i.clipping[s]={id:s});return bm(r)?a.path=r(null):gce(n)?a.path=yS(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+s+")"}function lf(e){this.clear(),e&&this.union(e)}lf.prototype={clone(){return new lf(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:s,y2:a}=this,o=Math.cos(e),l=Math.sin(e),u=t-t*o+n*l,c=n-t*l-n*o;return[o*r-l*i+u,l*r+o*i+c,o*r-l*a+u,l*r+o*a+c,o*s-l*i+u,l*s+o*i+c,o*s-l*a+u,l*s+o*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Yje(e){this.mark=e,this.bounds=this.bounds||new lf}function z_n(e){Yje.call(this,e),this.items=this.items||[]}hS(z_n,Yje);function Xje(e){this._pending=0,this._loader=e||jje()}function O$e(e){e._pending+=1}function Wk(e){e._pending-=1}Xje.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return O$e(t),t._loader.sanitize(e,{context:"href"}).then(n=>(Wk(t),n)).catch(()=>(Wk(t),null))},loadImage(e){const t=this,n=Iie();return O$e(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const s=new n,a=Is(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(s.crossOrigin=a),s.onload=()=>Wk(t),s.onerror=()=>Wk(t),s.src=i,s}).catch(r=>(Wk(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function bS(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?U_n(t,r):0))}return e}function U_n(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const W_n=Yf-1e-8;let uW,L4,B4,V1,ZQ,z4,QQ,JQ;const u0=(e,t)=>uW.add(e,t),U4=(e,t)=>u0(L4=e,B4=t),R$e=e=>u0(e,uW.y1),P$e=e=>u0(uW.x1,e),b1=(e,t)=>ZQ*e+QQ*t,x1=(e,t)=>z4*e+JQ*t,dG=(e,t)=>u0(b1(e,t),x1(e,t)),pG=(e,t)=>U4(b1(e,t),x1(e,t));function vce(e,t){return uW=e,t?(V1=t*_m,ZQ=JQ=Math.cos(V1),z4=Math.sin(V1),QQ=-z4):(ZQ=JQ=1,V1=z4=QQ=0),V_n}const V_n={beginPath(){},closePath(){},moveTo:pG,lineTo:pG,rect(e,t,n,r){V1?(dG(e+n,t),dG(e+n,t+r),dG(e,t+r),pG(e,t)):(u0(e+n,t+r),U4(e,t))},quadraticCurveTo(e,t,n,r){const i=b1(e,t),s=x1(e,t),a=b1(n,r),o=x1(n,r);L$e(L4,i,a,R$e),L$e(B4,s,o,P$e),U4(a,o)},bezierCurveTo(e,t,n,r,i,s){const a=b1(e,t),o=x1(e,t),l=b1(n,r),u=x1(n,r),c=b1(i,s),f=x1(i,s);B$e(L4,a,l,c,R$e),B$e(B4,o,u,f,P$e),U4(c,f)},arc(e,t,n,r,i,s){if(r+=V1,i+=V1,L4=n*Math.cos(i)+e,B4=n*Math.sin(i)+t,Math.abs(i-r)>W_n)u0(e-n,t-n),u0(e+n,t+n);else{const a=u=>u0(n*Math.cos(u)+e,n*Math.sin(u)+t);let o,l;if(a(r),a(i),i!==r)if(r=r%Yf,r<0&&(r+=Yf),i=i%Yf,i<0&&(i+=Yf),i<r&&(s=!s,o=r,r=i,i=o),s)for(i-=Yf,o=r-r%y1,l=0;l<4&&o>i;++l,o-=y1)a(o);else for(o=r-r%y1+y1,l=0;l<4&&o<i;++l,o=o+y1)a(o)}}};function L$e(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function B$e(e,t,n,r,i){const s=r-e+3*t-3*n,a=e+n-2*t,o=e-t;let l=0,u=0,c;Math.abs(s)>ZCn?(c=a*a+o*s,c>=0&&(c=Math.sqrt(c),l=(-a+c)/s,u=(-a-c)/s)):l=.5*o/a,0<l&&l<1&&i(z$e(l,e,t,n,r)),0<u&&u<1&&i(z$e(u,e,t,n,r))}function z$e(e,t,n,r,i){const s=1-e,a=s*s,o=e*e;return a*s*t+3*a*e*n+3*s*o*r+o*e*i}var T0=(T0=Ku(1,1))?T0.getContext("2d"):null;const eJ=new lf;function Kje(e){return function(t,n){if(!T0)return!0;e(T0,t),eJ.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:s,y2:a}=eJ;for(let o=i;o<=a;++o)for(let l=r;l<=s;++l)if(T0.isPointInPath(l,o))return!0;return!1}}function Zje(e,t){return t.contains(e.x||0,e.y||0)}function Qje(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,s=e.height||0;return t.intersects(eJ.set(n,r,n+i,r+s))}function j_n(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:r;return ZE(t,n,r,i,s)}function ZE(e,t,n,r,i){const{x1:s,y1:a,x2:o,y2:l}=e,u=r-t,c=i-n;let f=0,h=1,d,p,g,m;for(m=0;m<4;++m){if(m===0&&(d=-u,p=-(s-t)),m===1&&(d=u,p=o-t),m===2&&(d=-c,p=-(a-n)),m===3&&(d=c,p=l-n),Math.abs(d)<1e-10&&p<0)return!1;if(g=p/d,d<0){if(g>h)return!1;g>f&&(f=g)}else if(d>0){if(g<f)return!1;g<h&&(h=g)}}return!0}function q$(e,t){e.globalCompositeOperation=t.blend||"source-over"}function lc(e,t){return e==null?t:e}function U$e(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function H_n(e,t,n){const r=n.width(),i=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+lc(t.x1,.5)*r,n.y1+lc(t.y1,.5)*i,Math.max(r,i)*lc(t.r1,0),n.x1+lc(t.x2,.5)*r,n.y1+lc(t.y2,.5)*i,Math.max(r,i)*lc(t.r2,.5));else{const a=lc(t.x1,0),o=lc(t.y1,0),l=lc(t.x2,1),u=lc(t.y2,0);if(a===l||o===u||r===i)s=e.createLinearGradient(n.x1+a*r,n.y1+o*i,n.x1+l*r,n.y1+u*i);else{const c=Ku(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=U$e(f.createLinearGradient(a,o,l,u),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return U$e(s,t.stops)}function Jje(e,t,n){return dce(n)?H_n(e,n,t.bounds):n}function i8(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=Jje(e,t,t.fill),!0):!1}var q_n=[];function G$(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=Jje(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||q_n),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function G_n(e,t){return e.zindex-t.zindex||e.index-t.index}function eHe(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,s;for(i=0,s=t.length;i<s;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(G_n)}function Xh(e,t){var n=e.items,r,i;if(!n||!n.length)return;const s=eHe(e);if(s&&s.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=s}for(r=0,i=n.length;r<i;++r)t(n[r])}function tJ(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const s=eHe(e);for(s&&s.length&&(n=s),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===s){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function yce(e){return function(t,n,r){Xh(n,i=>{(!r||r.intersects(i.bounds))&&tHe(e,t,i,i)})}}function Y_n(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&tHe(e,t,n.items[0],n.items)}}function tHe(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(q$(t,n),n.fill&&i8(t,n,i)&&t.fill(),n.stroke&&G$(t,n,i)&&t.stroke()))}function cW(e){return e=e||UU,function(t,n,r,i,s,a){return r*=t.pixelRatio,i*=t.pixelRatio,tJ(n,o=>{const l=o.bounds;if(!(l&&!l.contains(s,a)||!l)&&e(t,o,r,i,s,a))return o})}}function sF(e,t){return function(n,r,i,s){var a=Array.isArray(r)?r[0]:r,o=t==null?a.fill:t,l=a.stroke&&n.isPointInStroke,u,c;return l&&(u=a.strokeWidth,c=a.strokeCap,n.lineWidth=u!=null?u:1,n.lineCap=c!=null?c:"butt"),e(n,r)?!1:o&&n.isPointInPath(i,s)||l&&n.isPointInStroke(i,s)}}function bce(e){return cW(sF(e))}function gy(e,t){return"translate("+e+","+t+")"}function xce(e){return"rotate("+e+")"}function X_n(e,t){return"scale("+e+","+t+")"}function nHe(e){return gy(e.x||0,e.y||0)}function K_n(e){return gy(e.x||0,e.y||0)+(e.angle?" "+xce(e.angle):"")}function Z_n(e){return gy(e.x||0,e.y||0)+(e.angle?" "+xce(e.angle):"")+(e.scaleX||e.scaleY?" "+X_n(e.scaleX||1,e.scaleY||1):"")}function wce(e,t,n){function r(a,o){a("transform",K_n(o)),a("d",t(null,o))}function i(a,o){return t(vce(a,o.angle),o),bS(a,o).translate(o.x||0,o.y||0)}function s(a,o){var l=o.x||0,u=o.y||0,c=o.angle||0;a.translate(l,u),c&&a.rotate(c*=_m),a.beginPath(),t(a,o),c&&a.rotate(-c),a.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:yce(s),pick:bce(s),isect:n||Kje(s)}}var Q_n=wce("arc",M_n);function J_n(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,s=1/0,a,o;--i>=0;)e[i].defined!==!1&&(o=Math.abs(e[i][r]-n),o<s&&(s=o,a=e[i]));return a}function eSn(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,s,a;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],s=e[r].y-t[1],a=i*i+s*s,a<n))return e[r];return null}function tSn(e,t){for(var n=e.length,r,i,s;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],s=r*r+i*i,r=e[n].size||1,s<r*r))return e[n];return null}function $ce(e,t,n){function r(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))}function i(l,u){var c=u.items;return c.length===0?l:(t(vce(l),c),bS(l,c[0]))}function s(l,u){l.beginPath(),t(l,u)}const a=sF(s);function o(l,u,c,f,h,d){var p=u.items,g=u.bounds;return!p||!p.length||g&&!g.contains(h,d)?null:(c*=l.pixelRatio,f*=l.pixelRatio,a(l,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:Y_n(s),pick:o,isect:Zje,tip:n}}var nSn=$ce("area",F_n,J_n);function rSn(e,t){var n=t.clip;e.save(),bm(n)?(e.beginPath(),n(e),e.clip()):rHe(e,t.group)}function rHe(e,t){e.beginPath(),gce(t)?yS(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function iHe(e){const t=lc(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function iSn(e,t){e("transform",nHe(t))}function sHe(e,t){const n=iHe(t);e("d",yS(null,t,n,n))}function sSn(e,t){e("class","background"),e("aria-hidden",!0),sHe(e,t)}function aSn(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?sHe(e,t):e("d","")}function oSn(e,t,n){const r=t.clip?mce(n,t,t):null;e("clip-path",r)}function lSn(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),bS(e,t),e.translate(t.x||0,t.y||0)}function SD(e,t,n,r){const i=iHe(t);e.beginPath(),yS(e,t,(n||0)+i,(r||0)+i)}const uSn=sF(SD),cSn=sF(SD,!1),fSn=sF(SD,!0);function hSn(e,t,n){Xh(t,r=>{const i=r.x||0,s=r.y||0,a=r.strokeForeground,o=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&o&&(SD(e,r,i,s),q$(e,r),r.fill&&i8(e,r,o)&&e.fill(),r.stroke&&!a&&G$(e,r,o)&&e.stroke()),e.save(),e.translate(i,s),r.clip&&rHe(e,r),n&&n.translate(-i,-s),Xh(r,l=>{this.draw(e,l,n)}),n&&n.translate(i,s),e.restore(),a&&r.stroke&&o&&(SD(e,r,i,s),q$(e,r),G$(e,r,o)&&e.stroke())})}function dSn(e,t,n,r,i,s){if(t.bounds&&!t.bounds.contains(i,s)||!t.items)return null;const a=n*e.pixelRatio,o=r*e.pixelRatio;return tJ(t,l=>{let u,c,f;const h=l.bounds;if(h&&!h.contains(i,s))return;c=l.x||0,f=l.y||0;const d=c+(l.width||0),p=f+(l.height||0),g=l.clip;if(g&&(i<c||i>d||s<f||s>p))return;if(e.save(),e.translate(c,f),c=i-c,f=s-f,g&&gce(l)&&!fSn(e,l,a,o))return e.restore(),null;const m=l.strokeForeground,v=t.interactive!==!1;return v&&m&&l.stroke&&cSn(e,l,a,o)?(e.restore(),l):(u=tJ(l,y=>pSn(y,c,f)?this.pick(y,n,r,c,f):null),!u&&v&&(l.fill||!m&&l.stroke)&&uSn(e,l,a,o)&&(u=l),e.restore(),u||null)})}function pSn(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var gSn={type:"group",tag:"g",nested:!1,attr:iSn,bound:lSn,draw:hSn,pick:dSn,isect:Qje,content:oSn,background:sSn,foreground:aSn},kD={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Cce(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function _ce(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function Sce(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function fW(e,t){return e==="center"?t/2:e==="right"?t:0}function hW(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function mSn(e,t,n){const r=Cce(t,n),i=_ce(t,r),s=Sce(t,r),a=(t.x||0)-fW(t.align,i),o=(t.y||0)-hW(t.baseline,s),l=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",l,kD["xmlns:xlink"],"xlink:href"),e("transform",gy(a,o)),e("width",i),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function vSn(e,t){const n=t.image,r=_ce(t,n),i=Sce(t,n),s=(t.x||0)-fW(t.align,r),a=(t.y||0)-hW(t.baseline,i);return e.set(s,a,s+r,a+i)}function ySn(e,t,n){Xh(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=Cce(r,this);let s=_ce(r,i),a=Sce(r,i);if(s===0||a===0)return;let o=(r.x||0)-fW(r.align,s),l=(r.y||0)-hW(r.baseline,a),u,c,f,h;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(h=s/c,l+=(a-h)/2,a=h):(h=a*c,o+=(s-h)/2,s=h))),(i.complete||i.toDataURL)&&(q$(e,r),e.globalAlpha=(u=r.opacity)!=null?u:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,o,l,s,a))})}var bSn={type:"image",tag:"image",nested:!1,attr:mSn,bound:vSn,draw:ySn,pick:cW(),isect:UU,get:Cce,xOffset:fW,yOffset:hW},xSn=$ce("line",O_n,eSn);function wSn(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",Z_n(t)),e("d",t.path)}function W4(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,s=t.scaleX||1,a=t.scaleY||1,o=(t.angle||0)*_m,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=pce(n)).path=n),o&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(o),r8(e,l,0,0,s,a),e.rotate(-o),e.translate(-r,-i)):r8(e,l,r,i,s,a)}function $Sn(e,t){return W4(vce(e,t.angle),t)?e.set(0,0,0,0):bS(e,t,!0)}var CSn={type:"path",tag:"path",nested:!1,attr:wSn,bound:$Sn,draw:yce(W4),pick:bce(W4),isect:Kje(W4)};function _Sn(e,t){e("d",yS(null,t))}function SSn(e,t){var n,r;return bS(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function W$e(e,t){e.beginPath(),yS(e,t)}var kSn={type:"rect",tag:"path",nested:!1,attr:_Sn,bound:SSn,draw:yce(W$e),pick:bce(W$e),isect:Qje};function ESn(e,t){e("transform",nHe(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function ASn(e,t){var n,r;return bS(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function aHe(e,t,n){var r,i,s,a;return t.stroke&&G$(e,t,n)?(r=t.x||0,i=t.y||0,s=t.x2!=null?t.x2:r,a=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(s,a),!0):!1}function TSn(e,t,n){Xh(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&aHe(e,r,i)&&(q$(e,r),e.stroke())}})}function DSn(e,t,n,r){return e.isPointInStroke?aHe(e,t,1)&&e.isPointInStroke(n,r):!1}var NSn={type:"rule",tag:"line",nested:!1,attr:ESn,bound:ASn,draw:TSn,pick:cW(DSn),isect:j_n},ISn=wce("shape",R_n),MSn=wce("symbol",P_n,Zje);const V$e=Dbn();var OA={height:pg,measureWidth:kce,estimateWidth:nJ,width:nJ,canvas:oHe};oHe(!0);function oHe(e){OA.width=e&&T0?kce:nJ}function nJ(e,t){return lHe(Sm(e,t),pg(e))}function lHe(e,t){return~~(.8*e.length*t)}function kce(e,t){return pg(e)<=0||!(t=Sm(e,t))?0:uHe(t,Ece(e))}function uHe(e,t){const n=`(${t}) ${e}`;let r=V$e.get(n);return r===void 0&&(T0.font=t,r=T0.measureText(e).width,V$e.set(n,r)),r}function pg(e){return e.fontSize!=null?+e.fontSize||0:11}function Y$(e){return e.lineHeight!=null?e.lineHeight:pg(e)+2}function FSn(e){return Oa(e)?e.length>1?e:e[0]:e}function dW(e){return FSn(e.lineBreak&&e.text&&!Oa(e.text)?e.text.split(e.lineBreak):e.text)}function Sm(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?RSn(e,n):n}function OSn(e){if(OA.width===kce){const t=Ece(e);return n=>uHe(n,t)}else{const t=pg(e);return n=>lHe(n,t)}}function RSn(e,t){var n=+e.limit,r=OSn(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",s=e.dir==="rtl",a=0,o=t.length,l;if(n-=r(i),s){for(;a<o;)l=a+o>>>1,r(t.slice(l))>n?a=l+1:o=l;return i+t.slice(a)}else{for(;a<o;)l=1+(a+o>>>1),r(t.slice(0,l))<n?a=l:o=l-1;return t.slice(0,a)+i}}function pW(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Ece(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+pg(e)+"px "+pW(e,t)}function Ace(e){var t=e.baseline,n=pg(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Y$(e):t==="line-bottom"?.29*n-.5*Y$(e):0)}const PSn={left:"start",center:"middle",right:"end"},RA=new lf;function gW(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-y1,t+=r*Math.cos(i),n+=r*Math.sin(i)),RA.x1=t,RA.y1=n,RA}function LSn(e,t){var n=t.dx||0,r=(t.dy||0)+Ace(t),i=gW(t),s=i.x1,a=i.y1,o=t.angle||0,l;e("text-anchor",PSn[t.align]||"start"),o?(l=gy(s,a)+" "+xce(o),(n||r)&&(l+=" "+gy(n,r))):l=gy(s+n,a+r),e("transform",l)}function Tce(e,t,n){var r=OA.height(t),i=t.align,s=gW(t),a=s.x1,o=s.y1,l=t.dx||0,u=(t.dy||0)+Ace(t)-Math.round(.8*r),c=dW(t),f;if(Oa(c)?(r+=Y$(t)*(c.length-1),f=c.reduce((h,d)=>Math.max(h,OA.width(t,d)),0)):f=OA.width(t,c),i==="center"?l-=f/2:i==="right"&&(l-=f),e.set(l+=a,u+=o,l+f,u+r),t.angle&&!n)e.rotate(t.angle*_m,a,o);else if(n===2)return e.rotatedPoints(t.angle*_m,a,o);return e}function BSn(e,t,n){Xh(t,r=>{var i=r.opacity==null?1:r.opacity,s,a,o,l,u,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=Ece(r),e.textAlign=r.align||"left",s=gW(r),a=s.x1,o=s.y1,r.angle&&(e.save(),e.translate(a,o),e.rotate(r.angle*_m),a=o=0),a+=r.dx||0,o+=(r.dy||0)+Ace(r),c=dW(r),q$(e,r),Oa(c))for(u=Y$(r),l=0;l<c.length;++l)f=Sm(r,c[l]),r.fill&&i8(e,r,i)&&e.fillText(f,a,o),r.stroke&&G$(e,r,i)&&e.strokeText(f,a,o),o+=u;else f=Sm(r,c),r.fill&&i8(e,r,i)&&e.fillText(f,a,o),r.stroke&&G$(e,r,i)&&e.strokeText(f,a,o);r.angle&&e.restore()}})}function zSn(e,t,n,r,i,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=gW(t),o=a.x1,l=a.y1,u=Tce(RA,t,1),c=-t.angle*_m,f=Math.cos(c),h=Math.sin(c),d=f*i-h*s+(o-f*o+h*l),p=h*i+f*s+(l-h*o-f*l);return u.contains(d,p)}function USn(e,t){const n=Tce(RA,e,2);return ZE(t,n[0],n[1],n[2],n[3])||ZE(t,n[0],n[1],n[4],n[5])||ZE(t,n[4],n[5],n[6],n[7])||ZE(t,n[2],n[3],n[6],n[7])}var WSn={type:"text",tag:"text",nested:!1,attr:LSn,bound:Tce,draw:BSn,pick:cW(zSn),isect:USn},VSn=$ce("trail",L_n,tSn),km={arc:Q_n,area:nSn,group:gSn,image:bSn,line:xSn,path:CSn,rect:kSn,rule:NSn,shape:ISn,symbol:MSn,text:WSn,trail:VSn};function j1(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function cHe(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Tl(e,t,n,r){var i=e.childNodes[t],s;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(s=i||null,i=j1(e.ownerDocument,n,r),e.insertBefore(i,s)),i}function Xf(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function fHe(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function hHe(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function jSn(e,t,n,r){var i=e&&e.mark,s,a;if(i&&(s=km[i.marktype]).tip){for(a=hHe(t,n),a[0]-=r[0],a[1]-=r[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=s.tip(i.items,a)}return e}function yb(e,t){this._active=null,this._handlers={},this._loader=e||jje(),this._tooltip=t||HSn}function HSn(e,t,n,r){e.element().setAttribute("title",r||"")}yb.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),s=j1(null,"a");for(const a in r)s.setAttribute(a,r[a]);s.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=jSn(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,s=i.width(),a=i.height();let o=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)o+=e.x||0,l+=e.y||0;return{x:o,y:l,width:s,height:a,left:o,top:l,right:o+s,bottom:l+a}}};function gg(e){this._el=null,this._bgcolor=null,this._loader=new Xje(e)}gg.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(s=>{s&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const qSn="keydown",GSn="keypress",YSn="keyup",dHe="dragenter",V4="dragleave",pHe="dragover",rJ="mousedown",XSn="mouseup",s8="mousemove",PA="mouseout",gHe="mouseover",a8="click",KSn="dblclick",ZSn="wheel",mHe="mousewheel",o8="touchstart",l8="touchmove",u8="touchend",QSn=[qSn,GSn,YSn,dHe,V4,pHe,rJ,XSn,s8,PA,gHe,a8,KSn,ZSn,mHe,o8,l8,u8],iJ=s8,ED=PA,sJ=a8;function JSn(e,t){yb.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const ekn=e=>e===o8||e===l8||e===u8?[o8,l8,u8]:[e];function j$e(e,t){ekn(t).forEach(n=>tkn(e,n))}function tkn(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function H$e(e,t,n){return function(r){const i=this._active,s=this.pickEvent(r);s===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=s,this.fire(t,r),this.fire(e,r))}}function q$e(e){return function(t){this.fire(e,t),this._active=null}}hS(JSn,yb,{initialize(e,t,n){return this._canvas=e&&cHe(e,"canvas"),[a8,rJ,s8,PA,V4].forEach(r=>j$e(this,r)),yb.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:QSn,DOMMouseScroll(e){this.fire(mHe,e)},mousemove:H$e(s8,gHe,PA),dragover:H$e(pHe,dHe,V4),mouseout:q$e(PA),dragleave:q$e(V4),mousedown(e){this._down=this._active,this.fire(rJ,e)},click(e){this._down===this._active&&(this.fire(a8,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(o8,e,!0)},touchmove(e){this.fire(l8,e,!0)},touchend(e){this.fire(u8,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===sJ&&r&&r.href?this.handleHref(t,r,r.href):(e===iJ||e===ED)&&this.handleTooltip(t,r,e!==ED),i)for(let s=0,a=i.length;s<a;++s)i[s].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(j$e(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=hHe(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const s=this.context();return km[e.marktype].pick.call(this,s,e,t,n,r,i)}});function nkn(){return typeof window<"u"&&window.devicePixelRatio||1}var rkn=nkn();function ikn(e,t,n,r,i,s){const a=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,o=e.getContext("2d"),l=a?rkn:i;e.width=t*l,e.height=n*l;for(const u in s)o[u]=s[u];return a&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),o.pixelRatio=l,o.setTransform(l,0,0,l,l*r[0],l*r[1]),e}function skn(e){gg.call(this,e),this._options={},this._redraw=!1,this._dirty=new lf,this._tempb=new lf}const G$e=gg.prototype,akn=(e,t,n)=>new lf().set(0,0,t,n).translate(-e[0],-e[1]);function okn(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}hS(skn,gg,{initialize(e,t,n,r,i,s){return this._options=s||{},this._canvas=this._options.externalContext?null:Ku(1,1,this._options.type),e&&this._canvas&&(Xf(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),G$e.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(G$e.resize.call(this,e,t,n,r),this._canvas)ikn(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||br("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,s=this._dirty,a=akn(n,r,i);t.save();const o=this._redraw||s.empty()?(this._redraw=!1,a.expand(1)):okn(t,a.intersect(s),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,o),t.restore(),s.clear(),this},draw(e,t,n){const r=km[t.marktype];t.clip&&rSn(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,s=this.context();i.type!=="pdf"&&!i.externalContext&&s.clearRect(e,t,n,r),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,r))}});function lkn(e,t){yb.call(this,e,t);const n=this;n._hrefHandler=aJ(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=aJ(n,(r,i)=>{n.handleTooltip(r,i,r.type!==ED)})}const aJ=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};hS(lkn,yb,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(sJ,this._hrefHandler),r.removeEventListener(iJ,this._tooltipHandler),r.removeEventListener(ED,this._tooltipHandler)),this._svg=r=e&&cHe(e,"svg"),r&&(r.addEventListener(sJ,this._hrefHandler),r.addEventListener(iJ,this._tooltipHandler),r.addEventListener(ED,this._tooltipHandler)),yb.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const s={type:e,handler:t,listener:aJ(this,t)};(r[n]||(r[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const vHe="aria-hidden",Dce="aria-label",Nce="role",Ice="aria-roledescription",yHe="graphics-object",Mce="graphics-symbol",bHe=(e,t,n)=>({[Nce]:e,[Ice]:t,[Dce]:n||void 0}),ukn=W6(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Y$e={axis:{desc:"axis",caption:hkn},legend:{desc:"legend",caption:dkn},"title-text":{desc:"title",caption:e=>`Title text '${K$e(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${K$e(e)}'`}},X$e={ariaRole:Nce,ariaRoleDescription:Ice,description:Dce};function xHe(e,t){const n=t.aria===!1;if(e(vHe,n||void 0),n||t.description==null)for(const r in X$e)e(X$e[r],void 0);else{const r=t.mark.marktype;e(Dce,t.description),e(Nce,t.ariaRole||(r==="group"?yHe:Mce)),e(Ice,t.ariaRoleDescription||`${r} mark`)}}function wHe(e){return e.aria===!1?{[vHe]:!0}:ukn[e.role]?null:Y$e[e.role]?fkn(e,Y$e[e.role]):ckn(e)}function ckn(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return bHe(n?yHe:Mce,`${t} mark container`,e.description)}function fkn(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return bHe(t.role||Mce,t.desc,n.description||r(n))}catch{return null}}function K$e(e){return L$(e.text).join(" ")}function hkn(e){const t=e.datum,n=e.orient,r=t.title?$He(e):null,i=e.context,s=i.scales[t.scale].value,a=i.dataflow.locale(),o=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${yje(o)?"discrete":o} scale with ${_je(a,s,e)}`}function dkn(e){const t=e.datum,n=t.title?$He(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,s=Object.keys(i),a=e.context,o=a.scales[i[s[0]]].value,l=a.dataflow.locale();return gkn(r)+(n?` titled '${n}'`:"")+` for ${pkn(s)} with ${_je(l,o,e)}`}function $He(e){try{return L$($o(e.items).items[0].text).join(" ")}catch{return null}}function pkn(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+$o(e)}function gkn(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const CHe=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),mkn=e=>CHe(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function _He(){let e="",t="",n="";const r=[],i=()=>t=n="",s=l=>{t&&(e+=`${t}>${n}`,i()),r.push(l)},a=(l,u)=>(u!=null&&(t+=` ${l}="${mkn(u)}"`),o),o={open(l){s(l),t="<"+l;for(var u=arguments.length,c=new Array(u>1?u-1:0),f=1;f<u;f++)c[f-1]=arguments[f];for(const h of c)for(const d in h)a(d,h[d]);return o},close(){const l=r.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,i(),o},attr:a,text:l=>(n+=CHe(l),o),toString:()=>e};return o}const vkn=e=>SHe(_He(),e)+"";function SHe(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const r of n)r.nodeType===3?e.text(r.nodeValue):SHe(e,r)}return e.close()}const c8={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},f8={blend:"mix-blend-mode"},kHe={fill:"none","stroke-miterlimit":10},Vk=0,Z$e="http://www.w3.org/2000/xmlns/",ki=kD.xmlns;function ykn(e){gg.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const gG=gg.prototype;hS(ykn,gg,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=Tl(e,0,"svg",ki),this._svg.setAttributeNS(Z$e,"xmlns",ki),this._svg.setAttributeNS(Z$e,"xmlns:xlink",kD["xmlns:xlink"]),this._svg.setAttribute("version",kD.version),this._svg.setAttribute("class","marks"),Xf(e,1),this._root=Tl(this._svg,Vk,"g",ki),c0(this._root,kHe),Xf(this._svg,Vk+1)),this.background(this._bgcolor),gG.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),gG.background.apply(this,arguments)},resize(e,t,n,r){return gG.resize.call(this,e,t,n,r),this._svg&&(c0(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Tl(e,Vk,"rect",ki),c0(n,{width:this._width,height:this._height,fill:t}));const r=vkn(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Xf(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,s,a,o,l;for(a=0,o=e.length;a<o;++a)if(n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,s=km[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,Q$e(n,t),r.items.forEach(u=>{u.dirty=t})),!r.zdirty){if(n.exit){s.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(s,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null;continue}n=s.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,Q$e(n,t)):this._update(s,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=km[t.marktype],s=t.interactive===!1?"none":null,a=i.tag==="g",o=J$e(t,e,n,"g",r);o.setAttribute("class",fHe(t));const l=wHe(t);for(const h in l)Ha(o,h,l[h]);a||Ha(o,"pointer-events",s),Ha(o,"clip-path",t.clip?mce(this,t,t.group):null);let u=null,c=0;const f=h=>{const d=this.isDirty(h),p=J$e(h,o,u,i.tag,r);d&&(this._update(i,p,h),a&&wkn(this,p,h)),u=p,++c};return i.nested?t.items.length&&f(t.items[0]):Xh(t,f),Xf(o,c),o},_update(e,t,n){pp=t,ua=t.__values__,xHe(LA,n),e.attr(LA,n,this);const r=Ckn[e.type];r&&r.call(this,e,t,n),pp&&this.style(pp,n)},style(e,t){if(t!=null){for(const n in c8){let r=n==="font"?pW(t):t[n];if(r===ua[n])continue;const i=c8[n];r==null?e.removeAttribute(i):(dce(r)&&(r=Hje(r,this._defs.gradient,EHe())),e.setAttribute(i,r+"")),ua[n]=r}for(const n in f8)j4(e,f8[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=Tl(e,Vk+1,"defs",ki)),r=bkn(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=Tl(e,Vk+1,"defs",ki)),r=xkn(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):Xf(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function Q$e(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function bkn(e,t,n){let r,i,s;if(t.gradient==="radial"){let a=Tl(e,n++,"pattern",ki);c0(a,{id:n8+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=Tl(a,0,"rect",ki),c0(a,{width:1,height:1,fill:`url(${EHe()}#${t.id})`}),e=Tl(e,n++,"radialGradient",ki),c0(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Tl(e,n++,"linearGradient",ki),c0(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)s=Tl(e,r,"stop",ki),s.setAttribute("offset",t.stops[r].offset),s.setAttribute("stop-color",t.stops[r].color);return Xf(e,r),n}function xkn(e,t,n){let r;return e=Tl(e,n,"clipPath",ki),e.setAttribute("id",t.id),t.path?(r=Tl(e,0,"path",ki),r.setAttribute("d",t.path)):(r=Tl(e,0,"rect",ki),c0(r,{x:0,y:0,width:t.width,height:t.height})),Xf(e,1),n+1}function wkn(e,t,n){t=t.lastChild.previousSibling;let r,i=0;Xh(n,s=>{r=e.mark(t,s,r),++i}),Xf(t,1+i)}function J$e(e,t,n,r,i){let s=e._svg,a;if(!s&&(a=t.ownerDocument,s=j1(a,r,ki),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},r==="g"))){const o=j1(a,"path",ki);s.appendChild(o),o.__data__=e;const l=j1(a,"g",ki);s.appendChild(l),l.__data__=e;const u=j1(a,"path",ki);s.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(s.ownerSVGElement!==i||$kn(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function $kn(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let pp=null,ua=null;const Ckn={group(e,t,n){const r=pp=t.childNodes[2];ua=r.__values__,e.foreground(LA,n,this),ua=t.__values__,pp=t.childNodes[1],e.content(LA,n,this);const i=pp=t.childNodes[0];e.background(LA,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==ua.events&&(Ha(r,"pointer-events",s),Ha(i,"pointer-events",s),ua.events=s),n.strokeForeground&&n.stroke){const a=n.fill;Ha(r,"display",null),this.style(i,n),Ha(i,"stroke",null),a&&(n.fill=null),ua=r.__values__,this.style(r,n),a&&(n.fill=a),pp=null}else Ha(r,"display","none")},image(e,t,n){n.smooth===!1?(j4(t,"image-rendering","optimizeSpeed"),j4(t,"image-rendering","pixelated")):j4(t,"image-rendering",null)},text(e,t,n){const r=dW(n);let i,s,a,o;Oa(r)?(s=r.map(l=>Sm(n,l)),i=s.join(`
`),i!==ua.text&&(Xf(t,0),a=t.ownerDocument,o=Y$(n),s.forEach((l,u)=>{const c=j1(a,"tspan",ki);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",o)),t.appendChild(c)}),ua.text=i)):(s=Sm(n,r),s!==ua.text&&(t.textContent=s,ua.text=s)),Ha(t,"font-family",pW(n)),Ha(t,"font-size",pg(n)+"px"),Ha(t,"font-style",n.fontStyle),Ha(t,"font-variant",n.fontVariant),Ha(t,"font-weight",n.fontWeight)}};function LA(e,t,n){t!==ua[e]&&(n?_kn(pp,e,t,n):Ha(pp,e,t),ua[e]=t)}function j4(e,t,n){n!==ua[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),ua[t]=n)}function c0(e,t){for(const n in t)Ha(e,n,t[n])}function Ha(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function _kn(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function EHe(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Skn(e){gg.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}hS(Skn,gg,{svg(){return this._text},_render(e){const t=_He();t.open("svg",Ex({},kD,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",kHe,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=km[t.marktype],r=n.tag,i=[xHe,n.attr];e.open("g",{class:fHe(t),"clip-path":t.clip?mce(this,t,t.group):null},wHe(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const s=a=>{const o=this.href(a);if(o&&e.open("a",o),e.open(r,this.attr(t,a,i,r!=="g"?r:null)),r==="text"){const l=dW(a);if(Oa(l)){const u={x:0,dy:Y$(a)};for(let c=0;c<l.length;++c)e.open("tspan",c?u:null).text(Sm(a,l[c])).close()}else e.text(Sm(a,l))}else if(r==="g"){const l=a.strokeForeground,u=a.fill,c=a.stroke;l&&c&&(a.stroke=null),e.open("path",this.attr(t,a,n.background,"bgrect")).close(),e.open("g",this.attr(t,a,n.content)),Xh(a,f=>this.mark(e,f)),e.close(),l&&c?(u&&(a.fill=null),a.stroke=c,e.open("path",this.attr(t,a,n.foreground,"bgrect")).close(),u&&(a.fill=u)):e.open("path",this.attr(t,a,n.foreground,"bgfore")).close()}e.close(),o&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):Xh(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},s=(a,o,l,u)=>{i[u||a]=o};return Array.isArray(n)?n.forEach(a=>a(s,t,this)):n(s,t,this),r&&kkn(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const s=t[i],a=s.stops;s.gradient==="radial"?(e.open("pattern",{id:n8+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:i,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let o=0;o<a.length;++o)e.open("stop",{offset:a[o].offset,"stop-color":a[o].color}).close();e.close()}for(const i in n){const s=n[i];e.open("clipPath",{id:i}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});function kkn(e,t,n,r,i){let s;if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=pW(t),e["font-size"]=pg(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in c8){let o=t[a];const l=c8[a];o==="transparent"&&(l==="fill"||l==="stroke")||o!=null&&(dce(o)&&(o=Hje(o,i.gradient,"")),e[l]=o)}for(const a in f8){const o=t[a];o!=null&&(s=s||[],s.push(`${f8[a]}: ${o};`))}return s&&(e.style=s.join(" ")),e}function Ekn(e,t,n){const r=[],i=new lf().union(t),s=e.marktype;return s?AHe(e,i,n,r):s==="group"?THe(e,i,n,r):br("Intersect scene must be mark node or group item.")}function AHe(e,t,n,r){if(Akn(e,t,n)){const i=e.items,s=e.marktype,a=i.length;let o=0;if(s==="group")for(;o<a;++o)THe(i[o],t,n,r);else for(const l=km[s].isect;o<a;++o){const u=i[o];DHe(u,t,l)&&r.push(u)}}return r}function Akn(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function THe(e,t,n,r){n&&n(e.mark)&&DHe(e,t,km.group.isect)&&r.push(e);const i=e.items,s=i&&i.length;if(s){const a=e.x||0,o=e.y||0;t.translate(-a,-o);for(let l=0;l<s;++l)AHe(i[l],t,n,r);t.translate(a,o)}return r}function DHe(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}new lf;var h8=Math.random;const NHe=Math.sqrt(2*Math.PI),Tkn=Math.SQRT2;let jk=NaN;function IHe(e,t){e=e||0,t=t==null?1:t;let n=0,r=0,i,s;if(jk===jk)n=jk,jk=NaN;else{do n=h8()*2-1,r=h8()*2-1,i=n*n+r*r;while(i===0||i>1);s=Math.sqrt(-2*Math.log(i)/i),n*=s,jk=r*s}return e+n*t}function Dkn(e,t,n){n=n==null?1:n;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*NHe)}function MHe(e,t,n){t=t||0,n=n==null?1:n;const r=(e-t)/n,i=Math.abs(r);let s;if(i>37)s=0;else{const a=Math.exp(-i*i/2);let o;i<7.07106781186547?(o=.0352624965998911*i+.700383064443688,o=o*i+6.37396220353165,o=o*i+33.912866078383,o=o*i+112.079291497871,o=o*i+221.213596169931,o=o*i+220.206867912376,s=a*o,o=.0883883476483184*i+1.75566716318264,o=o*i+16.064177579207,o=o*i+86.7807322029461,o=o*i+296.564248779674,o=o*i+637.333633378831,o=o*i+793.826512519948,o=o*i+440.413735824752,s=s/o):(o=i+.65,o=i+4/o,o=i+3/o,o=i+2/o,o=i+1/o,s=a/o/2.506628274631)}return r>0?1-s:s}function FHe(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*Tkn*Nkn(2*e-1)}function Nkn(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function Ikn(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+IHe()*t)}function Mkn(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*NHe*e)}function Fkn(e,t,n){return MHe(Math.log(e),t,n)}function Okn(e,t,n){return Math.exp(FHe(e,t,n))}function Rkn(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*h8()}function Pkn(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function Lkn(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Bkn(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function OHe(e){const t=this.context.data[e];return t?t.values.value:[]}function zkn(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function Ukn(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(UU).insert(t)),1}function Wkn(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const aF=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},Vkn=aF("format"),RHe=aF("timeFormat"),jkn=aF("utcFormat"),Hkn=aF("timeParse"),qkn=aF("utcParse"),DR=new Date(2e3,0,1);function mW(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(DR.setYear(2e3),DR.setMonth(e),DR.setDate(t),RHe.call(this,DR,n))}function Gkn(e){return mW.call(this,e,1,"%B")}function Ykn(e){return mW.call(this,e,1,"%b")}function Xkn(e){return mW.call(this,0,2+e,"%A")}function Kkn(e){return mW.call(this,0,2+e,"%a")}const Zkn=":",Qkn="@",oJ="%",Jkn="$";function Fce(e,t,n,r){t[0].type!==vD&&br("First argument to data functions must be a string literal.");const i=t[0].value,s=Zkn+i;if(!Is(s,r))try{r[s]=n.getData(i).tuplesRef()}catch{}}function eEn(e,t,n,r){t[0].type!==vD&&br("First argument to indata must be a string literal."),t[1].type!==vD&&br("Second argument to indata must be a string literal.");const i=t[0].value,s=t[1].value,a=Qkn+s;Is(a,r)||(r[a]=n.getData(i).indataRef(n,s))}function nl(e,t,n,r){if(t[0].type===vD)eCe(n,r,t[0].value);else for(e in n.scales)eCe(n,r,e)}function eCe(e,t,n){const r=oJ+n;if(!Is(t,r))try{t[r]=e.scaleRef(n)}catch{}}function mg(e,t){let n;return bm(e)?e:xm(e)?(n=t.scales[e])&&n.value:void 0}function tEn(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=nl,n._range=nl,n._scale=nl;const r=i=>"_["+(i.type===vD?mD(oJ+i.value):mD(oJ)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function Oce(e,t){return function(n,r,i){if(n){const s=mg(n,(i||this).context);return s&&s.path[e](r)}else return t(r)}}const nEn=Oce("area",aQt),rEn=Oce("bounds",cQt),iEn=Oce("centroid",mQt);function sEn(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function Rce(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function aEn(){return Rce(this.context.dataflow,"warn",arguments)}function oEn(){return Rce(this.context.dataflow,"info",arguments)}function lEn(){return Rce(this.context.dataflow,"debug",arguments)}function mG(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function lJ(e){const t=sm(e),n=mG(t.r),r=mG(t.g),i=mG(t.b);return .2126*n+.7152*r+.0722*i}function uEn(e,t){const n=lJ(e),r=lJ(t),i=Math.max(n,r),s=Math.min(n,r);return(i+.05)/(s+.05)}function cEn(){const e=[].slice.call(arguments);return e.unshift({}),Ex(...e)}function PHe(e,t){return e===t||e!==e&&t!==t?!0:Oa(e)?Oa(t)&&e.length===t.length?fEn(e,t):!1:gD(e)&&gD(t)?LHe(e,t):!1}function fEn(e,t){for(let n=0,r=e.length;n<r;++n)if(!PHe(e[n],t[n]))return!1;return!0}function LHe(e,t){for(const n in e)if(!PHe(e[n],t[n]))return!1;return!0}function tCe(e){return t=>LHe(e,t)}function hEn(e,t,n,r,i,s){const a=this.context.dataflow,o=this.context.data[e],l=o.input,u=a.stamp();let c=o.changes,f,h;if(a._trigger===!1||!(l.value.length||t||r))return 0;if((!c||c.stamp<u)&&(o.changes=c=a.changeset(),c.stamp=u,a.runAfter(()=>{o.modified=!0,a.pulse(l,c).run()},!0,1)),n&&(f=n===!0?UU:Oa(n)||U_(n)?n:tCe(n),c.remove(f)),t&&c.insert(t),r&&(f=tCe(r),l.value.some(f)?c.remove(f):c.insert(r)),i)for(h in s)c.modify(i,h,s[h]);return 1}function dEn(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function pEn(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const nCe={};function gEn(e,t){const n=nCe[t]||(nCe[t]=JWe(t));return Oa(e)?e.map(n):n(e)}function Pce(e){return Oa(e)||ArrayBuffer.isView(e)?e:null}function Lce(e){return Pce(e)||(xm(e)?e:null)}function mEn(e,...t){return Pce(e).join(...t)}function vEn(e,...t){return Lce(e).indexOf(...t)}function yEn(e,...t){return Lce(e).lastIndexOf(...t)}function bEn(e,...t){return Lce(e).slice(...t)}function xEn(e,t,n){return bm(n)&&br("Function argument passed to replace."),String(e).replace(t,n)}function wEn(e){return Pce(e).slice().reverse()}function $En(e,t,n){return pje(e||0,t||0,n||0)}function CEn(e,t){const n=mg(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function _En(e,t){const n=mg(e,(t||this).context);return n?n.copy():void 0}function SEn(e,t){const n=mg(e,(t||this).context);return n?n.domain():[]}function kEn(e,t,n){const r=mg(e,(n||this).context);return r?Oa(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function EEn(e,t){const n=mg(e,(t||this).context);return n&&n.range?n.range():[]}function AEn(e,t,n){const r=mg(e,(n||this).context);return r?r(t):void 0}function TEn(e,t,n,r,i){e=mg(e,(i||this).context);const s=jCn(t,n);let a=e.domain(),o=a[0],l=$o(a),u=Nue;return l-o?u=_$n(e,o,l):e=(e.interpolator?Hn("sequential")().interpolator(e.interpolator()):Hn("linear")().interpolate(e.interpolate()).range(e.range())).domain([o=0,l=1]),e.ticks&&(a=e.ticks(+r||15),o!==a[0]&&a.unshift(o),l!==$o(a)&&a.push(l)),a.forEach(c=>s.stop(u(c),e(c))),s}function DEn(e,t,n){const r=mg(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function NEn(e){let t=null;return function(n){return n?r8(n,t=t||pce(e)):e}}const BHe=e=>e.data;function zHe(e,t){const n=OHe.call(t,e);return n.root&&n.root.lookup||{}}function IEn(e,t,n){const r=zHe(e,this),i=r[t],s=r[n];return i&&s?i.path(s).map(BHe):void 0}function MEn(e,t){const n=zHe(e,this)[t];return n?n.ancestors().map(BHe):void 0}const UHe=()=>typeof window<"u"&&window||null;function FEn(){const e=UHe();return e?e.screen:{}}function OEn(){const e=UHe();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function REn(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function PEn(e,t,n){if(!e)return[];const[r,i]=e,s=new lf().set(r[0],r[1],i[0],i[1]),a=n||this.context.dataflow.scenegraph().root;return Ekn(a,s,LEn(t))}function LEn(e){let t=null;if(e){const n=L$(e.marktype),r=L$(e.markname);t=i=>(!n.length||n.some(s=>i.marktype===s))&&(!r.length||r.some(s=>i.name===s))}return t}const d8={random(){return h8()},cumulativeNormal:MHe,cumulativeLogNormal:Fkn,cumulativeUniform:Lkn,densityNormal:Dkn,densityLogNormal:Mkn,densityUniform:Pkn,quantileNormal:FHe,quantileLogNormal:Okn,quantileUniform:Bkn,sampleNormal:IHe,sampleLogNormal:Ikn,sampleUniform:Rkn,isArray:Oa,isBoolean:kbn,isDate:iVe,isDefined(e){return e!==void 0},isNumber:sVe,isObject:gD,isRegExp:Ebn,isString:xm,isTuple:U_,isValid(e){return e!=null&&e===e},toBoolean:Mbn,toDate:Obn,toNumber:WU,toString:Rbn,indexof:vEn,join:mEn,lastindexof:yEn,replace:xEn,reverse:wEn,slice:bEn,flush:_bn,lerp:Abn,merge:cEn,pad:Nbn,peek:$o,pluck:gEn,span:Ibn,inrange:Sbn,truncate:Pbn,rgb:sm,lab:zP,hcl:UP,hsl:LP,luminance:lJ,contrast:uEn,sequence:Ml,format:Vkn,utcFormat:jkn,utcParse:qkn,utcOffset:t$n,utcSequence:r$n,timeFormat:RHe,timeParse:Hkn,timeOffset:e$n,timeSequence:n$n,timeUnitSpecifier:Vwn,monthFormat:Gkn,monthAbbrevFormat:Ykn,dayFormat:Xkn,dayAbbrevFormat:Kkn,quarter:ybn,utcquarter:bbn,week:Hwn,utcweek:Xwn,dayofyear:jwn,utcdayofyear:Ywn,warn:aEn,info:oEn,debug:lEn,extent:$bn,inScope:sEn,intersect:PEn,clampRange:xbn,pinchDistance:dEn,pinchAngle:pEn,screen:FEn,containerSize:REn,windowSize:OEn,bandspace:$En,setdata:Ukn,pathShape:NEn,panLinear:cbn,panLog:fbn,panPow:hbn,panSymlog:dbn,zoomLinear:pbn,zoomLog:gbn,zoomPow:mbn,zoomSymlog:vbn,encode:Wkn,modify:hEn},BEn=["view","item","group","xy","x","y"],zEn="event.vega.",WHe="this.",Bce={},UEn={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${mD(Jkn+e)}]`,functions:WEn,constants:aVe,visitors:Bce},rCe=Ybn(UEn);function WEn(e){const t=oVe(e);BEn.forEach(n=>t[n]=zEn+n);for(const n in d8)t[n]=WHe+n;return Ex(t,tEn(e,d8,Bce)),t}function wi(e,t,n){return arguments.length===1?d8[e]:(d8[e]=t,n&&(Bce[e]=n),rCe&&(rCe.functions[e]=WHe+e),this)}wi("bandwidth",CEn,nl);wi("copy",_En,nl);wi("domain",SEn,nl);wi("range",EEn,nl);wi("invert",kEn,nl);wi("scale",AEn,nl);wi("gradient",TEn,nl);wi("geoArea",nEn,nl);wi("geoBounds",rEn,nl);wi("geoCentroid",iEn,nl);wi("geoShape",DEn,nl);wi("indata",zkn,eEn);wi("data",OHe,Fce);wi("treePath",IEn,Fce);wi("treeAncestors",MEn,Fce);wi("vlSelectionTest",lWe,uS);wi("vlSelectionIdTest",cWe,uS);wi("vlSelectionResolve",hWe,uS);wi("vlSelectionTuples",fWe);const VEn="view",p8="[",g8="]",VHe="{",jHe="}",jEn=":",HHe=",",HEn="@",qEn=">",GEn=/[[\]{}]/,YEn={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let qHe,GHe;function XEn(e,t,n){return qHe=t||VEn,GHe=n||YEn,YHe(e.trim()).map(uJ)}function KEn(e){return GHe[e]}function BA(e,t,n,r,i){const s=e.length;let a=0,o;for(;t<s;++t){if(o=e[t],!a&&o===n)return t;i&&i.indexOf(o)>=0?--a:r&&r.indexOf(o)>=0&&++a}return t}function YHe(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=BA(e,i,HHe,p8+VHe,g8+jHe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function uJ(e){return e[0]==="["?ZEn(e):QEn(e)}function ZEn(e){const t=e.length;let n=1,r;if(n=BA(e,n,g8,p8,g8),n===t)throw"Empty between selector: "+e;if(r=YHe(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==qEn)throw"Expected '>' after between selector: "+e;r=r.map(uJ);const i=uJ(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function QEn(e){const t={source:qHe},n=[];let r=[0,0],i=0,s=0,a=e.length,o=0,l,u;if(e[a-1]===jHe){if(o=e.lastIndexOf(VHe),o>=0){try{r=JEn(e.substring(o+1,a-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,o).trim(),a=e.length}else throw"Unmatched right brace: "+e;o=0}if(!a)throw e;if(e[0]===HEn&&(i=++o),l=BA(e,o,jEn),l<a&&(n.push(e.substring(s,l).trim()),s=o=++l),o=BA(e,o,p8),o===a)n.push(e.substring(s,a).trim());else if(n.push(e.substring(s,o).trim()),u=[],s=++o,s===a)throw"Unmatched left bracket: "+e;for(;o<a;){if(o=BA(e,o,g8),o===a)throw"Unmatched left bracket: "+e;if(u.push(e.substring(s,o).trim()),o<a-1&&e[++o]!==p8)throw"Expected left bracket: "+e;s=++o}if(!(a=n.length)||GEn.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],i?t.markname=n[0].slice(1):KEn(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),u!=null&&(t.filter=u),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function JEn(e){const t=e.split(HHe);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function eAn(e){return Ft(e)?e:{type:e||"pad"}}const Hk=e=>+e||0,tAn=e=>({top:e,bottom:e,left:e,right:e});function nAn(e){return Ft(e)?e.signal?e:{top:Hk(e.top),bottom:Hk(e.bottom),left:Hk(e.left),right:Hk(e.right)}:tAn(Hk(e))}const us=e=>Ft(e)&&!at(e)?zt({},e):{value:e};function iCe(e,t,n,r){return n!=null?(Ft(n)&&!at(n)||at(n)&&n.length&&Ft(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function Gs(e,t,n){for(const r in t)iCe(e,r,t[r]);for(const r in n)iCe(e,r,n[r],"update")}function xS(e,t,n){for(const r in t)n&&bt(n,r)||(e[r]=zt(e[r]||{},t[r]));return e}function k2(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const zce="mark",Uce="frame",Wce="scope",rAn="axis",iAn="axis-domain",sAn="axis-grid",aAn="axis-label",oAn="axis-tick",lAn="axis-title",uAn="legend",cAn="legend-band",fAn="legend-entry",hAn="legend-gradient",XHe="legend-label",dAn="legend-symbol",pAn="legend-title",gAn="title",mAn="title-text",vAn="title-subtitle";function yAn(e,t,n,r,i){const s={},a={};let o,l,u,c;l="lineBreak",t==="text"&&i[l]!=null&&!k2(l,e)&&vG(s,l,i[l]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===Uce?i.group:n===zce?zt({},i.mark,i[t]):null;for(l in c)u=k2(l,e)||(l==="fill"||l==="stroke")&&(k2("fill",e)||k2("stroke",e)),u||vG(s,l,c[l]);ct(r).forEach(f=>{const h=i.style&&i.style[f];for(const d in h)k2(d,e)||vG(s,d,h[d])}),e=zt({},e);for(l in s)c=s[l],c.signal?(o=o||{})[l]=c:a[l]=c;return e.enter=zt(a,e.enter),o&&(e.update=zt(o,e.update)),e}function vG(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const KHe=e=>$r(e)?ot(e):e.signal?`(${e.signal})`:ZHe(e);function vW(e){if(e.gradient!=null)return xAn(e);let t=e.signal?`(${e.signal})`:e.color?bAn(e.color):e.field!=null?ZHe(e.field):e.value!==void 0?ot(e.value):void 0;return e.scale!=null&&(t=wAn(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${H4(e.exponent)})`),e.mult!=null&&(t+=`*${H4(e.mult)}`),e.offset!=null&&(t+=`+${H4(e.offset)}`),e.round&&(t=`round(${t})`),t}const NR=(e,t,n,r)=>`(${e}(${[t,n,r].map(vW).join(",")})+'')`;function bAn(e){return e.c?NR("hcl",e.h,e.c,e.l):e.h||e.s?NR("hsl",e.h,e.s,e.l):e.l||e.a?NR("lab",e.l,e.a,e.b):e.r||e.g||e.b?NR("rgb",e.r,e.g,e.b):null}function xAn(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:ot(n));for(;t.length&&un(t)==null;)t.pop();return t.unshift(KHe(e.gradient)),`gradient(${t.join(",")})`}function H4(e){return Ft(e)?"("+vW(e)+")":e}function ZHe(e){return QHe(Ft(e)?e:{datum:e})}function QHe(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):$e("Invalid field reference: "+ot(e));return e.signal||(r=$r(r)?Mre(r).map(ot).join("]["):QHe(r)),t+"["+r+"]"}function wAn(e,t){const n=KHe(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+H4(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function $An(e){let t="";return e.forEach(n=>{const r=vW(n);t+=n.test?`(${n.test})?${r}:`:r}),un(t)===":"&&(t+="null"),t}function JHe(e,t,n,r,i,s){const a={};s=s||{},s.encoders={$encode:a},e=yAn(e,t,n,r,i.config);for(const o in e)a[o]=CAn(e[o],t,s,i);return s}function CAn(e,t,n,r){const i={},s={};for(const a in e)e[a]!=null&&(i[a]=SAn(_An(e[a]),r,n,s));return{$expr:{marktype:t,channels:i},$fields:Object.keys(s),$output:Object.keys(e)}}function _An(e){return at(e)?$An(e):vW(e)}function SAn(e,t,n,r){const i=qh(e,t);return i.$fields.forEach(s=>r[s]=1),zt(n,i.$params),i.$expr}const kAn="outer",EAn=["value","update","init","react","bind"];function sCe(e,t){$e(e+' for "outer" push: '+ot(t))}function eqe(e,t){const n=e.name;if(e.push===kAn)t.signals[n]||sCe("No prior signal definition",n),EAn.forEach(r=>{e[r]!==void 0&&sCe("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function cJ(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function yW(e,t,n,r){return new cJ(e,t,n,r)}function m8(e,t){return yW("operator",e,t)}function tt(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function AD(e,t){return t?{$field:e,$name:t}:{$field:e}}const fJ=AD("key");function aCe(e,t){return{$compare:e,$order:t}}function AAn(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const TAn="ascending",DAn="descending";function NAn(e){return Ft(e)?(e.order===DAn?"-":"+")+bW(e.op,e.field):""}function bW(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const Vce="scope",hJ="view";function Ni(e){return e&&e.signal}function IAn(e){return e&&e.expr}function q4(e){if(Ni(e))return!0;if(Ft(e)){for(const t in e)if(q4(e[t]))return!0}return!1}function mc(e,t){return e!=null?e:t}function my(e){return e&&e.signal||e}const oCe="timer";function TD(e,t){return(e.merge?FAn:e.stream?OAn:e.type?RAn:$e("Invalid stream specification: "+ot(e)))(e,t)}function MAn(e){return e===Vce?hJ:e||hJ}function FAn(e,t){const n=e.merge.map(i=>TD(i,t)),r=jce({merge:n},e,t);return t.addStream(r).id}function OAn(e,t){const n=TD(e.stream,t),r=jce({stream:n},e,t);return t.addStream(r).id}function RAn(e,t){let n;e.type===oCe?(n=t.event(oCe,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(MAn(e.source),e.type);const r=jce({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function jce(e,t,n){let r=t.between;return r&&(r.length!==2&&$e('Stream "between" parameter must have 2 entries: '+ot(t)),e.between=[TD(r[0],n),TD(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(PAn(t.marktype,t.markname,t.markrole)),t.source===Vce&&r.push("inScope(event.item)"),r.length&&(e.filter=qh("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function PAn(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const LAn={code:"_.$value",ast:{type:"Identifier",value:"value"}};function BAn(e,t,n){const r=e.encode,i={target:n};let s=e.events,a=e.update,o=[];s||$e("Signal update missing events specification."),$r(s)&&(s=XEn(s,t.isSubscope()?Vce:hJ)),s=ct(s).filter(l=>l.signal||l.scale?(o.push(l),0):1),o.length>1&&(o=[UAn(o)]),s.length&&o.push(s.length>1?{merge:s}:s[0]),r!=null&&(a&&$e("Signal encode and update are mutually exclusive."),a="encode(item(),"+ot(r)+")"),i.update=$r(a)?qh(a,t):a.expr!=null?qh(a.expr,t):a.value!=null?a.value:a.signal!=null?{$expr:LAn,$params:{$value:t.signalRef(a.signal)}}:$e("Invalid signal update specification."),e.force&&(i.options={force:!0}),o.forEach(l=>t.addUpdate(zt(zAn(l,t),i)))}function zAn(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):TD(e,t)}}function UAn(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function WAn(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?$e("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=qh(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>BAn(i,t,n.id))}const Kn=e=>(t,n,r)=>yW(e,n,t||void 0,r),tqe=Kn("aggregate"),VAn=Kn("axisticks"),nqe=Kn("bound"),bf=Kn("collect"),lCe=Kn("compare"),jAn=Kn("datajoin"),rqe=Kn("encode"),HAn=Kn("expression"),qAn=Kn("facet"),GAn=Kn("field"),YAn=Kn("key"),XAn=Kn("legendentries"),KAn=Kn("load"),ZAn=Kn("mark"),QAn=Kn("multiextent"),JAn=Kn("multivalues"),eTn=Kn("overlap"),tTn=Kn("params"),iqe=Kn("prefacet"),nTn=Kn("projection"),rTn=Kn("proxy"),iTn=Kn("relay"),sqe=Kn("render"),sTn=Kn("scale"),Ix=Kn("sieve"),aTn=Kn("sortitems"),aqe=Kn("viewlayout"),oTn=Kn("values");let lTn=0;const oqe={min:"min",max:"max",count:"sum"};function uTn(e,t){const n=e.type||"linear";U5e(n)||$e("Unrecognized scale type: "+ot(n)),t.addScale(e.name,{type:n,domain:void 0})}function cTn(e,t){const n=t.getScale(e.name).params;let r;n.domain=lqe(e.domain,e,t),e.range!=null&&(n.range=cqe(e,t,n)),e.interpolate!=null&&xTn(e.interpolate,n),e.nice!=null&&(n.nice=bTn(e.nice)),e.bins!=null&&(n.bins=yTn(e.bins,t));for(r in e)bt(n,r)||r==="name"||(n[r]=Eu(e[r],t))}function Eu(e,t){return Ft(e)?e.signal?t.signalRef(e.signal):$e("Unsupported object: "+ot(e)):e}function G4(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Eu(n,t))}function xW(e){$e("Can not find data set: "+ot(e))}function lqe(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&$e("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(at(e)?fTn:e.fields?dTn:hTn)(e,t,n)}function fTn(e,t,n){return e.map(r=>Eu(r,n))}function hTn(e,t,n){const r=n.getData(e.data);return r||xW(e.data),a$(t.type)?r.valuesRef(n,e.field,uqe(e.sort,!1)):j5e(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function dTn(e,t,n){const r=e.data,i=e.fields.reduce((s,a)=>(a=$r(a)?{data:r,field:a}:at(a)||a.signal?pTn(a,n):a,s.push(a),s),[]);return(a$(t.type)?gTn:j5e(t.type)?mTn:vTn)(e,n,i)}function pTn(e,t){const n="_:vega:_"+lTn++,r=bf({});if(at(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+ot(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Ix({})]),{data:n,field:"data"}}function gTn(e,t,n){const r=uqe(e.sort,!0);let i,s;const a=n.map(u=>{const c=t.getData(u.data);return c||xW(u.data),c.countsRef(t,u.field,r)}),o={groupby:fJ,pulse:a};r&&(i=r.op||"count",s=r.field?bW(i,r.field):"count",o.ops=[oqe[i]],o.fields=[t.fieldRef(s)],o.as=[s]),i=t.add(tqe(o));const l=t.add(bf({pulse:tt(i)}));return s=t.add(oTn({field:fJ,sort:t.sortRef(r),pulse:tt(l)})),tt(s)}function uqe(e,t){return e&&(!e.field&&!e.op?Ft(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?$e("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!oqe[e.op]&&$e("Multiple domain scales can not be sorted using "+e.op)),e}function mTn(e,t,n){const r=n.map(i=>{const s=t.getData(i.data);return s||xW(i.data),s.domainRef(t,i.field)});return tt(t.add(JAn({values:r})))}function vTn(e,t,n){const r=n.map(i=>{const s=t.getData(i.data);return s||xW(i.data),s.extentRef(t,i.field)});return tt(t.add(QAn({extents:r})))}function yTn(e,t){return e.signal||at(e)?G4(e,t):t.objectProperty(e)}function bTn(e){return Ft(e)?{interval:Eu(e.interval),step:Eu(e.step)}:Eu(e)}function xTn(e,t){t.interpolate=Eu(e.type||e),e.gamma!=null&&(t.interpolateGamma=Eu(e.gamma))}function cqe(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if($r(i)){if(r&&bt(r,i))return e=zt({},e,{range:r[i]}),cqe(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=a$(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:$e("Unrecognized scale range value: "+ot(i))}else if(i.scheme){n.scheme=at(i.scheme)?G4(i.scheme,t):Eu(i.scheme,t),i.extent&&(n.schemeExtent=G4(i.extent,t)),i.count&&(n.schemeCount=Eu(i.count,t));return}else if(i.step){n.rangeStep=Eu(i.step,t);return}else{if(a$(e.type)&&!at(i))return lqe(i,e,t);at(i)||$e("Unsupported range type: "+ot(i))}return i.map(s=>(at(s)?G4:Eu)(s,t))}function wTn(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=dJ(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=dJ(n[i],i,t));t.addProjection(e.name,r)}function dJ(e,t,n){return at(e)?e.map(r=>dJ(r,t,n)):Ft(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:$e("Unsupported parameter object: "+ot(e)):e}const xf="top",wS="left",$S="right",Em="bottom",fqe="center",$Tn="vertical",CTn="start",_Tn="middle",STn="end",pJ="index",Hce="label",kTn="offset",X$="perc",ETn="perc2",Nu="value",oF="guide-label",qce="guide-title",ATn="group-title",TTn="group-subtitle",uCe="symbol",Y4="gradient",gJ="discrete",mJ="size",DTn="shape",NTn="fill",ITn="stroke",MTn="strokeWidth",FTn="strokeDash",OTn="opacity",Gce=[mJ,DTn,NTn,ITn,MTn,FTn,OTn],lF={name:1,style:1,interactive:1},an={value:0},Iu={value:1},wW="group",hqe="rect",Yce="rule",RTn="symbol",Mx="text";function DD(e){return e.type=wW,e.interactive=e.interactive||!1,e}function bl(e,t){const n=(r,i)=>mc(e[r],mc(t[r],i));return n.isVertical=r=>$Tn===mc(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>mc(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>mc(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>mc(e.columns,mc(t.columns,+n.isVertical(!0))),n}function dqe(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function PTn(e,t,n){const r=t.config.style[n];return r&&r[e]}function $W(e,t,n){return`item.anchor === '${CTn}' ? ${e} : item.anchor === '${STn}' ? ${t} : ${n}`}const Xce=$W(ot(wS),ot($S),ot(fqe));function LTn(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},Ft(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function pqe(e,t){return t?e?Ft(e)?Object.assign({},e,{offset:pqe(e.offset,t)}):{value:e,offset:t}:t:e}function Kl(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=xS(e.encode,t,lF)):e.interactive=!1,e}function BTn(e,t,n,r){const i=bl(e,n),s=i.isVertical(),a=i.gradientThickness(),o=i.gradientLength();let l,u,c,f,h;s?(u=[0,1],c=[0,0],f=a,h=o):(u=[0,0],c=[1,0],f=o,h=a);const d={enter:l={opacity:an,x:an,y:an,width:us(f),height:us(h)},update:zt({},l,{opacity:Iu,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:an}};return Gs(d,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Kl({type:hqe,role:hAn,encode:d},r)}function zTn(e,t,n,r,i){const s=bl(e,n),a=s.isVertical(),o=s.gradientThickness(),l=s.gradientLength();let u,c,f,h,d="";a?(u="y",f="y2",c="x",h="width",d="1-"):(u="x",f="x2",c="y",h="height");const p={opacity:an,fill:{scale:t,field:Nu}};p[u]={signal:d+"datum."+X$,mult:l},p[c]=an,p[f]={signal:d+"datum."+ETn,mult:l},p[h]=us(o);const g={enter:p,update:zt({},p,{opacity:Iu}),exit:{opacity:an}};return Gs(g,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),Kl({type:hqe,role:cAn,key:Nu,from:i,encode:g},r)}const UTn=`datum.${X$}<=0?"${wS}":datum.${X$}>=1?"${$S}":"${fqe}"`,WTn=`datum.${X$}<=0?"${Em}":datum.${X$}>=1?"${xf}":"${_Tn}"`;function cCe(e,t,n,r){const i=bl(e,t),s=i.isVertical(),a=us(i.gradientThickness()),o=i.gradientLength();let l=i("labelOverlap"),u,c,f,h,d="";const p={enter:u={opacity:an},update:c={opacity:Iu,text:{field:Hce}},exit:{opacity:an}};return Gs(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:mc(e.labelLimit,t.gradientLabelLimit)}),s?(u.align={value:"left"},u.baseline=c.baseline={signal:WTn},f="y",h="x",d="1-"):(u.align=c.align={signal:UTn},u.baseline={value:"top"},f="x",h="y"),u[f]=c[f]={signal:d+"datum."+X$,mult:o},u[h]=c[h]=a,a.offset=mc(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:i("labelSeparation"),method:l,order:"datum."+pJ}:void 0,Kl({type:Mx,role:XHe,style:oF,key:Nu,from:r,encode:p,overlap:l},n)}function VTn(e,t,n,r,i){const s=bl(e,t),a=n.entries,o=!!(a&&a.interactive),l=a?a.name:void 0,u=s("clipHeight"),c=s("symbolOffset"),f={data:"value"},h=`(${i}) ? datum.${kTn} : datum.${mJ}`,d=u?us(u):{field:mJ},p=`datum.${pJ}`,g=`max(1, ${i})`;let m,v,y,b,x;d.mult=.5,m={enter:v={opacity:an,x:{signal:h,mult:.5,offset:c},y:d},update:y={opacity:Iu,x:v.x,y:v.y},exit:{opacity:an}};let w=null,C=null;e.fill||(w=t.symbolBaseFillColor,C=t.symbolBaseStrokeColor),Gs(m,{fill:s("symbolFillColor",w),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",C),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),Gce.forEach(E=>{e[E]&&(y[E]=v[E]={scale:e[E],field:Nu})});const $=Kl({type:RTn,role:dAn,key:Nu,from:f,clip:u?!0:void 0,encode:m},n.symbols),_=us(c);_.offset=s("labelOffset"),m={enter:v={opacity:an,x:{signal:h,offset:_},y:d},update:y={opacity:Iu,text:{field:Hce},x:v.x,y:v.y},exit:{opacity:an}},Gs(m,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const k=Kl({type:Mx,role:XHe,style:oF,key:Nu,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!u},width:an,height:u?us(u):an,opacity:an},exit:{opacity:an},update:y={opacity:Iu,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(b=`ceil(item.mark.items.length / ${g})`,y.row.signal=`${p}%${b}`,y.column.signal=`floor(${p} / ${b})`,x={field:["row",p]}):(y.row.signal=`floor(${p} / ${g})`,y.column.signal=`${p} % ${g}`,x={field:p}),y.column.signal=`(${i})?${y.column.signal}:${p}`,r={facet:{data:r,name:"value",groupby:pJ}},DD({role:Wce,from:r,encode:xS(m,a,lF),marks:[$,k],name:l,interactive:o,sort:x})}function jTn(e,t){const n=bl(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const Kce='item.orient === "left"',Zce='item.orient === "right"',CW=`(${Kce} || ${Zce})`,HTn=`datum.vgrad && ${CW}`,qTn=$W('"top"','"bottom"','"middle"'),GTn=$W('"right"','"left"','"center"'),YTn=`datum.vgrad && ${Zce} ? (${GTn}) : (${CW} && !(datum.vgrad && ${Kce})) ? "left" : ${Xce}`,XTn=`item._anchor || (${CW} ? "middle" : "start")`,KTn=`${HTn} ? (${Kce} ? -90 : 90) : 0`,ZTn=`${CW} ? (datum.vgrad ? (${Zce} ? "bottom" : "top") : ${qTn}) : "top"`;function QTn(e,t,n,r){const i=bl(e,t),s={enter:{opacity:an},update:{opacity:Iu,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:an}};return Gs(s,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:XTn},angle:{signal:KTn},align:{signal:YTn},baseline:{signal:ZTn},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Kl({type:Mx,role:pAn,style:qce,from:r,encode:s},n)}function JTn(e,t){let n;return Ft(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+fCe(e.path)+")":e.sphere&&(n="geoShape("+fCe(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function fCe(e){return Ft(e)&&e.signal?e.signal:ot(e)}function gqe(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===wW?Wce:t||zce}function e3n(e){return{marktype:e.type,name:e.name||void 0,role:e.role||gqe(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function t3n(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function Qce(e,t){const n=cRe(e.type);n||$e("Unrecognized transform type: "+ot(e.type));const r=yW(n.type.toLowerCase(),null,mqe(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function mqe(e,t,n){const r={},i=e.params.length;for(let s=0;s<i;++s){const a=e.params[s];r[a.name]=n3n(a,t,n)}return r}function n3n(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return r3n(e,t,n);if(i===void 0){e.required&&$e("Missing required "+ot(t.type)+" parameter: "+ot(e.name));return}else{if(r==="param")return i3n(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!Ni(i)?i.map(s=>hCe(e,s,n)):hCe(e,i,n)}function hCe(e,t,n){const r=e.type;if(Ni(t))return pCe(r)?$e("Expression references can not be signals."):yG(r)?n.fieldRef(t):gCe(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||yG(r);return i&&s3n(t)?n.exprRef(t.expr,t.as):i&&a3n(t)?AD(t.field,t.as):pCe(r)?qh(t,n):o3n(r)?tt(n.getData(t).values):yG(r)?AD(t):gCe(r)?n.compareRef(t):t}}function r3n(e,t,n){return $r(t.from)||$e('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function i3n(e,t,n){const r=t[e.name];return e.array?(at(r)||$e("Expected an array of sub-parameters. Instead: "+ot(r)),r.map(i=>dCe(e,i,n))):dCe(e,r,n)}function dCe(e,t,n){const r=e.params.length;let i;for(let a=0;a<r;++a){i=e.params[a];for(const o in i.key)if(i.key[o]!==t[o]){i=null;break}if(i)break}i||$e("Unsupported parameter: "+ot(t));const s=zt(mqe(i,t,n),i.key);return tt(n.add(tTn(s)))}const s3n=e=>e&&e.expr,a3n=e=>e&&e.field,o3n=e=>e==="data",pCe=e=>e==="expr",yG=e=>e==="field",gCe=e=>e==="compare";function l3n(e,t,n){let r,i,s,a,o;return e?(r=e.facet)&&(t||$e("Only group marks can be faceted."),r.field!=null?a=o=X4(r,n):(e.data?o=tt(n.getData(e.data).aggregate):(s=Qce(zt({type:"aggregate",groupby:ct(r.groupby)},r.aggregate),n),s.params.key=n.keyRef(r.groupby),s.params.pulse=X4(r,n),a=o=tt(n.add(s))),i=n.keyRef(r.groupby,!0))):a=tt(n.add(bf(null,[{}]))),a||(a=X4(e,n)),{key:i,pulse:a,parent:o}}function X4(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:tt(t.getData(e.data).output)}function bb(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}bb.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let s=t[0],a=null,o=1;for(s&&s.type==="load"&&(s=t[1]),e.add(t[0]);o<n;++o)t[o].params.pulse=tt(t[o-1]),e.add(t[o]),t[o].type==="aggregate"&&(a=t[o]);return new bb(e,s,i,r,a)};function vqe(e){return $r(e)?e:null}function mCe(e,t,n){const r=bW(n.op,n.field);let i;if(t.ops){for(let s=0,a=t.as.length;s<a;++s)if(t.as[s]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function qk(e,t,n,r,i,s,a){const o=t[n]||(t[n]={}),l=NAn(s);let u=vqe(i),c,f;if(u!=null&&(e=t.scope,u=u+(l?"|"+l:""),c=o[u]),!c){const h=s?{field:fJ,pulse:t.countsRef(e,i,s)}:{field:e.fieldRef(i),pulse:tt(t.output)};l&&(h.sort=e.sortRef(s)),f=e.add(yW(r,void 0,h)),a&&(t.index[i]=f),c=tt(f),u!=null&&(o[u]=c)}return c}bb.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),s=vqe(t);let a,o,l;return s!=null&&(e=r.scope,a=i[s]),a?n&&n.field&&mCe(e,a.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:tt(r.output)},n&&n.field&&mCe(e,l,n),o=e.add(tqe(l)),a=e.add(bf({pulse:tt(o)})),a={agg:o,ref:tt(a)},s!=null&&(i[s]=a)),a.ref},tuplesRef(){return tt(this.values)},extentRef(e,t){return qk(e,this,"extent","extent",t,!1)},domainRef(e,t){return qk(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return qk(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return qk(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return qk(e,this,"indata","tupleindex",t,!0,!0)}};function u3n(e,t,n){const r=e.from.facet,i=r.name,s=X4(r,t);let a;r.name||$e("Facet must have a name: "+ot(r)),r.data||$e("Facet must reference a data set: "+ot(r)),r.field?a=t.add(iqe({field:t.fieldRef(r.field),pulse:s})):r.groupby?a=t.add(qAn({key:t.keyRef(r.groupby),group:tt(t.proxy(n.parent)),pulse:s})):$e("Facet must specify groupby or field: "+ot(r));const o=t.fork(),l=o.add(bf()),u=o.add(Ix({pulse:tt(l)}));o.addData(i,new bb(o,l,l,u)),o.addSignal("parent",null),a.params.subflow={$subflow:o.parse(e).toRuntime()}}function c3n(e,t,n){const r=t.add(iqe({pulse:n.pulse})),i=t.fork();i.add(Ix()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function yqe(e,t,n){const r=e.remove,i=e.insert,s=e.toggle,a=e.modify,o=e.values,l=t.add(m8()),u="if("+e.trigger+',modify("'+n+'",'+[i,r,s,a,o].map(f=>f==null?"null":f).join(",")+"),0)",c=qh(u,t);l.update=c.$expr,l.params=c.$params}function _W(e,t){const n=gqe(e),r=e.type===wW,i=e.from&&e.from.facet,s=e.overlap;let a=e.layout||n===Wce||n===Uce,o,l,u,c,f,h,d;const p=n===zce||a||i,g=l3n(e.from,r,t);l=t.add(jAn({key:g.key||(e.key?AD(e.key):void 0),pulse:g.pulse,clean:!r}));const m=tt(l);l=u=t.add(bf({pulse:m})),l=t.add(ZAn({markdef:e3n(e),interactive:t3n(e.interactive,t),clip:JTn(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:tt(l)}));const v=tt(l);l=c=t.add(rqe(JHe(e.encode,e.type,n,e.style,t,{mod:!1,pulse:v}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(C=>{const $=Qce(C,t),_=$.metadata;(_.generates||_.changes)&&$e("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),$.params.pulse=tt(l),t.add(l=$)}),e.sort&&(l=t.add(aTn({sort:t.compareRef(e.sort),pulse:tt(l)})));const y=tt(l);(i||a)&&(a=t.add(aqe({layout:t.objectProperty(e.layout),legends:t.legends,mark:v,pulse:y})),h=tt(a));const b=t.add(nqe({mark:v,pulse:h||y}));d=tt(b),r&&(p&&(o=t.operators,o.pop(),a&&o.pop()),t.pushState(y,h||d,m),i?u3n(e,t,g):p?c3n(e,t,g):t.parse(e),t.popState(),p&&(a&&o.push(a),o.push(b))),s&&(d=f3n(s,d,t));const x=t.add(sqe({pulse:d})),w=t.add(Ix({pulse:tt(x)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new bb(t,u,x,w)),e.on&&e.on.forEach(C=>{(C.insert||C.remove||C.toggle)&&$e("Marks only support modify triggers."),yqe(C,t,f)}))}function f3n(e,t,n){const r=e.method,i=e.bound,s=e.separation,a={separation:Ni(s)?n.signalRef(s.signal):s,method:Ni(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(a.sort=n.compareRef({field:e.order})),i){const o=i.tolerance;a.boundTolerance=Ni(o)?n.signalRef(o.signal):+o,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return tt(n.add(eTn(a)))}function h3n(e,t){const n=t.config.legend,r=e.encode||{},i=bl(e,n),s=r.legend||{},a=s.name||void 0,o=s.interactive,l=s.style,u={};let c=0,f,h,d;Gce.forEach(b=>e[b]?(u[b]=e[b],c=c||e[b]):0),c||$e("Missing valid scale for legend.");const p=d3n(e,t.scaleType(c)),g={title:e.title!=null,scales:u,type:p,vgrad:p!=="symbol"&&i.isVertical()},m=tt(t.add(bf(null,[g]))),v={enter:{x:{value:0},y:{value:0}}},y=tt(t.add(XAn(h={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===Y4?(d=[BTn(e,c,n,r.gradient),cCe(e,n,r.labels,y)],h.count=h.count||t.signalRef(`max(2,2*floor((${my(i.gradientLength())})/100))`)):p===gJ?d=[zTn(e,c,n,r.gradient,y),cCe(e,n,r.labels,y)]:(f=jTn(e,n),d=[VTn(e,n,r,y,my(f.columns))],h.size=m3n(e,t,d[0].marks)),d=[DD({role:fAn,from:m,encode:v,marks:d,layout:f,interactive:o})],g.title&&d.push(QTn(e,n,r.title,m)),_W(DD({role:uAn,from:m,encode:xS(g3n(i,e,n),s,lF),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:o,style:l}),t)}function d3n(e,t){let n=e.type||uCe;return!e.type&&p3n(e)===1&&(e.fill||e.stroke)&&(n=cse(t)?Y4:oK(t)?gJ:uCe),n!==Y4?n:oK(t)?gJ:Y4}function p3n(e){return Gce.reduce((t,n)=>t+(e[n]?1:0),0)}function g3n(e,t,n){const r={enter:{},update:{}};return Gs(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function m3n(e,t,n){const r=my(vCe("size",e,n)),i=my(vCe("strokeWidth",e,n)),s=my(v3n(n[1].encode,t,oF));return qh(`max(ceil(sqrt(${r})+${i}),${s})`,t)}function vCe(e,t,n){return t[e]?`scale("${t[e]}",datum)`:dqe(e,n[0].encode)}function v3n(e,t,n){return dqe("fontSize",e)||PTn("fontSize",t,n)}const y3n=`item.orient==="${wS}"?-90:item.orient==="${$S}"?90:0`;function b3n(e,t){e=$r(e)?{text:e}:e;const n=bl(e,t.config.title),r=e.encode||{},i=r.group||{},s=i.name||void 0,a=i.interactive,o=i.style,l=[],u={},c=tt(t.add(bf(null,[u])));return l.push($3n(e,n,x3n(e),c)),e.subtitle&&l.push(C3n(e,n,r.subtitle,c)),_W(DD({role:gAn,from:c,encode:w3n(n,i),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:a,style:o}),t)}function x3n(e){const t=e.encode;return t&&t.title||zt({name:e.name,interactive:e.interactive,style:e.style},t)}function w3n(e,t){const n={enter:{},update:{}};return Gs(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:Xce},angle:{signal:y3n},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),xS(n,t,lF)}function $3n(e,t,n,r){const i={value:0},s=e.text,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Gs(a,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Kl({type:Mx,role:mAn,style:ATn,from:r,encode:a},n)}function C3n(e,t,n,r){const i={value:0},s=e.subtitle,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Gs(a,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Kl({type:Mx,role:vAn,style:TTn,from:r,encode:a},n)}function _3n(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(Qce(r,t))}),e.on&&e.on.forEach(r=>{yqe(r,t,e.name)}),t.addDataPipeline(e.name,S3n(e,t,n))}function S3n(e,t,n){const r=[];let i=null,s=!1,a=!1,o,l,u,c,f;for(e.values?Ni(e.values)||q4(e.format)?(r.push(yCe(t,e)),r.push(i=Fv())):r.push(i=Fv({$ingest:e.values,$format:e.format})):e.url?q4(e.url)||q4(e.format)?(r.push(yCe(t,e)),r.push(i=Fv())):r.push(i=Fv({$request:e.url,$format:e.format})):e.source&&(i=o=ct(e.source).map(h=>tt(t.getData(h).output)),r.push(null)),l=0,u=n.length;l<u;++l)c=n[l],f=c.metadata,!i&&!f.source&&r.push(i=Fv()),r.push(c),f.generates&&(a=!0),f.modifies&&!a&&(s=!0),f.source?i=c:f.changes&&(i=null);return o&&(u=o.length-1,r[0]=iTn({derive:s,pulse:u?o:o[0]}),(s||u)&&r.splice(1,0,Fv())),i||r.push(Fv()),r.push(Ix({})),r}function Fv(e){const t=bf({},e);return t.metadata={source:!0},t}function yCe(e,t){return KAn({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const bqe=e=>e===Em||e===xf,SW=(e,t,n)=>Ni(e)?T3n(e.signal,t,n):e===wS||e===xf?t:n,cs=(e,t,n)=>Ni(e)?E3n(e.signal,t,n):bqe(e)?t:n,jc=(e,t,n)=>Ni(e)?A3n(e.signal,t,n):bqe(e)?n:t,xqe=(e,t,n)=>Ni(e)?D3n(e.signal,t,n):e===xf?{value:t}:{value:n},k3n=(e,t,n)=>Ni(e)?N3n(e.signal,t,n):e===$S?{value:t}:{value:n},E3n=(e,t,n)=>wqe(`${e} === '${xf}' || ${e} === '${Em}'`,t,n),A3n=(e,t,n)=>wqe(`${e} !== '${xf}' && ${e} !== '${Em}'`,t,n),T3n=(e,t,n)=>Jce(`${e} === '${wS}' || ${e} === '${xf}'`,t,n),D3n=(e,t,n)=>Jce(`${e} === '${xf}'`,t,n),N3n=(e,t,n)=>Jce(`${e} === '${$S}'`,t,n),wqe=(e,t,n)=>(t=t!=null?us(t):t,n=n!=null?us(n):n,bCe(t)&&bCe(n)?(t=t?t.signal||ot(t.value):null,n=n?n.signal||ot(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[zt({test:e},t)].concat(n||[])),bCe=e=>e==null||Object.keys(e).length===1,Jce=(e,t,n)=>({signal:`${e} ? (${B2(t)}) : (${B2(n)})`}),I3n=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${wS}' ? (${B2(r)}) : `:"")+(n!=null?`${e} === '${Em}' ? (${B2(n)}) : `:"")+(i!=null?`${e} === '${$S}' ? (${B2(i)}) : `:"")+(t!=null?`${e} === '${xf}' ? (${B2(t)}) : `:"")+"(null)"}),B2=e=>Ni(e)?e.signal:e==null?null:ot(e),M3n=(e,t)=>t===0?0:Ni(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},mw=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function y2(e,t,n,r){let i;if(t&&bt(t,e))return t[e];if(bt(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[qce][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[oF][i]}return null}function xCe(e){const t={};for(const n of e)if(!!n)for(const r in n)t[r]=1;return Object.keys(t)}function F3n(e,t){var n=t.config,r=n.style,i=n.axis,s=t.scaleType(e.scale)==="band"&&n.axisBand,a=e.orient,o,l,u;if(Ni(a)){const f=xCe([n.axisX,n.axisY]),h=xCe([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);o={};for(u of f)o[u]=cs(a,y2(u,n.axisX,i,r),y2(u,n.axisY,i,r));l={};for(u of h)l[u]=I3n(a.signal,y2(u,n.axisTop,i,r),y2(u,n.axisBottom,i,r),y2(u,n.axisLeft,i,r),y2(u,n.axisRight,i,r))}else o=a===xf||a===Em?n.axisX:n.axisY,l=n["axis"+a[0].toUpperCase()+a.slice(1)];return o||l||s?zt({},i,o,l,s):i}function O3n(e,t,n,r){const i=bl(e,t),s=e.orient;let a,o;const l={enter:a={opacity:an},update:o={opacity:Iu},exit:{opacity:an}};Gs(l,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=wCe(e,0),c=wCe(e,1);return a.x=o.x=cs(s,u,an),a.x2=o.x2=cs(s,c),a.y=o.y=jc(s,u,an),a.y2=o.y2=jc(s,c),Kl({type:Yce,role:iAn,from:r,encode:l},n)}function wCe(e,t){return{scale:e.scale,range:t}}function R3n(e,t,n,r,i){const s=bl(e,t),a=e.orient,o=e.gridScale,l=SW(a,1,-1),u=P3n(e.offset,l);let c,f,h;const d={enter:c={opacity:an},update:h={opacity:Iu},exit:f={opacity:an}};Gs(d,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const p={scale:e.scale,field:Nu,band:i.band,extra:i.extra,offset:i.offset,round:s("tickRound")},g=cs(a,{signal:"height"},{signal:"width"}),m=o?{scale:o,range:0,mult:l,offset:u}:{value:0,offset:u},v=o?{scale:o,range:1,mult:l,offset:u}:zt(g,{mult:l,offset:u});return c.x=h.x=cs(a,p,m),c.y=h.y=jc(a,p,m),c.x2=h.x2=jc(a,v),c.y2=h.y2=cs(a,v),f.x=cs(a,p),f.y=jc(a,p),Kl({type:Yce,role:sAn,key:Nu,from:r,encode:d},n)}function P3n(e,t){if(t!==1)if(!Ft(e))e=Ni(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=zt({},e);for(;n.mult!=null;)if(Ft(n.mult))n=n.mult=zt({},n.mult);else return n.mult=Ni(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function L3n(e,t,n,r,i,s){const a=bl(e,t),o=e.orient,l=SW(o,-1,1);let u,c,f;const h={enter:u={opacity:an},update:f={opacity:Iu},exit:c={opacity:an}};Gs(h,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const d=us(i);d.mult=l;const p={scale:e.scale,field:Nu,band:s.band,extra:s.extra,offset:s.offset,round:a("tickRound")};return f.y=u.y=cs(o,an,p),f.y2=u.y2=cs(o,d),c.x=cs(o,p),f.x=u.x=jc(o,an,p),f.x2=u.x2=jc(o,d),c.y=jc(o,p),Kl({type:Yce,role:oAn,key:Nu,from:r,encode:h},n)}function bG(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function B3n(e,t,n,r,i,s){const a=bl(e,t),o=e.orient,l=e.scale,u=SW(o,-1,1),c=my(a("labelFlush")),f=my(a("labelFlushOffset")),h=a("labelAlign"),d=a("labelBaseline");let p=c===0||!!c,g;const m=us(i);m.mult=u,m.offset=us(a("labelPadding")||0),m.offset.mult=u;const v={scale:l,field:Nu,band:.5,offset:pqe(s.offset,a("labelOffset"))},y=cs(o,p?bG(l,c,'"left"','"right"','"center"'):{value:"center"},k3n(o,"left","right")),b=cs(o,xqe(o,"bottom","top"),p?bG(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=bG(l,c,`-(${f})`,f,0);p=p&&f;const w={opacity:an,x:cs(o,v,m),y:jc(o,v,m)},C={enter:w,update:g={opacity:Iu,text:{field:Hce},x:w.x,y:w.y,align:y,baseline:b},exit:{opacity:an,x:w.x,y:w.y}};Gs(C,{dx:!h&&p?cs(o,x):null,dy:!d&&p?jc(o,x):null}),Gs(C,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:h,baseline:d});const $=a("labelBound");let _=a("labelOverlap");return _=_||$?{separation:a("labelSeparation"),method:_,order:"datum.index",bound:$?{scale:l,orient:o,tolerance:$}:null}:void 0,g.align!==y&&(g.align=mw(g.align,y)),g.baseline!==b&&(g.baseline=mw(g.baseline,b)),Kl({type:Mx,role:aAn,style:oF,key:Nu,from:r,encode:C,overlap:_},n)}function z3n(e,t,n,r){const i=bl(e,t),s=e.orient,a=SW(s,-1,1);let o,l;const u={enter:o={opacity:an,anchor:us(i("titleAnchor",null)),align:{signal:Xce}},update:l=zt({},o,{opacity:Iu,text:us(e.title)}),exit:{opacity:an}},c={signal:`lerp(range("${e.scale}"), ${$W(0,1,.5)})`};return l.x=cs(s,c),l.y=jc(s,c),o.angle=cs(s,an,M3n(a,90)),o.baseline=cs(s,xqe(s,Em,xf),{value:Em}),l.angle=o.angle,l.baseline=o.baseline,Gs(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),U3n(i,s,u,n),u.update.align=mw(u.update.align,o.align),u.update.angle=mw(u.update.angle,o.angle),u.update.baseline=mw(u.update.baseline,o.baseline),Kl({type:Mx,role:lAn,style:qce,from:r,encode:u},n)}function U3n(e,t,n,r){const i=(o,l)=>o!=null?(n.update[l]=mw(us(o),n.update[l]),!1):!k2(l,r),s=i(e("titleX"),"x"),a=i(e("titleY"),"y");n.enter.auto=a===s?us(a):cs(t,us(a),us(s))}function W3n(e,t){const n=F3n(e,t),r=e.encode||{},i=r.axis||{},s=i.name||void 0,a=i.interactive,o=i.style,l=bl(e,n),u=LTn(l),c={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:e.title!=null},f=tt(t.add(bf({},[c]))),h=tt(t.add(VAn({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),d=[];let p;return c.grid&&d.push(R3n(e,n,r.grid,h,u)),c.ticks&&(p=l("tickSize"),d.push(L3n(e,n,r.ticks,h,p,u))),c.labels&&(p=c.ticks?p:0,d.push(B3n(e,n,r.labels,h,p,u))),c.domain&&d.push(O3n(e,n,r.domain,f)),c.title&&d.push(z3n(e,n,r.title,f)),_W(DD({role:rAn,from:f,encode:xS(V3n(l,e),i,lF),marks:d,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:s,interactive:a,style:o}),t)}function V3n(e,t){const n={enter:{},update:{}};return Gs(n,{orient:e("orient"),offset:e("offset")||0,position:mc(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function $qe(e,t,n){const r=ct(e.signals),i=ct(e.scales);return n||r.forEach(s=>eqe(s,t)),ct(e.projections).forEach(s=>wTn(s,t)),i.forEach(s=>uTn(s,t)),ct(e.data).forEach(s=>_3n(s,t)),i.forEach(s=>cTn(s,t)),(n||r).forEach(s=>WAn(s,t)),ct(e.axes).forEach(s=>W3n(s,t)),ct(e.marks).forEach(s=>_W(s,t)),ct(e.legends).forEach(s=>h3n(s,t)),e.title&&b3n(e.title,t),t.parseLambdas(),t}const j3n=e=>xS({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function H3n(e,t){const n=t.config,r=tt(t.root=t.add(m8())),i=q3n(e,n);i.forEach(u=>eqe(u,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(bf()),a=t.add(rqe(JHe(j3n(e.encode),wW,Uce,e.style,t,{pulse:tt(s)}))),o=t.add(aqe({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:tt(a)}));t.operators.pop(),t.pushState(tt(a),tt(o),null),$qe(e,t,i),t.operators.push(o);let l=t.add(nqe({mark:r,pulse:tt(o)}));return l=t.add(sqe({pulse:tt(l)})),l=t.add(Ix({pulse:tt(l)})),t.addData("root",new bb(t,s,s,l)),t}function Gk(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function q3n(e,t){const n=a=>mc(e[a],t[a]),r=[Gk("background",n("background")),Gk("autosize",eAn(n("autosize"))),Gk("padding",nAn(n("padding"))),Gk("width",n("width")||0),Gk("height",n("height")||0)],i=r.reduce((a,o)=>(a[o.name]=o,a),{}),s={};return ct(e.signals).forEach(a=>{bt(i,a.name)?a=zt(i[a.name],a):r.push(a),s[a.name]=a}),ct(t.signals).forEach(a=>{!bt(s,a.name)&&!bt(i,a.name)&&r.push(a)}),r}function Cqe(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function $Ce(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}Cqe.prototype=$Ce.prototype={parse(e){return $qe(e,this)},fork(){return new $Ce(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof cJ?tt(e):e;return this.add(rTn({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,s){let a,o;r&&(a=r.data||(r.data={}),o=a[i]||(a[i]=[]),o.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(tt(this.add(Ix({pulse:e})))),this._parent.push(t),this._lookup.push(n?tt(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return un(this._parent)},encode(){return un(this._encode)},lookup(){return un(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if($r(e))return AD(e,t);e.signal||$e("Unsupported field reference: "+ot(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=tt(this.add(GAn(i)))}return r},compareRef(e){let t=!1;const n=s=>Ni(s)?(t=!0,this.signalRef(s.signal)):IAn(s)?(t=!0,this.exprRef(s.expr)):s,r=ct(e.field).map(n),i=ct(e.order).map(n);return t?tt(this.add(lCe({fields:r,orders:i}))):aCe(r,i)},keyRef(e,t){let n=!1;const r=s=>Ni(s)?(n=!0,tt(i[s.signal])):s,i=this.signals;return e=ct(e).map(r),n?tt(this.add(YAn({fields:e,flat:t}))):AAn(e,t)},sortRef(e){if(!e)return e;const t=bW(e.op,e.field),n=e.order||TAn;return n.signal?tt(this.add(lCe({fields:t,orders:this.signalRef(n.signal)}))):aCe(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return bt(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&$e("Duplicate signal name: "+ot(e));const n=t instanceof cJ?t:this.add(m8(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||$e("Unrecognized signal name: "+ot(e)),this.signals[e]},signalRef(e){return this.signals[e]?tt(this.signals[e]):(bt(this.lambdas,e)||(this.lambdas[e]=this.add(m8(null))),tt(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=qh(r,this),s=this.lambdas[r];s.params=i.$params,s.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Ft(e)?e:this.signalRef(e.signal||efe(e))},exprRef(e,t){const n={expr:qh(e,this)};return t&&(n.expr.$name=t),tt(this.add(HAn(n)))},addBinding(e,t){this.bindings||$e("Nested signals do not support binding: "+ot(e)),this.bindings.push(zt({signal:e},t))},addScaleProj(e,t){bt(this.scales,e)&&$e("Duplicate scale or projection name: "+ot(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,sTn(t))},addProjection(e,t){this.addScaleProj(e,nTn(t))},getScale(e){return this.scales[e]||$e("Unrecognized scale name: "+ot(e)),this.scales[e]},scaleRef(e){return tt(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return bt(this.data,e)&&$e("Duplicate data set name: "+ot(e)),this.data[e]=t},getData(e){return this.data[e]||$e("Undefined data set name: "+ot(e)),this.data[e]},addDataPipeline(e,t){return bt(this.data,e)&&$e("Duplicate data set name: "+ot(e)),this.addData(e,bb.fromEntries(this,t))}};function efe(e){return(at(e)?G3n:Y3n)(e)}function G3n(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(Ft(i)?i.signal||efe(i):ot(i))}return n+"]"}function Y3n(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+ot(r)+":"+(Ft(i)?i.signal||efe(i):ot(i));return t+"}"}function X3n(){const e="sans-serif",r="#4c78a8",i="#000",s="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:a}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function K3n(e,t,n){return Ft(e)||$e("Input Vega specification must be an object."),t=W6t(X3n(),t,e.config),H3n(e,new Cqe(t,n)).toRuntime()}function CS(e,t,n){return e.fields=t||[],e.fname=n,e}function Z3n(e){return e.length===1?Q3n(e[0]):J3n(e)}const Q3n=e=>function(t){return t[e]},J3n=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Rc(e){throw Error(e)}function eDn(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||Rc("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&Rc("Access path missing closing bracket: "+e),r&&Rc("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function tDn(e,t,n){const r=eDn(e);return e=r.length===1?r[0]:e,CS((n&&n.get||Z3n)(r),[e],t||e)}tDn("id");CS(e=>e,[],"identity");CS(()=>0,[],"zero");CS(()=>1,[],"one");CS(()=>!0,[],"true");CS(()=>!1,[],"false");function CCe(e){return typeof e=="function"}const nDn=Object.prototype.hasOwnProperty;function IR(e,t){return nDn.call(e,t)}function rDn(e){return typeof e=="string"}function _Ce(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}const iDn="RawCode",sDn="Literal",aDn="Property",oDn="Identifier",lDn="ArrayExpression",uDn="BinaryExpression",cDn="CallExpression",fDn="ConditionalExpression",hDn="LogicalExpression",dDn="MemberExpression",pDn="ObjectExpression",gDn="UnaryExpression";function wf(e){this.type=e}wf.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=mDn(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function mDn(e){switch(e.type){case lDn:return e.elements;case uDn:case hDn:return[e.left,e.right];case cDn:return[e.callee].concat(e.arguments);case fDn:return[e.test,e.consequent,e.alternate];case dDn:return[e.object,e.property];case pDn:return e.properties;case aDn:return[e.key,e.value];case gDn:return[e.argument];case oDn:case sDn:case iDn:default:return[]}}var vd,Xe,xe,ka,Un,kW=1,uF=2,xb=3,hv=4,EW=5,Fx=6,Po=7,cF=8,vDn=9;vd={};vd[kW]="Boolean";vd[uF]="<end>";vd[xb]="Identifier";vd[hv]="Keyword";vd[EW]="Null";vd[Fx]="Numeric";vd[Po]="Punctuator";vd[cF]="String";vd[vDn]="RegularExpression";var yDn="ArrayExpression",bDn="BinaryExpression",xDn="CallExpression",wDn="ConditionalExpression",_qe="Identifier",$Dn="Literal",CDn="LogicalExpression",_Dn="MemberExpression",SDn="ObjectExpression",kDn="Property",EDn="UnaryExpression",fs="Unexpected token %0",ADn="Unexpected number",TDn="Unexpected string",DDn="Unexpected identifier",NDn="Unexpected reserved word",IDn="Unexpected end of input",vJ="Invalid regular expression",xG="Invalid regular expression: missing /",Sqe="Octal literals are not allowed in strict mode.",MDn="Duplicate data property in object literal not allowed in strict mode",Ls="ILLEGAL",ND="Disabled.",FDn=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),ODn=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function AW(e,t){if(!e)throw new Error("ASSERT: "+t)}function jd(e){return e>=48&&e<=57}function tfe(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function zA(e){return"01234567".indexOf(e)>=0}function RDn(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function ID(e){return e===10||e===13||e===8232||e===8233}function fF(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&FDn.test(String.fromCharCode(e))}function v8(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&ODn.test(String.fromCharCode(e))}const PDn={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function kqe(){for(;xe<ka;){const e=Xe.charCodeAt(xe);if(RDn(e)||ID(e))++xe;else break}}function yJ(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)xe<ka&&tfe(Xe[xe])?(r=Xe[xe++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):xn({},fs,Ls);return String.fromCharCode(i)}function LDn(){var e,t,n,r;for(e=Xe[xe],t=0,e==="}"&&xn({},fs,Ls);xe<ka&&(e=Xe[xe++],!!tfe(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&xn({},fs,Ls),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function Eqe(){var e,t;for(e=Xe.charCodeAt(xe++),t=String.fromCharCode(e),e===92&&(Xe.charCodeAt(xe)!==117&&xn({},fs,Ls),++xe,e=yJ("u"),(!e||e==="\\"||!fF(e.charCodeAt(0)))&&xn({},fs,Ls),t=e);xe<ka&&(e=Xe.charCodeAt(xe),!!v8(e));)++xe,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Xe.charCodeAt(xe)!==117&&xn({},fs,Ls),++xe,e=yJ("u"),(!e||e==="\\"||!v8(e.charCodeAt(0)))&&xn({},fs,Ls),t+=e);return t}function BDn(){var e,t;for(e=xe++;xe<ka;){if(t=Xe.charCodeAt(xe),t===92)return xe=e,Eqe();if(v8(t))++xe;else break}return Xe.slice(e,xe)}function zDn(){var e,t,n;return e=xe,t=Xe.charCodeAt(xe)===92?Eqe():BDn(),t.length===1?n=xb:PDn.hasOwnProperty(t)?n=hv:t==="null"?n=EW:t==="true"||t==="false"?n=kW:n=xb,{type:n,value:t,start:e,end:xe}}function wG(){var e=xe,t=Xe.charCodeAt(xe),n,r=Xe[xe],i,s,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++xe,{type:Po,value:String.fromCharCode(t),start:e,end:xe};default:if(n=Xe.charCodeAt(xe+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return xe+=2,{type:Po,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:xe};case 33:case 61:return xe+=2,Xe.charCodeAt(xe)===61&&++xe,{type:Po,value:Xe.slice(e,xe),start:e,end:xe}}}if(a=Xe.substr(xe,4),a===">>>=")return xe+=4,{type:Po,value:a,start:e,end:xe};if(s=a.substr(0,3),s===">>>"||s==="<<="||s===">>=")return xe+=3,{type:Po,value:s,start:e,end:xe};if(i=s.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return xe+=2,{type:Po,value:i,start:e,end:xe};if(i==="//"&&xn({},fs,Ls),"<>=!+-*%&|^/".indexOf(r)>=0)return++xe,{type:Po,value:r,start:e,end:xe};xn({},fs,Ls)}function UDn(e){let t="";for(;xe<ka&&tfe(Xe[xe]);)t+=Xe[xe++];return t.length===0&&xn({},fs,Ls),fF(Xe.charCodeAt(xe))&&xn({},fs,Ls),{type:Fx,value:parseInt("0x"+t,16),start:e,end:xe}}function WDn(e){let t="0"+Xe[xe++];for(;xe<ka&&zA(Xe[xe]);)t+=Xe[xe++];return(fF(Xe.charCodeAt(xe))||jd(Xe.charCodeAt(xe)))&&xn({},fs,Ls),{type:Fx,value:parseInt(t,8),octal:!0,start:e,end:xe}}function SCe(){var e,t,n;if(n=Xe[xe],AW(jd(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=xe,e="",n!=="."){if(e=Xe[xe++],n=Xe[xe],e==="0"){if(n==="x"||n==="X")return++xe,UDn(t);if(zA(n))return WDn(t);n&&jd(n.charCodeAt(0))&&xn({},fs,Ls)}for(;jd(Xe.charCodeAt(xe));)e+=Xe[xe++];n=Xe[xe]}if(n==="."){for(e+=Xe[xe++];jd(Xe.charCodeAt(xe));)e+=Xe[xe++];n=Xe[xe]}if(n==="e"||n==="E")if(e+=Xe[xe++],n=Xe[xe],(n==="+"||n==="-")&&(e+=Xe[xe++]),jd(Xe.charCodeAt(xe)))for(;jd(Xe.charCodeAt(xe));)e+=Xe[xe++];else xn({},fs,Ls);return fF(Xe.charCodeAt(xe))&&xn({},fs,Ls),{type:Fx,value:parseFloat(e),start:t,end:xe}}function VDn(){var e="",t,n,r,i,s=!1;for(t=Xe[xe],AW(t==="'"||t==='"',"String literal must starts with a quote"),n=xe,++xe;xe<ka;)if(r=Xe[xe++],r===t){t="";break}else if(r==="\\")if(r=Xe[xe++],!r||!ID(r.charCodeAt(0)))switch(r){case"u":case"x":Xe[xe]==="{"?(++xe,e+=LDn()):e+=yJ(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:zA(r)?(i="01234567".indexOf(r),i!==0&&(s=!0),xe<ka&&zA(Xe[xe])&&(s=!0,i=i*8+"01234567".indexOf(Xe[xe++]),"0123".indexOf(r)>=0&&xe<ka&&zA(Xe[xe])&&(i=i*8+"01234567".indexOf(Xe[xe++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&Xe[xe]===`
`&&++xe;else{if(ID(r.charCodeAt(0)))break;e+=r}return t!==""&&xn({},fs,Ls),{type:cF,value:e,octal:s,start:n,end:xe}}function jDn(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";xn({},vJ)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{xn({},vJ)}try{return new RegExp(e,t)}catch{return null}}function HDn(){var e,t,n,r,i;for(e=Xe[xe],AW(e==="/","Regular expression literal must start with a slash"),t=Xe[xe++],n=!1,r=!1;xe<ka;)if(e=Xe[xe++],t+=e,e==="\\")e=Xe[xe++],ID(e.charCodeAt(0))&&xn({},xG),t+=e;else if(ID(e.charCodeAt(0)))xn({},xG);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||xn({},xG),i=t.substr(1,t.length-2),{value:i,literal:t}}function qDn(){var e,t,n;for(t="",n="";xe<ka&&(e=Xe[xe],!!v8(e.charCodeAt(0)));)++xe,e==="\\"&&xe<ka?xn({},fs,Ls):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&xn({},vJ,n),{value:n,literal:t}}function GDn(){var e,t,n,r;return Un=null,kqe(),e=xe,t=HDn(),n=qDn(),r=jDn(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:xe}}function YDn(e){return e.type===xb||e.type===hv||e.type===kW||e.type===EW}function Aqe(){if(kqe(),xe>=ka)return{type:uF,start:xe,end:xe};const e=Xe.charCodeAt(xe);return fF(e)?zDn():e===40||e===41||e===59?wG():e===39||e===34?VDn():e===46?jd(Xe.charCodeAt(xe+1))?SCe():wG():jd(e)?SCe():wG()}function Ho(){const e=Un;return xe=e.end,Un=Aqe(),xe=e.end,e}function Tqe(){const e=xe;Un=Aqe(),xe=e}function XDn(e){const t=new wf(yDn);return t.elements=e,t}function kCe(e,t,n){const r=new wf(e==="||"||e==="&&"?CDn:bDn);return r.operator=e,r.left=t,r.right=n,r}function KDn(e,t){const n=new wf(xDn);return n.callee=e,n.arguments=t,n}function ZDn(e,t,n){const r=new wf(wDn);return r.test=e,r.consequent=t,r.alternate=n,r}function nfe(e){const t=new wf(_qe);return t.name=e,t}function QE(e){const t=new wf($Dn);return t.value=e.value,t.raw=Xe.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function ECe(e,t,n){const r=new wf(_Dn);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function QDn(e){const t=new wf(SDn);return t.properties=e,t}function ACe(e,t,n){const r=new wf(kDn);return r.key=t,r.value=n,r.kind=e,r}function JDn(e,t){const n=new wf(EDn);return n.operator=e,n.argument=t,n.prefix=!0,n}function xn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(s,a)=>(AW(a<r.length,"Message reference must be in range"),r[a]));throw n=new Error(i),n.index=xe,n.description=i,n}function TW(e){e.type===uF&&xn(e,IDn),e.type===Fx&&xn(e,ADn),e.type===cF&&xn(e,TDn),e.type===xb&&xn(e,DDn),e.type===hv&&xn(e,NDn),xn(e,fs,e.value)}function Ea(e){const t=Ho();(t.type!==Po||t.value!==e)&&TW(t)}function gr(e){return Un.type===Po&&Un.value===e}function $G(e){return Un.type===hv&&Un.value===e}function eNn(){const e=[];for(xe=Un.start,Ea("[");!gr("]");)gr(",")?(Ho(),e.push(null)):(e.push(wb()),gr("]")||Ea(","));return Ho(),XDn(e)}function TCe(){xe=Un.start;const e=Ho();return e.type===cF||e.type===Fx?(e.octal&&xn(e,Sqe),QE(e)):nfe(e.value)}function tNn(){var e,t,n,r;if(xe=Un.start,e=Un,e.type===xb)return n=TCe(),Ea(":"),r=wb(),ACe("init",n,r);if(e.type===uF||e.type===Po)TW(e);else return t=TCe(),Ea(":"),r=wb(),ACe("init",t,r)}function nNn(){var e=[],t,n,r,i={},s=String;for(xe=Un.start,Ea("{");!gr("}");)t=tNn(),t.key.type===_qe?n=t.key.name:n=s(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?xn({},MDn):i[r]=!0,e.push(t),gr("}")||Ea(",");return Ea("}"),QDn(e)}function rNn(){Ea("(");const e=rfe();return Ea(")"),e}const iNn={if:1};function sNn(){var e,t,n;if(gr("("))return rNn();if(gr("["))return eNn();if(gr("{"))return nNn();if(e=Un.type,xe=Un.start,e===xb||iNn[Un.value])n=nfe(Ho().value);else if(e===cF||e===Fx)Un.octal&&xn(Un,Sqe),n=QE(Ho());else{if(e===hv)throw new Error(ND);e===kW?(t=Ho(),t.value=t.value==="true",n=QE(t)):e===EW?(t=Ho(),t.value=null,n=QE(t)):gr("/")||gr("/=")?(n=QE(GDn()),Tqe()):TW(Ho())}return n}function aNn(){const e=[];if(Ea("("),!gr(")"))for(;xe<ka&&(e.push(wb()),!gr(")"));)Ea(",");return Ea(")"),e}function oNn(){xe=Un.start;const e=Ho();return YDn(e)||TW(e),nfe(e.value)}function lNn(){return Ea("."),oNn()}function uNn(){Ea("[");const e=rfe();return Ea("]"),e}function cNn(){var e,t,n;for(e=sNn();;)if(gr("."))n=lNn(),e=ECe(".",e,n);else if(gr("("))t=aNn(),e=KDn(e,t);else if(gr("["))n=uNn(),e=ECe("[",e,n);else break;return e}function DCe(){const e=cNn();if(Un.type===Po&&(gr("++")||gr("--")))throw new Error(ND);return e}function K4(){var e,t;if(Un.type!==Po&&Un.type!==hv)t=DCe();else{if(gr("++")||gr("--"))throw new Error(ND);if(gr("+")||gr("-")||gr("~")||gr("!"))e=Ho(),t=K4(),t=JDn(e.value,t);else{if($G("delete")||$G("void")||$G("typeof"))throw new Error(ND);t=DCe()}}return t}function NCe(e){let t=0;if(e.type!==Po&&e.type!==hv)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function fNn(){var e,t,n,r,i,s,a,o,l,u;if(e=Un,l=K4(),r=Un,i=NCe(r),i===0)return l;for(r.prec=i,Ho(),t=[e,Un],a=K4(),s=[l,r,a];(i=NCe(Un))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)a=s.pop(),o=s.pop().value,l=s.pop(),t.pop(),n=kCe(o,l,a),s.push(n);r=Ho(),r.prec=i,s.push(r),t.push(Un),n=K4(),s.push(n)}for(u=s.length-1,n=s[u],t.pop();u>1;)t.pop(),n=kCe(s[u-1].value,s[u-2],n),u-=2;return n}function wb(){var e,t,n;return e=fNn(),gr("?")&&(Ho(),t=wb(),Ea(":"),n=wb(),e=ZDn(e,t,n)),e}function rfe(){const e=wb();if(gr(","))throw new Error(ND);return e}function hNn(e){Xe=e,xe=0,ka=Xe.length,Un=null,Tqe();const t=rfe();if(Un.type!==uF)throw new Error("Unexpect token after expression.");return t}var dNn={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function pNn(e){function t(a,o,l,u){let c=e(o[0]);return l&&(c=l+"("+c+")",l.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(u<0?"":u===0?"()":"("+o.slice(1).map(e).join(",")+")")}function n(a,o,l){return u=>t(a,u,o,l)}const r="new Date",i="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&Rc("Missing arguments to clamp function."),a.length>3&&Rc("Too many arguments to clamp function.");const o=a.map(e);return"Math.max("+o[1]+", Math.min("+o[2]+","+o[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:s,test:n("test",s),if:function(a){a.length<3&&Rc("Missing arguments to if function."),a.length>3&&Rc("Too many arguments to if function.");const o=a.map(e);return"("+o[0]+"?"+o[1]+":"+o[2]+")"}}}function gNn(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function mNn(e){e=e||{};const t=e.allowed?_Ce(e.allowed):{},n=e.forbidden?_Ce(e.forbidden):{},r=e.constants||dNn,i=(e.functions||pNn)(f),s=e.globalvar,a=e.fieldvar,o=CCe(s)?s:p=>"".concat(s,'["').concat(p,'"]');let l={},u={},c=0;function f(p){if(rDn(p))return p;const g=h[p.type];return g==null&&Rc("Unsupported type: "+p.type),g(p)}const h={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:IR(n,g)?Rc("Illegal identifier: "+g):IR(r,g)?r[g]:IR(t,g)?g:(l[g]=1,o(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const v=f(p.property);return m===a&&(u[gNn(v)]=1),g&&(c-=1),m+(g?"."+v:"["+v+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&Rc("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,v=IR(i,g)&&i[g];return v||Rc("Unrecognized function: "+g),CCe(v)?v(m):v+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function d(p){const g={code:f(p),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},g}return d.functions=i,d.constants=r,d}const vNn="view",y8="[",b8="]",Dqe="{",Nqe="}",yNn=":",Iqe=",",bNn="@",xNn=">",wNn=/[[\]{}]/,$Nn={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Mqe,Fqe;function Ox(e,t,n){return Mqe=t||vNn,Fqe=n||$Nn,Oqe(e.trim()).map(bJ)}function CNn(e){return Fqe[e]}function UA(e,t,n,r,i){const s=e.length;let a=0,o;for(;t<s;++t){if(o=e[t],!a&&o===n)return t;i&&i.indexOf(o)>=0?--a:r&&r.indexOf(o)>=0&&++a}return t}function Oqe(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=UA(e,i,Iqe,y8+Dqe,b8+Nqe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function bJ(e){return e[0]==="["?_Nn(e):SNn(e)}function _Nn(e){const t=e.length;let n=1,r;if(n=UA(e,n,b8,y8,b8),n===t)throw"Empty between selector: "+e;if(r=Oqe(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==xNn)throw"Expected '>' after between selector: "+e;r=r.map(bJ);const i=bJ(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function SNn(e){const t={source:Mqe},n=[];let r=[0,0],i=0,s=0,a=e.length,o=0,l,u;if(e[a-1]===Nqe){if(o=e.lastIndexOf(Dqe),o>=0){try{r=kNn(e.substring(o+1,a-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,o).trim(),a=e.length}else throw"Unmatched right brace: "+e;o=0}if(!a)throw e;if(e[0]===bNn&&(i=++o),l=UA(e,o,yNn),l<a&&(n.push(e.substring(s,l).trim()),s=o=++l),o=UA(e,o,y8),o===a)n.push(e.substring(s,a).trim());else if(n.push(e.substring(s,o).trim()),u=[],s=++o,s===a)throw"Unmatched left bracket: "+e;for(;o<a;){if(o=UA(e,o,b8),o===a)throw"Unmatched left bracket: "+e;if(u.push(e.substring(s,o).trim()),o<a-1&&e[++o]!==y8)throw"Expected left bracket: "+e;s=++o}if(!(a=n.length)||wNn.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],i?t.markname=n[0].slice(1):CNn(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),u!=null&&(t.filter=u),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function kNn(e){const t=e.split(Iqe);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}var ENn="vega",ANn="5.20.0",TNn="The Vega visualization grammar.",DNn=["vega","visualization","interaction","dataflow","library","data","d3"],NNn="BSD-3-Clause",INn="UW Interactive Data Lab (http://idl.cs.washington.edu)",MNn="build/vega-node.js",FNn="build/vega.module.js",ONn="build/vega.min.js",RNn="build/vega.min.js",PNn="index.d.ts",LNn="vega/vega",BNn={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},zNn={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.3","vega-encode":"~4.8.3","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.0","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.0.0","vega-loader":"~4.4.0","vega-parser":"~6.1.3","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.9","vega-time":"~2.0.4","vega-transforms":"~4.9.3","vega-typings":"~0.20.0","vega-util":"~1.16.1","vega-view":"~5.10.0","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},UNn={"vega-schema":"*"},WNn="f262105e75449760b0f35fda70e6b576a31d68a4",VNn={name:ENn,version:ANn,description:TNn,keywords:DNn,license:NNn,author:INn,main:MNn,module:FNn,unpkg:ONn,jsdelivr:RNn,types:PNn,repository:LNn,scripts:BNn,dependencies:zNn,devDependencies:UNn,gitHead:WNn};Ire(Qw,yUt,aXt,wKt,IJt,ken,enn,Ttn,nnn,bnn,Tnn,Rnn);const jNn=VNn.version,HNn=Object.freeze(Object.defineProperty({__proto__:null,version:jNn,Dataflow:Q2,EventStream:a9,MultiPulse:Xre,Operator:er,Parameters:s9,Pulse:x0,Transform:me,changeset:sx,definition:cRe,ingest:Tn,isTuple:U_,transform:fRe,transforms:Qw,tupleid:nt,interpolate:CUe,interpolateColors:$Ue,interpolateRange:jgn,quantizeInterpolator:Hgn,scale:rr,scheme:kUe,projection:AUe,View:PWe,defaultLocale:QWe,formatLocale:B6,locale:ibn,resetDefaultLocale:sbn,timeFormatLocale:z6,expressionFunction:wi,parse:K3n,runtimeContext:_We,codegenExpression:mNn,parseExpression:hNn,parseSelector:Ox,Debug:UFe,Error:LFe,Info:zFe,None:PFe,Warn:BFe,accessor:lg,accessorFields:OFe,accessorName:PLt,array:RT,ascending:Nre,clampRange:r6t,compare:s6t,constant:u6t,debounce:c6t,error:o4,extend:Ire,extent:f6t,extentIndex:h6t,falsy:jLt,fastmap:p6t,field:Ere,flush:g6t,hasOwnProperty:o1,id:zLt,identity:Are,inherits:m6t,inrange:v6t,isArray:G7,isBoolean:qFe,isDate:GFe,isFunction:Z7,isIterable:y6t,isNumber:YFe,isObject:tP,isRegExp:b6t,isString:PT,key:x6t,lerp:w6t,logger:HLt,lruCache:C6t,merge:_6t,mergeConfig:Tre,one:WLt,pad:S6t,panLinear:GLt,panLog:YLt,panPow:XLt,panSymlog:KLt,peek:z_,quarter:t6t,repeat:cE,span:k6t,splitAccessPath:kre,stringValue:XFe,toBoolean:E6t,toDate:T6t,toNumber:Dre,toSet:N6t,toString:D6t,truncate:I6t,truthy:VLt,utcquarter:n6t,visitArray:M6t,writeConfig:Y7,zero:ULt,zoomLinear:ZLt,zoomLog:QLt,zoomPow:JLt,zoomSymlog:e6t,bandwidthNRD:rBe,bin:Pnn,bootstrapCI:Bnn,cumulativeLogNormal:uBe,cumulativeNormal:Hae,cumulativeUniform:dBe,densityLogNormal:lBe,densityNormal:sBe,densityUniform:hBe,dotbin:znn,quantileLogNormal:cBe,quantileNormal:qae,quantileUniform:pBe,quantiles:tBe,quartiles:nBe,get random(){return Hp},randomInteger:Vnn,randomKDE:qnn,randomLCG:Wnn,randomLogNormal:Gnn,randomMixture:Ynn,randomNormal:aBe,randomUniform:Xnn,regressionExp:Znn,regressionLinear:gBe,regressionLoess:nrn,regressionLog:Knn,regressionPoly:Jnn,regressionPow:Qnn,regressionQuad:mBe,sampleCurve:orn,sampleLogNormal:oBe,sampleNormal:jae,sampleUniform:fBe,setRandom:Lnn,DATE:Vu,DAY:io,DAYOFYEAR:zh,HOURS:rf,MILLISECONDS:Wh,MINUTES:sf,MONTH:el,QUARTER:Wu,SECONDS:Uh,TIME_UNITS:ABe,WEEK:Rs,YEAR:fo,dayofyear:Brn,timeBin:oin,timeFloor:Yrn,timeInterval:noe,timeOffset:ein,timeSequence:nin,timeUnitSpecifier:Lrn,timeUnits:TBe,utcFloor:Zrn,utcInterval:roe,utcOffset:tin,utcSequence:rin,utcdayofyear:Wrn,utcweek:Vrn,week:zrn,format:S4,formats:goe,inferType:lze,inferTypes:uze,loader:Ean,read:San,responseType:_an,typeParsers:RZ,Bounds:fl,CanvasHandler:ble,CanvasRenderer:m6,Gradient:efn,GroupItem:tle,Handler:mm,Item:ele,Marks:of,RenderType:$dn,Renderer:hd,ResourceLoader:nle,SVGHandler:xle,SVGRenderer:kle,SVGStringRenderer:Ele,Scenegraph:h9e,boundClip:kdn,boundContext:RM,boundItem:iQ,boundMark:l9e,boundStroke:bx,domChild:Vo,domClear:Dc,domCreate:o0,domFind:vle,font:$U,fontFamily:BM,fontSize:fd,intersect:_dn,intersectBoxLine:L2,intersectPath:rle,intersectPoint:ile,intersectRule:Z7e,lineHeight:pm,markup:Sle,multiLineOffset:Fhn,pathCurves:Zoe,pathEqual:P9e,pathParse:V3,pathRectangle:q7e,pathRender:l6,pathSymbols:H7e,pathTrail:G7e,point:yle,renderModule:Cdn,resetSVGClipId:X7e,resetSVGDefIds:Tdn,sceneEqual:Ale,sceneFromJSON:c9e,scenePickVisit:c6,sceneToJSON:u9e,sceneVisit:af,sceneZOrder:sle,serializeXML:k9e,textMetrics:cw},Symbol.toStringTag,{value:"Module"})),qNn="vega-lite",GNn='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',YNn="4.13.1",XNn=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],KNn="https://vega.github.io/vega-lite/",ZNn="Vega-Lite is a concise high-level language for interactive visualization.",QNn="build/vega-lite.js",JNn="build/vega-lite.min.js",eIn="build/vega-lite.min.js",tIn="build/src/index",nIn="build/src/index.d.ts",rIn={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},iIn={test:"test"},sIn={changelog:"conventional-changelog -p angular -r 2",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"},aIn={type:"git",url:"https://github.com/vega/vega-lite.git"},oIn="BSD-3-Clause",lIn={url:"https://github.com/vega/vega-lite/issues"},uIn={"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2",ajv:"^6.12.2",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.7.0",concurrently:"^5.2.0","conventional-changelog-cli":"^2.0.34",d3:"^5.16.0",eslint:"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3",jest:"^26.0.1","jest-puppeteer":"^4.4.0",mkdirp:"^1.0.4",prettier:"^2.0.5",puppeteer:"^3.1.0",rollup:"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7",terser:"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1",typescript:"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},cIn={"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0",yargs:"~15.3.1"},fIn={vega:"^5.12.1"},hIn={preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1},dIn={name:qNn,author:GNn,version:YNn,collaborators:XNn,homepage:KNn,description:ZNn,main:QNn,unpkg:JNn,jsdelivr:eIn,module:tIn,types:nIn,bin:rIn,directories:iIn,scripts:sIn,repository:aIn,license:oIn,bugs:lIn,devDependencies:uIn,dependencies:cIn,peerDependencies:fIn,jest:hIn};function _S(e,t,n){return e.fields=t||[],e.fname=n,e}function pIn(e){return e.length===1?gIn(e[0]):mIn(e)}const gIn=e=>function(t){return t[e]},mIn=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function CG(e){throw Error(e)}function Rx(e){var t=[],n=null,r=0,i=e.length,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<i;++o)if(l=e[o],l==="\\")s+=e.substring(a,o),s+=e.substring(++o,++o),a=o;else if(l===n)u(),n=null,r=-1;else{if(n)continue;a===r&&l==='"'||a===r&&l==="'"?(a=o+1,n=l):l==="."&&!r?o>a?u():a=o+1:l==="["?(o>a&&u(),r=a=o+1):l==="]"&&(r||CG("Access path missing open bracket: "+e),r>0&&u(),r=0,a=o+1)}return r&&CG("Access path missing closing bracket: "+e),n&&CG("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function vIn(e,t,n){const r=Rx(e);return e=r.length===1?r[0]:e,_S((n&&n.get||pIn)(r),[e],t||e)}var hF=[];vIn("id");var yIn=_S(function(e){return e},hF,"identity");_S(function(){return 0},hF,"zero");_S(function(){return 1},hF,"one");_S(function(){return!0},hF,"true");_S(function(){return!1},hF,"false");function MR(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var bIn=0,xIn=1,Rqe=2,wIn=3,$In=4;function CIn(e,t){var n=e||bIn;return{level:function(r){return arguments.length?(n=+r,this):n},error:function(){return n>=xIn&&MR(t||"error","ERROR",arguments),this},warn:function(){return n>=Rqe&&MR(t||"warn","WARN",arguments),this},info:function(){return n>=wIn&&MR(t||"log","INFO",arguments),this},debug:function(){return n>=$In&&MR(t||"log","DEBUG",arguments),this}}}const ut=Array.isArray;function ds(e){return e===Object(e)}const ICe=e=>e!=="__proto__";function Pqe(...e){return e.reduce((t,n)=>{for(var r in n)if(r==="signals")t.signals=_In(t.signals,n.signals);else{var i=r==="legend"?{layout:1}:r==="style"?!0:null;ife(t,r,n[r],i)}return t},{})}function ife(e,t,n,r){if(!!ICe(t)){var i,s;if(ds(n)&&!ut(n)){s=ds(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?ife(s,i,n[i]):ICe(i)&&(s[i]=n[i])}else e[t]=n}}function _In(e,t){if(e==null)return t;const n={},r=[];function i(s){n[s.name]||(n[s.name]=1,r.push(s))}return t.forEach(i),e.forEach(i),r}function ci(e){return e!=null?ut(e)?e:[e]:[]}function SIn(e){return typeof e=="function"}const kIn=Object.prototype.hasOwnProperty;function H1(e,t){return kIn.call(e,t)}function dF(e){return typeof e=="boolean"}function yi(e){return typeof e=="number"}function qt(e){return typeof e=="string"}function on(e){return ut(e)?"["+e.map(on)+"]":ds(e)||qt(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Px(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function it(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var Lqe={exports:{}};(function(e){var t=function(){function n(h,d){return d!=null&&h instanceof d}var r;try{r=Map}catch{r=function(){}}var i;try{i=Set}catch{i=function(){}}var s;try{s=Promise}catch{s=function(){}}function a(h,d,p,g,m){typeof d=="object"&&(p=d.depth,g=d.prototype,m=d.includeNonEnumerable,d=d.circular);var v=[],y=[],b=typeof Buffer<"u";typeof d>"u"&&(d=!0),typeof p>"u"&&(p=1/0);function x(w,C){if(w===null)return null;if(C===0)return w;var $,_;if(typeof w!="object")return w;if(n(w,r))$=new r;else if(n(w,i))$=new i;else if(n(w,s))$=new s(function(F,R){w.then(function(P){F(x(P,C-1))},function(P){R(x(P,C-1))})});else if(a.__isArray(w))$=[];else if(a.__isRegExp(w))$=new RegExp(w.source,f(w)),w.lastIndex&&($.lastIndex=w.lastIndex);else if(a.__isDate(w))$=new Date(w.getTime());else{if(b&&Buffer.isBuffer(w))return Buffer.allocUnsafe?$=Buffer.allocUnsafe(w.length):$=new Buffer(w.length),w.copy($),$;n(w,Error)?$=Object.create(w):typeof g>"u"?(_=Object.getPrototypeOf(w),$=Object.create(_)):($=Object.create(g),_=g)}if(d){var k=v.indexOf(w);if(k!=-1)return y[k];v.push(w),y.push($)}n(w,r)&&w.forEach(function(F,R){var P=x(R,C-1),V=x(F,C-1);$.set(P,V)}),n(w,i)&&w.forEach(function(F){var R=x(F,C-1);$.add(R)});for(var E in w){var S;_&&(S=Object.getOwnPropertyDescriptor(_,E)),!(S&&S.set==null)&&($[E]=x(w[E],C-1))}if(Object.getOwnPropertySymbols)for(var N=Object.getOwnPropertySymbols(w),E=0;E<N.length;E++){var A=N[E],D=Object.getOwnPropertyDescriptor(w,A);D&&!D.enumerable&&!m||($[A]=x(w[A],C-1),D.enumerable||Object.defineProperty($,A,{enumerable:!1}))}if(m)for(var T=Object.getOwnPropertyNames(w),E=0;E<T.length;E++){var I=T[E],D=Object.getOwnPropertyDescriptor(w,I);D&&D.enumerable||($[I]=x(w[I],C-1),Object.defineProperty($,I,{enumerable:!1}))}return $}return x(h,p)}a.clonePrototype=function(d){if(d===null)return null;var p=function(){};return p.prototype=d,new p};function o(h){return Object.prototype.toString.call(h)}a.__objToStr=o;function l(h){return typeof h=="object"&&o(h)==="[object Date]"}a.__isDate=l;function u(h){return typeof h=="object"&&o(h)==="[object Array]"}a.__isArray=u;function c(h){return typeof h=="object"&&o(h)==="[object RegExp]"}a.__isRegExp=c;function f(h){var d="";return h.global&&(d+="g"),h.ignoreCase&&(d+="i"),h.multiline&&(d+="m"),d}return a.__getRegExpFlags=f,a}();e.exports&&(e.exports=t)})(Lqe);const EIn=Lqe.exports;var AIn=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(s=Object.keys(t),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var a=s[i];if(!e(t[a],n[a]))return!1}return!0}return t!==t&&n!==n},MD=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(s){return function(a){return function(o,l){var u={key:o,value:a[o]},c={key:l,value:a[l]};return s(u,c)}}}(t.cmp),i=[];return function s(a){if(a&&a.toJSON&&typeof a.toJSON=="function"&&(a=a.toJSON()),a!==void 0){if(typeof a=="number")return isFinite(a)?""+a:"null";if(typeof a!="object")return JSON.stringify(a);var o,l;if(Array.isArray(a)){for(l="[",o=0;o<a.length;o++)o&&(l+=","),l+=s(a[o])||"null";return l+"]"}if(a===null)return"null";if(i.indexOf(a)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=i.push(a)-1,c=Object.keys(a).sort(r&&r(a));for(l="",o=0;o<c.length;o++){var f=c[o],h=s(a[f]);!h||(l&&(l+=","),l+=JSON.stringify(f)+":"+h)}return i.splice(u,1),"{"+l+"}"}}(e)};function sfe(e){return!!e.or}function afe(e){return!!e.and}function ofe(e){return!!e.not}function Z4(e,t){if(ofe(e))Z4(e.not,t);else if(afe(e))for(const n of e.and)Z4(n,t);else if(sfe(e))for(const n of e.or)Z4(n,t);else t(e)}function Q4(e,t){return ofe(e)?{not:Q4(e.not,t)}:afe(e)?{and:e.and.map(n=>Q4(n,t))}:sfe(e)?{or:e.or.map(n=>Q4(n,t))}:t(e)}const pF=AIn,Gt=EIn;function FD(e,t){const n={};for(const r of t)H1(e,r)&&(n[r]=e[r]);return n}function $p(e,t){const n=Object.assign({},e);for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>MD(e)).join(",")})`};const Ar=MD;function gn(e){if(yi(e))return e;const t=qt(e)?e:MD(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function MCe(e){return e===!1||e===null}function ht(e,t){return e.indexOf(t)>-1}function OD(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function Bqe(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function TIn(e,...t){for(const n of t)DIn(e,n!=null?n:{});return e}function DIn(e,t){for(const n of Ie(t))ife(e,n,t[n],!0)}function f0(e,t){const n=[],r={};let i;for(const s of e)i=t(s),!(i in r)&&(r[i]=1,n.push(s));return n}function NIn(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function zqe(e,t){for(const n of e)if(t.has(n))return!0;return!1}function FCe(e){const t=new Set;for(const n of e){const i=Rx(n).map((a,o)=>o===0?a:`[${a}]`),s=i.map((a,o)=>i.slice(0,o+1).join(""));for(const a of s)t.add(a)}return t}function Uqe(e,t){return e===void 0||t===void 0?!0:zqe(FCe(e),FCe(t))}function tr(e){return Ie(e).length===0}const Ie=Object.keys,D0=Object.values;function Wqe(e){const t=[];for(const n in e)H1(e,n)&&t.push({key:n,value:e[n]});return t}function x8(e){return e===!0||e===!1}function Dr(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function WA(e,t){return ofe(e)?"!("+WA(e.not,t)+")":afe(e)?"("+e.and.map(n=>WA(n,t)).join(") && (")+")":sfe(e)?"("+e.or.map(n=>WA(n,t)).join(") || (")+")":t(e)}function xJ(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&xJ(e[n],t)&&delete e[n],tr(e)}function DW(e){return e.charAt(0).toUpperCase()+e.substr(1)}function Vqe(e,t="datum"){const n=Rx(e),r=[];for(let i=1;i<=n.length;i++){const s=`[${n.slice(0,i).map(on).join("][")}]`;r.push(`${t}${s}`)}return r.join(" && ")}function IIn(e,t="datum"){return`${t}[${on(Rx(e).join("."))}]`}function MIn(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Am(e){return`${Rx(e).map(MIn).join("\\.")}`}function K$(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function jqe(e){return`${Rx(e).join(".")}`}function RD(e){return e?Rx(e).length:0}function bi(...e){for(const t of e)if(t!==void 0)return t}let FIn=42;function OIn(e){const t=++FIn;return e?String(e)+t:t}function RIn(e){return PIn(e)?e:`__${e}`}function PIn(e){return e.indexOf("__")===0}function w8(e){if(e!==void 0)return(e%360+360)%360}function lfe(e){return yi(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const OCe={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function ufe(e){return e&&e.condition}const Hqe=["domain","grid","labels","ticks","title"],LIn={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},qqe={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},BIn=Object.assign(Object.assign({},qqe),{style:1,labelExpr:1,encoding:1});function RCe(e){return!!BIn[e]}const To={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},Gqe=To.arc,NW=To.area,IW=To.bar,zIn=To.image,MW=To.line,FW=To.point,UIn=To.rect,$8=To.rule,Yqe=To.text,cfe=To.tick,WIn=To.trail,ffe=To.circle,hfe=To.square,Xqe=To.geoshape;function Lx(e){return ht(["line","area","trail"],e)}function PCe(e){return ht(["rect","bar","image","arc"],e)}const Kqe=Ie(To);function Kh(e){return e.type}Px(Kqe);const VIn=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],jIn=["fill","fillOpacity"],HIn=[...VIn,...jIn],qIn={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1},LCe=Ie(qIn),GIn={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},YIn={color:"#4c78a8",invalid:"filter",timeUnitBand:1},XIn={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Zqe=5,KIn={binSpacing:1,continuousBandSize:Zqe,timeUnitBandPosition:.5},ZIn={binSpacing:0,continuousBandSize:Zqe,timeUnitBandPosition:.5},QIn={thickness:1};function JIn(e){return Kh(e)?e.type:e}function vg(e){return"mark"in e}class OW{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return vg(t)?JIn(t.mark)===this.name:!1}}const eMn={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},tMn={count:1,min:1,max:1};function Tm(e){return!!e&&!!e.argmin}function Bx(e){return!!e&&!!e.argmax}function dfe(e){return qt(e)&&!!eMn[e]}const nMn=["count","valid","missing","distinct"];function Qqe(e){return qt(e)&&ht(nMn,e)}function rMn(e){return qt(e)&&ht(["min","max"],e)}const iMn=["count","sum","distinct","valid","missing"],sMn=["mean","average","median","q1","q3","min","max"],aMn=Px(sMn),Cp="row",_p="column",RW="facet",Ur="x",Ii="y",$f="x2",yd="y2",bd="radius",yg="radius2",Cf="theta",bg="theta2",xd="latitude",wd="longitude",_f="latitude2",ju="longitude2",hl="color",$d="fill",Cd="stroke",dl="shape",xg="size",zx="angle",wg="opacity",dv="fillOpacity",pv="strokeOpacity",gv="strokeWidth",mv="strokeDash",gF="text",mF="order",vF="detail",PW="key",$b="tooltip",LW="href",BW="url",zW="description",oMn={x:1,y:1,x2:1,y2:1},Jqe={theta:1,theta2:1,radius:1,radius2:1};function eGe(e){return e in Jqe}const pfe={longitude:1,longitude2:1,latitude:1,latitude2:1};function lMn(e){switch(e){case xd:return"y";case _f:return"y2";case wd:return"x";case ju:return"x2"}}function uMn(e){return e in pfe}const cMn=Ie(pfe),tGe=Object.assign(Object.assign(Object.assign(Object.assign({},oMn),Jqe),pfe),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function vw(e){return e===hl||e===$d||e===Cd}const nGe={row:1,column:1,facet:1},Au=Ie(nGe),gfe=Object.assign(Object.assign({},tGe),nGe),rGe=Ie(gfe),fMn=it(gfe,["order","detail","tooltip"]),hMn=it(fMn,["row","column","facet"]);function dMn(e){return!!hMn[e]}function iGe(e){return!!gfe[e]}const pMn=[$f,yd,_f,ju,bg,yg];function sGe(e){return Ux(e)!==e}function Ux(e){switch(e){case $f:return Ur;case yd:return Ii;case _f:return xd;case ju:return wd;case bg:return Cf;case yg:return bd}return e}function Dm(e){if(eGe(e))switch(e){case Cf:return"startAngle";case bg:return"endAngle";case bd:return"outerRadius";case yg:return"innerRadius"}return e}function _d(e){switch(e){case Ur:return $f;case Ii:return yd;case xd:return _f;case wd:return ju;case Cf:return bg;case bd:return yg}}function Sd(e){switch(e){case Ur:case $f:return"width";case Ii:case yd:return"height"}}function gMn(e){switch(e){case Ur:return"xOffset";case Ii:return"yOffset";case $f:return"x2Offset";case yd:return"y2Offset";case Cf:return"thetaOffset";case bd:return"radiusOffset";case bg:return"theta2Offset";case yg:return"radius2Offset"}}const mfe=it(tGe,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),mMn=Ie(mfe),vv={x:1,y:1},Hu=Ie(vv);function Zh(e){return e in vv}const vfe={theta:1,radius:1},vMn=Ie(vfe);function UW(e){return e==="width"?Ur:Ii}const aGe=it(mfe,["text","tooltip","href","url","description","detail","key","order"]),yMn=Ie(aGe);function bMn(e){return!!mfe[e]}function xMn(e){switch(e){case hl:case $d:case Cd:case xg:case dl:case wg:case gv:case mv:return!0;case dv:case pv:case zx:return!1}}const oGe=Object.assign(Object.assign(Object.assign({},vv),vfe),aGe),WW=Ie(oGe);function yv(e){return!!oGe[e]}function wMn(e,t){return CMn(e)[t]}const lGe={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},$Mn=it(lGe,["geoshape"]);function CMn(e){switch(e){case hl:case $d:case Cd:case zW:case vF:case PW:case $b:case LW:case mF:case wg:case dv:case pv:case gv:case RW:case Cp:case _p:return lGe;case Ur:case Ii:case xd:case wd:return $Mn;case $f:case yd:case _f:case ju:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case xg:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case mv:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case dl:return{point:"always",geoshape:"always"};case gF:return{text:"always"};case zx:return{point:"always",square:"always",text:"always"};case BW:return{image:"always"};case Cf:return{text:"always",arc:"always"};case bd:return{text:"always",arc:"always"};case bg:case yg:return{arc:"always"}}}function J4(e){switch(e){case Ur:case Ii:case Cf:case bd:case xg:case zx:case gv:case wg:case dv:case pv:case $f:case yd:case bg:case yg:return;case RW:case Cp:case _p:case dl:case mv:case gF:case $b:case LW:case BW:case zW:return"discrete";case hl:case $d:case Cd:return"flexible";case xd:case wd:case _f:case ju:case vF:case PW:case mF:return}}function uGe(e){return dF(e)&&(e=XW(e,void 0)),"bin"+Ie(e).map(t=>VW(e[t])?Dr(`_${t}_${Object.entries(e[t])}`):Dr(`_${t}_${e[t]}`)).join("")}function hr(e){return e===!0||yF(e)&&!e.binned}function to(e){return e==="binned"||yF(e)&&e.binned===!0}function yF(e){return ds(e)}function VW(e){return e==null?void 0:e.selection}function BCe(e){switch(e){case Cp:case _p:case xg:case hl:case $d:case Cd:case gv:case wg:case dv:case pv:case dl:return 6;case mv:return 4;default:return 10}}function yfe(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const _Mn='Autosize "fit" only works for single views and layered views.';function zCe(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function UCe(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function WCe(e){return e?`Dropping "fit-${e}" because spec has discrete ${Sd(e)}.`:'Dropping "fit" because spec has discrete size.'}function VCe(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function SMn(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function kMn(e){return`The "nearest" transform is not supported for ${e} marks.`}function cGe(e){return`Selection not supported for ${e} yet.`}function EMn(e){return`Cannot find a selection named "${e}".`}const AMn="Scale bindings are currently only supported for scales with unbinned, continuous domains.",TMn="Legend bindings are only supported for selections over an individual field or encoding channel.";function DMn(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}function NMn(e){return`Unknown repeated value "${e}".`}function jCe(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const IMn="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function MMn(e){return`Unrecognized parse "${e}".`}function HCe(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function FMn(e){return`Ignoring an invalid transform: ${Ar(e)}.`}const OMn='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function qCe(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function RMn(e){return`Layer's shared ${e.join(",")} channel ${e.length===1?"is":"are"} overriden.`}function PMn(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Ar(t)} is overridden by a child projection ${Ar(n)}.`}const LMn="Arc marks uses theta channel rather than angle, replacing angle with theta.";function BMn(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Ar(n)}}.`}function fGe(e){return`Invalid field type "${e}".`}function zMn(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function UMn(e){return`Invalid aggregation operator "${e}".`}function WMn(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function hGe(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function wJ(e,t){return`Dropping ${Ar(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const VMn="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function jW(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function jMn(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function HMn(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function qMn(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function _G(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function GMn(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function YMn(e,t){return`Specified orient "${e}" overridden with "${t}".`}const XMn=`Scale's "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.`;function KMn(e){return`Cannot use the scale property "${e}" with non-color channel.`}function ZMn(e){return`Using unaggregated domain with raw field has no effect (${Ar(e)}).`}function QMn(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function JMn(e){return`Unaggregated domain is currently unsupported for log scale (${Ar(e)}).`}function eFn(e){return`Cannot apply size to non-oriented mark "${e}".`}function tFn(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function nFn(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function dGe(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function pGe(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function rFn(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ar(n)} and ${Ar(r)}). Using ${Ar(n)}.`}function iFn(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ar(n)} and ${Ar(r)}). Using the union of the two domains.`}function sFn(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function aFn(e){return`Dropping sort property ${Ar(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const GCe="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",oFn="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",lFn="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",uFn="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function cFn(e){return`Cannot stack "${e}" if there is already "${e}2".`}function fFn(e){return`Cannot stack non-linear scale (${e}).`}function hFn(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function C8(e,t){return`Invalid ${e}: ${Ar(t)}.`}function dFn(e){return`Dropping day from datetime ${Ar(e)} as day cannot be combined with other units.`}function pFn(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function gFn(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function mFn(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function vFn(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}function YCe(e){return`1D error band does not support ${e}.`}function gGe(e){return`Channel ${e} is required for "binned" bin.`}function yFn(e){return`Domain for ${e} is required for threshold scale.`}const mGe=CIn(Rqe);let Z$=mGe;function bFn(e){return Z$=e,Z$}function xFn(){return Z$=mGe,Z$}function Te(...e){Z$.warn(...e)}function wFn(...e){Z$.debug(...e)}function SS(e){if(e&&ds(e)){for(const t of xfe)if(t in e)return!0}return!1}const vGe=["january","february","march","april","may","june","july","august","september","october","november","december"],$Fn=vGe.map(e=>e.substr(0,3)),yGe=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],CFn=yGe.map(e=>e.substr(0,3));function _Fn(e){if(lfe(e)&&(e=+e),yi(e))return e>4&&Te(C8("quarter",e)),e-1;throw new Error(C8("quarter",e))}function SFn(e){if(lfe(e)&&(e=+e),yi(e))return e-1;{const t=e.toLowerCase(),n=vGe.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=$Fn.indexOf(r);if(i!==-1)return i;throw new Error(C8("month",e))}}function kFn(e){if(lfe(e)&&(e=+e),yi(e))return e%7;{const t=e.toLowerCase(),n=yGe.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=CFn.indexOf(r);if(i!==-1)return i;throw new Error(C8("day",e))}}function bfe(e,t){const n=[];if(t&&e.day!==void 0&&Ie(e).length>1&&(Te(dFn(e)),e=Gt(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?SFn(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?_Fn(e.quarter):e.quarter;n.push(yi(r)?r*3:r+"*3")}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?kFn(e.day):e.day;n.push(yi(r)?r+1:r+"+1")}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i>"u"?0:i)}return n}function PD(e){const n=bfe(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function EFn(e){const n=bfe(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function AFn(e){const t=bfe(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const bGe={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},xfe=Ie(bGe);function TFn(e){return!!bGe[e]}function wfe(e){return e.startsWith("utc")}function DFn(e){return e.substr(3)}const NFn={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function $fe(e){const t=[];for(const n of xfe)xGe(e,n)&&t.push(n);return t}function xGe(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function IFn(e,t,{end:n}={end:!1}){const r=Vqe(t),i=wfe(e)?"utc":"";function s(l){return l==="quarter"?`(${i}quarter(${r})-1)`:`${i}${l}(${r})`}let a;const o={};for(const l of xfe)xGe(e,l)&&(o[l]=s(l),a=l);return n&&(o[a]+="+1"),EFn(o)}function wGe(e){if(!e)return;const t=$fe(e);return`timeUnitSpecifier(${MD(t)}, ${MD(NFn)})`}function MFn(e,t,n){if(!e)return;const r=wGe(e);return`${n||wfe(e)?"utc":"time"}Format(${t}, ${r})`}function Co(e){if(!e)return;let t;return qt(e)?t={unit:e}:ds(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),wfe(t.unit)&&(t.utc=!0,t.unit=DFn(t.unit)),t}function FFn(e){const t=Co(e),{utc:n}=t,r=it(t,["utc"]);return r.unit?(n?"utc":"")+Ie(r).map(i=>Dr(`${i==="unit"?"":`_${i}_`}${r[i]}`)).join(""):(n?"utc":"")+"timeunit"+Ie(r).map(i=>Dr(`_${i}_${r[i]}`)).join("")}function wt(e){return e&&!!e.signal}function bv(e){return!!e.step}function OFn(e){return ut(e)?!1:"fields"in e&&!("data"in e)}function RFn(e){return ut(e)?!1:"fields"in e&&"data"in e}function h0(e){return ut(e)?!1:"field"in e&&"data"in e}const PFn={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1},LFn=Ie(PFn),BFn={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},SG=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function zFn(e){return e==null?void 0:e.selection}function Cfe(e){return e&&!!e.field&&e.equal!==void 0}function $Ge(e){return e&&!!e.field&&e.lt!==void 0}function CGe(e){return e&&!!e.field&&e.lte!==void 0}function _Ge(e){return e&&!!e.field&&e.gt!==void 0}function SGe(e){return e&&!!e.field&&e.gte!==void 0}function _fe(e){if(e&&e.field){if(ut(e.range)&&e.range.length===2)return!0;if(wt(e.range))return!0}return!1}function Sfe(e){return e&&!!e.field&&(ut(e.oneOf)||ut(e.in))}function UFn(e){return e&&!!e.field&&e.valid!==void 0}function kGe(e){return Sfe(e)||Cfe(e)||_fe(e)||$Ge(e)||_Ge(e)||CGe(e)||SGe(e)}function Mf(e,t){return zfe(e,{timeUnit:t,wrapTime:!0})}function WFn(e,t){return e.map(n=>Mf(n,t))}function EGe(e,t=!0){var n;const{field:r}=e,i=(n=Co(e.timeUnit))===null||n===void 0?void 0:n.unit,s=i?"time("+IFn(i,r)+")":Me(e,{expr:"datum"});if(Cfe(e))return s+"==="+Mf(e.equal,i);if($Ge(e)){const a=e.lt;return`${s}<${Mf(a,i)}`}else if(_Ge(e)){const a=e.gt;return`${s}>${Mf(a,i)}`}else if(CGe(e)){const a=e.lte;return`${s}<=${Mf(a,i)}`}else if(SGe(e)){const a=e.gte;return`${s}>=${Mf(a,i)}`}else{if(Sfe(e))return`indexof([${WFn(e.oneOf,i).join(",")}], ${s}) !== -1`;if(UFn(e))return kfe(s,e.valid);if(_fe(e)){const{range:a}=e,o=wt(a)?{signal:`${a.signal}[0]`}:a[0],l=wt(a)?{signal:`${a.signal}[1]`}:a[1];if(o!==null&&l!==null&&t)return"inrange("+s+", ["+Mf(o,i)+", "+Mf(l,i)+"])";const u=[];return o!==null&&u.push(`${s} >= ${Mf(o,i)}`),l!==null&&u.push(`${s} <= ${Mf(l,i)}`),u.length>0?u.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function kfe(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function VFn(e){var t;return kGe(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Co(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const kS={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},Cb=kS.quantitative,Efe=kS.ordinal,Q$=kS.temporal,Afe=kS.nominal,ES=kS.geojson,jFn=Ie(kS);function HFn(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Cb:return"quantitative";case"t":case Q$:return"temporal";case"o":case Efe:return"ordinal";case"n":case Afe:return"nominal";case ES:return"geojson"}}const fi={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},$J={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},qFn=Ie($J);function GFn(e,t){const n=$J[e],r=$J[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const YFn={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function XCe(e){return YFn[e]}const AGe=["linear","log","pow","sqrt","symlog","time","utc"],XFn=Px(AGe),KFn=["linear","log","pow","sqrt","symlog"],ZFn=Px(KFn);function QFn(e){return e in ZFn}const JFn=["quantile","quantize","threshold"],eOn=Px(JFn),tOn=AGe.concat(["quantile","quantize","threshold","sequential","identity"]),nOn=Px(tOn),rOn=["ordinal","bin-ordinal","point","band"],iOn=Px(rOn);function pl(e){return e in iOn}function qu(e){return e in nOn}function Pc(e){return e in XFn}function _8(e){return e in eOn}const sOn={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function aOn(e){return!qt(e)&&!!e.name}function TGe(e){return e==null?void 0:e.selection}function oOn(e){return e&&e.unionWith}const lOn={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},uOn=it(lOn,["type","domain","range","scheme"]),cOn=Ie(uOn);fOn();function DGe(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!ht(["point","band","identity"],e);case"bins":return!ht(["point","band","identity","ordinal"],e);case"round":return Pc(e)||e==="band"||e==="point";case"padding":return Pc(e)||ht(["point","band"],e);case"paddingOuter":case"align":return ht(["point","band"],e);case"paddingInner":return e==="band";case"domainMid":case"clamp":return Pc(e);case"nice":return Pc(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return qu(e)&&!ht(["log","time","utc","threshold","quantile"],e)}}function NGe(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return vw(e)?void 0:KMn(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function IGe(e,t){return ht([Efe,Afe],t)?e===void 0||pl(e):t===Q$?ht([fi.TIME,fi.UTC,void 0],e):t===Cb?ht([fi.LOG,fi.POW,fi.SQRT,fi.SYMLOG,fi.QUANTILE,fi.QUANTIZE,fi.THRESHOLD,fi.LINEAR,void 0],e):!0}function MGe(e,t){if(!yv(e))return!1;switch(e){case Ur:case Ii:case Cf:case bd:return Pc(t)||ht(["band","point"],t);case xg:case gv:case wg:case dv:case pv:case zx:return Pc(t)||_8(t)||ht(["band","point","ordinal"],t);case hl:case $d:case Cd:return t!=="band";case mv:return t==="ordinal"||_8(t);case dl:return t==="ordinal"}}function fOn(){var e;const t={};for(const n of rGe)for(const r of jFn)for(const i of qFn){const s=hOn(n,r);MGe(n,i)&&IGe(i,r)&&(t[s]=(e=t[s])!==null&&e!==void 0?e:[],t[s].push(i))}return t}function hOn(e,t){return e+"_"+t}function Tfe(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:s}=e,a=OGe(e);return Le(n)&&!Qqe(n.aggregate)&&i&&Pc(i.get("type"))&&i.get("zero")===!1?FGe({fieldDef:n,channel:t,markDef:r,ref:a,config:s}):a}function FGe({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return Lx(n.type)||Ln("invalid",n,i)===null?r:[dOn(e,t),r]}function dOn(e,t){const n=Dfe(e,!0),i=Ux(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function Dfe(e,t=!0){return kfe(qt(e)?e:Me(e,{expr:"datum"}),!t)}function pOn(e){const{datum:t}=e;return SS(t)?PD(t):`${JSON.stringify(t)}`}function vy(e,t,n,r){const i={};if(t&&(i.scale=t),xv(e)){const{datum:s}=e;SS(s)?i.signal=PD(s):wt(s)?i.signal=s.signal:i.value=s}else i.field=Me(e,n);if(r){const{offset:s,band:a}=r;s&&(i.offset=s),a&&(i.band=a)}return i}function S8({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,band:s=.5}){const a=0<s&&s<1?"datum":void 0,o=Me(t,{expr:a,suffix:i}),l=n!==void 0?Me(n,{expr:a}):Me(t,{suffix:"end",expr:a}),u={};if(s===0||s===1){u.scale=e;const c=s===0?o:l;u.field=c}else{const c=`${s} * ${o} + ${1-s} * ${l}`;u.signal=`scale("${e}", ${c})`}return r&&(u.offset=r),u}function OGe({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:s,scale:a,stack:o,offset:l,defaultRef:u,band:c}){var f;if(t){if(kt(t)){if(Zl(t)){c=c!=null?c:xF({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:o,config:i,isMidPoint:!0});const{bin:d,timeUnit:p,type:g}=t;if(hr(d)||c&&p&&g===Q$)return o&&o.impute?vy(t,s,{binSuffix:"mid"},{offset:l}):c?S8({scaleName:s,fieldOrDatumDef:t,band:c,offset:l}):vy(t,s,wF(t,e)?{binSuffix:"range"}:{},{offset:l});if(to(d)){if(Le(n))return S8({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:c,offset:l});Te(gGe(e===Ur?$f:yd))}}const h=a==null?void 0:a.get("type");return vy(t,s,pl(h)?{binSuffix:"range"}:{},{offset:l,band:h==="band"?(f=c!=null?c:t.band)!==null&&f!==void 0?f:.5:void 0})}else if(Xp(t)){const h=t.value,d=l?{offset:l}:{};return Object.assign(Object.assign({},VA(e,h)),d)}}return SIn(u)&&(u=u()),u&&Object.assign(Object.assign({},u),l?{offset:l}:{})}function VA(e,t){return ht(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:ht(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:ai(t)}function _b(e){return e&&e!=="number"&&e!=="time"}function RGe(e,t,n){return`${e}(${t}${n?`, ${JSON.stringify(n)}`:""})`}const gOn=" \u2013 ";function Nfe({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:s}){var a,o;if(_b(n))return Ife({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:s});const l=PGe(e,r,i);if(KW(e)){const u=vOn(l,Le(e)?(a=Co(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0,t,s.timeFormat,Pfe(e)&&((o=e.scale)===null||o===void 0?void 0:o.type)===fi.UTC);return u?{signal:u}:void 0}if(t=zGe(Wg(e),t,s),Le(e)&&hr(e.bin)){const u=Me(e,{expr:r,binSuffix:"end"});return{signal:HW(l,u,t,n,s)}}else return t||Wg(e)==="quantitative"?{signal:`${UGe(l,t)}`}:{signal:`isValid(${l}) ? ${l} : ""+${l}`}}function PGe(e,t,n){return Le(e)?n?`${Me(e,{expr:t,suffix:"end"})}-${Me(e,{expr:t,suffix:"start"})}`:Me(e,{expr:t}):pOn(e)}function Ife({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:s,field:a}){if(a=a!=null?a:PGe(e,r,i),Le(e)&&hr(e.bin)){const o=Me(e,{expr:r,binSuffix:"end"});return{signal:HW(a,o,t,n,s)}}return{signal:RGe(n,a,t)}}function LGe(e,t,n,r,i,s){var a;if(!_b(r)){if(KW(e)){const o=Le(e)?(a=Co(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0;return mOn(n,o,i,s)}return zGe(t,n,i)}}function BGe(e,t,n){if(e&&(wt(e)||e==="number"||e==="time"))return e;if(KW(t)&&n!=="time"&&n!=="utc")return"time"}function zGe(e,t,n){if(qt(t))return t;if(e===Cb)return n.numberFormat}function mOn(e,t,n,r){return e||(t?{signal:wGe(t)}:r?void 0:n.timeFormat)}function UGe(e,t){return`format(${e}, "${t||""}")`}function KCe(e,t,n,r){var i;return _b(n)?RGe(n,e,t):UGe(e,(i=qt(t)?t:void 0)!==null&&i!==void 0?i:r.numberFormat)}function HW(e,t,n,r,i){const s=KCe(e,n,r,i),a=KCe(t,n,r,i);return`${kfe(e,!1)} ? "null" : ${s} + "${gOn}" + ${a}`}function vOn(e,t,n,r,i){return!t||n?(n=qt(n)?n:r,`${i?"utc":"time"}Format(${e}, '${n}')`):MFn(t,e,i)}const qW="min",yOn={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function ZCe(e){return e in yOn}function WGe(e){return!!e&&!!e.encoding}function wh(e){return!!e&&(e.op==="count"||!!e.field)}function VGe(e){return!!e&&ut(e)}function bF(e){return"row"in e||"column"in e}function Mfe(e){return!!e&&"header"in e}function GW(e){return"facet"in e}function bOn(e){return e.selection}function xOn(e){return e&&!qt(e)&&"repeat"in e}function QCe(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function jGe(e){return Zl(e)&&"sort"in e}function xF({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:i,config:s,isMidPoint:a}){if(kt(t)&&t.band!==void 0)return t.band;if(Le(t)){const{timeUnit:o,bin:l}=t;if(o&&!n)return a?Sb("timeUnitBandPosition",r,s):PCe(r.type)?Sb("timeUnitBand",r,s):0;if(hr(l))return PCe(r.type)&&!a?1:.5}if((i==null?void 0:i.fieldChannel)===e&&a)return .5}function Ffe(e,t,n,r,i,s){return hr(t.bin)||t.timeUnit&&Zl(t)&&t.type==="temporal"?!!xF({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:i,config:s}):!1}function Ofe(e){return!!e&&"condition"in e}function YW(e){const t=e&&e.condition;return!!t&&!ut(t)&&Le(t)}function Rfe(e){const t=e&&e.condition;return!!t&&!ut(t)&&kt(t)}function wOn(e){const t=e&&e.condition;return!!t&&(ut(t)||Xp(t))}function Le(e){return!!e&&(!!e.field||e.aggregate==="count")}function Wg(e){return e&&e.type}function xv(e){return!!e&&"datum"in e}function nh(e){return Zl(e)&&YGe(e)||CJ(e)}function CJ(e){return xv(e)&&yi(e.datum)}function kt(e){return Le(e)||xv(e)}function Zl(e){return!!e&&("field"in e&&"type"in e||e.aggregate==="count")}function Xp(e){return e&&"value"in e&&"value"in e}function Pfe(e){return!!e&&("scale"in e||"sort"in e)}function Lfe(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function HGe(e){return!!e&&"legend"in e}function qGe(e){return!!e&&("format"in e||"formatType"in e)}function $On(e){return"op"in e}function Me(e,t={}){var n,r,i;let s=e.field;const a=t.prefix;let o=t.suffix,l="";if(COn(e))s=RIn("count");else{let u;if(!t.nofn)if($On(e))u=e.op;else{const{bin:c,aggregate:f,timeUnit:h}=e;hr(c)?(u=uGe(c),o=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")):f?Bx(f)?(l=`["${s}"]`,s=`argmax_${f.argmax}`):Tm(f)?(l=`["${s}"]`,s=`argmin_${f.argmin}`):u=String(f):h&&(u=FFn(h),o=(!ht(["range","mid"],t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:""))}u&&(s=s?`${u}_${s}`:u)}return o&&(s=`${s}_${o}`),a&&(s=`${a}_${s}`),t.forAs?jqe(s):t.expr?IIn(s,t.expr)+l:Am(s)+l}function GGe(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Le(e)&&!!e.bin;case"temporal":return!1}throw new Error(fGe(e.type))}function YGe(e){return!GGe(e)}function COn(e){return e.aggregate==="count"}function _On(e,t){var n;const{field:r,bin:i,timeUnit:s,aggregate:a}=e;if(a==="count")return t.countTitle;if(hr(i))return`${r} (binned)`;if(s){const o=(n=Co(s))===null||n===void 0?void 0:n.unit;if(o)return`${r} (${$fe(o).join("-")})`}else if(a)return Bx(a)?`${r} for max ${a.argmax}`:Tm(a)?`${r} for min ${a.argmin}`:`${DW(a)} of ${r}`;return r}function SOn(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(Bx(t))return`${i} for argmax(${t.argmax})`;if(Tm(t))return`${i} for argmin(${t.argmin})`;const s=Co(r),a=t||(s==null?void 0:s.unit)||(s==null?void 0:s.maxbins)&&"timeunit"||hr(n)&&"bin";return a?a.toUpperCase()+"("+i+")":i}const XGe=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return SOn(e);default:return _On(e,t)}};let KGe=XGe;function ZGe(e){KGe=e}function kOn(){ZGe(XGe)}function yy(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,s;const o=((i=Bfe(e))!==null&&i!==void 0?i:{}).title;if(!Le(e))return o;const l=e,u=r?QGe(l,t):void 0;return n?bi(o,l.title,u):(s=o!=null?o:l.title)!==null&&s!==void 0?s:u}function Bfe(e){if(Lfe(e)&&e.axis)return e.axis;if(HGe(e)&&e.legend)return e.legend;if(Mfe(e)&&e.header)return e.header}function QGe(e,t){return KGe(e,t)}function k8(e){var t;if(qGe(e)){const{format:n,formatType:r}=e;return{format:n,formatType:r}}else{const n=(t=Bfe(e))!==null&&t!==void 0?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function EOn(e,t){if(e.timeUnit)return"temporal";if(hr(e.bin))return"quantitative";switch(J4(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function Qh(e){if(Le(e))return e;if(YW(e))return e.condition}function Ti(e){if(kt(e))return e;if(Rfe(e))return e.condition}function _J(e,t,n){if(qt(e)||yi(e)||dF(e)){const r=qt(e)?"string":yi(e)?"number":"boolean";return Te(BMn(t,r,e)),{value:e}}return kt(e)?E8(e,t,n):Rfe(e)?Object.assign(Object.assign({},e),{condition:E8(e.condition,t,n)}):e}function E8(e,t,n){if(qGe(e)){const{format:r,formatType:i}=e,s=it(e,["format","formatType"]);if(_b(i)&&!n.customFormatTypes)return Te(qCe(t)),E8(s,t,n)}else{const r=Lfe(e)?"axis":HGe(e)?"legend":Mfe(e)?"header":null;if(r&&e[r]){const i=e[r],{format:s,formatType:a}=i,o=it(i,["format","formatType"]);if(_b(a)&&!n.customFormatTypes)return Te(qCe(t)),E8(Object.assign(Object.assign({},e),{[r]:o}),t,n)}}return Le(e)?JGe(e,t):AOn(e)}function AOn(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=yi(n)?"quantitative":qt(n)?"nominal":SS(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function JGe(e,t){const{aggregate:n,timeUnit:r,bin:i,field:s}=e,a=Object.assign({},e);if(n&&!dfe(n)&&!Bx(n)&&!Tm(n)&&(Te(UMn(n)),delete a.aggregate),r&&(a.timeUnit=Co(r)),s&&(a.field=`${s}`),hr(i)&&(a.bin=XW(i,t)),to(i)&&!Zh(t)&&Te(`Channel ${t} should not be used with "binned" bin.`),Zl(a)){const{type:o}=a,l=HFn(o);o!==l&&(a.type=l),o!=="quantitative"&&Qqe(n)&&(Te(zMn(o,n)),a.type="quantitative")}else if(!sGe(t)){const o=EOn(a,t);Te(WMn(t,o)),a.type=o}if(Zl(a)){const{compatible:o,warning:l}=TOn(a,t);o||Te(l)}if(jGe(a)&&qt(a.sort)){const{sort:o}=a;if(ZCe(o))return Object.assign(Object.assign({},a),{sort:{encoding:o}});const l=o.substr(1);if(o.charAt(0)==="-"&&ZCe(l))return Object.assign(Object.assign({},a),{sort:{encoding:l,order:"descending"}})}if(Mfe(a)){const{header:o}=a,{orient:l}=o,u=it(o,["orient"]);if(l)return Object.assign(Object.assign({},a),{header:Object.assign(Object.assign({},u),{labelOrient:o.labelOrient||l,titleOrient:o.titleOrient||l})})}return a}function XW(e,t){return dF(e)?{maxbins:BCe(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:BCe(t)}):e}const Ov={compatible:!0};function TOn(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case Cp:case _p:case RW:return YGe(e)?{compatible:!1,warning:HMn(t)}:Ov;case Ur:case Ii:case hl:case $d:case Cd:case gF:case vF:case PW:case $b:case LW:case BW:case zx:case Cf:case bd:case zW:return Ov;case wd:case ju:case xd:case _f:return n!==Cb?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Ov;case wg:case dv:case pv:case gv:case xg:case bg:case yg:case $f:case yd:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Ov;case mv:return ht(["ordinal","nominal"],e.type)?Ov:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case dl:return ht(["ordinal","nominal","geojson"],e.type)?Ov:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case mF:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Ov}}function KW(e){const{formatType:t}=k8(e);return t==="time"||!t&&DOn(e)}function DOn(e){return e&&(e.type==="temporal"||Le(e)&&!!e.timeUnit)}function zfe(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var s;const a=t&&((s=Co(t))===null||s===void 0?void 0:s.unit);let o=a||n==="temporal",l;return wt(e)?l=e.signal:SS(e)?(o=!0,l=PD(e)):(qt(e)||yi(e))&&o&&(l=`datetime(${JSON.stringify(e)})`,TFn(a)&&(yi(e)&&e<1e4||qt(e)&&isNaN(Date.parse(e)))&&(l=PD({[a]:e}))),l?r&&o?`time(${l})`:l:i?void 0:JSON.stringify(e)}function eYe(e,t){const{type:n}=e;return t.map(r=>{const i=zfe(r,{timeUnit:Le(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function wF(e,t){return hr(e.bin)?yv(t)&&ht(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function tYe(e){const{anchor:t,frame:n,offset:r,orient:i,color:s,subtitleColor:a,subtitleFont:o,subtitleFontSize:l,subtitleFontStyle:u,subtitleFontWeight:c,subtitleLineHeight:f,subtitlePadding:h}=e,d=it(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},d),s?{fill:s}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},a?{subtitleColor:a}:{}),o?{subtitleFont:o}:{}),l?{subtitleFontSize:l}:{}),u?{subtitleFontStyle:u}:{}),c?{subtitleFontWeight:c}:{}),f?{subtitleLineHeight:f}:{}),h?{subtitlePadding:h}:{}),v=FD(p,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:p,subtitleMarkConfig:v,nonMark:g,subtitle:m}}function Vg(e){return qt(e)||ut(e)&&qt(e[0])}function ai(e){return wt(e)?e:e!==void 0?{value:e}:void 0}function JCe(e){return wt(e)?e.signal:on(e.value)}function LD(e){return wt(e)?e.signal:e==null?null:on(e)}function NOn(e,t,n){for(const r of n){const i=Sb(r,t.markDef,t.config);i!==void 0&&(e[r]=ai(i))}return e}function nYe(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function Ln(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:s}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:s&&(!i||i===e)?void 0:Sb(e,t,n,r)}function Sb(e,t,n,{vgChannel:r}={}){return bi(r?A8(e,t,n.style):void 0,A8(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function A8(e,t,n){return rYe(e,nYe(t),n)}function rYe(e,t,n){t=ci(t);let r;for(const i of t){const s=n[i];s&&s[e]!==void 0&&(r=s[e])}return r}function iYe(e,t){return ci(e).reduce((n,r)=>{var i;return n.field.push(Me(r,t)),n.order.push((i=r.sort)!==null&&i!==void 0?i:"ascending"),n},{field:[],order:[]})}function sYe(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(pF(i,r))return;n.push(r)}),n}function aYe(e,t){return pF(e,t)||!t?e:e?[...ci(e),...ci(t)].join(", "):t}function oYe(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((Vg(n)||wt(n))&&(Vg(r)||wt(r)))return{explicit:e.explicit,value:aYe(n,r)};if(Vg(n)||wt(n))return{explicit:e.explicit,value:n};if(Vg(r)||wt(r))return{explicit:e.explicit,value:r};if(!Vg(n)&&!wt(n)&&!Vg(r)&&!wt(r))return{explicit:e.explicit,value:sYe(n,r)};throw new Error("It should never reach here")}function by(e,t){const n=e&&e[t];return n?ut(n)?OD(n,r=>!!r.field):Le(n)||YW(n):!1}function Ufe(e){return OD(rGe,t=>{if(by(e,t)){const n=e[t];if(ut(n))return OD(n,r=>!!r.aggregate);{const r=Qh(n);return r&&!!r.aggregate}}return!1})}function Wfe(e,t){const n=[],r=[],i=[],s=[],a={};return Vfe(e,(o,l)=>{if(Le(o)){const{field:u,aggregate:c,bin:f,timeUnit:h}=o,d=it(o,["field","aggregate","bin","timeUnit"]);if(c||h||f){const p=Bfe(o),g=p&&p.title;let m=Me(o,{forAs:!0});const v=Object.assign(Object.assign(Object.assign({},g?[]:{title:yy(o,t,{allowDisabling:!0})}),d),{field:m});if(c){let y;if(Bx(c)?(y="argmax",m=Me({op:"argmax",field:c.argmax},{forAs:!0}),v.field=`${m}.${u}`):Tm(c)?(y="argmin",m=Me({op:"argmin",field:c.argmin},{forAs:!0}),v.field=`${m}.${u}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(y=c),y){const b={op:y,as:m};u&&(b.field=u),s.push(b)}}else if(n.push(m),Zl(o)&&hr(f)){if(r.push({bin:f,field:u,as:m}),n.push(Me(o,{binSuffix:"end"})),wF(o,l)&&n.push(Me(o,{binSuffix:"range"})),Zh(l)){const y={field:m+"_end"};a[l+"2"]=y}v.bin="binned",sGe(l)||(v.type=Cb)}else if(h){i.push({timeUnit:h,field:u,as:m});const y=Zl(o)&&o.type!==Q$&&"time";y&&(l===gF||l===$b?v.formatType=y:bMn(l)?v.legend=Object.assign({formatType:y},v.legend):Zh(l)&&(v.axis=Object.assign({formatType:y},v.axis)))}a[l]=v}else n.push(u),a[l]=e[l]}else a[l]=e[l]}),{bins:r,timeUnits:i,aggregate:s,groupby:n,encoding:a}}function IOn(e,t,n){const r=wMn(t,n);if(r){if(r==="binned"){const i=e[t===$f?Ur:Ii];return!!(Le(i)&&Le(e[t])&&to(i.bin))}}else return!1;return!0}function MOn(e,t,n){const r=t.type;return Ie(e).reduce((i,s)=>{if(!iGe(s))return Te(jMn(s)),i;const a=e[s];if(s==="angle"&&r==="arc"&&!e.theta&&(Te(LMn),s=Cf),!IOn(e,s,r))return Te(jW(s,r)),i;if(s===xg&&r==="line"){const o=Qh(e[s]);if(o!=null&&o.aggregate)return Te(VMn),i}if(s===hl&&(t.filled?"fill"in e:"stroke"in e))return Te(hGe("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(s===vF||s===mF&&!ut(a)&&!Xp(a)||s===$b&&ut(a))a&&(i[s]=ci(a).reduce((o,l)=>(Le(l)?o.push(JGe(l,s)):Te(wJ(l,s)),o),[]));else{if(s===$b&&a===null)i[s]=null;else if(!Le(a)&&!xv(a)&&!Xp(a)&&!Ofe(a)&&!wt(a))return Te(wJ(a,s)),i;i[s]=_J(a,s,n)}return i},{})}function FOn(e){const t=[];for(const n of Ie(e))if(by(e,n)){const r=e[n],i=ci(r);for(const s of i)Le(s)?t.push(s):YW(s)&&t.push(s.condition)}return t}function Vfe(e,t,n){if(!!e)for(const r of Ie(e)){const i=e[r];if(ut(i))for(const s of i)t.call(n,s,r);else t.call(n,i,r)}}function lYe(e,t,n,r){return e?Ie(e).reduce((i,s)=>{const a=e[s];return ut(a)?a.reduce((o,l)=>t.call(r,o,l,s),i):t.call(r,i,a,s)},n):n}function uYe(e,t){return Ie(t).reduce((n,r)=>{switch(r){case Ur:case Ii:case LW:case zW:case BW:case $f:case yd:case Cf:case bg:case bd:case yg:case xd:case wd:case _f:case ju:case gF:case dl:case zx:case $b:return n;case mF:if(e==="line"||e==="trail")return n;case vF:case PW:{const i=t[r];if(ut(i)||Le(i))for(const s of ci(i))s.aggregate||n.push(Me(s,{}));return n}case xg:if(e==="trail")return n;case hl:case $d:case Cd:case wg:case dv:case pv:case mv:case gv:{const i=Qh(t[r]);return i&&!i.aggregate&&n.push(Me(i,{})),n}}},[])}function OOn(e){const{tooltip:t}=e,n=it(e,["tooltip"]);if(!t)return{filteredEncoding:e};let r,i;if(ut(t)){for(const s of t)s.aggregate?(r||(r=[]),r.push(s)):(i||(i=[]),i.push(s));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return ut(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function SJ(e,t,n,r=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...e.map(({fieldPrefix:s,titlePrefix:a})=>{const o=r?` of ${t.field}`:"";return{field:s+t.field,type:t.type,title:wt(a)?{signal:a+`"${escape(o)}"`}:a+o}}),...FOn(n)]}}function cYe(e){const{axis:t,title:n,field:r}=e;return t&&t.title!==void 0?void 0:bi(n,r)}function jfe(e,t,n,r,i){const{scale:s,axis:a}=n;return({partName:o,mark:l,positionPrefix:u,endPositionPrefix:c=void 0,aria:f,extraEncoding:h={}})=>{const d=cYe(n);return fYe(e,o,i,f,{mark:l,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:u+"_"+n.field,type:n.type},d!==void 0?{title:d}:{}),s!==void 0?{scale:s}:{}),a!==void 0?{axis:a}:{})},qt(c)?{[t+"2"]:{field:c+"_"+n.field}}:{}),r),h)})}}function fYe(e,t,n,r,i){const{clip:s,color:a,opacity:o}=e,l=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),s?{clip:s}:{}),a?{color:a}:{}),o?{opacity:o}:{}),Kh(i.mark)?i.mark:{type:i.mark}),{style:`${l}-${t}`}),dF(e[t])?{}:e[t]),r===!1?{aria:r}:{})})]:[]}function hYe(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",s=r[i],a=r[i+"2"],o=r[i+"Error"],l=r[i+"Error2"];return{continuousAxisChannelDef:FR(s,n),continuousAxisChannelDef2:FR(a,n),continuousAxisChannelDefError:FR(o,n),continuousAxisChannelDefError2:FR(l,n),continuousAxis:i}}function FR(e,t){if(e&&e.aggregate){const{aggregate:n}=e,r=it(e,["aggregate"]);return n!==t&&Te(mFn(n,t)),r}else return e}function dYe(e,t){const{mark:n,encoding:r}=e,{x:i,y:s}=r;if(nh(i)){if(nh(s)){const a=Le(i)&&i.aggregate,o=Le(s)&&s.aggregate;if(!a&&o===t)return"vertical";if(!o&&a===t)return"horizontal";if(a===t&&o===t)throw new Error("Both x and y cannot have aggregate");return Kh(n)&&n.orient?n.orient:"vertical"}return"horizontal"}else{if(nh(s))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}}const T8="boxplot",ROn=["box","median","outliers","rule","ticks"],POn=new OW(T8,gYe);function pYe(e){return yi(e)?"tukey":e}function gYe(e,{config:t}){var n,r;const{mark:i,encoding:s,selection:a,projection:o}=e,l=it(e,["mark","encoding","selection","projection"]),u=Kh(i)?i:{type:i};a&&Te(cGe("boxplot"));const c=(n=u.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=Ln("size",u,t),h=pYe(c),{transform:d,continuousAxisChannelDef:p,continuousAxis:g,groupby:m,aggregate:v,encodingWithoutContinuousAxis:y,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:w}=LOn(e,c,t),{color:C,size:$}=y,_=it(y,["color","size"]),k=P=>jfe(u,g,p,P,t.boxplot),E=k(_),S=k(y),N=k(Object.assign(Object.assign({},_),$?{size:$}:{})),A=SJ([{fieldPrefix:h==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:h==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],p,y),D={type:"tick",color:"black",opacity:1,orient:b,invalid:null},T=h==="min-max"?A:SJ([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],p,y),I=[...E({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:T}),...E({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:T}),...E({partName:"ticks",mark:D,positionPrefix:"lower_whisker",aria:!1,extraEncoding:T}),...E({partName:"ticks",mark:D,positionPrefix:"upper_whisker",aria:!1,extraEncoding:T})],F=[...h!=="tukey"?I:[],...S({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:x,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:A}),...N({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},ds(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:b,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:A})];let R;if(h!=="min-max"){const P=`datum["lower_box_${p.field}"]`,V=`datum["upper_box_${p.field}"]`,z=`(${V} - ${P})`,q=`${P} - ${c} * ${z}`,G=`${V} + ${c} * ${z}`,K=`datum["${p.field}"]`,Y={joinaggregate:mYe(p.field),groupby:m};let te;h==="tukey"&&(te={transform:[{filter:`(${q} <= ${K}) && (${K} <= ${G})`},{aggregate:[{op:"min",field:p.field,as:"lower_whisker_"+p.field},{op:"max",field:p.field,as:"upper_whisker_"+p.field},{op:"min",field:"lower_box_"+p.field,as:"lower_box_"+p.field},{op:"max",field:"upper_box_"+p.field,as:"upper_box_"+p.field},...v],groupby:m}],layer:I});const Z=it(_,["tooltip"]),{scale:ae,axis:O}=p,L=cYe(p),W=fYe(u,"outliers",t.boxplot,!0,{transform:[{filter:`(${K} < ${q}) || (${K} > ${G})`}],mark:"point",encoding:Object.assign(Object.assign({[g]:Object.assign(Object.assign(Object.assign({field:p.field,type:p.type},L!==void 0?{title:L}:{}),ae!==void 0?{scale:ae}:{}),O!==void 0?{axis:O}:{})},Z),w?{tooltip:w}:{})})[0];W&&te?R={transform:[Y],layer:[W,te]}:W?(R=W,R.transform.unshift(Y)):te&&(R=te,R.transform.unshift(Y))}return R?Object.assign(Object.assign({},l),{layer:[R,{transform:d,layer:F}]}):Object.assign(Object.assign({},l),{transform:((r=l.transform)!==null&&r!==void 0?r:[]).concat(d),layer:F})}function mYe(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function LOn(e,t,n){const r=dYe(e,T8),{continuousAxisChannelDef:i,continuousAxis:s}=hYe(e,r,T8),a=i.field,o=pYe(t),l=[...mYe(a),{op:"median",field:a,as:"mid_box_"+a},{op:"min",field:a,as:(o==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:a,as:(o==="min-max"?"upper_whisker_":"max_")+a}],u=o==="min-max"||o==="tukey"?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:"iqr_"+a},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:"upper_whisker_"+a},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:"lower_whisker_"+a}],c=e.encoding,f=s;c[f];const h=it(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:d,filteredEncoding:p}=OOn(h),{bins:g,timeUnits:m,aggregate:v,groupby:y,encoding:b}=Wfe(p,n),x=r==="vertical"?"horizontal":"vertical",w=r;return{transform:[...g,...m,{aggregate:[...v,...l],groupby:y},...u],groupby:y,aggregate:v,continuousAxisChannelDef:i,continuousAxis:s,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:d}}const Hfe="errorbar",BOn=["ticks","rule"],zOn=new OW(Hfe,vYe);function vYe(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:s,ticksOrient:a,markDef:o,outerSpec:l,tooltipEncoding:u}=yYe(e,Hfe,t),c=jfe(o,i,r,s,t.errorbar),f={type:"tick",orient:a},h=[...c({partName:"ticks",mark:f,positionPrefix:"lower",aria:!1,extraEncoding:u}),...c({partName:"ticks",mark:f,positionPrefix:"upper",aria:!1,extraEncoding:u}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return Object.assign(Object.assign(Object.assign({},l),{transform:n}),h.length>1?{layer:h}:Object.assign({},h[0]))}function UOn(e,t){const{encoding:n}=e;if(WOn(n))return{orient:dYe(e,t),inputType:"raw"};const r=VOn(n),i=jOn(n),s=n.x,a=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const o=n.x2,l=n.y2;if(kt(o)&&kt(l))throw new Error(`${t} cannot have both x2 and y2`);if(kt(o)){if(nh(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(kt(l)){if(nh(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const o=n.xError,l=n.xError2,u=n.yError,c=n.yError2;if(kt(l)&&!kt(o))throw new Error(`${t} cannot have xError2 without xError`);if(kt(c)&&!kt(u))throw new Error(`${t} cannot have yError2 without yError`);if(kt(o)&&kt(u))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(kt(o)){if(nh(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(kt(u)){if(nh(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function WOn(e){return(kt(e.x)||kt(e.y))&&!kt(e.x2)&&!kt(e.y2)&&!kt(e.xError)&&!kt(e.xError2)&&!kt(e.yError)&&!kt(e.yError2)}function VOn(e){return kt(e.x2)||kt(e.y2)}function jOn(e){return kt(e.xError)||kt(e.xError2)||kt(e.yError)||kt(e.yError2)}function yYe(e,t,n){var r;const{mark:i,encoding:s,selection:a,projection:o}=e,l=it(e,["mark","encoding","selection","projection"]),u=Kh(i)?i:{type:i};a&&Te(cGe(t));const{orient:c,inputType:f}=UOn(e,t),{continuousAxisChannelDef:h,continuousAxisChannelDef2:d,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=hYe(e,c,t),{errorBarSpecificAggregate:v,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:x}=HOn(u,h,d,p,g,f,t,n),w=s,C=m;w[C];const $=m==="x"?"x2":"y2";w[$];const _=m==="x"?"xError":"yError";w[_];const k=m==="x"?"xError2":"yError2";w[k];const E=it(w,[typeof C=="symbol"?C:C+"",typeof $=="symbol"?$:$+"",typeof _=="symbol"?_:_+"",typeof k=="symbol"?k:k+""]),{bins:S,timeUnits:N,aggregate:A,groupby:D,encoding:T}=Wfe(E,n),I=[...A,...v],F=f!=="raw"?[]:D,R=SJ(b,h,T,x);return{transform:[...(r=l.transform)!==null&&r!==void 0?r:[],...S,...N,...I.length===0?[]:[{aggregate:I,groupby:F}],...y],groupby:F,continuousAxisChannelDef:h,continuousAxis:m,encodingWithoutContinuousAxis:T,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:l,tooltipEncoding:R}}function HOn(e,t,n,r,i,s,a,o){let l=[],u=[];const c=t.field;let f,h=!1;if(s==="raw"){const d=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":o.errorbar.center,p=e.extent?e.extent:d==="mean"?"stderr":"iqr";if(d==="median"!=(p==="iqr")&&Te(gFn(d,p,a)),p==="stderr"||p==="stdev")l=[{op:p,field:c,as:"extent_"+c},{op:d,field:c,as:"center_"+c}],u=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:"upper_"+c},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:"lower_"+c}],f=[{fieldPrefix:"center_",titlePrefix:DW(d)},{fieldPrefix:"upper_",titlePrefix:e_e(d,p,"+")},{fieldPrefix:"lower_",titlePrefix:e_e(d,p,"-")}],h=!0;else{e.center&&e.extent&&Te(vFn(e.extent,a));let g,m,v;p==="ci"?(g="mean",m="ci0",v="ci1"):(g="median",m="q1",v="q3"),l=[{op:m,field:c,as:"lower_"+c},{op:v,field:c,as:"upper_"+c},{op:g,field:c,as:"center_"+c}],f=[{fieldPrefix:"upper_",titlePrefix:yy({field:c,aggregate:v,type:"quantitative"},o,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:yy({field:c,aggregate:m,type:"quantitative"},o,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:yy({field:c,aggregate:g,type:"quantitative"},o,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&Te(pFn(e.center,e.extent)),s==="aggregated-upper-lower"?(f=[],u=[{calculate:`datum["${n.field}"]`,as:"upper_"+c},{calculate:`datum["${c}"]`,as:"lower_"+c}]):s==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:"upper_"+c}],i?u.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:"lower_"+c}):u.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:"lower_"+c}));for(const d of u)f.push({fieldPrefix:d.as.substring(0,6),titlePrefix:K$(K$(d.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:f,tooltipTitleWithFieldName:h}}function e_e(e,t,n){return DW(e)+" "+n+" "+t}const qfe="errorband",qOn=["band","borders"],GOn=new OW(qfe,bYe);function bYe(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:s,markDef:a,outerSpec:o,tooltipEncoding:l}=yYe(e,qfe,t),u=a,c=jfe(u,i,r,s,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let h={type:f?"area":"rect"},d={type:f?"line":"rule"};const p=Object.assign(Object.assign({},u.interpolate?{interpolate:u.interpolate}:{}),u.tension&&u.interpolate?{tension:u.tension}:{});return f?(h=Object.assign(Object.assign(Object.assign({},h),p),{ariaRoleDescription:"errorband"}),d=Object.assign(Object.assign({},d),p)):u.interpolate?Te(YCe("interpolate")):u.tension&&Te(YCe("tension")),Object.assign(Object.assign({},o),{transform:n,layer:[...c({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l}),...c({partName:"borders",mark:d,positionPrefix:"lower",aria:!1,extraEncoding:l}),...c({partName:"borders",mark:d,positionPrefix:"upper",aria:!1,extraEncoding:l})]})}const xYe={};function Gfe(e,t,n){const r=new OW(e,t);xYe[e]={normalizer:r,parts:n}}function YOn(){return Ie(xYe)}Gfe(T8,gYe,ROn);Gfe(Hfe,vYe,BOn);Gfe(qfe,bYe,qOn);const XOn=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],wYe=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],KOn={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},ZOn={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},QOn={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},J$="_vgsid_",JOn={single:{on:"click",fields:[J$],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[J$],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function Yfe(e){return!!e&&(e==="legend"||!!e.legend)}function kG(e){return Yfe(e)&&ds(e)}function eRn(e){return ZW(e)||Kfe(e)||Xfe(e)}function Xfe(e){return"concat"in e}function ZW(e){return"vconcat"in e}function Kfe(e){return"hconcat"in e}function Jh(e){return ds(e)&&e.step!==void 0}function t_e(e){return e.view||e.width||e.height}const n_e=20,tRn={align:1,bounds:1,center:1,columns:1,spacing:1},nRn=Ie(tRn);function rRn(e,t,n){var r,i;const s=n[t],a={},{spacing:o,columns:l}=s;o!==void 0&&(a.spacing=o),l!==void 0&&(GW(e)&&!bF(e.facet)||Xfe(e))&&(a.columns=l),ZW(e)&&(a.columns=1);for(const u of nRn)if(e[u]!==void 0)if(u==="spacing"){const c=e[u];a[u]=yi(c)?c:{row:(r=c.row)!==null&&r!==void 0?r:o,column:(i=c.column)!==null&&i!==void 0?i:o}}else a[u]=e[u];return a}function kJ(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function D8(e,t){const n=BD(e,t);return Jh(n)?n.step:Zfe}function BD(e,t){var n;const r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return bi(r,{step:e.step})}const Zfe=20,iRn={continuousWidth:200,continuousHeight:200,step:Zfe},sRn={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:iRn,mark:YIn,arc:{},area:{},bar:KIn,circle:{},geoshape:{},image:{},line:{},point:{},rect:ZIn,rule:{color:"black"},square:{},text:{color:"black"},tick:QIn,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:sOn,projection:{},legend:ZOn,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:JOn,style:{},title:{},facet:{spacing:n_e},concat:{spacing:n_e}},Od=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],r_e={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},i_e={blue:Od[0],orange:Od[1],red:Od[2],teal:Od[3],green:Od[4],yellow:Od[5],purple:Od[6],pink:Od[7],brown:Od[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function aRn(e={}){return{signals:[{name:"color",value:ds(e)?Object.assign(Object.assign({},i_e),e):i_e}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function oRn(e){return{signals:[{name:"fontSize",value:ds(e)?Object.assign(Object.assign({},r_e),e):r_e}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function lRn(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function $Ye(e={}){const{color:t,font:n,fontSize:r}=e,i=it(e,["color","font","fontSize"]);return Pqe({},sRn,n?lRn(n):{},t?aRn(t):{},r?oRn(r):{},i||{})}const uRn=["view",...Kqe],cRn=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],fRn=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},GIn);function hRn(e){e=Gt(e);for(const t of cRn)delete e[t];if(e.axis)for(const t in e.axis)ufe(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of XOn)delete e.legend[t];if(e.mark){for(const t of LCe)delete e.mark[t];e.mark.tooltip&&ds(e.mark.tooltip)&&delete e.mark.tooltip}for(const t of uRn){for(const r of LCe)delete e[t][r];const n=fRn[t];if(n)for(const r of n)delete e[t][r];pRn(e,t)}for(const t of YOn())delete e[t];dRn(e);for(const t in e)ds(e[t])&&tr(e[t])&&delete e[t];return tr(e)?void 0:e}function dRn(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=tYe(e.title);tr(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),tr(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),tr(r)?delete e.title:e.title=r}function pRn(e,t,n,r){const i=r?e[t][r]:e[t];t==="view"&&(n="cell");const s=Object.assign(Object.assign({},i),e.style[n!=null?n:t]);tr(s)||(e.style[n!=null?n:t]=s),r||delete e[t]}function QW(e){return"layer"in e}function gRn(e){return"repeat"in e}function mRn(e){return!ut(e.repeat)&&e.repeat.layer}class CYe{map(t,n){return GW(t)?this.mapFacet(t,n):gRn(t)?this.mapRepeat(t,n):Kfe(t)?this.mapHConcat(t,n):ZW(t)?this.mapVConcat(t,n):Xfe(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(QW(t))return this.mapLayer(t,n);if(vg(t))return this.mapUnit(t,n);throw new Error(yfe(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(r=>this.map(r,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(r=>this.map(r,n))})}mapConcat(t,n){const{concat:r}=t,i=it(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(s=>this.map(s,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const vRn={zero:1,center:1,normalize:1};function yRn(e){return e in vRn}const bRn=new Set([Gqe,IW,NW,$8,FW,ffe,hfe,MW,Yqe,cfe]),xRn=new Set([IW,NW,Gqe]);function s_e(e,t){var n,r;const i=t==="x"?"y":"radius",s=e[t],a=e[i];if(Le(s)&&Le(a))if(Wg(s)==="quantitative"&&Wg(a)==="quantitative"){if(s.stack)return t;if(a.stack)return i;const o=Le(s)&&!!s.aggregate,l=Le(a)&&!!a.aggregate;if(o!==l)return o?t:i;{const u=(n=s.scale)===null||n===void 0?void 0:n.type,c=(r=a.scale)===null||r===void 0?void 0:r.type;if(u&&u!=="linear")return i;if(c&&c!=="linear")return t}}else{if(Wg(s)==="quantitative")return t;if(Wg(a)==="quantitative")return i}else{if(Wg(s)==="quantitative")return t;if(Wg(a)==="quantitative")return i}}function wRn(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function _Ye(e,t,n={}){const r=Kh(e)?e.type:e;if(!bRn.has(r))return null;const i=s_e(t,"x")||s_e(t,"theta");if(!i)return null;const s=t[i],a=Le(s)?Me(s,{}):void 0;let o=wRn(i),l=t[o],u=Le(l)?Me(l,{}):void 0;u===a&&(u=void 0,l=void 0,o=void 0);const c=mMn.reduce((h,d)=>{if(d!=="tooltip"&&by(t,d)){const p=t[d];for(const g of ci(p)){const m=Qh(g);if(m.aggregate)continue;const v=Me(m,{});(!v||v!==u)&&h.push({channel:d,fieldDef:m})}}return h},[]);let f;if(s.stack!==void 0?dF(s.stack)?f=s.stack?"zero":null:f=s.stack:c.length>0&&xRn.has(r)&&(f="zero"),!f||!yRn(f)||Ufe(t)&&c.length===0)return null;if(s.scale&&s.scale.type&&s.scale.type!==fi.LINEAR){if(n.disallowNonLinearStack)return null;Te(fFn(s.scale.type))}return kt(t[_d(i)])?(s.stack!==void 0&&Te(cFn(i)),null):(Le(s)&&s.aggregate&&!ht(iMn,s.aggregate)&&Te(hFn(s.aggregate)),{groupbyChannel:l?o:void 0,groupbyField:u,fieldChannel:i,impute:s.impute===null?!1:Lx(r),stackBy:c,offset:f})}function $Rn(e){const t=it(e,["point","line"]);return Ie(t).length>1?t:t.type}function CRn(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:$p(e[t],["point","line"])}));return e}function EG(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?ds(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?ds(t.point)?t.point:{}:void 0}function a_e(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class _Rn{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(vg(t)){const{mark:r,encoding:i}=t,s=Kh(r)?r:{type:r};switch(s.type){case"line":case"rule":case"trail":return!!EG(s,n[s.type],i);case"area":return!!EG(s,n[s.type],i)||!!a_e(s,n[s.type])}}return!1}run(t,n,r){const{config:i}=n,{selection:s,projection:a,encoding:o,mark:l}=t,u=it(t,["selection","projection","encoding","mark"]),c=Kh(l)?l:{type:l},f=EG(c,i[c.type],o),h=c.type==="area"&&a_e(c,i[c.type]),d=[Object.assign(Object.assign({},s?{selection:s}:{}),{mark:$Rn(Object.assign(Object.assign({},c.type==="area"&&c.opacity===void 0&&c.fillOpacity===void 0?{opacity:.7}:{}),c)),encoding:$p(o,["shape"])})],p=_Ye(c,o);let g=o;if(p){const{fieldChannel:m,offset:v}=p;g=Object.assign(Object.assign({},o),{[m]:Object.assign(Object.assign({},o[m]),v?{stack:v}:{})})}return h&&d.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"line"},FD(c,["clip","interpolate","tension","tooltip"])),h),encoding:g})),f&&d.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},FD(c,["clip","tooltip"])),f),encoding:g})),r(Object.assign(Object.assign({},u),{layer:d}),Object.assign(Object.assign({},n),{config:CRn(i)}))}}class SRn{constructor(){this.name="RangeStep"}hasMatchingType(t){var n;if(vg(t)&&t.encoding)for(const r of Hu){const i=t.encoding[r];if(i&&kt(i)&&!((n=i==null?void 0:i.scale)===null||n===void 0)&&n.rangeStep)return!0}return!1}run(t){var n;const r={};let i=Object.assign({},t.encoding);for(const s of Hu){const a=Sd(s),o=i[s];if(o&&kt(o)&&!((n=o==null?void 0:o.scale)===null||n===void 0)&&n.rangeStep){const{scale:l}=o,u=it(o,["scale"]),c=l,f=it(c,["rangeStep"]);r[a]={step:l.rangeStep},Te(XMn),i=Object.assign(Object.assign({},i),{[s]:Object.assign(Object.assign({},u),tr(f)?{}:{scale:f})})}}return Object.assign(Object.assign(Object.assign({},r),t),{encoding:i})}}function kRn(e,t){return t?bF(e)?kYe(e,t):SYe(e,t):e}function AG(e,t){return t?kYe(e,t):e}function EJ(e,t,n){const r=t[e];if(xOn(r)){if(r.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[r.repeat]});Te(NMn(r.repeat));return}return t}function SYe(e,t){if(e=EJ("field",e,t),e!==void 0){if(e===null)return null;if(jGe(e)&&wh(e.sort)){const n=EJ("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function o_e(e,t){if(Le(e))return SYe(e,t);{const n=EJ("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function l_e(e,t){if(kt(e)){const n=o_e(e,t);if(n)return n;if(Ofe(e))return{condition:e.condition}}else{if(Rfe(e)){const n=o_e(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):it(e,["condition"])}return e}}function kYe(e,t){const n={};for(const r in e)if(H1(e,r)){const i=e[r];if(ut(i))n[r]=i.map(s=>l_e(s,t)).filter(s=>s);else{const s=l_e(i,t);s!==void 0&&(n[r]=s)}}return n}class ERn{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(vg(t)){const{encoding:n,mark:r}=t;if(r==="line")for(const i of pMn){const s=Ux(i),a=n[s];if(n[i]&&(Le(a)&&!to(a.bin)||xv(a)))return!0}}return!1}run(t,n,r){const{encoding:i}=t;return Te(GMn(!!i.x2,!!i.y2)),r(Object.assign(Object.assign({},t),{mark:"rule"}),n)}}class ARn extends CYe{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[POn,zOn,GOn,new _Rn,new ERn,new SRn]}map(t,n){if(vg(t)){const r=by(t.encoding,Cp),i=by(t.encoding,_p),s=by(t.encoding,RW);if(r||i||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,s=Object.assign(Object.assign({},t),{encoding:AG(t.encoding,n.repeater)});if(r||i)return this.mapUnitWithParentEncodingOrProjection(s,n);const a=this.mapLayerOrUnit.bind(this);for(const o of this.nonFacetUnitNormalizers)if(o.hasMatchingType(s,n.config))return o.run(s,n,a);return s}mapRepeat(t,n){return mRn(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i}=t,s=it(t,["repeat","spec"]),{row:a,column:o,layer:l}=r,{repeater:u={},repeaterPrefix:c=""}=n;return a||o?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},a?{row:a}:{}),o?{column:o}:{}),spec:{repeat:{layer:l},spec:i}}),n):Object.assign(Object.assign({},s),{layer:l.map(f=>{const h=Object.assign(Object.assign({},u),{layer:f}),d=(i.name||"")+c+`child__layer_${Dr(f)}`,p=this.mapLayerOrUnit(i,Object.assign(Object.assign({},n),{repeater:h,repeaterPrefix:d}));return p.name=d,p})})}mapNonLayerRepeat(t,n){var r;const{repeat:i,spec:s,data:a}=t,o=it(t,["repeat","spec","data"]);!ut(i)&&t.columns&&(t=$p(t,["columns"]),Te(jCe("repeat")));const l=[],{repeater:u={},repeaterPrefix:c=""}=n,f=!ut(i)&&i.row||[u?u.row:null],h=!ut(i)&&i.column||[u?u.column:null],d=ut(i)&&i||[u?u.repeat:null];for(const g of d)for(const m of f)for(const v of h){const y={repeat:g,row:m,column:v,layer:u.layer},b=(s.name||"")+c+"child__"+(ut(i)?`${Dr(g)}`:(i.row?`row_${Dr(m)}`:"")+(i.column?`column_${Dr(v)}`:"")),x=this.map(s,Object.assign(Object.assign({},n),{repeater:y,repeaterPrefix:b}));x.name=b,l.push($p(x,["data"]))}const p=ut(i)?t.columns:i.column?i.column.length:1;return Object.assign(Object.assign({data:(r=s.data)!==null&&r!==void 0?r:a,align:"all"},o),{columns:p,concat:l})}mapFacet(t,n){const{facet:r}=t;return bF(r)&&t.columns&&(t=$p(t,["columns"]),Te(jCe("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:s,parentProjection:a,config:o}=n,l=c_e({parentProjection:a,projection:i}),u=u_e({parentEncoding:s,encoding:AG(r,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),l?{projection:l}:{}),u?{encoding:u}:{}),{config:o})}mapFacetedUnit(t,n){const r=t.encoding,{row:i,column:s,facet:a}=r,o=it(r,["row","column","facet"]),{mark:l,width:u,projection:c,height:f,view:h,selection:d,encoding:p}=t,g=it(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:m,layout:v}=this.getFacetMappingAndLayout({row:i,column:s,facet:a},n),y=AG(o,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),v),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{width:u}:{}),f?{height:f}:{}),h?{view:h}:{}),c?{projection:c}:{}),{mark:l,encoding:y}),d?{selection:d}:{})}),n)}getFacetMappingAndLayout(t,n){var r;const{row:i,column:s,facet:a}=t;if(i||s){a&&Te(qMn([...i?[Cp]:[],...s?[_p]:[]]));const o={},l={};for(const u of[Cp,_p]){const c=t[u];if(c){const f=it(c,["align","center","spacing","columns"]);o[u]=f;for(const h of["align","center","spacing"])c[h]!==void 0&&(l[h]=(r=l[h])!==null&&r!==void 0?r:{},l[h][u]=c[h])}}return{facetMapping:o,layout:l}}else{const{align:o,center:l,spacing:u,columns:c}=a,f=it(a,["align","center","spacing","columns"]);return{facetMapping:kRn(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},o?{align:o}:{}),l?{center:l}:{}),u?{spacing:u}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:r,parentProjection:i}=n,s=it(n,["parentEncoding","parentProjection"]);const{encoding:a,projection:o}=t,l=it(t,["encoding","projection"]),u=Object.assign(Object.assign({},s),{parentEncoding:u_e({parentEncoding:r,encoding:a}),parentProjection:c_e({parentProjection:i,projection:o})});return super.mapLayer(l,u)}}function u_e(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const i=Ie(t).reduce((s,a)=>(n[a]&&s.push(a),s),[]);i.length>0&&Te(RMn(i))}const r=Object.assign(Object.assign({},t!=null?t:{}),n!=null?n:{});return tr(r)?void 0:r}function c_e(e){const{parentProjection:t,projection:n}=e;return t&&n&&Te(PMn({parentProjection:t,projection:n})),n!=null?n:t}function EYe(e,t){t===void 0&&(t=$Ye(e.config));const n=DRn(e,t),{width:r,height:i}=e,s=NRn(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),s?{autosize:s}:{})}const TRn=new ARn;function DRn(e,t={}){return TRn.map(e,{config:t})}function f_e(e){return qt(e)?{type:e}:e!=null?e:{}}function NRn(e,t,n){let{width:r,height:i}=t;const s=vg(e)||QW(e),a={};s?r=="container"&&i=="container"?(a.type="fit",a.contains="padding"):r=="container"?(a.type="fit-x",a.contains="padding"):i=="container"&&(a.type="fit-y",a.contains="padding"):(r=="container"&&(Te(zCe("width")),r=void 0),i=="container"&&(Te(zCe("height")),i=void 0));const o=Object.assign(Object.assign(Object.assign({type:"pad"},a),n?f_e(n.autosize):{}),f_e(e.autosize));if(o.type==="fit"&&!s&&(Te(_Mn),o.type="pad"),r=="container"&&!(o.type=="fit"||o.type=="fit-x")&&Te(UCe("width")),i=="container"&&!(o.type=="fit"||o.type=="fit-y")&&Te(UCe("height")),!pF(o,{type:"pad"}))return o}function IRn(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function MRn(e){return e?`fit-${UW(e)}`:"fit"}const FRn=["background","padding"];function h_e(e){return FRn.reduce((t,n)=>(e&&e[n]!==void 0&&(t[n]=e[n]),t),{})}class $g{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new $g(Gt(this.explicit),Gt(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return bi(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,n){n.value!==void 0&&this.set(t,n.value,n.explicit)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,n){n.explicit[t]!==void 0?this.set(t,n.explicit[t],!0):n.implicit[t]!==void 0&&this.set(t,n.implicit[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of Ie(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function q1(e){return{explicit:!0,value:e}}function xl(e){return{explicit:!1,value:e}}function AYe(e){return(t,n,r,i)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:JW(t,n,r,i)}}function JW(e,t,n,r){return e.explicit&&t.explicit&&Te(rFn(n,r,e.value,t.value)),e}function Nm(e,t,n,r,i=JW){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:pF(e.value,t.value)?e:i(e,t,n,r)}class ORn extends $g{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function zD(e){return"url"in e}function N8(e){return"values"in e}function TYe(e){return"name"in e&&!zD(e)&&!N8(e)&&!xy(e)}function xy(e){return e&&(DYe(e)||NYe(e)||Qfe(e))}function DYe(e){return"sequence"in e}function NYe(e){return"sphere"in e}function Qfe(e){return"graticule"in e}const ha="main",I8="raw";function IYe(e){return"filter"in e}function RRn(e){return(e==null?void 0:e.stop)!==void 0}function PRn(e){return"lookup"in e}function LRn(e){return"data"in e}function BRn(e){return"selection"in e}function zRn(e){return"pivot"in e}function URn(e){return"density"in e}function WRn(e){return"quantile"in e}function VRn(e){return"regression"in e}function jRn(e){return"loess"in e}function HRn(e){return"sample"in e}function qRn(e){return"window"in e}function GRn(e){return"joinaggregate"in e}function YRn(e){return"flatten"in e}function XRn(e){return"calculate"in e}function KRn(e){return"bin"in e}function ZRn(e){return"impute"in e}function QRn(e){return"timeUnit"in e}function JRn(e){return"aggregate"in e}function e4n(e){return"stack"in e}function t4n(e){return"fold"in e}function n4n(e){return e.map(t=>IYe(t)?{filter:Q4(t.filter,VFn)}:t)}function $F(e,t,n,r){const i=Ofe(t)&&t.condition,s=r(t);if(i){const o=ci(i).map(l=>{const u=r(l),c=bOn(l)?iXe(e,l.selection):R8(e,l.test);return Object.assign({test:c},u)});return{[n]:[...o,...s!==void 0?[s]:[]]}}else return s!==void 0?{[n]:s}:{}}function Jfe(e,t="text"){const n=e.encoding[t];return $F(e,n,t,r=>eV(r,e.config))}function eV(e,t,n="datum"){if(e){if(Xp(e))return ai(e.value);if(kt(e)){const{format:r,formatType:i}=k8(e);return Nfe({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function MYe(e,t={}){const{encoding:n,markDef:r,config:i,stack:s}=e,a=n.tooltip;if(ut(a))return{tooltip:d_e({tooltip:a},s,i,t)};{const o=t.reactiveGeom?"datum.datum":"datum";return $F(e,a,"tooltip",l=>{const u=eV(l,i,o);if(u)return u;if(l===null)return;let c=Ln("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),qt(c))return{value:c};if(ds(c))return c.content==="encoding"?d_e(n,s,i,t):{signal:o}})}}function FYe(e,t,n,{reactiveGeom:r}={}){const i={},s=r?"datum.datum":"datum",a=[];function o(u,c){const f=Ux(c),h=Zl(u)?u:Object.assign(Object.assign({},u),{type:e[f].type}),d=ci(yy(h,n,{allowDisabling:!1})).join(", ");let p;if(Zh(c)){const g=c==="x"?"x2":"y2",m=Qh(e[g]);if(to(h.bin)&&m){const v=Me(h,{expr:s}),y=Me(m,{expr:s}),{format:b,formatType:x}=k8(h);p=HW(v,y,b,x,n),i[g]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:y}=k8(h);p=Nfe({fieldOrDatumDef:h,format:v,formatType:y,expr:s,config:n,normalizeStack:!0}).signal}}p=p!=null?p:eV(h,n,s).signal,a.push({channel:c,key:d,value:p})}Vfe(e,(u,c)=>{Le(u)?o(u,c):YW(u)&&o(u.condition,c)});const l={};for(const{channel:u,key:c,value:f}of a)!i[u]&&!l[c]&&(l[on(c)]=f);return l}function d_e(e,t,n,{reactiveGeom:r}={}){const i=FYe(e,t,n,{reactiveGeom:r}),s=Wqe(i).map(({key:a,value:o})=>`${a}: ${o}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function r4n(e){const{markDef:t,config:n}=e,r=Ln("aria",t,n);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),i4n(e)),s4n(e))}function i4n(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=Ln("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in BFn?{}:{ariaRoleDescription:{value:t}}}function s4n(e){const{encoding:t,markDef:n,config:r,stack:i}=e,s=t.description;if(s)return $F(e,s,"description",l=>eV(l,e.config));const a=Ln("description",n,r);if(a!=null)return{description:ai(a)};if(r.aria===!1)return{};const o=FYe(t,i,r);if(!tr(o))return{description:{signal:Wqe(o).map(({key:l,value:u})=>`${l} + ": " + (${u})`).join(' + "; " + ')}}}function Ji(e,t,n={}){const{markDef:r,encoding:i,config:s}=t,{vgChannel:a}=n;let{defaultRef:o,defaultValue:l}=n;o===void 0&&(l=l!=null?l:Ln(e,r,s,{vgChannel:a,ignoreVgConfig:!0}),l!==void 0&&(o=ai(l)));const u=i[e];return $F(t,u,a!=null?a:e,c=>OGe({channel:e,channelDef:c,markDef:r,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:o}))}function OYe(e,t={filled:void 0}){var n,r,i,s;const{markDef:a,encoding:o,config:l}=e,{type:u}=a,c=(n=t.filled)!==null&&n!==void 0?n:Ln("filled",a,l),f=ht(["bar","point","circle","square","geoshape"],u)?"transparent":void 0,h=(i=(r=Ln(c===!0?"color":void 0,a,l,{vgChannel:"fill"}))!==null&&r!==void 0?r:l.mark[c===!0&&"color"])!==null&&i!==void 0?i:f,d=(s=Ln(c===!1?"color":void 0,a,l,{vgChannel:"stroke"}))!==null&&s!==void 0?s:l.mark[c===!1&&"color"],p=c?"fill":"stroke",g=Object.assign(Object.assign({},h?{fill:ai(h)}:{}),d?{stroke:ai(d)}:{});return a.color&&(c?a.fill:a.stroke)&&Te(hGe("property",{fill:"fill"in a,stroke:"stroke"in a})),Object.assign(Object.assign(Object.assign(Object.assign({},g),Ji("color",e,{vgChannel:p,defaultValue:c?h:d})),Ji("fill",e,{defaultValue:o.fill?h:void 0})),Ji("stroke",e,{defaultValue:o.stroke?d:void 0}))}function UD(e,t){const n=gMn(e),r=t[n];if(r)return r}function ya(e,t,{defaultPos:n,vgChannel:r,isMidPoint:i}){const{encoding:s,markDef:a,config:o,stack:l}=t,u=s[e],c=s[_d(e)],f=t.scaleName(e),h=t.getScaleComponent(e),d=UD(e,a),p=ehe({model:t,defaultPos:n,channel:e,scaleName:f,scale:h}),g=!u&&Zh(e)&&(s.latitude||s.longitude)?{field:t.getName(e)}:a4n({channel:e,channelDef:u,channel2Def:c,markDef:a,config:o,isMidPoint:i,scaleName:f,scale:h,stack:l,offset:d,defaultRef:p});return g?{[r||e]:g}:void 0}function a4n(e){const{channel:t,channelDef:n,isMidPoint:r,scaleName:i,stack:s,offset:a,markDef:o,config:l}=e;if(kt(n)&&s&&t===s.fieldChannel){if(Le(n)){const u=xF({channel:t,fieldDef:n,isMidPoint:r,markDef:o,stack:s,config:l});if(u!==void 0)return S8({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:u,offset:a})}return vy(n,i,{suffix:"end"},{offset:a})}return Tfe(e)}function ehe({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:s,config:a}=e;return()=>{const o=Ux(n),l=Dm(n),u=Ln(n,s,a,{vgChannel:l});if(u!==void 0)return VA(n,u);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!ht([fi.LOG,fi.TIME,fi.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return o==="y"?{field:{group:"height"}}:{value:0};switch(o){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Sd(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const o4n={left:"x",center:"xc",right:"x2"},l4n={top:"y",middle:"yc",bottom:"y2"};function RYe(e,t,n,r="middle"){if(e==="radius"||e==="theta")return Dm(e);const s=Ln(e==="x"?"align":"baseline",t,n);return e==="x"?o4n[s||(r==="top"?"left":"center")]:l4n[s||r]}function M8(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?PYe(e,t,{defaultPos:n,defaultPos2:r}):ya(e,t,{defaultPos:n})}function PYe(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:s}=t,a=_d(e),o=Sd(e),l=u4n(t,r,a),u=l[o]?RYe(e,i,s):Dm(e);return Object.assign(Object.assign({},ya(e,t,{defaultPos:n,vgChannel:u})),l)}function u4n(e,t,n){const{encoding:r,mark:i,markDef:s,stack:a,config:o}=e,l=Ux(n),u=Sd(n),c=Dm(n),f=r[l],h=e.scaleName(l),d=e.getScaleComponent(l),p=n in r||n in s?UD(n,e.markDef):UD(l,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude))return{[c]:{field:e.getName(n)}};const g=c4n({channel:n,channelDef:f,channel2Def:r[n],markDef:s,config:o,scaleName:h,scale:d,stack:a,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:OR(n,s)||OR(n,{[n]:A8(n,s,o.style),[u]:A8(u,s,o.style)})||OR(n,o[i])||OR(n,o.mark)||{[c]:ehe({model:e,defaultPos:t,channel:n,scaleName:h,scale:d})()}}function c4n({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:s,scale:a,stack:o,offset:l,defaultRef:u}){return kt(t)&&o&&e.charAt(0)===o.fieldChannel.charAt(0)?vy(t,s,{suffix:"start"},{offset:l}):Tfe({channel:e,channelDef:n,scaleName:s,scale:a,stack:o,markDef:r,config:i,offset:l,defaultRef:u})}function OR(e,t){const n=Sd(e),r=Dm(e);if(t[r]!==void 0)return{[r]:VA(e,t[r])};if(t[e]!==void 0)return{[r]:VA(e,t[e])};if(t[n])return{[n]:VA(e,t[n])}}function Im(e,t,n){var r,i,s,a;const{config:o,encoding:l,markDef:u,stack:c}=e,f=_d(t),h=Sd(t),d=l[t],p=l[f],g=e.getScaleComponent(t),m=g?g.get("type"):void 0,v=e.scaleName(t),y=u.orient,b=(i=(r=l[h])!==null&&r!==void 0?r:l.size)!==null&&i!==void 0?i:Ln("size",u,o,{vgChannel:h}),x=n==="bar"&&(t==="x"?y==="vertical":y==="horizontal");if(Le(d)&&(hr(d.bin)||to(d.bin)||d.timeUnit&&!p)&&!b&&!pl(m)){const w=xF({channel:t,fieldDef:d,stack:c,markDef:u,config:o}),C=(s=e.component.axes[t])===null||s===void 0?void 0:s[0],$=(a=C==null?void 0:C.get("translate"))!==null&&a!==void 0?a:.5;return d4n({fieldDef:d,fieldDef2:p,channel:t,markDef:u,scaleName:v,band:w,axisTranslate:$,spacing:Zh(t)?Ln("binSpacing",u,o):void 0,reverse:g.get("reverse"),config:o})}else return(kt(d)&&pl(m)||x)&&!p?h4n(n,d,t,e):PYe(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function f4n(e,t,n,r,i,s){if(r){const l=r.get("type");if(l==="point"||l==="band"){if(i[e].discreteBandSize!==void 0)return{value:i[e].discreteBandSize};if(l===fi.POINT){const u=r.get("range");return bv(u)&&yi(u.step)?{value:u.step-2}:{value:Zfe-2}}else return{scale:n,band:s}}else return{value:i[e].continuousBandSize}}const a=D8(i.view,t),o=bi(i[e].discreteBandSize,a-2);return o!==void 0?{value:o}:void 0}function h4n(e,t,n,r){var i;const{markDef:s,encoding:a,config:o,stack:l}=r,u=s.orient,c=r.scaleName(n),f=r.getScaleComponent(n),h=Sd(n),d=_d(n),p=u==="horizontal"&&n==="y"||u==="vertical"&&n==="x",g=Ln(p?"size":h,s,o,{vgChannel:h});let m;(a.size||g!==void 0)&&(p?m=Ji("size",r,{vgChannel:h,defaultValue:g}):Te(eFn(s.type)));const v=(i=kt(t)?xF({channel:n,fieldDef:t,markDef:s,stack:l,config:o}):void 0)!==null&&i!==void 0?i:1;m=m||{[h]:f4n(e,h,c,f,o,v)};const y=(f==null?void 0:f.get("type"))!=="band"||!("band"in m[h]),b=RYe(n,s,o,y?"middle":"top"),x=UD(n,s),w=Tfe({channel:n,channelDef:t,markDef:s,config:o,scaleName:c,scale:f,stack:l,offset:x,defaultRef:ehe({model:r,defaultPos:"mid",channel:n,scaleName:c,scale:f}),band:y?.5:(1-v)/2});if(h)return Object.assign({[b]:w},m);{const C=Dm(d),$=m[h],_=x?Object.assign(Object.assign({},$),{offset:x}):$;return{[b]:w,[C]:ut(w)?[w[0],Object.assign(Object.assign({},w[1]),{offset:_})]:Object.assign(Object.assign({},w),{offset:_})}}}function Yk(e,t,n,r,i){if(eGe(e))return 0;const s=e==="x"||e==="y2"?-t/2:t/2;if(wt(n)){const a=LD(i);return{signal:`${n.signal} ? ${r-s}${a?"-"+a:""} : ${r+s}${a?"+"+a:""}`}}else{if(wt(i)){const a=r+(n?-s:s);return{signal:`${a||""}${n?" - ":a?" + ":""}${i.signal}`}}return i=i||0,r+(n?-i-s:+i+s)}}function d4n({fieldDef:e,fieldDef2:t,channel:n,band:r,scaleName:i,markDef:s,spacing:a=0,axisTranslate:o,reverse:l,config:u}){const c=_d(n),f=Dm(n),h=Dm(c),d=UD(n,s);if(hr(e.bin)||e.timeUnit)return{[h]:p_e({channel:n,fieldDef:e,scaleName:i,markDef:s,band:(1-r)/2,offset:Yk(c,a,l,o,d),config:u}),[f]:p_e({channel:n,fieldDef:e,scaleName:i,markDef:s,band:1-(1-r)/2,offset:Yk(n,a,l,o,d),config:u})};if(to(e.bin)){const p=vy(e,i,{},{offset:Yk(c,a,l,o,d)});if(Le(t))return{[h]:p,[f]:vy(t,i,{},{offset:Yk(n,a,l,o,d)})};if(yF(e.bin)&&e.bin.step)return{[h]:p,[f]:{signal:`scale("${i}", ${Me(e,{expr:"datum"})} + ${e.bin.step})`,offset:Yk(n,a,l,o,d)}}}Te(gGe(c))}function p_e({channel:e,fieldDef:t,scaleName:n,markDef:r,band:i,offset:s,config:a}){const o=S8({scaleName:n,fieldOrDatumDef:t,band:i,offset:s});return FGe({fieldDef:t,channel:e,markDef:r,ref:o,config:a})}const p4n=new Set(["aria"]);function Qu(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?OYe(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g4n(e.markDef,t)),g_e(e,"fill",n)),g_e(e,"stroke",r)),Ji("opacity",e)),Ji("fillOpacity",e)),Ji("strokeOpacity",e)),Ji("strokeWidth",e)),Ji("strokeDash",e)),MYe(e)),Jfe(e,"href")),r4n(e))}function g_e(e,t,n){const{config:r,mark:i,markDef:s}=e;if(Ln("invalid",s,r)==="hide"&&n&&!Lx(i)){const o=m4n(e,{invalid:!0,channels:WW});if(o)return{[t]:[{test:o,value:null},...ci(n)]}}return n?{[t]:n}:{}}function g4n(e,t){return LFn.reduce((n,r)=>(!p4n.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=ai(e[r])),n),{})}function m4n(e,{invalid:t=!1,channels:n}){const r=n.reduce((s,a)=>{const o=e.getScaleComponent(a);if(o){const l=o.get("type"),u=e.vgField(a,{expr:"datum"});u&&qu(l)&&(s[u]=!0)}return s},{}),i=Ie(r);if(i.length>0){const s=t?"||":"&&";return i.map(a=>Dfe(a,t)).join(` ${s} `)}}function the(e){const{config:t,markDef:n}=e;if(Ln("invalid",n,t)){const i=v4n(e,{channels:Hu});if(i)return{defined:{signal:i}}}return{}}function v4n(e,{invalid:t=!1,channels:n}){const r=n.reduce((s,a)=>{const o=e.getScaleComponent(a);if(o){const l=o.get("type"),u=e.vgField(a,{expr:"datum"});u&&qu(l)&&(s[u]=!0)}return s},{}),i=Ie(r);if(i.length>0){const s=t?"||":"&&";return i.map(a=>Dfe(a,t)).join(` ${s} `)}}function m_e(e,t){if(t!==void 0)return{[e]:ai(t)}}const TG="voronoi",LYe={has:e=>e.type!=="interval"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(TG)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,s=e.mark;if(Lx(s))return Te(kMn(s)),n;const a={name:e.getName(TG),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},MYe(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let o=0,l=!1;return n.forEach((u,c)=>{var f;const h=(f=u.name)!==null&&f!==void 0?f:"";h===e.component.mark[0].name?o=c:h.indexOf(TG)>=0&&(l=!0)}),l||n.splice(o+1,0,a),n}};class Zn{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.indexOf(t)>-1){console.warn("Attempt to add the same child twice.");return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class ho extends Zn{constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${OIn()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class $h extends Zn{constructor(t,n){super(t),this.formula=n}clone(){return new $h(null,Gt(this.formula))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,s,a)=>{const{field:o,timeUnit:l}=s,u=qr(n)?n.encoding[_d(a)]:void 0,c=qr(n)&&Ffe(a,s,u,n.stack,n.markDef,n.config);if(l){const f=Me(s,{forAs:!0});i[gn({as:f,field:o,timeUnit:l})]=Object.assign({as:f,field:o,timeUnit:l},c?{band:!0}:{})}return i},{});return tr(r)?null:new $h(t,r)}static makeFromTransform(t,n){const r=Object.assign({},n),{timeUnit:i}=r,s=it(r,["timeUnit"]),a=Co(i),o=Object.assign(Object.assign({},s),{timeUnit:a});return new $h(t,{[gn(o)]:o})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)(!this.formula[n]||t.formula[n].band)&&(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(D0(this.formula).map(t=>t.as))}dependentFields(){return new Set(D0(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${gn(this.formula)}`}assemble(){const t=[];for(const n of D0(this.formula)){const{field:r,as:i,timeUnit:s}=n,a=Co(s),{unit:o,utc:l}=a,u=it(a,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Am(r),type:"timeunit"},o?{units:$fe(o)}:{}),l?{timezone:"utc"}:{}),u),{as:[i,`${i}_end`]}))}return t}}const CF="_tuple_fields";class y4n{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const b4n={has:()=>!0,parse:(e,t,n)=>{var r,i,s;const a=t.name,o=(r=t.project)!==null&&r!==void 0?r:t.project=new y4n,l={},u={},c=new Set,f=(h,d)=>{const p=d==="visual"?h.channel:h.field;let g=Dr(`${a}_${p}`);for(let m=1;c.has(g);m++)g=Dr(`${a}_${p}_${m}`);return c.add(g),{[d]:g}};if(!n.fields&&!n.encodings){const h=e.config.selection[n.type];if(n.init)for(const d of ci(n.init))for(const p of Ie(d))dMn(p)?(n.encodings||(n.encodings=[])).push(p):n.type==="interval"?(Te('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=h.encodings):(n.fields||(n.fields=[])).push(p);else n.encodings=h.encodings,n.fields=h.fields}for(const h of(i=n.fields)!==null&&i!==void 0?i:[]){const d={type:"E",field:h};d.signals=Object.assign({},f(d,"data")),o.items.push(d),o.hasField[h]=d}for(const h of(s=n.encodings)!==null&&s!==void 0?s:[]){const d=e.fieldDef(h);if(d){let p=d.field;if(d.aggregate){Te(SMn(h,d.aggregate));continue}else if(!p){Te(VCe(h));continue}if(d.timeUnit){p=e.vgField(h);const g={timeUnit:d.timeUnit,as:p,field:d.field};u[gn(g)]=g}if(!l[p]){let g="E";if(t.type==="interval"){const v=e.getScaleComponent(h).get("type");qu(v)&&(g="R")}else d.bin&&(g="R-RE");const m={field:p,channel:h,type:g};m.signals=Object.assign(Object.assign({},f(m,"data")),f(m,"visual")),o.items.push(l[p]=m),o.hasField[p]=o.hasChannel[h]=l[p]}}else Te(VCe(h))}if(n.init){const h=d=>o.items.map(p=>d[p.channel]!==void 0?d[p.channel]:d[p.field]);if(n.type==="interval")t.init=h(n.init);else{const d=ci(n.init);t.init=d.map(h)}}tr(u)||(o.timeUnit=new $h(null,u))},signals:(e,t,n)=>{const r=t.name+CF;return n.filter(s=>s.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(s=>{const a=it(s,["signals","hasLegend"]);return a.field=Am(a.field),a})})}},BYe={has:e=>e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!Yfe(e.bind),parse:(e,t,n,r)=>{r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,s=t.bind,a=t.init&&t.init[0],o=LYe.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((l,u)=>{var c,f;const h=Dr(`${r}_${l.field}`);n.filter(p=>p.name===h).length||n.unshift(Object.assign(Object.assign({name:h},a?{init:eC(a[u])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${o}[${on(l.field)}] : null`}]:[],bind:(f=(c=s[l.field])!==null&&c!==void 0?c:s[l.channel])!==null&&f!==void 0?f:s}))}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,s=n.filter(u=>u.name===r+ed)[0],a=r+CF,o=i.items.map(u=>Dr(`${r}_${u.field}`)),l=o.map(u=>`${u} !== null`).join(" && ");return o.length&&(s.update=`${l} ? {fields: ${a}, values: [${o.join(", ")}]} : null`),delete s.value,delete s.on,n}},F8="_toggle",zYe={has:e=>e.type==="multi"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+F8,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+ed,r=t.name+F8;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${Sp(e)}}, `)+`${r} ? ${n} : null`}},x4n={has:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t,n)=>{n.clear&&(t.clear=qt(n.clear)?Ox(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if(BYe.has(t))for(const r of t.project.items){const i=n.findIndex(s=>s.name===Dr(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,s){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:s})}if(t.type==="interval")for(const i of t.project.items){const s=n.findIndex(a=>a.name===i.signals.visual);if(r(s,"[0, 0]"),s===-1){const a=n.findIndex(o=>o.name===i.signals.data);r(a,"null")}}else{let i=n.findIndex(s=>s.name===t.name+ed);r(i,"null"),zYe.has(t)&&(i=n.findIndex(s=>s.name===t.name+F8),r(i,"false"))}return n}},Mm={has:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!yv(i))continue;const s=e.getScaleComponent(i),a=s?s.get("type"):void 0;if(!s||!qu(a)){Te(AMn);continue}const o={selection:t.name,field:r.field};s.set("selectionExtent",o,!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(a=>n.filter(o=>o.name===a.signals.data).length===0);if(!e.parent||TJ(e)||r.length===0)return n;const i=n.filter(a=>a.name===t.name)[0];let s=i.update;if(s.indexOf(XYe)>=0)i.update=`{${r.map(a=>`${on(a.field)}: ${a.signals.data}`).join(", ")}}`;else{for(const a of r){const o=`${on(a.field)}: ${a.signals.data}`;s.indexOf(o)<0&&(s=`${s.substring(0,s.length-1)}, ${o}}`)}i.update=s}return n.concat(r.map(a=>({name:a.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!TJ(e))for(const r of t.scales){const i=n.filter(s=>s.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function AJ(e,t){return`domain(${on(e.scaleName(t))})`}function TJ(e){var t;return e.parent&&IS(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:TJ(e.parent.parent))}const UYe={has:e=>{const t=e.resolve==="global"&&e.bind&&Yfe(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==J$;return t&&!n&&Te(TMn),t&&n},parse:(e,t,n,r)=>{var i;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){const o='event.item && indexof(event.item.mark.role, "legend") < 0';for(const l of t.events)l.filter=ci((i=l.filter)!==null&&i!==void 0?i:[]),l.filter.indexOf(o)<0&&l.filter.push(o)}const s=kG(t.bind)?t.bind.legend:"click",a=qt(s)?Ox(s,"view"):ci(s);t.bind={legend:{merge:a}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=kG(t.bind)&&t.bind.legend,s=a=>o=>{const l=Gt(o);return l.markname=a,l};for(const a of t.project.items){if(!a.hasLegend)continue;const o=`${Dr(a.field)}_legend`,l=`${r}_${o}`;if(n.filter(c=>c.name===l).length===0){const c=i.merge.map(s(`${o}_symbols`)).concat(i.merge.map(s(`${o}_labels`))).concat(i.merge.map(s(`${o}_entries`)));n.unshift(Object.assign(Object.assign({name:l},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${l}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,s=n.find(h=>h.name===r+ed),a=r+CF,o=i.items.filter(h=>h.hasLegend).map(h=>Dr(`${r}_${Dr(h.field)}_legend`)),u=`${o.map(h=>`${h} !== null`).join(" && ")} ? {fields: ${a}, values: [${o.join(", ")}]} : null`;t.events&&o.length>0?s.on.push({events:o.map(h=>({signal:h})),update:u}):o.length>0&&(s.update=u,delete s.value,delete s.on);const c=n.find(h=>h.name===r+F8),f=kG(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function w4n(e,t,n){var r;const i=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;Wx(e,s=>{var a,o;const l=(a=s.project.hasField[i])!==null&&a!==void 0?a:s.project.hasChannel[t];if(l&&UYe.has(s)){const u=(o=n.get("selections"))!==null&&o!==void 0?o:[];u.push(s.name),n.set("selections",u,!1),l.hasLegend=!0}})}const WYe="_translate_anchor",VYe="_translate_delta",$4n={has:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=Mm.has(t),s=r+WYe,{x:a,y:o}=t.project.hasChannel;let l=Ox(t.translate,"scope");return i||(l=l.map(u=>(u.between[0].markname=r+jA,u))),n.push({name:s,value:{},on:[{events:l.map(u=>u.between[0]),update:"{x: x(unit), y: y(unit)"+(a!==void 0?", extent_x: "+(i?AJ(e,Ur):`slice(${a.signals.visual})`):"")+(o!==void 0?", extent_y: "+(i?AJ(e,Ii):`slice(${o.signals.visual})`):"")+"}"}]},{name:r+VYe,value:{},on:[{events:l,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),a!==void 0&&v_e(e,t,a,"width",n),o!==void 0&&v_e(e,t,o,"height",n),n}};function v_e(e,t,n,r,i){var s;const a=t.name,o=a+WYe,l=a+VYe,u=n.channel,c=Mm.has(t),f=i.filter(x=>x.name===n.signals[c?"data":"visual"])[0],h=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(u),p=d.get("type"),g=c&&u===Ur?"-":"",m=`${o}.extent_${u}`,v=`${g}${l}.${u} / `+(c?`${h}`:`span(${m})`),b=`${c?p==="log"?"panLog":p==="pow"?"panPow":"panLinear":"panLinear"}(${m}, ${v}`+(c&&p==="pow"?`, ${(s=d.get("exponent"))!==null&&s!==void 0?s:1}`:"")+")";f.on.push({events:{signal:l},update:c?b:`clampRange(${b}, 0, ${h})`})}const jYe="_zoom_anchor",HYe="_zoom_delta",C4n={has:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=Mm.has(t),s=r+HYe,{x:a,y:o}=t.project.hasChannel,l=on(e.scaleName(Ur)),u=on(e.scaleName(Ii));let c=Ox(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+jA,f))),n.push({name:r+jYe,on:[{events:c,update:i?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),a!==void 0&&y_e(e,t,a,"width",n),o!==void 0&&y_e(e,t,o,"height",n),n}};function y_e(e,t,n,r,i){var s;const a=t.name,o=n.channel,l=Mm.has(t),u=i.filter(y=>y.name===n.signals[l?"data":"visual"])[0],c=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(o),h=f.get("type"),d=l?AJ(e,o):u.name,p=a+HYe,g=`${a}${jYe}.${o}`,v=`${l?h==="log"?"zoomLog":h==="pow"?"zoomPow":"zoomLinear":"zoomLinear"}(${d}, ${g}, ${p}`+(l&&h==="pow"?`, ${(s=f.get("exponent"))!==null&&s!==void 0?s:1}`:"")+")";u.on.push({events:{signal:p},update:l?v:`clampRange(${v}, 0, ${c})`})}const _4n=[b4n,zYe,Mm,UYe,$4n,C4n,BYe,LYe,x4n];function tV(e,t){for(const n of _4n)n.has(e)&&t(n)}function eC(e,t=!0,n=yIn){if(ut(e)){const r=e.map(i=>eC(i,t,n));return t?`[${r.join(", ")}]`:r}else if(SS(e))return n(t?PD(e):AFn(e));return t?n(JSON.stringify(e)):e}function S4n(e,t){return Wx(e,(n,r)=>{const i=n.name;let s=r.modifyExpr(e,n);t.push(...r.signals(e,n)),tV(n,a=>{a.signals&&(t=a.signals(e,n,t)),a.modifyExpr&&(s=a.modifyExpr(e,n,s))}),t.push({name:i+O4n,on:[{events:{signal:n.name+ed},update:`modify(${on(n.name+kb)}, ${s})`}]})}),nhe(t)}function k4n(e,t){if(e.component.selection&&Ie(e.component.selection).length){const n=on(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Ox("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return nhe(t)}function E4n(e,t){let n=!1;return Wx(e,(r,i)=>{const s=r.name,a=on(s+kb);if(t.filter(l=>l.name===s).length===0){const l=r.resolve==="global"?"union":r.resolve,u=r.type==="multi"?", true)":")";t.push({name:r.name,update:`${XYe}(${a}, ${on(l)}${u}`})}n=!0,i.topLevelSignals&&(t=i.topLevelSignals(e,r,t)),tV(r,l=>{l.topLevelSignals&&(t=l.topLevelSignals(e,r,t))})}),n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),nhe(t)}function A4n(e,t){const n=[...t];return Wx(e,r=>{const i={name:r.name+kb};if(r.init){const a=r.project.items.map(l=>it(l,["signals"])),o=r.init.map(l=>eC(l,!1));i.values=r.type==="interval"?[{unit:Sp(e,{escape:!1}),fields:a,values:o}]:o.map(l=>({unit:Sp(e,{escape:!1}),fields:a,values:l}))}n.filter(a=>a.name===r.name+kb).length||n.push(i)}),n}function qYe(e,t){return Wx(e,(n,r)=>{t=r.marks?r.marks(e,n,t):t,tV(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function T4n(e,t){for(const n of e.children)qr(n)&&(t=qYe(n,t));return t}function D4n(e,t){const n=t.selection,r=e.getSelectionComponent(n,Dr(n));return{signal:sXe(r,t)}}function nhe(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const jA="_brush",DJ="_scale_trigger",N4n={signals:(e,t)=>{const n=t.name,r=n+CF,i=Mm.has(t),s=[],a=[],o=[];if(t.translate&&!i){const c=`!event.item || event.item.mark.name !== ${on(n+jA)}`;GYe(t,(f,h)=>{var d;const p=ci((d=h.between[0].filter)!==null&&d!==void 0?d:h.between[0].filter=[]);return p.indexOf(c)<0&&p.push(c),f})}t.project.items.forEach((c,f)=>{const h=c.channel;if(h!==Ur&&h!==Ii){Te("Interval selections only support x and y encoding channels.");return}const d=t.init?t.init[f]:null,p=I4n(e,t,c,d),g=c.signals.data,m=c.signals.visual,v=on(e.scaleName(h)),y=e.getScaleComponent(h).get("type"),b=qu(y)?"+":"";s.push(...p),a.push(g),o.push({scaleName:e.scaleName(h),expr:`(!isArray(${g}) || (${b}invert(${v}, ${m})[0] === ${b}${g}[0] && ${b}invert(${v}, ${m})[1] === ${b}${g}[1]))`})}),i||s.push({name:n+DJ,value:{},on:[{events:o.map(c=>({scale:c.scaleName})),update:o.map(c=>c.expr).join(" && ")+` ? ${n+DJ} : {}`}]});const l=t.init,u=`unit: ${Sp(e)}, fields: ${r}, values`;return s.concat(Object.assign(Object.assign({name:n+ed},l?{init:`{${u}: ${eC(l)}}`}:{}),{on:[{events:[{signal:a.join(" || ")}],update:a.join(" && ")+` ? {${u}: [${a}]} : null`}]}))},modifyExpr:(e,t)=>t.name+ed+", "+(t.resolve==="global"?"true":`{unit: ${Sp(e)}}`),marks:(e,t,n)=>{const r=t.name,{x:i,y:s}=t.project.hasChannel,a=i&&i.signals.visual,o=s&&s.signals.visual,l=`data(${on(t.name+kb)})`;if(Mm.has(t))return n;const u={x:i!==void 0?{signal:`${a}[0]`}:{value:0},y:s!==void 0?{signal:`${o}[0]`}:{value:0},x2:i!==void 0?{signal:`${a}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${o}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of Ie(u))u[m]=[Object.assign({test:`${l}.length && ${l}[0].unit === ${Sp(e)}`},u[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:h,cursor:d}=c,p=it(c,["fill","fillOpacity","cursor"]),g=Ie(p).reduce((m,v)=>(m[v]=[{test:[i!==void 0&&`${a}[0] !== ${a}[1]`,s!==void 0&&`${o}[0] !== ${o}[1]`].filter(y=>y).join(" && "),value:p[v]},{value:null}],m),{});return[{name:r+jA+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:h}},update:u}},...n,{name:r+jA,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},d?{cursor:{value:d}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},u),g)}}]}};function I4n(e,t,n,r){const i=n.channel,s=n.signals.visual,a=n.signals.data,o=Mm.has(t),l=on(e.scaleName(i)),u=e.getScaleComponent(i),c=u?u.get("type"):void 0,f=g=>`scale(${l}, ${g})`,h=e.getSizeSignalRef(i===Ur?"width":"height").signal,d=`${i}(unit)`,p=GYe(t,(g,m)=>[...g,{events:m.between[0],update:`[${d}, ${d}]`},{events:m,update:`[${s}[0], clamp(${d}, 0, ${h})]`}]);return p.push({events:{signal:t.name+DJ},update:qu(c)?`[${f(`${a}[0]`)}, ${f(`${a}[1]`)}]`:"[0, 0]"}),o?[{name:a,on:[]}]:[Object.assign(Object.assign({name:s},r?{init:eC(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:a},r?{init:eC(r)}:{}),{on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${l}, ${s})`}]})]}function GYe(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):(Te(`${r} is not an ordered event stream for interval selections.`),n),[])}function YYe(e,t){const n=t.name,r=n+CF,i=t.project,s="(item().isVoronoi ? datum.datum : datum)",a=i.items.map(u=>{const c=e.fieldDef(u.channel);return c&&c.bin?`[${s}[${on(e.vgField(u.channel,{}))}], ${s}[${on(e.vgField(u.channel,{binSuffix:"end"}))}]]`:`${s}[${on(u.field)}]`}).join(", "),o=`unit: ${Sp(e)}, fields: ${r}, values`,l=t.events;return[{name:n+ed,on:l?[{events:l,update:`datum && item().mark.marktype !== 'group' ? {${o}: [${a}]} : null`,force:!0}]:[]}]}const M4n={signals:YYe,modifyExpr:(e,t)=>t.name+ed+", "+(t.resolve==="global"?"null":`{unit: ${Sp(e)}}`)},F4n={signals:YYe,modifyExpr:(e,t)=>t.name+ed+", "+(t.resolve==="global"?"true":`{unit: ${Sp(e)}}`)},kb="_store",ed="_tuple",O4n="_modify",XYe="vlSelectionResolve",R4n={single:F4n,multi:M4n,interval:N4n};function Wx(e,t){const n=e.component.selection;if(n){for(const r of D0(n))if(t(r,R4n[r.type])===!0)break}}function P4n(e){let t=e.parent;for(;t&&!qc(t);)t=t.parent;return t}function Sp(e,{escape:t}={escape:!0}){let n=t?on(e.name):e.name;const r=P4n(e);if(r){const{facet:i}=r;for(const s of Au)i[s]&&(n+=` + '__facet_${s}_' + (facet[${on(r.vgField(s))}])`)}return n}function rhe(e){let t=!1;return Wx(e,n=>{t=t||n.project.items.some(r=>r.field===J$)}),t}const L4n="RawCode",B4n="Literal",z4n="Property",U4n="Identifier",W4n="ArrayExpression",V4n="BinaryExpression",j4n="CallExpression",H4n="ConditionalExpression",q4n="LogicalExpression",G4n="MemberExpression",Y4n="ObjectExpression",X4n="UnaryExpression";function Sf(e){this.type=e}Sf.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=K4n(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function K4n(e){switch(e.type){case W4n:return e.elements;case V4n:case q4n:return[e.left,e.right];case j4n:return[e.callee].concat(e.arguments);case H4n:return[e.test,e.consequent,e.alternate];case G4n:return[e.object,e.property];case Y4n:return e.properties;case z4n:return[e.key,e.value];case X4n:return[e.argument];case U4n:case B4n:case L4n:default:return[]}}var kd,Ke,we,Aa,Wn,nV=1,_F=2,Eb=3,wv=4,rV=5,Vx=6,Lo=7,SF=8,Z4n=9;kd={};kd[nV]="Boolean";kd[_F]="<end>";kd[Eb]="Identifier";kd[wv]="Keyword";kd[rV]="Null";kd[Vx]="Numeric";kd[Lo]="Punctuator";kd[SF]="String";kd[Z4n]="RegularExpression";var Q4n="ArrayExpression",J4n="BinaryExpression",e5n="CallExpression",t5n="ConditionalExpression",KYe="Identifier",n5n="Literal",r5n="LogicalExpression",i5n="MemberExpression",s5n="ObjectExpression",a5n="Property",o5n="UnaryExpression",Bs="Unexpected token %0",l5n="Unexpected number",u5n="Unexpected string",c5n="Unexpected identifier",f5n="Unexpected reserved word",h5n="Unexpected end of input",NJ="Invalid regular expression",DG="Invalid regular expression: missing /",ZYe="Octal literals are not allowed in strict mode.",d5n="Duplicate data property in object literal not allowed in strict mode",ba="ILLEGAL",WD="Disabled.",p5n=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),g5n=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function iV(e,t){if(!e)throw new Error("ASSERT: "+t)}function Hd(e){return e>=48&&e<=57}function ihe(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function HA(e){return"01234567".indexOf(e)>=0}function m5n(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function VD(e){return e===10||e===13||e===8232||e===8233}function kF(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&p5n.test(String.fromCharCode(e))}function O8(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&g5n.test(String.fromCharCode(e))}var v5n={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function QYe(){for(var e;we<Aa&&(e=Ke.charCodeAt(we),m5n(e)||VD(e));)++we}function IJ(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)we<Aa&&ihe(Ke[we])?(r=Ke[we++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):An({},Bs,ba);return String.fromCharCode(i)}function y5n(){var e,t,n,r;for(e=Ke[we],t=0,e==="}"&&An({},Bs,ba);we<Aa&&(e=Ke[we++],!!ihe(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&An({},Bs,ba),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function JYe(){var e,t;for(e=Ke.charCodeAt(we++),t=String.fromCharCode(e),e===92&&(Ke.charCodeAt(we)!==117&&An({},Bs,ba),++we,e=IJ("u"),(!e||e==="\\"||!kF(e.charCodeAt(0)))&&An({},Bs,ba),t=e);we<Aa&&(e=Ke.charCodeAt(we),!!O8(e));)++we,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Ke.charCodeAt(we)!==117&&An({},Bs,ba),++we,e=IJ("u"),(!e||e==="\\"||!O8(e.charCodeAt(0)))&&An({},Bs,ba),t+=e);return t}function b5n(){var e,t;for(e=we++;we<Aa;){if(t=Ke.charCodeAt(we),t===92)return we=e,JYe();if(O8(t))++we;else break}return Ke.slice(e,we)}function x5n(){var e,t,n;return e=we,t=Ke.charCodeAt(we)===92?JYe():b5n(),t.length===1?n=Eb:v5n.hasOwnProperty(t)?n=wv:t==="null"?n=rV:t==="true"||t==="false"?n=nV:n=Eb,{type:n,value:t,start:e,end:we}}function NG(){var e=we,t=Ke.charCodeAt(we),n,r=Ke[we],i,s,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++we,{type:Lo,value:String.fromCharCode(t),start:e,end:we};default:if(n=Ke.charCodeAt(we+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return we+=2,{type:Lo,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:we};case 33:case 61:return we+=2,Ke.charCodeAt(we)===61&&++we,{type:Lo,value:Ke.slice(e,we),start:e,end:we}}}if(a=Ke.substr(we,4),a===">>>=")return we+=4,{type:Lo,value:a,start:e,end:we};if(s=a.substr(0,3),s===">>>"||s==="<<="||s===">>=")return we+=3,{type:Lo,value:s,start:e,end:we};if(i=s.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return we+=2,{type:Lo,value:i,start:e,end:we};if("<>=!+-*%&|^/".indexOf(r)>=0)return++we,{type:Lo,value:r,start:e,end:we};An({},Bs,ba)}function w5n(e){for(var t="";we<Aa&&ihe(Ke[we]);)t+=Ke[we++];return t.length===0&&An({},Bs,ba),kF(Ke.charCodeAt(we))&&An({},Bs,ba),{type:Vx,value:parseInt("0x"+t,16),start:e,end:we}}function $5n(e){for(var t="0"+Ke[we++];we<Aa&&HA(Ke[we]);)t+=Ke[we++];return(kF(Ke.charCodeAt(we))||Hd(Ke.charCodeAt(we)))&&An({},Bs,ba),{type:Vx,value:parseInt(t,8),octal:!0,start:e,end:we}}function b_e(){var e,t,n;if(n=Ke[we],iV(Hd(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=we,e="",n!=="."){if(e=Ke[we++],n=Ke[we],e==="0"){if(n==="x"||n==="X")return++we,w5n(t);if(HA(n))return $5n(t);n&&Hd(n.charCodeAt(0))&&An({},Bs,ba)}for(;Hd(Ke.charCodeAt(we));)e+=Ke[we++];n=Ke[we]}if(n==="."){for(e+=Ke[we++];Hd(Ke.charCodeAt(we));)e+=Ke[we++];n=Ke[we]}if(n==="e"||n==="E")if(e+=Ke[we++],n=Ke[we],(n==="+"||n==="-")&&(e+=Ke[we++]),Hd(Ke.charCodeAt(we)))for(;Hd(Ke.charCodeAt(we));)e+=Ke[we++];else An({},Bs,ba);return kF(Ke.charCodeAt(we))&&An({},Bs,ba),{type:Vx,value:parseFloat(e),start:t,end:we}}function C5n(){var e="",t,n,r,i,s=!1;for(t=Ke[we],iV(t==="'"||t==='"',"String literal must starts with a quote"),n=we,++we;we<Aa;)if(r=Ke[we++],r===t){t="";break}else if(r==="\\")if(r=Ke[we++],!r||!VD(r.charCodeAt(0)))switch(r){case"u":case"x":Ke[we]==="{"?(++we,e+=y5n()):e+=IJ(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:HA(r)?(i="01234567".indexOf(r),i!==0&&(s=!0),we<Aa&&HA(Ke[we])&&(s=!0,i=i*8+"01234567".indexOf(Ke[we++]),"0123".indexOf(r)>=0&&we<Aa&&HA(Ke[we])&&(i=i*8+"01234567".indexOf(Ke[we++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&Ke[we]===`
`&&++we;else{if(VD(r.charCodeAt(0)))break;e+=r}return t!==""&&An({},Bs,ba),{type:SF,value:e,octal:s,start:n,end:we}}function _5n(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(r,i){if(parseInt(i,16)<=1114111)return"x";An({},NJ)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{An({},NJ)}try{return new RegExp(e,t)}catch{return null}}function S5n(){var e,t,n,r,i;for(e=Ke[we],iV(e==="/","Regular expression literal must start with a slash"),t=Ke[we++],n=!1,r=!1;we<Aa;)if(e=Ke[we++],t+=e,e==="\\")e=Ke[we++],VD(e.charCodeAt(0))&&An({},DG),t+=e;else if(VD(e.charCodeAt(0)))An({},DG);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||An({},DG),i=t.substr(1,t.length-2),{value:i,literal:t}}function k5n(){var e,t,n;for(t="",n="";we<Aa&&(e=Ke[we],!!O8(e.charCodeAt(0)));)++we,e==="\\"&&we<Aa?An({},Bs,ba):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&An({},NJ,n),{value:n,literal:t}}function E5n(){var e,t,n,r;return Wn=null,QYe(),e=we,t=S5n(),n=k5n(),r=_5n(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:we}}function A5n(e){return e.type===Eb||e.type===wv||e.type===nV||e.type===rV}function eXe(){var e;return QYe(),we>=Aa?{type:_F,start:we,end:we}:(e=Ke.charCodeAt(we),kF(e)?x5n():e===40||e===41||e===59?NG():e===39||e===34?C5n():e===46?Hd(Ke.charCodeAt(we+1))?b_e():NG():Hd(e)?b_e():NG())}function qo(){var e;return e=Wn,we=e.end,Wn=eXe(),we=e.end,e}function tXe(){var e;e=we,Wn=eXe(),we=e}function T5n(e){var t=new Sf(Q4n);return t.elements=e,t}function x_e(e,t,n){var r=new Sf(e==="||"||e==="&&"?r5n:J4n);return r.operator=e,r.left=t,r.right=n,r}function D5n(e,t){var n=new Sf(e5n);return n.callee=e,n.arguments=t,n}function N5n(e,t,n){var r=new Sf(t5n);return r.test=e,r.consequent=t,r.alternate=n,r}function she(e){var t=new Sf(KYe);return t.name=e,t}function JE(e){var t=new Sf(n5n);return t.value=e.value,t.raw=Ke.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function w_e(e,t,n){var r=new Sf(i5n);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function I5n(e){var t=new Sf(s5n);return t.properties=e,t}function $_e(e,t,n){var r=new Sf(a5n);return r.key=t,r.value=n,r.kind=e,r}function M5n(e,t){var n=new Sf(o5n);return n.operator=e,n.argument=t,n.prefix=!0,n}function An(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(s,a){return iV(a<r.length,"Message reference must be in range"),r[a]});throw n=new Error(i),n.index=we,n.description=i,n}function sV(e){e.type===_F&&An(e,h5n),e.type===Vx&&An(e,l5n),e.type===SF&&An(e,u5n),e.type===Eb&&An(e,c5n),e.type===wv&&An(e,f5n),An(e,Bs,e.value)}function Ta(e){var t=qo();(t.type!==Lo||t.value!==e)&&sV(t)}function mr(e){return Wn.type===Lo&&Wn.value===e}function IG(e){return Wn.type===wv&&Wn.value===e}function F5n(){var e=[];for(we=Wn.start,Ta("[");!mr("]");)mr(",")?(qo(),e.push(null)):(e.push(Ab()),mr("]")||Ta(","));return qo(),T5n(e)}function C_e(){var e;return we=Wn.start,e=qo(),e.type===SF||e.type===Vx?(e.octal&&An(e,ZYe),JE(e)):she(e.value)}function O5n(){var e,t,n,r;if(we=Wn.start,e=Wn,e.type===Eb)return n=C_e(),Ta(":"),r=Ab(),$_e("init",n,r);if(e.type===_F||e.type===Lo)sV(e);else return t=C_e(),Ta(":"),r=Ab(),$_e("init",t,r)}function R5n(){var e=[],t,n,r,i={},s=String;for(we=Wn.start,Ta("{");!mr("}");)t=O5n(),t.key.type===KYe?n=t.key.name:n=s(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?An({},d5n):i[r]=!0,e.push(t),mr("}")||Ta(",");return Ta("}"),I5n(e)}function P5n(){var e;return Ta("("),e=ahe(),Ta(")"),e}var L5n={if:1};function B5n(){var e,t,n;if(mr("("))return P5n();if(mr("["))return F5n();if(mr("{"))return R5n();if(e=Wn.type,we=Wn.start,e===Eb||L5n[Wn.value])n=she(qo().value);else if(e===SF||e===Vx)Wn.octal&&An(Wn,ZYe),n=JE(qo());else{if(e===wv)throw new Error(WD);e===nV?(t=qo(),t.value=t.value==="true",n=JE(t)):e===rV?(t=qo(),t.value=null,n=JE(t)):mr("/")||mr("/=")?(n=JE(E5n()),tXe()):sV(qo())}return n}function z5n(){var e=[];if(Ta("("),!mr(")"))for(;we<Aa&&(e.push(Ab()),!mr(")"));)Ta(",");return Ta(")"),e}function U5n(){var e;return we=Wn.start,e=qo(),A5n(e)||sV(e),she(e.value)}function W5n(){return Ta("."),U5n()}function V5n(){var e;return Ta("["),e=ahe(),Ta("]"),e}function j5n(){var e,t,n;for(e=B5n();;)if(mr("."))n=W5n(),e=w_e(".",e,n);else if(mr("("))t=z5n(),e=D5n(e,t);else if(mr("["))n=V5n(),e=w_e("[",e,n);else break;return e}function __e(){var e=j5n();if(Wn.type===Lo&&(mr("++")||mr("--")))throw new Error(WD);return e}function e5(){var e,t;if(Wn.type!==Lo&&Wn.type!==wv)t=__e();else{if(mr("++")||mr("--"))throw new Error(WD);if(mr("+")||mr("-")||mr("~")||mr("!"))e=qo(),t=e5(),t=M5n(e.value,t);else{if(IG("delete")||IG("void")||IG("typeof"))throw new Error(WD);t=__e()}}return t}function S_e(e){var t=0;if(e.type!==Lo&&e.type!==wv)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function H5n(){var e,t,n,r,i,s,a,o,l,u;if(e=Wn,l=e5(),r=Wn,i=S_e(r),i===0)return l;for(r.prec=i,qo(),t=[e,Wn],a=e5(),s=[l,r,a];(i=S_e(Wn))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)a=s.pop(),o=s.pop().value,l=s.pop(),t.pop(),n=x_e(o,l,a),s.push(n);r=qo(),r.prec=i,s.push(r),t.push(Wn),n=e5(),s.push(n)}for(u=s.length-1,n=s[u],t.pop();u>1;)t.pop(),n=x_e(s[u-1].value,s[u-2],n),u-=2;return n}function Ab(){var e,t,n;return e=H5n(),mr("?")&&(qo(),t=Ab(),Ta(":"),n=Ab(),e=N5n(e,t,n)),e}function ahe(){var e=Ab();if(mr(","))throw new Error(WD);return e}function q5n(e){Ke=e,we=0,Aa=Ke.length,Wn=null,tXe();var t=ahe();if(Wn.type!==_F)throw new Error("Unexpect token after expression.");return t}function AS(e,t,n){return e.fields=t||[],e.fname=n,e}function G5n(e){return e.length===1?Y5n(e[0]):X5n(e)}const Y5n=e=>function(t){return t[e]},X5n=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function MG(e){throw Error(e)}function K5n(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||MG("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&MG("Access path missing closing bracket: "+e),r&&MG("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function Z5n(e,t,n){const r=K5n(e);return e=r.length===1?r[0]:e,AS((n&&n.get||G5n)(r),[e],t||e)}Z5n("id");AS(e=>e,[],"identity");AS(()=>0,[],"zero");AS(()=>1,[],"one");AS(()=>!0,[],"true");AS(()=>!1,[],"false");function MJ(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...MJ(e.object)),t.push(...MJ(e.property))),t)}function nXe(e){return e.object.type==="MemberExpression"?nXe(e.object):e.object.name==="datum"}function rXe(e){const t=q5n(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&nXe(r)&&n.add(MJ(r).slice(1).join("."))}),n}class TS extends Zn{constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=R8(this.model,this.filter,this),this._dependentFields=rXe(this.expr)}clone(){return new TS(null,this.model,Gt(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function Q5n(e,t){var n;const r={},i=e.config.selection;for(const s of Ie(t!=null?t:{})){const a=Gt(t[s]),o=i[a.type],l=it(o,["fields","encodings"]);for(const f in l)f==="encodings"&&a.fields||f==="fields"&&a.encodings||(f==="mark"&&(a[f]=Object.assign(Object.assign({},l[f]),a[f])),(a[f]===void 0||a[f]===!0)&&(a[f]=(n=l[f])!==null&&n!==void 0?n:a[f]));const u=Dr(s),c=r[u]=Object.assign(Object.assign({},a),{name:u,events:qt(a.on)?Ox(a.on,"scope"):Gt(a.on)});tV(c,f=>{f.has(c)&&f.parse&&f.parse(e,c,a,t[s])})}return r}function iXe(e,t,n,r="datum"){const i=[];function s(o){const l=Dr(o),u=e.getSelectionComponent(l,o),c=on(l+kb);if(u.project.timeUnit){const f=n!=null?n:e.component.data.raw,h=u.project.timeUnit.clone();f.parent?h.insertAsParentOf(f):f.parent=h}return u.empty!=="none"&&i.push(c),`vlSelectionTest(${c}, ${r}`+(u.resolve==="global"?")":`, ${on(u.resolve)})`)}const a=WA(t,s);return(i.length?"!("+i.map(o=>`length(data(${o}))`).join(" || ")+") || ":"")+`(${a})`}function sXe(e,t){const n=t.encoding;let r=t.field;if(!n&&!r)r=e.project.items[0].field,e.project.items.length>1&&Te(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${on(r)}.`);else if(n&&!r){const i=e.project.items.filter(s=>s.channel===n);!i.length||i.length>1?(r=e.project.items[0].field,Te((i.length?"Multiple ":"No ")+`matching ${on(n)} encoding found for selection ${on(t.selection)}. Using "field": ${on(r)}.`)):r=i[0].field}return`${e.name}[${on(r)}]`}function J5n(e,t){Wx(e,n=>{const r=n.name,i=e.getName(`lookup_${r}`);e.component.data.outputNodes[i]=n.materialized=new ho(new TS(t,e,{selection:r}),i,"lookup",e.component.data.outputNodeRefCounts)})}function R8(e,t,n){return WA(t,r=>qt(r)?r:zFn(r)?iXe(e,r.selection,n):EGe(r))}function ePn(e,t){if(!!e)return ut(e)&&!Vg(e)?e.map(n=>QGe(n,t)).join(", "):e}function FG(e,t,n,r){var i,s,a;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(s=e.encode[t])!==null&&s!==void 0?s:{},e.encode[t].update=(a=e.encode[t].update)!==null&&a!==void 0?a:{},e.encode[t].update[n]=r}function eA(e,t,n,r={header:!1}){var i,s;const a=e.combine(),{disable:o,orient:l,scale:u,labelExpr:c,title:f,zindex:h}=a,d=it(a,["disable","orient","scale","labelExpr","title","zindex"]);if(!o){for(const p in d){const g=LIn[p],m=d[p];if(g&&g!==t&&g!=="both")delete d[p];else if(ufe(m)){const{condition:v}=m,y=it(m,["condition"]),b=ci(v),x=OCe[p];if(x){const{vgProp:w,part:C}=x,$=[...b.map(_=>{const{test:k}=_,E=it(_,["test"]);return Object.assign({test:R8(null,k)},E)}),y];FG(d,C,w,$),delete d[p]}else if(x===null){const w={signal:b.map(C=>{const{test:$}=C,_=it(C,["test"]);return`${R8(null,$)} ? ${JCe(_)} : `}).join("")+JCe(y)};d[p]=w}}else if(wt(m)){const v=OCe[p];if(v){const{vgProp:y,part:b}=v;FG(d,b,y,m),delete d[p]}}}if(t==="grid"){if(!d.grid)return;if(d.encode){const{grid:p}=d.encode;d.encode=Object.assign({},p?{grid:p}:{}),tr(d.encode)&&delete d.encode}return Object.assign(Object.assign({scale:u,orient:l},d),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:bi(h,0)})}else{if(!r.header&&e.mainExtracted)return;if(c!==void 0){let g=c;((s=(i=d.encode)===null||i===void 0?void 0:i.labels)===null||s===void 0?void 0:s.update)&&wt(d.encode.labels.update.text)&&(g=K$(c,"datum.label",d.encode.labels.update.text.signal)),FG(d,"labels","text",{signal:g})}if(d.labelAlign===null&&delete d.labelAlign,d.encode){for(const g of Hqe)e.hasAxisPart(g)||delete d.encode[g];tr(d.encode)&&delete d.encode}const p=ePn(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:u,orient:l,grid:!1},p?{title:p}:{}),d),n.aria===!1?{aria:!1}:{}),{zindex:bi(h,0)})}}}function aXe(e){const{axes:t}=e.component,n=[];for(const r of Hu)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const s=r==="x"?"height":"width",a=e.getSizeSignalRef(s).signal;s!==a&&n.push({name:s,update:a})}}return n}function tPn(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>eA(i,"grid",t)),...r.map(i=>eA(i,"grid",t)),...n.map(i=>eA(i,"main",t)),...r.map(i=>eA(i,"main",t))].filter(i=>i)}const oXe={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},lXe={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},nPn=Ie(oXe),rPn=Ie(lXe);function k_e(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const s=n==="x"?"bottom":"left",a=t[n==="x"?"axisBottom":"axisLeft"]||{},o=t[n==="x"?"axisTop":"axisRight"]||{},l=new Set([...Ie(a),...Ie(o)]),u={};for(const c of l.values())u[c]={signal:`${r.signal} === "${s}" ? ${LD(a[c])} : ${LD(o[c])}`};return u}return t[i]})])}function iPn(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:QFn(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],s=e==="x"?"axisX":"axisY",a=wt(n)?"axisOrient":"axis"+DW(n),o=[...i,...i.map(u=>s+u.substr(4))],l=["axis",a,s];return{vlOnlyAxisConfig:k_e(o,r,e,n),vgAxisConfig:k_e(l,r,e,n),axisConfigStyle:sPn([...l,...o],r)}}function sPn(e,t){var n;const r=[{}];for(const i of e){let s=(n=t[i])===null||n===void 0?void 0:n.style;if(s){s=ci(s);for(const a of s)r.push(t.style[a])}}return Object.assign.apply(null,r)}function FJ(e,t,n,r={}){var i;const s=rYe(e,n,t.style);if(s!==void 0)return{configFrom:"style",configValue:s};for(const a of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((i=r[a])===null||i===void 0?void 0:i[e])!==void 0)return{configFrom:a,configValue:r[a][e]};return{}}const E_e={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return LGe(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return BGe(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return Le(e)&&to(e.bin)?!1:(r=t.grid)!==null&&r!==void 0?r:aPn(n,e)},gridScale:({model:e,channel:t})=>oPn(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||cXe(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||uXe(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return(r=e.labelFlush)!==null&&r!==void 0?r:uPn(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return(r=e.labelOverlap)!==null&&r!==void 0?r:cPn(t.type,n)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var s;const a=e==="x"?"width":e==="y"?"height":void 0,o=a?t.getSizeSignalRef(a):void 0;return(s=n.tickCount)!==null&&s!==void 0?s:hPn({fieldOrDatumDef:r,scaleType:i,size:o,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=fXe(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),s=n==="x"?"x2":"y2",a=t.fieldDef(s);return sYe(i?[QCe(i)]:[],Le(a)?[QCe(a)]:[])},values:({axis:e,fieldOrDatumDef:t})=>dPn(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return(r=e.zindex)!==null&&r!==void 0?r:pPn(n,t)}};function aPn(e,t){return!pl(e)&&Le(t)&&!hr(t==null?void 0:t.bin)}function oPn(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function lPn(e,t,n,r,i){const s=t==null?void 0:t.labelAngle;if(s!==void 0)return wt(s)?s:w8(s);{const{configValue:a}=FJ("labelAngle",e.config,t==null?void 0:t.style,i);return a!==void 0?w8(a):n===Ur&&ht([Afe,Efe],r.type)?270:void 0}}function OJ(e){return`(((${e.signal} % 360) + 360) % 360)`}function uXe(e,t,n,r){if(e!==void 0)if(n==="x"){if(wt(e)){const i=OJ(e),s=wt(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${s} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(wt(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(wt(e)){const i=OJ(e),s=wt(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${s} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(wt(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function cXe(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,s=r?"bottom":"left";if(wt(e)){const a=OJ(e),o=wt(t)?`(${t.signal} === "${s}")`:t===s;return{signal:`(${i?"("+a+" + 90)":a} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${a} && ${a} < ${180+i}) === ${o} ? "left" : "right"`}}if((e+i)%180===0)return r?null:"center";if(wt(t)){const a=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${a} "${s}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===s)?"left":"right"}function uPn(e,t){if(t==="x"&&ht(["quantitative","temporal"],e))return!0}function cPn(e,t){if(e!=="nominal")return t==="log"?"greedy":!0}function fPn(e){return e==="x"?"bottom":"left"}function hPn({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!pl(t)&&t!=="log"){if(Le(e)){if(hr(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&ht(["month","hours","day","quarter"],(i=Co(e.timeUnit))===null||i===void 0?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function fXe(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),s=r?r.title:void 0,a=i?i.title:void 0;if(s&&a)return aYe(s,a);if(s)return s;if(a)return a;if(s!==void 0)return s;if(a!==void 0)return a}function dPn(e,t){const n=e.values;if(ut(n))return eYe(t,n);if(wt(n))return n}function pPn(e,t){return e==="rect"&&GGe(t)?1:0}class tC extends Zn{constructor(t,n){super(t),this.transform=n,this._dependentFields=rXe(this.transform.calculate)}clone(){return new tC(null,Gt(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(!!Pfe(r)&&VGe(r.sort)){const{field:s,timeUnit:a}=r,o=r.sort,l=o.map((u,c)=>`${EGe({field:s,timeUnit:a,equal:u})} ? ${c} : `).join("")+o.length;t=new tC(t,{calculate:l,as:nC(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${gn(this.transform)}`}}function nC(e,t,n){return Me(e,Object.assign({prefix:t,suffix:"sort_index"},n!=null?n:{}))}function aV(e,t){return ht(["top","bottom"],t)?"column":ht(["left","right"],t)||e==="row"?"row":"column"}function rC(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return bi(((t==null?void 0:t.header)||{})[e],i[e],n.header[e])}function oV(e,t,n,r){const i={};for(const s of e){const a=rC(s,t,n,r);a!==void 0&&(i[s]=a)}return i}const ohe=["row","column"],lhe=["header","footer"];function gPn(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:a,titleOrient:o}=oV(["titleAnchor","titleAngle","titleOrient"],i,r,t),l=aV(t,o),u=w8(a);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),dXe(u,l)),hXe(l,u,s)),pXe(r,i,t,nPn,oXe))}}function hXe(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=cXe(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function dXe(e,t){const n=uXe(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function mPn(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of lhe)if(n[i])for(const s of n[i]){const a=yPn(e,t,i,n,s);a!=null&&r.push(a)}return r}function vPn(e,t){var n;const{sort:r}=e;return wh(r)?{field:Me(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}:ut(r)?{field:nC(e,t,{expr:"datum"}),order:"ascending"}:{field:Me(e,{expr:"datum"}),order:r!=null?r:"ascending"}}function RJ(e,t,n){const{format:r,formatType:i,labelAngle:s,labelAnchor:a,labelOrient:o,labelExpr:l}=oV(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),u=Nfe({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=aV(t,o);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:l?K$(K$(l,"datum.label",u),"datum.value",Me(e,{expr:"parent"})):u}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),dXe(s,c)),hXe(c,s,a)),pXe(n,e,t,rPn,lXe))}function yPn(e,t,n,r,i){if(i){let s=null;const{facetFieldDef:a}=r,o=e.config?e.config:void 0;if(a&&i.labels){const{labelOrient:f}=oV(["labelOrient"],a,o,t);(t==="row"&&!ht(["top","bottom"],f)||t==="column"&&!ht(["left","right"],f))&&(s=RJ(a,t,o))}const l=qc(e)&&!bF(e.facet),u=i.axes,c=(u==null?void 0:u.length)>0;if(s||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:vPn(a,t)}:{}),c&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),s?{title:s}:{}),i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{}),c?{axes:u}:{})}}return null}const bPn={column:{start:0,end:1},row:{start:1,end:0}};function xPn(e,t){return bPn[t][e]}function wPn(e,t){const n={};for(const r of Au){const i=e[r];if(i!=null&&i.facetFieldDef){const{titleAnchor:s,titleOrient:a}=oV(["titleAnchor","titleOrient"],i.facetFieldDef,t,r),o=aV(r,a),l=xPn(s,o);l!==void 0&&(n[o]=l)}}return tr(n)?void 0:n}function pXe(e,t,n,r,i){const s={};for(const a of r){if(!i[a])continue;const o=rC(a,t,e,n);o!==void 0&&(s[i[a]]=o)}return s}function uhe(e){return[...RR(e,"width"),...RR(e,"height"),...RR(e,"childWidth"),...RR(e,"childHeight")]}function RR(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const s=e.getScaleComponent(n);if(s){const a=s.get("type"),o=s.get("range");if(pl(a)&&bv(o)){const l=e.scaleName(n);return qc(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[A_e(l,o)]:[A_e(l,o),{name:i,update:gXe(l,s,`domain('${l}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const s=i.endsWith("width"),a=s?"containerSize()[0]":"containerSize()[1]",o=kJ(e.config.view,s?"width":"height"),l=`isFinite(${a}) ? ${a} : ${o}`;return[{name:i,init:l,on:[{update:l,events:"window:resize"}]}]}else return[{name:i,value:r}]}function A_e(e,t){return{name:e+"_step",value:t.step}}function gXe(e,t,n){const r=t.get("type"),i=t.get("padding"),s=bi(t.get("paddingOuter"),i);let a=t.get("paddingInner");return a=r==="band"?a!==void 0?a:i:1,`bandspace(${n}, ${a}, ${s}) * ${e}_step`}function mXe(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function vXe(e,t){return Ie(e).reduce((n,r)=>{const i=e[r];return Object.assign(Object.assign({},n),$F(t,i,r,s=>wt(s)?s:{value:s.value}))},{})}function $Pn(e,t){if(IS(t)||qc(t))return"shared";if(phe(t))return Zh(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function che(e,t){const n=e.scale[t],r=Zh(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&Te(sFn(t)),"independent"):e[r][t]||"shared"}const CPn=Object.assign(Object.assign({},QOn),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),yXe=Ie(CPn);class _Pn extends $g{}const T_e={symbols:SPn,gradient:kPn,labels:EPn,entries:APn};function SPn(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:s}){var a,o,l,u,c;if(s!=="symbol")return;const{markDef:f,encoding:h,config:d,mark:p}=n,g=f.filled&&p!=="trail";let m=Object.assign(Object.assign({},NOn({},n,HIn)),OYe(n,{filled:g}));const v=(a=bXe(h.opacity))!==null&&a!==void 0?a:f.opacity;if(m.fill){if(r==="fill"||g&&r===hl)delete m.fill;else if(m.fill.field)i.get("symbolFillColor")?delete m.fill:(m.fill=ai((o=d.legend.symbolBaseFillColor)!==null&&o!==void 0?o:"black"),m.fillOpacity=ai(v!=null?v:1));else if(ut(m.fill)){const y=(c=(u=PJ((l=h.fill)!==null&&l!==void 0?l:h.color))!==null&&u!==void 0?u:f.fill)!==null&&c!==void 0?c:g&&f.color;y&&(m.fill=ai(y))}}if(m.stroke){if(r==="stroke"||!g&&r===hl)delete m.stroke;else if(m.stroke.field)delete m.stroke;else if(ut(m.stroke)){const y=bi(PJ(h.stroke||h.color),f.stroke,g?f.color:void 0);y&&(m.stroke={value:y})}}if(r!==wg){const y=Le(t)&&wXe(n,i,t);y?m.opacity=[Object.assign({test:y},ai(v!=null?v:1)),ai(d.legend.unselectedOpacity)]:v&&(m.opacity=ai(v))}return m=Object.assign(Object.assign({},m),e),tr(m)?void 0:m}function kPn(e,{model:t,legendType:n}){if(n!=="gradient")return;let r={};const i=bXe(t.encoding.opacity)||t.markDef.opacity;return i&&(r.opacity=ai(i)),r=Object.assign(Object.assign({},r),e),tr(r)?void 0:r}function EPn(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const s=n.legend(r)||{},a=n.config,o=Le(t)?wXe(n,i,t):void 0,l=o?[{test:o,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:u,formatType:c}=s,f=_b(c)?Ife({fieldOrDatumDef:t,field:"datum.value",format:u,formatType:c,config:a}):void 0,h=Object.assign(Object.assign(Object.assign({},l?{opacity:l}:{}),f?{text:f}:{}),e);return tr(h)?void 0:h}function APn(e,{legendCmpt:t}){const n=t.get("selections");return n!=null&&n.length?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function bXe(e){return xXe(e,(t,n)=>Math.max(t,n.value))}function PJ(e){return xXe(e,(t,n)=>bi(t,n.value))}function xXe(e,t){if(wOn(e))return ci(e.condition).reduce(t,e.value);if(Xp(e))return e.value}function wXe(e,t,n){const r=t.get("selections");if(!(r!=null&&r.length))return;const i=on(n.field);return r.map(s=>`(!length(data(${on(Dr(s)+kb)})) || (${s}[${i}] && indexof(${s}[${i}], datum.value) >= 0))`).join(" || ")}const D_e={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return LGe(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return BGe(r,t,n)},gradientLength:e=>{var t,n;const{legend:r,legendConfig:i}=e;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:OPn(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return(i=(r=e.labelOverlap)!==null&&r!==void 0?r:t.labelOverlap)!==null&&i!==void 0?i:RPn(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return(i=e.symbolType)!==null&&i!==void 0?i:DPn(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>yy(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(vw(n)&&Pc(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>TPn(t,e)};function TPn(e,t){const n=e.values;if(ut(n))return eYe(t,n);if(wt(n))return n}function DPn(e,t,n,r){var i;if(t!=="shape"){const s=(i=PJ(n))!==null&&i!==void 0?i:r;if(s)return s}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function NPn(e){const{legend:t}=e;return bi(t.type,IPn(e))}function IPn({channel:e,timeUnit:t,scaleType:n}){if(vw(e)){if(ht(["quarter","month","day"],t))return"symbol";if(Pc(n))return"gradient"}return"symbol"}function MPn({legendConfig:e,legendType:t,orient:n,legend:r}){var i,s;return(s=(i=r.direction)!==null&&i!==void 0?i:e[t?"gradientDirection":"symbolDirection"])!==null&&s!==void 0?s:FPn(n,t)}function FPn(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function OPn({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:a,gradientVerticalMaxLength:o,gradientVerticalMinLength:l}=e;if(Pc(i))return n==="horizontal"?r==="top"||r==="bottom"?N_e(t,"width",a,s):a:N_e(t,"height",l,o)}function N_e(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function RPn(e){if(ht(["quantile","threshold","log"],e))return"greedy"}function $Xe(e){const t=qr(e)?PPn(e):UPn(e);return e.component.legends=t,t}function PPn(e){const{encoding:t}=e,n={};for(const r of[hl,...wYe]){const i=Ti(t[r]);!i||!e.getScaleComponent(r)||r===dl&&Le(i)&&i.type===ES||(n[r]=zPn(e,r))}return n}function LPn(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function BPn(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n!=null&&n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function zPn(e,t){var n,r,i;let s=e.legend(t);const{markDef:a,encoding:o,config:l}=e,u=l.legend,c=new _Pn({},LPn(e,t));w4n(e,t,c);const f=s!==void 0?!s:u.disable;if(c.set("disable",f,s!==void 0),f)return c;s=s||{};const h=e.getScaleComponent(t).get("type"),d=Ti(o[t]),p=Le(d)?(n=Co(d.timeUnit))===null||n===void 0?void 0:n.unit:void 0,g=s.orient||l.legend.orient||"right",m=NPn({legend:s,channel:t,timeUnit:p,scaleType:h}),v=MPn({legend:s,legendType:m,orient:g,legendConfig:u}),y={legend:s,channel:t,model:e,markDef:a,encoding:o,fieldOrDatumDef:d,legendConfig:u,config:l,scaleType:h,orient:g,legendType:m,direction:v};for(const $ of yXe){const _=$ in D_e?D_e[$](y):s[$];if(_!==void 0){const k=BPn(_,$,s,e.fieldDef(t));(k||l.legend[$]===void 0)&&c.set($,_,k)}}const b=(r=s==null?void 0:s.encoding)!==null&&r!==void 0?r:{},x=c.get("selections"),w={},C={fieldOrDatumDef:d,model:e,channel:t,legendCmpt:c,legendType:m};for(const $ of["labels","legend","title","symbols","gradient","entries"]){const _=vXe((i=b[$])!==null&&i!==void 0?i:{},e),k=$ in T_e?T_e[$](_,C):_;k!==void 0&&!tr(k)&&(w[$]=Object.assign(Object.assign(Object.assign({},(x==null?void 0:x.length)&&Le(d)?{name:`${Dr(d.field)}_legend_${$}`}:{}),x!=null&&x.length?{interactive:!!x}:{}),{update:k}))}return tr(w)||c.set("encode",w,!!(s!=null&&s.encoding)),c}function UPn(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){$Xe(r);for(const i of Ie(r.component.legends))n.legend[i]=che(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=CXe(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of Ie(t))for(const i of e.children)!i.component.legends[r]||n.legend[r]==="shared"&&delete i.component.legends[r];return t}function CXe(e,t){var n,r,i,s;if(!e)return t.clone();const a=e.getWithExplicit("orient"),o=t.getWithExplicit("orient");if(a.explicit&&o.explicit&&a.value!==o.value)return;let l=!1;for(const u of yXe){const c=Nm(e.getWithExplicit(u),t.getWithExplicit(u),u,"legend",(f,h)=>{switch(u){case"symbolType":return WPn(f,h);case"title":return oYe(f,h);case"type":return l=!0,xl("symbol")}return JW(f,h,u,"legend")});e.setWithExplicit(u,c)}return l&&(!((r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0)&&r.gradient&&xJ(e.implicit,["encode","gradient"]),!((s=(i=e.explicit)===null||i===void 0?void 0:i.encode)===null||s===void 0)&&s.gradient&&xJ(e.explicit,["encode","gradient"])),e}function WPn(e,t){return t.value==="circle"?t:e}function I_e(e,t,n,r){var i,s,a;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(s=e.encode[t])!==null&&s!==void 0?s:{},e.encode[t].update=(a=e.encode[t].update)!==null&&a!==void 0?a:{},e.encode[t].update[n]=r}function _Xe(e){const t=e.component.legends,n={};for(const i of Ie(t)){const s=e.getScaleComponent(i),a=Ar(s.get("domains"));if(n[a])for(const o of n[a])CXe(o,t[i])||n[a].push(t[i]);else n[a]=[t[i].clone()]}return D0(n).flat().map(i=>VPn(i,e.config)).filter(i=>i!==void 0)}function VPn(e,t){var n,r,i;const s=e.combine(),{disable:a,labelExpr:o,selections:l}=s,u=it(s,["disable","labelExpr","selections"]);if(!a){if(t.aria===!1&&u.aria==null&&(u.aria=!1),!((n=u.encode)===null||n===void 0)&&n.symbols){const c=u.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!u.stroke&&(c.stroke={value:"transparent"});for(const f of wYe)u[f]&&delete c[f]}if(u.title||delete u.title,o!==void 0){let c=o;((i=(r=u.encode)===null||r===void 0?void 0:r.labels)===null||i===void 0?void 0:i.update)&&wt(u.encode.labels.update.text)&&(c=K$(o,"datum.label",u.encode.labels.update.text.signal)),I_e(u,"labels","text",{signal:c})}for(const c in u){const f=u[c];if(wt(f)){const h=KOn[c];if(h){const{vgProp:d,part:p}=h;I_e(u,p,d,f),delete u[c]}}}return u}}function jPn(e){return IS(e)||phe(e)?HPn(e):SXe(e)}function HPn(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),SXe(e))}function SXe(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(a=>a.signal).join(", ")}]`},s=t.data.reduce((a,o)=>{const l=wt(o)?o.signal:`data('${e.lookupDataSource(o)}')`;return ht(a,l)||a.push(l),a},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]}},n)]}else return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const qPn=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class kXe extends $g{constructor(t,n,r,i){super(Object.assign({},n),{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function EXe(e){e.component.projection=qr(e)?GPn(e):KPn(e)}function GPn(e){var t;if(e.hasProjection){const n=e.specifiedProjection,r=!(n&&(n.scale!=null||n.translate!=null)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,s=r?YPn(e):void 0;return new kXe(e.projectionName(!0),Object.assign(Object.assign({},(t=e.config.projection)!==null&&t!==void 0?t:{}),n!=null?n:{}),i,s)}}function YPn(e){const t=[],{encoding:n}=e;for(const r of[[wd,xd],[ju,_f]])(Ti(n[r[0]])||Ti(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(dl)&&e.typedFieldDef(dl).type===ES&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(ha)),t}function XPn(e,t){const n=Bqe(qPn,i=>!!(!H1(e.explicit,i)&&!H1(t.explicit,i)||H1(e.explicit,i)&&H1(t.explicit,i)&&Ar(e.get(i))===Ar(t.get(i))));if(Ar(e.size)===Ar(t.size)){if(n)return e;if(Ar(e.explicit)===Ar({}))return t;if(Ar(t.explicit)===Ar({}))return e}return null}function KPn(e){if(e.children.length===0)return;let t;for(const r of e.children)EXe(r);const n=Bqe(e.children,r=>{const i=r.component.projection;if(i)if(t){const s=XPn(t,i);return s&&(t=s),!!s}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new kXe(r,t.specifiedProjection,t.size,Gt(t.data));for(const s of e.children){const a=s.component.projection;a&&(a.isFit&&i.data.push(...s.component.projection.data),s.renameProjection(a.get("name"),r),a.merged=!0)}return i}}function ZPn(e,t,n,r){var i,s;if(wF(t,n)){const a=qr(e)?(s=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&s!==void 0?s:{}:{},o=Me(t,{expr:"datum"}),l=Me(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Me(t,{binSuffix:"range",forAs:!0}),formula:HW(o,l,a.format,a.formatType,r)}}return{}}function AXe(e,t){return`${uGe(e)}_${t}`}function QPn(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function fhe(e,t,n){var r;const i=(r=XW(n,void 0))!==null&&r!==void 0?r:{},s=AXe(i,t);return e.getName(`${s}_bins`)}function JPn(e){return"as"in e}function M_e(e,t,n){let r,i;JPn(e)?r=qt(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Me(e,{forAs:!0}),Me(e,{binSuffix:"end",forAs:!0})];const s=Object.assign({},XW(t,void 0)),a=AXe(s,e.field),{signal:o,extentSignal:l}=QPn(n,a);if(VW(s.extent)){const c=s.extent,f=c.selection;i=sXe(n.getSelectionComponent(Dr(f),f),c),delete s.extent}const u=Object.assign(Object.assign(Object.assign({bin:s,field:e.field,as:[r]},o?{signal:o}:{}),l?{extentSignal:l}:{}),i?{span:i}:{});return{key:a,binComponent:u}}class Ch extends Zn{constructor(t,n){super(t),this.bins=n}clone(){return new Ch(null,Gt(this.bins))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,s,a)=>{if(Zl(s)&&hr(s.bin)){const{key:o,binComponent:l}=M_e(s,s.bin,n);i[o]=Object.assign(Object.assign(Object.assign({},l),i[o]),ZPn(n,s,a,n.config))}return i},{});return tr(r)?null:new Ch(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:s}=M_e(n,n.bin,r);return new Ch(t,{[i]:s})}merge(t,n){for(const r of Ie(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=f0([...this.bins[r].as,...t.bins[r].as],gn)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(D0(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(D0(this.bins).map(t=>t.field))}hash(){return`Bin ${gn(this.bins)}`}assemble(){return D0(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,s=t.bin,{extent:a}=s,o=it(s,["extent"]),l=Object.assign(Object.assign(Object.assign({type:"bin",field:Am(t.field),as:r,signal:t.signal},VW(a)?{extent:null}:{extent:a}),t.span?{span:{signal:`span(${t.span})`}}:{}),o);!a&&t.extentSignal&&(n.push({type:"extent",field:Am(t.field),signal:t.extentSignal}),l.extent={signal:t.extentSignal}),n.push(l);for(const u of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:Me({field:r[c]},{expr:"datum"}),as:u[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class iC extends Zn{constructor(t){super(null),t=t!=null?t:{name:"source"};let n;if(xy(t)||(n=t.format?Object.assign({},$p(t.format,["parse"])):{}),N8(t))this._data={values:t.values};else if(zD(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];ht(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else NYe(t)?this._data={values:[{type:"Sphere"}]}:(TYe(t)||xy(t))&&(this._data={});this._generator=xy(t),t.name&&(this._name=t.name),n&&!tr(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function LJ(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return console.error("Dataflow graph is inconsistent.",t,n),!1;if(!LJ(t.children))return!1}return!0}class EF extends Zn{constructor(t,n){super(t),this.params=n}clone(){return new EF(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${gn(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class AF extends Zn{constructor(t,n){super(t),this.params=n}clone(){return new AF(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${gn(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}function lV(e){return e instanceof iC||e instanceof EF||e instanceof AF}class TXe{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class Cg extends TXe{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:n}){t&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(lV(t))return!1;const n=t.parent,{continueFlag:r}=this.run(t);return r&&this.optimizeNextFromLeaves(n),this.mutatedFlag}}class hhe extends TXe{}function eLn(e,t,n,r){const i=qr(r)?r.encoding[_d(t)]:void 0;if(Zl(n)&&qr(r)&&Ffe(t,n,i,r.stack,r.markDef,r.config))e.add(Me(n,{})),e.add(Me(n,{suffix:"end"})),n.bin&&wF(n,t)&&e.add(Me(n,{binSuffix:"range"}));else if(uMn(t)){const s=lMn(t);e.add(r.getName(s))}else e.add(Me(n));return e}function tLn(e,t){var n;for(const r of Ie(t)){const i=t[r];for(const s of Ie(i))r in e?e[r][s]=new Set([...(n=e[r][s])!==null&&n!==void 0?n:[],...i[s]]):e[r]={[s]:i[s]}}}class Hc extends Zn{constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}clone(){return new Hc(null,new Set(this.dimensions),Gt(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(a=>{a.aggregate&&(r=!0)});const i={},s=new Set;return!r||(n.forEachFieldDef((a,o)=>{var l,u,c,f;const{aggregate:h,field:d}=a;if(h)if(h==="count")i["*"]=(l=i["*"])!==null&&l!==void 0?l:{},i["*"].count=new Set([Me(a,{forAs:!0})]);else{if(Tm(h)||Bx(h)){const p=Tm(h)?"argmin":"argmax",g=h[p];i[g]=(u=i[g])!==null&&u!==void 0?u:{},i[g][p]=new Set([Me({op:p,field:g},{forAs:!0})])}else i[d]=(c=i[d])!==null&&c!==void 0?c:{},i[d][h]=new Set([Me(a,{forAs:!0})]);yv(o)&&n.scaleDomain(o)==="unaggregated"&&(i[d]=(f=i[d])!==null&&f!==void 0?f:{},i[d].min=new Set([Me({field:d,aggregate:"min"},{forAs:!0})]),i[d].max=new Set([Me({field:d,aggregate:"max"},{forAs:!0})]))}else eLn(s,o,a,n)}),s.size+Ie(i).length===0)?null:new Hc(t,s,i)}static makeFromTransform(t,n){var r,i,s;const a=new Set,o={};for(const l of n.aggregate){const{op:u,field:c,as:f}=l;u&&(u==="count"?(o["*"]=(r=o["*"])!==null&&r!==void 0?r:{},o["*"].count=new Set([f||Me(l,{forAs:!0})])):(o[c]=(i=o[c])!==null&&i!==void 0?i:{},o[c][u]=new Set([f||Me(l,{forAs:!0})])))}for(const l of(s=n.groupby)!==null&&s!==void 0?s:[])a.add(l);return a.size+Ie(o).length===0?null:new Hc(t,a,o)}merge(t){return NIn(this.dimensions,t.dimensions)?(tLn(this.measures,t.measures),!0):(wFn("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Ie(this.measures)])}producedFields(){const t=new Set;for(const n of Ie(this.measures))for(const r of Ie(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${gn({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const s of Ie(this.measures))for(const a of Ie(this.measures[s]))for(const o of this.measures[s][a])r.push(o),t.push(a),n.push(s==="*"?null:Am(s));return{type:"aggregate",groupby:[...this.dimensions].map(Am),ops:t,fields:n,as:r}}}class DS extends Zn{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(const s of Au){const a=n.facet[s];if(a){const{bin:o,sort:l}=a;this[s]=Object.assign({name:n.getName(`${s}_domain`),fields:[Me(a),...hr(o)?[Me(a,{binSuffix:"end"})]:[]]},wh(l)?{sortField:l}:ut(l)?{sortIndexField:nC(a,s)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Au)this[n]&&(t+=` ${n.charAt(0)}:${gn(this[n])}`);return t}get fields(){var t;const n=[];for(const r of Au)!((t=this[r])===null||t===void 0)&&t.fields&&n.push(...this[r].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Au)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Hu){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),s=r.get("range");if(pl(i)&&bv(s)){const a=uV(this.childModel,n),o=dhe(a);o?t[n]=o:Te(`Unknown field for ${n}. Cannot calculate view size.`)}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x"}[t],s=[],a=[],o=[];r&&r[i]&&(n?(s.push(`distinct_${r[i]}`),a.push("max")):(s.push(r[i]),a.push("distinct")),o.push(`distinct_${r[i]}`));const{sortField:l,sortIndexField:u}=this[t];if(l){const{op:c=qW,field:f}=l;s.push(f),a.push(c),o.push(Me(l,{forAs:!0}))}else u&&(s.push(u),a.push("max"),o.push(u));return{name:this[t].name,source:n!=null?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},s.length?{fields:s,ops:a,as:o}:{})]}}assembleFacetHeaderData(t){var n,r;const{columns:i}=this.model.layout,{layoutHeaders:s}=this.model.component,a=[],o={};for(const c of ohe){for(const f of lhe){const h=(n=s[c]&&s[c][f])!==null&&n!==void 0?n:[];for(const d of h)if(((r=d.axes)===null||r===void 0?void 0:r.length)>0){o[c]=!0;break}}if(o[c]){const f=`length(data("${this.facet.name}"))`,h=c==="row"?i?{signal:`ceil(${f} / ${i})`}:1:i?{signal:`min(${f}, ${i})`}:{signal:f};a.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:h}]})}}const{row:l,column:u}=o;return(l||u)&&a.unshift(this.assembleRowColumnHeaderData("facet",null,t)),a}assemble(){var t,n;const r=[];let i=null;const s=this.getChildIndependentFieldsWithStep(),{column:a,row:o,facet:l}=this;if(a&&o&&(s.x||s.y)){i=`cross_${this.column.name}_${this.row.name}`;const u=[].concat((t=s.x)!==null&&t!==void 0?t:[],(n=s.y)!==null&&n!==void 0?n:[]),c=u.map(()=>"distinct");r.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:u,ops:c}]})}for(const u of[_p,Cp])this[u]&&r.push(this.assembleRowColumnHeaderData(u,i,s));if(l){const u=this.assembleFacetHeaderData(s);u&&r.push(...u)}return r}}function F_e(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function nLn(e,t){const n=Vqe(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.indexOf("date:")===0){const r=F_e(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.indexOf("utc:")===0){const r=F_e(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return Te(MMn(t)),null}function rLn(e){const t={};return Z4(e.filter,n=>{var r;if(kGe(n)){let i=null;Cfe(n)?i=n.equal:_fe(n)?i=n.range[0]:Sfe(n)&&(i=((r=n.oneOf)!==null&&r!==void 0?r:n.in)[0]),i&&(SS(i)?t[n.field]="date":yi(i)?t[n.field]="number":qt(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function iLn(e){const t={};function n(r){KW(r)?t[r.field]="date":r.type==="quantitative"&&rMn(r.aggregate)?t[r.field]="number":RD(r.field)>1?r.field in t||(t[r.field]="flatten"):Pfe(r)&&wh(r.sort)&&RD(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((qr(e)||qc(e))&&e.forEachFieldDef((r,i)=>{if(Zl(r))n(r);else{const s=Ux(i),a=e.fieldDef(s);n(Object.assign(Object.assign({},r),{type:a.type}))}}),qr(e)){const{mark:r,markDef:i,encoding:s}=e;if(Lx(r)&&!e.encoding.order){const a=i.orient==="horizontal"?"y":"x",o=s[a];Le(o)&&o.type==="quantitative"&&!(o.field in t)&&(t[o.field]="number")}}return t}function sLn(e){const t={};if(qr(e)&&e.component.selection)for(const n of Ie(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&RD(i.field)>1&&(t[i.field]="flatten")}return t}class xa extends Zn{constructor(t,n){super(t),this._parse=n}clone(){return new xa(null,Gt(this._parse))}hash(){return`Parse ${gn(this._parse)}`}static makeExplicit(t,n,r){let i={};const s=n.data;return!xy(s)&&s&&s.format&&s.format.parse&&(i=s.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const o of Ie(r)){const l=i.getWithExplicit(o);l.value!==void 0&&(l.explicit||l.value===r[o]||l.value==="derived"||r[o]==="flatten"?delete r[o]:Te(HCe(o,r[o],l.value)))}for(const o of Ie(n)){const l=i.get(o);l!==void 0&&(l===n[o]?delete n[o]:Te(HCe(o,n[o],l)))}const s=new $g(n,r);i.copyAll(s);const a={};for(const o of Ie(s.combine())){const l=s.get(o);l!==null&&(a[o]=l)}return Ie(a).length===0||i.parseNothing?null:new xa(t,a)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of Ie(this._parse)){const r=this._parse[n];RD(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(Ie(this._parse))}dependentFields(){return new Set(Ie(this._parse))}assembleTransforms(t=!1){return Ie(this._parse).filter(n=>t?RD(n)>1:!0).map(n=>{const r=nLn(n,this._parse[n]);return r?{type:"formula",expr:r,as:jqe(n)}:null}).filter(n=>n!==null)}}class Fm extends Zn{clone(){return new Fm(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([J$])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:J$}}}class jx extends Zn{constructor(t,n){super(t),this.transform=n}clone(){return new jx(null,Gt(this.transform))}addDimensions(t){this.transform.groupby=f0(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Me(t)}hash(){return`JoinAggregateTransform ${gn(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const s of this.transform.joinaggregate)n.push(s.op),r.push(this.getDefaultName(s)),t.push(s.field===void 0?null:s.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},i!==void 0?{groupby:i}:{})}}function aLn(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Me(r);return i&&t.push(i),t},[])}function oLn(e){return ut(e)&&e.every(t=>qt(t))&&e.length>1}class kp extends Zn{constructor(t,n){super(t),this._stack=n}clone(){return new kp(null,Gt(this._stack))}static makeFromTransform(t,n){const{stack:r,groupby:i,as:s,offset:a="zero"}=n,o=[],l=[];if(n.sort!==void 0)for(const f of n.sort)o.push(f.field),l.push(bi(f.order,"ascending"));const u={field:o,order:l};let c;return oLn(s)?c=s:qt(s)?c=[s,s+"_end"]:c=[n.stack+"_start",n.stack+"_end"],new kp(t,{stackField:r,groupby:i,offset:a,sort:u,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannel:s,fieldChannel:a,offset:o,impute:l}=r;let u;if(s){const d=i[s];u=Qh(d)}const c=aLn(n),f=n.encoding.order;let h;return ut(f)||Le(f)?h=iYe(f):h=c.reduce((d,p)=>(d.field.push(p),d.order.push(a==="y"?"descending":"ascending"),d),{field:[],order:[]}),new kp(t,{dimensionFieldDef:u,stackField:n.vgField(a),facetby:[],stackby:c,sort:h,offset:o,impute:l,as:[n.vgField(a,{suffix:"start",forAs:!0}),n.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${gn(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:r}=this._stack;return t?t.bin?n?[Me(t,{binSuffix:"mid"})]:[Me(t,{}),Me(t,{binSuffix:"end"})]:[Me(t)]:r!=null?r:[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:r,stackField:i,stackby:s,sort:a,offset:o,impute:l,as:u}=this._stack;if(l&&r){const{band:c=.5,bin:f}=r;f&&t.push({type:"formula",expr:`${c}*`+Me(r,{expr:"datum"})+`+${1-c}*`+Me(r,{expr:"datum",binSuffix:"end"}),as:Me(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[...s,...n],key:Me(r,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:a,as:u,offset:o}),t}}class NS extends Zn{constructor(t,n){super(t),this.transform=n}clone(){return new NS(null,Gt(this.transform))}addDimensions(t){this.transform.groupby=f0(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const r=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(r.add,r),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(i=>r.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>i!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Me(t)}hash(){return`WindowTransform ${gn(this.transform)}`}assemble(){var t;const n=[],r=[],i=[],s=[];for(const h of this.transform.window)r.push(h.op),i.push(this.getDefaultName(h)),s.push(h.param===void 0?null:h.param),n.push(h.field===void 0?null:h.field);const a=this.transform.frame,o=this.transform.groupby;if(a&&a[0]===null&&a[1]===null&&r.every(h=>dfe(h)))return Object.assign({type:"joinaggregate",as:i,ops:r,fields:n},o!==void 0?{groupby:o}:{});const l=[],u=[];if(this.transform.sort!==void 0)for(const h of this.transform.sort)l.push(h.field),u.push((t=h.order)!==null&&t!==void 0?t:"ascending");const c={field:l,order:u},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:s,as:i,ops:r,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),o!==void 0?{groupby:o}:{}),a!==void 0?{frame:a}:{})}}class lLn extends Cg{run(t){const n=t.parent;if(t instanceof xa){if(lV(n))return this.flags;if(n.numChildren()>1)return this.setContinue(),this.flags;if(n instanceof xa)this.setMutated(),n.merge(t);else{if(Uqe(n.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class uLn extends hhe{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of Ie(r))r[i].length>1&&(this.setMutated(),this.mergeNodes(t,r[i]));for(const i of t.children)this.run(i);return this.mutatedFlag}}class cLn extends Cg{run(t){return t instanceof ho||t.numChildren()>0||t instanceof DS?this.flags:(this.setMutated(),t.remove(),this.flags)}}class fLn extends Cg{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof $h){const n=t.producedFields();zqe(n,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...n]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class hLn extends Cg{run(t){this.setContinue();const r=t.parent.children.filter(s=>s instanceof $h),i=r.pop();for(const s of r)this.setMutated(),i.merge(s);return this.flags}}function dLn(e){function t(n){if(!(n instanceof DS)){const r=n.clone();if(r instanceof ho){const i=zJ+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof Hc||r instanceof kp||r instanceof NS||r instanceof jx)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function BJ(e){if(e instanceof DS)if(e.numChildren()===1&&!(e.children[0]instanceof ho)){const t=e.children[0];(t instanceof Hc||t instanceof kp||t instanceof NS||t instanceof jx)&&t.addDimensions(e.fields),t.swapWithParent(),BJ(e)}else{const t=e.model.component.data.main;DXe(t);const n=dLn(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(BJ)}function DXe(e){if(e instanceof ho&&e.type===ha&&e.numChildren()===1){const t=e.children[0];t instanceof DS||(t.swapWithParent(),DXe(e))}}class pLn extends hhe{constructor(){super()}run(t){t instanceof ho&&!t.isRequired()&&(this.setMutated(),t.remove());for(const n of t.children)this.run(n);return this.mutatedFlag}}class gLn extends hhe{constructor(t){super(),this.requiresSelectionId=t&&rhe(t)}run(t){t instanceof Fm&&(this.requiresSelectionId&&(lV(t.parent)||t.parent instanceof Hc||t.parent instanceof xa)||(this.setMutated(),t.remove()));for(const n of t.children)this.run(n);return this.mutatedFlag}}class mLn extends Cg{run(t){const n=t.parent,r=[...n.children],i=n.children.filter(s=>s instanceof xa);if(n.numChildren()>1&&i.length>=1){const s={},a=new Set;for(const o of i){const l=o.parse;for(const u of Ie(l))u in s?s[u]!==l[u]&&a.add(u):s[u]=l[u]}for(const o of a)delete s[o];if(!tr(s)){this.setMutated();const o=new xa(n,s);for(const l of r){if(l instanceof xa)for(const u of Ie(s))delete l.parse[u];n.removeChild(l),l.parent=o,l instanceof xa&&Ie(l.parse).length===0&&l.remove()}}}return this.setContinue(),this.flags}}class vLn extends Cg{run(t){const n=t.parent,r=n.children.filter(s=>s instanceof Hc),i={};for(const s of r){const a=gn(s.groupBy);a in i||(i[a]=[]),i[a].push(s)}for(const s of Ie(i)){const a=i[s];if(a.length>1){const o=a.pop();for(const l of a)o.merge(l)&&(n.removeChild(l),l.parent=o,l.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class yLn extends Cg{constructor(t){super(),this.model=t}run(t){const n=t.parent,r=!(lV(n)||n instanceof TS||n instanceof xa||n instanceof Fm),i=[],s=[];for(const a of n.children)a instanceof Ch&&(r&&!Uqe(n.producedFields(),a.dependentFields())?i.push(a):s.push(a));if(i.length>0){const a=i.pop();for(const o of i)a.merge(o,this.model.renameSignal.bind(this.model));this.setMutated(),n instanceof Ch?n.merge(a,this.model.renameSignal.bind(this.model)):a.swapWithParent()}if(s.length>1){const a=s.pop();for(const o of s)a.merge(o,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class bLn extends Cg{run(t){const n=t.parent,r=[...n.children];if(!OD(r,o=>o instanceof ho)||n.numChildren()<=1)return this.setContinue(),this.flags;const s=[];let a;for(const o of r)if(o instanceof ho){let l=o;for(;l.numChildren()===1;){const u=l.children[0];if(u instanceof ho)l=u;else break}s.push(...l.children),a?(n.removeChild(o),o.parent=a.parent,a.parent.removeChild(a),a.parent=l,this.setMutated()):a=l}else s.push(o);if(s.length){this.setMutated();for(const o of s)o.parent.removeChild(o),o.parent=a}return this.setContinue(),this.flags}}const zJ="scale_",PR=5;function Ig(e){const t=[];function n(r){if(r.numChildren()===0)t.push(r);else for(const i of r.children)n(i)}for(const r of e)n(r);return t}function xLn(e){return e}function sc(e,t){return t.map(r=>{if(e instanceof Cg){const i=e.optimizeNextFromLeaves(r);return e.reset(),i}else return e.run(r)}).some(xLn)}function O_e(e,t){let n=e.sources;const r=new Set;return r.add(sc(new pLn,n)),r.add(sc(new gLn(t),n)),n=n.filter(i=>i.numChildren()>0),r.add(sc(new cLn,Ig(n))),n=n.filter(i=>i.numChildren()>0),r.add(sc(new lLn,Ig(n))),r.add(sc(new yLn(t),Ig(n))),r.add(sc(new fLn,Ig(n))),r.add(sc(new mLn,Ig(n))),r.add(sc(new vLn,Ig(n))),r.add(sc(new hLn,Ig(n))),r.add(sc(new uLn,n)),r.add(sc(new bLn,Ig(n))),e.sources=n,r.has(!0)}function wLn(e,t){LJ(e.sources);let n=0,r=0;for(let i=0;i<PR&&O_e(e,t);i++)n++;e.sources.map(BJ);for(let i=0;i<PR&&O_e(e,t);i++)r++;LJ(e.sources),Math.max(n,r)===PR&&Te(`Maximum optimization runs(${PR}) reached.`)}class Bl{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Bl(()=>t(n))}}function NXe(e){qr(e)?$Ln(e):CLn(e)}function $Ln(e){const t=e.component.scales;for(const n of Ie(t)){const r=SLn(e,n);if(t[n].setWithExplicit("domains",r),ELn(e,n),e.component.data.isFaceted){let s=e;for(;!qc(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[n]==="shared")for(const o of r.value)h0(o)&&(o.data=zJ+o.data.replace(zJ,""))}}}function CLn(e){for(const n of e.children)NXe(n);const t=e.component.scales;for(const n of Ie(t)){let r,i=null;for(const s of e.children){const a=s.component.scales[n];if(a){r===void 0?r=a.getWithExplicit("domains"):r=Nm(r,a.getWithExplicit("domains"),"domains","scale",UJ);const o=a.get("selectionExtent");i&&o&&i.selection!==o.selection&&Te("The same selection must be used to override scale domains in a layered view."),i=o}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function _Ln(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:s}=R_e(t,n);if(!i){Te(s);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=R_e(t,n);if(i)return"unaggregated"}return e}function SLn(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=_Ln(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),t==="x"&&Ti(r.x2)?Ti(r.x)?Nm(Fg(n,i,e,"x"),Fg(n,i,e,"x2"),"domain","scale",UJ):Fg(n,i,e,"x2"):t==="y"&&Ti(r.y2)?Ti(r.y)?Nm(Fg(n,i,e,"y"),Fg(n,i,e,"y2"),"domain","scale",UJ):Fg(n,i,e,"y2"):Fg(n,i,e,t)}function kLn(e,t,n){return e.map(r=>({signal:`{data: ${zfe(r,{timeUnit:n,type:t})}}`}))}function OG(e,t,n){var r;const i=(r=Co(n))===null||r===void 0?void 0:r.unit;return t==="temporal"||i?kLn(e,t,i):[e]}function Fg(e,t,n,r){const{encoding:i}=n,s=Ti(i[r]),{type:a}=s,o=s.timeUnit;if(oOn(t)){const f=Fg(e,void 0,n,r),h=OG(t.unionWith,a,o);return q1([...f.value,...h])}else{if(wt(t))return q1([t]);if(t&&t!=="unaggregated"&&!TGe(t))return q1(OG(t,a,o))}const l=n.stack;if(l&&r===l.fieldChannel){if(l.offset==="normalize")return xl([[0,1]]);const f=n.requestDataName(ha);return xl([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const u=yv(r)&&Le(s)?ALn(n,r,e):void 0;if(xv(s)){const f=OG([s.datum],a,o);return xl(f)}const c=s;if(t==="unaggregated"){const f=n.requestDataName(ha),{field:h}=s;return xl([{data:f,field:Me({field:h,aggregate:"min"})},{data:f,field:Me({field:h,aggregate:"max"})}])}else if(hr(c.bin)){if(pl(e))return xl(e==="bin-ordinal"?[]:[{data:x8(u)?n.requestDataName(ha):n.requestDataName(I8),field:n.vgField(r,wF(c,r)?{binSuffix:"range"}:{}),sort:u===!0||!ds(u)?{field:n.vgField(r,{}),op:"min"}:u}]);{const{bin:f}=c;if(hr(f)){const h=fhe(n,c.field,f);return xl([new Bl(()=>{const d=n.getSignalName(h);return`[${d}.start, ${d}.stop]`})])}else return xl([{data:n.requestDataName(ha),field:n.vgField(r,{})}])}}else if(c.timeUnit&&ht(["time","utc"],e)&&Ffe(r,c,qr(n)?n.encoding[_d(r)]:void 0,n.stack,n.markDef,n.config)){const f=n.requestDataName(ha);return xl([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return xl(u?[{data:x8(u)?n.requestDataName(ha):n.requestDataName(I8),field:n.vgField(r),sort:u}]:[{data:n.requestDataName(ha),field:n.vgField(r)}])}function RG(e,t){const{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:n!=null?n:t?"sum":qW},r?{field:Am(r)}:{}),i?{order:i}:{})}function ELn(e,t){var n;const r=e.component.scales[t],i=e.specifiedScales[t].domain,s=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,a=TGe(i)&&i,o=yF(s)&&VW(s.extent)&&s.extent;(a||o)&&r.set("selectionExtent",a!=null?a:o,!0)}function ALn(e,t,n){if(!pl(n))return;const r=e.fieldDef(t),i=r.sort;if(VGe(i))return{op:"min",field:nC(r,t),order:"ascending"};const{stack:s}=e,a=s?[...s.groupbyField?[s.groupbyField]:[],...s.stackBy.map(o=>o.fieldDef.field)]:void 0;if(wh(i)){const o=s&&!ht(a,i.field);return RG(i,o)}else if(WGe(i)){const{encoding:o,order:l}=i,u=e.fieldDef(o),{aggregate:c,field:f}=u,h=s&&!ht(a,f);if(Tm(c)||Bx(c))return RG({field:Me(u),order:l},h);if(dfe(c)||!c)return RG({op:c,field:f,order:l},h)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(ht(["ascending",void 0],i))return!0}}function R_e(e,t){const{aggregate:n,type:r}=e;return n?qt(n)&&!aMn[n]?{valid:!1,reason:QMn(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:JMn(e)}:{valid:!0}:{valid:!1,reason:ZMn(e)}}function UJ(e,t,n,r){return e.explicit&&t.explicit&&Te(iFn(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function TLn(e){const t=f0(e.map(a=>h0(a)?it(a,["sort"]):a),gn),n=f0(e.map(a=>{if(h0(a)){const o=a.sort;return o!==void 0&&!x8(o)&&("op"in o&&o.op==="count"&&delete o.field,o.order==="ascending"&&delete o.order),o}}).filter(a=>a!==void 0),gn);if(t.length===0)return;if(t.length===1){const a=e[0];if(h0(a)&&n.length>0){let o=n[0];if(n.length>1)Te(GCe),o=!0;else if(ds(o)&&"field"in o){const l=o.field;a.field===l&&(o=o.order?{order:o.order}:!0)}return Object.assign(Object.assign({},a),{sort:o})}return a}const r=f0(n.map(a=>x8(a)||!("op"in a)||a.op in tMn?a:(Te(aFn(a)),!0)),gn);let i;r.length===1?i=r[0]:r.length>1&&(Te(GCe),i=!0);const s=f0(e.map(a=>h0(a)?a.data:null),a=>a);return s.length===1&&s[0]!==null?Object.assign({data:s[0],fields:t.map(o=>o.field)},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}function dhe(e){if(h0(e)&&qt(e.field))return e.field;if(OFn(e)){let t;for(const n of e.fields)if(h0(n)&&qt(n.field)){if(!t)t=n.field;else if(t!==n.field)return Te(oFn),t}return Te(lFn),t}else if(RFn(e)){Te(uFn);const t=e.fields[0];return qt(t)?t:void 0}}function uV(e,t){const r=e.component.scales[t].get("domains").map(i=>(h0(i)&&(i.data=e.lookupDataSource(i.data)),i));return TLn(r)}function IXe(e){return IS(e)||phe(e)?e.children.reduce((t,n)=>t.concat(IXe(n)),P_e(e)):P_e(e)}function P_e(e){return Ie(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:s,type:a,selectionExtent:o,domains:l,range:u,reverse:c}=i,f=it(i,["name","type","selectionExtent","domains","range","reverse"]),h=DLn(i.range,s,n);let d;o&&(d=D4n(e,o));const p=uV(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:s,type:a},p?{domain:p}:{}),d?{domainRaw:d}:{}),{range:h}),c!==void 0?{reverse:c}:{}),f)),t},[])}function DLn(e,t,n){return Zh(n)&&bv(e)?{step:{signal:t+"_step"}}:e}class MXe extends $g{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:OD(this.get("domains"),t=>ut(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const NLn=["range","scheme"];function FXe(e){return e==="x"?"width":e==="y"?"height":void 0}function ILn(e){const t=e.component.scales;for(const n of WW){const r=t[n];if(!r)continue;const i=MLn(n,e);r.setWithExplicit("range",i)}}function L_e(e,t){const n=e.fieldDef(t);if(n&&n.bin&&hr(n.bin)){const r=fhe(e,n.field,n.bin),i=FXe(t),s=e.getName(i);return new Bl(()=>{const a=e.getSignalName(r),o=`(${a}.stop - ${a}.start) / ${a}.step`;return`${e.getSignalName(s)} / (${o})`})}}function MLn(e,t){const n=t.specifiedScales[e],{size:r}=t,s=t.getScaleComponent(e).get("type");for(const a of NLn)if(n[a]!==void 0){const o=DGe(s,a),l=NGe(e,a);if(!o)Te(dGe(s,a,e));else if(l)Te(l);else switch(a){case"range":return ut(n.range)&&Zh(e)?q1(n.range.map(u=>{if(u==="width"||u==="height"){const c=t.getName(u),f=t.getSignalName.bind(t);return Bl.fromName(f,c)}return u})):q1(n.range);case"scheme":return q1(FLn(n[a]))}}if(e===Ur||e===Ii){const a=e===Ur?"width":"height",o=r[a];if(Jh(o)){if(pl(s))return q1({step:o.step});Te(pGe(a))}}return xl(OLn(e,t))}function FLn(e){return aOn(e)?Object.assign({scheme:e.name},$p(e,["name"])):{scheme:e}}function OLn(e,t){const{size:n,config:r,mark:i,encoding:s}=t,a=t.getSignalName.bind(t),{type:o}=Ti(s[e]),u=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case Ur:case Ii:{if(ht(["point","band"],u)){if(e===Ur&&!n.width){const p=BD(r.view,"width");if(Jh(p))return p}else if(e===Ii&&!n.height){const p=BD(r.view,"height");if(Jh(p))return p}}const h=FXe(e),d=t.getName(h);return e===Ii&&qu(u)?[Bl.fromName(a,d),0]:[0,Bl.fromName(a,d)]}case xg:{const h=t.component.scales[e].get("zero"),d=OXe(i,h,r),p=LLn(i,n,t,r);return _8(u)?PLn(d,p,RLn(u,r,c,e)):[d,p]}case Cf:return[0,Math.PI*2];case zx:return[0,360];case bd:return[0,new Bl(()=>{const h=t.getSignalName("width"),d=t.getSignalName("height");return`min(${h},${d})/2`})];case gv:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case mv:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case dl:return"symbol";case hl:case $d:case Cd:return u==="ordinal"?o==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case wg:case dv:case pv:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function RLn(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&ut(n)?n.length+1:(Te(yFn(r)),3)}}function PLn(e,t,n){const r=()=>{const i=LD(t),s=LD(e),a=`(${i} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${i} + ${a}, ${a})`};return wt(t)?new Bl(r):{signal:r()}}function OXe(e,t,n){if(t)return wt(t)?{signal:`${t.signal} ? 0 : ${OXe(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(jW("size",e))}const B_e=.95;function LLn(e,t,n,r){const i={x:L_e(n,"x"),y:L_e(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const s=z_e(t,i,r.view);return yi(s)?s-1:new Bl(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const s=z_e(t,i,r.view);return yi(s)?Math.pow(B_e*s,2):new Bl(()=>`pow(${B_e} * ${s.signal}, 2)`)}}throw new Error(jW("size",e))}function z_e(e,t,n){const r=Jh(e.width)?e.width.step:D8(n,"width"),i=Jh(e.height)?e.height.step:D8(n,"height");return t.x||t.y?new Bl(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function RXe(e,t){qr(e)?BLn(e,t):LXe(e,t)}function BLn(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:s,specifiedScales:a}=e;for(const o of Ie(n)){const l=a[o],u=n[o],c=e.getScaleComponent(o),f=Ti(i[o]),h=l[t],d=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=DGe(d,t),v=NGe(o,t);if(h!==void 0&&(m?v&&Te(v):Te(dGe(d,t,o))),m&&v===void 0)if(h!==void 0)u.copyKeyFromObject(t,l);else{const y=t in U_e?U_e[t]({model:e,channel:o,fieldOrDatumDef:f,scaleType:d,scalePadding:p,scalePaddingInner:g,domain:l.domain,markDef:s,config:r}):r.scale[t];y!==void 0&&u.set(t,y,!1)}}}const U_e={bins:({model:e,fieldOrDatumDef:t})=>Le(t)?zLn(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>ULn(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>WLn(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>VLn(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>jLn(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:s})=>HLn(e,t,n,r.type,i,s.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=Le(e)?e.sort:void 0;return qLn(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>GLn(e,t,n,r,i)};function PXe(e){qr(e)?ILn(e):LXe(e,"range")}function LXe(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?PXe(r):RXe(r,t);for(const r of Ie(n)){let i;for(const s of e.children){const a=s.component.scales[r];if(a){const o=a.getWithExplicit(t);i=Nm(i,o,t,"scale",AYe((l,u)=>{switch(t){case"range":return l.step&&u.step?l.step-u.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function zLn(e,t){const n=t.bin;if(hr(n)){const r=fhe(e,t.field,n);return new Bl(()=>e.getSignalName(r))}else if(to(n)&&yF(n)&&n.step!==void 0)return{step:n.step}}function ULn(e,t){if(ht([hl,$d,Cd],e)&&t!=="nominal")return"hcl"}function WLn(e,t,n){var r;if(!(((r=Qh(n))===null||r===void 0?void 0:r.bin)||ht([fi.TIME,fi.UTC],e)))return t in vv?!0:void 0}function VLn(e,t,n,r,i,s){if(e in vv){if(Pc(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:a,orient:o}=i;if(a==="bar"&&!(Le(r)&&(r.bin||r.timeUnit))&&(o==="vertical"&&e==="x"||o==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===fi.POINT)return n.pointPadding}}function jLn(e,t,n,r){if(e===void 0&&t in vv){const{bandPaddingInner:i,barBandPaddingInner:s,rectBandPaddingInner:a}=r;return bi(i,n==="bar"?s:a)}}function HLn(e,t,n,r,i,s){if(e===void 0&&t in vv&&n===fi.BAND){const{bandPaddingOuter:a}=s;return bi(a,wt(i)?{signal:`${i.signal}/2`}:i/2)}}function qLn(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return qu(e)&&t==="descending"?wt(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(qu(e)&&t==="descending")return!0}function GLn(e,t,n,r,i){if(!!n&&n!=="unaggregated"&&qu(i)){if(ut(n)){const a=n[0],o=n[n.length-1];if(a<=0&&o>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!_8(i))return!0;if(!(Le(t)&&t.bin)&&ht([...Hu,...vMn],e)){const{orient:a,type:o}=r;return!(ht(["bar","area","line","trail"],o)&&(a==="horizontal"&&e==="y"||a==="vertical"&&e==="x"))}return!1}function YLn(e,t,n,r){const i=XLn(t,n,r),{type:s}=e;return yv(t)?s!==void 0?MGe(t,s)?Le(n)&&!IGe(s,n.type)?(Te(nFn(s,i)),i):s:(Te(tFn(t,s,i)),i):i:null}function XLn(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(vw(e)||J4(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&Te(_G(e,"ordinal")),"ordinal";if(e in vv){if(ht(["rect","bar","image","rule"],n))return"band"}else if(n==="arc"&&e in vfe)return"band";return t.band!==void 0||Lfe(t)&&((r=t.axis)===null||r===void 0?void 0:r.tickBand)?"band":"point";case"temporal":return vw(e)?"time":J4(e)==="discrete"?(Te(_G(e,"temporal")),"ordinal"):Le(t)&&t.timeUnit&&Co(t.timeUnit).utc?"utc":"time";case"quantitative":return vw(e)?Le(t)&&hr(t.bin)?"bin-ordinal":"linear":J4(e)==="discrete"?(Te(_G(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(fGe(t.type))}function KLn(e,{ignoreRange:t}={}){BXe(e),NXe(e);for(const n of cOn)RXe(e,n);t||PXe(e)}function BXe(e){qr(e)?e.component.scales=ZLn(e):e.component.scales=JLn(e)}function ZLn(e){const{encoding:t,mark:n}=e;return WW.reduce((r,i)=>{const s=Ti(t[i]);if(s&&n===Xqe&&i===dl&&s.type===ES)return r;let a=s&&s.scale;if(s&&a!==null&&a!==!1){a=a!=null?a:{};const o=YLn(a,i,s,n);r[i]=new MXe(e.scaleName(i+"",!0),{value:o,explicit:a.type===o})}return r},{})}const QLn=AYe((e,t)=>XCe(e)-XCe(t));function JLn(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const s of e.children){BXe(s);for(const a of Ie(s.component.scales))if(i.scale[a]=(t=i.scale[a])!==null&&t!==void 0?t:$Pn(a,e),i.scale[a]==="shared"){const o=r[a],l=s.component.scales[a].getWithExplicit("type");o?GFn(o.value,l.value)?r[a]=Nm(o,l,"type","scale",QLn):(i.scale[a]="independent",delete r[a]):r[a]=l}}for(const s of Ie(r)){const a=e.scaleName(s,!0),o=r[s];n[s]=new MXe(a,o);for(const l of e.children){const u=l.component.scales[s];u&&(l.renameScale(u.get("name"),a),u.merged=!0)}}return n}class PG{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function qr(e){return(e==null?void 0:e.type)==="unit"}function qc(e){return(e==null?void 0:e.type)==="facet"}function phe(e){return(e==null?void 0:e.type)==="concat"}function IS(e){return(e==null?void 0:e.type)==="layer"}class ghe{constructor(t,n,r,i,s,a,o){var l,u;this.type=n,this.parent=r,this.config=s,this.view=o,this.children=[],this.correctDataNames=c=>(c.from&&c.from.data&&(c.from.data=this.lookupDataSource(c.from.data)),c.from&&c.from.facet&&c.from.facet.data&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c),this.parent=r,this.config=s,this.name=(l=t.name)!==null&&l!==void 0?l:i,this.title=Vg(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new PG,this.projectionNameMap=r?r.projectionNameMap:new PG,this.signalNameMap=r?r.signalNameMap:new PG,this.data=t.data,this.description=t.description,this.transforms=n4n((u=t.transform)!==null&&u!==void 0?u:[]),this.layout=n==="layer"||n==="unit"?{}:rRn(t,n,s),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:GW(t)||r&&r.component.data.isFaceted&&t.data===void 0},layoutSize:new $g,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},a?Gt(a):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){KLn(this)}parseProjection(){EXe(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){$Xe(this)}assembleGroupStyle(){var t,n;if(this.type==="unit"||this.type==="layer")return(n=(t=this.view)===null||t===void 0?void 0:t.style)!==null&&n!==void 0?n:"cell"}assembleEncodeFromView(t){const n=it(t,["style"]),r={};for(const i of Ie(n)){const s=n[i];s!==void 0&&(r[i]=ai(s))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=ai(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n!=null?n:{}):tr(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,r=it(t,["spacing"]),{component:i,config:s}=this,a=wPn(i.layoutHeaders,s);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),a?{titleBand:a}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of Au)t[r].title&&n.push(gPn(this,r));for(const r of ohe)n=n.concat(mPn(this,r));return n}assembleAxes(){return tPn(this.component.axes,this.config)}assembleLegends(){return _Xe(this)}assembleProjections(){return jPn(this)}assembleTitle(){var t,n,r;const i=(t=this.title)!==null&&t!==void 0?t:{},{encoding:s}=i,a=it(i,["encoding"]),o=Object.assign(Object.assign(Object.assign({},tYe(this.config.title).nonMark),a),s?{encode:{update:s}}:{});if(o.text)return ht(["unit","layer"],this.type)?ht(["middle",void 0],o.anchor)&&(o.frame=(n=o.frame)!==null&&n!==void 0?n:"group"):o.anchor=(r=o.anchor)!==null&&r!==void 0?r:"start",tr(o)?void 0:o}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||qc(this.parent)?IXe(this):[];i.length>0&&(n.scales=i);const s=this.assembleAxes();s.length>0&&(n.axes=s);const a=this.assembleLegends();return a.length>0&&(n.legends=a),n}getName(t){return Dr((this.name?this.name+"_":"")+t)}requestDataName(t){var n;const r=this.getName(t),i=this.component.data.outputNodeRefCounts;return i[r]=((n=i[r])!==null&&n!==void 0?n:0)+1,r}getSizeSignalRef(t){if(qc(this.parent)){const n=mXe(t),r=UW(n),i=this.component.scales[r];if(i&&!i.merged){const s=i.get("type"),a=i.get("range");if(pl(s)&&bv(a)){const o=i.get("name"),l=uV(this,r),u=dhe(l);if(u){const c=Me({aggregate:"distinct",field:u},{expr:"datum"});return{signal:gXe(o,i,c)}}else return Te(`Unknown field for ${r}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(iGe(t)&&yv(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(EMn(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))}}class zXe extends ghe{vgField(t,n={}){const r=this.fieldDef(t);if(!!r)return Me(r,n)}reduceFieldDef(t,n){return lYe(this.getMapping(),(r,i,s)=>{const a=Qh(i);return a?t(r,a,s):r},n)}forEachFieldDef(t,n){Vfe(this.getMapping(),(r,i)=>{const s=Qh(r);s&&t(s,i)},n)}}class cV extends Zn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Gt(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:"value",(s=a[1])!==null&&s!==void 0?s:"density"]}clone(){return new cV(null,Gt(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${gn(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,r=it(t,["density"]);return Object.assign({type:"kde",field:n},r)}}class jD extends Zn{constructor(t,n){super(t),this.filter=n}clone(){return new jD(null,Object.assign({},this.filter))}static make(t,n){const{config:r,mark:i,markDef:s}=n;if(Ln("invalid",s,r)!=="filter")return null;const o=n.reduceFieldDef((l,u,c)=>{const f=yv(c)&&n.getScaleComponent(c);if(f){const h=f.get("type");qu(h)&&u.aggregate!=="count"&&!Lx(i)&&(l[u.field]=u)}return l},{});return Ie(o).length?new jD(t,o):null}dependentFields(){return new Set(Ie(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${gn(this.filter)}`}assemble(){const t=Ie(this.filter).reduce((n,r)=>{const i=this.filter[r],s=Me(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${s}) || (isValid(${s}) && isFinite(+${s})))`):i.type==="quantitative"&&(n.push(`isValid(${s})`),n.push(`isFinite(+${s})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class fV extends Zn{constructor(t,n){super(t),this.transform=n,this.transform=Gt(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((s,a)=>{var o;return(o=i[a])!==null&&o!==void 0?o:s})}clone(){return new fV(this.parent,Gt(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${gn(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class hV extends Zn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Gt(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:"key",(s=a[1])!==null&&s!==void 0?s:"value"]}clone(){return new hV(null,Gt(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${gn(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class yw extends Zn{constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}clone(){return new yw(null,Gt(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[wd,xd],[ju,_f]]){const s=i.map(a=>{const o=Ti(n.encoding[a]);return Le(o)?o.field:xv(o)?{expr:`${o.datum}`}:Xp(o)?{expr:`${o.value}`}:void 0});(s[0]||s[1])&&(t=new yw(t,s,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(dl)){const i=n.typedFieldDef(dl);i.type===ES&&(t=new yw(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(qt);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${gn(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class HD extends Zn{constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}clone(){return new HD(null,this.projection,Gt(this.fields),Gt(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[wd,xd],[ju,_f]]){const i=r.map(a=>{const o=Ti(n.encoding[a]);return Le(o)?o.field:xv(o)?{expr:`${o.datum}`}:Xp(o)?{expr:`${o.value}`}:void 0}),s=r[0]===ju?"2":"";(i[0]||i[1])&&(t=new HD(t,n.projectionName(),i,[n.getName("x"+s),n.getName("y"+s)]))}return t}dependentFields(){return new Set(this.fields.filter(qt))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${gn(this.fields)} ${gn(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class wy extends Zn{constructor(t,n){super(t),this.transform=n}clone(){return new wy(null,Gt(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new wy(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,s=r.y;if(Le(i)&&Le(s)){const a=i.impute?i:s.impute?s:void 0;if(a===void 0)return;const o=i.impute?s:s.impute?i:void 0,{method:l,value:u,frame:c,keyvals:f}=a.impute,h=uYe(n.mark,r);return new wy(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:a.field,key:o.field},l?{method:l}:{}),u!==void 0?{value:u}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),h.length?{groupby:h}:{}))}return null}hash(){return`Impute ${gn(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:s,value:a,frame:o=[null,null]}=this.transform,l=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:RRn(r)?this.processSequence(r):r}:{}),{method:"value"}),s?{groupby:s}:{}),{value:!i||i==="value"?a:null});if(i&&i!=="value"){const u=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:o,ignorePeers:!1},s?{groupby:s}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[l,u,c]}else return[l]}}class dV extends Zn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Gt(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:n.on,(s=a[1])!==null&&s!==void 0?s:n.loess]}clone(){return new dV(null,Gt(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${gn(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:r}=t,i=it(t,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},i)}}class qD extends Zn{constructor(t,n,r){super(t),this.transform=n,this.secondary=r}clone(){return new qD(null,Gt(this.transform),this.secondary)}static make(t,n,r,i){const s=n.component.data.sources,{from:a}=r;let o=null;if(LRn(a)){let l=VXe(a.data,s);l||(l=new iC(a.data),s.push(l));const u=n.getName(`lookup_${i}`);o=new ho(l,u,"lookup",n.component.data.outputNodeRefCounts),n.component.data.outputNodes[u]=o}else if(BRn(a)){const l=a.selection;if(r=Object.assign({as:l},r),o=n.getSelectionComponent(Dr(l),l).materialized,!o)throw new Error(DMn(l))}return new qD(t,r,o.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?ci(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${gn({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:ci(this.transform.as)}:{});else{let n=this.transform.as;qt(n)||(Te(OMn),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class pV extends Zn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Gt(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:"prob",(s=a[1])!==null&&s!==void 0?s:"value"]}clone(){return new pV(null,Gt(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${gn(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,r=it(t,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}class gV extends Zn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Gt(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:n.on,(s=a[1])!==null&&s!==void 0?s:n.regression]}clone(){return new gV(null,Gt(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${gn(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:r}=t,i=it(t,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},i)}}class mV extends Zn{constructor(t,n){super(t),this.transform=n}clone(){return new mV(null,Gt(this.transform))}addDimensions(t){var n;this.transform.groupby=f0(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),r=>r)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${gn(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:s}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==void 0?{limit:i}:{}),s!==void 0?{op:s}:{}),r!==void 0?{groupby:r}:{})}}class vV extends Zn{constructor(t,n){super(t),this.transform=n}clone(){return new vV(null,Gt(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${gn(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function UXe(e){let t=0;function n(r,i){var s;if(r instanceof iC&&!r.isGenerator&&!zD(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof xa&&(r.parent instanceof iC&&!i.source?(i.format=Object.assign(Object.assign({},(s=i.format)!==null&&s!==void 0?s:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof DS){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source;for(const a of r.assemble())e.push(a);return}switch((r instanceof EF||r instanceof AF||r instanceof jD||r instanceof TS||r instanceof tC||r instanceof HD||r instanceof yw||r instanceof Hc||r instanceof qD||r instanceof NS||r instanceof jx||r instanceof hV||r instanceof fV||r instanceof cV||r instanceof dV||r instanceof pV||r instanceof gV||r instanceof Fm||r instanceof vV||r instanceof mV)&&i.transform.push(r.assemble()),(r instanceof Ch||r instanceof $h||r instanceof wy||r instanceof kp)&&i.transform.push(...r.assemble()),r instanceof ho&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof ho?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof ho&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let a=i.name;!i.source||i.transform.length>0?e.push(i):a=i.source;for(const o of r.children)n(o,{name:null,source:a,transform:[]});break}}}return n}function e6n(e){const t=[],n=UXe(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function t6n(e,t){var n,r;const i=[],s=UXe(i);let a=0;for(const l of e.sources){l.hasName()||(l.dataName=`source_${a++}`);const u=l.assemble();s(l,u)}for(const l of i)l.transform.length===0&&delete l.transform;let o=0;for(const[l,u]of i.entries())((n=u.transform)!==null&&n!==void 0?n:[]).length===0&&!u.source&&i.splice(o++,0,i.splice(l,1)[0]);for(const l of i)for(const u of(r=l.transform)!==null&&r!==void 0?r:[])u.type==="lookup"&&(u.from=e.outputNodes[u.from].getSource());for(const l of i)l.name in t&&(l.values=t[l.name]);return i}function n6n(e){return e==="top"||e==="left"||wt(e)?"header":"footer"}function r6n(e){for(const t of Au)i6n(e,t);W_e(e,"x"),W_e(e,"y")}function i6n(e,t){var n;const{facet:r,config:i,child:s,component:a}=e;if(e.channelHasField(t)){const o=r[t],l=rC("title",null,i,t);let u=yy(o,i,{allowDisabling:!0,includeDefault:l===void 0||!!l});s.component.layoutHeaders[t].title&&(u=ut(u)?u.join(", "):u,u+=" / "+s.component.layoutHeaders[t].title,s.component.layoutHeaders[t].title=null);const c=rC("labelOrient",o,i,t),f=(n=o.header)!==null&&n!==void 0?n:{},h=bi(f.labels,i.header.labels,!0),d=ht(["bottom","right"],c)?"footer":"header";a.layoutHeaders[t]={title:u,facetFieldDef:o,[d]:t==="facet"?[]:[WXe(e,t,h)]}}}function WXe(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function W_e(e,t){var n;const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:i,resolve:s}=e.component;if(s.axis[t]=che(s,t),s.axis[t]==="shared"){const a=t==="x"?"column":"row",o=i[a];for(const l of r.component.axes[t]){const u=n6n(l.get("orient"));o[u]=(n=o[u])!==null&&n!==void 0?n:[WXe(e,a,!1)];const c=eA(l,"main",e.config,{header:!0});c&&o[u][0].axes.push(c),l.mainExtracted=!0}}}}function s6n(e){mhe(e),P8(e,"width"),P8(e,"height")}function a6n(e){mhe(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";P8(e,t),P8(e,n)}function mhe(e){for(const t of e.children)t.parseLayoutSize()}function P8(e,t){const n=mXe(t),r=UW(n),i=e.component.resolve,s=e.component.layoutSize;let a;for(const o of e.children){const l=o.component.layoutSize.getWithExplicit(n),u=i.scale[r];if(u==="independent"&&l.value==="step"){a=void 0;break}if(a){if(u==="independent"&&a.value!==l.value){a=void 0;break}a=Nm(a,l,n,"")}else a=l}if(a){for(const o of e.children)e.renameSignal(o.getName(n),e.getName(t)),o.component.layoutSize.set(n,"merged",!1);s.setWithExplicit(t,a)}else s.setWithExplicit(t,{explicit:!1,value:void 0})}function o6n(e){const{size:t,component:n}=e;for(const r of Hu){const i=Sd(r);if(t[i]){const s=t[i];n.layoutSize.set(i,Jh(s)?"step":s,!0)}else{const s=l6n(e,i);n.layoutSize.set(i,s,!1)}}}function l6n(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const s=i.get("type"),a=i.get("range");if(pl(s)){const o=BD(r.view,t);return bv(a)||Jh(o)?"step":o}else return kJ(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return kJ(r.view,t);{const s=BD(r.view,t);return Jh(s)?s.step:s}}}function WJ(e,t,n){return Me(t,Object.assign({suffix:`by_${Me(e)}`},n!=null?n:{}))}class qA extends zXe{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve),this.child=xhe(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet,i)}initFacet(t,n){return bF(t)?lYe(t,(r,i,s)=>ht([Cp,_p],s)?i.field===void 0?(Te(wJ(i,s)),r):(r[s]=_J(i,s,n),r):(Te(jW(s,"facet")),r),{}):{facet:_J(t,"facet",n)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=yV(this),this.child.parseData()}parseLayoutSize(){mhe(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),r6n(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,r;const i={};for(const s of Au)for(const a of lhe){const o=this.component.layoutHeaders[s],l=o[a],{facetFieldDef:u}=o;if(u){const c=rC("titleOrient",u,this.config,s);if(ht(["right","bottom"],c)){const f=aV(s,c);i.titleAnchor=(t=i.titleAnchor)!==null&&t!==void 0?t:{},i.titleAnchor[f]="end"}}if(l!=null&&l[0]){const c=s==="row"?"height":"width",f=a==="header"?"headerBand":"footerBand";s!=="facet"&&!this.child.component.layoutSize.get(c)&&(i[f]=(n=i[f])!==null&&n!==void 0?n:{},i[f][s]=.5),o.title&&(i.offset=(r=i.offset)!==null&&r!==void 0?r:{},i.offset[s==="row"?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof qA))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof qA?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Me(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof qA){if(this.child.channelHasField("column")){const i=Me(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of Hu){const s=this.child.component.scales[i];if(s&&!s.merged){const a=s.get("type"),o=s.get("range");if(pl(a)&&bv(o)){const l=uV(this.child,i),u=dhe(l);u?(t.push(u),n.push("distinct"),r.push(`distinct_${u}`)):Te(`Unknown field for ${i}. Cannot calculate view size.`)}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:s,ops:a,as:o}=this.getCardinalityAggregateForChild(),l=[];for(const c of Au){const f=this.facet[c];if(f){l.push(Me(f));const{bin:h,sort:d}=f;if(hr(h)&&l.push(Me(f,{binSuffix:"end"})),wh(d)){const{field:p,op:g=qW}=d,m=WJ(f,d);r&&i?(s.push(m),a.push("max"),o.push(m)):(s.push(p),a.push(g),o.push(m))}else if(ut(d)){const p=nC(f,c);s.push(p),a.push("max"),o.push(p)}}}const u=!!r&&!!i;return Object.assign({name:t,data:n,groupby:l},u||s.length>0?{aggregate:Object.assign(Object.assign({},u?{cross:u}:{}),s.length?{fields:s,ops:a,as:o}:{})}:{})}facetSortFields(t){const{facet:n}=this,r=n[t];return r?wh(r.sort)?[WJ(r,r.sort,{expr:"datum"})]:ut(r.sort)?[nC(r,t,{expr:"datum"})]:[Me(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(wh(i)?i.order:!ut(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return RJ(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const i of ohe)if(t[i]){const s=rC("labelOrient",t[i],n,i);if(ht(r[i],s))return RJ(t[i],i,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=e6n(n),i=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),a=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},s?{title:s}:{}),a?{style:a}:{}),{from:{facet:this.assembleFacet()},sort:{field:Au.map(l=>this.facetSortFields(l)).flat(),order:Au.map(l=>this.facetSortOrder(l)).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(k4n(this,[])))]}getMapping(){return this.facet}}function u6n(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const s of[n,r])if(wh(s.sort)){const{field:a,op:o=qW}=s.sort;e=i=new jx(e,{joinaggregate:[{op:o,field:a,as:WJ(s,s.sort,{forAs:!0})}],groupby:[Me(s)]})}return i}return null}function VXe(e,t){var n,r,i,s,a,o,l,u,c,f;for(const h of t){const d=h.data;if(!(e.name&&h.hasName()&&e.name!==h.dataName)&&!(((n=e.format)===null||n===void 0?void 0:n.mesh)&&((r=d.format)===null||r===void 0?void 0:r.feature))&&!((((i=e.format)===null||i===void 0?void 0:i.feature)||((s=d.format)===null||s===void 0?void 0:s.feature))&&((a=e.format)===null||a===void 0?void 0:a.feature)!==((o=d.format)===null||o===void 0?void 0:o.feature))&&!((((l=e.format)===null||l===void 0?void 0:l.mesh)||((u=d.format)===null||u===void 0?void 0:u.mesh))&&((c=e.format)===null||c===void 0?void 0:c.mesh)!==((f=d.format)===null||f===void 0?void 0:f.mesh))){if(N8(e)&&N8(d)){if(pF(e.values,d.values))return h}else if(zD(e)&&zD(d)){if(e.url===d.url)return h}else if(TYe(e)&&e.name===h.dataName)return h}}return null}function c6n(e,t){if(e.data||!e.parent){if(e.data===null){const r=new iC({values:[]});return t.push(r),r}const n=VXe(e.data,t);if(n)return xy(e.data)||(n.data.format=TIn({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new iC(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function f6n(e,t,n){var r,i;let s=0;for(const a of t.transforms){let o,l;if(XRn(a))l=e=new tC(e,a),o="derived";else if(IYe(a)){const u=rLn(a);l=e=(r=xa.makeWithAncestors(e,{},u,n))!==null&&r!==void 0?r:e,e=new TS(e,t,a.filter)}else if(KRn(a))l=e=Ch.makeFromTransform(e,a,t),o="number";else if(QRn(a))o="date",n.getWithExplicit(a.field).value===void 0&&(e=new xa(e,{[a.field]:o}),n.set(a.field,o,!1)),l=e=$h.makeFromTransform(e,a);else if(JRn(a))l=e=Hc.makeFromTransform(e,a),o="number",rhe(t)&&(e=new Fm(e));else if(PRn(a))l=e=qD.make(e,t,a,s++),o="derived";else if(qRn(a))l=e=new NS(e,a),o="number";else if(GRn(a))l=e=new jx(e,a),o="number";else if(e4n(a))l=e=kp.makeFromTransform(e,a),o="derived";else if(t4n(a))l=e=new hV(e,a),o="derived";else if(YRn(a))l=e=new fV(e,a),o="derived";else if(zRn(a))l=e=new mV(e,a),o="derived";else if(HRn(a))e=new vV(e,a);else if(ZRn(a))l=e=wy.makeFromTransform(e,a),o="derived";else if(URn(a))l=e=new cV(e,a),o="derived";else if(WRn(a))l=e=new pV(e,a),o="derived";else if(VRn(a))l=e=new gV(e,a),o="derived";else if(jRn(a))l=e=new dV(e,a),o="derived";else{Te(FMn(a));continue}if(l&&o!==void 0)for(const u of(i=l.producedFields())!==null&&i!==void 0?i:[])n.set(u,o,!1)}return e}function yV(e){var t,n,r,i,s,a,o,l,u,c;let f=c6n(e,e.component.data.sources);const{outputNodes:h,outputNodeRefCounts:d}=e.component.data,p=e.parent?e.parent.component.data.ancestorParse.clone():new ORn,g=e.data;xy(g)?(DYe(g)?f=new AF(f,g.sequence):Qfe(g)&&(f=new EF(f,g.graticule)),p.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(p.parseNothing=!0),f=(n=xa.makeExplicit(f,e,p))!==null&&n!==void 0?n:f,f=new Fm(f);const m=e.parent&&IS(e.parent);(qr(e)||qc(e))&&m&&(f=(r=Ch.makeFromEncoding(f,e))!==null&&r!==void 0?r:f),e.transforms.length>0&&(f=f6n(f,e,p));const v=sLn(e),y=iLn(e);f=(i=xa.makeWithAncestors(f,{},Object.assign(Object.assign({},v),y),p))!==null&&i!==void 0?i:f,qr(e)&&(f=yw.parseAll(f,e),f=HD.parseAll(f,e)),(qr(e)||qc(e))&&(m||(f=(s=Ch.makeFromEncoding(f,e))!==null&&s!==void 0?s:f),f=(a=$h.makeFromEncoding(f,e))!==null&&a!==void 0?a:f,f=tC.parseAllForSortIndex(f,e));const b=e.getName(I8),x=new ho(f,b,I8,d);if(h[b]=x,f=x,qr(e)){const _=Hc.makeFromEncoding(f,e);_&&(f=_,rhe(e)&&(f=new Fm(f))),f=(o=wy.makeFromEncoding(f,e))!==null&&o!==void 0?o:f,f=(l=kp.makeFromEncoding(f,e))!==null&&l!==void 0?l:f}qr(e)&&(f=(u=jD.make(f,e))!==null&&u!==void 0?u:f);const w=e.getName(ha),C=new ho(f,w,ha,d);h[w]=C,f=C,qr(e)&&J5n(e,C);let $=null;if(qc(e)){const _=e.getName("facet");f=(c=u6n(f,e.facet))!==null&&c!==void 0?c:f,$=new DS(f,e,_,C.getSource()),h[_]=$}return Object.assign(Object.assign({},e.component.data),{outputNodes:h,outputNodeRefCounts:d,raw:x,main:C,facetRoot:$,ancestorParse:p})}class h6n extends ghe{constructor(t,n,r,i){var s,a,o,l;super(t,"concat",n,r,i,t.resolve),(((a=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||a===void 0?void 0:a.x)==="shared"||((l=(o=t.resolve)===null||o===void 0?void 0:o.axis)===null||l===void 0?void 0:l.y)==="shared")&&Te(IMn),this.children=this.getChildren(t).map((u,c)=>xhe(u,this,this.getName("concat_"+c),void 0,i))}parseData(){this.component.data=yV(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Ie(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return ZW(t)?t.vconcat:Kfe(t)?t.hconcat:t.concat}parseLayoutSize(){a6n(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=uhe(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),r?{style:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup())})}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function d6n(e){return e===!1||e===null}const p6n=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},qqe),{labelExpr:1,encode:1}),jXe=Ie(p6n);class vhe extends $g{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new vhe(Gt(this.explicit),Gt(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!d6n(this.get(t))}hasOrientSignalRef(){return wt(this.explicit.orient)}}function g6n(e,t,n){var r;const{encoding:i,config:s}=e,a=(r=Ti(i[t]))!==null&&r!==void 0?r:Ti(i[_d(t)]),o=e.axis(t)||{},{format:l,formatType:u}=o;return _b(u)?Object.assign({text:Ife({fieldOrDatumDef:a,field:"datum.value",format:l,formatType:u,config:s})},n):n}function m6n(e){return Hu.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[C6n(n,e)]),t),{})}const v6n={bottom:"top",top:"bottom",left:"right",right:"left"};function y6n(e){var t;const{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(const s of e.children){s.parseAxesAndHeaders();for(const a of Ie(s.component.axes))r.axis[a]=che(e.component.resolve,a),r.axis[a]==="shared"&&(n[a]=b6n(n[a],s.component.axes[a]),n[a]||(r.axis[a]="independent",delete n[a]))}for(const s of Hu){for(const a of e.children)if(!!a.component.axes[s]){if(r.axis[s]==="independent"){n[s]=((t=n[s])!==null&&t!==void 0?t:[]).concat(a.component.axes[s]);for(const o of a.component.axes[s]){const{value:l,explicit:u}=o.getWithExplicit("orient");if(!wt(l)){if(i[l]>0&&!u){const c=v6n[l];i[l]>i[c]&&o.set("orient",c,!1)}i[l]++}}}delete a.component.axes[s]}if(r.axis[s]==="independent"&&n[s]&&n[s].length>1)for(const a of n[s])!!a.get("grid")&&!a.explicit.grid&&(a.implicit.grid=!1)}}function b6n(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],s=t[r];if(!!i!=!!s)return;if(i&&s){const a=i.getWithExplicit("orient"),o=s.getWithExplicit("orient");if(a.explicit&&o.explicit&&a.value!==o.value)return;e[r]=x6n(i,s)}}}else return t.map(n=>n.clone());return e}function x6n(e,t){for(const n of jXe){const r=Nm(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,s)=>{switch(n){case"title":return oYe(i,s);case"gridScale":return{explicit:i.explicit,value:bi(i.value,s.value)}}return JW(i,s,n,"axis")});e.setWithExplicit(n,r)}return e}function w6n(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(wt(n.labelAngle)?n.labelAngle:w8(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===fXe(r,i))return!0}return e===n[t]}const $6n=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function C6n(e,t){var n,r,i;let s=t.axis(e);const a=new vhe,o=Ti(t.encoding[e]),{mark:l,config:u}=t,c=(s==null?void 0:s.orient)||((n=u[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=u.axis)===null||r===void 0?void 0:r.orient)||fPn(e),f=t.getScaleComponent(e).get("type"),h=iPn(e,f,c,t.config),d=s!==void 0?!s:FJ("disable",u,s==null?void 0:s.style,h).configValue;if(a.set("disable",d,s!==void 0),d)return a;s=s||{};const p=lPn(t,s,e,o,h),g={fieldOrDatumDef:o,axis:s,channel:e,model:t,scaleType:f,orient:c,labelAngle:p,mark:l,config:u};for(const y of jXe){const b=y in E_e?E_e[y](g):RCe(y)?s[y]:void 0,x=b!==void 0,w=w6n(b,y,s,t,e);if(x&&w)a.set(y,b,w);else{const{configValue:C=void 0,configFrom:$=void 0}=RCe(y)&&y!=="values"?FJ(y,t.config,s.style,h):{},_=C!==void 0;x&&!_?a.set(y,b,w):($!=="vgAxisConfig"||$6n.has(y)&&_||ufe(C)||wt(C))&&a.set(y,C,!1)}}const m=(i=s.encoding)!==null&&i!==void 0?i:{},v=Hqe.reduce((y,b)=>{var x;if(!a.hasAxisPart(b))return y;const w=vXe((x=m[b])!==null&&x!==void 0?x:{},t),C=b==="labels"?g6n(t,e,w):w;return C!==void 0&&!tr(C)&&(y[b]={update:C}),y},{});return tr(v)||a.set("encode",v,!!s.encoding||s.labelAngle!==void 0),a}function _6n({encoding:e,size:t}){for(const n of Hu){const r=Sd(n);Jh(t[r])&&nh(e[n])&&(delete t[r],Te(pGe(r)))}return t}function S6n(e,t,n,{graticule:r}){const i=Kh(e)?Object.assign({},e):{type:e},s=Ln("orient",i,n);if(i.orient=T6n(i.type,t,s),s!==void 0&&s!==i.orient&&Te(YMn(i.orient,s)),i.type==="bar"&&i.orient){const u=Ln("cornerRadiusEnd",i,n);if(u!==void 0){const c=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:XIn[i.orient];for(const f of c)i[f]=u;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return Ln("opacity",i,n)===void 0&&(i.opacity=E6n(i.type,t)),i.filled===void 0&&(i.filled=r?!1:A6n(i,n)),Ln("cursor",i,n)===void 0&&(i.cursor=k6n(i,t,n)),i}function k6n(e,t,n){return t.href||e.href||Ln("href",e,n)?"pointer":e.cursor}function E6n(e,t){if(ht([FW,cfe,ffe,hfe],e)&&!Ufe(t))return .7}function A6n(e,t){const n=Sb("filled",e,t),r=e.type;return bi(n,r!==FW&&r!==MW&&r!==$8)}function T6n(e,t,n){switch(e){case FW:case ffe:case hfe:case Yqe:case UIn:case zIn:return}const{x:r,y:i,x2:s,y2:a}=t;switch(e){case IW:if(Le(r)&&(to(r.bin)||Le(i)&&i.aggregate&&!r.aggregate))return"vertical";if(Le(i)&&(to(i.bin)||Le(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(a||s){if(n)return n;if(!s&&(Le(r)&&r.type===Cb&&!hr(r.bin)||CJ(r)))return"horizontal";if(!a&&(Le(i)&&i.type===Cb&&!hr(i.bin)||CJ(i)))return"vertical"}case $8:if(s&&!(Le(r)&&to(r.bin))&&a&&!(Le(i)&&to(i.bin)))return;case NW:if(a)return Le(i)&&to(i.bin)?"horizontal":"vertical";if(s)return Le(r)&&to(r.bin)?"vertical":"horizontal";if(e===$8){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case MW:case cfe:{const o=nh(r),l=nh(i);if(o&&!l)return e!=="tick"?"horizontal":"vertical";if(!o&&l)return e!=="tick"?"vertical":"horizontal";if(o&&l){const u=r,c=i,f=u.type===Q$,h=c.type===Q$;return f&&!h?e!=="tick"?"vertical":"horizontal":!f&&h?e!=="tick"?"horizontal":"vertical":!u.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":u.aggregate&&!c.aggregate?e!=="tick"?"horizontal":"vertical":n||"vertical"}else return n||void 0}}return"vertical"}const D6n={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qu(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ya("x",e,{defaultPos:"mid"})),ya("y",e,{defaultPos:"mid"})),Im(e,"radius","arc")),Im(e,"theta","arc"))},N6n={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Qu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),M8("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),M8("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),the(e))},I6n={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Qu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Im(e,"x","bar")),Im(e,"y","bar"))},M6n={vgMark:"shape",encodeEntry:e=>Object.assign({},Qu(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&Le(n)&&n.type===ES?{field:Me(n,{expr:"datum"})}:{})]}},F6n={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Qu(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Im(e,"x","image")),Im(e,"y","image")),Jfe(e,"url"))},O6n={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qu(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ya("x",e,{defaultPos:"mid"})),ya("y",e,{defaultPos:"mid"})),Ji("size",e,{vgChannel:"strokeWidth"})),the(e))},R6n={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qu(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ya("x",e,{defaultPos:"mid"})),ya("y",e,{defaultPos:"mid"})),Ji("size",e)),the(e))};function yhe(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qu(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ya("x",e,{defaultPos:"mid"})),ya("y",e,{defaultPos:"mid"})),Ji("size",e)),Ji("angle",e)),P6n(e,n,t))}function P6n(e,t,n){return n?{shape:{value:n}}:Ji("shape",e)}const L6n={vgMark:"symbol",encodeEntry:e=>yhe(e)},B6n={vgMark:"symbol",encodeEntry:e=>yhe(e,"circle")},z6n={vgMark:"symbol",encodeEntry:e=>yhe(e,"square")},U6n={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Qu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Im(e,"x","rect")),Im(e,"y","rect"))},W6n={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Qu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),M8("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),M8("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),Ji("size",e,{vgChannel:"strokeWidth"}))}},V6n={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qu(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),ya("x",e,{defaultPos:"mid"})),ya("y",e,{defaultPos:"mid"})),Jfe(e)),Ji("size",e,{vgChannel:"fontSize"})),Ji("angle",e)),m_e("align",j6n(e.markDef,n,t))),m_e("baseline",H6n(e.markDef,n,t))),ya("radius",e,{defaultPos:null,isMidPoint:!0})),ya("theta",e,{defaultPos:null,isMidPoint:!0}))}};function j6n(e,t,n){if(Ln("align",e,n)===void 0)return"center"}function H6n(e,t,n){if(Ln("baseline",e,n)===void 0)return"middle"}const q6n={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",s=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ya("x",e,{defaultPos:"mid",vgChannel:"xc"})),ya("y",e,{defaultPos:"mid",vgChannel:"yc"})),Ji("size",e,{defaultValue:G6n(e),vgChannel:i})),{[s]:ai(Ln("thickness",n,t))})}};function G6n(e){var t;const{config:n,markDef:r}=e,{orient:i}=r,s=i==="horizontal"?"width":"height",a=e.getScaleComponent(i==="horizontal"?"x":"y"),o=(t=Ln("size",r,n,{vgChannel:s}))!==null&&t!==void 0?t:n.tick.bandSize;if(o!==void 0)return o;{const l=a?a.get("range"):void 0;return l&&bv(l)&&yi(l.step)?l.step*3/4:D8(n.view,s)*3/4}}const LR={arc:D6n,area:N6n,bar:I6n,circle:B6n,geoshape:M6n,image:F6n,line:O6n,point:L6n,rect:U6n,rule:W6n,square:z6n,text:V6n,tick:q6n,trail:R6n};function Y6n(e){return ht([MW,NW,WIn],e.mark)?X6n(e):ht([IW],e.mark)?K6n(e):L8(e)}const V_e="faceted_path_";function X6n(e){const t=uYe(e.mark,e.encoding),n=L8(e,{fromPrefix:t.length>0?V_e:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:V_e+e.requestDataName(ha),data:e.requestDataName(ha),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}const j_e="stack_group_";function K6n(e){const t=SG.some(n=>Ln(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t){const[n]=L8(e,{fromPrefix:j_e}),r=e.scaleName(e.stack.fieldChannel),i=(f={})=>e.vgField(e.stack.fieldChannel,f),s=(f,h)=>{const d=[i({prefix:"min",suffix:"start",expr:h}),i({prefix:"max",suffix:"start",expr:h}),i({prefix:"min",suffix:"end",expr:h}),i({prefix:"max",suffix:"end",expr:h})];return`${f}(${d.map(p=>`scale('${r}',${p})`).join(",")})`};let a,o;e.stack.fieldChannel==="x"?(a=Object.assign(Object.assign({},FD(n.encode.update,["y","yc","y2","height",...SG])),{x:{signal:s("min","datum")},x2:{signal:s("max","datum")},clip:{value:!0}}),o={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},$p(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(a=Object.assign(Object.assign({},FD(n.encode.update,["x","xc","x2","width"])),{y:{signal:s("min","datum")},y2:{signal:s("max","datum")},clip:{value:!0}}),o={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},$p(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const f of SG){const h=Sb(f,e.markDef,e.config);n.encode.update[f]?(a[f]=n.encode.update[f],delete n.encode.update[f]):h&&(a[f]=ai(h)),h&&(n.encode.update[f]={value:0})}const l=e.fieldDef(e.stack.groupbyChannel),u=Me(l)?[Me(l)]:[];return((l==null?void 0:l.bin)||(l==null?void 0:l.timeUnit))&&u.push(Me(l,{binSuffix:"end"})),a=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((f,h)=>{if(n.encode.update[h])return Object.assign(Object.assign({},f),{[h]:n.encode.update[h]});{const d=Sb(h,e.markDef,e.config);return d!==void 0?Object.assign(Object.assign({},f),{[h]:ai(d)}):f}},a),a.stroke&&(a.strokeForeground={value:!0},a.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(ha),name:j_e+e.requestDataName(ha),groupby:u,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:a},marks:[{type:"group",encode:{update:o},marks:[n]}]}]}else return L8(e)}function Z6n(e){const{encoding:t,stack:n,mark:r,markDef:i,config:s}=e,a=t.order;if(!(!ut(a)&&Xp(a)&&MCe(a.value)||!a&&MCe(Ln("order",i,s)))){if((ut(a)||Le(a))&&!n)return iYe(a,{expr:"datum"});if(Lx(r)){const o=i.orient==="horizontal"?"y":"x",l=t[o];if(Le(l)){const u=l.sort;if(ut(u))return{field:Me(l,{prefix:o,suffix:"sort_index",expr:"datum"})};if(wh(u))return{field:Me({aggregate:Ufe(e.encoding)?u.op:void 0,field:u.field},{expr:"datum"})};if(WGe(u)){const c=e.fieldDef(u.encoding);return{field:Me(c,{expr:"datum"}),order:u.order}}else return u===null?void 0:{field:Me(l,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}return}}}function L8(e,t={fromPrefix:""}){const{mark:n,markDef:r,config:i}=e,s=bi(r.clip,Q6n(e),J6n(e)),a=nYe(r),o=e.encoding.key,l=Z6n(e),u=e8n(e),c=Ln("aria",r,i),f=LR[n].postEncodingTransform?LR[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:LR[n].vgMark},s?{clip:!0}:{}),a?{style:a}:{}),o?{key:o.field}:{}),l?{sort:l}:{}),u||{}),c===!1?{aria:c}:{}),{from:{data:t.fromPrefix+e.requestDataName(ha)},encode:{update:LR[n].encodeEntry(e)}}),f?{transform:f}:{})]}function Q6n(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function J6n(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function e8n(e){if(!e.component.selection)return null;const t=Ie(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=Ie(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}class HXe extends zXe{constructor(t,n,r,i={},s){var a,o;super(t,"unit",n,r,s,void 0,t_e(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const l=Kh(t.mark)?t.mark.type:t.mark;this.markDef=S6n(t.mark,(a=t.encoding)!==null&&a!==void 0?a:{},s,{graticule:t.data&&Qfe(t.data)});const u=this.encoding=MOn((o=t.encoding)!==null&&o!==void 0?o:{},this.markDef,s);this.size=_6n({encoding:u,size:t_e(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i}),this.stack=_Ye(l,u),this.specifiedScales=this.initScales(l,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegend(u),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,n=this.mark===Xqe,r=t&&cMn.some(i=>kt(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return WW.reduce((r,i)=>{var s;const a=Ti(n[i]);return a&&(r[i]=(s=a.scale)!==null&&s!==void 0?s:{}),r},{})}initAxes(t){return Hu.reduce((n,r)=>{const i=t[r];if(kt(i)||r===Ur&&kt(t.x2)||r===Ii&&kt(t.y2)){const s=kt(i)?i.axis:void 0;n[r]=s&&Object.assign({},s)}return n},{})}initLegend(t){return yMn.reduce((n,r)=>{const i=Ti(t[r]);if(i&&xMn(r)){const s=i.legend;n[r]=s&&Object.assign({},s)}return n},{})}parseData(){this.component.data=yV(this)}parseLayoutSize(){o6n(this)}parseSelections(){this.component.selection=Q5n(this,this.selection)}parseMarkGroup(){this.component.mark=Y6n(this)}parseAxesAndHeaders(){this.component.axes=m6n(this)}assembleSelectionTopLevelSignals(t){return E4n(this,t)}assembleSignals(){return[...aXe(this),...S4n(this,[])]}assembleSelectionData(t){return A4n(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return uhe(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!IS(this.parent))&&(n=qYe(this,n)),n.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return by(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Qh(n)}typedFieldDef(t){const n=this.fieldDef(t);return Zl(n)?n:null}}class bhe extends ghe{constructor(t,n,r,i,s){super(t,"layer",n,r,s,t.resolve,t.view);const a=Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((o,l)=>{if(QW(o))return new bhe(o,this,this.getName("layer_"+l),a,s);if(vg(o))return new HXe(o,this,this.getName("layer_"+l),a,s);throw new Error(yfe(o))})}parseData(){this.component.data=yV(this);for(const t of this.children)t.parseData()}parseLayoutSize(){s6n(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Ie(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){y6n(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),aXe(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),uhe(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return T4n(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),_Xe(this))}}function xhe(e,t,n,r,i){if(GW(e))return new qA(e,t,n,i);if(QW(e))return new bhe(e,t,n,r,i);if(vg(e))return new HXe(e,t,n,r,i);if(eRn(e))return new h6n(e,t,n,i);throw new Error(yfe(e))}function t8n(e,t={}){t.logger&&bFn(t.logger),t.fieldTitle&&ZGe(t.fieldTitle);try{const n=$Ye(Pqe(t.config,e.config)),r=EYe(e,n),i=xhe(r,null,"",void 0,n);return i.parse(),wLn(i.component.data,i),{spec:r8n(i,n8n(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&xFn(),t.fieldTitle&&kOn()}}function n8n(e,t,n,r){const i=r.component.layoutSize.get("width"),s=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):qt(t)&&(t={type:t}),i&&s&&IRn(t.type)){if(i==="step"&&s==="step")Te(WCe()),t.type="pad";else if(i==="step"||s==="step"){const a=i==="step"?"width":"height";Te(WCe(UW(a)));const o=a==="width"?"height":"width";t.type=MRn(o)}}return Object.assign(Object.assign(Object.assign({},Ie(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),h_e(n)),h_e(e))}function r8n(e,t,n={},r){const i=e.config?hRn(e.config):void 0,s=[].concat(e.assembleSelectionData([]),t6n(e.component.data,n)),a=e.assembleProjections(),o=e.assembleTitle(),l=e.assembleGroupStyle(),u=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();return c=c.filter(f=>(f.name==="width"||f.name==="height")&&f.value!==void 0?(t[f.name]=+f.value,!1):!0),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),o?{title:o}:{}),l?{style:l}:{}),u?{encode:{update:u}}:{}),{data:s}),a.length>0?{projections:a}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}class i8n extends CYe{mapUnit(t,{config:n}){if(t.encoding){const{encoding:r,transform:i}=t,{bins:s,timeUnits:a,aggregate:o,groupby:l,encoding:u}=Wfe(r,n),c=[...i||[],...s,...a,...o.length===0?[]:[{aggregate:o,groupby:l}]];return Object.assign(Object.assign(Object.assign({},t),c.length>0?{transform:c}:{}),{encoding:u})}else return t}}const s8n=new i8n;function a8n(e,t){return s8n.map(e,{config:t})}const o8n=dIn.version,l8n=Object.freeze(Object.defineProperty({__proto__:null,normalize:EYe,version:o8n,compile:t8n,extractTransforms:a8n},Symbol.toStringTag,{value:"Module"}));function qXe(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var u8n="vega-themes",c8n="2.13.0",f8n="Themes for stylized Vega and Vega-Lite visualizations.",h8n=["vega","vega-lite","themes","style"],d8n="BSD-3-Clause",p8n={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},g8n=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],m8n="build/vega-themes.js",whe="build/vega-themes.module.js",v8n="build/vega-themes.min.js",y8n="build/vega-themes.min.js",b8n="build/vega-themes.module.d.ts",x8n={type:"git",url:"https://github.com/vega/vega-themes.git"},w8n=["src","build"],$8n={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},C8n={"@babel/core":"^7.21.4","@babel/plugin-transform-runtime":"^7.21.4","@babel/preset-env":"^7.21.4","@babel/preset-typescript":"^7.21.4","@release-it/conventional-changelog":"^5.1.1","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.2","@rollup/plugin-terser":"^0.4.1","@typescript-eslint/eslint-plugin":"^5.59.0","@typescript-eslint/parser":"^5.59.0","browser-sync":"^2.29.1",concurrently:"^8.0.1",eslint:"^8.38.0","eslint-config-prettier":"^8.8.0","eslint-plugin-prettier":"^4.2.1","gh-pages":"^5.0.0",prettier:"^2.8.7","release-it":"^15.10.1",rollup:"^3.20.6","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.2.0",typescript:"^5.0.4",vega:"^5.24.0","vega-lite":"^5.7.1"},_8n={vega:"*","vega-lite":"*"},S8n={},k8n={name:u8n,version:c8n,description:f8n,keywords:h8n,license:d8n,author:p8n,contributors:g8n,main:m8n,module:whe,unpkg:v8n,jsdelivr:y8n,types:b8n,repository:x8n,files:w8n,scripts:$8n,devDependencies:C8n,peerDependencies:_8n,dependencies:S8n};const b2="#fff",H_e="#888",E8n={background:"#333",view:{stroke:H_e},title:{color:b2,subtitleColor:b2},style:{"guide-label":{fill:b2},"guide-title":{fill:b2}},axis:{domainColor:b2,gridColor:H_e,tickColor:b2}},Rv="#4572a7",A8n={background:"#fff",arc:{fill:Rv},area:{fill:Rv},line:{stroke:Rv,strokeWidth:2},path:{stroke:Rv},rect:{fill:Rv},shape:{stroke:Rv},symbol:{fill:Rv,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Pv="#30a2da",LG="#cbcbcb",T8n="#999",D8n="#333",q_e="#f0f0f0",G_e="#333",N8n={arc:{fill:Pv},area:{fill:Pv},axis:{domainColor:LG,grid:!0,gridColor:LG,gridWidth:1,labelColor:T8n,labelFontSize:10,titleColor:D8n,tickColor:LG,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:q_e,group:{fill:q_e},legend:{labelColor:G_e,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:G_e,titleFontSize:14,titlePadding:10},line:{stroke:Pv,strokeWidth:2},path:{stroke:Pv,strokeWidth:.5},rect:{fill:Pv},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Pv},bar:{binSpacing:2,fill:Pv,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Lv="#000",I8n={group:{fill:"#e5e5e5"},arc:{fill:Lv},area:{fill:Lv},line:{stroke:Lv},path:{stroke:Lv},rect:{fill:Lv},shape:{stroke:Lv},symbol:{fill:Lv,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},M8n=22,F8n="normal",Y_e="Benton Gothic, sans-serif",X_e=11.5,O8n="normal",Bv="#82c6df",BG="Benton Gothic Bold, sans-serif",K_e="normal",Z_e=13,Xk={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},R8n={background:"#ffffff",title:{anchor:"start",color:"#000000",font:BG,fontSize:M8n,fontWeight:F8n},arc:{fill:Bv},area:{fill:Bv},line:{stroke:Bv,strokeWidth:2},path:{stroke:Bv},rect:{fill:Bv},shape:{stroke:Bv},symbol:{fill:Bv,size:30},axis:{labelFont:Y_e,labelFontSize:X_e,labelFontWeight:O8n,titleFont:BG,titleFontSize:Z_e,titleFontWeight:K_e},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Y_e,labelFontSize:X_e,symbolType:"square",titleFont:BG,titleFontSize:Z_e,titleFontWeight:K_e},range:{category:Xk["category-6"],diverging:Xk["fireandice-6"],heatmap:Xk["fire-7"],ordinal:Xk["fire-7"],ramp:Xk["fire-7"]}},zv="#ab5787",BR="#979797",P8n={background:"#f9f9f9",arc:{fill:zv},area:{fill:zv},line:{stroke:zv},path:{stroke:zv},rect:{fill:zv},shape:{stroke:zv},symbol:{fill:zv,size:30},axis:{domainColor:BR,domainWidth:.5,gridWidth:.2,labelColor:BR,tickColor:BR,tickWidth:.2,titleColor:BR},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Uv="#3e5c69",L8n={background:"#fff",arc:{fill:Uv},area:{fill:Uv},line:{stroke:Uv},path:{stroke:Uv},rect:{fill:Uv},shape:{stroke:Uv},symbol:{fill:Uv},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},lu="#1696d2",Q_e="#000000",B8n="#FFFFFF",zR="Lato",zG="Lato",z8n="Lato",U8n="#DEDDDD",W8n=18,Kk={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},V8n={background:B8n,title:{anchor:"start",fontSize:W8n,font:zR},axisX:{domain:!0,domainColor:Q_e,domainWidth:1,grid:!1,labelFontSize:12,labelFont:zG,labelAngle:0,tickColor:Q_e,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:zR},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:U8n,gridWidth:1,labelFontSize:12,labelFont:zG,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:zR,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:zG,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:zR,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Kk["six-groups-cat-1"],diverging:Kk["diverging-colors"],heatmap:Kk["diverging-colors"],ordinal:Kk["six-groups-seq"],ramp:Kk["shades-blue"]},area:{fill:lu},rect:{fill:lu},line:{color:lu,stroke:lu,strokeWidth:5},trail:{color:lu,stroke:lu,strokeWidth:0,size:1},path:{stroke:lu,strokeWidth:.5},point:{filled:!0},text:{font:z8n,color:lu,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:lu,stroke:null}},arc:{fill:lu},shape:{stroke:lu},symbol:{fill:lu,size:30}},Wv="#3366CC",J_e="#ccc",UR="Arial, sans-serif",j8n={arc:{fill:Wv},area:{fill:Wv},path:{stroke:Wv},rect:{fill:Wv},shape:{stroke:Wv},symbol:{stroke:Wv},circle:{fill:Wv},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:UR,fontSize:12},"guide-title":{font:UR,fontSize:12},"group-title":{font:UR,fontSize:12}},title:{font:UR,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:J_e,tickColor:J_e,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},$he=e=>e*(1/3+1),eSe=$he(9),tSe=$he(10),nSe=$he(12),Zk="Segoe UI",rSe="wf_standard-font, helvetica, arial, sans-serif",iSe="#252423",Qk="#605E5C",sSe="transparent",H8n="#C8C6C4",uc="#118DFF",q8n="#12239E",G8n="#E66C37",Y8n="#6B007B",X8n="#E044A7",K8n="#744EC2",Z8n="#D9B300",Q8n="#D64550",GXe=uc,YXe="#DEEFFF",aSe=[YXe,GXe],J8n=[YXe,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",GXe],eBn={view:{stroke:sSe},background:sSe,font:Zk,header:{titleFont:rSe,titleFontSize:nSe,titleColor:iSe,labelFont:Zk,labelFontSize:tSe,labelColor:Qk},axis:{ticks:!1,grid:!1,domain:!1,labelColor:Qk,labelFontSize:eSe,titleFont:rSe,titleColor:iSe,titleFontSize:nSe,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:H8n,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:uc},line:{stroke:uc,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:Zk,fontSize:eSe,fill:Qk},arc:{fill:uc},area:{fill:uc,line:!0,opacity:.6},path:{stroke:uc},rect:{fill:uc},point:{fill:uc,filled:!0,size:75},shape:{stroke:uc},symbol:{fill:uc,strokeWidth:1.5,size:50},legend:{titleFont:Zk,titleFontWeight:"bold",titleColor:Qk,labelFont:Zk,labelFontSize:tSe,labelColor:Qk,symbolType:"circle",symbolSize:75},range:{category:[uc,q8n,G8n,Y8n,X8n,K8n,Z8n,Q8n],diverging:aSe,heatmap:aSe,ordinal:J8n}},tBn=k8n.version,nBn=Object.freeze(Object.defineProperty({__proto__:null,dark:E8n,excel:A8n,fivethirtyeight:N8n,ggplot2:I8n,googlecharts:j8n,latimes:R8n,powerbi:eBn,quartz:P8n,urbaninstitute:V8n,version:tBn,vox:L8n},Symbol.toStringTag,{value:"Module"}));var rBn=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const XXe="vg-tooltip-element",iBn={offsetX:10,offsetY:10,id:XXe,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:sBn,maxDepth:2};function sBn(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function aBn(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return rBn.toString().replace(XXe,e)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function oBn(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function lBn(e,t,n){if(at(e))return`[${e.map(r=>t($r(r)?r:oSe(r,n))).join(", ")}]`;if(Ft(e)){let r="";const i=e,{title:s,image:a}=i,o=oBn(i,["title","image"]);s&&(r+=`<h2>${t(s)}</h2>`),a&&(r+=`<img src="${t(a)}">`);const l=Object.keys(o);if(l.length>0){r+="<table>";for(const u of l){let c=o[u];c!==void 0&&(Ft(c)&&(c=oSe(c,n)),r+=`<tr><td class="key">${t(u)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function uBn(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function oSe(e,t){return JSON.stringify(e,uBn(t))}function cBn(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let s=e.clientY+r;return s+t.height>window.innerHeight&&(s=+e.clientY-r-t.height),{x:i,y:s}}class fBn{constructor(t){this.options=Object.assign(Object.assign({},iBn),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=aBn(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(document.fullscreenElement!=null?document.fullscreenElement:document.body).appendChild(this.el),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=lBn(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:a,y:o}=cBn(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${o}px; left: ${a}px`)}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function B8(e,t,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(f){a(f)}}function l(c){try{u(r.throw(c))}catch(f){a(f)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((r=r.apply(e,t||[])).next())})}function hBn(e,t,n){const r=e.open(t),i=1e4,s=250,{origin:a}=new URL(t);let o=~~(i/s);function l(c){c.source===r&&(o=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function u(){o<=0||(r.postMessage(n,a),setTimeout(u,s),o-=1)}setTimeout(u,s)}var dBn=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper {
    width: 100%;
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function KXe(e,...t){for(const n of t)pBn(e,n);return e}function pBn(e,t){for(const n of Object.keys(t))Y7(e,n,t[n],!0)}var UG;const qd=HNn;let sC=l8n;const WR=typeof window<"u"?window:void 0;sC===void 0&&((UG=WR==null?void 0:WR.vl)===null||UG===void 0?void 0:UG.compile)&&(sC=WR.vl);const ZXe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},gBn={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},tA={vega:"Vega","vega-lite":"Vega-Lite"},z8={vega:qd.version,"vega-lite":sC?sC.version:"not available"},mBn={vega:e=>e,"vega-lite":(e,t)=>sC.compile(e,{config:t}).spec},vBn=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,yBn="chart-wrapper";function bBn(e){return typeof e=="function"}function lSe(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,s=`</code></pre>${n}</body></html>`,a=window.open("");a.document.write(i+e+s),a.document.title=`${tA[r]} JSON Source`}function QXe(e,t){var n;if(e.$schema){const r=qXe(e.$schema);t&&t!==r.library&&console.warn(`The given visualization spec is written in ${tA[r.library]}, but mode argument sets ${(n=tA[t])!==null&&n!==void 0?n:t}.`);const i=r.library;return FFe.satisfies(z8[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${tA[i]} ${r.version}, but the current version of ${tA[i]} is v${z8[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t!=null?t:"vega"}function xBn(e){return!!(e&&"load"in e)}function uSe(e){return xBn(e)?e:qd.loader(e)}function cSe(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function wBn(e,t,n={}){var r,i,s;return B8(this,void 0,void 0,function*(){let a,o;PT(t)?(o=uSe(n.loader),a=JSON.parse(yield o.load(t))):a=t;const l=cSe(a).loader;(!o||l)&&(o=uSe((r=n.loader)!==null&&r!==void 0?r:l));const u=yield fSe(cSe(a),o),c=yield fSe(n,o),f=Object.assign(Object.assign({},KXe(c,u)),{config:Tre((i=c.config)!==null&&i!==void 0?i:{},(s=u.config)!==null&&s!==void 0?s:{})});return yield CBn(e,a,f,o)})}function fSe(e,t){var n;return B8(this,void 0,void 0,function*(){const r=PT(e.config)?JSON.parse(yield t.load(e.config)):(n=e.config)!==null&&n!==void 0?n:{},i=PT(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),r?{config:r}:{})})}function $Bn(e){var t;const n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:(t=document.head)!==null&&t!==void 0?t:document.body}}function CBn(e,t,n={},r){var i,s,a,o,l,u;return B8(this,void 0,void 0,function*(){const c=n.theme?Tre(nBn[n.theme],(i=n.config)!==null&&i!==void 0?i:{}):n.config,f=qFe(n.actions)?n.actions:KXe({},ZXe,(s=n.actions)!==null&&s!==void 0?s:{}),h=Object.assign(Object.assign({},gBn),n.i18n),d=(a=n.renderer)!==null&&a!==void 0?a:"canvas",p=(o=n.logLevel)!==null&&o!==void 0?o:qd.Warn,g=(l=n.downloadFileName)!==null&&l!==void 0?l:"visualization",m=typeof e=="string"?document.querySelector(e):e;if(!m)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const S="vega-embed-style",{root:N,rootContainer:A}=$Bn(m);if(!N.getElementById(S)){const D=document.createElement("style");D.id=S,D.innerText=n.defaultStyle===void 0||n.defaultStyle===!0?dBn.toString():n.defaultStyle,A.appendChild(D)}}const v=QXe(t,n.mode);let y=mBn[v](t,c);if(v==="vega-lite"&&y.$schema){const S=qXe(y.$schema);FFe.satisfies(z8.vega,`^${S.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${S.version}, but current version is v${z8.vega}.`)}m.classList.add("vega-embed"),f&&m.classList.add("has-actions"),m.innerHTML="";let b=m;if(f){const S=document.createElement("div");S.classList.add(yBn),m.appendChild(S),b=S}const x=n.patch;x&&(x instanceof Function?y=x(y):y=U7(y,x,!0,!1).newDocument),n.formatLocale&&qd.formatLocale(n.formatLocale),n.timeFormatLocale&&qd.timeFormatLocale(n.timeFormatLocale);const{ast:w}=n,C=qd.parse(y,v==="vega-lite"?{}:c,{ast:w}),$=new(n.viewClass||qd.View)(C,Object.assign({loader:r,logLevel:p,renderer:d},w?{expr:qd.expressionInterpreter}:{}));if(n.tooltip!==!1){let S;bBn(n.tooltip)?S=n.tooltip:S=new fBn(n.tooltip===!0?{}:n.tooltip).call,$.tooltip(S)}let{hover:_}=n;if(_===void 0&&(_=v==="vega"),_){const{hoverSet:S,updateSet:N}=typeof _=="boolean"?{}:_;$.hover(S,N)}n&&(n.width!=null&&$.width(n.width),n.height!=null&&$.height(n.height),n.padding!=null&&$.padding(n.padding)),yield $.initialize(b,n.bind).runAsync();let k;if(f!==!1){let S=m;if(n.defaultStyle!==!1){const A=document.createElement("details");A.title=h.CLICK_TO_VIEW_ACTIONS,m.append(A),S=A;const D=document.createElement("summary");D.innerHTML=vBn,A.append(D),k=T=>{A.contains(T.target)||A.removeAttribute("open")},document.addEventListener("click",k)}const N=document.createElement("div");if(S.append(N),N.classList.add("vega-actions"),f===!0||f.export!==!1){for(const A of["svg","png"])if(f===!0||f.export===!0||f.export[A]){const D=h[`${A.toUpperCase()}_ACTION`],T=document.createElement("a");T.text=D,T.href="#",T.target="_blank",T.download=`${g}.${A}`,T.addEventListener("mousedown",function(I){return B8(this,void 0,void 0,function*(){I.preventDefault();const F=yield $.toImageURL(A,n.scaleFactor);this.href=F})}),N.append(T)}}if(f===!0||f.source!==!1){const A=document.createElement("a");A.text=h.SOURCE_ACTION,A.href="#",A.addEventListener("click",function(D){var T,I;lSe(kj(t),(T=n.sourceHeader)!==null&&T!==void 0?T:"",(I=n.sourceFooter)!==null&&I!==void 0?I:"",v),D.preventDefault()}),N.append(A)}if(v==="vega-lite"&&(f===!0||f.compiled!==!1)){const A=document.createElement("a");A.text=h.COMPILED_ACTION,A.href="#",A.addEventListener("click",function(D){var T,I;lSe(kj(y),(T=n.sourceHeader)!==null&&T!==void 0?T:"",(I=n.sourceFooter)!==null&&I!==void 0?I:"","vega"),D.preventDefault()}),N.append(A)}if(f===!0||f.editor!==!1){const A=(u=n.editorUrl)!==null&&u!==void 0?u:"https://vega.github.io/editor/",D=document.createElement("a");D.text=h.EDITOR_ACTION,D.href="#",D.addEventListener("click",function(T){hBn(window,A,{config:c,mode:v,renderer:d,spec:kj(t)}),T.preventDefault()}),N.append(D)}}function E(){k&&document.removeEventListener("click",k),$.finalize()}return{view:$,spec:t,vgSpec:y,finalize:E}})}const _Bn=Object.freeze(Object.defineProperty({__proto__:null,default:wBn,DEFAULT_ACTIONS:ZXe,guessMode:QXe,vega:qd,get vegaLite(){return sC}},Symbol.toStringTag,{value:"Module"})),MS=Ob(_Bn);var Ju={},De={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var hSe=Object.getOwnPropertySymbols,SBn=Object.prototype.hasOwnProperty,kBn=Object.prototype.propertyIsEnumerable;function EBn(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function ABn(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(s){return t[s]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(s){i[s]=s}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var Che=ABn()?Object.assign:function(e,t){for(var n,r=EBn(e),i,s=1;s<arguments.length;s++){n=Object(arguments[s]);for(var a in n)SBn.call(n,a)&&(r[a]=n[a]);if(hSe){i=hSe(n);for(var o=0;o<i.length;o++)kBn.call(n,i[o])&&(r[i[o]]=n[i[o]])}}return r},_he={};Object.defineProperty(_he,"__esModule",{value:!0});_he.StyleSheet=JXe;var TBn=Che,DBn=NBn(TBn);function NBn(e){return e&&e.__esModule?e:{default:e}}function IBn(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}function WG(e){return e[e.length-1]}function dSe(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var w1=typeof window<"u",MBn=!1,FBn=function(){if(w1){var e=document.createElement("div");return e.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->",e.getElementsByTagName("i").length===1}}();function pSe(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function JXe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.speedy,n=t===void 0?!MBn:t,r=e.maxLength,i=r===void 0?w1&&FBn?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,DBn.default)(JXe.prototype,{getSheet:function(){return dSe(WG(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");w1?this.tags[0]=pSe():this.sheet={cssRules:[],insertRule:function(r){t.sheet.cssRules.push({cssText:r})}},this.injected=!0},speedy:function(t){if(this.ctr!==0)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var n=this.getSheet();n.insertRule(t,t.indexOf("@import")!==-1?0:n.cssRules.length)}catch{}},insert:function(t){if(w1)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(t.indexOf("@import")!==-1){var n=WG(this.tags);n.insertBefore(document.createTextNode(t),n.firstChild)}else WG(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,t.indexOf("@import")!==-1?0:this.sheet.cssRules.length);return this.ctr++,w1&&this.ctr%this.maxLength===0&&this.tags.push(pSe()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){w1?(this.tags.forEach(function(t){return t.parentNode.removeChild(t)}),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!w1)return this.sheet.cssRules;var t=[];return this.tags.forEach(function(n){return t.splice.apply(t,[t.length,0].concat(IBn(Array.from(dSe(n).cssRules))))}),t}});var FS={},OBn=/-(.)/g;function RBn(e){return e.replace(OBn,function(t,n){return n.toUpperCase()})}var PBn=RBn,LBn=PBn,BBn=/^-ms-/;function zBn(e){return LBn(e.replace(BBn,"ms-"))}var UBn=zBn,She={},khe={};Object.defineProperty(khe,"__esModule",{value:!0});var t5={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function WBn(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var VBn=["Webkit","ms","Moz","O"];Object.keys(t5).forEach(function(e){VBn.forEach(function(t){t5[WBn(t,e)]=t5[e]})});var jBn={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},HBn={isUnitlessNumber:t5,shorthandPropertyExpansions:jBn};khe.default=HBn;function bV(e){return function(){return e}}var Hx=function(){};Hx.thatReturns=bV;Hx.thatReturnsFalse=bV(!1);Hx.thatReturnsTrue=bV(!0);Hx.thatReturnsNull=bV(null);Hx.thatReturnsThis=function(){return this};Hx.thatReturnsArgument=function(e){return e};var qBn=Hx,GBn=qBn,YBn=GBn,eKe=YBn;Object.defineProperty(She,"__esModule",{value:!0});var XBn=khe,KBn=tKe(XBn),ZBn=eKe;tKe(ZBn);function tKe(e){return e&&e.__esModule?e:{default:e}}var gSe=KBn.default.isUnitlessNumber;function QBn(e,t,n){var r=t==null||typeof t=="boolean"||t==="";if(r)return"";var i=isNaN(t);return i||t===0||gSe.hasOwnProperty(e)&&gSe[e]?""+t:(typeof t=="string"&&(t=t.trim()),t+"px")}She.default=QBn;var JBn=/([A-Z])/g;function ezn(e){return e.replace(JBn,"-$1").toLowerCase()}var tzn=ezn,nzn=tzn,rzn=/^ms-/;function izn(e){return nzn(e).replace(rzn,"-ms-")}var szn=izn;function azn(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}var ozn=azn;Object.defineProperty(FS,"__esModule",{value:!0});FS.processStyleName=void 0;FS.createMarkupForStyles=vzn;var lzn=UBn;TF(lzn);var uzn=She,czn=TF(uzn),fzn=szn,hzn=TF(fzn),dzn=ozn,pzn=TF(dzn),gzn=eKe;TF(gzn);function TF(e){return e&&e.__esModule?e:{default:e}}var mzn=FS.processStyleName=(0,pzn.default)(hzn.default);function vzn(e,t){var n="";for(var r in e){var i=r.indexOf("--")===0;if(!!e.hasOwnProperty(r)&&r!=="label"){var s=e[r];s!=null&&(i?n+=r+":"+s+";":(n+=mzn(r)+":",n+=(0,czn.default)(r,s,t)+";"))}}return n||null}var Ehe={};Object.defineProperty(Ehe,"__esModule",{value:!0});var nKe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Ehe.default=Ahe;function yzn(e){return e==null||e===!1||(typeof e>"u"?"undefined":nKe(e))==="object"&&Object.keys(e).length===0}function bzn(e){if(yzn(e))return null;if((typeof e>"u"?"undefined":nKe(e))!=="object")return e;for(var t={},n=Object.keys(e),r=!1,i=0;i<n.length;i++){var s=e[n[i]],a=Ahe(s);(a===null||a!==s)&&(r=!0),a!==null&&(t[n[i]]=a)}return Object.keys(t).length===0?null:r?t:e}function xzn(e){var t=!1,n=[];return e.forEach(function(r){var i=Ahe(r);(i===null||i!==r)&&(t=!0),i!==null&&n.push(i)}),n.length==0?null:t?n:e}function Ahe(e){return Array.isArray(e)?xzn(e):bzn(e)}var OS={},The={},VJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],i=["ms"],s=["Webkit","Moz"],a=["Webkit","ms"],o=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:s,userSelect:o,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:o,breakBefore:o,breakInside:o,columnCount:s,columnFill:s,columnGap:s,columnRule:s,columnRuleColor:s,columnRuleStyle:s,columnRuleWidth:s,columns:s,columnSpan:s,columnWidth:s,writingMode:a,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:a,scrollSnapPointsX:a,scrollSnapPointsY:a,scrollSnapDestination:a,scrollSnapCoordinate:a,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:o,flowInto:a,flowFrom:a,regionFragment:a,textAlignLast:r,tabSize:r,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:a,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default})(VJ,VJ.exports);var jJ={exports:{}},U8={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r){return r.charAt(0).toUpperCase()+r.slice(1)}e.exports=t.default})(U8,U8.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=U8.exports,r=i(n);function i(a){return a&&a.__esModule?a:{default:a}}function s(a,o,l){if(a.hasOwnProperty(o))for(var u=a[o],c=0,f=u.length;c<f;++c)l[u[c]+(0,r.default)(o)]=l[o]}e.exports=t.default})(jJ,jJ.exports);var HJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i,s,a,o){for(var l=0,u=r.length;l<u;++l){var c=r[l](i,s,a,o);if(c)return c}}e.exports=t.default})(HJ,HJ.exports);var qJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function i(s,a){if(s==="cursor"&&r.hasOwnProperty(a))return n.map(function(o){return o+a})}e.exports=t.default})(qJ,qJ.exports);var GJ={exports:{}},Tb={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=/-webkit-|-moz-|-ms-/;function r(i){return typeof i=="string"&&n.test(i)}e.exports=t.default})(Tb,Tb.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=Tb.exports,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}var s=["-webkit-",""];function a(o,l){if(typeof l=="string"&&!(0,r.default)(l)&&l.indexOf("cross-fade(")>-1)return s.map(function(u){return l.replace(/cross-fade\(/g,u+"cross-fade(")})}e.exports=t.default})(GJ,GJ.exports);var YJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=Tb.exports,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}var s=["-webkit-",""];function a(o,l){if(typeof l=="string"&&!(0,r.default)(l)&&l.indexOf("filter(")>-1)return s.map(function(u){return l.replace(/filter\(/g,u+"filter(")})}e.exports=t.default})(YJ,YJ.exports);var XJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function r(i,s){if(i==="display"&&n.hasOwnProperty(s))return n[s]}e.exports=t.default})(XJ,XJ.exports);var KJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};function i(s,a,o){s==="flexDirection"&&typeof a=="string"&&(a.indexOf("column")>-1?o.WebkitBoxOrient="vertical":o.WebkitBoxOrient="horizontal",a.indexOf("reverse")>-1?o.WebkitBoxDirection="reverse":o.WebkitBoxDirection="normal"),r.hasOwnProperty(s)&&(o[r[s]]=n[a]||a)}e.exports=t.default})(KJ,KJ.exports);var ZJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Tb.exports,r=i(n);function i(l){return l&&l.__esModule?l:{default:l}}var s=["-webkit-","-moz-",""],a=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;function o(l,u){if(typeof u=="string"&&!(0,r.default)(u)&&a.test(u))return s.map(function(c){return c+u})}e.exports=t.default})(ZJ,ZJ.exports);var QJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=Tb.exports,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}var s=["-webkit-",""];function a(o,l){if(typeof l=="string"&&!(0,r.default)(l)&&l.indexOf("image-set(")>-1)return s.map(function(u){return l.replace(/image-set\(/g,u+"image-set(")})}e.exports=t.default})(QJ,QJ.exports);var JJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i){if(r==="position"&&i==="sticky")return["-webkit-sticky","sticky"]}e.exports=t.default})(JJ,JJ.exports);var eee={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function s(a,o){if(r.hasOwnProperty(a)&&i.hasOwnProperty(o))return n.map(function(l){return l+o})}e.exports=t.default})(eee,eee.exports);var tee={exports:{}},nee={exports:{}},wzn=/[A-Z]/g,$zn=/^ms-/,VG={};function Czn(e){return"-"+e.toLowerCase()}function _zn(e){if(VG.hasOwnProperty(e))return VG[e];var t=e.replace(wzn,Czn);return VG[e]=$zn.test(t)?"-"+t:t}const Szn=Object.freeze(Object.defineProperty({__proto__:null,default:_zn},Symbol.toStringTag,{value:"Module"})),kzn=Ob(Szn);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=kzn,r=i(n);function i(a){return a&&a.__esModule?a:{default:a}}function s(a){return(0,r.default)(a)}e.exports=t.default})(nee,nee.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=h;var n=nee.exports,r=l(n),i=Tb.exports,s=l(i),a=U8.exports,o=l(a);function l(d){return d&&d.__esModule?d:{default:d}}var u={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},c={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function f(d,p){if((0,s.default)(d))return d;for(var g=d.split(/,(?![^()]*(?:\([^()]*\))?\))/g),m=0,v=g.length;m<v;++m){var y=g[m],b=[y];for(var x in p){var w=(0,r.default)(x);if(y.indexOf(w)>-1&&w!=="order")for(var C=p[x],$=0,_=C.length;$<_;++$)b.unshift(y.replace(w,c[C[$]]+w))}g[m]=b.join(",")}return g.join(",")}function h(d,p,g,m){if(typeof p=="string"&&u.hasOwnProperty(d)){var v=f(p,m),y=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-moz-|-ms-/.test(x)}).join(",");if(d.indexOf("Webkit")>-1)return y;var b=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-webkit-|-ms-/.test(x)}).join(",");return d.indexOf("Moz")>-1?b:(g["Webkit"+(0,o.default)(d)]=y,g["Moz"+(0,o.default)(d)]=b,v)}}e.exports=t.default})(tee,tee.exports);Object.defineProperty(The,"__esModule",{value:!0});The.default=e7n;var Ezn=VJ.exports,Azn=tu(Ezn),Tzn=jJ.exports,Dzn=tu(Tzn),Nzn=HJ.exports,Izn=tu(Nzn),Mzn=qJ.exports,Fzn=tu(Mzn),Ozn=GJ.exports,Rzn=tu(Ozn),Pzn=YJ.exports,Lzn=tu(Pzn),Bzn=XJ.exports,zzn=tu(Bzn),Uzn=KJ.exports,Wzn=tu(Uzn),Vzn=ZJ.exports,jzn=tu(Vzn),Hzn=QJ.exports,qzn=tu(Hzn),Gzn=JJ.exports,Yzn=tu(Gzn),Xzn=eee.exports,Kzn=tu(Xzn),Zzn=tee.exports,Qzn=tu(Zzn);function tu(e){return e&&e.__esModule?e:{default:e}}var Jzn=[Rzn.default,Fzn.default,Lzn.default,Wzn.default,jzn.default,qzn.default,Yzn.default,Kzn.default,Qzn.default,zzn.default],mSe=Azn.default.prefixMap;function e7n(e){for(var t in e){var n=e[t],r=(0,Izn.default)(Jzn,t,n,e,mSe);r&&(e[t]=r),(0,Dzn.default)(mSe,t,e)}return e}Object.defineProperty(OS,"__esModule",{value:!0});var ree=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};OS.PluginSet=iKe;OS.fallbacks=a7n;OS.contentWrap=l7n;OS.prefixes=u7n;var t7n=Che,Dhe=rKe(t7n),n7n=FS,r7n=The,i7n=rKe(r7n);function rKe(e){return e&&e.__esModule?e:{default:e}}var s7n=function(e){return e==="development"||!e}("production");function iKe(e){this.fns=e||[]}(0,Dhe.default)(iKe.prototype,{add:function(){for(var t=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(s){t.fns.indexOf(s)>=0?s7n&&console.warn("adding the same plugin again, ignoring"):t.fns=[s].concat(t.fns)})},remove:function(t){this.fns=this.fns.filter(function(n){return n!==t})},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce(function(n,r){return r(n)},t)}});function a7n(e){var t=Object.keys(e.style).map(function(i){return Array.isArray(e.style[i])}).indexOf(!0)>=0;if(t){var n=e.style,r=Object.keys(n).reduce(function(i,s){return i[s]=Array.isArray(n[s])?n[s].join("; "+(0,n7n.processStyleName)(s)+": "):n[s],i},{});return(0,Dhe.default)({},e,{style:r})}return e}var o7n=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"];function l7n(e){if(e.style.content){var t=e.style.content;return o7n.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)||t.charAt(0)===t.charAt(t.length-1)&&(t.charAt(0)==='"'||t.charAt(0)==="'")?e:ree({},e,{style:ree({},e.style,{content:'"'+t+'"'})})}return e}function u7n(e){return(0,Dhe.default)({},e,{style:(0,i7n.default)(ree({},e.style))})}var Nhe={};Object.defineProperty(Nhe,"__esModule",{value:!0});Nhe.default=c7n;function c7n(e,t){for(var n=1540483477,r=24,i=t^e.length,s=e.length,a=0;s>=4;){var o=f7n(e,a);o=Vv(o,n),o^=o>>>r,o=Vv(o,n),i=Vv(i,n),i^=o,a+=4,s-=4}switch(s){case 3:i^=vSe(e,a),i^=e.charCodeAt(a+2)<<16,i=Vv(i,n);break;case 2:i^=vSe(e,a),i=Vv(i,n);break;case 1:i^=e.charCodeAt(a),i=Vv(i,n);break}return i^=i>>>13,i=Vv(i,n),i^=i>>>15,i>>>0}function f7n(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function vSe(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function Vv(e,t){e=e|0,t=t|0;var n=e&65535,r=e>>>16,i=n*t+((r*t&65535)<<16)|0;return i}Object.defineProperty(De,"__esModule",{value:!0});De.compose=De.merge=De.$=De.style=De.presets=De.keyframes=De.fontFace=De.insertGlobal=De.insertRule=De.plugins=De.styleSheet=void 0;De.speedy=y7n;De.simulations=b7n;De.simulate=x7n;De.cssLabels=w7n;De.isLikeRule=Rhe;De.idFor=Phe;De.css=ps;De.rehydrate=O7n;De.flush=R7n;De.select=Lhe;De.parent=L7n;De.media=B7n;De.pseudo=$t;De.active=z7n;De.any=U7n;De.checked=W7n;De.disabled=V7n;De.empty=j7n;De.enabled=H7n;De._default=q7n;De.first=G7n;De.firstChild=Y7n;De.firstOfType=X7n;De.fullscreen=K7n;De.focus=Z7n;De.hover=Q7n;De.indeterminate=J7n;De.inRange=e9n;De.invalid=t9n;De.lastChild=n9n;De.lastOfType=r9n;De.left=i9n;De.link=s9n;De.onlyChild=a9n;De.onlyOfType=o9n;De.optional=l9n;De.outOfRange=u9n;De.readOnly=c9n;De.readWrite=f9n;De.required=h9n;De.right=d9n;De.root=p9n;De.scope=g9n;De.target=m9n;De.valid=v9n;De.visited=y9n;De.dir=b9n;De.lang=x9n;De.not=w9n;De.nthChild=$9n;De.nthLastChild=C9n;De.nthLastOfType=_9n;De.nthOfType=S9n;De.after=k9n;De.before=E9n;De.firstLetter=A9n;De.firstLine=T9n;De.selection=D9n;De.backdrop=N9n;De.placeholder=I9n;De.cssFor=M9n;De.attribsFor=F9n;var h7n=Che,d7n=Mhe(h7n),p7n=_he,Ihe=FS,g7n=Ehe,$v=Mhe(g7n),gp=OS,m7n=Nhe,v7n=Mhe(m7n);function Mhe(e){return e&&e.__esModule?e:{default:e}}function DF(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fl=De.styleSheet=new p7n.StyleSheet;Fl.inject();function y7n(e){return Fl.speedy(e)}var NF=De.plugins=Fl.plugins=new gp.PluginSet([gp.prefixes,gp.contentWrap,gp.fallbacks]);NF.media=new gp.PluginSet;NF.fontFace=new gp.PluginSet;NF.keyframes=new gp.PluginSet([gp.prefixes,gp.fallbacks]);var Fhe=!1,xV=typeof window<"u",Ohe=Fhe,ySe=!1,bSe=!1;function b7n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;Ohe=!!e}function x7n(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,$v.default)(t),t?Ohe?t.reduce(function(r,i){return r["data-simulate-"+W8(i)]="",r},{}):(ySe||(console.warn("can't simulate without once calling simulations(true)"),ySe=!0),bSe||(console.warn("don't use simulation outside dev"),bSe=!0),{}):{}}var IF=Fhe;function w7n(e){IF=!!e}function W8(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function MF(e){var t=JSON.stringify(e),n=(0,v7n.default)(t).toString(36);return e.label&&e.label.length>0&&Fhe?W8(e.label.join("."),"-")+"-"+n:n}function Rhe(e){var t=Object.keys(e).filter(function(n){return n!=="toString"});return t.length!==1?!1:!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function Phe(e){var t=Object.keys(e).filter(function(i){return i!=="toString"});if(t.length!==1)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/,r=n.exec(t[0]);if(!r)throw new Error("not a rule");return r[1]}var $7n=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function iee(e){if(e.indexOf(",")===-1)return[e];for(var t=[],n=[],r=0,i;i=$7n.exec(e);)switch(i[0]){case"(":r++;break;case")":r--;break;case",":if(r)break;t.push(i.index)}for(i=t.length;i--;)n.unshift(e.slice(t[i]+1)),e=e.slice(0,t[i]);return n.unshift(e),n}function xSe(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=iee(t).map(function(r){return r.indexOf("&")>=0?[r.replace(/\&/mg,".css-"+e),r.replace(/\&/mg,"[data-css-"+e+"]")].join(","):".css-"+e+r+",[data-css-"+e+"]"+r}).join(",");return Ohe&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+W8(t)+"],[data-css-"+e+"][data-simulate-"+W8(t)+"]"),n}function see(e){var t=e.selector,n=e.style,r=NF.transform({selector:t,style:n});return r.selector+"{"+(0,Ihe.createMarkupForStyles)(r.style)+"}"}function V8(e){var t=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(e).forEach(function(s){s.indexOf("&")>=0?(n=n||{},n[s]=e[s]):s.indexOf("@media")===0?(r=r||{},r[s]=V8(e[s])):s.indexOf("@supports")===0?(i=i||{},i[s]=V8(e[s])):s==="label"?e.label.length>0&&(t=t||{},t.label=IF?e.label.join("."):""):(t=t||{},t[s]=e[s])}),{plain:t,selects:n,medias:r,supports:i}}function j8(e,t){var n=[],r=t.plain,i=t.selects,s=t.medias,a=t.supports;return r&&n.push(see({style:r,selector:xSe(e)})),i&&Object.keys(i).forEach(function(o){return n.push(see({style:i[o],selector:xSe(e,o)}))}),s&&Object.keys(s).forEach(function(o){return n.push(o+"{"+j8(e,s[o]).join("")+"}")}),a&&Object.keys(a).forEach(function(o){return n.push(o+"{"+j8(e,a[o]).join("")+"}")}),n}var Gc=Fl.inserted={};function C7n(e){if(!Gc[e.id]){Gc[e.id]=!0;var t=V8(e.style),n=j8(e.id,t);Gc[e.id]=xV?!0:n,n.forEach(function(r){return Fl.insert(r)})}}var GD=Fl.registered={};function wV(e){GD[e.id]||(GD[e.id]=e)}function _7n(e){if(Rhe(e)){var t=GD[Phe(e)];if(t==null)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}var n5={};function S7n(e){if(wV(e),C7n(e),n5[e.id])return n5[e.id];var t=DF({},"data-css-"+e.id,IF&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),n5[e.id]=t,t}function k7n(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),i=0;i<t.length;i++)if(r===t[i]){n=!0;break}return n||e.indexOf("&")>=0}function wSe(e,t){var n=iee(e).map(function(i){return i.indexOf("&")>=0?i:"&"+i}),r=iee(t).map(function(i){return i.indexOf("&")>=0?i:"&"+i});return r.reduce(function(i,s){return i.concat(n.map(function(a){return s.replace(/\&/g,a)}))},[]).join(",")}function E7n(e,t){return e?"@media "+e.substring(6)+" and "+t.substring(6):t}function A7n(e){return e.indexOf("@media")===0}function T7n(e){return e.indexOf("@supports")===0}function D7n(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function sKe(e){for(var t=[],n=0;n<e.length;n++)Array.isArray(e[n])?t=t.concat(sKe(e[n])):t=t.concat(e[n]);return t}var $Se={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function $1(e,t){var n=t.selector,r=n===void 0?"":n,i=t.mq,s=i===void 0?"":i,a=t.supp,o=a===void 0?"":a,l=t.src,u=l===void 0?{}:l;Array.isArray(u)||(u=[u]),u=sKe(u),u.forEach(function(c){if(Rhe(c)){var f=_7n(c);if(f.type!=="css")throw new Error("cannot merge this rule");c=f.style}c=(0,$v.default)(c),c&&c.composes&&$1(e,{selector:r,mq:s,supp:o,src:c.composes}),Object.keys(c||{}).forEach(function(h){if(k7n(h))$Se[h]&&$Se[h].forEach(function(p){return $1(e,{selector:wSe(r,p),mq:s,supp:o,src:c[h]})}),$1(e,{selector:wSe(r,h),mq:s,supp:o,src:c[h]});else if(A7n(h))$1(e,{selector:r,mq:E7n(s,h),supp:o,src:c[h]});else if(T7n(h))$1(e,{selector:r,mq:s,supp:D7n(o,h),src:c[h]});else if(h!=="composes"){var d=e;o&&(d[o]=d[o]||{},d=d[o]),s&&(d[s]=d[s]||{},d=d[s]),r&&(d[r]=d[r]||{},d=d[r]),h==="label"?IF&&(e.label=e.label.concat(c.label)):d[h]=c[h]}})})}function CSe(e){var t={label:[]};$1(t,{src:e});var n={id:MF(t),style:t,label:IF?t.label.join("."):"",type:"css"};return S7n(n)}var H8={};Object.defineProperty(H8,"toString",{enumerable:!1,value:function(){return"css-nil"}});var VR=typeof WeakMap<"u"?[H8,new WeakMap,new WeakMap,new WeakMap]:[H8];function N7n(e){return function(t){if(VR[t.length]){for(var n=VR[t.length],r=0;r<t.length-1;)n.has(t[r])||n.set(t[r],new WeakMap),n=n.get(t[r]),r++;if(n.has(t[t.length-1])){var i=n.get(t[r]);if(GD[i.toString().substring(4)])return i}}var s=e(t);if(VR[t.length]){for(var a=0,o=VR[t.length];a<t.length-1;)o=o.get(t[a]),a++;try{o.set(t[a],s)}catch{}}return s}}var I7n=typeof WeakMap<"u"?N7n(CSe):CSe;function ps(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return t=(0,$v.default)(t),t?I7n(t):H8}ps.insert=function(e){var t={id:MF(e),css:e,type:"raw"};wV(t),Gc[t.id]||(Fl.insert(t.css),Gc[t.id]=xV?!0:[t.css])};De.insertRule=ps.insert;ps.global=function(e,t){if(t=(0,$v.default)(t),t)return ps.insert(see({selector:e,style:t}))};De.insertGlobal=ps.global;function M7n(e){if(!Gc[e.id]){var t=Object.keys(e.keyframes).map(function(r){var i=NF.keyframes.transform({id:e.id,name:r,style:e.keyframes[r]});return i.name+"{"+(0,Ihe.createMarkupForStyles)(i.style)+"}"}).join(""),n=["-webkit-","-moz-","-o-",""].map(function(r){return"@"+r+"keyframes "+(e.name+"_"+e.id)+"{"+t+"}"});n.forEach(function(r){return Fl.insert(r)}),Gc[e.id]=xV?!0:n}}ps.keyframes=function(e,t){t||(t=e,e="animation"),t=(0,$v.default)(t)||{};var n={id:MF({name:e,kfs:t}),type:"keyframes",name:e,keyframes:t};return wV(n),M7n(n),e+"_"+n.id};ps.fontFace=function(e){e=(0,$v.default)(e);var t={id:MF(e),type:"font-face",font:e};return wV(t),F7n(t),e.fontFamily};De.fontFace=ps.fontFace;De.keyframes=ps.keyframes;function F7n(e){if(!Gc[e.id]){var t="@font-face{"+(0,Ihe.createMarkupForStyles)(e.font)+"}";Fl.insert(t),Gc[e.id]=xV?!0:[t]}}function O7n(e){(0,d7n.default)(Gc,e.reduce(function(t,n){return t[n]=!0,t},{}))}function R7n(){Gc=Fl.inserted={},GD=Fl.registered={},n5={},Fl.flush(),Fl.inject()}De.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var P7n=De.style=ps;function Lhe(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?ps(DF({},e,n)):P7n(n)}De.$=Lhe;function L7n(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ps(DF({},e+" &",n))}De.merge=ps;De.compose=ps;function B7n(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ps(DF({},"@media "+e,n))}function $t(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ps(DF({},e,n))}function z7n(e){return $t(":active",e)}function U7n(e){return $t(":any",e)}function W7n(e){return $t(":checked",e)}function V7n(e){return $t(":disabled",e)}function j7n(e){return $t(":empty",e)}function H7n(e){return $t(":enabled",e)}function q7n(e){return $t(":default",e)}function G7n(e){return $t(":first",e)}function Y7n(e){return $t(":first-child",e)}function X7n(e){return $t(":first-of-type",e)}function K7n(e){return $t(":fullscreen",e)}function Z7n(e){return $t(":focus",e)}function Q7n(e){return $t(":hover",e)}function J7n(e){return $t(":indeterminate",e)}function e9n(e){return $t(":in-range",e)}function t9n(e){return $t(":invalid",e)}function n9n(e){return $t(":last-child",e)}function r9n(e){return $t(":last-of-type",e)}function i9n(e){return $t(":left",e)}function s9n(e){return $t(":link",e)}function a9n(e){return $t(":only-child",e)}function o9n(e){return $t(":only-of-type",e)}function l9n(e){return $t(":optional",e)}function u9n(e){return $t(":out-of-range",e)}function c9n(e){return $t(":read-only",e)}function f9n(e){return $t(":read-write",e)}function h9n(e){return $t(":required",e)}function d9n(e){return $t(":right",e)}function p9n(e){return $t(":root",e)}function g9n(e){return $t(":scope",e)}function m9n(e){return $t(":target",e)}function v9n(e){return $t(":valid",e)}function y9n(e){return $t(":visited",e)}function b9n(e,t){return $t(":dir("+e+")",t)}function x9n(e,t){return $t(":lang("+e+")",t)}function w9n(e,t){var n=e.split(",").map(function(r){return r.trim()}).map(function(r){return":not("+r+")"});return n.length===1?$t(":not("+e+")",t):Lhe(n.join(""),t)}function $9n(e,t){return $t(":nth-child("+e+")",t)}function C9n(e,t){return $t(":nth-last-child("+e+")",t)}function _9n(e,t){return $t(":nth-last-of-type("+e+")",t)}function S9n(e,t){return $t(":nth-of-type("+e+")",t)}function k9n(e){return $t("::after",e)}function E9n(e){return $t("::before",e)}function A9n(e){return $t("::first-letter",e)}function T9n(e){return $t("::first-line",e)}function D9n(e){return $t("::selection",e)}function N9n(e){return $t("::backdrop",e)}function I9n(e){return ps({"::placeholder":e})}function M9n(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,$v.default)(t),t?t.map(function(r){var i={label:[]};return $1(i,{src:r}),j8(MF(i),V8(i)).join("")}).join(""):""}function F9n(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t=(0,$v.default)(t);var r=t?t.map(function(i){Phe(i);var s=Object.keys(i)[0],a=i[s];return s+'="'+(a||"")+'"'}).join(" "):"";return r}var Do={},FF={};Object.defineProperty(FF,"__esModule",{value:!0});function O9n(e){return e.name!=null}FF.isSurfaceInfo=O9n;function R9n(e){return e.drawArea instanceof HTMLElement}FF.isSurface=R9n;var OF={},Bhe={};function P9n(){}var gl={},x2=[],_Se=[];function YD(e,t){var n=_Se,r,i,s,a;for(a=arguments.length;a-- >2;)x2.push(arguments[a]);for(t&&t.children!=null&&(x2.length||x2.push(t.children),delete t.children);x2.length;)if((i=x2.pop())&&i.pop!==void 0)for(a=i.length;a--;)x2.push(i[a]);else typeof i=="boolean"&&(i=null),(s=typeof e!="function")&&(i==null?i="":typeof i=="number"?i=String(i):typeof i!="string"&&(s=!1)),s&&r?n[n.length-1]+=i:n===_Se?n=[i]:n.push(i),r=s;var o=new P9n;return o.nodeName=e,o.children=n,o.attributes=t==null?void 0:t,o.key=t==null?void 0:t.key,gl.vnode!==void 0&&gl.vnode(o),o}function N0(e,t){for(var n in t)e[n]=t[n];return e}var L9n=typeof Promise=="function"?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function aKe(e,t){return YD(e.nodeName,N0(N0({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var B9n=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,aee=[];function oKe(e){!e._dirty&&(e._dirty=!0)&&aee.push(e)==1&&(gl.debounceRendering||L9n)(zhe)}function zhe(){var e,t=aee;for(aee=[];e=t.pop();)e._dirty&&$V(e)}function z9n(e,t,n){return typeof t=="string"||typeof t=="number"?e.splitText!==void 0:typeof t.nodeName=="string"?!e._componentConstructor&&lKe(e,t.nodeName):n||e._componentConstructor===t.nodeName}function lKe(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function uKe(e){var t=N0({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(n!==void 0)for(var r in n)t[r]===void 0&&(t[r]=n[r]);return t}function U9n(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}function Uhe(e){var t=e.parentNode;t&&t.removeChild(e)}function SSe(e,t,n,r,i){if(t==="className"&&(t="class"),t!=="key")if(t==="ref")n&&n(null),r&&r(e);else if(t==="class"&&!i)e.className=r||"";else if(t==="style"){if((!r||typeof r=="string"||typeof n=="string")&&(e.style.cssText=r||""),r&&typeof r=="object"){if(typeof n!="string")for(var s in n)s in r||(e.style[s]="");for(var s in r)e.style[s]=typeof r[s]=="number"&&B9n.test(s)===!1?r[s]+"px":r[s]}}else if(t==="dangerouslySetInnerHTML")r&&(e.innerHTML=r.__html||"");else if(t[0]=="o"&&t[1]=="n"){var a=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,kSe,a):e.removeEventListener(t,kSe,a),(e._listeners||(e._listeners={}))[t]=r}else if(t!=="list"&&t!=="type"&&!i&&t in e)W9n(e,t,r==null?"":r),(r==null||r===!1)&&e.removeAttribute(t);else{var o=i&&t!==(t=t.replace(/^xlink:?/,""));r==null||r===!1?o?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):typeof r!="function"&&(o?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}}function W9n(e,t,n){try{e[t]=n}catch{}}function kSe(e){return this._listeners[e.type](gl.event&&gl.event(e)||e)}var cKe=[],oee=0,Yg=!1,q8=!1;function fKe(){for(var e;e=cKe.pop();)gl.afterMount&&gl.afterMount(e),e.componentDidMount&&e.componentDidMount()}function hKe(e,t,n,r,i,s){oee++||(Yg=i!=null&&i.ownerSVGElement!==void 0,q8=e!=null&&!("__preactattr_"in e));var a=dKe(e,t,n,r,s);return i&&a.parentNode!==i&&i.appendChild(a),--oee||(q8=!1,s||fKe()),a}function dKe(e,t,n,r,i){var s=e,a=Yg;if((t==null||typeof t=="boolean")&&(t=""),typeof t=="string"||typeof t=="number")return e&&e.splitText!==void 0&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(s=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(s,e),Db(e,!0))),s.__preactattr_=!0,s;var o=t.nodeName;if(typeof o=="function")return G9n(e,t,n,r);if(Yg=o==="svg"?!0:o==="foreignObject"?!1:Yg,o=String(o),(!e||!lKe(e,o))&&(s=U9n(o,Yg),e)){for(;e.firstChild;)s.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(s,e),Db(e,!0)}var l=s.firstChild,u=s.__preactattr_,c=t.children;if(u==null){u=s.__preactattr_={};for(var f=s.attributes,h=f.length;h--;)u[f[h].name]=f[h].value}return!q8&&c&&c.length===1&&typeof c[0]=="string"&&l!=null&&l.splitText!==void 0&&l.nextSibling==null?l.nodeValue!=c[0]&&(l.nodeValue=c[0]):(c&&c.length||l!=null)&&V9n(s,c,n,r,q8||u.dangerouslySetInnerHTML!=null),j9n(s,t.attributes,u),Yg=a,s}function V9n(e,t,n,r,i){var s=e.childNodes,a=[],o={},l=0,u=0,c=s.length,f=0,h=t?t.length:0,d,p,g,m,v;if(c!==0)for(var y=0;y<c;y++){var b=s[y],x=b.__preactattr_,w=h&&x?b._component?b._component.__key:x.key:null;w!=null?(l++,o[w]=b):(x||(b.splitText!==void 0?i?b.nodeValue.trim():!0:i))&&(a[f++]=b)}if(h!==0)for(var y=0;y<h;y++){m=t[y],v=null;var w=m.key;if(w!=null)l&&o[w]!==void 0&&(v=o[w],o[w]=void 0,l--);else if(!v&&u<f){for(d=u;d<f;d++)if(a[d]!==void 0&&z9n(p=a[d],m,i)){v=p,a[d]=void 0,d===f-1&&f--,d===u&&u++;break}}v=dKe(v,m,n,r),g=s[y],v&&v!==e&&v!==g&&(g==null?e.appendChild(v):v===g.nextSibling?Uhe(g):e.insertBefore(v,g))}if(l)for(var y in o)o[y]!==void 0&&Db(o[y],!1);for(;u<=f;)(v=a[f--])!==void 0&&Db(v,!1)}function Db(e,t){var n=e._component;n?CV(n):(e.__preactattr_!=null&&e.__preactattr_.ref&&e.__preactattr_.ref(null),(t===!1||e.__preactattr_==null)&&Uhe(e),pKe(e))}function pKe(e){for(e=e.lastChild;e;){var t=e.previousSibling;Db(e,!0),e=t}}function j9n(e,t,n){var r;for(r in n)!(t&&t[r]!=null)&&n[r]!=null&&SSe(e,r,n[r],n[r]=void 0,Yg);for(r in t)r!=="children"&&r!=="innerHTML"&&(!(r in n)||t[r]!==(r==="value"||r==="checked"?e[r]:n[r]))&&SSe(e,r,n[r],n[r]=t[r],Yg)}var lee={};function H9n(e){var t=e.constructor.name;(lee[t]||(lee[t]=[])).push(e)}function gKe(e,t,n){var r=lee[e.name],i;if(e.prototype&&e.prototype.render?(i=new e(t,n),XD.call(i,t,n)):(i=new XD(t,n),i.constructor=e,i.render=q9n),r){for(var s=r.length;s--;)if(r[s].constructor===e){i.nextBase=r[s].nextBase,r.splice(s,1);break}}return i}function q9n(e,t,n){return this.constructor(e,n)}function G8(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,n!==0&&(n===1||gl.syncComponentUpdates!==!1||!e.base?$V(e,1,i):oKe(e)),e.__ref&&e.__ref(e))}function $V(e,t,n,r){if(!e._disable){var i=e.props,s=e.state,a=e.context,o=e.prevProps||i,l=e.prevState||s,u=e.prevContext||a,c=e.base,f=e.nextBase,h=c||f,d=e._component,p=!1,g,m,v;if(c&&(e.props=o,e.state=l,e.context=u,t!==2&&e.shouldComponentUpdate&&e.shouldComponentUpdate(i,s,a)===!1?p=!0:e.componentWillUpdate&&e.componentWillUpdate(i,s,a),e.props=i,e.state=s,e.context=a),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!p){g=e.render(i,s,a),e.getChildContext&&(a=N0(N0({},a),e.getChildContext()));var y=g&&g.nodeName,b,x;if(typeof y=="function"){var w=uKe(g);m=d,m&&m.constructor===y&&w.key==m.__key?G8(m,w,1,a,!1):(b=m,e._component=m=gKe(y,w,a),m.nextBase=m.nextBase||f,m._parentComponent=e,G8(m,w,0,a,!1),$V(m,1,n,!0)),x=m.base}else v=h,b=d,b&&(v=e._component=null),(h||t===1)&&(v&&(v._component=null),x=hKe(v,g,a,n||!c,h&&h.parentNode,!0));if(h&&x!==h&&m!==d){var C=h.parentNode;C&&x!==C&&(C.replaceChild(x,h),b||(h._component=null,Db(h,!1)))}if(b&&CV(b),e.base=x,x&&!r){for(var $=e,_=e;_=_._parentComponent;)($=_).base=x;x._component=$,x._componentConstructor=$.constructor}}if(!c||n?cKe.unshift(e):p||(e.componentDidUpdate&&e.componentDidUpdate(o,l,u),gl.afterUpdate&&gl.afterUpdate(e)),e._renderCallbacks!=null)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);!oee&&!r&&fKe()}}function G9n(e,t,n,r){for(var i=e&&e._component,s=i,a=e,o=i&&e._componentConstructor===t.nodeName,l=o,u=uKe(t);i&&!l&&(i=i._parentComponent);)l=i.constructor===t.nodeName;return i&&l&&(!r||i._component)?(G8(i,u,3,n,r),e=i.base):(s&&!o&&(CV(s),e=a=null),i=gKe(t.nodeName,u,n),e&&!i.nextBase&&(i.nextBase=e,a=null),G8(i,u,1,n,r),e=i.base,a&&e!==a&&(a._component=null,Db(a,!1))),e}function CV(e){gl.beforeUnmount&&gl.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?CV(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,Uhe(t),H9n(e),pKe(t)),e.__ref&&e.__ref(null)}function XD(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}N0(XD.prototype,{setState:function(t,n){var r=this.state;this.prevState||(this.prevState=N0({},r)),N0(r,typeof t=="function"?t(r,this.props):t),n&&(this._renderCallbacks=this._renderCallbacks||[]).push(n),oKe(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),$V(this,2)},render:function(){}});function mKe(e,t,n){return hKe(n,e,{},!1,t,!1)}var Y9n={h:YD,createElement:YD,cloneElement:aKe,Component:XD,render:mKe,rerender:zhe,options:gl};const X9n=Object.freeze(Object.defineProperty({__proto__:null,default:Y9n,h:YD,createElement:YD,cloneElement:aKe,Component:XD,render:mKe,rerender:zhe,options:gl},Symbol.toStringTag,{value:"Module"})),Whe=Ob(X9n);var Vhe={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Vhe,"__esModule",{value:!0});const jR=Whe,jG=De;class bw extends jR.Component{componentDidMount(){const{name:t,tab:n}=this.props;this.props.registerSurface(t,n,this)}componentDidUpdate(){return!1}render(){const{name:t,visible:n,styles:r}=this.props,i=Object.assign({},bw.defaultStyles,r),{width:s,height:a}=i;let{maxHeight:o,maxWidth:l}=i;o=a===bw.defaultStyles.height?o:a,l=s===bw.defaultStyles.width?l:s;const u=jG.css({display:n?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:a,width:s,maxHeight:o,maxWidth:l,overflow:"auto"}),c=jG.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),f=jG.css({boxSizing:"border-box"});return jR.h("div",{className:`${u} tf-surface`,ref:h=>this.container=h,"data-visible":n},jR.h("div",{className:`${c} tf-label`,ref:h=>this.label=h},t),jR.h("div",{className:`${f} tf-draw-area`,ref:h=>this.drawArea=h}))}}bw.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"};Vhe.SurfaceComponent=bw;var jhe={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(jhe,"__esModule",{value:!0});const GA=Whe,vKe=De;class K9n extends GA.Component{render(){const{tabNames:t,activeTab:n,handleClick:r}=this.props,i=t.length>0?t.map(a=>GA.h(Z9n,{key:a,id:a,handleClick:r,isActive:a===n},a)):null,s=vKe.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return GA.h("div",{className:`${s} visor-tabs`},i)}}jhe.Tabs=K9n;class Z9n extends GA.Component{render(){const{children:t,isActive:n,handleClick:r,id:i}=this.props,s=vKe.css({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return GA.h("a",{className:`${s} tf-tab`,"data-isactive":n,onClick:()=>r(i)},t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Bhe,"__esModule",{value:!0});const pc=Whe,G1=De,Q9n=Vhe,J9n=jhe;class Hhe extends pc.Component{static render(t,n,r){return pc.render(pc.h(Hhe,Object.assign({},r)),t,n)}constructor(t){super(t),this.surfaces=new Map;const n=t.startOpen==null?!0:t.startOpen;this.state={isOpen:n,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,n){const r=this.surfaceId(t,n);let i;if(this.surfaces.has(r))i=this.surfaces.get(r);else throw Error(`Surface not found with id: ${r}`);return{container:i.container,label:i.label,drawArea:i.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,n){return t+n}setTabs(t){const n=t.map(s=>s.tab),r=this.state.tabs;let i;for(const s of n)r.has(s)||(r.add(s),i=s);i!=null&&this.setState({tabs:r,activeTab:i})}getTabs(){return this.state.tabs}registerSurface(t,n,r){const i=this.surfaceId(t,n);this.surfaces.set(i,r)}keyHandler(t){t.keyCode===192&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){const{isOpen:t,isFullscreen:n,activeTab:r}=this.state,{surfaceList:i}=this.props,s=Array.from(this.getTabs().values()),l=n?"90vw":"550px",u=G1.css({width:l,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),c=G1.css({right:"0"}),f=G1.css({right:`calc(-${l} - 10px)`}),h=t?c:f,d=G1.css({});return pc.h("div",{className:`${u} ${h} visor`,"data-isopen":t,"data-isfullscreen":n},pc.h(eUn,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:n}),pc.h(J9n.Tabs,{tabNames:s,activeTab:r,handleClick:this.setActiveTab.bind(this)}),pc.h("div",{className:`${d} visor-surfaces`},i.map(p=>pc.h(Q9n.SurfaceComponent,{key:p.name+p.tab,name:p.name,tab:p.tab,styles:p.styles,registerSurface:this.registerSurface.bind(this),visible:r===p.tab}))))}}Bhe.VisorComponent=Hhe;function eUn(e){const{isFullScreen:t,fullScreenHandler:n,closeHandler:r}=e,i=G1.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),s=G1.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),a=G1.css({marginLeft:"auto"});return pc.h("div",{className:`${i} visor-controls`},pc.h("button",{className:`${s}`,onClick:n},t?"Minimize":"Maximize"),pc.h("button",{className:`${s} ${a}`,onClick:r},"Hide"))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(OF,"__esModule",{value:!0});const tUn=Bhe;let HR;const nUn="Visor",HG="tfjs-visor-container";function rUn(){if(typeof document>"u")throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(HG)&&HR!=null)return HR;let e=document.getElementById(HG);e==null&&(e=document.createElement("div"),e.id=HG,document.body.appendChild(e));let t;function n(s,a){let o=null;return t=tUn.VisorComponent.render(s,t,{ref:l=>o=l,surfaceList:Array.from(a.values())}),o}const r=new Map,i=n(e,r);return HR=new yKe(i,e,r,n),HR}OF.visor=rUn;class yKe{constructor(t,n,r,i){this.visorComponent=t,this.el=n,this.surfaceList=r,this.renderVisor=i}surface(t){const{name:n}=t,r=t.tab==null?nUn:t.tab;if(n==null||!(typeof n=="string"||n instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const i=Object.assign({},t,{tab:r}),s=`${n}-${r}`;return this.surfaceList.has(s)||this.surfaceList.set(s,i),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(n,r)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error(`Tab '${t}' does not exist`);this.visorComponent.setState({activeTab:t})}}OF.Visor=yKe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var iUn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(Do,"__esModule",{value:!0});const ESe=FF,sUn=OF;function aUn(e){if(e instanceof HTMLElement)return e;if(ESe.isSurface(e))return e.drawArea;if(ESe.isSurfaceInfo(e))return sUn.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")}Do.getDrawArea=aUn;function oUn(e,t){const n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){const s=n[i];if(e[s]!==t[s])return!1}return!0}Do.shallowEquals=oUn;function lUn(){return iUn(this,void 0,void 0,function*(){yield new Promise(e=>requestAnimationFrame(e))})}Do.nextFrame=lUn;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Ju,"__esModule",{value:!0});const ASe=De,uUn=Do,cUn={prepend:!1};function fUn(e,t,n={}){const r=uUn.getDrawArea(e),i=ASe.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),s=ASe.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),a=Object.assign({},cUn,n);let o=r.querySelector(`div[data-name=${t}]`);if(!o){if(o=document.createElement("div"),o.setAttribute("class",`${i}`),o.dataset.name=t,a.title){const l=document.createElement("div");l.setAttribute("class",`subsurface-title ${s}`),l.innerText=a.title,o.appendChild(l)}a.prepend?r.insertBefore(o,r.firstChild):r.appendChild(o)}return o}Ju.subSurface=fUn;function hUn(e){let n=0,r=e;for(;r&&r.clientWidth===0;)r=r.parentElement,n=50;return r.clientWidth-n}Ju.getDefaultWidth=hUn;function dUn(e){return e.clientHeight===0?200:e.clientHeight}Ju.getDefaultHeight=dUn;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var pUn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})},gUn=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gre,"__esModule",{value:!0});const mUn=gUn(MS),TSe=Ju,qR=Do;function vUn(e,t,n={}){return pUn(this,void 0,void 0,function*(){const r=qR.getDrawArea(e),i=t,s=Object.assign({},yUn,n);if(qG.has(r)){const m=qG.get(r);if(qR.shallowEquals(s,m.lastOptions)){yield qR.nextFrame();const v=m.view,y=v.changeset().remove(()=>!0).insert(i);yield v.change("values",y).runAsync();return}}const{xLabel:a,yLabel:o,xType:l,yType:u}=s;let c=null;a!=null&&(c={title:a});let f=null;o!=null&&(f={title:o});const h={actions:!1,mode:"vega-lite",defaultStyle:!1};let d;s.color!=null?Array.isArray(s.color)?d={field:"index",type:"nominal",scale:{range:s.color}}:d={value:s.color}:d={value:"#4C78A0"};const p={width:s.width||TSe.getDefaultWidth(r),height:s.height||TSe.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:l,axis:c},y:{field:"value",type:u,axis:f},color:d}};yield qR.nextFrame();const g=yield mUn.default(r,p,h);qG.set(r,{view:g.view,lastOptions:s})})}gre.barchart=vUn;const yUn={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},qG=new Map;var qhe={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bUn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})},xUn=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qhe,"__esModule",{value:!0});const wUn=xUn(MS),DSe=Ju,$Un=Do;function CUn(e,t,n={}){return bUn(this,void 0,void 0,function*(){const r=Object.assign({},_Un,n),i=$Un.getDrawArea(e),s=[],a=t.values,o=t.tickLabels||[],l=o.length===0;let u=!0;for(let d=0;d<a.length;d++){const p=l?`Class ${d}`:o[d];l&&o.push(p);for(let g=0;g<a[d].length;g++){const m=l?`Class ${g}`:o[g],v=a[d][g];d===g&&!r.shadeDiagonal?s.push({label:p,prediction:m,count:v,noFill:!0}):(s.push({label:p,prediction:m,count:v,scaleCount:v}),v!==0&&(u=!1))}}if(!r.shadeDiagonal&&u)for(const d of s)d.noFill===!0&&(d.noFill=!1,d.scaleCount=d.count);const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||DSe.getDefaultWidth(i),height:r.height||DSe.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:s},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:o}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:o}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};r.shadeDiagonal===!1&&f.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&f.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});const h=typeof r.colorMap=="string"?{scheme:r.colorMap}:r.colorMap;f.layer[0].encoding.color.scale.range=h,yield wUn.default(i,f,c)})}qhe.confusionMatrix=CUn;const _Un={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]};var Ghe={},_g={};Object.defineProperty(_g,"__esModule",{value:!0});/*
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bKe(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}_g.assert=bKe;function SUn(e,t,n=""){bKe(xKe(e,t),n+` Shapes ${e} and ${t} must match`)}_g.assertShapesMatch=SUn;function xKe(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}_g.arraysEqual=xKe;_g.DECIMAL_PLACES_TO_CHECK=4;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wKe=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})},kUn=mt&&mt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},EUn=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ghe,"__esModule",{value:!0});const YA=kUn($Fe),AUn=EUn(MS),NSe=Ju,KD=_g,TUn=Do;function DUn(e,t,n={}){return wKe(this,void 0,void 0,function*(){const r=Object.assign({},IUn,n),i=TUn.getDrawArea(e);let s=t.values;r.rowMajor&&(s=yield NUn(t.values));const{xTickLabels:a,yTickLabels:o}=t;a!=null&&ISe(s,a,0),o!=null&&ISe(s,o,1);const l="@tfidx@",u=[];if(s instanceof YA.Tensor){KD.assert(s.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const g=yield s.data(),[m,v]=s.shape;for(let y=0;y<m;y++){const b=a?`${a[y]}${l}${y}`:y;for(let x=0;x<v;x++){const w=o?`${o[x]}${l}${x}`:x,C=y*v+x,$=g[C];u.push({x:b,y:w,value:$})}}}else{const g=s;for(let m=0;m<g.length;m++){const v=a?`${a[m]}${l}${m}`:m;for(let y=0;y<g[m].length;y++){const b=o?`${o[y]}${l}${y}`:y,x=g[m][y];u.push({x:v,y:b,value:x})}}}const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||NSe.getDefaultWidth(i),height:r.height||NSe.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:u},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:r.xType,title:r.xLabel,sort:!1},y:{field:"y",type:r.yType,title:r.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},h=`${l}\\d+$`,d=new RegExp(h);a&&(f.encoding.x.axis={labelExpr:`replace(datum.value, regexp(/${h}/), '')`}),o&&(f.encoding.y.axis={labelExpr:`replace(datum.value, regexp(/${h}/), '')`}),(a||o)&&(c.tooltip={sanitize:g=>String(g).replace(d,"")});let p;switch(r.colorMap){case"blues":p=["#f7fbff","#4292c6"];break;case"greyscale":p=["#000000","#ffffff"];break;case"viridis":default:p="viridis";break}if(p!=="viridis"){const g=f.encoding.fill;g.scale={range:p}}if(r.domain){const g=f.encoding.fill;g.scale!=null?g.scale=Object.assign({},g.scale,{domain:r.domain}):g.scale={domain:r.domain}}yield AUn.default(i,f,c)})}Ghe.heatmap=DUn;function NUn(e){return wKe(this,void 0,void 0,function*(){let t,n;e instanceof YA.Tensor?(t=e.shape,n=e.transpose()):(t=[e.length,e[0].length],n=YA.tidy(()=>YA.tensor2d(e).transpose())),KD.assert(n.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const r=yield n.array();n.dispose();const i=[r.length,r[0].length];return KD.assert(t[0]===i[1]&&t[1]===i[0],`Unexpected transposed shape. Original ${t} : Transposed ${i}`),r})}function ISe(e,t,n){const r=e instanceof YA.Tensor?e.shape:[e.length,e[0].length];n===0?KD.assert(r[0]===t.length,`Length of xTickLabels (${t.length}) must match number of rows (${r[0]})`):n===1&&KD.assert(r[1]===t.length,`Length of yTickLabels (${t.length}) must match number of columns (${r[1]})`)}const IUn={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1};var RF={};function Y8(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function aC(e){return e=Y8(Math.abs(e)),e?e[1]:NaN}function MUn(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function FUn(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var OUn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function X8(e){return new Yhe(e)}X8.prototype=Yhe.prototype;function Yhe(e){if(!(t=OUn.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}Yhe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function RUn(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(r>0){if(!+e[n])break e;r=0}break}return r>0?e.slice(0,r)+e.slice(i+1):e}var $Ke;function PUn(e,t){var n=Y8(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-($Ke=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+Y8(e,Math.max(0,t+s-1))[0]}function MSe(e,t){var n=Y8(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const FSe={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return MSe(e*100,t)},r:MSe,s:PUn,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function OSe(e){return e}var RSe=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function CKe(e){var t=e.grouping&&e.thousands?MUn(e.grouping,e.thousands):OSe,n=e.currency,r=e.decimal,i=e.numerals?FUn(e.numerals):OSe,s=e.percent||"%";function a(l){l=X8(l);var u=l.fill,c=l.align,f=l.sign,h=l.symbol,d=l.zero,p=l.width,g=l.comma,m=l.precision,v=l.trim,y=l.type;y==="n"?(g=!0,y="g"):FSe[y]||(m==null&&(m=12),v=!0,y="g"),(d||u==="0"&&c==="=")&&(d=!0,u="0",c="=");var b=h==="$"?n[0]:h==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x=h==="$"?n[1]:/[%p]/.test(y)?s:"",w=FSe[y],C=/[defgprs%]/.test(y);m=m==null?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m));function $(_){var k=b,E=x,S,N,A;if(y==="c")E=w(_)+E,_="";else{_=+_;var D=_<0;if(_=w(Math.abs(_),m),v&&(_=RUn(_)),D&&+_==0&&(D=!1),k=(D?f==="("?f:"-":f==="-"||f==="("?"":f)+k,E=(y==="s"?RSe[8+$Ke/3]:"")+E+(D&&f==="("?")":""),C){for(S=-1,N=_.length;++S<N;)if(A=_.charCodeAt(S),48>A||A>57){E=(A===46?r+_.slice(S+1):_.slice(S))+E,_=_.slice(0,S);break}}}g&&!d&&(_=t(_,1/0));var T=k.length+_.length+E.length,I=T<p?new Array(p-T+1).join(u):"";switch(g&&d&&(_=t(I+_,I.length?p-E.length:1/0),I=""),c){case"<":_=k+_+E+I;break;case"=":_=k+I+_+E;break;case"^":_=I.slice(0,T=I.length>>1)+k+_+E+I.slice(T);break;default:_=I+k+_+E;break}return i(_)}return $.toString=function(){return l+""},$}function o(l,u){var c=a((l=X8(l),l.type="f",l)),f=Math.max(-8,Math.min(8,Math.floor(aC(u)/3)))*3,h=Math.pow(10,-f),d=RSe[8+f/3];return function(p){return c(h*p)+d}}return{format:a,formatPrefix:o}}var GR,_Ke,SKe;kKe({decimal:".",thousands:",",grouping:[3],currency:["$",""]});function kKe(e){return GR=CKe(e),_Ke=GR.format,SKe=GR.formatPrefix,GR}function LUn(e){return Math.max(0,-aC(Math.abs(e)))}function BUn(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(aC(t)/3)))*3-aC(Math.abs(e)))}function zUn(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,aC(t)-aC(e))+1}const UUn=Object.freeze(Object.defineProperty({__proto__:null,formatDefaultLocale:kKe,get format(){return _Ke},get formatPrefix(){return SKe},formatLocale:CKe,formatSpecifier:X8,precisionFixed:LUn,precisionPrefix:BUn,precisionRound:zUn},Symbol.toStringTag,{value:"Module"})),EKe=Ob(UUn);var Ed={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var _V=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(Ed,"__esModule",{value:!0});const Nb=$Fe,d0=_g;function WUn(e){if(!Array.isArray(e))throw new Error("input must be an array");if(e.length===0)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const t=e.length;let n=-1/0,r=1/0,i=0,s=0,a=0;for(let l=0;l<t;l++){const u=e[l];u>n&&(n=u),u<r&&(r=u),u===0&&(i+=1),isNaN(u)?s+=1:isFinite(u)||(a+=1)}const o={numVals:t,numZeros:i,numNans:s,max:n,min:r,numInfs:a};return o.max===-1/0&&(o.max=NaN),o.min===1/0&&(o.min=NaN),o}Ed.arrayStats=WUn;function VUn(e){return _V(this,void 0,void 0,function*(){const[t,n,r]=Nb.tidy(()=>{const i=Nb.scalar(0,e.dtype),s=e.min(),a=e.max(),o=e.equal(i).sum();return[s,a,o]});return Promise.all([e.data(),t.data(),n.data(),r.data()]).then(([i,s,a,o])=>{const l=i.length;let u=0,c=0;for(let p=0;p<l;p++){const g=i[p];isNaN(g)?u+=1:isFinite(g)||(c+=1)}let f=s[0],h=a[0];return u===l&&(f=NaN,h=NaN),{numVals:l,numZeros:o[0],numNans:u,min:f,max:h,numInfs:c}})})}Ed.tensorStats=VUn;function jUn(e,t,n,r){return _V(this,void 0,void 0,function*(){d0.assert(e.rank===1,"labels must be a 1D tensor"),d0.assert(t.rank===1,"predictions must be a 1D tensor"),d0.assert(e.size===t.size,"labels and predictions must be the same length"),r!=null&&d0.assert(r.size===t.size,"labels and predictions must be the same length");const i=e.cast("int32"),s=t.cast("int32");n==null&&(n=Nb.tidy(()=>Nb.maximum(i.max(),s.max()).cast("int32").dataSync()[0]+1));let a=Promise.resolve(null);return r!=null&&(a=r.data()),Promise.all([i.data(),s.data(),a]).then(([o,l,u])=>{const c=Array(n).fill(0);for(let f=0;f<n;f++)c[f]=Array(n).fill(0);for(let f=0;f<o.length;f++){const h=o[f],d=l[f];u!=null?c[h][d]+=u[f]:c[h][d]+=1}return c})})}Ed.confusionMatrix=jUn;function HUn(e,t){return _V(this,void 0,void 0,function*(){d0.assertShapesMatch(e.shape,t.shape,"Error computing accuracy.");const n=e.equal(t),r=n.mean(),i=(yield r.data())[0];return Nb.dispose([n,r]),i})}Ed.accuracy=HUn;function qUn(e,t,n){return _V(this,void 0,void 0,function*(){return d0.assert(e.rank===1,"labels must be a 1D tensor"),d0.assert(t.rank===1,"predictions must be a 1D tensor"),d0.assert(e.size===t.size,"labels and predictions must be the same length"),n==null&&(n=Nb.tidy(()=>Nb.maximum(e.max(),t.max()).dataSync()[0]+1)),Promise.all([e.data(),t.data()]).then(([r,i])=>{const s=Array(n).fill(0),a=Array(n).fill(0);for(let l=0;l<r.length;l++){const u=r[l],c=i[l];s[u]+=1,u===c&&(a[u]+=1)}const o=[];for(let l=0;l<s.length;l++)o.push({count:s[l],accuracy:s[l]===0?0:a[l]/s[l]});return o})})}Ed.perClassAccuracy=qUn;var RS={},uee="http://www.w3.org/1999/xhtml";const cee={svg:"http://www.w3.org/2000/svg",xhtml:uee,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Xhe(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),cee.hasOwnProperty(t)?{space:cee[t],local:e}:e}function GUn(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===uee&&t.documentElement.namespaceURI===uee?t.createElement(e):t.createElementNS(n,e)}}function YUn(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function SV(e){var t=Xhe(e);return(t.local?YUn:GUn)(t)}function XUn(){}function Khe(e){return e==null?XUn:function(){return this.querySelector(e)}}function KUn(e){typeof e!="function"&&(e=Khe(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,o=r[i]=new Array(a),l,u,c=0;c<a;++c)(l=s[c])&&(u=e.call(l,l.__data__,c,s))&&("__data__"in l&&(u.__data__=l.__data__),o[c]=u);return new _o(r,this._parents)}function ZUn(){return[]}function AKe(e){return e==null?ZUn:function(){return this.querySelectorAll(e)}}function QUn(e){typeof e!="function"&&(e=AKe(e));for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var a=t[s],o=a.length,l,u=0;u<o;++u)(l=a[u])&&(r.push(e.call(l,l.__data__,u,a)),i.push(l));return new _o(r,i)}var TKe=function(e){return function(){return this.matches(e)}};if(typeof document<"u"){var Jk=document.documentElement;if(!Jk.matches){var JUn=Jk.webkitMatchesSelector||Jk.msMatchesSelector||Jk.mozMatchesSelector||Jk.oMatchesSelector;TKe=function(e){return function(){return JUn.call(this,e)}}}}const DKe=TKe;function eWn(e){typeof e!="function"&&(e=DKe(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,o=r[i]=[],l,u=0;u<a;++u)(l=s[u])&&e.call(l,l.__data__,u,s)&&o.push(l);return new _o(r,this._parents)}function NKe(e){return new Array(e.length)}function tWn(){return new _o(this._enter||this._groups.map(NKe),this._parents)}function K8(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}K8.prototype={constructor:K8,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function nWn(e){return function(){return e}}var PSe="$";function rWn(e,t,n,r,i,s){for(var a=0,o,l=t.length,u=s.length;a<u;++a)(o=t[a])?(o.__data__=s[a],r[a]=o):n[a]=new K8(e,s[a]);for(;a<l;++a)(o=t[a])&&(i[a]=o)}function iWn(e,t,n,r,i,s,a){var o,l,u={},c=t.length,f=s.length,h=new Array(c),d;for(o=0;o<c;++o)(l=t[o])&&(h[o]=d=PSe+a.call(l,l.__data__,o,t),d in u?i[o]=l:u[d]=l);for(o=0;o<f;++o)d=PSe+a.call(e,s[o],o,s),(l=u[d])?(r[o]=l,l.__data__=s[o],u[d]=null):n[o]=new K8(e,s[o]);for(o=0;o<c;++o)(l=t[o])&&u[h[o]]===l&&(i[o]=l)}function sWn(e,t){if(!e)return d=new Array(this.size()),u=-1,this.each(function(C){d[++u]=C}),d;var n=t?iWn:rWn,r=this._parents,i=this._groups;typeof e!="function"&&(e=nWn(e));for(var s=i.length,a=new Array(s),o=new Array(s),l=new Array(s),u=0;u<s;++u){var c=r[u],f=i[u],h=f.length,d=e.call(c,c&&c.__data__,u,r),p=d.length,g=o[u]=new Array(p),m=a[u]=new Array(p),v=l[u]=new Array(h);n(c,f,g,m,v,d,t);for(var y=0,b=0,x,w;y<p;++y)if(x=g[y]){for(y>=b&&(b=y+1);!(w=m[b])&&++b<p;);x._next=w||null}}return a=new _o(a,r),a._enter=o,a._exit=l,a}function aWn(){return new _o(this._exit||this._groups.map(NKe),this._parents)}function oWn(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),a=new Array(r),o=0;o<s;++o)for(var l=t[o],u=n[o],c=l.length,f=a[o]=new Array(c),h,d=0;d<c;++d)(h=l[d]||u[d])&&(f[d]=h);for(;o<r;++o)a[o]=t[o];return new _o(a,this._parents)}function lWn(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],a;--i>=0;)(a=r[i])&&(s&&s!==a.nextSibling&&s.parentNode.insertBefore(a,s),s=a);return this}function uWn(e){e||(e=cWn);function t(f,h){return f&&h?e(f.__data__,h.__data__):!f-!h}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var a=n[s],o=a.length,l=i[s]=new Array(o),u,c=0;c<o;++c)(u=a[c])&&(l[c]=u);l.sort(t)}return new _o(i,this._parents).order()}function cWn(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function fWn(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function hWn(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e}function dWn(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var a=r[i];if(a)return a}return null}function pWn(){var e=0;return this.each(function(){++e}),e}function gWn(){return!this.node()}function mWn(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,a=i.length,o;s<a;++s)(o=i[s])&&e.call(o,o.__data__,s,i);return this}function vWn(e){return function(){this.removeAttribute(e)}}function yWn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function bWn(e,t){return function(){this.setAttribute(e,t)}}function xWn(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function wWn(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function $Wn(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function CWn(e,t){var n=Xhe(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?yWn:vWn:typeof t=="function"?n.local?$Wn:wWn:n.local?xWn:bWn)(n,t))}function Zhe(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function _Wn(e){return function(){this.style.removeProperty(e)}}function SWn(e,t,n){return function(){this.style.setProperty(e,t,n)}}function kWn(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function EWn(e,t,n){return arguments.length>1?this.each((t==null?_Wn:typeof t=="function"?kWn:SWn)(e,t,n==null?"":n)):IKe(this.node(),e)}function IKe(e,t){return e.style.getPropertyValue(t)||Zhe(e).getComputedStyle(e,null).getPropertyValue(t)}function AWn(e){return function(){delete this[e]}}function TWn(e,t){return function(){this[e]=t}}function DWn(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function NWn(e,t){return arguments.length>1?this.each((t==null?AWn:typeof t=="function"?DWn:TWn)(e,t)):this.node()[e]}function MKe(e){return e.trim().split(/^|\s+/)}function Qhe(e){return e.classList||new FKe(e)}function FKe(e){this._node=e,this._names=MKe(e.getAttribute("class")||"")}FKe.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function OKe(e,t){for(var n=Qhe(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function RKe(e,t){for(var n=Qhe(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function IWn(e){return function(){OKe(this,e)}}function MWn(e){return function(){RKe(this,e)}}function FWn(e,t){return function(){(t.apply(this,arguments)?OKe:RKe)(this,e)}}function OWn(e,t){var n=MKe(e+"");if(arguments.length<2){for(var r=Qhe(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?FWn:t?IWn:MWn)(n,t))}function RWn(){this.textContent=""}function PWn(e){return function(){this.textContent=e}}function LWn(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function BWn(e){return arguments.length?this.each(e==null?RWn:(typeof e=="function"?LWn:PWn)(e)):this.node().textContent}function zWn(){this.innerHTML=""}function UWn(e){return function(){this.innerHTML=e}}function WWn(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function VWn(e){return arguments.length?this.each(e==null?zWn:(typeof e=="function"?WWn:UWn)(e)):this.node().innerHTML}function jWn(){this.nextSibling&&this.parentNode.appendChild(this)}function HWn(){return this.each(jWn)}function qWn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function GWn(){return this.each(qWn)}function YWn(e){var t=typeof e=="function"?e:SV(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function XWn(){return null}function KWn(e,t){var n=typeof e=="function"?e:SV(e),r=t==null?XWn:typeof t=="function"?t:Khe(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ZWn(){var e=this.parentNode;e&&e.removeChild(this)}function QWn(){return this.each(ZWn)}function JWn(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function eVn(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}function tVn(e){return this.select(e?eVn:JWn)}function nVn(e){return arguments.length?this.property("__data__",e):this.node().__data__}var PKe={},mp=null;if(typeof document<"u"){var rVn=document.documentElement;"onmouseenter"in rVn||(PKe={mouseenter:"mouseover",mouseleave:"mouseout"})}function iVn(e,t,n){return e=LKe(e,t,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&e.call(this,r)}}function LKe(e,t,n){return function(r){var i=mp;mp=r;try{e.call(this,this.__data__,t,n)}finally{mp=i}}}function sVn(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function aVn(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.capture):t[++r]=s;++r?t.length=r:delete this.__on}}}function oVn(e,t,n){var r=PKe.hasOwnProperty(e.type)?iVn:LKe;return function(i,s,a){var o=this.__on,l,u=r(t,s,a);if(o){for(var c=0,f=o.length;c<f;++c)if((l=o[c]).type===e.type&&l.name===e.name){this.removeEventListener(l.type,l.listener,l.capture),this.addEventListener(l.type,l.listener=u,l.capture=n),l.value=t;return}}this.addEventListener(e.type,u,n),l={type:e.type,name:e.name,value:t,listener:u,capture:n},o?o.push(l):this.__on=[l]}}function lVn(e,t,n){var r=sVn(e+""),i,s=r.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,u=o.length,c;l<u;++l)for(i=0,c=o[l];i<s;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(o=t?oVn:aVn,n==null&&(n=!1),i=0;i<s;++i)this.each(o(r[i],t,n));return this}function uVn(e,t,n,r){var i=mp;e.sourceEvent=mp,mp=e;try{return t.apply(n,r)}finally{mp=i}}function BKe(e,t,n){var r=Zhe(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function cVn(e,t){return function(){return BKe(this,e,t)}}function fVn(e,t){return function(){return BKe(this,e,t.apply(this,arguments))}}function hVn(e,t){return this.each((typeof t=="function"?fVn:cVn)(e,t))}var Jhe=[null];function _o(e,t){this._groups=e,this._parents=t}function zKe(){return new _o([[document.documentElement]],Jhe)}_o.prototype=zKe.prototype={constructor:_o,select:KUn,selectAll:QUn,filter:eWn,data:sWn,enter:tWn,exit:aWn,merge:oWn,order:lWn,sort:uWn,call:fWn,nodes:hWn,node:dWn,size:pWn,empty:gWn,each:mWn,attr:CWn,style:EWn,property:NWn,classed:OWn,text:BWn,html:VWn,raise:HWn,lower:GWn,append:YWn,insert:KWn,remove:QWn,clone:tVn,datum:nVn,on:lVn,dispatch:hVn};function UKe(e){return typeof e=="string"?new _o([[document.querySelector(e)]],[document.documentElement]):new _o([[e]],Jhe)}function dVn(e){return UKe(SV(e).call(document.documentElement))}var pVn=0;function WKe(){return new fee}function fee(){this._="@"+(++pVn).toString(36)}fee.prototype=WKe.prototype={constructor:fee,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function ede(){for(var e=mp,t;t=e.sourceEvent;)e=t;return e}function kV(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}function gVn(e){var t=ede();return t.changedTouches&&(t=t.changedTouches[0]),kV(e,t)}function mVn(e){return typeof e=="string"?new _o([document.querySelectorAll(e)],[document.documentElement]):new _o([e==null?[]:e],Jhe)}function vVn(e,t,n){arguments.length<3&&(n=t,t=ede().changedTouches);for(var r=0,i=t?t.length:0,s;r<i;++r)if((s=t[r]).identifier===n)return kV(e,s);return null}function yVn(e,t){t==null&&(t=ede().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=kV(e,t[n]);return i}const bVn=Object.freeze(Object.defineProperty({__proto__:null,create:dVn,creator:SV,local:WKe,matcher:DKe,mouse:gVn,namespace:Xhe,namespaces:cee,clientPoint:kV,select:UKe,selectAll:mVn,selection:zKe,selector:Khe,selectorAll:AKe,style:IKe,touch:vVn,touches:yVn,window:Zhe,get event(){return mp},customEvent:uVn},Symbol.toStringTag,{value:"Module"})),xVn=Ob(bVn);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(RS,"__esModule",{value:!0});const wVn=EKe,LSe=xVn,GG=De,$Vn=Do;function CVn(e,t,n={}){if(t&&t.headers==null)throw new Error('Data to render must have a "headers" property');if(t&&t.values==null)throw new Error('Data to render must have a "values" property');const r=$Vn.getDrawArea(e),i=Object.assign({},_Vn,n);let s=LSe.select(r).select("table.tf-table");const a=GG.css({fontSize:i.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(s.size()===0&&(s=LSe.select(r).append("table"),s.attr("class",` ${a} tf-table`),s.append("thead").append("tr"),s.append("tbody")),s.size()!==1)throw new Error("Error inserting table");const o=GG.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),l=s.select("thead").select("tr").selectAll("th").data(t.headers),u=l.enter().append("th").attr("class",`${o}`);l.merge(u).html(m=>m),l.exit().remove();const c=wVn.format(",.4~f"),f=s.select("tbody").selectAll("tr").data(t.values),h=f.enter().append("tr"),d=GG.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),p=f.merge(h).selectAll("td").data(m=>m),g=p.enter().append("td").attr("class",`${d}`);p.merge(g).html(m=>typeof m=="number"?c(m):m),p.exit().remove(),f.exit().remove()}RS.table=CVn;const _Vn={fontSize:14};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var SVn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})},kVn=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(RF,"__esModule",{value:!0});const BSe=EKe,EVn=kVn(MS),YR=Ju,AVn=Ed,TVn=RS,DVn={maxBins:12,fontSize:11};function NVn(e,t,n={}){return SVn(this,void 0,void 0,function*(){const r=MVn(t),i=Object.assign({},DVn,n),s={actions:!1,mode:"vega-lite",defaultStyle:!1},a=YR.subSurface(e,"histogram");if(n.stats!==!1){const u=YR.subSurface(e,"stats",{prepend:!0});let c;n.stats?c=n.stats:c=AVn.arrayStats(r.map(f=>f.value)),IVn(c,u,{fontSize:i.fontSize})}if(r.length===0)return;const o=[];for(let u=0;u<r.length;u++){const c=r[u].value;c!=null&&isFinite(c)&&o.push(r[u])}const l={width:i.width||YR.getDefaultWidth(a),height:i.height||YR.getDefaultHeight(a),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:o},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return EVn.default(a,l,s)})}RF.histogram=NVn;function IVn(e,t,n){const r=BSe.format(",.4~f"),i=BSe.format(".4~p"),s=[],a=[];if(e.numVals!=null&&(s.push("Num Vals"),a.push(r(e.numVals))),e.min!=null&&(s.push("Min"),a.push(r(e.min))),e.max!=null&&(s.push("Max"),a.push(r(e.max))),e.numZeros!=null){s.push("# Zeros");let o="";e.numVals&&(o=e.numZeros>0?`(${i(e.numZeros/e.numVals)})`:""),a.push(`${r(e.numZeros)} ${o}`)}if(e.numNans!=null){s.push("# NaNs");let o="";e.numVals&&(o=e.numNans>0?`(${i(e.numNans/e.numVals)})`:""),a.push(`${r(e.numNans)} ${o}`)}if(e.numInfs!=null){s.push("# Infinity");let o="";e.numVals&&(o=e.numInfs>0?`(${i(e.numInfs/e.numVals)})`:""),a.push(`${r(e.numInfs)} ${o}`)}TVn.table(t,{headers:s,values:[a]},n)}function MVn(e){if(e.length==null)throw new Error("input data must be an array");if(e.length===0)return[];if(typeof e[0]=="object"){if(e[0].value==null)throw new Error("input data must have a value field");return e}else{const t=Array(e.length);for(let n=0;n<e.length;n++)t[n]={value:e[n]};return t}}var EV={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var FVn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})},OVn=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(EV,"__esModule",{value:!0});const RVn=OVn(MS),zSe=Ju,USe=_g,PVn=Do;function LVn(e,t,n={}){return FVn(this,void 0,void 0,function*(){const r=Array.isArray(t.values[0])?t.values:[t.values],i=r[0].length,s=t.series?t.series:r.map((g,m)=>`Series ${m+1}`);USe.assert(s.length===r.length,"Must have an equal number of series labels as there are data series"),n.seriesColors!=null&&USe.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const a=[];for(let g=0;g<i;g++){const m={x:g};s.forEach((v,y)=>{const b=r[y][g].y;m[v]=b,m[`${v}-name`]=v}),a.push(m)}const o=Object.assign({},BVn,n),l=()=>{if(o.zoomToFit)return{zero:!1};if(o.yAxisDomain!=null)return{domain:o.yAxisDomain}},u={x:{field:"x",type:o.xType,title:o.xLabel},tooltip:[{field:"x",type:"quantitative"},...s.map(g=>({field:g,type:"quantitative"}))]},c=s.map(g=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:g,type:o.yType,title:o.yLabel,scale:l()},color:{field:`${g}-name`,type:"nominal",legend:{values:s,title:null},scale:{range:o.seriesColors}}}})),f={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},h=PVn.getDrawArea(e),d={width:o.width||zSe.getDefaultWidth(h),height:o.height||zSe.getDefaultHeight(h),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize}},data:{values:a},encoding:u,layer:[...c,f]},p={actions:!1,mode:"vega-lite",defaultStyle:!1};return yield RVn.default(h,d,p),Promise.resolve()})}EV.linechart=LVn;const BVn={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var tde={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var zVn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})},UVn=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tde,"__esModule",{value:!0});const WVn=UVn(MS),WSe=Ju,VVn=_g,jVn=Do;function HVn(e,t,n={}){return zVn(this,void 0,void 0,function*(){let r=t.values;const i=t.series==null?[]:t.series;r=Array.isArray(r[0])?r:[r];const s=[];r.forEach((h,d)=>{const p=i[d]!=null?i[d]:`Series ${d+1}`,g=h.map(m=>Object.assign({},m,{series:p}));s.push(...g)}),n.seriesColors!=null&&VVn.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const a=jVn.getDrawArea(e),o=Object.assign({},qVn,n),l={actions:!1,mode:"vega-lite",defaultStyle:!1},u=()=>{if(o.zoomToFit)return{zero:!1};if(o.xAxisDomain!=null)return{domain:o.xAxisDomain}},c=()=>{if(o.zoomToFit)return{zero:!1};if(o.yAxisDomain!=null)return{domain:o.yAxisDomain}},f={width:o.width||WSe.getDefaultWidth(a),height:o.height||WSe.getDefaultHeight(a),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize}},data:{values:s},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:o.xType,title:o.xLabel,scale:u()},y:{field:"y",type:o.yType,title:o.yLabel,scale:c()},color:{field:"series",type:"nominal",scale:{range:o.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield WVn.default(a,f,l),Promise.resolve()})}tde.scatterplot=HVn;const qVn={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var AV={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var VKe=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(AV,"__esModule",{value:!0});const GVn=EV,hee=Do,jKe=Ju;function HKe(e,t,n,r={}){return VKe(this,void 0,void 0,function*(){const i=hee.getDrawArea(e),s={};for(const u of n)if(/val_/.test(u)){const c=u.replace("val_","");VSe(s,c);const f=jSe(t,u,n.indexOf(u));s[c].series.push(u),s[c].values.push(f)}else{const c=jSe(t,u,n.indexOf(u));VSe(s,u),s[u].series.push(u),s[u].values.push(c)}const a=Object.keys(s),o=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},r),l=[];for(const u of a){const c=jKe.subSurface(i,u),f=s[u].series,h=s[u].values;f.every(p=>Boolean(p.match("acc")))&&(o.zoomToFitAccuracy?o.zoomToFit=!0:(o.yAxisDomain=[0,1],delete o.zoomToFit));const d=GVn.linechart(c,{values:h,series:f},o);l.push(d)}yield Promise.all(l)})}AV.history=HKe;function VSe(e,t){e[t]==null&&(e[t]={series:[],values:[]})}function jSe(e,t,n){if(Array.isArray(e)){const r=Array.isArray(e[0])?e[n]:e,i=[];for(let s=0;s<r.length;s++){const a=r[s];i.push({x:s,y:a[t]})}return i}else return e.history[t].map((r,i)=>({x:i,y:r}))}function YVn(e,t,n={}){const r={},i=n.callbacks||["onEpochEnd","onBatchEnd"],s=hee.getDrawArea(e),a=Object.assign({},n);delete a.callbacks;function o(u){return(c,f)=>VKe(this,void 0,void 0,function*(){/batch/i.test(u)?a.xLabel="Batch":/epoch/i.test(u)&&(a.xLabel="Epoch");const h=[],d=[];for(const g of t)if(f[g]!=null){d.push(g);const m=XVn(r,u,g);m.push({[g]:f[g]}),h.push(m)}const p=jKe.subSurface(s,u,{title:u});HKe(p,h,d,a),yield hee.nextFrame()})}const l={};return i.forEach(u=>{l[u]=o(u)}),l}AV.fitCallbacks=YVn;function XVn(e,t,n){return e[t]==null&&(e[t]={}),e[t][n]==null&&(e[t][n]=[]),e[t][n]}var TV={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Z8=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(TV,"__esModule",{value:!0});const KVn=RF,qKe=Do,GKe=RS,YG=Ju,ZVn=Ed;function QVn(e,t){return Z8(this,void 0,void 0,function*(){const n=qKe.getDrawArea(e),r=ejn(t),i=["Layer Name","Output Shape","# Of Params","Trainable"],s=r.layers.map(a=>[a.name,a.outputShape,a.parameters,a.trainable]);GKe.table(n,{headers:i,values:s})})}TV.modelSummary=QVn;function JVn(e,t){return Z8(this,void 0,void 0,function*(){const n=qKe.getDrawArea(e),r=yield njn(t),i=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],s=YG.subSurface(n,"layer-weights-info"),a=r.map(c=>[c.name,c.shape,c.stats.min,c.stats.max,c.weight.size,c.stats.numZeros,c.stats.numNans,c.stats.numInfs]);GKe.table(s,{headers:i,values:a});const o=YG.subSurface(n,"select-layer"),l=YG.subSurface(n,"param-distribution"),u=c=>Z8(this,void 0,void 0,function*(){const h=yield r.filter(d=>d.name===c)[0].weight.data();KVn.histogram(l,h,{height:150,width:460,stats:!1})});rjn(r.map(c=>c.name),o,u)})}TV.layer=JVn;function ejn(e){return{layers:e.layers.map(tjn)}}function tjn(e){let t;return Array.isArray(e.outputShape[0])?t=`[${e.outputShape.map(r=>dee(r)).join(", ")}]`:t=dee(e.outputShape),{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function njn(e){return Z8(this,void 0,void 0,function*(){const t=e.getWeights(),n=e.weights,r=t.map(ZVn.tensorStats),i=yield Promise.all(r),s=t.map(a=>a.shape);return t.map((a,o)=>({name:n[o].name,stats:i[o],shape:dee(s[o]),weight:a}))})}function dee(e){const t=e.slice();return t.length===0?"Scalar":(t[0]===null&&(t[0]="batch"),`[${t.join(",")}]`)}function rjn(e,t,n){const s=`<div><button>Show Values Distribution for:</button>${`
    <select>
      ${e.map(l=>`<option value=${l}>${l}</option>`)}
    </select>
  `}</div>`;t.innerHTML=s;const a=t.querySelector("button"),o=t.querySelector("select");a.addEventListener("click",()=>{n(o.selectedOptions[0].label)})}var nde={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ijn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(nde,"__esModule",{value:!0});const sjn=Do,ajn=RS;function ojn(e,t,n){return ijn(this,void 0,void 0,function*(){const r=sjn.getDrawArea(e),i=["Class","Accuracy","# Samples"],s=[];for(let a=0;a<t.length;a++){const o=n?n[a]:a.toString(),l=t[a];s.push([o,l.accuracy,l.count])}return ajn.table(r,{headers:i,values:s})})}nde.perClassAccuracy=ojn;var rde={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ljn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(rde,"__esModule",{value:!0});const ujn=RF,cjn=Do,fjn=Ed;function hjn(e,t){return ljn(this,void 0,void 0,function*(){const n=cjn.getDrawArea(e),r=yield fjn.tensorStats(t),i=yield t.data();ujn.histogram(n,i,{height:150,stats:r})})}rde.valuesDistribution=hjn;var ide={};/** @license See the LICENSE file. */Object.defineProperty(ide,"__esModule",{value:!0});const djn="1.5.1";ide.version=djn;(function(e){function t(b){for(var x in b)e.hasOwnProperty(x)||(e[x]=b[x])}Object.defineProperty(e,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n=gre,r=qhe,i=Ghe,s=RF,a=EV,o=tde,l=RS,u=AV,c=TV,f=nde,h=rde,d=Ed,p=ide;e.version_vis=p.version;const g={barchart:n.barchart,table:l.table,histogram:s.histogram,linechart:a.linechart,scatterplot:o.scatterplot,confusionMatrix:r.confusionMatrix,heatmap:i.heatmap};e.render=g;const m={accuracy:d.accuracy,perClassAccuracy:d.perClassAccuracy,confusionMatrix:d.confusionMatrix};e.metrics=m;const v={history:u.history,fitCallbacks:u.fitCallbacks,perClassAccuracy:f.perClassAccuracy,valuesDistribution:h.valuesDistribution,layer:c.layer,modelSummary:c.modelSummary};e.show=v;var y=OF;e.visor=y.visor,t(FF)})(pre);var pjn=Object.defineProperty,gjn=Object.getOwnPropertyDescriptor,sde=(e,t,n,r)=>{for(var i=r>1?void 0:r?gjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&pjn(t,n,i),i};let ZD=class extends _t{buildPlots(){if(this.dataSet&&this.inputKey){const e=document.createElement("div");e.setAttribute("id","plots");const t=this.dataSet.label,n=this.dataSet.inputs.findIndex(a=>a.key==this.inputKey),r=this.dataSet.data.map(a=>({x:a.inputs[n],y:a.label})),i=["Data set"],s=e.appendChild(document.createElement("div"));return pre.render.scatterplot({drawArea:s},{values:r,series:i},{xLabel:this.inputKey,yLabel:t.key,width:350,height:240}),he`${e}`}else return he`Click on an input pill above to see the relation between this
      input and the output in a plot`}render(){return he`
      <c-card>
        <div slot="title">Plots</div>
        <div slot="content">${this.buildPlots()}</div>
      </c-card>
    `}};ZD.styles=[St,Xt`
      #plots {
        display: flex;
        flex-direction: row;
        gap: 10px;
        overflow-x: auto;
      }
    `];sde([Q()],ZD.prototype,"dataSet",2);sde([Q()],ZD.prototype,"inputKey",2);ZD=sde([ze("plots-card")],ZD);var mjn=Object.defineProperty,vjn=Object.getOwnPropertyDescriptor,ade=(e,t,n,r)=>{for(var i=r>1?void 0:r?vjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&mjn(t,n,i),i};let QD=class extends _t{async _handleChangeDataSet(){const e=await q2.getDataSetByName(decodeURI(this._dataSetSelect.value)),t=new CustomEvent("change-data-set",{detail:e,bubbles:!0,composed:!0});this.dispatchEvent(t)}render(){return he`
      <c-card>
        <div slot="title">Select data set</div>
        <div slot="content">
          <sl-select
            .value="${this.dataSet?encodeURI(this.dataSet.name):ri}"
            id="dataSetSelect"
            placeholder="Select a data set"
            @sl-change="${e=>{this._handleChangeDataSet()}}"
          >
            ${q2.getOptions().map(e=>he`<sl-option .value="${encodeURI(e)}"
                  >${e}</sl-option
                >`)}
          </sl-select>
          <sl-button disabled>Create your own data set</sl-button>
        </div>
      </c-card>
    `}};QD.styles=[St];ade([Q()],QD.prototype,"dataSet",2);ade([pt("#dataSetSelect")],QD.prototype,"_dataSetSelect",2);QD=ade([ze("data-set-select-card")],QD);var yjn=Object.defineProperty,bjn=Object.getOwnPropertyDescriptor,ode=(e,t,n,r)=>{for(var i=r>1?void 0:r?bjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&yjn(t,n,i),i};let JD=class extends _t{updated(e){e.has("dataSet")&&(this.selectedInputKey=null)}_handleClickedDataProperty(e){this.selectedInputKey=e.detail}render(){return he`
      <c-panel name="dataSet">
        <data-set-select-card .dataSet="${this.dataSet}"></data-set-select-card>
        ${this.dataSet?he`
              <data-set-info-card
                .dataSet="${this.dataSet}"
                @clicked-data-property="${e=>{this._handleClickedDataProperty(e)}}"
              ></data-set-info-card>
            `:""}
        <plots-card
          .dataSet="${this.dataSet}"
          .inputKey="${this.selectedInputKey}"
        ></plots-card>
      </c-panel>
    `}};JD.styles=[St];ode([Q({attribute:!0,reflect:!0})],JD.prototype,"selectedInputKey",2);ode([tn({context:Bm,subscribe:!0}),Q({attribute:!1})],JD.prototype,"dataSet",2);JD=ode([ze("data-set-panel")],JD);var xjn=Object.defineProperty,wjn=Object.getOwnPropertyDescriptor,YKe=(e,t,n,r)=>{for(var i=r>1?void 0:r?wjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&xjn(t,n,i),i};let Q8=class extends _t{_handleReset(){this.model.reset()}_handleTrain(){this.model.train()}_handleStopTraining(){this.dispatchEvent(new Event("stop-training",{bubbles:!0,composed:!0}))}render(){return he`
      <c-card>
        <div slot="title">Train</div>
        <div slot="content">
          <div>
            ${this.model.isTraining?he`
                  <sl-progress-bar indeterminate></sl-progress-bar>
                  <sl-tooltip content="Stop training">
                    <sl-button
                      size="large"
                      circle
                      @click="${e=>this._handleStopTraining()}"
                    >
                      <sl-icon name="stop" label="Stop"></sl-icon>
                    </sl-button>
                  </sl-tooltip>
                `:he`
                  <sl-tooltip content="Reset model">
                    <sl-button
                      size="large"
                      circle
                      @click="${e=>this._handleReset()}"
                    >
                      <sl-icon
                        name="arrow-counterclockwise"
                        label="Reset"
                      ></sl-icon>
                    </sl-button>
                  </sl-tooltip>
                  <sl-tooltip
                    content="${this.model.model?"Continue training":"Start training"}"
                  >
                    <sl-button
                      variant="primary"
                      size="large"
                      circle
                      @click="${e=>this._handleTrain()}"
                    >
                      <sl-icon name="play" label="Run"></sl-icon>
                    </sl-button>
                  </sl-tooltip>
                  <sl-tooltip content="Train a single batch">
                    <sl-button size="large" circle>
                      <sl-icon name="fast-forward" label="Next"></sl-icon>
                    </sl-button>
                  </sl-tooltip>
                  <sl-tooltip content="Train a single epoch">
                    <sl-button size="large" circle>
                      <sl-icon name="fast-forward" label="Next"></sl-icon>
                    </sl-button>
                  </sl-tooltip>
                `}
          </div>
        </div>
      </c-card>
    `}};Q8.styles=[St];YKe([tn({context:EC,subscribe:!0})],Q8.prototype,"model",2);Q8=YKe([ze("training-train-card")],Q8);var $jn=Object.defineProperty,Cjn=Object.getOwnPropertyDescriptor,lde=(e,t,n,r)=>{for(var i=r>1?void 0:r?Cjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&$jn(t,n,i),i};let eN=class extends _t{firstUpdated(){console.log("connected training metrics card"),console.log(this._trainMetricsContainer);const e=new CustomEvent("set-train-metrics-container",{detail:this._trainMetricsContainer,bubbles:!0,composed:!0});this.dispatchEvent(e)}render(){return he`
      <c-card>
        <div slot="title">Metrics</div>
        <div slot="content">
          <div id="trainMetricsContainer"></div>
        </div>
      </c-card>
    `}};eN.styles=[St];lde([tn({context:EC,subscribe:!0})],eN.prototype,"model",2);lde([pt("#trainMetricsContainer")],eN.prototype,"_trainMetricsContainer",2);eN=lde([ze("training-metrics-card")],eN);var _jn=Object.defineProperty,Sjn=Object.getOwnPropertyDescriptor,PF=(e,t,n,r)=>{for(var i=r>1?void 0:r?Sjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&_jn(t,n,i),i};let Ib=class extends _t{_handleChangeLearningRate(){this.trainOptions.setOption("learningRate",this._learningRateRange.value.toString())}_handleChangeDropoutRate(){this.trainOptions.setOption("dropoutRate",this._dropoutRateRange.value.toString())}render(){return he`
      <c-card>
        <div slot="title">Hyperparameters</div>
        <div slot="content">
          ${this.model.model?he`<span
                >The changes you make below will not take effect until you reset
                the model or start a new training from the beginning!</span
              >`:he``}
          <sl-range
            id="learningRateRange"
            label="learning rate: ${this.trainOptions.learningRate}"
            help-text="Adjust the speed at which the network learns"
            min="0"
            max="1"
            step="0.01"
            value="${this.trainOptions.learningRate}"
            @sl-change="${e=>this._handleChangeLearningRate()}"
          >
          </sl-range>
          <sl-range
            id="dropoutRateRange"
            label="dropout rate: ${this.trainOptions.dropoutRate}"
            help-text="Adjust the probability of neurons being deactivated during training"
            min="0"
            max="1"
            step="0.01"
            value="${this.trainOptions.dropoutRate}"
            @sl-change="${e=>this._handleChangeDropoutRate()}"
          >
          </sl-range>
        </div>
      </c-card>
    `}};Ib.styles=[St];PF([tn({context:sAe,subscribe:!0})],Ib.prototype,"trainOptions",2);PF([tn({context:EC,subscribe:!0})],Ib.prototype,"model",2);PF([pt("#learningRateRange")],Ib.prototype,"_learningRateRange",2);PF([pt("#dropoutRateRange")],Ib.prototype,"_dropoutRateRange",2);Ib=PF([ze("training-hyperparameters-card")],Ib);var kjn=Object.defineProperty,Ejn=Object.getOwnPropertyDescriptor,XKe=(e,t,n,r)=>{for(var i=r>1?void 0:r?Ejn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&kjn(t,n,i),i};let J8=class extends _t{render(){return he`
      <c-panel name="train">
        <training-train-card></training-train-card>
        <training-metrics-card
          class="${this.model.model?"":"hidden"}"
        ></training-metrics-card>
        <training-hyperparameters-card></training-hyperparameters-card>
      </c-panel>
    `}};J8.styles=[St];XKe([tn({context:EC,subscribe:!0})],J8.prototype,"model",2);J8=XKe([ze("train-panel")],J8);function KKe(e){const t=new FormData(e),n={};return t.forEach((r,i)=>{if(Reflect.has(n,i)){const s=n[i];Array.isArray(s)?s.push(r):n[i]=[n[i],r]}else n[i]=r}),n}var Ajn=Object.defineProperty,Tjn=Object.getOwnPropertyDescriptor,DV=(e,t,n,r)=>{for(var i=r>1?void 0:r?Tjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Ajn(t,n,i),i};let oC=class extends _t{async connectedCallback(){super.connectedCallback(),await this.updateComplete,this._predictForm.addEventListener("submit",e=>this._handlePredict(e))}_handlePredict(e){e.preventDefault();const t=KKe(this._predictForm);console.log(t),this._predictForm.reset()}getInputFieldsForLayer(e){return console.log("input fields"),console.log(this.dataSet.getAssignedInputsFor(e)),this.dataSet.getAssignedInputsFor(e).map(n=>he`
        <sl-tooltip content=${n.description}>
          <sl-input
            name="${n.key}"
            placeholder="${n.key}"
            type="number"
            required
          ></sl-input>
        </sl-tooltip>
      `)}getInputFields(){return this.networkConf.network.getInputLayers().map(t=>he`
        ${t.getName()} ${this.getInputFieldsForLayer(t)}
      `)}render(){return console.log("rerendering predict card"),he`
      <c-card>
        <div slot="title">Predict</div>
        <form slot="content" id="predictForm">
          ${this.getInputFields()}
          <sl-button variant="primary" type="submit">
            Predict
            <sl-icon slot="suffix" name="send"></sl-icon>
          </sl-button>
        </form>
      </c-card>
    `}};oC.styles=[St];DV([tn({context:Jp,subscribe:!0})],oC.prototype,"networkConf",2);DV([tn({context:Bm,subscribe:!0})],oC.prototype,"dataSet",2);DV([pt("#predictForm")],oC.prototype,"_predictForm",2);oC=DV([ze("predict-card")],oC);var Djn=Object.defineProperty,Njn=Object.getOwnPropertyDescriptor,Ijn=(e,t,n,r)=>{for(var i=r>1?void 0:r?Njn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Djn(t,n,i),i};let pee=class extends _t{render(){return he`
      <c-panel name="predict">
        <predict-card></predict-card>
      </c-panel>
    `}};pee.styles=[St];pee=Ijn([ze("predict-panel")],pee);var Mjn=Object.defineProperty,Fjn=Object.getOwnPropertyDescriptor,ZKe=(e,t,n,r)=>{for(var i=r>1?void 0:r?Fjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Mjn(t,n,i),i};let eB=class extends _t{render(){return he`
      <c-card>
        <div slot="title">Info</div>
        <div slot="content">
          <span>
            Selected:
            <c-network-link .target="${this.layer}">
              ${this.layer.getName()}
            </c-network-link>
          </span>
          <span> ${this.layer.getDescription()} </span>
        </div>
      </c-card>
    `}};eB.styles=[St];ZKe([Q()],eB.prototype,"layer",2);eB=ZKe([ze("layer-info-card")],eB);var Ojn=Object.defineProperty,Rjn=Object.getOwnPropertyDescriptor,PS=(e,t,n,r)=>{for(var i=r>1?void 0:r?Rjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Ojn(t,n,i),i};let Om=class extends _t{async connectedCallback(){super.connectedCallback(),await this.updateComplete,this._updateNeuronsForm&&this._updateNeuronsForm.addEventListener("submit",e=>{this._handleSetNeurons(e)})}_handleRemoveNeuron(){this.layer instanceof Bc&&this.layer.removeNeuron()}_handleAddNeuron(){this.layer instanceof Bc&&this.layer.addNeuron()}_handleSetNeurons(e){e.preventDefault();const t=KKe(this._updateNeuronsForm);if(typeof t.units!="string")throw new Error("The number of neurons in the form should be of type string.");const n=parseInt(t.units);this.layer instanceof Pl&&this.layer.setNeurons(n),this._updateNeuronsForm.reset()}_handleDuplicateLayer(){this.layer.duplicate()}_handleDeleteLayer(){this.networkConf.network.removeLayer(this.layer),Ms({message:`'${this.layer.getName()}' has been deleted!`,variant:"danger",icon:"trash"})}render(){return he`
      <c-card>
        <div slot="title">Edit layer</div>
        <div slot="content">
          ${this.layer instanceof Vs||this.layer instanceof $a?he``:he`<div>
                  <h2>Neurons</h2>
                  <c-button-group>
                    <sl-button
                      .disabled=${this.layer instanceof Bc&&this.layer.neurons.length<=1}
                      @click="${e=>this._handleRemoveNeuron()}"
                    >
                      <sl-icon slot="prefix" name="dash-square"></sl-icon>
                      Remove
                    </sl-button>
                    <sl-button
                      @click="${e=>this._handleAddNeuron()}"
                    >
                      <sl-icon slot="prefix" name="plus-square"></sl-icon>
                      Add
                    </sl-button>
                  </c-button-group>
                </div>
                <form id="updateNeuronsForm">
                  <c-button-group>
                    <sl-input
                      name="units"
                      placeholder="neurons"
                      type="number"
                      required
                    ></sl-input>
                    <sl-button type="submit">
                      <sl-icon slot="prefix" name="arrow-clockwise"></sl-icon>
                      Update
                    </sl-button>
                  </c-button-group>
                </form>`}
          <h2>Layer</h2>
          <c-button-group>
            ${this.layer instanceof Vs||this.layer instanceof $a?he``:he` <sl-button
                  @click="${e=>this._handleDuplicateLayer()}"
                >
                  <sl-icon slot="prefix" name="files"></sl-icon>
                  Duplicate
                </sl-button>`}
            <sl-button
              @click="${e=>this._handleDeleteLayer()}"
            >
              <sl-icon slot="prefix" name="trash"></sl-icon>
              Delete
            </sl-button>
          </c-button-group>
        </div>
      </c-card>
    `}};Om.styles=[St];PS([Q()],Om.prototype,"layer",2);PS([tn({context:Jp,subscribe:!0})],Om.prototype,"networkConf",2);PS([pt("#inputSelect")],Om.prototype,"_inputSelect",2);PS([pt("#outputSelect")],Om.prototype,"_outputSelect",2);PS([pt("#updateNeuronsForm")],Om.prototype,"_updateNeuronsForm",2);Om=PS([ze("layer-edit-card")],Om);var Pjn=Object.defineProperty,Ljn=Object.getOwnPropertyDescriptor,ude=(e,t,n,r)=>{for(var i=r>1?void 0:r?Ljn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Pjn(t,n,i),i};let tN=class extends _t{_handleChangeActivation(){this.layer.setActivation(this._selectActivationFormElm.value)}render(){return he`
      <c-card>
        <div slot="title">Activation function</div>
        <div slot="content">
          <sl-select
            .value="${this.layer.activation}"
            help-text="The selected activation will be applied to all neurons in this layer."
            @sl-change="${e=>{this._handleChangeActivation()}}"
          >
            ${qRt.map(e=>he`<sl-option .value="${e}">${e}</sl-option>`)}
          </sl-select>
        </div>
      </c-card>
    `}};tN.styles=[St];ude([Q()],tN.prototype,"layer",2);ude([pt("sl-select")],tN.prototype,"_selectActivationFormElm",2);tN=ude([ze("layer-activation-card")],tN);var Bjn=Object.defineProperty,zjn=Object.getOwnPropertyDescriptor,NV=(e,t,n,r)=>{for(var i=r>1?void 0:r?zjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Bjn(t,n,i),i};let lC=class extends _t{_handleChangeConnections(){const e=Array.from(this.networkConf.layerConnections.keys()).filter(([i,s])=>s==this.layer.layerId).map(([i,s])=>i),t=this._connectionSelect.value.map(i=>parseInt(i)),n=t.filter(i=>!e.includes(i));for(const i of n){const s=this.networkConf.layers.get(i);this.networkConf.network.addLayerConnection(s,this.layer)}const r=e.filter(i=>!t.includes(i));for(const i of r){const s=this.networkConf.layers.get(i);this.networkConf.network.removeLayerConnection(s,this.layer)}}_getConnectionOptions(){return Array.from(this.networkConf.layers.values()).filter(t=>t!=this.layer&&!(t instanceof $a)).map(t=>he`<sl-option value="${t.layerId.toString()}"
          >${t.getName()}</sl-option
        >`)}render(){return he`
      <c-card>
        <div slot="title">Incoming connections</div>
        <div slot="content">
          <sl-select
            id="connectionSelect"
            value=${Array.from(this.networkConf.layerConnections.keys()).filter(([e,t])=>{t==this.layer.layerId}).map(([e,t])=>e).join(" ")}
            multiple
            clearable
            help-text="Select the layers that connect to this layer"
            @sl-change="${e=>this._handleChangeConnections()}"
          >
            ${this._getConnectionOptions()}
          </sl-select>
        </div>
      </c-card>
    `}};lC.styles=[St];NV([Q()],lC.prototype,"layer",2);NV([tn({context:Jp,subscribe:!0})],lC.prototype,"networkConf",2);NV([pt("#connectionSelect")],lC.prototype,"_connectionSelect",2);lC=NV([ze("layer-incoming-connections-card")],lC);var Ujn=Object.defineProperty,Wjn=Object.getOwnPropertyDescriptor,IV=(e,t,n,r)=>{for(var i=r>1?void 0:r?Wjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Ujn(t,n,i),i};let uC=class extends _t{_handleChangeInputData(){const e=this._inputDataSelect.value;this.layer.dataSetKeys=e}getInputOptions(){const e=this.layer.getAssignedInputs().map(n=>he`
        <sl-option value="${n}">
          <sl-tooltip content="${this.dataSet.getInputByKey(n).description}"
            >${n}</sl-tooltip
          >
        </sl-option>
      `);console.log(e);const t=this.dataSet.getNonAssignedInputKeys().map(n=>he`
        <sl-option .value="${n}">
          <sl-tooltip content="${this.dataSet.getInputByKey(n).description}"
            >${n}</sl-tooltip
          >
        </sl-option>
      `);return console.log(t),he`${e} ${t}`}render(){return he`
      <c-card>
        <div slot="title">Incoming data</div>
        <div slot="content">
          <sl-select
            id="inputDataSelect"
            value=${this.layer.getAssignedInputs().join(" ")}
            multiple
            max-options-visible="100"
            help-text="Assign input data to this layer"
            @sl-change="${e=>{this._handleChangeInputData()}}"
          >
            ${this.getInputOptions()}
          </sl-select>
        </div>
      </c-card>
    `}};uC.styles=[St];IV([Q()],uC.prototype,"layer",2);IV([Q()],uC.prototype,"dataSet",2);IV([pt("#inputDataSelect")],uC.prototype,"_inputDataSelect",2);uC=IV([ze("layer-incoming-data-card")],uC);var Vjn=Object.defineProperty,jjn=Object.getOwnPropertyDescriptor,MV=(e,t,n,r)=>{for(var i=r>1?void 0:r?jjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Vjn(t,n,i),i};let cC=class extends _t{_handleChangeConnections(){const e=Array.from(this.networkConf.layerConnections.keys()).filter(([i,s])=>i==this.layer.layerId).map(([i,s])=>s),t=this._connectionSelect.value.map(i=>parseInt(i)),n=t.filter(i=>!e.includes(i));for(const i of n){const s=this.networkConf.layers.get(i);this.networkConf.network.addLayerConnection(this.layer,s)}const r=e.filter(i=>!t.includes(i));for(const i of r){const s=this.networkConf.layers.get(i);this.networkConf.network.removeLayerConnection(this.layer,s)}}_getConnectionOptions(){return Array.from(this.networkConf.layers.values()).filter(t=>t!=this.layer&&!(t instanceof Vs)).map(t=>he`<sl-option value="${t.layerId.toString()}"
          >${t.getName()}</sl-option
        >`)}render(){return he`
      <c-card>
        <div slot="title">Outgoing connections</div>
        <div slot="content">
          <sl-select
            id="connectionSelect"
            value=${Array.from(this.networkConf.layerConnections.keys()).filter(([e,t])=>{e==this.layer.layerId}).map(([e,t])=>t).join(" ")}
            multiple
            clearable
            help-text="Select the layers that connect to this layer"
            @sl-change="${e=>this._handleChangeConnections()}"
          >
            ${this._getConnectionOptions()}
          </sl-select>
        </div>
      </c-card>
    `}};cC.styles=[St];MV([Q()],cC.prototype,"layer",2);MV([tn({context:Jp,subscribe:!0})],cC.prototype,"networkConf",2);MV([pt("#connectionSelect")],cC.prototype,"_connectionSelect",2);cC=MV([ze("layer-outgoing-connections-card")],cC);var Hjn=Object.defineProperty,qjn=Object.getOwnPropertyDescriptor,QKe=(e,t,n,r)=>{for(var i=r>1?void 0:r?qjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Hjn(t,n,i),i};let tB=class extends _t{render(){return he`
      <c-card>
        <div slot="title">Outgoing data</div>
        <div slot="content">
          ${this.layer.dataSetLabel.key?he`
                <c-data-info
                  .dataProperty="${this.layer.dataSetLabel}"
                ></c-data-info>
              `:he``}
        </div>
      </c-card>
    `}};tB.styles=[St];QKe([Q()],tB.prototype,"layer",2);tB=QKe([ze("layer-outgoing-data-card")],tB);var Gjn=Object.defineProperty,Yjn=Object.getOwnPropertyDescriptor,cde=(e,t,n,r)=>{for(var i=r>1?void 0:r?Yjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Gjn(t,n,i),i};let nN=class extends _t{getCards(){if(!this.selected.layer)return he``;const e=this.selected.layer;if(e instanceof Vs)return he`
        <layer-info-card .layer=${e}></layer-info-card>
        <layer-edit-card
          .layer=${e}
          .dataSet=${this.dataSet}
        ></layer-edit-card>
        <layer-incoming-data-card
          .layer=${e}
          .dataSet=${this.dataSet}
        ></layer-incoming-data-card>
        <layer-outgoing-connections-card
          .layer=${e}
        ></layer-outgoing-connections-card>
      `;if(e instanceof Pl)return he`
        <layer-info-card .layer=${e}></layer-info-card>
        <layer-edit-card .layer=${e}></layer-edit-card>
        <layer-incoming-connections-card
          .layer=${e}
        ></layer-incoming-connections-card>
        <layer-outgoing-connections-card
          .layer=${e}
        ></layer-outgoing-connections-card>
        <layer-activation-card .layer=${e}></layer-activation-card>
      `;if(e instanceof $a)return he`
        <layer-info-card .layer=${e}></layer-info-card>
        <layer-edit-card
          .layer=${e}
          .dataSet=${this.dataSet}
        ></layer-edit-card>
        <layer-incoming-connections-card
          .layer=${e}
        ></layer-incoming-connections-card>
        <layer-outgoing-data-card .layer=${e}></layer-outgoing-data-card>
        <layer-activation-card .layer=${e}></layer-activation-card>
      `}render(){return he` <c-panel name="layer"> ${this.getCards()} </c-panel> `}};nN.styles=[St];cde([tn({context:Bm,subscribe:!0})],nN.prototype,"dataSet",2);cde([tn({context:AC,subscribe:!0})],nN.prototype,"selected",2);nN=cde([ze("layer-panel")],nN);var Xjn=Object.defineProperty,Kjn=Object.getOwnPropertyDescriptor,FV=(e,t,n,r)=>{for(var i=r>1?void 0:r?Kjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Xjn(t,n,i),i};let fC=class extends _t{render(){let e;return this.neuron.layer instanceof Vs?e=this.dataSet.getByKey(this.neuron.label):this.neuron.layer instanceof $a&&(e=this.neuron.layer.dataSetLabel),he`
      <c-card>
        <div slot="title">Info</div>
        <div slot="content">
          <div>
            <p>
              Selected item:
              <c-network-link .target="${this.neuron}"
                >Neuron ${this.neuron.neuronId}</c-network-link
              >
              inside
              <c-network-link .target="${this.layer}"
                >${this.neuron.layer.getName()}</c-network-link
              >
            </p>
            ${e?he`
                  <h2>Assigned data</h2>
                  <c-data-info .dataProperty="${e}"></c-data-info>
                `:he``}
          </div>
        </div>
      </c-card>
    `}};fC.styles=[St];FV([Q()],fC.prototype,"neuron",2);FV([Q()],fC.prototype,"layer",2);FV([Q()],fC.prototype,"dataSet",2);fC=FV([ze("neuron-info-card")],fC);var Zjn=Object.defineProperty,Qjn=Object.getOwnPropertyDescriptor,fde=(e,t,n,r)=>{for(var i=r>1?void 0:r?Qjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Zjn(t,n,i),i};let rN=class extends _t{getCards(){if(!this.selected.neuron&&!this.selected.layer)return he``;const e=this.selected.neuron,t=this.selected.layer;return he`
      <neuron-info-card
        .neuron=${e}
        .layer=${t}
        .dataSet=${this.dataSet}
      ></neuron-info-card>
      ${t instanceof Vs&&e.label?he`
            <plots-card
              .dataSet=${this.dataSet}
              .inputKey=${e.label}
            ></plots-card>
          `:he``}
    `}render(){return he` <c-panel name="neuron"> ${this.getCards()} </c-panel> `}};rN.styles=[St];fde([tn({context:Bm,subscribe:!0})],rN.prototype,"dataSet",2);fde([tn({context:AC,subscribe:!0})],rN.prototype,"selected",2);rN=fde([ze("neuron-panel")],rN);var Jjn=Object.defineProperty,eHn=Object.getOwnPropertyDescriptor,LF=(e,t,n,r)=>{for(var i=r>1?void 0:r?eHn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Jjn(t,n,i),i};let Mb=class extends _t{render(){return he`
      <c-card>
        <div slot="title">Info</div>
        <div slot="content">
          <span>
            Selected: Edge connecting
            ${this.sourceNeuron!=null?he`
                  <c-network-link .target="${this.sourceNeuron}"
                    >Neuron ${this.sourceNeuron.neuronId}</c-network-link
                  >
                  inside
                `:he``}.id
            <c-network-link .target="${this.sourceLayer}"
              >${this.sourceLayer.getName()}</c-network-link
            >
            with
            ${this.targetNeuron!=null?he`
                  <c-network-link .target="${this.targetNeuron}"
                    >Neuron ${this.targetNeuron.neuronId}</c-network-link
                  >
                  inside
                `:he``}
            <c-network-link .target="${this.targetLayer}"
              >${this.targetLayer.getName()}</c-network-link
            >
          </span>
        </div>
      </c-card>
    `}};Mb.styles=[St];LF([Q()],Mb.prototype,"sourceLayer",2);LF([Q()],Mb.prototype,"targetLayer",2);LF([Q()],Mb.prototype,"sourceNeuron",2);LF([Q()],Mb.prototype,"targetNeuron",2);Mb=LF([ze("edge-info-card")],Mb);var tHn=Object.defineProperty,nHn=Object.getOwnPropertyDescriptor,JKe=(e,t,n,r)=>{for(var i=r>1?void 0:r?nHn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&tHn(t,n,i),i};let nB=class extends _t{getCards(){return this.selected.edge?he`
      <edge-info-card
        .sourceLayer=${this.selected.edge.sourceLayer}
        .targetLayer=${this.selected.edge.targetLayer}
        .sourceNeuron=${this.selected.edge.sourceNeuron}
        .targetNeuron=${this.selected.edge.targetNeuron}
      >
      </edge-info-card>
    `:he``}render(){return he` <c-panel name="edge"> ${this.getCards()} </c-panel> `}};nB.styles=[St];JKe([tn({context:AC,subscribe:!0})],nB.prototype,"selected",2);nB=JKe([ze("edge-panel")],nB);var rHn=Object.defineProperty,iHn=Object.getOwnPropertyDescriptor,OV=(e,t,n,r)=>{for(var i=r>1?void 0:r?iHn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&rHn(t,n,i),i};let hC=class extends _t{render(){return he`
      <div
        id="rightMenu"
        class="${this.panels.containsSome(...S1.right)?"":"collapsed"}"
      >
        <div id="rightMenuTabs">
          <c-tab group="right" name="settings" class="only-editable"
            >Settings</c-tab
          >
          <c-tab group="right" name="network">Network</c-tab>
          <c-tab group="right" name="dataSet">Data set</c-tab>
          <c-tab group="right" name="train">Train</c-tab>
          ${this.model.model?he` <c-tab group="right" name="predict">Predict</c-tab> `:he``}
          ${this.selected.layer?he` <c-tab group="right" name="layer" colored>Layer</c-tab> `:he``}
          ${this.selected.neuron?he` <c-tab group="right" name="neuron" colored>Neuron</c-tab> `:he``}
          ${this.selected.edge?he` <c-tab group="right" name="edge" colored>Edge</c-tab> `:he``}
        </div>
        <div
          id="rightMenuPanel"
          class="${this.panels.containsSome(...S1.right)?"":"collapsed"}"
        >
          <settings-panel></settings-panel>
          <network-panel></network-panel>
          <data-set-panel></data-set-panel>
          <train-panel></train-panel>
          ${this.model.model?he` <predict-panel></predict-panel> `:he``}
          ${this.selected.layer?he` <layer-panel></layer-panel> `:he``}
          ${this.selected.neuron?he` <neuron-panel></neuron-panel> `:he``}
          ${this.selected.edge?he` <edge-panel></edge-panel> `:he``}
        </div>
      </div>
    `}};hC.styles=[St,Xt`
      #rightMenu {
        width: 100%;
        height: 100%;
      }

      #rightMenu.collapsed {
        transform: translate(450px, 0);
      }

      #rightMenuTabs {
        position: absolute;
        top: 10px;
        right: 460px;
        width: 90px;
        display: grid;
        gap: 10px;
      }

      #rightMenuPanel {
        width: 100%;
        height: 100%;
        overflow: auto;
        padding: 10px;
      }

      #rightMenuPanel.collapsed {
        display: none;
      }
    `];OV([tn({context:EC,subscribe:!0})],hC.prototype,"model",2);OV([tn({context:AC,subscribe:!0})],hC.prototype,"selected",2);OV([tn({context:TB,subscribe:!0})],hC.prototype,"panels",2);hC=OV([ze("menu-area")],hC);var sHn=Object.defineProperty,aHn=Object.getOwnPropertyDescriptor,Sg=(e,t,n,r)=>{for(var i=r>1?void 0:r?aHn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&sHn(t,n,i),i};let uf=class extends _t{constructor(){super(...arguments),this.shortcutListener=new uut(this),this.trainOptions={learningRate:"0.01",dropoutRate:"0",epochs:"3",batchSize:"50",lossFunction:"meanSquaredError",optimizer:"sgd",setOption:(e,t)=>{this.trainOptions[e]=t,this.trainOptions=Object.create(this.trainOptions)}},this.model={model:null,reset:()=>{this.model.model&&(this.model.stopRequested=!0,this.model.model=null,this.model=Object.create(this.model),this.trainMetricsContainer.innerHTML="")},build:()=>{this.model.reset();const e=this.networkConf.network.buildModel();if(e){const t=Rg.sgd(parseFloat(this.trainOptions.learningRate));e.compile({loss:"meanSquaredError",optimizer:t,metrics:["mse","acc"]}),this.model.model=e,Ms({message:"The model was successfully compiled! All hyperparameter and network architecture changes were taken into account!",variant:"success",icon:"check-circle"}),this.model=Object.create(this.model)}},isTraining:!1,train:()=>{if(this.model.model||this.model.build(),this.model.model){this.model.stopRequested=!1,this.model.isTraining=!0,this.model=Object.create(this.model);const e=[];for(const n of this.networkConf.network.getInputLayers())e.push(...this.dataSet.getInputDataForLayer(n));const t=this.dataSet.getLabelData();this.model.model.fit(vp(e),vp(t),{epochs:10,batchSize:10,callbacks:[pre.show.fitCallbacks(this.trainMetricsContainer,["loss","acc"],{height:100}),{onBatchEnd:(n,r)=>{this.model.stopRequested&&(this.model.model.stopTraining=!0,this.model=Object.create(this.model))}}]}).then(n=>{console.log("Final MSE",n.history.mse),console.log(n)}).catch(n=>{console.error(n)}).finally(()=>{this.model.isTraining=!1,this.model=Object.create(this.model)})}},stopRequested:!1,predict:()=>{}},this.selected={select:({layer:e=null,neuron:t=null,edge:n=null}={})=>{const r={select:this.selected.select};t&&e?(r.neuron=t,r.layer=e,this.panels.open("neuron","right")):e?(r.layer=e,this.panels.open("layer","right")):n&&(r.edge=n,this.panels.open("edge","right")),this.selected=r}},this.panels={openPanels:[],open:(e,t)=>{t&&this.panels.close(...S1[t]),this.panels.openPanels.push(e),this.panels=Object.create(this.panels)},close:(...e)=>{this.panels.openPanels=this.panels.openPanels.filter(t=>!e.includes(t)),this.panels=Object.create(this.panels)},containsSome:(...e)=>this.panels.openPanels.some(t=>e.includes(t))}}async connectedCallback(){super.connectedCallback(),this.createNetworkConf();const e=await q2.getDataSetByName("Boston House Pricing");this.setDataSet(e)}createCanvas(e){this.canvas=new tut(this,e)}createNetworkConf(){this.networkConf={layers:new Map,addLayer:e=>{this.networkConf.layers.set(e.layerId,e),this.networkConf=Object.create(this.networkConf)},removeLayer:e=>{this.networkConf.layers.delete(e),this.networkConf=Object.create(this.networkConf)},layerConnections:new Map,addLayerConnection:e=>{this.networkConf.layerConnections.set([e.sourceLayer.layerId,e.targetLayer.layerId],e),this.networkConf=Object.create(this.networkConf)},removeLayerConnection:e=>{this.networkConf.layerConnections.delete(e),this.networkConf=Object.create(this.networkConf)},network:null}}createNetwork(e){console.log("created network"),this.networkConf.network=e,this.networkConf=Object.create(this.networkConf)}clearNetwork(){const e=this.networkConf.network;this.createNetworkConf(),this.networkConf.network=e,console.log("cleared network")}setDataSet(e){this.dataSet=e,this.model.reset(),this.networkConf.network&&this.networkConf.network.handleDataSetChange()}setTrainMetricsContainer(e){this.trainMetricsContainer=e,console.log("setting train metrics container to "),console.log(e),console.log(this.trainMetricsContainer)}stopTraining(){this.model.stopRequested=!0}render(){return he`
      <div id="app">
        ${this.dataSet?he`
            <canvas-area
              class="${this.panels.containsSome(...S1.right)?"":"right-collapsed"}"
              @canvas-created="${e=>this.createCanvas(e.detail)}"
            ></canvas-area>

            <div
              id="divider"
              class="${this.panels.containsSome(...S1.right)?"":"hidden"}"
            ></div>

            <menu-area
              class="${this.panels.containsSome(...S1.right)?"":"right-collapsed"}"
              @change-data-set="${e=>this.setDataSet(e.detail)}"
              @clear-network="${e=>this.clearNetwork()}"
              @set-train-metrics-container="${e=>this.setTrainMetricsContainer(e.detail)}"
              @stop-training="${e=>this.stopTraining()}"
            ></menu-area>
          </div>
        `:he`
              <div id="loadingDiv">
                <h1>Loading</h1>
                <sl-spinner style="font-size: 3rem;"></sl-spinner>
              </div>
            `}
        ${this.networkConf?he` <c-network
              @network-created="${e=>this.createNetwork(e.detail)}"
            ></c-network>`:he``}
      </div>
    `}};uf.styles=[St,Xt`
      #app {
        height: 100vh;
        display: flex;
        flex-direction: row;
        overflow: hidden;
        background-color: #f7f7f7;
      }

      #loadingDiv {
        position: absolute;
        left: 50%;
        top: 50%;
        -ms-transform: translate(-50%, -50%);
        transform: translate(-50%, -50%);
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      canvas-area {
        width: calc(100% - 450px);
        height: 100%;
      }

      canvas-area.right-collapsed {
        width: 100%;
      }

      menu-area {
        width: 450px;
      }

      menu-area.right-collapsed {
        width: 0;
      }

      #divider {
        position: absolute;
        right: 449px;
        width: 2px;
        top: 10px;
        bottom: 10px;
        background-color: #efefef;
      }
    `];Sg([Fb({context:Lm}),Q({attribute:!0,reflect:!0})],uf.prototype,"canvas",2);Sg([Fb({context:Jp}),Q({attribute:!0,reflect:!0})],uf.prototype,"networkConf",2);Sg([Fb({context:Bm}),Q({attribute:!0,reflect:!0})],uf.prototype,"dataSet",2);Sg([Fb({context:sAe}),Q({attribute:!0,reflect:!0})],uf.prototype,"trainOptions",2);Sg([Cr()],uf.prototype,"trainMetricsContainer",2);Sg([Fb({context:EC}),Q({attribute:!0,reflect:!0})],uf.prototype,"model",2);Sg([Fb({context:AC}),Q({attribute:!0,reflect:!0})],uf.prototype,"selected",2);Sg([Fb({context:TB}),Q({attribute:!0,reflect:!0,type:Object})],uf.prototype,"panels",2);uf=Sg([ze("ww-deeplearning")],uf)});export default oHn();
