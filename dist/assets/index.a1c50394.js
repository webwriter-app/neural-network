var eZe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Xjn=eZe((eHn,dhe)=>{function PSe(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var LSe=Object.defineProperty,tZe=Object.defineProperties,nZe=Object.getOwnPropertyDescriptor,rZe=Object.getOwnPropertyDescriptors,lde=Object.getOwnPropertySymbols,iZe=Object.prototype.hasOwnProperty,sZe=Object.prototype.propertyIsEnumerable,ude=(e,t,n)=>t in e?LSe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,BSe=(e,t)=>{for(var n in t||(t={}))iZe.call(t,n)&&ude(e,n,t[n]);if(lde)for(var n of lde(t))sZe.call(t,n)&&ude(e,n,t[n]);return e},aZe=(e,t)=>tZe(e,rZe(t)),H=(e,t,n,r)=>{for(var i=r>1?void 0:r?nZe(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&LSe(t,n,i),i};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ue=e=>t=>typeof t=="function"?((n,r)=>(customElements.define(n,r),r))(e,t):((n,r)=>{const{kind:i,elements:s}=r;return{kind:i,elements:s,finisher(a){customElements.define(n,a)}}})(e,t);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const oZe=(e,t)=>t.kind==="method"&&t.descriptor&&!("value"in t.descriptor)?{...t,finisher(n){n.createProperty(t.key,e)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:t.key,initializer(){typeof t.initializer=="function"&&(this[t.key]=t.initializer.call(this))},finisher(n){n.createProperty(t.key,e)}},lZe=(e,t,n)=>{t.constructor.createProperty(n,e)};function J(e){return(t,n)=>n!==void 0?lZe(e,t,n):oZe(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Ir(e){return J({...e,state:!0})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ZB=({finisher:e,descriptor:t})=>(n,r)=>{var i;if(r===void 0){const s=(i=n.originalKey)!==null&&i!==void 0?i:n.key,a=t!=null?{kind:"method",placement:"prototype",key:s,descriptor:t(n.key)}:{...n,key:s};return e!=null&&(a.finisher=function(o){e(o,s)}),a}{const s=n.constructor;t!==void 0&&Object.defineProperty(n,r,t(r)),e==null||e(s,r)}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function uZe(e){return ZB({finisher:(t,n)=>{Object.assign(t.prototype[n],e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function gt(e,t){return ZB({descriptor:n=>{const r={get(){var i,s;return(s=(i=this.renderRoot)===null||i===void 0?void 0:i.querySelector(e))!==null&&s!==void 0?s:null},enumerable:!0,configurable:!0};if(t){const i=typeof n=="symbol"?Symbol():"__"+n;r.get=function(){var s,a;return this[i]===void 0&&(this[i]=(a=(s=this.renderRoot)===null||s===void 0?void 0:s.querySelector(e))!==null&&a!==void 0?a:null),this[i]}}return r}})}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var MV;((MV=window.HTMLSlotElement)===null||MV===void 0?void 0:MV.prototype.assignedElements)!=null;let jG="";function HG(e){jG=e}function cZe(e=""){if(!jG){const t=[...document.getElementsByTagName("script")],n=t.find(r=>r.hasAttribute("data-shoelace"));if(n)HG(n.getAttribute("data-shoelace"));else{const r=t.find(s=>/shoelace(\.min)?\.js($|\?)/.test(s.src)||/shoelace-autoloader(\.min)?\.js($|\?)/.test(s.src));let i="";r&&(i=r.getAttribute("src")),HG(i.split("/").slice(0,-1).join("/"))}}return jG.replace(/\/$/,"")+(e?`/${e.replace(/^\//,"")}`:"")}const fZe={name:"default",resolver:e=>cZe(`assets/icons/${e}.svg`)};var hZe=fZe;const cde={caret:`
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="6 9 12 15 18 9"></polyline>
    </svg>
  `,check:`
    <svg part="checked-icon" class="checkbox__icon" viewBox="0 0 16 16">
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">
        <g stroke="currentColor" stroke-width="2">
          <g transform="translate(3.428571, 3.428571)">
            <path d="M0,5.71428571 L3.42857143,9.14285714"></path>
            <path d="M9.14285714,0 L3.42857143,9.14285714"></path>
          </g>
        </g>
      </g>
    </svg>
  `,"chevron-down":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
    </svg>
  `,"chevron-left":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
    </svg>
  `,"chevron-right":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
    </svg>
  `,eye:`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
      <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>
      <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>
    </svg>
  `,"eye-slash":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-slash" viewBox="0 0 16 16">
      <path d="M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7.028 7.028 0 0 0-2.79.588l.77.771A5.944 5.944 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.134 13.134 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755-.165.165-.337.328-.517.486l.708.709z"/>
      <path d="M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829l.822.822zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829z"/>
      <path d="M3.35 5.47c-.18.16-.353.322-.518.487A13.134 13.134 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7.029 7.029 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12-.708.708z"/>
    </svg>
  `,eyedropper:`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eyedropper" viewBox="0 0 16 16">
      <path d="M13.354.646a1.207 1.207 0 0 0-1.708 0L8.5 3.793l-.646-.647a.5.5 0 1 0-.708.708L8.293 5l-7.147 7.146A.5.5 0 0 0 1 12.5v1.793l-.854.853a.5.5 0 1 0 .708.707L1.707 15H3.5a.5.5 0 0 0 .354-.146L11 7.707l1.146 1.147a.5.5 0 0 0 .708-.708l-.647-.646 3.147-3.146a1.207 1.207 0 0 0 0-1.708l-2-2zM2 12.707l7-7L10.293 7l-7 7H2v-1.293z"></path>
    </svg>
  `,"grip-vertical":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-grip-vertical" viewBox="0 0 16 16">
      <path d="M7 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"></path>
    </svg>
  `,indeterminate:`
    <svg part="indeterminate-icon" class="checkbox__icon" viewBox="0 0 16 16">
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">
        <g stroke="currentColor" stroke-width="2">
          <g transform="translate(2.285714, 6.857143)">
            <path d="M10.2857143,1.14285714 L1.14285714,1.14285714"></path>
          </g>
        </g>
      </g>
    </svg>
  `,"person-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
      <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
    </svg>
  `,"play-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-play-fill" viewBox="0 0 16 16">
      <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"></path>
    </svg>
  `,"pause-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pause-fill" viewBox="0 0 16 16">
      <path d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z"></path>
    </svg>
  `,radio:`
    <svg part="checked-icon" class="radio__icon" viewBox="0 0 16 16">
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g fill="currentColor">
          <circle cx="8" cy="8" r="3.42857143"></circle>
        </g>
      </g>
    </svg>
  `,"star-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-star-fill" viewBox="0 0 16 16">
      <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
    </svg>
  `,"x-lg":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">
      <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
    </svg>
  `,"x-circle-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle-fill" viewBox="0 0 16 16">
      <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"></path>
    </svg>
  `},dZe={name:"system",resolver:e=>e in cde?`data:image/svg+xml,${encodeURIComponent(cde[e])}`:""};var pZe=dZe;let gZe=[hZe,pZe],qG=[];function mZe(e){qG.push(e)}function vZe(e){qG=qG.filter(t=>t!==e)}function fde(e){return gZe.find(t=>t.name===e)}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const jR=window,fee=jR.ShadowRoot&&(jR.ShadyCSS===void 0||jR.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,hee=Symbol(),hde=new WeakMap;class zSe{constructor(t,n,r){if(this._$cssResult$=!0,r!==hee)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=n}get styleSheet(){let t=this.o;const n=this.t;if(fee&&t===void 0){const r=n!==void 0&&n.length===1;r&&(t=hde.get(n)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),r&&hde.set(n,t))}return t}toString(){return this.cssText}}const yZe=e=>new zSe(typeof e=="string"?e:e+"",void 0,hee),Qt=(e,...t)=>{const n=e.length===1?e[0]:t.reduce((r,i,s)=>r+(a=>{if(a._$cssResult$===!0)return a.cssText;if(typeof a=="number")return a;throw Error("Value passed to 'css' function must be a 'css' function result: "+a+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+e[s+1],e[0]);return new zSe(n,e,hee)},USe=(e,t)=>{fee?e.adoptedStyleSheets=t.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet):t.forEach(n=>{const r=document.createElement("style"),i=jR.litNonce;i!==void 0&&r.setAttribute("nonce",i),r.textContent=n.cssText,e.appendChild(r)})},dde=fee?e=>e:e=>e instanceof CSSStyleSheet?(t=>{let n="";for(const r of t.cssRules)n+=r.cssText;return yZe(n)})(e):e;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var FV;const Q4=window,pde=Q4.trustedTypes,bZe=pde?pde.emptyScript:"",gde=Q4.reactiveElementPolyfillSupport,HA={toAttribute(e,t){switch(t){case Boolean:e=e?bZe:null;break;case Object:case Array:e=e==null?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=e!==null;break;case Number:n=e===null?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch{n=null}}return n}},WSe=(e,t)=>t!==e&&(t==t||e==e),OV={attribute:!0,type:String,converter:HA,reflect:!1,hasChanged:WSe},GG="finalized";class w2 extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var n;this.finalize(),((n=this.h)!==null&&n!==void 0?n:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach((n,r)=>{const i=this._$Ep(r,n);i!==void 0&&(this._$Ev.set(i,r),t.push(i))}),t}static createProperty(t,n=OV){if(n.state&&(n.attribute=!1),this.finalize(),this.elementProperties.set(t,n),!n.noAccessor&&!this.prototype.hasOwnProperty(t)){const r=typeof t=="symbol"?Symbol():"__"+t,i=this.getPropertyDescriptor(t,r,n);i!==void 0&&Object.defineProperty(this.prototype,t,i)}}static getPropertyDescriptor(t,n,r){return{get(){return this[n]},set(i){const s=this[t];this[n]=i,this.requestUpdate(t,s,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||OV}static finalize(){if(this.hasOwnProperty(GG))return!1;this[GG]=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),t.h!==void 0&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const n=this.properties,r=[...Object.getOwnPropertyNames(n),...Object.getOwnPropertySymbols(n)];for(const i of r)this.createProperty(i,n[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const n=[];if(Array.isArray(t)){const r=new Set(t.flat(1/0).reverse());for(const i of r)n.unshift(dde(i))}else t!==void 0&&n.push(dde(t));return n}static _$Ep(t,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof t=="string"?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise(n=>this.enableUpdating=n),this._$AL=new Map,this._$Eg(),this.requestUpdate(),(t=this.constructor.h)===null||t===void 0||t.forEach(n=>n(this))}addController(t){var n,r;((n=this._$ES)!==null&&n!==void 0?n:this._$ES=[]).push(t),this.renderRoot!==void 0&&this.isConnected&&((r=t.hostConnected)===null||r===void 0||r.call(t))}removeController(t){var n;(n=this._$ES)===null||n===void 0||n.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((t,n)=>{this.hasOwnProperty(n)&&(this._$Ei.set(n,this[n]),delete this[n])})}createRenderRoot(){var t;const n=(t=this.shadowRoot)!==null&&t!==void 0?t:this.attachShadow(this.constructor.shadowRootOptions);return USe(n,this.constructor.elementStyles),n}connectedCallback(){var t;this.renderRoot===void 0&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(t=this._$ES)===null||t===void 0||t.forEach(n=>{var r;return(r=n.hostConnected)===null||r===void 0?void 0:r.call(n)})}enableUpdating(t){}disconnectedCallback(){var t;(t=this._$ES)===null||t===void 0||t.forEach(n=>{var r;return(r=n.hostDisconnected)===null||r===void 0?void 0:r.call(n)})}attributeChangedCallback(t,n,r){this._$AK(t,r)}_$EO(t,n,r=OV){var i;const s=this.constructor._$Ep(t,r);if(s!==void 0&&r.reflect===!0){const a=(((i=r.converter)===null||i===void 0?void 0:i.toAttribute)!==void 0?r.converter:HA).toAttribute(n,r.type);this._$El=t,a==null?this.removeAttribute(s):this.setAttribute(s,a),this._$El=null}}_$AK(t,n){var r;const i=this.constructor,s=i._$Ev.get(t);if(s!==void 0&&this._$El!==s){const a=i.getPropertyOptions(s),o=typeof a.converter=="function"?{fromAttribute:a.converter}:((r=a.converter)===null||r===void 0?void 0:r.fromAttribute)!==void 0?a.converter:HA;this._$El=s,this[s]=o.fromAttribute(n,a.type),this._$El=null}}requestUpdate(t,n,r){let i=!0;t!==void 0&&(((r=r||this.constructor.getPropertyOptions(t)).hasChanged||WSe)(this[t],n)?(this._$AL.has(t)||this._$AL.set(t,n),r.reflect===!0&&this._$El!==t&&(this._$EC===void 0&&(this._$EC=new Map),this._$EC.set(t,r))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(n){Promise.reject(n)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((i,s)=>this[s]=i),this._$Ei=void 0);let n=!1;const r=this._$AL;try{n=this.shouldUpdate(r),n?(this.willUpdate(r),(t=this._$ES)===null||t===void 0||t.forEach(i=>{var s;return(s=i.hostUpdate)===null||s===void 0?void 0:s.call(i)}),this.update(r)):this._$Ek()}catch(i){throw n=!1,this._$Ek(),i}n&&this._$AE(r)}willUpdate(t){}_$AE(t){var n;(n=this._$ES)===null||n===void 0||n.forEach(r=>{var i;return(i=r.hostUpdated)===null||i===void 0?void 0:i.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){this._$EC!==void 0&&(this._$EC.forEach((n,r)=>this._$EO(r,this[r],n)),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}w2[GG]=!0,w2.elementProperties=new Map,w2.elementStyles=[],w2.shadowRootOptions={mode:"open"},gde==null||gde({ReactiveElement:w2}),((FV=Q4.reactiveElementVersions)!==null&&FV!==void 0?FV:Q4.reactiveElementVersions=[]).push("1.6.2");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var RV;const J4=window,xw=J4.trustedTypes,mde=xw?xw.createPolicy("lit-html",{createHTML:e=>e}):void 0,YG="$lit$",zg=`lit$${(Math.random()+"").slice(9)}$`,VSe="?"+zg,xZe=`<${VSe}>`,$y=document,qA=()=>$y.createComment(""),GA=e=>e===null||typeof e!="object"&&typeof e!="function",jSe=Array.isArray,wZe=e=>jSe(e)||typeof(e==null?void 0:e[Symbol.iterator])=="function",PV=`[ 	
\f\r]`,RS=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,vde=/-->/g,yde=/>/g,Cv=RegExp(`>|${PV}(?:([^\\s"'>=/]+)(${PV}*=${PV}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),bde=/'/g,xde=/"/g,HSe=/^(?:script|style|textarea|title)$/i,$Ze=e=>(t,...n)=>({_$litType$:e,strings:t,values:n}),de=$Ze(1),Ic=Symbol.for("lit-noChange"),ri=Symbol.for("lit-nothing"),wde=new WeakMap,C1=$y.createTreeWalker($y,129,null,!1);function qSe(e,t){if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return mde!==void 0?mde.createHTML(t):t}const CZe=(e,t)=>{const n=e.length-1,r=[];let i,s=t===2?"<svg>":"",a=RS;for(let o=0;o<n;o++){const l=e[o];let u,c,f=-1,h=0;for(;h<l.length&&(a.lastIndex=h,c=a.exec(l),c!==null);)h=a.lastIndex,a===RS?c[1]==="!--"?a=vde:c[1]!==void 0?a=yde:c[2]!==void 0?(HSe.test(c[2])&&(i=RegExp("</"+c[2],"g")),a=Cv):c[3]!==void 0&&(a=Cv):a===Cv?c[0]===">"?(a=i!=null?i:RS,f=-1):c[1]===void 0?f=-2:(f=a.lastIndex-c[2].length,u=c[1],a=c[3]===void 0?Cv:c[3]==='"'?xde:bde):a===xde||a===bde?a=Cv:a===vde||a===yde?a=RS:(a=Cv,i=void 0);const d=a===Cv&&e[o+1].startsWith("/>")?" ":"";s+=a===RS?l+xZe:f>=0?(r.push(u),l.slice(0,f)+YG+l.slice(f)+zg+d):l+zg+(f===-2?(r.push(void 0),o):d)}return[qSe(e,s+(e[n]||"<?>")+(t===2?"</svg>":"")),r]};class YA{constructor({strings:t,_$litType$:n},r){let i;this.parts=[];let s=0,a=0;const o=t.length-1,l=this.parts,[u,c]=CZe(t,n);if(this.el=YA.createElement(u,r),C1.currentNode=this.el.content,n===2){const f=this.el.content,h=f.firstChild;h.remove(),f.append(...h.childNodes)}for(;(i=C1.nextNode())!==null&&l.length<o;){if(i.nodeType===1){if(i.hasAttributes()){const f=[];for(const h of i.getAttributeNames())if(h.endsWith(YG)||h.startsWith(zg)){const d=c[a++];if(f.push(h),d!==void 0){const p=i.getAttribute(d.toLowerCase()+YG).split(zg),g=/([.?@])?(.*)/.exec(d);l.push({type:1,index:s,name:g[2],strings:p,ctor:g[1]==="."?SZe:g[1]==="?"?EZe:g[1]==="@"?AZe:QB})}else l.push({type:6,index:s})}for(const h of f)i.removeAttribute(h)}if(HSe.test(i.tagName)){const f=i.textContent.split(zg),h=f.length-1;if(h>0){i.textContent=xw?xw.emptyScript:"";for(let d=0;d<h;d++)i.append(f[d],qA()),C1.nextNode(),l.push({type:2,index:++s});i.append(f[h],qA())}}}else if(i.nodeType===8)if(i.data===VSe)l.push({type:2,index:s});else{let f=-1;for(;(f=i.data.indexOf(zg,f+1))!==-1;)l.push({type:7,index:s}),f+=zg.length-1}s++}}static createElement(t,n){const r=$y.createElement("template");return r.innerHTML=t,r}}function ww(e,t,n=e,r){var i,s,a,o;if(t===Ic)return t;let l=r!==void 0?(i=n._$Co)===null||i===void 0?void 0:i[r]:n._$Cl;const u=GA(t)?void 0:t._$litDirective$;return(l==null?void 0:l.constructor)!==u&&((s=l==null?void 0:l._$AO)===null||s===void 0||s.call(l,!1),u===void 0?l=void 0:(l=new u(e),l._$AT(e,n,r)),r!==void 0?((a=(o=n)._$Co)!==null&&a!==void 0?a:o._$Co=[])[r]=l:n._$Cl=l),l!==void 0&&(t=ww(e,l._$AS(e,t.values),l,r)),t}class _Ze{constructor(t,n){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var n;const{el:{content:r},parts:i}=this._$AD,s=((n=t==null?void 0:t.creationScope)!==null&&n!==void 0?n:$y).importNode(r,!0);C1.currentNode=s;let a=C1.nextNode(),o=0,l=0,u=i[0];for(;u!==void 0;){if(o===u.index){let c;u.type===2?c=new eI(a,a.nextSibling,this,t):u.type===1?c=new u.ctor(a,u.name,u.strings,this,t):u.type===6&&(c=new TZe(a,this,t)),this._$AV.push(c),u=i[++l]}o!==(u==null?void 0:u.index)&&(a=C1.nextNode(),o++)}return C1.currentNode=$y,s}v(t){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(t,r,n),n+=r.strings.length-2):r._$AI(t[n])),n++}}class eI{constructor(t,n,r,i){var s;this.type=2,this._$AH=ri,this._$AN=void 0,this._$AA=t,this._$AB=n,this._$AM=r,this.options=i,this._$Cp=(s=i==null?void 0:i.isConnected)===null||s===void 0||s}get _$AU(){var t,n;return(n=(t=this._$AM)===null||t===void 0?void 0:t._$AU)!==null&&n!==void 0?n:this._$Cp}get parentNode(){let t=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&(t==null?void 0:t.nodeType)===11&&(t=n.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,n=this){t=ww(this,t,n),GA(t)?t===ri||t==null||t===""?(this._$AH!==ri&&this._$AR(),this._$AH=ri):t!==this._$AH&&t!==Ic&&this._(t):t._$litType$!==void 0?this.g(t):t.nodeType!==void 0?this.$(t):wZe(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==ri&&GA(this._$AH)?this._$AA.nextSibling.data=t:this.$($y.createTextNode(t)),this._$AH=t}g(t){var n;const{values:r,_$litType$:i}=t,s=typeof i=="number"?this._$AC(t):(i.el===void 0&&(i.el=YA.createElement(qSe(i.h,i.h[0]),this.options)),i);if(((n=this._$AH)===null||n===void 0?void 0:n._$AD)===s)this._$AH.v(r);else{const a=new _Ze(s,this),o=a.u(this.options);a.v(r),this.$(o),this._$AH=a}}_$AC(t){let n=wde.get(t.strings);return n===void 0&&wde.set(t.strings,n=new YA(t)),n}T(t){jSe(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,i=0;for(const s of t)i===n.length?n.push(r=new eI(this.k(qA()),this.k(qA()),this,this.options)):r=n[i],r._$AI(s),i++;i<n.length&&(this._$AR(r&&r._$AB.nextSibling,i),n.length=i)}_$AR(t=this._$AA.nextSibling,n){var r;for((r=this._$AP)===null||r===void 0||r.call(this,!1,!0,n);t&&t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){var n;this._$AM===void 0&&(this._$Cp=t,(n=this._$AP)===null||n===void 0||n.call(this,t))}}class QB{constructor(t,n,r,i,s){this.type=1,this._$AH=ri,this._$AN=void 0,this.element=t,this.name=n,this._$AM=i,this.options=s,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=ri}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,n=this,r,i){const s=this.strings;let a=!1;if(s===void 0)t=ww(this,t,n,0),a=!GA(t)||t!==this._$AH&&t!==Ic,a&&(this._$AH=t);else{const o=t;let l,u;for(t=s[0],l=0;l<s.length-1;l++)u=ww(this,o[r+l],n,l),u===Ic&&(u=this._$AH[l]),a||(a=!GA(u)||u!==this._$AH[l]),u===ri?t=ri:t!==ri&&(t+=(u!=null?u:"")+s[l+1]),this._$AH[l]=u}a&&!i&&this.j(t)}j(t){t===ri?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t!=null?t:"")}}class SZe extends QB{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===ri?void 0:t}}const kZe=xw?xw.emptyScript:"";class EZe extends QB{constructor(){super(...arguments),this.type=4}j(t){t&&t!==ri?this.element.setAttribute(this.name,kZe):this.element.removeAttribute(this.name)}}class AZe extends QB{constructor(t,n,r,i,s){super(t,n,r,i,s),this.type=5}_$AI(t,n=this){var r;if((t=(r=ww(this,t,n,0))!==null&&r!==void 0?r:ri)===Ic)return;const i=this._$AH,s=t===ri&&i!==ri||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,a=t!==ri&&(i===ri||s);s&&this.element.removeEventListener(this.name,this,i),a&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var n,r;typeof this._$AH=="function"?this._$AH.call((r=(n=this.options)===null||n===void 0?void 0:n.host)!==null&&r!==void 0?r:this.element,t):this._$AH.handleEvent(t)}}class TZe{constructor(t,n,r){this.element=t,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(t){ww(this,t)}}const $de=J4.litHtmlPolyfillSupport;$de==null||$de(YA,eI),((RV=J4.litHtmlVersions)!==null&&RV!==void 0?RV:J4.litHtmlVersions=[]).push("2.7.5");const DZe=(e,t,n)=>{var r,i;const s=(r=n==null?void 0:n.renderBefore)!==null&&r!==void 0?r:t;let a=s._$litPart$;if(a===void 0){const o=(i=n==null?void 0:n.renderBefore)!==null&&i!==void 0?i:null;s._$litPart$=a=new eI(t.insertBefore(qA(),o),o,void 0,n!=null?n:{})}return a._$AI(e),a};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var LV,BV;class Y1 extends w2{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,n;const r=super.createRenderRoot();return(t=(n=this.renderOptions).renderBefore)!==null&&t!==void 0||(n.renderBefore=r.firstChild),r}update(t){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=DZe(n,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),(t=this._$Do)===null||t===void 0||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),(t=this._$Do)===null||t===void 0||t.setConnected(!1)}render(){return Ic}}Y1.finalized=!0,Y1._$litElement$=!0,(LV=globalThis.litElementHydrateSupport)===null||LV===void 0||LV.call(globalThis,{LitElement:Y1});const Cde=globalThis.litElementPolyfillSupport;Cde==null||Cde({LitElement:Y1});((BV=globalThis.litElementVersions)!==null&&BV!==void 0?BV:globalThis.litElementVersions=[]).push("3.3.2");/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const IZe=(e,t)=>t===void 0?(e==null?void 0:e._$litType$)!==void 0:(e==null?void 0:e._$litType$)===t,NZe=e=>e.strings===void 0,MZe={},FZe=(e,t=MZe)=>e._$AH=t;function Jt(e,t){const n=Object.assign({waitUntilFirstUpdate:!1},t);return(r,i)=>{const{update:s}=r,a=Array.isArray(e)?e:[e];r.update=function(o){a.forEach(l=>{const u=l;if(o.has(u)){const c=o.get(u),f=this[u];c!==f&&(!n.waitUntilFirstUpdate||this.hasUpdated)&&this[i](c,f)}}),s.call(this,o)}}}var GSe=globalThis&&globalThis.__decorate||function(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(s=(i<3?a(s):i>3?a(t,n,s):a(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};class nr extends Y1{emit(t,n){const r=new CustomEvent(t,Object.assign({bubbles:!0,cancelable:!1,composed:!0,detail:{}},n));return this.dispatchEvent(r),r}}GSe([J()],nr.prototype,"dir",void 0);GSe([J()],nr.prototype,"lang",void 0);const Nr=Qt`
  :host {
    box-sizing: border-box;
  }

  :host *,
  :host *::before,
  :host *::after {
    box-sizing: inherit;
  }

  [hidden] {
    display: none !important;
  }
`;var OZe=Qt`
  ${Nr}

  :host {
    display: inline-block;
    width: 1em;
    height: 1em;
    box-sizing: content-box !important;
  }

  svg {
    display: block;
    height: 100%;
    width: 100%;
  }
`;const PS=Symbol(),PF=Symbol();let zV;const UV=new Map;let $h=class extends nr{constructor(){super(...arguments),this.initialRender=!1,this.svg=null,this.label="",this.library="default"}async resolveIcon(e,t){var n;let r;if(t!=null&&t.spriteSheet)return de`<svg part="svg">
        <use part="use" href="${e}"></use>
      </svg>`;try{if(r=await fetch(e,{mode:"cors"}),!r.ok)return r.status===410?PS:PF}catch{return PF}try{const i=document.createElement("div");i.innerHTML=await r.text();const s=i.firstElementChild;if(((n=s==null?void 0:s.tagName)==null?void 0:n.toLowerCase())!=="svg")return PS;zV||(zV=new DOMParser);const o=zV.parseFromString(s.outerHTML,"text/html").body.querySelector("svg");return o?(o.part.add("svg"),document.adoptNode(o)):PS}catch{return PS}}connectedCallback(){super.connectedCallback(),mZe(this)}firstUpdated(){this.initialRender=!0,this.setIcon()}disconnectedCallback(){super.disconnectedCallback(),vZe(this)}getUrl(){const e=fde(this.library);return this.name&&e?e.resolver(this.name):this.src}handleLabelChange(){typeof this.label=="string"&&this.label.length>0?(this.setAttribute("role","img"),this.setAttribute("aria-label",this.label),this.removeAttribute("aria-hidden")):(this.removeAttribute("role"),this.removeAttribute("aria-label"),this.setAttribute("aria-hidden","true"))}async setIcon(){var e;const t=fde(this.library),n=this.getUrl();if(!n){this.svg=null;return}let r=UV.get(n);if(r||(r=this.resolveIcon(n,t),UV.set(n,r)),!this.initialRender)return;const i=await r;if(i===PF&&UV.delete(n),n===this.getUrl()){if(IZe(i)){this.svg=i;return}switch(i){case PF:case PS:this.svg=null,this.emit("sl-error");break;default:this.svg=i.cloneNode(!0),(e=t==null?void 0:t.mutator)==null||e.call(t,this.svg),this.emit("sl-load")}}}render(){return this.svg}};$h.styles=OZe;H([Ir()],$h.prototype,"svg",2);H([J({reflect:!0})],$h.prototype,"name",2);H([J()],$h.prototype,"src",2);H([J()],$h.prototype,"label",2);H([J({reflect:!0})],$h.prototype,"library",2);H([Jt("label")],$h.prototype,"handleLabelChange",1);H([Jt(["name","src","library"])],$h.prototype,"setIcon",1);$h=H([Ue("sl-icon")],$h);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Wv={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},YSe=e=>(...t)=>({_$litDirective$:e,values:t});class XSe{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,n,r){this._$Ct=t,this._$AM=n,this._$Ci=r}_$AS(t,n){return this.update(t,n)}update(t,n){return this.render(...n)}}/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ar=YSe(class extends XSe{constructor(e){var t;if(super(e),e.type!==Wv.ATTRIBUTE||e.name!=="class"||((t=e.strings)===null||t===void 0?void 0:t.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter(t=>e[t]).join(" ")+" "}update(e,[t]){var n,r;if(this.it===void 0){this.it=new Set,e.strings!==void 0&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter(s=>s!=="")));for(const s in t)t[s]&&!(!((n=this.nt)===null||n===void 0)&&n.has(s))&&this.it.add(s);return this.render(t)}const i=e.element.classList;this.it.forEach(s=>{s in t||(i.remove(s),this.it.delete(s))});for(const s in t){const a=!!t[s];a===this.it.has(s)||((r=this.nt)===null||r===void 0?void 0:r.has(s))||(a?(i.add(s),this.it.add(s)):(i.remove(s),this.it.delete(s)))}return Ic}});/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const KSe=Symbol.for(""),RZe=e=>{if((e==null?void 0:e.r)===KSe)return e==null?void 0:e._$litStatic$},e5=(e,...t)=>({_$litStatic$:t.reduce((n,r,i)=>n+(s=>{if(s._$litStatic$!==void 0)return s._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${s}. Use 'unsafeStatic' to pass non-literal values, but
            take care to ensure page security.`)})(r)+e[i+1],e[0]),r:KSe}),_de=new Map,PZe=e=>(t,...n)=>{const r=n.length;let i,s;const a=[],o=[];let l,u=0,c=!1;for(;u<r;){for(l=t[u];u<r&&(s=n[u],(i=RZe(s))!==void 0);)l+=i+t[++u],c=!0;u!==r&&o.push(s),a.push(l),u++}if(u===r&&a.push(t[r]),c){const f=a.join("$$lit$$");(t=_de.get(f))===void 0&&(a.raw=a,_de.set(f,t=a)),n=o}return e(t,...n)},QE=PZe(de);/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const At=e=>e!=null?e:ri;var LZe=Qt`
  ${Nr}

  :host {
    display: inline-block;
    color: var(--sl-color-neutral-600);
  }

  .icon-button {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    background: none;
    border: none;
    border-radius: var(--sl-border-radius-medium);
    font-size: inherit;
    color: inherit;
    padding: var(--sl-spacing-x-small);
    cursor: pointer;
    transition: var(--sl-transition-x-fast) color;
    -webkit-appearance: none;
  }

  .icon-button:hover:not(.icon-button--disabled),
  .icon-button:focus-visible:not(.icon-button--disabled) {
    color: var(--sl-color-primary-600);
  }

  .icon-button:active:not(.icon-button--disabled) {
    color: var(--sl-color-primary-700);
  }

  .icon-button:focus {
    outline: none;
  }

  .icon-button--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .icon-button:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .icon-button__icon {
    pointer-events: none;
  }
`;let Bl=class extends nr{constructor(){super(...arguments),this.hasFocus=!1,this.label="",this.disabled=!1}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleClick(e){this.disabled&&(e.preventDefault(),e.stopPropagation())}click(){this.button.click()}focus(e){this.button.focus(e)}blur(){this.button.blur()}render(){const e=!!this.href,t=e?e5`a`:e5`button`;return QE`
      <${t}
        part="base"
        class=${Ar({"icon-button":!0,"icon-button--disabled":!e&&this.disabled,"icon-button--focused":this.hasFocus})}
        ?disabled=${At(e?void 0:this.disabled)}
        type=${At(e?void 0:"button")}
        href=${At(e?this.href:void 0)}
        target=${At(e?this.target:void 0)}
        download=${At(e?this.download:void 0)}
        rel=${At(e&&this.target?"noreferrer noopener":void 0)}
        role=${At(e?void 0:"button")}
        aria-disabled=${this.disabled?"true":"false"}
        aria-label="${this.label}"
        tabindex=${this.disabled?"-1":"0"}
        @blur=${this.handleBlur}
        @focus=${this.handleFocus}
        @click=${this.handleClick}
      >
        <sl-icon
          class="icon-button__icon"
          name=${At(this.name)}
          library=${At(this.library)}
          src=${At(this.src)}
          aria-hidden="true"
        ></sl-icon>
      </${t}>
    `}};Bl.styles=LZe;H([gt(".icon-button")],Bl.prototype,"button",2);H([Ir()],Bl.prototype,"hasFocus",2);H([J()],Bl.prototype,"name",2);H([J()],Bl.prototype,"library",2);H([J()],Bl.prototype,"src",2);H([J()],Bl.prototype,"href",2);H([J()],Bl.prototype,"target",2);H([J()],Bl.prototype,"download",2);H([J()],Bl.prototype,"label",2);H([J({type:Boolean,reflect:!0})],Bl.prototype,"disabled",2);Bl=H([Ue("sl-icon-button")],Bl);function Ki(e,t,n){return new Promise(r=>{if((n==null?void 0:n.duration)===1/0)throw new Error("Promise-based animations must be finite.");const i=e.animate(t,Object.assign(Object.assign({},n),{duration:BZe()?0:n.duration}));i.addEventListener("cancel",r,{once:!0}),i.addEventListener("finish",r,{once:!0})})}function Sde(e){return e=e.toString().toLowerCase(),e.indexOf("ms")>-1?parseFloat(e):e.indexOf("s")>-1?parseFloat(e)*1e3:parseFloat(e)}function BZe(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}function ga(e){return Promise.all(e.getAnimations().map(t=>new Promise(n=>{const r=requestAnimationFrame(n);t.addEventListener("cancel",()=>r,{once:!0}),t.addEventListener("finish",()=>r,{once:!0}),t.cancel()})))}function kde(e,t){return e.map(n=>Object.assign(Object.assign({},n),{height:n.height==="auto"?`${t}px`:n.height}))}const ZSe=new Map,zZe=new WeakMap;function UZe(e){return e!=null?e:{keyframes:[],options:{duration:0}}}function Ede(e,t){return t.toLowerCase()==="rtl"?{keyframes:e.rtlKeyframes||e.keyframes,options:e.options}:e}function Mr(e,t){ZSe.set(e,UZe(t))}function Zi(e,t,n){const r=zZe.get(e);if(r!=null&&r[t])return Ede(r[t],n.dir);const i=ZSe.get(t);return i?Ede(i,n.dir):{keyframes:[],options:{duration:0}}}class td{constructor(t,...n){this.slotNames=[],(this.host=t).addController(this),this.slotNames=n,this.handleSlotChange=this.handleSlotChange.bind(this)}hasDefaultSlot(){return[...this.host.childNodes].some(t=>{if(t.nodeType===t.TEXT_NODE&&t.textContent.trim()!=="")return!0;if(t.nodeType===t.ELEMENT_NODE){const n=t;if(n.tagName.toLowerCase()==="sl-visually-hidden")return!1;if(!n.hasAttribute("slot"))return!0}return!1})}hasNamedSlot(t){return this.host.querySelector(`:scope > [slot="${t}"]`)!==null}test(t){return t==="[default]"?this.hasDefaultSlot():this.hasNamedSlot(t)}hostConnected(){this.host.shadowRoot.addEventListener("slotchange",this.handleSlotChange)}hostDisconnected(){this.host.shadowRoot.removeEventListener("slotchange",this.handleSlotChange)}handleSlotChange(t){const n=t.target;(this.slotNames.includes("[default]")&&!n.name||n.name&&this.slotNames.includes(n.name))&&this.host.requestUpdate()}}const XG=new Set,WZe=new MutationObserver(eke),E2=new Map;let QSe=document.documentElement.dir||"ltr",JSe=document.documentElement.lang||navigator.language,n1;WZe.observe(document.documentElement,{attributes:!0,attributeFilter:["dir","lang"]});function VZe(...e){e.map(t=>{const n=t.$code.toLowerCase();E2.has(n)?E2.set(n,Object.assign(Object.assign({},E2.get(n)),t)):E2.set(n,t),n1||(n1=t)}),eke()}function eke(){QSe=document.documentElement.dir||"ltr",JSe=document.documentElement.lang||navigator.language,[...XG.keys()].map(e=>{typeof e.requestUpdate=="function"&&e.requestUpdate()})}class jZe{constructor(t){this.host=t,this.host.addController(this)}hostConnected(){XG.add(this.host)}hostDisconnected(){XG.delete(this.host)}dir(){return`${this.host.dir||QSe}`.toLowerCase()}lang(){return`${this.host.lang||JSe}`.toLowerCase()}getTranslationData(t){var n,r;const i=new Intl.Locale(t),s=i==null?void 0:i.language.toLowerCase(),a=(r=(n=i==null?void 0:i.region)===null||n===void 0?void 0:n.toLowerCase())!==null&&r!==void 0?r:"",o=E2.get(`${s}-${a}`),l=E2.get(s);return{locale:i,language:s,region:a,primary:o,secondary:l}}exists(t,n){var r;const{primary:i,secondary:s}=this.getTranslationData((r=n.lang)!==null&&r!==void 0?r:this.lang());return n=Object.assign({includeFallback:!1},n),!!(i&&i[t]||s&&s[t]||n.includeFallback&&n1&&n1[t])}term(t,...n){const{primary:r,secondary:i}=this.getTranslationData(this.lang());let s;if(r&&r[t])s=r[t];else if(i&&i[t])s=i[t];else if(n1&&n1[t])s=n1[t];else return console.error(`No translation found for: ${String(t)}`),String(t);return typeof s=="function"?s(...n):s}date(t,n){return t=new Date(t),new Intl.DateTimeFormat(this.lang(),n).format(t)}number(t,n){return t=Number(t),isNaN(t)?"":new Intl.NumberFormat(this.lang(),n).format(t)}relativeTime(t,n,r){return new Intl.RelativeTimeFormat(this.lang(),r).format(t,n)}}const HZe={$code:"en",$name:"English",$dir:"ltr",carousel:"Carousel",clearEntry:"Clear entry",close:"Close",copy:"Copy",currentValue:"Current value",goToSlide:(e,t)=>`Go to slide ${e} of ${t}`,hidePassword:"Hide password",loading:"Loading",nextSlide:"Next slide",numOptionsSelected:e=>e===0?"No options selected":e===1?"1 option selected":`${e} options selected`,previousSlide:"Previous slide",progress:"Progress",remove:"Remove",resize:"Resize",scrollToEnd:"Scroll to end",scrollToStart:"Scroll to start",selectAColorFromTheScreen:"Select a color from the screen",showPassword:"Show password",slideNum:e=>`Slide ${e}`,toggleColorFormat:"Toggle color format"};VZe(HZe);class Co extends jZe{}function Iu(e,t){return new Promise(n=>{function r(i){i.target===e&&(e.removeEventListener(t,r),n())}e.addEventListener(t,r)})}var qZe=Qt`
  ${Nr}

  :host {
    display: contents;

    /* For better DX, we'll reset the margin here so the base part can inherit it */
    margin: 0;
  }

  .alert {
    position: relative;
    display: flex;
    align-items: stretch;
    background-color: var(--sl-panel-background-color);
    border: solid var(--sl-panel-border-width) var(--sl-panel-border-color);
    border-top-width: calc(var(--sl-panel-border-width) * 3);
    border-radius: var(--sl-border-radius-medium);
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-small);
    font-weight: var(--sl-font-weight-normal);
    line-height: 1.6;
    color: var(--sl-color-neutral-700);
    margin: inherit;
  }

  .alert:not(.alert--has-icon) .alert__icon,
  .alert:not(.alert--closable) .alert__close-button {
    display: none;
  }

  .alert__icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-large);
    padding-inline-start: var(--sl-spacing-large);
  }

  .alert--primary {
    border-top-color: var(--sl-color-primary-600);
  }

  .alert--primary .alert__icon {
    color: var(--sl-color-primary-600);
  }

  .alert--success {
    border-top-color: var(--sl-color-success-600);
  }

  .alert--success .alert__icon {
    color: var(--sl-color-success-600);
  }

  .alert--neutral {
    border-top-color: var(--sl-color-neutral-600);
  }

  .alert--neutral .alert__icon {
    color: var(--sl-color-neutral-600);
  }

  .alert--warning {
    border-top-color: var(--sl-color-warning-600);
  }

  .alert--warning .alert__icon {
    color: var(--sl-color-warning-600);
  }

  .alert--danger {
    border-top-color: var(--sl-color-danger-600);
  }

  .alert--danger .alert__icon {
    color: var(--sl-color-danger-600);
  }

  .alert__message {
    flex: 1 1 auto;
    display: block;
    padding: var(--sl-spacing-large);
    overflow: hidden;
  }

  .alert__close-button {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-medium);
    padding-inline-end: var(--sl-spacing-medium);
  }
`;const Yx=Object.assign(document.createElement("div"),{className:"sl-toast-stack"});let Ch=class extends nr{constructor(){super(...arguments),this.hasSlotController=new td(this,"icon","suffix"),this.localize=new Co(this),this.open=!1,this.closable=!1,this.variant="primary",this.duration=1/0}firstUpdated(){this.base.hidden=!this.open}restartAutoHide(){clearTimeout(this.autoHideTimeout),this.open&&this.duration<1/0&&(this.autoHideTimeout=window.setTimeout(()=>this.hide(),this.duration))}handleCloseClick(){this.hide()}handleMouseMove(){this.restartAutoHide()}async handleOpenChange(){if(this.open){this.emit("sl-show"),this.duration<1/0&&this.restartAutoHide(),await ga(this.base),this.base.hidden=!1;const{keyframes:e,options:t}=Zi(this,"alert.show",{dir:this.localize.dir()});await Ki(this.base,e,t),this.emit("sl-after-show")}else{this.emit("sl-hide"),clearTimeout(this.autoHideTimeout),await ga(this.base);const{keyframes:e,options:t}=Zi(this,"alert.hide",{dir:this.localize.dir()});await Ki(this.base,e,t),this.base.hidden=!0,this.emit("sl-after-hide")}}handleDurationChange(){this.restartAutoHide()}async show(){if(!this.open)return this.open=!0,Iu(this,"sl-after-show")}async hide(){if(!!this.open)return this.open=!1,Iu(this,"sl-after-hide")}async toast(){return new Promise(e=>{Yx.parentElement===null&&document.body.append(Yx),Yx.appendChild(this),requestAnimationFrame(()=>{this.clientWidth,this.show()}),this.addEventListener("sl-after-hide",()=>{Yx.removeChild(this),e(),Yx.querySelector("sl-alert")===null&&Yx.remove()},{once:!0})})}render(){return de`
      <div
        part="base"
        class=${Ar({alert:!0,"alert--open":this.open,"alert--closable":this.closable,"alert--has-icon":this.hasSlotController.test("icon"),"alert--primary":this.variant==="primary","alert--success":this.variant==="success","alert--neutral":this.variant==="neutral","alert--warning":this.variant==="warning","alert--danger":this.variant==="danger"})}
        role="alert"
        aria-hidden=${this.open?"false":"true"}
        @mousemove=${this.handleMouseMove}
      >
        <slot name="icon" part="icon" class="alert__icon"></slot>

        <slot part="message" class="alert__message" aria-live="polite"></slot>

        ${this.closable?de`
              <sl-icon-button
                part="close-button"
                exportparts="base:close-button__base"
                class="alert__close-button"
                name="x-lg"
                library="system"
                label=${this.localize.term("close")}
                @click=${this.handleCloseClick}
              ></sl-icon-button>
            `:""}
      </div>
    `}};Ch.styles=qZe;H([gt('[part~="base"]')],Ch.prototype,"base",2);H([J({type:Boolean,reflect:!0})],Ch.prototype,"open",2);H([J({type:Boolean,reflect:!0})],Ch.prototype,"closable",2);H([J({reflect:!0})],Ch.prototype,"variant",2);H([J({type:Number})],Ch.prototype,"duration",2);H([Jt("open",{waitUntilFirstUpdate:!0})],Ch.prototype,"handleOpenChange",1);H([Jt("duration")],Ch.prototype,"handleDurationChange",1);Ch=H([Ue("sl-alert")],Ch);Mr("alert.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:250,easing:"ease"}});Mr("alert.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:250,easing:"ease"}});var GZe=Qt`
  ${Nr}

  :host {
    display: inline-flex;
  }

  .badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: max(12px, 0.75em);
    font-weight: var(--sl-font-weight-semibold);
    letter-spacing: var(--sl-letter-spacing-normal);
    line-height: 1;
    border-radius: var(--sl-border-radius-small);
    border: solid 1px var(--sl-color-neutral-0);
    white-space: nowrap;
    padding: 0.35em 0.6em;
    user-select: none;
    cursor: inherit;
  }

  /* Variant modifiers */
  .badge--primary {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .badge--success {
    background-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  .badge--neutral {
    background-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  .badge--warning {
    background-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }

  .badge--danger {
    background-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  /* Pill modifier */
  .badge--pill {
    border-radius: var(--sl-border-radius-pill);
  }

  /* Pulse modifier */
  .badge--pulse {
    animation: pulse 1.5s infinite;
  }

  .badge--pulse.badge--primary {
    --pulse-color: var(--sl-color-primary-600);
  }

  .badge--pulse.badge--success {
    --pulse-color: var(--sl-color-success-600);
  }

  .badge--pulse.badge--neutral {
    --pulse-color: var(--sl-color-neutral-600);
  }

  .badge--pulse.badge--warning {
    --pulse-color: var(--sl-color-warning-600);
  }

  .badge--pulse.badge--danger {
    --pulse-color: var(--sl-color-danger-600);
  }

  @keyframes pulse {
    0% {
      box-shadow: 0 0 0 0 var(--pulse-color);
    }
    70% {
      box-shadow: 0 0 0 0.5rem transparent;
    }
    100% {
      box-shadow: 0 0 0 0 transparent;
    }
  }
`;let $w=class extends nr{constructor(){super(...arguments),this.variant="primary",this.pill=!1,this.pulse=!1}render(){return de`
      <slot
        part="base"
        class=${Ar({badge:!0,"badge--primary":this.variant==="primary","badge--success":this.variant==="success","badge--neutral":this.variant==="neutral","badge--warning":this.variant==="warning","badge--danger":this.variant==="danger","badge--pill":this.pill,"badge--pulse":this.pulse})}
        role="status"
      ></slot>
    `}};$w.styles=GZe;H([J({reflect:!0})],$w.prototype,"variant",2);H([J({type:Boolean,reflect:!0})],$w.prototype,"pill",2);H([J({type:Boolean,reflect:!0})],$w.prototype,"pulse",2);$w=H([Ue("sl-badge")],$w);var YZe=Qt`
  ${Nr}

  :host {
    --track-width: 2px;
    --track-color: rgb(128 128 128 / 25%);
    --indicator-color: var(--sl-color-primary-600);
    --speed: 2s;

    display: inline-flex;
    width: 1em;
    height: 1em;
  }

  .spinner {
    flex: 1 1 auto;
    height: 100%;
    width: 100%;
  }

  .spinner__track,
  .spinner__indicator {
    fill: none;
    stroke-width: var(--track-width);
    r: calc(0.5em - var(--track-width) / 2);
    cx: 0.5em;
    cy: 0.5em;
    transform-origin: 50% 50%;
  }

  .spinner__track {
    stroke: var(--track-color);
    transform-origin: 0% 0%;
  }

  .spinner__indicator {
    stroke: var(--indicator-color);
    stroke-linecap: round;
    stroke-dasharray: 150% 75%;
    animation: spin var(--speed) linear infinite;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
      stroke-dasharray: 0.01em, 2.75em;
    }

    50% {
      transform: rotate(450deg);
      stroke-dasharray: 1.375em, 1.375em;
    }

    100% {
      transform: rotate(1080deg);
      stroke-dasharray: 0.01em, 2.75em;
    }
  }
`;let KG=class extends nr{constructor(){super(...arguments),this.localize=new Co(this)}render(){return de`
      <svg part="base" class="spinner" role="progressbar" aria-valuetext=${this.localize.term("loading")}>
        <circle class="spinner__track"></circle>
        <circle class="spinner__indicator"></circle>
      </svg>
    `}};KG.styles=YZe;KG=H([Ue("sl-spinner")],KG);const LS=new WeakMap,BS=new WeakMap,WV=new WeakSet,LF=new WeakMap;class hC{constructor(t,n){(this.host=t).addController(this),this.options=Object.assign({form:r=>{if(r.hasAttribute("form")&&r.getAttribute("form")!==""){const i=r.getRootNode(),s=r.getAttribute("form");if(s)return i.getElementById(s)}return r.closest("form")},name:r=>r.name,value:r=>r.value,defaultValue:r=>r.defaultValue,disabled:r=>{var i;return(i=r.disabled)!==null&&i!==void 0?i:!1},reportValidity:r=>typeof r.reportValidity=="function"?r.reportValidity():!0,setValue:(r,i)=>r.value=i,assumeInteractionOn:["sl-input"]},n),this.handleFormData=this.handleFormData.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleFormReset=this.handleFormReset.bind(this),this.reportFormValidity=this.reportFormValidity.bind(this),this.handleInteraction=this.handleInteraction.bind(this)}hostConnected(){const t=this.options.form(this.host);t&&this.attachForm(t),LF.set(this.host,[]),this.options.assumeInteractionOn.forEach(n=>{this.host.addEventListener(n,this.handleInteraction)})}hostDisconnected(){this.detachForm(),LF.delete(this.host),this.options.assumeInteractionOn.forEach(t=>{this.host.removeEventListener(t,this.handleInteraction)})}hostUpdated(){const t=this.options.form(this.host);t||this.detachForm(),t&&this.form!==t&&(this.detachForm(),this.attachForm(t)),this.host.hasUpdated&&this.setValidity(this.host.validity.valid)}attachForm(t){t?(this.form=t,LS.has(this.form)?LS.get(this.form).add(this.host):LS.set(this.form,new Set([this.host])),this.form.addEventListener("formdata",this.handleFormData),this.form.addEventListener("submit",this.handleFormSubmit),this.form.addEventListener("reset",this.handleFormReset),BS.has(this.form)||(BS.set(this.form,this.form.reportValidity),this.form.reportValidity=()=>this.reportFormValidity())):this.form=void 0}detachForm(){var t;this.form&&((t=LS.get(this.form))===null||t===void 0||t.delete(this.host),this.form.removeEventListener("formdata",this.handleFormData),this.form.removeEventListener("submit",this.handleFormSubmit),this.form.removeEventListener("reset",this.handleFormReset),BS.has(this.form)&&(this.form.reportValidity=BS.get(this.form),BS.delete(this.form))),this.form=void 0}handleFormData(t){const n=this.options.disabled(this.host),r=this.options.name(this.host),i=this.options.value(this.host),s=this.host.tagName.toLowerCase()==="sl-button";!n&&!s&&typeof r=="string"&&r.length>0&&typeof i<"u"&&(Array.isArray(i)?i.forEach(a=>{t.formData.append(r,a.toString())}):t.formData.append(r,i.toString()))}handleFormSubmit(t){var n;const r=this.options.disabled(this.host),i=this.options.reportValidity;this.form&&!this.form.noValidate&&((n=LS.get(this.form))===null||n===void 0||n.forEach(s=>{this.setUserInteracted(s,!0)})),this.form&&!this.form.noValidate&&!r&&!i(this.host)&&(t.preventDefault(),t.stopImmediatePropagation())}handleFormReset(){this.options.setValue(this.host,this.options.defaultValue(this.host)),this.setUserInteracted(this.host,!1),LF.set(this.host,[])}handleInteraction(t){const n=LF.get(this.host);n.includes(t.type)||n.push(t.type),n.length===this.options.assumeInteractionOn.length&&this.setUserInteracted(this.host,!0)}reportFormValidity(){if(this.form&&!this.form.noValidate){const t=this.form.querySelectorAll("*");for(const n of t)if(typeof n.reportValidity=="function"&&!n.reportValidity())return!1}return!0}setUserInteracted(t,n){n?WV.add(t):WV.delete(t),t.requestUpdate()}doAction(t,n){if(this.form){const r=document.createElement("button");r.type=t,r.style.position="absolute",r.style.width="0",r.style.height="0",r.style.clipPath="inset(50%)",r.style.overflow="hidden",r.style.whiteSpace="nowrap",n&&(r.name=n.name,r.value=n.value,["formaction","formenctype","formmethod","formnovalidate","formtarget"].forEach(i=>{n.hasAttribute(i)&&r.setAttribute(i,n.getAttribute(i))})),this.form.append(r),r.click(),r.remove()}}getForm(){var t;return(t=this.form)!==null&&t!==void 0?t:null}reset(t){this.doAction("reset",t)}submit(t){this.doAction("submit",t)}setValidity(t){const n=this.host,r=Boolean(WV.has(n)),i=Boolean(n.required);n.toggleAttribute("data-required",i),n.toggleAttribute("data-optional",!i),n.toggleAttribute("data-invalid",!t),n.toggleAttribute("data-valid",t),n.toggleAttribute("data-user-invalid",!t&&r),n.toggleAttribute("data-user-valid",t&&r)}updateValidity(){const t=this.host;this.setValidity(t.validity.valid)}emitInvalidEvent(t){const n=new CustomEvent("sl-invalid",{bubbles:!1,composed:!1,cancelable:!0,detail:{}});t||n.preventDefault(),this.host.dispatchEvent(n)||t==null||t.preventDefault()}}const JB=Object.freeze({badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:!0,valueMissing:!1}),XZe=Object.freeze(Object.assign(Object.assign({},JB),{valid:!1,valueMissing:!0})),KZe=Object.freeze(Object.assign(Object.assign({},JB),{valid:!1,customError:!0}));var tke=Qt`
  ${Nr}

  :host {
    display: inline-block;
    position: relative;
    width: auto;
    cursor: pointer;
  }

  .button {
    display: inline-flex;
    align-items: stretch;
    justify-content: center;
    width: 100%;
    border-style: solid;
    border-width: var(--sl-input-border-width);
    font-family: var(--sl-input-font-family);
    font-weight: var(--sl-font-weight-semibold);
    text-decoration: none;
    user-select: none;
    white-space: nowrap;
    vertical-align: middle;
    padding: 0;
    transition: var(--sl-transition-x-fast) background-color, var(--sl-transition-x-fast) color,
      var(--sl-transition-x-fast) border, var(--sl-transition-x-fast) box-shadow;
    cursor: inherit;
  }

  .button::-moz-focus-inner {
    border: 0;
  }

  .button:focus {
    outline: none;
  }

  .button:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .button--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  /* When disabled, prevent mouse events from bubbling up from children */
  .button--disabled * {
    pointer-events: none;
  }

  .button__prefix,
  .button__suffix {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    pointer-events: none;
  }

  .button__label {
    display: inline-block;
  }

  .button__label::slotted(sl-icon) {
    vertical-align: -2px;
  }

  /*
   * Standard buttons
   */

  /* Default */
  .button--standard.button--default {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-neutral-300);
    color: var(--sl-color-neutral-700);
  }

  .button--standard.button--default:hover:not(.button--disabled) {
    background-color: var(--sl-color-primary-50);
    border-color: var(--sl-color-primary-300);
    color: var(--sl-color-primary-700);
  }

  .button--standard.button--default:active:not(.button--disabled) {
    background-color: var(--sl-color-primary-100);
    border-color: var(--sl-color-primary-400);
    color: var(--sl-color-primary-700);
  }

  /* Primary */
  .button--standard.button--primary {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--primary:hover:not(.button--disabled) {
    background-color: var(--sl-color-primary-500);
    border-color: var(--sl-color-primary-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--primary:active:not(.button--disabled) {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  /* Success */
  .button--standard.button--success {
    background-color: var(--sl-color-success-600);
    border-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--success:hover:not(.button--disabled) {
    background-color: var(--sl-color-success-500);
    border-color: var(--sl-color-success-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--success:active:not(.button--disabled) {
    background-color: var(--sl-color-success-600);
    border-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  /* Neutral */
  .button--standard.button--neutral {
    background-color: var(--sl-color-neutral-600);
    border-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--neutral:hover:not(.button--disabled) {
    background-color: var(--sl-color-neutral-500);
    border-color: var(--sl-color-neutral-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--neutral:active:not(.button--disabled) {
    background-color: var(--sl-color-neutral-600);
    border-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  /* Warning */
  .button--standard.button--warning {
    background-color: var(--sl-color-warning-600);
    border-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }
  .button--standard.button--warning:hover:not(.button--disabled) {
    background-color: var(--sl-color-warning-500);
    border-color: var(--sl-color-warning-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--warning:active:not(.button--disabled) {
    background-color: var(--sl-color-warning-600);
    border-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }

  /* Danger */
  .button--standard.button--danger {
    background-color: var(--sl-color-danger-600);
    border-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--danger:hover:not(.button--disabled) {
    background-color: var(--sl-color-danger-500);
    border-color: var(--sl-color-danger-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--danger:active:not(.button--disabled) {
    background-color: var(--sl-color-danger-600);
    border-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  /*
   * Outline buttons
   */

  .button--outline {
    background: none;
    border: solid 1px;
  }

  /* Default */
  .button--outline.button--default {
    border-color: var(--sl-color-neutral-300);
    color: var(--sl-color-neutral-700);
  }

  .button--outline.button--default:hover:not(.button--disabled),
  .button--outline.button--default.button--checked:not(.button--disabled) {
    border-color: var(--sl-color-primary-600);
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--default:active:not(.button--disabled) {
    border-color: var(--sl-color-primary-700);
    background-color: var(--sl-color-primary-700);
    color: var(--sl-color-neutral-0);
  }

  /* Primary */
  .button--outline.button--primary {
    border-color: var(--sl-color-primary-600);
    color: var(--sl-color-primary-600);
  }

  .button--outline.button--primary:hover:not(.button--disabled),
  .button--outline.button--primary.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--primary:active:not(.button--disabled) {
    border-color: var(--sl-color-primary-700);
    background-color: var(--sl-color-primary-700);
    color: var(--sl-color-neutral-0);
  }

  /* Success */
  .button--outline.button--success {
    border-color: var(--sl-color-success-600);
    color: var(--sl-color-success-600);
  }

  .button--outline.button--success:hover:not(.button--disabled),
  .button--outline.button--success.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--success:active:not(.button--disabled) {
    border-color: var(--sl-color-success-700);
    background-color: var(--sl-color-success-700);
    color: var(--sl-color-neutral-0);
  }

  /* Neutral */
  .button--outline.button--neutral {
    border-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-600);
  }

  .button--outline.button--neutral:hover:not(.button--disabled),
  .button--outline.button--neutral.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--neutral:active:not(.button--disabled) {
    border-color: var(--sl-color-neutral-700);
    background-color: var(--sl-color-neutral-700);
    color: var(--sl-color-neutral-0);
  }

  /* Warning */
  .button--outline.button--warning {
    border-color: var(--sl-color-warning-600);
    color: var(--sl-color-warning-600);
  }

  .button--outline.button--warning:hover:not(.button--disabled),
  .button--outline.button--warning.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--warning:active:not(.button--disabled) {
    border-color: var(--sl-color-warning-700);
    background-color: var(--sl-color-warning-700);
    color: var(--sl-color-neutral-0);
  }

  /* Danger */
  .button--outline.button--danger {
    border-color: var(--sl-color-danger-600);
    color: var(--sl-color-danger-600);
  }

  .button--outline.button--danger:hover:not(.button--disabled),
  .button--outline.button--danger.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--danger:active:not(.button--disabled) {
    border-color: var(--sl-color-danger-700);
    background-color: var(--sl-color-danger-700);
    color: var(--sl-color-neutral-0);
  }

  @media (forced-colors: active) {
    .button.button--outline.button--checked:not(.button--disabled) {
      outline: solid 2px transparent;
    }
  }

  /*
   * Text buttons
   */

  .button--text {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-600);
  }

  .button--text:hover:not(.button--disabled) {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-500);
  }

  .button--text:focus-visible:not(.button--disabled) {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-500);
  }

  .button--text:active:not(.button--disabled) {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-700);
  }

  /*
   * Size modifiers
   */

  .button--small {
    height: auto;
    min-height: var(--sl-input-height-small);
    font-size: var(--sl-button-font-size-small);
    line-height: calc(var(--sl-input-height-small) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-small);
  }

  .button--medium {
    height: auto;
    min-height: var(--sl-input-height-medium);
    font-size: var(--sl-button-font-size-medium);
    line-height: calc(var(--sl-input-height-medium) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-medium);
  }

  .button--large {
    height: auto;
    min-height: var(--sl-input-height-large);
    font-size: var(--sl-button-font-size-large);
    line-height: calc(var(--sl-input-height-large) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-large);
  }

  /*
   * Pill modifier
   */

  .button--pill.button--small {
    border-radius: var(--sl-input-height-small);
  }

  .button--pill.button--medium {
    border-radius: var(--sl-input-height-medium);
  }

  .button--pill.button--large {
    border-radius: var(--sl-input-height-large);
  }

  /*
   * Circle modifier
   */

  .button--circle {
    padding-left: 0;
    padding-right: 0;
  }

  .button--circle.button--small {
    width: var(--sl-input-height-small);
    border-radius: 50%;
  }

  .button--circle.button--medium {
    width: var(--sl-input-height-medium);
    border-radius: 50%;
  }

  .button--circle.button--large {
    width: var(--sl-input-height-large);
    border-radius: 50%;
  }

  .button--circle .button__prefix,
  .button--circle .button__suffix,
  .button--circle .button__caret {
    display: none;
  }

  /*
   * Caret modifier
   */

  .button--caret .button__suffix {
    display: none;
  }

  .button--caret .button__caret {
    height: auto;
  }

  /*
   * Loading modifier
   */

  .button--loading {
    position: relative;
    cursor: wait;
  }

  .button--loading .button__prefix,
  .button--loading .button__label,
  .button--loading .button__suffix,
  .button--loading .button__caret {
    visibility: hidden;
  }

  .button--loading sl-spinner {
    --indicator-color: currentColor;
    position: absolute;
    font-size: 1em;
    height: 1em;
    width: 1em;
    top: calc(50% - 0.5em);
    left: calc(50% - 0.5em);
  }

  /*
   * Badges
   */

  .button ::slotted(sl-badge) {
    position: absolute;
    top: 0;
    right: 0;
    translate: 50% -50%;
    pointer-events: none;
  }

  .button--rtl ::slotted(sl-badge) {
    right: auto;
    left: 0;
    translate: -50% -50%;
  }

  /*
   * Button spacing
   */

  .button--has-label.button--small .button__label {
    padding: 0 var(--sl-spacing-small);
  }

  .button--has-label.button--medium .button__label {
    padding: 0 var(--sl-spacing-medium);
  }

  .button--has-label.button--large .button__label {
    padding: 0 var(--sl-spacing-large);
  }

  .button--has-prefix.button--small {
    padding-inline-start: var(--sl-spacing-x-small);
  }

  .button--has-prefix.button--small .button__label {
    padding-inline-start: var(--sl-spacing-x-small);
  }

  .button--has-prefix.button--medium {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-prefix.button--medium .button__label {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-prefix.button--large {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-prefix.button--large .button__label {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-suffix.button--small,
  .button--caret.button--small {
    padding-inline-end: var(--sl-spacing-x-small);
  }

  .button--has-suffix.button--small .button__label,
  .button--caret.button--small .button__label {
    padding-inline-end: var(--sl-spacing-x-small);
  }

  .button--has-suffix.button--medium,
  .button--caret.button--medium {
    padding-inline-end: var(--sl-spacing-small);
  }

  .button--has-suffix.button--medium .button__label,
  .button--caret.button--medium .button__label {
    padding-inline-end: var(--sl-spacing-small);
  }

  .button--has-suffix.button--large,
  .button--caret.button--large {
    padding-inline-end: var(--sl-spacing-small);
  }

  .button--has-suffix.button--large .button__label,
  .button--caret.button--large .button__label {
    padding-inline-end: var(--sl-spacing-small);
  }

  /*
   * Button groups support a variety of button types (e.g. buttons with tooltips, buttons as dropdown triggers, etc.).
   * This means buttons aren't always direct descendants of the button group, thus we can't target them with the
   * ::slotted selector. To work around this, the button group component does some magic to add these special classes to
   * buttons and we style them here instead.
   */

  :host(.sl-button-group__button--first:not(.sl-button-group__button--last)) .button {
    border-start-end-radius: 0;
    border-end-end-radius: 0;
  }

  :host(.sl-button-group__button--inner) .button {
    border-radius: 0;
  }

  :host(.sl-button-group__button--last:not(.sl-button-group__button--first)) .button {
    border-start-start-radius: 0;
    border-end-start-radius: 0;
  }

  /* All except the first */
  :host(.sl-button-group__button:not(.sl-button-group__button--first)) {
    margin-inline-start: calc(-1 * var(--sl-input-border-width));
  }

  /* Add a visual separator between solid buttons */
  :host(
      .sl-button-group__button:not(
          .sl-button-group__button--first,
          .sl-button-group__button--radio,
          [variant='default']
        ):not(:hover)
    )
    .button:after {
    content: '';
    position: absolute;
    top: 0;
    inset-inline-start: 0;
    bottom: 0;
    border-left: solid 1px rgb(128 128 128 / 33%);
    mix-blend-mode: multiply;
  }

  /* Bump hovered, focused, and checked buttons up so their focus ring isn't clipped */
  :host(.sl-button-group__button--hover) {
    z-index: 1;
  }

  /* Focus and checked are always on top */
  :host(.sl-button-group__button--focus),
  :host(.sl-button-group__button[checked]) {
    z-index: 2;
  }
`;let Vn=class extends nr{constructor(){super(),this.formControlController=new hC(this,{form:e=>{if(e.hasAttribute("form")){const t=e.getRootNode(),n=e.getAttribute("form");return t.getElementById(n)}return e.closest("form")},assumeInteractionOn:["click"]}),this.hasSlotController=new td(this,"[default]","prefix","suffix"),this.localize=new Co(this),this.hasFocus=!1,this.invalid=!1,this.title="",this.variant="default",this.size="medium",this.caret=!1,this.disabled=!1,this.loading=!1,this.outline=!1,this.pill=!1,this.circle=!1,this.type="button",this.name="",this.value="",this.href="",this.rel="noreferrer noopener",this.handleHostClick=e=>{(this.disabled||this.loading)&&(e.preventDefault(),e.stopImmediatePropagation())},this.addEventListener("click",this.handleHostClick)}get validity(){return this.isButton()?this.button.validity:JB}get validationMessage(){return this.isButton()?this.button.validationMessage:""}firstUpdated(){this.isButton()&&this.formControlController.updateValidity()}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleClick(){this.type==="submit"&&this.formControlController.submit(this),this.type==="reset"&&this.formControlController.reset(this)}handleInvalid(e){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(e)}isButton(){return!this.href}isLink(){return!!this.href}handleDisabledChange(){this.isButton()&&this.formControlController.setValidity(this.disabled)}click(){this.button.click()}focus(e){this.button.focus(e)}blur(){this.button.blur()}checkValidity(){return this.isButton()?this.button.checkValidity():!0}getForm(){return this.formControlController.getForm()}reportValidity(){return this.isButton()?this.button.reportValidity():!0}setCustomValidity(e){this.isButton()&&(this.button.setCustomValidity(e),this.formControlController.updateValidity())}render(){const e=this.isLink(),t=e?e5`a`:e5`button`;return QE`
      <${t}
        part="base"
        class=${Ar({button:!0,"button--default":this.variant==="default","button--primary":this.variant==="primary","button--success":this.variant==="success","button--neutral":this.variant==="neutral","button--warning":this.variant==="warning","button--danger":this.variant==="danger","button--text":this.variant==="text","button--small":this.size==="small","button--medium":this.size==="medium","button--large":this.size==="large","button--caret":this.caret,"button--circle":this.circle,"button--disabled":this.disabled,"button--focused":this.hasFocus,"button--loading":this.loading,"button--standard":!this.outline,"button--outline":this.outline,"button--pill":this.pill,"button--rtl":this.localize.dir()==="rtl","button--has-label":this.hasSlotController.test("[default]"),"button--has-prefix":this.hasSlotController.test("prefix"),"button--has-suffix":this.hasSlotController.test("suffix")})}
        ?disabled=${At(e?void 0:this.disabled)}
        type=${At(e?void 0:this.type)}
        title=${this.title}
        name=${At(e?void 0:this.name)}
        value=${At(e?void 0:this.value)}
        href=${At(e?this.href:void 0)}
        target=${At(e?this.target:void 0)}
        download=${At(e?this.download:void 0)}
        rel=${At(e?this.rel:void 0)}
        role=${At(e?void 0:"button")}
        aria-disabled=${this.disabled?"true":"false"}
        tabindex=${this.disabled?"-1":"0"}
        @blur=${this.handleBlur}
        @focus=${this.handleFocus}
        @invalid=${this.isButton()?this.handleInvalid:null}
        @click=${this.handleClick}
      >
        <slot name="prefix" part="prefix" class="button__prefix"></slot>
        <slot part="label" class="button__label"></slot>
        <slot name="suffix" part="suffix" class="button__suffix"></slot>
        ${this.caret?QE` <sl-icon part="caret" class="button__caret" library="system" name="caret"></sl-icon> `:""}
        ${this.loading?QE`<sl-spinner></sl-spinner>`:""}
      </${t}>
    `}};Vn.styles=tke;H([gt(".button")],Vn.prototype,"button",2);H([Ir()],Vn.prototype,"hasFocus",2);H([Ir()],Vn.prototype,"invalid",2);H([J()],Vn.prototype,"title",2);H([J({reflect:!0})],Vn.prototype,"variant",2);H([J({reflect:!0})],Vn.prototype,"size",2);H([J({type:Boolean,reflect:!0})],Vn.prototype,"caret",2);H([J({type:Boolean,reflect:!0})],Vn.prototype,"disabled",2);H([J({type:Boolean,reflect:!0})],Vn.prototype,"loading",2);H([J({type:Boolean,reflect:!0})],Vn.prototype,"outline",2);H([J({type:Boolean,reflect:!0})],Vn.prototype,"pill",2);H([J({type:Boolean,reflect:!0})],Vn.prototype,"circle",2);H([J()],Vn.prototype,"type",2);H([J()],Vn.prototype,"name",2);H([J()],Vn.prototype,"value",2);H([J()],Vn.prototype,"href",2);H([J()],Vn.prototype,"target",2);H([J()],Vn.prototype,"rel",2);H([J()],Vn.prototype,"download",2);H([J()],Vn.prototype,"form",2);H([J({attribute:"formaction"})],Vn.prototype,"formAction",2);H([J({attribute:"formenctype"})],Vn.prototype,"formEnctype",2);H([J({attribute:"formmethod"})],Vn.prototype,"formMethod",2);H([J({attribute:"formnovalidate",type:Boolean})],Vn.prototype,"formNoValidate",2);H([J({attribute:"formtarget"})],Vn.prototype,"formTarget",2);H([Jt("disabled",{waitUntilFirstUpdate:!0})],Vn.prototype,"handleDisabledChange",1);Vn=H([Ue("sl-button")],Vn);var ZZe=Qt`
  ${Nr}

  :host {
    --border-color: var(--sl-color-neutral-200);
    --border-radius: var(--sl-border-radius-medium);
    --border-width: 1px;
    --padding: var(--sl-spacing-large);

    display: inline-block;
  }

  .card {
    display: flex;
    flex-direction: column;
    background-color: var(--sl-panel-background-color);
    box-shadow: var(--sl-shadow-x-small);
    border: solid var(--border-width) var(--border-color);
    border-radius: var(--border-radius);
  }

  .card__image {
    display: flex;
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
    margin: calc(-1 * var(--border-width));
    overflow: hidden;
  }

  .card__image::slotted(img) {
    display: block;
    width: 100%;
  }

  .card:not(.card--has-image) .card__image {
    display: none;
  }

  .card__header {
    display: block;
    border-bottom: solid var(--border-width) var(--border-color);
    padding: calc(var(--padding) / 2) var(--padding);
  }

  .card:not(.card--has-header) .card__header {
    display: none;
  }

  .card:not(.card--has-image) .card__header {
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
  }

  .card__body {
    display: block;
    padding: var(--padding);
  }

  .card--has-footer .card__footer {
    display: block;
    border-top: solid var(--border-width) var(--border-color);
    padding: var(--padding);
  }

  .card:not(.card--has-footer) .card__footer {
    display: none;
  }
`;let ZG=class extends nr{constructor(){super(...arguments),this.hasSlotController=new td(this,"footer","header","image")}render(){return de`
      <div
        part="base"
        class=${Ar({card:!0,"card--has-footer":this.hasSlotController.test("footer"),"card--has-image":this.hasSlotController.test("image"),"card--has-header":this.hasSlotController.test("header")})}
      >
        <slot name="image" part="image" class="card__image"></slot>
        <slot name="header" part="header" class="card__header"></slot>
        <slot part="body" class="card__body"></slot>
        <slot name="footer" part="footer" class="card__footer"></slot>
      </div>
    `}};ZG.styles=ZZe;ZG=H([Ue("sl-card")],ZG);var QZe=Qt`
  ${Nr}

  :host {
    display: block;
  }

  .details {
    border: solid 1px var(--sl-color-neutral-200);
    border-radius: var(--sl-border-radius-medium);
    background-color: var(--sl-color-neutral-0);
    overflow-anchor: none;
  }

  .details--disabled {
    opacity: 0.5;
  }

  .details__header {
    display: flex;
    align-items: center;
    border-radius: inherit;
    padding: var(--sl-spacing-medium);
    user-select: none;
    cursor: pointer;
  }

  .details__header:focus {
    outline: none;
  }

  .details__header:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: calc(1px + var(--sl-focus-ring-offset));
  }

  .details--disabled .details__header {
    cursor: not-allowed;
  }

  .details--disabled .details__header:focus-visible {
    outline: none;
    box-shadow: none;
  }

  .details__summary {
    flex: 1 1 auto;
    display: flex;
    align-items: center;
  }

  .details__summary-icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    transition: var(--sl-transition-medium) rotate ease;
  }

  .details--open .details__summary-icon {
    rotate: 90deg;
  }

  .details--open.details--rtl .details__summary-icon {
    rotate: -90deg;
  }

  .details--open slot[name='expand-icon'],
  .details:not(.details--open) slot[name='collapse-icon'] {
    display: none;
  }

  .details__body {
    overflow: hidden;
  }

  .details__content {
    display: block;
    padding: var(--sl-spacing-medium);
  }
`;let Gc=class extends nr{constructor(){super(...arguments),this.localize=new Co(this),this.open=!1,this.disabled=!1}firstUpdated(){this.body.hidden=!this.open,this.body.style.height=this.open?"auto":"0"}handleSummaryClick(){this.disabled||(this.open?this.hide():this.show(),this.header.focus())}handleSummaryKeyDown(e){(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),this.open?this.hide():this.show()),(e.key==="ArrowUp"||e.key==="ArrowLeft")&&(e.preventDefault(),this.hide()),(e.key==="ArrowDown"||e.key==="ArrowRight")&&(e.preventDefault(),this.show())}async handleOpenChange(){if(this.open){if(this.emit("sl-show",{cancelable:!0}).defaultPrevented){this.open=!1;return}await ga(this.body),this.body.hidden=!1;const{keyframes:t,options:n}=Zi(this,"details.show",{dir:this.localize.dir()});await Ki(this.body,kde(t,this.body.scrollHeight),n),this.body.style.height="auto",this.emit("sl-after-show")}else{if(this.emit("sl-hide",{cancelable:!0}).defaultPrevented){this.open=!0;return}await ga(this.body);const{keyframes:t,options:n}=Zi(this,"details.hide",{dir:this.localize.dir()});await Ki(this.body,kde(t,this.body.scrollHeight),n),this.body.hidden=!0,this.body.style.height="auto",this.emit("sl-after-hide")}}async show(){if(!(this.open||this.disabled))return this.open=!0,Iu(this,"sl-after-show")}async hide(){if(!(!this.open||this.disabled))return this.open=!1,Iu(this,"sl-after-hide")}render(){const e=this.localize.dir()==="rtl";return de`
      <div
        part="base"
        class=${Ar({details:!0,"details--open":this.open,"details--disabled":this.disabled,"details--rtl":e})}
      >
        <div
          part="header"
          id="header"
          class="details__header"
          role="button"
          aria-expanded=${this.open?"true":"false"}
          aria-controls="content"
          aria-disabled=${this.disabled?"true":"false"}
          tabindex=${this.disabled?"-1":"0"}
          @click=${this.handleSummaryClick}
          @keydown=${this.handleSummaryKeyDown}
        >
          <slot name="summary" part="summary" class="details__summary">${this.summary}</slot>

          <span part="summary-icon" class="details__summary-icon">
            <slot name="expand-icon">
              <sl-icon library="system" name=${e?"chevron-left":"chevron-right"}></sl-icon>
            </slot>
            <slot name="collapse-icon">
              <sl-icon library="system" name=${e?"chevron-left":"chevron-right"}></sl-icon>
            </slot>
          </span>
        </div>

        <div class="details__body" role="region" aria-labelledby="header">
          <slot part="content" id="content" class="details__content"></slot>
        </div>
      </div>
    `}};Gc.styles=QZe;H([gt(".details")],Gc.prototype,"details",2);H([gt(".details__header")],Gc.prototype,"header",2);H([gt(".details__body")],Gc.prototype,"body",2);H([gt(".details__expand-icon-slot")],Gc.prototype,"expandIconSlot",2);H([J({type:Boolean,reflect:!0})],Gc.prototype,"open",2);H([J()],Gc.prototype,"summary",2);H([J({type:Boolean,reflect:!0})],Gc.prototype,"disabled",2);H([Jt("open",{waitUntilFirstUpdate:!0})],Gc.prototype,"handleOpenChange",1);Gc=H([Ue("sl-details")],Gc);Mr("details.show",{keyframes:[{height:"0",opacity:"0"},{height:"auto",opacity:"1"}],options:{duration:250,easing:"linear"}});Mr("details.hide",{keyframes:[{height:"auto",opacity:"1"},{height:"0",opacity:"0"}],options:{duration:250,easing:"linear"}});function JZe(e,t){return{top:Math.round(e.getBoundingClientRect().top-t.getBoundingClientRect().top),left:Math.round(e.getBoundingClientRect().left-t.getBoundingClientRect().left)}}const QG=new Set;function eQe(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}function JE(e){if(QG.add(e),!document.body.classList.contains("sl-scroll-lock")){const t=eQe();document.body.classList.add("sl-scroll-lock"),document.body.style.setProperty("--sl-scroll-lock-size",`${t}px`)}}function eA(e){QG.delete(e),QG.size===0&&(document.body.classList.remove("sl-scroll-lock"),document.body.style.removeProperty("--sl-scroll-lock-size"))}function JG(e,t,n="vertical",r="smooth"){const i=JZe(e,t),s=i.top+t.scrollTop,a=i.left+t.scrollLeft,o=t.scrollLeft,l=t.scrollLeft+t.offsetWidth,u=t.scrollTop,c=t.scrollTop+t.offsetHeight;(n==="horizontal"||n==="both")&&(a<o?t.scrollTo({left:a,behavior:r}):a+e.clientWidth>l&&t.scrollTo({left:a-t.offsetWidth+e.clientWidth,behavior:r})),(n==="vertical"||n==="both")&&(s<u?t.scrollTo({top:s,behavior:r}):s+e.clientHeight>c&&t.scrollTo({top:s-t.offsetHeight+e.clientHeight,behavior:r}))}function Ade(e){const t=e.tagName.toLowerCase();return e.getAttribute("tabindex")==="-1"||e.hasAttribute("disabled")||e.hasAttribute("aria-disabled")&&e.getAttribute("aria-disabled")!=="false"||t==="input"&&e.getAttribute("type")==="radio"&&!e.hasAttribute("checked")||e.offsetParent===null||window.getComputedStyle(e).visibility==="hidden"?!1:(t==="audio"||t==="video")&&e.hasAttribute("controls")||e.hasAttribute("tabindex")||e.hasAttribute("contenteditable")&&e.getAttribute("contenteditable")!=="false"?!0:["button","input","select","textarea","a","audio","video","summary"].includes(t)}function tQe(e){var t,n;const r=[];function i(o){o instanceof HTMLElement&&(r.push(o),o.shadowRoot!==null&&o.shadowRoot.mode==="open"&&i(o.shadowRoot)),[...o.children].forEach(l=>i(l))}i(e);const s=(t=r.find(o=>Ade(o)))!==null&&t!==void 0?t:null,a=(n=r.reverse().find(o=>Ade(o)))!==null&&n!==void 0?n:null;return{start:s,end:a}}let zS=[];class nke{constructor(t){this.tabDirection="forward",this.element=t,this.handleFocusIn=this.handleFocusIn.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this)}activate(){zS.push(this.element),document.addEventListener("focusin",this.handleFocusIn),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}deactivate(){zS=zS.filter(t=>t!==this.element),document.removeEventListener("focusin",this.handleFocusIn),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)}isActive(){return zS[zS.length-1]===this.element}checkFocus(){if(this.isActive()&&!this.element.matches(":focus-within")){const{start:t,end:n}=tQe(this.element),r=this.tabDirection==="forward"?t:n;typeof(r==null?void 0:r.focus)=="function"&&r.focus({preventScroll:!0})}}handleFocusIn(){this.checkFocus()}handleKeyDown(t){t.key==="Tab"&&t.shiftKey&&(this.tabDirection="backward",requestAnimationFrame(()=>this.checkFocus()))}handleKeyUp(){this.tabDirection="forward"}}var nQe=Qt`
  ${Nr}

  :host {
    --width: 31rem;
    --header-spacing: var(--sl-spacing-large);
    --body-spacing: var(--sl-spacing-large);
    --footer-spacing: var(--sl-spacing-large);

    display: contents;
  }

  .dialog {
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    z-index: var(--sl-z-index-dialog);
  }

  .dialog__panel {
    display: flex;
    flex-direction: column;
    z-index: 2;
    width: var(--width);
    max-width: calc(100% - var(--sl-spacing-2x-large));
    max-height: calc(100% - var(--sl-spacing-2x-large));
    background-color: var(--sl-panel-background-color);
    border-radius: var(--sl-border-radius-medium);
    box-shadow: var(--sl-shadow-x-large);
  }

  .dialog__panel:focus {
    outline: none;
  }

  /* Ensure there's enough vertical padding for phones that don't update vh when chrome appears (e.g. iPhone) */
  @media screen and (max-width: 420px) {
    .dialog__panel {
      max-height: 80vh;
    }
  }

  .dialog--open .dialog__panel {
    display: flex;
    opacity: 1;
  }

  .dialog__header {
    flex: 0 0 auto;
    display: flex;
  }

  .dialog__title {
    flex: 1 1 auto;
    font: inherit;
    font-size: var(--sl-font-size-large);
    line-height: var(--sl-line-height-dense);
    padding: var(--header-spacing);
    margin: 0;
  }

  .dialog__header-actions {
    flex-shrink: 0;
    display: flex;
    flex-wrap: wrap;
    justify-content: end;
    gap: var(--sl-spacing-2x-small);
    padding: 0 var(--header-spacing);
  }

  .dialog__header-actions sl-icon-button,
  .dialog__header-actions ::slotted(sl-icon-button) {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-medium);
  }

  .dialog__body {
    flex: 1 1 auto;
    display: block;
    padding: var(--body-spacing);
    overflow: auto;
    -webkit-overflow-scrolling: touch;
  }

  .dialog__footer {
    flex: 0 0 auto;
    text-align: right;
    padding: var(--footer-spacing);
  }

  .dialog__footer ::slotted(sl-button:not(:first-of-type)) {
    margin-inline-start: var(--sl-spacing-x-small);
  }

  .dialog:not(.dialog--has-footer) .dialog__footer {
    display: none;
  }

  .dialog__overlay {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background-color: var(--sl-overlay-background-color);
  }

  @media (forced-colors: active) {
    .dialog__panel {
      border: solid 1px var(--sl-color-neutral-0);
    }
  }
`;let _h=class extends nr{constructor(){super(...arguments),this.hasSlotController=new td(this,"footer"),this.localize=new Co(this),this.modal=new nke(this),this.open=!1,this.label="",this.noHeader=!1,this.handleDocumentKeyDown=e=>{this.open&&e.key==="Escape"&&(e.stopPropagation(),this.requestClose("keyboard"))}}firstUpdated(){this.dialog.hidden=!this.open,this.open&&(this.addOpenListeners(),this.modal.activate(),JE(this))}disconnectedCallback(){super.disconnectedCallback(),eA(this)}requestClose(e){if(this.emit("sl-request-close",{cancelable:!0,detail:{source:e}}).defaultPrevented){const n=Zi(this,"dialog.denyClose",{dir:this.localize.dir()});Ki(this.panel,n.keyframes,n.options);return}this.hide()}addOpenListeners(){document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){document.removeEventListener("keydown",this.handleDocumentKeyDown)}async handleOpenChange(){if(this.open){this.emit("sl-show"),this.addOpenListeners(),this.originalTrigger=document.activeElement,this.modal.activate(),JE(this);const e=this.querySelector("[autofocus]");e&&e.removeAttribute("autofocus"),await Promise.all([ga(this.dialog),ga(this.overlay)]),this.dialog.hidden=!1,requestAnimationFrame(()=>{this.emit("sl-initial-focus",{cancelable:!0}).defaultPrevented||(e?e.focus({preventScroll:!0}):this.panel.focus({preventScroll:!0})),e&&e.setAttribute("autofocus","")});const t=Zi(this,"dialog.show",{dir:this.localize.dir()}),n=Zi(this,"dialog.overlay.show",{dir:this.localize.dir()});await Promise.all([Ki(this.panel,t.keyframes,t.options),Ki(this.overlay,n.keyframes,n.options)]),this.emit("sl-after-show")}else{this.emit("sl-hide"),this.removeOpenListeners(),this.modal.deactivate(),await Promise.all([ga(this.dialog),ga(this.overlay)]);const e=Zi(this,"dialog.hide",{dir:this.localize.dir()}),t=Zi(this,"dialog.overlay.hide",{dir:this.localize.dir()});await Promise.all([Ki(this.overlay,t.keyframes,t.options).then(()=>{this.overlay.hidden=!0}),Ki(this.panel,e.keyframes,e.options).then(()=>{this.panel.hidden=!0})]),this.dialog.hidden=!0,this.overlay.hidden=!1,this.panel.hidden=!1,eA(this);const n=this.originalTrigger;typeof(n==null?void 0:n.focus)=="function"&&setTimeout(()=>n.focus()),this.emit("sl-after-hide")}}async show(){if(!this.open)return this.open=!0,Iu(this,"sl-after-show")}async hide(){if(!!this.open)return this.open=!1,Iu(this,"sl-after-hide")}render(){return de`
      <div
        part="base"
        class=${Ar({dialog:!0,"dialog--open":this.open,"dialog--has-footer":this.hasSlotController.test("footer")})}
      >
        <div part="overlay" class="dialog__overlay" @click=${()=>this.requestClose("overlay")} tabindex="-1"></div>

        <div
          part="panel"
          class="dialog__panel"
          role="dialog"
          aria-modal="true"
          aria-hidden=${this.open?"false":"true"}
          aria-label=${At(this.noHeader?this.label:void 0)}
          aria-labelledby=${At(this.noHeader?void 0:"title")}
          tabindex="0"
        >
          ${this.noHeader?"":de`
                <header part="header" class="dialog__header">
                  <h2 part="title" class="dialog__title" id="title">
                    <slot name="label"> ${this.label.length>0?this.label:String.fromCharCode(65279)} </slot>
                  </h2>
                  <div part="header-actions" class="dialog__header-actions">
                    <slot name="header-actions"></slot>
                    <sl-icon-button
                      part="close-button"
                      exportparts="base:close-button__base"
                      class="dialog__close"
                      name="x-lg"
                      label=${this.localize.term("close")}
                      library="system"
                      @click="${()=>this.requestClose("close-button")}"
                    ></sl-icon-button>
                  </div>
                </header>
              `}

          <slot part="body" class="dialog__body"></slot>

          <footer part="footer" class="dialog__footer">
            <slot name="footer"></slot>
          </footer>
        </div>
      </div>
    `}};_h.styles=nQe;H([gt(".dialog")],_h.prototype,"dialog",2);H([gt(".dialog__panel")],_h.prototype,"panel",2);H([gt(".dialog__overlay")],_h.prototype,"overlay",2);H([J({type:Boolean,reflect:!0})],_h.prototype,"open",2);H([J({reflect:!0})],_h.prototype,"label",2);H([J({attribute:"no-header",type:Boolean,reflect:!0})],_h.prototype,"noHeader",2);H([Jt("open",{waitUntilFirstUpdate:!0})],_h.prototype,"handleOpenChange",1);_h=H([Ue("sl-dialog")],_h);Mr("dialog.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:250,easing:"ease"}});Mr("dialog.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:250,easing:"ease"}});Mr("dialog.denyClose",{keyframes:[{scale:1},{scale:1.02},{scale:1}],options:{duration:250}});Mr("dialog.overlay.show",{keyframes:[{opacity:0},{opacity:1}],options:{duration:250}});Mr("dialog.overlay.hide",{keyframes:[{opacity:1},{opacity:0}],options:{duration:250}});function Tde(e){return e.charAt(0).toUpperCase()+e.slice(1)}var rQe=Qt`
  ${Nr}

  :host {
    --size: 25rem;
    --header-spacing: var(--sl-spacing-large);
    --body-spacing: var(--sl-spacing-large);
    --footer-spacing: var(--sl-spacing-large);

    display: contents;
  }

  .drawer {
    top: 0;
    inset-inline-start: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: hidden;
  }

  .drawer--contained {
    position: absolute;
    z-index: initial;
  }

  .drawer--fixed {
    position: fixed;
    z-index: var(--sl-z-index-drawer);
  }

  .drawer__panel {
    position: absolute;
    display: flex;
    flex-direction: column;
    z-index: 2;
    max-width: 100%;
    max-height: 100%;
    background-color: var(--sl-panel-background-color);
    box-shadow: var(--sl-shadow-x-large);
    overflow: auto;
    pointer-events: all;
  }

  .drawer__panel:focus {
    outline: none;
  }

  .drawer--top .drawer__panel {
    top: 0;
    inset-inline-end: auto;
    bottom: auto;
    inset-inline-start: 0;
    width: 100%;
    height: var(--size);
  }

  .drawer--end .drawer__panel {
    top: 0;
    inset-inline-end: 0;
    bottom: auto;
    inset-inline-start: auto;
    width: var(--size);
    height: 100%;
  }

  .drawer--bottom .drawer__panel {
    top: auto;
    inset-inline-end: auto;
    bottom: 0;
    inset-inline-start: 0;
    width: 100%;
    height: var(--size);
  }

  .drawer--start .drawer__panel {
    top: 0;
    inset-inline-end: auto;
    bottom: auto;
    inset-inline-start: 0;
    width: var(--size);
    height: 100%;
  }

  .drawer__header {
    display: flex;
  }

  .drawer__title {
    flex: 1 1 auto;
    font: inherit;
    font-size: var(--sl-font-size-large);
    line-height: var(--sl-line-height-dense);
    padding: var(--header-spacing);
    margin: 0;
  }

  .drawer__header-actions {
    flex-shrink: 0;
    display: flex;
    flex-wrap: wrap;
    justify-content: end;
    gap: var(--sl-spacing-2x-small);
    padding: 0 var(--header-spacing);
  }

  .drawer__header-actions sl-icon-button,
  .drawer__header-actions ::slotted(sl-icon-button) {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-medium);
  }

  .drawer__body {
    flex: 1 1 auto;
    display: block;
    padding: var(--body-spacing);
    overflow: auto;
    -webkit-overflow-scrolling: touch;
  }

  .drawer__footer {
    text-align: right;
    padding: var(--footer-spacing);
  }

  .drawer__footer ::slotted(sl-button:not(:last-of-type)) {
    margin-inline-end: var(--sl-spacing-x-small);
  }

  .drawer:not(.drawer--has-footer) .drawer__footer {
    display: none;
  }

  .drawer__overlay {
    display: block;
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background-color: var(--sl-overlay-background-color);
    pointer-events: all;
  }

  .drawer--contained .drawer__overlay {
    display: none;
  }

  @media (forced-colors: active) {
    .drawer__panel {
      border: solid 1px var(--sl-color-neutral-0);
    }
  }
`;let zl=class extends nr{constructor(){super(...arguments),this.hasSlotController=new td(this,"footer"),this.localize=new Co(this),this.modal=new nke(this),this.open=!1,this.label="",this.placement="end",this.contained=!1,this.noHeader=!1,this.handleDocumentKeyDown=e=>{this.open&&!this.contained&&e.key==="Escape"&&(e.stopPropagation(),this.requestClose("keyboard"))}}firstUpdated(){this.drawer.hidden=!this.open,this.open&&(this.addOpenListeners(),this.contained||(this.modal.activate(),JE(this)))}disconnectedCallback(){super.disconnectedCallback(),eA(this)}requestClose(e){if(this.emit("sl-request-close",{cancelable:!0,detail:{source:e}}).defaultPrevented){const n=Zi(this,"drawer.denyClose",{dir:this.localize.dir()});Ki(this.panel,n.keyframes,n.options);return}this.hide()}addOpenListeners(){document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){document.removeEventListener("keydown",this.handleDocumentKeyDown)}async handleOpenChange(){if(this.open){this.emit("sl-show"),this.addOpenListeners(),this.originalTrigger=document.activeElement,this.contained||(this.modal.activate(),JE(this));const e=this.querySelector("[autofocus]");e&&e.removeAttribute("autofocus"),await Promise.all([ga(this.drawer),ga(this.overlay)]),this.drawer.hidden=!1,requestAnimationFrame(()=>{this.emit("sl-initial-focus",{cancelable:!0}).defaultPrevented||(e?e.focus({preventScroll:!0}):this.panel.focus({preventScroll:!0})),e&&e.setAttribute("autofocus","")});const t=Zi(this,`drawer.show${Tde(this.placement)}`,{dir:this.localize.dir()}),n=Zi(this,"drawer.overlay.show",{dir:this.localize.dir()});await Promise.all([Ki(this.panel,t.keyframes,t.options),Ki(this.overlay,n.keyframes,n.options)]),this.emit("sl-after-show")}else{this.emit("sl-hide"),this.removeOpenListeners(),this.contained||(this.modal.deactivate(),eA(this)),await Promise.all([ga(this.drawer),ga(this.overlay)]);const e=Zi(this,`drawer.hide${Tde(this.placement)}`,{dir:this.localize.dir()}),t=Zi(this,"drawer.overlay.hide",{dir:this.localize.dir()});await Promise.all([Ki(this.overlay,t.keyframes,t.options).then(()=>{this.overlay.hidden=!0}),Ki(this.panel,e.keyframes,e.options).then(()=>{this.panel.hidden=!0})]),this.drawer.hidden=!0,this.overlay.hidden=!1,this.panel.hidden=!1;const n=this.originalTrigger;typeof(n==null?void 0:n.focus)=="function"&&setTimeout(()=>n.focus()),this.emit("sl-after-hide")}}handleNoModalChange(){this.open&&!this.contained&&(this.modal.activate(),JE(this)),this.open&&this.contained&&(this.modal.deactivate(),eA(this))}async show(){if(!this.open)return this.open=!0,Iu(this,"sl-after-show")}async hide(){if(!!this.open)return this.open=!1,Iu(this,"sl-after-hide")}render(){return de`
      <div
        part="base"
        class=${Ar({drawer:!0,"drawer--open":this.open,"drawer--top":this.placement==="top","drawer--end":this.placement==="end","drawer--bottom":this.placement==="bottom","drawer--start":this.placement==="start","drawer--contained":this.contained,"drawer--fixed":!this.contained,"drawer--rtl":this.localize.dir()==="rtl","drawer--has-footer":this.hasSlotController.test("footer")})}
      >
        <div part="overlay" class="drawer__overlay" @click=${()=>this.requestClose("overlay")} tabindex="-1"></div>

        <div
          part="panel"
          class="drawer__panel"
          role="dialog"
          aria-modal="true"
          aria-hidden=${this.open?"false":"true"}
          aria-label=${At(this.noHeader?this.label:void 0)}
          aria-labelledby=${At(this.noHeader?void 0:"title")}
          tabindex="0"
        >
          ${this.noHeader?"":de`
                <header part="header" class="drawer__header">
                  <h2 part="title" class="drawer__title" id="title">
                    <!-- If there's no label, use an invisible character to prevent the header from collapsing -->
                    <slot name="label"> ${this.label.length>0?this.label:String.fromCharCode(65279)} </slot>
                  </h2>
                  <div part="header-actions" class="drawer__header-actions">
                    <slot name="header-actions"></slot>
                    <sl-icon-button
                      part="close-button"
                      exportparts="base:close-button__base"
                      class="drawer__close"
                      name="x-lg"
                      label=${this.localize.term("close")}
                      library="system"
                      @click=${()=>this.requestClose("close-button")}
                    ></sl-icon-button>
                  </div>
                </header>
              `}

          <slot part="body" class="drawer__body"></slot>

          <footer part="footer" class="drawer__footer">
            <slot name="footer"></slot>
          </footer>
        </div>
      </div>
    `}};zl.styles=rQe;H([gt(".drawer")],zl.prototype,"drawer",2);H([gt(".drawer__panel")],zl.prototype,"panel",2);H([gt(".drawer__overlay")],zl.prototype,"overlay",2);H([J({type:Boolean,reflect:!0})],zl.prototype,"open",2);H([J({reflect:!0})],zl.prototype,"label",2);H([J({reflect:!0})],zl.prototype,"placement",2);H([J({type:Boolean,reflect:!0})],zl.prototype,"contained",2);H([J({attribute:"no-header",type:Boolean,reflect:!0})],zl.prototype,"noHeader",2);H([Jt("open",{waitUntilFirstUpdate:!0})],zl.prototype,"handleOpenChange",1);H([Jt("contained",{waitUntilFirstUpdate:!0})],zl.prototype,"handleNoModalChange",1);zl=H([Ue("sl-drawer")],zl);Mr("drawer.showTop",{keyframes:[{opacity:0,translate:"0 -100%"},{opacity:1,translate:"0 0"}],options:{duration:250,easing:"ease"}});Mr("drawer.hideTop",{keyframes:[{opacity:1,translate:"0 0"},{opacity:0,translate:"0 -100%"}],options:{duration:250,easing:"ease"}});Mr("drawer.showEnd",{keyframes:[{opacity:0,translate:"100%"},{opacity:1,translate:"0"}],rtlKeyframes:[{opacity:0,translate:"-100%"},{opacity:1,translate:"0"}],options:{duration:250,easing:"ease"}});Mr("drawer.hideEnd",{keyframes:[{opacity:1,translate:"0"},{opacity:0,translate:"100%"}],rtlKeyframes:[{opacity:1,translate:"0"},{opacity:0,translate:"-100%"}],options:{duration:250,easing:"ease"}});Mr("drawer.showBottom",{keyframes:[{opacity:0,translate:"0 100%"},{opacity:1,translate:"0 0"}],options:{duration:250,easing:"ease"}});Mr("drawer.hideBottom",{keyframes:[{opacity:1,translate:"0 0"},{opacity:0,translate:"0 100%"}],options:{duration:250,easing:"ease"}});Mr("drawer.showStart",{keyframes:[{opacity:0,translate:"-100%"},{opacity:1,translate:"0"}],rtlKeyframes:[{opacity:0,translate:"100%"},{opacity:1,translate:"0"}],options:{duration:250,easing:"ease"}});Mr("drawer.hideStart",{keyframes:[{opacity:1,translate:"0"},{opacity:0,translate:"-100%"}],rtlKeyframes:[{opacity:1,translate:"0"},{opacity:0,translate:"100%"}],options:{duration:250,easing:"ease"}});Mr("drawer.denyClose",{keyframes:[{scale:1},{scale:1.01},{scale:1}],options:{duration:250}});Mr("drawer.overlay.show",{keyframes:[{opacity:0},{opacity:1}],options:{duration:250}});Mr("drawer.overlay.hide",{keyframes:[{opacity:1},{opacity:0}],options:{duration:250}});const e8=(e="value")=>(t,n)=>{const r=t.constructor,i=r.prototype.attributeChangedCallback;r.prototype.attributeChangedCallback=function(s,a,o){var l;const u=r.getPropertyOptions(e),c=typeof u.attribute=="string"?u.attribute:e;if(s===c){const f=u.converter||HA,d=(typeof f=="function"?f:(l=f==null?void 0:f.fromAttribute)!==null&&l!==void 0?l:HA.fromAttribute)(o,u.type);this[e]!==d&&(this[n]=d)}i.call(this,s,a,o)}};/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const dee=YSe(class extends XSe{constructor(e){if(super(e),e.type!==Wv.PROPERTY&&e.type!==Wv.ATTRIBUTE&&e.type!==Wv.BOOLEAN_ATTRIBUTE)throw Error("The `live` directive is not allowed on child or event bindings");if(!NZe(e))throw Error("`live` bindings can only contain a single expression")}render(e){return e}update(e,[t]){if(t===Ic||t===ri)return t;const n=e.element,r=e.name;if(e.type===Wv.PROPERTY){if(t===n[r])return Ic}else if(e.type===Wv.BOOLEAN_ATTRIBUTE){if(!!t===n.hasAttribute(r))return Ic}else if(e.type===Wv.ATTRIBUTE&&n.getAttribute(r)===t+"")return Ic;return FZe(e),t}}),t8=Qt`
  .form-control .form-control__label {
    display: none;
  }

  .form-control .form-control__help-text {
    display: none;
  }

  /* Label */
  .form-control--has-label .form-control__label {
    display: inline-block;
    color: var(--sl-input-label-color);
    margin-bottom: var(--sl-spacing-3x-small);
  }

  .form-control--has-label.form-control--small .form-control__label {
    font-size: var(--sl-input-label-font-size-small);
  }

  .form-control--has-label.form-control--medium .form-control__label {
    font-size: var(--sl-input-label-font-size-medium);
  }

  .form-control--has-label.form-control--large .form-control__label {
    font-size: var(--sl-input-label-font-size-large);
  }

  :host([required]) .form-control--has-label .form-control__label::after {
    content: var(--sl-input-required-content);
    margin-inline-start: var(--sl-input-required-content-offset);
    color: var(--sl-input-required-content-color);
  }

  /* Help text */
  .form-control--has-help-text .form-control__help-text {
    display: block;
    color: var(--sl-input-help-text-color);
    margin-top: var(--sl-spacing-3x-small);
  }

  .form-control--has-help-text.form-control--small .form-control__help-text {
    font-size: var(--sl-input-help-text-font-size-small);
  }

  .form-control--has-help-text.form-control--medium .form-control__help-text {
    font-size: var(--sl-input-help-text-font-size-medium);
  }

  .form-control--has-help-text.form-control--large .form-control__help-text {
    font-size: var(--sl-input-help-text-font-size-large);
  }

  .form-control--has-help-text.form-control--radio-group .form-control__help-text {
    margin-top: var(--sl-spacing-2x-small);
  }
`;var iQe=Qt`
  ${Nr}
  ${t8}

  :host {
    display: block;
  }

  .input {
    flex: 1 1 auto;
    display: inline-flex;
    align-items: stretch;
    justify-content: start;
    position: relative;
    width: 100%;
    font-family: var(--sl-input-font-family);
    font-weight: var(--sl-input-font-weight);
    letter-spacing: var(--sl-input-letter-spacing);
    vertical-align: middle;
    overflow: hidden;
    cursor: text;
    transition: var(--sl-transition-fast) color, var(--sl-transition-fast) border, var(--sl-transition-fast) box-shadow,
      var(--sl-transition-fast) background-color;
  }

  /* Standard inputs */
  .input--standard {
    background-color: var(--sl-input-background-color);
    border: solid var(--sl-input-border-width) var(--sl-input-border-color);
  }

  .input--standard:hover:not(.input--disabled) {
    background-color: var(--sl-input-background-color-hover);
    border-color: var(--sl-input-border-color-hover);
  }

  .input--standard.input--focused:not(.input--disabled) {
    background-color: var(--sl-input-background-color-focus);
    border-color: var(--sl-input-border-color-focus);
    box-shadow: 0 0 0 var(--sl-focus-ring-width) var(--sl-input-focus-ring-color);
  }

  .input--standard.input--focused:not(.input--disabled) .input__control {
    color: var(--sl-input-color-focus);
  }

  .input--standard.input--disabled {
    background-color: var(--sl-input-background-color-disabled);
    border-color: var(--sl-input-border-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
  }

  .input--standard.input--disabled .input__control {
    color: var(--sl-input-color-disabled);
  }

  .input--standard.input--disabled .input__control::placeholder {
    color: var(--sl-input-placeholder-color-disabled);
  }

  /* Filled inputs */
  .input--filled {
    border: none;
    background-color: var(--sl-input-filled-background-color);
    color: var(--sl-input-color);
  }

  .input--filled:hover:not(.input--disabled) {
    background-color: var(--sl-input-filled-background-color-hover);
  }

  .input--filled.input--focused:not(.input--disabled) {
    background-color: var(--sl-input-filled-background-color-focus);
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .input--filled.input--disabled {
    background-color: var(--sl-input-filled-background-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
  }

  .input__control {
    flex: 1 1 auto;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    min-width: 0;
    height: 100%;
    color: var(--sl-input-color);
    border: none;
    background: inherit;
    box-shadow: none;
    padding: 0;
    margin: 0;
    cursor: inherit;
    -webkit-appearance: none;
  }

  .input__control::-webkit-search-decoration,
  .input__control::-webkit-search-cancel-button,
  .input__control::-webkit-search-results-button,
  .input__control::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }

  .input__control:-webkit-autofill,
  .input__control:-webkit-autofill:hover,
  .input__control:-webkit-autofill:focus,
  .input__control:-webkit-autofill:active {
    box-shadow: 0 0 0 var(--sl-input-height-large) var(--sl-input-background-color-hover) inset !important;
    -webkit-text-fill-color: var(--sl-color-primary-500);
    caret-color: var(--sl-input-color);
  }

  .input--filled .input__control:-webkit-autofill,
  .input--filled .input__control:-webkit-autofill:hover,
  .input--filled .input__control:-webkit-autofill:focus,
  .input--filled .input__control:-webkit-autofill:active {
    box-shadow: 0 0 0 var(--sl-input-height-large) var(--sl-input-filled-background-color) inset !important;
  }

  .input__control::placeholder {
    color: var(--sl-input-placeholder-color);
    user-select: none;
  }

  .input:hover:not(.input--disabled) .input__control {
    color: var(--sl-input-color-hover);
  }

  .input__control:focus {
    outline: none;
  }

  .input__prefix,
  .input__suffix {
    display: inline-flex;
    flex: 0 0 auto;
    align-items: center;
    cursor: default;
  }

  .input__prefix::slotted(sl-icon),
  .input__suffix::slotted(sl-icon) {
    color: var(--sl-input-icon-color);
  }

  /*
   * Size modifiers
   */

  .input--small {
    border-radius: var(--sl-input-border-radius-small);
    font-size: var(--sl-input-font-size-small);
    height: var(--sl-input-height-small);
  }

  .input--small .input__control {
    height: calc(var(--sl-input-height-small) - var(--sl-input-border-width) * 2);
    padding: 0 var(--sl-input-spacing-small);
  }

  .input--small .input__clear,
  .input--small .input__password-toggle {
    width: calc(1em + var(--sl-input-spacing-small) * 2);
  }

  .input--small .input__prefix::slotted(*) {
    margin-inline-start: var(--sl-input-spacing-small);
  }

  .input--small .input__suffix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-small);
  }

  .input--medium {
    border-radius: var(--sl-input-border-radius-medium);
    font-size: var(--sl-input-font-size-medium);
    height: var(--sl-input-height-medium);
  }

  .input--medium .input__control {
    height: calc(var(--sl-input-height-medium) - var(--sl-input-border-width) * 2);
    padding: 0 var(--sl-input-spacing-medium);
  }

  .input--medium .input__clear,
  .input--medium .input__password-toggle {
    width: calc(1em + var(--sl-input-spacing-medium) * 2);
  }

  .input--medium .input__prefix::slotted(*) {
    margin-inline-start: var(--sl-input-spacing-medium);
  }

  .input--medium .input__suffix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-medium);
  }

  .input--large {
    border-radius: var(--sl-input-border-radius-large);
    font-size: var(--sl-input-font-size-large);
    height: var(--sl-input-height-large);
  }

  .input--large .input__control {
    height: calc(var(--sl-input-height-large) - var(--sl-input-border-width) * 2);
    padding: 0 var(--sl-input-spacing-large);
  }

  .input--large .input__clear,
  .input--large .input__password-toggle {
    width: calc(1em + var(--sl-input-spacing-large) * 2);
  }

  .input--large .input__prefix::slotted(*) {
    margin-inline-start: var(--sl-input-spacing-large);
  }

  .input--large .input__suffix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-large);
  }

  /*
   * Pill modifier
   */

  .input--pill.input--small {
    border-radius: var(--sl-input-height-small);
  }

  .input--pill.input--medium {
    border-radius: var(--sl-input-height-medium);
  }

  .input--pill.input--large {
    border-radius: var(--sl-input-height-large);
  }

  /*
   * Clearable + Password Toggle
   */

  .input__clear,
  .input__password-toggle {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: inherit;
    color: var(--sl-input-icon-color);
    border: none;
    background: none;
    padding: 0;
    transition: var(--sl-transition-fast) color;
    cursor: pointer;
  }

  .input__clear:hover,
  .input__password-toggle:hover {
    color: var(--sl-input-icon-color-hover);
  }

  .input__clear:focus,
  .input__password-toggle:focus {
    outline: none;
  }

  .input--empty .input__clear {
    visibility: hidden;
  }

  /* Don't show the browser's password toggle in Edge */
  ::-ms-reveal {
    display: none;
  }

  /* Hide the built-in number spinner */
  .input--no-spin-buttons input[type='number']::-webkit-outer-spin-button,
  .input--no-spin-buttons input[type='number']::-webkit-inner-spin-button {
    -webkit-appearance: none;
    display: none;
  }

  .input--no-spin-buttons input[type='number'] {
    -moz-appearance: textfield;
  }
`;let Wt=class extends nr{constructor(){super(...arguments),this.formControlController=new hC(this,{assumeInteractionOn:["sl-blur","sl-input"]}),this.hasSlotController=new td(this,"help-text","label"),this.localize=new Co(this),this.hasFocus=!1,this.title="",this.__numberInput=Object.assign(document.createElement("input"),{type:"number"}),this.__dateInput=Object.assign(document.createElement("input"),{type:"date"}),this.type="text",this.name="",this.value="",this.defaultValue="",this.size="medium",this.filled=!1,this.pill=!1,this.label="",this.helpText="",this.clearable=!1,this.disabled=!1,this.placeholder="",this.readonly=!1,this.passwordToggle=!1,this.passwordVisible=!1,this.noSpinButtons=!1,this.form="",this.required=!1,this.spellcheck=!0}get valueAsDate(){var e;return this.__dateInput.value=this.value,((e=this.input)==null?void 0:e.valueAsDate)||this.__dateInput.valueAsDate}set valueAsDate(e){this.__dateInput.valueAsDate=e,this.value=this.__dateInput.value}get valueAsNumber(){var e;return this.__numberInput.value=this.value,((e=this.input)==null?void 0:e.valueAsNumber)||this.__numberInput.valueAsNumber}set valueAsNumber(e){this.__numberInput.valueAsNumber=e,this.value=this.__numberInput.value}get validity(){return this.input.validity}get validationMessage(){return this.input.validationMessage}firstUpdated(){this.formControlController.updateValidity()}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleChange(){this.value=this.input.value,this.emit("sl-change")}handleClearClick(e){this.value="",this.emit("sl-clear"),this.emit("sl-input"),this.emit("sl-change"),this.input.focus(),e.stopPropagation()}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleInput(){this.value=this.input.value,this.formControlController.updateValidity(),this.emit("sl-input")}handleInvalid(e){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(e)}handleKeyDown(e){const t=e.metaKey||e.ctrlKey||e.shiftKey||e.altKey;e.key==="Enter"&&!t&&setTimeout(()=>{!e.defaultPrevented&&!e.isComposing&&this.formControlController.submit()})}handlePasswordToggle(){this.passwordVisible=!this.passwordVisible}handleDisabledChange(){this.formControlController.setValidity(this.disabled)}handleStepChange(){this.input.step=String(this.step),this.formControlController.updateValidity()}async handleValueChange(){await this.updateComplete,this.formControlController.updateValidity()}focus(e){this.input.focus(e)}blur(){this.input.blur()}select(){this.input.select()}setSelectionRange(e,t,n="none"){this.input.setSelectionRange(e,t,n)}setRangeText(e,t,n,r){this.input.setRangeText(e,t,n,r),this.value!==this.input.value&&(this.value=this.input.value)}showPicker(){"showPicker"in HTMLInputElement.prototype&&this.input.showPicker()}stepUp(){this.input.stepUp(),this.value!==this.input.value&&(this.value=this.input.value)}stepDown(){this.input.stepDown(),this.value!==this.input.value&&(this.value=this.input.value)}checkValidity(){return this.input.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.input.reportValidity()}setCustomValidity(e){this.input.setCustomValidity(e),this.formControlController.updateValidity()}render(){const e=this.hasSlotController.test("label"),t=this.hasSlotController.test("help-text"),n=this.label?!0:!!e,r=this.helpText?!0:!!t,i=this.clearable&&!this.disabled&&!this.readonly&&(typeof this.value=="number"||this.value.length>0);return de`
      <div
        part="form-control"
        class=${Ar({"form-control":!0,"form-control--small":this.size==="small","form-control--medium":this.size==="medium","form-control--large":this.size==="large","form-control--has-label":n,"form-control--has-help-text":r})}
      >
        <label
          part="form-control-label"
          class="form-control__label"
          for="input"
          aria-hidden=${n?"false":"true"}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <div
            part="base"
            class=${Ar({input:!0,"input--small":this.size==="small","input--medium":this.size==="medium","input--large":this.size==="large","input--pill":this.pill,"input--standard":!this.filled,"input--filled":this.filled,"input--disabled":this.disabled,"input--focused":this.hasFocus,"input--empty":!this.value,"input--no-spin-buttons":this.noSpinButtons})}
          >
            <slot name="prefix" part="prefix" class="input__prefix"></slot>
            <input
              part="input"
              id="input"
              class="input__control"
              type=${this.type==="password"&&this.passwordVisible?"text":this.type}
              title=${this.title}
              name=${At(this.name)}
              ?disabled=${this.disabled}
              ?readonly=${this.readonly}
              ?required=${this.required}
              placeholder=${At(this.placeholder)}
              minlength=${At(this.minlength)}
              maxlength=${At(this.maxlength)}
              min=${At(this.min)}
              max=${At(this.max)}
              step=${At(this.step)}
              .value=${dee(this.value)}
              autocapitalize=${At(this.autocapitalize)}
              autocomplete=${At(this.autocomplete)}
              autocorrect=${At(this.autocorrect)}
              ?autofocus=${this.autofocus}
              spellcheck=${this.spellcheck}
              pattern=${At(this.pattern)}
              enterkeyhint=${At(this.enterkeyhint)}
              inputmode=${At(this.inputmode)}
              aria-describedby="help-text"
              @change=${this.handleChange}
              @input=${this.handleInput}
              @invalid=${this.handleInvalid}
              @keydown=${this.handleKeyDown}
              @focus=${this.handleFocus}
              @blur=${this.handleBlur}
            />

            ${i?de`
                    <button
                      part="clear-button"
                      class="input__clear"
                      type="button"
                      aria-label=${this.localize.term("clearEntry")}
                      @click=${this.handleClearClick}
                      tabindex="-1"
                    >
                      <slot name="clear-icon">
                        <sl-icon name="x-circle-fill" library="system"></sl-icon>
                      </slot>
                    </button>
                  `:""}
            ${this.passwordToggle&&!this.disabled?de`
                    <button
                      part="password-toggle-button"
                      class="input__password-toggle"
                      type="button"
                      aria-label=${this.localize.term(this.passwordVisible?"hidePassword":"showPassword")}
                      @click=${this.handlePasswordToggle}
                      tabindex="-1"
                    >
                      ${this.passwordVisible?de`
                            <slot name="show-password-icon">
                              <sl-icon name="eye-slash" library="system"></sl-icon>
                            </slot>
                          `:de`
                            <slot name="hide-password-icon">
                              <sl-icon name="eye" library="system"></sl-icon>
                            </slot>
                          `}
                    </button>
                  `:""}

            <slot name="suffix" part="suffix" class="input__suffix"></slot>
          </div>
        </div>

        <slot
          name="help-text"
          part="form-control-help-text"
          id="help-text"
          class="form-control__help-text"
          aria-hidden=${r?"false":"true"}
        >
          ${this.helpText}
        </slot>
        </div>
      </div>
    `}};Wt.styles=iQe;H([gt(".input__control")],Wt.prototype,"input",2);H([Ir()],Wt.prototype,"hasFocus",2);H([J()],Wt.prototype,"title",2);H([J({reflect:!0})],Wt.prototype,"type",2);H([J()],Wt.prototype,"name",2);H([J()],Wt.prototype,"value",2);H([e8()],Wt.prototype,"defaultValue",2);H([J({reflect:!0})],Wt.prototype,"size",2);H([J({type:Boolean,reflect:!0})],Wt.prototype,"filled",2);H([J({type:Boolean,reflect:!0})],Wt.prototype,"pill",2);H([J()],Wt.prototype,"label",2);H([J({attribute:"help-text"})],Wt.prototype,"helpText",2);H([J({type:Boolean})],Wt.prototype,"clearable",2);H([J({type:Boolean,reflect:!0})],Wt.prototype,"disabled",2);H([J()],Wt.prototype,"placeholder",2);H([J({type:Boolean,reflect:!0})],Wt.prototype,"readonly",2);H([J({attribute:"password-toggle",type:Boolean})],Wt.prototype,"passwordToggle",2);H([J({attribute:"password-visible",type:Boolean})],Wt.prototype,"passwordVisible",2);H([J({attribute:"no-spin-buttons",type:Boolean})],Wt.prototype,"noSpinButtons",2);H([J({reflect:!0})],Wt.prototype,"form",2);H([J({type:Boolean,reflect:!0})],Wt.prototype,"required",2);H([J()],Wt.prototype,"pattern",2);H([J({type:Number})],Wt.prototype,"minlength",2);H([J({type:Number})],Wt.prototype,"maxlength",2);H([J()],Wt.prototype,"min",2);H([J()],Wt.prototype,"max",2);H([J()],Wt.prototype,"step",2);H([J()],Wt.prototype,"autocapitalize",2);H([J()],Wt.prototype,"autocorrect",2);H([J()],Wt.prototype,"autocomplete",2);H([J({type:Boolean})],Wt.prototype,"autofocus",2);H([J()],Wt.prototype,"enterkeyhint",2);H([J({type:Boolean,converter:{fromAttribute:e=>!(!e||e==="false"),toAttribute:e=>e?"true":"false"}})],Wt.prototype,"spellcheck",2);H([J()],Wt.prototype,"inputmode",2);H([Jt("disabled",{waitUntilFirstUpdate:!0})],Wt.prototype,"handleDisabledChange",1);H([Jt("step",{waitUntilFirstUpdate:!0})],Wt.prototype,"handleStepChange",1);H([Jt("value",{waitUntilFirstUpdate:!0})],Wt.prototype,"handleValueChange",1);Wt=H([Ue("sl-input")],Wt);var sQe=Qt`
  ${Nr}

  :host {
    display: block;
    user-select: none;
  }

  :host(:focus) {
    outline: none;
  }

  .option {
    position: relative;
    display: flex;
    align-items: center;
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-medium);
    font-weight: var(--sl-font-weight-normal);
    line-height: var(--sl-line-height-normal);
    letter-spacing: var(--sl-letter-spacing-normal);
    color: var(--sl-color-neutral-700);
    padding: var(--sl-spacing-x-small) var(--sl-spacing-medium) var(--sl-spacing-x-small) var(--sl-spacing-x-small);
    transition: var(--sl-transition-fast) fill;
    cursor: pointer;
  }

  .option--hover:not(.option--current):not(.option--disabled) {
    background-color: var(--sl-color-neutral-100);
    color: var(--sl-color-neutral-1000);
  }

  .option--current,
  .option--current.option--disabled {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
    opacity: 1;
  }

  .option--disabled {
    outline: none;
    opacity: 0.5;
    cursor: not-allowed;
  }

  .option__label {
    flex: 1 1 auto;
    display: inline-block;
    line-height: var(--sl-line-height-dense);
  }

  .option .option__check {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    visibility: hidden;
    padding-inline-end: var(--sl-spacing-2x-small);
  }

  .option--selected .option__check {
    visibility: visible;
  }

  .option__prefix,
  .option__suffix {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
  }

  .option__prefix::slotted(*) {
    margin-inline-end: var(--sl-spacing-x-small);
  }

  .option__suffix::slotted(*) {
    margin-inline-start: var(--sl-spacing-x-small);
  }

  @media (forced-colors: active) {
    :host(:hover:not([aria-disabled='true'])) .option {
      outline: dashed 1px SelectedItem;
      outline-offset: -1px;
    }
  }
`;let Nu=class extends nr{constructor(){super(...arguments),this.localize=new Co(this),this.current=!1,this.selected=!1,this.hasHover=!1,this.value="",this.disabled=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","option"),this.setAttribute("aria-selected","false")}handleDefaultSlotChange(){const e=this.getTextLabel();if(typeof this.cachedTextLabel>"u"){this.cachedTextLabel=e;return}e!==this.cachedTextLabel&&(this.cachedTextLabel=e,this.emit("slotchange",{bubbles:!0,composed:!1,cancelable:!1}))}handleMouseEnter(){this.hasHover=!0}handleMouseLeave(){this.hasHover=!1}handleDisabledChange(){this.setAttribute("aria-disabled",this.disabled?"true":"false")}handleSelectedChange(){this.setAttribute("aria-selected",this.selected?"true":"false")}handleValueChange(){typeof this.value!="string"&&(this.value=String(this.value)),this.value.includes(" ")&&(console.error("Option values cannot include a space. All spaces have been replaced with underscores.",this),this.value=this.value.replace(/ /g,"_"))}getTextLabel(){var e;return((e=this.textContent)!=null?e:"").trim()}render(){return de`
      <div
        part="base"
        class=${Ar({option:!0,"option--current":this.current,"option--disabled":this.disabled,"option--selected":this.selected,"option--hover":this.hasHover})}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
      >
        <sl-icon part="checked-icon" class="option__check" name="check" library="system" aria-hidden="true"></sl-icon>
        <slot part="prefix" name="prefix" class="option__prefix"></slot>
        <slot part="label" class="option__label" @slotchange=${this.handleDefaultSlotChange}></slot>
        <slot part="suffix" name="suffix" class="option__suffix"></slot>
      </div>
    `}};Nu.styles=sQe;H([gt(".option__label")],Nu.prototype,"defaultSlot",2);H([Ir()],Nu.prototype,"current",2);H([Ir()],Nu.prototype,"selected",2);H([Ir()],Nu.prototype,"hasHover",2);H([J({reflect:!0})],Nu.prototype,"value",2);H([J({type:Boolean,reflect:!0})],Nu.prototype,"disabled",2);H([Jt("disabled")],Nu.prototype,"handleDisabledChange",1);H([Jt("selected")],Nu.prototype,"handleSelectedChange",1);H([Jt("value")],Nu.prototype,"handleValueChange",1);Nu=H([Ue("sl-option")],Nu);var aQe=Qt`
  ${tke}

  .button__prefix,
  .button__suffix,
  .button__label {
    display: inline-flex;
    position: relative;
    align-items: center;
  }

  /* We use a hidden input so constraint validation errors work, since they don't appear to show when used with buttons.
    We can't actually hide it, though, otherwise the messages will be suppressed by the browser. */
  .hidden-input {
    all: unset;
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    outline: dotted 1px red;
    opacity: 0;
    z-index: -1;
  }
`;let Mu=class extends nr{constructor(){super(...arguments),this.hasSlotController=new td(this,"[default]","prefix","suffix"),this.hasFocus=!1,this.checked=!1,this.disabled=!1,this.size="medium",this.pill=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","presentation")}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleClick(e){if(this.disabled){e.preventDefault(),e.stopPropagation();return}this.checked=!0}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleDisabledChange(){this.setAttribute("aria-disabled",this.disabled?"true":"false")}focus(e){this.input.focus(e)}blur(){this.input.blur()}render(){return QE`
      <div part="base" role="presentation">
        <button
          part="${`button${this.checked?" button--checked":""}`}"
          role="radio"
          aria-checked="${this.checked}"
          class=${Ar({button:!0,"button--default":!0,"button--small":this.size==="small","button--medium":this.size==="medium","button--large":this.size==="large","button--checked":this.checked,"button--disabled":this.disabled,"button--focused":this.hasFocus,"button--outline":!0,"button--pill":this.pill,"button--has-label":this.hasSlotController.test("[default]"),"button--has-prefix":this.hasSlotController.test("prefix"),"button--has-suffix":this.hasSlotController.test("suffix")})}
          aria-disabled=${this.disabled}
          type="button"
          value=${At(this.value)}
          tabindex="${this.checked?"0":"-1"}"
          @blur=${this.handleBlur}
          @focus=${this.handleFocus}
          @click=${this.handleClick}
        >
          <slot name="prefix" part="prefix" class="button__prefix"></slot>
          <slot part="label" class="button__label"></slot>
          <slot name="suffix" part="suffix" class="button__suffix"></slot>
        </button>
      </div>
    `}};Mu.styles=aQe;H([gt(".button")],Mu.prototype,"input",2);H([gt(".hidden-input")],Mu.prototype,"hiddenInput",2);H([Ir()],Mu.prototype,"hasFocus",2);H([J({type:Boolean,reflect:!0})],Mu.prototype,"checked",2);H([J()],Mu.prototype,"value",2);H([J({type:Boolean,reflect:!0})],Mu.prototype,"disabled",2);H([J({reflect:!0})],Mu.prototype,"size",2);H([J({type:Boolean,reflect:!0})],Mu.prototype,"pill",2);H([Jt("disabled",{waitUntilFirstUpdate:!0})],Mu.prototype,"handleDisabledChange",1);Mu=H([Ue("sl-radio-button")],Mu);var oQe=Qt`
  ${Nr}

  :host {
    display: inline-block;
  }

  .button-group {
    display: flex;
    flex-wrap: nowrap;
  }
`;let Cw=class extends nr{constructor(){super(...arguments),this.disableRole=!1,this.label=""}handleFocus(e){const t=US(e.target);t==null||t.classList.add("sl-button-group__button--focus")}handleBlur(e){const t=US(e.target);t==null||t.classList.remove("sl-button-group__button--focus")}handleMouseOver(e){const t=US(e.target);t==null||t.classList.add("sl-button-group__button--hover")}handleMouseOut(e){const t=US(e.target);t==null||t.classList.remove("sl-button-group__button--hover")}handleSlotChange(){const e=[...this.defaultSlot.assignedElements({flatten:!0})];e.forEach(t=>{const n=e.indexOf(t),r=US(t);r!==null&&(r.classList.add("sl-button-group__button"),r.classList.toggle("sl-button-group__button--first",n===0),r.classList.toggle("sl-button-group__button--inner",n>0&&n<e.length-1),r.classList.toggle("sl-button-group__button--last",n===e.length-1),r.classList.toggle("sl-button-group__button--radio",r.tagName.toLowerCase()==="sl-radio-button"))})}render(){return de`
      <slot
        part="base"
        class="button-group"
        role="${this.disableRole?"presentation":"group"}"
        aria-label=${this.label}
        @focusout=${this.handleBlur}
        @focusin=${this.handleFocus}
        @mouseover=${this.handleMouseOver}
        @mouseout=${this.handleMouseOut}
        @slotchange=${this.handleSlotChange}
      ></slot>
    `}};Cw.styles=oQe;H([gt("slot")],Cw.prototype,"defaultSlot",2);H([Ir()],Cw.prototype,"disableRole",2);H([J()],Cw.prototype,"label",2);Cw=H([Ue("sl-button-group")],Cw);function US(e){var t;const n="sl-button, sl-radio-button";return(t=e.closest(n))!=null?t:e.querySelector(n)}var lQe=Qt`
  ${Nr}
  ${t8}

  :host {
    display: block;
  }

  .form-control {
    position: relative;
    border: none;
    padding: 0;
    margin: 0;
  }

  .form-control__label {
    padding: 0;
  }

  .radio-group--required .radio-group__label::after {
    content: var(--sl-input-required-content);
    margin-inline-start: var(--sl-input-required-content-offset);
  }

  .visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
`;let Vs=class extends nr{constructor(){super(...arguments),this.formControlController=new hC(this),this.hasSlotController=new td(this,"help-text","label"),this.customValidityMessage="",this.hasButtonGroup=!1,this.errorMessage="",this.defaultValue="",this.label="",this.helpText="",this.name="option",this.value="",this.size="medium",this.form="",this.required=!1}get validity(){const e=this.required&&!this.value;return this.customValidityMessage!==""?KZe:e?XZe:JB}get validationMessage(){const e=this.required&&!this.value;return this.customValidityMessage!==""?this.customValidityMessage:e?this.validationInput.validationMessage:""}connectedCallback(){super.connectedCallback(),this.defaultValue=this.value}firstUpdated(){this.formControlController.updateValidity()}getAllRadios(){return[...this.querySelectorAll("sl-radio, sl-radio-button")]}handleRadioClick(e){const t=e.target.closest("sl-radio, sl-radio-button"),n=this.getAllRadios(),r=this.value;t.disabled||(this.value=t.value,n.forEach(i=>i.checked=i===t),this.value!==r&&(this.emit("sl-change"),this.emit("sl-input")))}handleKeyDown(e){var t;if(!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," "].includes(e.key))return;const n=this.getAllRadios().filter(o=>!o.disabled),r=(t=n.find(o=>o.checked))!=null?t:n[0],i=e.key===" "?0:["ArrowUp","ArrowLeft"].includes(e.key)?-1:1,s=this.value;let a=n.indexOf(r)+i;a<0&&(a=n.length-1),a>n.length-1&&(a=0),this.getAllRadios().forEach(o=>{o.checked=!1,this.hasButtonGroup||(o.tabIndex=-1)}),this.value=n[a].value,n[a].checked=!0,this.hasButtonGroup?n[a].shadowRoot.querySelector("button").focus():(n[a].tabIndex=0,n[a].focus()),this.value!==s&&(this.emit("sl-change"),this.emit("sl-input")),e.preventDefault()}handleLabelClick(){const e=this.getAllRadios(),n=e.find(r=>r.checked)||e[0];n&&n.focus()}handleInvalid(e){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(e)}async syncRadioElements(){var e,t;const n=this.getAllRadios();if(await Promise.all(n.map(async r=>{await r.updateComplete,r.checked=r.value===this.value,r.size=this.size})),this.hasButtonGroup=n.some(r=>r.tagName.toLowerCase()==="sl-radio-button"),!n.some(r=>r.checked))if(this.hasButtonGroup){const r=(e=n[0].shadowRoot)==null?void 0:e.querySelector("button");r&&(r.tabIndex=0)}else n[0].tabIndex=0;if(this.hasButtonGroup){const r=(t=this.shadowRoot)==null?void 0:t.querySelector("sl-button-group");r&&(r.disableRole=!0)}}syncRadios(){if(customElements.get("sl-radio")&&customElements.get("sl-radio-button")){this.syncRadioElements();return}customElements.get("sl-radio")?this.syncRadioElements():customElements.whenDefined("sl-radio").then(()=>this.syncRadios()),customElements.get("sl-radio-button")?this.syncRadioElements():customElements.whenDefined("sl-radio-button").then(()=>this.syncRadios())}updateCheckedRadio(){this.getAllRadios().forEach(t=>t.checked=t.value===this.value),this.formControlController.setValidity(this.validity.valid)}handleSizeChange(){this.syncRadios()}handleValueChange(){this.hasUpdated&&this.updateCheckedRadio()}checkValidity(){const e=this.required&&!this.value,t=this.customValidityMessage!=="";return e||t?(this.formControlController.emitInvalidEvent(),!1):!0}getForm(){return this.formControlController.getForm()}reportValidity(){const e=this.validity.valid;return this.errorMessage=this.customValidityMessage||e?"":this.validationInput.validationMessage,this.formControlController.setValidity(e),this.validationInput.hidden=!0,clearTimeout(this.validationTimeout),e||(this.validationInput.hidden=!1,this.validationInput.reportValidity(),this.validationTimeout=setTimeout(()=>this.validationInput.hidden=!0,1e4)),e}setCustomValidity(e=""){this.customValidityMessage=e,this.errorMessage=e,this.validationInput.setCustomValidity(e),this.formControlController.updateValidity()}render(){const e=this.hasSlotController.test("label"),t=this.hasSlotController.test("help-text"),n=this.label?!0:!!e,r=this.helpText?!0:!!t,i=de`
      <slot
        @click=${this.handleRadioClick}
        @keydown=${this.handleKeyDown}
        @slotchange=${this.syncRadios}
        role="presentation"
      ></slot>
    `;return de`
      <fieldset
        part="form-control"
        class=${Ar({"form-control":!0,"form-control--small":this.size==="small","form-control--medium":this.size==="medium","form-control--large":this.size==="large","form-control--radio-group":!0,"form-control--has-label":n,"form-control--has-help-text":r})}
        role="radiogroup"
        aria-labelledby="label"
        aria-describedby="help-text"
        aria-errormessage="error-message"
      >
        <label
          part="form-control-label"
          id="label"
          class="form-control__label"
          aria-hidden=${n?"false":"true"}
          @click=${this.handleLabelClick}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <div class="visually-hidden">
            <div id="error-message" aria-live="assertive">${this.errorMessage}</div>
            <label class="radio-group__validation">
              <input
                type="text"
                class="radio-group__validation-input"
                ?required=${this.required}
                tabindex="-1"
                hidden
                @invalid=${this.handleInvalid}
              />
            </label>
          </div>

          ${this.hasButtonGroup?de`
                <sl-button-group part="button-group" exportparts="base:button-group__base">
                  ${i}
                </sl-button-group>
              `:i}
        </div>

        <slot
          name="help-text"
          part="form-control-help-text"
          id="help-text"
          class="form-control__help-text"
          aria-hidden=${r?"false":"true"}
        >
          ${this.helpText}
        </slot>
      </fieldset>
    `}};Vs.styles=lQe;H([gt("slot:not([name])")],Vs.prototype,"defaultSlot",2);H([gt(".radio-group__validation-input")],Vs.prototype,"validationInput",2);H([Ir()],Vs.prototype,"hasButtonGroup",2);H([Ir()],Vs.prototype,"errorMessage",2);H([Ir()],Vs.prototype,"defaultValue",2);H([J()],Vs.prototype,"label",2);H([J({attribute:"help-text"})],Vs.prototype,"helpText",2);H([J()],Vs.prototype,"name",2);H([J({reflect:!0})],Vs.prototype,"value",2);H([J({reflect:!0})],Vs.prototype,"size",2);H([J({reflect:!0})],Vs.prototype,"form",2);H([J({type:Boolean,reflect:!0})],Vs.prototype,"required",2);H([Jt("size",{waitUntilFirstUpdate:!0})],Vs.prototype,"handleSizeChange",1);H([Jt("value")],Vs.prototype,"handleValueChange",1);Vs=H([Ue("sl-radio-group")],Vs);var uQe=Qt`
  ${Nr}
  ${t8}

  :host {
    --thumb-size: 20px;
    --tooltip-offset: 10px;
    --track-color-active: var(--sl-color-neutral-200);
    --track-color-inactive: var(--sl-color-neutral-200);
    --track-active-offset: 0%;
    --track-height: 6px;

    display: block;
  }

  .range {
    position: relative;
  }

  .range__control {
    --percent: 0%;
    -webkit-appearance: none;
    border-radius: 3px;
    width: 100%;
    height: var(--track-height);
    background: transparent;
    line-height: var(--sl-input-height-medium);
    vertical-align: middle;
    margin: 0;

    background-image: linear-gradient(
      to right,
      var(--track-color-inactive) 0%,
      var(--track-color-inactive) min(var(--percent), var(--track-active-offset)),
      var(--track-color-active) min(var(--percent), var(--track-active-offset)),
      var(--track-color-active) max(var(--percent), var(--track-active-offset)),
      var(--track-color-inactive) max(var(--percent), var(--track-active-offset)),
      var(--track-color-inactive) 100%
    );
  }

  .range--rtl .range__control {
    background-image: linear-gradient(
      to left,
      var(--track-color-inactive) 0%,
      var(--track-color-inactive) min(var(--percent), var(--track-active-offset)),
      var(--track-color-active) min(var(--percent), var(--track-active-offset)),
      var(--track-color-active) max(var(--percent), var(--track-active-offset)),
      var(--track-color-inactive) max(var(--percent), var(--track-active-offset)),
      var(--track-color-inactive) 100%
    );
  }

  /* Webkit */
  .range__control::-webkit-slider-runnable-track {
    width: 100%;
    height: var(--track-height);
    border-radius: 3px;
    border: none;
  }

  .range__control::-webkit-slider-thumb {
    border: none;
    width: var(--thumb-size);
    height: var(--thumb-size);
    border-radius: 50%;
    background-color: var(--sl-color-primary-600);
    border: solid var(--sl-input-border-width) var(--sl-color-primary-600);
    -webkit-appearance: none;
    margin-top: calc(var(--thumb-size) / -2 + var(--track-height) / 2);
    cursor: pointer;
  }

  .range__control:enabled::-webkit-slider-thumb:hover {
    background-color: var(--sl-color-primary-500);
    border-color: var(--sl-color-primary-500);
  }

  .range__control:enabled:focus-visible::-webkit-slider-thumb {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .range__control:enabled::-webkit-slider-thumb:active {
    background-color: var(--sl-color-primary-500);
    border-color: var(--sl-color-primary-500);
    cursor: grabbing;
  }

  /* Firefox */
  .range__control::-moz-focus-outer {
    border: 0;
  }

  .range__control::-moz-range-progress {
    background-color: var(--track-color-active);
    border-radius: 3px;
    height: var(--track-height);
  }

  .range__control::-moz-range-track {
    width: 100%;
    height: var(--track-height);
    background-color: var(--track-color-inactive);
    border-radius: 3px;
    border: none;
  }

  .range__control::-moz-range-thumb {
    border: none;
    height: var(--thumb-size);
    width: var(--thumb-size);
    border-radius: 50%;
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
    transition: var(--sl-transition-fast) border-color, var(--sl-transition-fast) background-color,
      var(--sl-transition-fast) color, var(--sl-transition-fast) box-shadow;
    cursor: pointer;
  }

  .range__control:enabled::-moz-range-thumb:hover {
    background-color: var(--sl-color-primary-500);
    border-color: var(--sl-color-primary-500);
  }

  .range__control:enabled:focus-visible::-moz-range-thumb {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .range__control:enabled::-moz-range-thumb:active {
    background-color: var(--sl-color-primary-500);
    border-color: var(--sl-color-primary-500);
    cursor: grabbing;
  }

  /* States */
  .range__control:focus-visible {
    outline: none;
  }

  .range__control:disabled {
    opacity: 0.5;
  }

  .range__control:disabled::-webkit-slider-thumb {
    cursor: not-allowed;
  }

  .range__control:disabled::-moz-range-thumb {
    cursor: not-allowed;
  }

  /* Tooltip output */
  .range__tooltip {
    position: absolute;
    z-index: var(--sl-z-index-tooltip);
    left: 0;
    border-radius: var(--sl-tooltip-border-radius);
    background-color: var(--sl-tooltip-background-color);
    font-family: var(--sl-tooltip-font-family);
    font-size: var(--sl-tooltip-font-size);
    font-weight: var(--sl-tooltip-font-weight);
    line-height: var(--sl-tooltip-line-height);
    color: var(--sl-tooltip-color);
    opacity: 0;
    padding: var(--sl-tooltip-padding);
    transition: var(--sl-transition-fast) opacity;
    pointer-events: none;
  }

  .range__tooltip:after {
    content: '';
    position: absolute;
    width: 0;
    height: 0;
    left: 50%;
    translate: calc(-1 * var(--sl-tooltip-arrow-size));
  }

  .range--tooltip-visible .range__tooltip {
    opacity: 1;
  }

  /* Tooltip on top */
  .range--tooltip-top .range__tooltip {
    top: calc(-1 * var(--thumb-size) - var(--tooltip-offset));
  }

  .range--tooltip-top .range__tooltip:after {
    border-top: var(--sl-tooltip-arrow-size) solid var(--sl-tooltip-background-color);
    border-left: var(--sl-tooltip-arrow-size) solid transparent;
    border-right: var(--sl-tooltip-arrow-size) solid transparent;
    top: 100%;
  }

  /* Tooltip on bottom */
  .range--tooltip-bottom .range__tooltip {
    bottom: calc(-1 * var(--thumb-size) - var(--tooltip-offset));
  }

  .range--tooltip-bottom .range__tooltip:after {
    border-bottom: var(--sl-tooltip-arrow-size) solid var(--sl-tooltip-background-color);
    border-left: var(--sl-tooltip-arrow-size) solid transparent;
    border-right: var(--sl-tooltip-arrow-size) solid transparent;
    bottom: 100%;
  }

  @media (forced-colors: active) {
    .range__control,
    .range__tooltip {
      border: solid 1px transparent;
    }

    .range__control::-webkit-slider-thumb {
      border: solid 1px transparent;
    }

    .range__control::-moz-range-thumb {
      border: solid 1px transparent;
    }

    .range__tooltip:after {
      display: none;
    }
  }
`;let Tr=class extends nr{constructor(){super(...arguments),this.formControlController=new hC(this),this.hasSlotController=new td(this,"help-text","label"),this.localize=new Co(this),this.hasFocus=!1,this.hasTooltip=!1,this.title="",this.name="",this.value=0,this.label="",this.helpText="",this.disabled=!1,this.min=0,this.max=100,this.step=1,this.tooltip="top",this.tooltipFormatter=e=>e.toString(),this.form="",this.defaultValue=0}get validity(){return this.input.validity}get validationMessage(){return this.input.validationMessage}connectedCallback(){super.connectedCallback(),this.resizeObserver=new ResizeObserver(()=>this.syncRange()),this.value<this.min&&(this.value=this.min),this.value>this.max&&(this.value=this.max),this.updateComplete.then(()=>{this.syncRange(),this.resizeObserver.observe(this.input)})}disconnectedCallback(){super.disconnectedCallback(),this.resizeObserver.unobserve(this.input)}handleChange(){this.emit("sl-change")}handleInput(){this.value=parseFloat(this.input.value),this.emit("sl-input"),this.syncRange()}handleBlur(){this.hasFocus=!1,this.hasTooltip=!1,this.emit("sl-blur")}handleFocus(){this.hasFocus=!0,this.hasTooltip=!0,this.emit("sl-focus")}handleThumbDragStart(){this.hasTooltip=!0}handleThumbDragEnd(){this.hasTooltip=!1}syncProgress(e){this.input.style.setProperty("--percent",`${e*100}%`)}syncTooltip(e){if(this.output!==null){const t=this.input.offsetWidth,n=this.output.offsetWidth,r=getComputedStyle(this.input).getPropertyValue("--thumb-size"),i=this.localize.dir()==="rtl",s=t*e;if(i){const a=`${t-s}px + ${e} * ${r}`;this.output.style.translate=`calc((${a} - ${n/2}px - ${r} / 2))`}else{const a=`${s}px - ${e} * ${r}`;this.output.style.translate=`calc(${a} - ${n/2}px + ${r} / 2)`}}}handleValueChange(){this.formControlController.updateValidity(),this.input.value=this.value.toString(),this.value=parseFloat(this.input.value),this.syncRange()}handleDisabledChange(){this.formControlController.setValidity(this.disabled)}syncRange(){const e=Math.max(0,(this.value-this.min)/(this.max-this.min));this.syncProgress(e),this.tooltip!=="none"&&this.syncTooltip(e)}handleInvalid(e){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(e)}focus(e){this.input.focus(e)}blur(){this.input.blur()}stepUp(){this.input.stepUp(),this.value!==Number(this.input.value)&&(this.value=Number(this.input.value))}stepDown(){this.input.stepDown(),this.value!==Number(this.input.value)&&(this.value=Number(this.input.value))}checkValidity(){return this.input.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.input.reportValidity()}setCustomValidity(e){this.input.setCustomValidity(e),this.formControlController.updateValidity()}render(){const e=this.hasSlotController.test("label"),t=this.hasSlotController.test("help-text"),n=this.label?!0:!!e,r=this.helpText?!0:!!t;return de`
      <div
        part="form-control"
        class=${Ar({"form-control":!0,"form-control--medium":!0,"form-control--has-label":n,"form-control--has-help-text":r})}
      >
        <label
          part="form-control-label"
          class="form-control__label"
          for="input"
          aria-hidden=${n?"false":"true"}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <div
            part="base"
            class=${Ar({range:!0,"range--disabled":this.disabled,"range--focused":this.hasFocus,"range--rtl":this.localize.dir()==="rtl","range--tooltip-visible":this.hasTooltip,"range--tooltip-top":this.tooltip==="top","range--tooltip-bottom":this.tooltip==="bottom"})}
            @mousedown=${this.handleThumbDragStart}
            @mouseup=${this.handleThumbDragEnd}
            @touchstart=${this.handleThumbDragStart}
            @touchend=${this.handleThumbDragEnd}
          >
            <input
              part="input"
              id="input"
              class="range__control"
              title=${this.title}
              type="range"
              name=${At(this.name)}
              ?disabled=${this.disabled}
              min=${At(this.min)}
              max=${At(this.max)}
              step=${At(this.step)}
              .value=${dee(this.value.toString())}
              aria-describedby="help-text"
              @change=${this.handleChange}
              @focus=${this.handleFocus}
              @input=${this.handleInput}
              @invalid=${this.handleInvalid}
              @blur=${this.handleBlur}
            />
            ${this.tooltip!=="none"&&!this.disabled?de`
                  <output part="tooltip" class="range__tooltip">
                    ${typeof this.tooltipFormatter=="function"?this.tooltipFormatter(this.value):this.value}
                  </output>
                `:""}
          </div>
        </div>

        <slot
          name="help-text"
          part="form-control-help-text"
          id="help-text"
          class="form-control__help-text"
          aria-hidden=${r?"false":"true"}
        >
          ${this.helpText}
        </slot>
      </div>
    `}};Tr.styles=uQe;H([gt(".range__control")],Tr.prototype,"input",2);H([gt(".range__tooltip")],Tr.prototype,"output",2);H([Ir()],Tr.prototype,"hasFocus",2);H([Ir()],Tr.prototype,"hasTooltip",2);H([J()],Tr.prototype,"title",2);H([J()],Tr.prototype,"name",2);H([J({type:Number})],Tr.prototype,"value",2);H([J()],Tr.prototype,"label",2);H([J({attribute:"help-text"})],Tr.prototype,"helpText",2);H([J({type:Boolean,reflect:!0})],Tr.prototype,"disabled",2);H([J({type:Number})],Tr.prototype,"min",2);H([J({type:Number})],Tr.prototype,"max",2);H([J({type:Number})],Tr.prototype,"step",2);H([J()],Tr.prototype,"tooltip",2);H([J({attribute:!1})],Tr.prototype,"tooltipFormatter",2);H([J({reflect:!0})],Tr.prototype,"form",2);H([e8()],Tr.prototype,"defaultValue",2);H([uZe({passive:!0})],Tr.prototype,"handleThumbDragStart",1);H([Jt("value",{waitUntilFirstUpdate:!0})],Tr.prototype,"handleValueChange",1);H([Jt("disabled",{waitUntilFirstUpdate:!0})],Tr.prototype,"handleDisabledChange",1);H([Jt("hasTooltip",{waitUntilFirstUpdate:!0})],Tr.prototype,"syncRange",1);Tr=H([Ue("sl-range")],Tr);function dC(e){return e.split("-")[1]}function pee(e){return e==="y"?"height":"width"}function A0(e){return e.split("-")[0]}function pC(e){return["top","bottom"].includes(A0(e))?"x":"y"}function Dde(e,t,n){let{reference:r,floating:i}=e;const s=r.x+r.width/2-i.width/2,a=r.y+r.height/2-i.height/2,o=pC(t),l=pee(o),u=r[l]/2-i[l]/2,c=A0(t),f=o==="x";let h;switch(c){case"top":h={x:s,y:r.y-i.height};break;case"bottom":h={x:s,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:a};break;case"left":h={x:r.x-i.width,y:a};break;default:h={x:r.x,y:r.y}}switch(dC(t)){case"start":h[o]-=u*(n&&f?-1:1);break;case"end":h[o]+=u*(n&&f?-1:1);break}return h}const cQe=async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:a}=n,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let u=await a.getElementRects({reference:e,floating:t,strategy:i}),{x:c,y:f}=Dde(u,r,l),h=r,d={},p=0;for(let g=0;g<o.length;g++){const{name:m,fn:v}=o[g],{x:y,y:b,data:x,reset:w}=await v({x:c,y:f,initialPlacement:r,placement:h,strategy:i,middlewareData:d,rects:u,platform:a,elements:{reference:e,floating:t}});if(c=y!=null?y:c,f=b!=null?b:f,d={...d,[m]:{...d[m],...x}},w&&p<=50){p++,typeof w=="object"&&(w.placement&&(h=w.placement),w.rects&&(u=w.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:i}):w.rects),{x:c,y:f}=Dde(u,h,l)),g=-1;continue}}return{x:c,y:f,placement:h,strategy:i,middlewareData:d}};function gC(e,t){return typeof e=="function"?e(t):e}function fQe(e){return{top:0,right:0,bottom:0,left:0,...e}}function rke(e){return typeof e!="number"?fQe(e):{top:e,right:e,bottom:e,left:e}}function t5(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function gee(e,t){var n;t===void 0&&(t={});const{x:r,y:i,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:f="floating",altBoundary:h=!1,padding:d=0}=gC(t,e),p=rke(d),m=o[h?f==="floating"?"reference":"floating":f],v=t5(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(m)))==null||n?m:m.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:u,rootBoundary:c,strategy:l})),y=f==="floating"?{...a.floating,x:r,y:i}:a.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),x=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},w=t5(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:y,offsetParent:b,strategy:l}):y);return{top:(v.top-w.top+p.top)/x.y,bottom:(w.bottom-v.bottom+p.bottom)/x.y,left:(v.left-w.left+p.left)/x.x,right:(w.right-v.right+p.right)/x.x}}const XA=Math.min,Vv=Math.max;function eY(e,t,n){return Vv(e,XA(t,n))}const hQe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:i,rects:s,platform:a,elements:o}=t,{element:l,padding:u=0}=gC(e,t)||{};if(l==null)return{};const c=rke(u),f={x:n,y:r},h=pC(i),d=pee(h),p=await a.getDimensions(l),g=h==="y",m=g?"top":"left",v=g?"bottom":"right",y=g?"clientHeight":"clientWidth",b=s.reference[d]+s.reference[h]-f[h]-s.floating[d],x=f[h]-s.reference[h],w=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l));let C=w?w[y]:0;(!C||!await(a.isElement==null?void 0:a.isElement(w)))&&(C=o.floating[y]||s.floating[d]);const $=b/2-x/2,_=C/2-p[d]/2-1,k=XA(c[m],_),E=XA(c[v],_),S=k,I=C-p[d]-E,A=C/2-p[d]/2+$,D=eY(S,A,I),N=dC(i)!=null&&A!=D&&s.reference[d]/2-(A<S?k:E)-p[d]/2<0?A<S?S-A:I-A:0;return{[h]:f[h]-N,data:{[h]:D,centerOffset:A-D+N}}}}),dQe={left:"right",right:"left",bottom:"top",top:"bottom"};function n5(e){return e.replace(/left|right|bottom|top/g,t=>dQe[t])}function pQe(e,t,n){n===void 0&&(n=!1);const r=dC(e),i=pC(e),s=pee(i);let a=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=n5(a)),{main:a,cross:n5(a)}}const gQe={start:"end",end:"start"};function tY(e){return e.replace(/start|end/g,t=>gQe[t])}function mQe(e){const t=n5(e);return[tY(e),t,tY(t)]}function vQe(e,t,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?s:a;default:return[]}}function yQe(e,t,n,r){const i=dC(e);let s=vQe(A0(e),n==="start",r);return i&&(s=s.map(a=>a+"-"+i),t&&(s=s.concat(s.map(tY)))),s}const bQe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n;const{placement:r,middlewareData:i,rects:s,initialPlacement:a,platform:o,elements:l}=t,{mainAxis:u=!0,crossAxis:c=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:d="none",flipAlignment:p=!0,...g}=gC(e,t),m=A0(r),v=A0(a)===a,y=await(o.isRTL==null?void 0:o.isRTL(l.floating)),b=f||(v||!p?[n5(a)]:mQe(a));!f&&d!=="none"&&b.push(...yQe(a,p,d,y));const x=[a,...b],w=await gee(t,g),C=[];let $=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&C.push(w[m]),c){const{main:S,cross:I}=pQe(r,s,y);C.push(w[S],w[I])}if($=[...$,{placement:r,overflows:C}],!C.every(S=>S<=0)){var _,k;const S=(((_=i.flip)==null?void 0:_.index)||0)+1,I=x[S];if(I)return{data:{index:S,overflows:$},reset:{placement:I}};let A=(k=$.filter(D=>D.overflows[0]<=0).sort((D,T)=>D.overflows[1]-T.overflows[1])[0])==null?void 0:k.placement;if(!A)switch(h){case"bestFit":{var E;const D=(E=$.map(T=>[T.placement,T.overflows.filter(N=>N>0).reduce((N,F)=>N+F,0)]).sort((T,N)=>T[1]-N[1])[0])==null?void 0:E[0];D&&(A=D);break}case"initialPlacement":A=a;break}if(r!==A)return{reset:{placement:A}}}return{}}}};async function xQe(e,t){const{placement:n,platform:r,elements:i}=e,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=A0(n),o=dC(n),l=pC(n)==="x",u=["left","top"].includes(a)?-1:1,c=s&&l?-1:1,f=gC(t,e);let{mainAxis:h,crossAxis:d,alignmentAxis:p}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...f};return o&&typeof p=="number"&&(d=o==="end"?p*-1:p),l?{x:d*c,y:h*u}:{x:h*u,y:d*c}}const wQe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){const{x:n,y:r}=t,i=await xQe(t,e);return{x:n+i.x,y:r+i.y,data:i}}}};function $Qe(e){return e==="x"?"y":"x"}const CQe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:m=>{let{x:v,y}=m;return{x:v,y}}},...l}=gC(e,t),u={x:n,y:r},c=await gee(t,l),f=pC(A0(i)),h=$Qe(f);let d=u[f],p=u[h];if(s){const m=f==="y"?"top":"left",v=f==="y"?"bottom":"right",y=d+c[m],b=d-c[v];d=eY(y,d,b)}if(a){const m=h==="y"?"top":"left",v=h==="y"?"bottom":"right",y=p+c[m],b=p-c[v];p=eY(y,p,b)}const g=o.fn({...t,[f]:d,[h]:p});return{...g,data:{x:g.x-n,y:g.y-r}}}}},Ide=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:i,elements:s}=t,{apply:a=()=>{},...o}=gC(e,t),l=await gee(t,o),u=A0(n),c=dC(n),h=pC(n)==="x",{width:d,height:p}=r.floating;let g,m;u==="top"||u==="bottom"?(g=u,m=c===(await(i.isRTL==null?void 0:i.isRTL(s.floating))?"start":"end")?"left":"right"):(m=u,g=c==="end"?"top":"bottom");const v=p-l[g],y=d-l[m],b=!t.middlewareData.shift;let x=v,w=y;if(h){const $=d-l.left-l.right;w=c||b?XA(y,$):$}else{const $=p-l.top-l.bottom;x=c||b?XA(v,$):$}if(b&&!c){const $=Vv(l.left,0),_=Vv(l.right,0),k=Vv(l.top,0),E=Vv(l.bottom,0);h?w=d-2*($!==0||_!==0?$+_:Vv(l.left,l.right)):x=p-2*(k!==0||E!==0?k+E:Vv(l.top,l.bottom))}await a({...t,availableWidth:w,availableHeight:x});const C=await i.getDimensions(s.floating);return d!==C.width||p!==C.height?{reset:{rects:!0}}:{}}}};function Ol(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Sh(e){return Ol(e).getComputedStyle(e)}function ike(e){return e instanceof Ol(e).Node}function T0(e){return ike(e)?(e.nodeName||"").toLowerCase():"#document"}function Yc(e){return e instanceof Ol(e).HTMLElement}function Nde(e){return typeof ShadowRoot>"u"?!1:e instanceof Ol(e).ShadowRoot||e instanceof ShadowRoot}function tI(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=Sh(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function _Qe(e){return["table","td","th"].includes(T0(e))}function mee(e){const t=vee(),n=Sh(e);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function vee(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function n8(e){return["html","body","#document"].includes(T0(e))}const nY=Math.min,z2=Math.max,r5=Math.round,BF=Math.floor,D0=e=>({x:e,y:e});function ske(e){const t=Sh(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=Yc(e),s=i?e.offsetWidth:n,a=i?e.offsetHeight:r,o=r5(n)!==s||r5(r)!==a;return o&&(n=s,r=a),{width:n,height:r,$:o}}function Ep(e){return e instanceof Ol(e).Element}function yee(e){return Ep(e)?e:e.contextElement}function U2(e){const t=yee(e);if(!Yc(t))return D0(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:s}=ske(t);let a=(s?r5(n.width):n.width)/r,o=(s?r5(n.height):n.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const SQe=D0(0);function ake(e){const t=Ol(e);return!vee()||!t.visualViewport?SQe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function kQe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Ol(e)?!1:t}function Cy(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),s=yee(e);let a=D0(1);t&&(r?Ep(r)&&(a=U2(r)):a=U2(e));const o=kQe(s,n,r)?ake(s):D0(0);let l=(i.left+o.x)/a.x,u=(i.top+o.y)/a.y,c=i.width/a.x,f=i.height/a.y;if(s){const h=Ol(s),d=r&&Ep(r)?Ol(r):r;let p=h.frameElement;for(;p&&r&&d!==h;){const g=U2(p),m=p.getBoundingClientRect(),v=getComputedStyle(p),y=m.left+(p.clientLeft+parseFloat(v.paddingLeft))*g.x,b=m.top+(p.clientTop+parseFloat(v.paddingTop))*g.y;l*=g.x,u*=g.y,c*=g.x,f*=g.y,l+=y,u+=b,p=Ol(p).frameElement}}return t5({width:c,height:f,x:l,y:u})}function r8(e){return Ep(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Xp(e){return((ike(e)?e.ownerDocument:e.document)||window.document).documentElement}function EQe(e){let{rect:t,offsetParent:n,strategy:r}=e;const i=Yc(n),s=Xp(n);if(n===s)return t;let a={scrollLeft:0,scrollTop:0},o=D0(1);const l=D0(0);if((i||!i&&r!=="fixed")&&((T0(n)!=="body"||tI(s))&&(a=r8(n)),Yc(n))){const u=Cy(n);o=U2(n),l.x=u.x+n.clientLeft,l.y=u.y+n.clientTop}return{width:t.width*o.x,height:t.height*o.y,x:t.x*o.x-a.scrollLeft*o.x+l.x,y:t.y*o.y-a.scrollTop*o.y+l.y}}function AQe(e){return Array.from(e.getClientRects())}function oke(e){return Cy(Xp(e)).left+r8(e).scrollLeft}function TQe(e){const t=Xp(e),n=r8(e),r=e.ownerDocument.body,i=z2(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=z2(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+oke(e);const o=-n.scrollTop;return Sh(r).direction==="rtl"&&(a+=z2(t.clientWidth,r.clientWidth)-i),{width:i,height:s,x:a,y:o}}function _w(e){if(T0(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Nde(e)&&e.host||Xp(e);return Nde(t)?t.host:t}function lke(e){const t=_w(e);return n8(t)?e.ownerDocument?e.ownerDocument.body:e.body:Yc(t)&&tI(t)?t:lke(t)}function i5(e,t){var n;t===void 0&&(t=[]);const r=lke(e),i=r===((n=e.ownerDocument)==null?void 0:n.body),s=Ol(r);return i?t.concat(s,s.visualViewport||[],tI(r)?r:[]):t.concat(r,i5(r))}function DQe(e,t){const n=Ol(e),r=Xp(e),i=n.visualViewport;let s=r.clientWidth,a=r.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;const u=vee();(!u||u&&t==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:s,height:a,x:o,y:l}}function IQe(e,t){const n=Cy(e,!0,t==="fixed"),r=n.top+e.clientTop,i=n.left+e.clientLeft,s=Yc(e)?U2(e):D0(1),a=e.clientWidth*s.x,o=e.clientHeight*s.y,l=i*s.x,u=r*s.y;return{width:a,height:o,x:l,y:u}}function Mde(e,t,n){let r;if(t==="viewport")r=DQe(e,n);else if(t==="document")r=TQe(Xp(e));else if(Ep(t))r=IQe(t,n);else{const i=ake(e);r={...t,x:t.x-i.x,y:t.y-i.y}}return t5(r)}function uke(e,t){const n=_w(e);return n===t||!Ep(n)||n8(n)?!1:Sh(n).position==="fixed"||uke(n,t)}function NQe(e,t){const n=t.get(e);if(n)return n;let r=i5(e).filter(o=>Ep(o)&&T0(o)!=="body"),i=null;const s=Sh(e).position==="fixed";let a=s?_w(e):e;for(;Ep(a)&&!n8(a);){const o=Sh(a),l=mee(a);!l&&o.position==="fixed"&&(i=null),(s?!l&&!i:!l&&o.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||tI(a)&&!l&&uke(e,a))?r=r.filter(c=>c!==a):i=o,a=_w(a)}return t.set(e,r),r}function MQe(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const a=[...n==="clippingAncestors"?NQe(t,this._c):[].concat(n),r],o=a[0],l=a.reduce((u,c)=>{const f=Mde(t,c,i);return u.top=z2(f.top,u.top),u.right=nY(f.right,u.right),u.bottom=nY(f.bottom,u.bottom),u.left=z2(f.left,u.left),u},Mde(t,o,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function FQe(e){return ske(e)}function OQe(e,t,n){const r=Yc(t),i=Xp(t),s=n==="fixed",a=Cy(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=D0(0);if(r||!r&&!s)if((T0(t)!=="body"||tI(i))&&(o=r8(t)),Yc(t)){const u=Cy(t,!0,s,t);l.x=u.x+t.clientLeft,l.y=u.y+t.clientTop}else i&&(l.x=oke(i));return{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}function Fde(e,t){return!Yc(e)||Sh(e).position==="fixed"?null:t?t(e):e.offsetParent}function RQe(e){let t=_w(e);for(;Yc(t)&&!n8(t);){if(mee(t))return t;t=_w(t)}return null}function cke(e,t){const n=Ol(e);if(!Yc(e))return n;let r=Fde(e,t);for(;r&&_Qe(r)&&Sh(r).position==="static";)r=Fde(r,t);return r&&(T0(r)==="html"||T0(r)==="body"&&Sh(r).position==="static"&&!mee(r))?n:r||RQe(e)||n}const PQe=async function(e){let{reference:t,floating:n,strategy:r}=e;const i=this.getOffsetParent||cke,s=this.getDimensions;return{reference:OQe(t,await i(n),r),floating:{x:0,y:0,...await s(n)}}};function LQe(e){return getComputedStyle(e).direction==="rtl"}const HR={convertOffsetParentRelativeRectToViewportRelativeRect:EQe,getDocumentElement:Xp,getClippingRect:MQe,getOffsetParent:cke,getElementRects:PQe,getClientRects:AQe,getDimensions:FQe,getScale:U2,isElement:Ep,isRTL:LQe};function BQe(e,t){let n=null,r;const i=Xp(e);function s(){clearTimeout(r),n&&n.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const{left:u,top:c,width:f,height:h}=e.getBoundingClientRect();if(o||t(),!f||!h)return;const d=BF(c),p=BF(i.clientWidth-(u+f)),g=BF(i.clientHeight-(c+h)),m=BF(u),y={rootMargin:-d+"px "+-p+"px "+-g+"px "+-m+"px",threshold:z2(0,nY(1,l))||1};let b=!0;function x(w){const C=w[0].intersectionRatio;if(C!==l){if(!b)return a();C?a(!1,C):r=setTimeout(()=>{a(!1,1e-7)},100)}b=!1}try{n=new IntersectionObserver(x,{...y,root:i.ownerDocument})}catch{n=new IntersectionObserver(x,y)}n.observe(e)}return a(!0),s}function zQe(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,u=yee(e),c=i||s?[...u?i5(u):[],...i5(t)]:[];c.forEach(v=>{i&&v.addEventListener("scroll",n,{passive:!0}),s&&v.addEventListener("resize",n)});const f=u&&o?BQe(u,n):null;let h=-1,d=null;a&&(d=new ResizeObserver(v=>{let[y]=v;y&&y.target===u&&d&&(d.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{d&&d.observe(t)})),n()}),u&&!l&&d.observe(u),d.observe(t));let p,g=l?Cy(e):null;l&&m();function m(){const v=Cy(e);g&&(v.x!==g.x||v.y!==g.y||v.width!==g.width||v.height!==g.height)&&n(),g=v,p=requestAnimationFrame(m)}return n(),()=>{c.forEach(v=>{i&&v.removeEventListener("scroll",n),s&&v.removeEventListener("resize",n)}),f&&f(),d&&d.disconnect(),d=null,l&&cancelAnimationFrame(p)}}const UQe=(e,t,n)=>{const r=new Map,i={platform:HR,...n},s={...i.platform,_c:r};return cQe(e,t,{...i,platform:s})};function WQe(e){return VQe(e)}function VV(e){return e.assignedSlot?e.assignedSlot:e.parentNode instanceof ShadowRoot?e.parentNode.host:e.parentNode}function VQe(e){for(let t=e;t;t=VV(t))if(t instanceof Element&&getComputedStyle(t).display==="none")return null;for(let t=VV(e);t;t=VV(t)){if(!(t instanceof Element))continue;const n=getComputedStyle(t);if(n.display!=="contents"&&(n.position!=="static"||n.filter!=="none"||t.tagName==="BODY"))return t}return null}var jQe=Qt`
  ${Nr}

  :host {
    --arrow-color: var(--sl-color-neutral-1000);
    --arrow-size: 6px;

    /*
     * These properties are computed to account for the arrow's dimensions after being rotated 45. The constant
     * 0.7071 is derived from sin(45), which is the diagonal size of the arrow's container after rotating.
     */
    --arrow-size-diagonal: calc(var(--arrow-size) * 0.7071);
    --arrow-padding-offset: calc(var(--arrow-size-diagonal) - var(--arrow-size));

    display: contents;
  }

  .popup {
    position: absolute;
    isolation: isolate;
    max-width: var(--auto-size-available-width, none);
    max-height: var(--auto-size-available-height, none);
  }

  .popup--fixed {
    position: fixed;
  }

  .popup:not(.popup--active) {
    display: none;
  }

  .popup__arrow {
    position: absolute;
    width: calc(var(--arrow-size-diagonal) * 2);
    height: calc(var(--arrow-size-diagonal) * 2);
    rotate: 45deg;
    background: var(--arrow-color);
    z-index: -1;
  }
`;let cr=class extends nr{constructor(){super(...arguments),this.active=!1,this.placement="top",this.strategy="absolute",this.distance=0,this.skidding=0,this.arrow=!1,this.arrowPlacement="anchor",this.arrowPadding=10,this.flip=!1,this.flipFallbackPlacements="",this.flipFallbackStrategy="best-fit",this.flipPadding=0,this.shift=!1,this.shiftPadding=0,this.autoSizePadding=0}async connectedCallback(){super.connectedCallback(),await this.updateComplete,this.start()}disconnectedCallback(){this.stop()}async updated(e){super.updated(e),e.has("active")&&(this.active?this.start():this.stop()),e.has("anchor")&&this.handleAnchorChange(),this.active&&(await this.updateComplete,this.reposition())}async handleAnchorChange(){if(await this.stop(),this.anchor&&typeof this.anchor=="string"){const e=this.getRootNode();this.anchorEl=e.getElementById(this.anchor)}else this.anchor instanceof Element?this.anchorEl=this.anchor:this.anchorEl=this.querySelector('[slot="anchor"]');if(this.anchorEl instanceof HTMLSlotElement&&(this.anchorEl=this.anchorEl.assignedElements({flatten:!0})[0]),!this.anchorEl)throw new Error("Invalid anchor element: no anchor could be found using the anchor slot or the anchor attribute.");this.start()}start(){!this.anchorEl||(this.cleanup=zQe(this.anchorEl,this.popup,()=>{this.reposition()}))}async stop(){return new Promise(e=>{this.cleanup?(this.cleanup(),this.cleanup=void 0,this.removeAttribute("data-current-placement"),this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height"),requestAnimationFrame(()=>e())):e()})}reposition(){if(!this.active||!this.anchorEl)return;const e=[wQe({mainAxis:this.distance,crossAxis:this.skidding})];this.sync?e.push(Ide({apply:({rects:n})=>{const r=this.sync==="width"||this.sync==="both",i=this.sync==="height"||this.sync==="both";this.popup.style.width=r?`${n.reference.width}px`:"",this.popup.style.height=i?`${n.reference.height}px`:""}})):(this.popup.style.width="",this.popup.style.height=""),this.flip&&e.push(bQe({boundary:this.flipBoundary,fallbackPlacements:this.flipFallbackPlacements,fallbackStrategy:this.flipFallbackStrategy==="best-fit"?"bestFit":"initialPlacement",padding:this.flipPadding})),this.shift&&e.push(CQe({boundary:this.shiftBoundary,padding:this.shiftPadding})),this.autoSize?e.push(Ide({boundary:this.autoSizeBoundary,padding:this.autoSizePadding,apply:({availableWidth:n,availableHeight:r})=>{this.autoSize==="vertical"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-height",`${r}px`):this.style.removeProperty("--auto-size-available-height"),this.autoSize==="horizontal"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-width",`${n}px`):this.style.removeProperty("--auto-size-available-width")}})):(this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height")),this.arrow&&e.push(hQe({element:this.arrowEl,padding:this.arrowPadding}));const t=this.strategy==="absolute"?n=>HR.getOffsetParent(n,WQe):HR.getOffsetParent;UQe(this.anchorEl,this.popup,{placement:this.placement,middleware:e,strategy:this.strategy,platform:aZe(BSe({},HR),{getOffsetParent:t})}).then(({x:n,y:r,middlewareData:i,placement:s})=>{const a=getComputedStyle(this).direction==="rtl",o={top:"bottom",right:"left",bottom:"top",left:"right"}[s.split("-")[0]];if(this.setAttribute("data-current-placement",s),Object.assign(this.popup.style,{left:`${n}px`,top:`${r}px`}),this.arrow){const l=i.arrow.x,u=i.arrow.y;let c="",f="",h="",d="";if(this.arrowPlacement==="start"){const p=typeof l=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";c=typeof u=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"",f=a?p:"",d=a?"":p}else if(this.arrowPlacement==="end"){const p=typeof l=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";f=a?"":p,d=a?p:"",h=typeof u=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:""}else this.arrowPlacement==="center"?(d=typeof l=="number"?"calc(50% - var(--arrow-size-diagonal))":"",c=typeof u=="number"?"calc(50% - var(--arrow-size-diagonal))":""):(d=typeof l=="number"?`${l}px`:"",c=typeof u=="number"?`${u}px`:"");Object.assign(this.arrowEl.style,{top:c,right:f,bottom:h,left:d,[o]:"calc(var(--arrow-size-diagonal) * -1)"})}}),this.emit("sl-reposition")}render(){return de`
      <slot name="anchor" @slotchange=${this.handleAnchorChange}></slot>

      <div
        part="popup"
        class=${Ar({popup:!0,"popup--active":this.active,"popup--fixed":this.strategy==="fixed","popup--has-arrow":this.arrow})}
      >
        <slot></slot>
        ${this.arrow?de`<div part="arrow" class="popup__arrow" role="presentation"></div>`:""}
      </div>
    `}};cr.styles=jQe;H([gt(".popup")],cr.prototype,"popup",2);H([gt(".popup__arrow")],cr.prototype,"arrowEl",2);H([J()],cr.prototype,"anchor",2);H([J({type:Boolean,reflect:!0})],cr.prototype,"active",2);H([J({reflect:!0})],cr.prototype,"placement",2);H([J({reflect:!0})],cr.prototype,"strategy",2);H([J({type:Number})],cr.prototype,"distance",2);H([J({type:Number})],cr.prototype,"skidding",2);H([J({type:Boolean})],cr.prototype,"arrow",2);H([J({attribute:"arrow-placement"})],cr.prototype,"arrowPlacement",2);H([J({attribute:"arrow-padding",type:Number})],cr.prototype,"arrowPadding",2);H([J({type:Boolean})],cr.prototype,"flip",2);H([J({attribute:"flip-fallback-placements",converter:{fromAttribute:e=>e.split(" ").map(t=>t.trim()).filter(t=>t!==""),toAttribute:e=>e.join(" ")}})],cr.prototype,"flipFallbackPlacements",2);H([J({attribute:"flip-fallback-strategy"})],cr.prototype,"flipFallbackStrategy",2);H([J({type:Object})],cr.prototype,"flipBoundary",2);H([J({attribute:"flip-padding",type:Number})],cr.prototype,"flipPadding",2);H([J({type:Boolean})],cr.prototype,"shift",2);H([J({type:Object})],cr.prototype,"shiftBoundary",2);H([J({attribute:"shift-padding",type:Number})],cr.prototype,"shiftPadding",2);H([J({attribute:"auto-size"})],cr.prototype,"autoSize",2);H([J()],cr.prototype,"sync",2);H([J({type:Object})],cr.prototype,"autoSizeBoundary",2);H([J({attribute:"auto-size-padding",type:Number})],cr.prototype,"autoSizePadding",2);cr=H([Ue("sl-popup")],cr);var HQe=Qt`
  ${Nr}

  :host {
    display: inline-block;
  }

  .tag {
    display: flex;
    align-items: center;
    border: solid 1px;
    line-height: 1;
    white-space: nowrap;
    user-select: none;
  }

  .tag__remove::part(base) {
    color: inherit;
    padding: 0;
  }

  /*
   * Variant modifiers
   */

  .tag--primary {
    background-color: var(--sl-color-primary-50);
    border-color: var(--sl-color-primary-200);
    color: var(--sl-color-primary-800);
  }

  .tag--primary:active > sl-icon-button {
    color: var(--sl-color-primary-600);
  }

  .tag--success {
    background-color: var(--sl-color-success-50);
    border-color: var(--sl-color-success-200);
    color: var(--sl-color-success-800);
  }

  .tag--success:active > sl-icon-button {
    color: var(--sl-color-success-600);
  }

  .tag--neutral {
    background-color: var(--sl-color-neutral-50);
    border-color: var(--sl-color-neutral-200);
    color: var(--sl-color-neutral-800);
  }

  .tag--neutral:active > sl-icon-button {
    color: var(--sl-color-neutral-600);
  }

  .tag--warning {
    background-color: var(--sl-color-warning-50);
    border-color: var(--sl-color-warning-200);
    color: var(--sl-color-warning-800);
  }

  .tag--warning:active > sl-icon-button {
    color: var(--sl-color-warning-600);
  }

  .tag--danger {
    background-color: var(--sl-color-danger-50);
    border-color: var(--sl-color-danger-200);
    color: var(--sl-color-danger-800);
  }

  .tag--danger:active > sl-icon-button {
    color: var(--sl-color-danger-600);
  }

  /*
   * Size modifiers
   */

  .tag--small {
    font-size: var(--sl-button-font-size-small);
    height: calc(var(--sl-input-height-small) * 0.8);
    line-height: calc(var(--sl-input-height-small) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-small);
    padding: 0 var(--sl-spacing-x-small);
  }

  .tag--medium {
    font-size: var(--sl-button-font-size-medium);
    height: calc(var(--sl-input-height-medium) * 0.8);
    line-height: calc(var(--sl-input-height-medium) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-medium);
    padding: 0 var(--sl-spacing-small);
  }

  .tag--large {
    font-size: var(--sl-button-font-size-large);
    height: calc(var(--sl-input-height-large) * 0.8);
    line-height: calc(var(--sl-input-height-large) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-large);
    padding: 0 var(--sl-spacing-medium);
  }

  .tag__remove {
    margin-inline-start: var(--sl-spacing-x-small);
  }

  /*
   * Pill modifier
   */

  .tag--pill {
    border-radius: var(--sl-border-radius-pill);
  }
`;let _y=class extends nr{constructor(){super(...arguments),this.localize=new Co(this),this.variant="neutral",this.size="medium",this.pill=!1,this.removable=!1}handleRemoveClick(){this.emit("sl-remove")}render(){return de`
      <span
        part="base"
        class=${Ar({tag:!0,"tag--primary":this.variant==="primary","tag--success":this.variant==="success","tag--neutral":this.variant==="neutral","tag--warning":this.variant==="warning","tag--danger":this.variant==="danger","tag--text":this.variant==="text","tag--small":this.size==="small","tag--medium":this.size==="medium","tag--large":this.size==="large","tag--pill":this.pill,"tag--removable":this.removable})}
      >
        <slot part="content" class="tag__content"></slot>

        ${this.removable?de`
              <sl-icon-button
                part="remove-button"
                exportparts="base:remove-button__base"
                name="x-lg"
                library="system"
                label=${this.localize.term("remove")}
                class="tag__remove"
                @click=${this.handleRemoveClick}
                tabindex="-1"
              ></sl-icon-button>
            `:""}
      </span>
    `}};_y.styles=HQe;H([J({reflect:!0})],_y.prototype,"variant",2);H([J({reflect:!0})],_y.prototype,"size",2);H([J({type:Boolean,reflect:!0})],_y.prototype,"pill",2);H([J({type:Boolean})],_y.prototype,"removable",2);_y=H([Ue("sl-tag")],_y);var qQe=Qt`
  ${Nr}
  ${t8}

  :host {
    display: block;
  }

  /** The popup */
  .select {
    flex: 1 1 auto;
    display: inline-flex;
    width: 100%;
    position: relative;
    vertical-align: middle;
  }

  .select::part(popup) {
    z-index: var(--sl-z-index-dropdown);
  }

  .select[data-current-placement^='top']::part(popup) {
    transform-origin: bottom;
  }

  .select[data-current-placement^='bottom']::part(popup) {
    transform-origin: top;
  }

  /* Combobox */
  .select__combobox {
    flex: 1;
    display: flex;
    width: 100%;
    min-width: 0;
    position: relative;
    align-items: center;
    justify-content: start;
    font-family: var(--sl-input-font-family);
    font-weight: var(--sl-input-font-weight);
    letter-spacing: var(--sl-input-letter-spacing);
    vertical-align: middle;
    overflow: hidden;
    cursor: pointer;
    transition: var(--sl-transition-fast) color, var(--sl-transition-fast) border, var(--sl-transition-fast) box-shadow,
      var(--sl-transition-fast) background-color;
  }

  .select__display-input {
    position: relative;
    width: 100%;
    font: inherit;
    border: none;
    background: none;
    color: var(--sl-input-color);
    cursor: inherit;
    overflow: hidden;
    padding: 0;
    margin: 0;
    -webkit-appearance: none;
  }

  .select:not(.select--disabled):hover .select__display-input {
    color: var(--sl-input-color-hover);
  }

  .select__display-input:focus {
    outline: none;
  }

  /* Visually hide the display input when multiple is enabled */
  .select--multiple:not(.select--placeholder-visible) .select__display-input {
    position: absolute;
    z-index: -1;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
  }

  .select__value-input {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
    opacity: 0;
    z-index: -1;
  }

  .select__tags {
    display: flex;
    flex: 1;
    align-items: center;
    flex-wrap: wrap;
    margin-inline-start: var(--sl-spacing-2x-small);
  }

  .select__tags::slotted(sl-tag) {
    cursor: pointer !important;
  }

  .select--disabled .select__tags,
  .select--disabled .select__tags::slotted(sl-tag) {
    cursor: not-allowed !important;
  }

  /* Standard selects */
  .select--standard .select__combobox {
    background-color: var(--sl-input-background-color);
    border: solid var(--sl-input-border-width) var(--sl-input-border-color);
  }

  .select--standard.select--disabled .select__combobox {
    background-color: var(--sl-input-background-color-disabled);
    border-color: var(--sl-input-border-color-disabled);
    color: var(--sl-input-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
    outline: none;
  }

  .select--standard:not(.select--disabled).select--open .select__combobox,
  .select--standard:not(.select--disabled).select--focused .select__combobox {
    background-color: var(--sl-input-background-color-focus);
    border-color: var(--sl-input-border-color-focus);
    box-shadow: 0 0 0 var(--sl-focus-ring-width) var(--sl-input-focus-ring-color);
  }

  /* Filled selects */
  .select--filled .select__combobox {
    border: none;
    background-color: var(--sl-input-filled-background-color);
    color: var(--sl-input-color);
  }

  .select--filled:hover:not(.select--disabled) .select__combobox {
    background-color: var(--sl-input-filled-background-color-hover);
  }

  .select--filled.select--disabled .select__combobox {
    background-color: var(--sl-input-filled-background-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
  }

  .select--filled:not(.select--disabled).select--open .select__combobox,
  .select--filled:not(.select--disabled).select--focused .select__combobox {
    background-color: var(--sl-input-filled-background-color-focus);
    outline: var(--sl-focus-ring);
  }

  /* Sizes */
  .select--small .select__combobox {
    border-radius: var(--sl-input-border-radius-small);
    font-size: var(--sl-input-font-size-small);
    min-height: var(--sl-input-height-small);
    padding-block: 0;
    padding-inline: var(--sl-input-spacing-small);
  }

  .select--small .select__clear {
    margin-inline-start: var(--sl-input-spacing-small);
  }

  .select--small .select__prefix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-small);
  }

  .select--small.select--multiple:not(.select--placeholder-visible) .select__combobox {
    padding-block: 2px;
    padding-inline-start: 0;
  }

  .select--small .select__tags {
    gap: 2px;
  }

  .select--medium .select__combobox {
    border-radius: var(--sl-input-border-radius-medium);
    font-size: var(--sl-input-font-size-medium);
    min-height: var(--sl-input-height-medium);
    padding-block: 0;
    padding-inline: var(--sl-input-spacing-medium);
  }

  .select--medium .select__clear {
    margin-inline-start: var(--sl-input-spacing-medium);
  }

  .select--medium .select__prefix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-medium);
  }

  .select--medium.select--multiple:not(.select--placeholder-visible) .select__combobox {
    padding-inline-start: 0;
    padding-block: 3px;
  }

  .select--medium .select__tags {
    gap: 3px;
  }

  .select--large .select__combobox {
    border-radius: var(--sl-input-border-radius-large);
    font-size: var(--sl-input-font-size-large);
    min-height: var(--sl-input-height-large);
    padding-block: 0;
    padding-inline: var(--sl-input-spacing-large);
  }

  .select--large .select__clear {
    margin-inline-start: var(--sl-input-spacing-large);
  }

  .select--large .select__prefix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-large);
  }

  .select--large.select--multiple:not(.select--placeholder-visible) .select__combobox {
    padding-inline-start: 0;
    padding-block: 4px;
  }

  .select--large .select__tags {
    gap: 4px;
  }

  /* Pills */
  .select--pill.select--small .select__combobox {
    border-radius: var(--sl-input-height-small);
  }

  .select--pill.select--medium .select__combobox {
    border-radius: var(--sl-input-height-medium);
  }

  .select--pill.select--large .select__combobox {
    border-radius: var(--sl-input-height-large);
  }

  /* Prefix */
  .select__prefix {
    flex: 0;
    display: inline-flex;
    align-items: center;
    color: var(--sl-input-placeholder-color);
  }

  /* Clear button */
  .select__clear {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: inherit;
    color: var(--sl-input-icon-color);
    border: none;
    background: none;
    padding: 0;
    transition: var(--sl-transition-fast) color;
    cursor: pointer;
  }

  .select__clear:hover {
    color: var(--sl-input-icon-color-hover);
  }

  .select__clear:focus {
    outline: none;
  }

  /* Expand icon */
  .select__expand-icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    transition: var(--sl-transition-medium) rotate ease;
    rotate: 0;
    margin-inline-start: var(--sl-spacing-small);
  }

  .select--open .select__expand-icon {
    rotate: -180deg;
  }

  /* Listbox */
  .select__listbox {
    display: block;
    position: relative;
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-medium);
    font-weight: var(--sl-font-weight-normal);
    box-shadow: var(--sl-shadow-large);
    background: var(--sl-panel-background-color);
    border: solid var(--sl-panel-border-width) var(--sl-panel-border-color);
    border-radius: var(--sl-border-radius-medium);
    padding-block: var(--sl-spacing-x-small);
    padding-inline: 0;
    overflow: auto;
    overscroll-behavior: none;

    /* Make sure it adheres to the popup's auto size */
    max-width: var(--auto-size-available-width);
    max-height: var(--auto-size-available-height);
  }

  .select__listbox ::slotted(sl-divider) {
    --spacing: var(--sl-spacing-x-small);
  }

  .select__listbox ::slotted(small) {
    font-size: var(--sl-font-size-small);
    font-weight: var(--sl-font-weight-semibold);
    color: var(--sl-color-neutral-500);
    padding-block: var(--sl-spacing-x-small);
    padding-inline: var(--sl-spacing-x-large);
  }
`;let gn=class extends nr{constructor(){super(...arguments),this.formControlController=new hC(this,{assumeInteractionOn:["sl-blur","sl-input"]}),this.hasSlotController=new td(this,"help-text","label"),this.localize=new Co(this),this.typeToSelectString="",this.hasFocus=!1,this.displayLabel="",this.selectedOptions=[],this.name="",this.value="",this.defaultValue="",this.size="medium",this.placeholder="",this.multiple=!1,this.maxOptionsVisible=3,this.disabled=!1,this.clearable=!1,this.open=!1,this.hoist=!1,this.filled=!1,this.pill=!1,this.label="",this.placement="bottom",this.helpText="",this.form="",this.required=!1,this.handleDocumentFocusIn=e=>{const t=e.composedPath();this&&!t.includes(this)&&this.hide()},this.handleDocumentKeyDown=e=>{const t=e.target,n=t.closest(".select__clear")!==null,r=t.closest("sl-icon-button")!==null;if(!(n||r)){if(e.key==="Escape"&&this.open&&(e.preventDefault(),e.stopPropagation(),this.hide(),this.displayInput.focus({preventScroll:!0})),e.key==="Enter"||e.key===" "&&this.typeToSelectString===""){if(e.preventDefault(),e.stopImmediatePropagation(),!this.open){this.show();return}this.currentOption&&!this.currentOption.disabled&&(this.multiple?this.toggleOptionSelection(this.currentOption):this.setSelectedOptions(this.currentOption),this.updateComplete.then(()=>{this.emit("sl-input"),this.emit("sl-change")}),this.multiple||(this.hide(),this.displayInput.focus({preventScroll:!0})));return}if(["ArrowUp","ArrowDown","Home","End"].includes(e.key)){const i=this.getAllOptions(),s=i.indexOf(this.currentOption);let a=Math.max(0,s);if(e.preventDefault(),!this.open&&(this.show(),this.currentOption))return;e.key==="ArrowDown"?(a=s+1,a>i.length-1&&(a=0)):e.key==="ArrowUp"?(a=s-1,a<0&&(a=i.length-1)):e.key==="Home"?a=0:e.key==="End"&&(a=i.length-1),this.setCurrentOption(i[a])}if(e.key.length===1||e.key==="Backspace"){const i=this.getAllOptions();if(e.metaKey||e.ctrlKey||e.altKey)return;if(!this.open){if(e.key==="Backspace")return;this.show()}e.stopPropagation(),e.preventDefault(),clearTimeout(this.typeToSelectTimeout),this.typeToSelectTimeout=window.setTimeout(()=>this.typeToSelectString="",1e3),e.key==="Backspace"?this.typeToSelectString=this.typeToSelectString.slice(0,-1):this.typeToSelectString+=e.key.toLowerCase();for(const s of i)if(s.getTextLabel().toLowerCase().startsWith(this.typeToSelectString)){this.setCurrentOption(s);break}}}},this.handleDocumentMouseDown=e=>{const t=e.composedPath();this&&!t.includes(this)&&this.hide()}}get validity(){return this.valueInput.validity}get validationMessage(){return this.valueInput.validationMessage}connectedCallback(){super.connectedCallback(),this.open=!1}addOpenListeners(){document.addEventListener("focusin",this.handleDocumentFocusIn),document.addEventListener("keydown",this.handleDocumentKeyDown),document.addEventListener("mousedown",this.handleDocumentMouseDown)}removeOpenListeners(){document.removeEventListener("focusin",this.handleDocumentFocusIn),document.removeEventListener("keydown",this.handleDocumentKeyDown),document.removeEventListener("mousedown",this.handleDocumentMouseDown)}handleFocus(){this.hasFocus=!0,this.displayInput.setSelectionRange(0,0),this.emit("sl-focus")}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleLabelClick(){this.displayInput.focus()}handleComboboxMouseDown(e){const n=e.composedPath().some(r=>r instanceof Element&&r.tagName.toLowerCase()==="sl-icon-button");this.disabled||n||(e.preventDefault(),this.displayInput.focus({preventScroll:!0}),this.open=!this.open)}handleComboboxKeyDown(e){e.stopPropagation(),this.handleDocumentKeyDown(e)}handleClearClick(e){e.stopPropagation(),this.value!==""&&(this.setSelectedOptions([]),this.displayInput.focus({preventScroll:!0}),this.updateComplete.then(()=>{this.emit("sl-clear"),this.emit("sl-input"),this.emit("sl-change")}))}handleClearMouseDown(e){e.stopPropagation(),e.preventDefault()}handleOptionClick(e){const n=e.target.closest("sl-option"),r=this.value;n&&!n.disabled&&(this.multiple?this.toggleOptionSelection(n):this.setSelectedOptions(n),this.updateComplete.then(()=>this.displayInput.focus({preventScroll:!0})),this.value!==r&&this.updateComplete.then(()=>{this.emit("sl-input"),this.emit("sl-change")}),this.multiple||(this.hide(),this.displayInput.focus({preventScroll:!0})))}handleDefaultSlotChange(){const e=this.getAllOptions(),t=Array.isArray(this.value)?this.value:[this.value],n=[];customElements.get("sl-option")?(e.forEach(r=>n.push(r.value)),this.setSelectedOptions(e.filter(r=>t.includes(r.value)))):customElements.whenDefined("sl-option").then(()=>this.handleDefaultSlotChange())}handleTagRemove(e,t){e.stopPropagation(),this.disabled||(this.toggleOptionSelection(t,!1),this.updateComplete.then(()=>{this.emit("sl-input"),this.emit("sl-change")}))}getAllOptions(){return[...this.querySelectorAll("sl-option")]}getFirstOption(){return this.querySelector("sl-option")}setCurrentOption(e){this.getAllOptions().forEach(n=>{n.current=!1,n.tabIndex=-1}),e&&(this.currentOption=e,e.current=!0,e.tabIndex=0,e.focus())}setSelectedOptions(e){const t=this.getAllOptions(),n=Array.isArray(e)?e:[e];t.forEach(r=>r.selected=!1),n.length&&n.forEach(r=>r.selected=!0),this.selectionChanged()}toggleOptionSelection(e,t){t===!0||t===!1?e.selected=t:e.selected=!e.selected,this.selectionChanged()}selectionChanged(){var e,t,n,r;this.selectedOptions=this.getAllOptions().filter(i=>i.selected),this.multiple?(this.value=this.selectedOptions.map(i=>i.value),this.placeholder&&this.value.length===0?this.displayLabel="":this.displayLabel=this.localize.term("numOptionsSelected",this.selectedOptions.length)):(this.value=(t=(e=this.selectedOptions[0])==null?void 0:e.value)!=null?t:"",this.displayLabel=(r=(n=this.selectedOptions[0])==null?void 0:n.getTextLabel())!=null?r:""),this.updateComplete.then(()=>{this.formControlController.updateValidity()})}handleInvalid(e){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(e)}handleDisabledChange(){this.disabled&&(this.open=!1,this.handleOpenChange())}handleValueChange(){const e=this.getAllOptions(),t=Array.isArray(this.value)?this.value:[this.value];this.setSelectedOptions(e.filter(n=>t.includes(n.value)))}async handleOpenChange(){if(this.open&&!this.disabled){this.setCurrentOption(this.selectedOptions[0]||this.getFirstOption()),this.emit("sl-show"),this.addOpenListeners(),await ga(this),this.listbox.hidden=!1,this.popup.active=!0,requestAnimationFrame(()=>{this.setCurrentOption(this.currentOption)});const{keyframes:e,options:t}=Zi(this,"select.show",{dir:this.localize.dir()});await Ki(this.popup.popup,e,t),this.currentOption&&JG(this.currentOption,this.listbox,"vertical","auto"),this.emit("sl-after-show")}else{this.emit("sl-hide"),this.removeOpenListeners(),await ga(this);const{keyframes:e,options:t}=Zi(this,"select.hide",{dir:this.localize.dir()});await Ki(this.popup.popup,e,t),this.listbox.hidden=!0,this.popup.active=!1,this.emit("sl-after-hide")}}async show(){if(this.open||this.disabled){this.open=!1;return}return this.open=!0,Iu(this,"sl-after-show")}async hide(){if(!this.open||this.disabled){this.open=!1;return}return this.open=!1,Iu(this,"sl-after-hide")}checkValidity(){return this.valueInput.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.valueInput.reportValidity()}setCustomValidity(e){this.valueInput.setCustomValidity(e),this.formControlController.updateValidity()}focus(e){this.displayInput.focus(e)}blur(){this.displayInput.blur()}render(){const e=this.hasSlotController.test("label"),t=this.hasSlotController.test("help-text"),n=this.label?!0:!!e,r=this.helpText?!0:!!t,i=this.clearable&&!this.disabled&&this.value.length>0,s=this.placeholder&&this.value.length===0;return de`
      <div
        part="form-control"
        class=${Ar({"form-control":!0,"form-control--small":this.size==="small","form-control--medium":this.size==="medium","form-control--large":this.size==="large","form-control--has-label":n,"form-control--has-help-text":r})}
      >
        <label
          id="label"
          part="form-control-label"
          class="form-control__label"
          aria-hidden=${n?"false":"true"}
          @click=${this.handleLabelClick}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <sl-popup
            class=${Ar({select:!0,"select--standard":!0,"select--filled":this.filled,"select--pill":this.pill,"select--open":this.open,"select--disabled":this.disabled,"select--multiple":this.multiple,"select--focused":this.hasFocus,"select--placeholder-visible":s,"select--top":this.placement==="top","select--bottom":this.placement==="bottom","select--small":this.size==="small","select--medium":this.size==="medium","select--large":this.size==="large"})}
            placement=${this.placement}
            strategy=${this.hoist?"fixed":"absolute"}
            flip
            shift
            sync="width"
            auto-size="vertical"
            auto-size-padding="10"
          >
            <div
              part="combobox"
              class="select__combobox"
              slot="anchor"
              @keydown=${this.handleComboboxKeyDown}
              @mousedown=${this.handleComboboxMouseDown}
            >
              <slot part="prefix" name="prefix" class="select__prefix"></slot>

              <input
                part="display-input"
                class="select__display-input"
                type="text"
                placeholder=${this.placeholder}
                .disabled=${this.disabled}
                .value=${this.displayLabel}
                autocomplete="off"
                spellcheck="false"
                autocapitalize="off"
                readonly
                aria-controls="listbox"
                aria-expanded=${this.open?"true":"false"}
                aria-haspopup="listbox"
                aria-labelledby="label"
                aria-disabled=${this.disabled?"true":"false"}
                aria-describedby="help-text"
                role="combobox"
                tabindex="0"
                @focus=${this.handleFocus}
                @blur=${this.handleBlur}
              />

              ${this.multiple?de`
                    <div part="tags" class="select__tags">
                      ${this.selectedOptions.map((a,o)=>o<this.maxOptionsVisible||this.maxOptionsVisible<=0?de`
                            <sl-tag
                              part="tag"
                              exportparts="
                                base:tag__base,
                                content:tag__content,
                                remove-button:tag__remove-button,
                                remove-button__base:tag__remove-button__base
                              "
                              ?pill=${this.pill}
                              size=${this.size}
                              removable
                              @sl-remove=${l=>this.handleTagRemove(l,a)}
                            >
                              ${a.getTextLabel()}
                            </sl-tag>
                          `:o===this.maxOptionsVisible?de` <sl-tag size=${this.size}> +${this.selectedOptions.length-o} </sl-tag> `:null)}
                    </div>
                  `:""}

              <input
                class="select__value-input"
                type="text"
                ?disabled=${this.disabled}
                ?required=${this.required}
                .value=${Array.isArray(this.value)?this.value.join(", "):this.value}
                tabindex="-1"
                aria-hidden="true"
                @focus=${()=>this.focus()}
                @invalid=${this.handleInvalid}
              />

              ${i?de`
                    <button
                      part="clear-button"
                      class="select__clear"
                      type="button"
                      aria-label=${this.localize.term("clearEntry")}
                      @mousedown=${this.handleClearMouseDown}
                      @click=${this.handleClearClick}
                      tabindex="-1"
                    >
                      <slot name="clear-icon">
                        <sl-icon name="x-circle-fill" library="system"></sl-icon>
                      </slot>
                    </button>
                  `:""}

              <slot name="expand-icon" part="expand-icon" class="select__expand-icon">
                <sl-icon library="system" name="chevron-down"></sl-icon>
              </slot>
            </div>

            <div
              id="listbox"
              role="listbox"
              aria-expanded=${this.open?"true":"false"}
              aria-multiselectable=${this.multiple?"true":"false"}
              aria-labelledby="label"
              part="listbox"
              class="select__listbox"
              tabindex="-1"
              @mouseup=${this.handleOptionClick}
              @slotchange=${this.handleDefaultSlotChange}
            >
              <slot></slot>
            </div>
          </sl-popup>
        </div>

        <slot
          name="help-text"
          part="form-control-help-text"
          id="help-text"
          class="form-control__help-text"
          aria-hidden=${r?"false":"true"}
        >
          ${this.helpText}
        </slot>
      </div>
    `}};gn.styles=qQe;H([gt(".select")],gn.prototype,"popup",2);H([gt(".select__combobox")],gn.prototype,"combobox",2);H([gt(".select__display-input")],gn.prototype,"displayInput",2);H([gt(".select__value-input")],gn.prototype,"valueInput",2);H([gt(".select__listbox")],gn.prototype,"listbox",2);H([Ir()],gn.prototype,"hasFocus",2);H([Ir()],gn.prototype,"displayLabel",2);H([Ir()],gn.prototype,"currentOption",2);H([Ir()],gn.prototype,"selectedOptions",2);H([J()],gn.prototype,"name",2);H([J({converter:{fromAttribute:e=>e.split(" "),toAttribute:e=>e.join(" ")}})],gn.prototype,"value",2);H([e8()],gn.prototype,"defaultValue",2);H([J({reflect:!0})],gn.prototype,"size",2);H([J()],gn.prototype,"placeholder",2);H([J({type:Boolean,reflect:!0})],gn.prototype,"multiple",2);H([J({attribute:"max-options-visible",type:Number})],gn.prototype,"maxOptionsVisible",2);H([J({type:Boolean,reflect:!0})],gn.prototype,"disabled",2);H([J({type:Boolean})],gn.prototype,"clearable",2);H([J({type:Boolean,reflect:!0})],gn.prototype,"open",2);H([J({type:Boolean})],gn.prototype,"hoist",2);H([J({type:Boolean,reflect:!0})],gn.prototype,"filled",2);H([J({type:Boolean,reflect:!0})],gn.prototype,"pill",2);H([J()],gn.prototype,"label",2);H([J({reflect:!0})],gn.prototype,"placement",2);H([J({attribute:"help-text"})],gn.prototype,"helpText",2);H([J({reflect:!0})],gn.prototype,"form",2);H([J({type:Boolean,reflect:!0})],gn.prototype,"required",2);H([Jt("disabled",{waitUntilFirstUpdate:!0})],gn.prototype,"handleDisabledChange",1);H([Jt("value",{waitUntilFirstUpdate:!0})],gn.prototype,"handleValueChange",1);H([Jt("open",{waitUntilFirstUpdate:!0})],gn.prototype,"handleOpenChange",1);gn=H([Ue("sl-select")],gn);Mr("select.show",{keyframes:[{opacity:0,scale:.9},{opacity:1,scale:1}],options:{duration:100,easing:"ease"}});Mr("select.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.9}],options:{duration:100,easing:"ease"}});function Ode(e,t,n){const r=i=>Object.is(i,-0)?0:i;return e<t?r(t):e>n?r(n):r(e)}function GQe(e,t){function n(i){const s=e.getBoundingClientRect(),a=e.ownerDocument.defaultView,o=s.left+a.pageXOffset,l=s.top+a.pageYOffset,u=i.pageX-o,c=i.pageY-l;t!=null&&t.onMove&&t.onMove(u,c)}function r(){document.removeEventListener("pointermove",n),document.removeEventListener("pointerup",r),t!=null&&t.onStop&&t.onStop()}document.addEventListener("pointermove",n,{passive:!0}),document.addEventListener("pointerup",r),(t==null?void 0:t.initialEvent)instanceof PointerEvent&&n(t.initialEvent)}var YQe=Qt`
  ${Nr}

  :host {
    --divider-width: 4px;
    --divider-hit-area: 12px;
    --min: 0%;
    --max: 100%;

    display: grid;
  }

  .start,
  .end {
    overflow: hidden;
  }

  .divider {
    flex: 0 0 var(--divider-width);
    display: flex;
    position: relative;
    align-items: center;
    justify-content: center;
    background-color: var(--sl-color-neutral-200);
    color: var(--sl-color-neutral-900);
    z-index: 1;
  }

  .divider:focus {
    outline: none;
  }

  :host(:not([disabled])) .divider:focus-visible {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  :host([disabled]) .divider {
    cursor: not-allowed;
  }

  /* Horizontal */
  :host(:not([vertical], [disabled])) .divider {
    cursor: col-resize;
  }

  :host(:not([vertical])) .divider::after {
    display: flex;
    content: '';
    position: absolute;
    height: 100%;
    left: calc(var(--divider-hit-area) / -2 + var(--divider-width) / 2);
    width: var(--divider-hit-area);
  }

  /* Vertical */
  :host([vertical]) {
    flex-direction: column;
  }

  :host([vertical]:not([disabled])) .divider {
    cursor: row-resize;
  }

  :host([vertical]) .divider::after {
    content: '';
    position: absolute;
    width: 100%;
    top: calc(var(--divider-hit-area) / -2 + var(--divider-width) / 2);
    height: var(--divider-hit-area);
  }

  @media (forced-colors: active) {
    .divider {
      outline: solid 1px transparent;
    }
  }
`;let rl=class extends nr{constructor(){super(...arguments),this.localize=new Co(this),this.position=50,this.vertical=!1,this.disabled=!1,this.snapThreshold=12}connectedCallback(){super.connectedCallback(),this.resizeObserver=new ResizeObserver(e=>this.handleResize(e)),this.updateComplete.then(()=>this.resizeObserver.observe(this)),this.detectSize(),this.cachedPositionInPixels=this.percentageToPixels(this.position)}disconnectedCallback(){super.disconnectedCallback(),this.resizeObserver.unobserve(this)}detectSize(){const{width:e,height:t}=this.getBoundingClientRect();this.size=this.vertical?t:e}percentageToPixels(e){return this.size*(e/100)}pixelsToPercentage(e){return e/this.size*100}handleDrag(e){const t=this.localize.dir()==="rtl";this.disabled||(e.cancelable&&e.preventDefault(),GQe(this,{onMove:(n,r)=>{let i=this.vertical?r:n;this.primary==="end"&&(i=this.size-i),this.snap&&this.snap.split(" ").forEach(a=>{let o;a.endsWith("%")?o=this.size*(parseFloat(a)/100):o=parseFloat(a),t&&!this.vertical&&(o=this.size-o),i>=o-this.snapThreshold&&i<=o+this.snapThreshold&&(i=o)}),this.position=Ode(this.pixelsToPercentage(i),0,100)},initialEvent:e}))}handleKeyDown(e){if(!this.disabled&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(e.key)){let t=this.position;const n=(e.shiftKey?10:1)*(this.primary==="end"?-1:1);e.preventDefault(),(e.key==="ArrowLeft"&&!this.vertical||e.key==="ArrowUp"&&this.vertical)&&(t-=n),(e.key==="ArrowRight"&&!this.vertical||e.key==="ArrowDown"&&this.vertical)&&(t+=n),e.key==="Home"&&(t=this.primary==="end"?100:0),e.key==="End"&&(t=this.primary==="end"?0:100),this.position=Ode(t,0,100)}}handleResize(e){const{width:t,height:n}=e[0].contentRect;this.size=this.vertical?n:t,this.primary&&(this.position=this.pixelsToPercentage(this.cachedPositionInPixels))}handlePositionChange(){this.cachedPositionInPixels=this.percentageToPixels(this.position),this.positionInPixels=this.percentageToPixels(this.position),this.emit("sl-reposition")}handlePositionInPixelsChange(){this.position=this.pixelsToPercentage(this.positionInPixels)}handleVerticalChange(){this.detectSize()}render(){const e=this.vertical?"gridTemplateRows":"gridTemplateColumns",t=this.vertical?"gridTemplateColumns":"gridTemplateRows",n=this.localize.dir()==="rtl",r=`
      clamp(
        0%,
        clamp(
          var(--min),
          ${this.position}% - var(--divider-width) / 2,
          var(--max)
        ),
        calc(100% - var(--divider-width))
      )
    `,i="auto";return this.primary==="end"?n&&!this.vertical?this.style[e]=`${r} var(--divider-width) ${i}`:this.style[e]=`${i} var(--divider-width) ${r}`:n&&!this.vertical?this.style[e]=`${i} var(--divider-width) ${r}`:this.style[e]=`${r} var(--divider-width) ${i}`,this.style[t]="",de`
      <slot name="start" part="panel start" class="start"></slot>

      <div
        part="divider"
        class="divider"
        tabindex=${At(this.disabled?void 0:"0")}
        role="separator"
        aria-valuenow=${this.position}
        aria-valuemin="0"
        aria-valuemax="100"
        aria-label=${this.localize.term("resize")}
        @keydown=${this.handleKeyDown}
        @mousedown=${this.handleDrag}
        @touchstart=${this.handleDrag}
      >
        <slot name="divider"></slot>
      </div>

      <slot name="end" part="panel end" class="end"></slot>
    `}};rl.styles=YQe;H([gt(".divider")],rl.prototype,"divider",2);H([J({type:Number,reflect:!0})],rl.prototype,"position",2);H([J({attribute:"position-in-pixels",type:Number})],rl.prototype,"positionInPixels",2);H([J({type:Boolean,reflect:!0})],rl.prototype,"vertical",2);H([J({type:Boolean,reflect:!0})],rl.prototype,"disabled",2);H([J()],rl.prototype,"primary",2);H([J()],rl.prototype,"snap",2);H([J({type:Number,attribute:"snap-threshold"})],rl.prototype,"snapThreshold",2);H([Jt("position")],rl.prototype,"handlePositionChange",1);H([Jt("positionInPixels")],rl.prototype,"handlePositionInPixelsChange",1);H([Jt("vertical")],rl.prototype,"handleVerticalChange",1);rl=H([Ue("sl-split-panel")],rl);var XQe=Qt`
  ${Nr}

  :host {
    display: inline-block;
  }

  :host([size='small']) {
    --height: var(--sl-toggle-size-small);
    --thumb-size: calc(var(--sl-toggle-size-small) + 4px);
    --width: calc(var(--height) * 2);

    font-size: var(--sl-input-font-size-small);
  }

  :host([size='medium']) {
    --height: var(--sl-toggle-size-medium);
    --thumb-size: calc(var(--sl-toggle-size-medium) + 4px);
    --width: calc(var(--height) * 2);

    font-size: var(--sl-input-font-size-medium);
  }

  :host([size='large']) {
    --height: var(--sl-toggle-size-large);
    --thumb-size: calc(var(--sl-toggle-size-large) + 4px);
    --width: calc(var(--height) * 2);

    font-size: var(--sl-input-font-size-large);
  }

  .switch {
    position: relative;
    display: inline-flex;
    align-items: center;
    font-family: var(--sl-input-font-family);
    font-size: inherit;
    font-weight: var(--sl-input-font-weight);
    color: var(--sl-input-label-color);
    vertical-align: middle;
    cursor: pointer;
  }

  .switch__control {
    flex: 0 0 auto;
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: var(--width);
    height: var(--height);
    background-color: var(--sl-color-neutral-400);
    border: solid var(--sl-input-border-width) var(--sl-color-neutral-400);
    border-radius: var(--height);
    transition: var(--sl-transition-fast) border-color, var(--sl-transition-fast) background-color;
  }

  .switch__control .switch__thumb {
    width: var(--thumb-size);
    height: var(--thumb-size);
    background-color: var(--sl-color-neutral-0);
    border-radius: 50%;
    border: solid var(--sl-input-border-width) var(--sl-color-neutral-400);
    translate: calc((var(--width) - var(--height)) / -2);
    transition: var(--sl-transition-fast) translate ease, var(--sl-transition-fast) background-color,
      var(--sl-transition-fast) border-color, var(--sl-transition-fast) box-shadow;
  }

  .switch__input {
    position: absolute;
    opacity: 0;
    padding: 0;
    margin: 0;
    pointer-events: none;
  }

  /* Hover */
  .switch:not(.switch--checked):not(.switch--disabled) .switch__control:hover {
    background-color: var(--sl-color-neutral-400);
    border-color: var(--sl-color-neutral-400);
  }

  .switch:not(.switch--checked):not(.switch--disabled) .switch__control:hover .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-neutral-400);
  }

  /* Focus */
  .switch:not(.switch--checked):not(.switch--disabled) .switch__input:focus-visible ~ .switch__control {
    background-color: var(--sl-color-neutral-400);
    border-color: var(--sl-color-neutral-400);
  }

  .switch:not(.switch--checked):not(.switch--disabled) .switch__input:focus-visible ~ .switch__control .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-primary-600);
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  /* Checked */
  .switch--checked .switch__control {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
  }

  .switch--checked .switch__control .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-primary-600);
    translate: calc((var(--width) - var(--height)) / 2);
  }

  /* Checked + hover */
  .switch.switch--checked:not(.switch--disabled) .switch__control:hover {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
  }

  .switch.switch--checked:not(.switch--disabled) .switch__control:hover .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-primary-600);
  }

  /* Checked + focus */
  .switch.switch--checked:not(.switch--disabled) .switch__input:focus-visible ~ .switch__control {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
  }

  .switch.switch--checked:not(.switch--disabled) .switch__input:focus-visible ~ .switch__control .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-primary-600);
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  /* Disabled */
  .switch--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .switch__label {
    display: inline-block;
    line-height: var(--height);
    margin-inline-start: 0.5em;
    user-select: none;
  }

  :host([required]) .switch__label::after {
    content: var(--sl-input-required-content);
    margin-inline-start: var(--sl-input-required-content-offset);
  }

  @media (forced-colors: active) {
    .switch.switch--checked:not(.switch--disabled) .switch__control:hover .switch__thumb,
    .switch--checked .switch__control .switch__thumb {
      background-color: ButtonText;
    }
  }
`;let Aa=class extends nr{constructor(){super(...arguments),this.formControlController=new hC(this,{value:e=>e.checked?e.value||"on":void 0,defaultValue:e=>e.defaultChecked,setValue:(e,t)=>e.checked=t}),this.hasFocus=!1,this.title="",this.name="",this.size="medium",this.disabled=!1,this.checked=!1,this.defaultChecked=!1,this.form="",this.required=!1}get validity(){return this.input.validity}get validationMessage(){return this.input.validationMessage}firstUpdated(){this.formControlController.updateValidity()}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleInput(){this.emit("sl-input")}handleInvalid(e){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(e)}handleClick(){this.checked=!this.checked,this.emit("sl-change")}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleKeyDown(e){e.key==="ArrowLeft"&&(e.preventDefault(),this.checked=!1,this.emit("sl-change"),this.emit("sl-input")),e.key==="ArrowRight"&&(e.preventDefault(),this.checked=!0,this.emit("sl-change"),this.emit("sl-input"))}handleCheckedChange(){this.input.checked=this.checked,this.formControlController.updateValidity()}handleDisabledChange(){this.formControlController.setValidity(!0)}click(){this.input.click()}focus(e){this.input.focus(e)}blur(){this.input.blur()}checkValidity(){return this.input.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.input.reportValidity()}setCustomValidity(e){this.input.setCustomValidity(e),this.formControlController.updateValidity()}render(){return de`
      <label
        part="base"
        class=${Ar({switch:!0,"switch--checked":this.checked,"switch--disabled":this.disabled,"switch--focused":this.hasFocus,"switch--small":this.size==="small","switch--medium":this.size==="medium","switch--large":this.size==="large"})}
      >
        <input
          class="switch__input"
          type="checkbox"
          title=${this.title}
          name=${this.name}
          value=${At(this.value)}
          .checked=${dee(this.checked)}
          .disabled=${this.disabled}
          .required=${this.required}
          role="switch"
          aria-checked=${this.checked?"true":"false"}
          @click=${this.handleClick}
          @input=${this.handleInput}
          @invalid=${this.handleInvalid}
          @blur=${this.handleBlur}
          @focus=${this.handleFocus}
          @keydown=${this.handleKeyDown}
        />

        <span part="control" class="switch__control">
          <span part="thumb" class="switch__thumb"></span>
        </span>

        <slot part="label" class="switch__label"></slot>
      </label>
    `}};Aa.styles=XQe;H([gt('input[type="checkbox"]')],Aa.prototype,"input",2);H([Ir()],Aa.prototype,"hasFocus",2);H([J()],Aa.prototype,"title",2);H([J()],Aa.prototype,"name",2);H([J()],Aa.prototype,"value",2);H([J({reflect:!0})],Aa.prototype,"size",2);H([J({type:Boolean,reflect:!0})],Aa.prototype,"disabled",2);H([J({type:Boolean,reflect:!0})],Aa.prototype,"checked",2);H([e8("checked")],Aa.prototype,"defaultChecked",2);H([J({reflect:!0})],Aa.prototype,"form",2);H([J({type:Boolean,reflect:!0})],Aa.prototype,"required",2);H([Jt("checked",{waitUntilFirstUpdate:!0})],Aa.prototype,"handleCheckedChange",1);H([Jt("disabled",{waitUntilFirstUpdate:!0})],Aa.prototype,"handleDisabledChange",1);Aa=H([Ue("sl-switch")],Aa);var KQe=Qt`
  ${Nr}

  :host {
    display: inline-block;
  }

  .tab {
    display: inline-flex;
    align-items: center;
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-small);
    font-weight: var(--sl-font-weight-semibold);
    border-radius: var(--sl-border-radius-medium);
    color: var(--sl-color-neutral-600);
    padding: var(--sl-spacing-medium) var(--sl-spacing-large);
    white-space: nowrap;
    user-select: none;
    cursor: pointer;
    transition: var(--transition-speed) box-shadow, var(--transition-speed) color;
  }

  .tab:hover:not(.tab--disabled) {
    color: var(--sl-color-primary-600);
  }

  .tab:focus {
    outline: none;
  }

  .tab:focus-visible:not(.tab--disabled) {
    color: var(--sl-color-primary-600);
  }

  .tab:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: calc(-1 * var(--sl-focus-ring-width) - var(--sl-focus-ring-offset));
  }

  .tab.tab--active:not(.tab--disabled) {
    color: var(--sl-color-primary-600);
  }

  .tab.tab--closable {
    padding-inline-end: var(--sl-spacing-small);
  }

  .tab.tab--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .tab__close-button {
    font-size: var(--sl-font-size-small);
    margin-inline-start: var(--sl-spacing-small);
  }

  .tab__close-button::part(base) {
    padding: var(--sl-spacing-3x-small);
  }

  @media (forced-colors: active) {
    .tab.tab--active:not(.tab--disabled) {
      outline: solid 1px transparent;
      outline-offset: -3px;
    }
  }
`;let ZQe=0,kh=class extends nr{constructor(){super(...arguments),this.localize=new Co(this),this.attrId=++ZQe,this.componentId=`sl-tab-${this.attrId}`,this.panel="",this.active=!1,this.closable=!1,this.disabled=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","tab")}handleCloseClick(e){e.stopPropagation(),this.emit("sl-close")}handleActiveChange(){this.setAttribute("aria-selected",this.active?"true":"false")}handleDisabledChange(){this.setAttribute("aria-disabled",this.disabled?"true":"false")}focus(e){this.tab.focus(e)}blur(){this.tab.blur()}render(){return this.id=this.id.length>0?this.id:this.componentId,de`
      <div
        part="base"
        class=${Ar({tab:!0,"tab--active":this.active,"tab--closable":this.closable,"tab--disabled":this.disabled})}
        tabindex=${this.disabled?"-1":"0"}
      >
        <slot></slot>
        ${this.closable?de`
              <sl-icon-button
                part="close-button"
                exportparts="base:close-button__base"
                name="x-lg"
                library="system"
                label=${this.localize.term("close")}
                class="tab__close-button"
                @click=${this.handleCloseClick}
                tabindex="-1"
              ></sl-icon-button>
            `:""}
      </div>
    `}};kh.styles=KQe;H([gt(".tab")],kh.prototype,"tab",2);H([J({reflect:!0})],kh.prototype,"panel",2);H([J({type:Boolean,reflect:!0})],kh.prototype,"active",2);H([J({type:Boolean})],kh.prototype,"closable",2);H([J({type:Boolean,reflect:!0})],kh.prototype,"disabled",2);H([Jt("active")],kh.prototype,"handleActiveChange",1);H([Jt("disabled")],kh.prototype,"handleDisabledChange",1);kh=H([Ue("sl-tab")],kh);var QQe=Qt`
  ${Nr}

  :host {
    --indicator-color: var(--sl-color-primary-600);
    --track-color: var(--sl-color-neutral-200);
    --track-width: 2px;

    display: block;
  }

  .tab-group {
    display: flex;
    border-radius: 0;
  }

  .tab-group__tabs {
    display: flex;
    position: relative;
  }

  .tab-group__indicator {
    position: absolute;
    transition: var(--sl-transition-fast) translate ease, var(--sl-transition-fast) width ease;
  }

  .tab-group--has-scroll-controls .tab-group__nav-container {
    position: relative;
    padding: 0 var(--sl-spacing-x-large);
  }

  .tab-group__body {
    display: block;
    overflow: auto;
  }

  .tab-group__scroll-button {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    bottom: 0;
    width: var(--sl-spacing-x-large);
  }

  .tab-group__scroll-button--start {
    left: 0;
  }

  .tab-group__scroll-button--end {
    right: 0;
  }

  .tab-group--rtl .tab-group__scroll-button--start {
    left: auto;
    right: 0;
  }

  .tab-group--rtl .tab-group__scroll-button--end {
    left: 0;
    right: auto;
  }

  /*
   * Top
   */

  .tab-group--top {
    flex-direction: column;
  }

  .tab-group--top .tab-group__nav-container {
    order: 1;
  }

  .tab-group--top .tab-group__nav {
    display: flex;
    overflow-x: auto;

    /* Hide scrollbar in Firefox */
    scrollbar-width: none;
  }

  /* Hide scrollbar in Chrome/Safari */
  .tab-group--top .tab-group__nav::-webkit-scrollbar {
    width: 0;
    height: 0;
  }

  .tab-group--top .tab-group__tabs {
    flex: 1 1 auto;
    position: relative;
    flex-direction: row;
    border-bottom: solid var(--track-width) var(--track-color);
  }

  .tab-group--top .tab-group__indicator {
    bottom: calc(-1 * var(--track-width));
    border-bottom: solid var(--track-width) var(--indicator-color);
  }

  .tab-group--top .tab-group__body {
    order: 2;
  }

  .tab-group--top ::slotted(sl-tab-panel) {
    --padding: var(--sl-spacing-medium) 0;
  }

  /*
   * Bottom
   */

  .tab-group--bottom {
    flex-direction: column;
  }

  .tab-group--bottom .tab-group__nav-container {
    order: 2;
  }

  .tab-group--bottom .tab-group__nav {
    display: flex;
    overflow-x: auto;

    /* Hide scrollbar in Firefox */
    scrollbar-width: none;
  }

  /* Hide scrollbar in Chrome/Safari */
  .tab-group--bottom .tab-group__nav::-webkit-scrollbar {
    width: 0;
    height: 0;
  }

  .tab-group--bottom .tab-group__tabs {
    flex: 1 1 auto;
    position: relative;
    flex-direction: row;
    border-top: solid var(--track-width) var(--track-color);
  }

  .tab-group--bottom .tab-group__indicator {
    top: calc(-1 * var(--track-width));
    border-top: solid var(--track-width) var(--indicator-color);
  }

  .tab-group--bottom .tab-group__body {
    order: 1;
  }

  .tab-group--bottom ::slotted(sl-tab-panel) {
    --padding: var(--sl-spacing-medium) 0;
  }

  /*
   * Start
   */

  .tab-group--start {
    flex-direction: row;
  }

  .tab-group--start .tab-group__nav-container {
    order: 1;
  }

  .tab-group--start .tab-group__tabs {
    flex: 0 0 auto;
    flex-direction: column;
    border-inline-end: solid var(--track-width) var(--track-color);
  }

  .tab-group--start .tab-group__indicator {
    right: calc(-1 * var(--track-width));
    border-right: solid var(--track-width) var(--indicator-color);
  }

  .tab-group--start.tab-group--rtl .tab-group__indicator {
    right: auto;
    left: calc(-1 * var(--track-width));
  }

  .tab-group--start .tab-group__body {
    flex: 1 1 auto;
    order: 2;
  }

  .tab-group--start ::slotted(sl-tab-panel) {
    --padding: 0 var(--sl-spacing-medium);
  }

  /*
   * End
   */

  .tab-group--end {
    flex-direction: row;
  }

  .tab-group--end .tab-group__nav-container {
    order: 2;
  }

  .tab-group--end .tab-group__tabs {
    flex: 0 0 auto;
    flex-direction: column;
    border-left: solid var(--track-width) var(--track-color);
  }

  .tab-group--end .tab-group__indicator {
    left: calc(-1 * var(--track-width));
    border-inline-start: solid var(--track-width) var(--indicator-color);
  }

  .tab-group--end.tab-group--rtl .tab-group__indicator {
    right: calc(-1 * var(--track-width));
    left: auto;
  }

  .tab-group--end .tab-group__body {
    flex: 1 1 auto;
    order: 1;
  }

  .tab-group--end ::slotted(sl-tab-panel) {
    --padding: 0 var(--sl-spacing-medium);
  }
`;let Ul=class extends nr{constructor(){super(...arguments),this.localize=new Co(this),this.tabs=[],this.panels=[],this.hasScrollControls=!1,this.placement="top",this.activation="auto",this.noScrollControls=!1}connectedCallback(){const e=Promise.all([customElements.whenDefined("sl-tab"),customElements.whenDefined("sl-tab-panel")]);super.connectedCallback(),this.resizeObserver=new ResizeObserver(()=>{this.repositionIndicator(),this.updateScrollControls()}),this.mutationObserver=new MutationObserver(t=>{t.some(n=>!["aria-labelledby","aria-controls"].includes(n.attributeName))&&setTimeout(()=>this.setAriaLabels()),t.some(n=>n.attributeName==="disabled")&&this.syncTabsAndPanels()}),this.updateComplete.then(()=>{this.syncTabsAndPanels(),this.mutationObserver.observe(this,{attributes:!0,childList:!0,subtree:!0}),this.resizeObserver.observe(this.nav),e.then(()=>{new IntersectionObserver((n,r)=>{var i;n[0].intersectionRatio>0&&(this.setAriaLabels(),this.setActiveTab((i=this.getActiveTab())!=null?i:this.tabs[0],{emitEvents:!1}),r.unobserve(n[0].target))}).observe(this.tabGroup)})})}disconnectedCallback(){this.mutationObserver.disconnect(),this.resizeObserver.unobserve(this.nav)}getAllTabs(e={includeDisabled:!0}){return[...this.shadowRoot.querySelector('slot[name="nav"]').assignedElements()].filter(n=>e.includeDisabled?n.tagName.toLowerCase()==="sl-tab":n.tagName.toLowerCase()==="sl-tab"&&!n.disabled)}getAllPanels(){return[...this.body.assignedElements()].filter(e=>e.tagName.toLowerCase()==="sl-tab-panel")}getActiveTab(){return this.tabs.find(e=>e.active)}handleClick(e){const n=e.target.closest("sl-tab");(n==null?void 0:n.closest("sl-tab-group"))===this&&n!==null&&this.setActiveTab(n,{scrollBehavior:"smooth"})}handleKeyDown(e){const n=e.target.closest("sl-tab");if((n==null?void 0:n.closest("sl-tab-group"))===this&&(["Enter"," "].includes(e.key)&&n!==null&&(this.setActiveTab(n,{scrollBehavior:"smooth"}),e.preventDefault()),["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(e.key))){const i=this.tabs.find(a=>a.matches(":focus")),s=this.localize.dir()==="rtl";if((i==null?void 0:i.tagName.toLowerCase())==="sl-tab"){let a=this.tabs.indexOf(i);e.key==="Home"?a=0:e.key==="End"?a=this.tabs.length-1:["top","bottom"].includes(this.placement)&&e.key===(s?"ArrowRight":"ArrowLeft")||["start","end"].includes(this.placement)&&e.key==="ArrowUp"?a--:(["top","bottom"].includes(this.placement)&&e.key===(s?"ArrowLeft":"ArrowRight")||["start","end"].includes(this.placement)&&e.key==="ArrowDown")&&a++,a<0&&(a=this.tabs.length-1),a>this.tabs.length-1&&(a=0),this.tabs[a].focus({preventScroll:!0}),this.activation==="auto"&&this.setActiveTab(this.tabs[a],{scrollBehavior:"smooth"}),["top","bottom"].includes(this.placement)&&JG(this.tabs[a],this.nav,"horizontal"),e.preventDefault()}}}handleScrollToStart(){this.nav.scroll({left:this.localize.dir()==="rtl"?this.nav.scrollLeft+this.nav.clientWidth:this.nav.scrollLeft-this.nav.clientWidth,behavior:"smooth"})}handleScrollToEnd(){this.nav.scroll({left:this.localize.dir()==="rtl"?this.nav.scrollLeft-this.nav.clientWidth:this.nav.scrollLeft+this.nav.clientWidth,behavior:"smooth"})}setActiveTab(e,t){if(t=BSe({emitEvents:!0,scrollBehavior:"auto"},t),e!==this.activeTab&&!e.disabled){const n=this.activeTab;this.activeTab=e,this.tabs.forEach(r=>r.active=r===this.activeTab),this.panels.forEach(r=>{var i;return r.active=r.name===((i=this.activeTab)==null?void 0:i.panel)}),this.syncIndicator(),["top","bottom"].includes(this.placement)&&JG(this.activeTab,this.nav,"horizontal",t.scrollBehavior),t.emitEvents&&(n&&this.emit("sl-tab-hide",{detail:{name:n.panel}}),this.emit("sl-tab-show",{detail:{name:this.activeTab.panel}}))}}setAriaLabels(){this.tabs.forEach(e=>{const t=this.panels.find(n=>n.name===e.panel);t&&(e.setAttribute("aria-controls",t.getAttribute("id")),t.setAttribute("aria-labelledby",e.getAttribute("id")))})}repositionIndicator(){const e=this.getActiveTab();if(!e)return;const t=e.clientWidth,n=e.clientHeight,r=this.localize.dir()==="rtl",i=this.getAllTabs(),a=i.slice(0,i.indexOf(e)).reduce((o,l)=>({left:o.left+l.clientWidth,top:o.top+l.clientHeight}),{left:0,top:0});switch(this.placement){case"top":case"bottom":this.indicator.style.width=`${t}px`,this.indicator.style.height="auto",this.indicator.style.translate=r?`${-1*a.left}px`:`${a.left}px`;break;case"start":case"end":this.indicator.style.width="auto",this.indicator.style.height=`${n}px`,this.indicator.style.translate=`0 ${a.top}px`;break}}syncTabsAndPanels(){this.tabs=this.getAllTabs({includeDisabled:!1}),this.panels=this.getAllPanels(),this.syncIndicator(),this.updateComplete.then(()=>this.updateScrollControls())}updateScrollControls(){this.noScrollControls?this.hasScrollControls=!1:this.hasScrollControls=["top","bottom"].includes(this.placement)&&this.nav.scrollWidth>this.nav.clientWidth}syncIndicator(){this.getActiveTab()?(this.indicator.style.display="block",this.repositionIndicator()):this.indicator.style.display="none"}show(e){const t=this.tabs.find(n=>n.panel===e);t&&this.setActiveTab(t,{scrollBehavior:"smooth"})}render(){const e=this.localize.dir()==="rtl";return de`
      <div
        part="base"
        class=${Ar({"tab-group":!0,"tab-group--top":this.placement==="top","tab-group--bottom":this.placement==="bottom","tab-group--start":this.placement==="start","tab-group--end":this.placement==="end","tab-group--rtl":this.localize.dir()==="rtl","tab-group--has-scroll-controls":this.hasScrollControls})}
        @click=${this.handleClick}
        @keydown=${this.handleKeyDown}
      >
        <div class="tab-group__nav-container" part="nav">
          ${this.hasScrollControls?de`
                <sl-icon-button
                  part="scroll-button scroll-button--start"
                  exportparts="base:scroll-button__base"
                  class="tab-group__scroll-button tab-group__scroll-button--start"
                  name=${e?"chevron-right":"chevron-left"}
                  library="system"
                  label=${this.localize.term("scrollToStart")}
                  @click=${this.handleScrollToStart}
                ></sl-icon-button>
              `:""}

          <div class="tab-group__nav">
            <div part="tabs" class="tab-group__tabs" role="tablist">
              <div part="active-tab-indicator" class="tab-group__indicator"></div>
              <slot name="nav" @slotchange=${this.syncTabsAndPanels}></slot>
            </div>
          </div>

          ${this.hasScrollControls?de`
                <sl-icon-button
                  part="scroll-button scroll-button--end"
                  exportparts="base:scroll-button__base"
                  class="tab-group__scroll-button tab-group__scroll-button--end"
                  name=${e?"chevron-left":"chevron-right"}
                  library="system"
                  label=${this.localize.term("scrollToEnd")}
                  @click=${this.handleScrollToEnd}
                ></sl-icon-button>
              `:""}
        </div>

        <slot part="body" class="tab-group__body" @slotchange=${this.syncTabsAndPanels}></slot>
      </div>
    `}};Ul.styles=QQe;H([gt(".tab-group")],Ul.prototype,"tabGroup",2);H([gt(".tab-group__body")],Ul.prototype,"body",2);H([gt(".tab-group__nav")],Ul.prototype,"nav",2);H([gt(".tab-group__indicator")],Ul.prototype,"indicator",2);H([Ir()],Ul.prototype,"hasScrollControls",2);H([J()],Ul.prototype,"placement",2);H([J()],Ul.prototype,"activation",2);H([J({attribute:"no-scroll-controls",type:Boolean})],Ul.prototype,"noScrollControls",2);H([Jt("noScrollControls",{waitUntilFirstUpdate:!0})],Ul.prototype,"updateScrollControls",1);H([Jt("placement",{waitUntilFirstUpdate:!0})],Ul.prototype,"syncIndicator",1);Ul=H([Ue("sl-tab-group")],Ul);var JQe=Qt`
  ${Nr}

  :host {
    --padding: 0;

    display: none;
  }

  :host([active]) {
    display: block;
  }

  .tab-panel {
    display: block;
    padding: var(--padding);
  }
`;let eJe=0,Sw=class extends nr{constructor(){super(...arguments),this.attrId=++eJe,this.componentId=`sl-tab-panel-${this.attrId}`,this.name="",this.active=!1}connectedCallback(){super.connectedCallback(),this.id=this.id.length>0?this.id:this.componentId,this.setAttribute("role","tabpanel")}handleActiveChange(){this.setAttribute("aria-hidden",this.active?"false":"true")}render(){return de`
      <slot
        part="base"
        class=${Ar({"tab-panel":!0,"tab-panel--active":this.active})}
      ></slot>
    `}};Sw.styles=JQe;H([J({reflect:!0})],Sw.prototype,"name",2);H([J({type:Boolean,reflect:!0})],Sw.prototype,"active",2);H([Jt("active")],Sw.prototype,"handleActiveChange",1);Sw=H([Ue("sl-tab-panel")],Sw);var tJe=Qt`
  ${Nr}

  :host {
    --max-width: 20rem;
    --hide-delay: 0ms;
    --show-delay: 150ms;

    display: contents;
  }

  .tooltip {
    --arrow-size: var(--sl-tooltip-arrow-size);
    --arrow-color: var(--sl-tooltip-background-color);
  }

  .tooltip::part(popup) {
    pointer-events: none;
    z-index: var(--sl-z-index-tooltip);
  }

  .tooltip[placement^='top']::part(popup) {
    transform-origin: bottom;
  }

  .tooltip[placement^='bottom']::part(popup) {
    transform-origin: top;
  }

  .tooltip[placement^='left']::part(popup) {
    transform-origin: right;
  }

  .tooltip[placement^='right']::part(popup) {
    transform-origin: left;
  }

  .tooltip__body {
    display: block;
    width: max-content;
    max-width: var(--max-width);
    border-radius: var(--sl-tooltip-border-radius);
    background-color: var(--sl-tooltip-background-color);
    font-family: var(--sl-tooltip-font-family);
    font-size: var(--sl-tooltip-font-size);
    font-weight: var(--sl-tooltip-font-weight);
    line-height: var(--sl-tooltip-line-height);
    color: var(--sl-tooltip-color);
    padding: var(--sl-tooltip-padding);
    pointer-events: none;
  }
`;let js=class extends nr{constructor(){super(),this.localize=new Co(this),this.content="",this.placement="top",this.disabled=!1,this.distance=8,this.open=!1,this.skidding=0,this.trigger="hover focus",this.hoist=!1,this.handleBlur=()=>{this.hasTrigger("focus")&&this.hide()},this.handleClick=()=>{this.hasTrigger("click")&&(this.open?this.hide():this.show())},this.handleFocus=()=>{this.hasTrigger("focus")&&this.show()},this.handleKeyDown=e=>{this.open&&e.key==="Escape"&&(e.stopPropagation(),this.hide())},this.handleMouseOver=()=>{if(this.hasTrigger("hover")){const e=Sde(getComputedStyle(this).getPropertyValue("--show-delay"));clearTimeout(this.hoverTimeout),this.hoverTimeout=window.setTimeout(()=>this.show(),e)}},this.handleMouseOut=()=>{if(this.hasTrigger("hover")){const e=Sde(getComputedStyle(this).getPropertyValue("--hide-delay"));clearTimeout(this.hoverTimeout),this.hoverTimeout=window.setTimeout(()=>this.hide(),e)}},this.addEventListener("blur",this.handleBlur,!0),this.addEventListener("focus",this.handleFocus,!0),this.addEventListener("click",this.handleClick),this.addEventListener("keydown",this.handleKeyDown),this.addEventListener("mouseover",this.handleMouseOver),this.addEventListener("mouseout",this.handleMouseOut)}connectedCallback(){super.connectedCallback()}firstUpdated(){this.body.hidden=!this.open,this.open&&(this.popup.active=!0,this.popup.reposition())}hasTrigger(e){return this.trigger.split(" ").includes(e)}async handleOpenChange(){if(this.open){if(this.disabled)return;this.emit("sl-show"),await ga(this.body),this.body.hidden=!1,this.popup.active=!0;const{keyframes:e,options:t}=Zi(this,"tooltip.show",{dir:this.localize.dir()});await Ki(this.popup.popup,e,t),this.emit("sl-after-show")}else{this.emit("sl-hide"),await ga(this.body);const{keyframes:e,options:t}=Zi(this,"tooltip.hide",{dir:this.localize.dir()});await Ki(this.popup.popup,e,t),this.popup.active=!1,this.body.hidden=!0,this.emit("sl-after-hide")}}async handleOptionsChange(){this.hasUpdated&&(await this.updateComplete,this.popup.reposition())}handleDisabledChange(){this.disabled&&this.open&&this.hide()}async show(){if(!this.open)return this.open=!0,Iu(this,"sl-after-show")}async hide(){if(!!this.open)return this.open=!1,Iu(this,"sl-after-hide")}render(){return de`
      <sl-popup
        part="base"
        exportparts="
          popup:base__popup,
          arrow:base__arrow
        "
        class=${Ar({tooltip:!0,"tooltip--open":this.open})}
        placement=${this.placement}
        distance=${this.distance}
        skidding=${this.skidding}
        strategy=${this.hoist?"fixed":"absolute"}
        flip
        shift
        arrow
      >
        <slot slot="anchor" aria-describedby="tooltip"></slot>

        <slot
          name="content"
          part="body"
          id="tooltip"
          class="tooltip__body"
          role="tooltip"
          aria-live=${this.open?"polite":"off"}
        >
          ${this.content}
        </slot>
      </sl-popup>
    `}};js.styles=tJe;H([gt("slot:not([name])")],js.prototype,"defaultSlot",2);H([gt(".tooltip__body")],js.prototype,"body",2);H([gt("sl-popup")],js.prototype,"popup",2);H([J()],js.prototype,"content",2);H([J()],js.prototype,"placement",2);H([J({type:Boolean,reflect:!0})],js.prototype,"disabled",2);H([J({type:Number})],js.prototype,"distance",2);H([J({type:Boolean,reflect:!0})],js.prototype,"open",2);H([J({type:Number})],js.prototype,"skidding",2);H([J()],js.prototype,"trigger",2);H([J({type:Boolean})],js.prototype,"hoist",2);H([Jt("open",{waitUntilFirstUpdate:!0})],js.prototype,"handleOpenChange",1);H([Jt(["content","distance","hoist","placement","skidding"])],js.prototype,"handleOptionsChange",1);H([Jt("disabled")],js.prototype,"handleDisabledChange",1);js=H([Ue("sl-tooltip")],js);Mr("tooltip.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:150,easing:"ease"}});Mr("tooltip.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:150,easing:"ease"}});const fke=new WeakMap;function nJe(e,t){let n=t;for(;n;){if(fke.get(n)===e)return!0;n=Object.getPrototypeOf(n)}return!1}function rJe(e){return t=>{if(nJe(e,t))return t;const n=e(t);return fke.set(n,e),n}}const zF=!!ShadowRoot.prototype.createElement,iJe=e=>class extends e{static get scopedElements(){return{}}static get shadowRootOptions(){return this.__shadowRootOptions}static set shadowRootOptions(n){this.__shadowRootOptions=n}static get elementStyles(){return this.__elementStyles}static set elementStyles(n){this.__elementStyles=n}constructor(...n){super(),this.renderOptions=this.renderOptions||void 0}get registry(){return this.constructor.__registry}set registry(n){this.constructor.__registry=n}createRenderRoot(){const{scopedElements:n,shadowRootOptions:r,elementStyles:i}=this.constructor;if(!this.registry||this.registry===this.constructor.__registry&&!Object.prototype.hasOwnProperty.call(this.constructor,"__registry")){this.registry=zF?new CustomElementRegistry:customElements;for(const[l,u]of Object.entries(n))this.defineScopedElement(l,u)}const a={mode:"open",...r,customElements:this.registry},o=this.attachShadow(a);return zF&&(this.renderOptions.creationScope=o),o instanceof ShadowRoot&&(USe(o,i),this.renderOptions.renderBefore=this.renderOptions.renderBefore||o.firstChild),o}createScopedElement(n){return(zF?this.shadowRoot:document).createElement(n)}defineScopedElement(n,r){const i=this.registry.get(n);return i&&zF===!1&&i!==r&&console.error([`You are trying to re-register the "${n}" custom element with a different class via ScopedElementsMixin.`,"This is only possible with a CustomElementRegistry.","Your browser does not support this feature so you will need to load a polyfill for it.",'Load "@webcomponents/scoped-custom-element-registry" before you register ANY web component to the global customElements registry.','e.g. add "<script src="/node_modules/@webcomponents/scoped-custom-element-registry/scoped-custom-element-registry.min.js"><\/script>" as your first script tag.',"For more details you can visit https://open-wc.org/docs/development/scoped-elements/"].join(`
`)),i?this.registry.get(n):this.registry.define(n,r)}getScopedTagName(n){return this.constructor.getScopedTagName(n)}static getScopedTagName(n){return this.__registry.get(n)?n:void 0}},hke=rJe(iJe);var sJe=Object.defineProperty,aJe=Object.getOwnPropertyDescriptor,bee=(e,t,n,r)=>{for(var i=r>1?void 0:r?aJe(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&sJe(t,n,i),i};class St extends hke(Y1){connectedCallback(){super.connectedCallback(),this.getAttributeNames().forEach(t=>this.setAttribute(t,this.getAttribute(t)))}}St.shadowRootOptions={...hke(Y1).shadowRootOptions,delegatesFocus:!0};bee([J({type:Boolean,attribute:!0,reflect:!0})],St.prototype,"printable",2);bee([J({type:Boolean,attribute:!0,reflect:!0})],St.prototype,"editable",2);bee([J({type:Boolean,attribute:!0,reflect:!0})],St.prototype,"analyzable",2);const kt=Qt`
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: var(--sl-font-sans);
  }

  h1,
  h2,
  h3,
  h4 {
    text-transform: uppercase;
    margin: 10px 0 15px 0;
  }

  h1 {
    font-size: 18px;
  }

  h2 {
    font-size: 16px;
  }

  h3 {
    font-size: 14px;
  }

  h4 {
    font-size: 12px;
  }

  .hidden {
    display: none !important;
  }
`;var oJe=Object.defineProperty,lJe=Object.getOwnPropertyDescriptor,uJe=(e,t,n,r)=>{for(var i=r>1?void 0:r?lJe(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&oJe(t,n,i),i};let rY=class extends St{render(){return de`
      <div class="c-button-group">
        <slot></slot>
      </div>
    `}};rY.styles=[kt,Qt`
      .c-button-group {
        width: 100%;
        display: flex;
        justify-content: space-between;
        gap: 20px;
      }

      .c-button-group ::slotted(*) {
        flex-grow: 1;
      }
    `];rY=uJe([Ue("c-button-group")],rY);var cJe=Object.defineProperty,fJe=Object.getOwnPropertyDescriptor,hJe=(e,t,n,r)=>{for(var i=r>1?void 0:r?fJe(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&cJe(t,n,i),i};let iY=class extends St{render(){return de`
      <sl-card class="c-card">
        <h1><slot name="title"></slot></h1>
        <slot name="content"> </slot>
      </sl-card>
    `}};iY.styles=[kt,Qt`
      :host {
        width: 100%;
      }

      .c-card {
        --padding: 10px 20px 20px 20px;
        margin: 0;
        width: 100%;
      }

      .c-card ::slotted(*[slot='content']) {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
    `];iY=hJe([Ue("c-card")],iY);function sY(e){return e.type=="classification"}function dke(e){return e.type=="regression"}var dJe=Object.defineProperty,pJe=Object.getOwnPropertyDescriptor,pke=(e,t,n,r)=>{for(var i=r>1?void 0:r?pJe(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&dJe(t,n,i),i};let s5=class extends St{getTooltipContent(){if(this.dataProperty.type){if(dke(this.dataProperty))return de`
          <p>Type: regression</p>
          <p>${this.dataProperty.description}</p>
        `;if(sY(this.dataProperty))return de`
          <p>Type: classification</p>
          <p>${this.dataProperty.description}</p>
          ${this.dataProperty.classes.map(e=>de` <p>${e.key}: ${e.description}</p> `)}
        `}else return de` <p>${this.dataProperty.description}</p> `}render(){return de`
      <sl-tooltip>
        <div slot="content">${this.getTooltipContent()}</div>
        <sl-tag pill> ${this.dataProperty.key} </sl-tag>
      </sl-tooltip>
    `}};s5.styles=[kt];pke([J({type:Object})],s5.prototype,"dataProperty",2);s5=pke([Ue("c-data-info")],s5);/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class gJe extends Event{constructor(t,n,r){super("context-request",{bubbles:!0,composed:!0}),this.context=t,this.callback=n,this.subscribe=r}}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 *//**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class mJe{constructor(t,n,r,i){var s;if(this.subscribe=!1,this.provided=!1,this.value=void 0,this.t=(a,o)=>{this.unsubscribe&&(this.unsubscribe!==o&&(this.provided=!1,this.unsubscribe()),this.subscribe||this.unsubscribe()),this.value=a,this.host.requestUpdate(),this.provided&&!this.subscribe||(this.provided=!0,this.callback&&this.callback(a,o)),this.unsubscribe=o},this.host=t,n.context!==void 0){const a=n;this.context=a.context,this.callback=a.callback,this.subscribe=(s=a.subscribe)!==null&&s!==void 0&&s}else this.context=n,this.callback=r,this.subscribe=i!=null&&i;this.host.addController(this)}hostConnected(){this.dispatchRequest()}hostDisconnected(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=void 0)}dispatchRequest(){this.host.dispatchEvent(new gJe(this.context,this.t,this.subscribe))}}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class vJe{constructor(t){this.disposers=new Map,this.updateObservers=()=>{for(const[n,r]of this.disposers)n(this.o,r)},t!==void 0&&(this.value=t)}get value(){return this.o}set value(t){this.setValue(t)}setValue(t,n=!1){const r=n||!Object.is(t,this.o);this.o=t,r&&this.updateObservers()}addCallback(t,n){if(n){this.disposers.has(t)||this.disposers.set(t,()=>{this.disposers.delete(t)});const r=this.disposers.get(t);t(this.value,r)}else t(this.value)}clearCallbacks(){this.disposers.clear()}}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class yJe extends Event{constructor(t){super("context-provider",{bubbles:!0,composed:!0}),this.context=t}}class bJe extends vJe{constructor(t,n,r){super(n.context!==void 0?n.initialValue:r),this.onContextRequest=i=>{i.context===this.context&&i.composedPath()[0]!==this.host&&(i.stopPropagation(),this.addCallback(i.callback,i.subscribe))},this.host=t,n.context!==void 0?this.context=n.context:this.context=n,this.attachListeners(),this.host.addController(this)}attachListeners(){this.host.addEventListener("context-request",this.onContextRequest)}hostConnected(){this.host.dispatchEvent(new yJe(this.context))}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Mb({context:e}){return ZB({finisher:(t,n)=>{const r=new WeakMap;t.addInitializer(o=>{r.set(o,new bJe(o,{context:e}))});const i=Object.getOwnPropertyDescriptor(t.prototype,n),s=i==null?void 0:i.set,a={...i,set:function(o){var l;(l=r.get(this))===null||l===void 0||l.setValue(o),s&&s.call(this,o)}};Object.defineProperty(t.prototype,n,a)}})}/**
 * @license
 * Copyright 2022 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function En({context:e,subscribe:t}){return ZB({finisher:(n,r)=>{n.addInitializer(i=>{new mJe(i,{context:e,callback:s=>{i[r]=s},subscribe:t})})}})}var mt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fb(e){var t=e.default;if(typeof t=="function"){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}function xJe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var nI=xJe,wJe=typeof mt=="object"&&mt&&mt.Object===Object&&mt,$Je=wJe,CJe=$Je,_Je=typeof self=="object"&&self&&self.Object===Object&&self,SJe=CJe||_Je||Function("return this")(),i8=SJe,kJe=i8,EJe=function(){return kJe.Date.now()},AJe=EJe,TJe=/\s/;function DJe(e){for(var t=e.length;t--&&TJe.test(e.charAt(t)););return t}var IJe=DJe,NJe=IJe,MJe=/^\s+/;function FJe(e){return e&&e.slice(0,NJe(e)+1).replace(MJe,"")}var OJe=FJe,RJe=i8,PJe=RJe.Symbol,xee=PJe,Rde=xee,gke=Object.prototype,LJe=gke.hasOwnProperty,BJe=gke.toString,WS=Rde?Rde.toStringTag:void 0;function zJe(e){var t=LJe.call(e,WS),n=e[WS];try{e[WS]=void 0;var r=!0}catch{}var i=BJe.call(e);return r&&(t?e[WS]=n:delete e[WS]),i}var UJe=zJe,WJe=Object.prototype,VJe=WJe.toString;function jJe(e){return VJe.call(e)}var HJe=jJe,Pde=xee,qJe=UJe,GJe=HJe,YJe="[object Null]",XJe="[object Undefined]",Lde=Pde?Pde.toStringTag:void 0;function KJe(e){return e==null?e===void 0?XJe:YJe:Lde&&Lde in Object(e)?qJe(e):GJe(e)}var mke=KJe;function ZJe(e){return e!=null&&typeof e=="object"}var QJe=ZJe,JJe=mke,eet=QJe,tet="[object Symbol]";function net(e){return typeof e=="symbol"||eet(e)&&JJe(e)==tet}var rI=net,ret=OJe,Bde=nI,iet=rI,zde=0/0,set=/^[-+]0x[0-9a-f]+$/i,aet=/^0b[01]+$/i,oet=/^0o[0-7]+$/i,uet=parseInt;function cet(e){if(typeof e=="number")return e;if(iet(e))return zde;if(Bde(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Bde(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=ret(e);var n=aet.test(e);return n||oet.test(e)?uet(e.slice(2),n?2:8):set.test(e)?zde:+e}var fet=cet,het=nI,jV=AJe,Ude=fet,det="Expected a function",pet=Math.max,get=Math.min;function met(e,t,n){var r,i,s,a,o,l,u=0,c=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(det);t=Ude(t)||0,het(n)&&(c=!!n.leading,f="maxWait"in n,s=f?pet(Ude(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h);function d(C){var $=r,_=i;return r=i=void 0,u=C,a=e.apply(_,$),a}function p(C){return u=C,o=setTimeout(v,t),c?d(C):a}function g(C){var $=C-l,_=C-u,k=t-$;return f?get(k,s-_):k}function m(C){var $=C-l,_=C-u;return l===void 0||$>=t||$<0||f&&_>=s}function v(){var C=jV();if(m(C))return y(C);o=setTimeout(v,g(C))}function y(C){return o=void 0,h&&r?d(C):(r=i=void 0,a)}function b(){o!==void 0&&clearTimeout(o),u=0,r=l=i=o=void 0}function x(){return o===void 0?a:y(jV())}function w(){var C=jV(),$=m(C);if(r=arguments,i=this,l=C,$){if(o===void 0)return p(l);if(f)return clearTimeout(o),o=setTimeout(v,t),d(l)}return o===void 0&&(o=setTimeout(v,t)),a}return w.cancel=b,w.flush=x,w}var vet=met,vke={exports:{}},yke={exports:{}};(function(e,t){(function(){var n,r,i,s,a,o,l,u,c,f,h,d,p,g,m;i=Math.floor,f=Math.min,r=function(v,y){return v<y?-1:v>y?1:0},c=function(v,y,b,x,w){var C;if(b==null&&(b=0),w==null&&(w=r),b<0)throw new Error("lo must be non-negative");for(x==null&&(x=v.length);b<x;)C=i((b+x)/2),w(y,v[C])<0?x=C:b=C+1;return[].splice.apply(v,[b,b-b].concat(y)),y},o=function(v,y,b){return b==null&&(b=r),v.push(y),g(v,0,v.length-1,b)},a=function(v,y){var b,x;return y==null&&(y=r),b=v.pop(),v.length?(x=v[0],v[0]=b,m(v,0,y)):x=b,x},u=function(v,y,b){var x;return b==null&&(b=r),x=v[0],v[0]=y,m(v,0,b),x},l=function(v,y,b){var x;return b==null&&(b=r),v.length&&b(v[0],y)<0&&(x=[v[0],y],y=x[0],v[0]=x[1],m(v,0,b)),y},s=function(v,y){var b,x,w,C,$,_;for(y==null&&(y=r),C=function(){_=[];for(var k=0,E=i(v.length/2);0<=E?k<E:k>E;0<=E?k++:k--)_.push(k);return _}.apply(this).reverse(),$=[],x=0,w=C.length;x<w;x++)b=C[x],$.push(m(v,b,y));return $},p=function(v,y,b){var x;if(b==null&&(b=r),x=v.indexOf(y),x!==-1)return g(v,0,x,b),m(v,x,b)},h=function(v,y,b){var x,w,C,$,_;if(b==null&&(b=r),w=v.slice(0,y),!w.length)return w;for(s(w,b),_=v.slice(y),C=0,$=_.length;C<$;C++)x=_[C],l(w,x,b);return w.sort(b).reverse()},d=function(v,y,b){var x,w,C,$,_,k,E,S,I;if(b==null&&(b=r),y*10<=v.length){if(C=v.slice(0,y).sort(b),!C.length)return C;for(w=C[C.length-1],E=v.slice(y),$=0,k=E.length;$<k;$++)x=E[$],b(x,w)<0&&(c(C,x,0,null,b),C.pop(),w=C[C.length-1]);return C}for(s(v,b),I=[],_=0,S=f(y,v.length);0<=S?_<S:_>S;0<=S?++_:--_)I.push(a(v,b));return I},g=function(v,y,b,x){var w,C,$;for(x==null&&(x=r),w=v[b];b>y;){if($=b-1>>1,C=v[$],x(w,C)<0){v[b]=C,b=$;continue}break}return v[b]=w},m=function(v,y,b){var x,w,C,$,_;for(b==null&&(b=r),w=v.length,_=y,C=v[y],x=2*y+1;x<w;)$=x+1,$<w&&!(b(v[x],v[$])<0)&&(x=$),v[y]=v[x],y=x,x=2*y+1;return v[y]=C,g(v,_,y,b)},n=function(){v.push=o,v.pop=a,v.replace=u,v.pushpop=l,v.heapify=s,v.updateItem=p,v.nlargest=h,v.nsmallest=d;function v(y){this.cmp=y!=null?y:r,this.nodes=[]}return v.prototype.push=function(y){return o(this.nodes,y,this.cmp)},v.prototype.pop=function(){return a(this.nodes,this.cmp)},v.prototype.peek=function(){return this.nodes[0]},v.prototype.contains=function(y){return this.nodes.indexOf(y)!==-1},v.prototype.replace=function(y){return u(this.nodes,y,this.cmp)},v.prototype.pushpop=function(y){return l(this.nodes,y,this.cmp)},v.prototype.heapify=function(){return s(this.nodes,this.cmp)},v.prototype.updateItem=function(y){return p(this.nodes,y,this.cmp)},v.prototype.clear=function(){return this.nodes=[]},v.prototype.empty=function(){return this.nodes.length===0},v.prototype.size=function(){return this.nodes.length},v.prototype.clone=function(){var y;return y=new v,y.nodes=this.nodes.slice(0),y},v.prototype.toArray=function(){return this.nodes.slice(0)},v.prototype.insert=v.prototype.push,v.prototype.top=v.prototype.peek,v.prototype.front=v.prototype.peek,v.prototype.has=v.prototype.contains,v.prototype.copy=v.prototype.clone,v}(),function(v,y){return e.exports=y()}(this,function(){return n})}).call(mt)})(yke);(function(e){e.exports=yke.exports})(vke);var yet=Array.isArray,s8=yet,bet=s8,xet=rI,wet=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$et=/^\w*$/;function Cet(e,t){if(bet(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||xet(e)?!0:$et.test(e)||!wet.test(e)||t!=null&&e in Object(t)}var _et=Cet,ket=mke,Eet=nI,Aet="[object AsyncFunction]",Tet="[object Function]",Det="[object GeneratorFunction]",Iet="[object Proxy]";function Net(e){if(!Eet(e))return!1;var t=ket(e);return t==Tet||t==Det||t==Aet||t==Iet}var Met=Net,Fet=i8,Oet=Fet["__core-js_shared__"],Ret=Oet,HV=Ret,Wde=function(){var e=/[^.]+$/.exec(HV&&HV.keys&&HV.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Pet(e){return!!Wde&&Wde in e}var Let=Pet,Bet=Function.prototype,zet=Bet.toString;function Uet(e){if(e!=null){try{return zet.call(e)}catch{}try{return e+""}catch{}}return""}var Wet=Uet,Vet=Met,jet=Let,Het=nI,qet=Wet,Get=/[\\^$.*+?()[\]{}|]/g,Yet=/^\[object .+?Constructor\]$/,Xet=Function.prototype,Ket=Object.prototype,Zet=Xet.toString,Qet=Ket.hasOwnProperty,Jet=RegExp("^"+Zet.call(Qet).replace(Get,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ett(e){if(!Het(e)||jet(e))return!1;var t=Vet(e)?Jet:Yet;return t.test(qet(e))}var ttt=ett;function ntt(e,t){return e==null?void 0:e[t]}var rtt=ntt,itt=ttt,stt=rtt;function att(e,t){var n=stt(e,t);return itt(n)?n:void 0}var wee=att,ott=wee,ltt=ott(Object,"create"),a8=ltt,Vde=a8;function utt(){this.__data__=Vde?Vde(null):{},this.size=0}var ctt=utt;function ftt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var htt=ftt,dtt=a8,ptt="__lodash_hash_undefined__",gtt=Object.prototype,mtt=gtt.hasOwnProperty;function vtt(e){var t=this.__data__;if(dtt){var n=t[e];return n===ptt?void 0:n}return mtt.call(t,e)?t[e]:void 0}var ytt=vtt,btt=a8,xtt=Object.prototype,wtt=xtt.hasOwnProperty;function $tt(e){var t=this.__data__;return btt?t[e]!==void 0:wtt.call(t,e)}var Ctt=$tt,_tt=a8,Stt="__lodash_hash_undefined__";function ktt(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=_tt&&t===void 0?Stt:t,this}var Ett=ktt,Att=ctt,Ttt=htt,Dtt=ytt,Itt=Ctt,Ntt=Ett;function mC(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}mC.prototype.clear=Att;mC.prototype.delete=Ttt;mC.prototype.get=Dtt;mC.prototype.has=Itt;mC.prototype.set=Ntt;var Mtt=mC;function Ftt(){this.__data__=[],this.size=0}var Ott=Ftt;function Rtt(e,t){return e===t||e!==e&&t!==t}var bke=Rtt,Ptt=bke;function Ltt(e,t){for(var n=e.length;n--;)if(Ptt(e[n][0],t))return n;return-1}var o8=Ltt,Btt=o8,ztt=Array.prototype,Utt=ztt.splice;function Wtt(e){var t=this.__data__,n=Btt(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Utt.call(t,n,1),--this.size,!0}var Vtt=Wtt,jtt=o8;function Htt(e){var t=this.__data__,n=jtt(t,e);return n<0?void 0:t[n][1]}var qtt=Htt,Gtt=o8;function Ytt(e){return Gtt(this.__data__,e)>-1}var Xtt=Ytt,Ktt=o8;function Ztt(e,t){var n=this.__data__,r=Ktt(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var Qtt=Ztt,Jtt=Ott,ent=Vtt,tnt=qtt,nnt=Xtt,rnt=Qtt;function vC(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}vC.prototype.clear=Jtt;vC.prototype.delete=ent;vC.prototype.get=tnt;vC.prototype.has=nnt;vC.prototype.set=rnt;var int=vC,snt=wee,ant=i8,ont=snt(ant,"Map"),lnt=ont,jde=Mtt,unt=int,cnt=lnt;function fnt(){this.size=0,this.__data__={hash:new jde,map:new(cnt||unt),string:new jde}}var hnt=fnt;function dnt(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var pnt=dnt,gnt=pnt;function mnt(e,t){var n=e.__data__;return gnt(t)?n[typeof t=="string"?"string":"hash"]:n.map}var l8=mnt,vnt=l8;function ynt(e){var t=vnt(this,e).delete(e);return this.size-=t?1:0,t}var bnt=ynt,xnt=l8;function wnt(e){return xnt(this,e).get(e)}var $nt=wnt,Cnt=l8;function _nt(e){return Cnt(this,e).has(e)}var Snt=_nt,knt=l8;function Ent(e,t){var n=knt(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var Ant=Ent,Tnt=hnt,Dnt=bnt,Int=$nt,Nnt=Snt,Mnt=Ant;function yC(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}yC.prototype.clear=Tnt;yC.prototype.delete=Dnt;yC.prototype.get=Int;yC.prototype.has=Nnt;yC.prototype.set=Mnt;var Fnt=yC,xke=Fnt,Ont="Expected a function";function $ee(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Ont);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var a=e.apply(this,r);return n.cache=s.set(i,a)||s,a};return n.cache=new($ee.Cache||xke),n}$ee.Cache=xke;var Rnt=$ee,Pnt=Rnt,Lnt=500;function Bnt(e){var t=Pnt(e,function(r){return n.size===Lnt&&n.clear(),r}),n=t.cache;return t}var znt=Bnt,Unt=znt,Wnt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Vnt=/\\(\\)?/g,jnt=Unt(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Wnt,function(n,r,i,s){t.push(i?s.replace(Vnt,"$1"):r||n)}),t}),wke=jnt;function Hnt(e,t){for(var n=-1,r=e==null?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var $ke=Hnt,Hde=xee,qnt=$ke,Gnt=s8,Ynt=rI,Xnt=1/0,qde=Hde?Hde.prototype:void 0,Gde=qde?qde.toString:void 0;function Cke(e){if(typeof e=="string")return e;if(Gnt(e))return qnt(e,Cke)+"";if(Ynt(e))return Gde?Gde.call(e):"";var t=e+"";return t=="0"&&1/e==-Xnt?"-0":t}var Knt=Cke,Znt=Knt;function Qnt(e){return e==null?"":Znt(e)}var _ke=Qnt,Jnt=s8,ert=_et,trt=wke,nrt=_ke;function rrt(e,t){return Jnt(e)?e:ert(e,t)?[e]:trt(nrt(e))}var Ske=rrt,irt=rI,srt=1/0;function art(e){if(typeof e=="string"||irt(e))return e;var t=e+"";return t=="0"&&1/e==-srt?"-0":t}var Cee=art,ort=Ske,lrt=Cee;function urt(e,t){t=ort(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[lrt(t[n++])];return n&&n==r?e:void 0}var crt=urt,frt=crt;function hrt(e,t,n){var r=e==null?void 0:frt(e,t);return r===void 0?n:r}var drt=hrt,prt=wee,grt=function(){try{var e=prt(Object,"defineProperty");return e({},"",{}),e}catch{}}(),mrt=grt,Yde=mrt;function vrt(e,t,n){t=="__proto__"&&Yde?Yde(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var yrt=vrt,brt=yrt,xrt=bke,wrt=Object.prototype,$rt=wrt.hasOwnProperty;function Crt(e,t,n){var r=e[t];(!($rt.call(e,t)&&xrt(r,n))||n===void 0&&!(t in e))&&brt(e,t,n)}var _rt=Crt,Srt=9007199254740991,krt=/^(?:0|[1-9]\d*)$/;function Ert(e,t){var n=typeof e;return t=t==null?Srt:t,!!t&&(n=="number"||n!="symbol"&&krt.test(e))&&e>-1&&e%1==0&&e<t}var Art=Ert,Trt=_rt,Drt=Ske,Irt=Art,Xde=nI,Nrt=Cee;function Mrt(e,t,n,r){if(!Xde(e))return e;t=Drt(t,e);for(var i=-1,s=t.length,a=s-1,o=e;o!=null&&++i<s;){var l=Nrt(t[i]),u=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(i!=a){var c=o[l];u=r?r(c,l,o):void 0,u===void 0&&(u=Xde(c)?c:Irt(t[i+1])?[]:{})}Trt(o,l,u),o=o[l]}return e}var Frt=Mrt,Ort=Frt;function Rrt(e,t,n){return e==null?e:Ort(e,t,n)}var Prt=Rrt;function Lrt(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var Brt=Lrt,zrt=$ke,Urt=Brt,Wrt=s8,Vrt=rI,jrt=wke,Hrt=Cee,qrt=_ke;function Grt(e){return Wrt(e)?zrt(e,Hrt):Vrt(e)?[e]:Urt(jrt(qrt(e)))}var Yrt=Grt,Xrt=vet,Krt=vke.exports,Zrt=drt,Qrt=Prt,Jrt=Yrt;function iI(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var u8=iI(Xrt),sI=iI(Krt),eit=iI(Zrt),tit=iI(Qrt),nit=iI(Jrt);function Mi(e){return Mi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mi(e)}function _ee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kde(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function See(e,t,n){return t&&Kde(e.prototype,t),n&&Kde(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rd(e,t){return rit(e)||iit(e,t)||sit(e,t)||ait()}function rit(e){if(Array.isArray(e))return e}function iit(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],i=!0,s=!1,a,o;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(r.push(a.value),!(t&&r.length===t));i=!0);}catch(l){s=!0,o=l}finally{try{!i&&n.return!=null&&n.return()}finally{if(s)throw o}}return r}}function sit(e,t){if(!!e){if(typeof e=="string")return Zde(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zde(e,t)}}function Zde(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ait(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _r=typeof window>"u"?null:window,Qde=_r?_r.navigator:null;_r&&_r.document;var oit=Mi(""),Eke=Mi({}),lit=Mi(function(){}),uit=typeof HTMLElement>"u"?"undefined":Mi(HTMLElement),aI=function(t){return t&&t.instanceString&&zr(t.instanceString)?t.instanceString():null},rt=function(t){return t!=null&&Mi(t)==oit},zr=function(t){return t!=null&&Mi(t)===lit},Qn=function(t){return!Rl(t)&&(Array.isArray?Array.isArray(t):t!=null&&t instanceof Array)},dn=function(t){return t!=null&&Mi(t)===Eke&&!Qn(t)&&t.constructor===Object},cit=function(t){return t!=null&&Mi(t)===Eke},Pe=function(t){return t!=null&&Mi(t)===Mi(1)&&!isNaN(t)},fit=function(t){return Pe(t)&&Math.floor(t)===t},a5=function(t){if(uit!=="undefined")return t!=null&&t instanceof HTMLElement},Rl=function(t){return oI(t)||Ake(t)},oI=function(t){return aI(t)==="collection"&&t._private.single},Ake=function(t){return aI(t)==="collection"&&!t._private.single},kee=function(t){return aI(t)==="core"},Tke=function(t){return aI(t)==="stylesheet"},hit=function(t){return aI(t)==="event"},I0=function(t){return t==null?!0:!!(t===""||t.match(/^\s+$/))},dit=function(t){return typeof HTMLElement>"u"?!1:t instanceof HTMLElement},pit=function(t){return dn(t)&&Pe(t.x1)&&Pe(t.x2)&&Pe(t.y1)&&Pe(t.y2)},git=function(t){return cit(t)&&zr(t.then)},mit=function(){return Qde&&Qde.userAgent.match(/msie|trident|edge/i)},KA=function(t,n){n||(n=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var s=[],a=0;a<arguments.length;a++)s.push(arguments[a]);return s.join("$")});var r=function i(){var s=this,a=arguments,o,l=n.apply(s,a),u=i.cache;return(o=u[l])||(o=u[l]=t.apply(s,a)),o};return r.cache={},r},Eee=KA(function(e){return e.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}),c8=KA(function(e){return e.replace(/(-\w)/g,function(t){return t[1].toUpperCase()})}),Dke=KA(function(e,t){return e+t[0].toUpperCase()+t.substring(1)},function(e,t){return e+"$"+t}),Jde=function(t){return I0(t)?t:t.charAt(0).toUpperCase()+t.substring(1)},Ei="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",vit="rgb[a]?\\(("+Ei+"[%]?)\\s*,\\s*("+Ei+"[%]?)\\s*,\\s*("+Ei+"[%]?)(?:\\s*,\\s*("+Ei+"))?\\)",yit="rgb[a]?\\((?:"+Ei+"[%]?)\\s*,\\s*(?:"+Ei+"[%]?)\\s*,\\s*(?:"+Ei+"[%]?)(?:\\s*,\\s*(?:"+Ei+"))?\\)",bit="hsl[a]?\\(("+Ei+")\\s*,\\s*("+Ei+"[%])\\s*,\\s*("+Ei+"[%])(?:\\s*,\\s*("+Ei+"))?\\)",xit="hsl[a]?\\((?:"+Ei+")\\s*,\\s*(?:"+Ei+"[%])\\s*,\\s*(?:"+Ei+"[%])(?:\\s*,\\s*(?:"+Ei+"))?\\)",wit="\\#[0-9a-fA-F]{3}",$it="\\#[0-9a-fA-F]{6}",Ike=function(t,n){return t<n?-1:t>n?1:0},Cit=function(t,n){return-1*Ike(t,n)},pt=Object.assign!=null?Object.assign.bind(Object):function(e){for(var t=arguments,n=1;n<t.length;n++){var r=t[n];if(r!=null)for(var i=Object.keys(r),s=0;s<i.length;s++){var a=i[s];e[a]=r[a]}}return e},_it=function(t){if(!(!(t.length===4||t.length===7)||t[0]!=="#")){var n=t.length===4,r,i,s,a=16;return n?(r=parseInt(t[1]+t[1],a),i=parseInt(t[2]+t[2],a),s=parseInt(t[3]+t[3],a)):(r=parseInt(t[1]+t[2],a),i=parseInt(t[3]+t[4],a),s=parseInt(t[5]+t[6],a)),[r,i,s]}},Sit=function(t){var n,r,i,s,a,o,l,u;function c(p,g,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?p+(g-p)*6*m:m<1/2?g:m<2/3?p+(g-p)*(2/3-m)*6:p}var f=new RegExp("^"+bit+"$").exec(t);if(f){if(r=parseInt(f[1]),r<0?r=(360- -1*r%360)%360:r>360&&(r=r%360),r/=360,i=parseFloat(f[2]),i<0||i>100||(i=i/100,s=parseFloat(f[3]),s<0||s>100)||(s=s/100,a=f[4],a!==void 0&&(a=parseFloat(a),a<0||a>1)))return;if(i===0)o=l=u=Math.round(s*255);else{var h=s<.5?s*(1+i):s+i-s*i,d=2*s-h;o=Math.round(255*c(d,h,r+1/3)),l=Math.round(255*c(d,h,r)),u=Math.round(255*c(d,h,r-1/3))}n=[o,l,u,a]}return n},kit=function(t){var n,r=new RegExp("^"+vit+"$").exec(t);if(r){n=[];for(var i=[],s=1;s<=3;s++){var a=r[s];if(a[a.length-1]==="%"&&(i[s]=!0),a=parseFloat(a),i[s]&&(a=a/100*255),a<0||a>255)return;n.push(Math.floor(a))}var o=i[1]||i[2]||i[3],l=i[1]&&i[2]&&i[3];if(o&&!l)return;var u=r[4];if(u!==void 0){if(u=parseFloat(u),u<0||u>1)return;n.push(u)}}return n},Eit=function(t){return Tit[t.toLowerCase()]},Ait=function(t){return(Qn(t)?t:null)||Eit(t)||_it(t)||kit(t)||Sit(t)},Tit={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Nke=function(t){for(var n=t.map,r=t.keys,i=r.length,s=0;s<i;s++){var a=r[s];if(dn(a))throw Error("Tried to set map with object key");s<r.length-1?(n[a]==null&&(n[a]={}),n=n[a]):n[a]=t.value}},Mke=function(t){for(var n=t.map,r=t.keys,i=r.length,s=0;s<i;s++){var a=r[s];if(dn(a))throw Error("Tried to get map with object key");if(n=n[a],n==null)return n}return n},qV=_r?_r.performance:null,Fke=qV&&qV.now?function(){return qV.now()}:function(){return Date.now()},Dit=function(){if(_r){if(_r.requestAnimationFrame)return function(e){_r.requestAnimationFrame(e)};if(_r.mozRequestAnimationFrame)return function(e){_r.mozRequestAnimationFrame(e)};if(_r.webkitRequestAnimationFrame)return function(e){_r.webkitRequestAnimationFrame(e)};if(_r.msRequestAnimationFrame)return function(e){_r.msRequestAnimationFrame(e)}}return function(e){e&&setTimeout(function(){e(Fke())},1e3/60)}}(),o5=function(t){return Dit(t)},Ap=Fke,A2=9261,Oke=65599,Kk=5381,Rke=function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A2,r=n,i;i=t.next(),!i.done;)r=r*Oke+i.value|0;return r},ZA=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A2;return n*Oke+t|0},QA=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kk;return(n<<5)+n+t|0},Iit=function(t,n){return t*2097152+n},Sg=function(t){return t[0]*2097152+t[1]},UF=function(t,n){return[ZA(t[0],n[0]),QA(t[1],n[1])]},Nit=function(t,n){var r={value:0,done:!1},i=0,s=t.length,a={next:function(){return i<s?r.value=t[i++]:r.done=!0,r}};return Rke(a,n)},Sy=function(t,n){var r={value:0,done:!1},i=0,s=t.length,a={next:function(){return i<s?r.value=t.charCodeAt(i++):r.done=!0,r}};return Rke(a,n)},Pke=function(){return Mit(arguments)},Mit=function(t){for(var n,r=0;r<t.length;r++){var i=t[r];r===0?n=Sy(i):n=Sy(i,n)}return n},epe=!0,Fit=console.warn!=null,Oit=console.trace!=null,Aee=Number.MAX_SAFE_INTEGER||9007199254740991,Lke=function(){return!0},l5=function(){return!1},tpe=function(){return 0},Tee=function(){},Xr=function(t){throw new Error(t)},Bke=function(t){if(t!==void 0)epe=!!t;else return epe},Rn=function(t){!Bke()||(Fit?console.warn(t):(console.log(t),Oit&&console.trace()))},Rit=function(t){return pt({},t)},Yf=function(t){return t==null?t:Qn(t)?t.slice():dn(t)?Rit(t):t},Pit=function(t){return t.slice()},zke=function(t,n){for(n=t="";t++<36;n+=t*51&52?(t^15?8^Math.random()*(t^20?16:4):4).toString(16):"-");return n},Lit={},Uke=function(){return Lit},Gs=function(t){var n=Object.keys(t);return function(r){for(var i={},s=0;s<n.length;s++){var a=n[s],o=r==null?void 0:r[a];i[a]=o===void 0?t[a]:o}return i}},N0=function(t,n,r){for(var i=t.length-1;i>=0&&!(t[i]===n&&(t.splice(i,1),r));i--);},Dee=function(t){t.splice(0,t.length)},Bit=function(t,n){for(var r=0;r<n.length;r++){var i=n[r];t.push(i)}},gc=function(t,n,r){return r&&(n=Dke(r,n)),t[n]},Ug=function(t,n,r,i){r&&(n=Dke(r,n)),t[n]=i},zit=function(){function e(){_ee(this,e),this._obj={}}return See(e,[{key:"set",value:function(n,r){return this._obj[n]=r,this}},{key:"delete",value:function(n){return this._obj[n]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(n){return this._obj[n]!==void 0}},{key:"get",value:function(n){return this._obj[n]}}]),e}(),Xf=typeof Map<"u"?Map:zit,Uit="undefined",Wit=function(){function e(t){if(_ee(this,e),this._obj=Object.create(null),this.size=0,t!=null){var n;t.instanceString!=null&&t.instanceString()===this.instanceString()?n=t.toArray():n=t;for(var r=0;r<n.length;r++)this.add(n[r])}}return See(e,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(n){var r=this._obj;r[n]!==1&&(r[n]=1,this.size++)}},{key:"delete",value:function(n){var r=this._obj;r[n]===1&&(r[n]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(n){return this._obj[n]===1}},{key:"toArray",value:function(){var n=this;return Object.keys(this._obj).filter(function(r){return n.has(r)})}},{key:"forEach",value:function(n,r){return this.toArray().forEach(n,r)}}]),e}(),bC=(typeof Set>"u"?"undefined":Mi(Set))!==Uit?Set:Wit,f8=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(t===void 0||n===void 0||!kee(t)){Xr("An element must have a core reference and parameters set");return}var i=n.group;if(i==null&&(n.data&&n.data.source!=null&&n.data.target!=null?i="edges":i="nodes"),i!=="nodes"&&i!=="edges"){Xr("An element must be of type `nodes` or `edges`; you specified `"+i+"`");return}this.length=1,this[0]=this;var s=this._private={cy:t,single:!0,data:n.data||{},position:n.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!n.selected,selectable:n.selectable===void 0?!0:!!n.selectable,locked:!!n.locked,grabbed:!1,grabbable:n.grabbable===void 0?!0:!!n.grabbable,pannable:n.pannable===void 0?i==="edges":!!n.pannable,active:!1,classes:new bC,animation:{current:[],queue:[]},rscratch:{},scratch:n.scratch||{},edges:[],children:[],parent:n.parent&&n.parent.isNode()?n.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(s.position.x==null&&(s.position.x=0),s.position.y==null&&(s.position.y=0),n.renderedPosition){var a=n.renderedPosition,o=t.pan(),l=t.zoom();s.position={x:(a.x-o.x)/l,y:(a.y-o.y)/l}}var u=[];Qn(n.classes)?u=n.classes:rt(n.classes)&&(u=n.classes.split(/\s+/));for(var c=0,f=u.length;c<f;c++){var h=u[c];!h||h===""||s.classes.add(h)}this.createEmitter();var d=n.style||n.css;d&&(Rn("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(d)),(r===void 0||r)&&this.restore()},npe=function(t){return t={bfs:t.bfs||!t.dfs,dfs:t.dfs||!t.bfs},function(r,i,s){var a;dn(r)&&!Rl(r)&&(a=r,r=a.roots||a.root,i=a.visit,s=a.directed),s=arguments.length===2&&!zr(i)?i:s,i=zr(i)?i:function(){};for(var o=this._private.cy,l=r=rt(r)?this.filter(r):r,u=[],c=[],f={},h={},d={},p=0,g,m=this.byGroup(),v=m.nodes,y=m.edges,b=0;b<l.length;b++){var x=l[b],w=x.id();x.isNode()&&(u.unshift(x),t.bfs&&(d[w]=!0,c.push(x)),h[w]=0)}for(var C=function(){var A=t.bfs?u.shift():u.pop(),D=A.id();if(t.dfs){if(d[D])return"continue";d[D]=!0,c.push(A)}var T=h[D],N=f[D],F=N!=null?N.source():null,R=N!=null?N.target():null,P=N==null?void 0:A.same(F)?R[0]:F[0],V=void 0;if(V=i(A,N,P,p++,T),V===!0)return g=A,"break";if(V===!1)return"break";for(var z=A.connectedEdges().filter(function(te){return(!s||te.source().same(A))&&y.has(te)}),q=0;q<z.length;q++){var G=z[q],K=G.connectedNodes().filter(function(te){return!te.same(A)&&v.has(te)}),Y=K.id();K.length!==0&&!d[Y]&&(K=K[0],u.push(K),t.bfs&&(d[Y]=!0,c.push(K)),f[Y]=G,h[Y]=h[D]+1)}};u.length!==0;){var $=C();if($!=="continue"&&$==="break")break}for(var _=o.collection(),k=0;k<c.length;k++){var E=c[k],S=f[E.id()];S!=null&&_.push(S),_.push(E)}return{path:o.collection(_),found:o.collection(g)}}},JA={breadthFirstSearch:npe({bfs:!0}),depthFirstSearch:npe({dfs:!0})};JA.bfs=JA.breadthFirstSearch;JA.dfs=JA.depthFirstSearch;var Vit=Gs({root:null,weight:function(t){return 1},directed:!1}),jit={dijkstra:function(t){if(!dn(t)){var n=arguments;t={root:n[0],weight:n[1],directed:n[2]}}var r=Vit(t),i=r.root,s=r.weight,a=r.directed,o=this,l=s,u=rt(i)?this.filter(i)[0]:i[0],c={},f={},h={},d=this.byGroup(),p=d.nodes,g=d.edges;g.unmergeBy(function(T){return T.isLoop()});for(var m=function(N){return c[N.id()]},v=function(N,F){c[N.id()]=F,y.updateItem(N)},y=new sI.default(function(T,N){return m(T)-m(N)}),b=0;b<p.length;b++){var x=p[b];c[x.id()]=x.same(u)?0:1/0,y.push(x)}for(var w=function(N,F){for(var R=(a?N.edgesTo(F):N.edgesWith(F)).intersect(g),P=1/0,V,z=0;z<R.length;z++){var q=R[z],G=l(q);(G<P||!V)&&(P=G,V=q)}return{edge:V,dist:P}};y.size()>0;){var C=y.pop(),$=m(C),_=C.id();if(h[_]=$,$!==1/0)for(var k=C.neighborhood().intersect(p),E=0;E<k.length;E++){var S=k[E],I=S.id(),A=w(C,S),D=$+A.dist;D<m(S)&&(v(S,D),f[I]={node:C,edge:A.edge})}}return{distanceTo:function(N){var F=rt(N)?p.filter(N)[0]:N[0];return h[F.id()]},pathTo:function(N){var F=rt(N)?p.filter(N)[0]:N[0],R=[],P=F,V=P.id();if(F.length>0)for(R.unshift(F);f[V];){var z=f[V];R.unshift(z.edge),R.unshift(z.node),P=z.node,V=P.id()}return o.spawn(R)}}}},Hit={kruskal:function(t){t=t||function(b){return 1};for(var n=this.byGroup(),r=n.nodes,i=n.edges,s=r.length,a=new Array(s),o=r,l=function(x){for(var w=0;w<a.length;w++){var C=a[w];if(C.has(x))return w}},u=0;u<s;u++)a[u]=this.spawn(r[u]);for(var c=i.sort(function(b,x){return t(b)-t(x)}),f=0;f<c.length;f++){var h=c[f],d=h.source()[0],p=h.target()[0],g=l(d),m=l(p),v=a[g],y=a[m];g!==m&&(o.merge(h),v.merge(y),a.splice(m,1))}return o}},qit=Gs({root:null,goal:null,weight:function(t){return 1},heuristic:function(t){return 0},directed:!1}),Git={aStar:function(t){var n=this.cy(),r=qit(t),i=r.root,s=r.goal,a=r.heuristic,o=r.directed,l=r.weight;i=n.collection(i)[0],s=n.collection(s)[0];var u=i.id(),c=s.id(),f={},h={},d={},p=new sI.default(function(V,z){return h[V.id()]-h[z.id()]}),g=new bC,m={},v={},y=function(z,q){p.push(z),g.add(q)},b,x,w=function(){b=p.pop(),x=b.id(),g.delete(x)},C=function(z){return g.has(z)};y(i,u),f[u]=0,h[u]=a(i);for(var $=0;p.size()>0;){if(w(),$++,x===c){for(var _=[],k=s,E=c,S=v[E];_.unshift(k),S!=null&&_.unshift(S),k=m[E],k!=null;)E=k.id(),S=v[E];return{found:!0,distance:f[x],path:this.spawn(_),steps:$}}d[x]=!0;for(var I=b._private.edges,A=0;A<I.length;A++){var D=I[A];if(!!this.hasElementWithId(D.id())&&!(o&&D.data("source")!==x)){var T=D.source(),N=D.target(),F=T.id()!==x?T:N,R=F.id();if(!!this.hasElementWithId(R)&&!d[R]){var P=f[x]+l(D);if(!C(R)){f[R]=P,h[R]=P+a(F),y(F,R),m[R]=b,v[R]=D;continue}P<f[R]&&(f[R]=P,h[R]=P+a(F),m[R]=b,v[R]=D)}}}}return{found:!1,distance:void 0,path:void 0,steps:$}}},Yit=Gs({weight:function(t){return 1},directed:!1}),Xit={floydWarshall:function(t){for(var n=this.cy(),r=Yit(t),i=r.weight,s=r.directed,a=i,o=this.byGroup(),l=o.nodes,u=o.edges,c=l.length,f=c*c,h=function(G){return l.indexOf(G)},d=function(G){return l[G]},p=new Array(f),g=0;g<f;g++){var m=g%c,v=(g-m)/c;v===m?p[g]=0:p[g]=1/0}for(var y=new Array(f),b=new Array(f),x=0;x<u.length;x++){var w=u[x],C=w.source()[0],$=w.target()[0];if(C!==$){var _=h(C),k=h($),E=_*c+k,S=a(w);if(p[E]>S&&(p[E]=S,y[E]=k,b[E]=w),!s){var I=k*c+_;!s&&p[I]>S&&(p[I]=S,y[I]=_,b[I]=w)}}}for(var A=0;A<c;A++)for(var D=0;D<c;D++)for(var T=D*c+A,N=0;N<c;N++){var F=D*c+N,R=A*c+N;p[T]+p[R]<p[F]&&(p[F]=p[T]+p[R],y[F]=y[T])}var P=function(G){return(rt(G)?n.filter(G):G)[0]},V=function(G){return h(P(G))},z={distance:function(G,K){var Y=V(G),te=V(K);return p[Y*c+te]},path:function(G,K){var Y=V(G),te=V(K),Z=d(Y);if(Y===te)return Z.collection();if(y[Y*c+te]==null)return n.collection();var ae=n.collection(),O=Y,L;for(ae.merge(Z);Y!==te;)O=Y,Y=y[Y*c+te],L=b[O*c+Y],ae.merge(L),ae.merge(d(Y));return ae}};return z}},Kit=Gs({weight:function(t){return 1},directed:!1,root:null}),Zit={bellmanFord:function(t){var n=this,r=Kit(t),i=r.weight,s=r.directed,a=r.root,o=i,l=this,u=this.cy(),c=this.byGroup(),f=c.edges,h=c.nodes,d=h.length,p=new Xf,g=!1,m=[];a=u.collection(a)[0],f.unmergeBy(function(pe){return pe.isLoop()});for(var v=f.length,y=function(Ce){var ze=p.get(Ce.id());return ze||(ze={},p.set(Ce.id(),ze)),ze},b=function(Ce){return(rt(Ce)?u.$(Ce):Ce)[0]},x=function(Ce){return y(b(Ce)).dist},w=function(Ce){for(var ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a,et=b(Ce),dt=[],He=et;;){if(He==null)return n.spawn();var Se=y(He),j=Se.edge,fe=Se.pred;if(dt.unshift(He[0]),He.same(ze)&&dt.length>0)break;j!=null&&dt.unshift(j),He=fe}return l.spawn(dt)},C=0;C<d;C++){var $=h[C],_=y($);$.same(a)?_.dist=0:_.dist=1/0,_.pred=null,_.edge=null}for(var k=!1,E=function(Ce,ze,et,dt,He,Se){var j=dt.dist+Se;j<He.dist&&!et.same(dt.edge)&&(He.dist=j,He.pred=Ce,He.edge=et,k=!0)},S=1;S<d;S++){k=!1;for(var I=0;I<v;I++){var A=f[I],D=A.source(),T=A.target(),N=o(A),F=y(D),R=y(T);E(D,T,A,F,R,N),s||E(T,D,A,R,F,N)}if(!k)break}if(k)for(var P=[],V=0;V<v;V++){var z=f[V],q=z.source(),G=z.target(),K=o(z),Y=y(q).dist,te=y(G).dist;if(Y+K<te||!s&&te+K<Y)if(g||(Rn("Graph contains a negative weight cycle for Bellman-Ford"),g=!0),t.findNegativeWeightCycles!==!1){var Z=[];Y+K<te&&Z.push(q),!s&&te+K<Y&&Z.push(G);for(var ae=Z.length,O=0;O<ae;O++){var L=Z[O],W=[L];W.push(y(L).edge);for(var M=y(L).pred;W.indexOf(M)===-1;)W.push(M),W.push(y(M).edge),M=y(M).pred;W=W.slice(W.indexOf(M));for(var ue=W[0].id(),X=0,se=2;se<W.length;se+=2)W[se].id()<ue&&(ue=W[se].id(),X=se);W=W.slice(X).concat(W.slice(0,X)),W.push(W[0]);var oe=W.map(function(pe){return pe.id()}).join(",");P.indexOf(oe)===-1&&(m.push(l.spawn(W)),P.push(oe))}}else break}return{distanceTo:x,pathTo:w,hasNegativeWeightCycle:g,negativeWeightCycles:m}}},Qit=Math.sqrt(2),Jit=function(t,n,r){r.length===0&&Xr("Karger-Stein must be run on a connected (sub)graph");for(var i=r[t],s=i[1],a=i[2],o=n[s],l=n[a],u=r,c=u.length-1;c>=0;c--){var f=u[c],h=f[1],d=f[2];(n[h]===o&&n[d]===l||n[h]===l&&n[d]===o)&&u.splice(c,1)}for(var p=0;p<u.length;p++){var g=u[p];g[1]===l?(u[p]=g.slice(),u[p][1]=o):g[2]===l&&(u[p]=g.slice(),u[p][2]=o)}for(var m=0;m<n.length;m++)n[m]===l&&(n[m]=o);return u},GV=function(t,n,r,i){for(;r>i;){var s=Math.floor(Math.random()*n.length);n=Jit(s,t,n),r--}return n},est={kargerStein:function(){var t=this,n=this.byGroup(),r=n.nodes,i=n.edges;i.unmergeBy(function(R){return R.isLoop()});var s=r.length,a=i.length,o=Math.ceil(Math.pow(Math.log(s)/Math.LN2,2)),l=Math.floor(s/Qit);if(s<2){Xr("At least 2 nodes are required for Karger-Stein algorithm");return}for(var u=[],c=0;c<a;c++){var f=i[c];u.push([c,r.indexOf(f.source()),r.indexOf(f.target())])}for(var h=1/0,d=[],p=new Array(s),g=new Array(s),m=new Array(s),v=function(P,V){for(var z=0;z<s;z++)V[z]=P[z]},y=0;y<=o;y++){for(var b=0;b<s;b++)g[b]=b;var x=GV(g,u.slice(),s,l),w=x.slice();v(g,m);var C=GV(g,x,l,2),$=GV(m,w,l,2);C.length<=$.length&&C.length<h?(h=C.length,d=C,v(g,p)):$.length<=C.length&&$.length<h&&(h=$.length,d=$,v(m,p))}for(var _=this.spawn(d.map(function(R){return i[R[0]]})),k=this.spawn(),E=this.spawn(),S=p[0],I=0;I<p.length;I++){var A=p[I],D=r[I];A===S?k.merge(D):E.merge(D)}var T=function(P){var V=t.spawn();return P.forEach(function(z){V.merge(z),z.connectedEdges().forEach(function(q){t.contains(q)&&!_.contains(q)&&V.merge(q)})}),V},N=[T(k),T(E)],F={cut:_,components:N,partition1:k,partition2:E};return F}},tst=function(t){return{x:t.x,y:t.y}},h8=function(t,n,r){return{x:t.x*n+r.x,y:t.y*n+r.y}},Wke=function(t,n,r){return{x:(t.x-r.x)/n,y:(t.y-r.y)/n}},T2=function(t){return{x:t[0],y:t[1]}},nst=function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,i=1/0,s=n;s<r;s++){var a=t[s];isFinite(a)&&(i=Math.min(a,i))}return i},rst=function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,i=-1/0,s=n;s<r;s++){var a=t[s];isFinite(a)&&(i=Math.max(a,i))}return i},ist=function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,i=0,s=0,a=n;a<r;a++){var o=t[a];isFinite(o)&&(i+=o,s++)}return i/s},sst=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;i?t=t.slice(n,r):(r<t.length&&t.splice(r,t.length-r),n>0&&t.splice(0,n));for(var o=0,l=t.length-1;l>=0;l--){var u=t[l];a?isFinite(u)||(t[l]=-1/0,o++):t.splice(l,1)}s&&t.sort(function(h,d){return h-d});var c=t.length,f=Math.floor(c/2);return c%2!==0?t[f+1+o]:(t[f-1+o]+t[f+o])/2},ast=function(t){return Math.PI*t/180},WF=function(t,n){return Math.atan2(n,t)-Math.PI/2},Iee=Math.log2||function(e){return Math.log(e)/Math.log(2)},Vke=function(t){return t>0?1:t<0?-1:0},ky=function(t,n){return Math.sqrt(jv(t,n))},jv=function(t,n){var r=n.x-t.x,i=n.y-t.y;return r*r+i*i},ost=function(t){for(var n=t.length,r=0,i=0;i<n;i++)r+=t[i];for(var s=0;s<n;s++)t[s]=t[s]/r;return t},Xi=function(t,n,r,i){return(1-i)*(1-i)*t+2*(1-i)*i*n+i*i*r},W2=function(t,n,r,i){return{x:Xi(t.x,n.x,r.x,i),y:Xi(t.y,n.y,r.y,i)}},lst=function(t,n,r,i){var s={x:n.x-t.x,y:n.y-t.y},a=ky(t,n),o={x:s.x/a,y:s.y/a};return r=r==null?0:r,i=i!=null?i:r*a,{x:t.x+o.x*i,y:t.y+o.y*i}},eT=function(t,n,r){return Math.max(t,Math.min(r,n))},il=function(t){if(t==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(t.x1!=null&&t.y1!=null){if(t.x2!=null&&t.y2!=null&&t.x2>=t.x1&&t.y2>=t.y1)return{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,w:t.x2-t.x1,h:t.y2-t.y1};if(t.w!=null&&t.h!=null&&t.w>=0&&t.h>=0)return{x1:t.x1,y1:t.y1,x2:t.x1+t.w,y2:t.y1+t.h,w:t.w,h:t.h}}},ust=function(t){return{x1:t.x1,x2:t.x2,w:t.w,y1:t.y1,y2:t.y2,h:t.h}},cst=function(t){t.x1=1/0,t.y1=1/0,t.x2=-1/0,t.y2=-1/0,t.w=0,t.h=0},fst=function(t,n){t.x1=Math.min(t.x1,n.x1),t.x2=Math.max(t.x2,n.x2),t.w=t.x2-t.x1,t.y1=Math.min(t.y1,n.y1),t.y2=Math.max(t.y2,n.y2),t.h=t.y2-t.y1},hst=function(t,n,r){t.x1=Math.min(t.x1,n),t.x2=Math.max(t.x2,n),t.w=t.x2-t.x1,t.y1=Math.min(t.y1,r),t.y2=Math.max(t.y2,r),t.h=t.y2-t.y1},qR=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.x1-=n,t.x2+=n,t.y1-=n,t.y2+=n,t.w=t.x2-t.x1,t.h=t.y2-t.y1,t},YV=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],r,i,s,a;if(n.length===1)r=i=s=a=n[0];else if(n.length===2)r=s=n[0],a=i=n[1];else if(n.length===4){var o=Rd(n,4);r=o[0],i=o[1],s=o[2],a=o[3]}return t.x1-=a,t.x2+=i,t.y1-=r,t.y2+=s,t.w=t.x2-t.x1,t.h=t.y2-t.y1,t},rpe=function(t,n){t.x1=n.x1,t.y1=n.y1,t.x2=n.x2,t.y2=n.y2,t.w=t.x2-t.x1,t.h=t.y2-t.y1},Nee=function(t,n){return!(t.x1>n.x2||n.x1>t.x2||t.x2<n.x1||n.x2<t.x1||t.y2<n.y1||n.y2<t.y1||t.y1>n.y2||n.y1>t.y2)},kw=function(t,n,r){return t.x1<=n&&n<=t.x2&&t.y1<=r&&r<=t.y2},dst=function(t,n){return kw(t,n.x,n.y)},jke=function(t,n){return kw(t,n.x1,n.y1)&&kw(t,n.x2,n.y2)},Hke=function(t,n,r,i,s,a,o){var l=lI(s,a),u=s/2,c=a/2,f;{var h=r-u+l-o,d=i-c-o,p=r+u-l+o,g=d;if(f=Hg(t,n,r,i,h,d,p,g,!1),f.length>0)return f}{var m=r+u+o,v=i-c+l-o,y=m,b=i+c-l+o;if(f=Hg(t,n,r,i,m,v,y,b,!1),f.length>0)return f}{var x=r-u+l-o,w=i+c+o,C=r+u-l+o,$=w;if(f=Hg(t,n,r,i,x,w,C,$,!1),f.length>0)return f}{var _=r-u-o,k=i-c+l-o,E=_,S=i+c-l+o;if(f=Hg(t,n,r,i,_,k,E,S,!1),f.length>0)return f}var I;{var A=r-u+l,D=i-c+l;if(I=Zk(t,n,r,i,A,D,l+o),I.length>0&&I[0]<=A&&I[1]<=D)return[I[0],I[1]]}{var T=r+u-l,N=i-c+l;if(I=Zk(t,n,r,i,T,N,l+o),I.length>0&&I[0]>=T&&I[1]<=N)return[I[0],I[1]]}{var F=r+u-l,R=i+c-l;if(I=Zk(t,n,r,i,F,R,l+o),I.length>0&&I[0]>=F&&I[1]>=R)return[I[0],I[1]]}{var P=r-u+l,V=i+c-l;if(I=Zk(t,n,r,i,P,V,l+o),I.length>0&&I[0]<=P&&I[1]>=V)return[I[0],I[1]]}return[]},pst=function(t,n,r,i,s,a,o){var l=o,u=Math.min(r,s),c=Math.max(r,s),f=Math.min(i,a),h=Math.max(i,a);return u-l<=t&&t<=c+l&&f-l<=n&&n<=h+l},gst=function(t,n,r,i,s,a,o,l,u){var c={x1:Math.min(r,o,s)-u,x2:Math.max(r,o,s)+u,y1:Math.min(i,l,a)-u,y2:Math.max(i,l,a)+u};return!(t<c.x1||t>c.x2||n<c.y1||n>c.y2)},mst=function(t,n,r,i){r-=i;var s=n*n-4*t*r;if(s<0)return[];var a=Math.sqrt(s),o=2*t,l=(-n+a)/o,u=(-n-a)/o;return[l,u]},vst=function(t,n,r,i,s){var a=1e-5;t===0&&(t=a),n/=t,r/=t,i/=t;var o,l,u,c,f,h,d,p;if(l=(3*r-n*n)/9,u=-(27*i)+n*(9*r-2*(n*n)),u/=54,o=l*l*l+u*u,s[1]=0,d=n/3,o>0){f=u+Math.sqrt(o),f=f<0?-Math.pow(-f,1/3):Math.pow(f,1/3),h=u-Math.sqrt(o),h=h<0?-Math.pow(-h,1/3):Math.pow(h,1/3),s[0]=-d+f+h,d+=(f+h)/2,s[4]=s[2]=-d,d=Math.sqrt(3)*(-h+f)/2,s[3]=d,s[5]=-d;return}if(s[5]=s[3]=0,o===0){p=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3),s[0]=-d+2*p,s[4]=s[2]=-(p+d);return}l=-l,c=l*l*l,c=Math.acos(u/Math.sqrt(c)),p=2*Math.sqrt(l),s[0]=-d+p*Math.cos(c/3),s[2]=-d+p*Math.cos((c+2*Math.PI)/3),s[4]=-d+p*Math.cos((c+4*Math.PI)/3)},yst=function(t,n,r,i,s,a,o,l){var u=1*r*r-4*r*s+2*r*o+4*s*s-4*s*o+o*o+i*i-4*i*a+2*i*l+4*a*a-4*a*l+l*l,c=1*9*r*s-3*r*r-3*r*o-6*s*s+3*s*o+9*i*a-3*i*i-3*i*l-6*a*a+3*a*l,f=1*3*r*r-6*r*s+r*o-r*t+2*s*s+2*s*t-o*t+3*i*i-6*i*a+i*l-i*n+2*a*a+2*a*n-l*n,h=1*r*s-r*r+r*t-s*t+i*a-i*i+i*n-a*n,d=[];vst(u,c,f,h,d);for(var p=1e-7,g=[],m=0;m<6;m+=2)Math.abs(d[m+1])<p&&d[m]>=0&&d[m]<=1&&g.push(d[m]);g.push(1),g.push(0);for(var v=-1,y,b,x,w=0;w<g.length;w++)y=Math.pow(1-g[w],2)*r+2*(1-g[w])*g[w]*s+g[w]*g[w]*o,b=Math.pow(1-g[w],2)*i+2*(1-g[w])*g[w]*a+g[w]*g[w]*l,x=Math.pow(y-t,2)+Math.pow(b-n,2),v>=0?x<v&&(v=x):v=x;return v},bst=function(t,n,r,i,s,a){var o=[t-r,n-i],l=[s-r,a-i],u=l[0]*l[0]+l[1]*l[1],c=o[0]*o[0]+o[1]*o[1],f=o[0]*l[0]+o[1]*l[1],h=f*f/u;return f<0?c:h>u?(t-s)*(t-s)+(n-a)*(n-a):c-h},Lo=function(t,n,r){for(var i,s,a,o,l,u=0,c=0;c<r.length/2;c++)if(i=r[c*2],s=r[c*2+1],c+1<r.length/2?(a=r[(c+1)*2],o=r[(c+1)*2+1]):(a=r[(c+1-r.length/2)*2],o=r[(c+1-r.length/2)*2+1]),!(i==t&&a==t))if(i>=t&&t>=a||i<=t&&t<=a)l=(t-i)/(a-i)*(o-s)+s,l>n&&u++;else continue;return u%2!==0},Tp=function(t,n,r,i,s,a,o,l,u){var c=new Array(r.length),f;l[0]!=null?(f=Math.atan(l[1]/l[0]),l[0]<0?f=f+Math.PI/2:f=-f-Math.PI/2):f=l;for(var h=Math.cos(-f),d=Math.sin(-f),p=0;p<c.length/2;p++)c[p*2]=a/2*(r[p*2]*h-r[p*2+1]*d),c[p*2+1]=o/2*(r[p*2+1]*h+r[p*2]*d),c[p*2]+=i,c[p*2+1]+=s;var g;if(u>0){var m=Gke(c,-u);g=qke(m)}else g=c;return Lo(t,n,g)},xst=function(t,n,r,i,s,a,o){for(var l=new Array(r.length),u=a/2,c=o/2,f=Mee(a,o),h=f*f,d=0;d<r.length/4;d++){var p=void 0,g=void 0;d===0?p=r.length-2:p=d*4-2,g=d*4+2;var m=i+u*r[d*4],v=s+c*r[d*4+1],y=-r[p]*r[g]-r[p+1]*r[g+1],b=f/Math.tan(Math.acos(y)/2),x=m-b*r[p],w=v-b*r[p+1],C=m+b*r[g],$=v+b*r[g+1];l[d*4]=x,l[d*4+1]=w,l[d*4+2]=C,l[d*4+3]=$;var _=r[p+1],k=-r[p],E=_*r[g]+k*r[g+1];E<0&&(_*=-1,k*=-1);var S=x+_*f,I=w+k*f,A=Math.pow(S-t,2)+Math.pow(I-n,2);if(A<=h)return!0}return Lo(t,n,l)},qke=function(t){for(var n=new Array(t.length/2),r,i,s,a,o,l,u,c,f=0;f<t.length/4;f++){r=t[f*4],i=t[f*4+1],s=t[f*4+2],a=t[f*4+3],f<t.length/4-1?(o=t[(f+1)*4],l=t[(f+1)*4+1],u=t[(f+1)*4+2],c=t[(f+1)*4+3]):(o=t[0],l=t[1],u=t[2],c=t[3]);var h=Hg(r,i,s,a,o,l,u,c,!0);n[f*2]=h[0],n[f*2+1]=h[1]}return n},Gke=function(t,n){for(var r=new Array(t.length*2),i,s,a,o,l=0;l<t.length/2;l++){i=t[l*2],s=t[l*2+1],l<t.length/2-1?(a=t[(l+1)*2],o=t[(l+1)*2+1]):(a=t[0],o=t[1]);var u=o-s,c=-(a-i),f=Math.sqrt(u*u+c*c),h=u/f,d=c/f;r[l*4]=i+h*n,r[l*4+1]=s+d*n,r[l*4+2]=a+h*n,r[l*4+3]=o+d*n}return r},wst=function(t,n,r,i,s,a){var o=r-t,l=i-n;o/=s,l/=a;var u=Math.sqrt(o*o+l*l),c=u-1;if(c<0)return[];var f=c/u;return[(r-t)*f+t,(i-n)*f+n]},_1=function(t,n,r,i,s,a,o){return t-=s,n-=a,t/=r/2+o,n/=i/2+o,t*t+n*n<=1},Zk=function(t,n,r,i,s,a,o){var l=[r-t,i-n],u=[t-s,n-a],c=l[0]*l[0]+l[1]*l[1],f=2*(u[0]*l[0]+u[1]*l[1]),h=u[0]*u[0]+u[1]*u[1]-o*o,d=f*f-4*c*h;if(d<0)return[];var p=(-f+Math.sqrt(d))/(2*c),g=(-f-Math.sqrt(d))/(2*c),m=Math.min(p,g),v=Math.max(p,g),y=[];if(m>=0&&m<=1&&y.push(m),v>=0&&v<=1&&y.push(v),y.length===0)return[];var b=y[0]*l[0]+t,x=y[0]*l[1]+n;if(y.length>1){if(y[0]==y[1])return[b,x];var w=y[1]*l[0]+t,C=y[1]*l[1]+n;return[b,x,w,C]}else return[b,x]},XV=function(t,n,r){return n<=t&&t<=r||r<=t&&t<=n?t:t<=n&&n<=r||r<=n&&n<=t?n:r},Hg=function(t,n,r,i,s,a,o,l,u){var c=t-s,f=r-t,h=o-s,d=n-a,p=i-n,g=l-a,m=h*d-g*c,v=f*d-p*c,y=g*f-h*p;if(y!==0){var b=m/y,x=v/y,w=.001,C=0-w,$=1+w;return C<=b&&b<=$&&C<=x&&x<=$?[t+b*f,n+b*p]:u?[t+b*f,n+b*p]:[]}else return m===0||v===0?XV(t,r,o)===o?[o,l]:XV(t,r,s)===s?[s,a]:XV(s,o,r)===r?[r,i]:[]:[]},tT=function(t,n,r,i,s,a,o,l){var u=[],c,f=new Array(r.length),h=!0;a==null&&(h=!1);var d;if(h){for(var p=0;p<f.length/2;p++)f[p*2]=r[p*2]*a+i,f[p*2+1]=r[p*2+1]*o+s;if(l>0){var g=Gke(f,-l);d=qke(g)}else d=f}else d=r;for(var m,v,y,b,x=0;x<d.length/2;x++)m=d[x*2],v=d[x*2+1],x<d.length/2-1?(y=d[(x+1)*2],b=d[(x+1)*2+1]):(y=d[0],b=d[1]),c=Hg(t,n,i,s,m,v,y,b),c.length!==0&&u.push(c[0],c[1]);return u},$st=function(t,n,r,i,s,a,o,l){for(var u=[],c,f=new Array(r.length),h=a/2,d=o/2,p=Mee(a,o),g=0;g<r.length/4;g++){var m=void 0,v=void 0;g===0?m=r.length-2:m=g*4-2,v=g*4+2;var y=i+h*r[g*4],b=s+d*r[g*4+1],x=-r[m]*r[v]-r[m+1]*r[v+1],w=p/Math.tan(Math.acos(x)/2),C=y-w*r[m],$=b-w*r[m+1],_=y+w*r[v],k=b+w*r[v+1];g===0?(f[r.length-2]=C,f[r.length-1]=$):(f[g*4-2]=C,f[g*4-1]=$),f[g*4]=_,f[g*4+1]=k;var E=r[m+1],S=-r[m],I=E*r[v]+S*r[v+1];I<0&&(E*=-1,S*=-1);var A=C+E*p,D=$+S*p;c=Zk(t,n,i,s,A,D,p),c.length!==0&&u.push(c[0],c[1])}for(var T=0;T<f.length/4;T++)c=Hg(t,n,i,s,f[T*4],f[T*4+1],f[T*4+2],f[T*4+3],!1),c.length!==0&&u.push(c[0],c[1]);if(u.length>2){for(var N=[u[0],u[1]],F=Math.pow(N[0]-t,2)+Math.pow(N[1]-n,2),R=1;R<u.length/2;R++){var P=Math.pow(u[R*2]-t,2)+Math.pow(u[R*2+1]-n,2);P<=F&&(N[0]=u[R*2],N[1]=u[R*2+1],F=P)}return N}return u},VF=function(t,n,r){var i=[t[0]-n[0],t[1]-n[1]],s=Math.sqrt(i[0]*i[0]+i[1]*i[1]),a=(s-r)/s;return a<0&&(a=1e-5),[n[0]+a*i[0],n[1]+a*i[1]]},Ba=function(t,n){var r=aY(t,n);return r=Yke(r),r},Yke=function(t){for(var n,r,i=t.length/2,s=1/0,a=1/0,o=-1/0,l=-1/0,u=0;u<i;u++)n=t[2*u],r=t[2*u+1],s=Math.min(s,n),o=Math.max(o,n),a=Math.min(a,r),l=Math.max(l,r);for(var c=2/(o-s),f=2/(l-a),h=0;h<i;h++)n=t[2*h]=t[2*h]*c,r=t[2*h+1]=t[2*h+1]*f,s=Math.min(s,n),o=Math.max(o,n),a=Math.min(a,r),l=Math.max(l,r);if(a<-1)for(var d=0;d<i;d++)r=t[2*d+1]=t[2*d+1]+(-1-a);return t},aY=function(t,n){var r=1/t*2*Math.PI,i=t%2===0?Math.PI/2+r/2:Math.PI/2;i+=n;for(var s=new Array(t*2),a,o=0;o<t;o++)a=o*r+i,s[2*o]=Math.cos(a),s[2*o+1]=Math.sin(-a);return s},lI=function(t,n){return Math.min(t/4,n/4,8)},Mee=function(t,n){return Math.min(t/10,n/10,8)},Xke=function(){return 8},Cst=function(t,n,r){return[t-2*n+r,2*(n-t),t]},oY=function(t,n){return{heightOffset:Math.min(15,.05*n),widthOffset:Math.min(100,.25*t),ctrlPtOffsetPct:.05}},_st=Gs({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(t){return 1}}),Sst={pageRank:function(t){for(var n=_st(t),r=n.dampingFactor,i=n.precision,s=n.iterations,a=n.weight,o=this._private.cy,l=this.byGroup(),u=l.nodes,c=l.edges,f=u.length,h=f*f,d=c.length,p=new Array(h),g=new Array(f),m=(1-r)/f,v=0;v<f;v++){for(var y=0;y<f;y++){var b=v*f+y;p[b]=0}g[v]=0}for(var x=0;x<d;x++){var w=c[x],C=w.data("source"),$=w.data("target");if(C!==$){var _=u.indexOfId(C),k=u.indexOfId($),E=a(w),S=k*f+_;p[S]+=E,g[_]+=E}}for(var I=1/f+m,A=0;A<f;A++)if(g[A]===0)for(var D=0;D<f;D++){var T=D*f+A;p[T]=I}else for(var N=0;N<f;N++){var F=N*f+A;p[F]=p[F]/g[A]+m}for(var R=new Array(f),P=new Array(f),V,z=0;z<f;z++)R[z]=1;for(var q=0;q<s;q++){for(var G=0;G<f;G++)P[G]=0;for(var K=0;K<f;K++)for(var Y=0;Y<f;Y++){var te=K*f+Y;P[K]+=p[te]*R[Y]}ost(P),V=R,R=P,P=V;for(var Z=0,ae=0;ae<f;ae++){var O=V[ae]-R[ae];Z+=O*O}if(Z<i)break}var L={rank:function(M){return M=o.collection(M)[0],R[u.indexOf(M)]}};return L}},ipe=Gs({root:null,weight:function(t){return 1},directed:!1,alpha:0}),V2={degreeCentralityNormalized:function(t){t=ipe(t);var n=this.cy(),r=this.nodes(),i=r.length;if(t.directed){for(var c={},f={},h=0,d=0,p=0;p<i;p++){var g=r[p],m=g.id();t.root=g;var v=this.degreeCentrality(t);h<v.indegree&&(h=v.indegree),d<v.outdegree&&(d=v.outdegree),c[m]=v.indegree,f[m]=v.outdegree}return{indegree:function(b){return h==0?0:(rt(b)&&(b=n.filter(b)),c[b.id()]/h)},outdegree:function(b){return d===0?0:(rt(b)&&(b=n.filter(b)),f[b.id()]/d)}}}else{for(var s={},a=0,o=0;o<i;o++){var l=r[o];t.root=l;var u=this.degreeCentrality(t);a<u.degree&&(a=u.degree),s[l.id()]=u.degree}return{degree:function(b){return a===0?0:(rt(b)&&(b=n.filter(b)),s[b.id()]/a)}}}},degreeCentrality:function(t){t=ipe(t);var n=this.cy(),r=this,i=t,s=i.root,a=i.weight,o=i.directed,l=i.alpha;if(s=n.collection(s)[0],o){for(var d=s.connectedEdges(),p=d.filter(function(C){return C.target().same(s)&&r.has(C)}),g=d.filter(function(C){return C.source().same(s)&&r.has(C)}),m=p.length,v=g.length,y=0,b=0,x=0;x<p.length;x++)y+=a(p[x]);for(var w=0;w<g.length;w++)b+=a(g[w]);return{indegree:Math.pow(m,1-l)*Math.pow(y,l),outdegree:Math.pow(v,1-l)*Math.pow(b,l)}}else{for(var u=s.connectedEdges().intersection(r),c=u.length,f=0,h=0;h<u.length;h++)f+=a(u[h]);return{degree:Math.pow(c,1-l)*Math.pow(f,l)}}}};V2.dc=V2.degreeCentrality;V2.dcn=V2.degreeCentralityNormalised=V2.degreeCentralityNormalized;var spe=Gs({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),j2={closenessCentralityNormalized:function(t){for(var n=spe(t),r=n.harmonic,i=n.weight,s=n.directed,a=this.cy(),o={},l=0,u=this.nodes(),c=this.floydWarshall({weight:i,directed:s}),f=0;f<u.length;f++){for(var h=0,d=u[f],p=0;p<u.length;p++)if(f!==p){var g=c.distance(d,u[p]);r?h+=1/g:h+=g}r||(h=1/h),l<h&&(l=h),o[d.id()]=h}return{closeness:function(v){return l==0?0:(rt(v)?v=a.filter(v)[0].id():v=v.id(),o[v]/l)}}},closenessCentrality:function(t){var n=spe(t),r=n.root,i=n.weight,s=n.directed,a=n.harmonic;r=this.filter(r)[0];for(var o=this.dijkstra({root:r,weight:i,directed:s}),l=0,u=this.nodes(),c=0;c<u.length;c++){var f=u[c];if(!f.same(r)){var h=o.distanceTo(f);a?l+=1/h:l+=h}}return a?l:1/l}};j2.cc=j2.closenessCentrality;j2.ccn=j2.closenessCentralityNormalised=j2.closenessCentralityNormalized;var kst=Gs({weight:null,directed:!1}),lY={betweennessCentrality:function(t){for(var n=kst(t),r=n.directed,i=n.weight,s=i!=null,a=this.cy(),o=this.nodes(),l={},u={},c=0,f={set:function(b,x){u[b]=x,x>c&&(c=x)},get:function(b){return u[b]}},h=0;h<o.length;h++){var d=o[h],p=d.id();r?l[p]=d.outgoers().nodes():l[p]=d.openNeighborhood().nodes(),f.set(p,0)}for(var g=function(b){for(var x=o[b].id(),w=[],C={},$={},_={},k=new sI.default(function(Y,te){return _[Y]-_[te]}),E=0;E<o.length;E++){var S=o[E].id();C[S]=[],$[S]=0,_[S]=1/0}for($[x]=1,_[x]=0,k.push(x);!k.empty();){var I=k.pop();if(w.push(I),s)for(var A=0;A<l[I].length;A++){var D=l[I][A],T=a.getElementById(I),N=void 0;T.edgesTo(D).length>0?N=T.edgesTo(D)[0]:N=D.edgesTo(T)[0];var F=i(N);D=D.id(),_[D]>_[I]+F&&(_[D]=_[I]+F,k.nodes.indexOf(D)<0?k.push(D):k.updateItem(D),$[D]=0,C[D]=[]),_[D]==_[I]+F&&($[D]=$[D]+$[I],C[D].push(I))}else for(var R=0;R<l[I].length;R++){var P=l[I][R].id();_[P]==1/0&&(k.push(P),_[P]=_[I]+1),_[P]==_[I]+1&&($[P]=$[P]+$[I],C[P].push(I))}}for(var V={},z=0;z<o.length;z++)V[o[z].id()]=0;for(;w.length>0;){for(var q=w.pop(),G=0;G<C[q].length;G++){var K=C[q][G];V[K]=V[K]+$[K]/$[q]*(1+V[q])}q!=o[b].id()&&f.set(q,f.get(q)+V[q])}},m=0;m<o.length;m++)g(m);var v={betweenness:function(b){var x=a.collection(b).id();return f.get(x)},betweennessNormalized:function(b){if(c==0)return 0;var x=a.collection(b).id();return f.get(x)/c}};return v.betweennessNormalised=v.betweennessNormalized,v}};lY.bc=lY.betweennessCentrality;var Est=Gs({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(e){return 1}]}),Ast=function(t){return Est(t)},Tst=function(t,n){for(var r=0,i=0;i<n.length;i++)r+=n[i](t);return r},Dst=function(t,n,r){for(var i=0;i<n;i++)t[i*n+i]=r},Kke=function(t,n){for(var r,i=0;i<n;i++){r=0;for(var s=0;s<n;s++)r+=t[s*n+i];for(var a=0;a<n;a++)t[a*n+i]=t[a*n+i]/r}},Ist=function(t,n,r){for(var i=new Array(r*r),s=0;s<r;s++){for(var a=0;a<r;a++)i[s*r+a]=0;for(var o=0;o<r;o++)for(var l=0;l<r;l++)i[s*r+l]+=t[s*r+o]*n[o*r+l]}return i},Nst=function(t,n,r){for(var i=t.slice(0),s=1;s<r;s++)t=Ist(t,i,n);return t},Mst=function(t,n,r){for(var i=new Array(n*n),s=0;s<n*n;s++)i[s]=Math.pow(t[s],r);return Kke(i,n),i},Fst=function(t,n,r,i){for(var s=0;s<r;s++){var a=Math.round(t[s]*Math.pow(10,i))/Math.pow(10,i),o=Math.round(n[s]*Math.pow(10,i))/Math.pow(10,i);if(a!==o)return!1}return!0},Ost=function(t,n,r,i){for(var s=[],a=0;a<n;a++){for(var o=[],l=0;l<n;l++)Math.round(t[a*n+l]*1e3)/1e3>0&&o.push(r[l]);o.length!==0&&s.push(i.collection(o))}return s},Rst=function(t,n){for(var r=0;r<t.length;r++)if(!n[r]||t[r].id()!==n[r].id())return!1;return!0},Pst=function(t){for(var n=0;n<t.length;n++)for(var r=0;r<t.length;r++)n!=r&&Rst(t[n],t[r])&&t.splice(r,1);return t},ape=function(t){for(var n=this.nodes(),r=this.edges(),i=this.cy(),s=Ast(t),a={},o=0;o<n.length;o++)a[n[o].id()]=o;for(var l=n.length,u=l*l,c=new Array(u),f,h=0;h<u;h++)c[h]=0;for(var d=0;d<r.length;d++){var p=r[d],g=a[p.source().id()],m=a[p.target().id()],v=Tst(p,s.attributes);c[g*l+m]+=v,c[m*l+g]+=v}Dst(c,l,s.multFactor),Kke(c,l);for(var y=!0,b=0;y&&b<s.maxIterations;)y=!1,f=Nst(c,l,s.expandFactor),c=Mst(f,l,s.inflateFactor),Fst(c,f,u,4)||(y=!0),b++;var x=Ost(c,l,n,i);return x=Pst(x),x},Lst={markovClustering:ape,mcl:ape},Bst=function(t){return t},Zke=function(t,n){return Math.abs(n-t)},ope=function(t,n,r){return t+Zke(n,r)},lpe=function(t,n,r){return t+Math.pow(r-n,2)},zst=function(t){return Math.sqrt(t)},Ust=function(t,n,r){return Math.max(t,Zke(n,r))},VS=function(t,n,r,i,s){for(var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:Bst,o=i,l,u,c=0;c<t;c++)l=n(c),u=r(c),o=s(o,l,u);return a(o)},Ew={euclidean:function(t,n,r){return t>=2?VS(t,n,r,0,lpe,zst):VS(t,n,r,0,ope)},squaredEuclidean:function(t,n,r){return VS(t,n,r,0,lpe)},manhattan:function(t,n,r){return VS(t,n,r,0,ope)},max:function(t,n,r){return VS(t,n,r,-1/0,Ust)}};Ew["squared-euclidean"]=Ew.squaredEuclidean;Ew.squaredeuclidean=Ew.squaredEuclidean;function d8(e,t,n,r,i,s){var a;return zr(e)?a=e:a=Ew[e]||Ew.euclidean,t===0&&zr(e)?a(i,s):a(t,n,r,i,s)}var Wst=Gs({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),Fee=function(t){return Wst(t)},u5=function(t,n,r,i,s){var a=s!=="kMedoids",o=a?function(f){return r[f]}:function(f){return i[f](r)},l=function(h){return i[h](n)},u=r,c=n;return d8(t,i.length,o,l,u,c)},KV=function(t,n,r){for(var i=r.length,s=new Array(i),a=new Array(i),o=new Array(n),l=null,u=0;u<i;u++)s[u]=t.min(r[u]).value,a[u]=t.max(r[u]).value;for(var c=0;c<n;c++){l=[];for(var f=0;f<i;f++)l[f]=Math.random()*(a[f]-s[f])+s[f];o[c]=l}return o},Qke=function(t,n,r,i,s){for(var a=1/0,o=0,l=0;l<n.length;l++){var u=u5(r,t,n[l],i,s);u<a&&(a=u,o=l)}return o},Jke=function(t,n,r){for(var i=[],s=null,a=0;a<n.length;a++)s=n[a],r[s.id()]===t&&i.push(s);return i},Vst=function(t,n,r){return Math.abs(n-t)<=r},jst=function(t,n,r){for(var i=0;i<t.length;i++)for(var s=0;s<t[i].length;s++){var a=Math.abs(t[i][s]-n[i][s]);if(a>r)return!1}return!0},Hst=function(t,n,r){for(var i=0;i<r;i++)if(t===n[i])return!0;return!1},upe=function(t,n){var r=new Array(n);if(t.length<50)for(var i=0;i<n;i++){for(var s=t[Math.floor(Math.random()*t.length)];Hst(s,r,i);)s=t[Math.floor(Math.random()*t.length)];r[i]=s}else for(var a=0;a<n;a++)r[a]=t[Math.floor(Math.random()*t.length)];return r},cpe=function(t,n,r){for(var i=0,s=0;s<n.length;s++)i+=u5("manhattan",n[s],t,r,"kMedoids");return i},qst=function(t){var n=this.cy(),r=this.nodes(),i=null,s=Fee(t),a=new Array(s.k),o={},l;s.testMode?typeof s.testCentroids=="number"?(s.testCentroids,l=KV(r,s.k,s.attributes)):Mi(s.testCentroids)==="object"?l=s.testCentroids:l=KV(r,s.k,s.attributes):l=KV(r,s.k,s.attributes);for(var u=!0,c=0;u&&c<s.maxIterations;){for(var f=0;f<r.length;f++)i=r[f],o[i.id()]=Qke(i,l,s.distance,s.attributes,"kMeans");u=!1;for(var h=0;h<s.k;h++){var d=Jke(h,r,o);if(d.length!==0){for(var p=s.attributes.length,g=l[h],m=new Array(p),v=new Array(p),y=0;y<p;y++){v[y]=0;for(var b=0;b<d.length;b++)i=d[b],v[y]+=s.attributes[y](i);m[y]=v[y]/d.length,Vst(m[y],g[y],s.sensitivityThreshold)||(u=!0)}l[h]=m,a[h]=n.collection(d)}}c++}return a},Gst=function(t){var n=this.cy(),r=this.nodes(),i=null,s=Fee(t),a=new Array(s.k),o,l={},u,c=new Array(s.k);s.testMode?typeof s.testCentroids=="number"||(Mi(s.testCentroids)==="object"?o=s.testCentroids:o=upe(r,s.k)):o=upe(r,s.k);for(var f=!0,h=0;f&&h<s.maxIterations;){for(var d=0;d<r.length;d++)i=r[d],l[i.id()]=Qke(i,o,s.distance,s.attributes,"kMedoids");f=!1;for(var p=0;p<o.length;p++){var g=Jke(p,r,l);if(g.length!==0){c[p]=cpe(o[p],g,s.attributes);for(var m=0;m<g.length;m++)u=cpe(g[m],g,s.attributes),u<c[p]&&(c[p]=u,o[p]=g[m],f=!0);a[p]=n.collection(g)}}h++}return a},Yst=function(t,n,r,i,s){for(var a,o,l=0;l<n.length;l++)for(var u=0;u<t.length;u++)i[l][u]=Math.pow(r[l][u],s.m);for(var c=0;c<t.length;c++)for(var f=0;f<s.attributes.length;f++){a=0,o=0;for(var h=0;h<n.length;h++)a+=i[h][c]*s.attributes[f](n[h]),o+=i[h][c];t[c][f]=a/o}},Xst=function(t,n,r,i,s){for(var a=0;a<t.length;a++)n[a]=t[a].slice();for(var o,l,u,c=2/(s.m-1),f=0;f<r.length;f++)for(var h=0;h<i.length;h++){o=0;for(var d=0;d<r.length;d++)l=u5(s.distance,i[h],r[f],s.attributes,"cmeans"),u=u5(s.distance,i[h],r[d],s.attributes,"cmeans"),o+=Math.pow(l/u,c);t[h][f]=1/o}},Kst=function(t,n,r,i){for(var s=new Array(r.k),a=0;a<s.length;a++)s[a]=[];for(var o,l,u=0;u<n.length;u++){o=-1/0,l=-1;for(var c=0;c<n[0].length;c++)n[u][c]>o&&(o=n[u][c],l=c);s[l].push(t[u])}for(var f=0;f<s.length;f++)s[f]=i.collection(s[f]);return s},fpe=function(t){var n=this.cy(),r=this.nodes(),i=Fee(t),s,a,o,l,u;l=new Array(r.length);for(var c=0;c<r.length;c++)l[c]=new Array(i.k);o=new Array(r.length);for(var f=0;f<r.length;f++)o[f]=new Array(i.k);for(var h=0;h<r.length;h++){for(var d=0,p=0;p<i.k;p++)o[h][p]=Math.random(),d+=o[h][p];for(var g=0;g<i.k;g++)o[h][g]=o[h][g]/d}a=new Array(i.k);for(var m=0;m<i.k;m++)a[m]=new Array(i.attributes.length);u=new Array(r.length);for(var v=0;v<r.length;v++)u[v]=new Array(i.k);for(var y=!0,b=0;y&&b<i.maxIterations;)y=!1,Yst(a,r,o,u,i),Xst(o,l,a,r,i),jst(o,l,i.sensitivityThreshold)||(y=!0),b++;return s=Kst(r,o,i,n),{clusters:s,degreeOfMembership:o}},Zst={kMeans:qst,kMedoids:Gst,fuzzyCMeans:fpe,fcm:fpe},Qst=Gs({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),Jst={single:"min",complete:"max"},eat=function(t){var n=Qst(t),r=Jst[n.linkage];return r!=null&&(n.linkage=r),n},hpe=function(t,n,r,i,s){for(var a=0,o=1/0,l,u=s.attributes,c=function(k,E){return d8(s.distance,u.length,function(S){return u[S](k)},function(S){return u[S](E)},k,E)},f=0;f<t.length;f++){var h=t[f].key,d=r[h][i[h]];d<o&&(a=h,o=d)}if(s.mode==="threshold"&&o>=s.threshold||s.mode==="dendrogram"&&t.length===1)return!1;var p=n[a],g=n[i[a]],m;s.mode==="dendrogram"?m={left:p,right:g,key:p.key}:m={value:p.value.concat(g.value),key:p.key},t[p.index]=m,t.splice(g.index,1),n[p.key]=m;for(var v=0;v<t.length;v++){var y=t[v];p.key===y.key?l=1/0:s.linkage==="min"?(l=r[p.key][y.key],r[p.key][y.key]>r[g.key][y.key]&&(l=r[g.key][y.key])):s.linkage==="max"?(l=r[p.key][y.key],r[p.key][y.key]<r[g.key][y.key]&&(l=r[g.key][y.key])):s.linkage==="mean"?l=(r[p.key][y.key]*p.size+r[g.key][y.key]*g.size)/(p.size+g.size):s.mode==="dendrogram"?l=c(y.value,p.value):l=c(y.value[0],p.value[0]),r[p.key][y.key]=r[y.key][p.key]=l}for(var b=0;b<t.length;b++){var x=t[b].key;if(i[x]===p.key||i[x]===g.key){for(var w=x,C=0;C<t.length;C++){var $=t[C].key;r[x][$]<r[x][w]&&(w=$)}i[x]=w}t[b].index=b}return p.key=g.key=p.index=g.index=null,!0},jF=function e(t,n,r){!t||(t.value?n.push(t.value):(t.left&&e(t.left,n),t.right&&e(t.right,n)))},tat=function e(t,n){if(!t)return"";if(t.left&&t.right){var r=e(t.left,n),i=e(t.right,n),s=n.add({group:"nodes",data:{id:r+","+i}});return n.add({group:"edges",data:{source:r,target:s.id()}}),n.add({group:"edges",data:{source:i,target:s.id()}}),s.id()}else if(t.value)return t.value.id()},nat=function e(t,n,r){if(!t)return[];var i=[],s=[],a=[];return n===0?(t.left&&jF(t.left,i),t.right&&jF(t.right,s),a=i.concat(s),[r.collection(a)]):n===1?t.value?[r.collection(t.value)]:(t.left&&jF(t.left,i),t.right&&jF(t.right,s),[r.collection(i),r.collection(s)]):t.value?[r.collection(t.value)]:(t.left&&(i=e(t.left,n-1,r)),t.right&&(s=e(t.right,n-1,r)),i.concat(s))},dpe=function(t){for(var n=this.cy(),r=this.nodes(),i=eat(t),s=i.attributes,a=function(b,x){return d8(i.distance,s.length,function(w){return s[w](b)},function(w){return s[w](x)},b,x)},o=[],l=[],u=[],c=[],f=0;f<r.length;f++){var h={value:i.mode==="dendrogram"?r[f]:[r[f]],key:f,index:f};o[f]=h,c[f]=h,l[f]=[],u[f]=0}for(var d=0;d<o.length;d++)for(var p=0;p<=d;p++){var g=void 0;i.mode==="dendrogram"?g=d===p?1/0:a(o[d].value,o[p].value):g=d===p?1/0:a(o[d].value[0],o[p].value[0]),l[d][p]=g,l[p][d]=g,g<l[d][u[d]]&&(u[d]=p)}for(var m=hpe(o,c,l,u,i);m;)m=hpe(o,c,l,u,i);var v;return i.mode==="dendrogram"?(v=nat(o[0],i.dendrogramDepth,n),i.addDendrogram&&tat(o[0],n)):(v=new Array(o.length),o.forEach(function(y,b){y.key=y.index=null,v[b]=n.collection(y.value)})),v},rat={hierarchicalClustering:dpe,hca:dpe},iat=Gs({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),sat=function(t){var n=t.damping,r=t.preference;.5<=n&&n<1||Xr("Damping must range on [0.5, 1).  Got: ".concat(n));var i=["median","mean","min","max"];return i.some(function(s){return s===r})||Pe(r)||Xr("Preference must be one of [".concat(i.map(function(s){return"'".concat(s,"'")}).join(", "),"] or a number.  Got: ").concat(r)),iat(t)},aat=function(t,n,r,i){var s=function(o,l){return i[l](o)};return-d8(t,i.length,function(a){return s(n,a)},function(a){return s(r,a)},n,r)},oat=function(t,n){var r=null;return n==="median"?r=sst(t):n==="mean"?r=ist(t):n==="min"?r=nst(t):n==="max"?r=rst(t):r=n,r},lat=function(t,n,r){for(var i=[],s=0;s<t;s++)n[s*t+s]+r[s*t+s]>0&&i.push(s);return i},ppe=function(t,n,r){for(var i=[],s=0;s<t;s++){for(var a=-1,o=-1/0,l=0;l<r.length;l++){var u=r[l];n[s*t+u]>o&&(a=u,o=n[s*t+u])}a>0&&i.push(a)}for(var c=0;c<r.length;c++)i[r[c]]=r[c];return i},uat=function(t,n,r){for(var i=ppe(t,n,r),s=0;s<r.length;s++){for(var a=[],o=0;o<i.length;o++)i[o]===r[s]&&a.push(o);for(var l=-1,u=-1/0,c=0;c<a.length;c++){for(var f=0,h=0;h<a.length;h++)f+=n[a[h]*t+a[c]];f>u&&(l=c,u=f)}r[s]=a[l]}return i=ppe(t,n,r),i},gpe=function(t){for(var n=this.cy(),r=this.nodes(),i=sat(t),s={},a=0;a<r.length;a++)s[r[a].id()]=a;var o,l,u,c,f,h;o=r.length,l=o*o,u=new Array(l);for(var d=0;d<l;d++)u[d]=-1/0;for(var p=0;p<o;p++)for(var g=0;g<o;g++)p!==g&&(u[p*o+g]=aat(i.distance,r[p],r[g],i.attributes));c=oat(u,i.preference);for(var m=0;m<o;m++)u[m*o+m]=c;f=new Array(l);for(var v=0;v<l;v++)f[v]=0;h=new Array(l);for(var y=0;y<l;y++)h[y]=0;for(var b=new Array(o),x=new Array(o),w=new Array(o),C=0;C<o;C++)b[C]=0,x[C]=0,w[C]=0;for(var $=new Array(o*i.minIterations),_=0;_<$.length;_++)$[_]=0;var k;for(k=0;k<i.maxIterations;k++){for(var E=0;E<o;E++){for(var S=-1/0,I=-1/0,A=-1,D=0,T=0;T<o;T++)b[T]=f[E*o+T],D=h[E*o+T]+u[E*o+T],D>=S?(I=S,S=D,A=T):D>I&&(I=D);for(var N=0;N<o;N++)f[E*o+N]=(1-i.damping)*(u[E*o+N]-S)+i.damping*b[N];f[E*o+A]=(1-i.damping)*(u[E*o+A]-I)+i.damping*b[A]}for(var F=0;F<o;F++){for(var R=0,P=0;P<o;P++)b[P]=h[P*o+F],x[P]=Math.max(0,f[P*o+F]),R+=x[P];R-=x[F],x[F]=f[F*o+F],R+=x[F];for(var V=0;V<o;V++)h[V*o+F]=(1-i.damping)*Math.min(0,R-x[V])+i.damping*b[V];h[F*o+F]=(1-i.damping)*(R-x[F])+i.damping*b[F]}for(var z=0,q=0;q<o;q++){var G=h[q*o+q]+f[q*o+q]>0?1:0;$[k%i.minIterations*o+q]=G,z+=G}if(z>0&&(k>=i.minIterations-1||k==i.maxIterations-1)){for(var K=0,Y=0;Y<o;Y++){w[Y]=0;for(var te=0;te<i.minIterations;te++)w[Y]+=$[te*o+Y];(w[Y]===0||w[Y]===i.minIterations)&&K++}if(K===o)break}}for(var Z=lat(o,f,h),ae=uat(o,u,Z),O={},L=0;L<Z.length;L++)O[Z[L]]=[];for(var W=0;W<r.length;W++){var M=s[r[W].id()],ue=ae[M];ue!=null&&O[ue].push(r[W])}for(var X=new Array(Z.length),se=0;se<Z.length;se++)X[se]=n.collection(O[Z[se]]);return X},cat={affinityPropagation:gpe,ap:gpe},fat=Gs({root:void 0,directed:!1}),hat={hierholzer:function(t){if(!dn(t)){var n=arguments;t={root:n[0],directed:n[1]}}var r=fat(t),i=r.root,s=r.directed,a=this,o=!1,l,u,c;i&&(c=rt(i)?this.filter(i)[0].id():i[0].id());var f={},h={};s?a.forEach(function(y){var b=y.id();if(y.isNode()){var x=y.indegree(!0),w=y.outdegree(!0),C=x-w,$=w-x;C==1?l?o=!0:l=b:$==1?u?o=!0:u=b:($>1||C>1)&&(o=!0),f[b]=[],y.outgoers().forEach(function(_){_.isEdge()&&f[b].push(_.id())})}else h[b]=[void 0,y.target().id()]}):a.forEach(function(y){var b=y.id();if(y.isNode()){var x=y.degree(!0);x%2&&(l?u?o=!0:u=b:l=b),f[b]=[],y.connectedEdges().forEach(function(w){return f[b].push(w.id())})}else h[b]=[y.source().id(),y.target().id()]});var d={found:!1,trail:void 0};if(o)return d;if(u&&l)if(s){if(c&&u!=c)return d;c=u}else{if(c&&u!=c&&l!=c)return d;c||(c=u)}else c||(c=a[0].id());var p=function(b){for(var x=b,w=[b],C,$,_;f[x].length;)C=f[x].shift(),$=h[C][0],_=h[C][1],x!=_?(f[_]=f[_].filter(function(k){return k!=C}),x=_):!s&&x!=$&&(f[$]=f[$].filter(function(k){return k!=C}),x=$),w.unshift(C),w.unshift(x);return w},g=[],m=[];for(m=p(c);m.length!=1;)f[m[0]].length==0?(g.unshift(a.getElementById(m.shift())),g.unshift(a.getElementById(m.shift()))):m=p(m.shift()).concat(m);g.unshift(a.getElementById(m.shift()));for(var v in f)if(f[v].length)return d;return d.found=!0,d.trail=this.spawn(g,!0),d}},HF=function(){var t=this,n={},r=0,i=0,s=[],a=[],o={},l=function(h,d){for(var p=a.length-1,g=[],m=t.spawn();a[p].x!=h||a[p].y!=d;)g.push(a.pop().edge),p--;g.push(a.pop().edge),g.forEach(function(v){var y=v.connectedNodes().intersection(t);m.merge(v),y.forEach(function(b){var x=b.id(),w=b.connectedEdges().intersection(t);m.merge(b),n[x].cutVertex?m.merge(w.filter(function(C){return C.isLoop()})):m.merge(w)})}),s.push(m)},u=function f(h,d,p){h===p&&(i+=1),n[d]={id:r,low:r++,cutVertex:!1};var g=t.getElementById(d).connectedEdges().intersection(t);if(g.size()===0)s.push(t.spawn(t.getElementById(d)));else{var m,v,y,b;g.forEach(function(x){m=x.source().id(),v=x.target().id(),y=m===d?v:m,y!==p&&(b=x.id(),o[b]||(o[b]=!0,a.push({x:d,y,edge:x})),y in n?n[d].low=Math.min(n[d].low,n[y].id):(f(h,y,d),n[d].low=Math.min(n[d].low,n[y].low),n[d].id<=n[y].low&&(n[d].cutVertex=!0,l(d,y))))})}};t.forEach(function(f){if(f.isNode()){var h=f.id();h in n||(i=0,u(h,h),n[h].cutVertex=i>1)}});var c=Object.keys(n).filter(function(f){return n[f].cutVertex}).map(function(f){return t.getElementById(f)});return{cut:t.spawn(c),components:s}},dat={hopcroftTarjanBiconnected:HF,htbc:HF,htb:HF,hopcroftTarjanBiconnectedComponents:HF},qF=function(){var t=this,n={},r=0,i=[],s=[],a=t.spawn(t),o=function l(u){s.push(u),n[u]={index:r,low:r++,explored:!1};var c=t.getElementById(u).connectedEdges().intersection(t);if(c.forEach(function(g){var m=g.target().id();m!==u&&(m in n||l(m),n[m].explored||(n[u].low=Math.min(n[u].low,n[m].low)))}),n[u].index===n[u].low){for(var f=t.spawn();;){var h=s.pop();if(f.merge(t.getElementById(h)),n[h].low=n[u].index,n[h].explored=!0,h===u)break}var d=f.edgesWith(f),p=f.merge(d);i.push(p),a=a.difference(p)}};return t.forEach(function(l){if(l.isNode()){var u=l.id();u in n||o(u)}}),{cut:a,components:i}},pat={tarjanStronglyConnected:qF,tsc:qF,tscc:qF,tarjanStronglyConnectedComponents:qF},eEe={};[JA,jit,Hit,Git,Xit,Zit,est,Sst,V2,j2,lY,Lst,Zst,rat,cat,hat,dat,pat].forEach(function(e){pt(eEe,e)});/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/var tEe=0,nEe=1,rEe=2,Dp=function e(t){if(!(this instanceof e))return new e(t);this.id="Thenable/1.0.7",this.state=tEe,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof t=="function"&&t.call(this,this.fulfill.bind(this),this.reject.bind(this))};Dp.prototype={fulfill:function(t){return mpe(this,nEe,"fulfillValue",t)},reject:function(t){return mpe(this,rEe,"rejectReason",t)},then:function(t,n){var r=this,i=new Dp;return r.onFulfilled.push(ype(t,i,"fulfill")),r.onRejected.push(ype(n,i,"reject")),iEe(r),i.proxy}};var mpe=function(t,n,r,i){return t.state===tEe&&(t.state=n,t[r]=i,iEe(t)),t},iEe=function(t){t.state===nEe?vpe(t,"onFulfilled",t.fulfillValue):t.state===rEe&&vpe(t,"onRejected",t.rejectReason)},vpe=function(t,n,r){if(t[n].length!==0){var i=t[n];t[n]=[];var s=function(){for(var o=0;o<i.length;o++)i[o](r)};typeof setImmediate=="function"?setImmediate(s):setTimeout(s,0)}},ype=function(t,n,r){return function(i){if(typeof t!="function")n[r].call(n,i);else{var s;try{s=t(i)}catch(a){n.reject(a);return}gat(n,s)}}},gat=function e(t,n){if(t===n||t.proxy===n){t.reject(new TypeError("cannot resolve promise with itself"));return}var r;if(Mi(n)==="object"&&n!==null||typeof n=="function")try{r=n.then}catch(s){t.reject(s);return}if(typeof r=="function"){var i=!1;try{r.call(n,function(s){i||(i=!0,s===n?t.reject(new TypeError("circular thenable chain")):e(t,s))},function(s){i||(i=!0,t.reject(s))})}catch(s){i||t.reject(s)}return}t.fulfill(n)};Dp.all=function(e){return new Dp(function(t,n){for(var r=new Array(e.length),i=0,s=function(l,u){r[l]=u,i++,i===e.length&&t(r)},a=0;a<e.length;a++)(function(o){var l=e[o],u=l!=null&&l.then!=null;if(u)l.then(function(f){s(o,f)},function(f){n(f)});else{var c=l;s(o,c)}})(a)})};Dp.resolve=function(e){return new Dp(function(t,n){t(e)})};Dp.reject=function(e){return new Dp(function(t,n){n(e)})};var xC=typeof Promise<"u"?Promise:Dp,uY=function(t,n,r){var i=kee(t),s=!i,a=this._private=pt({duration:1e3},n,r);if(a.target=t,a.style=a.style||a.css,a.started=!1,a.playing=!1,a.hooked=!1,a.applying=!1,a.progress=0,a.completes=[],a.frames=[],a.complete&&zr(a.complete)&&a.completes.push(a.complete),s){var o=t.position();a.startPosition=a.startPosition||{x:o.x,y:o.y},a.startStyle=a.startStyle||t.cy().style().getAnimationStartStyle(t,a.style)}if(i){var l=t.pan();a.startPan={x:l.x,y:l.y},a.startZoom=t.zoom()}this.length=1,this[0]=this},Ey=uY.prototype;pt(Ey,{instanceString:function(){return"animation"},hook:function(){var t=this._private;if(!t.hooked){var n,r=t.target._private.animation;t.queue?n=r.queue:n=r.current,n.push(this),Rl(t.target)&&t.target.cy().addToAnimationPool(t.target),t.hooked=!0}return this},play:function(){var t=this._private;return t.progress===1&&(t.progress=0),t.playing=!0,t.started=!1,t.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var t=this._private;return t.applying=!0,t.started=!1,t.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var t=this._private;return t.playing=!1,t.started=!1,this},stop:function(){var t=this._private;return t.playing=!1,t.started=!1,t.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(t){var n=this._private;return t===void 0?n.progress*n.duration:this.progress(t/n.duration)},progress:function(t){var n=this._private,r=n.playing;return t===void 0?n.progress:(r&&this.pause(),n.progress=t,n.started=!1,r&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var t=this._private,n=t.playing;n&&this.pause(),t.progress=1-t.progress,t.started=!1;var r=function(u,c){var f=t[u];f!=null&&(t[u]=t[c],t[c]=f)};if(r("zoom","startZoom"),r("pan","startPan"),r("position","startPosition"),t.style)for(var i=0;i<t.style.length;i++){var s=t.style[i],a=s.name,o=t.startStyle[a];t.startStyle[a]=s,t.style[i]=o}return n&&this.play(),this},promise:function(t){var n=this._private,r;switch(t){case"frame":r=n.frames;break;default:case"complete":case"completed":r=n.completes}return new xC(function(i,s){r.push(function(){i()})})}});Ey.complete=Ey.completed;Ey.run=Ey.play;Ey.running=Ey.playing;var mat={animated:function(){return function(){var n=this,r=n.length!==void 0,i=r?n:[n],s=this._private.cy||this;if(!s.styleEnabled())return!1;var a=i[0];if(a)return a._private.animation.current.length>0}},clearQueue:function(){return function(){var n=this,r=n.length!==void 0,i=r?n:[n],s=this._private.cy||this;if(!s.styleEnabled())return this;for(var a=0;a<i.length;a++){var o=i[a];o._private.animation.queue=[]}return this}},delay:function(){return function(n,r){var i=this._private.cy||this;return i.styleEnabled()?this.animate({delay:n,duration:n,complete:r}):this}},delayAnimation:function(){return function(n,r){var i=this._private.cy||this;return i.styleEnabled()?this.animation({delay:n,duration:n,complete:r}):this}},animation:function(){return function(n,r){var i=this,s=i.length!==void 0,a=s?i:[i],o=this._private.cy||this,l=!s,u=!l;if(!o.styleEnabled())return this;var c=o.style();n=pt({},n,r);var f=Object.keys(n).length===0;if(f)return new uY(a[0],n);switch(n.duration===void 0&&(n.duration=400),n.duration){case"slow":n.duration=600;break;case"fast":n.duration=200;break}if(u&&(n.style=c.getPropsList(n.style||n.css),n.css=void 0),u&&n.renderedPosition!=null){var h=n.renderedPosition,d=o.pan(),p=o.zoom();n.position=Wke(h,p,d)}if(l&&n.panBy!=null){var g=n.panBy,m=o.pan();n.pan={x:m.x+g.x,y:m.y+g.y}}var v=n.center||n.centre;if(l&&v!=null){var y=o.getCenterPan(v.eles,n.zoom);y!=null&&(n.pan=y)}if(l&&n.fit!=null){var b=n.fit,x=o.getFitViewport(b.eles||b.boundingBox,b.padding);x!=null&&(n.pan=x.pan,n.zoom=x.zoom)}if(l&&dn(n.zoom)){var w=o.getZoomedViewport(n.zoom);w!=null?(w.zoomed&&(n.zoom=w.zoom),w.panned&&(n.pan=w.pan)):n.zoom=null}return new uY(a[0],n)}},animate:function(){return function(n,r){var i=this,s=i.length!==void 0,a=s?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;r&&(n=pt({},n,r));for(var l=0;l<a.length;l++){var u=a[l],c=u.animated()&&(n.queue===void 0||n.queue),f=u.animation(n,c?{queue:!0}:void 0);f.play()}return this}},stop:function(){return function(n,r){var i=this,s=i.length!==void 0,a=s?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;for(var l=0;l<a.length;l++){for(var u=a[l],c=u._private,f=c.animation.current,h=0;h<f.length;h++){var d=f[h],p=d._private;r&&(p.duration=0)}n&&(c.animation.queue=[]),r||(c.animation.current=[])}return o.notify("draw"),this}}},vat={data:function(t){var n={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(i){},beforeSet:function(i,s){},onSet:function(i){},canSet:function(i){return!0}};return t=pt({},n,t),function(i,s){var a=t,o=this,l=o.length!==void 0,u=l?o:[o],c=l?o[0]:o;if(rt(i)){var f=i.indexOf(".")!==-1,h=f&&nit.default(i);if(a.allowGetting&&s===void 0){var d;return c&&(a.beforeGet(c),h&&c._private[a.field][i]===void 0?d=eit.default(c._private[a.field],h):d=c._private[a.field][i]),d}else if(a.allowSetting&&s!==void 0){var p=!a.immutableKeys[i];if(p){var g=kke({},i,s);a.beforeSet(o,g);for(var m=0,v=u.length;m<v;m++){var y=u[m];a.canSet(y)&&(h&&c._private[a.field][i]===void 0?tit.default(y._private[a.field],h,s):y._private[a.field][i]=s)}a.updateStyle&&o.updateStyle(),a.onSet(o),a.settingTriggersEvent&&o[a.triggerFnName](a.settingEvent)}}}else if(a.allowSetting&&dn(i)){var b=i,x,w,C=Object.keys(b);a.beforeSet(o,b);for(var $=0;$<C.length;$++){x=C[$],w=b[x];var _=!a.immutableKeys[x];if(_)for(var k=0;k<u.length;k++){var E=u[k];a.canSet(E)&&(E._private[a.field][x]=w)}}a.updateStyle&&o.updateStyle(),a.onSet(o),a.settingTriggersEvent&&o[a.triggerFnName](a.settingEvent)}else if(a.allowBinding&&zr(i)){var S=i;o.on(a.bindingEvent,S)}else if(a.allowGetting&&i===void 0){var I;return c&&(a.beforeGet(c),I=c._private[a.field]),I}return o}},removeData:function(t){var n={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return t=pt({},n,t),function(i){var s=t,a=this,o=a.length!==void 0,l=o?a:[a];if(rt(i)){for(var u=i.split(/\s+/),c=u.length,f=0;f<c;f++){var h=u[f];if(!I0(h)){var d=!s.immutableKeys[h];if(d)for(var p=0,g=l.length;p<g;p++)l[p]._private[s.field][h]=void 0}}s.triggerEvent&&a[s.triggerFnName](s.event)}else if(i===void 0){for(var m=0,v=l.length;m<v;m++)for(var y=l[m]._private[s.field],b=Object.keys(y),x=0;x<b.length;x++){var w=b[x],C=!s.immutableKeys[w];C&&(y[w]=void 0)}s.triggerEvent&&a[s.triggerFnName](s.event)}return a}}},yat={eventAliasesOn:function(t){var n=t;n.addListener=n.listen=n.bind=n.on,n.unlisten=n.unbind=n.off=n.removeListener,n.trigger=n.emit,n.pon=n.promiseOn=function(r,i){var s=this,a=Array.prototype.slice.call(arguments,0);return new xC(function(o,l){var u=function(d){s.off.apply(s,f),o(d)},c=a.concat([u]),f=c.concat([]);s.on.apply(s,c)})}}},Fn={};[mat,vat,yat].forEach(function(e){pt(Fn,e)});var bat={animate:Fn.animate(),animation:Fn.animation(),animated:Fn.animated(),clearQueue:Fn.clearQueue(),delay:Fn.delay(),delayAnimation:Fn.delayAnimation(),stop:Fn.stop()},GR={classes:function(t){var n=this;if(t===void 0){var r=[];return n[0]._private.classes.forEach(function(p){return r.push(p)}),r}else Qn(t)||(t=(t||"").match(/\S+/g)||[]);for(var i=[],s=new bC(t),a=0;a<n.length;a++){for(var o=n[a],l=o._private,u=l.classes,c=!1,f=0;f<t.length;f++){var h=t[f],d=u.has(h);if(!d){c=!0;break}}c||(c=u.size!==t.length),c&&(l.classes=s,i.push(o))}return i.length>0&&this.spawn(i).updateStyle().emit("class"),n},addClass:function(t){return this.toggleClass(t,!0)},hasClass:function(t){var n=this[0];return n!=null&&n._private.classes.has(t)},toggleClass:function(t,n){Qn(t)||(t=t.match(/\S+/g)||[]);for(var r=this,i=n===void 0,s=[],a=0,o=r.length;a<o;a++)for(var l=r[a],u=l._private.classes,c=!1,f=0;f<t.length;f++){var h=t[f],d=u.has(h),p=!1;n||i&&!d?(u.add(h),p=!0):(!n||i&&d)&&(u.delete(h),p=!0),!c&&p&&(s.push(l),c=!0)}return s.length>0&&this.spawn(s).updateStyle().emit("class"),r},removeClass:function(t){return this.toggleClass(t,!1)},flashClass:function(t,n){var r=this;if(n==null)n=250;else if(n===0)return r;return r.addClass(t),setTimeout(function(){r.removeClass(t)},n),r}};GR.className=GR.classNames=GR.classes;var fn={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Ei,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};fn.variable="(?:[\\w-.]|(?:\\\\"+fn.metaChar+"))+";fn.className="(?:[\\w-]|(?:\\\\"+fn.metaChar+"))+";fn.value=fn.string+"|"+fn.number;fn.id=fn.variable;(function(){var e,t,n;for(e=fn.comparatorOp.split("|"),n=0;n<e.length;n++)t=e[n],fn.comparatorOp+="|@"+t;for(e=fn.comparatorOp.split("|"),n=0;n<e.length;n++)t=e[n],!(t.indexOf("!")>=0)&&t!=="="&&(fn.comparatorOp+="|\\!"+t)})();var qn=function(){return{checks:[]}},je={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},cY=[{selector:":selected",matches:function(t){return t.selected()}},{selector:":unselected",matches:function(t){return!t.selected()}},{selector:":selectable",matches:function(t){return t.selectable()}},{selector:":unselectable",matches:function(t){return!t.selectable()}},{selector:":locked",matches:function(t){return t.locked()}},{selector:":unlocked",matches:function(t){return!t.locked()}},{selector:":visible",matches:function(t){return t.visible()}},{selector:":hidden",matches:function(t){return!t.visible()}},{selector:":transparent",matches:function(t){return t.transparent()}},{selector:":grabbed",matches:function(t){return t.grabbed()}},{selector:":free",matches:function(t){return!t.grabbed()}},{selector:":removed",matches:function(t){return t.removed()}},{selector:":inside",matches:function(t){return!t.removed()}},{selector:":grabbable",matches:function(t){return t.grabbable()}},{selector:":ungrabbable",matches:function(t){return!t.grabbable()}},{selector:":animated",matches:function(t){return t.animated()}},{selector:":unanimated",matches:function(t){return!t.animated()}},{selector:":parent",matches:function(t){return t.isParent()}},{selector:":childless",matches:function(t){return t.isChildless()}},{selector:":child",matches:function(t){return t.isChild()}},{selector:":orphan",matches:function(t){return t.isOrphan()}},{selector:":nonorphan",matches:function(t){return t.isChild()}},{selector:":compound",matches:function(t){return t.isNode()?t.isParent():t.source().isParent()||t.target().isParent()}},{selector:":loop",matches:function(t){return t.isLoop()}},{selector:":simple",matches:function(t){return t.isSimple()}},{selector:":active",matches:function(t){return t.active()}},{selector:":inactive",matches:function(t){return!t.active()}},{selector:":backgrounding",matches:function(t){return t.backgrounding()}},{selector:":nonbackgrounding",matches:function(t){return!t.backgrounding()}}].sort(function(e,t){return Cit(e.selector,t.selector)}),xat=function(){for(var e={},t,n=0;n<cY.length;n++)t=cY[n],e[t.selector]=t.matches;return e}(),wat=function(t,n){return xat[t](n)},$at="("+cY.map(function(e){return e.selector}).join("|")+")",Xx=function(t){return t.replace(new RegExp("\\\\("+fn.metaChar+")","g"),function(n,r){return r})},kg=function(t,n,r){t[t.length-1]=r},fY=[{name:"group",query:!0,regex:"("+fn.group+")",populate:function(t,n,r){var i=Rd(r,1),s=i[0];n.checks.push({type:je.GROUP,value:s==="*"?s:s+"s"})}},{name:"state",query:!0,regex:$at,populate:function(t,n,r){var i=Rd(r,1),s=i[0];n.checks.push({type:je.STATE,value:s})}},{name:"id",query:!0,regex:"\\#("+fn.id+")",populate:function(t,n,r){var i=Rd(r,1),s=i[0];n.checks.push({type:je.ID,value:Xx(s)})}},{name:"className",query:!0,regex:"\\.("+fn.className+")",populate:function(t,n,r){var i=Rd(r,1),s=i[0];n.checks.push({type:je.CLASS,value:Xx(s)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+fn.variable+")\\s*\\]",populate:function(t,n,r){var i=Rd(r,1),s=i[0];n.checks.push({type:je.DATA_EXIST,field:Xx(s)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+fn.variable+")\\s*("+fn.comparatorOp+")\\s*("+fn.value+")\\s*\\]",populate:function(t,n,r){var i=Rd(r,3),s=i[0],a=i[1],o=i[2],l=new RegExp("^"+fn.string+"$").exec(o)!=null;l?o=o.substring(1,o.length-1):o=parseFloat(o),n.checks.push({type:je.DATA_COMPARE,field:Xx(s),operator:a,value:o})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+fn.boolOp+")\\s*("+fn.variable+")\\s*\\]",populate:function(t,n,r){var i=Rd(r,2),s=i[0],a=i[1];n.checks.push({type:je.DATA_BOOL,field:Xx(a),operator:s})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+fn.meta+")\\s*("+fn.comparatorOp+")\\s*("+fn.number+")\\s*\\]\\]",populate:function(t,n,r){var i=Rd(r,3),s=i[0],a=i[1],o=i[2];n.checks.push({type:je.META_COMPARE,field:Xx(s),operator:a,value:parseFloat(o)})}},{name:"nextQuery",separator:!0,regex:fn.separator,populate:function(t,n){var r=t.currentSubject,i=t.edgeCount,s=t.compoundCount,a=t[t.length-1];r!=null&&(a.subject=r,t.currentSubject=null),a.edgeCount=i,a.compoundCount=s,t.edgeCount=0,t.compoundCount=0;var o=t[t.length++]=qn();return o}},{name:"directedEdge",separator:!0,regex:fn.directedEdge,populate:function(t,n){if(t.currentSubject==null){var r=qn(),i=n,s=qn();return r.checks.push({type:je.DIRECTED_EDGE,source:i,target:s}),kg(t,n,r),t.edgeCount++,s}else{var a=qn(),o=n,l=qn();return a.checks.push({type:je.NODE_SOURCE,source:o,target:l}),kg(t,n,a),t.edgeCount++,l}}},{name:"undirectedEdge",separator:!0,regex:fn.undirectedEdge,populate:function(t,n){if(t.currentSubject==null){var r=qn(),i=n,s=qn();return r.checks.push({type:je.UNDIRECTED_EDGE,nodes:[i,s]}),kg(t,n,r),t.edgeCount++,s}else{var a=qn(),o=n,l=qn();return a.checks.push({type:je.NODE_NEIGHBOR,node:o,neighbor:l}),kg(t,n,a),l}}},{name:"child",separator:!0,regex:fn.child,populate:function(t,n){if(t.currentSubject==null){var r=qn(),i=qn(),s=t[t.length-1];return r.checks.push({type:je.CHILD,parent:s,child:i}),kg(t,n,r),t.compoundCount++,i}else if(t.currentSubject===n){var a=qn(),o=t[t.length-1],l=qn(),u=qn(),c=qn(),f=qn();return a.checks.push({type:je.COMPOUND_SPLIT,left:o,right:l,subject:u}),u.checks=n.checks,n.checks=[{type:je.TRUE}],f.checks.push({type:je.TRUE}),l.checks.push({type:je.PARENT,parent:f,child:c}),kg(t,o,a),t.currentSubject=u,t.compoundCount++,c}else{var h=qn(),d=qn(),p=[{type:je.PARENT,parent:h,child:d}];return h.checks=n.checks,n.checks=p,t.compoundCount++,d}}},{name:"descendant",separator:!0,regex:fn.descendant,populate:function(t,n){if(t.currentSubject==null){var r=qn(),i=qn(),s=t[t.length-1];return r.checks.push({type:je.DESCENDANT,ancestor:s,descendant:i}),kg(t,n,r),t.compoundCount++,i}else if(t.currentSubject===n){var a=qn(),o=t[t.length-1],l=qn(),u=qn(),c=qn(),f=qn();return a.checks.push({type:je.COMPOUND_SPLIT,left:o,right:l,subject:u}),u.checks=n.checks,n.checks=[{type:je.TRUE}],f.checks.push({type:je.TRUE}),l.checks.push({type:je.ANCESTOR,ancestor:f,descendant:c}),kg(t,o,a),t.currentSubject=u,t.compoundCount++,c}else{var h=qn(),d=qn(),p=[{type:je.ANCESTOR,ancestor:h,descendant:d}];return h.checks=n.checks,n.checks=p,t.compoundCount++,d}}},{name:"subject",modifier:!0,regex:fn.subject,populate:function(t,n){if(t.currentSubject!=null&&t.currentSubject!==n)return Rn("Redefinition of subject in selector `"+t.toString()+"`"),!1;t.currentSubject=n;var r=t[t.length-1],i=r.checks[0],s=i==null?null:i.type;s===je.DIRECTED_EDGE?i.type=je.NODE_TARGET:s===je.UNDIRECTED_EDGE&&(i.type=je.NODE_NEIGHBOR,i.node=i.nodes[1],i.neighbor=i.nodes[0],i.nodes=null)}}];fY.forEach(function(e){return e.regexObj=new RegExp("^"+e.regex)});var Cat=function(t){for(var n,r,i,s=0;s<fY.length;s++){var a=fY[s],o=a.name,l=t.match(a.regexObj);if(l!=null){r=l,n=a,i=o;var u=l[0];t=t.substring(u.length);break}}return{expr:n,match:r,name:i,remaining:t}},_at=function(t){var n=t.match(/^\s+/);if(n){var r=n[0];t=t.substring(r.length)}return t},Sat=function(t){var n=this,r=n.inputText=t,i=n[0]=qn();for(n.length=1,r=_at(r);;){var s=Cat(r);if(s.expr==null)return Rn("The selector `"+t+"`is invalid"),!1;var a=s.match.slice(1),o=s.expr.populate(n,i,a);if(o===!1)return!1;if(o!=null&&(i=o),r=s.remaining,r.match(/^\s*$/))break}var l=n[n.length-1];n.currentSubject!=null&&(l.subject=n.currentSubject),l.edgeCount=n.edgeCount,l.compoundCount=n.compoundCount;for(var u=0;u<n.length;u++){var c=n[u];if(c.compoundCount>0&&c.edgeCount>0)return Rn("The selector `"+t+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(c.edgeCount>1)return Rn("The selector `"+t+"` is invalid because it uses multiple edge selectors"),!1;c.edgeCount===1&&Rn("The selector `"+t+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},kat=function(){if(this.toStringCache!=null)return this.toStringCache;for(var t=function(c){return c==null?"":c},n=function(c){return rt(c)?'"'+c+'"':t(c)},r=function(c){return" "+c+" "},i=function(c,f){var h=c.type,d=c.value;switch(h){case je.GROUP:{var p=t(d);return p.substring(0,p.length-1)}case je.DATA_COMPARE:{var g=c.field,m=c.operator;return"["+g+r(t(m))+n(d)+"]"}case je.DATA_BOOL:{var v=c.operator,y=c.field;return"["+t(v)+y+"]"}case je.DATA_EXIST:{var b=c.field;return"["+b+"]"}case je.META_COMPARE:{var x=c.operator,w=c.field;return"[["+w+r(t(x))+n(d)+"]]"}case je.STATE:return d;case je.ID:return"#"+d;case je.CLASS:return"."+d;case je.PARENT:case je.CHILD:return s(c.parent,f)+r(">")+s(c.child,f);case je.ANCESTOR:case je.DESCENDANT:return s(c.ancestor,f)+" "+s(c.descendant,f);case je.COMPOUND_SPLIT:{var C=s(c.left,f),$=s(c.subject,f),_=s(c.right,f);return C+(C.length>0?" ":"")+$+_}case je.TRUE:return""}},s=function(c,f){return c.checks.reduce(function(h,d,p){return h+(f===c&&p===0?"$":"")+i(d,f)},"")},a="",o=0;o<this.length;o++){var l=this[o];a+=s(l,l.subject),this.length>1&&o<this.length-1&&(a+=", ")}return this.toStringCache=a,a},Eat={parse:Sat,toString:kat},sEe=function(t,n,r){var i,s=rt(t),a=Pe(t),o=rt(r),l,u,c=!1,f=!1,h=!1;switch(n.indexOf("!")>=0&&(n=n.replace("!",""),f=!0),n.indexOf("@")>=0&&(n=n.replace("@",""),c=!0),(s||o||c)&&(l=!s&&!a?"":""+t,u=""+r),c&&(t=l=l.toLowerCase(),r=u=u.toLowerCase()),n){case"*=":i=l.indexOf(u)>=0;break;case"$=":i=l.indexOf(u,l.length-u.length)>=0;break;case"^=":i=l.indexOf(u)===0;break;case"=":i=t===r;break;case">":h=!0,i=t>r;break;case">=":h=!0,i=t>=r;break;case"<":h=!0,i=t<r;break;case"<=":h=!0,i=t<=r;break;default:i=!1;break}return f&&(t!=null||!h)&&(i=!i),i},Aat=function(t,n){switch(n){case"?":return!!t;case"!":return!t;case"^":return t===void 0}},Tat=function(t){return t!==void 0},Oee=function(t,n){return t.data(n)},Dat=function(t,n){return t[n]()},Qr=[],vr=function(t,n){return t.checks.every(function(r){return Qr[r.type](r,n)})};Qr[je.GROUP]=function(e,t){var n=e.value;return n==="*"||n===t.group()};Qr[je.STATE]=function(e,t){var n=e.value;return wat(n,t)};Qr[je.ID]=function(e,t){var n=e.value;return t.id()===n};Qr[je.CLASS]=function(e,t){var n=e.value;return t.hasClass(n)};Qr[je.META_COMPARE]=function(e,t){var n=e.field,r=e.operator,i=e.value;return sEe(Dat(t,n),r,i)};Qr[je.DATA_COMPARE]=function(e,t){var n=e.field,r=e.operator,i=e.value;return sEe(Oee(t,n),r,i)};Qr[je.DATA_BOOL]=function(e,t){var n=e.field,r=e.operator;return Aat(Oee(t,n),r)};Qr[je.DATA_EXIST]=function(e,t){var n=e.field;return e.operator,Tat(Oee(t,n))};Qr[je.UNDIRECTED_EDGE]=function(e,t){var n=e.nodes[0],r=e.nodes[1],i=t.source(),s=t.target();return vr(n,i)&&vr(r,s)||vr(r,i)&&vr(n,s)};Qr[je.NODE_NEIGHBOR]=function(e,t){return vr(e.node,t)&&t.neighborhood().some(function(n){return n.isNode()&&vr(e.neighbor,n)})};Qr[je.DIRECTED_EDGE]=function(e,t){return vr(e.source,t.source())&&vr(e.target,t.target())};Qr[je.NODE_SOURCE]=function(e,t){return vr(e.source,t)&&t.outgoers().some(function(n){return n.isNode()&&vr(e.target,n)})};Qr[je.NODE_TARGET]=function(e,t){return vr(e.target,t)&&t.incomers().some(function(n){return n.isNode()&&vr(e.source,n)})};Qr[je.CHILD]=function(e,t){return vr(e.child,t)&&vr(e.parent,t.parent())};Qr[je.PARENT]=function(e,t){return vr(e.parent,t)&&t.children().some(function(n){return vr(e.child,n)})};Qr[je.DESCENDANT]=function(e,t){return vr(e.descendant,t)&&t.ancestors().some(function(n){return vr(e.ancestor,n)})};Qr[je.ANCESTOR]=function(e,t){return vr(e.ancestor,t)&&t.descendants().some(function(n){return vr(e.descendant,n)})};Qr[je.COMPOUND_SPLIT]=function(e,t){return vr(e.subject,t)&&vr(e.left,t)&&vr(e.right,t)};Qr[je.TRUE]=function(){return!0};Qr[je.COLLECTION]=function(e,t){var n=e.value;return n.has(t)};Qr[je.FILTER]=function(e,t){var n=e.value;return n(t)};var Iat=function(t){var n=this;if(n.length===1&&n[0].checks.length===1&&n[0].checks[0].type===je.ID)return t.getElementById(n[0].checks[0].value).collection();var r=function(s){for(var a=0;a<n.length;a++){var o=n[a];if(vr(o,s))return!0}return!1};return n.text()==null&&(r=function(){return!0}),t.filter(r)},Nat=function(t){for(var n=this,r=0;r<n.length;r++){var i=n[r];if(vr(i,t))return!0}return!1},Mat={matches:Nat,filter:Iat},M0=function(t){this.inputText=t,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,t==null||rt(t)&&t.match(/^\s*$/)||(Rl(t)?this.addQuery({checks:[{type:je.COLLECTION,value:t.collection()}]}):zr(t)?this.addQuery({checks:[{type:je.FILTER,value:t}]}):rt(t)?this.parse(t)||(this.invalid=!0):Xr("A selector must be created from a string; found "))},F0=M0.prototype;[Eat,Mat].forEach(function(e){return pt(F0,e)});F0.text=function(){return this.inputText};F0.size=function(){return this.length};F0.eq=function(e){return this[e]};F0.sameText=function(e){return!this.invalid&&!e.invalid&&this.text()===e.text()};F0.addQuery=function(e){this[this.length++]=e};F0.selector=F0.toString;var c0={allAre:function(t){var n=new M0(t);return this.every(function(r){return n.matches(r)})},is:function(t){var n=new M0(t);return this.some(function(r){return n.matches(r)})},some:function(t,n){for(var r=0;r<this.length;r++){var i=n?t.apply(n,[this[r],r,this]):t(this[r],r,this);if(i)return!0}return!1},every:function(t,n){for(var r=0;r<this.length;r++){var i=n?t.apply(n,[this[r],r,this]):t(this[r],r,this);if(!i)return!1}return!0},same:function(t){if(this===t)return!0;t=this.cy().collection(t);var n=this.length,r=t.length;return n!==r?!1:n===1?this[0]===t[0]:this.every(function(i){return t.hasElementWithId(i.id())})},anySame:function(t){return t=this.cy().collection(t),this.some(function(n){return t.hasElementWithId(n.id())})},allAreNeighbors:function(t){t=this.cy().collection(t);var n=this.neighborhood();return t.every(function(r){return n.hasElementWithId(r.id())})},contains:function(t){t=this.cy().collection(t);var n=this;return t.every(function(r){return n.hasElementWithId(r.id())})}};c0.allAreNeighbours=c0.allAreNeighbors;c0.has=c0.contains;c0.equal=c0.equals=c0.same;var cu=function(t,n){return function(i,s,a,o){var l=i,u=this,c;if(l==null?c="":Rl(l)&&l.length===1&&(c=l.id()),u.length===1&&c){var f=u[0]._private,h=f.traversalCache=f.traversalCache||{},d=h[n]=h[n]||[],p=Sy(c),g=d[p];return g||(d[p]=t.call(u,i,s,a,o))}else return t.call(u,i,s,a,o)}},Aw={parent:function(t){var n=[];if(this.length===1){var r=this[0]._private.parent;if(r)return r}for(var i=0;i<this.length;i++){var s=this[i],a=s._private.parent;a&&n.push(a)}return this.spawn(n,!0).filter(t)},parents:function(t){for(var n=[],r=this.parent();r.nonempty();){for(var i=0;i<r.length;i++){var s=r[i];n.push(s)}r=r.parent()}return this.spawn(n,!0).filter(t)},commonAncestors:function(t){for(var n,r=0;r<this.length;r++){var i=this[r],s=i.parents();n=n||s,n=n.intersect(s)}return n.filter(t)},orphans:function(t){return this.stdFilter(function(n){return n.isOrphan()}).filter(t)},nonorphans:function(t){return this.stdFilter(function(n){return n.isChild()}).filter(t)},children:cu(function(e){for(var t=[],n=0;n<this.length;n++)for(var r=this[n],i=r._private.children,s=0;s<i.length;s++)t.push(i[s]);return this.spawn(t,!0).filter(e)},"children"),siblings:function(t){return this.parent().children().not(this).filter(t)},isParent:function(){var t=this[0];if(t)return t.isNode()&&t._private.children.length!==0},isChildless:function(){var t=this[0];if(t)return t.isNode()&&t._private.children.length===0},isChild:function(){var t=this[0];if(t)return t.isNode()&&t._private.parent!=null},isOrphan:function(){var t=this[0];if(t)return t.isNode()&&t._private.parent==null},descendants:function(t){var n=[];function r(i){for(var s=0;s<i.length;s++){var a=i[s];n.push(a),a.children().nonempty()&&r(a.children())}}return r(this.children()),this.spawn(n,!0).filter(t)}};function Ree(e,t,n,r){for(var i=[],s=new bC,a=e.cy(),o=a.hasCompoundNodes(),l=0;l<e.length;l++){var u=e[l];n?i.push(u):o&&r(i,s,u)}for(;i.length>0;){var c=i.shift();t(c),s.add(c.id()),o&&r(i,s,c)}return e}function aEe(e,t,n){if(n.isParent())for(var r=n._private.children,i=0;i<r.length;i++){var s=r[i];t.has(s.id())||e.push(s)}}Aw.forEachDown=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Ree(this,e,t,aEe)};function oEe(e,t,n){if(n.isChild()){var r=n._private.parent;t.has(r.id())||e.push(r)}}Aw.forEachUp=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Ree(this,e,t,oEe)};function Fat(e,t,n){oEe(e,t,n),aEe(e,t,n)}Aw.forEachUpAndDown=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Ree(this,e,t,Fat)};Aw.ancestors=Aw.parents;var nT,lEe;nT=lEe={data:Fn.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:Fn.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:Fn.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Fn.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:Fn.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:Fn.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var t=this[0];if(t)return t._private.data.id}};nT.attr=nT.data;nT.removeAttr=nT.removeData;var Oat=lEe,p8={};function ZV(e){return function(t){var n=this;if(t===void 0&&(t=!0),n.length!==0)if(n.isNode()&&!n.removed()){for(var r=0,i=n[0],s=i._private.edges,a=0;a<s.length;a++){var o=s[a];!t&&o.isLoop()||(r+=e(i,o))}return r}else return}}pt(p8,{degree:ZV(function(e,t){return t.source().same(t.target())?2:1}),indegree:ZV(function(e,t){return t.target().same(e)?1:0}),outdegree:ZV(function(e,t){return t.source().same(e)?1:0})});function Kx(e,t){return function(n){for(var r,i=this.nodes(),s=0;s<i.length;s++){var a=i[s],o=a[e](n);o!==void 0&&(r===void 0||t(o,r))&&(r=o)}return r}}pt(p8,{minDegree:Kx("degree",function(e,t){return e<t}),maxDegree:Kx("degree",function(e,t){return e>t}),minIndegree:Kx("indegree",function(e,t){return e<t}),maxIndegree:Kx("indegree",function(e,t){return e>t}),minOutdegree:Kx("outdegree",function(e,t){return e<t}),maxOutdegree:Kx("outdegree",function(e,t){return e>t})});pt(p8,{totalDegree:function(t){for(var n=0,r=this.nodes(),i=0;i<r.length;i++)n+=r[i].degree(t);return n}});var Pc,uEe,cEe=function(t,n,r){for(var i=0;i<t.length;i++){var s=t[i];if(!s.locked()){var a=s._private.position,o={x:n.x!=null?n.x-a.x:0,y:n.y!=null?n.y-a.y:0};s.isParent()&&!(o.x===0&&o.y===0)&&s.children().shift(o,r),s.dirtyBoundingBoxCache()}}},bpe={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(t){t.updateCompoundBounds()},beforeSet:function(t,n){cEe(t,n,!1)},onSet:function(t){t.dirtyCompoundBoundsCache()},canSet:function(t){return!t.locked()}};Pc=uEe={position:Fn.data(bpe),silentPosition:Fn.data(pt({},bpe,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(t,n){cEe(t,n,!0)},onSet:function(t){t.dirtyCompoundBoundsCache()}})),positions:function(t,n){if(dn(t))n?this.silentPosition(t):this.position(t);else if(zr(t)){var r=t,i=this.cy();i.startBatch();for(var s=0;s<this.length;s++){var a=this[s],o=void 0;(o=r(a,s))&&(n?a.silentPosition(o):a.position(o))}i.endBatch()}return this},silentPositions:function(t){return this.positions(t,!0)},shift:function(t,n,r){var i;if(dn(t)?(i={x:Pe(t.x)?t.x:0,y:Pe(t.y)?t.y:0},r=n):rt(t)&&Pe(n)&&(i={x:0,y:0},i[t]=n),i!=null){var s=this.cy();s.startBatch();for(var a=0;a<this.length;a++){var o=this[a];if(!(s.hasCompoundNodes()&&o.isChild()&&o.ancestors().anySame(this))){var l=o.position(),u={x:l.x+i.x,y:l.y+i.y};r?o.silentPosition(u):o.position(u)}}s.endBatch()}return this},silentShift:function(t,n){return dn(t)?this.shift(t,!0):rt(t)&&Pe(n)&&this.shift(t,n,!0),this},renderedPosition:function(t,n){var r=this[0],i=this.cy(),s=i.zoom(),a=i.pan(),o=dn(t)?t:void 0,l=o!==void 0||n!==void 0&&rt(t);if(r&&r.isNode())if(l)for(var u=0;u<this.length;u++){var c=this[u];n!==void 0?c.position(t,(n-a[t])/s):o!==void 0&&c.position(Wke(o,s,a))}else{var f=r.position();return o=h8(f,s,a),t===void 0?o:o[t]}else if(!l)return;return this},relativePosition:function(t,n){var r=this[0],i=this.cy(),s=dn(t)?t:void 0,a=s!==void 0||n!==void 0&&rt(t),o=i.hasCompoundNodes();if(r&&r.isNode())if(a)for(var l=0;l<this.length;l++){var u=this[l],c=o?u.parent():null,f=c&&c.length>0,h=f;f&&(c=c[0]);var d=h?c.position():{x:0,y:0};n!==void 0?u.position(t,n+d[t]):s!==void 0&&u.position({x:s.x+d.x,y:s.y+d.y})}else{var p=r.position(),g=o?r.parent():null,m=g&&g.length>0,v=m;m&&(g=g[0]);var y=v?g.position():{x:0,y:0};return s={x:p.x-y.x,y:p.y-y.y},t===void 0?s:s[t]}else if(!a)return;return this}};Pc.modelPosition=Pc.point=Pc.position;Pc.modelPositions=Pc.points=Pc.positions;Pc.renderedPoint=Pc.renderedPosition;Pc.relativePoint=Pc.relativePosition;var Rat=uEe,H2,Mm;H2=Mm={};Mm.renderedBoundingBox=function(e){var t=this.boundingBox(e),n=this.cy(),r=n.zoom(),i=n.pan(),s=t.x1*r+i.x,a=t.x2*r+i.x,o=t.y1*r+i.y,l=t.y2*r+i.y;return{x1:s,x2:a,y1:o,y2:l,w:a-s,h:l-o}};Mm.dirtyCompoundBoundsCache=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.cy();return!t.styleEnabled()||!t.hasCompoundNodes()?this:(this.forEachUp(function(n){if(n.isParent()){var r=n._private;r.compoundBoundsClean=!1,r.bbCache=null,e||n.emitAndNotify("bounds")}}),this)};Mm.updateCompoundBounds=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.cy();if(!t.styleEnabled()||!t.hasCompoundNodes())return this;if(!e&&t.batching())return this;function n(a){if(!a.isParent())return;var o=a._private,l=a.children(),u=a.pstyle("compound-sizing-wrt-labels").value==="include",c={width:{val:a.pstyle("min-width").pfValue,left:a.pstyle("min-width-bias-left"),right:a.pstyle("min-width-bias-right")},height:{val:a.pstyle("min-height").pfValue,top:a.pstyle("min-height-bias-top"),bottom:a.pstyle("min-height-bias-bottom")}},f=l.boundingBox({includeLabels:u,includeOverlays:!1,useCache:!1}),h=o.position;(f.w===0||f.h===0)&&(f={w:a.pstyle("width").pfValue,h:a.pstyle("height").pfValue},f.x1=h.x-f.w/2,f.x2=h.x+f.w/2,f.y1=h.y-f.h/2,f.y2=h.y+f.h/2);function d(k,E,S){var I=0,A=0,D=E+S;return k>0&&D>0&&(I=E/D*k,A=S/D*k),{biasDiff:I,biasComplementDiff:A}}function p(k,E,S,I){if(S.units==="%")switch(I){case"width":return k>0?S.pfValue*k:0;case"height":return E>0?S.pfValue*E:0;case"average":return k>0&&E>0?S.pfValue*(k+E)/2:0;case"min":return k>0&&E>0?k>E?S.pfValue*E:S.pfValue*k:0;case"max":return k>0&&E>0?k>E?S.pfValue*k:S.pfValue*E:0;default:return 0}else return S.units==="px"?S.pfValue:0}var g=c.width.left.value;c.width.left.units==="px"&&c.width.val>0&&(g=g*100/c.width.val);var m=c.width.right.value;c.width.right.units==="px"&&c.width.val>0&&(m=m*100/c.width.val);var v=c.height.top.value;c.height.top.units==="px"&&c.height.val>0&&(v=v*100/c.height.val);var y=c.height.bottom.value;c.height.bottom.units==="px"&&c.height.val>0&&(y=y*100/c.height.val);var b=d(c.width.val-f.w,g,m),x=b.biasDiff,w=b.biasComplementDiff,C=d(c.height.val-f.h,v,y),$=C.biasDiff,_=C.biasComplementDiff;o.autoPadding=p(f.w,f.h,a.pstyle("padding"),a.pstyle("padding-relative-to").value),o.autoWidth=Math.max(f.w,c.width.val),h.x=(-x+f.x1+f.x2+w)/2,o.autoHeight=Math.max(f.h,c.height.val),h.y=(-$+f.y1+f.y2+_)/2}for(var r=0;r<this.length;r++){var i=this[r],s=i._private;(!s.compoundBoundsClean||e)&&(n(i),t.batching()||(s.compoundBoundsClean=!0))}return this};var uu=function(t){return t===1/0||t===-1/0?0:t},dc=function(t,n,r,i,s){i-n===0||s-r===0||n==null||r==null||i==null||s==null||(t.x1=n<t.x1?n:t.x1,t.x2=i>t.x2?i:t.x2,t.y1=r<t.y1?r:t.y1,t.y2=s>t.y2?s:t.y2,t.w=t.x2-t.x1,t.h=t.y2-t.y1)},Hv=function(t,n){return n==null?t:dc(t,n.x1,n.y1,n.x2,n.y2)},jS=function(t,n,r){return gc(t,n,r)},GF=function(t,n,r){if(!n.cy().headless()){var i=n._private,s=i.rstyle,a=s.arrowWidth/2,o=n.pstyle(r+"-arrow-shape").value,l,u;if(o!=="none"){r==="source"?(l=s.srcX,u=s.srcY):r==="target"?(l=s.tgtX,u=s.tgtY):(l=s.midX,u=s.midY);var c=i.arrowBounds=i.arrowBounds||{},f=c[r]=c[r]||{};f.x1=l-a,f.y1=u-a,f.x2=l+a,f.y2=u+a,f.w=f.x2-f.x1,f.h=f.y2-f.y1,qR(f,1),dc(t,f.x1,f.y1,f.x2,f.y2)}}},QV=function(t,n,r){if(!n.cy().headless()){var i;r?i=r+"-":i="";var s=n._private,a=s.rstyle,o=n.pstyle(i+"label").strValue;if(o){var l=n.pstyle("text-halign"),u=n.pstyle("text-valign"),c=jS(a,"labelWidth",r),f=jS(a,"labelHeight",r),h=jS(a,"labelX",r),d=jS(a,"labelY",r),p=n.pstyle(i+"text-margin-x").pfValue,g=n.pstyle(i+"text-margin-y").pfValue,m=n.isEdge(),v=n.pstyle(i+"text-rotation"),y=n.pstyle("text-outline-width").pfValue,b=n.pstyle("text-border-width").pfValue,x=b/2,w=n.pstyle("text-background-padding").pfValue,C=2,$=f,_=c,k=_/2,E=$/2,S,I,A,D;if(m)S=h-k,I=h+k,A=d-E,D=d+E;else{switch(l.value){case"left":S=h-_,I=h;break;case"center":S=h-k,I=h+k;break;case"right":S=h,I=h+_;break}switch(u.value){case"top":A=d-$,D=d;break;case"center":A=d-E,D=d+E;break;case"bottom":A=d,D=d+$;break}}S+=p-Math.max(y,x)-w-C,I+=p+Math.max(y,x)+w+C,A+=g-Math.max(y,x)-w-C,D+=g+Math.max(y,x)+w+C;var T=r||"main",N=s.labelBounds,F=N[T]=N[T]||{};F.x1=S,F.y1=A,F.x2=I,F.y2=D,F.w=I-S,F.h=D-A;var R=m&&v.strValue==="autorotate",P=v.pfValue!=null&&v.pfValue!==0;if(R||P){var V=R?jS(s.rstyle,"labelAngle",r):v.pfValue,z=Math.cos(V),q=Math.sin(V),G=(S+I)/2,K=(A+D)/2;if(!m){switch(l.value){case"left":G=I;break;case"right":G=S;break}switch(u.value){case"top":K=D;break;case"bottom":K=A;break}}var Y=function(ue,X){return ue=ue-G,X=X-K,{x:ue*z-X*q+G,y:ue*q+X*z+K}},te=Y(S,A),Z=Y(S,D),ae=Y(I,A),O=Y(I,D);S=Math.min(te.x,Z.x,ae.x,O.x),I=Math.max(te.x,Z.x,ae.x,O.x),A=Math.min(te.y,Z.y,ae.y,O.y),D=Math.max(te.y,Z.y,ae.y,O.y)}var L=T+"Rot",W=N[L]=N[L]||{};W.x1=S,W.y1=A,W.x2=I,W.y2=D,W.w=I-S,W.h=D-A,dc(t,S,A,I,D),dc(s.labelBounds.all,S,A,I,D)}return t}},Pat=function(t,n){var r=t._private.cy,i=r.styleEnabled(),s=r.headless(),a=il(),o=t._private,l=t.isNode(),u=t.isEdge(),c,f,h,d,p,g,m=o.rstyle,v=l&&i?t.pstyle("bounds-expansion").pfValue:[0],y=function(oe){return oe.pstyle("display").value!=="none"},b=!i||y(t)&&(!u||y(t.source())&&y(t.target()));if(b){var x=0,w=0;i&&n.includeOverlays&&(x=t.pstyle("overlay-opacity").value,x!==0&&(w=t.pstyle("overlay-padding").value));var C=0,$=0;i&&n.includeUnderlays&&(C=t.pstyle("underlay-opacity").value,C!==0&&($=t.pstyle("underlay-padding").value));var _=Math.max(w,$),k=0,E=0;if(i&&(k=t.pstyle("width").pfValue,E=k/2),l&&n.includeNodes){var S=t.position();p=S.x,g=S.y;var I=t.outerWidth(),A=I/2,D=t.outerHeight(),T=D/2;c=p-A,f=p+A,h=g-T,d=g+T,dc(a,c,h,f,d)}else if(u&&n.includeEdges)if(i&&!s){var N=t.pstyle("curve-style").strValue;if(c=Math.min(m.srcX,m.midX,m.tgtX),f=Math.max(m.srcX,m.midX,m.tgtX),h=Math.min(m.srcY,m.midY,m.tgtY),d=Math.max(m.srcY,m.midY,m.tgtY),c-=E,f+=E,h-=E,d+=E,dc(a,c,h,f,d),N==="haystack"){var F=m.haystackPts;if(F&&F.length===2){if(c=F[0].x,h=F[0].y,f=F[1].x,d=F[1].y,c>f){var R=c;c=f,f=R}if(h>d){var P=h;h=d,d=P}dc(a,c-E,h-E,f+E,d+E)}}else if(N==="bezier"||N==="unbundled-bezier"||N==="segments"||N==="taxi"){var V;switch(N){case"bezier":case"unbundled-bezier":V=m.bezierPts;break;case"segments":case"taxi":V=m.linePts;break}if(V!=null)for(var z=0;z<V.length;z++){var q=V[z];c=q.x-E,f=q.x+E,h=q.y-E,d=q.y+E,dc(a,c,h,f,d)}}}else{var G=t.source(),K=G.position(),Y=t.target(),te=Y.position();if(c=K.x,f=te.x,h=K.y,d=te.y,c>f){var Z=c;c=f,f=Z}if(h>d){var ae=h;h=d,d=ae}c-=E,f+=E,h-=E,d+=E,dc(a,c,h,f,d)}if(i&&n.includeEdges&&u&&(GF(a,t,"mid-source"),GF(a,t,"mid-target"),GF(a,t,"source"),GF(a,t,"target")),i){var O=t.pstyle("ghost").value==="yes";if(O){var L=t.pstyle("ghost-offset-x").pfValue,W=t.pstyle("ghost-offset-y").pfValue;dc(a,a.x1+L,a.y1+W,a.x2+L,a.y2+W)}}var M=o.bodyBounds=o.bodyBounds||{};rpe(M,a),YV(M,v),qR(M,1),i&&(c=a.x1,f=a.x2,h=a.y1,d=a.y2,dc(a,c-_,h-_,f+_,d+_));var ue=o.overlayBounds=o.overlayBounds||{};rpe(ue,a),YV(ue,v),qR(ue,1);var X=o.labelBounds=o.labelBounds||{};X.all!=null?cst(X.all):X.all=il(),i&&n.includeLabels&&(n.includeMainLabels&&QV(a,t,null),u&&(n.includeSourceLabels&&QV(a,t,"source"),n.includeTargetLabels&&QV(a,t,"target")))}return a.x1=uu(a.x1),a.y1=uu(a.y1),a.x2=uu(a.x2),a.y2=uu(a.y2),a.w=uu(a.x2-a.x1),a.h=uu(a.y2-a.y1),a.w>0&&a.h>0&&b&&(YV(a,v),qR(a,1)),a},fEe=function(t){var n=0,r=function(a){return(a?1:0)<<n++},i=0;return i+=r(t.incudeNodes),i+=r(t.includeEdges),i+=r(t.includeLabels),i+=r(t.includeMainLabels),i+=r(t.includeSourceLabels),i+=r(t.includeTargetLabels),i+=r(t.includeOverlays),i},hEe=function(t){if(t.isEdge()){var n=t.source().position(),r=t.target().position(),i=function(a){return Math.round(a)};return Nit([i(n.x),i(n.y),i(r.x),i(r.y)])}else return 0},xpe=function(t,n){var r=t._private,i,s=t.isEdge(),a=n==null?wpe:fEe(n),o=a===wpe,l=hEe(t),u=r.bbCachePosKey===l,c=n.useCache&&u,f=function(g){return g._private.bbCache==null||g._private.styleDirty},h=!c||f(t)||s&&f(t.source())||f(t.target());if(h?(u||t.recalculateRenderedStyle(c),i=Pat(t,rT),r.bbCache=i,r.bbCachePosKey=l):i=r.bbCache,!o){var d=t.isNode();i=il(),(n.includeNodes&&d||n.includeEdges&&!d)&&(n.includeOverlays?Hv(i,r.overlayBounds):Hv(i,r.bodyBounds)),n.includeLabels&&(n.includeMainLabels&&(!s||n.includeSourceLabels&&n.includeTargetLabels)?Hv(i,r.labelBounds.all):(n.includeMainLabels&&Hv(i,r.labelBounds.mainRot),n.includeSourceLabels&&Hv(i,r.labelBounds.sourceRot),n.includeTargetLabels&&Hv(i,r.labelBounds.targetRot))),i.w=i.x2-i.x1,i.h=i.y2-i.y1}return i},rT={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,useCache:!0},wpe=fEe(rT),$pe=Gs(rT);Mm.boundingBox=function(e){var t;if(this.length===1&&this[0]._private.bbCache!=null&&!this[0]._private.styleDirty&&(e===void 0||e.useCache===void 0||e.useCache===!0))e===void 0?e=rT:e=$pe(e),t=xpe(this[0],e);else{t=il(),e=e||rT;var n=$pe(e),r=this,i=r.cy(),s=i.styleEnabled();if(s)for(var a=0;a<r.length;a++){var o=r[a],l=o._private,u=hEe(o),c=l.bbCachePosKey===u,f=n.useCache&&c&&!l.styleDirty;o.recalculateRenderedStyle(f)}this.updateCompoundBounds(!e.useCache);for(var h=0;h<r.length;h++){var d=r[h];Hv(t,xpe(d,n))}}return t.x1=uu(t.x1),t.y1=uu(t.y1),t.x2=uu(t.x2),t.y2=uu(t.y2),t.w=uu(t.x2-t.x1),t.h=uu(t.y2-t.y1),t};Mm.dirtyBoundingBoxCache=function(){for(var e=0;e<this.length;e++){var t=this[e]._private;t.bbCache=null,t.bbCachePosKey=null,t.bodyBounds=null,t.overlayBounds=null,t.labelBounds.all=null,t.labelBounds.source=null,t.labelBounds.target=null,t.labelBounds.main=null,t.labelBounds.sourceRot=null,t.labelBounds.targetRot=null,t.labelBounds.mainRot=null,t.arrowBounds.source=null,t.arrowBounds.target=null,t.arrowBounds["mid-source"]=null,t.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Mm.boundingBoxAt=function(e){var t=this.nodes(),n=this.cy(),r=n.hasCompoundNodes(),i=n.collection();if(r&&(i=t.filter(function(u){return u.isParent()}),t=t.not(i)),dn(e)){var s=e;e=function(){return s}}var a=function(c,f){return c._private.bbAtOldPos=e(c,f)},o=function(c){return c._private.bbAtOldPos};n.startBatch(),t.forEach(a).silentPositions(e),r&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0));var l=ust(this.boundingBox({useCache:!1}));return t.silentPositions(o),r&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0)),n.endBatch(),l};H2.boundingbox=H2.bb=H2.boundingBox;H2.renderedBoundingbox=H2.renderedBoundingBox;var Lat=Mm,Qk,uI;Qk=uI={};var dEe=function(t){t.uppercaseName=Jde(t.name),t.autoName="auto"+t.uppercaseName,t.labelName="label"+t.uppercaseName,t.outerName="outer"+t.uppercaseName,t.uppercaseOuterName=Jde(t.outerName),Qk[t.name]=function(){var r=this[0],i=r._private,s=i.cy,a=s._private.styleEnabled;if(r)if(a){if(r.isParent())return r.updateCompoundBounds(),i[t.autoName]||0;var o=r.pstyle(t.name);switch(o.strValue){case"label":return r.recalculateRenderedStyle(),i.rstyle[t.labelName]||0;default:return o.pfValue}}else return 1},Qk["outer"+t.uppercaseName]=function(){var r=this[0],i=r._private,s=i.cy,a=s._private.styleEnabled;if(r)if(a){var o=r[t.name](),l=r.pstyle("border-width").pfValue,u=2*r.padding();return o+l+u}else return 1},Qk["rendered"+t.uppercaseName]=function(){var r=this[0];if(r){var i=r[t.name]();return i*this.cy().zoom()}},Qk["rendered"+t.uppercaseOuterName]=function(){var r=this[0];if(r){var i=r[t.outerName]();return i*this.cy().zoom()}}};dEe({name:"width"});dEe({name:"height"});uI.padding=function(){var e=this[0],t=e._private;return e.isParent()?(e.updateCompoundBounds(),t.autoPadding!==void 0?t.autoPadding:e.pstyle("padding").pfValue):e.pstyle("padding").pfValue};uI.paddedHeight=function(){var e=this[0];return e.height()+2*e.padding()};uI.paddedWidth=function(){var e=this[0];return e.width()+2*e.padding()};var Bat=uI,zat=function(t,n){if(t.isEdge())return n(t)},Uat=function(t,n){if(t.isEdge()){var r=t.cy();return h8(n(t),r.zoom(),r.pan())}},Wat=function(t,n){if(t.isEdge()){var r=t.cy(),i=r.pan(),s=r.zoom();return n(t).map(function(a){return h8(a,s,i)})}},Vat=function(t){return t.renderer().getControlPoints(t)},jat=function(t){return t.renderer().getSegmentPoints(t)},Hat=function(t){return t.renderer().getSourceEndpoint(t)},qat=function(t){return t.renderer().getTargetEndpoint(t)},Gat=function(t){return t.renderer().getEdgeMidpoint(t)},Cpe={controlPoints:{get:Vat,mult:!0},segmentPoints:{get:jat,mult:!0},sourceEndpoint:{get:Hat},targetEndpoint:{get:qat},midpoint:{get:Gat}},Yat=function(t){return"rendered"+t[0].toUpperCase()+t.substr(1)},Xat=Object.keys(Cpe).reduce(function(e,t){var n=Cpe[t],r=Yat(t);return e[t]=function(){return zat(this,n.get)},n.mult?e[r]=function(){return Wat(this,n.get)}:e[r]=function(){return Uat(this,n.get)},e},{}),Kat=pt({},Rat,Lat,Bat,Xat);/*!
Event object based on jQuery events, MIT license

https://jquery.org/license/
https://tldrlegal.com/license/mit-license
https://github.com/jquery/jquery/blob/master/src/event.js
*/var pEe=function(t,n){this.recycle(t,n)};function HS(){return!1}function YF(){return!0}pEe.prototype={instanceString:function(){return"event"},recycle:function(t,n){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=HS,t!=null&&t.preventDefault?(this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?YF:HS):t!=null&&t.type?n=t:this.type=t,n!=null&&(this.originalEvent=n.originalEvent,this.type=n.type!=null?n.type:this.type,this.cy=n.cy,this.target=n.target,this.position=n.position,this.renderedPosition=n.renderedPosition,this.namespace=n.namespace,this.layout=n.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var r=this.position,i=this.cy.zoom(),s=this.cy.pan();this.renderedPosition={x:r.x*i+s.x,y:r.y*i+s.y}}this.timeStamp=t&&t.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=YF;var t=this.originalEvent;!t||t.preventDefault&&t.preventDefault()},stopPropagation:function(){this.isPropagationStopped=YF;var t=this.originalEvent;!t||t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=YF,this.stopPropagation()},isDefaultPrevented:HS,isPropagationStopped:HS,isImmediatePropagationStopped:HS};var gEe=/^([^.]+)(\.(?:[^.]+))?$/,Zat=".*",mEe={qualifierCompare:function(t,n){return t===n},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(t){return t},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},_pe=Object.keys(mEe),Qat={};function g8(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Qat,t=arguments.length>1?arguments[1]:void 0,n=0;n<_pe.length;n++){var r=_pe[n];this[r]=e[r]||mEe[r]}this.context=t||this.context,this.listeners=[],this.emitting=0}var O0=g8.prototype,vEe=function(t,n,r,i,s,a,o){zr(i)&&(s=i,i=null),o&&(a==null?a=o:a=pt({},a,o));for(var l=Qn(r)?r:r.split(/\s+/),u=0;u<l.length;u++){var c=l[u];if(!I0(c)){var f=c.match(gEe);if(f){var h=f[1],d=f[2]?f[2]:null,p=n(t,c,h,d,i,s,a);if(p===!1)break}}}},Spe=function(t,n){return t.addEventFields(t.context,n),new pEe(n.type,n)},Jat=function(t,n,r){if(hit(r)){n(t,r);return}else if(dn(r)){n(t,Spe(t,r));return}for(var i=Qn(r)?r:r.split(/\s+/),s=0;s<i.length;s++){var a=i[s];if(!I0(a)){var o=a.match(gEe);if(o){var l=o[1],u=o[2]?o[2]:null,c=Spe(t,{type:l,namespace:u,target:t.context});n(t,c)}}}};O0.on=O0.addListener=function(e,t,n,r,i){return vEe(this,function(s,a,o,l,u,c,f){zr(c)&&s.listeners.push({event:a,callback:c,type:o,namespace:l,qualifier:u,conf:f})},e,t,n,r,i),this};O0.one=function(e,t,n,r){return this.on(e,t,n,r,{one:!0})};O0.removeListener=O0.off=function(e,t,n,r){var i=this;this.emitting!==0&&(this.listeners=Pit(this.listeners));for(var s=this.listeners,a=function(u){var c=s[u];vEe(i,function(f,h,d,p,g,m){if((c.type===d||e==="*")&&(!p&&c.namespace!==".*"||c.namespace===p)&&(!g||f.qualifierCompare(c.qualifier,g))&&(!m||c.callback===m))return s.splice(u,1),!1},e,t,n,r)},o=s.length-1;o>=0;o--)a(o);return this};O0.removeAllListeners=function(){return this.removeListener("*")};O0.emit=O0.trigger=function(e,t,n){var r=this.listeners,i=r.length;return this.emitting++,Qn(t)||(t=[t]),Jat(this,function(s,a){n!=null&&(r=[{event:a.event,type:a.type,namespace:a.namespace,callback:n}],i=r.length);for(var o=function(c){var f=r[c];if(f.type===a.type&&(!f.namespace||f.namespace===a.namespace||f.namespace===Zat)&&s.eventMatches(s.context,f,a)){var h=[a];t!=null&&Bit(h,t),s.beforeEmit(s.context,f,a),f.conf&&f.conf.one&&(s.listeners=s.listeners.filter(function(g){return g!==f}));var d=s.callbackContext(s.context,f,a),p=f.callback.apply(d,h);s.afterEmit(s.context,f,a),p===!1&&(a.stopPropagation(),a.preventDefault())}},l=0;l<i;l++)o(l);s.bubble(s.context)&&!a.isPropagationStopped()&&s.parent(s.context).emit(a,t)},e),this.emitting--,this};var eot={qualifierCompare:function(t,n){return t==null||n==null?t==null&&n==null:t.sameText(n)},eventMatches:function(t,n,r){var i=n.qualifier;return i!=null?t!==r.target&&oI(r.target)&&i.matches(r.target):!0},addEventFields:function(t,n){n.cy=t.cy(),n.target=t},callbackContext:function(t,n,r){return n.qualifier!=null?r.target:t},beforeEmit:function(t,n){n.conf&&n.conf.once&&n.conf.onceCollection.removeListener(n.event,n.qualifier,n.callback)},bubble:function(){return!0},parent:function(t){return t.isChild()?t.parent():t.cy()}},XF=function(t){return rt(t)?new M0(t):t},yEe={createEmitter:function(){for(var t=0;t<this.length;t++){var n=this[t],r=n._private;r.emitter||(r.emitter=new g8(eot,n))}return this},emitter:function(){return this._private.emitter},on:function(t,n,r){for(var i=XF(n),s=0;s<this.length;s++){var a=this[s];a.emitter().on(t,i,r)}return this},removeListener:function(t,n,r){for(var i=XF(n),s=0;s<this.length;s++){var a=this[s];a.emitter().removeListener(t,i,r)}return this},removeAllListeners:function(){for(var t=0;t<this.length;t++){var n=this[t];n.emitter().removeAllListeners()}return this},one:function(t,n,r){for(var i=XF(n),s=0;s<this.length;s++){var a=this[s];a.emitter().one(t,i,r)}return this},once:function(t,n,r){for(var i=XF(n),s=0;s<this.length;s++){var a=this[s];a.emitter().on(t,i,r,{once:!0,onceCollection:this})}},emit:function(t,n){for(var r=0;r<this.length;r++){var i=this[r];i.emitter().emit(t,n)}return this},emitAndNotify:function(t,n){if(this.length!==0)return this.cy().notify(t,this),this.emit(t,n),this}};Fn.eventAliasesOn(yEe);var bEe={nodes:function(t){return this.filter(function(n){return n.isNode()}).filter(t)},edges:function(t){return this.filter(function(n){return n.isEdge()}).filter(t)},byGroup:function(){for(var t=this.spawn(),n=this.spawn(),r=0;r<this.length;r++){var i=this[r];i.isNode()?t.push(i):n.push(i)}return{nodes:t,edges:n}},filter:function(t,n){if(t===void 0)return this;if(rt(t)||Rl(t))return new M0(t).filter(this);if(zr(t)){for(var r=this.spawn(),i=this,s=0;s<i.length;s++){var a=i[s],o=n?t.apply(n,[a,s,i]):t(a,s,i);o&&r.push(a)}return r}return this.spawn()},not:function(t){if(t){rt(t)&&(t=this.filter(t));for(var n=this.spawn(),r=0;r<this.length;r++){var i=this[r],s=t.has(i);s||n.push(i)}return n}else return this},absoluteComplement:function(){var t=this.cy();return t.mutableElements().not(this)},intersect:function(t){if(rt(t)){var n=t;return this.filter(n)}for(var r=this.spawn(),i=this,s=t,a=this.length<t.length,o=a?i:s,l=a?s:i,u=0;u<o.length;u++){var c=o[u];l.has(c)&&r.push(c)}return r},xor:function(t){var n=this._private.cy;rt(t)&&(t=n.$(t));var r=this.spawn(),i=this,s=t,a=function(l,u){for(var c=0;c<l.length;c++){var f=l[c],h=f._private.data.id,d=u.hasElementWithId(h);d||r.push(f)}};return a(i,s),a(s,i),r},diff:function(t){var n=this._private.cy;rt(t)&&(t=n.$(t));var r=this.spawn(),i=this.spawn(),s=this.spawn(),a=this,o=t,l=function(c,f,h){for(var d=0;d<c.length;d++){var p=c[d],g=p._private.data.id,m=f.hasElementWithId(g);m?s.merge(p):h.push(p)}};return l(a,o,r),l(o,a,i),{left:r,right:i,both:s}},add:function(t){var n=this._private.cy;if(!t)return this;if(rt(t)){var r=t;t=n.mutableElements().filter(r)}for(var i=this.spawnSelf(),s=0;s<t.length;s++){var a=t[s],o=!this.has(a);o&&i.push(a)}return i},merge:function(t){var n=this._private,r=n.cy;if(!t)return this;if(t&&rt(t)){var i=t;t=r.mutableElements().filter(i)}for(var s=n.map,a=0;a<t.length;a++){var o=t[a],l=o._private.data.id,u=!s.has(l);if(u){var c=this.length++;this[c]=o,s.set(l,{ele:o,index:c})}}return this},unmergeAt:function(t){var n=this[t],r=n.id(),i=this._private,s=i.map;this[t]=void 0,s.delete(r);var a=t===this.length-1;if(this.length>1&&!a){var o=this.length-1,l=this[o],u=l._private.data.id;this[o]=void 0,this[t]=l,s.set(u,{ele:l,index:t})}return this.length--,this},unmergeOne:function(t){t=t[0];var n=this._private,r=t._private.data.id,i=n.map,s=i.get(r);if(!s)return this;var a=s.index;return this.unmergeAt(a),this},unmerge:function(t){var n=this._private.cy;if(!t)return this;if(t&&rt(t)){var r=t;t=n.mutableElements().filter(r)}for(var i=0;i<t.length;i++)this.unmergeOne(t[i]);return this},unmergeBy:function(t){for(var n=this.length-1;n>=0;n--){var r=this[n];t(r)&&this.unmergeAt(n)}return this},map:function(t,n){for(var r=[],i=this,s=0;s<i.length;s++){var a=i[s],o=n?t.apply(n,[a,s,i]):t(a,s,i);r.push(o)}return r},reduce:function(t,n){for(var r=n,i=this,s=0;s<i.length;s++)r=t(r,i[s],s,i);return r},max:function(t,n){for(var r=-1/0,i,s=this,a=0;a<s.length;a++){var o=s[a],l=n?t.apply(n,[o,a,s]):t(o,a,s);l>r&&(r=l,i=o)}return{value:r,ele:i}},min:function(t,n){for(var r=1/0,i,s=this,a=0;a<s.length;a++){var o=s[a],l=n?t.apply(n,[o,a,s]):t(o,a,s);l<r&&(r=l,i=o)}return{value:r,ele:i}}},vn=bEe;vn.u=vn["|"]=vn["+"]=vn.union=vn.or=vn.add;vn["\\"]=vn["!"]=vn["-"]=vn.difference=vn.relativeComplement=vn.subtract=vn.not;vn.n=vn["&"]=vn["."]=vn.and=vn.intersection=vn.intersect;vn["^"]=vn["(+)"]=vn["(-)"]=vn.symmetricDifference=vn.symdiff=vn.xor;vn.fnFilter=vn.filterFn=vn.stdFilter=vn.filter;vn.complement=vn.abscomp=vn.absoluteComplement;var tot={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var t=this[0];if(t)return t._private.group}},xEe=function(t,n){var r=t.cy(),i=r.hasCompoundNodes();function s(c){var f=c.pstyle("z-compound-depth");return f.value==="auto"?i?c.zDepth():0:f.value==="bottom"?-1:f.value==="top"?Aee:0}var a=s(t)-s(n);if(a!==0)return a;function o(c){var f=c.pstyle("z-index-compare");return f.value==="auto"&&c.isNode()?1:0}var l=o(t)-o(n);if(l!==0)return l;var u=t.pstyle("z-index").value-n.pstyle("z-index").value;return u!==0?u:t.poolIndex()-n.poolIndex()},c5={forEach:function(t,n){if(zr(t))for(var r=this.length,i=0;i<r;i++){var s=this[i],a=n?t.apply(n,[s,i,this]):t(s,i,this);if(a===!1)break}return this},toArray:function(){for(var t=[],n=0;n<this.length;n++)t.push(this[n]);return t},slice:function(t,n){var r=[],i=this.length;n==null&&(n=i),t==null&&(t=0),t<0&&(t=i+t),n<0&&(n=i+n);for(var s=t;s>=0&&s<n&&s<i;s++)r.push(this[s]);return this.spawn(r)},size:function(){return this.length},eq:function(t){return this[t]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(t){if(!zr(t))return this;var n=this.toArray().sort(t);return this.spawn(n)},sortByZIndex:function(){return this.sort(xEe)},zDepth:function(){var t=this[0];if(!!t){var n=t._private,r=n.group;if(r==="nodes"){var i=n.data.parent?t.parents().size():0;return t.isParent()?i:Aee-1}else{var s=n.source,a=n.target,o=s.zDepth(),l=a.zDepth();return Math.max(o,l,0)}}}};c5.each=c5.forEach;var not=function(){var t="undefined",n=(typeof Symbol>"u"?"undefined":Mi(Symbol))!=t&&Mi(Symbol.iterator)!=t;n&&(c5[Symbol.iterator]=function(){var r=this,i={value:void 0,done:!1},s=0,a=this.length;return kke({next:function(){return s<a?i.value=r[s++]:(i.value=void 0,i.done=!0),i}},Symbol.iterator,function(){return this})})};not();var rot=Gs({nodeDimensionsIncludeLabels:!1}),YR={layoutDimensions:function(t){t=rot(t);var n;if(!this.takesUpSpace())n={w:0,h:0};else if(t.nodeDimensionsIncludeLabels){var r=this.boundingBox();n={w:r.w,h:r.h}}else n={w:this.outerWidth(),h:this.outerHeight()};return(n.w===0||n.h===0)&&(n.w=n.h=1),n},layoutPositions:function(t,n,r){var i=this.nodes().filter(function(w){return!w.isParent()}),s=this.cy(),a=n.eles,o=function(C){return C.id()},l=KA(r,o);t.emit({type:"layoutstart",layout:t}),t.animations=[];var u=function(C,$,_){var k={x:$.x1+$.w/2,y:$.y1+$.h/2},E={x:(_.x-k.x)*C,y:(_.y-k.y)*C};return{x:k.x+E.x,y:k.y+E.y}},c=n.spacingFactor&&n.spacingFactor!==1,f=function(){if(!c)return null;for(var C=il(),$=0;$<i.length;$++){var _=i[$],k=l(_,$);hst(C,k.x,k.y)}return C},h=f(),d=KA(function(w,C){var $=l(w,C);if(c){var _=Math.abs(n.spacingFactor);$=u(_,h,$)}return n.transform!=null&&($=n.transform(w,$)),$},o);if(n.animate){for(var p=0;p<i.length;p++){var g=i[p],m=d(g,p),v=n.animateFilter==null||n.animateFilter(g,p);if(v){var y=g.animation({position:m,duration:n.animationDuration,easing:n.animationEasing});t.animations.push(y)}else g.position(m)}if(n.fit){var b=s.animation({fit:{boundingBox:a.boundingBoxAt(d),padding:n.padding},duration:n.animationDuration,easing:n.animationEasing});t.animations.push(b)}else if(n.zoom!==void 0&&n.pan!==void 0){var x=s.animation({zoom:n.zoom,pan:n.pan,duration:n.animationDuration,easing:n.animationEasing});t.animations.push(x)}t.animations.forEach(function(w){return w.play()}),t.one("layoutready",n.ready),t.emit({type:"layoutready",layout:t}),xC.all(t.animations.map(function(w){return w.promise()})).then(function(){t.one("layoutstop",n.stop),t.emit({type:"layoutstop",layout:t})})}else i.positions(d),n.fit&&s.fit(n.eles,n.padding),n.zoom!=null&&s.zoom(n.zoom),n.pan&&s.pan(n.pan),t.one("layoutready",n.ready),t.emit({type:"layoutready",layout:t}),t.one("layoutstop",n.stop),t.emit({type:"layoutstop",layout:t});return this},layout:function(t){var n=this.cy();return n.makeLayout(pt({},t,{eles:this}))}};YR.createLayout=YR.makeLayout=YR.layout;function wEe(e,t,n){var r=n._private,i=r.styleCache=r.styleCache||[],s;return(s=i[e])!=null||(s=i[e]=t(n)),s}function m8(e,t){return e=Sy(e),function(r){return wEe(e,t,r)}}function v8(e,t){e=Sy(e);var n=function(i){return t.call(i)};return function(){var i=this[0];if(i)return wEe(e,n,i)}}var Bs={recalculateRenderedStyle:function(t){var n=this.cy(),r=n.renderer(),i=n.styleEnabled();return r&&i&&r.recalculateRenderedStyle(this,t),this},dirtyStyleCache:function(){var t=this.cy(),n=function(s){return s._private.styleCache=null};if(t.hasCompoundNodes()){var r;r=this.spawnSelf().merge(this.descendants()).merge(this.parents()),r.merge(r.connectedEdges()),r.forEach(n)}else this.forEach(function(i){n(i),i.connectedEdges().forEach(n)});return this},updateStyle:function(t){var n=this._private.cy;if(!n.styleEnabled())return this;if(n.batching()){var r=n._private.batchStyleEles;return r.merge(this),this}var i=n.hasCompoundNodes(),s=this;t=!!(t||t===void 0),i&&(s=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var a=s;return t?a.emitAndNotify("style"):a.emit("style"),s.forEach(function(o){return o._private.styleDirty=!0}),this},cleanStyle:function(){var t=this.cy();if(!!t.styleEnabled())for(var n=0;n<this.length;n++){var r=this[n];r._private.styleDirty&&(r._private.styleDirty=!1,t.style().apply(r))}},parsedStyle:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this[0],i=r.cy();if(!!i.styleEnabled()&&r){this.cleanStyle();var s=r._private.style[t];return s!=null?s:n?i.style().getDefaultProperty(t):null}},numericStyle:function(t){var n=this[0];if(!!n.cy().styleEnabled()&&n){var r=n.pstyle(t);return r.pfValue!==void 0?r.pfValue:r.value}},numericStyleUnits:function(t){var n=this[0];if(!!n.cy().styleEnabled()&&n)return n.pstyle(t).units},renderedStyle:function(t){var n=this.cy();if(!n.styleEnabled())return this;var r=this[0];if(r)return n.style().getRenderedStyle(r,t)},style:function(t,n){var r=this.cy();if(!r.styleEnabled())return this;var i=!1,s=r.style();if(dn(t)){var a=t;s.applyBypass(this,a,i),this.emitAndNotify("style")}else if(rt(t))if(n===void 0){var o=this[0];return o?s.getStylePropertyValue(o,t):void 0}else s.applyBypass(this,t,n,i),this.emitAndNotify("style");else if(t===void 0){var l=this[0];return l?s.getRawStyle(l):void 0}return this},removeStyle:function(t){var n=this.cy();if(!n.styleEnabled())return this;var r=!1,i=n.style(),s=this;if(t===void 0)for(var a=0;a<s.length;a++){var o=s[a];i.removeAllBypasses(o,r)}else{t=t.split(/\s+/);for(var l=0;l<s.length;l++){var u=s[l];i.removeBypasses(u,t,r)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var t=this.cy();if(!t.styleEnabled())return 1;var n=t.hasCompoundNodes(),r=this[0];if(r){var i=r._private,s=r.pstyle("opacity").value;if(!n)return s;var a=i.data.parent?r.parents():null;if(a)for(var o=0;o<a.length;o++){var l=a[o],u=l.pstyle("opacity").value;s=u*s}return s}},transparent:function(){var t=this.cy();if(!t.styleEnabled())return!1;var n=this[0],r=n.cy().hasCompoundNodes();if(n)return r?n.effectiveOpacity()===0:n.pstyle("opacity").value===0},backgrounding:function(){var t=this.cy();if(!t.styleEnabled())return!1;var n=this[0];return!!n._private.backgrounding}};function JV(e,t){var n=e._private,r=n.data.parent?e.parents():null;if(r)for(var i=0;i<r.length;i++){var s=r[i];if(!t(s))return!1}return!0}function Pee(e){var t=e.ok,n=e.edgeOkViaNode||e.ok,r=e.parentOk||e.ok;return function(){var i=this.cy();if(!i.styleEnabled())return!0;var s=this[0],a=i.hasCompoundNodes();if(s){var o=s._private;if(!t(s))return!1;if(s.isNode())return!a||JV(s,r);var l=o.source,u=o.target;return n(l)&&(!a||JV(l,n))&&(l===u||n(u)&&(!a||JV(u,n)))}}}var wC=m8("eleTakesUpSpace",function(e){return e.pstyle("display").value==="element"&&e.width()!==0&&(e.isNode()?e.height()!==0:!0)});Bs.takesUpSpace=v8("takesUpSpace",Pee({ok:wC}));var iot=m8("eleInteractive",function(e){return e.pstyle("events").value==="yes"&&e.pstyle("visibility").value==="visible"&&wC(e)}),sot=m8("parentInteractive",function(e){return e.pstyle("visibility").value==="visible"&&wC(e)});Bs.interactive=v8("interactive",Pee({ok:iot,parentOk:sot,edgeOkViaNode:wC}));Bs.noninteractive=function(){var e=this[0];if(e)return!e.interactive()};var aot=m8("eleVisible",function(e){return e.pstyle("visibility").value==="visible"&&e.pstyle("opacity").pfValue!==0&&wC(e)}),oot=wC;Bs.visible=v8("visible",Pee({ok:aot,edgeOkViaNode:oot}));Bs.hidden=function(){var e=this[0];if(e)return!e.visible()};Bs.isBundledBezier=v8("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});Bs.bypass=Bs.css=Bs.style;Bs.renderedCss=Bs.renderedStyle;Bs.removeBypass=Bs.removeCss=Bs.removeStyle;Bs.pstyle=Bs.parsedStyle;var f0={};function kpe(e){return function(){var t=arguments,n=[];if(t.length===2){var r=t[0],i=t[1];this.on(e.event,r,i)}else if(t.length===1&&zr(t[0])){var s=t[0];this.on(e.event,s)}else if(t.length===0||t.length===1&&Qn(t[0])){for(var a=t.length===1?t[0]:null,o=0;o<this.length;o++){var l=this[o],u=!e.ableField||l._private[e.ableField],c=l._private[e.field]!=e.value;if(e.overrideAble){var f=e.overrideAble(l);if(f!==void 0&&(u=f,!f))return this}u&&(l._private[e.field]=e.value,c&&n.push(l))}var h=this.spawn(n);h.updateStyle(),h.emit(e.event),a&&h.emit(a)}return this}}function $C(e){f0[e.field]=function(){var t=this[0];if(t){if(e.overrideField){var n=e.overrideField(t);if(n!==void 0)return n}return t._private[e.field]}},f0[e.on]=kpe({event:e.on,field:e.field,ableField:e.ableField,overrideAble:e.overrideAble,value:!0}),f0[e.off]=kpe({event:e.off,field:e.field,ableField:e.ableField,overrideAble:e.overrideAble,value:!1})}$C({field:"locked",overrideField:function(t){return t.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});$C({field:"grabbable",overrideField:function(t){return t.cy().autoungrabify()||t.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});$C({field:"selected",ableField:"selectable",overrideAble:function(t){return t.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});$C({field:"selectable",overrideField:function(t){return t.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});f0.deselect=f0.unselect;f0.grabbed=function(){var e=this[0];if(e)return e._private.grabbed};$C({field:"active",on:"activate",off:"unactivate"});$C({field:"pannable",on:"panify",off:"unpanify"});f0.inactive=function(){var e=this[0];if(e)return!e._private.active};var Ta={},Epe=function(t){return function(r){for(var i=this,s=[],a=0;a<i.length;a++){var o=i[a];if(!!o.isNode()){for(var l=!1,u=o.connectedEdges(),c=0;c<u.length;c++){var f=u[c],h=f.source(),d=f.target();if(t.noIncomingEdges&&d===o&&h!==o||t.noOutgoingEdges&&h===o&&d!==o){l=!0;break}}l||s.push(o)}}return this.spawn(s,!0).filter(r)}},Ape=function(t){return function(n){for(var r=this,i=[],s=0;s<r.length;s++){var a=r[s];if(!!a.isNode())for(var o=a.connectedEdges(),l=0;l<o.length;l++){var u=o[l],c=u.source(),f=u.target();t.outgoing&&c===a?(i.push(u),i.push(f)):t.incoming&&f===a&&(i.push(u),i.push(c))}}return this.spawn(i,!0).filter(n)}},Tpe=function(t){return function(n){for(var r=this,i=[],s={};;){var a=t.outgoing?r.outgoers():r.incomers();if(a.length===0)break;for(var o=!1,l=0;l<a.length;l++){var u=a[l],c=u.id();s[c]||(s[c]=!0,i.push(u),o=!0)}if(!o)break;r=a}return this.spawn(i,!0).filter(n)}};Ta.clearTraversalCache=function(){for(var e=0;e<this.length;e++)this[e]._private.traversalCache=null};pt(Ta,{roots:Epe({noIncomingEdges:!0}),leaves:Epe({noOutgoingEdges:!0}),outgoers:cu(Ape({outgoing:!0}),"outgoers"),successors:Tpe({outgoing:!0}),incomers:cu(Ape({incoming:!0}),"incomers"),predecessors:Tpe({incoming:!0})});pt(Ta,{neighborhood:cu(function(e){for(var t=[],n=this.nodes(),r=0;r<n.length;r++)for(var i=n[r],s=i.connectedEdges(),a=0;a<s.length;a++){var o=s[a],l=o.source(),u=o.target(),c=i===l?u:l;c.length>0&&t.push(c[0]),t.push(o[0])}return this.spawn(t,!0).filter(e)},"neighborhood"),closedNeighborhood:function(t){return this.neighborhood().add(this).filter(t)},openNeighborhood:function(t){return this.neighborhood(t)}});Ta.neighbourhood=Ta.neighborhood;Ta.closedNeighbourhood=Ta.closedNeighborhood;Ta.openNeighbourhood=Ta.openNeighborhood;pt(Ta,{source:cu(function(t){var n=this[0],r;return n&&(r=n._private.source||n.cy().collection()),r&&t?r.filter(t):r},"source"),target:cu(function(t){var n=this[0],r;return n&&(r=n._private.target||n.cy().collection()),r&&t?r.filter(t):r},"target"),sources:Dpe({attr:"source"}),targets:Dpe({attr:"target"})});function Dpe(e){return function(n){for(var r=[],i=0;i<this.length;i++){var s=this[i],a=s._private[e.attr];a&&r.push(a)}return this.spawn(r,!0).filter(n)}}pt(Ta,{edgesWith:cu(Ipe(),"edgesWith"),edgesTo:cu(Ipe({thisIsSrc:!0}),"edgesTo")});function Ipe(e){return function(n){var r=[],i=this._private.cy,s=e||{};rt(n)&&(n=i.$(n));for(var a=0;a<n.length;a++)for(var o=n[a]._private.edges,l=0;l<o.length;l++){var u=o[l],c=u._private.data,f=this.hasElementWithId(c.source)&&n.hasElementWithId(c.target),h=n.hasElementWithId(c.source)&&this.hasElementWithId(c.target),d=f||h;!d||(s.thisIsSrc||s.thisIsTgt)&&(s.thisIsSrc&&!f||s.thisIsTgt&&!h)||r.push(u)}return this.spawn(r,!0)}}pt(Ta,{connectedEdges:cu(function(e){for(var t=[],n=this,r=0;r<n.length;r++){var i=n[r];if(!!i.isNode())for(var s=i._private.edges,a=0;a<s.length;a++){var o=s[a];t.push(o)}}return this.spawn(t,!0).filter(e)},"connectedEdges"),connectedNodes:cu(function(e){for(var t=[],n=this,r=0;r<n.length;r++){var i=n[r];!i.isEdge()||(t.push(i.source()[0]),t.push(i.target()[0]))}return this.spawn(t,!0).filter(e)},"connectedNodes"),parallelEdges:cu(Npe(),"parallelEdges"),codirectedEdges:cu(Npe({codirected:!0}),"codirectedEdges")});function Npe(e){var t={codirected:!1};return e=pt({},t,e),function(r){for(var i=[],s=this.edges(),a=e,o=0;o<s.length;o++)for(var l=s[o],u=l._private,c=u.source,f=c._private.data.id,h=u.data.target,d=c._private.edges,p=0;p<d.length;p++){var g=d[p],m=g._private.data,v=m.target,y=m.source,b=v===h&&y===f,x=f===v&&h===y;(a.codirected&&b||!a.codirected&&(b||x))&&i.push(g)}return this.spawn(i,!0).filter(r)}}pt(Ta,{components:function(t){var n=this,r=n.cy(),i=r.collection(),s=t==null?n.nodes():t.nodes(),a=[];t!=null&&s.empty()&&(s=t.sources());var o=function(c,f){i.merge(c),s.unmerge(c),f.merge(c)};if(s.empty())return n.spawn();var l=function(){var c=r.collection();a.push(c);var f=s[0];o(f,c),n.bfs({directed:!1,roots:f,visit:function(d){return o(d,c)}}),c.forEach(function(h){h.connectedEdges().forEach(function(d){n.has(d)&&c.has(d.source())&&c.has(d.target())&&c.merge(d)})})};do l();while(s.length>0);return a},component:function(){var t=this[0];return t.cy().mutableElements().components(t)[0]}});Ta.componentsOf=Ta.components;var zs=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(t===void 0){Xr("A collection must have a reference to the core");return}var s=new Xf,a=!1;if(!n)n=[];else if(n.length>0&&dn(n[0])&&!oI(n[0])){a=!0;for(var o=[],l=new bC,u=0,c=n.length;u<c;u++){var f=n[u];f.data==null&&(f.data={});var h=f.data;if(h.id==null)h.id=zke();else if(t.hasElementWithId(h.id)||l.has(h.id))continue;var d=new f8(t,f,!1);o.push(d),l.add(h.id)}n=o}this.length=0;for(var p=0,g=n.length;p<g;p++){var m=n[p][0];if(m!=null){var v=m._private.data.id;(!r||!s.has(v))&&(r&&s.set(v,{index:this.length,ele:m}),this[this.length]=m,this.length++)}}this._private={eles:this,cy:t,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(y){this.lazyMap=y},rebuildMap:function(){for(var b=this.lazyMap=new Xf,x=this.eles,w=0;w<x.length;w++){var C=x[w];b.set(C.id(),{index:w,ele:C})}}},r&&(this._private.map=s),a&&!i&&this.restore()},fr=f8.prototype=zs.prototype=Object.create(Array.prototype);fr.instanceString=function(){return"collection"};fr.spawn=function(e,t){return new zs(this.cy(),e,t)};fr.spawnSelf=function(){return this.spawn(this)};fr.cy=function(){return this._private.cy};fr.renderer=function(){return this._private.cy.renderer()};fr.element=function(){return this[0]};fr.collection=function(){return Ake(this)?this:new zs(this._private.cy,[this])};fr.unique=function(){return new zs(this._private.cy,this,!0)};fr.hasElementWithId=function(e){return e=""+e,this._private.map.has(e)};fr.getElementById=function(e){e=""+e;var t=this._private.cy,n=this._private.map.get(e);return n?n.ele:new zs(t)};fr.$id=fr.getElementById;fr.poolIndex=function(){var e=this._private.cy,t=e._private.elements,n=this[0]._private.data.id;return t._private.map.get(n).index};fr.indexOf=function(e){var t=e[0]._private.data.id;return this._private.map.get(t).index};fr.indexOfId=function(e){return e=""+e,this._private.map.get(e).index};fr.json=function(e){var t=this.element(),n=this.cy();if(t==null&&e)return this;if(t!=null){var r=t._private;if(dn(e)){if(n.startBatch(),e.data){t.data(e.data);var i=r.data;if(t.isEdge()){var s=!1,a={},o=e.data.source,l=e.data.target;o!=null&&o!=i.source&&(a.source=""+o,s=!0),l!=null&&l!=i.target&&(a.target=""+l,s=!0),s&&(t=t.move(a))}else{var u="parent"in e.data,c=e.data.parent;u&&(c!=null||i.parent!=null)&&c!=i.parent&&(c===void 0&&(c=null),c!=null&&(c=""+c),t=t.move({parent:c}))}}e.position&&t.position(e.position);var f=function(g,m,v){var y=e[g];y!=null&&y!==r[g]&&(y?t[m]():t[v]())};return f("removed","remove","restore"),f("selected","select","unselect"),f("selectable","selectify","unselectify"),f("locked","lock","unlock"),f("grabbable","grabify","ungrabify"),f("pannable","panify","unpanify"),e.classes!=null&&t.classes(e.classes),n.endBatch(),this}else if(e===void 0){var h={data:Yf(r.data),position:Yf(r.position),group:r.group,removed:r.removed,selected:r.selected,selectable:r.selectable,locked:r.locked,grabbable:r.grabbable,pannable:r.pannable,classes:null};h.classes="";var d=0;return r.classes.forEach(function(p){return h.classes+=d++===0?p:" "+p}),h}}};fr.jsons=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t],r=n.json();e.push(r)}return e};fr.clone=function(){for(var e=this.cy(),t=[],n=0;n<this.length;n++){var r=this[n],i=r.json(),s=new f8(e,i,!1);t.push(s)}return new zs(e,t)};fr.copy=fr.clone;fr.restore=function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this,r=n.cy(),i=r._private,s=[],a=[],o,l=0,u=n.length;l<u;l++){var c=n[l];t&&!c.removed()||(c.isNode()?s.push(c):a.push(c))}o=s.concat(a);var f,h=function(){o.splice(f,1),f--};for(f=0;f<o.length;f++){var d=o[f],p=d._private,g=p.data;if(d.clearTraversalCache(),!(!t&&!p.removed)){if(g.id===void 0)g.id=zke();else if(Pe(g.id))g.id=""+g.id;else if(I0(g.id)||!rt(g.id)){Xr("Can not create element with invalid string ID `"+g.id+"`"),h();continue}else if(r.hasElementWithId(g.id)){Xr("Can not create second element with ID `"+g.id+"`"),h();continue}}var m=g.id;if(d.isNode()){var v=p.position;v.x==null&&(v.x=0),v.y==null&&(v.y=0)}if(d.isEdge()){for(var y=d,b=["source","target"],x=b.length,w=!1,C=0;C<x;C++){var $=b[C],_=g[$];Pe(_)&&(_=g[$]=""+g[$]),_==null||_===""?(Xr("Can not create edge `"+m+"` with unspecified "+$),w=!0):r.hasElementWithId(_)||(Xr("Can not create edge `"+m+"` with nonexistant "+$+" `"+_+"`"),w=!0)}if(w){h();continue}var k=r.getElementById(g.source),E=r.getElementById(g.target);k.same(E)?k._private.edges.push(y):(k._private.edges.push(y),E._private.edges.push(y)),y._private.source=k,y._private.target=E}p.map=new Xf,p.map.set(m,{ele:d,index:0}),p.removed=!1,t&&r.addToPool(d)}for(var S=0;S<s.length;S++){var I=s[S],A=I._private.data;Pe(A.parent)&&(A.parent=""+A.parent);var D=A.parent,T=D!=null;if(T||I._private.parent){var N=I._private.parent?r.collection().merge(I._private.parent):r.getElementById(D);if(N.empty())A.parent=void 0;else if(N[0].removed())Rn("Node added with missing parent, reference to parent removed"),A.parent=void 0,I._private.parent=null;else{for(var F=!1,R=N;!R.empty();){if(I.same(R)){F=!0,A.parent=void 0;break}R=R.parent()}F||(N[0]._private.children.push(I),I._private.parent=N[0],i.hasCompoundNodes=!0)}}}if(o.length>0){for(var P=o.length===n.length?n:new zs(r,o),V=0;V<P.length;V++){var z=P[V];z.isNode()||(z.parallelEdges().clearTraversalCache(),z.source().clearTraversalCache(),z.target().clearTraversalCache())}var q;i.hasCompoundNodes?q=r.collection().merge(P).merge(P.connectedNodes()).merge(P.parent()):q=P,q.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(e),e?P.emitAndNotify("add"):t&&P.emit("add")}return n};fr.removed=function(){var e=this[0];return e&&e._private.removed};fr.inside=function(){var e=this[0];return e&&!e._private.removed};fr.remove=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this,r=[],i={},s=n._private.cy;function a(D){for(var T=D._private.edges,N=0;N<T.length;N++)l(T[N])}function o(D){for(var T=D._private.children,N=0;N<T.length;N++)l(T[N])}function l(D){var T=i[D.id()];t&&D.removed()||T||(i[D.id()]=!0,D.isNode()?(r.push(D),a(D),o(D)):r.unshift(D))}for(var u=0,c=n.length;u<c;u++){var f=n[u];l(f)}function h(D,T){var N=D._private.edges;N0(N,T),D.clearTraversalCache()}function d(D){D.clearTraversalCache()}var p=[];p.ids={};function g(D,T){T=T[0],D=D[0];var N=D._private.children,F=D.id();N0(N,T),T._private.parent=null,p.ids[F]||(p.ids[F]=!0,p.push(D))}n.dirtyCompoundBoundsCache(),t&&s.removeFromPool(r);for(var m=0;m<r.length;m++){var v=r[m];if(v.isEdge()){var y=v.source()[0],b=v.target()[0];h(y,v),h(b,v);for(var x=v.parallelEdges(),w=0;w<x.length;w++){var C=x[w];d(C),C.isBundledBezier()&&C.dirtyBoundingBoxCache()}}else{var $=v.parent();$.length!==0&&g($,v)}t&&(v._private.removed=!0)}var _=s._private.elements;s._private.hasCompoundNodes=!1;for(var k=0;k<_.length;k++){var E=_[k];if(E.isParent()){s._private.hasCompoundNodes=!0;break}}var S=new zs(this.cy(),r);S.size()>0&&(e?S.emitAndNotify("remove"):t&&S.emit("remove"));for(var I=0;I<p.length;I++){var A=p[I];(!t||!A.removed())&&A.updateStyle()}return S};fr.move=function(e){var t=this._private.cy,n=this,r=!1,i=!1,s=function(p){return p==null?p:""+p};if(e.source!==void 0||e.target!==void 0){var a=s(e.source),o=s(e.target),l=a!=null&&t.hasElementWithId(a),u=o!=null&&t.hasElementWithId(o);(l||u)&&(t.batch(function(){n.remove(r,i),n.emitAndNotify("moveout");for(var d=0;d<n.length;d++){var p=n[d],g=p._private.data;p.isEdge()&&(l&&(g.source=a),u&&(g.target=o))}n.restore(r,i)}),n.emitAndNotify("move"))}else if(e.parent!==void 0){var c=s(e.parent),f=c===null||t.hasElementWithId(c);if(f){var h=c===null?void 0:c;t.batch(function(){var d=n.remove(r,i);d.emitAndNotify("moveout");for(var p=0;p<n.length;p++){var g=n[p],m=g._private.data;g.isNode()&&(m.parent=h)}d.restore(r,i)}),n.emitAndNotify("move")}}return this};[eEe,bat,GR,c0,Aw,Oat,p8,Kat,yEe,bEe,tot,c5,YR,Bs,f0,Ta].forEach(function(e){pt(fr,e)});var lot={add:function(t){var n,r=this;if(Rl(t)){var i=t;if(i._private.cy===r)n=i.restore();else{for(var s=[],a=0;a<i.length;a++){var o=i[a];s.push(o.json())}n=new zs(r,s)}}else if(Qn(t)){var l=t;n=new zs(r,l)}else if(dn(t)&&(Qn(t.nodes)||Qn(t.edges))){for(var u=t,c=[],f=["nodes","edges"],h=0,d=f.length;h<d;h++){var p=f[h],g=u[p];if(Qn(g))for(var m=0,v=g.length;m<v;m++){var y=pt({group:p},g[m]);c.push(y)}}n=new zs(r,c)}else{var b=t;n=new f8(r,b).collection()}return n},remove:function(t){if(!Rl(t)){if(rt(t)){var n=t;t=this.$(n)}}return t.remove()}};/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */function uot(e,t,n,r){var i=4,s=.001,a=1e-7,o=10,l=11,u=1/(l-1),c=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var f=0;f<4;++f)if(typeof arguments[f]!="number"||isNaN(arguments[f])||!isFinite(arguments[f]))return!1;e=Math.min(e,1),n=Math.min(n,1),e=Math.max(e,0),n=Math.max(n,0);var h=c?new Float32Array(l):new Array(l);function d(E,S){return 1-3*S+3*E}function p(E,S){return 3*S-6*E}function g(E){return 3*E}function m(E,S,I){return((d(S,I)*E+p(S,I))*E+g(S))*E}function v(E,S,I){return 3*d(S,I)*E*E+2*p(S,I)*E+g(S)}function y(E,S){for(var I=0;I<i;++I){var A=v(S,e,n);if(A===0)return S;var D=m(S,e,n)-E;S-=D/A}return S}function b(){for(var E=0;E<l;++E)h[E]=m(E*u,e,n)}function x(E,S,I){var A,D,T=0;do D=S+(I-S)/2,A=m(D,e,n)-E,A>0?I=D:S=D;while(Math.abs(A)>a&&++T<o);return D}function w(E){for(var S=0,I=1,A=l-1;I!==A&&h[I]<=E;++I)S+=u;--I;var D=(E-h[I])/(h[I+1]-h[I]),T=S+D*u,N=v(T,e,n);return N>=s?y(E,T):N===0?T:x(E,S,S+u)}var C=!1;function $(){C=!0,(e!==t||n!==r)&&b()}var _=function(S){return C||$(),e===t&&n===r?S:S===0?0:S===1?1:m(w(S),t,r)};_.getControlPoints=function(){return[{x:e,y:t},{x:n,y:r}]};var k="generateBezier("+[e,t,n,r]+")";return _.toString=function(){return k},_}/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */var cot=function(){function e(r){return-r.tension*r.x-r.friction*r.v}function t(r,i,s){var a={x:r.x+s.dx*i,v:r.v+s.dv*i,tension:r.tension,friction:r.friction};return{dx:a.v,dv:e(a)}}function n(r,i){var s={dx:r.v,dv:e(r)},a=t(r,i*.5,s),o=t(r,i*.5,a),l=t(r,i,o),u=1/6*(s.dx+2*(a.dx+o.dx)+l.dx),c=1/6*(s.dv+2*(a.dv+o.dv)+l.dv);return r.x=r.x+u*i,r.v=r.v+c*i,r}return function r(i,s,a){var o={x:-1,v:0,tension:null,friction:null},l=[0],u=0,c=1/1e4,f=16/1e3,h,d,p;for(i=parseFloat(i)||500,s=parseFloat(s)||20,a=a||null,o.tension=i,o.friction=s,h=a!==null,h?(u=r(i,s),d=u/a*f):d=f;p=n(p||o,d),l.push(1+p.x),u+=16,Math.abs(p.x)>c&&Math.abs(p.v)>c;);return h?function(g){return l[g*(l.length-1)|0]}:u}}(),ir=function(t,n,r,i){var s=uot(t,n,r,i);return function(a,o,l){return a+(o-a)*s(l)}},XR={linear:function(t,n,r){return t+(n-t)*r},ease:ir(.25,.1,.25,1),"ease-in":ir(.42,0,1,1),"ease-out":ir(0,0,.58,1),"ease-in-out":ir(.42,0,.58,1),"ease-in-sine":ir(.47,0,.745,.715),"ease-out-sine":ir(.39,.575,.565,1),"ease-in-out-sine":ir(.445,.05,.55,.95),"ease-in-quad":ir(.55,.085,.68,.53),"ease-out-quad":ir(.25,.46,.45,.94),"ease-in-out-quad":ir(.455,.03,.515,.955),"ease-in-cubic":ir(.55,.055,.675,.19),"ease-out-cubic":ir(.215,.61,.355,1),"ease-in-out-cubic":ir(.645,.045,.355,1),"ease-in-quart":ir(.895,.03,.685,.22),"ease-out-quart":ir(.165,.84,.44,1),"ease-in-out-quart":ir(.77,0,.175,1),"ease-in-quint":ir(.755,.05,.855,.06),"ease-out-quint":ir(.23,1,.32,1),"ease-in-out-quint":ir(.86,0,.07,1),"ease-in-expo":ir(.95,.05,.795,.035),"ease-out-expo":ir(.19,1,.22,1),"ease-in-out-expo":ir(1,0,0,1),"ease-in-circ":ir(.6,.04,.98,.335),"ease-out-circ":ir(.075,.82,.165,1),"ease-in-out-circ":ir(.785,.135,.15,.86),spring:function(t,n,r){if(r===0)return XR.linear;var i=cot(t,n,r);return function(s,a,o){return s+(a-s)*i(o)}},"cubic-bezier":ir};function Mpe(e,t,n,r,i){if(r===1||t===n)return n;var s=i(t,n,r);return e==null||((e.roundValue||e.color)&&(s=Math.round(s)),e.min!==void 0&&(s=Math.max(s,e.min)),e.max!==void 0&&(s=Math.min(s,e.max))),s}function Fpe(e,t){return e.pfValue!=null||e.value!=null?e.pfValue!=null&&(t==null||t.type.units!=="%")?e.pfValue:e.value:e}function Zx(e,t,n,r,i){var s=i!=null?i.type:null;n<0?n=0:n>1&&(n=1);var a=Fpe(e,i),o=Fpe(t,i);if(Pe(a)&&Pe(o))return Mpe(s,a,o,n,r);if(Qn(a)&&Qn(o)){for(var l=[],u=0;u<o.length;u++){var c=a[u],f=o[u];if(c!=null&&f!=null){var h=Mpe(s,c,f,n,r);l.push(h)}else l.push(f)}return l}}function fot(e,t,n,r){var i=!r,s=e._private,a=t._private,o=a.easing,l=a.startTime,u=r?e:e.cy(),c=u.style();if(!a.easingImpl)if(o==null)a.easingImpl=XR.linear;else{var f;if(rt(o)){var h=c.parse("transition-timing-function",o);f=h.value}else f=o;var d,p;rt(f)?(d=f,p=[]):(d=f[1],p=f.slice(2).map(function(P){return+P})),p.length>0?(d==="spring"&&p.push(a.duration),a.easingImpl=XR[d].apply(null,p)):a.easingImpl=XR[d]}var g=a.easingImpl,m;if(a.duration===0?m=1:m=(n-l)/a.duration,a.applying&&(m=a.progress),m<0?m=0:m>1&&(m=1),a.delay==null){var v=a.startPosition,y=a.position;if(y&&i&&!e.locked()){var b={};qS(v.x,y.x)&&(b.x=Zx(v.x,y.x,m,g)),qS(v.y,y.y)&&(b.y=Zx(v.y,y.y,m,g)),e.position(b)}var x=a.startPan,w=a.pan,C=s.pan,$=w!=null&&r;$&&(qS(x.x,w.x)&&(C.x=Zx(x.x,w.x,m,g)),qS(x.y,w.y)&&(C.y=Zx(x.y,w.y,m,g)),e.emit("pan"));var _=a.startZoom,k=a.zoom,E=k!=null&&r;E&&(qS(_,k)&&(s.zoom=eT(s.minZoom,Zx(_,k,m,g),s.maxZoom)),e.emit("zoom")),($||E)&&e.emit("viewport");var S=a.style;if(S&&S.length>0&&i){for(var I=0;I<S.length;I++){var A=S[I],D=A.name,T=A,N=a.startStyle[D],F=c.properties[N.name],R=Zx(N,T,m,g,F);c.overrideBypass(e,D,R)}e.emit("style")}}return a.progress=m,m}function qS(e,t){return e==null||t==null?!1:Pe(e)&&Pe(t)?!0:!!(e&&t)}function hot(e,t,n,r){var i=t._private;i.started=!0,i.startTime=n-i.progress*i.duration}function Ope(e,t){var n=t._private.aniEles,r=[];function i(c,f){var h=c._private,d=h.animation.current,p=h.animation.queue,g=!1;if(d.length===0){var m=p.shift();m&&d.push(m)}for(var v=function(C){for(var $=C.length-1;$>=0;$--){var _=C[$];_()}C.splice(0,C.length)},y=d.length-1;y>=0;y--){var b=d[y],x=b._private;if(x.stopped){d.splice(y,1),x.hooked=!1,x.playing=!1,x.started=!1,v(x.frames);continue}!x.playing&&!x.applying||(x.playing&&x.applying&&(x.applying=!1),x.started||hot(c,b,e),fot(c,b,e,f),x.applying&&(x.applying=!1),v(x.frames),x.step!=null&&x.step(e),b.completed()&&(d.splice(y,1),x.hooked=!1,x.playing=!1,x.started=!1,v(x.completes)),g=!0)}return!f&&d.length===0&&p.length===0&&r.push(c),g}for(var s=!1,a=0;a<n.length;a++){var o=n[a],l=i(o);s=s||l}var u=i(t,!0);(s||u)&&(n.length>0?t.notify("draw",n):t.notify("draw")),n.unmerge(r),t.emit("step")}var dot={animate:Fn.animate(),animation:Fn.animation(),animated:Fn.animated(),clearQueue:Fn.clearQueue(),delay:Fn.delay(),delayAnimation:Fn.delayAnimation(),stop:Fn.stop(),addToAnimationPool:function(t){var n=this;!n.styleEnabled()||n._private.aniEles.merge(t)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var t=this;if(t._private.animationsRunning=!0,!t.styleEnabled())return;function n(){!t._private.animationsRunning||o5(function(s){Ope(s,t),n()})}var r=t.renderer();r&&r.beforeRender?r.beforeRender(function(s,a){Ope(a,t)},r.beforeRenderPriorities.animations):n()}},pot={qualifierCompare:function(t,n){return t==null||n==null?t==null&&n==null:t.sameText(n)},eventMatches:function(t,n,r){var i=n.qualifier;return i!=null?t!==r.target&&oI(r.target)&&i.matches(r.target):!0},addEventFields:function(t,n){n.cy=t,n.target=t},callbackContext:function(t,n,r){return n.qualifier!=null?r.target:t}},KF=function(t){return rt(t)?new M0(t):t},$Ee={createEmitter:function(){var t=this._private;return t.emitter||(t.emitter=new g8(pot,this)),this},emitter:function(){return this._private.emitter},on:function(t,n,r){return this.emitter().on(t,KF(n),r),this},removeListener:function(t,n,r){return this.emitter().removeListener(t,KF(n),r),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(t,n,r){return this.emitter().one(t,KF(n),r),this},once:function(t,n,r){return this.emitter().one(t,KF(n),r),this},emit:function(t,n){return this.emitter().emit(t,n),this},emitAndNotify:function(t,n){return this.emit(t),this.notify(t,n),this}};Fn.eventAliasesOn($Ee);var hY={png:function(t){var n=this._private.renderer;return t=t||{},n.png(t)},jpg:function(t){var n=this._private.renderer;return t=t||{},t.bg=t.bg||"#fff",n.jpg(t)}};hY.jpeg=hY.jpg;var KR={layout:function(t){var n=this;if(t==null){Xr("Layout options must be specified to make a layout");return}if(t.name==null){Xr("A `name` must be specified to make a layout");return}var r=t.name,i=n.extension("layout",r);if(i==null){Xr("No such layout `"+r+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var s;rt(t.eles)?s=n.$(t.eles):s=t.eles!=null?t.eles:n.$();var a=new i(pt({},t,{cy:n,eles:s}));return a}};KR.createLayout=KR.makeLayout=KR.layout;var got={notify:function(t,n){var r=this._private;if(this.batching()){r.batchNotifications=r.batchNotifications||{};var i=r.batchNotifications[t]=r.batchNotifications[t]||this.collection();n!=null&&i.merge(n);return}if(!!r.notificationsEnabled){var s=this.renderer();this.destroyed()||!s||s.notify(t,n)}},notifications:function(t){var n=this._private;return t===void 0?n.notificationsEnabled:(n.notificationsEnabled=!!t,this)},noNotifications:function(t){this.notifications(!1),t(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var t=this._private;return t.batchCount==null&&(t.batchCount=0),t.batchCount===0&&(t.batchStyleEles=this.collection(),t.batchNotifications={}),t.batchCount++,this},endBatch:function(){var t=this._private;if(t.batchCount===0)return this;if(t.batchCount--,t.batchCount===0){t.batchStyleEles.updateStyle();var n=this.renderer();Object.keys(t.batchNotifications).forEach(function(r){var i=t.batchNotifications[r];i.empty()?n.notify(r):n.notify(r,i)})}return this},batch:function(t){return this.startBatch(),t(),this.endBatch(),this},batchData:function(t){var n=this;return this.batch(function(){for(var r=Object.keys(t),i=0;i<r.length;i++){var s=r[i],a=t[s],o=n.getElementById(s);o.data(a)}})}},mot=Gs({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1}),dY={renderTo:function(t,n,r,i){var s=this._private.renderer;return s.renderTo(t,n,r,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(t){var n=this,r=n.extension("renderer",t.name);if(r==null){Xr("Can not initialise: No such renderer `".concat(t.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}t.wheelSensitivity!==void 0&&Rn("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=mot(t);i.cy=n,n._private.renderer=new r(i),this.notify("init")},destroyRenderer:function(){var t=this;t.notify("destroy");var n=t.container();if(n)for(n._cyreg=null;n.childNodes.length>0;)n.removeChild(n.childNodes[0]);t._private.renderer=null,t.mutableElements().forEach(function(r){var i=r._private;i.rscratch={},i.rstyle={},i.animation.current=[],i.animation.queue=[]})},onRender:function(t){return this.on("render",t)},offRender:function(t){return this.off("render",t)}};dY.invalidateDimensions=dY.resize;var ZR={collection:function(t,n){return rt(t)?this.$(t):Rl(t)?t.collection():Qn(t)?(n||(n={}),new zs(this,t,n.unique,n.removed)):new zs(this)},nodes:function(t){var n=this.$(function(r){return r.isNode()});return t?n.filter(t):n},edges:function(t){var n=this.$(function(r){return r.isEdge()});return t?n.filter(t):n},$:function(t){var n=this._private.elements;return t?n.filter(t):n.spawnSelf()},mutableElements:function(){return this._private.elements}};ZR.elements=ZR.filter=ZR.$;var Fa={},tA="t",vot="f";Fa.apply=function(e){for(var t=this,n=t._private,r=n.cy,i=r.collection(),s=0;s<e.length;s++){var a=e[s],o=t.getContextMeta(a);if(!o.empty){var l=t.getContextStyle(o),u=t.applyContextStyle(o,l,a);a._private.appliedInitStyle?t.updateTransitions(a,u.diffProps):a._private.appliedInitStyle=!0;var c=t.updateStyleHints(a);c&&i.push(a)}}return i};Fa.getPropertiesDiff=function(e,t){var n=this,r=n._private.propDiffs=n._private.propDiffs||{},i=e+"-"+t,s=r[i];if(s)return s;for(var a=[],o={},l=0;l<n.length;l++){var u=n[l],c=e[l]===tA,f=t[l]===tA,h=c!==f,d=u.mappedProperties.length>0;if(h||f&&d){var p=void 0;h&&d||h?p=u.properties:d&&(p=u.mappedProperties);for(var g=0;g<p.length;g++){for(var m=p[g],v=m.name,y=!1,b=l+1;b<n.length;b++){var x=n[b],w=t[b]===tA;if(!!w&&(y=x.properties[m.name]!=null,y))break}!o[v]&&!y&&(o[v]=!0,a.push(v))}}}return r[i]=a,a};Fa.getContextMeta=function(e){for(var t=this,n="",r,i=e._private.styleCxtKey||"",s=0;s<t.length;s++){var a=t[s],o=a.selector&&a.selector.matches(e);o?n+=tA:n+=vot}return r=t.getPropertiesDiff(i,n),e._private.styleCxtKey=n,{key:n,diffPropNames:r,empty:r.length===0}};Fa.getContextStyle=function(e){var t=e.key,n=this,r=this._private.contextStyles=this._private.contextStyles||{};if(r[t])return r[t];for(var i={_private:{key:t}},s=0;s<n.length;s++){var a=n[s],o=t[s]===tA;if(!!o)for(var l=0;l<a.properties.length;l++){var u=a.properties[l];i[u.name]=u}}return r[t]=i,i};Fa.applyContextStyle=function(e,t,n){for(var r=this,i=e.diffPropNames,s={},a=r.types,o=0;o<i.length;o++){var l=i[o],u=t[l],c=n.pstyle(l);if(!u)if(c)c.bypass?u={name:l,deleteBypassed:!0}:u={name:l,delete:!0};else continue;if(c!==u){if(u.mapped===a.fn&&c!=null&&c.mapping!=null&&c.mapping.value===u.value){var f=c.mapping,h=f.fnValue=u.value(n);if(h===f.prevFnValue)continue}var d=s[l]={prev:c};r.applyParsedProperty(n,u),d.next=n.pstyle(l),d.next&&d.next.bypass&&(d.next=d.next.bypassed)}}return{diffProps:s}};Fa.updateStyleHints=function(e){var t=e._private,n=this,r=n.propertyGroupNames,i=n.propertyGroupKeys,s=function(L,W,M){return n.getPropertiesHash(L,W,M)},a=t.styleKey;if(e.removed())return!1;var o=t.group==="nodes",l=e._private.style;r=Object.keys(l);for(var u=0;u<i.length;u++){var c=i[u];t.styleKeys[c]=[A2,Kk]}for(var f=function(L,W){return t.styleKeys[W][0]=ZA(L,t.styleKeys[W][0])},h=function(L,W){return t.styleKeys[W][1]=QA(L,t.styleKeys[W][1])},d=function(L,W){f(L,W),h(L,W)},p=function(L,W){for(var M=0;M<L.length;M++){var ue=L.charCodeAt(M);f(ue,W),h(ue,W)}},g=2e9,m=function(L){return-128<L&&L<128&&Math.floor(L)!==L?g-(L*1024|0):L},v=0;v<r.length;v++){var y=r[v],b=l[y];if(b!=null){var x=this.properties[y],w=x.type,C=x.groupKey,$=void 0;x.hashOverride!=null?$=x.hashOverride(e,b):b.pfValue!=null&&($=b.pfValue);var _=x.enums==null?b.value:null,k=$!=null,E=_!=null,S=k||E,I=b.units;if(w.number&&S&&!w.multiple){var A=k?$:_;d(m(A),C),!k&&I!=null&&p(I,C)}else p(b.strValue,C)}}for(var D=[A2,Kk],T=0;T<i.length;T++){var N=i[T],F=t.styleKeys[N];D[0]=ZA(F[0],D[0]),D[1]=QA(F[1],D[1])}t.styleKey=Iit(D[0],D[1]);var R=t.styleKeys;t.labelDimsKey=Sg(R.labelDimensions);var P=s(e,["label"],R.labelDimensions);if(t.labelKey=Sg(P),t.labelStyleKey=Sg(UF(R.commonLabel,P)),!o){var V=s(e,["source-label"],R.labelDimensions);t.sourceLabelKey=Sg(V),t.sourceLabelStyleKey=Sg(UF(R.commonLabel,V));var z=s(e,["target-label"],R.labelDimensions);t.targetLabelKey=Sg(z),t.targetLabelStyleKey=Sg(UF(R.commonLabel,z))}if(o){var q=t.styleKeys,G=q.nodeBody,K=q.nodeBorder,Y=q.backgroundImage,te=q.compound,Z=q.pie,ae=[G,K,Y,te,Z].filter(function(O){return O!=null}).reduce(UF,[A2,Kk]);t.nodeKey=Sg(ae),t.hasPie=Z!=null&&Z[0]!==A2&&Z[1]!==Kk}return a!==t.styleKey};Fa.clearStyleHints=function(e){var t=e._private;t.styleCxtKey="",t.styleKeys={},t.styleKey=null,t.labelKey=null,t.labelStyleKey=null,t.sourceLabelKey=null,t.sourceLabelStyleKey=null,t.targetLabelKey=null,t.targetLabelStyleKey=null,t.nodeKey=null,t.hasPie=null};Fa.applyParsedProperty=function(e,t){var n=this,r=t,i=e._private.style,s,a=n.types,o=n.properties[r.name].type,l=r.bypass,u=i[r.name],c=u&&u.bypass,f=e._private,h="mapping",d=function(G){return G==null?null:G.pfValue!=null?G.pfValue:G.value},p=function(){var G=d(u),K=d(r);n.checkTriggers(e,r.name,G,K)};if(r&&r.name.substr(0,3)==="pie"&&Rn("The pie style properties are deprecated.  Create charts using background images instead."),t.name==="curve-style"&&e.isEdge()&&(t.value!=="bezier"&&e.isLoop()||t.value==="haystack"&&(e.source().isParent()||e.target().isParent()))&&(r=t=this.parse(t.name,"bezier",l)),r.delete)return i[r.name]=void 0,p(),!0;if(r.deleteBypassed)return u?u.bypass?(u.bypassed=void 0,p(),!0):!1:(p(),!0);if(r.deleteBypass)return u?u.bypass?(i[r.name]=u.bypassed,p(),!0):!1:(p(),!0);var g=function(){Rn("Do not assign mappings to elements without corresponding data (i.e. ele `"+e.id()+"` has no mapping for property `"+r.name+"` with data field `"+r.field+"`); try a `["+r.field+"]` selector to limit scope to elements with `"+r.field+"` defined")};switch(r.mapped){case a.mapData:{for(var m=r.field.split("."),v=f.data,y=0;y<m.length&&v;y++){var b=m[y];v=v[b]}if(v==null)return g(),!1;var x;if(Pe(v)){var w=r.fieldMax-r.fieldMin;w===0?x=0:x=(v-r.fieldMin)/w}else return Rn("Do not use continuous mappers without specifying numeric data (i.e. `"+r.field+": "+v+"` for `"+e.id()+"` is non-numeric)"),!1;if(x<0?x=0:x>1&&(x=1),o.color){var C=r.valueMin[0],$=r.valueMax[0],_=r.valueMin[1],k=r.valueMax[1],E=r.valueMin[2],S=r.valueMax[2],I=r.valueMin[3]==null?1:r.valueMin[3],A=r.valueMax[3]==null?1:r.valueMax[3],D=[Math.round(C+($-C)*x),Math.round(_+(k-_)*x),Math.round(E+(S-E)*x),Math.round(I+(A-I)*x)];s={bypass:r.bypass,name:r.name,value:D,strValue:"rgb("+D[0]+", "+D[1]+", "+D[2]+")"}}else if(o.number){var T=r.valueMin+(r.valueMax-r.valueMin)*x;s=this.parse(r.name,T,r.bypass,h)}else return!1;if(!s)return g(),!1;s.mapping=r,r=s;break}case a.data:{for(var N=r.field.split("."),F=f.data,R=0;R<N.length&&F;R++){var P=N[R];F=F[P]}if(F!=null&&(s=this.parse(r.name,F,r.bypass,h)),!s)return g(),!1;s.mapping=r,r=s;break}case a.fn:{var V=r.value,z=r.fnValue!=null?r.fnValue:V(e);if(r.prevFnValue=z,z==null)return Rn("Custom function mappers may not return null (i.e. `"+r.name+"` for ele `"+e.id()+"` is null)"),!1;if(s=this.parse(r.name,z,r.bypass,h),!s)return Rn("Custom function mappers may not return invalid values for the property type (i.e. `"+r.name+"` for ele `"+e.id()+"` is invalid)"),!1;s.mapping=Yf(r),r=s;break}case void 0:break;default:return!1}return l?(c?r.bypassed=u.bypassed:r.bypassed=u,i[r.name]=r):c?u.bypassed=r:i[r.name]=r,p(),!0};Fa.cleanElements=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(this.clearStyleHints(r),r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache(),!t)r._private.style={};else for(var i=r._private.style,s=Object.keys(i),a=0;a<s.length;a++){var o=s[a],l=i[o];l!=null&&(l.bypass?l.bypassed=null:i[o]=null)}}};Fa.update=function(){var e=this._private.cy,t=e.mutableElements();t.updateStyle()};Fa.updateTransitions=function(e,t){var n=this,r=e._private,i=e.pstyle("transition-property").value,s=e.pstyle("transition-duration").pfValue,a=e.pstyle("transition-delay").pfValue;if(i.length>0&&s>0){for(var o={},l=!1,u=0;u<i.length;u++){var c=i[u],f=e.pstyle(c),h=t[c];if(!!h){var d=h.prev,p=d,g=h.next!=null?h.next:f,m=!1,v=void 0,y=1e-6;!p||(Pe(p.pfValue)&&Pe(g.pfValue)?(m=g.pfValue-p.pfValue,v=p.pfValue+y*m):Pe(p.value)&&Pe(g.value)?(m=g.value-p.value,v=p.value+y*m):Qn(p.value)&&Qn(g.value)&&(m=p.value[0]!==g.value[0]||p.value[1]!==g.value[1]||p.value[2]!==g.value[2],v=p.strValue),m&&(o[c]=g.strValue,this.applyBypass(e,c,v),l=!0))}}if(!l)return;r.transitioning=!0,new xC(function(b){a>0?e.delayAnimation(a).play().promise().then(b):b()}).then(function(){return e.animation({style:o,duration:s,easing:e.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){n.removeBypasses(e,i),e.emitAndNotify("style"),r.transitioning=!1})}else r.transitioning&&(this.removeBypasses(e,i),e.emitAndNotify("style"),r.transitioning=!1)};Fa.checkTrigger=function(e,t,n,r,i,s){var a=this.properties[t],o=i(a);o!=null&&o(n,r)&&s(a)};Fa.checkZOrderTrigger=function(e,t,n,r){var i=this;this.checkTrigger(e,t,n,r,function(s){return s.triggersZOrder},function(){i._private.cy.notify("zorder",e)})};Fa.checkBoundsTrigger=function(e,t,n,r){this.checkTrigger(e,t,n,r,function(i){return i.triggersBounds},function(i){e.dirtyCompoundBoundsCache(),e.dirtyBoundingBoxCache(),i.triggersBoundsOfParallelBeziers&&(t==="curve-style"&&(n==="bezier"||r==="bezier")||t==="display"&&(n==="none"||r==="none"))&&e.parallelEdges().forEach(function(s){s.isBundledBezier()&&s.dirtyBoundingBoxCache()})})};Fa.checkTriggers=function(e,t,n,r){e.dirtyStyleCache(),this.checkZOrderTrigger(e,t,n,r),this.checkBoundsTrigger(e,t,n,r)};var cI={};cI.applyBypass=function(e,t,n,r){var i=this,s=[],a=!0;if(t==="*"||t==="**"){if(n!==void 0)for(var o=0;o<i.properties.length;o++){var l=i.properties[o],u=l.name,c=this.parse(u,n,!0);c&&s.push(c)}}else if(rt(t)){var f=this.parse(t,n,!0);f&&s.push(f)}else if(dn(t)){var h=t;r=n;for(var d=Object.keys(h),p=0;p<d.length;p++){var g=d[p],m=h[g];if(m===void 0&&(m=h[c8(g)]),m!==void 0){var v=this.parse(g,m,!0);v&&s.push(v)}}}else return!1;if(s.length===0)return!1;for(var y=!1,b=0;b<e.length;b++){for(var x=e[b],w={},C=void 0,$=0;$<s.length;$++){var _=s[$];if(r){var k=x.pstyle(_.name);C=w[_.name]={prev:k}}y=this.applyParsedProperty(x,Yf(_))||y,r&&(C.next=x.pstyle(_.name))}y&&this.updateStyleHints(x),r&&this.updateTransitions(x,w,a)}return y};cI.overrideBypass=function(e,t,n){t=Eee(t);for(var r=0;r<e.length;r++){var i=e[r],s=i._private.style[t],a=this.properties[t].type,o=a.color,l=a.mutiple,u=s?s.pfValue!=null?s.pfValue:s.value:null;!s||!s.bypass?this.applyBypass(i,t,n):(s.value=n,s.pfValue!=null&&(s.pfValue=n),o?s.strValue="rgb("+n.join(",")+")":l?s.strValue=n.join(" "):s.strValue=""+n,this.updateStyleHints(i)),this.checkTriggers(i,t,u,n)}};cI.removeAllBypasses=function(e,t){return this.removeBypasses(e,this.propertyNames,t)};cI.removeBypasses=function(e,t,n){for(var r=!0,i=0;i<e.length;i++){for(var s=e[i],a={},o=0;o<t.length;o++){var l=t[o],u=this.properties[l],c=s.pstyle(u.name);if(!(!c||!c.bypass)){var f="",h=this.parse(l,f,!0),d=a[u.name]={prev:c};this.applyParsedProperty(s,h),d.next=s.pstyle(u.name)}}this.updateStyleHints(s),n&&this.updateTransitions(s,a,r)}};var Lee={};Lee.getEmSizeInPixels=function(){var e=this.containerCss("font-size");return e!=null?parseFloat(e):1};Lee.containerCss=function(e){var t=this._private.cy,n=t.container();if(_r&&n&&_r.getComputedStyle)return _r.getComputedStyle(n).getPropertyValue(e)};var Eh={};Eh.getRenderedStyle=function(e,t){return t?this.getStylePropertyValue(e,t,!0):this.getRawStyle(e,!0)};Eh.getRawStyle=function(e,t){var n=this;if(e=e[0],e){for(var r={},i=0;i<n.properties.length;i++){var s=n.properties[i],a=n.getStylePropertyValue(e,s.name,t);a!=null&&(r[s.name]=a,r[c8(s.name)]=a)}return r}};Eh.getIndexedStyle=function(e,t,n,r){var i=e.pstyle(t)[n][r];return i!=null?i:e.cy().style().getDefaultProperty(t)[n][0]};Eh.getStylePropertyValue=function(e,t,n){var r=this;if(e=e[0],e){var i=r.properties[t];i.alias&&(i=i.pointsTo);var s=i.type,a=e.pstyle(i.name);if(a){var o=a.value,l=a.units,u=a.strValue;if(n&&s.number&&o!=null&&Pe(o)){var c=e.cy().zoom(),f=function(m){return m*c},h=function(m,v){return f(m)+v},d=Qn(o),p=d?l.every(function(g){return g!=null}):l!=null;return p?d?o.map(function(g,m){return h(g,l[m])}).join(" "):h(o,l):d?o.map(function(g){return rt(g)?g:""+f(g)}).join(" "):""+f(o)}else if(u!=null)return u}return null}};Eh.getAnimationStartStyle=function(e,t){for(var n={},r=0;r<t.length;r++){var i=t[r],s=i.name,a=e.pstyle(s);a!==void 0&&(dn(a)?a=this.parse(s,a.strValue):a=this.parse(s,a)),a&&(n[s]=a)}return n};Eh.getPropsList=function(e){var t=this,n=[],r=e,i=t.properties;if(r)for(var s=Object.keys(r),a=0;a<s.length;a++){var o=s[a],l=r[o],u=i[o]||i[Eee(o)],c=this.parse(u.name,l);c&&n.push(c)}return n};Eh.getNonDefaultPropertiesHash=function(e,t,n){var r=n.slice(),i,s,a,o,l,u;for(l=0;l<t.length;l++)if(i=t[l],s=e.pstyle(i,!1),s!=null)if(s.pfValue!=null)r[0]=ZA(o,r[0]),r[1]=QA(o,r[1]);else for(a=s.strValue,u=0;u<a.length;u++)o=a.charCodeAt(u),r[0]=ZA(o,r[0]),r[1]=QA(o,r[1]);return r};Eh.getPropertiesHash=Eh.getNonDefaultPropertiesHash;var y8={};y8.appendFromJson=function(e){for(var t=this,n=0;n<e.length;n++){var r=e[n],i=r.selector,s=r.style||r.css,a=Object.keys(s);t.selector(i);for(var o=0;o<a.length;o++){var l=a[o],u=s[l];t.css(l,u)}}return t};y8.fromJson=function(e){var t=this;return t.resetToDefault(),t.appendFromJson(e),t};y8.json=function(){for(var e=[],t=this.defaultLength;t<this.length;t++){for(var n=this[t],r=n.selector,i=n.properties,s={},a=0;a<i.length;a++){var o=i[a];s[o.name]=o.strValue}e.push({selector:r?r.toString():"core",style:s})}return e};var Bee={};Bee.appendFromString=function(e){var t=this,n=this,r=""+e,i,s,a;r=r.replace(/[/][*](\s|.)+?[*][/]/g,"");function o(){r.length>i.length?r=r.substr(i.length):r=""}function l(){s.length>a.length?s=s.substr(a.length):s=""}for(;;){var u=r.match(/^\s*$/);if(u)break;var c=r.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!c){Rn("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+r);break}i=c[0];var f=c[1];if(f!=="core"){var h=new M0(f);if(h.invalid){Rn("Skipping parsing of block: Invalid selector found in string stylesheet: "+f),o();continue}}var d=c[2],p=!1;s=d;for(var g=[];;){var m=s.match(/^\s*$/);if(m)break;var v=s.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!v){Rn("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+d),p=!0;break}a=v[0];var y=v[1],b=v[2],x=t.properties[y];if(!x){Rn("Skipping property: Invalid property name in: "+a),l();continue}var w=n.parse(y,b);if(!w){Rn("Skipping property: Invalid property definition in: "+a),l();continue}g.push({name:y,val:b}),l()}if(p){o();break}n.selector(f);for(var C=0;C<g.length;C++){var $=g[C];n.css($.name,$.val)}o()}return n};Bee.fromString=function(e){var t=this;return t.resetToDefault(),t.appendFromString(e),t};var Is={};(function(){var e=Ei,t=yit,n=xit,r=wit,i=$it,s=function(ae){return"^"+ae+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},a=function(ae){var O=e+"|\\w+|"+t+"|"+n+"|"+r+"|"+i;return"^"+ae+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+e+")\\s*\\,\\s*("+e+")\\s*,\\s*("+O+")\\s*\\,\\s*("+O+")\\)$"},o=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];Is.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi"]},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:s("data")},layoutData:{mapping:!0,regex:s("layoutData")},scratch:{mapping:!0,regex:s("scratch")},mapData:{mapping:!0,regex:a("mapData")},mapLayoutData:{mapping:!0,regex:a("mapLayoutData")},mapScratch:{mapping:!0,regex:a("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:o,singleRegexMatchValue:!0},urls:{regexes:o,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(ae,O){switch(ae.length){case 2:return O[0]!=="deg"&&O[0]!=="rad"&&O[1]!=="deg"&&O[1]!=="rad";case 1:return rt(ae[0])||O[0]==="deg"||O[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+e+")\\s*,\\s*("+e+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+e+")\\s*,\\s*("+e+")\\s*,\\s*("+e+")\\s*,\\s*("+e+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(ae){var O=ae.length;return O===1||O===2||O===4}}};var l={zeroNonZero:function(ae,O){return(ae==null||O==null)&&ae!==O||ae==0&&O!=0?!0:ae!=0&&O==0},any:function(ae,O){return ae!=O},emptyNonEmpty:function(ae,O){var L=I0(ae),W=I0(O);return L&&!W||!L&&W}},u=Is.types,c=[{name:"label",type:u.text,triggersBounds:l.any,triggersZOrder:l.emptyNonEmpty},{name:"text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any}],f=[{name:"source-label",type:u.text,triggersBounds:l.any},{name:"source-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"source-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-offset",type:u.size,triggersBounds:l.any}],h=[{name:"target-label",type:u.text,triggersBounds:l.any},{name:"target-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"target-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-offset",type:u.size,triggersBounds:l.any}],d=[{name:"font-family",type:u.fontFamily,triggersBounds:l.any},{name:"font-style",type:u.fontStyle,triggersBounds:l.any},{name:"font-weight",type:u.fontWeight,triggersBounds:l.any},{name:"font-size",type:u.size,triggersBounds:l.any},{name:"text-transform",type:u.textTransform,triggersBounds:l.any},{name:"text-wrap",type:u.textWrap,triggersBounds:l.any},{name:"text-overflow-wrap",type:u.textOverflowWrap,triggersBounds:l.any},{name:"text-max-width",type:u.size,triggersBounds:l.any},{name:"text-outline-width",type:u.size,triggersBounds:l.any},{name:"line-height",type:u.positiveNumber,triggersBounds:l.any}],p=[{name:"text-valign",type:u.valign,triggersBounds:l.any},{name:"text-halign",type:u.halign,triggersBounds:l.any},{name:"color",type:u.color},{name:"text-outline-color",type:u.color},{name:"text-outline-opacity",type:u.zeroOneNumber},{name:"text-background-color",type:u.color},{name:"text-background-opacity",type:u.zeroOneNumber},{name:"text-background-padding",type:u.size,triggersBounds:l.any},{name:"text-border-opacity",type:u.zeroOneNumber},{name:"text-border-color",type:u.color},{name:"text-border-width",type:u.size,triggersBounds:l.any},{name:"text-border-style",type:u.borderStyle,triggersBounds:l.any},{name:"text-background-shape",type:u.textBackgroundShape,triggersBounds:l.any},{name:"text-justification",type:u.justification}],g=[{name:"events",type:u.bool},{name:"text-events",type:u.bool}],m=[{name:"display",type:u.display,triggersZOrder:l.any,triggersBounds:l.any,triggersBoundsOfParallelBeziers:!0},{name:"visibility",type:u.visibility,triggersZOrder:l.any},{name:"opacity",type:u.zeroOneNumber,triggersZOrder:l.zeroNonZero},{name:"text-opacity",type:u.zeroOneNumber},{name:"min-zoomed-font-size",type:u.size},{name:"z-compound-depth",type:u.zCompoundDepth,triggersZOrder:l.any},{name:"z-index-compare",type:u.zIndexCompare,triggersZOrder:l.any},{name:"z-index",type:u.nonNegativeInt,triggersZOrder:l.any}],v=[{name:"overlay-padding",type:u.size,triggersBounds:l.any},{name:"overlay-color",type:u.color},{name:"overlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"overlay-shape",type:u.overlayShape,triggersBounds:l.any}],y=[{name:"underlay-padding",type:u.size,triggersBounds:l.any},{name:"underlay-color",type:u.color},{name:"underlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"underlay-shape",type:u.overlayShape,triggersBounds:l.any}],b=[{name:"transition-property",type:u.propList},{name:"transition-duration",type:u.time},{name:"transition-delay",type:u.time},{name:"transition-timing-function",type:u.easing}],x=function(ae,O){return O.value==="label"?-ae.poolIndex():O.pfValue},w=[{name:"height",type:u.nodeSize,triggersBounds:l.any,hashOverride:x},{name:"width",type:u.nodeSize,triggersBounds:l.any,hashOverride:x},{name:"shape",type:u.nodeShape,triggersBounds:l.any},{name:"shape-polygon-points",type:u.polygonPointList,triggersBounds:l.any},{name:"background-color",type:u.color},{name:"background-fill",type:u.fill},{name:"background-opacity",type:u.zeroOneNumber},{name:"background-blacken",type:u.nOneOneNumber},{name:"background-gradient-stop-colors",type:u.colors},{name:"background-gradient-stop-positions",type:u.percentages},{name:"background-gradient-direction",type:u.gradientDirection},{name:"padding",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"padding-relative-to",type:u.paddingRelativeTo,triggersBounds:l.any},{name:"bounds-expansion",type:u.boundsExpansion,triggersBounds:l.any}],C=[{name:"border-color",type:u.color},{name:"border-opacity",type:u.zeroOneNumber},{name:"border-width",type:u.size,triggersBounds:l.any},{name:"border-style",type:u.borderStyle}],$=[{name:"background-image",type:u.urls},{name:"background-image-crossorigin",type:u.bgCrossOrigin},{name:"background-image-opacity",type:u.zeroOneNumbers},{name:"background-image-containment",type:u.bgContainment},{name:"background-image-smoothing",type:u.bools},{name:"background-position-x",type:u.bgPos},{name:"background-position-y",type:u.bgPos},{name:"background-width-relative-to",type:u.bgRelativeTo},{name:"background-height-relative-to",type:u.bgRelativeTo},{name:"background-repeat",type:u.bgRepeat},{name:"background-fit",type:u.bgFit},{name:"background-clip",type:u.bgClip},{name:"background-width",type:u.bgWH},{name:"background-height",type:u.bgWH},{name:"background-offset-x",type:u.bgPos},{name:"background-offset-y",type:u.bgPos}],_=[{name:"position",type:u.position,triggersBounds:l.any},{name:"compound-sizing-wrt-labels",type:u.compoundIncludeLabels,triggersBounds:l.any},{name:"min-width",type:u.size,triggersBounds:l.any},{name:"min-width-bias-left",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-width-bias-right",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height",type:u.size,triggersBounds:l.any},{name:"min-height-bias-top",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height-bias-bottom",type:u.sizeMaybePercent,triggersBounds:l.any}],k=[{name:"line-style",type:u.lineStyle},{name:"line-color",type:u.color},{name:"line-fill",type:u.fill},{name:"line-cap",type:u.lineCap},{name:"line-opacity",type:u.zeroOneNumber},{name:"line-dash-pattern",type:u.numbers},{name:"line-dash-offset",type:u.number},{name:"line-gradient-stop-colors",type:u.colors},{name:"line-gradient-stop-positions",type:u.percentages},{name:"curve-style",type:u.curveStyle,triggersBounds:l.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:u.zeroOneNumber,triggersBounds:l.any},{name:"source-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"target-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"control-point-step-size",type:u.size,triggersBounds:l.any},{name:"control-point-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"control-point-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"segment-weights",type:u.numbers,triggersBounds:l.any},{name:"taxi-turn",type:u.bidirectionalSizeMaybePercent,triggersBounds:l.any},{name:"taxi-turn-min-distance",type:u.size,triggersBounds:l.any},{name:"taxi-direction",type:u.axisDirection,triggersBounds:l.any},{name:"edge-distances",type:u.edgeDistances,triggersBounds:l.any},{name:"arrow-scale",type:u.positiveNumber,triggersBounds:l.any},{name:"loop-direction",type:u.angle,triggersBounds:l.any},{name:"loop-sweep",type:u.angle,triggersBounds:l.any},{name:"source-distance-from-node",type:u.size,triggersBounds:l.any},{name:"target-distance-from-node",type:u.size,triggersBounds:l.any}],E=[{name:"ghost",type:u.bool,triggersBounds:l.any},{name:"ghost-offset-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-offset-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-opacity",type:u.zeroOneNumber}],S=[{name:"selection-box-color",type:u.color},{name:"selection-box-opacity",type:u.zeroOneNumber},{name:"selection-box-border-color",type:u.color},{name:"selection-box-border-width",type:u.size},{name:"active-bg-color",type:u.color},{name:"active-bg-opacity",type:u.zeroOneNumber},{name:"active-bg-size",type:u.size},{name:"outside-texture-bg-color",type:u.color},{name:"outside-texture-bg-opacity",type:u.zeroOneNumber}],I=[];Is.pieBackgroundN=16,I.push({name:"pie-size",type:u.sizeMaybePercent});for(var A=1;A<=Is.pieBackgroundN;A++)I.push({name:"pie-"+A+"-background-color",type:u.color}),I.push({name:"pie-"+A+"-background-size",type:u.percent}),I.push({name:"pie-"+A+"-background-opacity",type:u.zeroOneNumber});var D=[],T=Is.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:u.arrowShape,triggersBounds:l.any},{name:"arrow-color",type:u.color},{name:"arrow-fill",type:u.arrowFill}].forEach(function(Z){T.forEach(function(ae){var O=ae+"-"+Z.name,L=Z.type,W=Z.triggersBounds;D.push({name:O,type:L,triggersBounds:W})})},{});var N=Is.properties=[].concat(g,b,m,v,y,E,p,d,c,f,h,w,C,$,I,_,k,D,S),F=Is.propertyGroups={behavior:g,transition:b,visibility:m,overlay:v,underlay:y,ghost:E,commonLabel:p,labelDimensions:d,mainLabel:c,sourceLabel:f,targetLabel:h,nodeBody:w,nodeBorder:C,backgroundImage:$,pie:I,compound:_,edgeLine:k,edgeArrow:D,core:S},R=Is.propertyGroupNames={},P=Is.propertyGroupKeys=Object.keys(F);P.forEach(function(Z){R[Z]=F[Z].map(function(ae){return ae.name}),F[Z].forEach(function(ae){return ae.groupKey=Z})});var V=Is.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Is.propertyNames=N.map(function(Z){return Z.name});for(var z=0;z<N.length;z++){var q=N[z];N[q.name]=q}for(var G=0;G<V.length;G++){var K=V[G],Y=N[K.pointsTo],te={name:K.name,alias:!0,pointsTo:Y};N.push(te),N[K.name]=te}})();Is.getDefaultProperty=function(e){return this.getDefaultProperties()[e]};Is.getDefaultProperties=function(){var e=this._private;if(e.defaultProperties!=null)return e.defaultProperties;for(var t=pt({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var c=1;c<=Is.pieBackgroundN;c++){var f=u.name.replace("{{i}}",c),h=u.value;l[f]=h}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"taxi-turn":"50%","taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"}].reduce(function(l,u){return Is.arrowPrefixes.forEach(function(c){var f=c+"-"+u.name,h=u.value;l[f]=h}),l},{})),n={},r=0;r<this.properties.length;r++){var i=this.properties[r];if(!i.pointsTo){var s=i.name,a=t[s],o=this.parse(s,a);n[s]=o}}return e.defaultProperties=n,e.defaultProperties};Is.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var b8={};b8.parse=function(e,t,n,r){var i=this;if(zr(t))return i.parseImplWarn(e,t,n,r);var s=r==="mapping"||r===!0||r===!1||r==null?"dontcare":r,a=n?"t":"f",o=""+t,l=Pke(e,o,a,s),u=i.propCache=i.propCache||[],c;return(c=u[l])||(c=u[l]=i.parseImplWarn(e,t,n,r)),(n||r==="mapping")&&(c=Yf(c),c&&(c.value=Yf(c.value))),c};b8.parseImplWarn=function(e,t,n,r){var i=this.parseImpl(e,t,n,r);return!i&&t!=null&&Rn("The style property `".concat(e,": ").concat(t,"` is invalid")),i&&(i.name==="width"||i.name==="height")&&t==="label"&&Rn("The style value of `label` is deprecated for `"+i.name+"`"),i};b8.parseImpl=function(e,t,n,r){var i=this;e=Eee(e);var s=i.properties[e],a=t,o=i.types;if(!s||t===void 0)return null;s.alias&&(s=s.pointsTo,e=s.name);var l=rt(t);l&&(t=t.trim());var u=s.type;if(!u)return null;if(n&&(t===""||t===null))return{name:e,value:t,bypass:!0,deleteBypass:!0};if(zr(t))return{name:e,value:t,strValue:"fn",mapped:o.fn,bypass:n};var c,f;if(!(!l||r||t.length<7||t[1]!=="a")){if(t.length>=7&&t[0]==="d"&&(c=new RegExp(o.data.regex).exec(t))){if(n)return!1;var h=o.data;return{name:e,value:c,strValue:""+t,mapped:h,field:c[1],bypass:n}}else if(t.length>=10&&t[0]==="m"&&(f=new RegExp(o.mapData.regex).exec(t))){if(n||u.multiple)return!1;var d=o.mapData;if(!(u.color||u.number))return!1;var p=this.parse(e,f[4]);if(!p||p.mapped)return!1;var g=this.parse(e,f[5]);if(!g||g.mapped)return!1;if(p.pfValue===g.pfValue||p.strValue===g.strValue)return Rn("`"+e+": "+t+"` is not a valid mapper because the output range is zero; converting to `"+e+": "+p.strValue+"`"),this.parse(e,p.strValue);if(u.color){var m=p.value,v=g.value,y=m[0]===v[0]&&m[1]===v[1]&&m[2]===v[2]&&(m[3]===v[3]||(m[3]==null||m[3]===1)&&(v[3]==null||v[3]===1));if(y)return!1}return{name:e,value:f,strValue:""+t,mapped:d,field:f[1],fieldMin:parseFloat(f[2]),fieldMax:parseFloat(f[3]),valueMin:p.value,valueMax:g.value,bypass:n}}}if(u.multiple&&r!=="multiple"){var b;if(l?b=t.split(/\s+/):Qn(t)?b=t:b=[t],u.evenMultiple&&b.length%2!==0)return null;for(var x=[],w=[],C=[],$="",_=!1,k=0;k<b.length;k++){var E=i.parse(e,b[k],n,"multiple");_=_||rt(E.value),x.push(E.value),C.push(E.pfValue!=null?E.pfValue:E.value),w.push(E.units),$+=(k>0?" ":"")+E.strValue}return u.validate&&!u.validate(x,w)?null:u.singleEnum&&_?x.length===1&&rt(x[0])?{name:e,value:x[0],strValue:x[0],bypass:n}:null:{name:e,value:x,pfValue:C,strValue:$,bypass:n,units:w}}var S=function(){for(var O=0;O<u.enums.length;O++){var L=u.enums[O];if(L===t)return{name:e,value:t,strValue:""+t,bypass:n}}return null};if(u.number){var I,A="px";if(u.units&&(I=u.units),u.implicitUnits&&(A=u.implicitUnits),!u.unitless)if(l){var D="px|em"+(u.allowPercent?"|\\%":"");I&&(D=I);var T=t.match("^("+Ei+")("+D+")?$");T&&(t=T[1],I=T[2]||A)}else(!I||u.implicitUnits)&&(I=A);if(t=parseFloat(t),isNaN(t)&&u.enums===void 0)return null;if(isNaN(t)&&u.enums!==void 0)return t=a,S();if(u.integer&&!fit(t)||u.min!==void 0&&(t<u.min||u.strictMin&&t===u.min)||u.max!==void 0&&(t>u.max||u.strictMax&&t===u.max))return null;var N={name:e,value:t,strValue:""+t+(I||""),units:I,bypass:n};return u.unitless||I!=="px"&&I!=="em"?N.pfValue=t:N.pfValue=I==="px"||!I?t:this.getEmSizeInPixels()*t,(I==="ms"||I==="s")&&(N.pfValue=I==="ms"?t:1e3*t),(I==="deg"||I==="rad")&&(N.pfValue=I==="rad"?t:ast(t)),I==="%"&&(N.pfValue=t/100),N}else if(u.propList){var F=[],R=""+t;if(R!=="none"){for(var P=R.split(/\s*,\s*|\s+/),V=0;V<P.length;V++){var z=P[V].trim();i.properties[z]?F.push(z):Rn("`"+z+"` is not a valid property name")}if(F.length===0)return null}return{name:e,value:F,strValue:F.length===0?"none":F.join(" "),bypass:n}}else if(u.color){var q=Ait(t);return q?{name:e,value:q,pfValue:q,strValue:"rgb("+q[0]+","+q[1]+","+q[2]+")",bypass:n}:null}else if(u.regex||u.regexes){if(u.enums){var G=S();if(G)return G}for(var K=u.regexes?u.regexes:[u.regex],Y=0;Y<K.length;Y++){var te=new RegExp(K[Y]),Z=te.exec(t);if(Z)return{name:e,value:u.singleRegexMatchValue?Z[1]:Z,strValue:""+t,bypass:n}}return null}else return u.string?{name:e,value:""+t,strValue:""+t,bypass:n}:u.enums?S():null};var xa=function e(t){if(!(this instanceof e))return new e(t);if(!kee(t)){Xr("A style must have a core reference");return}this._private={cy:t,coreStyle:{}},this.length=0,this.resetToDefault()},Da=xa.prototype;Da.instanceString=function(){return"style"};Da.clear=function(){for(var e=this._private,t=e.cy,n=t.elements(),r=0;r<this.length;r++)this[r]=void 0;return this.length=0,e.contextStyles={},e.propDiffs={},this.cleanElements(n,!0),n.forEach(function(i){var s=i[0]._private;s.styleDirty=!0,s.appliedInitStyle=!1}),this};Da.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};Da.core=function(e){return this._private.coreStyle[e]||this.getDefaultProperty(e)};Da.selector=function(e){var t=e==="core"?null:new M0(e),n=this.length++;return this[n]={selector:t,properties:[],mappedProperties:[],index:n},this};Da.css=function(){var e=this,t=arguments;if(t.length===1)for(var n=t[0],r=0;r<e.properties.length;r++){var i=e.properties[r],s=n[i.name];s===void 0&&(s=n[c8(i.name)]),s!==void 0&&this.cssRule(i.name,s)}else t.length===2&&this.cssRule(t[0],t[1]);return this};Da.style=Da.css;Da.cssRule=function(e,t){var n=this.parse(e,t);if(n){var r=this.length-1;this[r].properties.push(n),this[r].properties[n.name]=n,n.name.match(/pie-(\d+)-background-size/)&&n.value&&(this._private.hasPie=!0),n.mapped&&this[r].mappedProperties.push(n);var i=!this[r].selector;i&&(this._private.coreStyle[n.name]=n)}return this};Da.append=function(e){return Tke(e)?e.appendToStyle(this):Qn(e)?this.appendFromJson(e):rt(e)&&this.appendFromString(e),this};xa.fromJson=function(e,t){var n=new xa(e);return n.fromJson(t),n};xa.fromString=function(e,t){return new xa(e).fromString(t)};[Fa,cI,Lee,Eh,y8,Bee,Is,b8].forEach(function(e){pt(Da,e)});xa.types=Da.types;xa.properties=Da.properties;xa.propertyGroups=Da.propertyGroups;xa.propertyGroupNames=Da.propertyGroupNames;xa.propertyGroupKeys=Da.propertyGroupKeys;var yot={style:function(t){if(t){var n=this.setStyle(t);n.update()}return this._private.style},setStyle:function(t){var n=this._private;return Tke(t)?n.style=t.generateStyle(this):Qn(t)?n.style=xa.fromJson(this,t):rt(t)?n.style=xa.fromString(this,t):n.style=xa(this),n.style},updateStyle:function(){this.mutableElements().updateStyle()}},bot="single",Ay={autolock:function(t){if(t!==void 0)this._private.autolock=!!t;else return this._private.autolock;return this},autoungrabify:function(t){if(t!==void 0)this._private.autoungrabify=!!t;else return this._private.autoungrabify;return this},autounselectify:function(t){if(t!==void 0)this._private.autounselectify=!!t;else return this._private.autounselectify;return this},selectionType:function(t){var n=this._private;if(n.selectionType==null&&(n.selectionType=bot),t!==void 0)(t==="additive"||t==="single")&&(n.selectionType=t);else return n.selectionType;return this},panningEnabled:function(t){if(t!==void 0)this._private.panningEnabled=!!t;else return this._private.panningEnabled;return this},userPanningEnabled:function(t){if(t!==void 0)this._private.userPanningEnabled=!!t;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(t){if(t!==void 0)this._private.zoomingEnabled=!!t;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(t){if(t!==void 0)this._private.userZoomingEnabled=!!t;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(t){if(t!==void 0)this._private.boxSelectionEnabled=!!t;else return this._private.boxSelectionEnabled;return this},pan:function(){var t=arguments,n=this._private.pan,r,i,s,a,o;switch(t.length){case 0:return n;case 1:if(rt(t[0]))return r=t[0],n[r];if(dn(t[0])){if(!this._private.panningEnabled)return this;s=t[0],a=s.x,o=s.y,Pe(a)&&(n.x=a),Pe(o)&&(n.y=o),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;r=t[0],i=t[1],(r==="x"||r==="y")&&Pe(i)&&(n[r]=i),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(t,n){var r=arguments,i=this._private.pan,s,a,o,l,u;if(!this._private.panningEnabled)return this;switch(r.length){case 1:dn(t)&&(o=r[0],l=o.x,u=o.y,Pe(l)&&(i.x+=l),Pe(u)&&(i.y+=u),this.emit("pan viewport"));break;case 2:s=t,a=n,(s==="x"||s==="y")&&Pe(a)&&(i[s]+=a),this.emit("pan viewport");break}return this.notify("viewport"),this},fit:function(t,n){var r=this.getFitViewport(t,n);if(r){var i=this._private;i.zoom=r.zoom,i.pan=r.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(t,n){if(Pe(t)&&n===void 0&&(n=t,t=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var r;if(rt(t)){var i=t;t=this.$(i)}else if(pit(t)){var s=t;r={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2},r.w=r.x2-r.x1,r.h=r.y2-r.y1}else Rl(t)||(t=this.mutableElements());if(!(Rl(t)&&t.empty())){r=r||t.boundingBox();var a=this.width(),o=this.height(),l;if(n=Pe(n)?n:0,!isNaN(a)&&!isNaN(o)&&a>0&&o>0&&!isNaN(r.w)&&!isNaN(r.h)&&r.w>0&&r.h>0){l=Math.min((a-2*n)/r.w,(o-2*n)/r.h),l=l>this._private.maxZoom?this._private.maxZoom:l,l=l<this._private.minZoom?this._private.minZoom:l;var u={x:(a-l*(r.x1+r.x2))/2,y:(o-l*(r.y1+r.y2))/2};return{zoom:l,pan:u}}}}},zoomRange:function(t,n){var r=this._private;if(n==null){var i=t;t=i.min,n=i.max}return Pe(t)&&Pe(n)&&t<=n?(r.minZoom=t,r.maxZoom=n):Pe(t)&&n===void 0&&t<=r.maxZoom?r.minZoom=t:Pe(n)&&t===void 0&&n>=r.minZoom&&(r.maxZoom=n),this},minZoom:function(t){return t===void 0?this._private.minZoom:this.zoomRange({min:t})},maxZoom:function(t){return t===void 0?this._private.maxZoom:this.zoomRange({max:t})},getZoomedViewport:function(t){var n=this._private,r=n.pan,i=n.zoom,s,a,o=!1;if(n.zoomingEnabled||(o=!0),Pe(t)?a=t:dn(t)&&(a=t.level,t.position!=null?s=h8(t.position,i,r):t.renderedPosition!=null&&(s=t.renderedPosition),s!=null&&!n.panningEnabled&&(o=!0)),a=a>n.maxZoom?n.maxZoom:a,a=a<n.minZoom?n.minZoom:a,o||!Pe(a)||a===i||s!=null&&(!Pe(s.x)||!Pe(s.y)))return null;if(s!=null){var l=r,u=i,c=a,f={x:-c/u*(s.x-l.x)+s.x,y:-c/u*(s.y-l.y)+s.y};return{zoomed:!0,panned:!0,zoom:c,pan:f}}else return{zoomed:!0,panned:!1,zoom:a,pan:r}},zoom:function(t){if(t===void 0)return this._private.zoom;var n=this.getZoomedViewport(t),r=this._private;return n==null||!n.zoomed?this:(r.zoom=n.zoom,n.panned&&(r.pan.x=n.pan.x,r.pan.y=n.pan.y),this.emit("zoom"+(n.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(t){var n=this._private,r=!0,i=!0,s=[],a=!1,o=!1;if(!t)return this;if(Pe(t.zoom)||(r=!1),dn(t.pan)||(i=!1),!r&&!i)return this;if(r){var l=t.zoom;l<n.minZoom||l>n.maxZoom||!n.zoomingEnabled?a=!0:(n.zoom=l,s.push("zoom"))}if(i&&(!a||!t.cancelOnFailedZoom)&&n.panningEnabled){var u=t.pan;Pe(u.x)&&(n.pan.x=u.x,o=!1),Pe(u.y)&&(n.pan.y=u.y,o=!1),o||s.push("pan")}return s.length>0&&(s.push("viewport"),this.emit(s.join(" ")),this.notify("viewport")),this},center:function(t){var n=this.getCenterPan(t);return n&&(this._private.pan=n,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(t,n){if(!!this._private.panningEnabled){if(rt(t)){var r=t;t=this.mutableElements().filter(r)}else Rl(t)||(t=this.mutableElements());if(t.length!==0){var i=t.boundingBox(),s=this.width(),a=this.height();n=n===void 0?this._private.zoom:n;var o={x:(s-n*(i.x1+i.x2))/2,y:(a-n*(i.y1+i.y2))/2};return o}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var t=this._private,n=t.container;return t.sizeCache=t.sizeCache||(n?function(){var r=_r.getComputedStyle(n),i=function(a){return parseFloat(r.getPropertyValue(a))};return{width:n.clientWidth-i("padding-left")-i("padding-right"),height:n.clientHeight-i("padding-top")-i("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var t=this._private.pan,n=this._private.zoom,r=this.renderedExtent(),i={x1:(r.x1-t.x)/n,x2:(r.x2-t.x)/n,y1:(r.y1-t.y)/n,y2:(r.y2-t.y)/n};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var t=this.width(),n=this.height();return{x1:0,y1:0,x2:t,y2:n,w:t,h:n}},multiClickDebounceTime:function(t){if(t)this._private.multiClickDebounceTime=t;else return this._private.multiClickDebounceTime;return this}};Ay.centre=Ay.center;Ay.autolockNodes=Ay.autolock;Ay.autoungrabifyNodes=Ay.autoungrabify;var iT={data:Fn.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:Fn.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:Fn.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Fn.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};iT.attr=iT.data;iT.removeAttr=iT.removeData;var sT=function(t){var n=this;t=pt({},t);var r=t.container;r&&!a5(r)&&a5(r[0])&&(r=r[0]);var i=r?r._cyreg:null;i=i||{},i&&i.cy&&(i.cy.destroy(),i={});var s=i.readies=i.readies||[];r&&(r._cyreg=i),i.cy=n;var a=_r!==void 0&&r!==void 0&&!t.headless,o=t;o.layout=pt({name:a?"grid":"null"},o.layout),o.renderer=pt({name:a?"canvas":"null"},o.renderer);var l=function(p,g,m){return g!==void 0?g:m!==void 0?m:p},u=this._private={container:r,ready:!1,options:o,elements:new zs(this),listeners:[],aniEles:new zs(this),data:o.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:l(!0,o.zoomingEnabled),userZoomingEnabled:l(!0,o.userZoomingEnabled),panningEnabled:l(!0,o.panningEnabled),userPanningEnabled:l(!0,o.userPanningEnabled),boxSelectionEnabled:l(!0,o.boxSelectionEnabled),autolock:l(!1,o.autolock,o.autolockNodes),autoungrabify:l(!1,o.autoungrabify,o.autoungrabifyNodes),autounselectify:l(!1,o.autounselectify),styleEnabled:o.styleEnabled===void 0?a:o.styleEnabled,zoom:Pe(o.zoom)?o.zoom:1,pan:{x:dn(o.pan)&&Pe(o.pan.x)?o.pan.x:0,y:dn(o.pan)&&Pe(o.pan.y)?o.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:l(250,o.multiClickDebounceTime)};this.createEmitter(),this.selectionType(o.selectionType),this.zoomRange({min:o.minZoom,max:o.maxZoom});var c=function(p,g){var m=p.some(git);if(m)return xC.all(p).then(g);g(p)};u.styleEnabled&&n.setStyle([]);var f=pt({},o,o.renderer);n.initRenderer(f);var h=function(p,g,m){n.notifications(!1);var v=n.mutableElements();v.length>0&&v.remove(),p!=null&&(dn(p)||Qn(p))&&n.add(p),n.one("layoutready",function(b){n.notifications(!0),n.emit(b),n.one("load",g),n.emitAndNotify("load")}).one("layoutstop",function(){n.one("done",m),n.emit("done")});var y=pt({},n._private.options.layout);y.eles=n.elements(),n.layout(y).run()};c([o.style,o.elements],function(d){var p=d[0],g=d[1];u.styleEnabled&&n.style().append(p),h(g,function(){n.startAnimationLoop(),u.ready=!0,zr(o.ready)&&n.on("ready",o.ready);for(var m=0;m<s.length;m++){var v=s[m];n.on("ready",v)}i&&(i.readies=[]),n.emit("ready")},o.done)})},f5=sT.prototype;pt(f5,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(t){return this.isReady()?this.emitter().emit("ready",[],t):this.on("ready",t),this},destroy:function(){var t=this;if(!t.destroyed())return t.stopAnimationLoop(),t.destroyRenderer(),this.emit("destroy"),t._private.destroyed=!0,t},hasElementWithId:function(t){return this._private.elements.hasElementWithId(t)},getElementById:function(t){return this._private.elements.getElementById(t)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(t){return this._private.elements.merge(t),this},removeFromPool:function(t){return this._private.elements.unmerge(t),this},container:function(){return this._private.container||null},mount:function(t){if(t!=null){var n=this,r=n._private,i=r.options;return!a5(t)&&a5(t[0])&&(t=t[0]),n.stopAnimationLoop(),n.destroyRenderer(),r.container=t,r.styleEnabled=!0,n.invalidateSize(),n.initRenderer(pt({},i,i.renderer,{name:i.renderer.name==="null"?"canvas":i.renderer.name})),n.startAnimationLoop(),n.style(i.style),n.emit("mount"),n}},unmount:function(){var t=this;return t.stopAnimationLoop(),t.destroyRenderer(),t.initRenderer({name:"null"}),t.emit("unmount"),t},options:function(){return Yf(this._private.options)},json:function(t){var n=this,r=n._private,i=n.mutableElements(),s=function(x){return n.getElementById(x.id())};if(dn(t)){if(n.startBatch(),t.elements){var a={},o=function(x,w){for(var C=[],$=[],_=0;_<x.length;_++){var k=x[_];if(!k.data.id){Rn("cy.json() cannot handle elements without an ID attribute");continue}var E=""+k.data.id,S=n.getElementById(E);a[E]=!0,S.length!==0?$.push({ele:S,json:k}):(w&&(k.group=w),C.push(k))}n.add(C);for(var I=0;I<$.length;I++){var A=$[I],D=A.ele,T=A.json;D.json(T)}};if(Qn(t.elements))o(t.elements);else for(var l=["nodes","edges"],u=0;u<l.length;u++){var c=l[u],f=t.elements[c];Qn(f)&&o(f,c)}var h=n.collection();i.filter(function(b){return!a[b.id()]}).forEach(function(b){b.isParent()?h.merge(b):b.remove()}),h.forEach(function(b){return b.children().move({parent:null})}),h.forEach(function(b){return s(b).remove()})}t.style&&n.style(t.style),t.zoom!=null&&t.zoom!==r.zoom&&n.zoom(t.zoom),t.pan&&(t.pan.x!==r.pan.x||t.pan.y!==r.pan.y)&&n.pan(t.pan),t.data&&n.data(t.data);for(var d=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],p=0;p<d.length;p++){var g=d[p];t[g]!=null&&n[g](t[g])}return n.endBatch(),this}else{var m=!!t,v={};m?v.elements=this.elements().map(function(b){return b.json()}):(v.elements={},i.forEach(function(b){var x=b.group();v.elements[x]||(v.elements[x]=[]),v.elements[x].push(b.json())})),this._private.styleEnabled&&(v.style=n.style().json()),v.data=Yf(n.data());var y=r.options;return v.zoomingEnabled=r.zoomingEnabled,v.userZoomingEnabled=r.userZoomingEnabled,v.zoom=r.zoom,v.minZoom=r.minZoom,v.maxZoom=r.maxZoom,v.panningEnabled=r.panningEnabled,v.userPanningEnabled=r.userPanningEnabled,v.pan=Yf(r.pan),v.boxSelectionEnabled=r.boxSelectionEnabled,v.renderer=Yf(y.renderer),v.hideEdgesOnViewport=y.hideEdgesOnViewport,v.textureOnViewport=y.textureOnViewport,v.wheelSensitivity=y.wheelSensitivity,v.motionBlur=y.motionBlur,v.multiClickDebounceTime=y.multiClickDebounceTime,v}}});f5.$id=f5.getElementById;[lot,dot,$Ee,hY,KR,got,dY,ZR,yot,Ay,iT].forEach(function(e){pt(f5,e)});var xot={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,n){return!0},ready:void 0,stop:void 0,transform:function(t,n){return n}},wot={maximal:!1,acyclic:!1},Qx=function(t){return t.scratch("breadthfirst")},Rpe=function(t,n){return t.scratch("breadthfirst",n)};function CEe(e){this.options=pt({},xot,wot,e)}CEe.prototype.run=function(){var e=this.options,t=e,n=e.cy,r=t.eles,i=r.nodes().filter(function(X){return!X.isParent()}),s=r,a=t.directed,o=t.acyclic||t.maximal||t.maximalAdjustments>0,l=il(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),u;if(Rl(t.roots))u=t.roots;else if(Qn(t.roots)){for(var c=[],f=0;f<t.roots.length;f++){var h=t.roots[f],d=n.getElementById(h);c.push(d)}u=n.collection(c)}else if(rt(t.roots))u=n.$(t.roots);else if(a)u=i.roots();else{var p=r.components();u=n.collection();for(var g=function(se){var oe=p[se],pe=oe.maxDegree(!1),Ce=oe.filter(function(ze){return ze.degree(!1)===pe});u=u.add(Ce)},m=0;m<p.length;m++)g(m)}var v=[],y={},b=function(se,oe){v[oe]==null&&(v[oe]=[]);var pe=v[oe].length;v[oe].push(se),Rpe(se,{index:pe,depth:oe})},x=function(se,oe){var pe=Qx(se),Ce=pe.depth,ze=pe.index;v[Ce][ze]=null,b(se,oe)};s.bfs({roots:u,directed:t.directed,visit:function(se,oe,pe,Ce,ze){var et=se[0],dt=et.id();b(et,ze),y[dt]=!0}});for(var w=[],C=0;C<i.length;C++){var $=i[C];y[$.id()]||w.push($)}var _=function(se){for(var oe=v[se],pe=0;pe<oe.length;pe++){var Ce=oe[pe];if(Ce==null){oe.splice(pe,1),pe--;continue}Rpe(Ce,{depth:se,index:pe})}},k=function(){for(var se=0;se<v.length;se++)_(se)},E=function(se,oe){for(var pe=Qx(se),Ce=se.incomers().filter(function(fe){return fe.isNode()&&r.has(fe)}),ze=-1,et=se.id(),dt=0;dt<Ce.length;dt++){var He=Ce[dt],Se=Qx(He);ze=Math.max(ze,Se.depth)}if(pe.depth<=ze){if(!t.acyclic&&oe[et])return null;var j=ze+1;return x(se,j),oe[et]=j,!0}return!1};if(a&&o){var S=[],I={},A=function(se){return S.push(se)},D=function(){return S.shift()};for(i.forEach(function(X){return S.push(X)});S.length>0;){var T=D(),N=E(T,I);if(N)T.outgoers().filter(function(X){return X.isNode()&&r.has(X)}).forEach(A);else if(N===null){Rn("Detected double maximal shift for node `"+T.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}k();var F=0;if(t.avoidOverlap)for(var R=0;R<i.length;R++){var P=i[R],V=P.layoutDimensions(t),z=V.w,q=V.h;F=Math.max(F,z,q)}var G={},K=function(se){if(G[se.id()])return G[se.id()];for(var oe=Qx(se).depth,pe=se.neighborhood(),Ce=0,ze=0,et=0;et<pe.length;et++){var dt=pe[et];if(!(dt.isEdge()||dt.isParent()||!i.has(dt))){var He=Qx(dt);if(He!=null){var Se=He.index,j=He.depth;if(!(Se==null||j==null)){var fe=v[j].length;j<oe&&(Ce+=Se/fe,ze++)}}}}return ze=Math.max(1,ze),Ce=Ce/ze,ze===0&&(Ce=0),G[se.id()]=Ce,Ce},Y=function(se,oe){var pe=K(se),Ce=K(oe),ze=pe-Ce;return ze===0?Ike(se.id(),oe.id()):ze};t.depthSort!==void 0&&(Y=t.depthSort);for(var te=0;te<v.length;te++)v[te].sort(Y),_(te);for(var Z=[],ae=0;ae<w.length;ae++)Z.push(w[ae]);v.unshift(Z),k();for(var O=0,L=0;L<v.length;L++)O=Math.max(v[L].length,O);var W={x:l.x1+l.w/2,y:l.x1+l.h/2},M=v.reduce(function(X,se){return Math.max(X,se.length)},0),ue=function(se){var oe=Qx(se),pe=oe.depth,Ce=oe.index,ze=v[pe].length,et=Math.max(l.w/((t.grid?M:ze)+1),F),dt=Math.max(l.h/(v.length+1),F),He=Math.min(l.w/2/v.length,l.h/2/v.length);if(He=Math.max(He,F),t.circle){var j=He*pe+He-(v.length>0&&v[0].length<=3?He/2:0),fe=2*Math.PI/v[pe].length*Ce;return pe===0&&v[0].length===1&&(j=1),{x:W.x+j*Math.cos(fe),y:W.y+j*Math.sin(fe)}}else{var Se={x:W.x+(Ce+1-(ze+1)/2)*et,y:(pe+1)*dt};return Se}};return r.nodes().layoutPositions(this,t,ue),this};var $ot={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,n){return!0},ready:void 0,stop:void 0,transform:function(t,n){return n}};function _Ee(e){this.options=pt({},$ot,e)}_Ee.prototype.run=function(){var e=this.options,t=e,n=e.cy,r=t.eles,i=t.counterclockwise!==void 0?!t.counterclockwise:t.clockwise,s=r.nodes().not(":parent");t.sort&&(s=s.sort(t.sort));for(var a=il(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),o={x:a.x1+a.w/2,y:a.y1+a.h/2},l=t.sweep===void 0?2*Math.PI-2*Math.PI/s.length:t.sweep,u=l/Math.max(1,s.length-1),c,f=0,h=0;h<s.length;h++){var d=s[h],p=d.layoutDimensions(t),g=p.w,m=p.h;f=Math.max(f,g,m)}if(Pe(t.radius)?c=t.radius:s.length<=1?c=0:c=Math.min(a.h,a.w)/2-f,s.length>1&&t.avoidOverlap){f*=1.75;var v=Math.cos(u)-Math.cos(0),y=Math.sin(u)-Math.sin(0),b=Math.sqrt(f*f/(v*v+y*y));c=Math.max(b,c)}var x=function(C,$){var _=t.startAngle+$*u*(i?1:-1),k=c*Math.cos(_),E=c*Math.sin(_),S={x:o.x+k,y:o.y+E};return S};return r.nodes().layoutPositions(this,t,x),this};var Cot={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(t){return t.degree()},levelWidth:function(t){return t.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,n){return!0},ready:void 0,stop:void 0,transform:function(t,n){return n}};function SEe(e){this.options=pt({},Cot,e)}SEe.prototype.run=function(){for(var e=this.options,t=e,n=t.counterclockwise!==void 0?!t.counterclockwise:t.clockwise,r=e.cy,i=t.eles,s=i.nodes().not(":parent"),a=il(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()}),o={x:a.x1+a.w/2,y:a.y1+a.h/2},l=[],u=0,c=0;c<s.length;c++){var f=s[c],h=void 0;h=t.concentric(f),l.push({value:h,node:f}),f._private.scratch.concentric=h}s.updateStyle();for(var d=0;d<s.length;d++){var p=s[d],g=p.layoutDimensions(t);u=Math.max(u,g.w,g.h)}l.sort(function(X,se){return se.value-X.value});for(var m=t.levelWidth(s),v=[[]],y=v[0],b=0;b<l.length;b++){var x=l[b];if(y.length>0){var w=Math.abs(y[0].value-x.value);w>=m&&(y=[],v.push(y))}y.push(x)}var C=u+t.minNodeSpacing;if(!t.avoidOverlap){var $=v.length>0&&v[0].length>1,_=Math.min(a.w,a.h)/2-C,k=_/(v.length+$?1:0);C=Math.min(C,k)}for(var E=0,S=0;S<v.length;S++){var I=v[S],A=t.sweep===void 0?2*Math.PI-2*Math.PI/I.length:t.sweep,D=I.dTheta=A/Math.max(1,I.length-1);if(I.length>1&&t.avoidOverlap){var T=Math.cos(D)-Math.cos(0),N=Math.sin(D)-Math.sin(0),F=Math.sqrt(C*C/(T*T+N*N));E=Math.max(F,E)}I.r=E,E+=C}if(t.equidistant){for(var R=0,P=0,V=0;V<v.length;V++){var z=v[V],q=z.r-P;R=Math.max(R,q)}P=0;for(var G=0;G<v.length;G++){var K=v[G];G===0&&(P=K.r),K.r=P,P+=R}}for(var Y={},te=0;te<v.length;te++)for(var Z=v[te],ae=Z.dTheta,O=Z.r,L=0;L<Z.length;L++){var W=Z[L],M=t.startAngle+(n?1:-1)*ae*L,ue={x:o.x+O*Math.cos(M),y:o.y+O*Math.sin(M)};Y[W.node.id()]=ue}return i.nodes().layoutPositions(this,t,function(X){var se=X.id();return Y[se]}),this};var ej,_ot={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(t,n){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(t){return 2048},nodeOverlap:4,idealEdgeLength:function(t){return 32},edgeElasticity:function(t){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function x8(e){this.options=pt({},_ot,e),this.options.layout=this}x8.prototype.run=function(){var e=this.options,t=e.cy,n=this;n.stopped=!1,(e.animate===!0||e.animate===!1)&&n.emit({type:"layoutstart",layout:n}),e.debug===!0?ej=!0:ej=!1;var r=Sot(t,n,e);ej&&Aot(r),e.randomize&&Tot(r);var i=Ap(),s=function(){Dot(r,t,e),e.fit===!0&&t.fit(e.padding)},a=function(h){return!(n.stopped||h>=e.numIter||(Iot(r,e),r.temperature=r.temperature*e.coolingFactor,r.temperature<e.minTemp))},o=function(){if(e.animate===!0||e.animate===!1)s(),n.one("layoutstop",e.stop),n.emit({type:"layoutstop",layout:n});else{var h=e.eles.nodes(),d=kEe(r,e,h);h.layoutPositions(n,e,d)}},l=0,u=!0;if(e.animate===!0){var c=function f(){for(var h=0;u&&h<e.refresh;)u=a(l),l++,h++;if(!u)Lpe(r,e),o();else{var d=Ap();d-i>=e.animationThreshold&&s(),o5(f)}};c()}else{for(;u;)u=a(l),l++;Lpe(r,e),o()}return this};x8.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};x8.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var Sot=function(t,n,r){for(var i=r.eles.edges(),s=r.eles.nodes(),a=il(r.boundingBox?r.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),o={isCompound:t.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:s.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:i.size(),temperature:r.initialTemp,clientWidth:a.w,clientHeight:a.h,boundingBox:a},l=r.eles.components(),u={},c=0;c<l.length;c++)for(var f=l[c],h=0;h<f.length;h++){var d=f[h];u[d.id()]=c}for(var c=0;c<o.nodeSize;c++){var p=s[c],g=p.layoutDimensions(r),m={};m.isLocked=p.locked(),m.id=p.data("id"),m.parentId=p.data("parent"),m.cmptId=u[p.id()],m.children=[],m.positionX=p.position("x"),m.positionY=p.position("y"),m.offsetX=0,m.offsetY=0,m.height=g.w,m.width=g.h,m.maxX=m.positionX+m.width/2,m.minX=m.positionX-m.width/2,m.maxY=m.positionY+m.height/2,m.minY=m.positionY-m.height/2,m.padLeft=parseFloat(p.style("padding")),m.padRight=parseFloat(p.style("padding")),m.padTop=parseFloat(p.style("padding")),m.padBottom=parseFloat(p.style("padding")),m.nodeRepulsion=zr(r.nodeRepulsion)?r.nodeRepulsion(p):r.nodeRepulsion,o.layoutNodes.push(m),o.idToIndex[m.id]=c}for(var v=[],y=0,b=-1,x=[],c=0;c<o.nodeSize;c++){var p=o.layoutNodes[c],w=p.parentId;w!=null?o.layoutNodes[o.idToIndex[w]].children.push(p.id):(v[++b]=p.id,x.push(p.id))}for(o.graphSet.push(x);y<=b;){var C=v[y++],$=o.idToIndex[C],d=o.layoutNodes[$],_=d.children;if(_.length>0){o.graphSet.push(_);for(var c=0;c<_.length;c++)v[++b]=_[c]}}for(var c=0;c<o.graphSet.length;c++)for(var k=o.graphSet[c],h=0;h<k.length;h++){var E=o.idToIndex[k[h]];o.indexToGraph[E]=c}for(var c=0;c<o.edgeSize;c++){var S=i[c],I={};I.id=S.data("id"),I.sourceId=S.data("source"),I.targetId=S.data("target");var A=zr(r.idealEdgeLength)?r.idealEdgeLength(S):r.idealEdgeLength,D=zr(r.edgeElasticity)?r.edgeElasticity(S):r.edgeElasticity,T=o.idToIndex[I.sourceId],N=o.idToIndex[I.targetId],F=o.indexToGraph[T],R=o.indexToGraph[N];if(F!=R){for(var P=kot(I.sourceId,I.targetId,o),V=o.graphSet[P],z=0,m=o.layoutNodes[T];V.indexOf(m.id)===-1;)m=o.layoutNodes[o.idToIndex[m.parentId]],z++;for(m=o.layoutNodes[N];V.indexOf(m.id)===-1;)m=o.layoutNodes[o.idToIndex[m.parentId]],z++;A*=z*r.nestingFactor}I.idealLength=A,I.elasticity=D,o.layoutEdges.push(I)}return o},kot=function(t,n,r){var i=Eot(t,n,0,r);return 2>i.count?0:i.graph},Eot=function e(t,n,r,i){var s=i.graphSet[r];if(-1<s.indexOf(t)&&-1<s.indexOf(n))return{count:2,graph:r};for(var a=0,o=0;o<s.length;o++){var l=s[o],u=i.idToIndex[l],c=i.layoutNodes[u].children;if(c.length!==0){var f=i.indexToGraph[i.idToIndex[c[0]]],h=e(t,n,f,i);if(h.count!==0)if(h.count===1){if(a++,a===2)break}else return h}}return{count:a,graph:r}},Aot,Tot=function(t,n){for(var r=t.clientWidth,i=t.clientHeight,s=0;s<t.nodeSize;s++){var a=t.layoutNodes[s];a.children.length===0&&!a.isLocked&&(a.positionX=Math.random()*r,a.positionY=Math.random()*i)}},kEe=function(t,n,r){var i=t.boundingBox,s={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return n.boundingBox&&(r.forEach(function(a){var o=t.layoutNodes[t.idToIndex[a.data("id")]];s.x1=Math.min(s.x1,o.positionX),s.x2=Math.max(s.x2,o.positionX),s.y1=Math.min(s.y1,o.positionY),s.y2=Math.max(s.y2,o.positionY)}),s.w=s.x2-s.x1,s.h=s.y2-s.y1),function(a,o){var l=t.layoutNodes[t.idToIndex[a.data("id")]];if(n.boundingBox){var u=(l.positionX-s.x1)/s.w,c=(l.positionY-s.y1)/s.h;return{x:i.x1+u*i.w,y:i.y1+c*i.h}}else return{x:l.positionX,y:l.positionY}}},Dot=function(t,n,r){var i=r.layout,s=r.eles.nodes(),a=kEe(t,r,s);s.positions(a),t.ready!==!0&&(t.ready=!0,i.one("layoutready",r.ready),i.emit({type:"layoutready",layout:this}))},Iot=function(t,n,r){Not(t,n),Oot(t),Rot(t,n),Pot(t),Lot(t)},Not=function(t,n){for(var r=0;r<t.graphSet.length;r++)for(var i=t.graphSet[r],s=i.length,a=0;a<s;a++)for(var o=t.layoutNodes[t.idToIndex[i[a]]],l=a+1;l<s;l++){var u=t.layoutNodes[t.idToIndex[i[l]]];Mot(o,u,t,n)}},Ppe=function(t){return-t+2*t*Math.random()},Mot=function(t,n,r,i){var s=t.cmptId,a=n.cmptId;if(!(s!==a&&!r.isCompound)){var o=n.positionX-t.positionX,l=n.positionY-t.positionY,u=1;o===0&&l===0&&(o=Ppe(u),l=Ppe(u));var c=Fot(t,n,o,l);if(c>0)var f=i.nodeOverlap*c,h=Math.sqrt(o*o+l*l),d=f*o/h,p=f*l/h;else var g=h5(t,o,l),m=h5(n,-1*o,-1*l),v=m.x-g.x,y=m.y-g.y,b=v*v+y*y,h=Math.sqrt(b),f=(t.nodeRepulsion+n.nodeRepulsion)/b,d=f*v/h,p=f*y/h;t.isLocked||(t.offsetX-=d,t.offsetY-=p),n.isLocked||(n.offsetX+=d,n.offsetY+=p)}},Fot=function(t,n,r,i){if(r>0)var s=t.maxX-n.minX;else var s=n.maxX-t.minX;if(i>0)var a=t.maxY-n.minY;else var a=n.maxY-t.minY;return s>=0&&a>=0?Math.sqrt(s*s+a*a):0},h5=function(t,n,r){var i=t.positionX,s=t.positionY,a=t.height||1,o=t.width||1,l=r/n,u=a/o,c={};return n===0&&0<r||n===0&&0>r?(c.x=i,c.y=s+a/2,c):0<n&&-1*u<=l&&l<=u?(c.x=i+o/2,c.y=s+o*r/2/n,c):0>n&&-1*u<=l&&l<=u?(c.x=i-o/2,c.y=s-o*r/2/n,c):0<r&&(l<=-1*u||l>=u)?(c.x=i+a*n/2/r,c.y=s+a/2,c):(0>r&&(l<=-1*u||l>=u)&&(c.x=i-a*n/2/r,c.y=s-a/2),c)},Oot=function(t,n){for(var r=0;r<t.edgeSize;r++){var i=t.layoutEdges[r],s=t.idToIndex[i.sourceId],a=t.layoutNodes[s],o=t.idToIndex[i.targetId],l=t.layoutNodes[o],u=l.positionX-a.positionX,c=l.positionY-a.positionY;if(!(u===0&&c===0)){var f=h5(a,u,c),h=h5(l,-1*u,-1*c),d=h.x-f.x,p=h.y-f.y,g=Math.sqrt(d*d+p*p),m=Math.pow(i.idealLength-g,2)/i.elasticity;if(g!==0)var v=m*d/g,y=m*p/g;else var v=0,y=0;a.isLocked||(a.offsetX+=v,a.offsetY+=y),l.isLocked||(l.offsetX-=v,l.offsetY-=y)}}},Rot=function(t,n){if(n.gravity!==0)for(var r=1,i=0;i<t.graphSet.length;i++){var s=t.graphSet[i],a=s.length;if(i===0)var o=t.clientHeight/2,l=t.clientWidth/2;else var u=t.layoutNodes[t.idToIndex[s[0]]],c=t.layoutNodes[t.idToIndex[u.parentId]],o=c.positionX,l=c.positionY;for(var f=0;f<a;f++){var h=t.layoutNodes[t.idToIndex[s[f]]];if(!h.isLocked){var d=o-h.positionX,p=l-h.positionY,g=Math.sqrt(d*d+p*p);if(g>r){var m=n.gravity*d/g,v=n.gravity*p/g;h.offsetX+=m,h.offsetY+=v}}}}},Pot=function(t,n){var r=[],i=0,s=-1;for(r.push.apply(r,t.graphSet[0]),s+=t.graphSet[0].length;i<=s;){var a=r[i++],o=t.idToIndex[a],l=t.layoutNodes[o],u=l.children;if(0<u.length&&!l.isLocked){for(var c=l.offsetX,f=l.offsetY,h=0;h<u.length;h++){var d=t.layoutNodes[t.idToIndex[u[h]]];d.offsetX+=c,d.offsetY+=f,r[++s]=u[h]}l.offsetX=0,l.offsetY=0}}},Lot=function(t,n){for(var r=0;r<t.nodeSize;r++){var i=t.layoutNodes[r];0<i.children.length&&(i.maxX=void 0,i.minX=void 0,i.maxY=void 0,i.minY=void 0)}for(var r=0;r<t.nodeSize;r++){var i=t.layoutNodes[r];if(!(0<i.children.length||i.isLocked)){var s=Bot(i.offsetX,i.offsetY,t.temperature);i.positionX+=s.x,i.positionY+=s.y,i.offsetX=0,i.offsetY=0,i.minX=i.positionX-i.width,i.maxX=i.positionX+i.width,i.minY=i.positionY-i.height,i.maxY=i.positionY+i.height,zot(i,t)}}for(var r=0;r<t.nodeSize;r++){var i=t.layoutNodes[r];0<i.children.length&&!i.isLocked&&(i.positionX=(i.maxX+i.minX)/2,i.positionY=(i.maxY+i.minY)/2,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY)}},Bot=function(t,n,r){var i=Math.sqrt(t*t+n*n);if(i>r)var s={x:r*t/i,y:r*n/i};else var s={x:t,y:n};return s},zot=function e(t,n){var r=t.parentId;if(r!=null){var i=n.layoutNodes[n.idToIndex[r]],s=!1;if((i.maxX==null||t.maxX+i.padRight>i.maxX)&&(i.maxX=t.maxX+i.padRight,s=!0),(i.minX==null||t.minX-i.padLeft<i.minX)&&(i.minX=t.minX-i.padLeft,s=!0),(i.maxY==null||t.maxY+i.padBottom>i.maxY)&&(i.maxY=t.maxY+i.padBottom,s=!0),(i.minY==null||t.minY-i.padTop<i.minY)&&(i.minY=t.minY-i.padTop,s=!0),s)return e(i,n)}},Lpe=function(t,n){for(var r=t.layoutNodes,i=[],s=0;s<r.length;s++){var a=r[s],o=a.cmptId,l=i[o]=i[o]||[];l.push(a)}for(var u=0,s=0;s<i.length;s++){var c=i[s];if(!!c){c.x1=1/0,c.x2=-1/0,c.y1=1/0,c.y2=-1/0;for(var f=0;f<c.length;f++){var h=c[f];c.x1=Math.min(c.x1,h.positionX-h.width/2),c.x2=Math.max(c.x2,h.positionX+h.width/2),c.y1=Math.min(c.y1,h.positionY-h.height/2),c.y2=Math.max(c.y2,h.positionY+h.height/2)}c.w=c.x2-c.x1,c.h=c.y2-c.y1,u+=c.w*c.h}}i.sort(function(y,b){return b.w*b.h-y.w*y.h});for(var d=0,p=0,g=0,m=0,v=Math.sqrt(u)*t.clientWidth/t.clientHeight,s=0;s<i.length;s++){var c=i[s];if(!!c){for(var f=0;f<c.length;f++){var h=c[f];h.isLocked||(h.positionX+=d-c.x1,h.positionY+=p-c.y1)}d+=c.w+n.componentSpacing,g+=c.w+n.componentSpacing,m=Math.max(m,c.h),g>v&&(p+=m+n.componentSpacing,d=0,g=0,m=0)}}},Uot={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(t){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,n){return!0},ready:void 0,stop:void 0,transform:function(t,n){return n}};function EEe(e){this.options=pt({},Uot,e)}EEe.prototype.run=function(){var e=this.options,t=e,n=e.cy,r=t.eles,i=r.nodes().not(":parent");t.sort&&(i=i.sort(t.sort));var s=il(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()});if(s.h===0||s.w===0)r.nodes().layoutPositions(this,t,function(G){return{x:s.x1,y:s.y1}});else{var a=i.size(),o=Math.sqrt(a*s.h/s.w),l=Math.round(o),u=Math.round(s.w/s.h*o),c=function(K){if(K==null)return Math.min(l,u);var Y=Math.min(l,u);Y==l?l=K:u=K},f=function(K){if(K==null)return Math.max(l,u);var Y=Math.max(l,u);Y==l?l=K:u=K},h=t.rows,d=t.cols!=null?t.cols:t.columns;if(h!=null&&d!=null)l=h,u=d;else if(h!=null&&d==null)l=h,u=Math.ceil(a/l);else if(h==null&&d!=null)u=d,l=Math.ceil(a/u);else if(u*l>a){var p=c(),g=f();(p-1)*g>=a?c(p-1):(g-1)*p>=a&&f(g-1)}else for(;u*l<a;){var m=c(),v=f();(v+1)*m>=a?f(v+1):c(m+1)}var y=s.w/u,b=s.h/l;if(t.condense&&(y=0,b=0),t.avoidOverlap)for(var x=0;x<i.length;x++){var w=i[x],C=w._private.position;(C.x==null||C.y==null)&&(C.x=0,C.y=0);var $=w.layoutDimensions(t),_=t.avoidOverlapPadding,k=$.w+_,E=$.h+_;y=Math.max(y,k),b=Math.max(b,E)}for(var S={},I=function(K,Y){return!!S["c-"+K+"-"+Y]},A=function(K,Y){S["c-"+K+"-"+Y]=!0},D=0,T=0,N=function(){T++,T>=u&&(T=0,D++)},F={},R=0;R<i.length;R++){var P=i[R],V=t.position(P);if(V&&(V.row!==void 0||V.col!==void 0)){var z={row:V.row,col:V.col};if(z.col===void 0)for(z.col=0;I(z.row,z.col);)z.col++;else if(z.row===void 0)for(z.row=0;I(z.row,z.col);)z.row++;F[P.id()]=z,A(z.row,z.col)}}var q=function(K,Y){var te,Z;if(K.locked()||K.isParent())return!1;var ae=F[K.id()];if(ae)te=ae.col*y+y/2+s.x1,Z=ae.row*b+b/2+s.y1;else{for(;I(D,T);)N();te=T*y+y/2+s.x1,Z=D*b+b/2+s.y1,A(D,T),N()}return{x:te,y:Z}};i.layoutPositions(this,t,q)}return this};var Wot={ready:function(){},stop:function(){}};function zee(e){this.options=pt({},Wot,e)}zee.prototype.run=function(){var e=this.options,t=e.eles,n=this;return e.cy,n.emit("layoutstart"),t.nodes().positions(function(){return{x:0,y:0}}),n.one("layoutready",e.ready),n.emit("layoutready"),n.one("layoutstop",e.stop),n.emit("layoutstop"),this};zee.prototype.stop=function(){return this};var Vot={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,n){return!0},ready:void 0,stop:void 0,transform:function(t,n){return n}};function AEe(e){this.options=pt({},Vot,e)}AEe.prototype.run=function(){var e=this.options,t=e.eles,n=t.nodes(),r=zr(e.positions);function i(s){if(e.positions==null)return tst(s.position());if(r)return e.positions(s);var a=e.positions[s._private.data.id];return a==null?null:a}return n.layoutPositions(this,e,function(s,a){var o=i(s);return s.locked()||o==null?!1:o}),this};var jot={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,n){return!0},ready:void 0,stop:void 0,transform:function(t,n){return n}};function TEe(e){this.options=pt({},jot,e)}TEe.prototype.run=function(){var e=this.options,t=e.cy,n=e.eles,r=il(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),i=function(a,o){return{x:r.x1+Math.round(Math.random()*r.w),y:r.y1+Math.round(Math.random()*r.h)}};return n.nodes().layoutPositions(this,e,i),this};var Hot=[{name:"breadthfirst",impl:CEe},{name:"circle",impl:_Ee},{name:"concentric",impl:SEe},{name:"cose",impl:x8},{name:"grid",impl:EEe},{name:"null",impl:zee},{name:"preset",impl:AEe},{name:"random",impl:TEe}];function DEe(e){this.options=e,this.notifications=0}var Bpe=function(){},zpe=function(){throw new Error("A headless instance can not render images")};DEe.prototype={recalculateRenderedStyle:Bpe,notify:function(){this.notifications++},init:Bpe,isHeadless:function(){return!0},png:zpe,jpg:zpe};var Uee={};Uee.arrowShapeWidth=.3;Uee.registerArrowShapes=function(){var e=this.arrowShapes={},t=this,n=function(u,c,f,h,d,p,g){var m=d.x-f/2-g,v=d.x+f/2+g,y=d.y-f/2-g,b=d.y+f/2+g,x=m<=u&&u<=v&&y<=c&&c<=b;return x},r=function(u,c,f,h,d){var p=u*Math.cos(h)-c*Math.sin(h),g=u*Math.sin(h)+c*Math.cos(h),m=p*f,v=g*f,y=m+d.x,b=v+d.y;return{x:y,y:b}},i=function(u,c,f,h){for(var d=[],p=0;p<u.length;p+=2){var g=u[p],m=u[p+1];d.push(r(g,m,c,f,h))}return d},s=function(u){for(var c=[],f=0;f<u.length;f++){var h=u[f];c.push(h.x,h.y)}return c},a=function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").pfValue*2},o=function(u,c){rt(c)&&(c=e[c]),e[u]=pt({name:u,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(h,d,p,g,m,v){var y=s(i(this.points,p+2*v,g,m)),b=Lo(h,d,y);return b},roughCollide:n,draw:function(h,d,p,g){var m=i(this.points,d,p,g);t.arrowShapeImpl("polygon")(h,m)},spacing:function(h){return 0},gap:a},c)};o("none",{collide:l5,roughCollide:l5,draw:Tee,spacing:tpe,gap:tpe}),o("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),o("arrow","triangle"),o("triangle-backcurve",{points:e.triangle.points,controlPoint:[0,-.15],roughCollide:n,draw:function(u,c,f,h,d){var p=i(this.points,c,f,h),g=this.controlPoint,m=r(g[0],g[1],c,f,h);t.arrowShapeImpl(this.name)(u,p,m)},gap:function(u){return a(u)*.8}}),o("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(u,c,f,h,d,p,g){var m=s(i(this.points,f+2*g,h,d)),v=s(i(this.pointsTee,f+2*g,h,d)),y=Lo(u,c,m)||Lo(u,c,v);return y},draw:function(u,c,f,h,d){var p=i(this.points,c,f,h),g=i(this.pointsTee,c,f,h);t.arrowShapeImpl(this.name)(u,p,g)}}),o("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(u,c,f,h,d,p,g){var m=d,v=Math.pow(m.x-u,2)+Math.pow(m.y-c,2)<=Math.pow((f+2*g)*this.radius,2),y=s(i(this.points,f+2*g,h,d));return Lo(u,c,y)||v},draw:function(u,c,f,h,d){var p=i(this.pointsTr,c,f,h);t.arrowShapeImpl(this.name)(u,p,h.x,h.y,this.radius*c)},spacing:function(u){return t.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),o("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(u,c){var f=this.baseCrossLinePts.slice(),h=c/u,d=3,p=5;return f[d]=f[d]-h,f[p]=f[p]-h,f},collide:function(u,c,f,h,d,p,g){var m=s(i(this.points,f+2*g,h,d)),v=s(i(this.crossLinePts(f,p),f+2*g,h,d)),y=Lo(u,c,m)||Lo(u,c,v);return y},draw:function(u,c,f,h,d){var p=i(this.points,c,f,h),g=i(this.crossLinePts(c,d),c,f,h);t.arrowShapeImpl(this.name)(u,p,g)}}),o("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(u){return a(u)*.525}}),o("circle",{radius:.15,collide:function(u,c,f,h,d,p,g){var m=d,v=Math.pow(m.x-u,2)+Math.pow(m.y-c,2)<=Math.pow((f+2*g)*this.radius,2);return v},draw:function(u,c,f,h,d){t.arrowShapeImpl(this.name)(u,h.x,h.y,this.radius*c)},spacing:function(u){return t.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),o("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(u){return 1},gap:function(u){return 1}}),o("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),o("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}}),o("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(u){return .95*u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}})};var Ob={};Ob.projectIntoViewport=function(e,t){var n=this.cy,r=this.findContainerClientCoords(),i=r[0],s=r[1],a=r[4],o=n.pan(),l=n.zoom(),u=((e-i)/a-o.x)/l,c=((t-s)/a-o.y)/l;return[u,c]};Ob.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var e=this.container,t=e.getBoundingClientRect(),n=_r.getComputedStyle(e),r=function(v){return parseFloat(n.getPropertyValue(v))},i={left:r("padding-left"),right:r("padding-right"),top:r("padding-top"),bottom:r("padding-bottom")},s={left:r("border-left-width"),right:r("border-right-width"),top:r("border-top-width"),bottom:r("border-bottom-width")},a=e.clientWidth,o=e.clientHeight,l=i.left+i.right,u=i.top+i.bottom,c=s.left+s.right,f=t.width/(a+c),h=a-l,d=o-u,p=t.left+i.left+s.left,g=t.top+i.top+s.top;return this.containerBB=[p,g,h,d,f]};Ob.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Ob.findNearestElement=function(e,t,n,r){return this.findNearestElements(e,t,n,r)[0]};Ob.findNearestElements=function(e,t,n,r){var i=this,s=this,a=s.getCachedZSortedEles(),o=[],l=s.cy.zoom(),u=s.cy.hasCompoundNodes(),c=(r?24:8)/l,f=(r?8:2)/l,h=(r?8:2)/l,d=1/0,p,g;n&&(a=a.interactive);function m($,_){if($.isNode()){if(g)return;g=$,o.push($)}if($.isEdge()&&(_==null||_<d))if(p){if(p.pstyle("z-compound-depth").value===$.pstyle("z-compound-depth").value&&p.pstyle("z-compound-depth").value===$.pstyle("z-compound-depth").value){for(var k=0;k<o.length;k++)if(o[k].isEdge()){o[k]=$,p=$,d=_!=null?_:d;break}}}else o.push($),p=$,d=_!=null?_:d}function v($){var _=$.outerWidth()+2*f,k=$.outerHeight()+2*f,E=_/2,S=k/2,I=$.position();if(I.x-E<=e&&e<=I.x+E&&I.y-S<=t&&t<=I.y+S){var A=s.nodeShapes[i.getNodeShape($)];if(A.checkPoint(e,t,0,_,k,I.x,I.y))return m($,0),!0}}function y($){var _=$._private,k=_.rscratch,E=$.pstyle("width").pfValue,S=$.pstyle("arrow-scale").value,I=E/2+c,A=I*I,D=I*2,R=_.source,P=_.target,T;if(k.edgeType==="segments"||k.edgeType==="straight"||k.edgeType==="haystack"){for(var N=k.allpts,F=0;F+3<N.length;F+=2)if(pst(e,t,N[F],N[F+1],N[F+2],N[F+3],D)&&A>(T=bst(e,t,N[F],N[F+1],N[F+2],N[F+3])))return m($,T),!0}else if(k.edgeType==="bezier"||k.edgeType==="multibezier"||k.edgeType==="self"||k.edgeType==="compound"){for(var N=k.allpts,F=0;F+5<k.allpts.length;F+=4)if(gst(e,t,N[F],N[F+1],N[F+2],N[F+3],N[F+4],N[F+5],D)&&A>(T=yst(e,t,N[F],N[F+1],N[F+2],N[F+3],N[F+4],N[F+5])))return m($,T),!0}for(var R=R||_.source,P=P||_.target,V=i.getArrowWidth(E,S),z=[{name:"source",x:k.arrowStartX,y:k.arrowStartY,angle:k.srcArrowAngle},{name:"target",x:k.arrowEndX,y:k.arrowEndY,angle:k.tgtArrowAngle},{name:"mid-source",x:k.midX,y:k.midY,angle:k.midsrcArrowAngle},{name:"mid-target",x:k.midX,y:k.midY,angle:k.midtgtArrowAngle}],F=0;F<z.length;F++){var q=z[F],G=s.arrowShapes[$.pstyle(q.name+"-arrow-shape").value],K=$.pstyle("width").pfValue;if(G.roughCollide(e,t,V,q.angle,{x:q.x,y:q.y},K,c)&&G.collide(e,t,V,q.angle,{x:q.x,y:q.y},K,c))return m($),!0}u&&o.length>0&&(v(R),v(P))}function b($,_,k){return gc($,_,k)}function x($,_){var k=$._private,E=h,S;_?S=_+"-":S="",$.boundingBox();var I=k.labelBounds[_||"main"],A=$.pstyle(S+"label").value,D=$.pstyle("text-events").strValue==="yes";if(!(!D||!A)){var T=b(k.rscratch,"labelX",_),N=b(k.rscratch,"labelY",_),F=b(k.rscratch,"labelAngle",_),R=$.pstyle(S+"text-margin-x").pfValue,P=$.pstyle(S+"text-margin-y").pfValue,V=I.x1-E-R,z=I.x2+E-R,q=I.y1-E-P,G=I.y2+E-P;if(F){var K=Math.cos(F),Y=Math.sin(F),te=function(ue,X){return ue=ue-T,X=X-N,{x:ue*K-X*Y+T,y:ue*Y+X*K+N}},Z=te(V,q),ae=te(V,G),O=te(z,q),L=te(z,G),W=[Z.x+R,Z.y+P,O.x+R,O.y+P,L.x+R,L.y+P,ae.x+R,ae.y+P];if(Lo(e,t,W))return m($),!0}else if(kw(I,e,t))return m($),!0}}for(var w=a.length-1;w>=0;w--){var C=a[w];C.isNode()?v(C)||x(C):y(C)||x(C)||x(C,"source")||x(C,"target")}return o};Ob.getAllInBox=function(e,t,n,r){var i=this.getCachedZSortedEles().interactive,s=[],a=Math.min(e,n),o=Math.max(e,n),l=Math.min(t,r),u=Math.max(t,r);e=a,n=o,t=l,r=u;for(var c=il({x1:e,y1:t,x2:n,y2:r}),f=0;f<i.length;f++){var h=i[f];if(h.isNode()){var d=h,p=d.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});Nee(c,p)&&!jke(p,c)&&s.push(d)}else{var g=h,m=g._private,v=m.rscratch;if(v.startX!=null&&v.startY!=null&&!kw(c,v.startX,v.startY)||v.endX!=null&&v.endY!=null&&!kw(c,v.endX,v.endY))continue;if(v.edgeType==="bezier"||v.edgeType==="multibezier"||v.edgeType==="self"||v.edgeType==="compound"||v.edgeType==="segments"||v.edgeType==="haystack"){for(var y=m.rstyle.bezierPts||m.rstyle.linePts||m.rstyle.haystackPts,b=!0,x=0;x<y.length;x++)if(!dst(c,y[x])){b=!1;break}b&&s.push(g)}else(v.edgeType==="haystack"||v.edgeType==="straight")&&s.push(g)}}return s};var d5={};d5.calculateArrowAngles=function(e){var t=e._private.rscratch,n=t.edgeType==="haystack",r=t.edgeType==="bezier",i=t.edgeType==="multibezier",s=t.edgeType==="segments",a=t.edgeType==="compound",o=t.edgeType==="self",l,u,c,f,h,d,v,y;if(n?(c=t.haystackPts[0],f=t.haystackPts[1],h=t.haystackPts[2],d=t.haystackPts[3]):(c=t.arrowStartX,f=t.arrowStartY,h=t.arrowEndX,d=t.arrowEndY),v=t.midX,y=t.midY,s)l=c-t.segpts[0],u=f-t.segpts[1];else if(i||a||o||r){var p=t.allpts,g=Xi(p[0],p[2],p[4],.1),m=Xi(p[1],p[3],p[5],.1);l=c-g,u=f-m}else l=c-v,u=f-y;t.srcArrowAngle=WF(l,u);var v=t.midX,y=t.midY;if(n&&(v=(c+h)/2,y=(f+d)/2),l=h-c,u=d-f,s){var p=t.allpts;if(p.length/2%2===0){var b=p.length/2,x=b-2;l=p[b]-p[x],u=p[b+1]-p[x+1]}else{var b=p.length/2-1,x=b-2,w=b+2;l=p[b]-p[x],u=p[b+1]-p[x+1]}}else if(i||a||o){var p=t.allpts,C=t.ctrlpts,$,_,k,E;if(C.length/2%2===0){var S=p.length/2-1,I=S+2,A=I+2;$=Xi(p[S],p[I],p[A],0),_=Xi(p[S+1],p[I+1],p[A+1],0),k=Xi(p[S],p[I],p[A],1e-4),E=Xi(p[S+1],p[I+1],p[A+1],1e-4)}else{var I=p.length/2-1,S=I-2,A=I+2;$=Xi(p[S],p[I],p[A],.4999),_=Xi(p[S+1],p[I+1],p[A+1],.4999),k=Xi(p[S],p[I],p[A],.5),E=Xi(p[S+1],p[I+1],p[A+1],.5)}l=k-$,u=E-_}if(t.midtgtArrowAngle=WF(l,u),t.midDispX=l,t.midDispY=u,l*=-1,u*=-1,s){var p=t.allpts;if(p.length/2%2!==0){var b=p.length/2-1,w=b+2;l=-(p[w]-p[b]),u=-(p[w+1]-p[b+1])}}if(t.midsrcArrowAngle=WF(l,u),s)l=h-t.segpts[t.segpts.length-2],u=d-t.segpts[t.segpts.length-1];else if(i||a||o||r){var p=t.allpts,D=p.length,g=Xi(p[D-6],p[D-4],p[D-2],.9),m=Xi(p[D-5],p[D-3],p[D-1],.9);l=h-g,u=d-m}else l=h-v,u=d-y;t.tgtArrowAngle=WF(l,u)};d5.getArrowWidth=d5.getArrowHeight=function(e,t){var n=this.arrowWidthCache=this.arrowWidthCache||{},r=n[e+", "+t];return r||(r=Math.max(Math.pow(e*13.37,.9),29)*t,n[e+", "+t]=r,r)};var _o={};_o.findHaystackPoints=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=n._private,i=r.rscratch;if(!i.haystack){var s=Math.random()*2*Math.PI;i.source={x:Math.cos(s),y:Math.sin(s)},s=Math.random()*2*Math.PI,i.target={x:Math.cos(s),y:Math.sin(s)}}var a=r.source,o=r.target,l=a.position(),u=o.position(),c=a.width(),f=o.width(),h=a.height(),d=o.height(),p=n.pstyle("haystack-radius").value,g=p/2;i.haystackPts=i.allpts=[i.source.x*c*g+l.x,i.source.y*h*g+l.y,i.target.x*f*g+u.x,i.target.y*d*g+u.y],i.midX=(i.allpts[0]+i.allpts[2])/2,i.midY=(i.allpts[1]+i.allpts[3])/2,i.edgeType="haystack",i.haystack=!0,this.storeEdgeProjections(n),this.calculateArrowAngles(n),this.recalculateEdgeLabelProjections(n),this.calculateLabelAngles(n)}};_o.findSegmentsPoints=function(e,t){var n=e._private.rscratch,r=t.posPts,i=t.intersectionPts,s=t.vectorNormInverse,a=e.pstyle("edge-distances").value,o=e.pstyle("segment-weights"),l=e.pstyle("segment-distances"),u=Math.min(o.pfValue.length,l.pfValue.length);n.edgeType="segments",n.segpts=[];for(var c=0;c<u;c++){var f=o.pfValue[c],h=l.pfValue[c],d=1-f,p=f,g=a==="node-position"?r:i,m={x:g.x1*d+g.x2*p,y:g.y1*d+g.y2*p};n.segpts.push(m.x+s.x*h,m.y+s.y*h)}};_o.findLoopPoints=function(e,t,n,r){var i=e._private.rscratch,s=t.dirCounts,a=t.srcPos,o=e.pstyle("control-point-distances"),l=o?o.pfValue[0]:void 0,u=e.pstyle("loop-direction").pfValue,c=e.pstyle("loop-sweep").pfValue,f=e.pstyle("control-point-step-size").pfValue;i.edgeType="self";var h=n,d=f;r&&(h=0,d=l);var p=u-Math.PI/2,g=p-c/2,m=p+c/2,v=String(u+"_"+c);h=s[v]===void 0?s[v]=0:++s[v],i.ctrlpts=[a.x+Math.cos(g)*1.4*d*(h/3+1),a.y+Math.sin(g)*1.4*d*(h/3+1),a.x+Math.cos(m)*1.4*d*(h/3+1),a.y+Math.sin(m)*1.4*d*(h/3+1)]};_o.findCompoundLoopPoints=function(e,t,n,r){var i=e._private.rscratch;i.edgeType="compound";var s=t.srcPos,a=t.tgtPos,o=t.srcW,l=t.srcH,u=t.tgtW,c=t.tgtH,f=e.pstyle("control-point-step-size").pfValue,h=e.pstyle("control-point-distances"),d=h?h.pfValue[0]:void 0,p=n,g=f;r&&(p=0,g=d);var m=50,v={x:s.x-o/2,y:s.y-l/2},y={x:a.x-u/2,y:a.y-c/2},b={x:Math.min(v.x,y.x),y:Math.min(v.y,y.y)},x=.5,w=Math.max(x,Math.log(o*.01)),C=Math.max(x,Math.log(u*.01));i.ctrlpts=[b.x,b.y-(1+Math.pow(m,1.12)/100)*g*(p/3+1)*w,b.x-(1+Math.pow(m,1.12)/100)*g*(p/3+1)*C,b.y]};_o.findStraightEdgePoints=function(e){e._private.rscratch.edgeType="straight"};_o.findBezierPoints=function(e,t,n,r,i){var s=e._private.rscratch,a=t.vectorNormInverse,o=t.posPts,l=t.intersectionPts,u=e.pstyle("edge-distances").value,c=e.pstyle("control-point-step-size").pfValue,f=e.pstyle("control-point-distances"),h=e.pstyle("control-point-weights"),d=f&&h?Math.min(f.value.length,h.value.length):1,p=f?f.pfValue[0]:void 0,g=h.value[0],m=r;s.edgeType=m?"multibezier":"bezier",s.ctrlpts=[];for(var v=0;v<d;v++){var y=(.5-t.eles.length/2+n)*c*(i?-1:1),b=void 0,x=Vke(y);m&&(p=f?f.pfValue[v]:c,g=h.value[v]),r?b=p:b=p!==void 0?x*p:void 0;var w=b!==void 0?b:y,C=1-g,$=g,_=u==="node-position"?o:l,k={x:_.x1*C+_.x2*$,y:_.y1*C+_.y2*$};s.ctrlpts.push(k.x+a.x*w,k.y+a.y*w)}};_o.findTaxiPoints=function(e,t){var n=e._private.rscratch;n.edgeType="segments";var r="vertical",i="horizontal",s="leftward",a="rightward",o="downward",l="upward",u="auto",c=t.posPts,f=t.srcW,h=t.srcH,d=t.tgtW,p=t.tgtH,g=e.pstyle("edge-distances").value,m=g!=="node-position",v=e.pstyle("taxi-direction").value,y=v,b=e.pstyle("taxi-turn"),x=b.units==="%",w=b.pfValue,C=w<0,$=e.pstyle("taxi-turn-min-distance").pfValue,_=m?(f+d)/2:0,k=m?(h+p)/2:0,E=c.x2-c.x1,S=c.y2-c.y1,I=function(Ve,Xt){return Ve>0?Math.max(Ve-Xt,0):Math.min(Ve+Xt,0)},A=I(E,_),D=I(S,k),T=!1;y===u?v=Math.abs(A)>Math.abs(D)?i:r:y===l||y===o?(v=r,T=!0):(y===s||y===a)&&(v=i,T=!0);var N=v===r,F=N?D:A,R=N?S:E,P=Vke(R),V=!1;!(T&&(x||C))&&(y===o&&R<0||y===l&&R>0||y===s&&R>0||y===a&&R<0)&&(P*=-1,F=P*Math.abs(F),V=!0);var z;if(x){var q=w<0?1+w:w;z=q*F}else{var G=w<0?F:0;z=G+w*P}var K=function(Ve){return Math.abs(Ve)<$||Math.abs(Ve)>=Math.abs(F)},Y=K(z),te=K(Math.abs(F)-Math.abs(z)),Z=Y||te;if(Z&&!V)if(N){var ae=Math.abs(R)<=h/2,O=Math.abs(E)<=d/2;if(ae){var L=(c.x1+c.x2)/2,W=c.y1,M=c.y2;n.segpts=[L,W,L,M]}else if(O){var ue=(c.y1+c.y2)/2,X=c.x1,se=c.x2;n.segpts=[X,ue,se,ue]}else n.segpts=[c.x1,c.y2]}else{var oe=Math.abs(R)<=f/2,pe=Math.abs(S)<=p/2;if(oe){var Ce=(c.y1+c.y2)/2,ze=c.x1,et=c.x2;n.segpts=[ze,Ce,et,Ce]}else if(pe){var dt=(c.x1+c.x2)/2,He=c.y1,Se=c.y2;n.segpts=[dt,He,dt,Se]}else n.segpts=[c.x2,c.y1]}else if(N){var j=c.y1+z+(m?h/2*P:0),fe=c.x1,_e=c.x2;n.segpts=[fe,j,_e,j]}else{var ve=c.x1+z+(m?f/2*P:0),ye=c.y1,yt=c.y2;n.segpts=[ve,ye,ve,yt]}};_o.tryToCorrectInvalidPoints=function(e,t){var n=e._private.rscratch;if(n.edgeType==="bezier"){var r=t.srcPos,i=t.tgtPos,s=t.srcW,a=t.srcH,o=t.tgtW,l=t.tgtH,u=t.srcShape,c=t.tgtShape,f=!Pe(n.startX)||!Pe(n.startY),h=!Pe(n.arrowStartX)||!Pe(n.arrowStartY),d=!Pe(n.endX)||!Pe(n.endY),p=!Pe(n.arrowEndX)||!Pe(n.arrowEndY),g=3,m=this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth,v=g*m,y=ky({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.startX,y:n.startY}),b=y<v,x=ky({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.endX,y:n.endY}),w=x<v,C=!1;if(f||h||b){C=!0;var $={x:n.ctrlpts[0]-r.x,y:n.ctrlpts[1]-r.y},_=Math.sqrt($.x*$.x+$.y*$.y),k={x:$.x/_,y:$.y/_},E=Math.max(s,a),S={x:n.ctrlpts[0]+k.x*2*E,y:n.ctrlpts[1]+k.y*2*E},I=u.intersectLine(r.x,r.y,s,a,S.x,S.y,0);b?(n.ctrlpts[0]=n.ctrlpts[0]+k.x*(v-y),n.ctrlpts[1]=n.ctrlpts[1]+k.y*(v-y)):(n.ctrlpts[0]=I[0]+k.x*v,n.ctrlpts[1]=I[1]+k.y*v)}if(d||p||w){C=!0;var A={x:n.ctrlpts[0]-i.x,y:n.ctrlpts[1]-i.y},D=Math.sqrt(A.x*A.x+A.y*A.y),T={x:A.x/D,y:A.y/D},N=Math.max(s,a),F={x:n.ctrlpts[0]+T.x*2*N,y:n.ctrlpts[1]+T.y*2*N},R=c.intersectLine(i.x,i.y,o,l,F.x,F.y,0);w?(n.ctrlpts[0]=n.ctrlpts[0]+T.x*(v-x),n.ctrlpts[1]=n.ctrlpts[1]+T.y*(v-x)):(n.ctrlpts[0]=R[0]+T.x*v,n.ctrlpts[1]=R[1]+T.y*v)}C&&this.findEndpoints(e)}};_o.storeAllpts=function(e){var t=e._private.rscratch;if(t.edgeType==="multibezier"||t.edgeType==="bezier"||t.edgeType==="self"||t.edgeType==="compound"){t.allpts=[],t.allpts.push(t.startX,t.startY);for(var n=0;n+1<t.ctrlpts.length;n+=2)t.allpts.push(t.ctrlpts[n],t.ctrlpts[n+1]),n+3<t.ctrlpts.length&&t.allpts.push((t.ctrlpts[n]+t.ctrlpts[n+2])/2,(t.ctrlpts[n+1]+t.ctrlpts[n+3])/2);t.allpts.push(t.endX,t.endY);var r,i;t.ctrlpts.length/2%2===0?(r=t.allpts.length/2-1,t.midX=t.allpts[r],t.midY=t.allpts[r+1]):(r=t.allpts.length/2-3,i=.5,t.midX=Xi(t.allpts[r],t.allpts[r+2],t.allpts[r+4],i),t.midY=Xi(t.allpts[r+1],t.allpts[r+3],t.allpts[r+5],i))}else if(t.edgeType==="straight")t.allpts=[t.startX,t.startY,t.endX,t.endY],t.midX=(t.startX+t.endX+t.arrowStartX+t.arrowEndX)/4,t.midY=(t.startY+t.endY+t.arrowStartY+t.arrowEndY)/4;else if(t.edgeType==="segments")if(t.allpts=[],t.allpts.push(t.startX,t.startY),t.allpts.push.apply(t.allpts,t.segpts),t.allpts.push(t.endX,t.endY),t.segpts.length%4===0){var s=t.segpts.length/2,a=s-2;t.midX=(t.segpts[a]+t.segpts[s])/2,t.midY=(t.segpts[a+1]+t.segpts[s+1])/2}else{var o=t.segpts.length/2-1;t.midX=t.segpts[o],t.midY=t.segpts[o+1]}};_o.checkForInvalidEdgeWarning=function(e){var t=e[0]._private.rscratch;t.nodesOverlap||Pe(t.startX)&&Pe(t.startY)&&Pe(t.endX)&&Pe(t.endY)?t.loggedErr=!1:t.loggedErr||(t.loggedErr=!0,Rn("Edge `"+e.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};_o.findEdgeControlPoints=function(e){var t=this;if(!(!e||e.length===0)){for(var n=this,r=n.cy,i=r.hasCompoundNodes(),s={map:new Xf,get:function($){var _=this.map.get($[0]);return _!=null?_.get($[1]):null},set:function($,_){var k=this.map.get($[0]);k==null&&(k=new Xf,this.map.set($[0],k)),k.set($[1],_)}},a=[],o=[],l=0;l<e.length;l++){var u=e[l],c=u._private,f=u.pstyle("curve-style").value;if(!(u.removed()||!u.takesUpSpace())){if(f==="haystack"){o.push(u);continue}var h=f==="unbundled-bezier"||f==="segments"||f==="straight"||f==="straight-triangle"||f==="taxi",d=f==="unbundled-bezier"||f==="bezier",p=c.source,g=c.target,m=p.poolIndex(),v=g.poolIndex(),y=[m,v].sort(),b=s.get(y);b==null&&(b={eles:[]},s.set(y,b),a.push(y)),b.eles.push(u),h&&(b.hasUnbundled=!0),d&&(b.hasBezier=!0)}}for(var x=function($){var _=a[$],k=s.get(_),E=void 0;if(!k.hasUnbundled){var S=k.eles[0].parallelEdges().filter(function(Se){return Se.isBundledBezier()});Dee(k.eles),S.forEach(function(Se){return k.eles.push(Se)}),k.eles.sort(function(Se,j){return Se.poolIndex()-j.poolIndex()})}var I=k.eles[0],A=I.source(),D=I.target();if(A.poolIndex()>D.poolIndex()){var T=A;A=D,D=T}var N=k.srcPos=A.position(),F=k.tgtPos=D.position(),R=k.srcW=A.outerWidth(),P=k.srcH=A.outerHeight(),V=k.tgtW=D.outerWidth(),z=k.tgtH=D.outerHeight(),q=k.srcShape=n.nodeShapes[t.getNodeShape(A)],G=k.tgtShape=n.nodeShapes[t.getNodeShape(D)];k.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var K=0;K<k.eles.length;K++){var Y=k.eles[K],te=Y[0]._private.rscratch,Z=Y.pstyle("curve-style").value,ae=Z==="unbundled-bezier"||Z==="segments"||Z==="taxi",O=!A.same(Y.source());if(!k.calculatedIntersection&&A!==D&&(k.hasBezier||k.hasUnbundled)){k.calculatedIntersection=!0;var L=q.intersectLine(N.x,N.y,R,P,F.x,F.y,0),W=k.srcIntn=L,M=G.intersectLine(F.x,F.y,V,z,N.x,N.y,0),ue=k.tgtIntn=M,X=k.intersectionPts={x1:L[0],x2:M[0],y1:L[1],y2:M[1]},se=k.posPts={x1:N.x,x2:F.x,y1:N.y,y2:F.y},oe=M[1]-L[1],pe=M[0]-L[0],Ce=Math.sqrt(pe*pe+oe*oe),ze=k.vector={x:pe,y:oe},et=k.vectorNorm={x:ze.x/Ce,y:ze.y/Ce},dt={x:-et.y,y:et.x};k.nodesOverlap=!Pe(Ce)||G.checkPoint(L[0],L[1],0,V,z,F.x,F.y)||q.checkPoint(M[0],M[1],0,R,P,N.x,N.y),k.vectorNormInverse=dt,E={nodesOverlap:k.nodesOverlap,dirCounts:k.dirCounts,calculatedIntersection:!0,hasBezier:k.hasBezier,hasUnbundled:k.hasUnbundled,eles:k.eles,srcPos:F,tgtPos:N,srcW:V,srcH:z,tgtW:R,tgtH:P,srcIntn:ue,tgtIntn:W,srcShape:G,tgtShape:q,posPts:{x1:se.x2,y1:se.y2,x2:se.x1,y2:se.y1},intersectionPts:{x1:X.x2,y1:X.y2,x2:X.x1,y2:X.y1},vector:{x:-ze.x,y:-ze.y},vectorNorm:{x:-et.x,y:-et.y},vectorNormInverse:{x:-dt.x,y:-dt.y}}}var He=O?E:k;te.nodesOverlap=He.nodesOverlap,te.srcIntn=He.srcIntn,te.tgtIntn=He.tgtIntn,i&&(A.isParent()||A.isChild()||D.isParent()||D.isChild())&&(A.parents().anySame(D)||D.parents().anySame(A)||A.same(D)&&A.isParent())?t.findCompoundLoopPoints(Y,He,K,ae):A===D?t.findLoopPoints(Y,He,K,ae):Z==="segments"?t.findSegmentsPoints(Y,He):Z==="taxi"?t.findTaxiPoints(Y,He):Z==="straight"||!ae&&k.eles.length%2===1&&K===Math.floor(k.eles.length/2)?t.findStraightEdgePoints(Y):t.findBezierPoints(Y,He,K,ae,O),t.findEndpoints(Y),t.tryToCorrectInvalidPoints(Y,He),t.checkForInvalidEdgeWarning(Y),t.storeAllpts(Y),t.storeEdgeProjections(Y),t.calculateArrowAngles(Y),t.recalculateEdgeLabelProjections(Y),t.calculateLabelAngles(Y)}},w=0;w<a.length;w++)x(w);this.findHaystackPoints(o)}};function IEe(e){var t=[];if(e!=null){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1];t.push({x:r,y:i})}return t}}_o.getSegmentPoints=function(e){var t=e[0]._private.rscratch,n=t.edgeType;if(n==="segments")return this.recalculateRenderedStyle(e),IEe(t.segpts)};_o.getControlPoints=function(e){var t=e[0]._private.rscratch,n=t.edgeType;if(n==="bezier"||n==="multibezier"||n==="self"||n==="compound")return this.recalculateRenderedStyle(e),IEe(t.ctrlpts)};_o.getEdgeMidpoint=function(e){var t=e[0]._private.rscratch;return this.recalculateRenderedStyle(e),{x:t.midX,y:t.midY}};var fI={};fI.manualEndptToPx=function(e,t){var n=this,r=e.position(),i=e.outerWidth(),s=e.outerHeight();if(t.value.length===2){var a=[t.pfValue[0],t.pfValue[1]];return t.units[0]==="%"&&(a[0]=a[0]*i),t.units[1]==="%"&&(a[1]=a[1]*s),a[0]+=r.x,a[1]+=r.y,a}else{var o=t.pfValue[0];o=-Math.PI/2+o;var l=2*Math.max(i,s),u=[r.x+Math.cos(o)*l,r.y+Math.sin(o)*l];return n.nodeShapes[this.getNodeShape(e)].intersectLine(r.x,r.y,i,s,u[0],u[1],0)}};fI.findEndpoints=function(e){var t=this,n,r=e.source()[0],i=e.target()[0],s=r.position(),a=i.position(),o=e.pstyle("target-arrow-shape").value,l=e.pstyle("source-arrow-shape").value,u=e.pstyle("target-distance-from-node").pfValue,c=e.pstyle("source-distance-from-node").pfValue,f=e.pstyle("curve-style").value,h=e._private.rscratch,d=h.edgeType,p=f==="taxi",g=d==="self"||d==="compound",m=d==="bezier"||d==="multibezier"||g,v=d!=="bezier",y=d==="straight"||d==="segments",b=d==="segments",x=m||v||y,w=g||p,C=e.pstyle("source-endpoint"),$=w?"outside-to-node":C.value,_=e.pstyle("target-endpoint"),k=w?"outside-to-node":_.value;h.srcManEndpt=C,h.tgtManEndpt=_;var E,S,I,A;if(m){var D=[h.ctrlpts[0],h.ctrlpts[1]],T=v?[h.ctrlpts[h.ctrlpts.length-2],h.ctrlpts[h.ctrlpts.length-1]]:D;E=T,S=D}else if(y){var N=b?h.segpts.slice(0,2):[a.x,a.y],F=b?h.segpts.slice(h.segpts.length-2):[s.x,s.y];E=F,S=N}if(k==="inside-to-node")n=[a.x,a.y];else if(_.units)n=this.manualEndptToPx(i,_);else if(k==="outside-to-line")n=h.tgtIntn;else if(k==="outside-to-node"||k==="outside-to-node-or-label"?I=E:(k==="outside-to-line"||k==="outside-to-line-or-label")&&(I=[s.x,s.y]),n=t.nodeShapes[this.getNodeShape(i)].intersectLine(a.x,a.y,i.outerWidth(),i.outerHeight(),I[0],I[1],0),k==="outside-to-node-or-label"||k==="outside-to-line-or-label"){var R=i._private.rscratch,P=R.labelWidth,V=R.labelHeight,z=R.labelX,q=R.labelY,G=P/2,K=V/2,Y=i.pstyle("text-valign").value;Y==="top"?q-=K:Y==="bottom"&&(q+=K);var te=i.pstyle("text-halign").value;te==="left"?z-=G:te==="right"&&(z+=G);var Z=tT(I[0],I[1],[z-G,q-K,z+G,q-K,z+G,q+K,z-G,q+K],a.x,a.y);if(Z.length>0){var ae=s,O=jv(ae,T2(n)),L=jv(ae,T2(Z)),W=O;if(L<O&&(n=Z,W=L),Z.length>2){var M=jv(ae,{x:Z[2],y:Z[3]});M<W&&(n=[Z[2],Z[3]])}}}var ue=VF(n,E,t.arrowShapes[o].spacing(e)+u),X=VF(n,E,t.arrowShapes[o].gap(e)+u);if(h.endX=X[0],h.endY=X[1],h.arrowEndX=ue[0],h.arrowEndY=ue[1],$==="inside-to-node")n=[s.x,s.y];else if(C.units)n=this.manualEndptToPx(r,C);else if($==="outside-to-line")n=h.srcIntn;else if($==="outside-to-node"||$==="outside-to-node-or-label"?A=S:($==="outside-to-line"||$==="outside-to-line-or-label")&&(A=[a.x,a.y]),n=t.nodeShapes[this.getNodeShape(r)].intersectLine(s.x,s.y,r.outerWidth(),r.outerHeight(),A[0],A[1],0),$==="outside-to-node-or-label"||$==="outside-to-line-or-label"){var se=r._private.rscratch,oe=se.labelWidth,pe=se.labelHeight,Ce=se.labelX,ze=se.labelY,et=oe/2,dt=pe/2,He=r.pstyle("text-valign").value;He==="top"?ze-=dt:He==="bottom"&&(ze+=dt);var Se=r.pstyle("text-halign").value;Se==="left"?Ce-=et:Se==="right"&&(Ce+=et);var j=tT(A[0],A[1],[Ce-et,ze-dt,Ce+et,ze-dt,Ce+et,ze+dt,Ce-et,ze+dt],s.x,s.y);if(j.length>0){var fe=a,_e=jv(fe,T2(n)),ve=jv(fe,T2(j)),ye=_e;if(ve<_e&&(n=[j[0],j[1]],ye=ve),j.length>2){var yt=jv(fe,{x:j[2],y:j[3]});yt<ye&&(n=[j[2],j[3]])}}}var Ae=VF(n,S,t.arrowShapes[l].spacing(e)+c),Ve=VF(n,S,t.arrowShapes[l].gap(e)+c);h.startX=Ve[0],h.startY=Ve[1],h.arrowStartX=Ae[0],h.arrowStartY=Ae[1],x&&(!Pe(h.startX)||!Pe(h.startY)||!Pe(h.endX)||!Pe(h.endY)?h.badLine=!0:h.badLine=!1)};fI.getSourceEndpoint=function(e){var t=e[0]._private.rscratch;switch(this.recalculateRenderedStyle(e),t.edgeType){case"haystack":return{x:t.haystackPts[0],y:t.haystackPts[1]};default:return{x:t.arrowStartX,y:t.arrowStartY}}};fI.getTargetEndpoint=function(e){var t=e[0]._private.rscratch;switch(this.recalculateRenderedStyle(e),t.edgeType){case"haystack":return{x:t.haystackPts[2],y:t.haystackPts[3]};default:return{x:t.arrowEndX,y:t.arrowEndY}}};var Wee={};function qot(e,t,n){for(var r=function(u,c,f,h){return Xi(u,c,f,h)},i=t._private,s=i.rstyle.bezierPts,a=0;a<e.bezierProjPcts.length;a++){var o=e.bezierProjPcts[a];s.push({x:r(n[0],n[2],n[4],o),y:r(n[1],n[3],n[5],o)})}}Wee.storeEdgeProjections=function(e){var t=e._private,n=t.rscratch,r=n.edgeType;if(t.rstyle.bezierPts=null,t.rstyle.linePts=null,t.rstyle.haystackPts=null,r==="multibezier"||r==="bezier"||r==="self"||r==="compound"){t.rstyle.bezierPts=[];for(var i=0;i+5<n.allpts.length;i+=4)qot(this,e,n.allpts.slice(i,i+6))}else if(r==="segments")for(var s=t.rstyle.linePts=[],i=0;i+1<n.allpts.length;i+=2)s.push({x:n.allpts[i],y:n.allpts[i+1]});else if(r==="haystack"){var a=n.haystackPts;t.rstyle.haystackPts=[{x:a[0],y:a[1]},{x:a[2],y:a[3]}]}t.rstyle.arrowWidth=this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth};Wee.recalculateEdgeProjections=function(e){this.findEdgeControlPoints(e)};var nd={};nd.recalculateNodeLabelProjection=function(e){var t=e.pstyle("label").strValue;if(!I0(t)){var n,r,i=e._private,s=e.width(),a=e.height(),o=e.padding(),l=e.position(),u=e.pstyle("text-halign").strValue,c=e.pstyle("text-valign").strValue,f=i.rscratch,h=i.rstyle;switch(u){case"left":n=l.x-s/2-o;break;case"right":n=l.x+s/2+o;break;default:n=l.x}switch(c){case"top":r=l.y-a/2-o;break;case"bottom":r=l.y+a/2+o;break;default:r=l.y}f.labelX=n,f.labelY=r,h.labelX=n,h.labelY=r,this.calculateLabelAngles(e),this.applyLabelDimensions(e)}};var NEe=function(t,n){var r=Math.atan(n/t);return t===0&&r<0&&(r=r*-1),r},MEe=function(t,n){var r=n.x-t.x,i=n.y-t.y;return NEe(r,i)},Got=function(t,n,r,i){var s=eT(0,i-.001,1),a=eT(0,i+.001,1),o=W2(t,n,r,s),l=W2(t,n,r,a);return MEe(o,l)};nd.recalculateEdgeLabelProjections=function(e){var t,n=e._private,r=n.rscratch,i=this,s={mid:e.pstyle("label").strValue,source:e.pstyle("source-label").strValue,target:e.pstyle("target-label").strValue};if(!!(s.mid||s.source||s.target)){t={x:r.midX,y:r.midY};var a=function(f,h,d){Ug(n.rscratch,f,h,d),Ug(n.rstyle,f,h,d)};a("labelX",null,t.x),a("labelY",null,t.y);var o=NEe(r.midDispX,r.midDispY);a("labelAutoAngle",null,o);var l=function c(){if(c.cache)return c.cache;for(var f=[],h=0;h+5<r.allpts.length;h+=4){var d={x:r.allpts[h],y:r.allpts[h+1]},p={x:r.allpts[h+2],y:r.allpts[h+3]},g={x:r.allpts[h+4],y:r.allpts[h+5]};f.push({p0:d,p1:p,p2:g,startDist:0,length:0,segments:[]})}var m=n.rstyle.bezierPts,v=i.bezierProjPcts.length;function y($,_,k,E,S){var I=ky(_,k),A=$.segments[$.segments.length-1],D={p0:_,p1:k,t0:E,t1:S,startDist:A?A.startDist+A.length:0,length:I};$.segments.push(D),$.length+=I}for(var b=0;b<f.length;b++){var x=f[b],w=f[b-1];w&&(x.startDist=w.startDist+w.length),y(x,x.p0,m[b*v],0,i.bezierProjPcts[0]);for(var C=0;C<v-1;C++)y(x,m[b*v+C],m[b*v+C+1],i.bezierProjPcts[C],i.bezierProjPcts[C+1]);y(x,m[b*v+v-1],x.p2,i.bezierProjPcts[v-1],1)}return c.cache=f},u=function(f){var h,d=f==="source";if(!!s[f]){var p=e.pstyle(f+"-text-offset").pfValue;switch(r.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var g=l(),m,v=0,y=0,b=0;b<g.length;b++){for(var x=g[d?b:g.length-1-b],w=0;w<x.segments.length;w++){var C=x.segments[d?w:x.segments.length-1-w],$=b===g.length-1&&w===x.segments.length-1;if(v=y,y+=C.length,y>=p||$){m={cp:x,segment:C};break}}if(m)break}var _=m.cp,k=m.segment,E=(p-v)/k.length,S=k.t1-k.t0,I=d?k.t0+S*E:k.t1-S*E;I=eT(0,I,1),t=W2(_.p0,_.p1,_.p2,I),h=Got(_.p0,_.p1,_.p2,I);break}case"straight":case"segments":case"haystack":{for(var A=0,D,T,N,F,R=r.allpts.length,P=0;P+3<R&&(d?(N={x:r.allpts[P],y:r.allpts[P+1]},F={x:r.allpts[P+2],y:r.allpts[P+3]}):(N={x:r.allpts[R-2-P],y:r.allpts[R-1-P]},F={x:r.allpts[R-4-P],y:r.allpts[R-3-P]}),D=ky(N,F),T=A,A+=D,!(A>=p));P+=2);var V=p-T,z=V/D;z=eT(0,z,1),t=lst(N,F,z),h=MEe(N,F);break}}a("labelX",f,t.x),a("labelY",f,t.y),a("labelAutoAngle",f,h)}};u("source"),u("target"),this.applyLabelDimensions(e)}};nd.applyLabelDimensions=function(e){this.applyPrefixedLabelDimensions(e),e.isEdge()&&(this.applyPrefixedLabelDimensions(e,"source"),this.applyPrefixedLabelDimensions(e,"target"))};nd.applyPrefixedLabelDimensions=function(e,t){var n=e._private,r=this.getLabelText(e,t),i=this.calculateLabelDimensions(e,r),s=e.pstyle("line-height").pfValue,a=e.pstyle("text-wrap").strValue,o=gc(n.rscratch,"labelWrapCachedLines",t)||[],l=a!=="wrap"?1:Math.max(o.length,1),u=i.height/l,c=u*s,f=i.width,h=i.height+(l-1)*(s-1)*u;Ug(n.rstyle,"labelWidth",t,f),Ug(n.rscratch,"labelWidth",t,f),Ug(n.rstyle,"labelHeight",t,h),Ug(n.rscratch,"labelHeight",t,h),Ug(n.rscratch,"labelLineHeight",t,c)};nd.getLabelText=function(e,t){var n=e._private,r=t?t+"-":"",i=e.pstyle(r+"label").strValue,s=e.pstyle("text-transform").value,a=function(V,z){return z?(Ug(n.rscratch,V,t,z),z):gc(n.rscratch,V,t)};if(!i)return"";s=="none"||(s=="uppercase"?i=i.toUpperCase():s=="lowercase"&&(i=i.toLowerCase()));var o=e.pstyle("text-wrap").value;if(o==="wrap"){var l=a("labelKey");if(l!=null&&a("labelWrapKey")===l)return a("labelWrapCachedText");for(var u="\u200B",c=i.split(`
`),f=e.pstyle("text-max-width").pfValue,h=e.pstyle("text-overflow-wrap").value,d=h==="anywhere",p=[],g=/[\s\u200b]+/,m=d?"":" ",v=0;v<c.length;v++){var y=c[v],b=this.calculateLabelDimensions(e,y),x=b.width;if(d){var w=y.split("").join(u);y=w}if(x>f){for(var C=y.split(g),$="",_=0;_<C.length;_++){var k=C[_],E=$.length===0?k:$+m+k,S=this.calculateLabelDimensions(e,E),I=S.width;I<=f?$+=k+m:($&&p.push($),$=k+m)}$.match(/^[\s\u200b]+$/)||p.push($)}else p.push(y)}a("labelWrapCachedLines",p),i=a("labelWrapCachedText",p.join(`
`)),a("labelWrapKey",l)}else if(o==="ellipsis"){var A=e.pstyle("text-max-width").pfValue,D="",T="\u2026",N=!1;if(this.calculateLabelDimensions(e,i).width<A)return i;for(var F=0;F<i.length;F++){var R=this.calculateLabelDimensions(e,D+i[F]+T).width;if(R>A)break;D+=i[F],F===i.length-1&&(N=!0)}return N||(D+=T),D}return i};nd.getLabelJustification=function(e){var t=e.pstyle("text-justification").strValue,n=e.pstyle("text-halign").strValue;if(t==="auto")if(e.isNode())switch(n){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return t};nd.calculateLabelDimensions=function(e,t){var n=this,r=Sy(t,e._private.labelDimsKey),i=n.labelDimCache||(n.labelDimCache=[]),s=i[r];if(s!=null)return s;var a=0,o=e.pstyle("font-style").strValue,l=e.pstyle("font-size").pfValue,u=e.pstyle("font-family").strValue,c=e.pstyle("font-weight").strValue,f=this.labelCalcCanvas,h=this.labelCalcCanvasContext;if(!f){f=this.labelCalcCanvas=document.createElement("canvas"),h=this.labelCalcCanvasContext=f.getContext("2d");var d=f.style;d.position="absolute",d.left="-9999px",d.top="-9999px",d.zIndex="-1",d.visibility="hidden",d.pointerEvents="none"}h.font="".concat(o," ").concat(c," ").concat(l,"px ").concat(u);for(var p=0,g=0,m=t.split(`
`),v=0;v<m.length;v++){var y=m[v],b=h.measureText(y),x=Math.ceil(b.width),w=l;p=Math.max(x,p),g+=w}return p+=a,g+=a,i[r]={width:p,height:g}};nd.calculateLabelAngle=function(e,t){var n=e._private,r=n.rscratch,i=e.isEdge(),s=t?t+"-":"",a=e.pstyle(s+"text-rotation"),o=a.strValue;return o==="none"?0:i&&o==="autorotate"?r.labelAutoAngle:o==="autorotate"?0:a.pfValue};nd.calculateLabelAngles=function(e){var t=this,n=e.isEdge(),r=e._private,i=r.rscratch;i.labelAngle=t.calculateLabelAngle(e),n&&(i.sourceLabelAngle=t.calculateLabelAngle(e,"source"),i.targetLabelAngle=t.calculateLabelAngle(e,"target"))};var FEe={},Upe=28,Wpe=!1;FEe.getNodeShape=function(e){var t=this,n=e.pstyle("shape").value;if(n==="cutrectangle"&&(e.width()<Upe||e.height()<Upe))return Wpe||(Rn("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),Wpe=!0),"rectangle";if(e.isParent())return n==="rectangle"||n==="roundrectangle"||n==="round-rectangle"||n==="cutrectangle"||n==="cut-rectangle"||n==="barrel"?n:"rectangle";if(n==="polygon"){var r=e.pstyle("shape-polygon-points").value;return t.nodeShapes.makePolygon(r).name}return n};var w8={};w8.registerCalculationListeners=function(){var e=this.cy,t=e.collection(),n=this,r=function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(t.merge(a),o)for(var l=0;l<a.length;l++){var u=a[l],c=u._private,f=c.rstyle;f.clean=!1,f.cleanConnected=!1}};n.binder(e).on("bounds.* dirty.*",function(a){var o=a.target;r(o)}).on("style.* background.*",function(a){var o=a.target;r(o,!1)});var i=function(a){if(a){var o=n.onUpdateEleCalcsFns;t.cleanStyle();for(var l=0;l<t.length;l++){var u=t[l],c=u._private.rstyle;u.isNode()&&!c.cleanConnected&&(r(u.connectedEdges()),c.cleanConnected=!0)}if(o)for(var f=0;f<o.length;f++){var h=o[f];h(a,t)}n.recalculateRenderedStyle(t),t=e.collection()}};n.flushRenderedStyleQueue=function(){i(!0)},n.beforeRender(i,n.beforeRenderPriorities.eleCalcs)};w8.onUpdateEleCalcs=function(e){var t=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];t.push(e)};w8.recalculateRenderedStyle=function(e,t){var n=function(x){return x._private.rstyle.cleanConnected},r=[],i=[];if(!this.destroyed){t===void 0&&(t=!0);for(var s=0;s<e.length;s++){var a=e[s],o=a._private,l=o.rstyle;a.isEdge()&&(!n(a.source())||!n(a.target()))&&(l.clean=!1),!(t&&l.clean||a.removed())&&a.pstyle("display").value!=="none"&&(o.group==="nodes"?i.push(a):r.push(a),l.clean=!0)}for(var u=0;u<i.length;u++){var c=i[u],f=c._private,h=f.rstyle,d=c.position();this.recalculateNodeLabelProjection(c),h.nodeX=d.x,h.nodeY=d.y,h.nodeW=c.pstyle("width").pfValue,h.nodeH=c.pstyle("height").pfValue}this.recalculateEdgeProjections(r);for(var p=0;p<r.length;p++){var g=r[p],m=g._private,v=m.rstyle,y=m.rscratch;v.srcX=y.arrowStartX,v.srcY=y.arrowStartY,v.tgtX=y.arrowEndX,v.tgtY=y.arrowEndY,v.midX=y.midX,v.midY=y.midY,v.labelAngle=y.labelAngle,v.sourceLabelAngle=y.sourceLabelAngle,v.targetLabelAngle=y.targetLabelAngle}}};var $8={};$8.updateCachedGrabbedEles=function(){var e=this.cachedZSortedEles;if(!!e){e.drag=[],e.nondrag=[];for(var t=[],n=0;n<e.length;n++){var r=e[n],i=r._private.rscratch;r.grabbed()&&!r.isParent()?t.push(r):i.inDragLayer?e.drag.push(r):e.nondrag.push(r)}for(var n=0;n<t.length;n++){var r=t[n];e.drag.push(r)}}};$8.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};$8.getCachedZSortedEles=function(e){if(e||!this.cachedZSortedEles){var t=this.cy.mutableElements().toArray();t.sort(xEe),t.interactive=t.filter(function(n){return n.interactive()}),this.cachedZSortedEles=t,this.updateCachedGrabbedEles()}else t=this.cachedZSortedEles;return t};var OEe={};[Ob,d5,_o,fI,Wee,nd,FEe,w8,$8].forEach(function(e){pt(OEe,e)});var REe={};REe.getCachedImage=function(e,t,n){var r=this,i=r.imageCache=r.imageCache||{},s=i[e];if(s)return s.image.complete||s.image.addEventListener("load",n),s.image;s=i[e]=i[e]||{};var a=s.image=new Image;a.addEventListener("load",n),a.addEventListener("error",function(){a.error=!0});var o="data:",l=e.substring(0,o.length).toLowerCase()===o;return l||(t=t==="null"?null:t,a.crossOrigin=t),a.src=e,a};var CC={};CC.registerBinding=function(e,t,n,r){var i=Array.prototype.slice.apply(arguments,[1]),s=this.binder(e);return s.on.apply(s,i)};CC.binder=function(e){var t=this,n=e===window||e===document||e===document.body||dit(e);if(t.supportsPassiveEvents==null){var r=!1;try{var i=Object.defineProperty({},"passive",{get:function(){return r=!0,!0}});window.addEventListener("test",null,i)}catch{}t.supportsPassiveEvents=r}var s=function(o,l,u){var c=Array.prototype.slice.call(arguments);return n&&t.supportsPassiveEvents&&(c[2]={capture:u!=null?u:!1,passive:!1,once:!1}),t.bindings.push({target:e,args:c}),(e.addEventListener||e.on).apply(e,c),this};return{on:s,addEventListener:s,addListener:s,bind:s}};CC.nodeIsDraggable=function(e){return e&&e.isNode()&&!e.locked()&&e.grabbable()};CC.nodeIsGrabbable=function(e){return this.nodeIsDraggable(e)&&e.interactive()};CC.load=function(){var e=this,t=function(j){return j.selected()},n=function(j,fe,_e,ve){j==null&&(j=e.cy);for(var ye=0;ye<fe.length;ye++){var yt=fe[ye];j.emit({originalEvent:_e,type:yt,position:ve})}},r=function(j){return j.shiftKey||j.metaKey||j.ctrlKey},i=function(j,fe){var _e=!0;if(e.cy.hasCompoundNodes()&&j&&j.pannable())for(var ve=0;fe&&ve<fe.length;ve++){var j=fe[ve];if(j.isNode()&&j.isParent()&&!j.pannable()){_e=!1;break}}else _e=!0;return _e},s=function(j){j[0]._private.grabbed=!0},a=function(j){j[0]._private.grabbed=!1},o=function(j){j[0]._private.rscratch.inDragLayer=!0},l=function(j){j[0]._private.rscratch.inDragLayer=!1},u=function(j){j[0]._private.rscratch.isGrabTarget=!0},c=function(j){j[0]._private.rscratch.isGrabTarget=!1},f=function(j,fe){var _e=fe.addToList,ve=_e.has(j);!ve&&j.grabbable()&&!j.locked()&&(_e.merge(j),s(j))},h=function(j,fe){if(!!j.cy().hasCompoundNodes()&&!(fe.inDragLayer==null&&fe.addToList==null)){var _e=j.descendants();fe.inDragLayer&&(_e.forEach(o),_e.connectedEdges().forEach(o)),fe.addToList&&f(_e,fe)}},d=function(j,fe){fe=fe||{};var _e=j.cy().hasCompoundNodes();fe.inDragLayer&&(j.forEach(o),j.neighborhood().stdFilter(function(ve){return!_e||ve.isEdge()}).forEach(o)),fe.addToList&&j.forEach(function(ve){f(ve,fe)}),h(j,fe),m(j,{inDragLayer:fe.inDragLayer}),e.updateCachedGrabbedEles()},p=d,g=function(j){!j||(e.getCachedZSortedEles().forEach(function(fe){a(fe),l(fe),c(fe)}),e.updateCachedGrabbedEles())},m=function(j,fe){if(!(fe.inDragLayer==null&&fe.addToList==null)&&!!j.cy().hasCompoundNodes()){var _e=j.ancestors().orphans();if(!_e.same(j)){var ve=_e.descendants().spawnSelf().merge(_e).unmerge(j).unmerge(j.descendants()),ye=ve.connectedEdges();fe.inDragLayer&&(ye.forEach(o),ve.forEach(o)),fe.addToList&&ve.forEach(function(yt){f(yt,fe)})}}},v=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},y=typeof MutationObserver<"u",b=typeof ResizeObserver<"u";y?(e.removeObserver=new MutationObserver(function(Se){for(var j=0;j<Se.length;j++){var fe=Se[j],_e=fe.removedNodes;if(_e)for(var ve=0;ve<_e.length;ve++){var ye=_e[ve];if(ye===e.container){e.destroy();break}}}}),e.container.parentNode&&e.removeObserver.observe(e.container.parentNode,{childList:!0})):e.registerBinding(e.container,"DOMNodeRemoved",function(Se){e.destroy()});var x=u8.default(function(){e.cy.resize()},100);y&&(e.styleObserver=new MutationObserver(x),e.styleObserver.observe(e.container,{attributes:!0})),e.registerBinding(window,"resize",x),b&&(e.resizeObserver=new ResizeObserver(x),e.resizeObserver.observe(e.container));var w=function(j,fe){for(;j!=null;)fe(j),j=j.parentNode},C=function(){e.invalidateContainerClientCoordsCache()};w(e.container,function(Se){e.registerBinding(Se,"transitionend",C),e.registerBinding(Se,"animationend",C),e.registerBinding(Se,"scroll",C)}),e.registerBinding(e.container,"contextmenu",function(Se){Se.preventDefault()});var $=function(){return e.selection[4]!==0},_=function(j){for(var fe=e.findContainerClientCoords(),_e=fe[0],ve=fe[1],ye=fe[2],yt=fe[3],Ae=j.touches?j.touches:[j],Ve=!1,Xt=0;Xt<Ae.length;Xt++){var nn=Ae[Xt];if(_e<=nn.clientX&&nn.clientX<=_e+ye&&ve<=nn.clientY&&nn.clientY<=ve+yt){Ve=!0;break}}if(!Ve)return!1;for(var It=e.container,cn=j.target,Et=cn.parentNode,Rt=!1;Et;){if(Et===It){Rt=!0;break}Et=Et.parentNode}return!!Rt};e.registerBinding(e.container,"mousedown",function(j){if(!!_(j)){j.preventDefault(),v(),e.hoverData.capture=!0,e.hoverData.which=j.which;var fe=e.cy,_e=[j.clientX,j.clientY],ve=e.projectIntoViewport(_e[0],_e[1]),ye=e.selection,yt=e.findNearestElements(ve[0],ve[1],!0,!1),Ae=yt[0],Ve=e.dragData.possibleDragElements;e.hoverData.mdownPos=ve,e.hoverData.mdownGPos=_e;var Xt=function(){e.hoverData.tapholdCancelled=!1,clearTimeout(e.hoverData.tapholdTimeout),e.hoverData.tapholdTimeout=setTimeout(function(){if(!e.hoverData.tapholdCancelled){var Wr=e.hoverData.down;Wr?Wr.emit({originalEvent:j,type:"taphold",position:{x:ve[0],y:ve[1]}}):fe.emit({originalEvent:j,type:"taphold",position:{x:ve[0],y:ve[1]}})}},e.tapholdDuration)};if(j.which==3){e.hoverData.cxtStarted=!0;var nn={originalEvent:j,type:"cxttapstart",position:{x:ve[0],y:ve[1]}};Ae?(Ae.activate(),Ae.emit(nn),e.hoverData.down=Ae):fe.emit(nn),e.hoverData.downTime=new Date().getTime(),e.hoverData.cxtDragged=!1}else if(j.which==1){Ae&&Ae.activate();{if(Ae!=null&&e.nodeIsGrabbable(Ae)){var It=function(Wr){return{originalEvent:j,type:Wr,position:{x:ve[0],y:ve[1]}}},cn=function(Wr){Wr.emit(It("grab"))};if(u(Ae),!Ae.selected())Ve=e.dragData.possibleDragElements=fe.collection(),p(Ae,{addToList:Ve}),Ae.emit(It("grabon")).emit(It("grab"));else{Ve=e.dragData.possibleDragElements=fe.collection();var Et=fe.$(function(Rt){return Rt.isNode()&&Rt.selected()&&e.nodeIsGrabbable(Rt)});d(Et,{addToList:Ve}),Ae.emit(It("grabon")),Et.forEach(cn)}e.redrawHint("eles",!0),e.redrawHint("drag",!0)}e.hoverData.down=Ae,e.hoverData.downs=yt,e.hoverData.downTime=new Date().getTime()}n(Ae,["mousedown","tapstart","vmousedown"],j,{x:ve[0],y:ve[1]}),Ae==null?(ye[4]=1,e.data.bgActivePosistion={x:ve[0],y:ve[1]},e.redrawHint("select",!0),e.redraw()):Ae.pannable()&&(ye[4]=1),Xt()}ye[0]=ye[2]=ve[0],ye[1]=ye[3]=ve[1]}},!1),e.registerBinding(window,"mousemove",function(j){var fe=e.hoverData.capture;if(!(!fe&&!_(j))){var _e=!1,ve=e.cy,ye=ve.zoom(),yt=[j.clientX,j.clientY],Ae=e.projectIntoViewport(yt[0],yt[1]),Ve=e.hoverData.mdownPos,Xt=e.hoverData.mdownGPos,nn=e.selection,It=null;!e.hoverData.draggingEles&&!e.hoverData.dragging&&!e.hoverData.selecting&&(It=e.findNearestElement(Ae[0],Ae[1],!0,!1));var cn=e.hoverData.last,Et=e.hoverData.down,Rt=[Ae[0]-nn[2],Ae[1]-nn[3]],Wr=e.dragData.possibleDragElements,Ts;if(Xt){var Qu=yt[0]-Xt[0],Ju=Qu*Qu,Ds=yt[1]-Xt[1],tu=Ds*Ds,Pa=Ju+tu;e.hoverData.isOverThresholdDrag=Ts=Pa>=e.desktopTapThreshold2}var Ad=r(j);Ts&&(e.hoverData.tapholdCancelled=!0);var _g=function(){var _f=e.hoverData.dragDelta=e.hoverData.dragDelta||[];_f.length===0?(_f.push(Rt[0]),_f.push(Rt[1])):(_f[0]+=Rt[0],_f[1]+=Rt[1])};_e=!0,n(It,["mousemove","vmousemove","tapdrag"],j,{x:Ae[0],y:Ae[1]});var qx=function(){e.data.bgActivePosistion=void 0,e.hoverData.selecting||ve.emit({originalEvent:j,type:"boxstart",position:{x:Ae[0],y:Ae[1]}}),nn[4]=1,e.hoverData.selecting=!0,e.redrawHint("select",!0),e.redraw()};if(e.hoverData.which===3){if(Ts){var wv={originalEvent:j,type:"cxtdrag",position:{x:Ae[0],y:Ae[1]}};Et?Et.emit(wv):ve.emit(wv),e.hoverData.cxtDragged=!0,(!e.hoverData.cxtOver||It!==e.hoverData.cxtOver)&&(e.hoverData.cxtOver&&e.hoverData.cxtOver.emit({originalEvent:j,type:"cxtdragout",position:{x:Ae[0],y:Ae[1]}}),e.hoverData.cxtOver=It,It&&It.emit({originalEvent:j,type:"cxtdragover",position:{x:Ae[0],y:Ae[1]}}))}}else if(e.hoverData.dragging){if(_e=!0,ve.panningEnabled()&&ve.userPanningEnabled()){var Gx;if(e.hoverData.justStartedPan){var FF=e.hoverData.mdownPos;Gx={x:(Ae[0]-FF[0])*ye,y:(Ae[1]-FF[1])*ye},e.hoverData.justStartedPan=!1}else Gx={x:Rt[0]*ye,y:Rt[1]*ye};ve.panBy(Gx),ve.emit("dragpan"),e.hoverData.dragged=!0}Ae=e.projectIntoViewport(j.clientX,j.clientY)}else if(nn[4]==1&&(Et==null||Et.pannable())){if(Ts){if(!e.hoverData.dragging&&ve.boxSelectionEnabled()&&(Ad||!ve.panningEnabled()||!ve.userPanningEnabled()))qx();else if(!e.hoverData.selecting&&ve.panningEnabled()&&ve.userPanningEnabled()){var $v=i(Et,e.hoverData.downs);$v&&(e.hoverData.dragging=!0,e.hoverData.justStartedPan=!0,nn[4]=0,e.data.bgActivePosistion=T2(Ve),e.redrawHint("select",!0),e.redraw())}Et&&Et.pannable()&&Et.active()&&Et.unactivate()}}else{if(Et&&Et.pannable()&&Et.active()&&Et.unactivate(),(!Et||!Et.grabbed())&&It!=cn&&(cn&&n(cn,["mouseout","tapdragout"],j,{x:Ae[0],y:Ae[1]}),It&&n(It,["mouseover","tapdragover"],j,{x:Ae[0],y:Ae[1]}),e.hoverData.last=It),Et)if(Ts){if(ve.boxSelectionEnabled()&&Ad)Et&&Et.grabbed()&&(g(Wr),Et.emit("freeon"),Wr.emit("free"),e.dragData.didDrag&&(Et.emit("dragfreeon"),Wr.emit("dragfree"))),qx();else if(Et&&Et.grabbed()&&e.nodeIsDraggable(Et)){var Do=!e.dragData.didDrag;Do&&e.redrawHint("eles",!0),e.dragData.didDrag=!0,e.hoverData.draggingEles||d(Wr,{inDragLayer:!0});var Zs={x:0,y:0};if(Pe(Rt[0])&&Pe(Rt[1])&&(Zs.x+=Rt[0],Zs.y+=Rt[1],Do)){var Io=e.hoverData.dragDelta;Io&&Pe(Io[0])&&Pe(Io[1])&&(Zs.x+=Io[0],Zs.y+=Io[1])}e.hoverData.draggingEles=!0,Wr.silentShift(Zs).emit("position drag"),e.redrawHint("drag",!0),e.redraw()}}else _g();_e=!0}if(nn[2]=Ae[0],nn[3]=Ae[1],_e)return j.stopPropagation&&j.stopPropagation(),j.preventDefault&&j.preventDefault(),!1}},!1);var k,E,S;e.registerBinding(window,"mouseup",function(j){var fe=e.hoverData.capture;if(!!fe){e.hoverData.capture=!1;var _e=e.cy,ve=e.projectIntoViewport(j.clientX,j.clientY),ye=e.selection,yt=e.findNearestElement(ve[0],ve[1],!0,!1),Ae=e.dragData.possibleDragElements,Ve=e.hoverData.down,Xt=r(j);if(e.data.bgActivePosistion&&(e.redrawHint("select",!0),e.redraw()),e.hoverData.tapholdCancelled=!0,e.data.bgActivePosistion=void 0,Ve&&Ve.unactivate(),e.hoverData.which===3){var nn={originalEvent:j,type:"cxttapend",position:{x:ve[0],y:ve[1]}};if(Ve?Ve.emit(nn):_e.emit(nn),!e.hoverData.cxtDragged){var It={originalEvent:j,type:"cxttap",position:{x:ve[0],y:ve[1]}};Ve?Ve.emit(It):_e.emit(It)}e.hoverData.cxtDragged=!1,e.hoverData.which=null}else if(e.hoverData.which===1){if(n(yt,["mouseup","tapend","vmouseup"],j,{x:ve[0],y:ve[1]}),!e.dragData.didDrag&&!e.hoverData.dragged&&!e.hoverData.selecting&&!e.hoverData.isOverThresholdDrag&&(n(Ve,["click","tap","vclick"],j,{x:ve[0],y:ve[1]}),E=!1,j.timeStamp-S<=_e.multiClickDebounceTime()?(k&&clearTimeout(k),E=!0,S=null,n(Ve,["dblclick","dbltap","vdblclick"],j,{x:ve[0],y:ve[1]})):(k=setTimeout(function(){E||n(Ve,["oneclick","onetap","voneclick"],j,{x:ve[0],y:ve[1]})},_e.multiClickDebounceTime()),S=j.timeStamp)),Ve==null&&!e.dragData.didDrag&&!e.hoverData.selecting&&!e.hoverData.dragged&&!r(j)&&(_e.$(t).unselect(["tapunselect"]),Ae.length>0&&e.redrawHint("eles",!0),e.dragData.possibleDragElements=Ae=_e.collection()),yt==Ve&&!e.dragData.didDrag&&!e.hoverData.selecting&&yt!=null&&yt._private.selectable&&(e.hoverData.dragging||(_e.selectionType()==="additive"||Xt?yt.selected()?yt.unselect(["tapunselect"]):yt.select(["tapselect"]):Xt||(_e.$(t).unmerge(yt).unselect(["tapunselect"]),yt.select(["tapselect"]))),e.redrawHint("eles",!0)),e.hoverData.selecting){var cn=_e.collection(e.getAllInBox(ye[0],ye[1],ye[2],ye[3]));e.redrawHint("select",!0),cn.length>0&&e.redrawHint("eles",!0),_e.emit({type:"boxend",originalEvent:j,position:{x:ve[0],y:ve[1]}});var Et=function(Ts){return Ts.selectable()&&!Ts.selected()};_e.selectionType()==="additive"||Xt||_e.$(t).unmerge(cn).unselect(),cn.emit("box").stdFilter(Et).select().emit("boxselect"),e.redraw()}if(e.hoverData.dragging&&(e.hoverData.dragging=!1,e.redrawHint("select",!0),e.redrawHint("eles",!0),e.redraw()),!ye[4]){e.redrawHint("drag",!0),e.redrawHint("eles",!0);var Rt=Ve&&Ve.grabbed();g(Ae),Rt&&(Ve.emit("freeon"),Ae.emit("free"),e.dragData.didDrag&&(Ve.emit("dragfreeon"),Ae.emit("dragfree")))}}ye[4]=0,e.hoverData.down=null,e.hoverData.cxtStarted=!1,e.hoverData.draggingEles=!1,e.hoverData.selecting=!1,e.hoverData.isOverThresholdDrag=!1,e.dragData.didDrag=!1,e.hoverData.dragged=!1,e.hoverData.dragDelta=[],e.hoverData.mdownPos=null,e.hoverData.mdownGPos=null}},!1);var I=function(j){if(!e.scrollingPage){var fe=e.cy,_e=fe.zoom(),ve=fe.pan(),ye=e.projectIntoViewport(j.clientX,j.clientY),yt=[ye[0]*_e+ve.x,ye[1]*_e+ve.y];if(e.hoverData.draggingEles||e.hoverData.dragging||e.hoverData.cxtStarted||$()){j.preventDefault();return}if(fe.panningEnabled()&&fe.userPanningEnabled()&&fe.zoomingEnabled()&&fe.userZoomingEnabled()){j.preventDefault(),e.data.wheelZooming=!0,clearTimeout(e.data.wheelTimeout),e.data.wheelTimeout=setTimeout(function(){e.data.wheelZooming=!1,e.redrawHint("eles",!0),e.redraw()},150);var Ae;j.deltaY!=null?Ae=j.deltaY/-250:j.wheelDeltaY!=null?Ae=j.wheelDeltaY/1e3:Ae=j.wheelDelta/1e3,Ae=Ae*e.wheelSensitivity;var Ve=j.deltaMode===1;Ve&&(Ae*=33);var Xt=fe.zoom()*Math.pow(10,Ae);j.type==="gesturechange"&&(Xt=e.gestureStartZoom*j.scale),fe.zoom({level:Xt,renderedPosition:{x:yt[0],y:yt[1]}}),fe.emit(j.type==="gesturechange"?"pinchzoom":"scrollzoom")}}};e.registerBinding(e.container,"wheel",I,!0),e.registerBinding(window,"scroll",function(j){e.scrollingPage=!0,clearTimeout(e.scrollingPageTimeout),e.scrollingPageTimeout=setTimeout(function(){e.scrollingPage=!1},250)},!0),e.registerBinding(e.container,"gesturestart",function(j){e.gestureStartZoom=e.cy.zoom(),e.hasTouchStarted||j.preventDefault()},!0),e.registerBinding(e.container,"gesturechange",function(Se){e.hasTouchStarted||I(Se)},!0),e.registerBinding(e.container,"mouseout",function(j){var fe=e.projectIntoViewport(j.clientX,j.clientY);e.cy.emit({originalEvent:j,type:"mouseout",position:{x:fe[0],y:fe[1]}})},!1),e.registerBinding(e.container,"mouseover",function(j){var fe=e.projectIntoViewport(j.clientX,j.clientY);e.cy.emit({originalEvent:j,type:"mouseover",position:{x:fe[0],y:fe[1]}})},!1);var A,D,T,N,F,R,P,V,z,q,G,K,Y,te=function(j,fe,_e,ve){return Math.sqrt((_e-j)*(_e-j)+(ve-fe)*(ve-fe))},Z=function(j,fe,_e,ve){return(_e-j)*(_e-j)+(ve-fe)*(ve-fe)},ae;e.registerBinding(e.container,"touchstart",ae=function(j){if(e.hasTouchStarted=!0,!!_(j)){v(),e.touchData.capture=!0,e.data.bgActivePosistion=void 0;var fe=e.cy,_e=e.touchData.now,ve=e.touchData.earlier;if(j.touches[0]){var ye=e.projectIntoViewport(j.touches[0].clientX,j.touches[0].clientY);_e[0]=ye[0],_e[1]=ye[1]}if(j.touches[1]){var ye=e.projectIntoViewport(j.touches[1].clientX,j.touches[1].clientY);_e[2]=ye[0],_e[3]=ye[1]}if(j.touches[2]){var ye=e.projectIntoViewport(j.touches[2].clientX,j.touches[2].clientY);_e[4]=ye[0],_e[5]=ye[1]}if(j.touches[1]){e.touchData.singleTouchMoved=!0,g(e.dragData.touchDragEles);var yt=e.findContainerClientCoords();z=yt[0],q=yt[1],G=yt[2],K=yt[3],A=j.touches[0].clientX-z,D=j.touches[0].clientY-q,T=j.touches[1].clientX-z,N=j.touches[1].clientY-q,Y=0<=A&&A<=G&&0<=T&&T<=G&&0<=D&&D<=K&&0<=N&&N<=K;var Ae=fe.pan(),Ve=fe.zoom();F=te(A,D,T,N),R=Z(A,D,T,N),P=[(A+T)/2,(D+N)/2],V=[(P[0]-Ae.x)/Ve,(P[1]-Ae.y)/Ve];var Xt=200,nn=Xt*Xt;if(R<nn&&!j.touches[2]){var It=e.findNearestElement(_e[0],_e[1],!0,!0),cn=e.findNearestElement(_e[2],_e[3],!0,!0);It&&It.isNode()?(It.activate().emit({originalEvent:j,type:"cxttapstart",position:{x:_e[0],y:_e[1]}}),e.touchData.start=It):cn&&cn.isNode()?(cn.activate().emit({originalEvent:j,type:"cxttapstart",position:{x:_e[0],y:_e[1]}}),e.touchData.start=cn):fe.emit({originalEvent:j,type:"cxttapstart",position:{x:_e[0],y:_e[1]}}),e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxt=!0,e.touchData.cxtDragged=!1,e.data.bgActivePosistion=void 0,e.redraw();return}}if(j.touches[2])fe.boxSelectionEnabled()&&j.preventDefault();else if(!j.touches[1]){if(j.touches[0]){var Et=e.findNearestElements(_e[0],_e[1],!0,!0),Rt=Et[0];if(Rt!=null&&(Rt.activate(),e.touchData.start=Rt,e.touchData.starts=Et,e.nodeIsGrabbable(Rt))){var Wr=e.dragData.touchDragEles=fe.collection(),Ts=null;e.redrawHint("eles",!0),e.redrawHint("drag",!0),Rt.selected()?(Ts=fe.$(function(Pa){return Pa.selected()&&e.nodeIsGrabbable(Pa)}),d(Ts,{addToList:Wr})):p(Rt,{addToList:Wr}),u(Rt);var Qu=function(Ad){return{originalEvent:j,type:Ad,position:{x:_e[0],y:_e[1]}}};Rt.emit(Qu("grabon")),Ts?Ts.forEach(function(Pa){Pa.emit(Qu("grab"))}):Rt.emit(Qu("grab"))}n(Rt,["touchstart","tapstart","vmousedown"],j,{x:_e[0],y:_e[1]}),Rt==null&&(e.data.bgActivePosistion={x:ye[0],y:ye[1]},e.redrawHint("select",!0),e.redraw()),e.touchData.singleTouchMoved=!1,e.touchData.singleTouchStartTime=+new Date,clearTimeout(e.touchData.tapholdTimeout),e.touchData.tapholdTimeout=setTimeout(function(){e.touchData.singleTouchMoved===!1&&!e.pinching&&!e.touchData.selecting&&n(e.touchData.start,["taphold"],j,{x:_e[0],y:_e[1]})},e.tapholdDuration)}}if(j.touches.length>=1){for(var Ju=e.touchData.startPosition=[],Ds=0;Ds<_e.length;Ds++)Ju[Ds]=ve[Ds]=_e[Ds];var tu=j.touches[0];e.touchData.startGPosition=[tu.clientX,tu.clientY]}}},!1);var O;e.registerBinding(window,"touchmove",O=function(j){var fe=e.touchData.capture;if(!(!fe&&!_(j))){var _e=e.selection,ve=e.cy,ye=e.touchData.now,yt=e.touchData.earlier,Ae=ve.zoom();if(j.touches[0]){var Ve=e.projectIntoViewport(j.touches[0].clientX,j.touches[0].clientY);ye[0]=Ve[0],ye[1]=Ve[1]}if(j.touches[1]){var Ve=e.projectIntoViewport(j.touches[1].clientX,j.touches[1].clientY);ye[2]=Ve[0],ye[3]=Ve[1]}if(j.touches[2]){var Ve=e.projectIntoViewport(j.touches[2].clientX,j.touches[2].clientY);ye[4]=Ve[0],ye[5]=Ve[1]}var Xt=e.touchData.startGPosition,nn;if(fe&&j.touches[0]&&Xt){for(var It=[],cn=0;cn<ye.length;cn++)It[cn]=ye[cn]-yt[cn];var Et=j.touches[0].clientX-Xt[0],Rt=Et*Et,Wr=j.touches[0].clientY-Xt[1],Ts=Wr*Wr,Qu=Rt+Ts;nn=Qu>=e.touchTapThreshold2}if(fe&&e.touchData.cxt){j.preventDefault();var Ju=j.touches[0].clientX-z,Ds=j.touches[0].clientY-q,tu=j.touches[1].clientX-z,Pa=j.touches[1].clientY-q,Ad=Z(Ju,Ds,tu,Pa),_g=Ad/R,qx=150,wv=qx*qx,Gx=1.5,FF=Gx*Gx;if(_g>=FF||Ad>=wv){e.touchData.cxt=!1,e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);var $v={originalEvent:j,type:"cxttapend",position:{x:ye[0],y:ye[1]}};e.touchData.start?(e.touchData.start.unactivate().emit($v),e.touchData.start=null):ve.emit($v)}}if(fe&&e.touchData.cxt){var $v={originalEvent:j,type:"cxtdrag",position:{x:ye[0],y:ye[1]}};e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),e.touchData.start?e.touchData.start.emit($v):ve.emit($v),e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxtDragged=!0;var Do=e.findNearestElement(ye[0],ye[1],!0,!0);(!e.touchData.cxtOver||Do!==e.touchData.cxtOver)&&(e.touchData.cxtOver&&e.touchData.cxtOver.emit({originalEvent:j,type:"cxtdragout",position:{x:ye[0],y:ye[1]}}),e.touchData.cxtOver=Do,Do&&Do.emit({originalEvent:j,type:"cxtdragover",position:{x:ye[0],y:ye[1]}}))}else if(fe&&j.touches[2]&&ve.boxSelectionEnabled())j.preventDefault(),e.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,e.touchData.selecting||ve.emit({originalEvent:j,type:"boxstart",position:{x:ye[0],y:ye[1]}}),e.touchData.selecting=!0,e.touchData.didSelect=!0,_e[4]=1,!_e||_e.length===0||_e[0]===void 0?(_e[0]=(ye[0]+ye[2]+ye[4])/3,_e[1]=(ye[1]+ye[3]+ye[5])/3,_e[2]=(ye[0]+ye[2]+ye[4])/3+1,_e[3]=(ye[1]+ye[3]+ye[5])/3+1):(_e[2]=(ye[0]+ye[2]+ye[4])/3,_e[3]=(ye[1]+ye[3]+ye[5])/3),e.redrawHint("select",!0),e.redraw();else if(fe&&j.touches[1]&&!e.touchData.didSelect&&ve.zoomingEnabled()&&ve.panningEnabled()&&ve.userZoomingEnabled()&&ve.userPanningEnabled()){j.preventDefault(),e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);var Zs=e.dragData.touchDragEles;if(Zs){e.redrawHint("drag",!0);for(var Io=0;Io<Zs.length;Io++){var OF=Zs[Io]._private;OF.grabbed=!1,OF.rscratch.inDragLayer=!1}}var _f=e.touchData.start,Ju=j.touches[0].clientX-z,Ds=j.touches[0].clientY-q,tu=j.touches[1].clientX-z,Pa=j.touches[1].clientY-q,ide=te(Ju,Ds,tu,Pa),HKe=ide/F;if(Y){var qKe=Ju-A,GKe=Ds-D,YKe=tu-T,XKe=Pa-N,KKe=(qKe+YKe)/2,ZKe=(GKe+XKe)/2,FS=ve.zoom(),IV=FS*HKe,RF=ve.pan(),sde=V[0]*FS+RF.x,ade=V[1]*FS+RF.y,QKe={x:-IV/FS*(sde-RF.x-KKe)+sde,y:-IV/FS*(ade-RF.y-ZKe)+ade};if(_f&&_f.active()){var Zs=e.dragData.touchDragEles;g(Zs),e.redrawHint("drag",!0),e.redrawHint("eles",!0),_f.unactivate().emit("freeon"),Zs.emit("free"),e.dragData.didDrag&&(_f.emit("dragfreeon"),Zs.emit("dragfree"))}ve.viewport({zoom:IV,pan:QKe,cancelOnFailedZoom:!0}),ve.emit("pinchzoom"),F=ide,A=Ju,D=Ds,T=tu,N=Pa,e.pinching=!0}if(j.touches[0]){var Ve=e.projectIntoViewport(j.touches[0].clientX,j.touches[0].clientY);ye[0]=Ve[0],ye[1]=Ve[1]}if(j.touches[1]){var Ve=e.projectIntoViewport(j.touches[1].clientX,j.touches[1].clientY);ye[2]=Ve[0],ye[3]=Ve[1]}if(j.touches[2]){var Ve=e.projectIntoViewport(j.touches[2].clientX,j.touches[2].clientY);ye[4]=Ve[0],ye[5]=Ve[1]}}else if(j.touches[0]&&!e.touchData.didSelect){var ec=e.touchData.start,NV=e.touchData.last,Do;if(!e.hoverData.draggingEles&&!e.swipePanning&&(Do=e.findNearestElement(ye[0],ye[1],!0,!0)),fe&&ec!=null&&j.preventDefault(),fe&&ec!=null&&e.nodeIsDraggable(ec))if(nn){var Zs=e.dragData.touchDragEles,ode=!e.dragData.didDrag;ode&&d(Zs,{inDragLayer:!0}),e.dragData.didDrag=!0;var OS={x:0,y:0};if(Pe(It[0])&&Pe(It[1])&&(OS.x+=It[0],OS.y+=It[1],ode)){e.redrawHint("eles",!0);var tc=e.touchData.dragDelta;tc&&Pe(tc[0])&&Pe(tc[1])&&(OS.x+=tc[0],OS.y+=tc[1])}e.hoverData.draggingEles=!0,Zs.silentShift(OS).emit("position drag"),e.redrawHint("drag",!0),e.touchData.startPosition[0]==yt[0]&&e.touchData.startPosition[1]==yt[1]&&e.redrawHint("eles",!0),e.redraw()}else{var tc=e.touchData.dragDelta=e.touchData.dragDelta||[];tc.length===0?(tc.push(It[0]),tc.push(It[1])):(tc[0]+=It[0],tc[1]+=It[1])}if(n(ec||Do,["touchmove","tapdrag","vmousemove"],j,{x:ye[0],y:ye[1]}),(!ec||!ec.grabbed())&&Do!=NV&&(NV&&NV.emit({originalEvent:j,type:"tapdragout",position:{x:ye[0],y:ye[1]}}),Do&&Do.emit({originalEvent:j,type:"tapdragover",position:{x:ye[0],y:ye[1]}})),e.touchData.last=Do,fe)for(var Io=0;Io<ye.length;Io++)ye[Io]&&e.touchData.startPosition[Io]&&nn&&(e.touchData.singleTouchMoved=!0);if(fe&&(ec==null||ec.pannable())&&ve.panningEnabled()&&ve.userPanningEnabled()){var JKe=i(ec,e.touchData.starts);JKe&&(j.preventDefault(),e.data.bgActivePosistion||(e.data.bgActivePosistion=T2(e.touchData.startPosition)),e.swipePanning?(ve.panBy({x:It[0]*Ae,y:It[1]*Ae}),ve.emit("dragpan")):nn&&(e.swipePanning=!0,ve.panBy({x:Et*Ae,y:Wr*Ae}),ve.emit("dragpan"),ec&&(ec.unactivate(),e.redrawHint("select",!0),e.touchData.start=null)));var Ve=e.projectIntoViewport(j.touches[0].clientX,j.touches[0].clientY);ye[0]=Ve[0],ye[1]=Ve[1]}}for(var cn=0;cn<ye.length;cn++)yt[cn]=ye[cn];fe&&j.touches.length>0&&!e.hoverData.draggingEles&&!e.swipePanning&&e.data.bgActivePosistion!=null&&(e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),e.redraw())}},!1);var L;e.registerBinding(window,"touchcancel",L=function(j){var fe=e.touchData.start;e.touchData.capture=!1,fe&&fe.unactivate()});var W,M,ue,X;if(e.registerBinding(window,"touchend",W=function(j){var fe=e.touchData.start,_e=e.touchData.capture;if(_e)j.touches.length===0&&(e.touchData.capture=!1),j.preventDefault();else return;var ve=e.selection;e.swipePanning=!1,e.hoverData.draggingEles=!1;var ye=e.cy,yt=ye.zoom(),Ae=e.touchData.now,Ve=e.touchData.earlier;if(j.touches[0]){var Xt=e.projectIntoViewport(j.touches[0].clientX,j.touches[0].clientY);Ae[0]=Xt[0],Ae[1]=Xt[1]}if(j.touches[1]){var Xt=e.projectIntoViewport(j.touches[1].clientX,j.touches[1].clientY);Ae[2]=Xt[0],Ae[3]=Xt[1]}if(j.touches[2]){var Xt=e.projectIntoViewport(j.touches[2].clientX,j.touches[2].clientY);Ae[4]=Xt[0],Ae[5]=Xt[1]}fe&&fe.unactivate();var nn;if(e.touchData.cxt){if(nn={originalEvent:j,type:"cxttapend",position:{x:Ae[0],y:Ae[1]}},fe?fe.emit(nn):ye.emit(nn),!e.touchData.cxtDragged){var It={originalEvent:j,type:"cxttap",position:{x:Ae[0],y:Ae[1]}};fe?fe.emit(It):ye.emit(It)}e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxt=!1,e.touchData.start=null,e.redraw();return}if(!j.touches[2]&&ye.boxSelectionEnabled()&&e.touchData.selecting){e.touchData.selecting=!1;var cn=ye.collection(e.getAllInBox(ve[0],ve[1],ve[2],ve[3]));ve[0]=void 0,ve[1]=void 0,ve[2]=void 0,ve[3]=void 0,ve[4]=0,e.redrawHint("select",!0),ye.emit({type:"boxend",originalEvent:j,position:{x:Ae[0],y:Ae[1]}});var Et=function(wv){return wv.selectable()&&!wv.selected()};cn.emit("box").stdFilter(Et).select().emit("boxselect"),cn.nonempty()&&e.redrawHint("eles",!0),e.redraw()}if(fe!=null&&fe.unactivate(),j.touches[2])e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);else if(!j.touches[1]){if(!j.touches[0]){if(!j.touches[0]){e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);var Rt=e.dragData.touchDragEles;if(fe!=null){var Wr=fe._private.grabbed;g(Rt),e.redrawHint("drag",!0),e.redrawHint("eles",!0),Wr&&(fe.emit("freeon"),Rt.emit("free"),e.dragData.didDrag&&(fe.emit("dragfreeon"),Rt.emit("dragfree"))),n(fe,["touchend","tapend","vmouseup","tapdragout"],j,{x:Ae[0],y:Ae[1]}),fe.unactivate(),e.touchData.start=null}else{var Ts=e.findNearestElement(Ae[0],Ae[1],!0,!0);n(Ts,["touchend","tapend","vmouseup","tapdragout"],j,{x:Ae[0],y:Ae[1]})}var Qu=e.touchData.startPosition[0]-Ae[0],Ju=Qu*Qu,Ds=e.touchData.startPosition[1]-Ae[1],tu=Ds*Ds,Pa=Ju+tu,Ad=Pa*yt*yt;e.touchData.singleTouchMoved||(fe||ye.$(":selected").unselect(["tapunselect"]),n(fe,["tap","vclick"],j,{x:Ae[0],y:Ae[1]}),M=!1,j.timeStamp-X<=ye.multiClickDebounceTime()?(ue&&clearTimeout(ue),M=!0,X=null,n(fe,["dbltap","vdblclick"],j,{x:Ae[0],y:Ae[1]})):(ue=setTimeout(function(){M||n(fe,["onetap","voneclick"],j,{x:Ae[0],y:Ae[1]})},ye.multiClickDebounceTime()),X=j.timeStamp)),fe!=null&&!e.dragData.didDrag&&fe._private.selectable&&Ad<e.touchTapThreshold2&&!e.pinching&&(ye.selectionType()==="single"?(ye.$(t).unmerge(fe).unselect(["tapunselect"]),fe.select(["tapselect"])):fe.selected()?fe.unselect(["tapunselect"]):fe.select(["tapselect"]),e.redrawHint("eles",!0)),e.touchData.singleTouchMoved=!0}}}for(var _g=0;_g<Ae.length;_g++)Ve[_g]=Ae[_g];e.dragData.didDrag=!1,j.touches.length===0&&(e.touchData.dragDelta=[],e.touchData.startPosition=null,e.touchData.startGPosition=null,e.touchData.didSelect=!1),j.touches.length<2&&(j.touches.length===1&&(e.touchData.startGPosition=[j.touches[0].clientX,j.touches[0].clientY]),e.pinching=!1,e.redrawHint("eles",!0),e.redraw())},!1),typeof TouchEvent>"u"){var se=[],oe=function(j){return{clientX:j.clientX,clientY:j.clientY,force:1,identifier:j.pointerId,pageX:j.pageX,pageY:j.pageY,radiusX:j.width/2,radiusY:j.height/2,screenX:j.screenX,screenY:j.screenY,target:j.target}},pe=function(j){return{event:j,touch:oe(j)}},Ce=function(j){se.push(pe(j))},ze=function(j){for(var fe=0;fe<se.length;fe++){var _e=se[fe];if(_e.event.pointerId===j.pointerId){se.splice(fe,1);return}}},et=function(j){var fe=se.filter(function(_e){return _e.event.pointerId===j.pointerId})[0];fe.event=j,fe.touch=oe(j)},dt=function(j){j.touches=se.map(function(fe){return fe.touch})},He=function(j){return j.pointerType==="mouse"||j.pointerType===4};e.registerBinding(e.container,"pointerdown",function(Se){He(Se)||(Se.preventDefault(),Ce(Se),dt(Se),ae(Se))}),e.registerBinding(e.container,"pointerup",function(Se){He(Se)||(ze(Se),dt(Se),W(Se))}),e.registerBinding(e.container,"pointercancel",function(Se){He(Se)||(ze(Se),dt(Se),L(Se))}),e.registerBinding(e.container,"pointermove",function(Se){He(Se)||(Se.preventDefault(),et(Se),dt(Se),O(Se))})}};var Kp={};Kp.generatePolygon=function(e,t){return this.nodeShapes[e]={renderer:this,name:e,points:t,draw:function(r,i,s,a,o){this.renderer.nodeShapeImpl("polygon",r,i,s,a,o,this.points)},intersectLine:function(r,i,s,a,o,l,u){return tT(o,l,this.points,r,i,s/2,a/2,u)},checkPoint:function(r,i,s,a,o,l,u){return Tp(r,i,this.points,l,u,a,o,[0,-1],s)}}};Kp.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(t,n,r,i,s){this.renderer.nodeShapeImpl(this.name,t,n,r,i,s)},intersectLine:function(t,n,r,i,s,a,o){return wst(s,a,t,n,r/2+o,i/2+o)},checkPoint:function(t,n,r,i,s,a,o){return _1(t,n,i,s,a,o,r)}}};Kp.generateRoundPolygon=function(e,t){for(var n=new Array(t.length*2),r=0;r<t.length/2;r++){var i=r*2,s=void 0;r<t.length/2-1?s=(r+1)*2:s=0,n[r*4]=t[i],n[r*4+1]=t[i+1];var a=t[s]-t[i],o=t[s+1]-t[i+1],l=Math.sqrt(a*a+o*o);n[r*4+2]=a/l,n[r*4+3]=o/l}return this.nodeShapes[e]={renderer:this,name:e,points:n,draw:function(c,f,h,d,p){this.renderer.nodeShapeImpl("round-polygon",c,f,h,d,p,this.points)},intersectLine:function(c,f,h,d,p,g,m){return $st(p,g,this.points,c,f,h,d)},checkPoint:function(c,f,h,d,p,g,m){return xst(c,f,this.points,g,m,d,p)}}};Kp.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Ba(4,0),draw:function(t,n,r,i,s){this.renderer.nodeShapeImpl(this.name,t,n,r,i,s)},intersectLine:function(t,n,r,i,s,a,o){return Hke(s,a,t,n,r,i,o)},checkPoint:function(t,n,r,i,s,a,o){var l=lI(i,s),u=l*2;return!!(Tp(t,n,this.points,a,o,i,s-u,[0,-1],r)||Tp(t,n,this.points,a,o,i-u,s,[0,-1],r)||_1(t,n,u,u,a-i/2+l,o-s/2+l,r)||_1(t,n,u,u,a+i/2-l,o-s/2+l,r)||_1(t,n,u,u,a+i/2-l,o+s/2-l,r)||_1(t,n,u,u,a-i/2+l,o+s/2-l,r))}}};Kp.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:Xke(),points:Ba(4,0),draw:function(t,n,r,i,s){this.renderer.nodeShapeImpl(this.name,t,n,r,i,s)},generateCutTrianglePts:function(t,n,r,i){var s=this.cornerLength,a=n/2,o=t/2,l=r-o,u=r+o,c=i-a,f=i+a;return{topLeft:[l,c+s,l+s,c,l+s,c+s],topRight:[u-s,c,u,c+s,u-s,c+s],bottomRight:[u,f-s,u-s,f,u-s,f-s],bottomLeft:[l+s,f,l,f-s,l+s,f-s]}},intersectLine:function(t,n,r,i,s,a,o){var l=this.generateCutTrianglePts(r+2*o,i+2*o,t,n),u=[].concat.apply([],[l.topLeft.splice(0,4),l.topRight.splice(0,4),l.bottomRight.splice(0,4),l.bottomLeft.splice(0,4)]);return tT(s,a,u,t,n)},checkPoint:function(t,n,r,i,s,a,o){if(Tp(t,n,this.points,a,o,i,s-2*this.cornerLength,[0,-1],r)||Tp(t,n,this.points,a,o,i-2*this.cornerLength,s,[0,-1],r))return!0;var l=this.generateCutTrianglePts(i,s,a,o);return Lo(t,n,l.topLeft)||Lo(t,n,l.topRight)||Lo(t,n,l.bottomRight)||Lo(t,n,l.bottomLeft)}}};Kp.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Ba(4,0),draw:function(t,n,r,i,s){this.renderer.nodeShapeImpl(this.name,t,n,r,i,s)},intersectLine:function(t,n,r,i,s,a,o){var l=.15,u=.5,c=.85,f=this.generateBarrelBezierPts(r+2*o,i+2*o,t,n),h=function(g){var m=W2({x:g[0],y:g[1]},{x:g[2],y:g[3]},{x:g[4],y:g[5]},l),v=W2({x:g[0],y:g[1]},{x:g[2],y:g[3]},{x:g[4],y:g[5]},u),y=W2({x:g[0],y:g[1]},{x:g[2],y:g[3]},{x:g[4],y:g[5]},c);return[g[0],g[1],m.x,m.y,v.x,v.y,y.x,y.y,g[4],g[5]]},d=[].concat(h(f.topLeft),h(f.topRight),h(f.bottomRight),h(f.bottomLeft));return tT(s,a,d,t,n)},generateBarrelBezierPts:function(t,n,r,i){var s=n/2,a=t/2,o=r-a,l=r+a,u=i-s,c=i+s,f=oY(t,n),h=f.heightOffset,d=f.widthOffset,p=f.ctrlPtOffsetPct*t,g={topLeft:[o,u+h,o+p,u,o+d,u],topRight:[l-d,u,l-p,u,l,u+h],bottomRight:[l,c-h,l-p,c,l-d,c],bottomLeft:[o+d,c,o+p,c,o,c-h]};return g.topLeft.isTop=!0,g.topRight.isTop=!0,g.bottomLeft.isBottom=!0,g.bottomRight.isBottom=!0,g},checkPoint:function(t,n,r,i,s,a,o){var l=oY(i,s),u=l.heightOffset,c=l.widthOffset;if(Tp(t,n,this.points,a,o,i,s-2*u,[0,-1],r)||Tp(t,n,this.points,a,o,i-2*c,s,[0,-1],r))return!0;for(var f=this.generateBarrelBezierPts(i,s,a,o),h=function($,_,k){var E=k[4],S=k[2],I=k[0],A=k[5],D=k[1],T=Math.min(E,I),N=Math.max(E,I),F=Math.min(A,D),R=Math.max(A,D);if(T<=$&&$<=N&&F<=_&&_<=R){var P=Cst(E,S,I),V=mst(P[0],P[1],P[2],$),z=V.filter(function(q){return 0<=q&&q<=1});if(z.length>0)return z[0]}return null},d=Object.keys(f),p=0;p<d.length;p++){var g=d[p],m=f[g],v=h(t,n,m);if(v!=null){var y=m[5],b=m[3],x=m[1],w=Xi(y,b,x,v);if(m.isTop&&w<=n||m.isBottom&&n<=w)return!0}}return!1}}};Kp.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Ba(4,0),draw:function(t,n,r,i,s){this.renderer.nodeShapeImpl(this.name,t,n,r,i,s)},intersectLine:function(t,n,r,i,s,a,o){var l=t-(r/2+o),u=n-(i/2+o),c=u,f=t+(r/2+o),h=Hg(s,a,t,n,l,u,f,c,!1);return h.length>0?h:Hke(s,a,t,n,r,i,o)},checkPoint:function(t,n,r,i,s,a,o){var l=lI(i,s),u=2*l;if(Tp(t,n,this.points,a,o,i,s-u,[0,-1],r)||Tp(t,n,this.points,a,o,i-u,s,[0,-1],r))return!0;var c=i/2+2*r,f=s/2+2*r,h=[a-c,o-f,a-c,o,a+c,o,a+c,o-f];return!!(Lo(t,n,h)||_1(t,n,u,u,a+i/2-l,o+s/2-l,r)||_1(t,n,u,u,a-i/2+l,o+s/2-l,r))}}};Kp.registerNodeShapes=function(){var e=this.nodeShapes={},t=this;this.generateEllipse(),this.generatePolygon("triangle",Ba(3,0)),this.generateRoundPolygon("round-triangle",Ba(3,0)),this.generatePolygon("rectangle",Ba(4,0)),e.square=e.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var n=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",n),this.generateRoundPolygon("round-diamond",n)}this.generatePolygon("pentagon",Ba(5,0)),this.generateRoundPolygon("round-pentagon",Ba(5,0)),this.generatePolygon("hexagon",Ba(6,0)),this.generateRoundPolygon("round-hexagon",Ba(6,0)),this.generatePolygon("heptagon",Ba(7,0)),this.generateRoundPolygon("round-heptagon",Ba(7,0)),this.generatePolygon("octagon",Ba(8,0)),this.generateRoundPolygon("round-octagon",Ba(8,0));var r=new Array(20);{var i=aY(5,0),s=aY(5,Math.PI/5),a=.5*(3-Math.sqrt(5));a*=1.57;for(var o=0;o<s.length/2;o++)s[o*2]*=a,s[o*2+1]*=a;for(var o=0;o<20/4;o++)r[o*4]=i[o*2],r[o*4+1]=i[o*2+1],r[o*4+2]=s[o*2],r[o*4+3]=s[o*2+1]}r=Yke(r),this.generatePolygon("star",r),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l)}e.makePolygon=function(u){var c=u.join("$"),f="polygon-"+c,h;return(h=this[f])?h:t.generatePolygon(f,u)}};var hI={};hI.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};hI.redraw=function(e){e=e||Uke();var t=this;t.averageRedrawTime===void 0&&(t.averageRedrawTime=0),t.lastRedrawTime===void 0&&(t.lastRedrawTime=0),t.lastDrawTime===void 0&&(t.lastDrawTime=0),t.requestedFrame=!0,t.renderOptions=e};hI.beforeRender=function(e,t){if(!this.destroyed){t==null&&Xr("Priority is not optional for beforeRender");var n=this.beforeRenderCallbacks;n.push({fn:e,priority:t}),n.sort(function(r,i){return i.priority-r.priority})}};var Vpe=function(t,n,r){for(var i=t.beforeRenderCallbacks,s=0;s<i.length;s++)i[s].fn(n,r)};hI.startRenderLoop=function(){var e=this,t=e.cy;if(!e.renderLoopStarted){e.renderLoopStarted=!0;var n=function r(i){if(!e.destroyed){if(!t.batching())if(e.requestedFrame&&!e.skipFrame){Vpe(e,!0,i);var s=Ap();e.render(e.renderOptions);var a=e.lastDrawTime=Ap();e.averageRedrawTime===void 0&&(e.averageRedrawTime=a-s),e.redrawCount===void 0&&(e.redrawCount=0),e.redrawCount++,e.redrawTotalTime===void 0&&(e.redrawTotalTime=0);var o=a-s;e.redrawTotalTime+=o,e.lastRedrawTime=o,e.averageRedrawTime=e.averageRedrawTime/2+o/2,e.requestedFrame=!1}else Vpe(e,!1,i);e.skipFrame=!1,o5(r)}};o5(n)}};var Yot=function(t){this.init(t)},PEe=Yot,_C=PEe.prototype;_C.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];_C.init=function(e){var t=this;t.options=e,t.cy=e.cy;var n=t.container=e.cy.container();if(_r){var r=_r.document,i=r.head,s="__________cytoscape_stylesheet",a="__________cytoscape_container",o=r.getElementById(s)!=null;if(n.className.indexOf(a)<0&&(n.className=(n.className||"")+" "+a),!o){var l=r.createElement("style");l.id=s,l.textContent="."+a+" { position: relative; }",i.insertBefore(l,i.children[0])}var u=_r.getComputedStyle(n),c=u.getPropertyValue("position");c==="static"&&Rn("A Cytoscape container has style position:static and so can not use UI extensions properly")}t.selection=[void 0,void 0,void 0,void 0,0],t.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],t.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},t.dragData={possibleDragElements:[]},t.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},t.redraws=0,t.showFps=e.showFps,t.debug=e.debug,t.hideEdgesOnViewport=e.hideEdgesOnViewport,t.textureOnViewport=e.textureOnViewport,t.wheelSensitivity=e.wheelSensitivity,t.motionBlurEnabled=e.motionBlur,t.forcedPixelRatio=Pe(e.pixelRatio)?e.pixelRatio:null,t.motionBlur=e.motionBlur,t.motionBlurOpacity=e.motionBlurOpacity,t.motionBlurTransparency=1-t.motionBlurOpacity,t.motionBlurPxRatio=1,t.mbPxRBlurry=1,t.minMbLowQualFrames=4,t.fullQualityMb=!1,t.clearedForMotionBlur=[],t.desktopTapThreshold=e.desktopTapThreshold,t.desktopTapThreshold2=e.desktopTapThreshold*e.desktopTapThreshold,t.touchTapThreshold=e.touchTapThreshold,t.touchTapThreshold2=e.touchTapThreshold*e.touchTapThreshold,t.tapholdDuration=500,t.bindings=[],t.beforeRenderCallbacks=[],t.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},t.registerNodeShapes(),t.registerArrowShapes(),t.registerCalculationListeners()};_C.notify=function(e,t){var n=this,r=n.cy;if(!this.destroyed){if(e==="init"){n.load();return}if(e==="destroy"){n.destroy();return}(e==="add"||e==="remove"||e==="move"&&r.hasCompoundNodes()||e==="load"||e==="zorder"||e==="mount")&&n.invalidateCachedZSortedEles(),e==="viewport"&&n.redrawHint("select",!0),(e==="load"||e==="resize"||e==="mount")&&(n.invalidateContainerClientCoordsCache(),n.matchCanvasSize(n.container)),n.redrawHint("eles",!0),n.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};_C.destroy=function(){var e=this;e.destroyed=!0,e.cy.stopAnimationLoop();for(var t=0;t<e.bindings.length;t++){var n=e.bindings[t],r=n,i=r.target;(i.off||i.removeEventListener).apply(i,r.args)}if(e.bindings=[],e.beforeRenderCallbacks=[],e.onUpdateEleCalcsFns=[],e.removeObserver&&e.removeObserver.disconnect(),e.styleObserver&&e.styleObserver.disconnect(),e.resizeObserver&&e.resizeObserver.disconnect(),e.labelCalcDiv)try{document.body.removeChild(e.labelCalcDiv)}catch{}};_C.isHeadless=function(){return!1};[Uee,OEe,REe,CC,Kp,hI].forEach(function(e){pt(_C,e)});var tj=1e3/60,LEe={setupDequeueing:function(t){return function(){var r=this,i=this.renderer;if(!r.dequeueingSetup){r.dequeueingSetup=!0;var s=u8.default(function(){i.redrawHint("eles",!0),i.redrawHint("drag",!0),i.redraw()},t.deqRedrawThreshold),a=function(u,c){var f=Ap(),h=i.averageRedrawTime,d=i.lastRedrawTime,p=[],g=i.cy.extent(),m=i.getPixelRatio();for(u||i.flushRenderedStyleQueue();;){var v=Ap(),y=v-f,b=v-c;if(d<tj){var x=tj-(u?h:0);if(b>=t.deqFastCost*x)break}else if(u){if(y>=t.deqCost*d||y>=t.deqAvgCost*h)break}else if(b>=t.deqNoDrawCost*tj)break;var w=t.deq(r,m,g);if(w.length>0)for(var C=0;C<w.length;C++)p.push(w[C]);else break}p.length>0&&(t.onDeqd(r,p),!u&&t.shouldRedraw(r,p,m,g)&&s())},o=t.priority||Tee;i.beforeRender(a,o(r))}}}},Xot=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:l5;_ee(this,e),this.idsByKey=new Xf,this.keyForId=new Xf,this.cachesByLvl=new Xf,this.lvls=[],this.getKey=t,this.doesEleInvalidateKey=n}return See(e,[{key:"getIdsFor",value:function(n){n==null&&Xr("Can not get id list for null key");var r=this.idsByKey,i=this.idsByKey.get(n);return i||(i=new bC,r.set(n,i)),i}},{key:"addIdForKey",value:function(n,r){n!=null&&this.getIdsFor(n).add(r)}},{key:"deleteIdForKey",value:function(n,r){n!=null&&this.getIdsFor(n).delete(r)}},{key:"getNumberOfIdsForKey",value:function(n){return n==null?0:this.getIdsFor(n).size}},{key:"updateKeyMappingFor",value:function(n){var r=n.id(),i=this.keyForId.get(r),s=this.getKey(n);this.deleteIdForKey(i,r),this.addIdForKey(s,r),this.keyForId.set(r,s)}},{key:"deleteKeyMappingFor",value:function(n){var r=n.id(),i=this.keyForId.get(r);this.deleteIdForKey(i,r),this.keyForId.delete(r)}},{key:"keyHasChangedFor",value:function(n){var r=n.id(),i=this.keyForId.get(r),s=this.getKey(n);return i!==s}},{key:"isInvalid",value:function(n){return this.keyHasChangedFor(n)||this.doesEleInvalidateKey(n)}},{key:"getCachesAt",value:function(n){var r=this.cachesByLvl,i=this.lvls,s=r.get(n);return s||(s=new Xf,r.set(n,s),i.push(n)),s}},{key:"getCache",value:function(n,r){return this.getCachesAt(r).get(n)}},{key:"get",value:function(n,r){var i=this.getKey(n),s=this.getCache(i,r);return s!=null&&this.updateKeyMappingFor(n),s}},{key:"getForCachedKey",value:function(n,r){var i=this.keyForId.get(n.id()),s=this.getCache(i,r);return s}},{key:"hasCache",value:function(n,r){return this.getCachesAt(r).has(n)}},{key:"has",value:function(n,r){var i=this.getKey(n);return this.hasCache(i,r)}},{key:"setCache",value:function(n,r,i){i.key=n,this.getCachesAt(r).set(n,i)}},{key:"set",value:function(n,r,i){var s=this.getKey(n);this.setCache(s,r,i),this.updateKeyMappingFor(n)}},{key:"deleteCache",value:function(n,r){this.getCachesAt(r).delete(n)}},{key:"delete",value:function(n,r){var i=this.getKey(n);this.deleteCache(i,r)}},{key:"invalidateKey",value:function(n){var r=this;this.lvls.forEach(function(i){return r.deleteCache(n,i)})}},{key:"invalidate",value:function(n){var r=n.id(),i=this.keyForId.get(r);this.deleteKeyMappingFor(n);var s=this.doesEleInvalidateKey(n);return s&&this.invalidateKey(i),s||this.getNumberOfIdsForKey(i)===0}}]),e}(),jpe=25,ZF=50,QR=-4,pY=3,Kot=7.99,Zot=8,Qot=1024,Jot=1024,elt=1024,tlt=.2,nlt=.8,rlt=10,ilt=.15,slt=.1,alt=.9,olt=.9,llt=100,ult=1,D2={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},clt=Gs({getKey:null,doesEleInvalidateKey:l5,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:Lke,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),Jk=function(t,n){var r=this;r.renderer=t,r.onDequeues=[];var i=clt(n);pt(r,i),r.lookup=new Xot(i.getKey,i.doesEleInvalidateKey),r.setupDequeueing()},Ri=Jk.prototype;Ri.reasons=D2;Ri.getTextureQueue=function(e){var t=this;return t.eleImgCaches=t.eleImgCaches||{},t.eleImgCaches[e]=t.eleImgCaches[e]||[]};Ri.getRetiredTextureQueue=function(e){var t=this,n=t.eleImgCaches.retired=t.eleImgCaches.retired||{},r=n[e]=n[e]||[];return r};Ri.getElementQueue=function(){var e=this,t=e.eleCacheQueue=e.eleCacheQueue||new sI.default(function(n,r){return r.reqs-n.reqs});return t};Ri.getElementKeyToQueue=function(){var e=this,t=e.eleKeyToCacheQueue=e.eleKeyToCacheQueue||{};return t};Ri.getElement=function(e,t,n,r,i){var s=this,a=this.renderer,o=a.cy.zoom(),l=this.lookup;if(!t||t.w===0||t.h===0||isNaN(t.w)||isNaN(t.h)||!e.visible()||e.removed()||!s.allowEdgeTxrCaching&&e.isEdge()||!s.allowParentTxrCaching&&e.isParent())return null;if(r==null&&(r=Math.ceil(Iee(o*n))),r<QR)r=QR;else if(o>=Kot||r>pY)return null;var u=Math.pow(2,r),c=t.h*u,f=t.w*u,h=a.eleTextBiggerThanMin(e,u);if(!this.isVisible(e,h))return null;var d=l.get(e,r);if(d&&d.invalidated&&(d.invalidated=!1,d.texture.invalidatedWidth-=d.width),d)return d;var p;if(c<=jpe?p=jpe:c<=ZF?p=ZF:p=Math.ceil(c/ZF)*ZF,c>elt||f>Jot)return null;var g=s.getTextureQueue(p),m=g[g.length-2],v=function(){return s.recycleTexture(p,f)||s.addTexture(p,f)};m||(m=g[g.length-1]),m||(m=v()),m.width-m.usedWidth<f&&(m=v());for(var y=function(N){return N&&N.scaledLabelShown===h},b=i&&i===D2.dequeue,x=i&&i===D2.highQuality,w=i&&i===D2.downscale,C,$=r+1;$<=pY;$++){var _=l.get(e,$);if(_){C=_;break}}var k=C&&C.level===r+1?C:null,E=function(){m.context.drawImage(k.texture.canvas,k.x,0,k.width,k.height,m.usedWidth,0,f,c)};if(m.context.setTransform(1,0,0,1,0,0),m.context.clearRect(m.usedWidth,0,f,p),y(k))E();else if(y(C))if(x){for(var S=C.level;S>r;S--)k=s.getElement(e,t,n,S,D2.downscale);E()}else return s.queueElement(e,C.level-1),C;else{var I;if(!b&&!x&&!w)for(var A=r-1;A>=QR;A--){var D=l.get(e,A);if(D){I=D;break}}if(y(I))return s.queueElement(e,r),I;m.context.translate(m.usedWidth,0),m.context.scale(u,u),this.drawElement(m.context,e,t,h,!1),m.context.scale(1/u,1/u),m.context.translate(-m.usedWidth,0)}return d={x:m.usedWidth,texture:m,level:r,scale:u,width:f,height:c,scaledLabelShown:h},m.usedWidth+=Math.ceil(f+Zot),m.eleCaches.push(d),l.set(e,r,d),s.checkTextureFullness(m),d};Ri.invalidateElements=function(e){for(var t=0;t<e.length;t++)this.invalidateElement(e[t])};Ri.invalidateElement=function(e){var t=this,n=t.lookup,r=[],i=n.isInvalid(e);if(!!i){for(var s=QR;s<=pY;s++){var a=n.getForCachedKey(e,s);a&&r.push(a)}var o=n.invalidate(e);if(o)for(var l=0;l<r.length;l++){var u=r[l],c=u.texture;c.invalidatedWidth+=u.width,u.invalidated=!0,t.checkTextureUtility(c)}t.removeFromQueue(e)}};Ri.checkTextureUtility=function(e){e.invalidatedWidth>=tlt*e.width&&this.retireTexture(e)};Ri.checkTextureFullness=function(e){var t=this,n=t.getTextureQueue(e.height);e.usedWidth/e.width>nlt&&e.fullnessChecks>=rlt?N0(n,e):e.fullnessChecks++};Ri.retireTexture=function(e){var t=this,n=e.height,r=t.getTextureQueue(n),i=this.lookup;N0(r,e),e.retired=!0;for(var s=e.eleCaches,a=0;a<s.length;a++){var o=s[a];i.deleteCache(o.key,o.level)}Dee(s);var l=t.getRetiredTextureQueue(n);l.push(e)};Ri.addTexture=function(e,t){var n=this,r=n.getTextureQueue(e),i={};return r.push(i),i.eleCaches=[],i.height=e,i.width=Math.max(Qot,t),i.usedWidth=0,i.invalidatedWidth=0,i.fullnessChecks=0,i.canvas=n.renderer.makeOffscreenCanvas(i.width,i.height),i.context=i.canvas.getContext("2d"),i};Ri.recycleTexture=function(e,t){for(var n=this,r=n.getTextureQueue(e),i=n.getRetiredTextureQueue(e),s=0;s<i.length;s++){var a=i[s];if(a.width>=t)return a.retired=!1,a.usedWidth=0,a.invalidatedWidth=0,a.fullnessChecks=0,Dee(a.eleCaches),a.context.setTransform(1,0,0,1,0,0),a.context.clearRect(0,0,a.width,a.height),N0(i,a),r.push(a),a}};Ri.queueElement=function(e,t){var n=this,r=n.getElementQueue(),i=n.getElementKeyToQueue(),s=this.getKey(e),a=i[s];if(a)a.level=Math.max(a.level,t),a.eles.merge(e),a.reqs++,r.updateItem(a);else{var o={eles:e.spawn().merge(e),level:t,reqs:1,key:s};r.push(o),i[s]=o}};Ri.dequeue=function(e){for(var t=this,n=t.getElementQueue(),r=t.getElementKeyToQueue(),i=[],s=t.lookup,a=0;a<ult&&n.size()>0;a++){var o=n.pop(),l=o.key,u=o.eles[0],c=s.hasCache(u,o.level);if(r[l]=null,c)continue;i.push(o);var f=t.getBoundingBox(u);t.getElement(u,f,e,o.level,D2.dequeue)}return i};Ri.removeFromQueue=function(e){var t=this,n=t.getElementQueue(),r=t.getElementKeyToQueue(),i=this.getKey(e),s=r[i];s!=null&&(s.eles.length===1?(s.reqs=Aee,n.updateItem(s),n.pop(),r[i]=null):s.eles.unmerge(e))};Ri.onDequeue=function(e){this.onDequeues.push(e)};Ri.offDequeue=function(e){N0(this.onDequeues,e)};Ri.setupDequeueing=LEe.setupDequeueing({deqRedrawThreshold:llt,deqCost:ilt,deqAvgCost:slt,deqNoDrawCost:alt,deqFastCost:olt,deq:function(t,n,r){return t.dequeue(n,r)},onDeqd:function(t,n){for(var r=0;r<t.onDequeues.length;r++){var i=t.onDequeues[r];i(n)}},shouldRedraw:function(t,n,r,i){for(var s=0;s<n.length;s++)for(var a=n[s].eles,o=0;o<a.length;o++){var l=a[o].boundingBox();if(Nee(l,i))return!0}return!1},priority:function(t){return t.renderer.beforeRenderPriorities.eleTxrDeq}});var flt=1,nA=-4,p5=2,hlt=3.99,dlt=50,plt=50,glt=.15,mlt=.1,vlt=.9,ylt=.9,blt=1,Hpe=250,xlt=4e3*4e3,wlt=!0,BEe=function(t){var n=this,r=n.renderer=t,i=r.cy;n.layersByLevel={},n.firstGet=!0,n.lastInvalidationTime=Ap()-2*Hpe,n.skipping=!1,n.eleTxrDeqs=i.collection(),n.scheduleElementRefinement=u8.default(function(){n.refineElementTextures(n.eleTxrDeqs),n.eleTxrDeqs.unmerge(n.eleTxrDeqs)},plt),r.beforeRender(function(a,o){o-n.lastInvalidationTime<=Hpe?n.skipping=!0:n.skipping=!1},r.beforeRenderPriorities.lyrTxrSkip);var s=function(o,l){return l.reqs-o.reqs};n.layersQueue=new sI.default(s),n.setupDequeueing()},Ys=BEe.prototype,qpe=0,$lt=Math.pow(2,53)-1;Ys.makeLayer=function(e,t){var n=Math.pow(2,t),r=Math.ceil(e.w*n),i=Math.ceil(e.h*n),s=this.renderer.makeOffscreenCanvas(r,i),a={id:qpe=++qpe%$lt,bb:e,level:t,width:r,height:i,canvas:s,context:s.getContext("2d"),eles:[],elesQueue:[],reqs:0},o=a.context,l=-a.bb.x1,u=-a.bb.y1;return o.scale(n,n),o.translate(l,u),a};Ys.getLayers=function(e,t,n){var r=this,i=r.renderer,s=i.cy,a=s.zoom(),o=r.firstGet;if(r.firstGet=!1,n==null){if(n=Math.ceil(Iee(a*t)),n<nA)n=nA;else if(a>=hlt||n>p5)return null}r.validateLayersElesOrdering(n,e);var l=r.layersByLevel,u=Math.pow(2,n),c=l[n]=l[n]||[],f,h=r.levelIsComplete(n,e),d,p=function(){var E=function(T){if(r.validateLayersElesOrdering(T,e),r.levelIsComplete(T,e))return d=l[T],!0},S=function(T){if(!d)for(var N=n+T;nA<=N&&N<=p5&&!E(N);N+=T);};S(1),S(-1);for(var I=c.length-1;I>=0;I--){var A=c[I];A.invalid&&N0(c,A)}};if(!h)p();else return c;var g=function(){if(!f){f=il();for(var E=0;E<e.length;E++)fst(f,e[E].boundingBox())}return f},m=function(E){E=E||{};var S=E.after;g();var I=f.w*u*(f.h*u);if(I>xlt)return null;var A=r.makeLayer(f,n);if(S!=null){var D=c.indexOf(S)+1;c.splice(D,0,A)}else(E.insert===void 0||E.insert)&&c.unshift(A);return A};if(r.skipping&&!o)return null;for(var v=null,y=e.length/flt,b=!o,x=0;x<e.length;x++){var w=e[x],C=w._private.rscratch,$=C.imgLayerCaches=C.imgLayerCaches||{},_=$[n];if(_){v=_;continue}if((!v||v.eles.length>=y||!jke(v.bb,w.boundingBox()))&&(v=m({insert:!0,after:v}),!v))return null;d||b?r.queueLayer(v,w):r.drawEleInLayer(v,w,n,t),v.eles.push(w),$[n]=v}return d||(b?null:c)};Ys.getEleLevelForLayerLevel=function(e,t){return e};Ys.drawEleInLayer=function(e,t,n,r){var i=this,s=this.renderer,a=e.context,o=t.boundingBox();o.w===0||o.h===0||!t.visible()||(n=i.getEleLevelForLayerLevel(n,r),s.setImgSmoothing(a,!1),s.drawCachedElement(a,t,null,null,n,wlt),s.setImgSmoothing(a,!0))};Ys.levelIsComplete=function(e,t){var n=this,r=n.layersByLevel[e];if(!r||r.length===0)return!1;for(var i=0,s=0;s<r.length;s++){var a=r[s];if(a.reqs>0||a.invalid)return!1;i+=a.eles.length}return i===t.length};Ys.validateLayersElesOrdering=function(e,t){var n=this.layersByLevel[e];if(!!n)for(var r=0;r<n.length;r++){for(var i=n[r],s=-1,a=0;a<t.length;a++)if(i.eles[0]===t[a]){s=a;break}if(s<0){this.invalidateLayer(i);continue}for(var o=s,a=0;a<i.eles.length;a++)if(i.eles[a]!==t[o+a]){this.invalidateLayer(i);break}}};Ys.updateElementsInLayers=function(e,t){for(var n=this,r=oI(e[0]),i=0;i<e.length;i++)for(var s=r?null:e[i],a=r?e[i]:e[i].ele,o=a._private.rscratch,l=o.imgLayerCaches=o.imgLayerCaches||{},u=nA;u<=p5;u++){var c=l[u];!c||s&&n.getEleLevelForLayerLevel(c.level)!==s.level||t(c,a,s)}};Ys.haveLayers=function(){for(var e=this,t=!1,n=nA;n<=p5;n++){var r=e.layersByLevel[n];if(r&&r.length>0){t=!0;break}}return t};Ys.invalidateElements=function(e){var t=this;e.length!==0&&(t.lastInvalidationTime=Ap(),!(e.length===0||!t.haveLayers())&&t.updateElementsInLayers(e,function(r,i,s){t.invalidateLayer(r)}))};Ys.invalidateLayer=function(e){if(this.lastInvalidationTime=Ap(),!e.invalid){var t=e.level,n=e.eles,r=this.layersByLevel[t];N0(r,e),e.elesQueue=[],e.invalid=!0,e.replacement&&(e.replacement.invalid=!0);for(var i=0;i<n.length;i++){var s=n[i]._private.rscratch.imgLayerCaches;s&&(s[t]=null)}}};Ys.refineElementTextures=function(e){var t=this;t.updateElementsInLayers(e,function(r,i,s){var a=r.replacement;if(a||(a=r.replacement=t.makeLayer(r.bb,r.level),a.replaces=r,a.eles=r.eles),!a.reqs)for(var o=0;o<a.eles.length;o++)t.queueLayer(a,a.eles[o])})};Ys.enqueueElementRefinement=function(e){this.eleTxrDeqs.merge(e),this.scheduleElementRefinement()};Ys.queueLayer=function(e,t){var n=this,r=n.layersQueue,i=e.elesQueue,s=i.hasId=i.hasId||{};if(!e.replacement){if(t){if(s[t.id()])return;i.push(t),s[t.id()]=!0}e.reqs?(e.reqs++,r.updateItem(e)):(e.reqs=1,r.push(e))}};Ys.dequeue=function(e){for(var t=this,n=t.layersQueue,r=[],i=0;i<blt&&n.size()!==0;){var s=n.peek();if(s.replacement){n.pop();continue}if(s.replaces&&s!==s.replaces.replacement){n.pop();continue}if(s.invalid){n.pop();continue}var a=s.elesQueue.shift();a&&(t.drawEleInLayer(s,a,s.level,e),i++),r.length===0&&r.push(!0),s.elesQueue.length===0&&(n.pop(),s.reqs=0,s.replaces&&t.applyLayerReplacement(s),t.requestRedraw())}return r};Ys.applyLayerReplacement=function(e){var t=this,n=t.layersByLevel[e.level],r=e.replaces,i=n.indexOf(r);if(!(i<0||r.invalid)){n[i]=e;for(var s=0;s<e.eles.length;s++){var a=e.eles[s]._private,o=a.imgLayerCaches=a.imgLayerCaches||{};o&&(o[e.level]=e)}t.requestRedraw()}};Ys.requestRedraw=u8.default(function(){var e=this.renderer;e.redrawHint("eles",!0),e.redrawHint("drag",!0),e.redraw()},100);Ys.setupDequeueing=LEe.setupDequeueing({deqRedrawThreshold:dlt,deqCost:glt,deqAvgCost:mlt,deqNoDrawCost:vlt,deqFastCost:ylt,deq:function(t,n){return t.dequeue(n)},onDeqd:Tee,shouldRedraw:Lke,priority:function(t){return t.renderer.beforeRenderPriorities.lyrTxrDeq}});var zEe={},Gpe;function Clt(e,t){for(var n=0;n<t.length;n++){var r=t[n];e.lineTo(r.x,r.y)}}function _lt(e,t,n){for(var r,i=0;i<t.length;i++){var s=t[i];i===0&&(r=s),e.lineTo(s.x,s.y)}e.quadraticCurveTo(n.x,n.y,r.x,r.y)}function Ype(e,t,n){e.beginPath&&e.beginPath();for(var r=t,i=0;i<r.length;i++){var s=r[i];e.lineTo(s.x,s.y)}var a=n,o=n[0];e.moveTo(o.x,o.y);for(var i=1;i<a.length;i++){var s=a[i];e.lineTo(s.x,s.y)}e.closePath&&e.closePath()}function Slt(e,t,n,r,i){e.beginPath&&e.beginPath(),e.arc(n,r,i,0,Math.PI*2,!1);var s=t,a=s[0];e.moveTo(a.x,a.y);for(var o=0;o<s.length;o++){var l=s[o];e.lineTo(l.x,l.y)}e.closePath&&e.closePath()}function klt(e,t,n,r){e.arc(t,n,r,0,Math.PI*2,!1)}zEe.arrowShapeImpl=function(e){return(Gpe||(Gpe={polygon:Clt,"triangle-backcurve":_lt,"triangle-tee":Ype,"circle-triangle":Slt,"triangle-cross":Ype,circle:klt}))[e]};var rd={};rd.drawElement=function(e,t,n,r,i,s){var a=this;t.isNode()?a.drawNode(e,t,n,r,i,s):a.drawEdge(e,t,n,r,i,s)};rd.drawElementOverlay=function(e,t){var n=this;t.isNode()?n.drawNodeOverlay(e,t):n.drawEdgeOverlay(e,t)};rd.drawElementUnderlay=function(e,t){var n=this;t.isNode()?n.drawNodeUnderlay(e,t):n.drawEdgeUnderlay(e,t)};rd.drawCachedElementPortion=function(e,t,n,r,i,s,a,o){var l=this,u=n.getBoundingBox(t);if(!(u.w===0||u.h===0)){var c=n.getElement(t,u,r,i,s);if(c!=null){var f=o(l,t);if(f===0)return;var h=a(l,t),d=u.x1,p=u.y1,g=u.w,m=u.h,v,y,b,x,w;if(h!==0){var C=n.getRotationPoint(t);b=C.x,x=C.y,e.translate(b,x),e.rotate(h),w=l.getImgSmoothing(e),w||l.setImgSmoothing(e,!0);var $=n.getRotationOffset(t);v=$.x,y=$.y}else v=d,y=p;var _;f!==1&&(_=e.globalAlpha,e.globalAlpha=_*f),e.drawImage(c.texture.canvas,c.x,0,c.width,c.height,v,y,g,m),f!==1&&(e.globalAlpha=_),h!==0&&(e.rotate(-h),e.translate(-b,-x),w||l.setImgSmoothing(e,!1))}else n.drawElement(e,t)}};var Elt=function(){return 0},Alt=function(t,n){return t.getTextAngle(n,null)},Tlt=function(t,n){return t.getTextAngle(n,"source")},Dlt=function(t,n){return t.getTextAngle(n,"target")},Ilt=function(t,n){return n.effectiveOpacity()},nj=function(t,n){return n.pstyle("text-opacity").pfValue*n.effectiveOpacity()};rd.drawCachedElement=function(e,t,n,r,i,s){var a=this,o=a.data,l=o.eleTxrCache,u=o.lblTxrCache,c=o.slbTxrCache,f=o.tlbTxrCache,h=t.boundingBox(),d=s===!0?l.reasons.highQuality:null;if(!(h.w===0||h.h===0||!t.visible())&&(!r||Nee(h,r))){var p=t.isEdge(),g=t.element()._private.rscratch.badLine;a.drawElementUnderlay(e,t),a.drawCachedElementPortion(e,t,l,n,i,d,Elt,Ilt),(!p||!g)&&a.drawCachedElementPortion(e,t,u,n,i,d,Alt,nj),p&&!g&&(a.drawCachedElementPortion(e,t,c,n,i,d,Tlt,nj),a.drawCachedElementPortion(e,t,f,n,i,d,Dlt,nj)),a.drawElementOverlay(e,t)}};rd.drawElements=function(e,t){for(var n=this,r=0;r<t.length;r++){var i=t[r];n.drawElement(e,i)}};rd.drawCachedElements=function(e,t,n,r){for(var i=this,s=0;s<t.length;s++){var a=t[s];i.drawCachedElement(e,a,n,r)}};rd.drawCachedNodes=function(e,t,n,r){for(var i=this,s=0;s<t.length;s++){var a=t[s];!a.isNode()||i.drawCachedElement(e,a,n,r)}};rd.drawLayeredElements=function(e,t,n,r){var i=this,s=i.data.lyrTxrCache.getLayers(t,n);if(s)for(var a=0;a<s.length;a++){var o=s[a],l=o.bb;l.w===0||l.h===0||e.drawImage(o.canvas,l.x1,l.y1,l.w,l.h)}else i.drawCachedElements(e,t,n,r)};var Zp={};Zp.drawEdge=function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,a=this,o=t._private.rscratch;if(!(s&&!t.visible())&&!(o.badLine||o.allpts==null||isNaN(o.allpts[0]))){var l;n&&(l=n,e.translate(-l.x1,-l.y1));var u=s?t.pstyle("opacity").value:1,c=s?t.pstyle("line-opacity").value:1,f=t.pstyle("curve-style").value,h=t.pstyle("line-style").value,d=t.pstyle("width").pfValue,p=t.pstyle("line-cap").value,g=u*c,m=u*c,v=function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g;f==="straight-triangle"?(a.eleStrokeStyle(e,t,I),a.drawEdgeTrianglePath(t,e,o.allpts)):(e.lineWidth=d,e.lineCap=p,a.eleStrokeStyle(e,t,I),a.drawEdgePath(t,e,o.allpts,h),e.lineCap="butt")},y=function(){!i||a.drawEdgeOverlay(e,t)},b=function(){!i||a.drawEdgeUnderlay(e,t)},x=function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m;a.drawArrowheads(e,t,I)},w=function(){a.drawElementText(e,t,null,r)};e.lineJoin="round";var C=t.pstyle("ghost").value==="yes";if(C){var $=t.pstyle("ghost-offset-x").pfValue,_=t.pstyle("ghost-offset-y").pfValue,k=t.pstyle("ghost-opacity").value,E=g*k;e.translate($,_),v(E),x(E),e.translate(-$,-_)}b(),v(),x(),y(),w(),n&&e.translate(l.x1,l.y1)}};var UEe=function(t){if(!["overlay","underlay"].includes(t))throw new Error("Invalid state");return function(n,r){if(!!r.visible()){var i=r.pstyle("".concat(t,"-opacity")).value;if(i!==0){var s=this,a=s.usePaths(),o=r._private.rscratch,l=r.pstyle("".concat(t,"-padding")).pfValue,u=2*l,c=r.pstyle("".concat(t,"-color")).value;n.lineWidth=u,o.edgeType==="self"&&!a?n.lineCap="butt":n.lineCap="round",s.colorStrokeStyle(n,c[0],c[1],c[2],i),s.drawEdgePath(r,n,o.allpts,"solid")}}}};Zp.drawEdgeOverlay=UEe("overlay");Zp.drawEdgeUnderlay=UEe("underlay");Zp.drawEdgePath=function(e,t,n,r){var i=e._private.rscratch,s=t,a,o=!1,l=this.usePaths(),u=e.pstyle("line-dash-pattern").pfValue,c=e.pstyle("line-dash-offset").pfValue;if(l){var f=n.join("$"),h=i.pathCacheKey&&i.pathCacheKey===f;h?(a=t=i.pathCache,o=!0):(a=t=new Path2D,i.pathCacheKey=f,i.pathCache=a)}if(s.setLineDash)switch(r){case"dotted":s.setLineDash([1,1]);break;case"dashed":s.setLineDash(u),s.lineDashOffset=c;break;case"solid":s.setLineDash([]);break}if(!o&&!i.badLine)switch(t.beginPath&&t.beginPath(),t.moveTo(n[0],n[1]),i.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var d=2;d+3<n.length;d+=4)t.quadraticCurveTo(n[d],n[d+1],n[d+2],n[d+3]);break;case"straight":case"segments":case"haystack":for(var p=2;p+1<n.length;p+=2)t.lineTo(n[p],n[p+1]);break}t=s,l?t.stroke(a):t.stroke(),t.setLineDash&&t.setLineDash([])};Zp.drawEdgeTrianglePath=function(e,t,n){t.fillStyle=t.strokeStyle;for(var r=e.pstyle("width").pfValue,i=0;i+1<n.length;i+=2){var s=[n[i+2]-n[i],n[i+3]-n[i+1]],a=Math.sqrt(s[0]*s[0]+s[1]*s[1]),o=[s[1]/a,-s[0]/a],l=[o[0]*r/2,o[1]*r/2];t.beginPath(),t.moveTo(n[i]-l[0],n[i+1]-l[1]),t.lineTo(n[i]+l[0],n[i+1]+l[1]),t.lineTo(n[i+2],n[i+3]),t.closePath(),t.fill()}};Zp.drawArrowheads=function(e,t,n){var r=t._private.rscratch,i=r.edgeType==="haystack";i||this.drawArrowhead(e,t,"source",r.arrowStartX,r.arrowStartY,r.srcArrowAngle,n),this.drawArrowhead(e,t,"mid-target",r.midX,r.midY,r.midtgtArrowAngle,n),this.drawArrowhead(e,t,"mid-source",r.midX,r.midY,r.midsrcArrowAngle,n),i||this.drawArrowhead(e,t,"target",r.arrowEndX,r.arrowEndY,r.tgtArrowAngle,n)};Zp.drawArrowhead=function(e,t,n,r,i,s,a){if(!(isNaN(r)||r==null||isNaN(i)||i==null||isNaN(s)||s==null)){var o=this,l=t.pstyle(n+"-arrow-shape").value;if(l!=="none"){var u=t.pstyle(n+"-arrow-fill").value==="hollow"?"both":"filled",c=t.pstyle(n+"-arrow-fill").value,f=t.pstyle("width").pfValue,h=t.pstyle("opacity").value;a===void 0&&(a=h);var d=e.globalCompositeOperation;(a!==1||c==="hollow")&&(e.globalCompositeOperation="destination-out",o.colorFillStyle(e,255,255,255,1),o.colorStrokeStyle(e,255,255,255,1),o.drawArrowShape(t,e,u,f,l,r,i,s),e.globalCompositeOperation=d);var p=t.pstyle(n+"-arrow-color").value;o.colorFillStyle(e,p[0],p[1],p[2],a),o.colorStrokeStyle(e,p[0],p[1],p[2],a),o.drawArrowShape(t,e,c,f,l,r,i,s)}}};Zp.drawArrowShape=function(e,t,n,r,i,s,a,o){var l=this,u=this.usePaths()&&i!=="triangle-cross",c=!1,f,h=t,d={x:s,y:a},p=e.pstyle("arrow-scale").value,g=this.getArrowWidth(r,p),m=l.arrowShapes[i];if(u){var v=l.arrowPathCache=l.arrowPathCache||[],y=Sy(i),b=v[y];b!=null?(f=t=b,c=!0):(f=t=new Path2D,v[y]=f)}c||(t.beginPath&&t.beginPath(),u?m.draw(t,1,0,{x:0,y:0},1):m.draw(t,g,o,d,r),t.closePath&&t.closePath()),t=h,u&&(t.translate(s,a),t.rotate(o),t.scale(g,g)),(n==="filled"||n==="both")&&(u?t.fill(f):t.fill()),(n==="hollow"||n==="both")&&(t.lineWidth=(m.matchEdgeWidth?r:1)/(u?g:1),t.lineJoin="miter",u?t.stroke(f):t.stroke()),u&&(t.scale(1/g,1/g),t.rotate(-o),t.translate(-s,-a))};var Vee={};Vee.safeDrawImage=function(e,t,n,r,i,s,a,o,l,u){if(!(i<=0||s<=0||l<=0||u<=0))try{e.drawImage(t,n,r,i,s,a,o,l,u)}catch(c){Rn(c)}};Vee.drawInscribedImage=function(e,t,n,r,i){var s=this,a=n.position(),o=a.x,l=a.y,u=n.cy().style(),c=u.getIndexedStyle.bind(u),f=c(n,"background-fit","value",r),h=c(n,"background-repeat","value",r),d=n.width(),p=n.height(),g=n.padding()*2,m=d+(c(n,"background-width-relative-to","value",r)==="inner"?0:g),v=p+(c(n,"background-height-relative-to","value",r)==="inner"?0:g),y=n._private.rscratch,b=c(n,"background-clip","value",r),x=b==="node",w=c(n,"background-image-opacity","value",r)*i,C=c(n,"background-image-smoothing","value",r),$=t.width||t.cachedW,_=t.height||t.cachedH;($==null||_==null)&&(document.body.appendChild(t),$=t.cachedW=t.width||t.offsetWidth,_=t.cachedH=t.height||t.offsetHeight,document.body.removeChild(t));var k=$,E=_;if(c(n,"background-width","value",r)!=="auto"&&(c(n,"background-width","units",r)==="%"?k=c(n,"background-width","pfValue",r)*m:k=c(n,"background-width","pfValue",r)),c(n,"background-height","value",r)!=="auto"&&(c(n,"background-height","units",r)==="%"?E=c(n,"background-height","pfValue",r)*v:E=c(n,"background-height","pfValue",r)),!(k===0||E===0)){if(f==="contain"){var S=Math.min(m/k,v/E);k*=S,E*=S}else if(f==="cover"){var S=Math.max(m/k,v/E);k*=S,E*=S}var I=o-m/2,A=c(n,"background-position-x","units",r),D=c(n,"background-position-x","pfValue",r);A==="%"?I+=(m-k)*D:I+=D;var T=c(n,"background-offset-x","units",r),N=c(n,"background-offset-x","pfValue",r);T==="%"?I+=(m-k)*N:I+=N;var F=l-v/2,R=c(n,"background-position-y","units",r),P=c(n,"background-position-y","pfValue",r);R==="%"?F+=(v-E)*P:F+=P;var V=c(n,"background-offset-y","units",r),z=c(n,"background-offset-y","pfValue",r);V==="%"?F+=(v-E)*z:F+=z,y.pathCache&&(I-=o,F-=l,o=0,l=0);var q=e.globalAlpha;e.globalAlpha=w;var G=s.getImgSmoothing(e),K=!1;if(C==="no"&&G?(s.setImgSmoothing(e,!1),K=!0):C==="yes"&&!G&&(s.setImgSmoothing(e,!0),K=!0),h==="no-repeat")x&&(e.save(),y.pathCache?e.clip(y.pathCache):(s.nodeShapes[s.getNodeShape(n)].draw(e,o,l,m,v),e.clip())),s.safeDrawImage(e,t,0,0,$,_,I,F,k,E),x&&e.restore();else{var Y=e.createPattern(t,h);e.fillStyle=Y,s.nodeShapes[s.getNodeShape(n)].draw(e,o,l,m,v),e.translate(I,F),e.fill(),e.translate(-I,-F)}e.globalAlpha=q,K&&s.setImgSmoothing(e,G)}};var Rb={};Rb.eleTextBiggerThanMin=function(e,t){if(!t){var n=e.cy().zoom(),r=this.getPixelRatio(),i=Math.ceil(Iee(n*r));t=Math.pow(2,i)}var s=e.pstyle("font-size").pfValue*t,a=e.pstyle("min-zoomed-font-size").pfValue;return!(s<a)};Rb.drawElementText=function(e,t,n,r,i){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,a=this;if(r==null){if(s&&!a.eleTextBiggerThanMin(t))return}else if(r===!1)return;if(t.isNode()){var o=t.pstyle("label");if(!o||!o.value)return;var l=a.getLabelJustification(t);e.textAlign=l,e.textBaseline="bottom"}else{var u=t.element()._private.rscratch.badLine,c=t.pstyle("label"),f=t.pstyle("source-label"),h=t.pstyle("target-label");if(u||(!c||!c.value)&&(!f||!f.value)&&(!h||!h.value))return;e.textAlign="center",e.textBaseline="bottom"}var d=!n,p;n&&(p=n,e.translate(-p.x1,-p.y1)),i==null?(a.drawText(e,t,null,d,s),t.isEdge()&&(a.drawText(e,t,"source",d,s),a.drawText(e,t,"target",d,s))):a.drawText(e,t,i,d,s),n&&e.translate(p.x1,p.y1)};Rb.getFontCache=function(e){var t;this.fontCaches=this.fontCaches||[];for(var n=0;n<this.fontCaches.length;n++)if(t=this.fontCaches[n],t.context===e)return t;return t={context:e},this.fontCaches.push(t),t};Rb.setupTextStyle=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=t.pstyle("font-style").strValue,i=t.pstyle("font-size").pfValue+"px",s=t.pstyle("font-family").strValue,a=t.pstyle("font-weight").strValue,o=n?t.effectiveOpacity()*t.pstyle("text-opacity").value:1,l=t.pstyle("text-outline-opacity").value*o,u=t.pstyle("color").value,c=t.pstyle("text-outline-color").value;e.font=r+" "+a+" "+i+" "+s,e.lineJoin="round",this.colorFillStyle(e,u[0],u[1],u[2],o),this.colorStrokeStyle(e,c[0],c[1],c[2],l)};function Nlt(e,t,n,r,i){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5;e.beginPath(),e.moveTo(t+s,n),e.lineTo(t+r-s,n),e.quadraticCurveTo(t+r,n,t+r,n+s),e.lineTo(t+r,n+i-s),e.quadraticCurveTo(t+r,n+i,t+r-s,n+i),e.lineTo(t+s,n+i),e.quadraticCurveTo(t,n+i,t,n+i-s),e.lineTo(t,n+s),e.quadraticCurveTo(t,n,t+s,n),e.closePath(),e.fill()}Rb.getTextAngle=function(e,t){var n,r=e._private,i=r.rscratch,s=t?t+"-":"",a=e.pstyle(s+"text-rotation"),o=gc(i,"labelAngle",t);return a.strValue==="autorotate"?n=e.isEdge()?o:0:a.strValue==="none"?n=0:n=a.pfValue,n};Rb.drawText=function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=t._private,a=s.rscratch,o=i?t.effectiveOpacity():1;if(!(i&&(o===0||t.pstyle("text-opacity").value===0))){n==="main"&&(n=null);var l=gc(a,"labelX",n),u=gc(a,"labelY",n),c,f,h=this.getLabelText(t,n);if(h!=null&&h!==""&&!isNaN(l)&&!isNaN(u)){this.setupTextStyle(e,t,i);var d=n?n+"-":"",p=gc(a,"labelWidth",n),g=gc(a,"labelHeight",n),m=t.pstyle(d+"text-margin-x").pfValue,v=t.pstyle(d+"text-margin-y").pfValue,y=t.isEdge(),b=t.pstyle("text-halign").value,x=t.pstyle("text-valign").value;y&&(b="center",x="center"),l+=m,u+=v;var w;switch(r?w=this.getTextAngle(t,n):w=0,w!==0&&(c=l,f=u,e.translate(c,f),e.rotate(w),l=0,u=0),x){case"top":break;case"center":u+=g/2;break;case"bottom":u+=g;break}var C=t.pstyle("text-background-opacity").value,$=t.pstyle("text-border-opacity").value,_=t.pstyle("text-border-width").pfValue,k=t.pstyle("text-background-padding").pfValue;if(C>0||_>0&&$>0){var E=l-k;switch(b){case"left":E-=p;break;case"center":E-=p/2;break}var S=u-g-k,I=p+2*k,A=g+2*k;if(C>0){var D=e.fillStyle,T=t.pstyle("text-background-color").value;e.fillStyle="rgba("+T[0]+","+T[1]+","+T[2]+","+C*o+")";var N=t.pstyle("text-background-shape").strValue;N.indexOf("round")===0?Nlt(e,E,S,I,A,2):e.fillRect(E,S,I,A),e.fillStyle=D}if(_>0&&$>0){var F=e.strokeStyle,R=e.lineWidth,P=t.pstyle("text-border-color").value,V=t.pstyle("text-border-style").value;if(e.strokeStyle="rgba("+P[0]+","+P[1]+","+P[2]+","+$*o+")",e.lineWidth=_,e.setLineDash)switch(V){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"double":e.lineWidth=_/4,e.setLineDash([]);break;case"solid":e.setLineDash([]);break}if(e.strokeRect(E,S,I,A),V==="double"){var z=_/2;e.strokeRect(E+z,S+z,I-z*2,A-z*2)}e.setLineDash&&e.setLineDash([]),e.lineWidth=R,e.strokeStyle=F}}var q=2*t.pstyle("text-outline-width").pfValue;if(q>0&&(e.lineWidth=q),t.pstyle("text-wrap").value==="wrap"){var G=gc(a,"labelWrapCachedLines",n),K=gc(a,"labelLineHeight",n),Y=p/2,te=this.getLabelJustification(t);switch(te==="auto"||(b==="left"?te==="left"?l+=-p:te==="center"&&(l+=-Y):b==="center"?te==="left"?l+=-Y:te==="right"&&(l+=Y):b==="right"&&(te==="center"?l+=Y:te==="right"&&(l+=p))),x){case"top":u-=(G.length-1)*K;break;case"center":case"bottom":u-=(G.length-1)*K;break}for(var Z=0;Z<G.length;Z++)q>0&&e.strokeText(G[Z],l,u),e.fillText(G[Z],l,u),u+=K}else q>0&&e.strokeText(h,l,u),e.fillText(h,l,u);w!==0&&(e.rotate(-w),e.translate(-c,-f))}}};var SC={};SC.drawNode=function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,a=this,o,l,u=t._private,c=u.rscratch,f=t.position();if(!(!Pe(f.x)||!Pe(f.y))&&!(s&&!t.visible())){var h=s?t.effectiveOpacity():1,d=a.usePaths(),p,g=!1,m=t.padding();o=t.width()+2*m,l=t.height()+2*m;var v;n&&(v=n,e.translate(-v.x1,-v.y1));for(var y=t.pstyle("background-image"),b=y.value,x=new Array(b.length),w=new Array(b.length),C=0,$=0;$<b.length;$++){var _=b[$],k=x[$]=_!=null&&_!=="none";if(k){var E=t.cy().style().getIndexedStyle(t,"background-image-crossorigin","value",$);C++,w[$]=a.getCachedImage(_,E,function(){u.backgroundTimestamp=Date.now(),t.emitAndNotify("background")})}}var S=t.pstyle("background-blacken").value,I=t.pstyle("border-width").pfValue,A=t.pstyle("background-opacity").value*h,D=t.pstyle("border-color").value,T=t.pstyle("border-style").value,N=t.pstyle("border-opacity").value*h;e.lineJoin="miter";var F=function(){var Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:A;a.eleFillStyle(e,t,Ce)},R=function(){var Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:N;a.colorStrokeStyle(e,D[0],D[1],D[2],Ce)},P=t.pstyle("shape").strValue,V=t.pstyle("shape-polygon-points").pfValue;if(d){e.translate(f.x,f.y);var z=a.nodePathCache=a.nodePathCache||[],q=Pke(P==="polygon"?P+","+V.join(","):P,""+l,""+o),G=z[q];G!=null?(p=G,g=!0,c.pathCache=p):(p=new Path2D,z[q]=c.pathCache=p)}var K=function(){if(!g){var Ce=f;d&&(Ce={x:0,y:0}),a.nodeShapes[a.getNodeShape(t)].draw(p||e,Ce.x,Ce.y,o,l)}d?e.fill(p):e.fill()},Y=function(){for(var Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h,ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,et=u.backgrounding,dt=0,He=0;He<w.length;He++){var Se=t.cy().style().getIndexedStyle(t,"background-image-containment","value",He);if(ze&&Se==="over"||!ze&&Se==="inside"){dt++;continue}x[He]&&w[He].complete&&!w[He].error&&(dt++,a.drawInscribedImage(e,w[He],t,He,Ce))}u.backgrounding=dt!==C,et!==u.backgrounding&&t.updateStyle(!1)},te=function(){var Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h;a.hasPie(t)&&(a.drawPie(e,t,ze),Ce&&(d||a.nodeShapes[a.getNodeShape(t)].draw(e,f.x,f.y,o,l)))},Z=function(){var Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h,ze=(S>0?S:-S)*Ce,et=S>0?0:255;S!==0&&(a.colorFillStyle(e,et,et,et,ze),d?e.fill(p):e.fill())},ae=function(){if(I>0){if(e.lineWidth=I,e.lineCap="butt",e.setLineDash)switch(T){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"solid":case"double":e.setLineDash([]);break}if(d?e.stroke(p):e.stroke(),T==="double"){e.lineWidth=I/3;var Ce=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",d?e.stroke(p):e.stroke(),e.globalCompositeOperation=Ce}e.setLineDash&&e.setLineDash([])}},O=function(){i&&a.drawNodeOverlay(e,t,f,o,l)},L=function(){i&&a.drawNodeUnderlay(e,t,f,o,l)},W=function(){a.drawElementText(e,t,null,r)},M=t.pstyle("ghost").value==="yes";if(M){var ue=t.pstyle("ghost-offset-x").pfValue,X=t.pstyle("ghost-offset-y").pfValue,se=t.pstyle("ghost-opacity").value,oe=se*h;e.translate(ue,X),F(se*A),K(),Y(oe,!0),R(se*N),ae(),te(S!==0||I!==0),Y(oe,!1),Z(oe),e.translate(-ue,-X)}d&&e.translate(-f.x,-f.y),L(),d&&e.translate(f.x,f.y),F(),K(),Y(h,!0),R(),ae(),te(S!==0||I!==0),Y(h,!1),Z(),d&&e.translate(-f.x,-f.y),W(),O(),n&&e.translate(v.x1,v.y1)}};var WEe=function(t){if(!["overlay","underlay"].includes(t))throw new Error("Invalid state");return function(n,r,i,s,a){var o=this;if(!!r.visible()){var l=r.pstyle("".concat(t,"-padding")).pfValue,u=r.pstyle("".concat(t,"-opacity")).value,c=r.pstyle("".concat(t,"-color")).value,f=r.pstyle("".concat(t,"-shape")).value;if(u>0){if(i=i||r.position(),s==null||a==null){var h=r.padding();s=r.width()+2*h,a=r.height()+2*h}o.colorFillStyle(n,c[0],c[1],c[2],u),o.nodeShapes[f].draw(n,i.x,i.y,s+l*2,a+l*2),n.fill()}}}};SC.drawNodeOverlay=WEe("overlay");SC.drawNodeUnderlay=WEe("underlay");SC.hasPie=function(e){return e=e[0],e._private.hasPie};SC.drawPie=function(e,t,n,r){t=t[0],r=r||t.position();var i=t.cy().style(),s=t.pstyle("pie-size"),a=r.x,o=r.y,l=t.width(),u=t.height(),c=Math.min(l,u)/2,f=0,h=this.usePaths();h&&(a=0,o=0),s.units==="%"?c=c*s.pfValue:s.pfValue!==void 0&&(c=s.pfValue/2);for(var d=1;d<=i.pieBackgroundN;d++){var p=t.pstyle("pie-"+d+"-background-size").value,g=t.pstyle("pie-"+d+"-background-color").value,m=t.pstyle("pie-"+d+"-background-opacity").value*n,v=p/100;v+f>1&&(v=1-f);var y=1.5*Math.PI+2*Math.PI*f,b=2*Math.PI*v,x=y+b;p===0||f>=1||f+v>1||(e.beginPath(),e.moveTo(a,o),e.arc(a,o,c,y,x),e.closePath(),this.colorFillStyle(e,g[0],g[1],g[2],m),e.fill(),f+=v)}};var Zl={},Mlt=100;Zl.getPixelRatio=function(){var e=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/t};Zl.paintCache=function(e){for(var t=this.paintCaches=this.paintCaches||[],n=!0,r,i=0;i<t.length;i++)if(r=t[i],r.context===e){n=!1;break}return n&&(r={context:e},t.push(r)),r};Zl.createGradientStyleFor=function(e,t,n,r,i){var s,a=this.usePaths(),o=n.pstyle(t+"-gradient-stop-colors").value,l=n.pstyle(t+"-gradient-stop-positions").pfValue;if(r==="radial-gradient")if(n.isEdge()){var u=n.sourceEndpoint(),c=n.targetEndpoint(),f=n.midpoint(),h=ky(u,f),d=ky(c,f);s=e.createRadialGradient(f.x,f.y,0,f.x,f.y,Math.max(h,d))}else{var p=a?{x:0,y:0}:n.position(),g=n.paddedWidth(),m=n.paddedHeight();s=e.createRadialGradient(p.x,p.y,0,p.x,p.y,Math.max(g,m))}else if(n.isEdge()){var v=n.sourceEndpoint(),y=n.targetEndpoint();s=e.createLinearGradient(v.x,v.y,y.x,y.y)}else{var b=a?{x:0,y:0}:n.position(),x=n.paddedWidth(),w=n.paddedHeight(),C=x/2,$=w/2,_=n.pstyle("background-gradient-direction").value;switch(_){case"to-bottom":s=e.createLinearGradient(b.x,b.y-$,b.x,b.y+$);break;case"to-top":s=e.createLinearGradient(b.x,b.y+$,b.x,b.y-$);break;case"to-left":s=e.createLinearGradient(b.x+C,b.y,b.x-C,b.y);break;case"to-right":s=e.createLinearGradient(b.x-C,b.y,b.x+C,b.y);break;case"to-bottom-right":case"to-right-bottom":s=e.createLinearGradient(b.x-C,b.y-$,b.x+C,b.y+$);break;case"to-top-right":case"to-right-top":s=e.createLinearGradient(b.x-C,b.y+$,b.x+C,b.y-$);break;case"to-bottom-left":case"to-left-bottom":s=e.createLinearGradient(b.x+C,b.y-$,b.x-C,b.y+$);break;case"to-top-left":case"to-left-top":s=e.createLinearGradient(b.x+C,b.y+$,b.x-C,b.y-$);break}}if(!s)return null;for(var k=l.length===o.length,E=o.length,S=0;S<E;S++)s.addColorStop(k?l[S]:S/(E-1),"rgba("+o[S][0]+","+o[S][1]+","+o[S][2]+","+i+")");return s};Zl.gradientFillStyle=function(e,t,n,r){var i=this.createGradientStyleFor(e,"background",t,n,r);if(!i)return null;e.fillStyle=i};Zl.colorFillStyle=function(e,t,n,r,i){e.fillStyle="rgba("+t+","+n+","+r+","+i+")"};Zl.eleFillStyle=function(e,t,n){var r=t.pstyle("background-fill").value;if(r==="linear-gradient"||r==="radial-gradient")this.gradientFillStyle(e,t,r,n);else{var i=t.pstyle("background-color").value;this.colorFillStyle(e,i[0],i[1],i[2],n)}};Zl.gradientStrokeStyle=function(e,t,n,r){var i=this.createGradientStyleFor(e,"line",t,n,r);if(!i)return null;e.strokeStyle=i};Zl.colorStrokeStyle=function(e,t,n,r,i){e.strokeStyle="rgba("+t+","+n+","+r+","+i+")"};Zl.eleStrokeStyle=function(e,t,n){var r=t.pstyle("line-fill").value;if(r==="linear-gradient"||r==="radial-gradient")this.gradientStrokeStyle(e,t,r,n);else{var i=t.pstyle("line-color").value;this.colorStrokeStyle(e,i[0],i[1],i[2],n)}};Zl.matchCanvasSize=function(e){var t=this,n=t.data,r=t.findContainerClientCoords(),i=r[2],s=r[3],a=t.getPixelRatio(),o=t.motionBlurPxRatio;(e===t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE]||e===t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG])&&(a=o);var l=i*a,u=s*a,c;if(!(l===t.canvasWidth&&u===t.canvasHeight)){t.fontCaches=null;var f=n.canvasContainer;f.style.width=i+"px",f.style.height=s+"px";for(var h=0;h<t.CANVAS_LAYERS;h++)c=n.canvases[h],c.width=l,c.height=u,c.style.width=i+"px",c.style.height=s+"px";for(var h=0;h<t.BUFFER_COUNT;h++)c=n.bufferCanvases[h],c.width=l,c.height=u,c.style.width=i+"px",c.style.height=s+"px";t.textureMult=1,a<=1&&(c=n.bufferCanvases[t.TEXTURE_BUFFER],t.textureMult=2,c.width=l*t.textureMult,c.height=u*t.textureMult),t.canvasWidth=l,t.canvasHeight=u}};Zl.renderTo=function(e,t,n,r){this.render({forcedContext:e,forcedZoom:t,forcedPan:n,drawAllLayers:!0,forcedPxRatio:r})};Zl.render=function(e){e=e||Uke();var t=e.forcedContext,n=e.drawAllLayers,r=e.drawOnlyNodeLayer,i=e.forcedZoom,s=e.forcedPan,a=this,o=e.forcedPxRatio===void 0?this.getPixelRatio():e.forcedPxRatio,l=a.cy,u=a.data,c=u.canvasNeedsRedraw,f=a.textureOnViewport&&!t&&(a.pinching||a.hoverData.dragging||a.swipePanning||a.data.wheelZooming),h=e.motionBlur!==void 0?e.motionBlur:a.motionBlur,d=a.motionBlurPxRatio,p=l.hasCompoundNodes(),g=a.hoverData.draggingEles,m=!!(a.hoverData.selecting||a.touchData.selecting);h=h&&!t&&a.motionBlurEnabled&&!m;var v=h;t||(a.prevPxRatio!==o&&(a.invalidateContainerClientCoordsCache(),a.matchCanvasSize(a.container),a.redrawHint("eles",!0),a.redrawHint("drag",!0)),a.prevPxRatio=o),!t&&a.motionBlurTimeout&&clearTimeout(a.motionBlurTimeout),h&&(a.mbFrames==null&&(a.mbFrames=0),a.mbFrames++,a.mbFrames<3&&(v=!1),a.mbFrames>a.minMbLowQualFrames&&(a.motionBlurPxRatio=a.mbPxRBlurry)),a.clearingMotionBlur&&(a.motionBlurPxRatio=1),a.textureDrawLastFrame&&!f&&(c[a.NODE]=!0,c[a.SELECT_BOX]=!0);var y=l.style(),b=l.zoom(),x=i!==void 0?i:b,w=l.pan(),C={x:w.x,y:w.y},$={zoom:b,pan:{x:w.x,y:w.y}},_=a.prevViewport,k=_===void 0||$.zoom!==_.zoom||$.pan.x!==_.pan.x||$.pan.y!==_.pan.y;!k&&!(g&&!p)&&(a.motionBlurPxRatio=1),s&&(C=s),x*=o,C.x*=o,C.y*=o;var E=a.getCachedZSortedEles();function S(X,se,oe,pe,Ce){var ze=X.globalCompositeOperation;X.globalCompositeOperation="destination-out",a.colorFillStyle(X,255,255,255,a.motionBlurTransparency),X.fillRect(se,oe,pe,Ce),X.globalCompositeOperation=ze}function I(X,se){var oe,pe,Ce,ze;!a.clearingMotionBlur&&(X===u.bufferContexts[a.MOTIONBLUR_BUFFER_NODE]||X===u.bufferContexts[a.MOTIONBLUR_BUFFER_DRAG])?(oe={x:w.x*d,y:w.y*d},pe=b*d,Ce=a.canvasWidth*d,ze=a.canvasHeight*d):(oe=C,pe=x,Ce=a.canvasWidth,ze=a.canvasHeight),X.setTransform(1,0,0,1,0,0),se==="motionBlur"?S(X,0,0,Ce,ze):!t&&(se===void 0||se)&&X.clearRect(0,0,Ce,ze),n||(X.translate(oe.x,oe.y),X.scale(pe,pe)),s&&X.translate(s.x,s.y),i&&X.scale(i,i)}if(f||(a.textureDrawLastFrame=!1),f){if(a.textureDrawLastFrame=!0,!a.textureCache){a.textureCache={},a.textureCache.bb=l.mutableElements().boundingBox(),a.textureCache.texture=a.data.bufferCanvases[a.TEXTURE_BUFFER];var A=a.data.bufferContexts[a.TEXTURE_BUFFER];A.setTransform(1,0,0,1,0,0),A.clearRect(0,0,a.canvasWidth*a.textureMult,a.canvasHeight*a.textureMult),a.render({forcedContext:A,drawOnlyNodeLayer:!0,forcedPxRatio:o*a.textureMult});var $=a.textureCache.viewport={zoom:l.zoom(),pan:l.pan(),width:a.canvasWidth,height:a.canvasHeight};$.mpan={x:(0-$.pan.x)/$.zoom,y:(0-$.pan.y)/$.zoom}}c[a.DRAG]=!1,c[a.NODE]=!1;var D=u.contexts[a.NODE],T=a.textureCache.texture,$=a.textureCache.viewport;D.setTransform(1,0,0,1,0,0),h?S(D,0,0,$.width,$.height):D.clearRect(0,0,$.width,$.height);var N=y.core("outside-texture-bg-color").value,F=y.core("outside-texture-bg-opacity").value;a.colorFillStyle(D,N[0],N[1],N[2],F),D.fillRect(0,0,$.width,$.height);var b=l.zoom();I(D,!1),D.clearRect($.mpan.x,$.mpan.y,$.width/$.zoom/o,$.height/$.zoom/o),D.drawImage(T,$.mpan.x,$.mpan.y,$.width/$.zoom/o,$.height/$.zoom/o)}else a.textureOnViewport&&!t&&(a.textureCache=null);var R=l.extent(),P=a.pinching||a.hoverData.dragging||a.swipePanning||a.data.wheelZooming||a.hoverData.draggingEles||a.cy.animated(),V=a.hideEdgesOnViewport&&P,z=[];if(z[a.NODE]=!c[a.NODE]&&h&&!a.clearedForMotionBlur[a.NODE]||a.clearingMotionBlur,z[a.NODE]&&(a.clearedForMotionBlur[a.NODE]=!0),z[a.DRAG]=!c[a.DRAG]&&h&&!a.clearedForMotionBlur[a.DRAG]||a.clearingMotionBlur,z[a.DRAG]&&(a.clearedForMotionBlur[a.DRAG]=!0),c[a.NODE]||n||r||z[a.NODE]){var q=h&&!z[a.NODE]&&d!==1,D=t||(q?a.data.bufferContexts[a.MOTIONBLUR_BUFFER_NODE]:u.contexts[a.NODE]),G=h&&!q?"motionBlur":void 0;I(D,G),V?a.drawCachedNodes(D,E.nondrag,o,R):a.drawLayeredElements(D,E.nondrag,o,R),a.debug&&a.drawDebugPoints(D,E.nondrag),!n&&!h&&(c[a.NODE]=!1)}if(!r&&(c[a.DRAG]||n||z[a.DRAG])){var q=h&&!z[a.DRAG]&&d!==1,D=t||(q?a.data.bufferContexts[a.MOTIONBLUR_BUFFER_DRAG]:u.contexts[a.DRAG]);I(D,h&&!q?"motionBlur":void 0),V?a.drawCachedNodes(D,E.drag,o,R):a.drawCachedElements(D,E.drag,o,R),a.debug&&a.drawDebugPoints(D,E.drag),!n&&!h&&(c[a.DRAG]=!1)}if(a.showFps||!r&&c[a.SELECT_BOX]&&!n){var D=t||u.contexts[a.SELECT_BOX];if(I(D),a.selection[4]==1&&(a.hoverData.selecting||a.touchData.selecting)){var b=a.cy.zoom(),K=y.core("selection-box-border-width").value/b;D.lineWidth=K,D.fillStyle="rgba("+y.core("selection-box-color").value[0]+","+y.core("selection-box-color").value[1]+","+y.core("selection-box-color").value[2]+","+y.core("selection-box-opacity").value+")",D.fillRect(a.selection[0],a.selection[1],a.selection[2]-a.selection[0],a.selection[3]-a.selection[1]),K>0&&(D.strokeStyle="rgba("+y.core("selection-box-border-color").value[0]+","+y.core("selection-box-border-color").value[1]+","+y.core("selection-box-border-color").value[2]+","+y.core("selection-box-opacity").value+")",D.strokeRect(a.selection[0],a.selection[1],a.selection[2]-a.selection[0],a.selection[3]-a.selection[1]))}if(u.bgActivePosistion&&!a.hoverData.selecting){var b=a.cy.zoom(),Y=u.bgActivePosistion;D.fillStyle="rgba("+y.core("active-bg-color").value[0]+","+y.core("active-bg-color").value[1]+","+y.core("active-bg-color").value[2]+","+y.core("active-bg-opacity").value+")",D.beginPath(),D.arc(Y.x,Y.y,y.core("active-bg-size").pfValue/b,0,2*Math.PI),D.fill()}var te=a.lastRedrawTime;if(a.showFps&&te){te=Math.round(te);var Z=Math.round(1e3/te);D.setTransform(1,0,0,1,0,0),D.fillStyle="rgba(255, 0, 0, 0.75)",D.strokeStyle="rgba(255, 0, 0, 0.75)",D.lineWidth=1,D.fillText("1 frame = "+te+" ms = "+Z+" fps",0,20);var ae=60;D.strokeRect(0,30,250,20),D.fillRect(0,30,250*Math.min(Z/ae,1),20)}n||(c[a.SELECT_BOX]=!1)}if(h&&d!==1){var O=u.contexts[a.NODE],L=a.data.bufferCanvases[a.MOTIONBLUR_BUFFER_NODE],W=u.contexts[a.DRAG],M=a.data.bufferCanvases[a.MOTIONBLUR_BUFFER_DRAG],ue=function(se,oe,pe){se.setTransform(1,0,0,1,0,0),pe||!v?se.clearRect(0,0,a.canvasWidth,a.canvasHeight):S(se,0,0,a.canvasWidth,a.canvasHeight);var Ce=d;se.drawImage(oe,0,0,a.canvasWidth*Ce,a.canvasHeight*Ce,0,0,a.canvasWidth,a.canvasHeight)};(c[a.NODE]||z[a.NODE])&&(ue(O,L,z[a.NODE]),c[a.NODE]=!1),(c[a.DRAG]||z[a.DRAG])&&(ue(W,M,z[a.DRAG]),c[a.DRAG]=!1)}a.prevViewport=$,a.clearingMotionBlur&&(a.clearingMotionBlur=!1,a.motionBlurCleared=!0,a.motionBlur=!0),h&&(a.motionBlurTimeout=setTimeout(function(){a.motionBlurTimeout=null,a.clearedForMotionBlur[a.NODE]=!1,a.clearedForMotionBlur[a.DRAG]=!1,a.motionBlur=!1,a.clearingMotionBlur=!f,a.mbFrames=0,c[a.NODE]=!0,c[a.DRAG]=!0,a.redraw()},Mlt)),t||l.emit("render")};var Fm={};Fm.drawPolygonPath=function(e,t,n,r,i,s){var a=r/2,o=i/2;e.beginPath&&e.beginPath(),e.moveTo(t+a*s[0],n+o*s[1]);for(var l=1;l<s.length/2;l++)e.lineTo(t+a*s[l*2],n+o*s[l*2+1]);e.closePath()};Fm.drawRoundPolygonPath=function(e,t,n,r,i,s){var a=r/2,o=i/2,l=Mee(r,i);e.beginPath&&e.beginPath();for(var u=0;u<s.length/4;u++){var c=void 0,f=void 0;u===0?c=s.length-2:c=u*4-2,f=u*4+2;var h=t+a*s[u*4],d=n+o*s[u*4+1],p=-s[c]*s[f]-s[c+1]*s[f+1],g=l/Math.tan(Math.acos(p)/2),m=h-g*s[c],v=d-g*s[c+1],y=h+g*s[f],b=d+g*s[f+1];u===0?e.moveTo(m,v):e.lineTo(m,v),e.arcTo(h,d,y,b,l)}e.closePath()};Fm.drawRoundRectanglePath=function(e,t,n,r,i){var s=r/2,a=i/2,o=lI(r,i);e.beginPath&&e.beginPath(),e.moveTo(t,n-a),e.arcTo(t+s,n-a,t+s,n,o),e.arcTo(t+s,n+a,t,n+a,o),e.arcTo(t-s,n+a,t-s,n,o),e.arcTo(t-s,n-a,t,n-a,o),e.lineTo(t,n-a),e.closePath()};Fm.drawBottomRoundRectanglePath=function(e,t,n,r,i){var s=r/2,a=i/2,o=lI(r,i);e.beginPath&&e.beginPath(),e.moveTo(t,n-a),e.lineTo(t+s,n-a),e.lineTo(t+s,n),e.arcTo(t+s,n+a,t,n+a,o),e.arcTo(t-s,n+a,t-s,n,o),e.lineTo(t-s,n-a),e.lineTo(t,n-a),e.closePath()};Fm.drawCutRectanglePath=function(e,t,n,r,i){var s=r/2,a=i/2,o=Xke();e.beginPath&&e.beginPath(),e.moveTo(t-s+o,n-a),e.lineTo(t+s-o,n-a),e.lineTo(t+s,n-a+o),e.lineTo(t+s,n+a-o),e.lineTo(t+s-o,n+a),e.lineTo(t-s+o,n+a),e.lineTo(t-s,n+a-o),e.lineTo(t-s,n-a+o),e.closePath()};Fm.drawBarrelPath=function(e,t,n,r,i){var s=r/2,a=i/2,o=t-s,l=t+s,u=n-a,c=n+a,f=oY(r,i),h=f.widthOffset,d=f.heightOffset,p=f.ctrlPtOffsetPct*h;e.beginPath&&e.beginPath(),e.moveTo(o,u+d),e.lineTo(o,c-d),e.quadraticCurveTo(o+p,c,o+h,c),e.lineTo(l-h,c),e.quadraticCurveTo(l-p,c,l,c-d),e.lineTo(l,u+d),e.quadraticCurveTo(l-p,u,l-h,u),e.lineTo(o+h,u),e.quadraticCurveTo(o+p,u,o,u+d),e.closePath()};var Xpe=Math.sin(0),Kpe=Math.cos(0),gY={},mY={},VEe=Math.PI/40;for(var Jx=0*Math.PI;Jx<2*Math.PI;Jx+=VEe)gY[Jx]=Math.sin(Jx),mY[Jx]=Math.cos(Jx);Fm.drawEllipsePath=function(e,t,n,r,i){if(e.beginPath&&e.beginPath(),e.ellipse)e.ellipse(t,n,r/2,i/2,0,0,2*Math.PI);else for(var s,a,o=r/2,l=i/2,u=0*Math.PI;u<2*Math.PI;u+=VEe)s=t-o*gY[u]*Xpe+o*mY[u]*Kpe,a=n+l*mY[u]*Xpe+l*gY[u]*Kpe,u===0?e.moveTo(s,a):e.lineTo(s,a);e.closePath()};var dI={};dI.createBuffer=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,[n,n.getContext("2d")]};dI.bufferCanvasImage=function(e){var t=this.cy,n=t.mutableElements(),r=n.boundingBox(),i=this.findContainerClientCoords(),s=e.full?Math.ceil(r.w):i[2],a=e.full?Math.ceil(r.h):i[3],o=Pe(e.maxWidth)||Pe(e.maxHeight),l=this.getPixelRatio(),u=1;if(e.scale!==void 0)s*=e.scale,a*=e.scale,u=e.scale;else if(o){var c=1/0,f=1/0;Pe(e.maxWidth)&&(c=u*e.maxWidth/s),Pe(e.maxHeight)&&(f=u*e.maxHeight/a),u=Math.min(c,f),s*=u,a*=u}o||(s*=l,a*=l,u*=l);var h=document.createElement("canvas");h.width=s,h.height=a,h.style.width=s+"px",h.style.height=a+"px";var d=h.getContext("2d");if(s>0&&a>0){d.clearRect(0,0,s,a),d.globalCompositeOperation="source-over";var p=this.getCachedZSortedEles();if(e.full)d.translate(-r.x1*u,-r.y1*u),d.scale(u,u),this.drawElements(d,p),d.scale(1/u,1/u),d.translate(r.x1*u,r.y1*u);else{var g=t.pan(),m={x:g.x*u,y:g.y*u};u*=t.zoom(),d.translate(m.x,m.y),d.scale(u,u),this.drawElements(d,p),d.scale(1/u,1/u),d.translate(-m.x,-m.y)}e.bg&&(d.globalCompositeOperation="destination-over",d.fillStyle=e.bg,d.rect(0,0,s,a),d.fill())}return h};function Flt(e,t){for(var n=atob(e),r=new ArrayBuffer(n.length),i=new Uint8Array(r),s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return new Blob([r],{type:t})}function Zpe(e){var t=e.indexOf(",");return e.substr(t+1)}function jEe(e,t,n){var r=function(){return t.toDataURL(n,e.quality)};switch(e.output){case"blob-promise":return new xC(function(i,s){try{t.toBlob(function(a){a!=null?i(a):s(new Error("`canvas.toBlob()` sent a null value in its callback"))},n,e.quality)}catch(a){s(a)}});case"blob":return Flt(Zpe(r()),n);case"base64":return Zpe(r());case"base64uri":default:return r()}}dI.png=function(e){return jEe(e,this.bufferCanvasImage(e),"image/png")};dI.jpg=function(e){return jEe(e,this.bufferCanvasImage(e),"image/jpeg")};var HEe={};HEe.nodeShapeImpl=function(e,t,n,r,i,s,a){switch(e){case"ellipse":return this.drawEllipsePath(t,n,r,i,s);case"polygon":return this.drawPolygonPath(t,n,r,i,s,a);case"round-polygon":return this.drawRoundPolygonPath(t,n,r,i,s,a);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(t,n,r,i,s);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(t,n,r,i,s);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(t,n,r,i,s);case"barrel":return this.drawBarrelPath(t,n,r,i,s)}};var Olt=qEe,mn=qEe.prototype;mn.CANVAS_LAYERS=3;mn.SELECT_BOX=0;mn.DRAG=1;mn.NODE=2;mn.BUFFER_COUNT=3;mn.TEXTURE_BUFFER=0;mn.MOTIONBLUR_BUFFER_NODE=1;mn.MOTIONBLUR_BUFFER_DRAG=2;function qEe(e){var t=this;t.data={canvases:new Array(mn.CANVAS_LAYERS),contexts:new Array(mn.CANVAS_LAYERS),canvasNeedsRedraw:new Array(mn.CANVAS_LAYERS),bufferCanvases:new Array(mn.BUFFER_COUNT),bufferContexts:new Array(mn.CANVAS_LAYERS)};var n="-webkit-tap-highlight-color",r="rgba(0,0,0,0)";t.data.canvasContainer=document.createElement("div");var i=t.data.canvasContainer.style;t.data.canvasContainer.style[n]=r,i.position="relative",i.zIndex="0",i.overflow="hidden";var s=e.cy.container();s.appendChild(t.data.canvasContainer),s.style[n]=r;var a={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};mit()&&(a["-ms-touch-action"]="none",a["touch-action"]="none");for(var o=0;o<mn.CANVAS_LAYERS;o++){var l=t.data.canvases[o]=document.createElement("canvas");t.data.contexts[o]=l.getContext("2d"),Object.keys(a).forEach(function(te){l.style[te]=a[te]}),l.style.position="absolute",l.setAttribute("data-id","layer"+o),l.style.zIndex=String(mn.CANVAS_LAYERS-o),t.data.canvasContainer.appendChild(l),t.data.canvasNeedsRedraw[o]=!1}t.data.topCanvas=t.data.canvases[0],t.data.canvases[mn.NODE].setAttribute("data-id","layer"+mn.NODE+"-node"),t.data.canvases[mn.SELECT_BOX].setAttribute("data-id","layer"+mn.SELECT_BOX+"-selectbox"),t.data.canvases[mn.DRAG].setAttribute("data-id","layer"+mn.DRAG+"-drag");for(var o=0;o<mn.BUFFER_COUNT;o++)t.data.bufferCanvases[o]=document.createElement("canvas"),t.data.bufferContexts[o]=t.data.bufferCanvases[o].getContext("2d"),t.data.bufferCanvases[o].style.position="absolute",t.data.bufferCanvases[o].setAttribute("data-id","buffer"+o),t.data.bufferCanvases[o].style.zIndex=String(-o-1),t.data.bufferCanvases[o].style.visibility="hidden";t.pathsEnabled=!0;var u=il(),c=function(Z){return{x:(Z.x1+Z.x2)/2,y:(Z.y1+Z.y2)/2}},f=function(Z){return{x:-Z.w/2,y:-Z.h/2}},h=function(Z){var ae=Z[0]._private,O=ae.oldBackgroundTimestamp===ae.backgroundTimestamp;return!O},d=function(Z){return Z[0]._private.nodeKey},p=function(Z){return Z[0]._private.labelStyleKey},g=function(Z){return Z[0]._private.sourceLabelStyleKey},m=function(Z){return Z[0]._private.targetLabelStyleKey},v=function(Z,ae,O,L,W){return t.drawElement(Z,ae,O,!1,!1,W)},y=function(Z,ae,O,L,W){return t.drawElementText(Z,ae,O,L,"main",W)},b=function(Z,ae,O,L,W){return t.drawElementText(Z,ae,O,L,"source",W)},x=function(Z,ae,O,L,W){return t.drawElementText(Z,ae,O,L,"target",W)},w=function(Z){return Z.boundingBox(),Z[0]._private.bodyBounds},C=function(Z){return Z.boundingBox(),Z[0]._private.labelBounds.main||u},$=function(Z){return Z.boundingBox(),Z[0]._private.labelBounds.source||u},_=function(Z){return Z.boundingBox(),Z[0]._private.labelBounds.target||u},k=function(Z,ae){return ae},E=function(Z){return c(w(Z))},S=function(Z,ae,O){var L=Z?Z+"-":"";return{x:ae.x+O.pstyle(L+"text-margin-x").pfValue,y:ae.y+O.pstyle(L+"text-margin-y").pfValue}},I=function(Z,ae,O){var L=Z[0]._private.rscratch;return{x:L[ae],y:L[O]}},A=function(Z){return S("",I(Z,"labelX","labelY"),Z)},D=function(Z){return S("source",I(Z,"sourceLabelX","sourceLabelY"),Z)},T=function(Z){return S("target",I(Z,"targetLabelX","targetLabelY"),Z)},N=function(Z){return f(w(Z))},F=function(Z){return f($(Z))},R=function(Z){return f(_(Z))},P=function(Z){var ae=C(Z),O=f(C(Z));if(Z.isNode()){switch(Z.pstyle("text-halign").value){case"left":O.x=-ae.w;break;case"right":O.x=0;break}switch(Z.pstyle("text-valign").value){case"top":O.y=-ae.h;break;case"bottom":O.y=0;break}}return O},V=t.data.eleTxrCache=new Jk(t,{getKey:d,doesEleInvalidateKey:h,drawElement:v,getBoundingBox:w,getRotationPoint:E,getRotationOffset:N,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),z=t.data.lblTxrCache=new Jk(t,{getKey:p,drawElement:y,getBoundingBox:C,getRotationPoint:A,getRotationOffset:P,isVisible:k}),q=t.data.slbTxrCache=new Jk(t,{getKey:g,drawElement:b,getBoundingBox:$,getRotationPoint:D,getRotationOffset:F,isVisible:k}),G=t.data.tlbTxrCache=new Jk(t,{getKey:m,drawElement:x,getBoundingBox:_,getRotationPoint:T,getRotationOffset:R,isVisible:k}),K=t.data.lyrTxrCache=new BEe(t);t.onUpdateEleCalcs(function(Z,ae){V.invalidateElements(ae),z.invalidateElements(ae),q.invalidateElements(ae),G.invalidateElements(ae),K.invalidateElements(ae);for(var O=0;O<ae.length;O++){var L=ae[O]._private;L.oldBackgroundTimestamp=L.backgroundTimestamp}});var Y=function(Z){for(var ae=0;ae<Z.length;ae++)K.enqueueElementRefinement(Z[ae].ele)};V.onDequeue(Y),z.onDequeue(Y),q.onDequeue(Y),G.onDequeue(Y)}mn.redrawHint=function(e,t){var n=this;switch(e){case"eles":n.data.canvasNeedsRedraw[mn.NODE]=t;break;case"drag":n.data.canvasNeedsRedraw[mn.DRAG]=t;break;case"select":n.data.canvasNeedsRedraw[mn.SELECT_BOX]=t;break}};var Rlt=typeof Path2D<"u";mn.path2dEnabled=function(e){if(e===void 0)return this.pathsEnabled;this.pathsEnabled=!!e};mn.usePaths=function(){return Rlt&&this.pathsEnabled};mn.setImgSmoothing=function(e,t){e.imageSmoothingEnabled!=null?e.imageSmoothingEnabled=t:(e.webkitImageSmoothingEnabled=t,e.mozImageSmoothingEnabled=t,e.msImageSmoothingEnabled=t)};mn.getImgSmoothing=function(e){return e.imageSmoothingEnabled!=null?e.imageSmoothingEnabled:e.webkitImageSmoothingEnabled||e.mozImageSmoothingEnabled||e.msImageSmoothingEnabled};mn.makeOffscreenCanvas=function(e,t){var n;return(typeof OffscreenCanvas>"u"?"undefined":Mi(OffscreenCanvas))!=="undefined"?n=new OffscreenCanvas(e,t):(n=document.createElement("canvas"),n.width=e,n.height=t),n};[zEe,rd,Zp,Vee,Rb,SC,Zl,Fm,dI,HEe].forEach(function(e){pt(mn,e)});var Plt=[{name:"null",impl:DEe},{name:"base",impl:PEe},{name:"canvas",impl:Olt}],Llt=[{type:"layout",extensions:Hot},{type:"renderer",extensions:Plt}],GEe={},YEe={};function XEe(e,t,n){var r=n,i=function(_){Rn("Can not register `"+t+"` for `"+e+"` since `"+_+"` already exists in the prototype and can not be overridden")};if(e==="core"){if(sT.prototype[t])return i(t);sT.prototype[t]=n}else if(e==="collection"){if(zs.prototype[t])return i(t);zs.prototype[t]=n}else if(e==="layout"){for(var s=function(_){this.options=_,n.call(this,_),dn(this._private)||(this._private={}),this._private.cy=_.cy,this._private.listeners=[],this.createEmitter()},a=s.prototype=Object.create(n.prototype),o=[],l=0;l<o.length;l++){var u=o[l];a[u]=a[u]||function(){return this}}a.start&&!a.run?a.run=function(){return this.start(),this}:!a.start&&a.run&&(a.start=function(){return this.run(),this});var c=n.prototype.stop;a.stop=function(){var $=this.options;if($&&$.animate){var _=this.animations;if(_)for(var k=0;k<_.length;k++)_[k].stop()}return c?c.call(this):this.emit("layoutstop"),this},a.destroy||(a.destroy=function(){return this}),a.cy=function(){return this._private.cy};var f=function(_){return _._private.cy},h={addEventFields:function(_,k){k.layout=_,k.cy=f(_),k.target=_},bubble:function(){return!0},parent:function(_){return f(_)}};pt(a,{createEmitter:function(){return this._private.emitter=new g8(h,this),this},emitter:function(){return this._private.emitter},on:function(_,k){return this.emitter().on(_,k),this},one:function(_,k){return this.emitter().one(_,k),this},once:function(_,k){return this.emitter().one(_,k),this},removeListener:function(_,k){return this.emitter().removeListener(_,k),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(_,k){return this.emitter().emit(_,k),this}}),Fn.eventAliasesOn(a),r=s}else if(e==="renderer"&&t!=="null"&&t!=="base"){var d=KEe("renderer","base"),p=d.prototype,g=n,m=n.prototype,v=function(){d.apply(this,arguments),g.apply(this,arguments)},y=v.prototype;for(var b in p){var x=p[b],w=m[b]!=null;if(w)return i(b);y[b]=x}for(var C in m)y[C]=m[C];p.clientFunctions.forEach(function($){y[$]=y[$]||function(){Xr("Renderer does not implement `renderer."+$+"()` on its prototype")}}),r=v}else if(e==="__proto__"||e==="constructor"||e==="prototype")return Xr(e+" is an illegal type to be registered, possibly lead to prototype pollutions");return Nke({map:GEe,keys:[e,t],value:r})}function KEe(e,t){return Mke({map:GEe,keys:[e,t]})}function Blt(e,t,n,r,i){return Nke({map:YEe,keys:[e,t,n,r],value:i})}function zlt(e,t,n,r){return Mke({map:YEe,keys:[e,t,n,r]})}var vY=function(){if(arguments.length===2)return KEe.apply(null,arguments);if(arguments.length===3)return XEe.apply(null,arguments);if(arguments.length===4)return zlt.apply(null,arguments);if(arguments.length===5)return Blt.apply(null,arguments);Xr("Invalid extension access syntax")};sT.prototype.extension=vY;Llt.forEach(function(e){e.extensions.forEach(function(t){XEe(e.type,t.name,t.impl)})});var ZEe=function e(){if(!(this instanceof e))return new e;this.length=0},Ty=ZEe.prototype;Ty.instanceString=function(){return"stylesheet"};Ty.selector=function(e){var t=this.length++;return this[t]={selector:e,properties:[]},this};Ty.css=function(e,t){var n=this.length-1;if(rt(e))this[n].properties.push({name:e,value:t});else if(dn(e))for(var r=e,i=Object.keys(r),s=0;s<i.length;s++){var a=i[s],o=r[a];if(o!=null){var l=xa.properties[a]||xa.properties[c8(a)];if(l!=null){var u=l.name,c=o;this[n].properties.push({name:u,value:c})}}}return this};Ty.style=Ty.css;Ty.generateStyle=function(e){var t=new xa(e);return this.appendToStyle(t)};Ty.appendToStyle=function(e){for(var t=0;t<this.length;t++){var n=this[t],r=n.selector,i=n.properties;e.selector(r);for(var s=0;s<i.length;s++){var a=i[s];e.css(a.name,a.value)}}return e};var Ult="3.25.0",Dy=function(t){if(t===void 0&&(t={}),dn(t))return new sT(t);if(rt(t))return vY.apply(vY,arguments)};Dy.use=function(e){var t=Array.prototype.slice.call(arguments,1);return t.unshift(Dy),e.apply(null,t),this};Dy.warnings=function(e){return Bke(e)};Dy.version=Ult;Dy.stylesheet=Dy.Stylesheet=ZEe;var Qpe=Dy;const Wlt=PSe({__proto__:null,default:Qpe},[Qpe]),S1={right:["settings","network","dataSet","train","predict","layer","neuron","edge"]},C8="panels";class Vlt{constructor(t,n){this.host=t,t.addController(this),this.LAYER_WIDTH=300,this.LAYER_PADDING=20,this.LAYER_DISTANCE=150,this.NEURON_SIZE=100,this.NEURON_DISTANCE=40,this.cy=Wlt({container:n,elements:[],style:[{selector:'node[type="layer"]',style:{shape:"round-rectangle","background-color":"#ffffff","border-color":"#efefef","border-width":5,padding:this.LAYER_PADDING,label:"data(label)","text-halign":"left","text-valign":"center","text-margin-x":-20,"z-compound-depth":"bottom"}},{selector:'node[type="layer"]:selected',style:{"border-color":"#26A269"}},{selector:'node[type="neuron-wrapper"]',style:{shape:"round-rectangle","border-width":5,"border-color":"black",padding:0,label:"data(label)","text-halign":"center","text-valign":"bottom","text-margin-y":20,"z-compound-depth":"bottom"}},{selector:'node[type="neuron"]',style:{shape:"round-rectangle","background-color":"white","border-width":5,"border-color":"#0183C7",width:"95px",height:"95px",label:"data(label)","text-halign":"center","text-valign":"center","z-compound-depth":"bottom"}},{selector:'node[type="neuron"][wrapped="true"]',style:{width:"90px",height:"90px"}},{selector:'node[type="neuron"]:selected',style:{"border-color":"#26A269"}},{selector:"edge",style:{width:3,"line-color":"lightgray","target-arrow-color":"gray","target-arrow-shape":"triangle","curve-style":"bezier"}},{selector:"edge:selected",style:{"line-color":"#26A269","target-arrow-color":"#26A269"}}],wheelSensitivity:.2,boxSelectionEnabled:!1,selectionType:"single"}),this.cy.on("tap",r=>{r.target===this.cy&&(this.host.selected.select(),this.host.panels.close(...S1.right))}),this.cy.on("select","node, edge",r=>{const i=r.target;if(this.cy.elements().not(i).unselect(),i.isNode()){const s=i;if(s.data("type")=="layer"){const a=this.host.networkConf.network.getLayerById(s.data("layer"));this.host.selected.select({layer:a})}else if(s.data("type")=="neuron"){const a=this.host.networkConf.network.getLayerById(s.data("layer")),o=a.neurons[s.data("neuron")-1];this.host.selected.select({layer:a,neuron:o})}}else if(i.isEdge()){const s=i,a=this.host.networkConf.network.getLayerById(s.source().data("layer"));let o=null;o=a.neurons[s.source().data("neuron")-1];const l=this.host.networkConf.network.getLayerById(s.target().data("layer"));let u=null;u=l.neurons[s.target().data("neuron")-1];const c={sourceLayer:a,sourceNeuron:o,targetLayer:l,targetNeuron:u};this.host.selected.select({edge:c})}})}hostConnected(){console.log("canvas controller connected")}hostDisconnected(){console.log("canvas controller disconnected")}zoomOut(){this.cy&&this.cy.zoom(this.cy.zoom()-.1)}fit(){this.cy&&this.cy.fit(this.cy.$(""),30)}zoomIn(){this.cy&&this.cy.zoom(this.cy.zoom()+.1)}getHeight(t){return this.cy.getElementById(t).outerHeight()}generatePos(){const t=this.cy.extent();return{x:t.x1+(t.x2-t.x1)/2,y:t.y1+(t.y2-t.y1)/2}}}const Om="canvas";var jlt=Object.defineProperty,Hlt=Object.getOwnPropertyDescriptor,_8=(e,t,n,r)=>{for(var i=r>1?void 0:r?Hlt(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&jlt(t,n,i),i};let Tw=class extends St{_handleClick(){this.canvas.cy.getElementById(this.target.getCyId()).select()}render(){return de`
      <sl-button 
        size="small" 
        pill 
        @click="${e=>this._handleClick()}"
      >
        <slot>
      </sl-button>
    `}};Tw.styles=[kt];_8([J({type:Boolean})],Tw.prototype,"disabled",2);_8([J({type:String})],Tw.prototype,"target",2);_8([En({context:Om,subscribe:!0})],Tw.prototype,"canvas",2);Tw=_8([Ue("c-network-link")],Tw);var qlt=Object.defineProperty,Glt=Object.getOwnPropertyDescriptor,jee=(e,t,n,r)=>{for(var i=r>1?void 0:r?Glt(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&qlt(t,n,i),i};let aT=class extends St{disconnectedCallback(){this.panels.close(this.name)}render(){return de`
      <div class="c-panel ${this.name&&!this.panels.containsSome(this.name)?"hidden":""}">
        <slot>
      </div>
    `}};aT.styles=[kt,Qt`
      .c-panel {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
    `];jee([J({type:String})],aT.prototype,"name",2);jee([En({context:C8,subscribe:!0})],aT.prototype,"panels",2);aT=jee([Ue("c-panel")],aT);var Ylt=Object.defineProperty,Xlt=Object.getOwnPropertyDescriptor,pI=(e,t,n,r)=>{for(var i=r>1?void 0:r?Xlt(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Ylt(t,n,i),i};let Iy=class extends St{render(){return de`
      <div class="c-tab">
        <sl-button 
          class="${this.panels.openPanels.includes(this.name)?"active":""}" 
          @click="${e=>this.panels.open(this.name,this.group)}"
        >
          <slot>
        </sl-button>
      </div>
    `}};Iy.styles=[kt,Qt`
      sl-button {
        width: 100%;
      }

      :host([colored]) sl-button::part(base) {
        background-color: var(--sl-color-primary-100);
      }

      .active::part(base) {
        background-color: var(--sl-color-primary-600) !important;
        color: var(--sl-color-neutral-0);
      }
    `];pI([J({type:String})],Iy.prototype,"name",2);pI([J({type:String})],Iy.prototype,"group",2);pI([J({type:Boolean})],Iy.prototype,"colored",2);pI([En({context:C8,subscribe:!0})],Iy.prototype,"panels",2);Iy=pI([Ue("c-tab")],Iy);HG("/shoelace");function Klt(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function ja({message:e,variant:t="primary",icon:n="info-circle",duration:r=7e3}){const i=Object.assign(document.createElement("sl-alert"),{variant:t,closable:!0,duration:r,innerHTML:`
        <sl-icon name="${n}" slot="icon"></sl-icon>
        ${Klt(e)}
    `});document.body.append(i),i.toast()}class Zlt{constructor(t){this.host=t,t.addController(this)}hostConnected(){window.addEventListener("keyup",t=>this.removeListener(t)),window.addEventListener("keydown",t=>this.moveListener(t))}hostDisconnected(){window.removeEventListener("keyup",t=>this.removeListener(t)),window.removeEventListener("keydown",t=>this.moveListener(t))}removeListener(t){if(t.code=="Delete"||t.code=="Backspace"){if(this.host.selected.layer){const n=this.host.selected.layer;ja({message:`'${n.getName()}' has been deleted!`,variant:"danger",icon:"trash"}),this.host.networkConf.network.removeLayer(n)}else if(this.host.selected.neuron)ja({message:"You can not delete neurons by now! To adjust the number of neurons in the layer, select the layer and set the number of neurons in the right panel!",variant:"warning",icon:"x-circle"});else if(this.host.selected.edge){const n=this.host.selected.edge;ja({message:`Can not delete edges manually. If you wish to delete the connection between '${n.sourceLayer.getName()}' and '${n.targetLayer.getName()}' select one of the layers and remove the other layer as its input resp. output!`,variant:"warning",icon:"x-circle"})}}}moveListener(t){if(this.host.selected.layer){const n=this.host.selected.layer,r=this.host.canvas.cy.getElementById(n.getCyId()),i=10;t.code=="KeyW"||t.code=="ArrowUp"?r.shift("y",-i):t.code=="KeyA"||t.code=="ArrowLeft"?r.shift("x",-i):t.code=="KeyS"||t.code=="ArrowDown"?r.shift("y",i):(t.code=="KeyD"||t.code=="ArrowRight")&&r.shift("x",i)}}}const Qp="network-conf",Rm="data-set",Qlt="train-options",Hee="model",kC="selected";class Jlt{constructor({name:t,description:n,inputs:r,label:i},s){this.name=t,this.description=n,this.inputs=r,this.label=i,this.data=s}unassignKey(t){console.log("unassign key"),this.assignKey(t,null)}assignKey(t,n){this.assignInputToLayer({key:t,layer:n}),this.assignLabelToLayer({key:t,layer:n})}getByKey(t){var n;return(n=this.getInputByKey(t))!=null?n:this.getLabelByKey(t)}getNonAssignedInputKeys(){return this.inputs.filter(n=>!n.layer).map(n=>n.key)}getAssignedInputsFor(t){return this.inputs.filter(n=>n.layer==t)}getInputByKey(t){return this.inputs.find(r=>r.key==t)}assignInputToLayer({key:t,layer:n}){const r=this.getInputByKey(t);r&&(r.layer=n)}getInputDataForLayer(t){const n=[];for(const[i,s]of this.inputs.entries())s.layer==t&&n.push(i);return this.data.map(({inputs:i})=>i.filter((s,a)=>n.includes(a)))}getNonAssignedLabelKey(){return this.label.layer?null:this.label.key}getLabelByKey(t){return this.label.key==t?this.label:null}assignLabelToLayer({key:t,layer:n}){const r=this.getLabelByKey(t);r&&(r.layer=n)}getLabelData(){return this.data.map(({label:t})=>t)}getData(){return this.data}}class q2{constructor(){}static async openDataSet(t){const r=await(await fetch(`${t}/config.json`)).json(),i=Object.create(r),o=(await(await fetch(`${t}/data.txt`)).text()).split(`
`),l=[];for(const u of o){const c=u.trim().split(/\s+/),f=[];let h=0;for(const p of i.inputs)f.push(parseInt(c[h])),h+=1;const d=parseInt(c[h]);l.push({inputs:f,label:d})}return new Jlt(i,l)}static getDataSetByName(t){switch(t){case"Boston House Pricing":return this.openDataSet("/data_set/boston");case"Pima Indians Diabetes":return this.openDataSet("/data_set/diabetes")}}static getOptions(){return["Boston House Pricing","Pima Indians Diabetes"]}}var eut=Object.defineProperty,tut=Object.getOwnPropertyDescriptor,Pb=(e,t,n,r)=>{for(var i=r>1?void 0:r?tut(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&eut(t,n,i),i};let Ah=class extends St{constructor(){super(...arguments),this.tensor=null,this.alert=!0}connectedCallback(){super.connectedCallback(),this.alert&&ja({message:`${this.getName()} has been created!`,variant:"success",icon:"check-circle"})}firstUpdated(){this.canvas.cy.getElementById(this.getCyId()).on("position",e=>{const t=this.canvas.cy.getElementById(this.getCyId());this.pos.x=t.position().x,this.pos.y=t.position().y})}disconnectedCallback(){this.removeFromCanvas()}getCyId(){return`${this.layerId}`}removeFromCanvas(){this.canvas.cy.filter(t=>t.isNode()&&t.data("layer")==this.layerId,this).remove()}getName(){return`${this.layerId} - ${this.constructor.LAYER_NAME} ${this.activation!="None"?`(${this.activation})`:""}`}setActivation(e){this.activation=e,this.canvas.cy.getElementById(`${this.layerId}`).data("label",this.getName())}getTensorName(){return this.getName().replace(/\s+/g,"").replace(/[^\w ]/g,"")}render(){return this.canvas.cy.getElementById(this.getCyId()).length||this.canvas.cy.add({group:"nodes",data:{id:this.getCyId(),label:this.getName(),type:"layer",layer:this.layerId,layer_type:`${this.constructor.LAYER_TYPE}`},css:{"z-index":this.layerId*3}}),de``}};Ah.styles=[kt];Pb([En({context:Om,subscribe:!0})],Ah.prototype,"canvas",2);Pb([J()],Ah.prototype,"layerId",2);Pb([J()],Ah.prototype,"activation",2);Pb([J()],Ah.prototype,"pos",2);Pb([J()],Ah.prototype,"tensor",2);Pb([J()],Ah.prototype,"alert",2);Ah=Pb([Ue("c-layer")],Ah);var nut=Object.defineProperty,rut=Object.getOwnPropertyDescriptor,Pm=(e,t,n,r)=>{for(var i=r>1?void 0:r?rut(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&nut(t,n,i),i};let Th=class extends St{connectedCallback(){super.connectedCallback(),this.value=Math.random(),this.label&&this.dataSet.assignKey(this.label,this.layer)}firstUpdated(){this.canvas.cy.getElementById(this.getCyId()).on("position",e=>{const t=this.canvas.cy.getElementById(this.getCyId());this.pos.x=t.position().x,this.pos.y=t.position().y})}disconnectedCallback(){super.disconnectedCallback(),console.log("neuron disconnected"),this.removeFromCanvas(),this.label&&this.dataSet.unassignKey(this.label)}getCyId(){return`${this.layer.getCyId()}n${this.neuronId}`}removeFromCanvas(){this.layer instanceof Us&&console.error("removing neuron for "+this.label);const e=this.canvas.cy.getElementById(this.getCyId());if(e.length){e.remove();const t=this.canvas.cy.getElementById(`${this.getCyId()}w`);t&&t.remove(),this.canvas.cy.getElementById(this.layer.getCyId()).shift("x",(this.canvas.NEURON_SIZE+this.canvas.NEURON_DISTANCE)/2)}}render(){this.removeFromCanvas(),this.layer instanceof Us&&console.log("rendering neuron for "+this.label);let e=this.layer.getCyId(),t=!1;return this.label&&(this.canvas.cy.add({group:"nodes",grabbable:!1,selectable:!1,data:{id:`${this.getCyId()}w`,parent:e,type:"neuron-wrapper",layer:this.layer.layerId,neuron:this.neuronId,label:this.label},css:{"z-index":this.layer.layerId*3+1}}),e=`${this.getCyId()}w`,t=!0),this.canvas.cy.add({group:"nodes",grabbable:!1,data:{id:this.getCyId(),parent:e,type:"neuron",layer:this.layer.layerId,neuron:this.neuronId,label:`${this.value}`.substring(0,3),wrapped:`${String(t)}`},position:{x:this.pos.x,y:this.pos.y},css:{"z-index":this.layer.layerId*3+2}}),this.canvas.cy.getElementById(this.layer.getCyId()).shift("x",-(this.canvas.NEURON_SIZE+this.canvas.NEURON_DISTANCE)/2),this.dispatchEvent(new CustomEvent("layer-updated-neurons",{detail:this.layer.layerId,bubbles:!0,composed:!0})),de``}};Th.styles=[kt];Pm([En({context:Om,subscribe:!0})],Th.prototype,"canvas",2);Pm([En({context:Rm,subscribe:!0})],Th.prototype,"dataSet",2);Pm([J()],Th.prototype,"layer",2);Pm([J()],Th.prototype,"neuronId",2);Pm([J()],Th.prototype,"pos",2);Pm([J()],Th.prototype,"label",2);Pm([Ir()],Th.prototype,"value",2);Th=Pm([Ue("c-neuron")],Th);var iut=Object.defineProperty,sut=Object.getOwnPropertyDescriptor,qee=(e,t,n,r)=>{for(var i=r>1?void 0:r?sut(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&iut(t,n,i),i};let Lc=class extends Ah{constructor(){super(...arguments),this.neurons=[],this.neuronYBackup=null}firstUpdated(){super.firstUpdated(),this.canvas.cy.getElementById(this.getCyId()).on("drag",e=>{this.neuronYBackup&&(this.neurons.length?this.neuronYBackup=this.canvas.cy.getElementById(this.neurons[0].getCyId()).position().y:this.neuronYBackup=null)})}getConnectionIds(){return this.neurons.map(e=>e.getCyId())}addNeuron({label:e}={}){const t=document.createElement("c-neuron");return t.layer=this,t.neuronId=this.getFreshNeuronId(),t.pos=this.getPositionForUnit(),t.label=e,this.neurons.push(t),this.requestUpdate(),t}removeNeuron({neuron:e=null,force:t=!1}={}){e&&console.error("removing specific neurons is not yet supported! To adjust the number of neurons in the layer, select the layer and adjust its configuration instead!"),this.neurons.length>1||t?(this.neurons.pop(),this.requestUpdate()):ja({message:`Could not remove neuron in '${this.getName()}'! Layer needs at least one neuron!`,variant:"warning",icon:"x-circle"})}getFreshNeuronId(){return this.neurons.length?this.neurons[this.neurons.length-1].neuronId+1:1}getPositionForUnit(){let e;return this.neurons.length==0?(e=this.pos.x,this.neuronYBackup||(this.neuronYBackup=this.pos.y)):this.neurons.length>=1&&(e=this.pos.x+this.canvas.NEURON_SIZE/2+this.canvas.NEURON_DISTANCE,this.neurons.length>=2&&(e+=this.neurons.length*this.canvas.NEURON_SIZE/2),this.neurons.length>=3&&(e+=(this.neurons.length-1)*this.canvas.NEURON_DISTANCE/2)),{x:e,y:this.neuronYBackup}}render(){return console.log(this.neurons),de`${super.render()}${this.neurons}`}};Lc.styles=[kt];qee([Ir()],Lc.prototype,"neurons",2);qee([Ir()],Lc.prototype,"neuronYBackup",2);Lc=qee([Ue("neuron-layer")],Lc);var aut=Object.defineProperty,out=Object.getOwnPropertyDescriptor,QEe=(e,t,n,r)=>{for(var i=r>1?void 0:r?out(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&aut(t,n,i),i};let Us=class extends Lc{constructor(){super(...arguments),this.dataSetKeys=[]}updated(e){e.has("dataSetKeys")&&(this.dataSetKeys.length?this.handleKeysChange():this.dispatchEvent(new Event("query-layer-deletion",{bubbles:!0,composed:!0})))}getName(){return`${this.layerId} - ${this.constructor.LAYER_NAME}`}getDescription(){return"An input layer is a layer that just takes data provided from outside the network and passes it on to the next layer(s)"}getAssignedInputs(){return this.neurons.map(e=>e.label)}handleKeysChange(){console.log("handling keys change"),console.log(this.dataSetKeys);for(let e=this.neurons.length-1;e>=0;e--)this.neurons.pop();for(const e of this.dataSetKeys)this.addNeuron({label:e});this.requestUpdate()}render(){return super.render()}};Us.LAYER_TYPE="Input";Us.LAYER_NAME="Input layer";Us.styles=[kt];QEe([J()],Us.prototype,"dataSetKeys",2);Us=QEe([Ue("input-layer")],Us);var lut=Object.defineProperty,uut=Object.getOwnPropertyDescriptor,JEe=(e,t,n,r)=>{for(var i=r>1?void 0:r?uut(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&lut(t,n,i),i};let Qo=class extends Lc{updated(e){e.has("dataSetLabel")&&(this.dataSetLabel?this.handleLabelChange():this.dispatchEvent(new Event("query-layer-deletion",{bubbles:!0,composed:!0})))}getName(){return`${this.dataSetLabel.key} ${this.constructor.LAYER_NAME} ${this.activation!="None"?`(${this.activation})`:""}`}getDescription(){let e="An output layer in this simulation is just a normal dense layer, additionally equipped with the ability to output the incoming data out of the network.";return sY(this.dataSetLabel)&&(e+=" Since the purpose if this layer is to output a classifiction, we should combine it with a softmax activation function in order to provide a probability distribution."),e}handleLabelChange(){for(let e=this.neurons.length-1;e>=0;e--)this.removeNeuron({force:!0});if(dke(this.dataSetLabel))this.addNeuron({label:this.dataSetLabel.key});else if(sY(this.dataSetLabel))for(const e of this.dataSetLabel.classes)this.addNeuron({label:e.key});this.canvas.cy.getElementById(`${this.id}`).data("label",this.getName())}render(){return super.render()}};Qo.LAYER_TYPE="Output";Qo.LAYER_NAME="Output layer";Qo.styles=[kt];JEe([J()],Qo.prototype,"dataSetLabel",2);Qo=JEe([Ue("output-layer")],Qo);var cut=Object.defineProperty,fut=Object.getOwnPropertyDescriptor,eAe=(e,t,n,r)=>{for(var i=r>1?void 0:r?fut(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&cut(t,n,i),i};let R0=class extends Lc{firstUpdated(){super.firstUpdated();for(let e=1;e<=this.units;e++)this.addNeuron()}getDescription(){return"A dense layer, also called fully-connected layer, is a layer whose inside neurons connect to every neuron in the preceding layer."}setNeurons(e){if(e>=1){if(e>this.neurons.length)for(let t=this.neurons.length+1;t<=e;t++)this.addNeuron();else if(e<this.neurons.length)for(let t=this.neurons.length;t>e;t--)this.removeNeuron();ja({message:`The number of neurons in '${this.getName()}' has been updated to ${e}!`,variant:"success",icon:"check-circle"})}else ja({message:`The number of neurons in '${this.getName()}' could not be updated to ${e}! Layer needs at least one neuron!`,variant:"warning",icon:"x-circle"})}render(){return super.render()}};R0.LAYER_TYPE="Dense";R0.LAYER_NAME="Dense layer";R0.styles=[kt];eAe([J()],R0.prototype,"units",2);R0=eAe([Ue("dense-layer")],R0);var hut=Object.defineProperty,dut=Object.getOwnPropertyDescriptor,S8=(e,t,n,r)=>{for(var i=r>1?void 0:r?dut(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&hut(t,n,i),i};let Dw=class extends St{disconnectedCallback(){super.disconnectedCallback(),this.removeFromCanvas()}removeFromCanvas(){const e=this.canvas.cy.filter(t=>t.isEdge()&&t.data("sourceLayer")==this.sourceLayer.layerId&&t.data("targetLayer")==this.targetLayer.layerId,this);console.log(e),e.remove()}render(){this.removeFromCanvas();const e=this.sourceLayer.getConnectionIds(),t=this.targetLayer.getConnectionIds();for(const n of e)for(const r of t)this.canvas.cy.add({group:"edges",data:{id:`${n}e${r}`,source:n,target:r,sourceLayer:this.sourceLayer.layerId,targetLayer:this.targetLayer.layerId}})}};Dw.styles=[kt];S8([En({context:Om,subscribe:!0})],Dw.prototype,"canvas",2);S8([J()],Dw.prototype,"sourceLayer",2);S8([J()],Dw.prototype,"targetLayer",2);Dw=S8([Ue("c-layer-connection")],Dw);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const put=1e-7,gut=1e-4;class Gee{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class k8{refCount(t){return No("refCount")}incRef(t){return No("incRef")}timerAvailable(){return!0}time(t){return No("time")}read(t){return No("read")}readSync(t){return No("readSync")}readToGPU(t,n){return No("readToGPU")}numDataIds(){return No("numDataIds")}disposeData(t,n){return No("disposeData")}write(t,n,r){return No("write")}move(t,n,r,i,s){return No("move")}createTensorFromGPUData(t,n,r){return No("createTensorFromGPUData")}memory(){return No("memory")}floatPrecision(){return No("floatPrecision")}epsilon(){return this.floatPrecision()===32?put:gut}dispose(){return No("dispose")}}function No(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yee(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,Gd(e,t,n)}function mut(e,t){if(e.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,Gd(e,n,r),Gd(t,n,r)}function P0(e,t,n){return Math.max(e,Math.min(t,n))}function E8(e){return e%2===0?e:e+1}function Gd(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function tAe(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function vut(e,t){const n=Math.random();return t*n+(1-n)*e}function yut(e,t){let n=0;for(let r=0;r<e.length;r++){const i=Number(e[r])-Number(t[r]);n+=i*i}return n}function B(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function gs(e,t,n=""){B(Zt(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function Lb(e){B(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function he(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function but(e){return e.length===0}function nAe(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==null&&t[n]!==null&&e[n]!==t[n])return!1;return!0}function Zt(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ny(e){return e%1===0}function xut(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{const t=Math.exp(2*e);return(t-1)/(t+1)}}function g5(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function wut(e){const t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return Yee(t),t}function X1(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function yY(e,t=i=>0,n,r){return new Promise((i,s)=>{let a=0;const o=()=>{if(e()){i();return}a++;const l=t(a);if(n!=null&&a>=n){s();return}r!=null?r(o,l):setTimeout(o,l)};o()})}function Xee(e,t){let n=1,r=-1;for(let s=0;s<e.length;++s)if(e[s]>=0)n*=e[s];else if(e[s]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(e[s]<0)throw Error(`Shapes can not be < 0. Found ${e[s]} at dim ${s}`);if(r===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const i=e.slice();return i[r]=t/n,i}function Ot(e,t){const n=t.length;return e=e==null?t.map((r,i)=>i):[].concat(e),B(e.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),B(e.every(r=>Ny(r)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(r=>r<0?n+r:r)}function Jp(e,t){const n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,s=t==null||i?null:Ot(t,e).sort();let a=0;for(let o=0;o<e.length;++o){if(s!=null){if(s[a]===o&&e[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${e[o]}' is not 1`);(s[a]==null||s[a]>o)&&e[o]===1&&(n.push(e[o]),r.push(o)),s[a]<=o&&a++}e[o]!==1&&(n.push(e[o]),r.push(o))}return{newShape:n,keptDims:r}}function Fi(e,t){return Br(e,t)}function Br(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function rAe(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function iAe(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function Kee(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function oT(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function sAe(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function Kf(e){return typeof e=="string"||e instanceof String}function aAe(e){return typeof e=="boolean"}function m5(e){return typeof e=="number"}function Bb(e){return Array.isArray(e)?Bb(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":m5(e)?"float32":Kf(e)?"string":aAe(e)?"bool":"float32"}function L0(e){return!!(e&&e.constructor&&e.call&&e.apply)}function v5(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function Je(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function oAe(e,t,n,r=!1){const i=new Array;if(t.length===1){const s=t[0]*(r?2:1);for(let a=0;a<s;a++)i[a]=n[e+a]}else{const s=t[0],a=t.slice(1),o=a.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<s;l++)i[l]=oAe(e+l*o,a,n,r)}return i}function Eu(e,t,n=!1){if(e.length===0)return t[0];const r=e.reduce((i,s)=>i*s)*(n?2:1);if(r===0)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return oAe(0,e,t,n)}function lAe(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function A8(e,t){const n=hs(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function hs(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function Zee(e,t){const n=e.reduce((r,i)=>r*i,1);if(t==null||t==="float32")return Eu(e,new Float32Array(n));if(t==="int32")return Eu(e,new Int32Array(n));if(t==="bool")return Eu(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function ml(e){e.forEach(t=>{B(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function Bc(e,t,n){if(t===0)return 0;if(t===1)return e[0];let r=e[e.length-1];for(let i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function zb(e,t,n){if(t===0)return[];if(t===1)return[e];const r=new Array(t);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}function T8(e){return e&&e.then&&typeof e.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jpe="tfjsflags";class uAe{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=$ut,this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&(le().getBool("IS_TEST")||le().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=n}registerFlag(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){const i=this.urlFlags[t];le().getBool("IS_TEST")||le().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${i}.`),this.set(t,i)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if(T8(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);Jpe in t&&t[Jpe].split(",").forEach(r=>{const[i,s]=r.split(":");this.urlFlags[i]=_ut(i,s)})}}function $ut(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(Cut(t,r[0],r[1]),r.join("="))),t}function Cut(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function _ut(e,t){const n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function le(){return Qee}let Qee=null;function Sut(e){Qee=e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rj;function cAe(){if(rj==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");rj=e}return rj}function kut(){const e=cAe();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function Jee(e,t){const n=kut();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}const gI="Abs",EC="Acos",AC="Acosh",Ub="Add",mI="AddN",D8="All",I8="Any",vI="ArgMax",yI="ArgMin",TC="Asin",DC="Asinh",IC="Atan",NC="Atanh",MC="Atan2",bI="AvgPool",N8="AvgPoolGrad",xI="AvgPool3D",M8="AvgPool3DGrad",wI="BatchMatMul",$I="BatchToSpaceND",F8="Bincount",CI="BitwiseAnd",fAe="BroadcastTo",O8="BroadcastArgs",FC="Cast",OC="Ceil",RC="ClipByValue",R8="Complex",_I="ComplexAbs",SI="Concat",kI="Conv2D",P8="Conv2DBackpropFilter",EI="Conv2DBackpropInput",AI="Conv3D",L8="Conv3DBackpropFilterV2",B8="Conv3DBackpropInputV2",PC="Cos",LC="Cosh",z8="Cumprod",TI="Cumsum",U8="CropAndResize",W8="DenseBincount",V8="DepthToSpace",DI="DepthwiseConv2dNative",j8="DepthwiseConv2dNativeBackpropFilter",H8="DepthwiseConv2dNativeBackpropInput",q8="Diag",II="Dilation2D",y5="Dilation2DBackpropInput",b5="Dilation2DBackpropFilter",G8="Draw",BC="RealDiv",Y8="Einsum",zC="Elu",X8="EluGrad",UC="Erf",NI="Equal",WC="Exp",MI="ExpandDims",VC="Expm1",K8="FFT",Z8="Fill",Q8="FlipLeftRight",jC="Floor",HC="FloorDiv",FI="FusedBatchNorm",OI="GatherV2",J8="GatherNd",RI="Greater",qC="GreaterEqual",GC="Identity",ez="IFFT",tz="Imag",YC="IsFinite",XC="IsInf",KC="IsNan",PI="LeakyRelu",LI="Less",BI="LessEqual",nz="LinSpace",ZC="Log",QC="Log1p",zI="LogicalAnd",UI="LogicalNot",WI="LogicalOr",Eut="LogicalXor",hAe="LogSoftmax",Aut="LowerBound",VI="LRN",rz="LRNGrad",Tut="MatrixBandPart",jI="Max",JC="Maximum",HI="MaxPool",iz="MaxPoolGrad",qI="MaxPool3D",sz="MaxPool3DGrad",az="MaxPoolWithArgmax",GI="Mean",YI="Min",e_="Minimum",XI="MirrorPad",t_="Mod",oz="Multinomial",n_="Multiply",KI="Neg",ZI="NotEqual",lz="NonMaxSuppressionV3",uz="NonMaxSuppressionV4",cz="NonMaxSuppressionV5",QI="OnesLike",JI="OneHot",eN="Pack",tN="PadV2",Dut="Pool",r_="Pow",nN="Prelu",rN="Prod",fz="RaggedGather",hz="RaggedRange",dz="RaggedTensorToTensor",pz="Range",gz="Real",i_="Reciprocal",s_="Relu",iN="Reshape",sN="ResizeNearestNeighbor",mz="ResizeNearestNeighborGrad",aN="ResizeBilinear",vz="ResizeBilinearGrad",a_="Relu6",oN="Reverse",o_="Round",l_="Rsqrt",yz="ScatterNd",bz="TensorScatterUpdate",xz="SearchSorted",lN="Select",u_="Selu",uN="Slice",c_="Sin",f_="Sinh",h_="Sign",d_="Sigmoid",p_="Softplus",g_="Sqrt",cN="Sum",fN="SpaceToBatchND",hN="SplitV",dN="Softmax",wz="SparseFillEmptyRows",$z="SparseReshape",Cz="SparseSegmentMean",_z="SparseSegmentSum",Sz="SparseToDense",m_="SquaredDifference",kz="Square",pN="StaticRegexReplace",Ez="StridedSlice",Az="StringNGrams",Tz="StringSplit",Dz="StringToHashBucketFast",v_="Sub",y_="Tan",b_="Tanh",x_="Tile",Iz="TopK",Nz="Transform",K1="Transpose",Mz="Unique",gN="Unpack",mN="UnsortedSegmentSum",Iut="UpperBound",vN="ZerosLike",w_="Step",x5="FromPixels",Fz="RotateWithOffset",lT="_FusedMatMul",uT="FusedConv2D",cT="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kl(...e){le().getBool("IS_TEST")||le().getBool("PROD")||console.warn(...e)}function Nut(...e){le().getBool("IS_TEST")||le().getBool("PROD")||console.log(...e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iw=Jee("kernelRegistry",()=>new Map),fT=Jee("gradRegistry",()=>new Map);function hT(e,t){const n=ete(e,t);return Iw.get(n)}function bY(e){return fT.get(e)}function w5(e){const t=Iw.entries(),n=[];for(;;){const{done:r,value:i}=t.next();if(r)break;const[s,a]=i,[o]=s.split("_");o===e&&n.push(a)}return n}function Oz(e){const{kernelName:t,backendName:n}=e,r=ete(t,n);Iw.has(r)&&kl(`The kernel '${t}' for backend '${n}' is already registered`),Iw.set(r,e)}function dAe(e){const{kernelName:t}=e;fT.has(t)&&le().getBool("DEBUG")&&kl(`Overriding the gradient for '${t}'`),fT.set(t,e)}function Mut(e,t){const n=ete(e,t);if(!Iw.has(n))throw new Error(`The kernel '${e}' for backend '${t}' is not registered`);Iw.delete(n)}function Fut(e){if(!fT.has(e))throw new Error(`The gradient '${e}' for backend is not registered`);fT.delete(e)}function Out(e,t){w5(e).forEach(r=>{const i=Object.assign({},r,{backendName:t});Oz(i)})}function ete(e,t){return`${t}_${e}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pAe(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var xY=or,fu=null;try{fu=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function or(e,t,n){this.low=e|0,this.high=t|0,this.unsigned=!!n}or.prototype.__isLong__;Object.defineProperty(or.prototype,"__isLong__",{value:!0});function vl(e){return(e&&e.__isLong__)===!0}or.isLong=vl;var ege={},tge={};function Wb(e,t){var n,r,i;return t?(e>>>=0,(i=0<=e&&e<256)&&(r=tge[e],r)?r:(n=lr(e,(e|0)<0?-1:0,!0),i&&(tge[e]=n),n)):(e|=0,(i=-128<=e&&e<128)&&(r=ege[e],r)?r:(n=lr(e,e<0?-1:0,!1),i&&(ege[e]=n),n))}or.fromInt=Wb;function hu(e,t){if(isNaN(e))return t?k1:du;if(t){if(e<0)return k1;if(e>=gAe)return yAe}else{if(e<=-rge)return qo;if(e+1>=rge)return vAe}return e<0?hu(-e,t).neg():lr(e%Nw|0,e/Nw|0,t)}or.fromNumber=hu;function lr(e,t,n){return new or(e,t,n)}or.fromBits=lr;var $5=Math.pow;function tte(e,t,n){if(e.length===0)throw Error("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return du;if(typeof t=="number"?(n=t,t=!1):t=!!t,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return tte(e.substring(1),t,n).neg();for(var i=hu($5(n,8)),s=du,a=0;a<e.length;a+=8){var o=Math.min(8,e.length-a),l=parseInt(e.substring(a,a+o),n);if(o<8){var u=hu($5(n,o));s=s.mul(u).add(hu(l))}else s=s.mul(i),s=s.add(hu(l))}return s.unsigned=t,s}or.fromString=tte;function lf(e,t){return typeof e=="number"?hu(e,t):typeof e=="string"?tte(e,t):lr(e.low,e.high,typeof t=="boolean"?t:e.unsigned)}or.fromValue=lf;var nge=1<<16,Rut=1<<24,Nw=nge*nge,gAe=Nw*Nw,rge=gAe/2,ige=Wb(Rut),du=Wb(0);or.ZERO=du;var k1=Wb(0,!0);or.UZERO=k1;var I2=Wb(1);or.ONE=I2;var mAe=Wb(1,!0);or.UONE=mAe;var wY=Wb(-1);or.NEG_ONE=wY;var vAe=lr(-1,2147483647,!1);or.MAX_VALUE=vAe;var yAe=lr(-1,-1,!0);or.MAX_UNSIGNED_VALUE=yAe;var qo=lr(0,-2147483648,!1);or.MIN_VALUE=qo;var Re=or.prototype;Re.toInt=function(){return this.unsigned?this.low>>>0:this.low};Re.toNumber=function(){return this.unsigned?(this.high>>>0)*Nw+(this.low>>>0):this.high*Nw+(this.low>>>0)};Re.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(qo)){var n=hu(t),r=this.div(n),i=r.mul(n).sub(this);return r.toString(t)+i.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var s=hu($5(t,6),this.unsigned),a=this,o="";;){var l=a.div(s),u=a.sub(l.mul(s)).toInt()>>>0,c=u.toString(t);if(a=l,a.isZero())return c+o;for(;c.length<6;)c="0"+c;o=""+c+o}};Re.getHighBits=function(){return this.high};Re.getHighBitsUnsigned=function(){return this.high>>>0};Re.getLowBits=function(){return this.low};Re.getLowBitsUnsigned=function(){return this.low>>>0};Re.getNumBitsAbs=function(){if(this.isNegative())return this.eq(qo)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,n=31;n>0&&(t&1<<n)==0;n--);return this.high!=0?n+33:n+1};Re.isZero=function(){return this.high===0&&this.low===0};Re.eqz=Re.isZero;Re.isNegative=function(){return!this.unsigned&&this.high<0};Re.isPositive=function(){return this.unsigned||this.high>=0};Re.isOdd=function(){return(this.low&1)===1};Re.isEven=function(){return(this.low&1)===0};Re.equals=function(t){return vl(t)||(t=lf(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low};Re.eq=Re.equals;Re.notEquals=function(t){return!this.eq(t)};Re.neq=Re.notEquals;Re.ne=Re.notEquals;Re.lessThan=function(t){return this.comp(t)<0};Re.lt=Re.lessThan;Re.lessThanOrEqual=function(t){return this.comp(t)<=0};Re.lte=Re.lessThanOrEqual;Re.le=Re.lessThanOrEqual;Re.greaterThan=function(t){return this.comp(t)>0};Re.gt=Re.greaterThan;Re.greaterThanOrEqual=function(t){return this.comp(t)>=0};Re.gte=Re.greaterThanOrEqual;Re.ge=Re.greaterThanOrEqual;Re.compare=function(t){if(vl(t)||(t=lf(t)),this.eq(t))return 0;var n=this.isNegative(),r=t.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1};Re.comp=Re.compare;Re.negate=function(){return!this.unsigned&&this.eq(qo)?qo:this.not().add(I2)};Re.neg=Re.negate;Re.add=function(t){vl(t)||(t=lf(t));var n=this.high>>>16,r=this.high&65535,i=this.low>>>16,s=this.low&65535,a=t.high>>>16,o=t.high&65535,l=t.low>>>16,u=t.low&65535,c=0,f=0,h=0,d=0;return d+=s+u,h+=d>>>16,d&=65535,h+=i+l,f+=h>>>16,h&=65535,f+=r+o,c+=f>>>16,f&=65535,c+=n+a,c&=65535,lr(h<<16|d,c<<16|f,this.unsigned)};Re.subtract=function(t){return vl(t)||(t=lf(t)),this.add(t.neg())};Re.sub=Re.subtract;Re.multiply=function(t){if(this.isZero())return du;if(vl(t)||(t=lf(t)),fu){var n=fu.mul(this.low,this.high,t.low,t.high);return lr(n,fu.get_high(),this.unsigned)}if(t.isZero())return du;if(this.eq(qo))return t.isOdd()?qo:du;if(t.eq(qo))return this.isOdd()?qo:du;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(ige)&&t.lt(ige))return hu(this.toNumber()*t.toNumber(),this.unsigned);var r=this.high>>>16,i=this.high&65535,s=this.low>>>16,a=this.low&65535,o=t.high>>>16,l=t.high&65535,u=t.low>>>16,c=t.low&65535,f=0,h=0,d=0,p=0;return p+=a*c,d+=p>>>16,p&=65535,d+=s*c,h+=d>>>16,d&=65535,d+=a*u,h+=d>>>16,d&=65535,h+=i*c,f+=h>>>16,h&=65535,h+=s*u,f+=h>>>16,h&=65535,h+=a*l,f+=h>>>16,h&=65535,f+=r*c+i*u+s*l+a*o,f&=65535,lr(d<<16|p,f<<16|h,this.unsigned)};Re.mul=Re.multiply;Re.divide=function(t){if(vl(t)||(t=lf(t)),t.isZero())throw Error("division by zero");if(fu){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var n=(this.unsigned?fu.div_u:fu.div_s)(this.low,this.high,t.low,t.high);return lr(n,fu.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?k1:du;var r,i,s;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return k1;if(t.gt(this.shru(1)))return mAe;s=k1}else{if(this.eq(qo)){if(t.eq(I2)||t.eq(wY))return qo;if(t.eq(qo))return I2;var a=this.shr(1);return r=a.div(t).shl(1),r.eq(du)?t.isNegative()?I2:wY:(i=this.sub(t.mul(r)),s=r.add(i.div(t)),s)}else if(t.eq(qo))return this.unsigned?k1:du;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();s=du}for(i=this;i.gte(t);){r=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(r)/Math.LN2),l=o<=48?1:$5(2,o-48),u=hu(r),c=u.mul(t);c.isNegative()||c.gt(i);)r-=l,u=hu(r,this.unsigned),c=u.mul(t);u.isZero()&&(u=I2),s=s.add(u),i=i.sub(c)}return s};Re.div=Re.divide;Re.modulo=function(t){if(vl(t)||(t=lf(t)),fu){var n=(this.unsigned?fu.rem_u:fu.rem_s)(this.low,this.high,t.low,t.high);return lr(n,fu.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))};Re.mod=Re.modulo;Re.rem=Re.modulo;Re.not=function(){return lr(~this.low,~this.high,this.unsigned)};Re.and=function(t){return vl(t)||(t=lf(t)),lr(this.low&t.low,this.high&t.high,this.unsigned)};Re.or=function(t){return vl(t)||(t=lf(t)),lr(this.low|t.low,this.high|t.high,this.unsigned)};Re.xor=function(t){return vl(t)||(t=lf(t)),lr(this.low^t.low,this.high^t.high,this.unsigned)};Re.shiftLeft=function(t){return vl(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?lr(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):lr(0,this.low<<t-32,this.unsigned)};Re.shl=Re.shiftLeft;Re.shiftRight=function(t){return vl(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?lr(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):lr(this.high>>t-32,this.high>=0?0:-1,this.unsigned)};Re.shr=Re.shiftRight;Re.shiftRightUnsigned=function(t){if(vl(t)&&(t=t.toInt()),t&=63,t===0)return this;var n=this.high;if(t<32){var r=this.low;return lr(r>>>t|n<<32-t,n>>>t,this.unsigned)}else return t===32?lr(n,0,this.unsigned):lr(n>>>t-32,0,this.unsigned)};Re.shru=Re.shiftRightUnsigned;Re.shr_u=Re.shiftRightUnsigned;Re.toSigned=function(){return this.unsigned?lr(this.low,this.high,!1):this};Re.toUnsigned=function(){return this.unsigned?this:lr(this.low,this.high,!0)};Re.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()};Re.toBytesLE=function(){var t=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]};Re.toBytesBE=function(){var t=this.high,n=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};or.fromBytes=function(t,n,r){return r?or.fromBytesLE(t,n):or.fromBytesBE(t,n)};or.fromBytesLE=function(t,n){return new or(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,n)};or.fromBytesBE=function(t,n){return new or(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],n)};const Put=PSe({__proto__:null,default:xY},[xY]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r1=xY||Put;function yN(e){return r1.fromString(e,!0,16)}const bAe=yN("c3a5c85c97cb3127"),qv=yN("b492b66fbe98f273"),ha=yN("9ae16a3b2f90404f");function $Y(e){return e.xor(e.shru(47))}function xAe(e,t,n){const r=e.slice(t,t+n);return r1.fromBytes(Array.from(r),!0,!0)}function Zn(e,t){return xAe(e,t,8)}function sge(e,t){return xAe(e,t,4)}function $i(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function h0(e,t,n=yN("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let i=t.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function Lut(e,t,n,r,i,s){i=i.add(e),s=$i(s.add(i).add(r),21);const a=i;return i=i.add(t),i=i.add(n),s=s.add($i(i,44)),[i.add(r),s.add(a)]}function QF(e,t,n,r){return Lut(Zn(e,t),Zn(e,t+8),Zn(e,t+16),Zn(e,t+24),n,r)}function But(e,t=e.length){if(t>=8){const n=ha.add(t*2),r=Zn(e,0).add(ha),i=Zn(e,t-8),s=$i(i,37).mul(n).add(r),a=$i(r,25).add(i).mul(n);return h0(s,a,n)}if(t>=4){const n=ha.add(t*2),r=sge(e,0);return h0(r.shl(3).add(t),sge(e,t-4),n)}if(t>0){const n=e[0],r=e[t>>1],i=e[t-1],s=n+(r<<8),a=t+(i<<2);return $Y(ha.mul(s).xor(bAe.mul(a))).mul(ha)}return ha}function zut(e,t=e.length){const n=ha.add(t*2),r=Zn(e,0).mul(qv),i=Zn(e,8),s=Zn(e,t-8).mul(n),a=Zn(e,t-16).mul(ha);return h0($i(r.add(i),43).add($i(s,30)).add(a),r.add($i(i.add(ha),18)).add(s),n)}function Uut(e,t=e.length){const n=ha.add(t*2),r=Zn(e,0).mul(ha),i=Zn(e,8),s=Zn(e,t-8).mul(n),a=Zn(e,t-16).mul(ha),o=$i(r.add(i),43).add($i(s,30)).add(a),l=h0(o,r.add($i(i.add(ha),18)).add(s),n),u=Zn(e,16).mul(n),c=Zn(e,24),f=o.add(Zn(e,t-32)).mul(n),h=l.add(Zn(e,t-24)).mul(n);return h0($i(u.add(c),43).add($i(f,30)).add(h),u.add($i(c.add(r),18)).add(f),n)}function wAe(e,t=e.length){const n=r1.fromNumber(81,!0);if(t<=32)return t<=16?But(e,t):zut(e,t);if(t<=64)return Uut(e,t);let r=n,i=n.mul(qv).add(113),s=$Y(i.mul(ha).add(113)).mul(ha),a=[r1.UZERO,r1.UZERO],o=[r1.UZERO,r1.UZERO];r=r.mul(ha).add(Zn(e,0));let l=0;const u=(t-1>>6)*64,c=u+(t-1&63)-63;do r=$i(r.add(i).add(a[0]).add(Zn(e,l+8)),37).mul(qv),i=$i(i.add(a[1]).add(Zn(e,l+48)),42).mul(qv),r=r.xor(o[1]),i=i.add(a[0]).add(Zn(e,l+40)),s=$i(s.add(o[0]),33).mul(qv),a=QF(e,l,a[1].mul(qv),r.add(o[0])),o=QF(e,l+32,s.add(o[1]),i.add(Zn(e,l+16))),[s,r]=[r,s],l+=64;while(l!==u);const f=qv.add(s.and(255).shl(1));return l=c,o[0]=o[0].add(t-1&63),a[0]=a[0].add(o[0]),o[0]=o[0].add(a[0]),r=$i(r.add(i).add(a[0]).add(Zn(e,l+8)),37).mul(f),i=$i(i.add(a[1]).add(Zn(e,l+48)),42).mul(f),r=r.xor(o[1].mul(9)),i=i.add(a[0].mul(9).add(Zn(e,l+40))),s=$i(s.add(o[0]),33).mul(f),a=QF(e,l,a[1].mul(f),r.add(o[0])),o=QF(e,l+32,s.add(o[1]),i.add(Zn(e,l+16))),[s,r]=[r,s],h0(h0(a[0],o[0],f).add($Y(i).mul(bAe)).add(s),h0(a[1],o[1],f).add(r),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eg(e,t){return t==="string"?th(e):Lm([e],t)}function Wut(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function Lm(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Dh(e)),le().getBool("DEBUG")&&rAe(e,t),Wut(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){const n=new Uint8Array(e.length);for(let r=0;r<n.length;++r)Math.round(e[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${t}`)}function ua(){return le().platform.now()}function Vut(e,t){return le().platform.fetch(e,t)}function th(e,t="utf-8"){return t=t||"utf-8",le().platform.encode(e,t)}function Ip(e,t="utf-8"){return t=t||"utf-8",le().platform.decode(e,t)}function Ci(e){return le().platform.isTypedArray!=null?le().platform.isTypedArray(e):pAe(e)}function Dh(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||T8(e)||e==null||Ci(e)&&n)t.push(e);else if(Array.isArray(e)||Ci(e))for(let r=0;r<e.length;++r)Dh(e[r],t,n);else{let r=-1;for(const i of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(i)&&(r=Math.max(r,Number(i)));for(let i=0;i<=r;i++)Dh(e[i],t,n)}return t}const jut=Object.freeze(Object.defineProperty({__proto__:null,createScalarValue:eg,toTypedArray:Lm,now:ua,fetch:Vut,encodeString:th,decodeString:Ip,isTypedArray:Ci,flatten:Dh,shuffle:Yee,shuffleCombo:mut,clamp:P0,nearestLargerEven:E8,swap:Gd,sum:tAe,randUniform:vut,distSquared:yut,assert:B,assertShapesMatch:gs,assertNonNull:Lb,sizeFromShape:he,isScalarShape:but,arraysEqualWithNull:nAe,arraysEqual:Zt,isInt:Ny,tanh:xut,sizeToSquarishShape:g5,createShuffledIndices:wut,rightPad:X1,repeatedTry:yY,inferFromImplicitShape:Xee,parseAxisParam:Ot,squeezeShape:Jp,getTypedArrayFromDType:Fi,getArrayFromDType:Br,checkConversionForErrors:rAe,isValidDtype:iAe,hasEncodingLoss:Kee,bytesPerElement:oT,bytesFromStringArray:sAe,isString:Kf,isBoolean:aAe,isNumber:m5,inferDtype:Bb,isFunction:L0,nearestDivisor:v5,computeStrides:Je,toNestedArray:Eu,convertBackendValuesAndArrayBuffer:lAe,makeOnesTypedArray:A8,makeZerosTypedArray:hs,makeZerosNestedTypedArray:Zee,assertNonNegativeIntegerDimensions:ml,locToIndex:Bc,indexToLoc:zb,isPromise:T8,hexToLong:yN,fingerPrint64:wAe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hut{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new Gut)}profileKernel(t,n,r){let i;const s=()=>{i=r()};let a;const o=ua();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(s);else{s();for(const u of i)u.dataSync();a=Promise.resolve({kernelMs:ua()-o})}if(le().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<i.length;u++){const c=i[u];c.data().then(f=>{qut(f,c.dtype,t)})}return{kernelName:t,outputs:i,inputs:n,timeMs:a.then(u=>u.kernelMs),extraInfo:a.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:r,timeMs:i,inputs:s,extraInfo:a}=t;r.forEach(o=>{Promise.all([o.data(),i,a]).then(l=>{this.logger.logKernelProfile(n,o,l[0],l[1],s,l[2])})})}}function qut(e,t,n){if(t!=="float32")return!1;for(let r=0;r<e.length;r++){const i=e[r];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${n}'`),!0}return!1}class Gut{logKernelProfile(t,n,r,i,s,a){const o=typeof i=="number"?X1(`${i}ms`,9):i.error,l=X1(t,25),u=n.rank,c=n.size,f=X1(n.shape.toString(),14);let h="";for(const d in s){const p=s[d];if(p!=null){const g=p.shape||n.shape,m=g.length;h+=`${d}: ${m}D ${m>0?g:""} `}}console.log(`%c${l}	%c${o}	%c${u}D ${f}	%c${c}	%c${h}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yut(e,t,n){const r={},i={};for(let l=0;l<t.length;l++)r[t[l].id]=!0;for(let l=0;l<e.length;l++){const u=e[l],c=u.inputs;for(const f in c){const h=c[f];let d=!1;for(let p=0;p<t.length;p++)if(r[h.id]){u.outputs.forEach(g=>r[g.id]=!0),d=!0,i[u.id]=!0;break}if(d)break}}const s={};s[n.id]=!0;const a={};for(let l=e.length-1;l>=0;l--){const u=e[l],c=u.inputs;for(let f=0;f<u.outputs.length;f++)if(s[u.outputs[f].id]){for(const h in c)s[c[h].id]=!0,a[u.id]=!0;break}}const o=[];for(let l=0;l<e.length;l++){const u=e[l];if(i[u.id]&&a[u.id]){const c={};for(const h in u.inputs){const d=u.inputs[h];r[d.id]&&(c[h]=d)}const f=Object.assign({},u);f.inputs=c,f.outputs=u.outputs,o.push(f)}}return o}function Xut(e,t,n,r){for(let i=t.length-1;i>=0;i--){const s=t[i],a=[];if(s.outputs.forEach(l=>{const u=e[l.id];u!=null?a.push(u):a.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const o=s.gradient(a);for(const l in s.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const u=n(()=>o[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=s.inputs[l];if(!Zt(u.shape,c.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(e[c.id]==null)e[c.id]=u;else{const f=e[c.id];e[c.id]=r(f,u),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const age=20,GS=3,ij=7;function Kut(e,t,n,r){const i=Je(t),s=Zut(e,t,n,i),a=t.length,o=JR(e,t,n,i,s),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${a}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(o.map(u=>"    "+u).join(`
`)),l.join(`
`)}function Zut(e,t,n,r){const i=he(t),s=r[r.length-1],a=new Array(s).fill(0),o=t.length,l=n==="complex64"?tE(e):e;if(o>1)for(let u=0;u<i/s;u++){const c=u*s;for(let f=0;f<s;f++)a[f]=Math.max(a[f],eE(l[c+f],0,n).length)}return a}function eE(e,t,n){let r;return Array.isArray(e)?r=`${parseFloat(e[0].toFixed(ij))} + ${parseFloat(e[1].toFixed(ij))}j`:Kf(e)?r=`'${e}'`:n==="bool"?r=$Ae(e):r=parseFloat(e.toFixed(ij)).toString(),X1(r,t)}function $Ae(e){return e===0?"false":"true"}function JR(e,t,n,r,i,s=!0){const a=n==="complex64"?2:1,o=t[0],l=t.length;if(l===0){if(n==="complex64"){const g=tE(e);return[eE(g[0],0,n)]}return n==="bool"?[$Ae(e[0])]:[e[0].toString()]}if(l===1){if(o>age){const m=GS*a;let v=Array.from(e.slice(0,m)),y=Array.from(e.slice((o-GS)*a,o*a));return n==="complex64"&&(v=tE(v),y=tE(y)),["["+v.map((b,x)=>eE(b,i[x],n)).join(", ")+", ..., "+y.map((b,x)=>eE(b,i[o-GS+x],n)).join(", ")+"]"]}return["["+(n==="complex64"?tE(e):Array.from(e)).map((m,v)=>eE(m,i[v],n)).join(", ")+"]"]}const u=t.slice(1),c=r.slice(1),f=r[0]*a,h=[];if(o>age){for(let g=0;g<GS;g++){const m=g*f,v=m+f;h.push(...JR(e.slice(m,v),u,n,c,i,!1))}h.push("...");for(let g=o-GS;g<o;g++){const m=g*f,v=m+f;h.push(...JR(e.slice(m,v),u,n,c,i,g===o-1))}}else for(let g=0;g<o;g++){const m=g*f,v=m+f;h.push(...JR(e.slice(m,v),u,n,c,i,g===o-1))}const d=l===2?",":"";h[0]="["+(o>0?h[0]+d:"");for(let g=1;g<h.length-1;g++)h[g]=" "+h[g]+d;let p=`,
`;for(let g=2;g<l;g++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(s?"":p),h}function tE(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oi{constructor(t,n,r){if(this.dtype=n,this.shape=t.slice(),this.size=he(t),r!=null){const i=r.length;B(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Br(n,this.size),this.strides=Je(t)}set(t,...n){n.length===0&&(n=[0]),B(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const i of t){if(i<0||i>=this.shape[n]){const s=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(s)}n++}let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=this.strides[i]*t[i];return this.values[r]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return mc().makeTensor(this.values,this.shape,this.dtype)}}let mc=null,$2=null;function Qut(e){mc=e}function Jut(e){$2=e}class On{constructor(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=he(t),this.strides=Je(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return $2.buffer(this.shape,this.dtype,t)}bufferSync(){return $2.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Eu(this.shape,t,this.dtype==="complex64")}arraySync(){return Eu(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=mc().read(this.dataId);if(this.dtype==="string"){const n=await t;try{return n.map(r=>Ip(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),mc().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=mc().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>Ip(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await mc().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(mc().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return $2.print(this,t)}clone(){return this.throwIfDisposed(),$2.clone(this)}toString(t=!1){const n=this.dataSync();return Kut(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),$2.cast(this,t)}variable(t=!0,n,r){return this.throwIfDisposed(),mc().makeVariable(this,t,n,r)}}Object.defineProperty(On,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function ge(){return Jee("Tensor",()=>On)}ge();class dT extends On{constructor(t,n,r,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=n,this.name=r}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!Zt(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);mc().disposeTensor(this),this.dataId=t.dataId,mc().incRef(this,null)}dispose(){mc().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(dT,Symbol.hasInstance,{value:e=>e instanceof On&&e.assign!=null&&e.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var CY;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(CY||(CY={}));var _Y;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(_Y||(_Y={}));var SY;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(SY||(SY={}));var kY;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(kY||(kY={}));var EY;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(EY||(EY={}));const ect={float32:kY,int32:_Y,bool:SY,complex64:EY};function fo(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return ect[e][t]}function Rz(e){return fo(e,"int32")}function CAe(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function _Ae(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dr(e,t){if(e.dtype===t.dtype)return[e,t];const n=fo(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function SAe(e,t){B(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function tct(e,t){return t.some(n=>n.id===e.id)}function nte(e){const t=[];return kAe(e,t,new Set),t}function kAe(e,t,n){if(e==null)return;if(e instanceof On){t.push(e);return}if(!nct(e))return;const r=e;for(const i in r){const s=r[i];n.has(s)||(n.add(s),kAe(s,t,n))}}function nct(e){return Array.isArray(e)||typeof e=="object"}const rct=Object.freeze(Object.defineProperty({__proto__:null,makeTypesMatch:Dr,assertTypesMatch:SAe,isTensorInList:tct,getTensorsInContainer:nte},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sj(e){return e.kernelName!=null}class oge{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Mw{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new oge}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const r=t[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,r=1){return t in this.registryFactory?(kl(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:r},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(t);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Hut(this.backendInstance),!0}setupRegisteredKernels(){w5(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){w5(t).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof k8)&&typeof r.then=="function"){const i=++this.pendingBackendInitId,s=r.then(a=>i<this.pendingBackendInitId?!1:(this.registry[t]=a,this.pendingBackendInit=null,!0)).catch(a=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,kl(`Initialization of backend ${t} failed`),kl(a.stack||a.message)),!1));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}else return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(r){return kl(`Initialization of backend ${t} failed`),kl(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const r=t[n],{success:i,asyncInit:s}=this.initializeBackend(r);if(s||i)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const r=this.state.tensorInfo.get(n),i=r.backend,s=this.readSync(n),a=i.refCount(n);i.disposeData(n,!0),r.backend=t,t.move(n,s,r.shape,r.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let r=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}let i;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(i),()=>(i=n(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(t,n,r){t();try{const i=r();return n(),i}catch(i){throw n(),i}}nextTensorId(){return Mw.nextTensorId++}nextVariableId(){return Mw.nextVariableId++}clone(t){const n=Q.runKernel(GC,{x:t}),r={x:t},i=a=>({x:()=>{const o="float32",l={x:a},u={dtype:o};return Q.runKernel(FC,l,u)}}),s=[];return this.addTapeNode(this.state.activeScope.name,r,[n],i,s,{}),n}runKernel(t,n,r){if(this.backendName==null&&this.backend,!(hT(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,r){const i=this.backend.numDataIds();let s=0;r.forEach(l=>{s+=l.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=i-n-s-a;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${t}'`)}runKernelFunc(t){let n,r=[];const i=this.isTapeOn(),s=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const u=sj(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(sj(t)){const{kernelName:p,inputs:g,attrs:m}=t;this.backendName==null&&this.backend;const v=hT(p,this.backendName);B(v!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),o=()=>{const y=this.backend.numDataIds();l=v.kernelFunc({inputs:g,attrs:m,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,y,b);const x=b.map(w=>w.rank!=null?w:this.makeTensorFromTensorInfo(w));if(i){const w=this.getTensorsForGradient(p,g,x);r=this.saveTensorsForBackwardMode(w)}return x}}else{const{forwardFunc:p}=t,g=m=>{!i||(r=m.map(v=>this.keep(this.clone(v))))};o=()=>{const m=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,g));const v=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,m,v),v}}const{inputs:c,attrs:f}=t,h=sj(t)?null:t.backwardsFunc;let d;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=o():(d=this.profiler.profileKernel(u,c,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(d),n=d.outputs)}),i&&this.addTapeNode(u,c,n,h,r,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:d.timeMs,extraInfo:d.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(t){return t.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(t,n,r){const i=bY(t);if(i!=null){const s=i.inputsToSave||[],a=i.outputsToSave||[];let o;i.saveAllInputs?(B(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(n).map(u=>n[u])):o=s.map(u=>n[u]);const l=r.filter((u,c)=>a[c]);return o.concat(l)}return[]}makeTensor(t,n,r,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;let s=t;r==="string"&&Kf(t[0])&&(s=t.map(l=>th(l)));const a=i.write(s,n,r),o=new On(n,r,a,this.nextTensorId());if(this.trackTensor(o,i),r==="string"){const l=this.state.tensorInfo.get(a),u=sAe(s);this.state.numBytes+=u-l.bytes,l.bytes=u}return o}makeTensorFromDataId(t,n,r,i){r=r||"float32";const s={dataId:t,shape:n,dtype:r};return this.makeTensorFromTensorInfo(s,i)}makeTensorFromTensorInfo(t,n){const{dataId:r,shape:i,dtype:s}=t,a=new On(i,s,r,this.nextTensorId());return this.trackTensor(a,n),a}makeVariable(t,n=!0,r,i){r=r||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.cast(i));const s=new dT(t,n,r,this.nextTensorId());if(this.state.registeredVariables[s.name]!=null)throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(t,n){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let r=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(r=t.size*oT(t.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:r})),t instanceof dT||this.track(t)}incRef(t,n){this.trackTensor(t,n),this.backend.incRef(t.dataId)}removeDataId(t,n){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===n&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const n=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const r=t.size*oT(t.dtype);this.state.numBytes-=r}n.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,n.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,r,i,s,a){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:s},l=bY(t);l!=null&&(i=l.gradFunc),i!=null&&(o.gradient=u=>(u=u.map((c,f)=>{if(c==null){const h=r[f],d=hs(h.size,h.dtype);return this.makeTensor(d,h.shape,h.dtype)}return c}),i(u.length>1?u:u[0],s,a))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=nte(t),r=new Set(n.map(s=>s.id));for(let s=0;s<this.state.activeScope.track.length;s++){const a=this.state.activeScope.track[s];!a.kept&&!r.has(a.id)&&a.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(s=>{!s.kept&&s.scopeId===i.id&&this.track(s)})}gradients(t,n,r,i=!1){if(B(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));B(s instanceof On,()=>"The result y returned by f() must be a tensor.");const a=Yut(this.state.activeTape,n,s);if(!i&&a.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[s.id]=r==null?ict(s.shape):r,Xut(o,a,u=>this.tidy(u),sct);const l=n.map(u=>o[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:s,grads:l}})}customGrad(t){return B(L0(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{B(n.every(o=>o instanceof On),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const i={};n.forEach((o,l)=>{i[l]=o});const s=(o,l)=>(r=t(...n,l),B(r.value instanceof On,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),B(L0(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),a=(o,l)=>{const u=r.gradFunc(o,l),c=Array.isArray(u)?u:[u];B(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),B(c.every(h=>h instanceof On),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return c.forEach((h,d)=>{f[d]=()=>h}),f};return this.runKernelFunc({forwardFunc:s,backwardsFunc:a,inputs:i})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,n){return this.state.tensorInfo.get(t).backend.readToGPU(t,n)}async time(t){const n=ua(),r=await this.backend.time(t);return r.wallMs=ua()-n,r}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new oge;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Mw.nextTensorId=0;Mw.nextVariableId=0;function ict(e){const t=A8(he(e),"float32");return Q.makeTensor(t,e,"float32")}function EAe(){const e=cAe();if(e._tfengine==null){const t=new uAe(e);e._tfengine=new Mw(t)}return Sut(e._tfengine.ENV),Qut(()=>e._tfengine),e._tfengine}const Q=EAe();function sct(e,t){const n={a:e,b:t};return Q.runKernel(Ub,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function act(){return typeof navigator<"u"&&navigator!=null}let AY;function oct(e){AY=e}function rte(e){if(AY!==void 0)return AY;if(e||act()){if(e||(e=navigator),e.product==="ReactNative")return!0;const t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){const n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function ite(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const lct=Object.freeze(Object.defineProperty({__proto__:null,mockIsMobile:oct,isMobile:rte,isBrowser:ite},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ho=le();ho.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ho.registerFlag("IS_BROWSER",()=>ite());ho.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ho.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ho.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ho.registerFlag("PROD",()=>!1);ho.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ho.getBool("DEBUG"));ho.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ho.registerFlag("IS_TEST",()=>!1);ho.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ho.getBool("DEBUG"));ho.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ho.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ho.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ih(e,t){let n=e;if(Ci(e))return t==="string"?[]:[e.length];if(CAe(e)){const i=e.channels||"RGBA";return[e.height,e.width*i.length]}else if(_Ae(e))return[e.buffer.size/(t==null?4:oT(t))];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||Ci(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&le().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&AAe(e,r,[]),r}function AAe(e,t,n){if(n=n||[],!Array.isArray(e)&&!Ci(e)){B(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}B(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),B(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);const r=t.slice(1);for(let i=0;i<e.length;++i)AAe(e[i],r,n.concat(i))}function lge(e,t,n,r){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function U(e,t,n,r="numeric"){if(e instanceof On)return lge(r,e.dtype,t,n),e;let i=Bb(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),lge(r,i,t,n),e==null||!Ci(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){const l=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const s=Ih(e,i);!Ci(e)&&!Array.isArray(e)&&(e=[e]);const o=i!=="string"?Lm(e,i):Dh(e,[],!0);return Q.makeTensor(o,s,i)}function pT(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((s,a)=>U(s,`${t}[${a}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TAe="__op";function ee(e){const t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+TAe;const i=(...s)=>{Q.startScope(n);try{const a=r(...s);return T8(a)&&console.error("Cannot return a Promise inside of tidy."),Q.endScope(a),a}catch(a){throw Q.endScope(null),a}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uct(e,t){const n=U(e,"real","complex"),r=U(t,"imag","complex");gs(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const i={real:n,imag:r};return Q.runKernel(R8,i)}const B0=ee({complex_:uct});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bm(e,t,n,r){if(r==null)r=Bb(e);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(_Ae(e)||CAe(e)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return Q.backend.createTensorFromGPUData(e,t||n,r)}if(!Ci(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){ml(t);const i=he(t),s=he(n);B(i===s,()=>`Based on the provided shape, [${t}], the tensor should have ${i} values but has ${s}`);for(let a=0;a<n.length;++a){const o=n[a],l=a===n.length-1?o!==he(t.slice(a)):!0;B(n[a]===t[a]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Ci(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=r!=="string"?Lm(e,r):Dh(e,[],!0),Q.makeTensor(e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vp(e,t,n){const r=Ih(e,n);return Bm(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TY={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class uf{static join(t){return new uf(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(r=>Ci(r)?r.buffer:r),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let n=0;for(let r=0;r<t.length;r++){const i=t[r];r!==t.length-1&&i.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const s=n+i.byteLength;this.shards.push({buffer:i,start:n,end:s}),n=s}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,n=isNaN(Number(n))?0:n,t=Math.max(0,t),n=Math.min(this.byteLength,n),n<=t)return new ArrayBuffer(0);const r=this.findShardForByte(t);if(r===-1)throw new Error(`Could not find start shard for byte ${t}`);const i=n-t,s=new ArrayBuffer(i),a=new Uint8Array(s);let o=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],f=t+o-u.start,h=o,p=Math.min(n,u.end)-u.start,g=new Uint8Array(u.buffer,f,p-f);if(a.set(g,h),o+=g.length,n<u.end)break}return s}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function n(i){return t<i.start?-1:t>=i.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=cct(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function cct(e,t){let n=0,r=e.length;for(;n<=r;){const i=Math.floor((r-n)/2)+n,s=t(e[i]);if(s===0)return i;s<0?r=i:n=i+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C5=4;async function DY(e,t){const n=[],r=[],i=Array.isArray(e)?e.map(a=>a.name):Object.keys(e);for(let a=0;a<i.length;++a){const o=i[a],l=Array.isArray(e)?e[a].tensor:e[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const u={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async f=>{const h=await l.bytes(),d=h.reduce((m,v)=>m+v.length,0)+C5*h.length,p=new Uint8Array(d);let g=0;for(let m=0;m<h.length;m++){const v=h[m],y=new Uint8Array(new Uint32Array([v.length]).buffer);p.set(y,g),g+=C5,p.set(v,g),g+=v.length}f(p)});r.push(c)}else r.push(l.data());t!=null&&(u.group=t),n.push(u)}const s=await Promise.all(r);return{data:fct(s),specs:n}}function DAe(e,t){const n=new uf(e),r={};let i,s=0;for(const a of t){const o=a.name,l=a.dtype,u=a.shape,c=he(u);let f;if("quantization"in a){const h=a.quantization;if(h.dtype==="uint8"||h.dtype==="uint16"){if(!("min"in h&&"scale"in h))throw new Error(`Weight ${a.name} with quantization ${h.dtype} doesn't have corresponding metadata min and scale.`)}else if(h.dtype==="float16"){if(l!=="float32")throw new Error(`Weight ${a.name} is quantized with ${h.dtype} which only supports weights of type float32 not ${l}.`)}else throw new Error(`Weight ${a.name} has unknown quantization dtype ${h.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const d=TY[h.dtype],p=n.slice(s,s+c*d),g=h.dtype==="uint8"?new Uint8Array(p):new Uint16Array(p);if(l==="float32")if(h.dtype==="uint8"||h.dtype==="uint16"){f=new Float32Array(g.length);for(let m=0;m<g.length;m++){const v=g[m];f[m]=v*h.scale+h.min}}else if(h.dtype==="float16")i===void 0&&(i=vct()),f=i(g);else throw new Error(`Unsupported quantization type ${h.dtype} for weight type float32.`);else if(l==="int32"){if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error(`Unsupported quantization type ${h.dtype} for weight type int32.`);f=new Int32Array(g.length);for(let m=0;m<g.length;m++){const v=g[m];f[m]=Math.round(v*h.scale+h.min)}}else throw new Error(`Unsupported dtype in weight '${o}': ${l}`);s+=c*d}else if(l==="string"){const h=he(a.shape);f=[];for(let d=0;d<h;d++){const p=new Uint32Array(n.slice(s,s+C5))[0];s+=C5;const g=new Uint8Array(n.slice(s,s+p));f.push(g),s+=p}}else{const h=TY[l],d=n.slice(s,s+c*h);if(l==="float32")f=new Float32Array(d);else if(l==="int32")f=new Int32Array(d);else if(l==="bool")f=new Uint8Array(d);else if(l==="complex64"){f=new Float32Array(d);const p=new Float32Array(f.length/2),g=new Float32Array(f.length/2);for(let y=0;y<p.length;y++)p[y]=f[y*2],g[y]=f[y*2+1];const m=vp(p,u,"float32"),v=vp(g,u,"float32");r[o]=B0(m,v),m.dispose(),v.dispose()}else throw new Error(`Unsupported dtype in weight '${o}': ${l}`);s+=c*h}l!=="complex64"&&(r[o]=vp(f,u,l))}return r}function fct(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const n=[];e.forEach(s=>{if(t+=s.byteLength,n.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});const r=new Uint8Array(t);let i=0;return n.forEach(s=>{r.set(new Uint8Array(s.buffer),i),i+=s.byteLength}),r.buffer}const ste=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function uge(e){return ste?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function hct(e){if(ste)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let r=0,i=t.length;r<i;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function dct(e){if(ste){const r=Buffer.from(e,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}function IAe(e){return uf.join(e)}function cge(e){const t="/";for(e=e.trim();e.endsWith(t);)e=e.slice(0,e.length-1);const n=e.split(t);return n[n.length-1]}function NAe(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function MAe(e,t,n){const r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(r.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return e.signature!=null&&(r.signature=e.signature),e.userDefinedMetadata!=null&&(r.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(r.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(r.initializerSignature=e.initializerSignature),r}async function ate(e,t){let n,r;return e.weightsManifest!=null&&([n,r]=await t(e.weightsManifest)),MAe(e,n,r)}function bN(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:uge(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:uge(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new uf(e.weightData).byteLength}}function FAe(e){const t=[];for(const n of e)t.push(...n.weights);return t}function pct(){const e=n=>{let r=n<<13,i=0;for(;(r&8388608)===0;)i-=8388608,r<<=1;return r&=-8388609,i+=947912704,r|i},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function gct(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function mct(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function vct(){const e=pct(),t=gct(),n=mct();return r=>{const i=new ArrayBuffer(4*r.length),s=new Uint32Array(i);for(let a=0;a<r.length;a++){const o=r[a],l=e[n[o>>10]+(o&1023)]+t[o>>10];s[a]=l}return new Float32Array(i)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cr{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Cr.instance==null&&(Cr.instance=new Cr),Cr.instance}static registerSaveRouter(t){Cr.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Cr.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Cr.getHandlers(t,"save")}static getLoadHandlers(t,n){return Cr.getHandlers(t,"load",n)}static getHandlers(t,n,r){const i=[];return(n==="load"?Cr.getInstance().loadRouters:Cr.getInstance().saveRouters).forEach(a=>{const o=a(t,r);o!==null&&i.push(o)}),i}}const yct=e=>Cr.registerSaveRouter(e),bct=e=>Cr.registerLoadRouter(e),OAe=e=>Cr.getSaveHandlers(e),xct=(e,t)=>Cr.getLoadHandlers(e,t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IY="tensorflowjs",NY=1,E1="models_store",qg="model_info_store";function RAe(){if(!le().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function MY(e){const t=e.result;t.createObjectStore(E1,{keyPath:"modelPath"}),t.createObjectStore(qg,{keyPath:"modelPath"})}class My{constructor(t){if(this.indexedDB=RAe(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,n){return new Promise((r,i)=>{const s=this.indexedDB.open(IY,NY);s.onupgradeneeded=()=>MY(s),s.onsuccess=()=>{const a=s.result;if(n==null){const o=a.transaction(E1,"readonly"),u=o.objectStore(E1).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return a.close(),i(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(a.close(),i(u.error)),o.oncomplete=()=>a.close()}else{n.weightData=uf.join(n.weightData);const o=bN(n),l=a.transaction(qg,"readwrite");let u=l.objectStore(qg),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(h){return i(h)}let f;c.onsuccess=()=>{f=a.transaction(E1,"readwrite");const h=f.objectStore(E1);let d;try{d=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:o})}catch(p){return i(p)}d.onsuccess=()=>r({modelArtifactsInfo:o}),d.onerror=p=>{u=l.objectStore(qg);const g=u.delete(this.modelPath);g.onsuccess=()=>(a.close(),i(d.error)),g.onerror=m=>(a.close(),i(d.error))}},c.onerror=h=>(a.close(),i(c.error)),l.oncomplete=()=>{f==null?a.close():f.oncomplete=()=>a.close()}}},s.onerror=a=>i(s.error)})}}My.URL_SCHEME="indexeddb://";const PAe=e=>le().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(My.URL_SCHEME)?wct(e.slice(My.URL_SCHEME.length)):null;Cr.registerSaveRouter(PAe);Cr.registerLoadRouter(PAe);function wct(e){return new My(e)}function $ct(e){return e.startsWith(My.URL_SCHEME)?e.slice(My.URL_SCHEME.length):e}class Cct{constructor(){this.indexedDB=RAe()}async listModels(){return new Promise((t,n)=>{const r=this.indexedDB.open(IY,NY);r.onupgradeneeded=()=>MY(r),r.onsuccess=()=>{const i=r.result,s=i.transaction(qg,"readonly"),o=s.objectStore(qg).getAll();o.onsuccess=()=>{const l={};for(const u of o.result)l[u.modelPath]=u.modelArtifactsInfo;t(l)},o.onerror=l=>(i.close(),n(o.error)),s.oncomplete=()=>i.close()},r.onerror=i=>n(r.error)})}async removeModel(t){return t=$ct(t),new Promise((n,r)=>{const i=this.indexedDB.open(IY,NY);i.onupgradeneeded=()=>MY(i),i.onsuccess=()=>{const s=i.result,a=s.transaction(qg,"readwrite"),o=a.objectStore(qg),l=o.get(t);let u;l.onsuccess=()=>{if(l.result==null)return s.close(),r(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const c=o.delete(t),f=()=>{u=s.transaction(E1,"readwrite");const d=u.objectStore(E1).delete(t);d.onsuccess=()=>n(l.result.modelArtifactsInfo),d.onerror=p=>r(l.error)};c.onsuccess=f,c.onerror=h=>(f(),s.close(),r(l.error))}},l.onerror=c=>(s.close(),r(l.error)),a.oncomplete=()=>{u==null?s.close():u.oncomplete=()=>s.close()}},i.onerror=s=>r(i.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yd="/",C2="tensorflowjs_models",LAe="info",_ct="model_topology",Sct="weight_specs",kct="weight_data",Ect="model_metadata";function BAe(e){return{info:[C2,e,LAe].join(Yd),topology:[C2,e,_ct].join(Yd),weightSpecs:[C2,e,Sct].join(Yd),weightData:[C2,e,kct].join(Yd),modelMetadata:[C2,e,Ect].join(Yd)}}function zAe(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function Act(e){const t=e.split(Yd);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(Yd)}function Tct(e){return e.startsWith(Fy.URL_SCHEME)?e.slice(Fy.URL_SCHEME.length):e}class Fy{constructor(t){if(!le().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=BAe(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=bN(t),s=uf.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,hct(s));const a={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,initializerSignature:t.initializerSignature!=null?t.initializerSignature:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:i}}catch{throw zAe(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(i==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=i;const s=this.LS.getItem(this.keys.modelMetadata);if(s!=null){const o=JSON.parse(s);n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,o.signature!=null&&(n.signature=o.signature),o.userDefinedMetadata!=null&&(n.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(n.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(n.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(n.trainingConfig=o.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=dct(a),n}}Fy.URL_SCHEME="localstorage://";const UAe=e=>le().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Fy.URL_SCHEME)?Dct(e.slice(Fy.URL_SCHEME.length)):null;Cr.registerSaveRouter(UAe);Cr.registerLoadRouter(UAe);function Dct(e){return new Fy(e)}class Ict{constructor(){B(le().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),B(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},n=C2+Yd,r=Yd+LAe;for(let i=0;i<this.LS.length;++i){const s=this.LS.key(i);if(s.startsWith(n)&&s.endsWith(r)){const a=Act(s);t[a]=JSON.parse(this.LS.getItem(s))}}return t}async removeModel(t){t=Tct(t);const n=BAe(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const r=JSON.parse(this.LS.getItem(n.info));return zAe(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G2="://";class ca{constructor(){this.managers={}}static getInstance(){return ca.instance==null&&(ca.instance=new ca),ca.instance}static registerManager(t,n){B(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(G2)&&(t=t.slice(0,t.indexOf(G2))),B(t.length>0,()=>"scheme must not be an empty string.");const r=ca.getInstance();B(r.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=n}static getManager(t){const n=ca.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(ca.getInstance().managers)}}function e4(e){if(e.indexOf(G2)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${ca.getSchemes().join(",")}`);return{scheme:e.split(G2)[0],path:e.split(G2)[1]}}async function WAe(e,t,n=!1){B(e!==t,()=>`Old path and new path are the same: '${e}'`);const r=Cr.getLoadHandlers(e);B(r.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),B(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`);const i=r[0],s=Cr.getSaveHandlers(t);B(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),B(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);const a=s[0],o=e4(e).scheme,l=e4(e).path,u=o===e4(e).scheme,c=await i.load();n&&u&&await ca.getManager(o).removeModel(l);const f=await a.save(c);return n&&!u&&await ca.getManager(o).removeModel(l),f.modelArtifactsInfo}async function Nct(){const e=ca.getSchemes(),t={};for(const n of e){const r=await ca.getManager(n).listModels();for(const i in r){const s=n+G2+i;t[s]=r[i]}}return t}async function Mct(e){const t=e4(e);return ca.getManager(t.scheme).removeModel(t.path)}async function Fct(e,t){return WAe(e,t,!1)}async function Oct(e,t){return WAe(e,t,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rct{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}setTimeoutCustom(t,n){if(typeof window>"u"||!le().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,n);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const i=this.functionRefs[r.data.index];i(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return pAe(t)}}if(le().get("IS_BROWSER")){le().setPlatform("browser",new Rct);try{ca.registerManager(Fy.URL_SCHEME,new Ict)}catch{}try{ca.registerManager(My.URL_SCHEME,new Cct)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pct={importFetch:()=>require("node-fetch")};let aj;class Lct{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return le().global.fetch!=null?le().global.fetch(t,n):(aj==null&&(aj=Pct.importFetch()),aj(t,n))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}le().get("IS_NODE")&&!le().get("IS_BROWSER")&&le().setPlatform("node",new Lct);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mt(e,t="float32",n){return t=t||"float32",ml(e),new oi(e,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bct(e,t){const n=U(e,"x","cast");if(!iAe(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},i={dtype:t};return Q.runKernel(FC,r,i)}const Oe=ee({cast_:Bct});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zct(e){const n={x:U(e,"x","clone","string_or_numeric")};return Q.runKernel(GC,n)}const d0=ee({clone_:zct});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VAe(e,t=!1){console.log(e.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */EAe();const Uct={buffer:Mt,cast:Oe,clone:d0,print:VAe};Jut(Uct);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wct(){le().set("PROD",!0)}function Vct(){le().set("DEBUG",!0)}function jct(){le().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Hct(e){le().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function qct(){Q.disposeVariables()}function fc(){return Q}function _5(){return Q.memory()}function Gct(e){return Q.profile(e)}function ce(e,t){return Q.tidy(e,t)}function Bt(e){nte(e).forEach(n=>n.dispose())}function zc(e){return Q.keep(e)}function Yct(e){return Q.time(e)}function Xct(e){return Q.setBackend(e)}function Kct(){return Q.ready()}function Zct(){return Q.backendName}function Qct(e){Q.removeBackend(e)}function Jct(e){return Q.findBackend(e)}function eft(e){return Q.findBackendFactory(e)}function ote(e,t,n=1){return Q.registerBackend(e,t,n)}function jAe(){return Q.backend}function tft(e,t){le().setPlatform(e,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nft(e,t){let n=U(e,"a","add"),r=U(t,"b","add");[n,r]=Dr(n,r);const i={a:n,b:r};return Q.runKernel(Ub,i)}const ke=ee({add_:nft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rft(e,t){let n=U(e,"a","floorDiv"),r=U(t,"b","floorDiv");[n,r]=Dr(n,r);const i={a:n,b:r};return Q.runKernel(HC,i)}const lte=ee({floorDiv_:rft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ift(e,t){let n=U(e,"a","div"),r=U(t,"b","div");if([n,r]=Dr(n,r),n.dtype==="int32"&&r.dtype==="int32")return lte(n,r);const i={a:n,b:r},s={};return Q.runKernel(BC,i,s)}const Qe=ee({div_:ift});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sft(e,t){let n=U(e,"a","mul"),r=U(t,"b","mul");[n,r]=Dr(n,r);const i={a:n,b:r};return Q.runKernel(n_,i)}const ne=ee({mul_:sft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aft(e){const t=U(e,"x","abs");if(t.dtype==="complex64"){const n={x:t};return Q.runKernel(_I,n)}else{const n={x:t};return Q.runKernel(gI,n)}}const hi=ee({abs_:aft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oft(e){const n={x:U(e,"x","acos")};return Q.runKernel(EC,n)}const HAe=ee({acos_:oft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lft(e){const n={x:U(e,"x","acosh")};return Q.runKernel(AC,n)}const qAe=ee({acosh_:lft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uft(e){B(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),B(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);const t=e.map((i,s)=>U(i,`tensors${s}`,"addN")),n=t[0];t.forEach(i=>{if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(i=>{if(!Zt(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=t;return Q.runKernel(mI,r)}const cft=ee({addN_:uft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fft(e,t=null,n=!1){const i={x:U(e,"x","all","bool")},s={axis:t,keepDims:n};return Q.runKernel(D8,i,s)}const ute=ee({all_:fft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hft(e,t=null,n=!1){const i={x:U(e,"x","any","bool")},s={axis:t,keepDims:n};return Q.runKernel(I8,i,s)}const S5=ee({any_:hft});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dft(e,t=0){const r={x:U(e,"x","argMax")},i={axis:t};return Q.runKernel(vI,r,i)}const Fw=ee({argMax_:dft});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pft(e,t=0){const r={x:U(e,"x","argMin")},i={axis:t};return Q.runKernel(yI,r,i)}const GAe=ee({argMin_:pft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gft(e){const n={x:U(e,"x","asin")};return Q.runKernel(TC,n)}const YAe=ee({asin_:gft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mft(e){const n={x:U(e,"x","asinh")};return Q.runKernel(DC,n)}const XAe=ee({asinh_:mft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vft(e){const n={x:U(e,"x","atan")};return Q.runKernel(IC,n)}const KAe=ee({atan_:vft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yft(e,t){let n=U(e,"a","atan2"),r=U(t,"b","atan2");[n,r]=Dr(n,r);const i={a:n,b:r};return Q.runKernel(MC,i)}const ZAe=ee({atan2_:yft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bft(e){const n={x:U(e,"x","atanh")};return Q.runKernel(NC,n)}const QAe=ee({atanh_:bft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xN(e,t,n,r,i="NHWC",s){const a=e[3],o=[...t,a],l=ng(i);return Pi(e,o,n,s,r,null,null,l)}function Hu(e,t,n,r,i,s,a="channelsLast"){const[o,l]=gT(t);let u;if(a==="channelsLast")u=[o,l,e[3],e[3]];else if(a==="channelsFirst")u=[o,l,e[1],e[1]];else throw new Error(`Unknown dataFormat ${a}`);return Pi(e,u,n,r,i,s,!1,a)}function tg(e,t,n,r,i,s,a="NDHWC"){const[o,l,u]=FY(t);let c,f;if(a==="NDHWC")f="channelsLast",c=[o,l,u,e[4],e[4]];else if(a==="NCDHW")f="channelsFirst",c=[o,l,u,e[1],e[1]];else throw new Error(`Unknown dataFormat ${a}`);return zm(e,c,n,r,i,!1,f,s)}function Pi(e,t,n,r,i,s,a=!1,o="channelsLast"){let[l,u,c,f]=[-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,f]=e;else if(o==="channelsFirst")[l,f,u,c]=e;else throw new Error(`Unknown dataFormat ${o}`);const[h,d,,p]=t,[g,m]=gT(n),[v,y]=gT(r),b=Y2(h,v),x=Y2(d,y),{padInfo:w,outHeight:C,outWidth:$}=$ft(i,u,c,g,m,b,x,s,o),_=a?p*f:p;let k;return o==="channelsFirst"?k=[l,_,C,$]:o==="channelsLast"&&(k=[l,C,$,_]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:c,inChannels:f,outHeight:C,outWidth:$,outChannels:_,padInfo:w,strideHeight:g,strideWidth:m,filterHeight:h,filterWidth:d,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:v,dilationWidth:y,inShape:e,outShape:k,filterShape:t}}function zm(e,t,n,r,i,s=!1,a="channelsLast",o){let[l,u,c,f,h]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,f,h]=e;else if(a==="channelsFirst")[l,h,u,c,f]=e;else throw new Error(`Unknown dataFormat ${a}`);const[d,p,g,,m]=t,[v,y,b]=FY(n),[x,w,C]=FY(r),$=Y2(d,x),_=Y2(p,w),k=Y2(g,C),{padInfo:E,outDepth:S,outHeight:I,outWidth:A}=Cft(i,u,c,f,v,y,b,$,_,k,o),D=s?m*h:m;let T;return a==="channelsFirst"?T=[l,D,S,I,A]:a==="channelsLast"&&(T=[l,S,I,A,D]),{batchSize:l,dataFormat:a,inDepth:u,inHeight:c,inWidth:f,inChannels:h,outDepth:S,outHeight:I,outWidth:A,outChannels:D,padInfo:E,strideDepth:v,strideHeight:y,strideWidth:b,filterDepth:d,filterHeight:p,filterWidth:g,effectiveFilterDepth:$,effectiveFilterHeight:_,effectiveFilterWidth:k,dilationDepth:x,dilationHeight:w,dilationWidth:C,inShape:e,outShape:T,filterShape:t}}function xft(e,t,n,r,i){r==null&&(r=cte(e,t,n));const s=e[0],a=e[1],o=mT((s-t+2*r)/n+1,i),l=mT((a-t+2*r)/n+1,i);return[o,l]}function wft(e,t,n,r,i,s){i==null&&(i=cte(e,t[0],r[0]));const a=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*i>=t[o]&&(a[o]=mT((e[o]-t[o]+2*i)/r[o]+1,s));return a}function cte(e,t,n,r=1){const i=Y2(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function gT(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function FY(e){return typeof e=="number"?[e,e,e]:e}function Y2(e,t){return t<=1?e:e+(e-1)*(t-1)}function $ft(e,t,n,r,i,s,a,o,l){let u,c,f;if(typeof e=="number"){u={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};const d=xft([t,n],s,r,e,o);c=d[0],f=d[1]}else if(e==="same"){c=Math.ceil(t/r),f=Math.ceil(n/i);const h=Math.max(0,(c-1)*r+s-t),d=Math.max(0,(f-1)*i+a-n),p=Math.floor(h/2),g=h-p,m=Math.floor(d/2),v=d-m;u={top:p,bottom:g,left:m,right:v,type:"SAME"}}else if(e==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-s+1)/r),f=Math.ceil((n-a+1)/i);else if(typeof e=="object"){const h=l==="channelsLast"?e[1][0]:e[2][0],d=l==="channelsLast"?e[1][1]:e[2][1],p=l==="channelsLast"?e[2][0]:e[3][0],g=l==="channelsLast"?e[2][1]:e[3][1];u={top:h,bottom:d,left:p,right:g,type:h===0&&d===0&&p===0&&g===0?"VALID":"EXPLICIT"},c=mT((t-s+h+d)/r+1,o),f=mT((n-a+p+g)/i+1,o)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:u,outHeight:c,outWidth:f}}function Cft(e,t,n,r,i,s,a,o,l,u,c){let f,h,d,p;if(e==="valid"&&(e=0),typeof e=="number"){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};const m=wft([t,n,r,1],[o,l,u],1,[i,s,a],e,c);h=m[0],d=m[1],p=m[2]}else if(e==="same"){h=Math.ceil(t/i),d=Math.ceil(n/s),p=Math.ceil(r/a);const g=(h-1)*i+o-t,m=(d-1)*s+l-n,v=(p-1)*a+u-r,y=Math.floor(g/2),b=g-y,x=Math.floor(m/2),w=m-x,C=Math.floor(v/2),$=v-C;f={top:x,bottom:w,left:C,right:$,front:y,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:f,outDepth:h,outHeight:d,outWidth:p}}function mT(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function z0(e){const[t,n,r]=gT(e);return t===1&&n===1&&r===1}function ms(e,t){return z0(e)||z0(t)}function Oy(e){return gT(e).every(t=>t>0)}function ng(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function Oa(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")B(Ny(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(r=>{r.forEach(i=>{B(Ny(i),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${i}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ft(e,t){const r={x:U(e,"x","reshape","string_or_numeric")},i={shape:t};return Q.runKernel(iN,r,i)}const ie=ee({reshape_:_ft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sft(e,t,n,r,i){const s=U(e,"x","avgPool","float32"),a=1;B(ms(n,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);let o=s,l=!1;s.rank===3&&(l=!0,o=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]])),B(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),Oa("avgPool",r,i);const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i};let f=Q.runKernel(bI,u,c);return f=Oe(f,s.dtype),l?ie(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Pz=ee({avgPool_:Sft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kft(e,t,n,r,i,s="NDHWC"){const a=U(e,"x","avgPool3d","float32");let o=a,l=!1;a.rank===4&&(l=!0,o=ie(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),B(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),B(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),B(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Oa("avgPool3d",r,i);const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:s};let f=Q.runKernel(xI,u,c);return f=Oe(f,o.dtype),l?ie(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const JAe=ee({avgPool3d_:kft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eft(e,t=0){B(e.length>=1,()=>"Pass at least one tensor to concat");const n=pT(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),n.length===1)return d0(n[0]);const r=n,i={axis:t};return Q.runKernel(SI,r,i)}const Di=ee({concat_:Eft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aft(e,t,n=!1,r=!1){let i=U(e,"a","matMul"),s=U(t,"b","matMul");[i,s]=Dr(i,s);const a={a:i,b:s},o={transposeA:n,transposeB:r};return Q.runKernel(wI,a,o)}const Pt=ee({matMul_:Aft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tft(e){const n={x:U(e,"x","sigmoid","float32")};return Q.runKernel(d_,n)}const nh=ee({sigmoid_:Tft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dft(e,t,n){const r=U(e,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const i={x:r},s={begin:t,size:n};return Q.runKernel(uN,i,s)}const rn=ee({slice_:Dft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ift(e){const n={x:U(e,"x","tanh","float32")};return Q.runKernel(b_,n)}const Ow=ee({tanh_:Ift});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nft(e,t,n,r,i,s){const a=U(e,"forgetBias","basicLSTMCell"),o=U(t,"lstmKernel","basicLSTMCell"),l=U(n,"lstmBias","basicLSTMCell"),u=U(r,"data","basicLSTMCell"),c=U(i,"c","basicLSTMCell"),f=U(s,"h","basicLSTMCell"),h=Di([u,f],1),d=Pt(h,o),p=ke(d,l),g=p.shape[0],m=p.shape[1]/4,v=[g,m],y=rn(p,[0,0],v),b=rn(p,[0,m],v),x=rn(p,[0,m*2],v),w=rn(p,[0,m*3],v),C=ke(ne(nh(y),Ow(b)),ne(c,nh(ke(a,x)))),$=ne(Ow(C),nh(w));return[C,$]}const Mft=ee({basicLSTMCell_:Nft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fft(e,t,n){const r=U(e,"x","batchToSpaceND"),i=t.reduce((o,l)=>o*l);B(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),B(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),B(r.shape[0]%i===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`);const s={x:r},a={blockShape:t,crops:n};return Q.runKernel($I,s,a)}const Lz=ee({batchToSpaceND_:Fft});function Oft(e){let t;return e.rank===0||e.rank===1?t=ie(e,[1,1,1,e.size]):e.rank===2?t=ie(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rft(e,t,n,r,i,s){s==null&&(s=.001);const a=U(e,"x","batchNorm"),o=U(t,"mean","batchNorm"),l=U(n,"variance","batchNorm");let u;i!=null&&(u=U(i,"scale","batchNorm"));let c;r!=null&&(c=U(r,"offset","batchNorm")),B(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),B(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),B(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:Oft(a),scale:u,offset:c,mean:o,variance:l},d={varianceEpsilon:s},p=Q.runKernel(FI,h,d);return ie(p,a.shape)}const wN=ee({batchNorm_:Rft});function Pft(e,t,n,r,i,s){const a=U(e,"x","batchNorm"),o=U(t,"mean","batchNorm"),l=U(n,"variance","batchNorm");let u;i!=null&&(u=U(i,"scale","batchNorm"));let c;return r!=null&&(c=U(r,"offset","batchNorm")),B(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),B(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),B(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&B(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&B(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),wN(a,o,l,c,u,s)}const eTe=ee({batchNorm2d_:Pft});function Lft(e,t,n,r,i,s){const a=U(e,"x","batchNorm"),o=U(t,"mean","batchNorm"),l=U(n,"variance","batchNorm");let u;i!=null&&(u=U(i,"scale","batchNorm"));let c;return r!=null&&(c=U(r,"offset","batchNorm")),B(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),B(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),B(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&B(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&B(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),wN(a,o,l,c,u,s)}const tTe=ee({batchNorm3d_:Lft});function Bft(e,t,n,r,i,s){const a=U(e,"x","batchNorm"),o=U(t,"mean","batchNorm"),l=U(n,"variance","batchNorm");let u;i!=null&&(u=U(i,"scale","batchNorm"));let c;return r!=null&&(c=U(r,"offset","batchNorm")),B(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),B(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),B(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&B(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&B(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),wN(a,o,l,c,u,s)}const nTe=ee({batchNorm4d_:Bft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zft(e,t,n){const r=U(e,"x","bincount"),i=U(t,"weights","bincount");B(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),B(n>=0,()=>`size must be non-negative, but got ${n}.`),B(i.size===r.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`);const s={x:r,weights:i},a={size:n};return Q.runKernel(F8,s,a)}const rTe=ee({bincount_:zft});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uft(e,t){const n=U(e,"x","bitwiseAnd"),r=U(t,"y","bitwiseAnd");if(!Zt(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const i={a:n,b:r};return Q.runKernel(CI,i)}const Wft=ee({bitwiseAnd_:Uft});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vft(e,t){const n=U(e,"s0","broadcastArgs","int32"),r=U(t,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const i={s0:n,s1:r};return Q.runKernel(O8,i)}const jft=ee({broadcastArgs_:Vft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hft(e,t){let n=U(e,"broadcastTo","x");const r=n.shape;if(ml(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const u=n.shape.slice();for(;u.length<t.length;)u.unshift(1);n=ie(n,u)}const i=n.shape,s=Array.from(t);for(let u=t.length-1;u>=0;u--)if(i[u]===t[u])s[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(s.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return d0(n);const o={x:n},l={reps:s};return Q.runKernel(x_,o,l)}const X2=ee({broadcastTo_:Hft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qft(e){const n={x:U(e,"x","ceil","float32")};return Q.runKernel(OC,n)}const iTe=ee({ceil_:qft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $_(e,t,n){ml(e),n=n||Bb(t);const r={shape:e,value:t,dtype:n};return Q.runKernel(Z8,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gft(e,t,n){const r=U(e,"x","clipByValue");if(B(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return $_(r.shape,t,r.dtype);const i={x:r},s={clipValueMin:t,clipValueMax:n};return Q.runKernel(RC,i,s)}const sl=ee({clipByValue_:Gft});function Yft(e){return Di(e,0)}const sTe=ee({concat1d_:Yft});function Xft(e,t){return Di(e,t)}const aTe=ee({concat2d_:Xft});function Kft(e,t){return Di(e,t)}const oTe=ee({concat3d_:Kft});function Zft(e,t){return Di(e,t)}const lTe=ee({concat4d_:Zft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qft(e,t,n,r,i="NHWC",s=[1,1],a){const o=U(e,"x","conv2d","float32"),l=U(t,"filter","conv2d","float32");let u=o,c=!1;o.rank===3&&(c=!0,u=ie(o,[1,o.shape[0],o.shape[1],o.shape[2]])),B(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),B(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Oa("conv2d",r,a);const f=i==="NHWC"?u.shape[3]:u.shape[1];B(f===l.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${l.shape[2]}.`),B(ms(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),B(Oy(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),B(Oy(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:u,filter:l},d={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:a},p=Q.runKernel(kI,h,d);return c?ie(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const U0=ee({conv2d_:Qft});function Jft(e,t,n,r,i="NWC",s=1,a){const o=U(e,"x","conv1d"),l=U(t,"filter","conv1d");let u=o,c=!1;o.rank===2&&(c=!0,u=ie(o,[1,o.shape[0],o.shape[1]])),B(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),B(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Oa("conv1d",r,a),B(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),B(ms(n,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${s}'`),B(Oy(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),B(Oy(n),()=>"Error in conv1D: Stride should be larger than 0."),B(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const f=ie(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=ie(u,[u.shape[0],1,u.shape[1],u.shape[2]]),m=U0(h,f,[1,n],r,"NHWC",[1,s],a);return c?ie(m,[m.shape[2],m.shape[3]]):ie(m,[m.shape[0],m.shape[2],m.shape[3]])}const fte=ee({conv1d_:Jft});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eht(e,t,n,r,i,s="NHWC",a){B(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let o=e,l=t,u=!1;t.rank===3&&(u=!0,l=ie(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),B(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),B(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),B(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=s==="NHWC"?o[3]:o[1],f=s==="NHWC"?l.shape[3]:l.shape[1];B(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),B(f===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[3]}.`),Oa("conv2dDerInput",i,a);const h={dy:l,filter:n},d={strides:r,pad:i,dataFormat:s,dimRoundingMode:a,inputShape:o},p=Q.runKernel(EI,h,d);return u?ie(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const hte=ee({conv2DBackpropInput_:eht});function tht(e,t,n,r,i,s){const a=U(e,"x","conv2dTranspose"),o=U(t,"filter","conv2dTranspose");return hte(n,a,o,r,i,"NHWC",s)}const dte=ee({conv2dTranspose_:tht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nht(e,t,n,r,i="NDHWC",s=[1,1,1]){const a=U(e,"x","conv3d"),o=U(t,"filter","conv3d");let l=a,u=!1;a.rank===4&&(u=!0,l=ie(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),B(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),B(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),B(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),B(ms(n,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),B(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),B(Oy(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),B(Oy(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:o},f={strides:n,pad:r,dataFormat:i,dilations:s},h=Q.runKernel(AI,c,f);return u?ie(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const uTe=ee({conv3d_:nht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rht(e,t,n,r,i){B(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let s=e,a=t,o=!1;t.rank===4&&(o=!0,a=ie(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,e[0],e[1],e[2],e[3]]);const l=s[4],u=a.shape[4];B(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),B(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),B(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),B(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),B(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:a,filter:n},f={pad:i,strides:r,inputShape:s},h=Q.runKernel(B8,c,f);return o?ie(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const cTe=ee({conv3DBackpropInput_:rht});function iht(e,t,n,r,i){const s=U(e,"x","conv3dTranspose"),a=U(t,"filter","conv3dTranspose");return cTe(n,s,a,r,i)}const fTe=ee({conv3dTranspose_:iht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sht(e){const n={x:U(e,"x","cos","float32")};return Q.runKernel(PC,n)}const Bz=ee({cos_:sht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aht(e){const n={x:U(e,"x","cosh","float32")};return Q.runKernel(LC,n)}const pte=ee({cosh_:aht});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oht(e,t=0,n=!1,r=!1){const s={x:U(e,"x","cumprod")},a={axis:t,exclusive:n,reverse:r};return Q.runKernel(z8,s,a)}const k5=ee({cumprod_:oht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lht(e,t=0,n=!1,r=!1){const s={x:U(e,"x","cumsum")},a={axis:t,exclusive:n,reverse:r};return Q.runKernel(TI,s,a)}const gte=ee({cumsum_:lht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uht(e,t,n,r=!1){const i=U(e,"x","denseBincount"),s=U(t,"weights","denseBincount");B(i.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),B(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),B(n>=0,()=>`size must be non-negative, but got ${n}.`),B(s.size===i.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${s.shape}.`);const a={x:i,weights:s},o={size:n,binaryOutput:r};return Q.runKernel(W8,a,o)}const OY=ee({denseBincount_:uht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cht(e,t,n="NHWC"){const r=U(e,"x","depthToSpace","float32"),i=n==="NHWC"?r.shape[1]:r.shape[2],s=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];B(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),B(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t}  for depthToSpace with input shape
    ${r.shape}`),B(s*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${t} for depthToSpace with input shape
        ${r.shape}`),B(a%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${a} for depthToSpace with input shape ${r.shape}`);const o={x:r},l={blockSize:t,dataFormat:n};return Q.runKernel(V8,o,l)}const hTe=ee({depthToSpace_:cht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fht(e,t,n,r,i="NHWC",s=[1,1],a){const o=U(e,"x","depthwiseConv2d","float32"),l=U(t,"filter","depthwiseConv2d","float32");let u=o,c=!1;o.rank===3&&(c=!0,u=ie(o,[1,o.shape[0],o.shape[1],o.shape[2]])),B(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),B(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const f=i==="NHWC"?u.shape[3]:u.shape[1];B(f===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${l.shape[2]}.`),Oa("depthwiseConv2d",r,a);const h={x:u,filter:l},d={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:a},p=Q.runKernel(DI,h,d);return c?ie(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const $N=ee({depthwiseConv2d_:fht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hht(e){const n={x:U(e,"x","diag")};return Q.runKernel(q8,n)}const dht=ee({diag_:hht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pht(e,t,n,r,i=[1,1],s="NHWC"){const a=U(e,"x","dilation2d"),o=U(t,"filter","dilation2d");B(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),B(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),B(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let l=a,u=!1;a.rank===3&&(l=ie(a,[1,a.shape[0],a.shape[1],a.shape[2]]),u=!0),B(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);const c={x:l,filter:o},f={strides:n,pad:r,dilations:i},h=Q.runKernel(II,c,f);return u?ie(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const dTe=ee({dilation2d_:pht});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ry(e,t){const n=e.length,r=[];for(let i=0;i<n;i++){const s=n-1-i,a=e[s]||1;(t[t.length-1-i]||1)>1&&a===1&&r.unshift(s)}return r}function ui(e,t){const n=[];for(let r=0;r<t.length;r++){const i=e[e.length-r-1],s=t.length-r-1,a=t[s];(i==null||i===1&&a>1)&&n.unshift(s)}return n}function Ct(e,t){const n=Math.max(e.length,t.length),r=new Array(n);for(let i=0;i<n;i++){let s=e[e.length-i-1];s==null&&(s=1);let a=t[t.length-i-1];if(a==null&&(a=1),s===1)r[n-i-1]=a;else if(a===1)r[n-i-1]=s;else if(s!==a){const o=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(o)}else r[n-i-1]=s}return r}const ght=Object.freeze(Object.defineProperty({__proto__:null,getBroadcastDims:Ry,getReductionAxes:ui,assertAndGetBroadcastShape:Ct},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mht(e,t){let n=U(e,"a","equal","string_or_numeric"),r=U(t,"b","equal","string_or_numeric");[n,r]=Dr(n,r),Ct(n.shape,r.shape);const i={a:n,b:r};return Q.runKernel(NI,i)}const Xc=ee({equal_:mht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vht(e,t,n){const r=U(t,"a","where"),i=U(n,"b","where"),s=U(e,"condition","where","bool"),a=Ct(Ct(s.shape,r.shape),i.shape),o=X2(s,a),l=X2(r,a),u=X2(i,a),c={condition:o,t:l,e:u};return Q.runKernel(lN,c)}const Ws=ee({where_:vht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yht(e){const n={x:U(e,"x","zerosLike")};return Q.runKernel(vN,n)}const en=ee({zerosLike_:yht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bht(e,t){let n=U(e,"a","div"),r=U(t,"b","div");[n,r]=Dr(n,r);const i=Qe(n,r),s=en(i),a=Xc(r,s);return Ws(a,s,i)}const pTe=ee({divNoNan_:bht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xht(e,t){const n=U(e,"t1","dot"),r=U(t,"t2","dot");B((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const i=n.rank===1?n.size:n.shape[1],s=r.rank===1?r.size:r.shape[0];if(B(i===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${s}.`),n.rank===1&&r.rank===1){const a=ie(n,[1,-1]),o=ie(r,[-1,1]),l=Pt(a,o);return ie(l,[])}else if(n.rank===1&&r.rank===2){const a=ie(n,[1,-1]),o=ie(r,[r.shape[0],r.shape[1]]),l=Pt(a,o);return ie(l,[l.size])}else if(n.rank===2&&r.rank===1){const a=ie(r,[-1,1]),o=Pt(n,a);return ie(o,[o.size])}else{const a=ie(r,[r.shape[0],r.shape[1]]);return Pt(n,a)}}const gTe=ee({dot_:xht});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wht(e,...t){const n=t.map((i,s)=>U(i,`tensors${s}`,"einsum")),r={equation:e};return Q.runKernel(Y8,n,r)}const $ht=ee({einsum_:wht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cht(e){const n={x:U(e,"x","elu","float32")};return Q.runKernel(zC,n)}const CN=ee({elu_:Cht});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ht(e,t){const n=U(e,"x","ensureShape","string_or_numeric");if(!nAe(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}const Sht=ee({ensureShape_:_ht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kht(e){let t=U(e,"x","erf");B(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=Oe(t,"float32"));const n={x:t};return Q.runKernel(UC,n)}const mTe=ee({erf_:kht});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mte(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function vTe(e,t,n){const r=e.length+t.length,i=[];let s=0,a=0;for(let o=0;o<r;o++)n.indexOf(o)===-1?i.push(e[s++]):i.push(t[a++]);return i}function Li(e,t){const n=[],r=e.length;for(let s=0;s<r;s++)t.indexOf(s)===-1&&n.push(e[s]);const i=t.map(s=>e[s]);return[n,i]}function Zr(e,t){const n=t.map(r=>1);return vTe(e,n,t)}function vs(e,t,n){B(mte(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function Fr(e,t){if(mte(e,t))return null;const n=[];for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(r=>n.push(r)),n}function Um(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function Jr(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eht(e,t=null,n=!1){const i={x:U(e,"x","max")},s={reductionIndices:t,keepDims:n};return Q.runKernel(jI,i,s)}const Au=ee({max_:Eht});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aht(e,t=null,n=!1){const i={x:U(e,"x","min")},s={axis:t,keepDims:n};return Q.runKernel(YI,i,s)}const vT=ee({min_:Aht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tht(e,t){let n=U(e,"base","pow"),r=U(t,"exp","pow");[n,r]=Dr(n,r);const i={a:n,b:r};return Q.runKernel(r_,i)}const W0=ee({pow_:Tht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xt(e,t){if((Ci(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Ci(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Bm(e,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dht(e){const n={x:U(e,"x","sqrt","float32")};return Q.runKernel(g_,n)}const Hs=ee({sqrt_:Dht});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iht(e){const t=U(e,"x","square"),n={};return Q.runKernel("Square",{x:t},n)}const Gn=ee({square_:Iht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nht(e,t=null,n=!1){let r=U(e,"x","sum");r.dtype==="bool"&&(r=Oe(r,"int32"));const i={x:r},s={axis:t,keepDims:n};return Q.runKernel(cN,i,s)}const qe=ee({sum_:Nht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mht(e,t="euclidean",n=null,r=!1){e=U(e,"x","norm");const i=yTe(e,t,n);let s=i.shape;if(r){const a=Ot(n,e.shape);s=Zr(i.shape,a)}return ie(i,s)}function yTe(e,t,n=null){if(e.rank===0)return hi(e);if(e.rank!==1&&n===null)return yTe(ie(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return qe(hi(e),n);if(t===1/0)return Au(hi(e),n);if(t===-1/0)return vT(hi(e),n);if(t==="euclidean"||t===2)return Hs(qe(W0(hi(e),xt(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return Au(qe(hi(e),n[0]),n[1]-1);if(t===1/0)return Au(qe(hi(e),n[1]),n[0]);if(t===-1/0)return vT(qe(hi(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return Hs(qe(Gn(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const _N=ee({norm_:Mht});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fht(e,t=null,n=!1){return _N(e,"euclidean",t,n)}const bTe=ee({euclideanNorm_:Fht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oht(e){const n={x:U(e,"x","exp")};return Q.runKernel(WC,n)}const Wl=ee({exp_:Oht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rht(e,t=0){const n=U(e,"x","expandDims","string_or_numeric");B(t<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},i={dim:t};return Q.runKernel(MI,r,i)}const Ha=ee({expandDims_:Rht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pht(e){const n={x:U(e,"x","expm1")};return Q.runKernel(VC,n)}const xTe=ee({expm1_:Pht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lht(e,t){const n=U(e,"x","tile","string_or_numeric");B(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const r={x:n},i={reps:t};return Q.runKernel(x_,r,i)}const pu=ee({tile_:Lht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bht(e,t,n,r="float32"){t==null&&(t=e);const i=Mt([e,t],r),s=e<=t?e:t;for(let o=0;o<s;++o)i.set(1,o,o);const a=ie(i.toTensor(),[e,t]);if(n==null)return a;if(n.length===1)return pu(Ha(a,0),[n[0],1,1]);if(n.length===2)return pu(Ha(Ha(a,0),0),[n[0],n[1],1,1]);if(n.length===3)return pu(Ha(Ha(Ha(a,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const vte=ee({eye_:Bht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zht(e){const n={x:U(e,"x","floor","float32")};return Q.runKernel(jC,n)}const SN=ee({floor_:zht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uht(e,t,n=0,r=0){const i=U(e,"x","gather"),s=U(t,"indices","gather","int32"),a={x:i,indices:s},o={axis:n,batchDims:r};return Q.runKernel(OI,a,o)}const kN=ee({gather_:Uht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wht(e,t){let n=U(e,"a","greater","string_or_numeric"),r=U(t,"b","greater","string_or_numeric");[n,r]=Dr(n,r),Ct(n.shape,r.shape);const i={a:n,b:r};return Q.runKernel(RI,i)}const yl=ee({greater_:Wht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vht(e,t){let n=U(e,"a","greaterEqual","string_or_numeric"),r=U(t,"b","greaterEqual","string_or_numeric");[n,r]=Dr(n,r),Ct(n.shape,r.shape);const i={a:n,b:r};return Q.runKernel(qC,i)}const Wm=ee({greaterEqual_:Vht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jht(e){const n={input:U(e,"input","imag")};return Q.runKernel(tz,n)}const zz=ee({imag_:jht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hht(e){const n={x:U(e,"x","isFinite")};return Q.runKernel(YC,n)}const wTe=ee({isFinite_:Hht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qht(e){const n={x:U(e,"x","isInf")};return Q.runKernel(XC,n)}const $Te=ee({isInf_:qht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ght(e){const n={x:U(e,"x","isNaN")};return Q.runKernel(KC,n)}const CTe=ee({isNaN_:Ght});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yht(e,t=.2){const r={x:U(e,"x","leakyRelu")},i={alpha:t};return Q.runKernel(PI,r,i)}const Uz=ee({leakyRelu_:Yht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xht(e,t){let n=U(e,"a","less","string_or_numeric"),r=U(t,"b","less","string_or_numeric");[n,r]=Dr(n,r),Ct(n.shape,r.shape);const i={a:n,b:r};return Q.runKernel(LI,i)}const yT=ee({less_:Xht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kht(e,t){let n=U(e,"a","lessEqual","string_or_numeric"),r=U(t,"b","lessEqual","string_or_numeric");[n,r]=Dr(n,r),Ct(n.shape,r.shape);const i={a:n,b:r};return Q.runKernel(BI,i)}const Vb=ee({lessEqual_:Kht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zht(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:e,stop:t,num:n};return Q.runKernel(nz,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qht(e,t=5,n=1,r=1,i=.5){const s=U(e,"x","localResponseNormalization");B(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),B(Ny(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let a=s,o=!1;s.rank===3&&(o=!0,a=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const l={x:a},u={depthRadius:t,bias:n,alpha:r,beta:i},c=Q.runKernel(VI,l,u);return o?ie(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const _Te=ee({localResponseNormalization_:Qht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jht(e){const n={x:U(e,"x","log","float32")};return Q.runKernel(ZC,n)}const Vl=ee({log_:Jht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function edt(e){const n={x:U(e,"x","log1p")};return Q.runKernel(QC,n)}const Wz=ee({log1p_:edt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tdt(e){return B(L0(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{const r=U(t,"x","tf.grad","string_or_numeric"),i=n!=null?U(n,"dy","tf.grad"):null;return Q.tidy(()=>{const{value:s,grads:a}=Q.gradients(()=>e(r),[r],i);return i!=null&&gs(s.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Vz(a),a[0]})}}function ndt(e){return B(L0(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{B(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const r=pT(t,"args","tf.grads","string_or_numeric"),i=n!=null?U(n,"dy","tf.grads"):null;return Q.tidy(()=>{const{value:s,grads:a}=Q.gradients(()=>e(...r),r,i);return i!=null&&gs(s.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Vz(a),a})}}function rdt(e){return B(L0(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{B(t instanceof On,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),B(n==null||n instanceof On,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:r,value:i}=Q.gradients(()=>e(t),[t],n);return Vz(r),{grad:r[0],value:i}}}function idt(e){return B(L0(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{B(Array.isArray(t)&&t.every(i=>i instanceof On),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),B(n==null||n instanceof On,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const r=Q.gradients(()=>e(...t),t,n);return n!=null&&gs(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Vz(r.grads),r}}function STe(e,t){B(L0(e),()=>"The f passed in variableGrads(f) must be a function"),B(t==null||Array.isArray(t)&&t.every(u=>u instanceof dT),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=t!=null;if(!n){t=[];for(const u in Q.registeredVariables)t.push(Q.registeredVariables[u])}const r=n?t.filter(u=>!u.trainable):null,i=t.length;t=t.filter(u=>u.trainable),B(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const s=!0,{value:a,grads:o}=Q.gradients(e,t,null,s);B(o.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),B(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const l={};return t.forEach((u,c)=>{o[c]!=null&&(l[u.name]=o[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:a,grads:l}}function Nh(e){return Q.customGrad(e)}function Vz(e){if(e.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sdt(e){const n={x:U(e,"x","neg")};return Q.runKernel(KI,n)}const ur=ee({neg_:sdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function adt(e){const n={x:U(e,"x","softplus")};return Q.runKernel(p_,n)}const C_=ee({softplus_:adt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function odt(e){const t=U(e,"x","logSigmoid");return Nh(r=>({value:ur(C_(ur(r))),gradFunc:a=>ne(a,nh(ur(r)))}))(t)}const kTe=ee({logSigmoid_:odt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ldt(e,t){let n=U(e,"a","sub"),r=U(t,"b","sub");[n,r]=Dr(n,r);const i={a:n,b:r};return Q.runKernel(v_,i)}const We=ee({sub_:ldt});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function udt(e,t=-1){const n=U(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Nh((i,s)=>{const o=Au(i,t,!0),l=We(i,o),u=We(Oe(l,"float32"),Vl(qe(Wl(l),t,!0)));return s([u]),{value:u,gradFunc:(f,h)=>{const[d]=h,p=!0,g=Wl(d);return We(f,ne(qe(f,t,p),g))}}})(n)}const yte=ee({logSoftmax_:udt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cdt(e,t=null,n=!1){const r=U(e,"x","logSumExp"),i=Ot(t,r.shape),s=Au(r,i,!0),a=We(r,s),o=Wl(a),l=qe(o,i),u=Vl(l),c=ke(ie(s,u.shape),u);if(n){const f=Zr(c.shape,i);return ie(c,f)}return c}const bte=ee({logSumExp_:cdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fdt(e,t){const n=U(e,"a","logicalAnd","bool"),r=U(t,"b","logicalAnd","bool");Ct(n.shape,r.shape);const i={a:n,b:r};return Q.runKernel(zI,i)}const Mh=ee({logicalAnd_:fdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hdt(e){const n={x:U(e,"x","logicalNot","bool")};return Q.runKernel(UI,n)}const jz=ee({logicalNot_:hdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ddt(e,t){const n=U(e,"a","logicalOr","bool"),r=U(t,"b","logicalOr","bool");Ct(n.shape,r.shape);const i={a:n,b:r};return Q.runKernel(WI,i)}const xte=ee({logicalOr_:ddt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pdt(e,t){const n=U(e,"a","logicalXor","bool"),r=U(t,"b","logicalXor","bool");return Ct(n.shape,r.shape),Mh(xte(e,t),jz(Mh(e,t)))}const ETe=ee({logicalXor_:pdt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JF=2147483648;function gdt(e,t,n="left"){const r=U(e,"sortedSequence","searchSorted"),i=U(t,"values","searchSorted"),s=r.shape[r.shape.length-1],a=i.shape[i.shape.length-1],o=ie(r,[-1,s]),l=ie(i,[-1,a]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(he(l.shape)>=JF)throw new Error(`values tensor size must less than ${JF}`);if(o.shape[1]>=JF)throw new Error(`trailing dim_size must less than ${JF} for int32 output type, was ${o.shape[1]}`);const u={sortedSequence:o,values:l},c={side:n};return Q.runKernel(xz,u,c)}const wte=ee({searchSorted_:gdt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mdt(e,t){return wte(e,t,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vdt(e,t,n,r,i){const s=U(e,"x","maxPool"),a=1;let o=s,l=!1;s.rank===3&&(l=!0,o=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]])),B(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),B(ms(n,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),Oa("maxPool",r,i);const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i},f=Q.runKernel(HI,u,c);return l?ie(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Hz=ee({maxPool_:vdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ydt(e,t=[1,1,1],n,r,i,s="NDHWC"){const a=U(e,"x","maxPool3d");let o=a,l=!1;a.rank===4&&(l=!0,o=ie(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),B(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),B(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),Oa("maxPool3d",r,i);const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:s},f=Q.runKernel(qI,u,c);return l?ie(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const ATe=ee({maxPool3d_:ydt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bdt(e,t,n,r,i=!1){const a={x:U(e,"x","maxPoolWithArgmax")},o={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},l=Q.runKernel(az,a,o);return{result:l[0],indexes:l[1]}}const xdt=ee({maxPoolWithArgmax_:bdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wdt(e,t){let n=U(e,"a","maximum"),r=U(t,"b","maximum");[n,r]=Dr(n,r),n.dtype==="bool"&&(n=Oe(n,"int32"),r=Oe(r,"int32")),Ct(n.shape,r.shape);const i={a:n,b:r};return Q.runKernel(JC,i)}const rg=ee({maximum_:wdt});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $dt(e,t=null,n=!1){const i={x:U(e,"x","mean")},s={axis:t,keepDims:n};return Q.runKernel(GI,i,s)}const Lr=ee({mean_:$dt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function di(e,t="float32"){if(ml(e),t==="complex64"){const r=di(e,"float32"),i=di(e,"float32");return B0(r,i)}const n=hs(he(e),t);return Q.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dl(e,t="float32"){if(ml(e),t==="complex64"){const r=Dl(e,"float32"),i=di(e,"float32");return B0(r,i)}const n=A8(he(e),t);return Q.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cdt(e,t,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(e===void 0)return[];let r=U(e,"x","meshgrid",e instanceof On?e.dtype:"float32");if(t===void 0)return[r];let i=U(t,"y","meshgrid",t instanceof On?t.dtype:"float32");const s=he(r.shape),a=he(i.shape);return n==="xy"?(r=ie(r,[1,-1]),i=ie(i,[-1,1]),[Pt(Dl([a,1],r.dtype),r),Pt(i,Dl([1,s],i.dtype))]):(r=ie(r,[-1,1]),i=ie(i,[1,-1]),[Pt(r,Dl([1,a],r.dtype)),Pt(Dl([s,1],i.dtype),i)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _dt(e,t){let n=U(e,"a","minimum"),r=U(t,"b","minimum");[n,r]=Dr(n,r),n.dtype==="bool"&&(n=Oe(n,"int32"),r=Oe(r,"int32")),Ct(n.shape,r.shape);const i={a:n,b:r};return Q.runKernel(e_,i)}const Py=ee({minimum_:_dt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sdt(e,t,n){B(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=U(e,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");B(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);const i=n==="reflect"?1:0;for(let o=0;o<r.rank;o++)B(t[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),B(t[o][0]>=0&&t[o][0]<=r.shape[o]-i&&t[o][1]>=0&&t[o][1]<=r.shape[o]-i,()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-i} or less than 0 for input of shape ${r.shape}`);const s={paddings:t,mode:n},a={x:r};return Q.runKernel(XI,a,s)}const TTe=ee({mirrorPad_:Sdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kdt(e,t){let n=U(e,"a","mod"),r=U(t,"b","mod");[n,r]=Dr(n,r);const i={a:n,b:r};return Q.runKernel(t_,i)}const DTe=ee({mod_:kdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Edt(e,t=null,n=!1){e=U(e,"x","moments");const r=Ot(t,e.shape),i=Lr(e,r,n);let s=i.shape;n||(s=Zr(i.shape,r));const a=Gn(We(Oe(e,"float32"),ie(i,s))),o=Lr(a,r,n);return{mean:i,variance:o}}const qz=ee({moments_:Edt});function Adt(e,t,n,r){const i=U(t,"data","multiRNNCell"),s=pT(n,"c","multiRNNCell"),a=pT(r,"h","multiRNNCell");let o=i;const l=[];for(let f=0;f<e.length;f++){const h=e[f](o,s[f],a[f]);l.push(h[0]),l.push(h[1]),o=h[1]}const u=[],c=[];for(let f=0;f<l.length;f+=2)u.push(l[f]),c.push(l[f+1]);return[u,c]}const Tdt=ee({multiRNNCell_:Adt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ddt(e,t,n,r=!1){const i=U(e,"logits","multinomial"),s=i.size,a=i.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(a>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${a}`);n=n||Math.random();const l={logits:a===1?ie(i,[1,-1]):i},u={numSamples:t,seed:n,normalized:r},c=Q.runKernel(oz,l,u);return a===1?ie(c,[c.size]):c}const Idt=ee({multinomial_:Ddt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ndt(e,t){let n=U(e,"a","notEqual","string_or_numeric"),r=U(t,"b","notEqual","string_or_numeric");[n,r]=Dr(n,r),Ct(n.shape,r.shape);const i={a:n,b:r};return Q.runKernel(ZI,i)}const Rw=ee({notEqual_:Ndt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mdt(e,t,n=1,r=0,i="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const a={indices:U(e,"indices","oneHot","int32")},o={dtype:i,depth:t,onValue:n,offValue:r};return Q.runKernel(JI,a,o)}const bT=ee({oneHot_:Mdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fdt(e){const n={x:U(e,"x","onesLike")};return Q.runKernel(QI,n)}const jl=ee({onesLike_:Fdt});function Odt(e,t){const n=U(e,"v1","outerProduct"),r=U(t,"v2","outerProduct");B(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const i=ie(n,[-1,1]),s=ie(r,[1,-1]);return Pt(i,s)}const Rdt=ee({outerProduct_:Odt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pdt(e,t,n=0){const r=U(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:t,constantValue:n},s={x:r};return Q.runKernel(tN,s,i)}const Vm=ee({pad_:Pdt});function Ldt(e,t,n=0){return B(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),Vm(e,[t],n)}const Bdt=ee({pad1d_:Ldt});function zdt(e,t,n=0){return B(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Vm(e,t,n)}const Udt=ee({pad2d_:zdt});function Wdt(e,t,n=0){return B(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Vm(e,t,n)}const Vdt=ee({pad3d_:Wdt});function jdt(e,t,n=0){return B(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Vm(e,t,n)}const Hdt=ee({pad4d_:jdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qdt(e,t,n){const r=U(e,"x","spaceToBatchND");B(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),B(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),B(r.shape.reduce((a,o,l)=>l>0&&l<=t.length?a&&(o+n[l-1][0]+n[l-1][1])%t[l-1]===0:a,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const i={x:r},s={blockShape:t,paddings:n};return Q.runKernel(fN,i,s)}const Gz=ee({spaceToBatchND_:qdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gdt(e,t,n,r,i,s,a){i==null&&(i=[1,1]),s==null&&(s=1),r===0&&(r="valid");const o=U(e,"x","maxPool");let l=o,u=!1;o.rank===3&&(u=!0,l=ie(o,[1,o.shape[0],o.shape[1],o.shape[2]])),B(ms(s,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${i}'`);const c=Hu(l.shape,t,s,i,r),f=[c.dilationHeight,c.dilationWidth];let h;r==="same"?h=Xdt([c.filterHeight,c.filterWidth],f):h=[[0,0],[0,0]];const d=f[0]===1&&f[1]===1,[p,g]=Ydt([c.inHeight,c.inWidth],f,h),m=d?r:"valid",v=d?l:Gz(l,f,p),b=(n==="avg"?()=>Pz(v,t,s,m,a):()=>Hz(v,t,s,m,a))(),x=d?b:Lz(b,f,g);return u?ie(x,[x.shape[1],x.shape[2],x.shape[3]]):x}function Ydt(e,t,n){const r=n.map(c=>c[0]),i=n.map(c=>c[1]),s=e.concat(r,i),a=t.map((c,f)=>(c-s[f]%c)%c),o=i.map((c,f)=>c+a[f]),l=t.map((c,f)=>[r[f],o[f]]),u=t.map((c,f)=>[0,a[f]]);return[l,u]}function Xdt(e,t){const r=e.map((a,o)=>a+(a-1)*(t[o]-1)).map(a=>a-1),i=r.map(a=>Math.floor(a/2)),s=r.map((a,o)=>a-i[o]);return r.map((a,o)=>[i[o],s[o]])}const ITe=ee({pool_:Gdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kdt(e,t){const n=U(e,"x","prelu"),r=U(t,"alpha","prelu"),i={x:n,alpha:r};return Q.runKernel(nN,i)}const Yz=ee({prelu_:Kdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zdt(e,t=null,n=!1){let r=U(e,"x","prod");r.dtype==="bool"&&(r=Oe(r,"int32"));const i={x:r},s={axis:t,keepDims:n};return Q.runKernel(rN,i,s)}const NTe=ee({prod_:Zdt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qdt(e,t,n,r){const i=e.map((c,f)=>U(c,`tensors${f}`,"raggedGather","int32")),s=U(t,"paramsDenseValues","raggedGather"),a=U(n,"indices","raggedGather","int32"),o={paramsNestedSplits:i,paramsDenseValues:s,indices:a},l={outputRaggedRank:r},u=Q.runKernel(fz,o,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const Jdt=ee({raggedGather_:Qdt});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ept(e,t,n){const r=U(e,"starts","raggedRange"),i=U(t,"limits","raggedRange",r.dtype),s=U(n,"deltas","raggedRange",r.dtype),a={starts:r,limits:i,deltas:s},o=Q.runKernel(hz,a);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}const tpt=ee({raggedRange_:ept});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function npt(e,t,n,r,i){const s=U(e,"shape","raggedTensorToTensor","int32"),a=U(t,"values","raggedTensorToTensor"),o=U(n,"defaultValue","raggedTensorToTensor",a.dtype),l=r.map((f,h)=>U(f,`tensors${h}`,"raggedTensorToTensor","int32")),u={shape:s,values:a,defaultValue:o,rowPartitionTensors:l},c={rowPartitionTypes:i};return Q.runKernel(dz,u,c)}const rpt=ee({raggedTensorToTensor_:npt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ipt(e,t,n){ml(e);const r=he(e);let i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else if(n==="bool")i=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let s=0;s<r;s++)i[s]=t();return Q.makeTensor(i,e,n)}const spt=ee({rand_:ipt});var MTe={exports:{}};(function(e){(function(t,n,r){function i(l){var u=this,c=o();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function s(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function a(l,u){var c=new i(l),f=u&&u.state,h=c.next;return h.int32=function(){return c.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,f&&(typeof f=="object"&&s(f,c),h.state=function(){return s(c,{})}),h}function o(){var l=4022871197,u=function(c){c=String(c);for(var f=0;f<c.length;f++){l+=c.charCodeAt(f);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.alea=a})(mt,e,!1)})(MTe);var FTe={exports:{}};(function(e){(function(t,n,r){function i(o){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var f=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^f^f>>>8},o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function s(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function a(o,l){var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a})(mt,e,!1)})(FTe);var OTe={exports:{}};(function(e){(function(t,n,r){function i(o){var l=this,u="";l.next=function(){var f=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(f^f<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function s(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function a(o,l){var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a})(mt,e,!1)})(OTe);var RTe={exports:{}};(function(e){(function(t,n,r){function i(o){var l=this;l.next=function(){var c=l.x,f=l.i,h,d;return h=c[f],h^=h>>>7,d=h^h<<24,h=c[f+1&7],d^=h^h>>>10,h=c[f+3&7],d^=h^h>>>3,h=c[f+4&7],d^=h^h<<7,h=c[f+7&7],h=h^h<<13,d^=h^h<<9,c[f]=d,l.i=f+1&7,d};function u(c,f){var h,d=[];if(f===(f|0))d[0]=f;else for(f=""+f,h=0;h<f.length;++h)d[h&7]=d[h&7]<<15^f.charCodeAt(h)+d[h+1&7]<<13;for(;d.length<8;)d.push(0);for(h=0;h<8&&d[h]===0;++h);for(h==8?d[7]=-1:d[h],c.x=d,c.i=0,h=256;h>0;--h)c.next()}u(l,o)}function s(o,l){return l.x=o.x.slice(),l.i=o.i,l}function a(o,l){o==null&&(o=+new Date);var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(c.x&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a})(mt,e,!1)})(RTe);var PTe={exports:{}};(function(e){(function(t,n,r){function i(o){var l=this;l.next=function(){var c=l.w,f=l.X,h=l.i,d,p;return l.w=c=c+1640531527|0,p=f[h+34&127],d=f[h=h+1&127],p^=p<<13,d^=d<<17,p^=p>>>15,d^=d>>>12,p=f[h]=p^d,l.i=h,p+(c^c>>>16)|0};function u(c,f){var h,d,p,g,m,v=[],y=128;for(f===(f|0)?(d=f,f=null):(f=f+"\0",d=0,y=Math.max(y,f.length)),p=0,g=-32;g<y;++g)f&&(d^=f.charCodeAt((g+32)%f.length)),g===0&&(m=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,g>=0&&(m=m+1640531527|0,h=v[g&127]^=d+m,p=h==0?p+1:0);for(p>=128&&(v[(f&&f.length||0)&127]=-1),p=127,g=4*128;g>0;--g)d=v[p+34&127],h=v[p=p+1&127],d^=d<<13,h^=h<<17,d^=d>>>15,h^=h>>>12,v[p]=d^h;c.w=m,c.X=v,c.i=p}u(l,o)}function s(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function a(o,l){o==null&&(o=+new Date);var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(c.X&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a})(mt,e,!1)})(PTe);var LTe={exports:{}};(function(e){(function(t,n,r){function i(o){var l=this,u="";l.next=function(){var f=l.b,h=l.c,d=l.d,p=l.a;return f=f<<25^f>>>7^h,h=h-d|0,d=d<<24^d>>>8^p,p=p-f|0,l.b=f=f<<20^f>>>12^h,l.c=h=h-d|0,l.d=d<<16^h>>>16^p,l.a=p-f|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):u+=o;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function s(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function a(o,l){var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a})(mt,e,!1)})(LTe);var BTe={exports:{}};const apt={},opt=Object.freeze(Object.defineProperty({__proto__:null,default:apt},Symbol.toStringTag,{value:"Module"})),lpt=Fb(opt);(function(e){(function(t,n,r){var i=256,s=6,a=52,o="random",l=r.pow(i,s),u=r.pow(2,a),c=u*2,f=i-1,h;function d(x,w,C){var $=[];w=w==!0?{entropy:!0}:w||{};var _=v(m(w.entropy?[x,b(n)]:x==null?y():x,3),$),k=new p($),E=function(){for(var S=k.g(s),I=l,A=0;S<u;)S=(S+A)*i,I*=i,A=k.g(1);for(;S>=c;)S/=2,I/=2,A>>>=1;return(S+A)/I};return E.int32=function(){return k.g(4)|0},E.quick=function(){return k.g(4)/4294967296},E.double=E,v(b(k.S),n),(w.pass||C||function(S,I,A,D){return D&&(D.S&&g(D,k),S.state=function(){return g(k,{})}),A?(r[o]=S,I):S})(E,_,"global"in w?w.global:this==r,w.state)}function p(x){var w,C=x.length,$=this,_=0,k=$.i=$.j=0,E=$.S=[];for(C||(x=[C++]);_<i;)E[_]=_++;for(_=0;_<i;_++)E[_]=E[k=f&k+x[_%C]+(w=E[_])],E[k]=w;($.g=function(S){for(var I,A=0,D=$.i,T=$.j,N=$.S;S--;)I=N[D=f&D+1],A=A*i+N[f&(N[D]=N[T=f&T+I])+(N[T]=I)];return $.i=D,$.j=T,A})(i)}function g(x,w){return w.i=x.i,w.j=x.j,w.S=x.S.slice(),w}function m(x,w){var C=[],$=typeof x,_;if(w&&$=="object")for(_ in x)try{C.push(m(x[_],w-1))}catch{}return C.length?C:$=="string"?x:x+"\0"}function v(x,w){for(var C=x+"",$,_=0;_<C.length;)w[f&_]=f&($^=w[f&_]*19)+C.charCodeAt(_++);return b(w)}function y(){try{var x;return h&&(x=h.randomBytes)?x=x(i):(x=new Uint8Array(i),(t.crypto||t.msCrypto).getRandomValues(x)),b(x)}catch{var w=t.navigator,C=w&&w.plugins;return[+new Date,t,C,t.screen,b(n)]}}function b(x){return String.fromCharCode.apply(0,x)}if(v(r.random(),n),e.exports){e.exports=d;try{h=lpt}catch{}}else r["seed"+o]=d})(typeof self<"u"?self:mt,[],Math)})(BTe);var upt=MTe.exports,cpt=FTe.exports,fpt=OTe.exports,hpt=RTe.exports,dpt=PTe.exports,ppt=LTe.exports,jb=BTe.exports;jb.alea=upt;jb.xor128=cpt;jb.xorwow=fpt;jb.xorshift7=hpt;jb.xor4096=dpt;jb.tychei=ppt;var Xz=jb;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gpt=.001,zTe=.1;function mpt(e,t,n){return n==null&&(n=$te()),RY(e,t,(r,i)=>Cte(r,i,n))}function $te(){return Q.backend.floatPrecision()===32?gpt:zTe}function RY(e,t,n){let r=!0;if((Ci(e)||Ci(t))&&(r=!1),Ci(e)&&Ci(t)&&(r=!0),r){const a=e.constructor.name,o=t.constructor.name;if(a!==o)throw new Error(`Arrays are of different type. Actual: ${a}. Expected: ${o}`)}if(Array.isArray(e)&&Array.isArray(t)){const a=Ih(e),o=Ih(t);if(!Zt(a,o))throw new Error(`Arrays have different shapes. Actual: [${a}]. Expected: [${o}]`)}const i=Ci(e)?e:Dh(e),s=Ci(t)?t:Dh(t);if(i.length!==s.length)throw new Error(`Arrays have different lengths actual: ${i.length} vs expected: ${s.length}.
Actual:   ${i}.
Expected: ${s}.`);for(let a=0;a<s.length;++a){const o=i[a],l=s[a];if(!n(o,l))throw new Error(`Arrays differ: actual[${a}] = ${o}, expected[${a}] = ${l}.
Actual:   ${i}.
Expected: ${s}.`)}typeof expect<"u"&&expect().nothing()}function vpt(e,t){e().then(()=>t.fail(),()=>t()),typeof expect<"u"&&expect().nothing()}function ypt(e,t){const n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return Kf(e)||Kf(e[0])||Kf(t)||Kf(t[0])?RY(e,n,(r,i)=>r==i):RY(e,t,(r,i)=>Cte(r,i,0))}function bpt(e,t,n){if(n==null&&(n=$te()),!Cte(e,t,n))throw new Error(`Numbers differ: actual === ${e}, expected === ${t}`);typeof expect<"u"&&expect().nothing()}function Cte(e,t,n){return!isFinite(e)&&!isFinite(t)?!0:!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function xpt(e,t,n){for(let r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error(`Value out of range:${e[r]} low: ${t}, high: ${n}`)}function wpt(e,t){const n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let i=0;i<r.length;i++)if(n[i]!==r[i])throw new Error(`Expected ArrayBuffer value at ${i} to be ${r[i]} but got ${n[i]} instead`)}function UTe(e){for(let t=0;t<e.length;t++){const n=e[t];Array.isArray(n)?UTe(n):e[t]=th(n)}return e}function $pt(e){const t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(n=>{t.addEventListener("loadeddata",r=>n(t)),t.load()})}async function Cpt(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}const _pt=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:zTe,expectArraysClose:mpt,testEpsilon:$te,expectPromiseToFail:vpt,expectArraysEqual:ypt,expectNumbersClose:bpt,expectValuesInRange:xpt,expectArrayBuffersEqual:wpt,encodeStrings:UTe,createVideoElement:$pt,play:Cpt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _te{constructor(t,n,r,i,s){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=s||Math.random();this.random=Xz.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let t,n,r=!1;for(;!r;){let i,s,a;do i=2*this.random()-1,s=2*this.random()-1,a=i*i+s*s;while(a>=1||a===0);const o=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*i*o,n=this.mean+this.stdDev*s*o,(!this.truncated||this.isValidTruncated(t))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class Spt{constructor(t,n,r,i){this.alpha=t,this.beta=1/n,this.dtype=r;const s=i||Math.random();this.randu=Xz.alea(s.toString()),this.randn=new _te(0,1,r,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,n,r,i,s,a;for(;;){do i=this.randn.nextValue(),a=1+this.c*i;while(a<=0);if(a*=a*a,t=i*i,n=1-.331*t*t,r=.5*t+this.d*(1-a+Math.log(a)),s=this.randu(),s<n||Math.log(s)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}}class kpt{constructor(t=0,n=1,r,i){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=Xz.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ept(e,t,n=1,r="float32",i){if(ml(e),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const s=new Spt(t,n,r,i),a=Mt(e,r);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}const Apt=ee({randomGamma_:Ept});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tpt(e,t=0,n=1,r,i){if(ml(e),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const s=new _te(t,n,r,!1,i),a=Mt(e,r);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}const Ste=ee({randomNormal_:Tpt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dpt(e,t,n){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return Ste(e,0,1,t,n)}const Ipt=ee({randomStandardNormal_:Dpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Npt(e,t=0,n=1,r="float32",i){ml(e);const s=Mt(e,r),a=new kpt(t,n,null,i);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}const Hb=ee({randomUniform_:Npt});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mpt(e,t,n,r){return Hb(e,t,n,"int32",r)}const Fpt=ee({randomUniformInt_:Mpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pw(e,t,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const i={start:e,stop:t,step:n,dtype:r};return Q.runKernel(pz,{},i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Opt(e){const n={input:U(e,"input","real")};return Q.runKernel(gz,n)}const xT=ee({real_:Opt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rpt(e){const n={x:U(e,"x","reciprocal")};return Q.runKernel(i_,n)}const WTe=ee({reciprocal_:Rpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ppt(e){const n={x:U(e,"x","relu")};return Q.runKernel(s_,n)}const id=ee({relu_:Ppt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lpt(e){const n={x:U(e,"x","relu6")};return Q.runKernel(a_,n)}const kte=ee({relu6_:Lpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bpt(e,t){const r={x:U(e,"x","reverse")},i={dims:t};return Q.runKernel(oN,r,i)}const Fu=ee({reverse_:Bpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zpt(e){const t=U(e,"x","reverse");return B(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),Fu(t,0)}const Upt=ee({reverse1d_:zpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wpt(e,t){const n=U(e,"x","reverse");return B(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Fu(n,t)}const Vpt=ee({reverse2d_:Wpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jpt(e,t){const n=U(e,"x","reverse");return B(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Fu(n,t)}const Hpt=ee({reverse3d_:jpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qpt(e,t){const n=U(e,"x","reverse");return B(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Fu(n,t)}const Gpt=ee({reverse4d_:qpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ypt(e){const n={x:U(e,"x","round")};return Q.runKernel(o_,n)}const Ete=ee({round_:Ypt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xpt(e){const n={x:U(e,"x","rsqrt","float32")};return Q.runKernel(l_,n)}const Ate=ee({rsqrt_:Xpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kpt(e){const n={x:U(e,"x","selu")};return Q.runKernel(u_,n)}const Tte=ee({selu_:Kpt});function Zpt(e,t,n,r,i,s=[1,1],a="NHWC"){const o=U(e,"x","separableConv2d"),l=U(t,"depthwiseFilter","separableConv2d"),u=U(n,"pointwiseFilter","separableConv2d");let c=o,f=!1;if(o.rank===3&&(f=!0,c=ie(o,[1,o.shape[0],o.shape[1],o.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");B(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),B(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),B(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),B(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),B(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const h=l.shape[2],d=l.shape[3];B(u.shape[2]===h*d,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*d}, but got ${u.shape[2]}.`);const p=$N(c,l,r,i,a,s),m=U0(p,u,1,"valid",a);return f?ie(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const Dte=ee({separableConv2d_:Zpt});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Qpt(e,t){const n=U(e,"x","setdiff1d"),r=U(t,"y","setdiff1d");B(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),B(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),B(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const i=await n.data(),s=await r.data(),a=new Set(s);let o=0;for(let c=0;c<i.length;c++)a.has(i[c])||o++;const l=new oi([o],n.dtype),u=new oi([o],"int32");for(let c=0,f=0;c<i.length;c++)a.has(i[c])||(l.values[f]=i[c],u.values[f]=c,f++);return[l.toTensor(),u.toTensor()]}const Jpt=Qpt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function egt(e){const n={x:U(e,"x","sign")};return Q.runKernel(h_,n)}const VTe=ee({sign_:egt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tgt(e){const n={x:U(e,"x","sin","float32")};return Q.runKernel(c_,n)}const Ite=ee({sin_:tgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ngt(e){const n={x:U(e,"x","sinh")};return Q.runKernel(f_,n)}const Nte=ee({sinh_:ngt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rgt(e,t,n){const r=U(e,"x","slice1d");return B(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),rn(r,[t],[n])}const Kz=ee({slice1d_:rgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function igt(e,t,n){const r=U(e,"x","slice2d");return B(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),rn(r,t,n)}const Mte=ee({slice2d_:igt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sgt(e,t,n){const r=U(e,"x","slice3d");return B(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),rn(r,t,n)}const Zz=ee({slice3d_:sgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function agt(e,t,n){const r=U(e,"x","slice4d");return B(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),rn(r,t,n)}const wT=ee({slice4d_:agt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ogt(e,t=-1){const n=U(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const r={logits:n},i={dim:t};return Q.runKernel(dN,r,i)}const Qz=ee({softmax_:ogt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lgt(e){B(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);const t={input:e};return Q.runKernel(K8,t)}const Jz=ee({fft_:lgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ugt(e){B(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);const t={input:e};return Q.runKernel(ez,t)}const $T=ee({ifft_:ugt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cgt(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const i=ie(e,[n,t]);r=$T(i)}else{const i=[n,2*(t-1)],s=ie(xT(e),[n,t]),a=ie(zz(e),[n,t]),o=Fu(rn(s,[0,1],[n,t-2]),1),l=ne(Fu(rn(a,[0,1],[n,t-2]),1),xt(-1)),u=Di([s,o],1),c=Di([a,l],1),f=ie(B0(u,c),[i[0],i[1]]);r=$T(f)}if(r=xT(r),e.rank===3&&e.shape[0]!==0){const i=r,s=e.shape[0];r=ie(r,[s,r.shape[0]/s,r.shape[1]]),i.dispose()}return r}const Fte=ee({irfft_:cgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fgt(e,t,n=0){const i={x:U(e,"x","split")},s={numOrSizeSplits:t,axis:n};return Q.runKernel(hN,i,s)}const Jo=ee({split_:fgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hgt(e,t){B(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1];const r=e.size/n;let i;if(t!=null&&t<n){const p=e.shape.map(m=>0),g=e.shape.map(m=>m);g[e.shape.length-1]=t,i=rn(e,p,g),n=t}else if(t!=null&&t>n){const p=e.shape.map(g=>g);p[e.shape.length-1]=t-n,i=Di([e,di(p)],e.shape.length-1),n=t}else i=e;const s=en(i),a=ie(B0(i,s),[r,n]),o=Jz(a),l=Math.floor(n/2)+1,u=xT(o),c=zz(o),f=Jo(u,[l,n-l],u.shape.length-1),h=Jo(c,[l,n-l],c.shape.length-1),d=i.shape.slice();return d[i.shape.length-1]=l,ie(B0(f[0],h[0]),d)}const e7=ee({rfft_:hgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dgt(e,t){let n=U(e,"a","squaredDifference"),r=U(t,"b","squaredDifference");[n,r]=Dr(n,r),Ct(n.shape,r.shape);const i={a:n,b:r},s={};return Q.runKernel(m_,i,s)}const Ote=ee({squaredDifference_:dgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pgt(e,t){const n=U(e,"x","squeeze","string_or_numeric");return ie(n,Jp(n.shape,t).newShape)}const qb=ee({squeeze_:pgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ggt(e,t=0){const n=pT(e,"tensors","stack","string_or_numeric");B(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&B(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,i={axis:t};return Q.runKernel(eN,r,i)}const Np=ee({stack_:ggt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mgt(e,t=0){const r={x:U(e,"x","step")},i={alpha:t};return Q.runKernel(w_,r,i)}const __=ee({step_:mgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vgt(e,t,n,r,i=0,s=0,a=0,o=0,l=0){const c={x:U(e,"x","stridedSlice","string_or_numeric")},f={begin:t,end:n,strides:r,beginMask:i,endMask:s,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};return Q.runKernel(Ez,c,f)}const jTe=ee({stridedSlice_:vgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ygt(e){const n={x:U(e,"x","tan","float32")};return Q.runKernel(y_,n)}const HTe=ee({tan_:ygt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ro(e,t){Lb(e);const n=Ih(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Bm(e,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rA(e,t,n){if(Lb(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Ih(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Bm(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qTe(e,t,n){if(Lb(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Ih(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Bm(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bgt(e,t,n){if(Lb(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Ih(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Bm(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xgt(e,t,n){if(Lb(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Ih(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Bm(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wgt(e,t,n){if(Lb(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Ih(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,Bm(e,t,r,n)}function Rte(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(s+` update.rank < ${i}. `);if(e.length<r+(n.rank-i))throw new Error(s+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+e.length-r)throw new Error(s+` update.rank != ${i+e.length-r}`);for(let a=0;a<i;++a)if(n.shape[a]!==t.shape[a])throw new Error(s+` updates.shape[${a}] (${n.shape[a]}) != indices.shape[${a}] (${t.shape[a]}).`);for(let a=0;a<n.rank-i;++a)if(n.shape[a+i]!==e[a+r])throw new Error(s+` updates.shape[${a+i}] (${n.shape[a+i]}) != shape[${a+i}] (${e[a+i]})`)}function t7(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}Rte(n,t,e)}function jm(e,t,n){const r=t.shape.length,i=r>1?t.shape[r-1]:1,s=n.length;let a=1;for(let f=i;f<s;++f)a*=n[f];const o=i<1?1:i,l=he(t.shape)/o,u=[...Je(n.slice(0,i)),1],c=he(n);return{sliceRank:i,numUpdates:l,sliceSize:a,strides:u,outputSize:c}}const $gt=Object.freeze(Object.defineProperty({__proto__:null,validateUpdateShape:Rte,validateInput:t7,calculateShapes:jm},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cgt(e,t,n){const r=U(e,"tensor","tensorScatterupdate"),i=U(t,"indices","tensorScatterupdate","int32"),s=U(n,"updates","tensorScatterupdate");if(t7(s,i,r.shape),r.dtype!==s.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${s.dtype}.`);const a={tensor:r,indices:i,updates:s},o={};return Q.runKernel(bz,a,o)}const _gt=ee({tensorScatterUpdate_:Cgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sgt(e,t=1,n=!0){const r=U(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);const s={x:r},a={k:t,sorted:n},[o,l]=Q.runKernel(Iz,s,a);return{values:o,indices:l}}const GTe=ee({topk_:Sgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kgt(e,t=0,n=1,r,i){if(ml(e),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const s=new _te(t,n,r,!0,i),a=Mt(e,r);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}const Pte=ee({truncatedNormal_:kgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Egt(e,t=0){const n=U(e,"x","unique","string_or_numeric");B(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},i={axis:t},[s,a]=Q.runKernel(Mz,r,i);return{values:s,indices:a}}const YTe=ee({unique_:Egt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Agt(e,t,n){const r=U(e,"x","unsortedSegmentSum"),i=U(t,"segmentIds","unsortedSegmentSum","int32");B(Ny(n),()=>"numSegments must be of dtype int");const s={x:r,segmentIds:i},a={numSegments:n};return Q.runKernel(mN,s,a)}const Lte=ee({unsortedSegmentSum_:Agt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tgt(e,t=0){const n=U(e,"x","unstack","string_or_numeric");B(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},i={axis:t};return Q.runKernel(gN,r,i)}const V0=ee({unstack_:Tgt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dgt(e,t){return wte(e,t,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XTe(e,t=!0,n,r){return Q.makeVariable(e,t,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n7(e,t){const n=[];for(let s=0;s<t.length;s++)t[s]&&n.push(s);const r=Mt(e,"int32"),i=Mt([n.length,e.length],"int32");for(let s=0;s<n.length;s++){const a=r.indexToLoc(n[s]),o=s*e.length;i.values.set(a,o)}return i.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Igt(e){const t=U(e,"condition","whereAsync","bool"),n=await t.data(),r=n7(t.shape,n);return e!==t&&t.dispose(),r}const KTe=Igt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ngt(e,t,n){const r=U(e,"tensor","boolMask"),i=U(t,"mask","boolMask","bool"),s=n==null?0:n,a=i.rank,o=r.shape;B(a>0,()=>"mask cannot be scalar"),gs(o.slice(s,s+a),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let g=s;g<s+a;g++)l*=o[g];const u=o.slice(0,s).concat([l],o.slice(s+a)),c=ie(r,u),f=ie(i,[-1]),h=await KTe(f),d=qb(h,[1]),p=kN(c,d,s);return e!==r&&r.dispose(),t!==i&&i.dispose(),d.dispose(),c.dispose(),f.dispose(),h.dispose(),p}const Mgt=Ngt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fgt(e,t,n){const r=U(e,"x","transpose");if(t==null&&(t=r.shape.map((a,o)=>o).reverse()),B(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`),t.forEach(a=>{B(a>=0&&a<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`)}),r.rank<=1)return r.clone();const i={x:r},s={perm:t};return r.dtype==="complex64"?ce(()=>{let a=xT(r),o=zz(r);return a=Q.runKernel(K1,{x:a},s),o=Q.runKernel(K1,{x:o},s),n&&(o=ur(o)),B0(a,o)}):Q.runKernel(K1,i,s)}const Kt=ee({transpose_:Fgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ogt(e,t,n,r,i=!0){const s=U(e,"v","movingAverage"),a=U(t,"x","movingAverage"),o=U(n,"decay","movingAverage");SAe(s,a),B(Zt(s.shape,a.shape),()=>"Shape mismatch in v and x");const l=xt(1),u=We(l,o);let c=ne(We(a,s),u);if(i){B(r!=null,()=>"When using zeroDebias: true, step is required.");const f=U(r,"step","movingAverage");c=Qe(c,We(l,W0(o,f)))}return ke(s,c)}const Rgt=ee({movingAverage_:Ogt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pgt(e,t,n){ml(n);const r=U(e,"indices","scatterND","int32"),i=U(t,"updates","scatterND");t7(i,r,n);const s={indices:r,updates:i},a={shape:n};return Q.runKernel(yz,s,a)}const Lgt=ee({scatterND_:Pgt});function Bgt(e,t,n,r){if(e.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);const i=e.rank>0?e.shape[0]:1,s=e.rank>1?e.shape[1]:1;if(n.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${s}.`);const a=t.size;if(!(t.rank===0||t.rank===1&&a===i))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${i}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zgt(e,t,n,r=0){ml(n);const i=U(e,"sparseIndices","sparseToDense","int32"),s=U(t,"sparseValues","sparseToDense","string_or_numeric"),a=U(r,"defaultValue","sparseToDense",s.dtype);Bgt(i,s,n,a);const o={sparseIndices:i,sparseValues:s,defaultValue:a},l={outputShape:n};return Q.runKernel(Sz,o,l)}const Ugt=ee({sparseToDense_:zgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wgt(e,t){const n=U(t,"indices","gatherND","int32"),i={params:U(e,"x","gatherND","string_or_numeric"),indices:n};return Q.runKernel(J8,i)}const Vgt=ee({gatherND_:Wgt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jgt(e,t){if(t==null)return e.shape.slice();if(Zt(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let r=0;r<e.shape.length;r++)t[r]==null&&e.shape[r]!=null?n.push(e.shape[r]):n.push(t[r]);return n}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hgt(e,t,n,r){const i=U(e,"x","dropout");if(B(i.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),B(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof On?i.clone():i;const s=jgt(i,n),a=1-t,o=Qe(SN(ke(Hb(s,0,1,"float32",r),a)),a);return ne(i,o)}const ZTe=ee({dropout_:Hgt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QTe(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function Bte(e,t,n){const r=1-e%2,i=new Float32Array(e);for(let s=0;s<e;++s){const a=2*Math.PI*s/(e+r-1);i[s]=t-n*Math.cos(a)}return ro(i,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function qgt(e,t,n=1){const r=U(e,"predictions","inTopK"),i=U(t,"targets","inTopK");B(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),B(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),gs(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=r.shape[r.shape.length-1];B(n>0&&n<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${n}`);const a=await r.data(),o=await i.data(),[l,u]=[a.length/s,s],c=Fi("bool",l);for(let f=0;f<l;f++){const h=f*u,d=a.subarray(h,h+u),p=[];for(let g=0;g<d.length;g++)p.push({value:d[g],index:g});p.sort((g,m)=>m.value-g.value),c[f]=0;for(let g=0;g<n;g++)if(p[g].index===o[f]){c[f]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),vp(c,i.shape,"bool")}const Ggt=qgt;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ygt(e,t,n,r,i,s="NHWC",a){let o=e;e.rank===3&&(o=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=ie(t,[1,t.shape[0],t.shape[1],t.shape[2]])),B(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),B(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),B(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=s==="NHWC"?o.shape[3]:o.shape[1],c=s==="NHWC"?l.shape[3]:l.shape[1];B(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),B(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),Oa("conv2dDerFilter",i,a);const f={x:o,dy:l},h={strides:r,pad:i,dataFormat:s,dimRoundingMode:a,filterShape:n};return Q.runKernel(P8,f,h)}const zte=ee({conv2DBackpropFilter_:Ygt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r7(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return ne(e,__(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function i7(e,t){let n=t;const r=ui(e.shape,t.shape);return r.length>0&&(n=qe(n,r)),ie(n,e.shape)}function s7(e,t,n,r){if(t==="linear")return e;if(t==="relu")return id(e);if(t==="elu")return CN(e);if(t==="relu6")return kte(e);if(t==="prelu")return Yz(e,n);if(t==="leakyrelu")return Uz(e,r);if(t==="sigmoid")return nh(e);throw new Error(`Unknown fused activation ${t}.`)}const a7=(e,t)=>!(e>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xgt({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",a7(Q.state.gradientDepth,l)===!1){B(i==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let C=U0(e,t,n,r,i,s,a);return o!=null&&(C=ke(C,o)),s7(C,l,u,c)}const f=U(e,"x","conv2d","float32"),h=U(t,"filter","conv2d","float32");let d=f,p=!1;f.rank===3&&(p=!0,d=ie(f,[1,f.shape[0],f.shape[1],f.shape[2]])),B(d.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${d.rank}.`),B(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),Oa("fused conv2d",r,a);const g=i==="NHWC"?d.shape[3]:d.shape[1];B(h.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${h.shape[2]}.`),B(ms(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);const m=Pi(d.shape,h.shape,n,s,r,a);let v;o!=null&&(v=U(o,"bias","fused conv2d"),[v]=Dr(v,f),i==="NHWC"?Ct(m.outShape,v.shape):(B(v.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${v.shape.length}.`),B(v.shape.length===0||v.shape[0]===m.outChannels||v.shape[0]===1,()=>`Error in fused conv2d: bias shape (${v.shape}) is not compatible with the number of output channels (${m.outChannels})`)));let y;if(u!=null){const C=u.shape;if(B(C.length<=1||C.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${C.length}.`),C.length===1)B(C[0]===1||C[0]===m.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the number of output channels (${m.outChannels}).`);else if(C.length===3)try{Ct(C,m.outShape)}catch{const _=`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the output shape of the conv2d (${m.outShape}).`;throw Error(_)}y=U(u,"prelu weights","fused conv2d")}const b=(C,$)=>{B(i==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);const[_,k,E,S]=$,I=r7(C,E,l);B(z0(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const A=hte(k.shape,I,_,n,r),D=zte(k,I,_.shape,n,r),T=[A,D];if(S!=null){const N=i7(S,I);T.push(N)}return T},x={x:d,filter:h,bias:v,preluActivationWeights:y},w={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:a,activation:l,leakyreluAlpha:c};return o==null?Nh(($,_,k)=>{let E=Q.runKernel(uT,x,w);return k([_,$,E]),p&&(E=ie(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(d,h):Nh(($,_,k,E)=>{let S=Q.runKernel(uT,x,w);return E([_,$,S,k]),p&&(S=ie(S,[S.shape[1],S.shape[2],S.shape[3]])),{value:S,gradFunc:b}})(d,h,v)}const JTe=ee({fusedConv2d_:Xgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kgt(e,t,n,r,i,s=[1,1],a){let o=e;e.rank===3&&(o=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=ie(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const u={x:o,dy:l},c={strides:r,pad:i,dimRoundingMode:a,dilations:s,filterShape:n};return Q.runKernel(j8,u,c)}const e3e=ee({depthwiseConv2dNativeBackpropFilter_:Kgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zgt(e,t,n,r,i,s=[1,1],a){let o=t,l=!1;t.rank===3&&(l=!0,o=ie(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const u={dy:o,filter:n},c={strides:r,pad:i,dimRoundingMode:a,dilations:s,inputShape:e},f=Q.runKernel(H8,u,c);return l?ie(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const t3e=ee({depthwiseConv2dNativeBackpropInput_:Zgt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qgt({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(a7(Q.state.gradientDepth,l)===!1){let w=$N(e,t,n,r,i,s,a);return o!=null&&(w=ke(w,o)),s7(w,l,u,c)}const f=U(e,"x","depthwiseConv2d","float32"),h=U(t,"filter","depthwiseConv2d","float32");let d=f,p=!1;f.rank===3&&(p=!0,d=ie(f,[1,f.shape[0],f.shape[1],f.shape[2]])),B(d.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${d.rank}.`),B(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),B(d.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${d.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),s==null&&(s=[1,1]),B(ms(n,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),Oa("fused depthwiseConv2d",r,a);const g=Pi(d.shape,h.shape,n,s,r,a,!0);let m;o!=null&&(m=U(o,"bias","fused conv2d"),[m]=Dr(m,f),Ct(g.outShape,m.shape));let v;u!=null&&(v=U(u,"prelu weights","fused depthwiseConv2d"));const y=(w,C)=>{B(z0(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[$,_,k,E]=C,S=r7(w,k,l),I=t3e(_.shape,S,$,n,r,s,a),A=e3e(_,S,$.shape,n,r,s,a);if(E!=null){const D=i7(m,S);return[I,A,D]}return[I,A]},b={x:d,filter:h,bias:m,preluActivationWeights:v},x={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:a,activation:l,leakyreluAlpha:c};return o==null?Nh((C,$,_)=>{let k=Q.runKernel(cT,b,x);return _([$,C,k]),p&&(k=ie(k,[k.shape[1],k.shape[2],k.shape[3]])),{value:k,gradFunc:y}})(d,h):Nh((C,$,_,k)=>{let E=Q.runKernel(cT,b,x);return k([$,C,E,_]),p&&(E=ie(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:y}})(d,h,m)}const Jgt=ee({fusedDepthwiseConv2d_:Qgt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0t({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:i,activation:s="linear",preluActivationWeights:a,leakyreluAlpha:o=.2}){if(a7(Q.state.gradientDepth,s)===!1){let S=Pt(e,t,n,r);return i!=null&&(S=ke(S,i)),s7(S,s,a,o)}let l=U(e,"a","fused matMul"),u=U(t,"b","fused matMul");[l,u]=Dr(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],f=r?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],d=r?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),g=u.shape.slice(0,-2),m=he(p),v=he(g);B(c===f,()=>`Error in fused matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const b=Ct(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,d]),x=n?ie(l,[m,c,h]):ie(l,[m,h,c]),w=r?ie(u,[v,d,f]):ie(u,[v,f,d]);let C;i!=null&&(C=U(i,"bias","fused matMul"),[C]=Dr(C,l),Ct(b,C.shape));let $;a!=null&&($=U(a,"prelu weights","fused matMul"));const _=(S,I)=>{const[A,D,T,N]=I,F=r7(ie(S,T.shape),T,s);let R,P;if(!n&&!r?(R=Pt(F,D,!1,!0),P=Pt(A,F,!0,!1)):!n&&r?(R=Pt(F,D,!1,!1),P=Pt(F,A,!0,!1)):n&&!r?(R=Pt(D,F,!1,!0),P=Pt(A,F,!1,!1)):(R=Pt(D,F,!0,!0),P=Pt(F,A,!0,!0)),i!=null){const V=i7(N,F);return[R,P,V]}else return[R,P]},k={a:x,b:w,bias:C,preluActivationWeights:$},E={transposeA:n,transposeB:r,activation:s,leakyreluAlpha:o};return i==null?Nh((I,A,D)=>{const T=Q.runKernel(lT,k,E);return D([I,A,T]),{value:ie(T,b),gradFunc:_}})(x,w):Nh((I,A,D,T)=>{const N=Q.runKernel(lT,k,E);return T([I,A,N,D]),{value:ie(N,b),gradFunc:_}})(x,w,C)}const PY=ee({fusedMatMul_:e0t});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t0t=Object.freeze(Object.defineProperty({__proto__:null,conv2d:JTe,depthwiseConv2d:Jgt,matMul:PY},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n0t(e){return Bte(e,.54,.46)}const r0t=ee({hammingWindow_:n0t});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i0t(e){return Bte(e,.5,.5)}const n3e=ee({hannWindow_:i0t});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0t(e,t,n,r=!1,i=0){let s=0;const a=[];for(;s+t<=e.size;)a.push(rn(e,s,t)),s+=n;if(r)for(;s<e.size;){const o=s+t-e.size,l=Di([rn(e,s,t-o),$_([o],i)]);a.push(l),s+=n}return a.length===0?rA([],[0,t]):ie(Di(a),[a.length,t])}const r3e=ee({frame_:s0t});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a0t(e,t,n,r,i=n3e){r==null&&(r=QTe(t));const s=r3e(e,t,n),a=ne(s,i(t));return e7(a,r)}const o0t=ee({stft_:a0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l0t(e,t,n,r,i="bilinear",s=0){const a=U(e,"image","cropAndResize"),o=U(t,"boxes","cropAndResize","float32"),l=U(n,"boxInd","cropAndResize","int32"),u=o.shape[0];B(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),B(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`),B(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`),B(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),B(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),B(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);const c={image:a,boxes:o,boxInd:l},f={method:i,extrapolationValue:s,cropSize:r};return Q.runKernel(U8,c,f)}const u0t=ee({cropAndResize_:l0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c0t(e){const t=U(e,"image","flipLeftRight","float32");B(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return Q.runKernel(Q8,n,{})}const f0t=ee({flipLeftRight_:c0t});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h0t(e){const t=U(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];B(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),B(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const i=new Array(t.rank);return i.fill(1,0,n),i[n]=3,pu(t,i)}const d0t=ee({grayscaleToRGB_:h0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0t(e,t,n=0,r=.5){const i=U(e,"image","rotateWithOffset","float32");B(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);const s={image:i},a={radians:t,fillValue:n,center:r};return Q.runKernel(Fz,s,a)}const g0t=ee({rotateWithOffset_:p0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S_(e,t,n,r,i,s){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),s==null&&(s=0);const a=e.shape[0];return n=Math.min(n,a),B(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),B(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),B(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),B(t.rank===1,()=>"scores must be a 1D tensor"),B(t.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${t.shape[0]}`),B(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m0t(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const s=U(e,"boxes","nonMaxSuppression","float32"),a=U(t,"scores","nonMaxSuppression","float32"),o=S_(s,a,n,r,i);n=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return Q.runKernel(lz,{boxes:s,scores:a},l)}const v0t=ee({nonMaxSuppression_:m0t});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y0t(e,t,n){const r=b0t(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function b0t(e,t,n){return w0t(e,t,n||x0t)}function x0t(e,t){return e>t?1:e<t?-1:0}function w0t(e,t,n){let r=0,i=e.length,s=0,a=!1;for(;r<i;){s=r+(i-r>>>1);const o=n(t,e[s]);o>0?r=s+1:(i=s,a=!o)}return a?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o7(e,t,n,r,i){return Ute(e,t,n,r,i,0)}function l7(e,t,n,r,i,s){return Ute(e,t,n,r,i,0,!1,s,!0)}function u7(e,t,n,r,i,s){return Ute(e,t,n,r,i,s,!0)}function Ute(e,t,n,r,i,s,a=!1,o=!1,l=!1){const u=[];for(let m=0;m<t.length;m++)t[m]>i&&u.push({score:t[m],boxIndex:m,suppressBeginIndex:0});u.sort(fge);const c=s>0?-.5/s:0,f=[],h=[];for(;f.length<n&&u.length>0;){const m=u.pop(),{score:v,boxIndex:y,suppressBeginIndex:b}=m;if(v<i)break;let x=!1;for(let w=f.length-1;w>=b;--w){const C=$0t(e,y,f[w]);if(C>=r){x=!0;break}if(m.score=m.score*C0t(r,c,C),m.score<=i)break}m.suppressBeginIndex=f.length,x||(m.score===v?(f.push(y),h.push(m.score)):m.score>i&&y0t(u,m,fge))}const d=f.length,p=n-d;o&&p>0&&(f.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const g={selectedIndices:f};return a&&(g.selectedScores=h),l&&(g.validOutputs=d),g}function $0t(e,t,n){const r=e.subarray(t*4,t*4+4),i=e.subarray(n*4,n*4+4),s=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]),d=(o-s)*(l-a),p=(f-u)*(h-c);if(d<=0||p<=0)return 0;const g=Math.max(s,u),m=Math.max(a,c),v=Math.min(o,f),y=Math.min(l,h),b=Math.max(v-g,0)*Math.max(y-m,0);return b/(d+p-b)}function C0t(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function fge(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _0t(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const s=U(e,"boxes","nonMaxSuppressionAsync"),a=U(t,"scores","nonMaxSuppressionAsync"),o=S_(s,a,n,r,i);n=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;const l=await Promise.all([s.data(),a.data()]),u=l[0],c=l[1],{selectedIndices:f}=o7(u,c,n,r,i);return s!==e&&s.dispose(),a!==t&&a.dispose(),ro(f,"int32")}const S0t=_0t;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k0t(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const a=U(e,"boxes","nonMaxSuppression"),o=U(t,"scores","nonMaxSuppression"),l=S_(a,o,n,r,i,s);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,s=l.softNmsSigma;const u={boxes:a,scores:o},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:s},f=Q.runKernel(cz,u,c);return{selectedIndices:f[0],selectedScores:f[1]}}const E0t=ee({nonMaxSuppressionWithScore_:k0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function A0t(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const a=U(e,"boxes","nonMaxSuppressionAsync"),o=U(t,"scores","nonMaxSuppressionAsync"),l=S_(a,o,n,r,i,s);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,s=l.softNmsSigma;const u=await Promise.all([a.data(),o.data()]),c=u[0],f=u[1],{selectedIndices:h,selectedScores:d}=u7(c,f,n,r,i,s);return a!==e&&a.dispose(),o!==t&&o.dispose(),{selectedIndices:ro(h,"int32"),selectedScores:ro(d)}}const T0t=A0t;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D0t(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const a=U(e,"boxes","nonMaxSuppression"),o=U(t,"scores","nonMaxSuppression"),l=S_(a,o,n,r,i,null),u=l.maxOutputSize,c=l.iouThreshold,f=l.scoreThreshold,h={boxes:a,scores:o},d={maxOutputSize:u,iouThreshold:c,scoreThreshold:f,padToMaxOutputSize:s},p=Q.runKernel(uz,h,d);return{selectedIndices:p[0],validOutputs:p[1]}}const I0t=ee({nonMaxSuppressionPadded_:D0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function N0t(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const a=U(e,"boxes","nonMaxSuppressionAsync"),o=U(t,"scores","nonMaxSuppressionAsync"),l=S_(a,o,n,r,i,null),u=l.maxOutputSize,c=l.iouThreshold,f=l.scoreThreshold,[h,d]=await Promise.all([a.data(),o.data()]),{selectedIndices:p,validOutputs:g}=l7(h,d,u,c,f,s);return a!==e&&a.dispose(),o!==t&&o.dispose(),{selectedIndices:ro(p,"int32"),validOutputs:xt(g,"int32")}}const M0t=N0t;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F0t(e,t,n=!1,r=!1){const i=U(e,"images","resizeBilinear");B(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),B(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),B(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=i,a=!1;i.rank===3&&(a=!0,s=ie(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const o={images:s},l={alignCorners:n,halfPixelCenters:r,size:t},u=Q.runKernel(aN,o,l);return a?ie(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const i3e=ee({resizeBilinear_:F0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O0t(e,t,n=!1,r=!1){const i=U(e,"images","resizeNearestNeighbor");B(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),B(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),B(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),B(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=i,a=!1;i.rank===3&&(a=!0,s=ie(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const o={images:s},l={alignCorners:n,halfPixelCenters:r,size:t},u=Q.runKernel(sN,o,l);return a?ie(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const s3e=ee({resizeNearestNeighbor_:O0t});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R0t(e,t="binary",n=!1,r=.5){const i=U(e,"image","threshold"),s=.2989,a=.587,o=.114,l=i.shape[0]*i.shape[1];let u=ne(ro([r]),255),c,f,h,d;if(B(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),B(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),B(i.dtype==="int32"||i.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),B(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),i.shape[2]===3){[c,f,h]=Jo(i,[1,1,1],-1);const m=ne(c,s),v=ne(f,a),y=ne(h,o);d=ke(ke(m,v),y)}else d=e;if(t==="otsu"){const m=rTe(Oe(Ete(d),"int32"),vp([]),256);u=P0t(m,l)}const p=n?Vb(d,u):yl(d,u);return Oe(ne(p,255),"int32")}function P0t(e,t){let n=ro([-1]),r=ro([0]),i=ro([0]),s,a,o,l,u,c;for(let f=0;f<e.size-1;f++){s=rn(e,0,f+1),a=rn(e,f+1),u=Qe(qe(s),t),c=Qe(qe(a),t);const h=qe(ne(s,Pw(0,s.size)));o=Qe(h,qe(s));const d=$_(a.shape,s.size),p=ke(Pw(0,a.size),d),g=ne(a,p);l=Qe(qe(g),qe(a));const m=We(o,l),v=We(o,l),y=ne(u,c);i=ne(ne(y,m),v);const b=yl(i,r);r=Ws(b,i,r),n=Ws(b,ro([f]),n)}return n}const L0t=ee({threshold_:R0t});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B0t(e,t,n="nearest",r="constant",i=0,s){const a=U(e,"image","transform","float32"),o=U(t,"transforms","transform","float32");B(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),B(o.rank===2&&(o.shape[0]===a.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),B(s==null||s.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`);const l={image:a,transforms:o},u={interpolation:n,fillMode:r,fillValue:i,outputShape:s};return Q.runKernel(Nz,l,u)}const z0t=ee({transform_:B0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U0t(e,t,n){const r=U(e,"a","bandPart");B(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const i=r.shape,[s,a]=r.shape.slice(-2);let o,l;typeof t=="number"?(B(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),B(t<=s,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`),o=U(t<0?s:t,"numLower","bandPart")):(B(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=Ws(yT(t,0),s,Py(t,s))),typeof n=="number"?(B(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),B(n<=a,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${a}).`),l=U(n<0?a:n,"numUpper","bandPart")):(B(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Ws(yT(n,0),a,Py(n,a)));const u=ie(Pw(0,s,1,"int32"),[-1,1]),c=Pw(0,a,1,"int32"),f=We(u,c),h=Mh(Vb(f,o),Wm(f,ur(l))),d=di([s,a],r.dtype);return ie(Np(V0(ie(r,[-1,s,a])).map(p=>Ws(h,p,d))),i)}const W0t=ee({bandPart_:U0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V0t(e){let t;if(Array.isArray(e)){t=!1,B(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const i=e[0].shape[0];for(let s=1;s<e.length;++s)B(e[s].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[s].shape[0]} vs. ${i})`)}else t=!0,e=Jo(e,e.shape[0],0).map(i=>qb(i,[0]));B(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);const n=[],r=e;for(let i=0;i<e.length;++i)n.push(Q.tidy(()=>{let s=r[i];if(i>0)for(let a=0;a<i;++a){const o=ne(qe(ne(n[a],s)),n[a]);s=We(s,o)}return Qe(s,_N(s,"euclidean"))}));return t?Np(n,0):n}const j0t=ee({gramSchmidt_:V0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H0t(e,t=!1){if(B(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return hge(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce((l,u)=>l*u),r=V0(ie(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],s=[];r.forEach(l=>{const[u,c]=hge(l,t);i.push(u),s.push(c)});const a=ie(Np(i,0),e.shape),o=ie(Np(s,0),e.shape);return[a,o]}}function hge(e,t=!1){return Q.tidy(()=>{B(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);const n=e.shape[0],r=e.shape[1];let i=vte(n),s=d0(e);const a=rA([[1]],[1,1]);let o=d0(a);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=s,f=o,h=i;[o,s,i]=Q.tidy(()=>{const d=rn(s,[u,u],[n-u,1]),p=_N(d),g=rn(s,[u,u],[1,1]),m=Ws(yl(g,0),rA([[-1]]),rA([[1]])),v=We(g,ne(m,p)),y=Qe(d,v);y.shape[0]===1?o=d0(a):o=Di([a,rn(y,[1,0],[y.shape[0]-1,y.shape[1]])],0);const b=ur(Qe(Pt(m,v),p)),x=rn(s,[u,0],[n-u,r]),w=ne(b,o),C=Kt(o);if(u===0)s=We(x,Pt(w,Pt(C,x)));else{const k=We(x,Pt(w,Pt(C,x)));s=Di([rn(s,[0,0],[u,r]),k],0)}const $=Kt(w),_=rn(i,[0,u],[n,i.shape[1]-u]);if(u===0)i=We(_,Pt(Pt(_,o),$));else{const k=We(_,Pt(Pt(_,o),$));i=Di([rn(i,[0,0],[n,u]),k],1)}return[o,s,i]}),Bt([c,f,h])}return!t&&n>r&&(i=rn(i,[0,0],[n,r]),s=rn(s,[0,0],[r,r])),[i,s]})}const q0t=ee({qr_:H0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var da;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(da||(da={}));function G0t(e,t,n=da.SUM_BY_NONZERO_WEIGHTS){const r=U(e,"losses","computeWeightedLoss");let i=null;t!=null&&(i=U(t,"weights","computeWeightedLoss"));const s=i==null?r:ne(r,i);if(n===da.NONE)return s;if(n===da.SUM)return qe(s);if(n===da.MEAN){if(i==null)return Lr(s);{const a=r.size/i.size,o=Qe(qe(s),qe(i));return a>1?Qe(o,xt(a)):o}}if(n===da.SUM_BY_NONZERO_WEIGHTS){if(i==null)return Qe(qe(s),xt(r.size));{const a=ne(i,Dl(r.shape)),o=Oe(qe(Rw(a,xt(0))),"float32");return Qe(qe(s),o)}}throw Error(`Unknown reduction: ${n}`)}const ig=ee({computeWeightedLoss_:G0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y0t(e,t,n,r=da.SUM_BY_NONZERO_WEIGHTS){const i=U(e,"labels","absoluteDifference"),s=U(t,"predictions","absoluteDifference");let a=null;n!=null&&(a=U(n,"weights","absoluteDifference")),gs(i.shape,s.shape,"Error in absoluteDifference: ");const o=hi(We(i,s));return ig(o,a,r)}const X0t=ee({absoluteDifference_:Y0t});function K0t(e,t,n,r,i=da.SUM_BY_NONZERO_WEIGHTS){const s=U(e,"labels","cosineDistance"),a=U(t,"predictions","cosineDistance");let o=null;r!=null&&(o=U(r,"weights","cosineDistance")),gs(s.shape,a.shape,"Error in cosineDistance: ");const l=xt(1),u=We(l,qe(ne(s,a),n,!0));return ig(u,o,i)}const Z0t=ee({cosineDistance_:K0t});function Q0t(e,t,n,r=da.SUM_BY_NONZERO_WEIGHTS){let i=U(e,"labels","hingeLoss");const s=U(t,"predictions","hingeLoss");let a=null;n!=null&&(a=U(n,"weights","hingeLoss")),gs(i.shape,s.shape,"Error in hingeLoss: ");const o=xt(1);i=We(ne(xt(2),i),o);const l=id(We(o,ne(i,s)));return ig(l,a,r)}const J0t=ee({hingeLoss_:Q0t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function emt(e,t,n,r=1,i=da.SUM_BY_NONZERO_WEIGHTS){const s=U(e,"labels","huberLoss"),a=U(t,"predictions","huberLoss");let o=null;n!=null&&(o=U(n,"weights","huberLoss")),gs(s.shape,a.shape,"Error in huberLoss: ");const l=xt(r),u=hi(We(a,s)),c=Py(u,l),f=We(u,c),h=ke(ne(xt(.5),Gn(c)),ne(l,f));return ig(h,o,i)}const tmt=ee({huberLoss_:emt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nmt(e,t,n,r=1e-7,i=da.SUM_BY_NONZERO_WEIGHTS){const s=U(e,"labels","logLoss"),a=U(t,"predictions","logLoss");let o=null;n!=null&&(o=U(n,"weights","logLoss")),gs(s.shape,a.shape,"Error in logLoss: ");const l=xt(1),u=xt(r),c=ur(ne(s,Vl(ke(a,u)))),f=ne(We(l,s),Vl(ke(We(l,a),u))),h=We(c,f);return ig(h,o,i)}const rmt=ee({logLoss_:nmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function imt(e,t,n,r=da.SUM_BY_NONZERO_WEIGHTS){const i=U(e,"labels","meanSquaredError"),s=U(t,"predictions","meanSquaredError");let a=null;n!=null&&(a=U(n,"weights","meanSquaredError")),gs(i.shape,s.shape,"Error in meanSquaredError: ");const o=Ote(i,s);return ig(o,a,r)}const smt=ee({meanSquaredError_:imt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function amt(e,t){const n=U(e,"labels","sigmoidCrossEntropyWithLogits"),r=U(t,"logits","sigmoidCrossEntropyWithLogits");gs(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=id(r),s=ne(r,n),a=Wz(Wl(ur(hi(r))));return ke(We(i,s),a)}function omt(e,t,n,r=0,i=da.SUM_BY_NONZERO_WEIGHTS){let s=U(e,"multiClassLabels","sigmoidCrossEntropy");const a=U(t,"logits","sigmoidCrossEntropy");let o=null;if(n!=null&&(o=U(n,"weights","sigmoidCrossEntropy")),gs(s.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=xt(r),c=xt(1),f=xt(.5);s=ke(ne(s,We(c,u)),ne(f,u))}const l=amt(s,a);return ig(l,o,i)}const lmt=ee({sigmoidCrossEntropy_:omt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function umt(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return Nh((i,s,a)=>{const l=bte(s,[n],!0),u=We(Oe(s,"float32"),l);a([i,u]);const c=ur(ne(u,i));return{value:qe(c,[n]),gradFunc:(d,p)=>{const[g,m]=p,v=Zr(d.shape,[n]);return[ne(ie(d,v),We(Oe(g,"float32"),Wl(m))),ne(ie(d,v),We(Wl(m),Oe(g,"float32")))]}}})(e,t)}function cmt(e,t,n,r=0,i=da.SUM_BY_NONZERO_WEIGHTS){let s=U(e,"onehotLabels","softmaxCrossEntropy");const a=U(t,"logits","softmaxCrossEntropy");let o=null;if(n!=null&&(o=U(n,"weights","softmaxCrossEntropy")),gs(s.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){const u=xt(r),c=xt(1),f=xt(s.shape[1]);s=ke(ne(s,We(c,u)),Qe(u,f))}const l=umt(s,a);return ig(l,o,i)}const fmt=ee({softmaxCrossEntropy_:cmt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hmt(e,t,n,r){const i=U(e,"indices","sparseFillEmptyRows","int32"),s=U(t,"values","sparseFillEmptyRows"),a=U(n,"denseShape","sparseFillEmptyRows","int32"),o=U(r,"defaultValue","sparseFillEmptyRows",s.dtype);if(i.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${i.shape}`);if(s.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(a.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${a.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:i,values:s,denseShape:a,defaultValue:o},u=Q.runKernel(wz,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const dmt=ee({sparseFillEmptyRows_:hmt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pmt(e,t,n){const r=U(e,"inputIndices","sparseReshape","int32"),i=U(t,"inputShape","sparseReshape","int32"),s=U(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(s.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);const a={inputIndices:r,inputShape:i,newShape:s},o=Q.runKernel($z,a);return{outputIndices:o[0],outputShape:o[1]}}const gmt=ee({sparseReshape_:pmt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mmt(e,t,n){const r=U(e,"data","sparseSegmentMean"),i=U(t,"indices","sparseSegmentMean","int32"),s=U(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${i.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${s.shape}`);const a={data:r,indices:i,segmentIds:s};return Q.runKernel(Cz,a)}const vmt=ee({sparseSegmentMean_:mmt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ymt(e,t,n){const r=U(e,"data","sparseSegmentSum"),i=U(t,"indices","sparseSegmentSum","int32"),s=U(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${i.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${s.shape}`);const a={data:r,indices:i,segmentIds:s};return Q.runKernel(_z,a)}const bmt=ee({sparseSegmentSum_:ymt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xmt(e,t,n,r,i,s,a,o){const l=U(e,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=U(t,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:i,rightPad:s,padWidth:a,preserveShortSequences:o},f={data:l,dataSplits:u},h=Q.runKernel(Az,f,c);return{nGrams:h[0],nGramsSplits:h[1]}}const wmt=ee({stringNGrams_:xmt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $mt(e,t,n=!0){const r=U(e,"input","stringSplit","string"),i=U(t,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(i.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const s={skipEmpty:n},a={input:r,delimiter:i},o=Q.runKernel(Tz,a,s);return{indices:o[0],values:o[1],shape:o[2]}}const Cmt=ee({stringSplit_:$mt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _mt(e,t){const n=U(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const i={input:n};return Q.runKernel(Dz,i,r)}const Smt=ee({stringToHashBucketFast_:_mt});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kmt(e,t,n,r=!0){const i=U(e,"input","staticRegexReplace","string"),s={pattern:t,rewrite:n,replaceGlobal:r};return Q.runKernel(pN,{x:i},s)}const Emt=ee({staticRegexReplace_:kmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Amt={fft:Jz,ifft:$T,rfft:e7,irfft:Fte},Tmt={hammingWindow:r0t,hannWindow:n3e,frame:r3e,stft:o0t},Zf={flipLeftRight:f0t,grayscaleToRGB:d0t,resizeNearestNeighbor:s3e,resizeBilinear:i3e,rotateWithOffset:g0t,cropAndResize:u0t,nonMaxSuppression:v0t,nonMaxSuppressionAsync:S0t,nonMaxSuppressionWithScore:E0t,nonMaxSuppressionWithScoreAsync:T0t,nonMaxSuppressionPadded:I0t,nonMaxSuppressionPaddedAsync:M0t,threshold:L0t,transform:z0t},a3e={bandPart:W0t,gramSchmidt:j0t,qr:q0t},Dmt={absoluteDifference:X0t,computeWeightedLoss:ig,cosineDistance:Z0t,hingeLoss:J0t,huberLoss:tmt,logLoss:rmt,meanSquaredError:smt,sigmoidCrossEntropy:lmt,softmaxCrossEntropy:fmt},Imt={sparseFillEmptyRows:dmt,sparseReshape:gmt,sparseSegmentMean:vmt,sparseSegmentSum:bmt},Nmt={stringNGrams:wmt,stringSplit:Cmt,stringToHashBucketFast:Smt,staticRegexReplace:Emt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mmt=new Map,LY=new Map;class Gb{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}}class El{constructor(){this.classNameMap={}}static getMap(){return El.instance==null&&(El.instance=new El),El.instance}static register(t){El.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function Ee(e,t,n){B(e.className!=null,()=>"Class being registered does not have the static className property defined."),B(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),B(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof n>"u"&&(n=e.className);const r=n,i=t+">"+r;return El.register(e),Mmt.set(i,e),LY.set(e,i),e}function Fmt(e){return LY.has(e)?LY.get(e):e.className}const Omt=Object.freeze(Object.defineProperty({__proto__:null,Serializable:Gb,SerializationMap:El,registerClass:Ee,getRegisteredName:Fmt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sg extends Gb{minimize(t,n=!1,r){const{value:i,grads:s}=this.computeGradients(t,r);if(r!=null){const a=r.map(o=>({name:o.name,tensor:s[o.name]}));this.applyGradients(a)}else this.applyGradients(s);return Bt(s),n?i:(i.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return STe(t,n)}dispose(){this.iterations_!=null&&Bt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:xt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(sg,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wte extends sg{static get className(){return"Adadelta"}constructor(t,n,r=null){super(),this.learningRate=t,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=Q.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Q.registeredVariables[r],a=!1;this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accum_grad`,variable:ce(()=>en(s).variable(a))}),this.accumulatedUpdates[i]==null&&(this.accumulatedUpdates[i]={originalName:`${r}/accum_var`,variable:ce(()=>en(s).variable(a))});const o=Array.isArray(t)?t[i].tensor:t[r];if(o==null)return;const l=this.accumulatedGrads[i].variable,u=this.accumulatedUpdates[i].variable;ce(()=>{const c=ke(ne(l,this.rho),ne(Gn(o),1-this.rho)),f=ne(Qe(Hs(ke(u,this.epsilon)),Hs(ke(l,this.epsilon))),o),h=ke(ne(u,this.rho),ne(Gn(f),1-this.rho));l.assign(c),u.assign(h);const d=ke(ne(f,-this.learningRate),s);s.assign(d)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Bt(this.accumulatedGrads.map(t=>t.variable)),Bt(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=t.length/2,r=!1;this.accumulatedGrads=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedUpdates=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vte extends sg{static get className(){return"Adagrad"}constructor(t,n=.1){super(),this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Q.registeredVariables[r];this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accumulator`,variable:ce(()=>$_(s.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(t)?t[i].tensor:t[r];if(a==null)return;const o=this.accumulatedGrads[i].variable;ce(()=>{const l=ke(o,Gn(a));o.assign(l);const u=ke(ne(Qe(a,Hs(ke(l,Q.backend.epsilon()))),-this.learningRate),s);s.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Bt(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulatedGrads=t.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jte extends sg{static get className(){return"Adam"}constructor(t,n,r,i=null){super(),this.learningRate=t,this.beta1=n,this.beta2=r,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ce(()=>{this.accBeta1=xt(n).variable(),this.accBeta2=xt(r).variable()}),i==null&&(this.epsilon=Q.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);ce(()=>{const r=We(1,this.accBeta1),i=We(1,this.accBeta2);n.forEach((s,a)=>{const o=Q.registeredVariables[s],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${s}/m`,variable:ce(()=>en(o).variable(l))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${s}/v`,variable:ce(()=>en(o).variable(l))});const u=Array.isArray(t)?t[a].tensor:t[s];if(u==null)return;const c=this.accumulatedFirstMoment[a].variable,f=this.accumulatedSecondMoment[a].variable,h=ke(ne(c,this.beta1),ne(u,1-this.beta1)),d=ke(ne(f,this.beta2),ne(Gn(u),1-this.beta2)),p=Qe(h,r),g=Qe(d,i);c.assign(h),f.assign(d);const m=ke(ne(Qe(p,ke(Hs(g),this.epsilon)),-this.learningRate),o);o.assign(m)}),this.accBeta1.assign(ne(this.accBeta1,this.beta1)),this.accBeta2.assign(ne(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Bt(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&Bt(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t),ce(()=>{this.accBeta1.assign(W0(this.beta1,this.iterations_+1)),this.accBeta2.assign(W0(this.beta2,this.iterations_+1))});const n=t.length/2,r=!1;this.accumulatedFirstMoment=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hte extends sg{static get className(){return"Adamax"}constructor(t,n,r,i=null,s=0){super(),this.learningRate=t,this.beta1=n,this.beta2=r,this.epsilon=i,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ce(()=>{this.iteration=xt(0).variable(),this.accBeta1=xt(n).variable()}),i==null&&(this.epsilon=Q.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);ce(()=>{const r=We(1,this.accBeta1),i=Qe(-this.learningRate,ke(ne(this.iteration,this.decay),1));n.forEach((s,a)=>{const o=Q.registeredVariables[s],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${s}/m`,variable:en(o).variable(l)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${s}/v`,variable:en(o).variable(l)});const u=Array.isArray(t)?t[a].tensor:t[s];if(u==null)return;const c=this.accumulatedFirstMoment[a].variable,f=this.accumulatedWeightedInfNorm[a].variable,h=ke(ne(c,this.beta1),ne(u,1-this.beta1)),d=ne(f,this.beta2),p=hi(u),g=rg(d,p);c.assign(h),f.assign(g);const m=ke(ne(Qe(i,r),Qe(h,ke(g,this.epsilon))),o);o.assign(m)}),this.iteration.assign(ke(this.iteration,1)),this.accBeta1.assign(ne(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Bt(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&Bt(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c7 extends sg{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Array.isArray(t)?t[i].tensor:t[r];if(s==null)return;const a=Q.registeredVariables[r];ce(()=>{const o=ke(ne(this.c,s),a);a.assign(o)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=zc(xt(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qte extends c7{static get className(){return"Momentum"}constructor(t,n,r=!1){super(t),this.learningRate=t,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=xt(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Q.registeredVariables[r];this.accumulations[i]==null&&(this.accumulations[i]={originalName:`${r}/momentum`,variable:ce(()=>en(s).variable(!1))});const a=this.accumulations[i].variable,o=Array.isArray(t)?t[i].tensor:t[r];o!=null&&ce(()=>{let l;const u=ke(ne(this.m,a),o);this.useNesterov?l=ke(ne(this.c,ke(o,ne(u,this.m))),s):l=ke(ne(this.c,u),s),a.assign(u),s.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Bt(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulations=t.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gte extends sg{static get className(){return"RMSProp"}constructor(t,n=.9,r=0,i=null,s=!1){if(super(),this.learningRate=t,this.decay=n,this.momentum=r,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,i==null&&(this.epsilon=Q.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Q.registeredVariables[r],a=!1;this.accumulatedMeanSquares[i]==null&&(this.accumulatedMeanSquares[i]={originalName:`${r}/rms`,variable:ce(()=>en(s).variable(a))}),this.accumulatedMoments[i]==null&&(this.accumulatedMoments[i]={originalName:`${r}/momentum`,variable:ce(()=>en(s).variable(a))}),this.accumulatedMeanGrads[i]==null&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${r}/mg`,variable:ce(()=>en(s).variable(a))});const o=Array.isArray(t)?t[i].tensor:t[r];if(o==null)return;const l=this.accumulatedMeanSquares[i].variable,u=this.accumulatedMoments[i].variable;ce(()=>{const c=ke(ne(l,this.decay),ne(Gn(o),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[i].variable,h=ke(ne(f,this.decay),ne(o,1-this.decay)),d=Qe(ne(o,this.learningRate),Hs(We(c,ke(Gn(h),this.epsilon)))),p=ke(ne(u,this.momentum),d);l.assign(c),f.assign(h),u.assign(p);const g=We(s,p);s.assign(g)}else{const f=ke(ne(l,this.decay),ne(Gn(o),1-this.decay)),h=ke(ne(u,this.momentum),Qe(ne(o,this.learningRate),Hs(ke(f,this.epsilon))));l.assign(f),u.assign(h);const d=We(s,h);s.assign(d)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Bt(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Bt(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&Bt(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=this.centered?t.length/3:t.length/2,r=!1;this.accumulatedMeanSquares=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedMoments=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rmt=[Wte,Vte,jte,Hte,qte,Gte,c7];function Pmt(){for(const e of Rmt)Ee(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lmt="model",Bmt=".json",zmt=".weights.bin";function dge(e){return new Promise(t=>setTimeout(t)).then(e)}class Ly{constructor(t){if(!le().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Ly.URL_SCHEME)&&(t=t.slice(Ly.URL_SCHEME.length)),(t==null||t.length===0)&&(t=Lmt),this.modelJsonFileName=t+Bmt,this.weightDataFileName=t+zmt}async save(t){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=uf.join(t.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const i=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],s=NAe(t,i),a=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=a,await dge(()=>o.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=r,await dge(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:bN(t)}}}}Ly.URL_SCHEME="downloads://";class Umt{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise((t,n)=>{const r=new FileReader;r.onload=i=>{const s=JSON.parse(i.target.result),a=s.modelTopology;if(a==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(s.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){t({modelTopology:a});return}const l=ate(s,u=>this.loadWeights(u));t(l)},r.onerror=i=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(t){const n=[],r=[];for(const a of t)n.push(...a.weights),r.push(...a.paths);const i=this.checkManifestAndWeightFiles(t),s=r.map(a=>this.loadWeightsFile(a,i[a]));return Promise.all(s).then(a=>[n,a])}loadWeightsFile(t,n){return new Promise((r,i)=>{const s=new FileReader;s.onload=a=>{const o=a.target.result;r(o)},s.onerror=a=>i(`Failed to weights data from file of path '${t}'.`),s.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(t){const n=[],r=this.weightsFiles.map(s=>cge(s.name)),i={};for(const s of t)s.paths.forEach(a=>{const o=cge(a);if(n.indexOf(o)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(n.push(o),r.indexOf(o)===-1)throw new Error(`Weight file with basename '${o}' is not provided.`);i[a]=this.weightsFiles[r.indexOf(o)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return i}}const Wmt=e=>le().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ly.URL_SCHEME)?Vmt(e.slice(Ly.URL_SCHEME.length)):null;Cr.registerSaveRouter(Wmt);function Vmt(e="model"){return new Ly(e)}function jmt(e){return new Umt(e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pge(e,t,n,r){a(e),n=n==null?0:n,r=r==null?1:r,o(n,r);let i=0;const s=l=>(l.then(u=>{const c=n+ ++i/e.length*(r-n);return t(c),u}),l);function a(l){B(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,u){B(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),B(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),B(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(e.map(s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function o3e(e,t){t==null&&(t={});const n=t.fetchFunc==null?le().platform.fetch:t.fetchFunc,r=e.map(f=>n(f,t.requestInit,{isBinary:!0})),i=0,s=.5,o=(t.onProgress==null?await Promise.all(r):await pge(r,t.onProgress,i,s)).map(f=>f.arrayBuffer()),l=.5,u=1;return t.onProgress==null?await Promise.all(o):await pge(o,t.onProgress,l,u)}async function Hmt(e,t="",n,r){return l3e(a=>o3e(a,{requestInit:r}))(e,t,n)}function l3e(e){return async(t,n="",r)=>{const i=t.map(()=>!1),s={},a=r!=null?r.map(()=>!1):[],o=[];if(t.forEach((d,p)=>{let g=0;d.weights.forEach(m=>{const v="quantization"in m?m.quantization.dtype:m.dtype,y=TY[v]*he(m.shape),b=()=>{i[p]=!0,s[p]==null&&(s[p]=[]),s[p].push({manifestEntry:m,groupOffset:g,sizeBytes:y})};r!=null?r.forEach((x,w)=>{x===m.name&&(b(),a[w]=!0)}):b(),o.push(m.name),g+=y})}),!a.every(d=>d)){const d=r.filter((p,g)=>!a[g]);throw new Error(`Could not find weights in manifest with names: ${d.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}const l=i.reduce((d,p,g)=>(p&&d.push(g),d),[]),u=[];l.forEach(d=>{t[d].paths.forEach(p=>{const g=n+(n.endsWith("/")?"":"/")+p;u.push(g)})});const c=await e(u),f={};let h=0;return l.forEach(d=>{const p=t[d].paths.length,g=new uf(c.slice(h,h+p));s[d].forEach(v=>{const y=g.slice(v.groupOffset,v.groupOffset+v.sizeBytes),b=DAe(y,[v.manifestEntry]);for(const x in b)f[x]=b[x]}),h+=p}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qmt="application/octet-stream",Gmt="application/json";class Yte{constructor(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(B(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=le().platform.fetch,B(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&B(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i=NAe(t,r);if(n.body.append("model.json",new Blob([JSON.stringify(i)],{type:Gmt}),"model.json"),t.weightData!=null){const a=uf.join(t.weightData);n.body.append("model.weights.bin",new Blob([a],{type:qmt}),"model.weights.bin")}const s=await this.fetch(this.path,n);if(s.ok)return{modelArtifactsInfo:bN(t),responses:[s]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${s.status}.`)}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await t.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}const r=n.modelTopology,i=n.weightsManifest;if(r==null&&i==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return ate(n,s=>this.loadWeights(s))}async loadWeights(t){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,i]=Ymt(n),s=this.weightPathPrefix||r,a=FAe(t),o=[],l=[];for(const c of t)for(const f of c.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(f)):o.push(s+f+i);this.weightUrlConverter&&o.push(...await Promise.all(l));const u=await o3e(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[a,u]}}Yte.URL_SCHEME_REGEX=/^https?:\/\//;function Ymt(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),i=n>t?e.substring(n):"";return[r+"/",i]}function BY(e){return e.match(Yte.URL_SCHEME_REGEX)!=null}const u3e=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(e)?n=e.every(r=>BY(r)):n=BY(e),n)return Xte(e,t)}return null};Cr.registerSaveRouter(u3e);Cr.registerLoadRouter(u3e);function Xte(e,t){return new Yte(e,t)}function Xmt(e,t){return Xte(e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oj{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class c3e{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class Kmt{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=n=>Promise.resolve(t.save(n)))}}function Zmt(e,t,n,r){const i=arguments;return new Kmt(f3e(...i))}function f3e(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new oj(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new oj({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new oj({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function Qmt(e){return new c3e(e)}function Jmt(e){return new c3e(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const evt=Object.freeze(Object.defineProperty({__proto__:null,browserFiles:jmt,browserHTTPRequest:Xmt,CompositeArrayBuffer:uf,concatenateArrayBuffers:IAe,decodeWeights:DAe,encodeWeights:DY,fromMemory:Zmt,fromMemorySync:f3e,getLoadHandlers:xct,getModelArtifactsForJSON:ate,getModelArtifactsForJSONSync:MAe,getModelArtifactsInfoForJSON:bN,getSaveHandlers:OAe,getWeightSpecs:FAe,http:Xte,isHTTPScheme:BY,loadWeights:Hmt,registerLoadRouter:bct,registerSaveRouter:yct,weightsLoaderFactory:l3e,withSaveHandler:Qmt,withSaveHandlerSync:Jmt,copyModel:Fct,listModels:Nct,moveModel:Oct,removeModel:Mct},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tvt(e,t,n){const r=U(e,"labels","confusionMatrix"),i=U(t,"predictions","confusionMatrix");B(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),B(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),B(i.rank===1,()=>`Expected the rank of predictions to be 1, but got ${i.rank}`),B(r.shape[0]===i.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`),B(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const s=bT(Oe(r,"int32"),n),a=bT(Oe(i,"int32"),n),o=Kt(s),l=Pt(o,a);return Oe(l,"int32")}const nvt=ee({confusionMatrix_:tvt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rvt=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:nvt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let _v,gge=!1;function h3e(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,s=!1,a=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)s=!0;else if(e.getContext!=null)a=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(hT(x5,Q.backendName)!=null){const p={pixels:e},g={numChannels:t};return Q.runKernel(x5,p,g)}const[u,c]=i?[e.videoWidth,e.videoHeight]:[e.width,e.height];let f;if(a)f=e.getContext("2d").getImageData(0,0,u,c).data;else if(r||n)f=e.data;else if(s||i||o){if(_v==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")_v=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else _v=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});_v.canvas.width=u,_v.canvas.height=c,_v.drawImage(e,0,0,u,c),f=_v.getImageData(0,0,u,c).data}let h;if(t===4)h=new Int32Array(f);else{const p=u*c;h=new Int32Array(p*t);for(let g=0;g<p;g++)for(let m=0;m<t;++m)h[g*t+m]=f[g*4+m]}return qTe(h,[c,u,t],"int32")}function ivt(e){return e!=null&&e.data instanceof Uint8Array}function svt(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function avt(e){return e!=null&&e.width!==0&&e.height!==0}function ovt(e){return svt()&&!(e instanceof ImageBitmap)&&avt(e)&&!ivt(e)}async function lvt(e,t=3){let n=null;if(le().getBool("WRAP_TO_IMAGEBITMAP")&&ovt(e)){let r;try{r=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===e.width&&r.height===e.height?n=r:n=e}else n=e;return h3e(n,t)}function d3e(e){if(e.rank!==2&&e.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);const t=e.rank===2?1:e.shape[2];if(t>4||t===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if(e.dtype!=="float32"&&e.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}function uvt(e){const t=(e==null?void 0:e.alpha)||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}async function cvt(e,t){let n=U(e,"img","toPixels");if(!(e instanceof On)){const u=n;n=Oe(u,"int32"),u.dispose()}d3e(n);const[r,i]=n.shape.slice(0,2),s=n.rank===2?1:n.shape[2],a=await n.data(),o=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(i*r*4);for(let u=0;u<r*i;++u){const c=[0,0,0,255];for(let h=0;h<s;h++){const d=a[u*s+h];if(n.dtype==="float32"){if(d<0||d>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${d}.`)}else if(n.dtype==="int32"&&(d<0||d>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${d}.`);s===1?(c[0]=d*o,c[1]=d*o,c[2]=d*o):c[h]=d*o}const f=u*4;l[f+0]=Math.round(c[0]),l[f+1]=Math.round(c[1]),l[f+2]=Math.round(c[2]),l[f+3]=Math.round(c[3])}if(t!=null){gge||hT(G8,Q.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),gge=!0),t.width=i,t.height=r;const u=t.getContext("2d"),c=new ImageData(l,i,r);u.putImageData(c,0,0)}return n!==e&&n.dispose(),l}function fvt(e,t,n){let r=U(e,"img","draw");if(!(e instanceof On)){const a=r;r=Oe(a,"int32"),a.dispose()}d3e(r),uvt(n==null?void 0:n.imageOptions);const i={image:r},s={canvas:t,options:n};Q.runKernel(G8,i,s)}const hvt=ee({fromPixels_:h3e}),dvt=Object.freeze(Object.defineProperty({__proto__:null,fromPixelsAsync:lvt,toPixels:cvt,draw:fvt,fromPixels:hvt},Symbol.toStringTag,{value:"Module"}));function f7(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(he(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const i=t.shape,s=i[i.length-1];let a=1;for(let f=0;f<i.length-1;++f)a*=i[f];const o=e.shape,l=i.slice();l.pop();let u=1;for(let f=s;f<n;++f)u*=o[f],l.push(o[f]);const c=[...Je(e.shape).map(f=>f/u),1].slice(0,s);return[l,a,u,c]}const pvt=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:f7},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zY=-2,gvt=-1;function Kte(e,t,n){const r=e.shape.length;B(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),B(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)B(t[i]+n[i]<=e.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${t[i]+n[i]}) would overflow input.shape[${i}] (${e.shape[i]})`)}function mvt(e){const t=[];let n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function Zte(e,t,n){const r=[];for(let i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function p3e(e,t,n,r){const i=[...e];for(let s=i.length;s<r.length;s++)i.push(1);for(let s=0;s<n;s++)s===0?i[t]=1:(i.splice(t,0,1),i.pop());return i}function g3e(e,t,n){return n<=e?n:n-(t-1)}function m3e(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function vvt(e,t,n,r,i,s,a,o,l){const u=e.length;let c=new Array(u),f=new Array(u),h=new Array(u);if(t.length&&n>0){const d=t[0],p=n+1;c=v3e(a,d,p,r,e),f=y3e(o,d,p,i,e),h=p3e(s,d,p,e)}else for(let d=0;d<u;d++)c[d]=x3e(a,r,s,e,d,l),f[d]=w3e(o,i,s,e,d,l),h[d]=b3e(s,d,l);return{begin:c,end:f,strides:h}}function v3e(e,t,n,r,i){const s=[...i],a=m3e(n,t);for(let o=0;o<s.length;o++)if(a.indexOf(o)>-1)s[o]=0;else{const l=g3e(t,n,o);let u=r[l];e&1<<l&&(u=0),s[o]=u}return s}function y3e(e,t,n,r,i){const s=[...i],a=m3e(n,t);for(let o=0;o<s.length;o++)if(a.indexOf(o)>-1)s[o]=Number.MAX_SAFE_INTEGER;else{const l=g3e(t,n,o);let u=r[l];e&1<<l&&(u=Number.MAX_SAFE_INTEGER),s[o]=u}for(let o=0;o<s.length;o++){const l=i[o];s[o]<0&&(s[o]+=l),s[o]=P0(0,s[o],i[o])}return s}function b3e(e,t,n){let r=e[t];return(n&1<<t||r==null)&&(r=1),r}function x3e(e,t,n,r,i,s){let a=t[i];const o=n[i]||1;(e&1<<i||s&1<<i||a==null)&&(o>0?a=Number.MIN_SAFE_INTEGER:a=Number.MAX_SAFE_INTEGER);const l=r[i];return a<0&&(a+=l),a=P0(0,a,l-1),a}function w3e(e,t,n,r,i,s){let a=t[i];const o=n[i]||1;(e&1<<i||s&1<<i||a==null)&&(o>0?a=Number.MAX_SAFE_INTEGER:a=Number.MIN_SAFE_INTEGER);const l=r[i];return a<0&&(a+=l),o>0?a=P0(0,a,l):a=P0(-1,a,l-1),a}function Qte(e,t,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function Jte(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function h7(e,t,n){let r;const i=e.shape.length;typeof t=="number"?r=[t,...new Array(i-1).fill(0)]:t.length<i?r=t.concat(new Array(i-t.length).fill(0)):r=t.slice(),r.forEach(a=>{B(a!==-1,()=>"slice() does not support negative begin indexing.")});let s;return n==null?s=new Array(i).fill(-1):typeof n=="number"?s=[n,...new Array(i-1).fill(-1)]:n.length<i?s=n.concat(new Array(i-n.length).fill(-1)):s=n,s=s.map((a,o)=>a>=0?a:(B(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${o}.`),e.shape[o]-r[o])),[r,s]}function ene(e,t,n,r,i,s,a,o,l){let u;if(r==null?(u=new Array(t.length),u.fill(1)):u=r,a!=null&&(a&a-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const f={dims:u.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:u.slice(),beginMask:i,endMask:s,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};for(let b=0;b<f.dims;b++)c&&(1<<b&o)!==0&&f.numAddAxisAfterEllipsis++,1<<b&a&&(c=!0);c||(f.ellipsisMask|=1<<f.dims,f.dims++);const h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};yvt(f,h);let d=!0,p=!0,g=!0;const m=[],v=[];for(let b=0;b<e.length;++b){if(h.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const x=!!(h.shrinkAxisMask&1<<b),w=e[b];if(w===-1){m.push(x?1:-1);continue}const C=[h.beginMask&1<<b,h.endMask&1<<b],$=[h.strides[b]>0?0:-1,h.strides[b]>0?w:w-1];if(x&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&h.strides[b]===1;const _=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(x){const I=h.begin[b]<0?w+h.begin[b]:h.begin[b];if(h.begin[b]=I,h.end[b]=h.begin[b]+1,I<0||I>=w)throw Error(`slice index ${h.begin[b]} of dimension ${b} out of bounds.`)}else h.begin[b]=mge(h.begin[b],0,h.strides[b],w,C,$),h.end[b]=mge(h.end[b],1,h.strides[b],w,C,$);const S=h.strides[b]===1&&h.begin[b]===0&&h.end[b]===w;d=d&&S,p=p&&(b===0&&h.strides[b]===1||S)}else d=d&&h.strides[b]===1&&_,p=p&&(b===0&&h.strides[b]===1||_);let k,E=!1;if(h.beginValid&&h.endValid?(k=h.end[b]-h.begin[b],E=!0):x?(k=1,E=!0):_&&w>=0&&(h.strides[b]<0?k=-w:k=w,E=!0),E){let S;k===0||k<0!=h.strides[b]<0?S=0:S=Math.trunc(k/h.strides[b])+(k%h.strides[b]!==0?1:0),m.push(S)}else m.push(-1)}for(let b=0;b<h.finalShapeGatherIndices.length;++b){const x=h.finalShapeGatherIndices[b];x>=0?v.push(m[x]):x===zY&&v.push(1)}return{finalShapeSparse:v.filter((b,x)=>h.finalShapeGatherIndices[x]!==zY),finalShape:v,isIdentity:d,sliceDim0:p,isSimpleSlice:g,begin:h.begin,end:h.end,strides:h.strides}}function yvt(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const i=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(zY),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[r]),e.end!=null&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(gvt),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}function mge(e,t,n,r,i,s){if(i[t])return n>0?s[t]:s[t+1&1];{const a=e<0?r+e:e;return a<s[0]?s[0]:a>s[1]?s[1]:a}}const $3e=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:Kte,maskToAxes:mvt,computeOutShape:Zte,stridesWithElidedDims:p3e,getNormalizedAxes:vvt,startIndicesWithElidedDims:v3e,stopIndicesWithElidedDims:y3e,stridesForAxis:b3e,startForAxis:x3e,stopForAxis:w3e,isSliceContinous:Qte,computeFlatOffset:Jte,parseSliceParams:h7,sliceInfo:ene},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const bvt="4.8.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C3e{static sgd(t){return new c7(t)}static momentum(t,n,r=!1){return new qte(t,n,r)}static rmsprop(t,n=.9,r=0,i=null,s=!1){return new Gte(t,n,r,i,s)}static adam(t=.001,n=.9,r=.999,i=null){return new jte(t,n,r,i)}static adadelta(t=.001,n=.95,r=null){return new Wte(t,n,r)}static adamax(t=.002,n=.9,r=.999,i=null,s=0){return new Hte(t,n,r,i,s)}static adagrad(t,n=.1){return new Vte(t,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gv=C3e;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xvt=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e())();function tne(){return new Promise(e=>xvt(()=>e()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nne(e,t){const n=e[0].length;e.forEach((i,s)=>{B(i.length===n,()=>`Error in concat${n}D: rank of tensors[${s}] must be the same as the rank of the rest (${n})`)}),B(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=e[0];e.forEach((i,s)=>{for(let a=0;a<n;a++)B(a===t||i[a]===r[a],()=>`Error in concat${n}D: Shape of tensors[${s}] (${i}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function rh(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var vc;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(vc||(vc={}));function _3e(e,t,n){let r=new Array;if(n==null&&t==null)return r;if(t==null)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(n==null)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){const s=n[i],a=r[r.length-n.length+i],o=r[a];if(s>=0)if(o>=0){if(o!==s)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+e}] = ${s} but shape[${i+e}] = ${o}`)}else r[a]=s}return r}function S3e(e){const t={FIRST_DIM_SIZE:vc.FIRST_DIM_SIZE,VALUE_ROWIDS:vc.VALUE_ROWIDS,ROW_LENGTHS:vc.ROW_LENGTHS,ROW_SPLITS:vc.ROW_SPLITS,ROW_LIMITS:vc.ROW_LIMITS,ROW_STARTS:vc.ROW_STARTS},n=[];for(const r of e)if(r in t)n.push(t[r]);else break;return n}function k3e(e){return e.length===0?0:e[0]===vc.FIRST_DIM_SIZE?e.length-1:e.length}function E3e(e,t){if(e==null||t==null)return;const n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){const s=e[i],a=t[i+1];if(s>=0&&a>=0&&s!==1&&s!==a)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-e.length}] = ${s} but ragged tensor input.flatValues.shape[${i-e.length}] = ${a}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rne=30;function d7(e){return e<=rne?e:v5(e,Math.floor(Math.sqrt(e)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(e,t,n){const r=n*(typeof e=="number"?e:e[0]),i=t*(typeof e=="number"?e:e[1]);return[r,i]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EN(e,t,n,r=!0){let i=[];if(r)i=i.concat(t.slice(0)),i.push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);const s=t.length;for(let a=0;a<s;++a)i=i.concat([e[a+1]/t[a],t[a]]);i=i.concat(e.slice(s+1))}return i}function AN(e,t,n=!0){const r=[];if(n){r.push(t);for(let i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{const i=[],s=[];for(let a=1;a<e;++a)a>=t*2+1||a%2===1?s.push(a):i.push(a);r.push(...i),r.push(0),r.push(...s)}return r}function TN(e,t,n,r=!0){const i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(let s=1;s<e.length;++s)s<=t.length?r?i.push(t[s-1]*e[s]):i.push(e[s]/t[s-1]):i.push(e[s]);return i}function sne(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function ane(e,t,n){const r=e.slice(0,1);for(let i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p7=1.7580993408473768,g7=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const one=.3275911,lne=.254829592,une=-.284496736,cne=1.421413741,fne=-1.453152027,hne=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mp(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(e.length*2);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function A3e(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function T3e(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=0;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function D3e(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=2;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function dne(e,t){const n=e[t*2],r=e[t*2+1];return{real:n,imag:r}}function I3e(e,t,n,r){e[r*2]=t,e[r*2+1]=n}function N3e(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let i=0;i<Math.ceil(e/2);i++){const s=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(s),r[i]=Math.sin(s)}return{real:n,imag:r}}function M3e(e,t,n){const r=(n?2:-2)*Math.PI*(e/t),i=Math.cos(r),s=Math.sin(r);return{real:i,imag:s}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lj="->",wvt=/->/g,vge=",",yge="...";function pne(e,t){e=e.replace(/\s/g,"");const n=(e.length-e.replace(wvt,"").length)/lj.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${lj}").`);const[r,i]=e.split(lj);B(r.indexOf(yge)===-1,()=>`The ellipsis notation ("${yge}") is not supported yet.`);const s=r.split(vge),a=s.length;if(t!==a)throw new Error(`Expected ${a} input tensors, received ${t}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let h=0;h<i.length;++h){const d=i[h];if(!s.some(p=>p.indexOf(d)!==-1))throw new Error(`Output subscripts contain the label ${d} not present in the input subscripts.`);o.indexOf(d)===-1&&o.push(d)}for(let h=0;h<r.length;++h){const d=r[h];o.indexOf(d)===-1&&d!==vge&&o.push(d)}const l=new Array(s.length);for(let h=0;h<a;++h){if(new Set(s[h].split("")).size!==s[h].length)throw new Error(`Found duplicate axes in input component ${s[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let d=0;d<s[h].length;++d)l[h].push(o.indexOf(s[h][d]))}const u=o.length,c=i.length,f=[];for(let h=c;h<u;++h)f.push(h);return{allDims:o,summedDims:f,idDims:l}}function gne(e,t){let n=new Array(e);n.fill(-1);for(let i=0;i<t.length;++i)n[t[i]]=i;const r=[];for(let i=0;i<e;++i)n[i]===-1&&r.push(i);return n=n.filter(i=>i!==-1),{permutationIndices:n,expandDims:r}}function mne(e,t,n){const r=new Array(e);for(let i=0;i<n.length;++i){const s=n[i].shape;for(let a=0;a<t[i].length;++a)r[t[i][a]]===void 0?r[t[i][a]]=s[a]:B(r[t[i][a]]===s[a],()=>`Expected dimension ${r[t[i][a]]} at axis ${a} of input shaped ${JSON.stringify(s)}, but got dimension ${s[a]}`)}}function vne(e,t){const n=e,r=[];let i=0;e.length===0&&n.push(-1),i=e.length+1;for(let a=0;a<i;++a)r.push([]);const s=[];for(let a=0;a<n.length;++a){const o=n[a],l=$vt(t,o);for(const u of l)s.indexOf(u)===-1&&(r[a].push(u),s.push(u))}return{path:n,steps:r}}function yne(e){return e.every((t,n)=>t===n)}function $vt(e,t){const n=[];for(let r=0;r<e.length;++r)(e[r].length===0||e[r].indexOf(t)!==-1||t===-1)&&n.push(r);return n}function bne(e,t,n=0){let r=[];if(typeof t=="number")B(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(e.shape[n]/t);else{const i=t.reduce((a,o)=>(o===-1&&(a+=1),a),0);B(i<=1,()=>"There should be only one negative value in split array.");const s=t.indexOf(-1);if(s!==-1){const a=t.reduce((o,l)=>l>0?o+l:o);t[s]=e.shape[n]-a}B(e.shape[n]===t.reduce((a,o)=>a+o),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F3e(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function O3e(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function R3e(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P3e(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function L3e(e,t){return`size ${e} must be non-negative, not ${t}`}function B3e(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function z3e(e,t){const n=he(e),r=he(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${e} outputShape= ${t}`}function U3e(e,t){const n=he(e),r=he(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${e} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UY(){return"segment ids must be >= 0"}function W3e(){return"segment ids are not increasing"}function V3e(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function j3e(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H3e(e,t){let n=!1,r;for(e<=rne?(r=e,n=!0):r=v5(e,Math.floor(Math.sqrt(e)));!n;)r>t||r===e?n=!0:r=v5(e,r+1);return r}function q3e(e,t,n){const r=[],i=e.length;for(let s=0;s<i;s++)s!==t?r.push(e[s]):r.push(n);return r}function xne(e,t,n,r){const i=t.shape.length,s=e.shape.length;if(r!==0&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${s}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let f=0;f<r;++f)if(e.shape[f]!==t.shape[f])throw new Error(`x.shape[${f}]: ${e.shape[f]} should be equal to indices.shape[${f}]: ${t.shape[f]}.`);const a=e.shape[n],o=[];let l=1,u=1,c=1;for(let f=0;f<r;++f)o.push(e.shape[f]),l*=e.shape[f];for(let f=r;f<n;f++)o.push(e.shape[f]),u*=e.shape[f];for(let f=r;f<i;f++)o.push(t.shape[f]);for(let f=n+1;f<s;f++)o.push(e.shape[f]),c*=e.shape[f];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:a,outputShape:o}}const Cvt=Object.freeze(Object.defineProperty({__proto__:null,segOpComputeOptimalWindowSize:H3e,computeOutShape:q3e,collectGatherOpShapeInfo:xne},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fp(e){try{return e.map(t=>Ip(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function G3e(e){return e.map(t=>th(t))}const Y3e=Object.freeze(Object.defineProperty({__proto__:null,slice_util:$3e,segment_util:Cvt,fromUint8ToStringArray:Fp,fromStringArrayToUint8:G3e,upcastType:fo,axesAreInnerMostDims:mte,combineLocations:vTe,computeOutAndReduceShapes:Li,expandShapeToKeepDim:Zr,assertAxesAreInnerMostDims:vs,getAxesPermutation:Fr,getUndoAxesPermutation:Um,getInnerMostAxes:Jr,getBroadcastDims:Ry,getReductionAxes:ui,assertAndGetBroadcastShape:Ct,assertParamsConsistent:nne,computeOutShape:rh,computeDilation2DInfo:xN,computePool2DInfo:Hu,computePool3DInfo:tg,computeConv2DInfo:Pi,computeConv3DInfo:zm,computeDefaultPad:cte,tupleValuesAreOne:z0,eitherStridesOrDilationsAreOne:ms,stridesOrDilationsArePositive:Oy,convertConv2DDataFormat:ng,checkPadOnDimRoundingMode:Oa,getFusedDyActivation:r7,getFusedBiasGradient:i7,applyActivation:s7,shouldFuse:a7,get RowPartitionType(){return vc},combineRaggedTensorToTensorShapes:_3e,getRowPartitionTypesHelper:S3e,getRaggedRank:k3e,validateDefaultValueShape:E3e,PARALLELIZE_THRESHOLD:rne,computeOptimalWindowSize:d7,getImageCenter:ine,getReshaped:EN,getPermuted:AN,getReshapedPermuted:TN,getSliceBeginCoords:sne,getSliceSize:ane,prepareAndValidate:f7,validateUpdateShape:Rte,validateInput:t7,calculateShapes:jm,SELU_SCALEALPHA:p7,SELU_SCALE:g7,ERF_P:one,ERF_A1:lne,ERF_A2:une,ERF_A3:cne,ERF_A4:fne,ERF_A5:hne,warn:kl,log:Nut,mergeRealAndImagArrays:Mp,splitRealAndImagArrays:A3e,complexWithEvenIndex:T3e,complexWithOddIndex:D3e,getComplexWithIndex:dne,assignToTypedArray:I3e,exponents:N3e,exponent:M3e,decodeEinsumEquation:pne,getEinsumPermutation:gne,checkEinsumDimSizes:mne,getEinsumComputePath:vne,isIdentityPermutation:yne,prepareSplitSize:bne,getSparseFillEmptyRowsIndicesDenseShapeMismatch:F3e,getSparseFillEmptyRowsNegativeIndexErrorMessage:O3e,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:R3e,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:P3e,getSparseReshapeNegativeOutputDimErrorMessage:L3e,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:B3e,getSparseReshapeInputOutputMultipleErrorMessage:z3e,getSparseReshapeInputOutputMismatchErrorMessage:U3e,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:UY,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:W3e,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:V3e,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:j3e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _vt=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:o7,nonMaxSuppressionV4Impl:l7,nonMaxSuppressionV5Impl:u7,whereImpl:n7},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pmt();const Svt=Object.freeze(Object.defineProperty({__proto__:null,AdadeltaOptimizer:Wte,AdagradOptimizer:Vte,AdamOptimizer:jte,AdamaxOptimizer:Hte,MomentumOptimizer:qte,Optimizer:sg,OptimizerConstructors:C3e,RMSPropOptimizer:Gte,SGDOptimizer:c7,Tensor:On,TensorBuffer:oi,Variable:dT,get Rank(){return CY},sumOutType:Rz,upcastType:fo,get Reduction(){return da},customGrad:Nh,grad:tdt,grads:ndt,valueAndGrad:rdt,valueAndGrads:idt,variableGrads:STe,Environment:uAe,env:le,get ENV(){return Qee},nextFrame:tne,KernelBackend:k8,DataStorage:Gee,abs:hi,acos:HAe,acosh:qAe,add:ke,addN:cft,all:ute,any:S5,argMax:Fw,argMin:GAe,asin:YAe,asinh:XAe,atan:KAe,atan2:ZAe,atanh:QAe,avgPool:Pz,avgPool3d:JAe,basicLSTMCell:Mft,batchToSpaceND:Lz,batchNorm:wN,batchNorm2d:eTe,batchNorm3d:tTe,batchNorm4d:nTe,bincount:rTe,bitwiseAnd:Wft,broadcastArgs:jft,broadcastTo:X2,buffer:Mt,cast:Oe,ceil:iTe,clipByValue:sl,clone:d0,complex:B0,concat:Di,concat1d:sTe,concat2d:aTe,concat3d:oTe,concat4d:lTe,conv1d:fte,conv2d:U0,conv2dTranspose:dte,conv3d:uTe,conv3dTranspose:fTe,cos:Bz,cosh:pte,cumprod:k5,cumsum:gte,denseBincount:OY,depthToSpace:hTe,depthwiseConv2d:$N,diag:dht,dilation2d:dTe,div:Qe,divNoNan:pTe,dot:gTe,einsum:$ht,elu:CN,ensureShape:Sht,equal:Xc,erf:mTe,euclideanNorm:bTe,exp:Wl,expandDims:Ha,expm1:xTe,eye:vte,fill:$_,floor:SN,floorDiv:lte,gather:kN,greater:yl,greaterEqual:Wm,imag:zz,isFinite:wTe,isInf:$Te,isNaN:CTe,leakyRelu:Uz,less:yT,lessEqual:Vb,linspace:Zht,localResponseNormalization:_Te,log:Vl,log1p:Wz,logSigmoid:kTe,logSoftmax:yte,logSumExp:bte,logicalAnd:Mh,logicalNot:jz,logicalOr:xte,logicalXor:ETe,lowerBound:mdt,matMul:Pt,max:Au,maxPool:Hz,maxPool3d:ATe,maxPoolWithArgmax:xdt,maximum:rg,mean:Lr,meshgrid:Cdt,min:vT,minimum:Py,mirrorPad:TTe,mod:DTe,moments:qz,mul:ne,multiRNNCell:Tdt,multinomial:Idt,neg:ur,notEqual:Rw,oneHot:bT,ones:Dl,onesLike:jl,outerProduct:Rdt,pad:Vm,pad1d:Bdt,pad2d:Udt,pad3d:Vdt,pad4d:Hdt,pool:ITe,pow:W0,prelu:Yz,print:VAe,prod:NTe,raggedGather:Jdt,raggedRange:tpt,raggedTensorToTensor:rpt,rand:spt,randomGamma:Apt,randomNormal:Ste,randomStandardNormal:Ipt,randomUniform:Hb,randomUniformInt:Fpt,range:Pw,real:xT,reciprocal:WTe,relu:id,relu6:kte,reshape:ie,reverse:Fu,reverse1d:Upt,reverse2d:Vpt,reverse3d:Hpt,reverse4d:Gpt,round:Ete,rsqrt:Ate,scalar:xt,selu:Tte,separableConv2d:Dte,setdiff1dAsync:Jpt,sigmoid:nh,sign:VTe,sin:Ite,sinh:Nte,slice:rn,slice1d:Kz,slice2d:Mte,slice3d:Zz,slice4d:wT,softmax:Qz,softplus:C_,spaceToBatchND:Gz,fft:Jz,ifft:$T,irfft:Fte,rfft:e7,split:Jo,sqrt:Hs,square:Gn,squaredDifference:Ote,squeeze:qb,stack:Np,step:__,stridedSlice:jTe,sub:We,sum:qe,tan:HTe,tanh:Ow,tensor:vp,tensor1d:ro,tensor2d:rA,tensor3d:qTe,tensor4d:bgt,tensor5d:xgt,tensor6d:wgt,tensorScatterUpdate:_gt,tile:pu,topk:GTe,truncatedNormal:Pte,unique:YTe,unsortedSegmentSum:Lte,unstack:V0,upperBound:Dgt,variable:XTe,where:Ws,whereAsync:KTe,zeros:di,zerosLike:en,op:ee,OP_SCOPE_SUFFIX:TAe,booleanMaskAsync:Mgt,transpose:Kt,norm:_N,movingAverage:Rgt,scatterND:Lgt,searchSorted:wte,sparseToDense:Ugt,gatherND:Vgt,dropout:ZTe,enclosingPowerOfTwo:QTe,cosineWindow:Bte,inTopKAsync:Ggt,image:Zf,linalg:a3e,losses:Dmt,spectral:Amt,fused:t0t,signal:Tmt,sparse:Imt,string:Nmt,train:Gv,enableProdMode:Wct,enableDebugMode:Vct,disableDeprecationWarnings:jct,deprecationWarn:Hct,disposeVariables:qct,engine:fc,memory:_5,profile:Gct,tidy:ce,dispose:Bt,keep:zc,time:Yct,setBackend:Xct,ready:Kct,getBackend:Zct,removeBackend:Qct,findBackend:Jct,findBackendFactory:eft,registerBackend:ote,backend:jAe,setPlatform:tft,getKernel:hT,getGradient:bY,getKernelsForBackend:w5,registerKernel:Oz,registerGradient:dAe,unregisterKernel:Mut,unregisterGradient:Fut,copyRegisteredKernels:Out,Abs:gI,Acos:EC,Acosh:AC,Add:Ub,AddN:mI,All:D8,Any:I8,ArgMax:vI,ArgMin:yI,Asin:TC,Asinh:DC,Atan:IC,Atanh:NC,Atan2:MC,AvgPool:bI,AvgPoolGrad:N8,AvgPool3D:xI,AvgPool3DGrad:M8,BatchMatMul:wI,BatchToSpaceND:$I,Bincount:F8,BitwiseAnd:CI,BroadcastTo:fAe,BroadcastArgs:O8,Cast:FC,Ceil:OC,ClipByValue:RC,Complex:R8,ComplexAbs:_I,Concat:SI,Conv2D:kI,Conv2DBackpropFilter:P8,Conv2DBackpropInput:EI,Conv3D:AI,Conv3DBackpropFilterV2:L8,Conv3DBackpropInputV2:B8,Cos:PC,Cosh:LC,Cumprod:z8,Cumsum:TI,CropAndResize:U8,DenseBincount:W8,DepthToSpace:V8,DepthwiseConv2dNative:DI,DepthwiseConv2dNativeBackpropFilter:j8,DepthwiseConv2dNativeBackpropInput:H8,Diag:q8,Dilation2D:II,Dilation2DBackpropInput:y5,Dilation2DBackpropFilter:b5,Draw:G8,RealDiv:BC,Einsum:Y8,Elu:zC,EluGrad:X8,Erf:UC,Equal:NI,Exp:WC,ExpandDims:MI,Expm1:VC,FFT:K8,Fill:Z8,FlipLeftRight:Q8,Floor:jC,FloorDiv:HC,FusedBatchNorm:FI,GatherV2:OI,GatherNd:J8,Greater:RI,GreaterEqual:qC,Identity:GC,IFFT:ez,Imag:tz,IsFinite:YC,IsInf:XC,IsNan:KC,LeakyRelu:PI,Less:LI,LessEqual:BI,LinSpace:nz,Log:ZC,Log1p:QC,LogicalAnd:zI,LogicalNot:UI,LogicalOr:WI,LogicalXor:Eut,LogSoftmax:hAe,LowerBound:Aut,LRN:VI,LRNGrad:rz,MatrixBandPart:Tut,Max:jI,Maximum:JC,MaxPool:HI,MaxPoolGrad:iz,MaxPool3D:qI,MaxPool3DGrad:sz,MaxPoolWithArgmax:az,Mean:GI,Min:YI,Minimum:e_,MirrorPad:XI,Mod:t_,Multinomial:oz,Multiply:n_,Neg:KI,NotEqual:ZI,NonMaxSuppressionV3:lz,NonMaxSuppressionV4:uz,NonMaxSuppressionV5:cz,OnesLike:QI,OneHot:JI,Pack:eN,PadV2:tN,Pool:Dut,Pow:r_,Prelu:nN,Prod:rN,RaggedGather:fz,RaggedRange:hz,RaggedTensorToTensor:dz,Range:pz,Real:gz,Reciprocal:i_,Relu:s_,Reshape:iN,ResizeNearestNeighbor:sN,ResizeNearestNeighborGrad:mz,ResizeBilinear:aN,ResizeBilinearGrad:vz,Relu6:a_,Reverse:oN,Round:o_,Rsqrt:l_,ScatterNd:yz,TensorScatterUpdate:bz,SearchSorted:xz,Select:lN,Selu:u_,Slice:uN,Sin:c_,Sinh:f_,Sign:h_,Sigmoid:d_,Softplus:p_,Sqrt:g_,Sum:cN,SpaceToBatchND:fN,SplitV:hN,Softmax:dN,SparseFillEmptyRows:wz,SparseReshape:$z,SparseSegmentMean:Cz,SparseSegmentSum:_z,SparseToDense:Sz,SquaredDifference:m_,Square:kz,StaticRegexReplace:pN,StridedSlice:Ez,StringNGrams:Az,StringSplit:Tz,StringToHashBucketFast:Dz,Sub:v_,Tan:y_,Tanh:b_,Tile:x_,TopK:Iz,Transform:Nz,Transpose:K1,Unique:Mz,Unpack:gN,UnsortedSegmentSum:mN,UpperBound:Iut,ZerosLike:vN,Step:w_,FromPixels:x5,RotateWithOffset:Fz,_FusedMatMul:lT,FusedConv2D:uT,FusedDepthwiseConv2D:cT,version_core:bvt,browser:dvt,io:evt,math:rvt,serialization:Omt,test_util:_pt,util:jut,backend_util:Y3e,broadcast_util:ght,tensor_util:rct,slice_util:$3e,gather_util:pvt,scatter_util:$gt,device_util:lct,kernel_impls:_vt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X3e={kernelName:gI,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,__(Oe(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kvt={kernelName:EC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=Gn(Oe(n,"float32")),i=Hs(We(xt(1),r));return ur(Qe(e,i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Evt={kernelName:AC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=Hs(We(Gn(Oe(n,"float32")),1));return Qe(e,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Avt={kernelName:Ub,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{let o=e;const l=ui(n.shape,i);return l.length>0&&(o=qe(o,l)),ie(o,n.shape)},b:()=>{let o=e;const l=ui(r.shape,i);return l.length>0&&(o=qe(o,l)),ie(o,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tvt={kernelName:mI,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach((r,i)=>{n[i]=()=>e.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dvt={kernelName:vI,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>en(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ivt={kernelName:yI,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>en(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nvt={kernelName:TC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,Hs(We(xt(1),Gn(Oe(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mvt={kernelName:DC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=Hs(ke(xt(1),Gn(Oe(n,"float32"))));return Qe(e,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fvt={kernelName:MC,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{const o=ke(Gn(n),Gn(r));let l=ne(e,Qe(r,o));const u=ui(n.shape,i);return u.length>0&&(l=qe(l,u)),ie(l,n.shape)},b:()=>{const o=ke(Gn(n),Gn(r));let l=ur(ne(e,Qe(n,o)));const u=ui(r.shape,i);return u.length>0&&(l=qe(l,u)),ie(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ovt={kernelName:IC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,ke(Gn(Oe(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rvt={kernelName:NC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,We(xt(1),Gn(Oe(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pvt(e,t,n,r,i,s){const a=U(e,"dy","avgPool3dGrad"),o=U(t,"input","avgPool3dGrad");let l=a,u=o,c=!1;o.rank===4&&(c=!0,l=ie(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),u=ie(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),B(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),B(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),Oa("avgPool3dGrad",i,s);const f={dy:l,input:u},h={filterSize:n,strides:r,pad:i,dimRoundingMode:s},d=Q.runKernel(M8,f,h);return c?ie(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Lvt=ee({avgPool3dGrad_:Pvt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bvt={kernelName:xI,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:s,pad:a,dimRoundingMode:o}=n;return{x:()=>Lvt(e,r,i,s,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zvt(e,t,n,r,i){const s=U(e,"dy","avgPoolGrad"),a=U(t,"input","avgPoolGrad");B(a.rank===s.rank,()=>`Rank of input (${a.rank}) does not match rank of dy (${s.rank})`);let o=a,l=s,u=!1;a.rank===3&&(u=!0,o=ie(a,[1,a.shape[0],a.shape[1],a.shape[2]]),l=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]])),B(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),B(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const c={dy:l,input:o},f={filterSize:n,strides:r,pad:i},h=Q.runKernel(N8,c,f);return u?ie(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Uvt=ee({avgPoolGrad_:zvt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wvt={kernelName:bI,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:s,pad:a}=n;return{x:()=>Uvt(e,r,i,s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vvt={kernelName:wI,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[r,i]=t,{transposeA:s,transposeB:a}=n;return!s&&!a?{a:()=>Pt(e,i,!1,!0),b:()=>Pt(r,e,!0,!1)}:!s&&a?{a:()=>Pt(e,i,!1,!1),b:()=>Pt(e,r,!0,!1)}:s&&!a?{a:()=>Pt(i,e,!1,!0),b:()=>Pt(r,e,!1,!1)}:{a:()=>Pt(i,e,!0,!0),b:()=>Pt(e,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jvt={kernelName:$I,gradFunc:(e,t,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>Gz(e,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hvt={kernelName:fAe,gradFunc:(e,t,n)=>{const r=n,i=r.inputShape,s=r.shape,a=Array.from(s);for(let l=i.length-1;l>=0;l--)if(i[l]===s[l])a[l]=1;else if(i[l]!==1)throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${s}].`);const o=[];for(let l=0;l<a.length;l++)a[l]>1&&o.push(l);return{x:()=>qe(e,o,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qvt={kernelName:FC,gradFunc:e=>({x:()=>e.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gvt={kernelName:OC,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yvt={kernelName:RC,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{clipValueMin:i,clipValueMax:s}=n;return{x:()=>Ws(Mh(Wm(r,i),Vb(r,s)),e,en(e))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xvt={kernelName:_I,inputsToSave:["x"],gradFunc:X3e.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kvt={kernelName:SI,saveAllInputs:!0,gradFunc:(e,t,n)=>{const r=t.map(l=>l.shape),{axis:i}=n,s=Ot(i,t[0].shape)[0],a=r.map(l=>l[s]);return Jo(e,a,s).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zvt={kernelName:kI,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{dilations:s,strides:a,pad:o,dataFormat:l}=n;return B(z0(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>hte(r.shape,e,i,a,o,l),filter:()=>zte(r,e,i.shape,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qvt={kernelName:EI,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{strides:s,pad:a,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>U0(e,i,s,a,o,1,l),filter:()=>zte(e,r,i.shape,s,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jvt(e,t,n,r,i){let s=e;e.rank===4&&(s=ie(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let a=t;a.rank===4&&(a=ie(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),B(s.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),B(a.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${a.shape}.`),B(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),B(s.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${n[3]}.`),B(a.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${a.shape[4]}) must match output depth for filter (${n[4]}).`);const o={x:s,dy:a},l={strides:r,pad:i,filterShape:n};return Q.runKernel(L8,o,l)}const e1t=ee({conv3DBackpropFilter_:Jvt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t1t={kernelName:AI,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:s}=n;B(z0(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[a,o]=t;return{x:()=>cTe(a.shape,e,o,i,s),filter:()=>e1t(a,e,o.shape,i,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n1t={kernelName:PC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(ur(Ite(Oe(n,"float32"))),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r1t={kernelName:LC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(Nte(Oe(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i1t={kernelName:TI,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i,exclusive:s,reverse:a}=n;return{x:()=>{const o=Fr([i],r.rank);let l=gte(e,i,s,!a);return o!=null&&(l=Kt(l,o)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s1t={kernelName:DI,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:s,dimRoundingMode:a}=n,o=r==null?[1,1]:r;B(z0(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,u]=t;return B(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),B(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),B(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),B(ms(i,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${o}'.`),Oa("depthwiseConv2d",s,a),{x:()=>t3e(l.shape,e,u,i,s,o,a),filter:()=>e3e(l,e,u.shape,i,s,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a1t={kernelName:II,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,s={x:r,filter:i,dy:e},a={x:r,filter:i,dy:e};return{x:()=>Q.runKernel(y5,s,n),filter:()=>Q.runKernel(b5,a,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o1t={kernelName:zC,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,r={dy:e,y:n};return{x:()=>Q.runKernel(X8,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l1t={kernelName:UC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=ne(Wl(ur(Gn(n))),2/Math.sqrt(Math.PI));return{x:()=>ne(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u1t={kernelName:WC,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c1t={kernelName:MI,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>ie(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f1t={kernelName:VC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,Wl(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h1t={kernelName:jC,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d1t={kernelName:HC,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{const o=Qe(e,Oe(r,"float32")),l=ui(n.shape,i);return l.length>0?ie(qe(o,l),n.shape):o},b:()=>{let o=ne(e,Oe(n,"float32"));const l=ui(r.shape,i);l.length>0&&(o=ie(qe(o,l),r.shape));const u=Gn(r);return ur(Qe(o,Oe(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p1t={kernelName:FI,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:r}=n,[i,s,a,o]=t,l=o==null?xt(1):o,u=ui(s.shape,i.shape),c=[];if(s.rank===1){for(let x=0;x<i.shape.length-1;++x)c.push(i.shape[x]);c.push(1)}const f=We(i,s),h=ne(e,l),d=Ate(ke(a,xt(r))),p=ne(ne(ne(d,d),d),xt(-.5));return{x:()=>s.rank===1?ie(ne(ne(e,pu(ie(d,[1,1,1,s.shape[0]]),c)),l),i.shape):ie(ne(ne(e,d),l),i.shape),mean:()=>{let x=ne(ne(d,xt(-1)),h);return s.rank===1&&(x=qe(x,u)),ie(x,s.shape)},variance:()=>{let x=ne(ne(p,f),h);return s.rank===1&&(x=qe(x,u)),ie(x,s.shape)},scale:()=>{const x=ne(f,d);let w=ne(e,x);return s.rank===1&&(w=qe(w,u)),ie(w,s.shape)},offset:()=>{let x=e;return s.rank===1&&(x=qe(x,u)),ie(x,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g1t={kernelName:OI,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[r,i]=t,{axis:s}=n,a=Ot(s,r.shape)[0];return{x:()=>{const l=r.shape,u=i.size,c=l.slice(0,a),f=c.length,h=l.slice(s,l.length).slice(1),d=h.length,p=bge(0,f),g=bge(f+1,f+1+d),m=xge([c,[u],h]),v=ie(e,m),y=ie(i,[u]),b=xge([[f],p,g]),x=Kt(v,b);let w=Lte(x,y,r.shape[a]);const C=Um(b);return w=Kt(w,C),w},indices:()=>i}}};function bge(e,t){const n=[];for(let r=e;r<t;++r)n.push(r);return n}function xge(e){const t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m1t={kernelName:qC,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>en(n),b:()=>en(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v1t={kernelName:GC,gradFunc:e=>({x:()=>Oe(e,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y1t={kernelName:YC,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b1t={kernelName:XC,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x1t={kernelName:KC,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w1t={kernelName:PI,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{alpha:i}=n,s=yl(r,0);return{x:()=>Ws(s,e,ne(e,i))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $1t={kernelName:QC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,ke(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C1t={kernelName:ZC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,Oe(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _1t={kernelName:hAe,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;return{logits:()=>{const a=Wl(r);return We(e,ne(qe(e,i,!0),a))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S1t(e,t,n,r=5,i=1,s=1,a=.5){const o={x:e,y:t,dy:n},l={depthRadius:r,bias:i,alpha:s,beta:a};return Q.runKernel(rz,o,l)}const k1t=ee({localResponseNormalizationBackprop_:S1t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E1t={kernelName:VI,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{depthRadius:s,bias:a,alpha:o,beta:l}=n;return{x:()=>k1t(r,i,e,s,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3e(e,t,n,r){return t.rank<n.rank&&(t=ie(t,Zr(t.shape,r))),e.rank<n.rank&&(e=ie(e,Zr(e.shape,r))),{x:()=>ne(e,Oe(Xc(n,t),e.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wge={kernelName:jI,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{reductionIndices:i}=r,s=t[0],a=t[1],o=Ot(i,s.shape),l=K3e(e,a,s,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A1t={kernelName:JC,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>ne(e,Oe(Wm(n,r),"float32")),b:()=>ne(e,Oe(yT(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1t(e,t,n,r,i,s,a){const o=U(e,"dy","maxPool3dGrad"),l=U(t,"input","maxPool3dGrad"),u=U(n,"output","maxPool3dGrad");let c=o,f=l,h=u,d=!1;l.rank===4&&(d=!0,c=ie(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),f=ie(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=ie(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),B(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),B(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),B(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),Oa("maxPool3dGrad",s,a);const p={dy:c,input:f,output:h},g={filterSize:r,strides:i,pad:s,dimRoundingMode:a},m=Q.runKernel(sz,p,g);return d?ie(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const D1t=ee({maxPool3dGrad_:T1t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I1t={kernelName:qI,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=n;return{x:()=>D1t(e,r,i,s,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N1t(e,t,n,r,i,s,a){const o=U(e,"dy","maxPoolGrad"),l=U(t,"input","maxPoolGrad"),u=U(n,"output","maxPoolGrad");B(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),B(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),B(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Oa("maxPoolGrad",s,a);const c={dy:o,input:l,output:u},f={filterSize:r,strides:i,pad:s,dimRoundingMode:a};return Q.runKernel(iz,c,f)}const M1t=ee({maxPoolGrad_:N1t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F1t={kernelName:HI,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:s,strides:a,pad:o}=n;return{x:()=>M1t(e,r,i,s,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O1t={kernelName:GI,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n,s=Ot(i,r.shape),o=Li(r.shape,s)[1],l=he(o);return{x:()=>{const c=r.shape.slice();s.forEach(d=>{c[d]=1});const f=ie(e,c);return Qe(ne(f,Dl(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R1t={kernelName:YI,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{axis:i}=r,[s,a]=t,o=Ot(i,s.shape),l=K3e(e,a,s,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P1t={kernelName:e_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>ne(e,Oe(Vb(n,r),"float32")),b:()=>ne(e,Oe(yl(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L1t={kernelName:XI,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,s=i.map(a=>a[0]);return{x:()=>rn(e,s,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B1t={kernelName:t_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{const o=ui(n.shape,i);return o.length>0?ie(qe(e,o),n.shape):e},b:()=>{const o=ne(e,ur(SN(Qe(n,r)))),l=ui(r.shape,i);return l.length>0?ie(qe(o,l),r.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z1t={kernelName:n_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{const o=ne(e,Oe(r,"float32")),l=ui(n.shape,i);return l.length>0?ie(qe(o,l),n.shape):o},b:()=>{const o=ne(e,Oe(n,"float32")),l=ui(r.shape,i);return l.length>0?ie(qe(o,l),r.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U1t={kernelName:KI,gradFunc:e=>({x:()=>ur(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W1t={kernelName:JI,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>di(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V1t={kernelName:QI,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j1t={kernelName:eN,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:r}=n;return V0(e,r).map(s=>()=>s)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ge={kernelName:tN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,s=i.map(a=>a[0]);return{x:()=>rn(e,s,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H1t={kernelName:r_,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,r,i]=t,s=n,a=r,o=Ct(s.shape,a.shape);return{a:()=>{const c=Oe(a,"float32");let f=ne(e,ne(c,W0(s,We(c,xt(1)))));const h=ui(s.shape,o);return h.length>0&&(f=qe(f,h)),ie(f,s.shape)},b:()=>{const c=yl(s,0),f=Ws(c,Vl(s),en(s));let h=ne(e,ne(i,f));const d=ui(a.shape,o);return d.length>0&&(h=qe(h,d)),ie(h,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q1t={kernelName:nN,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,r]=t,i=yl(n,0);return{x:()=>Ws(i,e,ne(e,r)),alpha:()=>{let s=Ws(i,en(e),ne(e,n));const a=ui(r.shape,e.shape);return a.length>0&&(s=qe(s,a)),ie(s,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G1t(e,t,n){const r=e.shape.slice();r[n]=1;const i=ie(t,r),s=k5(e,n,!0,!1),a=k5(e,n,!0,!0),o=ne(s,a);return ne(i,o)}function Y1t(e,t,n){const r=e.shape.length,i=r-n.length,s=Fr(n,r);let a=e;s!=null&&(a=Kt(e,s));const o=a.shape.slice(),u=o.splice(r-n.length,n.length).reduce((h,d)=>h*d,1);o.push(u);const c=a.reshape(o);let f=G1t(c,t,i);if(f=f.reshape(a.shape),s!=null){const h=Um(s);f=Kt(f,h)}return f}const X1t={kernelName:rN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;let s=[];return i==null?s=r.shape.map((a,o)=>o):typeof i=="number"?s=[i]:s=i,{x:()=>Y1t(r,e,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K1t={kernelName:BC,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{const o=Qe(e,Oe(r,"float32")),l=ui(n.shape,i);return l.length>0?ie(qe(o,l),n.shape):o},b:()=>{let o=ne(e,Oe(n,"float32"));const l=ui(r.shape,i);l.length>0&&(o=ie(qe(o,l),r.shape));const u=Gn(r);return ur(Qe(o,Oe(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z1t={kernelName:i_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,ur(Gn(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q1t={kernelName:a_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=ne(Vb(n,6),__(n));return{x:()=>ne(e,Oe(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J1t={kernelName:s_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,Oe(__(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eyt={kernelName:iN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ie(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tyt={kernelName:aN,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>Q.runKernel(vz,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nyt={kernelName:sN,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>Q.runKernel(mz,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ryt={kernelName:oN,gradFunc:(e,t,n)=>{const{dims:r}=n,i=Ot(r,e.shape);return{x:()=>Fu(e,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iyt={kernelName:o_,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const syt={kernelName:l_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ur(Qe(e,ne(W0(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ayt={kernelName:lN,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>Oe(en(n),"float32"),t:()=>ne(e,Oe(n,e.dtype)),e:()=>ne(e,Oe(jz(n),e.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oyt={kernelName:u_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=yl(n,xt(0)),i=xt(p7),s=xt(g7),a=ne(e,s),o=ne(ne(e,i),Wl(Oe(n,"float32")));return Ws(r,a,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lyt={kernelName:d_,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,ne(n,We(xt(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uyt={kernelName:h_,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cyt={kernelName:c_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(Bz(Oe(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fyt={kernelName:f_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(pte(Oe(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hyt={kernelName:uN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{begin:i,size:s}=n,a=r.shape,[o,l]=h7(r,i,s),u=[];for(let c=0;c<e.rank;c++)u.push([o[c],a[c]-o[c]-l[c]]);return{x:()=>Vm(e,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dyt={kernelName:dN,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{dim:i}=n,s=!0,a=ne(e,r);return{logits:()=>We(a,ne(qe(a,[i],s),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pyt={kernelName:p_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,nh(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cge={kernelName:fN,gradFunc:(e,t,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>Lz(e,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ge={kernelName:hN,gradFunc:(e,t,n)=>{const{axis:r}=n;return{x:()=>Di(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gyt={kernelName:g_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,ne(Hs(Oe(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const myt={kernelName:kz,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(e,ne(Oe(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vyt={kernelName:m_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=xt(2);return{a:()=>ne(e,ne(i,We(n,r))),b:()=>ne(e,ne(i,We(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yyt={kernelName:w_,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const byt={kernelName:v_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ct(n.shape,r.shape);return{a:()=>{let o=e;const l=ui(n.shape,i);return l.length>0&&(o=qe(o,l)),ie(o,n.shape)},b:()=>{let o=e;const l=ui(r.shape,i);return l.length>0&&(o=qe(o,l)),ie(ur(o),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xyt={kernelName:cN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,i=r.shape.slice(),{axis:s}=n;Ot(s,r.shape).forEach(u=>{i[u]=1});const o=ie(e,i),l=ne(o,Dl(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wyt={kernelName:y_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Qe(e,Gn(Bz(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $yt={kernelName:b_,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ne(We(xt(1),Gn(n)),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cyt={kernelName:x_,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{reps:i}=n;return{x:()=>{let a=en(r);if(r.rank===1)for(let o=0;o<i[0];++o)a=ke(a,rn(e,[o*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let o=0;o<i[0];++o)for(let l=0;l<i[1];++l)a=ke(a,rn(e,[o*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let o=0;o<i[0];++o)for(let l=0;l<i[1];++l)for(let u=0;u<i[2];++u)a=ke(a,rn(e,[o*r.shape[0],l*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let o=0;o<i[0];++o)for(let l=0;l<i[1];++l)for(let u=0;u<i[2];++u)for(let c=0;c<i[3];++c)a=ke(a,rn(e,[o*r.shape[0],l*r.shape[1],u*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _yt={kernelName:K1,gradFunc:(e,t,n)=>{const r=n,{perm:i}=r,s=Um(i);return{x:()=>Kt(e,s)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Syt={kernelName:gN,gradFunc:(e,t,n)=>{const r=n,{axis:i}=r;return{value:()=>Np(e,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kyt={kernelName:mN,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Eyt(e,n)}}};function Eyt(e,t){const n=rg(t,en(t)),r=kN(e,n);let i=Wm(t,xt(0,"int32"));const s=r.rank-i.rank;for(let o=0;o<s;++o)i=Ha(i,o+1);i=Mh(i,Dl(r.shape,"bool"));const a=en(r);return Ws(i,r,a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ayt={kernelName:vN,gradFunc:e=>({x:()=>en(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tyt=[X3e,kvt,Evt,Avt,Tvt,Dvt,Ivt,Nvt,Mvt,Fvt,Ovt,Rvt,Bvt,Wvt,Vvt,jvt,Hvt,qvt,Gvt,Yvt,Xvt,Kvt,Qvt,Zvt,t1t,n1t,r1t,i1t,s1t,a1t,K1t,o1t,l1t,u1t,c1t,f1t,d1t,h1t,p1t,g1t,m1t,v1t,y1t,b1t,x1t,w1t,$1t,C1t,_1t,E1t,wge,wge,A1t,I1t,F1t,O1t,R1t,P1t,L1t,B1t,z1t,U1t,W1t,V1t,j1t,$ge,$ge,H1t,q1t,X1t,Z1t,Q1t,J1t,eyt,tyt,nyt,ryt,iyt,syt,ayt,oyt,lyt,uyt,cyt,fyt,hyt,dyt,pyt,Cge,Cge,_ge,_ge,gyt,vyt,myt,yyt,byt,xyt,wyt,$yt,Cyt,_yt,Syt,kyt,Ayt];for(const e of Tyt)dAe(e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.abs=function(){return this.throwIfDisposed(),hi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.acos=function(){return this.throwIfDisposed(),HAe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.acosh=function(){return this.throwIfDisposed(),qAe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.add=function(e){return this.throwIfDisposed(),ke(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.all=function(e,t){return this.throwIfDisposed(),ute(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.any=function(e,t){return this.throwIfDisposed(),S5(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.argMax=function(e){return this.throwIfDisposed(),Fw(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.argMin=function(e){return this.throwIfDisposed(),GAe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.asScalar=function(){return this.throwIfDisposed(),B(this.size===1,()=>"The array must have only 1 element."),ie(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.asType=function(e){return this.throwIfDisposed(),Oe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.as1D=function(){return this.throwIfDisposed(),ie(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.as2D=function(e,t){return this.throwIfDisposed(),ie(this,[e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),ie(this,[e,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),ie(this,[e,t,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.as5D=function(e,t,n,r,i){return this.throwIfDisposed(),ie(this,[e,t,n,r,i])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.asin=function(){return this.throwIfDisposed(),YAe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.asinh=function(){return this.throwIfDisposed(),XAe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.atan=function(){return this.throwIfDisposed(),KAe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.atan2=function(e){return this.throwIfDisposed(),ZAe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.atanh=function(){return this.throwIfDisposed(),QAe(this)};ge().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),Pz(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Lz(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.batchNorm=function(e,t,n,r,i){return this.throwIfDisposed(),wN(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.broadcastTo=function(e){return this.throwIfDisposed(),X2(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.cast=function(e){return this.throwIfDisposed(),Oe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.ceil=function(){return this.throwIfDisposed(),iTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),sl(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof On&&(e=[e]),Di([this,...e],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.conv1d=function(e,t,n,r,i,s){return this.throwIfDisposed(),fte(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.conv2dTranspose=function(e,t,n,r,i){return this.throwIfDisposed(),dte(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.conv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),U0(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.cos=function(){return this.throwIfDisposed(),Bz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.cosh=function(){return this.throwIfDisposed(),pte(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),k5(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),gte(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),hTe(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.depthwiseConv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),$N(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.dilation2d=function(e,t,n,r,i){return this.throwIfDisposed(),dTe(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.divNoNan=function(e){return this.throwIfDisposed(),pTe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.div=function(e){return this.throwIfDisposed(),Qe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.dot=function(e){return this.throwIfDisposed(),gTe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.elu=function(){return this.throwIfDisposed(),CN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.equal=function(e){return this.throwIfDisposed(),Xc(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.erf=function(){return this.throwIfDisposed(),mTe(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),bTe(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.exp=function(){return this.throwIfDisposed(),Wl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.expandDims=function(e){return this.throwIfDisposed(),Ha(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.expm1=function(){return this.throwIfDisposed(),xTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.fft=function(){return this.throwIfDisposed(),Jz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.flatten=function(){return this.throwIfDisposed(),ie(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.floor=function(){return this.throwIfDisposed(),SN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.floorDiv=function(e){return this.throwIfDisposed(),lte(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.gather=function(e,t,n){return this.throwIfDisposed(),kN(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.greaterEqual=function(e){return this.throwIfDisposed(),Wm(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.greater=function(e){return this.throwIfDisposed(),yl(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.ifft=function(){return this.throwIfDisposed(),$T(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.irfft=function(){return this.throwIfDisposed(),Fte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.isFinite=function(){return this.throwIfDisposed(),wTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.isInf=function(){return this.throwIfDisposed(),$Te(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.isNaN=function(){return this.throwIfDisposed(),CTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.leakyRelu=function(e){return this.throwIfDisposed(),Uz(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.lessEqual=function(e){return this.throwIfDisposed(),Vb(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.less=function(e){return this.throwIfDisposed(),yT(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),_Te(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logSigmoid=function(){return this.throwIfDisposed(),kTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logSoftmax=function(e){return this.throwIfDisposed(),yte(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),bte(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.log=function(){return this.throwIfDisposed(),Vl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.log1p=function(){return this.throwIfDisposed(),Wz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logicalAnd=function(e){return this.throwIfDisposed(),Mh(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logicalNot=function(){return this.throwIfDisposed(),jz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logicalOr=function(e){return this.throwIfDisposed(),xte(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.logicalXor=function(e){return this.throwIfDisposed(),ETe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Pt(this,e,t,n)};ge().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Hz(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.max=function(e,t){return this.throwIfDisposed(),Au(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.maximum=function(e){return this.throwIfDisposed(),rg(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.mean=function(e,t){return this.throwIfDisposed(),Lr(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.min=function(e,t){return this.throwIfDisposed(),vT(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.minimum=function(e){return this.throwIfDisposed(),Py(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),TTe(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.mod=function(e){return this.throwIfDisposed(),DTe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.mul=function(e){return this.throwIfDisposed(),ne(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.neg=function(){return this.throwIfDisposed(),ur(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.norm=function(e,t,n){return this.throwIfDisposed(),_N(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.notEqual=function(e){return this.throwIfDisposed(),Rw(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),bT(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.onesLike=function(){return this.throwIfDisposed(),jl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.pad=function(e,t){return this.throwIfDisposed(),Vm(this,e,t)};ge().prototype.pool=function(e,t,n,r,i,s){return this.throwIfDisposed(),ITe(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.pow=function(e){return this.throwIfDisposed(),W0(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.prelu=function(e){return this.throwIfDisposed(),Yz(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.prod=function(e,t){return this.throwIfDisposed(),NTe(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.reciprocal=function(){return this.throwIfDisposed(),WTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.relu=function(){return this.throwIfDisposed(),id(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.relu6=function(){return this.throwIfDisposed(),kte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.reshapeAs=function(e){return this.throwIfDisposed(),ie(this,e.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.reshape=function(e){return this.throwIfDisposed(),ie(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),i3e(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),s3e(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.reverse=function(e){return this.throwIfDisposed(),Fu(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.rfft=function(){return this.throwIfDisposed(),e7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.round=function(){return this.throwIfDisposed(),Ete(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.rsqrt=function(){return this.throwIfDisposed(),Ate(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.selu=function(){return this.throwIfDisposed(),Tte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.separableConv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),Dte(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sigmoid=function(){return this.throwIfDisposed(),nh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sign=function(){return this.throwIfDisposed(),VTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sin=function(){return this.throwIfDisposed(),Ite(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sinh=function(){return this.throwIfDisposed(),Nte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.slice=function(e,t){return this.throwIfDisposed(),rn(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.softmax=function(e){return this.throwIfDisposed(),Qz(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.softplus=function(){return this.throwIfDisposed(),C_(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Gz(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.split=function(e,t){return this.throwIfDisposed(),Jo(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sqrt=function(){return this.throwIfDisposed(),Hs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.square=function(){return this.throwIfDisposed(),Gn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.squaredDifference=function(e){return this.throwIfDisposed(),Ote(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.squeeze=function(e){return this.throwIfDisposed(),qb(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof On?[this,e]:[this,...e];return Np(n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.step=function(e){return this.throwIfDisposed(),__(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.stridedSlice=function(e,t,n,r,i,s,a,o){return this.throwIfDisposed(),jTe(this,e,t,n,r,i,s,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sub=function(e){return this.throwIfDisposed(),We(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.sum=function(e,t){return this.throwIfDisposed(),qe(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.tan=function(){return this.throwIfDisposed(),HTe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.tanh=function(){return this.throwIfDisposed(),Ow(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.tile=function(e){return this.throwIfDisposed(),pu(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.toBool=function(){return this.throwIfDisposed(),Oe(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.toFloat=function(){return this.throwIfDisposed(),Oe(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.toInt=function(){return this.throwIfDisposed(),Oe(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.topk=function(e,t){return this.throwIfDisposed(),GTe(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.transpose=function(e){return this.throwIfDisposed(),Kt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.unique=function(e){return this.throwIfDisposed(),YTe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Lte(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.unstack=function(e){return this.throwIfDisposed(),V0(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.where=function(e,t){return this.throwIfDisposed(),Ws(e,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ge().prototype.zerosLike=function(){return this.throwIfDisposed(),en(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Mf extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Mf.prototype)}}class gu extends Error{constructor(t){super(t),Object.setPrototypeOf(this,gu.prototype)}}class re extends Error{constructor(t){super(t),Object.setPrototypeOf(this,re.prototype)}}class Tt extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Tt.prototype)}}class wne extends Error{constructor(t){super(t),Object.setPrototypeOf(this,wne.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Z3e{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let n;return this.cache.has(t)&&(n=this.cache.get(t),this.cache.delete(t),this.cache.set(t,n)),n}put(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(t,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let n=0;n<this.maxEntries-t;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function By(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}else{const n=new Array(t);return n.fill(e),n}}function Ff(e,t){if(!e)throw new wne(t)}function Sge(e,t){let n=0;for(const r of e)r===t&&n++;return n}function qa(e){return e.length===1?e[0]:e}function sr(e){return Array.isArray(e)?e:[e]}function Bd(e){const n=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function i1(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}let nu={};function $ne(e){if(e==null)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function WY(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>WY(t));else{const t=Object.keys(e);for(const n of t){const r=e[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?e[n]=r.value:WY(r))}}}function DN(e,t={},n={},r="object",i=!1){if(typeof e=="string"){const s=e;let a;if(s in n)a=n[s];else if(s in nu)a=nu[s];else if(a=t[s],a==null)throw new re(`Unknown ${r}: ${e}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}else{const s=e;if(s.className==null||s.config==null)throw new re(`${r}: Improper config format: ${JSON.stringify(s)}.
'className' and 'config' must set.`);const a=s.className;let o,l;if(a in n?[o,l]=n[a]:a in nu?[o,l]=nu.className:a in t&&([o,l]=t[a]),o==null)throw new re(`Unknown ${r}: ${a}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const d of Object.keys(nu))u[d]=nu[d];for(const d of Object.keys(n))u[d]=n[d];const c=s.config;c.customObjects=u;const f=Object.assign({},nu);for(const d of Object.keys(n))nu[d]=n[d];WY(s.config);const h=l(o,s.config,n,i);return nu=Object.assign({},f),h}else{const u=Object.assign({},nu);for(const f of Object.keys(n))nu[f]=n[f];const c=new o(s.config);return nu=Object.assign({},u),c}}}function Dyt(e,t){return e<t?-1:e>t?1:0}function eO(e,t){return-1*Dyt(e,t)}function p0(e){if(e==null)return e;const t=[];for(const n of e)t.indexOf(n)===-1&&t.push(n);return t}function Iyt(e){if(e==null)throw new re(`Invalid value in obj: ${JSON.stringify(e)}`);for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function Yb(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new re(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function Cne(e,t,n=0,r=1/0){return Ff(n>=0),Ff(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(i=>typeof i===t)}function Ai(e,t){Array.isArray(e)?(B(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((n,r)=>Ai(n,`element ${r+1} of ${t}`))):B(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${Q3e(e)}.`)}function Q3e(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>Q3e(t)).join(",")+"]":typeof e=="string"?`"${e}"`:`${e}`}function Nyt(e,t,n){let r=n!=null?n():ua(),i;return(...a)=>{const o=n!=null?n():ua();return o-r<t||(r=o,i=e(...a)),i}}function J3e(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Myt=0;function eDe(){return Myt++}const tO={};function m7(e=""){return e in tO||(tO[e]=0),tO[e]+=1,e+tO[e].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Fyt=["channelsFirst","channelsLast"],Oyt=["nearest","bilinear"],Ryt=["valid","same","causal"],Pyt=["max","avg"],Lyt=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const e2=new Map;function ei(e){Yb(Fyt,"DataFormat",e)}function Byt(e){Yb(Oyt,"InterpolationFormat",e)}function Ql(e){Yb(Ryt,"PaddingMode",e)}function tDe(e){Yb(Pyt,"PoolMode",e)}const iA=[],kge="/";function Z1(e,t){iA.push(e);try{const n=t();return iA.pop(),n}catch(n){throw iA.pop(),n}}function zyt(){return iA.length===0?"":iA.join(kge)+kge}function nDe(e){if(!iDe(e))throw new Error("Not a valid tensor name: '"+e+"'");return zyt()+e}function rDe(e){if(!iDe(e))throw new Error("Not a valid tensor name: '"+e+"'");e2.has(e)||e2.set(e,0);const t=e2.get(e);if(e2.set(e,e2.get(e)+1),t>0){const n=`${e}_${t}`;return e2.set(n,1),n}else return e}const Uyt=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function iDe(e){return!!e.match(Uyt)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Wyt(e){return e===parseInt(e.toString(),10)}function g0(e,t,n){t==null&&(t=0),n==null&&(n=e.length);let r=1;for(let i=t;i<n;++i)r*=e[i];return r}function Lw(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r<t&&(t=r)}return t}function j0(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r>t&&(t=r)}return t}function Kc(e,t){if(t<e)throw new re(`end (${t}) < begin (${e}) is forbidden.`);const n=[];for(let r=e;r<t;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let uj;function pi(){return uj==null&&(uj=jAe().epsilon()),uj}function Zc(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ih(e,t){return Oe(e,t)}function IN(e,t=-1){const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),ie(e,n)}function Vyt(e,t){return ce(()=>{if(e.shape.length!==2)throw new re(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);const n=IN(e,1);return VY(n,[1,t,1])})}function jyt(e){const t=[g0(e.shape)];return ie(e,t)}function Hyt(e){if(e.rank<=1)throw new re(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);const t=[e.shape[0],g0(e.shape,1)];return ie(e,t)}function Q1(e,t,n){return ce(()=>{switch(e.rank){case 1:return Kz(e,t,n);case 2:return Mte(e,[t,0],[n,e.shape[1]]);case 3:return Zz(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return wT(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return rn(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return rn(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new re(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function cj(e,t,n){return ce(()=>{switch(e.rank){case 1:return Kz(e,t,n);case 2:return Mte(e,[0,t],[e.shape[0],n]);case 3:return Zz(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return wT(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new re(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function nO(e,t,n,r){return ce(()=>{switch(e.rank){case 1:return Kz(e,t,n);case 2:switch(r){case 1:return Q1(e,t,n);case 2:return cj(e,t,n);default:throw new re(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return Q1(e,t,n);case 2:return Zz(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return cj(e,t,n);default:throw new re(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return Q1(e,t,n);case 2:return wT(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return wT(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return cj(e,t,n);default:throw new re(`The axis is not within the rank of the tensor ${r}`)}default:throw new re(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function _ne(e,t=-1){let n;return t<0&&(n=e[0].rank,n!==0?t=n:t=0),t===e[0].rank&&(t=-1),Di(e,t)}function Ege(e,t){switch(e.rank){case 1:return sTe([e,t]);case 2:return aTe([e,t],0);case 3:return oTe([e,t],0);case 4:return lTe([e,t],0);default:throw new re(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function VY(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new re(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return pu(e,t)}function v7(e,t=0,n=1,r,i){return Ste(e,t,n,r,i)}function sh(e,t,n,r){if(e.rank<2||t.rank<2)throw new Tt(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){const i=e.shape.slice(-1)[0],s=t.shape.slice(-2)[0];if(i!==s)throw new Tt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return PY({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?jY(e.rank,r,Zc()):null,activation:n});{const i=e.shape.slice(),s=i.pop();e=ie(e,[-1,s]);const a=t.shape.slice(),o=a.pop(),l=a.pop(),u=[...a,o],c=Array.from({length:t.rank},(p,g)=>g===0?t.rank-2:g<=t.rank-2?g-1:g);t=ie(Kt(t,c),[l,-1]);const f=[...i,...u];return ie(PY({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?jY(e.rank,r,Zc()):null,activation:n}),f)}}function sDe(e,t,n){return ce(()=>(Array.isArray(t)?t=ro(t,"int32"):t=Oe(t,"int32"),kN(e,t,n)))}function NN(e){return ne(e,e)}function jY(e,t,n){const r=t.shape;if(t.rank!==1&&t.rank!==e)throw new re(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(n==="channelsFirst")return r.length===1?ie(t,[1,r[0],1,1,1]):ie(t,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?ie(t,[1,1,1,1,r[0]]):ie(t,[1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?ie(t,[1,r[0],1,1]):ie(t,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?ie(t,[1,1,1,r[0]]):ie(t,[1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?ie(t,[1,r[0],1]):ie(t,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?ie(t,[1,1,r[0]]):ie(t,[1].concat(r))}else if(e<3)return t;throw new re(`Unsupported input rank by biasAdd: ${t.rank}`)}function cf(e,t,n){return ce(()=>(n==null&&(n=Zc()),ei(n),ke(e,jY(e.rank,t,n))))}function qyt(e,t=1){if(t!==1)throw new Tt(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return CN(e)}function Gyt(e){return ce(()=>Qe(e,ke(hi(e),1)))}function aDe(e,t,n,r){return ce(()=>ZTe(e,t,n,r))}function Yyt(e){return ce(()=>{const t=ke(.5,ne(.2,e));return sl(t,0,1)})}function MN(e,t,n=!1){return n?e():t()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Xyt=["fanIn","fanOut","fanAvg"],Kyt=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zyt(e){Yb(Xyt,"FanMode",e)}function Qyt(e){Yb(Kyt,"Distribution",e)}class qu extends Gb{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class oDe extends qu{apply(t,n){return di(t,n)}}oDe.className="Zeros";Ee(oDe);class Sne extends qu{apply(t,n){return Dl(t,n)}}Sne.className="Ones";Ee(Sne);class lDe extends qu{constructor(t){if(super(),typeof t!="object")throw new re(`Expected argument of type ConstantConfig but got ${t}`);if(t.value===void 0)throw new re(`config must have value set but got ${t}`);this.value=t.value}apply(t,n){return ce(()=>ne(xt(this.value),Dl(t,n)))}getConfig(){return{value:this.value}}}lDe.className="Constant";Ee(lDe);class uDe extends qu{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,n){return Hb(t,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}uDe.className="RandomUniform";Ee(uDe);class cDe extends qu{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Tt(`randomNormal does not support dType ${n}.`);return v7(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}cDe.className="RandomNormal";Ee(cDe);class fDe extends qu{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Tt(`truncatedNormal does not support dType ${n}.`);return Pte(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}fDe.className="TruncatedNormal";Ee(fDe);class hDe extends qu{constructor(t){super(),this.gain=t.gain!=null?t.gain:1}apply(t,n){return ce(()=>{if(t.length!==2||t[0]!==t[1])throw new re("Identity matrix initializer can only be used for 2D square matrices.");return ne(this.gain,vte(t[0]))})}getConfig(){return{gain:this.gain}}}hDe.className="Identity";Ee(hDe);function Jyt(e,t="channelsLast"){let n,r;if(ei(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){const i=g0(e,2);n=e[1]*i,r=e[0]*i}else if(t==="channelsLast"){const i=g0(e,0,e.length-2);n=e[e.length-2]*i,r=e[e.length-1]*i}}else{const i=g0(e);n=Math.sqrt(i),r=Math.sqrt(i)}return[n,r]}class al extends qu{constructor(t){if(super(),t.scale<0)throw new re(`scale must be a positive float. Got: ${t.scale}`);this.scale=t.scale==null?1:t.scale,this.mode=t.mode==null?"fanIn":t.mode,Zyt(this.mode),this.distribution=t.distribution==null?"normal":t.distribution,Qyt(this.distribution),this.seed=t.seed}apply(t,n){const r=Jyt(t),i=r[0],s=r[1];let a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,i):this.mode==="fanOut"?a/=Math.max(1,s):a/=Math.max(1,(i+s)/2),this.distribution==="normal"){const o=Math.sqrt(a);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Tt(`${this.getClassName()} does not support dType ${n}.`);return Pte(t,0,o,n,this.seed)}else{const o=Math.sqrt(3*a);return Hb(t,-o,o,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}al.className="VarianceScaling";Ee(al);class kne extends al{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return al.className}}kne.className="GlorotUniform";Ee(kne);class Ene extends al{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return al.className}}Ene.className="GlorotNormal";Ee(Ene);class Ane extends al{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return al.className}}Ane.className="HeNormal";Ee(Ane);class Tne extends al{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return al.className}}Tne.className="HeUniform";Ee(Tne);class Dne extends al{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return al.className}}Dne.className="LeCunNormal";Ee(Dne);class Ine extends al{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return al.className}}Ine.className="LeCunUniform";Ee(Ine);class dDe extends qu{constructor(t){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=t.gain==null?this.DEFAULT_GAIN:t.gain,this.seed=t.seed}apply(t,n){return ce(()=>{if(t.length<2)throw new Tt("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=he(t.slice(0,-1)),i=t[t.length-1],s=r*i;s>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${s}) elements: Slowness may result.`);const a=[Math.max(i,r),Math.min(i,r)],o=v7(a,0,1,n,this.seed),l=a3e.qr(o,!1);let u=l[0];const f=l[1].flatten().stridedSlice([0],[Math.min(i,r)*Math.min(i,r)],[Math.min(i,r)+1]);return u=ne(u,f.sign()),r<i&&(u=u.transpose()),ne(xt(this.gain),u.reshape(t))})}getConfig(){return{gain:this.gain,seed:this.seed}}}dDe.className="Orthogonal";Ee(dDe);const Age={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Tge(e,t={}){return DN(e,El.getMap().classNameMap,t,"initializer")}function kr(e){return $ne(e)}function yr(e){if(typeof e=="string"){const t=e in Age?Age[e]:e;if(t==="GlorotNormal")return new Ene;if(t==="GlorotUniform")return new kne;if(t==="HeNormal")return new Ane;if(t==="HeUniform")return new Tne;if(t==="LeCunNormal")return new Dne;if(t==="LeCunUniform")return new Ine;{const n={};return n.className=t,n.config={},Tge(n)}}else return e instanceof qu?e:Tge(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function HY(e){return Array.isArray(e)&&Array.isArray(e[0])}function E5(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function vt(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new re(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function un(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new re(`Expected exactly 1 Shape; got ${e.length}`)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function A5(e){let t=0;for(const n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((r,i)=>r*i);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Dge="Variable";class ebt{constructor(t,n="float32",r=Dge,i=!0,s=null){this.dtype=n==null?"float32":n,this.shape=t.shape,this.id=eDe(),r=r==null?Dge:r,this.originalName=nDe(r),this.name=rDe(this.originalName),this.trainable_=i,this.constraint=s,this.val=XTe(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),tbt(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function tbt(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function qY(e){return e.map(t=>t.read())}function Nne(e){e.forEach(t=>{t[0].write(t[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gi{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class Qf{constructor(t,n,r,i,s,a,o){this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=i,this.callArgs=s,this.outputTensorIndex=o,this.id=eDe(),a!=null&&(this.originalName=nDe(a),this.name=rDe(this.originalName)),this.rank=n.length}}let nbt=0;class y7{constructor(t,n){this.callArgs=n,this.id=nbt++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const r of t.inboundLayers)r!=null&&r.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const n of this.inboundLayers)n!=null?t.push(n.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let rbt=0;class Vt extends Gb{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=rbt++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=t.name;if(!n){const r=this.getClassName();n=Bd(r)+"_"+m7(r)}if(this.name=n,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let r;if(t.batchInputShape!=null)r=t.batchInputShape;else if(t.inputShape!=null){let s=null;t.batchSize!=null&&(s=t.batchSize),r=[s].concat(t.inputShape)}this.batchInputShape=r;let i=t.dtype;i==null&&(i=t.inputDType),i==null&&(i="float32"),this.dtype=i}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,n){return t.name+"_ib-"+n.toString()}getNodeAtIndex(t,n){if(this.inboundNodes.length===0)throw new gu(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=t)throw new re(`Asked to get ${n} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return qa(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return qa(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Mf(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Mf(`Layer ${this.name} is not connected, no input to return.`);return qa(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Mf(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Mf(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return qa(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(n=>n.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=sr(t),this.inputSpec==null||this.inputSpec.length===0)return;const n=sr(this.inputSpec);if(t.length!==n.length)throw new re(`Layer ${this.name} expects ${n.length} inputs, but it received ${t.length} input tensors. Input received: ${t}`);for(let r=0;r<t.length;r++){const i=t[r],s=n[r];if(s==null)continue;const a=i.rank;if(s.ndim!=null&&a!==s.ndim)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${s.ndim}, found ndim=${a}`);if(s.maxNDim!=null&&a>s.maxNDim)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${s.maxNDim}, found ndim=${a}`);if(s.minNDim!=null&&a<s.minNDim)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${s.minNDim}, found ndim=${a}.`);if(s.dtype!=null&&i.dtype!==s.dtype)throw new re(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${s.dtype}, found dtype=${i.dtype}.`);if(s.axes){const o=i.shape;for(const l in s.axes){const u=Number(l),c=s.axes[l],f=u>=0?o[u]:o[o.length+u];if(c!=null&&[c,null].indexOf(f)===-1)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${c} but got shape ${o}.`)}}if(s.shape!=null)for(let o=0;o<s.shape.length;++o){const l=s.shape[o],u=i.shape[o];if(l!=null&&u!=null&&l!==u)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected shape=${s.shape}, found shape=${i.shape}.`)}}}call(t,n){return t}invokeCallHook(t,n){this._callHook!=null&&this._callHook(t,n)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,n){n=n||{},this.assertNotDisposed();const r=sr(t);let i=!0;for(const a of r)if(!(a instanceof Qf)){i=!1;break}let s=!0;for(const a of r)if(a instanceof Qf){s=!1;break}if(i===s)throw new re("Arguments to apply() must be all SymbolicTensors or all Tensors");return Z1(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const a=[];for(const o of sr(t))a.push(o.shape);this.build(qa(a)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&s&&(this._refCount=1)}if(this.assertInputCompatibility(t),s){let a=this.call(t,n);const o=sr(a),l=[];for(let u of o)r.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(a=qa(l),this.activityRegularizer!=null)throw new Tt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}else{const a=ibt(t),o=this.computeOutputShape(a);let l;const u=sbt(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?a[0]:a),o!=null&&o.length>0&&Array.isArray(o[0])?l=o.map((c,f)=>new Qf(u,c,this,sr(t),n,this.name,f)):l=new Qf(u,o,this,sr(t),n,this.name),this.addInboundNode(t,l,null,null,a,o,n),this._refCount++,this.activityRegularizer!=null)throw new Tt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,i)=>{r!=null&&t[i]!=null&&t[i]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Mf(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);t.indexOf(r)===-1&&t.push(r)}if(t.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new Mf(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new gu(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return A5(this.weights)}build(t){this.built=!0}getWeights(t=!1){return qY(t?this.trainableWeights:this.weights)}setWeights(t){ce(()=>{const n=this.weights;if(n.length!==t.length)throw new re(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${n.length} weights. Provided weights: ${t}...`);if(n.length===0)return;const r=[],i=qY(n);for(let s=0;s<i.length;++s){const a=i[s],o=n[s],l=t[s];if(!Zt(a.shape,l.shape))throw new re(`Layer weight shape ${a.shape} not compatible with provided weight shape ${l.shape}`);r.push([o,l])}Nne(r)})}addWeight(t,n,r,i,s,a,o,l){if(this._addedWeightNames.indexOf(t)!==-1)throw new re(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(i=l!=null?l():yr("zeros"));const u=i.apply(n,r),c=new ebt(u,r,t,a,o);return u.dispose(),s!=null&&this.addLoss(()=>s.apply(c.read())),a==null&&(a=!0),a?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=sr(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}addInboundNode(t,n,r,i,s,a,o=null){const l=sr(t);n=sr(n),r=sr(r),i=sr(i),s=E5(s),a=E5(a);const u=[],c=[],f=[];for(const h of l)u.push(h.sourceLayer),c.push(h.nodeIndex),f.push(h.tensorIndex);new y7({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:f,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:i,inputShapes:s,outputShapes:a},o);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount===0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function ibt(e){e=sr(e);const t=[];for(const n of e)t.push(n.shape);return qa(t)}function sbt(e){return"float32"}function pDe(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{const r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const i=[];for(let s=0;s<r.inboundLayers.length;s++){const a=r.inputTensors[s],o=r.inboundLayers[s],l=r.nodeIndices[s],u=pDe(a,o,l);for(const c of u)i.indexOf(c)===-1&&i.push(c)}return i}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class FN extends Vt{constructor(t){if(super({dtype:t.dtype,name:t.name!=null?t.name:m7("input").toString()}),t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new re("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=t.batchInputShape;if(n==null){if(t.inputShape==null)throw new re("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new re("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=t.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const i=new Qf(this.dtype,this.batchInputShape,this,[],{},this.name);i.nodeIndex=0,i.tensorIndex=0,new y7({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(t,n){throw new re(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}FN.className="InputLayer";Ee(FN);function abt(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new re("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n==null&&(n="float32"),new FN({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function obt(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return Oe(t,e.dtype)}catch{throw new re(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}class Gg{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof Gg)for(const n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(const n of t)this.add(n.key,n.value)}}add(t,n,r){if(this.id2Value[t.id]==null)this.id2Value[t.id]=obt(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r);else throw new re(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Qf){if(this.id2Value[t.id]==null)throw new re(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{const n=this.name2Id[t];if(n==null)throw new re(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof Qf){if(this.id2Value[t.id]==null)throw new re(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{const n=this.name2Id[t];if(n==null)throw new re(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Bt(this.id2Mask)}}const T5=new Z3e,D5=new Z3e;function lbt(e){T5!=null&&T5.setMaxEntries(e),D5!=null&&D5.setMaxEntries(e)}function nE(e,t,n,r){const i=n==null?!1:n.training,s=Array.isArray(e),a=s?e:[e],o=a.map(p=>p.name),l=[],u=t.names();for(const p of o)u.indexOf(p)!==-1?l.push(t.getValue(p)):l.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const c=o.join(",")+"|"+t.names().sort().join(",");let f=T5.get(c),h;if(f==null){const p=ubt(a,t);f=p.sorted,h=p.recipientCounts,T5.put(c,f),D5.put(c,h)}h={},i||Object.assign(h,D5.get(c));const d=new Gg(t);for(let p=0;p<f.length;++p){if(r!=null){const k=_5().numTensors;k>r.maxNumTensors&&(r.maxNumTensors=k),k<r.minNumTensors&&(r.minNumTensors=k)}const g=f[p],m=g.sourceLayer;if(m instanceof FN)continue;const v=[],y=[],b=[];let x=!1;for(const k of g.inputs){const E=d.getValue(k),S=d.getMask(k);v.push(E),y.push(S),S!=null&&(x=!0),i||(h[k.name]--,h[k.name]===0&&!t.hasKey(k)&&o.indexOf(k.name)===-1&&!E.isDisposed&&k.sourceLayer.stateful!==!0&&b.push(E))}x&&(n=n||{},n.mask=y[0]);const w=sr(m.apply(v,n));let C=null;m.supportsMasking&&(C=m.computeMask(v,y));const $=fbt(g),_=Array.isArray($)?$:[$];for(let k=0;k<_.length;++k){d.hasKey(_[k])||d.add(_[k],w[k],Array.isArray(C)?C[0]:C);const E=o.indexOf(_[k].name);E!==-1&&(l[E]=w[k])}i||Bt(b)}return d.disposeMasks(),s?l:l[0]}function ubt(e,t){B(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(e.length===1){const i=Ige(e[0],t);n=i.sorted,r=i.recipientMap}else{const i=new Set;for(const s of e){const{sorted:a,recipientMap:o}=Ige(s,t);for(const l of a)i.has(l.name)||(n.push(l),i.add(l.name));for(const l in o)r[l]==null&&(r[l]=new Set),o[l].forEach(u=>r[l].add(u))}}return{sorted:n,recipientCounts:cbt(r)}}function cbt(e){const t={};for(const n in e)t[n]=e[n].size;return t}function Ige(e,t){const n=new Set,r=[],i={};for(const o of t.names())n.add(o);const s=[],a=[];for(s.push(e);s.length>0;){const o=s[s.length-1];if(n.has(o.name)){s.pop();continue}const l=a[a.length-1]===s.length-1;if(o.inputs.length===0||l)s.pop(),r.push(o),n.add(o.name),l&&a.pop();else{a.push(s.length-1);for(const u of o.inputs)i[u.name]==null&&(i[u.name]=new Set),i[u.name].add(o.name),!n.has(u.name)&&s.push(u)}}return{sorted:r,recipientMap:i}}function fbt(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let r=0;r<e.sourceLayer.inboundNodes.length;++r)for(const i of e.sourceLayer.inboundNodes[r].outputTensors)if(i.id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hbt=le();hbt.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,lbt);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Mne(e,t){return ce(()=>Hs(qe(ne(e,e),t,!0)))}class ON extends Gb{getConfig(){return{}}}class gDe extends ON{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return ce(()=>{const n=Mne(t,this.axis),r=sl(n,0,this.maxValue);return ne(t,Qe(r,ke(pi(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}gDe.className="MaxNorm";Ee(gDe);class mDe extends ON{constructor(t){super(),this.defaultAxis=0,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return ce(()=>Qe(t,ke(pi(),Mne(t,this.axis))))}getConfig(){return{axis:this.axis}}}mDe.className="UnitNorm";Ee(mDe);class vDe extends ON{apply(t){return id(t)}}vDe.className="NonNeg";Ee(vDe);class yDe extends ON{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=t.minValue!=null?t.minValue:this.defaultMinValue,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.rate=t.rate!=null?t.rate:this.defaultRate,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return ce(()=>{const n=Mne(t,this.axis),r=ke(ne(this.rate,sl(n,this.minValue,this.maxValue)),ne(1-this.rate,n));return ne(t,Qe(r,ke(pi(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}yDe.className="MinMaxNorm";Ee(yDe);const Nge={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function mi(e){return $ne(e)}function Mge(e,t={}){return DN(e,El.getMap().classNameMap,t,"constraint")}function vi(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in Nge?Nge[e]:e,config:{}};return Mge(n)}else return e instanceof ON?e:Mge(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Sv(e){if(e==null)return;const t=[],n=[],r=[];for(const i in e){const s=e[i];if(typeof s!="number"){const a=s;t.push(a.data()),n.push(i),r.push(a)}}if(t.length>0){const i=await Promise.all(t);for(let s=0;s<i.length;++s)e[n[s]]=i[s][0];Bt(r)}}function bDe(e){if(e!=null)for(const t in e){const n=e[t];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Fge;(function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"})(Fge||(Fge={}));const dbt=125;class CT{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,n){}async onEpochEnd(t,n){}async onBatchBegin(t,n){}async onBatchEnd(t,n){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class pbt{constructor(t,n=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=n}append(t){this.callbacks.push(t)}setParams(t){for(const n of this.callbacks)n.setParams(t)}setModel(t){for(const n of this.callbacks)n.setModel(t)}async onEpochBegin(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(t,n)}async onEpochEnd(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(t,n)}async onBatchBegin(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(t,n)}async onBatchEnd(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(t,n)}async onTrainBegin(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainBegin(t)}async onTrainEnd(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainEnd(t)}}class gbt extends CT{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const i in n){const s=n[i];if(typeof s=="number")this.totals.hasOwnProperty(i)||(this.totals[i]=0),this.totals[i]=this.totals[i]+s*r;else{let a;i in this.totals?a=this.totals[i]:this.totals[i]=0;const o=ce(()=>ke(this.totals[i],ne(s,r)));this.totals[i]=o,a!=null&&a.dispose()}}}async onEpochEnd(t,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:ce(()=>{const i=ne(Qe(1,this.seen),this.totals[r]);n[r]=i,this.totals[r].dispose(),zc(n[r])}))}}class mbt extends CT{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,n){n==null&&(n={}),this.epoch.push(t);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const t=[],n=[],r=[];for(const s in this.history){const a=this.history[s];for(let o=0;o<a.length;++o)if(typeof a[o]!="number"){const l=a[o];t.push(l.data()),n.push(s),r.push(o)}}const i=await Promise.all(t);for(let s=0;s<i.length;++s)this.history[n[s]][r[s]].dispose(),this.history[n[s]][r[s]]=i[s][0]}}class vbt extends CT{constructor(t,n){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||tne,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=dbt),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");m5(this.yieldEvery)&&(this.maybeWait=Nyt(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,n,r){const i=[];this.yield!=null&&(await Sv(r),i.push(this.yield(t,n,r))),i.push(this.nextFrameFunc()),await Promise.all(i)}async onEpochBegin(t,n){this.currentEpoch=t,this.epochBegin!=null&&(await Sv(n),await this.epochBegin(t,n))}async onEpochEnd(t,n){const r=[];this.epochEnd!=null&&(await Sv(n),r.push(this.epochEnd(t,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(t,n){this.batchBegin!=null&&(await Sv(n),await this.batchBegin(t,n))}async onBatchEnd(t,n){const r=[];this.batchEnd!=null&&(await Sv(n),r.push(this.batchEnd(t,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):m5(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),await Promise.all(r)}async onTrainBegin(t){this.trainBegin!=null&&(await Sv(t),await this.trainBegin(t))}async onTrainEnd(t){this.trainEnd!=null&&(await Sv(t),await this.trainEnd(t))}}function xDe(e,t){return e==null&&(e={}),e instanceof CT?[e]:Array.isArray(e)&&e[0]instanceof CT?e:sr(e).map(r=>new vbt(r,t))}class lu{constructor(){}static registerCallbackConstructor(t,n){B(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),lu.checkForDuplicate(n),lu.constructors[t]==null&&(lu.constructors[t]=[]),lu.constructors[t].push(n)}static checkForDuplicate(t){for(const n in lu.constructors)lu.constructors[+n].forEach(i=>{if(i===t)throw new re("Duplicate callback constructor.")})}static clear(){lu.constructors={}}static createCallbacks(t){const n=[];for(const r in lu.constructors){const i=+r;t>=i&&n.push(...lu.constructors[i])}return n.map(r=>new r)}}lu.constructors={};function wDe(e,t,n,r,i,s,a,o,l){const u=new mbt,c=[new gbt,...lu.createCallbacks(t)];e!=null&&c.push(...e),c.push(u);const f=new pbt(c);return f.setParams({epochs:n,initialEpoch:r,samples:i,steps:s,batchSize:a,verbose:t,doValidation:o,metrics:l}),{callbackList:f,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yp(e,t={},n=!1){return DN(e,El.getMap().classNameMap,t,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function I5(e,t){return ce(()=>{e.dtype!=="float32"&&(e=Oe(e,"float32"));const n=qe(NN(e),t,!0),r=$_(n.shape,pi()),i=Hs(rg(n,r));return Qe(e,i)})}function b7(e,t){return ce(()=>Lr(NN(We(t,e)),-1))}function Fne(e,t){return ce(()=>Lr(hi(We(t,e)),-1))}function One(e,t){return ce(()=>{const n=We(e,t),r=sl(hi(e),pi(),Number.MAX_VALUE),i=hi(Qe(n,r));return ne(100,Lr(i,-1))})}function ybt(e,t){return ce(()=>{const n=sl(t,pi(),Number.MAX_VALUE),r=Vl(ke(1,n)),i=sl(e,pi(),Number.MAX_VALUE),s=Vl(ke(1,i));return Lr(NN(We(r,s)),-1)})}function bbt(e,t){return ce(()=>{const n=rg(0,We(1,ne(e,t)));return Lr(NN(n),-1)})}function xbt(e,t){return ce(()=>{const n=rg(0,We(1,ne(e,t)));return Lr(n,-1)})}function wbt(e,t){return ce(()=>{const n=qe(ne(e,t),-1),r=Au(ne(We(1,e),t),-1);return rg(0,ke(1,We(r,n)))})}function $bt(e,t){return ce(()=>{const n=Math.log(2),r=We(t,e),i=We(ke(r,C_(ne(-2,r))),n);return Lr(i,-1)})}function _T(e,t,n=!1){return ce(()=>{if(n)t=Qz(t);else{const r=qe(t,t.shape.length-1,!0);t=Qe(t,r)}return t=sl(t,pi(),1-pi()),ur(qe(ne(Oe(e,"float32"),Vl(t)),t.shape.length-1))})}function N5(e,t,n=!1){return ce(()=>{const r=Oe(SN(jyt(e)),"int32");t=sl(t,pi(),1-pi());const i=t.shape,s=ie(bT(r,i[i.length-1]),i);return _T(s,t,n)})}function Cbt(e,t){if(!Zt(e.shape,t.shape))throw new re(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return ce(()=>{const n=id(t),r=ur(hi(t));return ke(We(n,ne(t,e)),Wz(Wl(r)))})}function x7(e,t){return ce(()=>{let n;return n=sl(t,pi(),1-pi()),n=Vl(Qe(n,We(1,n))),Lr(Cbt(e,n),-1)})}function _bt(e,t){return ce(()=>{const n=sl(e,pi(),1),r=sl(t,pi(),1);return qe(ne(e,Vl(Qe(n,r))),-1)})}function Sbt(e,t){return ce(()=>{const n=Vl(ke(pi(),t));return Lr(We(t,ne(e,n)),-1)})}function $De(e,t){return ce(()=>{const n=I5(e,-1),r=I5(t,-1),i=ne(n,r);return ur(qe(i,-1))})}const M5={meanSquaredError:b7,meanAbsoluteError:Fne,meanAbsolutePercentageError:One,meanSquaredLogarithmicError:ybt,squaredHinge:bbt,hinge:xbt,categoricalHinge:wbt,logcosh:$bt,categoricalCrossentropy:_T,sparseCategoricalCrossentropy:N5,binaryCrossentropy:x7,kullbackLeiblerDivergence:_bt,poisson:Sbt,cosineProximity:$De};function fj(e){if(typeof e=="string"){if(e in M5)return M5[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new re(t)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function CDe(e,t){return ce(()=>{const n=ne(.5,jl(t)),r=ih(yl(t,n),e.dtype);return Lr(Xc(e,r),-1)})}function _De(e,t){return ce(()=>ih(Xc(Fw(e,-1),Fw(t,-1)),"float32"))}function kbt(e,t){return ce(()=>Oe(qe(Mh(Xc(e,1),Xc(t,1))),"float32"))}function Ebt(e,t){return ce(()=>Oe(qe(Mh(Xc(e,0),Xc(t,1))),"float32"))}function Abt(e,t){return ce(()=>{const n=kbt(e,t),r=Ebt(e,t),i=ke(n,r);return Oe(Ws(yl(i,0),Qe(n,i),0),"float32")})}function Tbt(e,t){return x7(e,t)}function Dbt(e,t){return e.rank===t.rank&&(e=qb(e,[e.rank-1])),t=Fw(t,-1),t.dtype!==e.dtype&&(t=Oe(t,e.dtype)),Oe(Xc(e,t),"float32")}const Ibt=b7,Nbt=b7,Mbt=Fne,Fbt=Fne,Obt=One,Rbt=One,SDe=_T,Pbt=$De,kDe=N5,F5={binaryAccuracy:CDe,categoricalAccuracy:_De,precision:Abt,categoricalCrossentropy:SDe,sparseCategoricalCrossentropy:kDe,mse:Ibt,MSE:Nbt,mae:Mbt,MAE:Fbt,mape:Obt,MAPE:Rbt,cosine:Pbt};function Lbt(e){if(typeof e=="string"&&e in F5)return F5[e];if(typeof e!="string"&&e!=null)return e;throw new re(`Unknown metric ${e}`)}function rO(e){if(Ff(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e=="string")return e;{let t;for(const n of Object.keys(M5))if(M5[n]===e){t=n;break}if(t!==void 0)return t;for(const n of Object.keys(F5))if(F5[n]===e){t=n;break}return t!==void 0?t:e.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bbt(e){const t={Adagrad:()=>Gv.adagrad(.01),Adadelta:()=>Gv.adadelta(1,.95,pi()),Adam:()=>Gv.adam(.001,.9,.999,pi()),Adamax:()=>Gv.adamax(.002,.9,.999,pi(),0),RMSProp:()=>Gv.rmsprop(.001,.9,0,pi()),SGD:()=>Gv.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new re(`Unknown Optimizer ${e}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Oge=1*1024*1024;function Rge(e,t,n=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!GY(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(e);r.length>Oge&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${Oge}.`)}}function GY(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t)if(typeof n!="string"||!GY(e[n]))return!1;return!0}else if(Array.isArray(e)){for(const t of e)if(!GY(t))return!1;return!0}else return!1;else{const t=typeof e;return t==="string"||t==="number"||t==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zbt(e,t,n,r=console.log){const i=Wbt(e),s=["Layer (type)","Input Shape","Output shape","Param #"];i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(t*c)));let a;if(!i){s.push("Receives inputs"),a=[];for(const c in e.nodesByDepth)a.push(...e.nodesByDepth[c])}r("_".repeat(t)),O5(s,n,r),r("=".repeat(t));const o=e.layers;for(let c=0;c<o.length;++c)i?Vbt(o[c],n,r):jbt(o[c],n,a,r),r((c===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const l=Ubt(e),u=A5(e.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(t))}function Ubt(e){let t;return e.collectedTrainableWeights!=null?t=A5(e.collectedTrainableWeights):t=A5(e.trainableWeights),t}function Wbt(e){let t=!0;const n=[],r=[];for(const i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(const i of n){if(i.length>1||i.length===1&&i[0].inboundLayers.length>1){t=!1;break}r.push(...i)}if(t)for(const i of e.layers){let s=!1;for(const a of i.inboundNodes)if(r.indexOf(a)!==-1)if(s){t=!1;break}else s=!0;if(!t)break}return t}function O5(e,t,n=console.log){let r="";for(let i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=e[i],r=r.slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function Vbt(e,t,n){let r,i;try{i=e.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(e.outputShape)}catch{r="multiple"}const s=e.name,a=e.getClassName(),o=[`${s} (${a})`,i,r,e.countParams().toString()];O5(o,t,n)}function jbt(e,t,n,r){let i,s;try{s=e.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{s="multiple"}try{i=JSON.stringify(e.outputShape)}catch{i="multiple"}const a=[];for(const f of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(f)===-1))for(let h=0;h<f.inboundLayers.length;++h){const d=f.inboundLayers[h].name,p=f.nodeIndices[h],g=f.tensorIndices[h];a.push(`${d}[${p}][${g}]`)}const o=e.name,l=e.getClassName(),u=a.length===0?"":a[0],c=[`${o} (${l})`,s,i,e.countParams().toString(),u];O5(c,t,r);for(let f=1;f<a.length;++f)O5(["","","","",a[f]],t,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function EDe(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function YY(e,t){if(e===null)return null;if(typeof e=="string")return i1(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const s=e[i];EDe(t,i,s)?n.push(s):n.push(YY(s,t))}return n}else{const n={};for(const r of Object.keys(e)){const i=e[r];if(r==="name"&&typeof i=="string")n[r]=i;else{const s=i1(r);n[s]=YY(i,s)}}return n}}function XY(e,t){if(e==null)return null;if(typeof e=="string")return Bd(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const s=e[i];EDe(t,i,s)?n.push(s):n.push(XY(s,t))}return n}else{const n={};for(const r of Object.keys(e)){const i=e[r],s=Bd(r);(r==="name"||r==="className")&&typeof i=="string"?n[s]=i:n[s]=XY(i,r)}return n}}/** @license See the LICENSE file. */const ADe="4.8.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class lc extends Vt{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){const y=this.getClassName().toLowerCase();this.name=m7(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],p0(this.inputs).length!==this.inputs.length)throw new re(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(y=>y.name)}`);p0(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(y=>y.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const b=y.sourceLayer,x=y.nodeIndex,w=y.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(x),this.outputLayersTensorIndices.push(w)}for(const y of this.inputs){const b=y.sourceLayer,x=y.nodeIndex,w=y.tensorIndex;Ff(x===0,"input layer has >1 nodes"),Ff(w===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(x),this.inputLayersTensorIndices.push(w)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const b=this.inputLayers[y];if(!(b instanceof FN))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${y} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);const n={},r={},i={},s={},a={},o=[],l=(y,b,x,w,C,$)=>{(w==null||C==null||$==null)&&(w=y.sourceLayer,C=y.nodeIndex,$=y.tensorIndex);const _=w.inboundNodes[C];if(x.indexOf(_)!==-1)throw new gu(`The tensor ${y.name} at layer "${w.name}" is part of a cycle.`);if(b.indexOf(_)!==-1)return;this.containerNodes.add(lc.nodeKey(w,C)),w.id in a||(a[w.id]=Object.keys(a).length),x.indexOf(_)===-1&&x.push(_);const k=_.inboundLayers.length;for(let E=0;E<k;E++){const S=_.inputTensors[E],I=_.inboundLayers[E],A=_.nodeIndices[E],D=_.tensorIndices[E];l(S,b,x,I,A,D)}for(b.push(_);x.indexOf(_)>=0;)x.splice(x.indexOf(_),1);o.push(_)},u=[],c=[];for(const y of this.outputs)l(y,u,c);const f=o.slice().reverse();for(const y of f){r[y.id]=y,y.id in n||(n[y.id]=0);let b=n[y.id];const x=i[y.outboundLayer.id]==null?0:i[y.outboundLayer.id];b=Math.max(b,x),i[y.outboundLayer.id]=b,s[y.outboundLayer.id]=y.outboundLayer,n[y.id]=b;for(let w=0;w<y.inboundLayers.length;w++){const C=y.inboundLayers[w],$=y.nodeIndices[w],_=C.inboundNodes[$],k=n[_.id]==null?0:n[_.id];n[_.id]=Math.max(b+1,k),r[_.id]=_}}const h={};for(const y in n){const b=n[y];b in h||(h[b]=[]),h[b].push(r[y])}const d={};for(const y in i){const b=i[y];b in d||(d[b]=[]),d[b].push(s[y])}let p=Object.keys(d).map(y=>parseInt(y,10)).sort(eO);this.layers=[];for(const y of p){const b=d[y];b.sort((x,w)=>{const C=a[x.id],$=a[w.id];return C<$?-1:C>$?1:0});for(const x of b)x instanceof lc&&this.internalContainerRefs.push(x),this.layers.push(x)}this.layersByDepth=d,p=Object.keys(h).map(y=>parseInt(y,10)).sort(eO);const g=this.inputs.slice(),m=[];for(const y of p)for(const b of h[y]){const x=b.outboundLayer;if(x!=null){for(const w of b.inputTensors)if(g.indexOf(w)===-1)throw new gu(`Graph disconnected: cannot obtain value for tensor ${w} at layer "${x.name}". The following previous layers were accessed without issue: ${m}`);for(const w of b.outputTensors)g.push(w);m.push(x.name)}}this.nodesByDepth=h;const v=this.layers.map(y=>y.name);for(const y of v){const b=v.filter(x=>x===y).length;if(b!==1)throw new gu(`The name "${y}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(v))}this.outboundNodes=[],this.inboundNodes=[],new y7({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new re("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){const r={};let i=0;for(const a of this.layers)for(const o of a.weights){if(r[o.originalName]!=null)throw new re(`Duplicate weight name: ${o.originalName}`);r[o.originalName]=o,i++}const s=[];for(const a in t){let o=a;if(r[a]==null){const l=a.split("/");o=l.slice(0,-2).concat([l[l.length-1]]).join("/")}if(r[o]!=null)s.push([r[o],t[a]]);else if(n)throw new re(`Provided weight data has no target variable: ${a}`);delete r[o]}if(n){const a=[];for(const o in r)a.push(o);if(a.length>0)throw new re(`${a.length} of ${i} weights are not set: ${a}`)}Nne(s)}updatedConfig(){const t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${ADe}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){const r=XY(this.updatedConfig());return n?JSON.stringify(r):r}call(t,n){return ce(()=>{t=sr(t);const r=new Gg;for(let i=0;i<this.inputs.length;++i)r.add(this.inputs[i],t[i]);return nE(this.outputs,r,n)})}computeMask(t,n){return ce(()=>{t=sr(t);let r;return n==null?r=By(null,t.length):r=sr(n),this.runInternalGraph(t,r)[1]})}computeOutputShape(t){const n=E5(t);if(n.length!==this.inputLayers.length)throw new re(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let o=0;o<n.length;o++){const l=this.inputLayers[o],u=n[o],c=l.name+"_0_0";r[c]=u}const i=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(eO);if(i.length>1)for(const o of i){const l=this.nodesByDepth[o];for(const u of l){const c=u.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(c.id)!==-1)continue;const f=[];for(let g=0;g<u.inboundLayers.length;g++){const m=u.inboundLayers[g],v=u.nodeIndices[g],y=u.tensorIndices[g],b=`${m.name}_${v}_${y}`,x=r[b];f.push(x)}const h=c.computeOutputShape(qa(f)),d=E5(h),p=c.inboundNodes.indexOf(u);for(let g=0;g<d.length;g++){const m=`${c.name}_${p}_${g}`;r[m]=d[g]}}}const s=[],a=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],u=this.outputLayersNodeIndices[o],c=this.outputLayersTensorIndices[o],f=`${l.name}_${u}_${c}`;a.push(f)}for(let o=0;o<a.length;o++){const l=a[o];Ff(l in r),s.push(r[l])}return qa(s)}runInternalGraph(t,n){n==null&&(n=By(null,t.length));const r={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],c=t[l],f=n[l];r[u.id]=[c,f]}const i=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(eO);for(const l of i){const u=this.nodesByDepth[l];for(const c of u){const f=c.outboundLayer,h=c.inputTensors,d=c.outputTensors,p=new Array;for(const g of h)g.id in r&&p.push(r[g.id]);if(p.length===h.length){let g={},m,v,y,b;if(c.callArgs!=null&&(g=c.callArgs),p.length===1){const[x,w]=p[0];g.mask==null&&(g.mask=w),y=sr(f.call(x,g)),b=sr(f.computeMask(x,w)),m=[x],v=[w]}else m=p.map(x=>x[0]),v=p.map(x=>x[1]),g.mask==null&&(g.mask=v),y=sr(f.call(m,g)),b=sr(f.computeMask(m,v));if(f.activityRegularizer)throw new Tt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let x=0;x<d.length;++x){const w=d[x],C=y[x],$=b[x];r[w.id]=[C,$]}}}}const s=[],a=[],o=[];for(const l of this.outputs){Ff(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[u,c]=r[l.id];o.push(u.shape),s.push(u),a.push(c)}return[s,a,o]}buildNodeConversionMap(t){const n={};let r;for(const i of this.layers){r=i instanceof lc?1:0;for(let s=0;s<i.inboundNodes.length;s++){const a=lc.nodeKey(i,s);this.containerNodes.has(a)&&(n[a]=r,r+=1)}}return n}getLayer(t,n){if(n!=null)return this.findLayer(n);if(t==null)throw new re("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(const r of this.layers)if(r.name===t)return r;throw new re(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new re(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return ce(()=>{const t=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const i=lc.nodeKey(n,r);this.containerNodes.has(i)&&t.push(...n.calculateLosses())}return t})}getConfig(){const t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const a of this.layers){const o=a.getClassName(),l=a.getConfig(),u=[];for(let f=0;f<a.inboundNodes.length;f++){const h=a.inboundNodes[f],d=lc.nodeKey(a,f);let p={};if(this.containerNodes.has(d)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${a.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const g=[];for(let m=0;m<h.inboundLayers.length;m++){const v=h.inboundLayers[m],y=h.nodeIndices[m],b=h.tensorIndices[m],x=lc.nodeKey(v,y);let w=n[x];w==null&&(w=0),g.push([v.name,w,b,p])}u.push(g)}}}const c={};c.name=a.name,c.className=o,c.config=l,c.inboundNodes=u,r.push(c)}t.layers=r;const i=[];for(let a=0;a<this.inputLayers.length;a++){const o=this.inputLayers[a],l=this.inputLayersNodeIndices[a],u=lc.nodeKey(o,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const f=this.inputLayersTensorIndices[a];i.push([o.name,c,f])}t.inputLayers=i;const s=[];for(let a=0;a<this.outputLayers.length;a++){const o=this.outputLayers[a],l=this.outputLayersNodeIndices[a],u=lc.nodeKey(o,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const f=this.outputLayersTensorIndices[a];s.push([o.name,c,f])}return t.outputLayers=s,t}static fromConfig(t,n,r={},i=!1){const s={},a={};function o(m,v){m.name in a?a[m.name].push(v):a[m.name]=[v]}function l(m,v){const y=[];let b;for(const x of v){const w=x[0],C=x[1],$=x[2];if(b=x[3]==null?{}:x[3],!(w in s)){o(m,v);return}const _=s[w];if(_.inboundNodes.length<=C){o(m,v);return}const k=_.inboundNodes[C];y.push(k.outputTensors[$])}y.length>0&&m.apply(qa(y),b)}function u(m){const v=m.name,y=yp(m,n.customObjects!=null?n.customObjects:{});y.setFastWeightInitDuringBuild(i),s[v]=y,m.inboundNodes.forEach(x=>{if(!(x instanceof Array))throw new re(`Corrupted configuration, expected array for nodeData: ${x}`);o(y,x)})}const c=n.name,f=n.layers;for(const m of f)u(m);for(;!Iyt(a);)for(const m of f){const v=s[m.name];if(v.name in a){const y=a[v.name];delete a[v.name];for(const b of y)l(v,b)}}const h=[],d=[],p=n.inputLayers;for(const m of p){const v=m[0],y=m[1],b=m[2];Ff(v in s);const w=s[v].inboundNodes[y].outputTensors;h.push(w[b])}const g=n.outputLayers;for(const m of g){const v=m[0],y=m[1],b=m[2];Ff(v in s);const w=s[v].inboundNodes[y].outputTensors;d.push(w[b])}return new t({inputs:h,outputs:d,name:c})}get stateful(){if(this._stateful)throw new re("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){ce(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Hbt(e,t,n){const r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(i=>null);if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){const i=[];return t.forEach(s=>{s in e?i.push(e[s]):i.push(null)}),i}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function TDe(e,t){return Hbt(e,t,"classWeight")}async function DDe(e,t,n,r){if(t!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){const i=ce(()=>{if(e.shape.length===1)return d0(e);if(e.shape.length===2){if(e.shape[1]>1)return Fw(e,1);if(e.shape[1]===1)return ie(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(await i.data());Bt(i);const a=[];return s.forEach(o=>{if(n[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);a.push(n[o])}),ro(a,"float32")}else return null}function qbt(e,t){return ne(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Gbt=32;function IDe(e,t){let n,r;const i=t;n=i.xs,r=i.ys,B(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const s=Pge("input",e.inputNames,n),a=Pge("output",e.outputNames,r),o=s[0].shape[0];B(s.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),B(a.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${a.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let l=0;l<s.length;l++)B(s[l].shape[0]===o,()=>`Batch size mismatch: input ${e.inputNames[l]} has ${s[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);for(let l=0;l<a.length;l++)B(a[l].shape[0]===o,()=>`Batch size mismatch: output ${e.outputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);return{xs:s,ys:a}}function Pge(e,t,n){if(n instanceof On)return[n];if(Array.isArray(n))return B(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{const r=[];for(const i of t){if(n[i]==null)throw new re(`The feature data generated by the dataset lacks the required ${e} key '${i}'.`);r.push(n[i])}return r}}function Ybt(e){if(e.length===3)throw new Tt("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}async function Xbt(e,t,n){const r=n.batchesPerEpoch!=null;if(B(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),B(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),B(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),B(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),B(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const i=n.validationData!=null;let s,a;if(i)if(Lge(n.validationData))B(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const m=Ybt(n.validationData);s=m.xs,a=m.ys}const o=e.makeTrainFunction(),l=e.getDedupedMetricsNames();let u;i?u=l.slice().concat(l.map(m=>"val_"+m)):u=l.slice();const c=xDe(n.callbacks,n.yieldEvery),f=n.verbose==null?1:n.verbose,{callbackList:h,history:d}=wDe(c,f,n.epochs,null,null,Kbt(t,n),null,i,u);h.setModel(e),e.history=d,await h.onTrainBegin(),e.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,g=await t.iterator();for(;p<n.epochs;){const m={};await h.onEpochBegin(p);let v=0,y=0;for(r||(g=await t.iterator());!r||v<n.batchesPerEpoch;){const b=await g.next();if(r&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${v} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:x,ys:w}=IDe(e,b.value),C={};C.batch=y,C.size=x[0].shape[0],await h.onBatchBegin(y,C);const $=[];if(n.classWeight!=null){const E=TDe(n.classWeight,e.outputNames);for(let S=0;S<E.length;++S)$.push(await DDe(w[S],null,E[S]))}const _=x.concat(w).concat($),k=o(_);Bt(_);for(let E=0;E<l.length;++E){const S=l[E],I=k[E];C[S]=I,zc(I)}await h.onBatchEnd(y,C),bDe(C),y++,v++}if(r?v>=n.batchesPerEpoch:b.done){if(i){let x;Lge(n.validationData)?x=sr(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):x=sr(e.evaluate(s,a,{batchSize:n.validationBatchSize==null?Gbt:n.validationBatchSize,verbose:0}));for(let w=0;w<e.metricsNames.length;++w)m[`val_${e.metricsNames[w]}`]=x[w]}break}if(e.stopTraining_)break}if(await h.onEpochEnd(p,m),p++,e.stopTraining_)break}return await h.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function Kbt(e,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function Lge(e){return typeof e.iterator=="function"}function Zbt(e){return typeof e.next=="function"}async function Qbt(e,t,n){n=n||{};const r=n.batches!=null,i=e.testFunction;let s=[];if(n.verbose>0)throw new Tt("Verbose mode is not implemented yet.");B(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const a=Zbt(t)?t:await t.iterator();let o=0,l=0;for(;!r||l<n.batches;){const u=await a.next();if(s=ce(()=>{if(u.value){const{xs:c,ys:f}=IDe(e,u.value),h=c.concat(f),d=ce(()=>i(h));if(Bt(h),l===0)for(let g=0;g<d.length;++g)s.push(xt(0));const p=h[0].shape[0];for(let g=0;g<d.length;++g){const m=d[g],v=s[g];s[g]=ce(()=>ke(s[g],ne(p,m))),l>0&&Bt(v)}Bt(d),o+=p,++l}return s}),u.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<s.length;++u){const c=s[u];s[u]=Qe(s[u],o),Bt(c)}return qa(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hj(e){B(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function YS(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(r=>Q1(r,t,n-t)):Q1(e,t,n-t)}function KY(e,t){return ce(()=>e==null?null:Array.isArray(e)?e.map(n=>KY(n,t)):sDe(e,t.dtype==="int32"?t:Oe(t,"int32")))}function dj(e,t){const n=[];let r=0,i=null;for(;r<e;)i=r+t,i>=e&&(i=e),n.push([r,i]),r=i;return n}function NDe(e){const t=[];e instanceof On&&(e=[e]);for(let n=0;n<e.length;++n){const r=e[n];if(r.rank===1)t.push(IN(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function nc(e,t){if(e==null)return;const n=[];if(t instanceof On)n.push(t.id);else if(Array.isArray(t))t.forEach(i=>n.push(i.id));else if(t!=null)for(const i in t){const s=t[i];n.push(s.id)}const r=[];if(e instanceof On)n.indexOf(e.id)===-1&&r.push(e);else if(Array.isArray(e))e.forEach(i=>{n.indexOf(i.id)===-1&&r.push(i)});else if(e!=null)for(const i in e){const s=e[i];n.indexOf(s.id)===-1&&r.push(s)}r.forEach(i=>{i.isDisposed||i.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jbt(e){return e instanceof On}function ZY(e){return Array.isArray(e)}function Bge(e){return!Jbt(e)&&!ZY(e)}function zge(e,t,n,r=!0,i=""){if(t==null||t.length===0){if(e!=null){let a=!1;if(ZY(e)&&e.length>0)a=!0;else if(Bge(e)){for(const o in e)if(e.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new re(`Error when checking model ${i} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(a=>null);let s;if(Bge(e)){e=e,s=[];for(const a of t){if(e[a]==null)throw new re(`No data provided for "${a}". Need data for each key in: ${t}`);s.push(e[a])}}else if(ZY(e)){if(e=e,e.length!==t.length)throw new re(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);s=e}else{if(e=e,t.length>1)throw new re(`The model ${i} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);s=[e]}if(s=NDe(s),n!=null)for(let a=0;a<t.length;++a){if(n[a]==null)continue;const o=s[a];if(o.shape.length!==n[a].length)throw new re(`Error when checking ${i}: expected ${t[a]} to have ${n[a].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<n[a].length;++l){if(l===0&&!r)continue;const u=o.shape[l],c=n[a][l];if(c!=null&&c>=0&&u!==c)throw new re(`${i} expected a batch of elements where each example has shape [${n[a].slice(1,n[a].length)}] (i.e.,tensor shape [*,${n[a].slice(1,n[a].length)}]) but the ${i} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return s}function ext(e,t,n){const r=p0(e.map(s=>s.shape[0]));r.sort();const i=p0(t.map(s=>s.shape[0]));if(i.sort(),r.length>1)throw new re(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(s=>s.shape))}`);if(i.length>1)throw new re(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(r.length>0&&i.length>0&&!Zt(r,i))throw new re(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}function txt(e,t,n){const r=[b7,x7,_T];for(let i=0;i<e.length;++i){const s=e[i],a=t[i],o=n[i];if(a!=null){if(a===_T&&s.shape[s.shape.length-1]===1)throw new re(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(a)!==-1){const l=s.shape.slice(1),u=o.slice(1);for(let c=0;c<l.length;++c){const f=l[c],h=u[c];if(h!=null&&f!==h)throw new re(`A target Tensor with shape ${s.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function Uge(e,t,n,r=!0,i=""){let s;if(Array.isArray(e)){if(e.length!==t.length)throw new re(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);s=e}else{if(t.length>1)throw new re(`The model expects ${t.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);s=[e]}if(n!=null)for(let a=0;a<t.length;++a){if(n[a]==null)continue;const o=s[a];if(o.shape.length!==n[a].length)throw new re(`Error when checking ${i}: expected ${t[a]} to have ${n[a].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<n[a].length;++l){if(l===0&&!r)continue;const u=o.shape[l],c=n[a][l];if(c!=null&&c!==u)throw new re(`Error when checking ${i}: expected ${t[a]} to have shape ${JSON.stringify(n[a])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function nxt(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(r=>[]);let n;if(typeof e=="string"||typeof e=="function")n=[e];else if(Array.isArray(e)||typeof e=="object")n=e;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(n))return t.map(r=>n);{const r=[];for(const i of t){let s=n.hasOwnProperty(i)?n[i]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}}const rxt="layers-model";class J1 extends lc{constructor(t){super(t),this.isTraining=!1}summary(t,n,r=console.log){if(!this.built)throw new re("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");zbt(this,t,n,r)}compile(t){if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=Bbt(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof sg))throw new re("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(t.loss)&&typeof t.loss!="string"&&typeof t.loss!="function"){t.loss=t.loss;for(const a in t.loss)if(this.outputNames.indexOf(a)===-1)throw new re(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(const a of this.outputNames)t.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),n.push(fj(t.loss[a]))}else if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new re(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);n=t.loss.map(o=>fj(o))}else{const a=fj(t.loss);this.outputs.forEach(o=>{n.push(a)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const o=this.internalOutputShapes[a],l=this.outputNames[a];this.feedOutputNames.push(l),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[a])}const r=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Z1("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(r.indexOf(a)!==-1)continue;const o=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([o,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});const i=nxt(t.metrics,this.outputNames),s=(a,o,l)=>{this.outputNames.length>1&&(o=this.outputNames[a]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([l,a])};Z1("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(r.indexOf(a)!==-1)continue;const o=i[a];(u=>{const c="";let f,h,d;for(const p of u){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const m=this.internalOutputShapes[a];m[m.length-1]===1||this.lossFunctions[a]===x7?["accuracy","acc"].indexOf(p)!==-1?h=CDe:["crossentropy","ce"].indexOf(p)!==-1&&(h=Tbt):this.lossFunctions[a]===N5?["accuracy","acc"].indexOf(p)!==-1?h=Dbt:["crossentropy","ce"].indexOf(p)!==-1&&(h=kDe):["accuracy","acc"].indexOf(p)!==-1?h=_De:["crossentropy","ce"].indexOf(p)!==-1&&(h=SDe);let v;["accuracy","acc"].indexOf(p)!==-1?v="acc":["crossentropy","ce"].indexOf(p)!==-1&&(v="ce"),d=h,f=c+v}else d=Lbt(p),f=c+rO(p);let g;Z1(f,()=>{g=d}),s(a,f,g)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,n,r={}){const i=r.batchSize==null?32:r.batchSize;hj(i);const s=!0,a=this.standardizeUserDataXY(t,n,s,i);try{const o=a[0].concat(a[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,o,i,r.verbose,r.steps);return qa(u)}finally{nc(a[0],t),nc(a[1],n)}}async evaluateDataset(t,n){return this.makeTestFunction(),Qbt(this,t,n)}checkNumSamples(t,n,r,i="steps"){let s;if(r!=null){if(s=null,n!=null)throw new re(`If ${i} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(t!=null)Array.isArray(t)?s=t[0].shape[0]:s=t.shape[0];else throw new re(`Either the input data should have a defined shape, or ${i} shoud be specified.`);return s}execute(t,n){if(Array.isArray(n)&&n.length===0)throw new re("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),i=r?n:[n],s=this.retrieveSymbolicTensors(i),a=new Gg;if(t instanceof On&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new re(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)a.add(this.inputs[l],t[l])}else for(const l of this.inputs){const u=t[l.name];if(u==null)throw new re(`No value is provided for the model's input ${l.name}`);a.add(l,u)}const o=nE(s,a);return r?o:o[0]}retrieveSymbolicTensors(t){const n=By(null,t.length);let r=t.length;for(const i of this.layers){const s=Array.isArray(i.output)?i.output:[i.output],a=s.map(o=>o.name);for(let o=0;o<t.length;++o){const l=a.indexOf(t[o]);if(l!==-1&&(n[o]=s[l],r--),r===0)break}if(r===0)break}if(r>0){const i=[];throw n.forEach((s,a)=>{s==null&&i.push(t[a])}),new re(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(i)}`)}return n}predictLoop(t,n=32,r=!1){return ce(()=>{const i=this.checkNumSamples(t);if(r)throw new Tt("Verbose predictLoop() is not implemented yet.");const s=dj(i,n),a=this.outputs.map(o=>[]);for(let o=0;o<s.length;++o)ce(()=>{const u=s[o][0],c=s[o][1],f=YS(t,u,c),h=[];if(Array.isArray(f))for(let p=0;p<f.length;++p)h.push({key:this.inputs[p],value:f[p]});else h.push({key:this.inputs[0],value:f});const d=new Gg(h);return nE(this.outputs,d)}).forEach((u,c)=>a[c].push(u));return qa(a.map(o=>Di(o,0)))})}predict(t,n={}){const r=NDe(t);Uge(r,this.inputNames,this.feedInputShapes,!1);try{const i=n.batchSize==null?32:n.batchSize;return hj(i),this.predictLoop(r,i)}finally{nc(r,t)}}predictOnBatch(t){Uge(t,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,n)}standardizeUserDataXY(t,n,r=!0,i){if(this.optimizer_==null)throw new gu("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const s=[];for(let a=0;a<this.feedOutputShapes.length;++a){const o=this.feedOutputShapes[a];this.feedLossFns[a]===N5?s.push(o.slice(0,o.length-1).concat([1])):s.push(o)}if(t=zge(t,this.feedInputNames,this.feedInputShapes,!1,"input"),n=zge(n,this.feedOutputNames,s,!1,"target"),ext(t,n),txt(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&i!=null&&i>0&&t[0].shape[0]%i!==0)throw new re(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${i}. Found: ${t[0].shape[0]} sample(s).`);return[t,n]}async standardizeUserData(t,n,r,i,s=!0,a){const[o,l]=this.standardizeUserDataXY(t,n,s,a);if(r!=null)throw new Error("sample weight is not supported yet.");let u=null;if(i!=null){const c=TDe(i,this.outputNames);u=[];for(let f=0;f<c.length;++f)u.push(await DDe(l[f],null,c[f]))}return[o,l,u]}testLoop(t,n,r,i=0,s){return ce(()=>{const a=this.checkNumSamples(n,r,s,"steps"),o=[];if(i>0)throw new Tt("Verbose mode is not implemented yet.");if(s!=null)throw new Tt("steps mode in testLoop() is not implemented yet");{const l=dj(a,r),u=ro(Kc(0,a));for(let c=0;c<l.length;++c){const f=l[c][0],h=l[c][1],d=Q1(u,f,h-f),p=KY(n,d),g=t(p);if(c===0)for(let m=0;m<g.length;++m)o.push(xt(0));for(let m=0;m<g.length;++m){const v=g[m];o[m]=ke(o[m],ne(h-f,v))}}for(let c=0;c<o.length;++c)o[c]=Qe(o[c],a)}return o})}getDedupedMetricsNames(){const t=this.metricsNames,n=[];for(let r=0;r<t.length;++r){const i=t[r];let s=i;if(Sge(t,i)>1){const a=Sge(t.slice(0,r),i);s+=`_${a}`}n.push(s)}return n}makeTrainFunction(){return t=>{const n=[],r=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],o=()=>{const f=[];for(let g=0;g<this.inputs.length;++g)f.push({key:this.inputs[g],value:r[g]});const h=new Gg(f),d=nE(this.outputs,h,{training:!0});let p;for(let g=0;g<this.lossFunctions.length;++g){const m=this.lossFunctions[g];let v=m(i[g],d[g]);s[g]!=null&&(v=qbt(v,s[g]));const y=Lr(v);n.push(y),g===0?p=v:p=ke(p,v)}for(let g=0;g<this.metricsTensors.length;++g){let m;if(this.outputs.length>1&&g<this.outputs.length)m=n[g];else{const v=this.metricsTensors[g][0],y=this.metricsTensors[g][1];m=Lr(v(i[y],d[y]))}zc(m),a.push(m)}return p=Lr(p),this.calculateLosses().forEach(g=>{p=ke(p,g)}),p},l=this.collectedTrainableWeights.map(f=>f.read()),u=!0;return[this.optimizer_.minimize(o,u,l)].concat(a)}}makeTestFunction(){this.testFunction=t=>ce(()=>{const n=[];let r;const i=t.slice(0,this.inputs.length),s=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let u=0;u<this.inputs.length;++u)a.push({key:this.inputs[u],value:i[u]});const o=new Gg(a),l=nE(this.outputs,o);for(let u=0;u<this.lossFunctions.length;++u){const c=this.lossFunctions[u],f=Lr(c(s[u],l[u]));u===0?r=f:r=ke(r,f),n.push(r)}for(let u=0;u<this.metricsTensors.length;++u){const c=this.metricsTensors[u][0],f=this.metricsTensors[u][1],h=Lr(c(s[f],l[f]));n.push(h)}return n})}async fit(t,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let i,s,a,o,l,u,c,f,h;try{const d=r.batchSize==null?32:r.batchSize;hj(d);const p=!1,g=await this.standardizeUserData(t,n,r.sampleWeight,r.classWeight,p,d);i=g[0],s=g[1],h=g[2];let m=!1,v;if(r.validationData!=null&&r.validationData.length>0){if(m=!0,r.validationData.length===2)l=r.validationData[0],u=r.validationData[1];else throw r.validationData.length===3?new Tt("validationData including sample weights is not supported yet."):new re(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const k=!0,E=await this.standardizeUserData(l,u,null,null,k,d);c=E[0],f=E[1],v=c.concat(f)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){m=!0;const k=Math.floor(i[0].shape[0]*(1-r.validationSplit)),E=i[0].shape[0];c=YS(i,k,E),a=i,i=YS(i,0,k),f=YS(s,k,E),o=s,s=YS(s,0,k),v=c.concat(f)}else r.validationSteps!=null&&(m=!0);const y=i.concat(s).concat(h);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),x=this.getDedupedMetricsNames();let w,C;m?(this.makeTestFunction(),w=this.testFunction,C=x.slice().concat(x.map(k=>"val_"+k))):(w=null,v=[],C=x.slice());const $=xDe(r.callbacks,r.yieldEvery);return await this.fitLoop(b,y,x,d,r.epochs,r.verbose,$,w,v,r.shuffle,C,r.initialEpoch,null,null)}finally{this.isTraining=!1,nc(i,t),nc(s,n),nc(a,t),nc(o,n),nc(c,l),nc(f,u),h!=null&&Bt(h)}}async fitLoop(t,n,r,i,s,a,o,l,u,c,f,h,d,p){i==null&&(i=32),s==null&&(s=1),c==null&&(c=!0),h==null&&(h=0);let g=!1;if(l!=null&&u!=null&&(g=!0),p!=null&&(g=!0,d==null))throw new re("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const m=this.checkNumSamples(n,i,d,"steps_per_epoch");let v;m!=null&&(v=Kc(0,m)),a==null&&(a=1);const{callbackList:y,history:b}=wDe(o,a,s,h,m,d,i,g,f);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let x=h;x<s;++x){await y.onEpochBegin(x);const w={};if(d!=null)throw new Tt("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Tt("batch shuffling is not implemneted yet");c&&Yee(v);const C=ro(v),$=dj(m,i);for(let _=0;_<$.length;++_){const k={};if(await y.onBatchBegin(_,k),ce(()=>{const E=$[_][0],S=$[_][1],I=Q1(C,E,S-E);k.batch=_,k.size=S-E;const A=KY(n,I),D=t(A);for(let T=0;T<r.length;++T){const N=r[T],F=D[T];k[N]=F,zc(F)}if(_===$.length-1&&g){const T=this.testLoop(l,u,i);for(let N=0;N<r.length;++N){const F=r[N],R=T[N];zc(R),w["val_"+F]=R}}}),await y.onBatchEnd(_,k),bDe(k),this.stopTraining_)break}C.dispose()}if(await y.onEpochEnd(x,w),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(t,n){return Xbt(this,t,n)}async trainOnBatch(t,n){const r=await this.standardizeUserData(t,n),i=r[0],s=r[1],o=this.makeTrainFunction()(i.concat(s)),l=[];for(const u of o){const c=await u.data();l.push(c[0])}return Bt(o),nc(r[0],t),nc(r[1],n),qa(l)}getNamedWeights(t){const n=[],r=t!=null&&t.trainableOnly,i=r?this.trainableWeights:this.weights,s=this.getWeights(r);for(let a=0;a<i.length;++a)r&&!i[a].trainable||n.push({name:i[a].originalName,tensor:s[a]});return n}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=_5().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=n-_5().numTensors}return t}getLossIdentifiers(){let t;if(typeof this.loss=="string")t=Bd(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(n=>Bd(n))}else{const n=Object.keys(this.loss);t={};const r=this.loss;for(const i of n)if(typeof r[i]=="string")t[i]=Bd(r[i]);else throw new Error("Serialization of non-string loss is not supported.")}return t}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Bd(rO(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>Bd(rO(t)));{const t={};for(const n in this.metrics)t[n]=Bd(rO(this.metrics[n]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=YY(t.optimizer_config),r=yp(n);let i;if(typeof t.loss=="string")i=i1(t.loss);else if(Array.isArray(t.loss))i=t.loss.map(a=>i1(a));else if(t.loss!=null){i={};for(const a in t.loss)i[a]=i1(t.loss[a])}let s;if(Array.isArray(t.metrics))s=t.metrics.map(a=>i1(a));else if(t.metrics!=null){s={};for(const a in t.metrics)s[a]=i1(t.metrics[a])}this.compile({loss:i,metrics:s,optimizer:r})}async save(t,n){if(typeof t=="string"){const u=OAe(t);if(u.length===0)throw new re(`Cannot find any save handlers for URL '${t}'`);if(u.length>1)throw new re(`Found more than one (${u.length}) save handlers for URL '${t}'`);t=u[0]}if(t.save==null)throw new re("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await DY(this.getNamedWeights(n)),i=!1,s=null,o={modelTopology:this.toJSON(s,i),format:rxt,generatedBy:`TensorFlow.js tfjs-layers v${ADe}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:c,specs:f}=await DY(await this.optimizer.getWeights(),u);r.specs.push(...f),r.data=IAe([r.data,c])}return this.userDefinedMetadata!=null&&(Rge(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=r.data,o.weightSpecs=r.specs,t.save(o)}setUserDefinedMetadata(t){Rge(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}J1.className="Model";Ee(J1);class MDe extends J1{}MDe.className="Functional";Ee(MDe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ST extends J1{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:m7("sequential_"),t.layers!=null)for(const n of t.layers)this.add(n)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new re(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const n=t instanceof ST||t instanceof J1;let r;if(n){if(r=t,r.outputs.length!==1)throw new re("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new re("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new re("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const i=abt({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(i)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(t.inboundNodes.length!==1)throw new re(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new re("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=pDe(this.outputs[0])}this.inboundNodes=[],new y7({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:By(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(i=>i.shape),outputShapes:this.outputs[0].shape})}else{const i=t.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,n){return this.model==null&&this.build(),this.model.call(t,n)}build(t){if(un(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new J1({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,n,r=console.log){this.built||this.build(),super.summary(t,n,r)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,n,r={}){if(!this.built)throw new gu("The model needs to be compiled before being used.");return this.model.evaluate(t,n,r)}async evaluateDataset(t,n){if(!this.built)throw new gu("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,n)}predict(t,n={}){return this.model==null&&this.build(),this.model.predict(t,n)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,n,r={}){if(!this.built)throw new gu("The model needs to be compiled before being used.");return this.model.fit(t,n,r)}async fitDataset(t,n){if(!this.built)throw new gu("The model needs to be compiled before being used.");return this.model.fitDataset(t,n)}async trainOnBatch(t,n){return this.model.trainOnBatch(t,n)}static fromConfig(t,n,r={},i=!1){let s,a={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new re("Legacy serialization format not supported yet.");s=n}else B(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),s=n.layers,delete n.layers,a=n;const o=new t(a);if(!(o instanceof ST))throw new Tt(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const l of s){const c=yp(l,void 0,i);i&&c.setFastWeightInitDuringBuild(!0),o.add(c)}return o}set stopTraining(t){if(this.model==null)throw new re("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new re("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),t.push(r)}return{name:this.name,layers:t}}}ST.className="Sequential";Ee(ST);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ixt(e){return new J1(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class So extends Gb{getConfig(){return{}}}class FDe extends So{apply(t,n=1){return qyt(t,n)}}FDe.className="elu";Ee(FDe);class ODe extends So{apply(t){return Tte(t)}}ODe.className="selu";Ee(ODe);class RDe extends So{apply(t){return id(t)}}RDe.className="relu";Ee(RDe);class PDe extends So{apply(t){return ce(()=>Py(6,id(t)))}}PDe.className="relu6";Ee(PDe);class LDe extends So{apply(t){return t}}LDe.className="linear";Ee(LDe);class BDe extends So{apply(t){return nh(t)}}BDe.className="sigmoid";Ee(BDe);class zDe extends So{apply(t){return Yyt(t)}}zDe.className="hardSigmoid";Ee(zDe);class UDe extends So{apply(t){return C_(t)}}UDe.className="softplus";Ee(UDe);class WDe extends So{apply(t){return Gyt(t)}}WDe.className="softsign";Ee(WDe);class VDe extends So{apply(t){return Ow(t)}}VDe.className="tanh";Ee(VDe);class Rne extends So{apply(t,n=-1){return Qz(t,n)}}Rne.className="softmax";Ee(Rne);class jDe extends So{apply(t,n=-1){return yte(t,n)}}jDe.className="logSoftmax";Ee(jDe);class HDe extends So{apply(t,n=1){return ce(()=>ne(nh(ne(t,n)),t))}}HDe.className="swish";Ee(HDe);class qDe extends So{apply(t){return ce(()=>ne(t,Ow(C_(t))))}}qDe.className="mish";Ee(qDe);function H0(e){return e.getClassName()}function pj(e,t={}){return DN(e,El.getMap().classNameMap,t,"activation")}function q0(e){if(e==null){const t={};return t.className="linear",t.config={},pj(t)}if(typeof e=="string"){const t={};return t.className=e,t.config={},pj(t)}else return e instanceof So?e:pj(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sxt(e){if(e!=null&&typeof e!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}class GDe extends Gb{}class YDe extends GDe{constructor(t){super(),sxt(t),this.l1=t==null||t.l1==null?.01:t.l1,this.l2=t==null||t.l2==null?.01:t.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(t){return ce(()=>{let n=di([1]);return this.hasL1&&(n=ke(n,qe(ne(this.l1,hi(t))))),this.hasL2&&(n=ke(n,qe(ne(this.l2,NN(t))))),ie(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,n){return new t({l1:n.l1,l2:n.l2})}}YDe.className="L1L2";Ee(YDe);const Wge={l1l2:"L1L2"};function Yn(e){return $ne(e)}function Vge(e,t={}){return DN(e,El.getMap().classNameMap,t,"regularizer")}function xr(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in Wge?Wge[e]:e,config:{}};return Vge(n)}else return e instanceof GDe?e:Vge(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class XDe extends Vt{constructor(t){super(t==null?{}:t),this.supportsMasking=!0,t!=null&&(this.maxValue=t.maxValue)}call(t,n){t=vt(t);let r=id(t);return this.maxValue!=null&&(r=sl(r,0,this.maxValue)),r}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},n=super.getConfig();return Object.assign(t,n),t}}XDe.className="ReLU";Ee(XDe);class KDe extends Vt{constructor(t){super(t==null?{}:t),this.DEFAULT_ALPHA=.3,t==null&&(t={}),this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const r=vt(t);return Uz(r,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}KDe.className="LeakyReLU";Ee(KDe);class ZDe extends Vt{constructor(t){if(super(t==null?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),this.supportsMasking=!0,this.alphaInitializer=yr(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=xr(t.alphaRegularizer),this.alphaConstraint=vi(t.alphaConstraint),t.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else if(typeof t.sharedAxes=="number")this.sharedAxes=[t.sharedAxes];else throw new re(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`)}build(t){t=un(t);const n=t.slice(1);if(this.sharedAxes!=null)for(const i of this.sharedAxes)n[i-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let i=1;i<t.length;++i)r[i]=t[i];this.inputSpec=[new gi({ndim:t.length,axes:r})],this.built=!0}call(t,n){return t=vt(t),Yz(t,this.alpha.read())}getConfig(){const t={alphaInitializer:kr(this.alphaInitializer),alphaRegularizer:Yn(this.alphaRegularizer),alphaConstraint:mi(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(t,n),t}}ZDe.className="PReLU";Ee(ZDe);class QDe extends Vt{constructor(t){if(super(t==null?{}:t),this.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==this.DEFAULT_ALPHA)throw new Tt(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const r=vt(t);return CN(r)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}QDe.className="ELU";Ee(QDe);class JDe extends Vt{constructor(t){super(t==null?{}:t),this.DEFAULT_THETA=1,t==null&&(t={}),this.theta=t.theta==null?this.DEFAULT_THETA:t.theta}call(t,n){const r=vt(t);return ne(r,Oe(yl(r,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},n=super.getConfig();return Object.assign(t,n),t}}JDe.className="ThresholdedReLU";Ee(JDe);class eIe extends Vt{constructor(t){super(t==null?{}:t),this.DEFAULT_AXIS=1,t==null&&(t={}),this.softmax=new Rne().apply,this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis}call(t,n){const r=vt(t);return this.softmax(r,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}eIe.className="Softmax";Ee(eIe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function K2(e,t,n){if(typeof e=="number")return By(e,t);if(e.length!==t)throw new re(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let r=0;r<t;++r){const i=e[r];if(!Wyt(i))throw new re(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${i}`)}return e}function Uc(e,t,n,r,i=1){if(e==null)return e;const s=t+(t-1)*(i-1);let a;return n==="same"?a=e:a=e-s+1,Math.floor((a+r-1)/r)}function Of(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+j0([n-t,0]);else if(r==="same")e=e*t;else throw new re(`Unsupport padding mode: ${r}.`);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pne(e,t){return ce(()=>(ei(t),t==="channelsFirst"?Kt(e,[0,2,3,1]):e))}function tIe(e,t){return ce(()=>(ei(t),t==="channelsFirst"?Kt(e,[0,2,3,4,1]):e))}function axt(e,t,n,r=1,i="valid",s,a=1){return ce(()=>{if(s==null&&(s=Zc()),ei(s),e.shape.length!==3)throw new re(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new re(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new re(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(s==="channelsFirst"&&(e=Kt(e,[0,2,1])),i==="causal")throw new Tt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=fte(e,t,r,i==="same"?"same":"valid","NWC",a);return n!=null&&(o=cf(o,n)),o})}function jge(e,t,n,r=[1,1],i="valid",s,a,o=null){return ce(()=>{if(s==null&&(s=Zc()),ei(s),e.rank!==3&&e.rank!==4)throw new re(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new re(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let l=Pne(e,s);if(i==="causal")throw new Tt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=JTe({x:l,filter:t,strides:r,pad:i==="same"?"same":"valid",dilations:a,dataFormat:"NHWC",bias:n,activation:o}),s==="channelsFirst"&&(l=Kt(l,[0,3,1,2])),l})}function oxt(e,t,n,r=[1,1,1],i="valid",s,a){return ce(()=>{if(s==null&&(s=Zc()),ei(s),e.rank!==4&&e.rank!==5)throw new re(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new re(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let o=tIe(e,s);if(i==="causal")throw new Tt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=uTe(o,t,r,i==="same"?"same":"valid","NDHWC",a),n!=null&&(o=cf(o,n)),s==="channelsFirst"&&(o=Kt(o,[0,4,1,2,3])),o})}class w7 extends Vt{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",w7.verifyArgs(n),this.rank=t,Ai(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Tt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=K2(n.kernelSize,t,"kernelSize"),this.strides=K2(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,Ql(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,ei(this.dataFormat),this.activation=q0(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=yr(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=vi(n.biasConstraint),this.biasRegularizer=xr(n.biasRegularizer),this.activityRegularizer=xr(n.activityRegularizer),this.dilationRate=K2(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new re(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new re(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new re(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(Ff("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!Cne(t.kernelSize,"number",1,3))throw new re(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:H0(this.activation),useBias:this.useBias,biasInitializer:kr(this.biasInitializer),biasRegularizer:Yn(this.biasRegularizer),activityRegularizer:Yn(this.activityRegularizer),biasConstraint:mi(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}class k_ extends w7{constructor(t,n){super(t,n),this.kernel=null,k_.verifyArgs(n),this.filters=n.filters,Ai(this.filters,"filters"),this.kernelInitializer=yr(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=vi(n.kernelConstraint),this.kernelRegularizer=xr(n.kernelRegularizer)}build(t){t=un(t);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new re(`The channel dimension of the input should be defined. Found ${t[n]}`);const r=t[n],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(t,n){return ce(()=>{t=vt(t);let r;const i=this.bias==null?null:this.bias.read(),s=J3e(this.activation.getClassName());if(s!=null&&this.rank===2)r=jge(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(this.rank===1)r=axt(t,this.kernel.read(),i,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=jge(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=oxt(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Tt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(t){t=un(t);const n=[],r=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let s=0;s<r.length;++s){const a=Uc(r[s],this.kernelSize[s],this.padding,this.strides[s],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[s]);n.push(a)}let i=[t[0]];return this.dataFormat==="channelsLast"?(i=i.concat(n),i.push(this.filters)):(i.push(this.filters),i=i.concat(n)),i}getConfig(){const t={filters:this.filters,kernelInitializer:kr(this.kernelInitializer),kernelRegularizer:Yn(this.kernelRegularizer),kernelConstraint:mi(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new re(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class RN extends k_{constructor(t){super(2,t),RN.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!Cne(t.kernelSize,"number",1,2))throw new re(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}RN.className="Conv2D";Ee(RN);class PN extends k_{constructor(t){super(3,t),PN.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new re(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}PN.className="Conv3D";Ee(PN);class nIe extends RN{constructor(t){if(super(t),this.inputSpec=[new gi({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new re(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=un(t),t.length!==4)throw new re("Input should have rank 4; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new re("The channel dimension of the inputs should be defined. Found `None`.");const r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new gi({ndim:4,axes:{[n]:r}})],this.built=!0}call(t,n){return ce(()=>{let r=vt(t);if(r.shape.length!==4)throw new re(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const i=r.shape,s=i[0];let a,o;this.dataFormat==="channelsFirst"?(a=2,o=3):(a=1,o=2);const l=i[a],u=i[o],c=this.kernelSize[0],f=this.kernelSize[1],h=this.strides[0],d=this.strides[1],p=Of(l,h,c,this.padding),g=Of(u,d,f,this.padding),m=[s,p,g,this.filters];this.dataFormat!=="channelsLast"&&(r=Kt(r,[0,2,3,1]));let v=dte(r,this.kernel.read(),m,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(v=Kt(v,[0,3,1,2])),this.bias!=null&&(v=cf(v,this.bias.read(),this.dataFormat)),this.activation!=null&&(v=this.activation.apply(v)),v})}computeOutputShape(t){t=un(t);const n=t.slice();let r,i,s;this.dataFormat==="channelsFirst"?(r=1,i=2,s=3):(r=3,i=1,s=2);const a=this.kernelSize[0],o=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return n[r]=this.filters,n[i]=Of(n[i],l,a,this.padding),n[s]=Of(n[s],u,o,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}nIe.className="Conv2DTranspose";Ee(nIe);class rIe extends PN{constructor(t){if(super(t),this.inputSpec=[new gi({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new re(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=un(t),t.length!==5)throw new re("Input should have rank 5; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new re("The channel dimension of the inputs should be defined. Found `None`.");const r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new gi({ndim:5,axes:{[n]:r}})],this.built=!0}call(t,n){return ce(()=>{let r=vt(t);if(r.shape.length!==5)throw new re(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const i=r.shape,s=i[0];let a,o,l;this.dataFormat==="channelsFirst"?(l=2,a=3,o=4):(l=1,a=2,o=3);const u=i[l],c=i[a],f=i[o],h=this.kernelSize[0],d=this.kernelSize[1],p=this.kernelSize[2],g=this.strides[0],m=this.strides[1],v=this.strides[2],y=Of(u,g,h,this.padding),b=Of(c,m,d,this.padding),x=Of(f,v,p,this.padding),w=[s,y,b,x,this.filters];this.dataFormat!=="channelsLast"&&(r=Kt(r,[0,2,3,4,1]));let C=fTe(r,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(C=Kt(C,[0,4,1,2,3])),this.bias!==null&&(C=cf(C,this.bias.read(),this.dataFormat)),this.activation!==null&&(C=this.activation.apply(C)),C})}computeOutputShape(t){t=un(t);const n=t.slice();let r,i,s,a;this.dataFormat==="channelsFirst"?(r=1,i=2,s=3,a=4):(r=4,i=1,s=2,a=3);const o=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],f=this.strides[1],h=this.strides[2];return n[r]=this.filters,n[i]=Of(n[i],c,o,this.padding),n[s]=Of(n[s],f,l,this.padding),n[a]=Of(n[a],h,u,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}rIe.className="Conv3DTranspose";Ee(rIe);class iIe extends k_{constructor(t,n){if(super(t,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new re("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new re("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new re(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=yr(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=xr(n.depthwiseRegularizer),this.depthwiseConstraint=vi(n.depthwiseConstraint),this.pointwiseInitializer=yr(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=xr(n.pointwiseRegularizer),this.pointwiseConstraint=vi(n.pointwiseConstraint)}build(t){if(t=un(t),t.length<this.rank+2)throw new re(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null||t[n]<0)throw new re(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[n])}`);const r=t[n],i=this.kernelSize.concat([r,this.depthMultiplier]),s=[];for(let o=0;o<this.rank;++o)s.push(1);s.push(r*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new gi({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(t,n){return ce(()=>{t=vt(t);let r;if(this.rank===1)throw new Tt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(t=Kt(t,[0,2,3,1])),r=Dte(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=cf(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=Kt(r,[0,3,1,2])),r})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=kr(this.depthwiseInitializer),t.pointwiseInitializer=kr(this.pointwiseInitializer),t.depthwiseRegularizer=Yn(this.depthwiseRegularizer),t.pointwiseRegularizer=Yn(this.pointwiseRegularizer),t.depthwiseConstraint=mi(this.depthwiseConstraint),t.pointwiseConstraint=mi(this.pointwiseConstraint),t}}iIe.className="SeparableConv";class sIe extends iIe{constructor(t){super(2,t)}}sIe.className="SeparableConv2D";Ee(sIe);class $7 extends k_{constructor(t){super(1,t),$7.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!Cne(t.kernelSize,"number",1,1))throw new re(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}$7.className="Conv1D";Ee($7);class aIe extends Vt{constructor(t){super(t),typeof t.cropping=="number"?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,n){return ce(()=>{if(t=vt(t),this.dataFormat==="channelsLast"){const r=nO(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return nO(r,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=nO(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return nO(r,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}aIe.className="Cropping2D";Ee(aIe);class oIe extends Vt{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=t.size==null?this.DEFAULT_SIZE:t.size,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,ei(this.dataFormat),this.interpolation=t.interpolation==null?"nearest":t.interpolation,Byt(this.interpolation)}computeOutputShape(t){if(this.dataFormat==="channelsFirst"){const n=t[2]==null?null:this.size[0]*t[2],r=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],n,r]}else{const n=t[1]==null?null:this.size[0]*t[1],r=t[2]==null?null:this.size[1]*t[2];return[t[0],n,r,t[3]]}}call(t,n){return ce(()=>{let r=vt(t);const i=r.shape;if(this.dataFormat==="channelsFirst"){r=Kt(r,[0,2,3,1]);const s=this.size[0]*i[2],a=this.size[1]*i[3],o=this.interpolation==="nearest"?Zf.resizeNearestNeighbor(r,[s,a]):Zf.resizeBilinear(r,[s,a]);return Kt(o,[0,3,1,2])}else{const s=this.size[0]*i[1],a=this.size[1]*i[2];return this.interpolation==="nearest"?Zf.resizeNearestNeighbor(r,[s,a]):Zf.resizeBilinear(r,[s,a])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}}oIe.className="UpSampling2D";Ee(oIe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lxt(e,t,n=[1,1],r="valid",i,s){return ce(()=>{i==null&&(i=Zc()),ei(i);let a=Pne(e,i);if(e.rank!==4)throw new re(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new re(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return a=$N(a,t,n,r==="same"?"same":"valid","NHWC",s),i==="channelsFirst"&&(a=Kt(a,[0,3,1,2])),a})}class lIe extends w7{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=yr(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=vi(t.depthwiseConstraint),this.depthwiseRegularizer=xr(t.depthwiseRegularizer)}build(t){if(t=un(t),t.length<4)throw new re(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(t[n]==null||t[n]<0)throw new re(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[n]}).`);const r=t[n],i=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",i,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return ce(()=>{t=vt(t);let r=lxt(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=cf(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(t){t=un(t);const n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,s=Uc(n,this.kernelSize[0],this.padding,this.strides[0]),a=Uc(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],i,s,a]:[t[0],s,a,i]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=kr(this.depthwiseInitializer),t.depthwiseRegularizer=Yn(this.depthwiseRegularizer),t.depthwiseConstraint=mi(this.depthwiseRegularizer),t}}lIe.className="DepthwiseConv2D";Ee(lIe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function uIe(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new re("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(s){return s==null||Array.isArray(s)?s:[s]}return t=i(t),n=i(n),{inputs:e,initialState:t,constants:n}}function cIe(e,t,n,r=!1,i,s,a=!1,o=!1){return ce(()=>{const l=t.shape.length;if(l<3)throw new re(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(Kc(2,l));if(t=Kt(t,u),s!=null)throw new Tt("The rnn() functoin of the deeplearn.js backend does not support constants yet.");a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&(i=Oe(Oe(i,"bool"),"float32"),i.rank===l-1&&(i=Ha(i,-1)),i=Kt(i,u)),r&&(t=Fu(t,0),i!=null&&(i=Fu(i,0)));const c=[];let f,h=n;const d=t.shape[0],p=V0(t);let g;i!=null&&(g=V0(i));for(let v=0;v<d;++v){const y=p[v],b=ce(()=>e(y,h));if(i==null)f=b[0],h=b[1];else{const x=ce(()=>{const w=g[v],C=We(jl(w),w),$=ke(ne(b[0],w),ne(h[0],C)),_=h.map((k,E)=>ke(ne(b[1][E],w),ne(k,C)));return{output:$,newStates:_}});f=x.output,h=x.newStates}o&&c.push(f)}let m;return o&&(m=Np(c,1)),[f,m,h]})}class Hm extends Vt{constructor(t){super(t);let n;if(t.cell==null)throw new re("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?n=new zne({cells:t.cell}):n=t.cell,n.stateSize==null)throw new re("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new gi({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Kc(0,t).map(n=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){HY(t)&&(t=t[0]),t=t;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let i;if(this.returnSequences?i=[t[0],t[1],r]:i=[t[0],r],this.returnState){const s=[];for(const a of n)s.push([t[0],a]);return[i].concat(s)}else return i}computeMask(t,n){return ce(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const i=this.states.map(s=>null);return[r].concat(i)}else return r})}get states(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<t;++r)n.push(null);return n}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new Tt("Constants support is not implemented in RNN yet.");HY(t)&&(t=t[0]),t=t;const n=this.stateful?t[0]:null,r=t.slice(2);this.inputSpec[0]=new gi({shape:[n,null,...r]});const i=[t[0]].concat(t.slice(2));this.cell.build(i);let s;if(Array.isArray(this.cell.stateSize)?s=this.cell.stateSize:s=[this.cell.stateSize],this.stateSpec!=null){if(!Zt(this.stateSpec.map(a=>a.shape[a.shape.length-1]),s))throw new re(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=s.map(a=>new gi({shape:[null,a]}));this.stateful&&this.resetStates()}resetStates(t,n=!1){ce(()=>{if(!this.stateful)throw new Mf("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new re("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>di([r,i])):this.states_=[di([r,this.cell.stateSize])];else if(t==null)Bt(this.states_),this.keptStates!=null&&(Bt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>di([r,i])):this.states_[0]=di([r,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new re(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n===!0?this.keptStates.push(this.states_.slice()):Bt(this.states_);for(let i=0;i<this.states_.length;++i){const s=t[i],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[i]:this.cell.stateSize,o=[r,a];if(!Zt(s.shape,o))throw new re(`State ${i} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${s.shape}`);this.states_[i]=s}}this.states_=this.states_.map(i=>zc(i.clone()))})}apply(t,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const s=uIe(t,r,i,this.numConstants);t=s.inputs,r=s.initialState,i=s.constants;let a=[],o=[];if(r!=null){n.initialState=r,a=a.concat(r),this.stateSpec=[];for(const u of r)this.stateSpec.push(new gi({shape:u.shape}));o=o.concat(this.stateSpec)}if(i!=null&&(n.constants=i,a=a.concat(i),this.numConstants=i.length),a[0]instanceof Qf){const u=[t].concat(a),c=this.inputSpec.concat(o),f=this.inputSpec;this.inputSpec=c;const h=super.apply(u,n);return this.inputSpec=f,h}else return super.apply(t,n)}call(t,n){return ce(()=>{const r=n==null?null:n.mask,i=n==null?null:n.training;let s=n==null?null:n.initialState;t=vt(t),s==null&&(this.stateful?s=this.states_:s=this.getInitialState(t));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==a)throw new re(`RNN Layer has ${a} state(s) but was passed ${s.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:i},u=cIe((p,g)=>{const m=this.cell.call([p].concat(g),o);return[m[0],m.slice(1)]},t,s,this.goBackwards,r,null,this.unroll,this.returnSequences),c=u[0],f=u[1],h=u[2];this.stateful&&this.resetStates(h,i);const d=this.returnSequences?f:c;return this.returnState?[d].concat(h):d})}getInitialState(t){return ce(()=>{let n=di(t.shape);return n=qe(n,[1,2]),n=IN(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?VY(n,[1,r]):n):this.cell.stateSize>1?[VY(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===Hm.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),t),n)}static fromConfig(t,n,r={}){const i=n.cell,s=yp(i,r);return new t(Object.assign(n,{cell:s}))}}Hm.className="RNN";Ee(Hm);class C7 extends Vt{}class Lne extends C7{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Ai(this.units,"units"),this.activation=q0(t.activation==null?this.DEFAULT_ACTIVATION:t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=yr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=yr(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=yr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=xr(t.kernelRegularizer),this.recurrentRegularizer=xr(t.recurrentRegularizer),this.biasRegularizer=xr(t.biasRegularizer),this.kernelConstraint=vi(t.kernelConstraint),this.recurrentConstraint=vi(t.recurrentConstraint),this.biasConstraint=vi(t.biasConstraint),this.dropout=Lw([1,j0([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Lw([1,j0([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=un(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return ce(()=>{if(t=t,t.length!==2)throw new re(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let r=t[1];t=t[0];const i=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=G0({ones:()=>jl(t),rate:this.dropout,training:i,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=G0({ones:()=>jl(r),rate:this.recurrentDropout,training:i,dropoutFunc:this.dropoutFunc}));let s;const a=this.dropoutMask,o=this.recurrentDropoutMask;a!=null?s=sh(ne(t,a),this.kernel.read()):s=sh(t,this.kernel.read()),this.bias!=null&&(s=cf(s,this.bias.read())),o!=null&&(r=ne(r,o));let l=ke(s,sh(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:H0(this.activation),useBias:this.useBias,kernelInitializer:kr(this.kernelInitializer),recurrentInitializer:kr(this.recurrentInitializer),biasInitializer:kr(this.biasInitializer),kernelRegularizer:Yn(this.kernelRegularizer),recurrentRegularizer:Yn(this.recurrentRegularizer),biasRegularizer:Yn(this.biasRegularizer),activityRegularizer:Yn(this.activityRegularizer),kernelConstraint:mi(this.kernelConstraint),recurrentConstraint:mi(this.recurrentConstraint),biasConstraint:mi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},t),n)}}Lne.className="SimpleRNNCell";Ee(Lne);class fIe extends Hm{constructor(t){t.cell=new Lne(t),super(t)}call(t,n){return ce(()=>{this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}static fromConfig(t,n){return new t(n)}}fIe.className="SimpleRNN";Ee(fIe);class Bne extends C7{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new re("GRUCell does not support reset_after parameter set to true.");this.units=t.units,Ai(this.units,"units"),this.activation=q0(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=q0(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=yr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=yr(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=yr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=xr(t.kernelRegularizer),this.recurrentRegularizer=xr(t.recurrentRegularizer),this.biasRegularizer=xr(t.biasRegularizer),this.kernelConstraint=vi(t.kernelConstraint),this.recurrentConstraint=vi(t.recurrentConstraint),this.biasConstraint=vi(t.biasConstraint),this.dropout=Lw([1,j0([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Lw([1,j0([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=un(t);const n=t[t.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return ce(()=>{if(t=t,t.length!==2)throw new re(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const r=n.training==null?!1:n.training;let i=t[1];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=G0({ones:()=>jl(t),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=G0({ones:()=>jl(i),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,a=this.recurrentDropoutMask;let o,l,u;0<this.dropout&&this.dropout<1&&(t=ne(t,s[0]));let c=sh(t,this.kernel.read());this.useBias&&(c=cf(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=ne(i,a[0]));const f=this.recurrentKernel.read(),[h,d]=Jo(f,[2*this.units,this.units],f.rank-1),p=sh(i,h),[g,m,v]=Jo(c,3,c.rank-1),[y,b]=Jo(p,2,p.rank-1);o=this.recurrentActivation.apply(ke(g,y)),l=this.recurrentActivation.apply(ke(m,b));const x=sh(ne(l,i),d);u=this.activation.apply(ke(v,x));const w=ke(ne(o,i),ne(ke(1,ur(o)),u));return[w,w]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:H0(this.activation),recurrentActivation:H0(this.recurrentActivation),useBias:this.useBias,kernelInitializer:kr(this.kernelInitializer),recurrentInitializer:kr(this.recurrentInitializer),biasInitializer:kr(this.biasInitializer),kernelRegularizer:Yn(this.kernelRegularizer),recurrentRegularizer:Yn(this.recurrentRegularizer),biasRegularizer:Yn(this.biasRegularizer),activityRegularizer:Yn(this.activityRegularizer),kernelConstraint:mi(this.kernelConstraint),recurrentConstraint:mi(this.recurrentConstraint),biasConstraint:mi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},t),n)}}Bne.className="GRUCell";Ee(Bne);class hIe extends Hm{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new Bne(t),super(t)}call(t,n){return ce(()=>{this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}hIe.className="GRU";Ee(hIe);class _7 extends C7{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Ai(this.units,"units"),this.activation=q0(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=q0(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=yr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=yr(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=yr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=xr(t.kernelRegularizer),this.recurrentRegularizer=xr(t.recurrentRegularizer),this.biasRegularizer=xr(t.biasRegularizer),this.kernelConstraint=vi(t.kernelConstraint),this.recurrentConstraint=vi(t.recurrentConstraint),this.biasConstraint=vi(t.biasConstraint),this.dropout=Lw([1,j0([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Lw([1,j0([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var n;t=un(t);const r=t[t.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let i;if(this.useBias){if(this.unitForgetBias){const s=this.biasInitializer,a=this.units;i=new(n=class extends qu{apply(l,u){const c=s.apply([a]),f=new Sne().apply([a]),h=s.apply([a*2]);return Ege(Ege(c,f),h)}},n.className="CustomInit",n)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,n){return ce(()=>{const r=n.training==null?!1:n.training;if(t=t,t.length!==3)throw new re(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let i=t[1];const s=t[2];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=G0({ones:()=>jl(t),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=G0({ones:()=>jl(i),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,o=this.recurrentDropoutMask;let l,u,c,f;0<this.dropout&&this.dropout<1&&(t=ne(t,a[0]));let h=sh(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=ne(i,o[0])),h=ke(h,sh(i,this.recurrentKernel.read())),this.useBias&&(h=cf(h,this.bias.read()));const[d,p,g,m]=Jo(h,4,h.rank-1);l=this.recurrentActivation.apply(d),u=this.recurrentActivation.apply(p),c=ke(ne(u,s),ne(l,this.activation.apply(g))),f=this.recurrentActivation.apply(m);const v=ne(f,this.activation.apply(c));return[v,v,c]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:H0(this.activation),recurrentActivation:H0(this.recurrentActivation),useBias:this.useBias,kernelInitializer:kr(this.kernelInitializer),recurrentInitializer:kr(this.recurrentInitializer),biasInitializer:kr(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Yn(this.kernelRegularizer),recurrentRegularizer:Yn(this.recurrentRegularizer),biasRegularizer:Yn(this.biasRegularizer),activityRegularizer:Yn(this.activityRegularizer),kernelConstraint:mi(this.kernelConstraint),recurrentConstraint:mi(this.recurrentConstraint),biasConstraint:mi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},t),n)}}_7.className="LSTMCell";Ee(_7);class dIe extends Hm{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new _7(t),super(t)}call(t,n){return ce(()=>{this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}dIe.className="LSTM";Ee(dIe);class zne extends C7{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?t.push(...n.stateSize):t.push(n.stateSize);return t}call(t,n){return ce(()=>{t=t;let r=t.slice(1);const i=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?i.push(r.splice(0,o.stateSize.length)):i.push(r.splice(0,1));i.reverse();const s=[];let a;for(let o=0;o<this.cells.length;++o){const l=this.cells[o];r=i[o],o===0?a=[t[0]].concat(r):a=[a[0]].concat(r),a=l.call(a,n),s.push(a.slice(1))}r=[];for(const o of s.slice().reverse())r.push(...o);return[a[0]].concat(r)})}build(t){HY(t)&&(t=t[0]),t=t;let n;this.cells.forEach((r,i)=>{Z1(`RNNCell_${i}`,()=>{r.build(t),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,t=[t[0],n]})}),this.built=!0}getConfig(){const t=super.getConfig(),n=s=>({className:s.getClassName(),config:s.getConfig()}),i={cells:this.cells.map(n)};return Object.assign(Object.assign({},t),i)}static fromConfig(t,n,r={}){const i=[];for(const s of n.cells)i.push(yp(s,r));return new t({cells:i})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.cells)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(t)}return t}getWeights(){const t=[];for(const n of this.cells)t.push(...n.weights);return qY(t)}setWeights(t){const n=[];for(const r of this.cells){const i=r.weights.length,s=t.splice(i);for(let a=0;a<r.weights.length;++a)n.push([r.weights[a],s[a]])}Nne(n)}}zne.className="StackedRNNCells";Ee(zne);function G0(e){const{ones:t,rate:n,training:r=!1,count:i=1,dropoutFunc:s}=e,a=()=>s!=null?s(t(),n):aDe(t(),n),o=()=>MN(a,t,r);return!i||i<=1?zc(o().clone()):Array(i).fill(void 0).map(o).map(u=>zc(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var uxt=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class pIe extends Hm{constructor(t){if(t.unroll)throw new Tt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new Tt("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new gi({ndim:5})]}call(t,n){return ce(()=>{if(this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new re("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}computeOutputShape(t){let n=this.computeSingleOutputShape(t);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([t[0],...n.slice(-3)])]),n}getInitialState(t){return ce(()=>{const{stateSize:n}=this.cell,r=t.shape,i=this.computeSingleOutputShape(r),s=[i[0],...i.slice(2)],a=di(s);return Array.isArray(n)?Array(n.length).fill(a):[a]})}resetStates(t,n=!1){ce(()=>{if(!this.stateful)throw new Mf("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,i=this.computeSingleOutputShape(r),s=[i[0],...i.slice(2)];if(r[0]==null)throw new re("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>di(s)):this.states_=[di(s)];else if(t==null)Bt(this.states_),this.keptStates!=null&&(Bt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>di(s)):this.states_[0]=di(s);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new re(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n?this.keptStates.push(this.states_.slice()):Bt(this.states_);for(let o=0;o<this.states_.length;++o){const l=t[o],u=s;if(!Zt(l.shape,u))throw new re(`State ${o} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(o=>zc(o.clone()))})}computeSingleOutputShape(t){const{dataFormat:n,filters:r,kernelSize:i,padding:s,strides:a,dilationRate:o}=this.cell,l=n==="channelsFirst",u=t[l?3:2],c=t[l?4:3],f=Uc(u,i[0],s,a[0],o[0]),h=Uc(c,i[1],s,a[1],o[1]);return[...t.slice(0,2),...l?[r,f,h]:[f,h,r]]}}pIe.className="ConvRNN2D";class Une extends _7{constructor(t){const{filters:n,kernelSize:r,strides:i,padding:s,dataFormat:a,dilationRate:o}=t;super(Object.assign(Object.assign({},t),{units:n})),this.filters=n,Ai(this.filters,"filters"),this.kernelSize=K2(r,2,"kernelSize"),this.kernelSize.forEach(l=>Ai(l,"kernelSize")),this.strides=K2(i||1,2,"strides"),this.strides.forEach(l=>Ai(l,"strides")),this.padding=s||"valid",Ql(this.padding),this.dataFormat=a||"channelsLast",ei(this.dataFormat),this.dilationRate=K2(o||1,2,"dilationRate"),this.dilationRate.forEach(l=>Ai(l,"dilationRate"))}build(t){var n;t=un(t);const r=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[r]==null)throw new re(`The channel dimension of the input should be defined. Found ${t[r]}`);const i=t[r],s=4,a=this.kernelSize.concat([i,this.filters*s]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*s]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,c=this.filters;l=new(n=class extends qu{apply(h,d){const p=u.apply([c]),g=Dl([c]),m=u.apply([c*2]);return _ne([p,g,m])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*s],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,n){return ce(()=>{if(t.length!==3)throw new re(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const r=n.training||!1,i=t[0],s=t[1],a=t[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=G0({ones:()=>jl(i),rate:this.dropout,training:r,count:o,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(V,z,q)=>!z||!z[q]?V:ne(z[q],V);let c=u(i,l,0),f=u(i,l,1),h=u(i,l,2),d=u(i,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=G0({ones:()=>jl(s),rate:this.recurrentDropout,training:r,count:o,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let g=u(s,p,0),m=u(s,p,1),v=u(s,p,2),y=u(s,p,3);const b=3,[x,w,C,$]=Jo(this.kernel.read(),o,b),[_,k,E,S]=this.useBias?Jo(this.bias.read(),o):[null,null,null,null];c=this.inputConv(c,x,_,this.padding),f=this.inputConv(f,w,k,this.padding),h=this.inputConv(h,C,E,this.padding),d=this.inputConv(d,$,S,this.padding);const[I,A,D,T]=Jo(this.recurrentKernel.read(),o,b);g=this.recurrentConv(g,I),m=this.recurrentConv(m,A),v=this.recurrentConv(v,D),y=this.recurrentConv(y,T);const N=this.recurrentActivation.apply(ke(c,g)),F=this.recurrentActivation.apply(ke(f,m)),R=ke(ne(F,a),ne(N,this.activation.apply(ke(h,v)))),P=ne(this.recurrentActivation.apply(ke(d,y)),this.activation.apply(R));return[P,P,R]})}getConfig(){const t=super.getConfig(),n=uxt(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(t,n,r,i){const s=U0(t,n,this.strides,i||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?cf(s,r,this.dataFormat):s}recurrentConv(t,n){return U0(t,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}Une.className="ConvLSTM2DCell";Ee(Une);class gIe extends pIe{constructor(t){const n=new Une(t);super(Object.assign(Object.assign({},t),{cell:n}))}static fromConfig(t,n){return new t(n)}}gIe.className="ConvLSTM2D";Ee(gIe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Wne extends Vt{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(this.noiseShape==null)return this.noiseShape;const n=t.shape,r=[];for(let i=0;i<this.noiseShape.length;++i)r.push(this.noiseShape[i]==null?n[i]:this.noiseShape[i]);return r}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t);if(0<this.rate&&this.rate<1){const i=n.training==null?!1:n.training,s=this.getNoiseShape(r);return MN(()=>aDe(r,this.rate,s,this.seed),()=>r,i)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(t,n),t}dispose(){return super.dispose()}}Wne.className="Dropout";Ee(Wne);class mIe extends Wne{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const n=t.shape;return[n[0],1,n[2]]}}mIe.className="SpatialDropout1D";Ee(mIe);class vIe extends Vt{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){let n=null;t.batchSize!=null&&(n=t.batchSize),this.batchInputShape=[n,t.inputDim]}this.units=t.units,Ai(this.units,"units"),this.activation=q0(t.activation),t.useBias!=null&&(this.useBias=t.useBias),this.kernelInitializer=yr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=yr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=vi(t.kernelConstraint),this.biasConstraint=vi(t.biasConstraint),this.kernelRegularizer=xr(t.kernelRegularizer),this.biasRegularizer=xr(t.biasRegularizer),this.activityRegularizer=xr(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=un(t);const n=t[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(t){t=un(t);const n=t.slice();return n[n.length-1]=this.units,n}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t),i=J3e(this.activation.getClassName());let s;return i!=null?s=sh(r,this.kernel.read(),i,this.bias?this.bias.read():null):(s=sh(r,this.kernel.read()),this.bias!=null&&(s=cf(s,this.bias.read())),this.activation!=null&&(s=this.activation.apply(s))),s})}getConfig(){const t={units:this.units,activation:H0(this.activation),useBias:this.useBias,kernelInitializer:kr(this.kernelInitializer),biasInitializer:kr(this.biasInitializer),kernelRegularizer:Yn(this.kernelRegularizer),biasRegularizer:Yn(this.biasRegularizer),activityRegularizer:Yn(this.activityRegularizer),kernelConstraint:mi(this.kernelConstraint),biasConstraint:mi(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}vIe.className="Dense";Ee(vIe);class yIe extends Vt{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=un(t);for(const n of t.slice(1))if(n==null)throw new re(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],g0(t,1)]}call(t,n){return ce(()=>{this.invokeCallHook(t,n);let r=vt(t);if(this.dataFormat==="channelsFirst"&&r.rank>1){const i=[0];for(let s=2;s<r.rank;++s)i.push(s);i.push(1),r=Kt(r,i)}return Hyt(r)})}getConfig(){const t={};this.dataFormat!=null&&(t.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(t,n),t}}yIe.className="Flatten";Ee(yIe);class bIe extends Vt{constructor(t){super(t),this.supportsMasking=!0,this.activation=q0(t.activation)}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t);return this.activation.apply(r)})}getConfig(){const t={activation:H0(this.activation)},n=super.getConfig();return Object.assign(t,n),t}}bIe.className="Activation";Ee(bIe);class xIe extends Vt{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,n){return ce(()=>(t=vt(t),Vyt(t,this.n)))}getConfig(){const t={n:this.n},n=super.getConfig();return Object.assign(t,n),t}}xIe.className="RepeatVector";Ee(xIe);class wIe extends Vt{constructor(t){super(t),this.targetShape=t.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(t){return t<0||t==null}fixUnknownDimension(t,n){const r="Total size of new array must be unchanged.",i=n.slice();let s=1,a=null;for(let l=0;l<i.length;++l){const u=i[l];if(this.isUnknown(u))if(a===null)a=l;else throw new re("Can only specifiy one unknown dimension.");else s*=u}const o=g0(t);if(a!==null){if(s===0||o%s!==0)throw new re(r);i[a]=o/s}else if(o!==s)throw new re(r);return i}computeOutputShape(t){let n=!1;for(let r=0;r<t.length;++r)if(this.isUnknown(t[r])){n=!0;break}return n?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t),i=r.shape,s=i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape));return ie(r,s)})}getConfig(){const t={targetShape:this.targetShape},n=super.getConfig();return Object.assign(t,n),t}}wIe.className="Reshape";Ee(wIe);class $Ie extends Vt{constructor(t){if(super(t),t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const n=Kc(1,t.dims.length+1);if(!Zt(t.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new gi({ndim:this.dims.length+1})]}computeOutputShape(t){t=un(t);const n=t.slice();return this.dims.forEach((r,i)=>{n[i+1]=t[r]}),n}call(t,n){return Kt(vt(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},n=super.getConfig();return Object.assign(t,n),t}}$Ie.className="Permute";Ee($Ie);class CIe extends Vt{constructor(t){super(t==null?{}:t),this.supportsMasking=!0,t!=null?this.maskValue=t.maskValue==null?0:t.maskValue:this.maskValue=0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,t),n}computeMask(t,n){const r=vt(t),i=-1;return S5(Rw(r,this.maskValue),i)}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t),i=-1,s=!0,a=S5(Rw(r,this.maskValue),i,s);return ne(r,Oe(a,r.dtype))})}}CIe.className="Masking";Ee(CIe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _Ie extends Vt{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){let n=null;t.batchSize!=null&&(n=t.batchSize),t.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(sr(t.inputLength))}this.inputDim=t.inputDim,Ai(this.inputDim,"inputDim"),this.outputDim=t.outputDim,Ai(this.outputDim,"outputDim"),this.embeddingsInitializer=yr(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=xr(t.embeddingsRegularizer),this.activityRegularizer=xr(t.activityRegularizer),this.embeddingsConstraint=vi(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,n){return ce(()=>this.maskZero?(t=vt(t),Rw(t,en(t))):null)}computeOutputShape(t){if(t=un(t),this.inputLength==null)return[...t,this.outputDim];const n=sr(this.inputLength);if(n.length!==t.length-1)throw new re(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let r=0;for(let i=0;i<n.length;++i){const s=n[i],a=t[i+1];if(s!=null&&a!=null&&s!==a)throw new re(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);s==null&&(n[r]=a),r++}}return[t[0],...n,this.outputDim]}call(t,n){return ce(()=>{this.invokeCallHook(t,n);let r=vt(t);r.dtype!=="int32"&&(r=ih(r,"int32"));const i=sDe(this.embeddings.read(),ie(r,[r.size]));return ie(i,un(this.computeOutputShape(r.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:kr(this.embeddingsInitializer),embeddingsRegularizer:Yn(this.embeddingsRegularizer),activityRegularizer:Yn(this.activityRegularizer),embeddingsConstraint:mi(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(t,n),t}}_Ie.className="Embedding";Ee(_Ie);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Xb extends Vt{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new Tt}computeElementwiseOpOutputShape(t,n){if(t==null||n==null)return null;if(t.length<n.length)return this.computeElementwiseOpOutputShape(n,t);if(n.length===0)return t;const r=t.slice(0,t.length-n.length);for(let i=0;i<n.length;++i){const s=t[t.length-n.length+i],a=n[i];if(s==null||a==null||s<0||a<0)r.push(null);else if(s===1)r.push(a);else if(a===1)r.push(s);else{if(s!==a)throw new re("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(n));r.push(s)}}return r}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[un(t)]),t=t,t.length<2)throw new re(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let n=[];for(const s of t)s!=null&&s[0]!==null&&n.push(s[0]);if(n=p0(n),n.length>1)throw new re(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let r=t[0]==null?null:t[0].slice(1);for(let s=1;s<t.length;++s){const a=t[s]==null?null:t[s].slice(1);r=this.computeElementwiseOpOutputShape(r,a)}const i=t.map(s=>s.length);t.indexOf(null)===-1&&p0(i).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,n){return ce(()=>{if(t=t,this.reshapeRequired){const r=[],i=t.map(s=>s.rank);if(i.indexOf(null)===-1){const s=j0(i);for(let a of t){const o=a.rank;for(let l=0;l<s-o;++l)a=IN(a,1);r.push(a)}return this.mergeFunction(r)}else{let s=!1;for(const l of t){const u=l.rank;if(u==null){const c=l.shape,f=c[0],h=c.slice(1).concat([f]);let d=ie(l,[f].concat(g0(c.slice(1))));d=Kt(d,[1,0]),d=ie(d,h),r.push(d),s=!0}else if(u>1){const c=Kc(1,u).concat([0]);r.push(Kt(l,c)),s=!0}else r.push(l)}let a=this.mergeFunction(r);const o=a.rank;if(s){if(o==null){const l=a.shape,u=l.length,c=l[u-1],f=[c].concat(l.slice(0,l.length-1));a=ie(Kt(ie(a,[-1,c]),[1,0]),f)}else if(o>1){const l=[o-1].concat(Kc(0,o-1));a=Kt(a,l)}}return a}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let n;t[0]==null?n=null:n=t[0].slice(1);for(let i=1;i<t.length;++i){const s=t[i]==null?null:t[i].slice(1);n=this.computeElementwiseOpOutputShape(n,s)}let r=[];for(const i of t)i!=null&&i[0]!==null&&r.push(i[0]);return r=p0(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(t,n){return ce(()=>{if(n==null)return null;if(!Array.isArray(n))throw new re("`mask` should be an Array");if(!Array.isArray(t))throw new re("`inputs` should be an Array");if(n.length!==t.length)throw new re(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${n.length})`);if(n.every(i=>i==null))return null;n=n.map(i=>i==null?i:Ha(i,0));let r=n[0];for(let i=1;i<n.length-1;++i)r=Mh(r,n[i]);return r})}}class SIe extends Xb{constructor(t){super(t)}mergeFunction(t){return ce(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=ke(n,t[r]);return n})}}SIe.className="Add";Ee(SIe);class kIe extends Xb{constructor(t){super(t)}mergeFunction(t){return ce(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=ne(n,t[r]);return n})}}kIe.className="Multiply";Ee(kIe);class EIe extends Xb{constructor(t){super(t)}mergeFunction(t){return ce(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=ke(n,t[r]);return ne(1/t.length,n)})}}EIe.className="Average";Ee(EIe);class AIe extends Xb{constructor(t){super(t)}mergeFunction(t){return ce(()=>{let n=t[0];for(let r=1;r<t.length;++r)n=rg(n,t[r]);return n})}}AIe.className="Maximum";Ee(AIe);class TIe extends Xb{constructor(t){super(t)}mergeFunction(t){return ce(()=>{let n=t[0];for(let r=1;r<t.length;++r)n=Py(n,t[r]);return n})}}TIe.className="Minimum";Ee(TIe);class DIe extends Xb{constructor(t){super(t),this.DEFAULT_AXIS=-1,t==null&&(t={}),this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!(Array.isArray(t)&&Array.isArray(t[0]))||t.length===1)throw new re("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let n=!0;for(const i of t)if(i!=null){n=!1;break}if(n)return;const r=[];for(let i=0;i<t.length;++i){const s=t[i].slice();s.splice(this.axis,1);let a=!1;for(const o of r)if(Zt(o,s)){a=!0;break}a||r.push(s)}if(r.length>1)throw new re("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return ce(()=>_ne(t,this.axis))}computeOutputShape(t){if(!(Array.isArray(t)&&Array.isArray(t[0])))throw new re("A `Concatenate` layer should be called on a list of inputs.");const n=t,r=n[0].slice(),i=this.axis<0?r.length+this.axis:this.axis;for(const s of n.slice(1)){if(r[i]==null||s[i]==null){r[i]=null;break}r[i]+=s[i]}return r}computeMask(t,n){if(n==null)return null;if(!Array.isArray(n))throw new re("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new re("`inputs` should be an array for Concatenate");if(n.length!==t.length)throw new re(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${t.length})`);return ce(()=>{let r=!0;if(n.forEach(a=>{if(a!=null){r=!1;return}}),r)return null;const i=[];for(let a=0;a<t.length;++a)n[a]==null?i.push(Oe(jl(t[a]),"bool")):n[a].rank<t[a].rank?i.push(Ha(n[a],-1)):i.push(n[a]);const s=Di(i,this.axis);return ute(s,-1,!1)})}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}DIe.className="Concatenate";Ee(DIe);function XS(e,t){for(;e<0;)e+=t;return e}function cxt(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Tt("batchDot is not implemented for tensors of 4D or higher rank yet");if(B(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),B(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new Tt("batchDot is not implemented for complex64-type Tensors yet.");const r=e.shape.length,i=t.shape.length;n==null&&(n=[r-1,i-2]);const s=n;return ce(()=>{let a;if(r>i){a=r-i;const l=[];for(let u=0;u<a;++u)l.push(1);t=ie(t,t.shape.concat(l))}else if(i>r){a=i-r;const l=[];for(let u=0;u<a;++u)l.push(1);e=ie(e,e.shape.concat(l))}else a=0;let o;if(e.shape.length===2&&t.shape.length===2)s[0]===s[1]?o=qe(ne(e,t),s[0]):o=qe(ne(Kt(e,[1,0]),t),s[1]);else{const l=s[0]!==e.shape.length-1,u=s[1]===t.shape.length-1;o=Pt(e,t,l,u)}if(a>0){let l;r>i?l=r+i-3:l=r-1;const u=[];for(let c=l;c<l+a;++c)u.push(c);o=qb(o,u)}return o.shape.length===1&&(o=Ha(o,1)),o})}class IIe extends Xb{constructor(t){super(t),this.axes=t.axes,this.normalize=t.normalize==null?!1:t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){B(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0],r=t[1];if(n.length>3||r.length>3)throw new Tt("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,r);if(n[i[0]]!==r[i[1]])throw new re(`Dimension incompatibility: ${n[i[0]]} !== ${r[i[1]]}`)}mergeFunction(t){if(t.length!==2)throw new re(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let n=t[0],r=t[1],i;return Array.isArray(this.axes)?i=this.axes.map((s,a)=>XS(s,t[a].shape.length)):i=[XS(this.axes,n.shape.length),XS(this.axes,r.shape.length)],this.normalize&&(n=I5(n,i[0]),r=I5(r,i[1])),cxt(n,r,i)}interpretAxes(t,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[XS(this.axes,t.length),XS(this.axes,n.length)],r}computeOutputShape(t){B(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0].slice(),r=t[1].slice();if(n.length>3||r.length>3)throw new Tt("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,r);n.splice(i[0],1),r.splice(i[1],1),r.splice(0,1);const s=n.concat(r);return s.length===1&&s.push(1),s}computeMask(t,n){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(t,n),t}}IIe.className="Dot";Ee(IIe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class NIe extends Vt{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,t),n}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t);return MN(()=>ke(v7(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}NIe.className="GaussianNoise";Ee(NIe);class MIe extends Vt{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return ce(()=>{this.invokeCallHook(t,n);const r=vt(t);return this.rate>0&&this.rate<1?MN(()=>{const s=Math.sqrt(this.rate/(1-this.rate));return ne(r,v7(r.shape,1,s))},()=>r,n.training||!1):r})}}MIe.className="GaussianDropout";Ee(MIe);class FIe extends Vt{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||vt(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return ce(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(t);return MN(()=>{const s=vt(t),a=1.6732632423543772,o=1.0507009873554805,l=-a*o;let u=Wm(Hb(r),this.rate);u=ih(u,"float32");const c=((1-this.rate)*(1+this.rate*l**2))**-.5,f=-c*l*this.rate,h=ke(ne(s,u),ne(ke(u,-1),l));return ke(ne(h,c),f)},()=>vt(t),n.training||!1)}return t})}}FIe.className="AlphaDropout";Ee(FIe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kT(e,t,n,r,i,s=.001){let a;if(e.rank===2)a=eTe(e,t,n,r,i,s);else if(e.rank===3)a=tTe(e,t,n,r,i,s);else if(e.rank===4)a=nTe(e,t,n,r,i,s);else throw new Tt(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return a}function fxt(e,t,n,r,i=.001){return ce(()=>{const s=qz(e,r),a=s.mean,o=s.variance;return[kT(e,a,o,n,t,i),a,o]})}function hxt(e,t,n,r,i=.001){return ce(()=>{const s=qz(e,r),a=s.mean,o=s.variance,l=[];for(const p of Kc(0,e.rank))r.indexOf(p)!==-1?l.push(1):l.push(e.shape[p]);const u=ie(a,l),c=ie(o,l),f=t==null?null:ie(t,l),h=n==null?null:ie(n,l);return[kT(e,u,c,h,f,i),a,o]})}function dxt(e,t,n,r,i=.001){return Zt(r.slice().sort(),Kc(0,e.rank-1))?fxt(e,t,n,r,i):hxt(e,t,n,r,i)}class OIe extends Vt{constructor(t){t==null&&(t={}),super(t),this.supportsMasking=!0,this.axis=t.axis==null?-1:t.axis,this.momentum=t.momentum==null?.99:t.momentum,this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=yr(t.betaInitializer||"zeros"),this.gammaInitializer=yr(t.gammaInitializer||"ones"),this.movingMeanInitializer=yr(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=yr(t.movingVarianceInitializer||"ones"),this.betaConstraint=vi(t.betaConstraint),this.gammaConstraint=vi(t.gammaConstraint),this.betaRegularizer=xr(t.betaRegularizer),this.gammaRegularizer=xr(t.gammaRegularizer)}build(t){t=un(t);const n=this.axis>=0?this.axis:this.axis+t.length,r=t[n];if(r==null)throw new re(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new gi({ndim:t.length,axes:{[n]:r}})];const i=[r];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,n){return ce(()=>{const r=n.training==null?!1:n.training,i=vt(t),s=i.shape,a=s.length,o=Kc(0,a),l=this.axis>=0?this.axis:this.axis+a;o.splice(l,1);const u=By(1,a);u[l]=s[l];const c=o.slice();c.sort();const f=!Zt(c,Kc(0,a).slice(0,a-1)),h=()=>{if(f){const y=ie(this.movingMean.read(),u),b=ie(this.movingVariance.read(),u),x=this.center?ie(this.beta.read(),u):null,w=this.scale?ie(this.gamma.read(),u):null;return kT(i,y,b,x,w,this.epsilon)}else return kT(i,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return h();const[d,p,g]=dxt(i,this.gamma.read(),this.beta.read(),o,this.epsilon),m=(y,b,x)=>{ce(()=>{const w=1-x,C=y.read(),$=ne(We(C,b),w);y.write(We(C,$))})};return(()=>{m(this.movingMean,p,this.momentum),m(this.movingVariance,g,this.momentum)})(),d})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:kr(this.betaInitializer),gammaInitializer:kr(this.gammaInitializer),movingMeanInitializer:kr(this.movingMeanInitializer),movingVarianceInitializer:kr(this.movingVarianceInitializer),betaRegularizer:Yn(this.betaRegularizer),gammaRegularizer:Yn(this.gammaRegularizer),betaConstraint:mi(this.betaConstraint),gammaConstraint:mi(this.gammaConstraint)},n=super.getConfig();return Object.assign(t,n),t}}OIe.className="BatchNormalization";Ee(OIe);class RIe extends Vt{constructor(t){if(t==null&&(t={}),super(t),this.axis=t.axis==null?-1:t.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=yr(t.betaInitializer||"zeros"),this.gammaInitializer=yr(t.gammaInitializer||"ones"),this.betaRegularizer=xr(t.betaRegularizer),this.gammaRegularizer=xr(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=un(t);const n=t.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let s=0;s<this.axis.length;++s)this.axis[s]<0&&(this.axis[s]+=n);for(const s of this.axis)if(s<0||s>=n)throw new Error(`Invalid axis: ${s}`);if(this.axis.length!==p0(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(s=>t[s]),i=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,i):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,i):this.beta=null,this.built=!0}call(t,n){const r=vt(t),i=r.shape,s=i.length;return ce(()=>{let{mean:o,variance:l}=qz(r,this.axis,!0);const u=By(1,s);for(const g of this.axis)u[g]=i[g];const c=g=>g!=null&&g.shape.length!==s?ie(g,u):g;let f=this.scale?c(this.gamma.read()):null,h=this.center?c(this.beta.read()):null;const d=[],p=[];for(let g=0;g<s;++g)this.axis.indexOf(g)!==-1?(d.push(i[g]),p.push(1)):(d.push(1),p.push(i[g]));return o=pu(o,d),l=pu(l,d),f!=null&&(f=pu(f,p)),h!=null&&(h=pu(h,p)),kT(r,o,l,h,f,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:kr(this.betaInitializer),gammaInitializer:kr(this.gammaInitializer),betaRegularizer:Yn(this.betaRegularizer),gammaRegularizer:Yn(this.gammaRegularizer)},n=super.getConfig();return Object.assign(t,n),t}}RIe.className="LayerNormalization";Ee(RIe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pxt(e,t,n){return ce(()=>{if(e.rank!==4)throw new re(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new re("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Zc()),n!=="channelsLast"&&n!=="channelsFirst")throw new re(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],t[0],t[1]]:r=[[0,0],t[0],t[1],[0,0]],Vm(e,r)})}class PIe extends Vt{constructor(t){if(t==null&&(t={}),super(t),this.dataFormat=t.dataFormat==null?Zc():t.dataFormat,t.padding==null)this.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new re(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let n,r;if(typeof t.padding[0]=="number")n=[t.padding[0],t.padding[0]],r=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new re(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(n=t.padding[0],t.padding[1].length!==2)throw new re(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);r=t.padding[1]}this.padding=[n,r]}this.inputSpec=[new gi({ndim:4})]}computeOutputShape(t){t=un(t);let n,r;return this.dataFormat==="channelsFirst"?(t[2]!=null&&t[2]>=0?n=t[2]+this.padding[0][0]+this.padding[0][1]:n=null,t[3]!=null&&t[3]>=0?r=t[3]+this.padding[1][0]+this.padding[1][1]:r=null,[t[0],t[1],n,r]):(t[1]!=null&&t[1]>=0?n=t[1]+this.padding[0][0]+this.padding[0][1]:n=null,t[2]!=null&&t[2]>=0?r=t[2]+this.padding[1][0]+this.padding[1][1]:r=null,[t[0],n,r,t[3]])}call(t,n){return ce(()=>pxt(vt(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}PIe.className="ZeroPadding2D";Ee(PIe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function S7(e,t,n,r,i,s){return ce(()=>{ei(i),tDe(s),Ql(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=Zc()),s==null&&(s="max"),e=Pne(e,i);let a;const o=r==="same"?"same":"valid";return s==="max"?a=Hz(e,t,n,o):a=Pz(e,t,n,o),i==="channelsFirst"&&(a=Kt(a,[0,3,1,2])),a})}function LIe(e,t,n,r,i,s){return ce(()=>{ei(i),tDe(s),Ql(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=Zc()),s==null&&(s="max"),e=tIe(e,i);let a;const o=r==="same"?"same":"valid";return s==="max"?a=ATe(e,t,n,o):a=JAe(e,t,n,o),i==="channelsFirst"&&(a=Kt(a,[0,4,1,2,3])),a})}class BIe extends Vt{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new re(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(Ai(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new re(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);Ai(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,Ql(this.padding),this.inputSpec=[new gi({ndim:3})]}computeOutputShape(t){t=un(t);const n=Uc(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],n,t[2]]}call(t,n){return ce(()=>{this.invokeCallHook(t,n),t=IN(vt(t),2);const r=this.poolingFunction(vt(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return qb(r,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(t,n),t}}class zIe extends BIe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return ei(s),Ql(i),S7(t,n,r,i,s,"max")}}zIe.className="MaxPooling1D";Ee(zIe);class UIe extends BIe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return ei(s),Ql(i),S7(t,n,r,i,s,"avg")}}UIe.className="AveragePooling1D";Ee(UIe);class WIe extends Vt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new re(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];Ai(this.poolSize,"poolSize"),Ai(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,ei(this.dataFormat),Ql(this.padding),this.inputSpec=[new gi({ndim:4})]}computeOutputShape(t){t=un(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2];return n=Uc(n,this.poolSize[0],this.padding,this.strides[0]),r=Uc(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,r]:[t[0],n,r,t[3]]}call(t,n){return ce(()=>(this.invokeCallHook(t,n),this.poolingFunction(vt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class VIe extends WIe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return ei(s),Ql(i),S7(t,n,r,i,s,"max")}}VIe.className="MaxPooling2D";Ee(VIe);class jIe extends WIe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return ei(s),Ql(i),S7(t,n,r,i,s,"avg")}}jIe.className="AveragePooling2D";Ee(jIe);class HIe extends Vt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new re(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];Ai(this.poolSize,"poolSize"),Ai(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,ei(this.dataFormat),Ql(this.padding),this.inputSpec=[new gi({ndim:5})]}computeOutputShape(t){t=un(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[4]:t[3];return n=Uc(n,this.poolSize[0],this.padding,this.strides[0]),r=Uc(r,this.poolSize[1],this.padding,this.strides[1]),i=Uc(i,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,r,i]:[t[0],n,r,i,t[4]]}call(t,n){return ce(()=>(this.invokeCallHook(t,n),this.poolingFunction(vt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class qIe extends HIe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return ei(s),Ql(i),LIe(t,n,r,i,s,"max")}}qIe.className="MaxPooling3D";Ee(qIe);class GIe extends HIe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return ei(s),Ql(i),LIe(t,n,r,i,s,"avg")}}GIe.className="AveragePooling3D";Ee(GIe);class YIe extends Vt{constructor(t){super(t),this.inputSpec=[new gi({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,n){throw new Tt}}class XIe extends YIe{constructor(t){super(t||{})}call(t,n){return ce(()=>{const r=vt(t);return Lr(r,1)})}}XIe.className="GlobalAveragePooling1D";Ee(XIe);class KIe extends YIe{constructor(t){super(t||{})}call(t,n){return ce(()=>{const r=vt(t);return Au(r,1)})}}KIe.className="GlobalMaxPooling1D";Ee(KIe);class ZIe extends Vt{constructor(t){super(t),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,ei(this.dataFormat),this.inputSpec=[new gi({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,n){throw new Tt}getConfig(){const t={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class QIe extends ZIe{call(t,n){return ce(()=>{const r=vt(t);return this.dataFormat==="channelsLast"?Lr(r,[1,2]):Lr(r,[2,3])})}}QIe.className="GlobalAveragePooling2D";Ee(QIe);class JIe extends ZIe{call(t,n){return ce(()=>{const r=vt(t);return this.dataFormat==="channelsLast"?Au(r,[1,2]):Au(r,[2,3])})}}JIe.className="GlobalMaxPooling2D";Ee(JIe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class eNe extends Vt{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(t,n),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,n,r={}){const i=n.layer,s=yp(i,r);delete n.layer;const a={layer:s};return Object.assign(a,n),new t(a)}}class tNe extends eNe{constructor(t){super(t),this.supportsMasking=!0}build(t){if(t=un(t),t.length<3)throw new re(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=un(t);const n=[t[0]].concat(t.slice(2)),r=this.layer.computeOutputShape(n),i=t[1];return[r[0],i].concat(r.slice(1))}call(t,n){return ce(()=>(t=vt(t),cIe((a,o)=>[vt(this.layer.call(a,n)),[]],t,[],!1,null,null,!1,!0)[1]))}}tNe.className="TimeDistributed";Ee(tNe);function gxt(e){Yb(Lyt,"BidirectionalMergeMode",e)}const mxt="concat";class nNe extends eNe{constructor(t){super(t);const n=t.layer.getConfig(),r={};r.className=t.layer.getClassName(),r.config=n,this.forwardLayer=yp(r),n.goBackwards=n.goBackwards!==!0;const i={};if(i.className=t.layer.getClassName(),i.config=n,this.backwardLayer=yp(i),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=t.mergeMode===void 0?mxt:t.mergeMode,gxt(this.mergeMode),t.weights)throw new Tt("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const n=t.length,r=Math.floor(n/2);this.forwardLayer.setWeights(t.slice(0,r)),this.backwardLayer.setWeights(t.slice(r))}computeOutputShape(t){let n=this.forwardLayer.computeOutputShape(t);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,i,s;return this.returnState&&(s=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):this.mergeMode==null?i=[r,r.slice()]:i=[r],this.returnState?this.mergeMode==null?i.concat(s).concat(s.slice()):[r].concat(s).concat(s.slice()):qa(i)}apply(t,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const s=uIe(t,r,i,this.numConstants);if(t=s.inputs,r=s.initialState,i=s.constants,Array.isArray(t)&&(r=t.slice(1),t=t[0]),(r==null||r.length===0)&&i==null)return super.apply(t,n);const a=[],o=[];if(r!=null){const u=r.length;if(u%2>0)throw new re("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,a.push(...r);const c=r.map(f=>new gi({shape:f.shape}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),o.push(...c)}if(i!=null)throw new Tt("Support for constants in Bidirectional layers is not implemented yet.");const l=a[0]instanceof Qf;for(const u of a)if(u instanceof Qf!==l)throw new re("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[t].concat(a),c=this.inputSpec.concat(o),f=this.inputSpec;this.inputSpec=c;const h=super.apply(u,n);return this.inputSpec=f,h}else return super.apply(t,n)}call(t,n){return ce(()=>{const r=n.initialState;let i,s;if(r==null)i=this.forwardLayer.call(t,n),s=this.backwardLayer.call(t,n);else{const l=r.slice(0,r.length/2),u=r.slice(r.length/2);i=this.forwardLayer.call(t,Object.assign(n,{initialState:l})),s=this.backwardLayer.call(t,Object.assign(n,{initialState:u}))}let a;this.returnState&&(Array.isArray(i)&&(a=i.slice(1).concat(s.slice(1))),i=i[0],s=s[0]),this.returnSequences&&(s=Fu(s,1));let o;return this.mergeMode==="concat"?o=_ne([i,s]):this.mergeMode==="sum"?o=ke(i,s):this.mergeMode==="ave"?o=ne(.5,ke(i,s)):this.mergeMode==="mul"?o=ne(i,s):this.mergeMode==null&&(o=[i,s]),this.returnState?this.mergeMode==null?o.concat(a):[o].concat(a):o})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){Z1(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),Z1(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const s=this.forwardLayer.states.map(a=>null);return Array.isArray(r)?r.concat(s).concat(s):[r].concat(s).concat(s)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(t,n),t}static fromConfig(t,n){const r=yp(n.layer);if(delete n.layer,n.numConstants!=null)throw new Tt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const i=n;return i.layer=r,new t(i)}}nNe.className="Bidirectional";Ee(nNe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class rNe extends Vt{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return ce(()=>(t=vt(t),t.dtype!=="float32"&&(t=ih(t,"float32")),ke(ne(t,this.scale),this.offset)))}}rNe.className="Rescaling";Ee(rNe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:vxt,cropAndResize:yxt}=Zf;class iNe extends Vt{constructor(t){super(t),this.height=t.height,this.width=t.width}centerCrop(t,n,r,i,s,a,o,l){return ce(()=>{let u,c=!1;const f=n/a,h=r/o,d=(i+n)/a,p=(s+r)/o,g=[f,h,d,p],m=[];t.rank===3?(c=!0,u=Np([t])):u=t;for(let w=0;w<u.shape[0];w++)m.push(g);const v=vp(m,[m.length,4]),y=Pw(0,m.length,1,"int32"),x=yxt(u,v,y,[i,s],"nearest");return ih(c?vt(V0(x)):x,l)})}upsize(t,n,r,i){return ce(()=>{const s=vxt(t,[n,r]);return ih(s,i)})}call(t,n){return ce(()=>{const r=vt(t),i=r.dtype,s=r.shape,a=s[s.length-3],o=s[s.length-2];let l=0;a!==this.height&&(l=Math.floor((a-this.height)/2));let u=0;return o!==this.width&&(u=Math.floor((o-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(r,l,u,this.height,this.width,a,o,i):this.upsize(t,this.height,this.width,i)})}getConfig(){const t={height:this.height,width:this.width},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=un(t);const n=t.length-3,r=t.length-2;return t[n]=this.height,t[r]=this.width,t}}iNe.className="CenterCrop";Ee(iNe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bxt(e,t,n,r){let i=vt(e);if(i.dtype!=="int32"&&(i=ih(i,"int32")),t==="int")return i;const s=i.shape;if(i.rank===0&&(i=Ha(i,-1)),t==="oneHot"&&i.shape[i.shape.length-1]!==1&&(i=Ha(i,-1)),i.rank>2)throw new re(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${s} which would result in output rank ${i.rank}.`);const a=["multiHot","oneHot"].includes(t),o=i;let l;if(typeof r<"u"&&t==="count"?l=OY(o,r,n,a):l=OY(o,[],n,a),t!=="tfIdf")return l;if(r)return ne(l,r);throw new re("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sNe extends Vt{constructor(t){super(t),this.numTokens=t.numTokens,t.outputMode?this.outputMode=t.outputMode:this.outputMode="multiHot"}getConfig(){const t={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){return t=un(t),t==null?[this.numTokens]:this.outputMode==="oneHot"&&t[t.length-1]!==1?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)}call(t,n){return ce(()=>{t=vt(t),t.dtype!=="int32"&&(t=ih(t,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new re(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=vt(n.countWeights)}const i=Au(t),s=vT(t),a=yl(this.numTokens,i).bufferSync().get(0),o=Wm(s,0).bufferSync().get(0);if(!(a&&o))throw new re(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return bxt(t,this.outputMode,this.numTokens,r)})}}sNe.className="CategoryEncoding";Ee(sNe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const xxt=["bilinear","nearest"],Hge=new Set(xxt);class aNe extends Vt{constructor(t){if(super(t),this.height=t.height,this.width=t.width,t.interpolation)if(Hge.has(t.interpolation))this.interpolation=t.interpolation;else throw new re(`Invalid interpolation parameter: ${t.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(t.cropToAspectRatio)}computeOutputShape(t){t=un(t);const n=t[2];return[this.height,this.width,n]}getConfig(){const t={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return ce(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return Zf.resizeBilinear(t,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Zf.resizeNearestNeighbor(t,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...Hge]} are supported`)})}}aNe.className="Resizing";Ee(aNe);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class oNe{constructor(t){this.seed=t}next(){if(this.seed!==void 0)return this.seed++}}oNe.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class lNe extends Vt{constructor(t){super(t),this.randomGenerator=new oNe(t.seed)}getConfig(){const t={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(t,n),t}}lNe.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const wxt=["bilinear","nearest"],qge=new Set(wxt);class uNe extends lNe{constructor(t){super(t);const{factor:n,interpolation:r="bilinear"}=t;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new re(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new re(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new re(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(qge.has(r))this.interpolation=r;else throw new re(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const t={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=un(t);const n=t[2];return[this.imgHeight,-1,n]}call(t,n){return ce(()=>{const r=vt(t);this.imgHeight=r.shape[r.shape.length-3];const i=r.shape[r.shape.length-2];this.widthFactor=Hb([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let s=this.widthFactor.dataSync()[0]*i;s=Math.round(s);const a=[this.imgHeight,s];switch(this.interpolation){case"bilinear":return Zf.resizeBilinear(t,a);case"nearest":return Zf.resizeNearestNeighbor(t,a);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...qge]} are supported`)}})}}uNe.className="RandomWidth";Ee(uNe);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $xt=le();$xt.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Gge;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(Gge||(Gge={}));var Yge;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(Yge||(Yge={}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Xge;(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(Xge||(Xge={}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ge(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&B(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cxt=n7;class k7 extends k8{nextDataId(){return k7.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Gee(this,fc())}write(t,n,r){this.firstUse&&(this.firstUse=!1,le().get("IS_NODE")&&kl(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const i={id:this.nextDataId()};return this.data.set(i,{values:t,dtype:r,refCount:1}),i}makeTensorInfo(t,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&Kf(r[0])){const s=r.map(a=>th(a));i=this.write(s,t,n)}else i=this.write(r,t,n);return{dataId:i,shape:t,dtype:n}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){const n=this.data.get(t);n.refCount--}}move(t,n,r,i,s){this.data.set(t,{values:n,dtype:i,refCount:s})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:n,complexTensorInfos:r}=this.data.get(t);if(n==="complex64"){const i=this.readSync(r.real.dataId),s=this.readSync(r.imag.dataId);return Mp(i,s)}return lAe(this.data.get(t).values,n)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const r=n.map(i=>Ip(i));return Mt(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Mt(t.shape,t.dtype,n)}makeOutput(t,n,r){return fc().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,t),this)}disposeData(t,n=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!n&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(t);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const n=ua();return t(),{kernelMs:ua()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Ge([t],"where");const n=this.readSync(t.dataId);return Cxt(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}k7.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cNe(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const _xt=e=>{const{x:t}=e.inputs,n=e.backend;Ge(t,"abs");let r=new Float32Array(he(t.shape));const i=n.data.get(t.dataId).values;return r=cNe(i),n.makeOutput(r,t.shape,t.dtype)},Sxt={kernelName:gI,backendName:"cpu",kernelFunc:_xt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ti(e){return(t,n,r,i,s)=>{const a=Ct(t,n),o=a.length,l=Je(a),u=he(a),c=Fi(s,u),f=t.length,h=n.length,d=Je(t),p=Je(n),g=Ry(t,a),m=Ry(n,a);if(g.length+m.length===0)for(let v=0;v<c.length;++v)c[v]=e(r[v%r.length],i[v%i.length]);else for(let v=0;v<c.length;++v){const y=zb(v,o,l),b=y.slice(-f);g.forEach($=>b[$]=0);const x=Bc(b,f,d),w=y.slice(-h);m.forEach($=>w[$]=0);const C=Bc(w,h,p);c[v]=e(r[x],i[C])}return[c,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uo(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,o=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(o.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",s),imag:n.makeTensorInfo(i.shape,"float32",a)},o}const kxt={kernelName:R8,backendName:"cpu",kernelFunc:Uo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R5(e,t,n="float32"){if(n==="complex64"){const i=R5(e,t,"float32"),s=R5(e,t,"float32");return Uo({inputs:{real:i,imag:s},backend:e})}const r=hs(he(t),n);return e.makeTensorInfo(t,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fh(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Ext={kernelName:GC,backendName:"cpu",kernelFunc:Fh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zy(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.real,s=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,s)}const Axt={kernelName:gz,backendName:"cpu",kernelFunc:zy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fNe(e,t,n,r){if(r==="int32"){const i=Int32Array.from(e);return[t,"int32",i]}if(r==="bool"){const i=Lm([0],n),[s,a]=ti((o,l)=>o!==l?1:0)(t,[],e,i,"bool");return[a,"bool",s]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function Y0(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:s}=r;if(s==="complex64"){if(i.dtype==="complex64")return Fh({inputs:{x:i},backend:n});const c=R5(n,i.shape,i.dtype),f=Y0({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),h=Uo({inputs:{real:f,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),h}if(i.dtype==="complex64"){const c=zy({inputs:{input:i},backend:n}),f=Y0({inputs:{x:c},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(c),f}if(!Kee(i.dtype,s)){const c=Fh({inputs:{x:i},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:s}}const a=n.data.get(i.dataId).values,[o,l,u]=fNe(a,i.shape,i.dtype,s);return n.makeTensorInfo(o,l,u)}const Txt={kernelName:FC,backendName:"cpu",kernelFunc:Y0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xi(e,t,n,r){return n==null?({inputs:i,backend:s})=>{const{a,b:o}=i,l=s;Ge([a,o],e);const u=l.data.get(a.dataId).values,c=l.data.get(o.dataId).values,f=a.dtype==="string"?Fp(u):u,h=a.dtype==="string"?Fp(c):c,d=r||a.dtype,[p,g]=t(a.shape,o.shape,f,h,d);return l.makeTensorInfo(g,d,p)}:({inputs:i,backend:s})=>{const{a,b:o}=i,l=s;if(a.dtype==="complex64"||o.dtype==="complex64"){const u=Y0({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),f=c.complexTensorInfos.real,h=c.complexTensorInfos.imag,d=l.data.get(f.dataId).values,p=l.data.get(h.dataId).values,g=Y0({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),m=l.data.get(g.dataId),v=m.complexTensorInfos.real,y=m.complexTensorInfos.imag,b=l.data.get(v.dataId).values,x=l.data.get(y.dataId).values,[w,C,$]=n(a.shape,o.shape,d,p,b,x),_=l.makeTensorInfo($,"float32",w),k=l.makeTensorInfo($,"float32",C),E=Uo({inputs:{real:_,imag:k},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(_),l.disposeIntermediateTensorInfo(k),E}else{const u=l.data.get(a.dataId).values,c=l.data.get(o.dataId).values,f=r||a.dtype,[h,d]=t(a.shape,o.shape,u,c,f);return l.makeTensorInfo(d,f,h)}}}function Vne(e){return(t,n,r,i,s,a)=>{const o=Ct(t,n),l=he(o),u=o.length,c=Je(o),f=Fi("float32",l),h=Fi("float32",l),d=Ry(t,o),p=Ry(n,o),g=Mp(r,i),m=Mp(s,a),v=t.length,y=Je(t),b=n.length,x=Je(n);if(d.length+p.length===0)for(let w=0;w<f.length;w++){const C=w%g.length,$=w%m.length,_=e(g[C*2],g[C*2+1],m[$*2],m[$*2+1]);f[w]=_.real,h[w]=_.imag}else for(let w=0;w<f.length;w++){const C=zb(w,u,c),$=C.slice(-v);d.forEach(I=>$[I]=0);const _=Bc($,v,y),k=C.slice(-b);p.forEach(I=>k[I]=0);const E=Bc(k,b,x),S=e(g[_*2],g[_*2+1],m[E*2],m[E*2+1]);f[w]=S.real,h[w]=S.imag}return[f,h,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hNe=ti((e,t)=>e+t),Dxt=Vne((e,t,n,r)=>({real:e+n,imag:t+r})),Bw=xi(Ub,hNe,Dxt),Ixt={kernelName:Ub,backendName:"cpu",kernelFunc:Bw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jne(e,t,n,r,i){const s=he(r),a=hs(i,n);for(let o=0;o<e.length;o++){const l=e[o];if(l<0)throw new Error("Input x must be non-negative!");l>=i||(s>0?a[l]+=t[o]:a[l]+=1)}return a}function dNe(e,t,n,r=!1){const i=e.shape[0],s=e.shape[1],a=Mt([i,n],t.dtype);for(let o=0;o<i;o++)for(let l=0;l<s;l++){const u=e.get(o,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?a.set(1,o,u):t.size>0?a.set(a.get(o,u)+t.get(o,l),o,u):a.set(a.get(o,u)+1,o,u))}return a}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pNe=ti((e,t)=>e&t),Nxt=xi(CI,pNe),Mxt={kernelName:CI,backendName:"cpu",kernelFunc:Nxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sd(e){return(t,n,r)=>{const i=Br(n,t.length);for(let s=0;s<t.length;++s)i[s]=e(t[s],r);return i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bn(e,t,n){const r=sd(t);return qm(e,r,n)}function qm(e,t,n){return({inputs:r,attrs:i,backend:s})=>{const{x:a}=r;Ge(a,e);const o=s,l=o.data.get(a.dataId).values;let u;if(a.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=Fp(l)}else u=l;const c=n||a.dtype,f=t(u,c,i);return o.makeTensorInfo(a.shape,c,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gNe=sd(e=>Math.ceil(e)),Fxt=qm(OC,gNe),Oxt={kernelName:OC,backendName:"cpu",kernelFunc:Fxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mNe(e,t,n,r){const i=Br(n,he(t));if(r&&n!=="string"){let s=0;e.forEach(a=>{const o=he(a.shape);i.set(a.vals,s),s+=o})}else{let s=0;e.forEach(a=>{const o=n==="string"?Fp(a.vals):a.vals;let l=0;for(let u=0;u<a.shape[0];++u){const c=u*t[1]+s;for(let f=0;f<a.shape[1];++f)i[c+f]=o[l++]}s+=a.shape[1]})}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vNe=ti((e,t)=>e===t?1:0),yNe=xi(NI,vNe,null,"bool"),Rxt={kernelName:NI,backendName:"cpu",kernelFunc:yNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bNe=sd(e=>Math.exp(e)),xNe=qm(WC,bNe,"float32"),Pxt={kernelName:WC,backendName:"cpu",kernelFunc:xNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wNe=sd(e=>Math.expm1(e)),Lxt=qm(VC,wNe),Bxt={kernelName:VC,backendName:"cpu",kernelFunc:Lxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ne=sd(e=>Math.floor(e)),zxt=qm(jC,$Ne),Uxt={kernelName:jC,backendName:"cpu",kernelFunc:zxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CNe=ti((e,t)=>Math.floor(e/t)),Wxt=xi(HC,CNe,null,"int32"),Vxt={kernelName:HC,backendName:"cpu",kernelFunc:Wxt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ne(e,t,n,r,i,s,a,o,l){const u=Mt([r,s],n);for(let c=0;c<r;c++){const f=[];let h=0;for(let d=0;d<i;d++){const p=e[c*i+d];h+=p*a[d],f.push(p)}if(h<0||h>=l/s)throw new Error(`Invalid indices: ${f} does not index into ${o}`);for(let d=0;d<s;d++)u.values[c*s+d]=t.get(...t.indexToLoc(h*s+d))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SNe(e,t,n){const r=Mt(n,e.dtype);for(let i=0;i<r.size;++i){const a=r.indexToLoc(i).slice(),o=a[0],l=a[2],u=t.locToIndex([o,l]);a[2]=t.values[u];const c=e.locToIndex(a);0<=c&&c<e.values.length&&(r.values[i]=e.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kNe=ti((e,t)=>e>t?1:0),jxt=xi(RI,kNe,null,"bool"),Hxt={kernelName:RI,backendName:"cpu",kernelFunc:jxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ENe=ti((e,t)=>e>=t?1:0),qxt=xi(qC,ENe,null,"bool"),Gxt={kernelName:qC,backendName:"cpu",kernelFunc:qxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ANe=ti((e,t)=>e<t?1:0),Yxt=xi(LI,ANe,null,"bool"),Xxt={kernelName:LI,backendName:"cpu",kernelFunc:Yxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TNe=ti((e,t)=>e<=t?1:0),Kxt=xi(BI,TNe,null,"bool"),Zxt={kernelName:BI,backendName:"cpu",kernelFunc:Kxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DNe(e,t,n){const r=(t-e)/(n-1),i=hs(n,"float32");i[0]=e;for(let s=1;s<i.length;s++)i[s]=i[s-1]+r;return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const INe=sd(e=>Math.log(e)),Qxt=qm(ZC,INe),Jxt={kernelName:ZC,backendName:"cpu",kernelFunc:Qxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NNe(e,t,n,r){const i=Fi(r,he(n));for(let s=0;s<i.length;++s){const a=s*t;let o=e[a];for(let l=0;l<t;++l){const u=e[a+l];(Number.isNaN(u)||u>o)&&(o=u)}i[s]=o}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MNe=ti((e,t)=>Math.max(e,t)),e2t=xi(JC,MNe),t2t={kernelName:JC,backendName:"cpu",kernelFunc:e2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FNe=ti((e,t)=>Math.min(e,t)),n2t=xi(e_,FNe),r2t={kernelName:e_,backendName:"cpu",kernelFunc:n2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hne=ti((e,t)=>e*t),i2t=Vne((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),E7=xi(n_,Hne,i2t),s2t={kernelName:n_,backendName:"cpu",kernelFunc:E7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ONe(e,t,n){const r=eg(-1,n);return Hne([],t,r,e,n)}function a2t(e){const{inputs:t,backend:n}=e,{x:r}=t;Ge(r,"neg");const i=n.data.get(r.dataId).values,[s,a]=ONe(i,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,s)}const o2t={kernelName:KI,backendName:"cpu",kernelFunc:a2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RNe=ti((e,t)=>e!==t?1:0),l2t=xi(ZI,RNe,null,"bool"),u2t={kernelName:ZI,backendName:"cpu",kernelFunc:l2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qne(e,t,n,r,i){const s=t.length,a=he(t),o=Je(t),l=Je(i),u=Fi(n,he(i));for(let c=0;c<a;++c){const f=zb(c,s,o),h=new Array(f.length);for(let p=0;p<h.length;p++)h[p]=f[r[p]];const d=Bc(h,s,l);u[d]=e[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function po(e){const{inputs:t,attrs:n,backend:r}=e,{x:i}=t,{perm:s}=n;Ge(i,"transpose");const a=i.shape.length,o=new Array(a);for(let f=0;f<o.length;f++)o[f]=i.shape[s[f]];const l=r.data.get(i.dataId).values,u=qne(l,i.shape,i.dtype,s,o);return{dataId:r.write(u,o,i.dtype),shape:o,dtype:i.dtype}}const c2t={kernelName:K1,backendName:"cpu",kernelFunc:po};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PNe(e,t,n,r){const[i,s]=Li(e,r),a=fo(t,"int32"),o=hs(he(i),a),l=he(s);for(let u=0;u<o.length;++u){const c=u*l;let f=1;for(let h=0;h<l;++h)f*=n[c+h];o[u]=f}return{outVals:o,outShape:i,outDtype:a}}function f2t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r;Ge(i,"prod");const o=i.shape.length,l=Ot(s,i.shape),u=Fr(l,o);let c=l,f=i;const h=[];u!=null&&(f=po({inputs:{x:i},backend:n,attrs:{perm:u}}),h.push(f),c=Jr(c.length,o));const d=n.data.get(f.dataId).values,{outVals:p,outShape:g,outDtype:m}=PNe(f.shape,f.dtype,d,c);let v=g;return a&&(v=Zr(g,l)),h.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(v,m,p)}const h2t={kernelName:rN,backendName:"cpu",kernelFunc:f2t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d2t(e,t,n){e.forEach((r,i)=>{if(r<0||r>=n){const s=zb(i,t.length,Je(t)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${n})`)}})}function p2t(e,t){for(let n=0;n<e.length;++n){const r=e[n],i=n===e.length-1?t:e[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}function g2t(e,t,n,r){const i=[];let s=0;const a=t.length-1+n.length,o=new Array(a).fill(null).map(()=>[0]);p2t(n,r);let l=1;for(let u=0;u<t.length-1;++u){l*=t[u];const c=t[u+1];for(let f=1;f<l+1;++f)o[u].push(f*c)}for(let u=0;u<e.length;++u){let c=e[u],f=e[u]+1;for(let h=0;h<n.length;++h){const d=n[h],p=h+t.length-1;if(p>=0){const g=o[p],m=g[g.length-1]-d[c];for(let v=c;v<f;++v)o[p].push(d[v+1]+m)}c=d[c],f=d[f]}f!==c&&(i.push([c,f]),s+=f-c)}return{outSplits:o,valueSlices:i,numValues:s}}function m2t(e){const t=[];for(let n=0;n<e.length;++n){const r=e[n].length,i=Br("int32",r);t.push(i),e[n].forEach((s,a)=>i[a]=s)}return t}function Kge(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function v2t(e,t,n,r,i,s){const a=Kge(t,2)[1],o=Kge(s,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let f=0;f<r;++f)i[l*o+f]=e[c*a+f];++l}}function y2t(e,t,n,r,i){const s=t.slice();s[0]=i;const a=Br(n,he(s)),o=e.length,l=o===0?0:o/t[0];return v2t(e,t,r,l,a,s),[a,s]}function LNe(e,t,n,r,i,s,a,o){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const l=t[0][0]-1;if(d2t(s,a,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:f,numValues:h}=g2t(s,a,e,u),d=m2t(c),p=y2t(n,r,i,f,h);return[d,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zge=2147483647;function BNe(e,t,n,r,i,s,a){if(t.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(a.length>1)throw new Error("deltas must be a scalar or vector");const o=t.length===0,l=i.length===0,u=a.length===0,c=[];o||c.push(t[0]),l||c.push(i[0]),u||c.push(a[0]);for(let m=1;m<c.length;++m)if(c[m]!==c[m-1])throw new Error("starts, limits, and deltas must have the same shape");const f=c.length===0?1:c[0],h=Br("int32",f+1);h[0]=0;for(let m=0;m<f;++m){const v=o?e[0]:e[m],y=l?r[0]:r[m],b=u?s[0]:s[m];if(b===0)throw new Error("Requires delta != 0");let x;if(b>0&&y<v||b<0&&y>v)x=0;else if(x=Math.ceil(Math.abs((y-v)/b)),x>Zge)throw new Error(`Requires ((limit - start) / delta) <= ${Zge}`);h[m+1]=h[m]+x}const d=h[f],p=Br(n,d);let g=0;for(let m=0;m<f;++m){const v=h[m+1]-h[m];let y=o?e[0]:e[m];const b=u?s[0]:s[m];for(let x=0;x<v;++x)p[g++]=y,y+=b}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ru=vc;class P5{constructor(t,n,r,i,s,a,o,l,u,c){this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=i,this.valuesDType=s,this.defaultValue=a,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=S3e(c),this.raggedRank=k3e(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===ru.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===ru.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case ru.VALUE_ROWIDS:return P5.getMaxWidthValueRowID(n);case ru.ROW_SPLITS:return P5.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${ru[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const n=t.length;if(n===0||n===1)return 0;let r=0;for(let i=0;i<n-1;++i){const s=t[i+1]-t[i];s>r&&(r=s)}return r}static getMaxWidthValueRowID(t){const n=t.length;if(n===0)return 0;let r=0,i=t[0],s=0;for(let a=1;a<n;++a){const o=t[a];o!==i&&(i=o,s=Math.max(a-r,s),r=a)}return Math.max(n-r,s)}tensorShapeFromTensor(t,n,r=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Jge(t,r)}calculateOutputSize(t){const n=this.valuesShape,r=this.defaultValueShape;E3e(r,n);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=_3e(this.raggedRank,i,n);a[0]<0&&(a[0]=t);for(let o=1;o<=this.raggedRank;++o)a[o]<0&&(a[o]=this.getMaxWidth(o));return a}calculateFirstParentOutputIndex(t,n,r){const i=Math.min(t,r),s=[];let a=0;for(let o=0;o<i;++o,a+=n)s.push(a);for(let o=i;o<t;++o)s.push(-1);return B(s.length===t,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(t,n,r,i){const s=t.length,a=[];for(let o=0;o<s-1;++o){const l=t[o+1]-t[o];let u=Math.min(i,l),c=n[o];c===-1&&(u=0);for(let f=0;f<u;++f)a.push(c),c+=r;for(let f=0;f<l-u;++f)a.push(-1)}if(s>0&&a.length!==t[s-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(t,n,r,i){const s=t.length,a=[];if(s===0)return[];let o=0,l=t[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];a.push(u);for(let c=1;c<s;++c){const f=t[c];if(f===l)u>=0&&(++o,o<i?u+=r:u=-1);else{if(o=0,l=f,f>=n.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${n.length}`);u=n[f]}a.push(u)}if(a.length!==t.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(t,n,r,i){const s=this.getRowPartitionTensor(t),a=this.getRowPartitionTypeByDimension(t);switch(a){case ru.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,n,r,i);case ru.ROW_SPLITS:if(s.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(s,n,r,i);default:throw new Error(`Unsupported partition type: ${ru[a]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case ru.FIRST_DIM_SIZE:return t[0];case ru.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ru.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${ru[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let l=i.length-2;l>=0;--l)i[l]=i[l+1]*r[l+1];const s=Jge(r,!1),a=Br(this.valuesDType,he(s));if(i[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,i[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,i[u],r[u]);this.setOutput(this.raggedRank,l,a,s)}return[s,a]}setOutput(t,n,r,i){if(r.length===0)return;const s=this.values,a=r;let o=i.slice();o=o.slice(t+1);const l=he(o),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const p=this.defaultValueShape;ce(()=>{const g=ie(c,p);c=X2(g,o).dataSync()})}let f=0,h=0,d=0;for(let p=0;p<=u;++p){let g=p<u?n[p]:-1;if(g===d){++d;continue}if(h<d){const m=s.subarray(f*l),v=a.subarray(h*l),y=(d-h)*l;Qge(v,m,y)}if(p>=u){const m=r.length;g=Math.floor(m/l)}if(g>d)if(this.defaultValue.length===1)a.subarray(d*l,g*l).fill(this.defaultValue[0]),d=g;else for(;g>d;){const m=a.slice(d*l);Qge(m,c,l),++d}g<0?(f=p+1,h=d):(f=p,h=d,d=h+1)}}}function Qge(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function Jge(e,t){const n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function zNe(e,t,n,r,i,s,a,o,l,u){return new P5(e,t,n,r,i,s,a,o,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UNe(e,t,n,r){const i=e===t,s=e<t&&n<0,a=t<e&&n>1;if(i||s||a)return hs(0,r);const o=Math.abs(Math.ceil((t-e)/n)),l=hs(o,r);t<e&&n===1&&(n=-1),l[0]=e;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WNe=sd(e=>1/Math.sqrt(e)),b2t=qm(l_,WNe),x2t={kernelName:l_,backendName:"cpu",kernelFunc:b2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A1(e,t,n,r,i,s,a,o,l,u){const c=[r/i,i],f=e.values,h=t.values;if(r===0)return Mt(n,t.dtype);const d=l instanceof oi?l:Mt(c,t.dtype);typeof l=="string"||typeof l=="number"?d.values.fill(l):typeof l=="boolean"&&d.values.fill(+l);for(let p=0;p<s;p++){const g=[];let m=0;for(let v=0;v<a;v++){const y=f[p*a+v];g.push(y),m+=y*o[v]}if(m<0||m>=r/i)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let v=0;v<i;v++)u?d.values[m*i+v]+=h[p*i+v]:d.values[m*i+v]=t.rank===0?h[0]:h[p*i+v]}return d}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w2t=sd(e=>1/(1+Math.exp(-e))),VNe=Bn(d_,e=>1/(1+Math.exp(-e))),$2t={kernelName:d_,backendName:"cpu",kernelFunc:VNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jNe(e,t,n,r,i){const s=Qte(r,t,n),a=he(n),o=Je(r);if(s){const f=Jte(t,o);return i==="string"?e.slice(f,f+a):e.subarray(f,f+a)}const l=i==="string"?Fp(e):e,u=Mt(r,i,l),c=Mt(n,i);for(let f=0;f<c.size;++f){const h=c.indexToLoc(f),d=h.map((p,g)=>p+t[g]);c.set(u.get(...d),...h)}return i==="string"?G3e(c.values):c.values}function Uy(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,size:a}=r;Ge(i,"slice");const[o,l]=h7(i,s,a);Kte(i,o,l);const u=n.data.get(i.dataId).values,c=jNe(u,o,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,c)}const C2t={kernelName:uN,backendName:"cpu",kernelFunc:Uy};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HNe(e,t,n,r,i,s,a){const o=t[0],l=s[0],u=new Array(l),c=new Array(o),f=t[1];if(l===0){if(o!==0)throw new Error(F3e(o));const m=Br(n,0),v=Br(i,0);return[m,[0,f],v,u,c]}let h=!0,d=0;const p=new Array(l).fill(0);for(let m=0;m<o;++m){const v=e[m*f];if(v<0)throw new Error(O3e(m,v));if(v>=l)throw new Error(R3e(m,v,l));++p[v],h=h&&v>=d,d=v}let g=!0;for(let m=0;m<l;++m){const v=p[m]===0;u[m]=v,g=g&&!v,p[m]=Math.max(p[m],1),m>0&&(p[m]+=p[m-1])}if(g&&h){const m=e,v=r;for(let y=0;y<o;++y)c[y]=y;return[m,[o,f],v,u,c]}else{const m=p[l-1],v=Br(n,m*f),y=Br(i,m),b=new Array(l).fill(0);for(let x=0;x<o;++x){const w=e[x*f],C=b[w],$=(w===0?0:p[w-1])+C;b[w]++;for(let _=0;_<f;++_)v[$*f+_]=e[x*f+_];y[$]=r[x],c[x]=$}for(let x=0;x<l;++x)if(b[x]===0){const C=x===0?0:p[x-1];v[C*f+0]=x;for(let $=1;$<f;++$)v[C*f+$]=0;y[C]=a}return[v,[m,f],y,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qNe(e,t,n,r,i){const s=he(r),a=t[0],o=i.length,l=[];let u=1,c=-1;for(let m=0;m<o;++m){const v=i[m];if(v===-1){if(c!==-1)throw new Error(P3e(c,m));c=m,l.push(1)}else{if(v<0)throw new Error(L3e(m,v));u*=v,l.push(v)}}if(c!==-1){if(u<=0)throw new Error(B3e());const m=Math.trunc(s/u);if(u*m!==s)throw new Error(z3e(r,l));l[c]=m}if(he(l)!==s)throw new Error(U3e(r,l));const h=r.length,d=[];if(h>0){d[h-1]=1;for(let m=h-2;m>=0;--m)d[m]=d[m+1]*r[m+1]}const p=[];if(o>0){p[o-1]=1;for(let m=o-2;m>=0;--m)p[m]=p[m+1]*l[m+1]}const g=Br(n,a*o);for(let m=0;m<a;++m){let v=0;for(let y=0;y<h;++y)v+=e[m*h+y]*d[y];for(let y=0;y<o;++y)g[m*o+y]=Math.trunc(v/p[y]),v%=p[y]}return[g,[a,o],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gne(e,t,n,r,i,s=!1,a=0){const o=r.length,l=[t[0],e.length/t[0]],u=l[1],f=o>0?i[o-1]+1:0;if(f<0)throw new Error(UY());const h=t.slice();h[0]=f;const d=h.reduce((b,x)=>b*x,1),p=Br(n,d);if(o===0)return f>0&&p.fill(a),[p,h];if(f<=0)throw new Error(UY());let g=0,m=1,v=0,y=i[g];for(;;){let b=0;if(m<o){if(b=i[m],y===b){++m;continue}if(y>=b)throw new Error(W3e())}if(y<0||y>=f)throw new Error(V3e(y,f));y>v&&p.fill(a,v*u,y*u);for(let x=g;x<m;++x){const w=r[x];if(w<0||w>=l[0])throw new Error(j3e(x,r[x],l[0]));for(let C=0;C<u;C++)p[y*u+C]+=e[w*u+C]}if(s)for(let x=0;x<u;x++)p[y*u+x]/=m-g;if(g=m,++m,v=y+1,y=b,m>o)break}return v<f&&p.fill(a,v*u,f*u),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _2t=sd(e=>Math.sqrt(e)),S2t=Bn(g_,e=>Math.sqrt(e)),k2t={kernelName:g_,backendName:"cpu",kernelFunc:S2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GNe=ti((e,t)=>{const n=e-t;return n*n}),E2t=xi(m_,GNe),A2t={kernelName:m_,backendName:"cpu",kernelFunc:E2t};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YNe=sd((e,t)=>{const{pattern:n,replaceGlobal:r,rewrite:i}=t;return e.replace(new RegExp(n,r?"g":""),i)}),T2t=qm(pN,YNe),D2t={kernelName:pN,backendName:"cpu",kernelFunc:T2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XNe(e,t,n,r){const i=Mt(e,t.dtype);for(let s=0;s<i.size;s++){const a=i.indexToLoc(s),o=new Array(a.length);for(let l=0;l<o.length;l++)o[l]=a[l]*n[l]+r[l];i.set(t.get(...o),...a)}return i}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I2t{constructor(t,n,r,i,s,a){this.separator=th(t),this.nGramWidths=n,this.leftPad=th(r),this.rightPad=th(i),this.padWidth=s,this.preserveShort=a}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,n){const r=this.getPadWidth(n);return Math.max(0,t+2*r-n+1)}createNGrams(t,n,r,i,s,a){for(let o=0;o<s;++o){const l=this.getPadWidth(a),u=Math.max(0,l-o),c=Math.max(0,l-(s-(o+1))),f=a-(u+c),h=n+(u>0?0:o-l);let d=0;d+=u*this.leftPad.length;for(let y=0;y<f;++y)d+=t[h+y].length;d+=c*this.rightPad.length;const p=u+c+f-1;d+=p*this.separator.length,r[i+o]=new Uint8Array(d);const g=r[i+o];let m=0;const v=y=>y.forEach(b=>g[m++]=b);for(let y=0;y<u;++y)v(this.leftPad),v(this.separator);for(let y=0;y<f-1;++y)v(t[h+y]),v(this.separator);if(f>0){v(t[h+f-1]);for(let y=0;y<c;++y)v(this.separator),v(this.rightPad)}else{for(let y=0;y<c-1;++y)v(this.rightPad),v(this.separator);v(this.rightPad)}}}compute(t,n){const r=t.length,i=n.length;if(i>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<i;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const s=i-1,a=Br("int32",i);if(r===0||i===0){const l=new Array(r);for(let u=0;u<=s;++u)a[u]=0;return[l,a]}a[0]=0;for(let l=1;l<=s;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(f=>{c+=this.getNumNGrams(u,f)}),this.preserveShort&&u>0&&c===0&&(c=1),a[l]=a[l-1]+c}const o=new Array(a[s]);for(let l=0;l<s;++l){const u=n[l];let c=a[l];if(this.nGramWidths.forEach(f=>{const h=n[l+1]-n[l],d=this.getNumNGrams(h,f);this.createNGrams(t,u,o,c,d,f),c+=d}),this.preserveShort&&c===a[l]){const f=n[l+1]-n[l];if(f===0)continue;const h=f+2*this.padWidth,d=1;this.createNGrams(t,u,o,c,d,h)}}return[o,a]}}function KNe(e,t,n,r,i,s,a,o){return new I2t(n,r,i,s,a,o).compute(e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N2t(e,t,n,r){if(!e.length)return;if(t.length===0){for(let s=0;s<e.length;++s)r.push(e.subarray(s,s+1));return}if(t.length===1){const s=t[0];let a=e.indexOf(s);for(;a!==-1;){const o=e.subarray(0,a);(!n||o.length!==0)&&r.push(o),e=e.subarray(a+1),a=e.indexOf(s)}(!n||e.length!==0)&&r.push(e);return}let i=0;for(let s=0;s<e.length+1;s++)if(s===e.length||t.indexOf(e[s])!==-1){const a=e.subarray(i,s);(!n||a.length!==0)&&r.push(a),i=s+1}}function ZNe(e,t,n){const r=e.length,i=[];let s=0,a=0;const o=new Array(r);for(let h=0;h<r;++h){const d=i.length;N2t(e[h],t,n,i);const p=i.length-d;o[h]=p,s+=p,a=Math.max(a,p)}const l=Br("int32",s*2),u=new Array(s),c=[r,a];let f=0;for(let h=0;h<r;++h)for(let d=0;d<o[h];++d)l[f*2]=h,l[f*2+1]=d,u[f]=i[f],++f;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QNe(e,t){const n=Br("int32",e.length);for(let r=0;r<e.length;++r)n[r]=wAe(e[r]).modulo(t).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JNe=ti((e,t)=>e-t),M2t=Vne((e,t,n,r)=>({real:e-n,imag:t-r})),Yne=xi(v_,JNe,M2t),F2t={kernelName:v_,backendName:"cpu",kernelFunc:Yne};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eMe(e,t){const n=new Array(e.rank);for(let i=0;i<n.length;i++)n[i]=e.shape[i]*t[i];const r=Mt(n,e.dtype);for(let i=0;i<r.values.length;++i){const s=r.indexToLoc(i),a=new Array(e.rank);for(let l=0;l<a.length;l++)a[l]=s[l]%e.shape[l];const o=e.locToIndex(a);r.values[i]=e.values[o]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rE=(e,t)=>{const n=t.value-e.value;return n===0?e.index-t.index:n};function tMe(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){const o=r-n+1,l=t-n+1,u=Math.log(o),c=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*c*(o-c)/o)*Math.sign(l-o/2),h=Math.max(n,Math.floor(t-l*c/o+f)),d=Math.min(r,Math.floor(t+(o-l)*c/o+f));tMe(e,t,h,d)}const i=e[t];let s=n,a=r;for(Gd(e,n,t),rE(e[r],i)>0&&Gd(e,n,r);s<a;){for(Gd(e,s,a),s++,a--;rE(e[s],i)<0;)s=s+1;for(;rE(e[a],i)>0;)a=a-1}rE(e[n],i)===0?Gd(e,n,a):(a=a+1,Gd(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}}function nMe(e,t,n,r,i){const s=t[t.length-1],[a,o]=[e.length/s,s],l=Fi(n,a*r),u=Fi("int32",a*r);for(let f=0;f<a;f++){const h=f*o,d=e.subarray(h,h+o);let p=new Array(d.length);d.forEach((y,b)=>p[b]={value:y,index:b}),r<p.length&&(tMe(p,r),p=p.slice(0,r)),i&&p.sort(rE);const g=f*r,m=l.subarray(g,g+r),v=u.subarray(g,g+r);for(let y=0;y<r;y++)m[y]=p[y].value,v[y]=p[y].index}const c=t.slice();return c[c.length-1]=r,[Mt(c,n,l),Mt(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rMe(e,t,n,r){const i=Ot(t,n)[0],s=[1,n[0],1];for(let p=0;p<i;p++)s[0]*=n[p];s[1]=n[i];for(let p=i+1;p<n.length;p++)s[2]*=n[p];const a=new Map,o=new Int32Array(n[i]),l=new oi(s,r,e),u=[],c=s[0]===1&&s[2]===1;for(let p=0;p<n[i];p++){let g;if(c)g=e[p].toString();else{const v=[];for(let y=0;y<s[0];y++)for(let b=0;b<s[2];b++)v.push(l.get(y,p,b));g=v.join(",")}const m=a.get(g);if(m!=null)o[p]=m;else{const v=a.size;a.set(g,v),o[p]=v,u.push(p)}}const f=s.slice();f[1]=a.size;const h=new oi(f,r);u.forEach((p,g)=>{for(let m=0;m<s[0];m++)for(let v=0;v<s[2];v++)h.set(l.get(m,p,v),m,g,v)});const d=n.slice();return d[i]=f[1],{outputValues:h.values,outputShape:d,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O2t=Object.freeze(Object.defineProperty({__proto__:null,simpleAbsImpl:cNe,addImpl:hNe,bincountImpl:jne,bincountReduceImpl:dNe,bitwiseAndImpl:pNe,castImpl:fNe,ceilImpl:gNe,concatImpl:mNe,equalImpl:vNe,expImpl:bNe,expm1Impl:wNe,floorImpl:$Ne,floorDivImpl:CNe,gatherNdImpl:_Ne,gatherV2Impl:SNe,greaterImpl:kNe,greaterEqualImpl:ENe,lessImpl:ANe,lessEqualImpl:TNe,linSpaceImpl:DNe,logImpl:INe,maxImpl:NNe,maximumImpl:MNe,minimumImpl:FNe,multiplyImpl:Hne,negImpl:ONe,notEqualImpl:RNe,prodImpl:PNe,raggedGatherImpl:LNe,raggedRangeImpl:BNe,raggedTensorToTensorImpl:zNe,rangeImpl:UNe,rsqrtImpl:WNe,scatterImpl:A1,sigmoidImpl:w2t,sliceImpl:jNe,sparseFillEmptyRowsImpl:HNe,sparseReshapeImpl:qNe,sparseSegmentReductionImpl:Gne,sqrtImpl:_2t,squaredDifferenceImpl:GNe,staticRegexReplaceImpl:YNe,stridedSliceImpl:XNe,stringNGramsImpl:KNe,stringSplitImpl:ZNe,stringToHashBucketFastImpl:QNe,subImpl:JNe,tileImpl:eMe,topKImpl:nMe,transposeImpl:qne,uniqueImpl:rMe},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ote("cpu",()=>new k7,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iMe=Bn(zC,e=>e>=0?e:Math.exp(e)-1),R2t={kernelName:zC,backendName:"cpu",kernelFunc:iMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sMe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:s}=r;Ge([i],"leakyRelu");const a=he(i.shape),o=n.data.get(i.dataId).values,l=Fi("float32",a);for(let u=0;u<o.length;u++)l[u]=o[u]<0?s*o[u]:o[u];return n.makeTensorInfo(i.shape,"float32",l)}const P2t={kernelName:PI,backendName:"cpu",kernelFunc:sMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L2t=ti((e,t)=>e<0?t*e:e);function aMe(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t;Ge([r,i],"prelu");const s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,[o,l]=L2t(r.shape,i.shape,s,a,"float32");return n.makeTensorInfo(l,"float32",o)}const B2t={kernelName:nN,backendName:"cpu",kernelFunc:aMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oMe=Bn(s_,e=>Math.max(0,e)),z2t={kernelName:s_,backendName:"cpu",kernelFunc:oMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lMe=Bn(a_,e=>Math.min(Math.max(0,e),6)),U2t={kernelName:a_,backendName:"cpu",kernelFunc:lMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L5(e,t,n,r,i){if(n==="linear")return Fh({inputs:{x:t},backend:e});if(n==="relu")return oMe({inputs:{x:t},backend:e});if(n==="elu")return iMe({inputs:{x:t},backend:e});if(n==="relu6")return lMe({inputs:{x:t},backend:e});if(n==="prelu")return aMe({inputs:{x:t,alpha:r},backend:e});if(n==="leakyrelu")return sMe({inputs:{x:t},backend:e,attrs:{alpha:i}});if(n==="sigmoid")return VNe({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tr(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:s}=r,a=he(i.shape),o=Xee(s,a),l=he(o);B(a===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${i.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);const u=n.data.get(i.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,f=u.complexTensorInfos.imag;c.shape=o,f.shape=o}return{dataId:i.dataId,shape:o,dtype:i.dtype}}const W2t={kernelName:iN,backendName:"cpu",kernelFunc:tr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uMe(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s}=t,{transposeA:a,transposeB:o}=r;Ge([i,s],"matMul");const l=i.shape.length,u=s.shape.length,c=a?i.shape[l-2]:i.shape[l-1],f=o?s.shape[u-1]:s.shape[u-2],h=a?i.shape[l-1]:i.shape[l-2],d=o?s.shape[u-2]:s.shape[u-1],p=i.shape.slice(0,-2),g=s.shape.slice(0,-2),m=he(p),v=he(g),b=Ct(i.shape.slice(0,-2),s.shape.slice(0,-2)).concat([h,d]);B(c===f,()=>`Error in matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${i.shape} and ${s.shape} and transposeA=${a} and transposeB=${o} must match.`);const x=a?[m,c,h]:[m,h,c],w=o?[v,d,f]:[v,f,d],C=tr({inputs:{x:i},backend:n,attrs:{shape:x}}),$=tr({inputs:{x:s},backend:n,attrs:{shape:w}}),_=a?C.shape[1]:C.shape[2],k=a?C.shape[2]:C.shape[1],E=o?$.shape[1]:$.shape[2],S=Math.max(m,v),I=n.data.get(C.dataId).values,A=n.data.get($.dataId).values,D=Je(C.shape),T=Je($.shape),[N,F,R]=a?[D[0],1,D[1]]:[D[0],D[1],1],[P,V,z]=o?[1,T[1],T[0]]:[T[1],1,T[0]],q=k*E,G=Mt([S,k,E],C.dtype),K=G.values,Y=n.blockSize;for(let te=0;te<S;te++){const Z=te%m,ae=te%v;for(let O=0;O<k;O+=Y){const L=Math.min(O+Y,k);for(let W=0;W<E;W+=Y){const M=Math.min(W+Y,E);for(let ue=0;ue<_;ue+=Y){const X=Math.min(ue+Y,_);for(let se=O;se<L;se++)for(let oe=W;oe<M;oe++){let pe=0;for(let Ce=ue;Ce<X;Ce++){const ze=I[Z*N+se*F+Ce*R],et=A[Ce*P+oe*V+ae*z];pe+=ze*et}K[te*q+(se*E+oe)]+=pe}}}}}return n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo($),n.makeTensorInfo(b,G.dtype,G.values)}const V2t={kernelName:wI,backendName:"cpu",kernelFunc:uMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j2t(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s,bias:a,preluActivationWeights:o}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:f}=r;let h,d,p;const g=[];h=uMe({inputs:{a:i,b:s},attrs:{transposeA:l,transposeB:u},backend:n}),a&&(d=Bw({inputs:{a:h,b:a},backend:n}),g.push(h),h=d),c&&(p=L5(n,h,c,o,f),g.push(h),h=p);for(const v of g)n.disposeIntermediateTensorInfo(v);return h}const H2t={kernelName:lT,backendName:"cpu",kernelFunc:j2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q2t=Bn(EC,e=>Math.acos(e)),G2t={kernelName:EC,backendName:"cpu",kernelFunc:q2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y2t=Bn(AC,e=>Math.acosh(e)),X2t={kernelName:AC,backendName:"cpu",kernelFunc:Y2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K2t(e){const{inputs:t,backend:n}=e,r=t;Ge(t,"addN");const i=r.map(o=>n.data.get(o.dataId).values),s=Mt(r[0].shape,r[0].dtype),a=s.values;for(let o=0;o<r.length;o++){const l=i[o];for(let u=0;u<a.length;u++)a[u]+=l[u]}return n.makeTensorInfo(s.shape,s.dtype,s.values)}const Z2t={kernelName:mI,backendName:"cpu",kernelFunc:K2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q2t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r;Ge(i,"all");const o=Ot(s,i.shape);let l=o;const u=Fr(l,i.shape.length);let c=i;u!=null&&(c=po({inputs:{x:i},backend:n,attrs:{perm:u}}),l=Jr(l.length,i.shape.length)),vs("all",l,c.shape.length);const[f,h]=Li(c.shape,l),d=he(h),p=hs(he(f),c.dtype),g=n.data.get(c.dataId).values;for(let v=0;v<p.length;++v){const y=v*d;let b=g[y];for(let x=0;x<d;++x){const w=g[y+x];b=b&&w}p[v]=b}u!=null&&n.disposeIntermediateTensorInfo(c);const m=n.makeTensorInfo(f,c.dtype,p);if(a){const v=Zr(f,o),y=tr({inputs:{x:m},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(m),y}return m}const J2t={kernelName:D8,backendName:"cpu",kernelFunc:Q2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ewt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r;Ge(i,"any");const o=Ot(s,i.shape);let l=o;const u=Fr(l,i.shape.length);let c=i;u!=null&&(c=po({inputs:{x:i},backend:n,attrs:{perm:u}}),l=Jr(l.length,i.shape.length)),vs("any",l,c.shape.length);const[f,h]=Li(c.shape,l),d=he(h),p=hs(he(f),c.dtype),g=n.data.get(c.dataId).values;for(let v=0;v<p.length;++v){const y=v*d;let b=g[y];for(let x=0;x<d;++x){const w=g[y+x];b=b||w}p[v]=b}u!=null&&n.disposeIntermediateTensorInfo(c);const m=n.makeTensorInfo(f,c.dtype,p);if(a){const v=Zr(f,o),y=tr({inputs:{x:m},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(m),y}return m}const twt={kernelName:I8,backendName:"cpu",kernelFunc:ewt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;Ge(i,"argMax");let a=Ot(s,i.shape);const o=Fr(a,i.shape.length);let l=i;const u=[];o!=null&&(l=po({inputs:{x:i},backend:n,attrs:{perm:o}}),u.push(l),a=Jr(a.length,l.shape.length)),a=[a[0]],vs("argMax",a,l.shape.length);const[c,f]=Li(l.shape,a),h=he(c),d=hs(h,"int32"),p=he(f),g=n.data.get(l.dataId).values;for(let m=0;m<d.length;++m){const v=m*p;let y=g[v],b=0;for(let x=0;x<p;++x){const w=g[v+x];w>y&&(y=w,b=x)}d[m]=b}return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),n.makeTensorInfo(c,"int32",d)}const rwt={kernelName:vI,backendName:"cpu",kernelFunc:nwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;Ge(i,"argMin");let a=Ot(s,i.shape);const o=Fr(a,i.shape.length);let l=i;const u=[];o!=null&&(l=po({inputs:{x:i},backend:n,attrs:{perm:o}}),u.push(l),a=Jr(a.length,l.shape.length)),a=[a[0]],vs("argMin",a,l.shape.length);const[c,f]=Li(l.shape,a),h=he(c),d=hs(h,"int32"),p=he(f),g=n.data.get(l.dataId).values;for(let m=0;m<d.length;++m){const v=m*p;let y=g[v],b=0;for(let x=0;x<p;++x){const w=g[v+x];w<y&&(y=w,b=x)}d[m]=b}return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),n.makeTensorInfo(c,"int32",d)}const swt={kernelName:yI,backendName:"cpu",kernelFunc:iwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const awt=Bn(TC,e=>Math.asin(e)),owt={kernelName:TC,backendName:"cpu",kernelFunc:awt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lwt=Bn(DC,e=>Math.asinh(e)),uwt={kernelName:DC,backendName:"cpu",kernelFunc:lwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cwt=Bn(IC,e=>Math.atan(e)),fwt={kernelName:IC,backendName:"cpu",kernelFunc:cwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hwt=ti((e,t)=>Math.atan2(e,t)),dwt=xi(MC,hwt),pwt={kernelName:MC,backendName:"cpu",kernelFunc:dwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gwt=Bn(NC,e=>Math.atanh(e)),mwt={kernelName:NC,backendName:"cpu",kernelFunc:gwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xne(e,t,n,r,i,s){const a=i.strideHeight,o=i.strideWidth,l=i.dilationHeight,u=i.dilationWidth,c=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=i.padInfo.top,d=i.padInfo.left,p=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Mt(i.outShape,n),m=g.values,v=i.outShape[1]*i.outShape[2]*i.outShape[3],y=i.outShape[2]*i.outShape[3],b=i.outShape[3];for(let x=0;x<i.batchSize;++x){const w=x*v,C=x*r[0];for(let $=0;$<i.inChannels;++$)for(let _=0;_<i.outHeight;++_){const k=_*a-h,E=Math.max(0,k),S=Math.min(i.inHeight,c+k),I=w+_*y;for(let A=0;A<i.outWidth;++A){const D=A*o-d,T=Math.max(0,D),N=Math.min(i.inWidth,f+D);let F=p,R=0,P=0;for(let z=E;z<S;z+=l){const q=C+z*r[1];for(let G=T;G<N;G+=u){const K=q+G*r[2],Y=e[K+$];s==="max"&&Y>F?F=Y:s==="avg"&&(R+=Y,P++)}if(isNaN(F))break}const V=I+A*b+$;m[V]=s==="avg"?R/P:F}}}return g}function cMe(e,t,n,r,i=!1,s=!1){const a=Mt(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,g=Mt(t,n,e);for(let m=0;m<r.batchSize;++m)for(let v=0;v<r.inChannels;++v)for(let y=0;y<r.outHeight;++y){const b=y*o-d;let x=b;for(;x<0;)x+=u;const w=Math.min(r.inHeight,f+b);for(let C=0;C<r.outWidth;++C){const $=C*l-p;let _=$;for(;_<0;)_+=c;const k=Math.min(r.inWidth,h+$);let E=Number.NEGATIVE_INFINITY,S=-1;for(let I=x;I<w;I+=u){const A=I-b;for(let D=_;D<k;D+=c){const T=D-$,N=g.get(m,I,D,v);N>E&&(E=N,i?S=s?((m*r.inHeight+I)*r.inWidth+D)*r.inChannels+v:(I*r.inWidth+D)*r.inChannels+v:S=A*h+T)}}a.set(S,m,y,C,v)}}return a}function fMe(e,t,n,r,i,s){const a=i.strideDepth,o=i.strideHeight,l=i.strideWidth,u=i.dilationDepth,c=i.dilationHeight,f=i.dilationWidth,h=i.effectiveFilterDepth,d=i.effectiveFilterHeight,p=i.effectiveFilterWidth,g=i.padInfo.front,m=i.padInfo.top,v=i.padInfo.left,y=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Mt(i.outShape,n),x=b.values,w=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],C=i.outShape[2]*i.outShape[3]*i.outShape[4],$=i.outShape[3]*i.outShape[4],_=i.outShape[4];for(let k=0;k<i.batchSize;++k){const E=k*w,S=k*r[0];for(let I=0;I<i.inChannels;++I)for(let A=0;A<i.outDepth;++A){const D=A*a-g;let T=D;for(;T<0;)T+=u;const N=Math.min(i.inDepth,h+D),F=E+A*C;for(let R=0;R<i.outHeight;++R){const P=R*o-m;let V=P;for(;V<0;)V+=c;const z=Math.min(i.inHeight,d+P),q=F+R*$;for(let G=0;G<i.outWidth;++G){const K=G*l-v;let Y=K;for(;Y<0;)Y+=f;const te=Math.min(i.inWidth,p+K),Z=q+G*_;let ae=y,O=0,L=0;for(let M=T;M<N;M+=u){const ue=S+M*r[1];for(let X=V;X<z;X+=c){const se=ue+X*r[2];for(let oe=Y;oe<te;oe+=f){const pe=se+oe*r[3],Ce=e[pe+I];if(s==="max"&&Ce>ae?ae=Ce:s==="avg"&&(O+=Ce,L++),isNaN(ae))break}if(isNaN(ae))break}if(isNaN(ae))break}const W=Z+I;x[W]=s==="avg"?O/Math.max(L,1):ae}}}}return b}function vwt(e,t){const n=Mt(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,s=t.strideWidth,a=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,c=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,d=t.padInfo.top,p=t.padInfo.left;for(let g=0;g<t.batchSize;++g)for(let m=0;m<t.inChannels;++m)for(let v=0;v<t.outDepth;++v){const y=v*r-h;let b=y;for(;b<0;)b+=a;const x=Math.min(t.inDepth,u+y);for(let w=0;w<t.outHeight;++w){const C=w*i-d;let $=C;for(;$<0;)$+=o;const _=Math.min(t.inHeight,c+C);for(let k=0;k<t.outWidth;++k){const E=k*s-p;let S=E;for(;S<0;)S+=l;const I=Math.min(t.inWidth,f+E);let A=Number.NEGATIVE_INFINITY,D=-1;for(let T=b;T<x;T+=a){const N=T-y;for(let F=$;F<_;F+=o){const R=F-C;for(let P=S;P<I;P+=l){const V=P-E,z=e.get(g,T,F,P,m);z>=A&&(A=z,D=N*c*f+R*c+V)}}}n.set(D,g,v,w,k,m)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ywt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;Ge(i,"avgPool");const{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=r,u=1;B(ms(a,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const c=Hu(i.shape,s,a,u,o,l);let f;if(c.filterWidth===1&&c.filterHeight===1&&Zt(c.inShape,c.outShape))f=Fh({inputs:{x:i},backend:n});else{const h=n.data.get(i.dataId).values,d=Je(i.shape),p=Xne(h,i.shape,i.dtype,d,c,"avg");f=n.makeTensorInfo(c.outShape,i.dtype,p.values)}return f}const bwt={kernelName:bI,backendName:"cpu",kernelFunc:ywt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:a,pad:o,dimRoundingMode:l,dataFormat:u}=r;Ge(i,"avgPool3d");const c=tg(i.shape,s,a,1,o,l,u),f=n.data.get(i.dataId).values,h=fMe(f,i.shape,i.dtype,Je(i.shape),c,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const wwt={kernelName:xI,backendName:"cpu",kernelFunc:xwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $wt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,{filterSize:a,strides:o,pad:l,dimRoundingMode:u}=r;Ge([i,s],"avgPool3DGrad");const c=tg(s.shape,a,o,1,l,u),f=c.strideDepth,h=c.strideHeight,d=c.strideWidth,p=c.filterDepth,g=c.filterHeight,m=c.filterWidth,v=c.dilationDepth,y=c.dilationHeight,b=c.dilationWidth,x=c.effectiveFilterDepth,w=c.effectiveFilterHeight,C=c.effectiveFilterWidth,$=x-1-c.padInfo.front,_=C-1-c.padInfo.left,k=w-1-c.padInfo.top,E=Mt(s.shape,"float32"),S=1/(p*g*m),I=n.bufferSync(i);for(let A=0;A<c.batchSize;++A)for(let D=0;D<c.inChannels;++D)for(let T=0;T<c.inDepth;++T)for(let N=0;N<c.inHeight;++N)for(let F=0;F<c.inWidth;++F){const R=T-$,P=N-k,V=F-_;let z=0;for(let q=0;q<x;q+=v){const G=(R+q)/f;if(!(G<0||G>=c.outDepth||Math.floor(G)!==G))for(let K=0;K<w;K+=y){const Y=(P+K)/h;if(!(Y<0||Y>=c.outHeight||Math.floor(Y)!==Y))for(let te=0;te<C;te+=b){const Z=(V+te)/d;if(Z<0||Z>=c.outWidth||Math.floor(Z)!==Z)continue;const ae=I.get(A,G,Y,Z,D);z+=ae}}}E.set(z*S,A,T,N,F,D)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const Cwt={kernelName:M8,backendName:"cpu",kernelFunc:$wt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _wt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,a=s;Ge([i,s],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=r,c=Hu(a.shape,o,l,1,u),f=c.strideHeight,h=c.strideWidth,d=c.filterHeight,p=c.filterWidth,g=c.dilationHeight,m=c.dilationWidth,v=c.effectiveFilterHeight,y=c.effectiveFilterWidth,b=y-1-c.padInfo.left,x=v-1-c.padInfo.top,w=Mt(a.shape,"float32"),C=1/(d*p),$=n.data.get(i.dataId).values,_=Mt(i.shape,"float32",$);for(let k=0;k<c.batchSize;++k)for(let E=0;E<c.inChannels;++E)for(let S=0;S<c.inHeight;++S)for(let I=0;I<c.inWidth;++I){const A=S-x,D=I-b;let T=0;for(let N=0;N<v;N+=g){const F=(A+N)/f;if(!(F<0||F>=c.outHeight||Math.floor(F)!==F))for(let R=0;R<y;R+=m){const P=(D+R)/h;if(P<0||P>=c.outWidth||Math.floor(P)!==P)continue;const V=_.get(k,F,P,E);T+=V}}w.set(T*C,k,S,I,E)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const Swt={kernelName:N8,backendName:"cpu",kernelFunc:_wt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,scale:s,offset:a,mean:o,variance:l}=t;B(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),B(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),B(s==null||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ge([i,o,l,s,a],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);const c=n.data.get(i.dataId).values,f=n.data.get(o.dataId).values,h=n.data.get(l.dataId).values,d=s?n.data.get(s.dataId).values:new Float32Array([1]),p=a?n.data.get(a.dataId).values:new Float32Array([0]),g=new Float32Array(c.length),m=p.length,v=d.length,y=h.length,b=f.length;let x=0,w=0,C=0,$=0;for(let _=0;_<c.length;++_)g[_]=p[x++]+(c[_]-f[w++])*d[C++]/Math.sqrt(h[$++]+u),x>=m&&(x=0),w>=b&&(w=0),C>=v&&(C=0),$>=y&&($=0);return n.makeTensorInfo(i.shape,i.dtype,g)}const Ewt={kernelName:FI,backendName:"cpu",kernelFunc:kwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Awt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,crops:a}=r;Ge([i],"batchToSpaceND");const o=s.reduce((v,y)=>v*y),l=EN(i.shape,s,o),u=AN(l.length,s.length),c=TN(i.shape,s,o),f=sne(a,s.length),h=ane(c,a,s.length),d=tr({inputs:{x:i},backend:n,attrs:{shape:l}}),p=po({inputs:{x:d},backend:n,attrs:{perm:u}}),g=tr({inputs:{x:p},backend:n,attrs:{shape:c}}),m=Uy({inputs:{x:g},backend:n,attrs:{begin:f,size:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const Twt={kernelName:$I,backendName:"cpu",kernelFunc:Awt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:a}=r,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,u=jne(o,l,s.dtype,s.shape,a);return n.makeTensorInfo([a],s.dtype,u)}const Iwt={kernelName:F8,backendName:"cpu",kernelFunc:Dwt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nwt(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,o=Ct(Array.from(s),Array.from(a));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const Mwt={kernelName:O8,backendName:"cpu",kernelFunc:Nwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fwt=Bn(RC,(e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),Owt={kernelName:RC,backendName:"cpu",kernelFunc:Fwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rwt=e=>{const{x:t}=e.inputs,n=e.backend,r=new Float32Array(he(t.shape)),i=n.data.get(t.dataId),s=i.complexTensorInfos.real,a=i.complexTensorInfos.imag,o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values;for(let u=0;u<o.length;u++){const c=o[u],f=l[u];r[u]=Math.hypot(c,f)}return n.makeOutput(r,t.shape,"float32")},Pwt={kernelName:_I,backendName:"cpu",kernelFunc:Rwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zw(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.imag,s=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,s)}const Lwt={kernelName:tz,backendName:"cpu",kernelFunc:zw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uw(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,s=Ot(i,t[0].shape)[0],a=t.map(g=>g.shape);nne(a,s);let o=rh(t.map(g=>g.shape),s);if(he(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);const l=t.filter(g=>he(g.shape)>0);if(l.length===1)return Fh({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const g=l.map(x=>zy({inputs:{input:x},backend:n})),m=l.map(x=>zw({inputs:{input:x},backend:n})),v=Uw({inputs:g,backend:n,attrs:{axis:s}}),y=Uw({inputs:m,backend:n,attrs:{axis:s}}),b=Uo({inputs:{real:v,imag:y},backend:n});return g.forEach(x=>n.disposeIntermediateTensorInfo(x)),m.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),b}const u=l.map(g=>{const v=[-1,he(g.shape.slice(s))];return tr({inputs:{x:g},backend:n,attrs:{shape:v}})}),c=u.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));o=rh(u.map(g=>g.shape),1);const f=u[0].shape[0]===1,h=mNe(c,o,t[0].dtype,f),d=rh(l.map(g=>g.shape),s),p=n.makeTensorInfo(d,t[0].dtype,h);return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const Bwt={kernelName:SI,backendName:"cpu",kernelFunc:Uw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hMe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=r;Ge([i,s],"conv2d");const f=ng(l),h=Pi(i.shape,s.shape,a,u,o,c,!1,f),d=h.filterHeight,p=h.filterWidth,g=h.dilationHeight,m=h.dilationWidth,v=h.padInfo.left,y=h.padInfo.top,b=h.dataFormat==="channelsLast",x=new oi(h.outShape,i.dtype),w=Je(i.shape),C=Je(s.shape),$=w[0],_=b?w[1]:w[2],k=b?w[2]:1,E=b?1:w[1],S=x.strides[0],I=b?x.strides[1]:x.strides[2],A=b?x.strides[2]:1,D=b?1:x.strides[1],T=n.data.get(i.dataId).values,N=n.data.get(s.dataId).values,F=x.values;for(let R=0;R<h.batchSize;++R){const P=R*$,V=R*S;for(let z=0;z<h.outHeight;++z){const q=V+z*I,G=z*h.strideHeight-y;for(let K=0;K<d;++K){const Y=G+K*g;if(Y<0||Y>=h.inHeight)continue;const te=K*C[0],Z=P+Y*_;for(let ae=0;ae<h.outWidth;++ae){const O=q+ae*A,L=ae*h.strideWidth-v;for(let W=0;W<p;++W){const M=L+W*m;if(M<0||M>=h.inWidth)continue;const ue=te+W*C[1],X=Z+M*k;let se=ue;for(let oe=0;oe<h.inChannels;++oe){const pe=T[X+oe*E];for(let Ce=0;Ce<h.outChannels;++Ce)F[O+Ce*D]+=pe*N[se+Ce];se+=h.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,F)}const zwt={kernelName:kI,backendName:"cpu",kernelFunc:hMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:a,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;Ge([i,s],"conv2dBackpropFilter");const f=ng(l),h=Pi(i.shape,c,a,1,o,u,!1,f),{strideHeight:d,strideWidth:p,filterHeight:g,filterWidth:m}=h,v=h.dataFormat==="channelsLast",y=new oi(h.filterShape,"float32"),b=h.padInfo.left,x=h.padInfo.top,w=n.data.get(i.dataId).values,C=n.data.get(s.dataId).values,$=new oi(i.shape,i.dtype,w),_=new oi(s.shape,s.dtype,C);for(let k=0;k<g;++k){const E=Math.max(0,Math.ceil((x-k)/d)),S=Math.min(h.outHeight,(h.inHeight+x-k)/d);for(let I=0;I<m;++I){const A=Math.max(0,Math.ceil((b-I)/p)),D=Math.min(h.outWidth,(h.inWidth+b-I)/p);for(let T=0;T<h.inChannels;++T)for(let N=0;N<h.outChannels;++N){let F=0;for(let R=0;R<h.batchSize;++R)for(let P=E;P<S;++P){const V=k+P*d-x;for(let z=A;z<D;++z){const q=I+z*p-b;v?F+=$.get(R,V,q,T)*_.get(R,P,z,N):F+=$.get(R,T,V,q)*_.get(R,N,P,z)}}y.set(F,k,I,T,N)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const Wwt={kernelName:P8,backendName:"cpu",kernelFunc:Uwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vwt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{inputShape:a,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=r;Ge([i,s],"conv2dBackpropInput");const f=Je(s.shape),h=Je(i.shape);let d=ng(u);const p=Pi(a,s.shape,o,1,l,c,!1,d),g=new oi(p.inShape,"float32"),m=g.values,v=n.data.get(i.dataId).values,y=n.data.get(s.dataId).values,[b,x,w]=f,{batchSize:C,filterHeight:$,filterWidth:_,inChannels:k,inHeight:E,inWidth:S,outChannels:I,outHeight:A,outWidth:D,strideHeight:T,strideWidth:N}=p;d=p.dataFormat;const F=$-1-p.padInfo.top,R=_-1-p.padInfo.left,P=d==="channelsLast",V=g.strides[0],z=P?g.strides[1]:g.strides[2],q=P?g.strides[2]:1,G=P?1:g.strides[1],K=h[0],Y=P?h[1]:h[2],te=P?h[2]:1,Z=P?1:h[1];for(let ae=0;ae<C;++ae)for(let O=0;O<k;++O)for(let L=0;L<E;++L){const W=L-F,M=Math.max(0,Math.ceil(W/T)),ue=Math.min(A,($+W)/T);for(let X=0;X<S;++X){const se=X-R,oe=Math.max(0,Math.ceil(se/N)),pe=Math.min(D,(_+se)/N);let Ce=0;for(let et=M;et<ue;++et){const dt=et*T-W;for(let He=oe;He<pe;++He){const Se=He*N-se,j=K*ae+Y*et+te*He,fe=b*($-1-dt)+x*(_-1-Se)+w*O;for(let _e=0;_e<I;++_e){const ve=v[j+Z*_e],ye=y[fe+_e];Ce+=ve*ye}}}const ze=V*ae+z*L+q*X+G*O;m[ze]=Ce}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const jwt={kernelName:EI,backendName:"cpu",kernelFunc:Vwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dilations:l}=r;Ge([i,s],"conv3d");const u=zm(i.shape,s.shape,a,l,o),{filterDepth:c,filterHeight:f,filterWidth:h,dilationDepth:d,dilationHeight:p,dilationWidth:g,padInfo:m}=u,v=m.front,y=m.left,b=m.top,x=new oi(u.outShape,i.dtype),w=n.data.get(i.dataId).values,C=n.data.get(s.dataId).values,$=x.values,_=Je(i.shape),k=Je(s.shape);for(let E=0;E<u.batchSize;++E){const S=E*_[0],I=E*x.strides[0];for(let A=0;A<u.outDepth;++A){const D=I+A*x.strides[1],T=A*u.strideDepth-v;for(let N=0;N<c;++N){const F=T+N*d;if(F<0||F>=u.inDepth)continue;const R=N*k[0],P=S+F*_[1];for(let V=0;V<u.outHeight;++V){const z=D+V*x.strides[2],q=V*u.strideHeight-b;for(let G=0;G<f;++G){const K=q+G*p;if(K<0||K>=u.inHeight)continue;const Y=R+G*k[1],te=P+K*_[2];for(let Z=0;Z<u.outWidth;++Z){const ae=z+Z*u.outChannels,O=Z*u.strideWidth-y;for(let L=0;L<h;++L){const W=O+L*g;if(W<0||W>=u.inWidth)continue;const M=Y+L*k[2],ue=te+W*u.inChannels;let X=M;for(let se=0;se<u.inChannels;++se){const oe=w[ue+se];for(let pe=0;pe<u.outChannels;++pe)$[ae+pe]+=oe*C[X+pe];X+=u.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const qwt={kernelName:AI,backendName:"cpu",kernelFunc:Hwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:a,pad:o,filterShape:l}=r;Ge([i,s],"conv3dBackpropFilterV2");const u=Je(i.shape),c=Je(s.shape),f=zm(i.shape,l,a,1,o),h=f.strideDepth,d=f.strideHeight,p=f.strideWidth,g=f.filterDepth,m=f.filterHeight,v=f.filterWidth,y=new oi(f.filterShape,"float32"),b=y.values,[x,w,C,$]=y.strides,_=n.data.get(s.dataId).values,[k,E,S,I]=c,A=n.data.get(i.dataId).values,[D,T,N,F]=u,R=f.padInfo.front,P=f.padInfo.left,V=f.padInfo.top;for(let z=0;z<g;++z){const q=Math.max(0,Math.ceil((R-z)/h)),G=Math.min(f.outDepth,(f.inDepth+R-z)/h),K=z*x;for(let Y=0;Y<m;++Y){const te=Math.max(0,Math.ceil((V-Y)/d)),Z=Math.min(f.outHeight,(f.inHeight+V-Y)/d),ae=Y*w+K;for(let O=0;O<v;++O){const L=Math.max(0,Math.ceil((P-O)/p)),W=Math.min(f.outWidth,(f.inWidth+P-O)/p),M=O*C+ae;for(let ue=0;ue<f.inChannels;++ue){const X=ue*$+M;for(let se=0;se<f.outChannels;++se){let oe=0;for(let pe=0;pe<f.batchSize;++pe){const Ce=pe*D,ze=pe*k;for(let et=q;et<G;++et){const He=(z+et*h-R)*T+Ce,Se=et*E+ze;for(let j=te;j<Z;++j){const _e=(Y+j*d-V)*N+He,ve=j*S+Se;for(let ye=L;ye<W;++ye){const Ae=(O+ye*p-P)*F+_e,Ve=ye*I+ve;oe+=A[Ae+ue]*_[Ve+se]}}}}b[X+se]=oe}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const Ywt={kernelName:L8,backendName:"cpu",kernelFunc:Gwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xwt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{pad:a,strides:o,inputShape:l}=r;Ge([i],"conv3dBackpropInputV2");const u=Je(i.shape),c=Je(s.shape),f=zm(l,s.shape,o,1,a),h=new oi(f.inShape,"float32"),d=h.values,[p,g,m,v]=h.strides,y=n.data.get(i.dataId).values,[b,x,w,C]=u,$=n.data.get(s.dataId).values,[_,k,E,S]=c,{batchSize:I,filterDepth:A,filterHeight:D,filterWidth:T,inChannels:N,inDepth:F,inHeight:R,inWidth:P,outChannels:V,outDepth:z,outHeight:q,outWidth:G,strideDepth:K,strideHeight:Y,strideWidth:te}=f,Z=A-1-f.padInfo.front,ae=D-1-f.padInfo.top,O=T-1-f.padInfo.left;for(let L=0;L<I;++L)for(let W=0;W<N;++W)for(let M=0;M<F;++M){const ue=M-Z,X=Math.max(0,Math.ceil(ue/K)),se=Math.min(z,(A+ue)/K);for(let oe=0;oe<R;++oe){const pe=oe-ae,Ce=Math.max(0,Math.ceil(pe/Y)),ze=Math.min(q,(D+pe)/Y);for(let et=0;et<P;++et){const dt=et-O,He=Math.max(0,Math.ceil(dt/te)),Se=Math.min(G,(T+dt)/te);let j=0;for(let fe=X;fe<se;++fe){const _e=fe*K-ue;for(let ve=Ce;ve<ze;++ve){const ye=ve*Y-pe;for(let yt=He;yt<Se;++yt){const Ae=yt*te-dt,Ve=b*L+x*fe+w*ve+C*yt,Xt=_*(A-1-_e)+k*(D-1-ye)+E*(T-1-Ae)+S*W;for(let nn=0;nn<V;++nn){const It=y[Ve+nn],cn=$[Xt+nn];j+=It*cn}}}}d[p*L+g*M+m*oe+v*et+W]=j}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const Kwt={kernelName:B8,backendName:"cpu",kernelFunc:Xwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zwt=Bn(PC,e=>Math.cos(e)),Qwt={kernelName:PC,backendName:"cpu",kernelFunc:Zwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jwt=Bn(LC,e=>Math.cosh(e)),e$t={kernelName:LC,backendName:"cpu",kernelFunc:Jwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t$t(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:s,boxInd:a}=t,{cropSize:o,method:l,extrapolationValue:u}=r,[c,f,h,d]=i.shape,p=s.shape[0],[g,m]=o,v=Mt([p,g,m,d],"float32"),y=n.data.get(s.dataId).values,b=n.data.get(a.dataId).values,x=n.data.get(i.dataId).values,w=Je(i.shape),C=Je(v.shape);for(let $=0;$<p;$++){const _=$*4,k=y[_],E=y[_+1],S=y[_+2],I=y[_+3],A=b[$];if(A>=c)continue;const D=g>1?(S-k)*(f-1)/(g-1):0,T=m>1?(I-E)*(h-1)/(m-1):0;for(let N=0;N<g;N++){const F=g>1?k*(f-1)+N*D:.5*(k+S)*(f-1);if(F<0||F>f-1){for(let R=0;R<m;R++)for(let P=0;P<d;P++){const V=P+R*C[2]+N*C[1]+$*C[0];v.values[V]=u}continue}if(l==="bilinear"){const R=Math.floor(F),P=Math.ceil(F),V=F-R;for(let z=0;z<m;z++){const q=m>1?E*(h-1)+z*T:.5*(E+I)*(h-1);if(q<0||q>h-1){for(let te=0;te<d;te++){const Z=te+z*C[2]+N*C[1]+$*C[0];v.values[Z]=u}continue}const G=Math.floor(q),K=Math.ceil(q),Y=q-G;for(let te=0;te<d;te++){let Z=te+G*w[2]+R*w[1]+A*w[0];const ae=x[Z];Z=te+K*w[2]+R*w[1]+A*w[0];const O=x[Z];Z=te+G*w[2]+P*w[1]+A*w[0];const L=x[Z];Z=te+K*w[2]+P*w[1]+A*w[0];const W=x[Z],M=ae+(O-ae)*Y,ue=L+(W-L)*Y;Z=te+z*C[2]+N*C[1]+$*C[0],v.values[Z]=M+(ue-M)*V}}}else for(let R=0;R<m;++R){const P=m>1?E*(h-1)+R*T:.5*(E+I)*(h-1);if(P<0||P>h-1){for(let q=0;q<d;q++){const G=q+R*C[2]+N*C[1]+$*C[0];v.values[G]=u}continue}const V=Math.round(P),z=Math.round(F);for(let q=0;q<d;q++){const G=q+V*w[2]+z*w[1]+A*w[0],K=q+R*C[2]+N*C[1]+$*C[0];v.values[K]=x[G]}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const n$t={kernelName:U8,backendName:"cpu",kernelFunc:t$t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:a,reverse:o}=r;Ge(i,"cumprod");const l=Fr([s],i.shape.length);let u=i;l!=null&&(u=po({inputs:{x:i},backend:n,attrs:{perm:l}}));const c=Jr(1,i.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const f=fo(u.dtype,"int32"),h=A8(he(u.shape),f),d=n.data.get(u.dataId).values,p=u.shape[u.shape.length-1],g=o?(v,y)=>v+p-y-1:(v,y)=>v+y;for(let v=0;v<d.length;v+=p)for(let y=0;y<p;y++){const b=g(v,y);if(y===0)h[b]=a?1:d[b];else{const x=g(v,y-1);h[b]=a?d[x]*h[x]:d[b]*h[x]}}const m=n.makeTensorInfo(u.shape,f,h);if(l!=null){const v=Um(l),y=po({inputs:{x:m},backend:n,attrs:{perm:v}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(u),y}return m}const i$t={kernelName:z8,backendName:"cpu",kernelFunc:r$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:a,reverse:o}=r;Ge(i,"cumsum");const l=Fr([s],i.shape.length);let u=i;l!=null&&(u=po({inputs:{x:i},backend:n,attrs:{perm:l}}));const c=Jr(1,i.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const f=fo(u.dtype,"int32"),h=hs(he(u.shape),f),d=n.data.get(u.dataId).values,p=u.shape[u.shape.length-1],g=o?(v,y)=>v+p-y-1:(v,y)=>v+y;for(let v=0;v<d.length;v+=p)for(let y=0;y<p;y++){const b=g(v,y);if(y===0)h[b]=a?0:d[b];else{const x=g(v,y-1);h[b]=a?d[x]+h[x]:d[b]+h[x]}}const m=n.makeTensorInfo(u.shape,f,h);if(l!=null){const v=Um(l),y=po({inputs:{x:m},backend:n,attrs:{perm:v}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(u),y}return m}const a$t={kernelName:TI,backendName:"cpu",kernelFunc:s$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:a,binaryOutput:o}=r;if(i.shape.length===1){const l=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,c=jne(l,u,s.dtype,s.shape,a);return n.makeTensorInfo([a],s.dtype,c)}else if(i.shape.length===2){const l=n.bufferSync(i),u=n.bufferSync(s),c=dNe(l,u,a,o);return n.makeTensorInfo(c.shape,s.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const l$t={kernelName:W8,backendName:"cpu",kernelFunc:o$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:s,dataFormat:a}=r;B(a==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${a}`);const o=i.shape[0],l=i.shape[1],u=i.shape[2],c=i.shape[3],f=l*s,h=u*s,d=c/(s*s),p=n.data.get(i.dataId).values,g=new Float32Array(o*f*h*d);let m=0;for(let v=0;v<o;++v)for(let y=0;y<f;++y){const b=Math.floor(y/s),x=y%s;for(let w=0;w<h;++w){const C=Math.floor(w/s),$=w%s,_=(x*s+$)*d;for(let k=0;k<d;++k){const S=k+_+c*(C+u*(b+l*v));g[m++]=p[S]}}}return n.makeTensorInfo([o,f,h,d],i.dtype,g)}const c$t={kernelName:V8,backendName:"cpu",kernelFunc:u$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dMe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dilations:l,dimRoundingMode:u}=r;Ge([i,s],"depthwiseConv2DNative");const c=Je(i.shape),f=Je(s.shape);let h=l;h==null&&(h=[1,1]),B(ms(a,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${h}'`);const d=Pi(i.shape,s.shape,a,h,o,u,!0),{filterHeight:p,filterWidth:g,dilationHeight:m,dilationWidth:v,padInfo:y}=d,b=y.left,x=y.top,w=d.outChannels/d.inChannels,C=new oi(d.outShape,i.dtype),$=n.data.get(i.dataId).values,_=n.data.get(s.dataId).values,k=C.values;for(let E=0;E<d.batchSize;++E){const S=E*c[0],I=E*C.strides[0];for(let A=0;A<d.outHeight;++A){const D=I+A*C.strides[1],T=A*d.strideHeight-x;for(let N=0;N<p;++N){const F=T+N*m;if(F<0||F>=d.inHeight)continue;const R=N*f[0],P=S+F*c[1];for(let V=0;V<d.outWidth;++V){const z=D+V*C.strides[2],q=V*d.strideWidth-b;for(let G=0;G<g;++G){const K=q+G*v;if(K<0||K>=d.inWidth)continue;const Y=R+G*f[1],te=P+K*d.inChannels;let Z=z,ae=Y;for(let O=0;O<d.inChannels;++O){const L=$[te+O];for(let W=0;W<w;++W)k[Z+W]+=L*_[ae+W];Z+=w,ae+=w}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const f$t={kernelName:DI,backendName:"cpu",kernelFunc:dMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:a,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=r;Ge([i,s],"depthwiseConv2dNativeBackpropFilter");const f=Pi(i.shape,c,a,o,l,u,!0),{strideHeight:h,strideWidth:d,filterHeight:p,filterWidth:g}=f,m=new oi(f.filterShape,"float32"),v=f.padInfo.left,y=f.padInfo.top,b=f.outChannels/f.inChannels,x=n.data.get(i.dataId).values,w=new oi(i.shape,i.dtype,x),C=n.data.get(s.dataId).values,$=new oi(s.shape,s.dtype,C);for(let _=0;_<p;++_){const k=Math.max(0,Math.ceil((y-_)/h)),E=Math.min(f.outHeight,(f.inHeight+y-_)/h);for(let S=0;S<g;++S){const I=Math.max(0,Math.ceil((v-S)/d)),A=Math.min(f.outWidth,(f.inWidth+v-S)/d);for(let D=0;D<f.outChannels;++D){const T=Math.trunc(D/b),N=D%b;let F=0;for(let R=0;R<f.batchSize;++R)for(let P=k;P<E;++P){const V=_+P*h-y;for(let z=I;z<A;++z){const q=S+z*d-v;F+=w.get(R,V,q,T)*$.get(R,P,z,D)}}m.set(F,_,S,T,N)}}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const d$t={kernelName:j8,backendName:"cpu",kernelFunc:h$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p$t(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{strides:a,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=r;Ge([i,s],"depthwiseConv2DNativeBackpropInput");const f=Je(i.shape),h=Je(s.shape),d=Pi(c,s.shape,a,o,l,u,!0),p=new oi(d.inShape,"float32"),g=p.values,[m,v,y]=p.strides,b=n.data.get(i.dataId).values,[x,w,C]=f,$=n.data.get(s.dataId).values,[_,k,E]=h,{batchSize:S,filterHeight:I,filterWidth:A,inChannels:D,inHeight:T,inWidth:N,outChannels:F,outHeight:R,outWidth:P,strideHeight:V,strideWidth:z}=d,q=I-1-d.padInfo.top,G=A-1-d.padInfo.left,K=F/D;for(let Y=0;Y<S;++Y)for(let te=0;te<D;++te)for(let Z=0;Z<T;++Z){const ae=Z-q,O=Math.max(0,Math.ceil(ae/V)),L=Math.min(R,(I+ae)/V);for(let W=0;W<N;++W){const M=W-G,ue=Math.max(0,Math.ceil(M/z)),X=Math.min(P,(A+M)/z);let se=0;for(let oe=O;oe<L;++oe){const pe=oe*V-ae;for(let Ce=ue;Ce<X;++Ce){const ze=Ce*z-M,et=x*Y+w*oe+C*Ce,dt=_*(I-1-pe)+k*(A-1-ze)+E*te;for(let He=0;He<K;++He){const Se=te*K+He,j=b[et+Se],fe=$[dt+He];se+=j*fe}}}g[m*Y+v*Z+y*W+te]=se}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const g$t={kernelName:H8,backendName:"cpu",kernelFunc:p$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m$t(e){const{inputs:t,backend:n}=e,{x:r}=t,i=he(r.shape),s=n.data.get(r.dataId).values,a=Mt([i,i],r.dtype),o=a.values;for(let u=0;u<s.length;u++)o[u*i+u]=s[u];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,a.dtype,a.values)}const v$t={kernelName:q8,backendName:"cpu",kernelFunc:m$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y$t={kernelName:II,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i}=e,{strides:s,pad:a,dilations:o}=n,l=t,u=l.data.get(r.dataId).values,c=r.shape.length,f=l.data.get(i.dataId).values,h=i.shape.length,{batchSize:d,inHeight:p,inWidth:g,inChannels:m,outHeight:v,outWidth:y,padInfo:b,strideHeight:x,strideWidth:w,filterHeight:C,filterWidth:$,dilationHeight:_,dilationWidth:k,outShape:E}=xN(r.shape,i.shape,s,a,"NHWC",o),S=he(E),I=E.length,A=Br(r.dtype,S);for(let T=0;T<d;++T)for(let N=0;N<v;++N){const F=N*x-b.top;for(let R=0;R<y;++R){const P=R*w-b.left;for(let V=0;V<m;++V){let z=Number.MIN_SAFE_INTEGER;for(let G=0;G<C;++G){const K=F+G*_;if(K>=0&&K<p)for(let Y=0;Y<$;++Y){const te=P+Y*k;if(te>=0&&te<g){const Z=Bc([T,K,te,V],c,Je(r.shape)),ae=Bc([G,Y,V],h,Je(i.shape)),O=u[Z]+f[ae];O>z&&(z=O)}}}const q=Bc([T,N,R,V],I,Je(E));A[q]=z}}}return{dataId:l.write(Lm(A,r.dtype),E,r.dtype),shape:E,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b$t={kernelName:b5,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i,dy:s}=e,{strides:a,pad:o,dilations:l}=n,u=t,c=Eu(r.shape,u.data.get(r.dataId).values),f=Eu(i.shape,u.data.get(i.dataId).values),{batchSize:h,inHeight:d,inWidth:p,inChannels:g,outHeight:m,outWidth:v,padInfo:y,strideHeight:b,strideWidth:x,filterHeight:w,filterWidth:C,dilationHeight:$,dilationWidth:_,outShape:k}=xN(r.shape,i.shape,a,o,"NHWC",l);B(s.rank===k.length,()=>`Error in ${b5}, dy must have the same rank as output ${k.length}, but got ${s.rank}`);const E=Eu(k,u.data.get(s.dataId).values),S=Zee(i.shape,i.dtype);for(let A=0;A<h;++A)for(let D=0;D<m;++D){const T=D*b-y.top;for(let N=0;N<v;++N){const F=N*x-y.left;for(let R=0;R<g;++R){let P=Number.MIN_SAFE_INTEGER,V=0,z=0;for(let q=0;q<w;++q){const G=T+q*$;if(G>=0&&G<d)for(let K=0;K<C;++K){const Y=F+K*_;if(Y>=0&&Y<p){const te=c[A][G][Y][R]+f[q][K][R];te>P&&(P=te,V=q,z=K)}}}S[V][z][R]+=E[A][D][N][R]}}}return{dataId:u.write(Lm(S,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x$t={kernelName:y5,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i,dy:s}=e,{strides:a,pad:o,dilations:l}=n,u=t,c=Eu(r.shape,u.data.get(r.dataId).values),f=Eu(i.shape,u.data.get(i.dataId).values),{batchSize:h,inHeight:d,inWidth:p,inChannels:g,outHeight:m,outWidth:v,padInfo:y,strideHeight:b,strideWidth:x,filterHeight:w,filterWidth:C,dilationHeight:$,dilationWidth:_,outShape:k}=xN(r.shape,i.shape,a,o,"NHWC",l);B(s.rank===k.length,()=>`Error in ${y5}, dy must have the same rank as output ${k.length}, but got ${s.rank}`);const E=Eu(k,u.data.get(s.dataId).values),S=Zee(r.shape,r.dtype);for(let A=0;A<h;++A)for(let D=0;D<m;++D){const T=D*b-y.top;for(let N=0;N<v;++N){const F=N*x-y.left;for(let R=0;R<g;++R){let P=Number.MIN_SAFE_INTEGER,V=T<0?0:T,z=F<0?0:F;for(let q=0;q<w;++q){const G=T+q*$;if(G>=0&&G<d)for(let K=0;K<C;++K){const Y=F+K*_;if(Y>=0&&Y<p){const te=c[A][G][Y][R]+f[q][K][R];te>P&&(P=te,V=G,z=Y)}}}S[A][V][z][R]+=E[A][D][N][R]}}}return{dataId:u.write(Lm(S,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w$t(e){const{inputs:t,backend:n,attrs:r}=e,{image:i}=t,{canvas:s,options:a}=r,{contextOptions:o,imageOptions:l}=a||{},u=(l==null?void 0:l.alpha)||1,c=(o==null?void 0:o.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const f=s.getContext(c,(o==null?void 0:o.contextAttributes)||{});if(f==null)throw new Error(`Could not get the context with ${c} type.`);const[h,d]=i.shape.slice(0,2),p=i.shape.length===2?1:i.shape[2],g=n.data.get(i.dataId).values,m=i.dtype==="float32"?255:1,v=new Uint8ClampedArray(d*h*4);for(let b=0;b<h*d;++b){const x=[0,0,0,255*u];for(let C=0;C<p;C++){const $=g[b*p+C];if(i.dtype==="float32"){if($<0||$>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${$}.`)}else if(i.dtype==="int32"&&($<0||$>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${$}.`);p===1?(x[0]=$*m,x[1]=$*m,x[2]=$*m):x[C]=$*m}const w=b*4;v[w+0]=Math.round(x[0]),v[w+1]=Math.round(x[1]),v[w+2]=Math.round(x[2]),v[w+3]=Math.round(x[3])}s.width=d,s.height=h;const y=new ImageData(v,d,h);return f.putImageData(y,0,0),i}const $$t={kernelName:G8,backendName:"cpu",kernelFunc:w$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LN(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r;Ge(i,"sum");let o;i.dtype==="bool"?o=Y0({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):o=Fh({inputs:{x:i},backend:n});const l=o.shape.length,u=Ot(s,o.shape),c=Fr(u,l);let f=u,h=o;c!=null&&(h=po({inputs:{x:o},backend:n,attrs:{perm:c}}),f=Jr(f.length,l)),vs("sum",f,h.shape.length);const[d,p]=Li(h.shape,f),g=fo(h.dtype,"int32");let m=R5(n,d,g);const v=he(p),y=n.data.get(m.dataId).values,b=n.data.get(h.dataId).values;for(let x=0;x<y.length;++x){const w=x*v;let C=0;for(let $=0;$<v;++$)C+=b[w+$];y[x]=C}if(a){const x=Zr(m.shape,u),w=m;m=tr({inputs:{x:m},backend:n,attrs:{shape:x}}),n.disposeIntermediateTensorInfo(w)}return n.disposeIntermediateTensorInfo(o),c!=null&&n.disposeIntermediateTensorInfo(h),m}const C$t={kernelName:cN,backendName:"cpu",kernelFunc:LN};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _$t(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,s=t,{allDims:a,summedDims:o,idDims:l}=pne(i,s.length);mne(a.length,l,s);const{path:u,steps:c}=vne(o,l),f=c.length;let h=null,d=a.length;const p=[];for(let g=0;g<f;++g){for(const m of c[g]){const{permutationIndices:v,expandDims:y}=gne(d,l[m]);let b;yne(v)?b=s[m]:(b=po({inputs:{x:s[m]},backend:n,attrs:{perm:v}}),p.push(b));const x=b.shape.slice();for(let w=0;w<y.length;++w)x.splice(y[w],0,1);Zt(b.shape,x)||(b=tr({inputs:{x:b},backend:n,attrs:{shape:x}}),p.push(b)),h===null?h=b:(h=E7({inputs:{a:b,b:h},backend:n}),p.push(h))}g<f-1&&(u[g]>=0&&(h=LN({inputs:{x:h},backend:n,attrs:{axis:u[g]-(a.length-d),keepDims:!1}}),p.push(h)),d--)}for(const g of p)g!==h&&n.disposeIntermediateTensorInfo(g);return h}const S$t={kernelName:Y8,backendName:"cpu",kernelFunc:_$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k$t(e){const{inputs:t,backend:n}=e,{dy:r,y:i}=t;Ge([r,i],"eluGrad");const s=new Float32Array(he(i.shape)),a=n.data.get(i.dataId).values,o=n.data.get(r.dataId).values;for(let l=0;l<a.length;++l){const u=a[l];u>=0?s[l]=o[l]:s[l]=o[l]*(u+1)}return n.makeTensorInfo(i.shape,"float32",s)}const E$t={kernelName:X8,backendName:"cpu",kernelFunc:k$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A$t=one,T$t=lne,D$t=une,I$t=cne,N$t=fne,M$t=hne,F$t=Bn(UC,e=>{const t=Math.sign(e),n=Math.abs(e),r=1/(1+A$t*n);return t*(1-((((M$t*r+N$t)*r+I$t)*r+D$t)*r+T$t)*r*Math.exp(-n*n))}),O$t={kernelName:UC,backendName:"cpu",kernelFunc:F$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B5(e){const{inputs:t,backend:n,attrs:r}=e,{input:i}=t,{dim:s}=r,a=i.shape.length,o=i.shape.slice();let l=s;return s<0&&(B(-(a+1)<=s,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+s+1),o.splice(l,0,1),tr({inputs:{x:i},backend:n,attrs:{shape:o}})}const R$t={kernelName:MI,backendName:"cpu",kernelFunc:B5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P$t=ti((e,t)=>e/t),Kne=xi(BC,P$t),QY={kernelName:BC,backendName:"cpu",kernelFunc:Kne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pMe(e,t,n){const r=e.shape,i=r[0],s=r[1],a=n.data.get(e.dataId),o=a.complexTensorInfos.real,l=a.complexTensorInfos.imag,u=[i,s],c=he(u),f=Fi("float32",c),h=Fi("float32",c);for(let m=0;m<i;m++){const v=Uy({inputs:{x:o},backend:n,attrs:{begin:[m,0],size:[1,s]}}),y=Uy({inputs:{x:l},backend:n,attrs:{begin:[m,0],size:[1,s]}}),b=Uo({inputs:{real:v,imag:y},backend:n}),{real:x,imag:w}=L$t(b,t,n),C=Mp(x,w);for(let $=0;$<s;$++){const _=dne(C,$);f[m*s+$]=_.real,h[m*s+$]=_.imag}n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b)}const d=n.makeTensorInfo(u,"float32",f),p=n.makeTensorInfo(u,"float32",h),g=Uo({inputs:{real:d,imag:p},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),g}function L$t(e,t,n){const r=he(e.shape),i=n.data.get(e.dataId),s=n.data.get(i.complexTensorInfos.real.dataId).values,a=n.data.get(i.complexTensorInfos.imag.dataId).values;if(B$t(r)){const o=JY(s,a,r,t,n),l=[e.shape[0],e.shape[1]];if(t){const u=n.makeTensorInfo(l,"float32",o.real),c=n.makeTensorInfo(l,"float32",o.imag),f=n.makeTensorInfo([],"float32",eg(r,"float32")),h=Fh({inputs:{x:f},backend:n}),d=QY.kernelFunc({inputs:{a:u,b:f},backend:n}),p=QY.kernelFunc({inputs:{a:c,b:h},backend:n}),g=n.data.get(d.dataId).values,m=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),{real:g,imag:m}}return o}else{const o=Mp(s,a),l=z$t(o,r,t);return A3e(l)}}function B$t(e){return(e&e-1)===0}function JY(e,t,n,r,i){if(n===1)return{real:e,imag:t};const s=Mp(e,t),a=n/2,o=T3e(s),l=o.real,u=o.imag,c=[l.length],f=i.makeTensorInfo(c,"float32",l),h=i.makeTensorInfo(c,"float32",u),d=Uo({inputs:{real:f,imag:h},backend:i}),p=D3e(s),g=p.real,m=p.imag,v=[g.length],y=i.makeTensorInfo(v,"float32",g),b=i.makeTensorInfo(v,"float32",m),x=Uo({inputs:{real:y,imag:b},backend:i}),w=JY(l,u,a,r,i),C=w.real,$=w.imag,_=[C.length],k=i.makeTensorInfo(_,"float32",C),E=i.makeTensorInfo(_,"float32",$),S=Uo({inputs:{real:k,imag:E},backend:i}),I=JY(g,m,a,r,i),A=I.real,D=I.imag,T=[A.length],N=i.makeTensorInfo(T,"float32",A),F=i.makeTensorInfo(T,"float32",D),R=Uo({inputs:{real:N,imag:F},backend:i}),P=N3e(n,r),V=[P.real.length],z=i.makeTensorInfo(V,"float32",P.real),q=i.makeTensorInfo(V,"float32",P.imag),G=Uo({inputs:{real:z,imag:q},backend:i}),K=E7({inputs:{a:G,b:R},backend:i}),Y=Bw({inputs:{a:S,b:K},backend:i}),te=Yne({inputs:{a:S,b:K},backend:i}),Z=zy({inputs:{input:Y},backend:i}),ae=zy({inputs:{input:te},backend:i}),O=zw({inputs:{input:Y},backend:i}),L=zw({inputs:{input:te},backend:i}),W=Uw({inputs:[Z,ae],backend:i,attrs:{axis:0}}),M=Uw({inputs:[O,L],backend:i,attrs:{axis:0}}),ue=i.data.get(W.dataId).values,X=i.data.get(M.dataId).values;return i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(h),i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(y),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(x),i.disposeIntermediateTensorInfo(k),i.disposeIntermediateTensorInfo(E),i.disposeIntermediateTensorInfo(S),i.disposeIntermediateTensorInfo(N),i.disposeIntermediateTensorInfo(F),i.disposeIntermediateTensorInfo(R),i.disposeIntermediateTensorInfo(z),i.disposeIntermediateTensorInfo(q),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(K),i.disposeIntermediateTensorInfo(Y),i.disposeIntermediateTensorInfo(te),i.disposeIntermediateTensorInfo(Z),i.disposeIntermediateTensorInfo(O),i.disposeIntermediateTensorInfo(ae),i.disposeIntermediateTensorInfo(L),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(M),{real:ue,imag:X}}function z$t(e,t,n){const r=new Float32Array(t*2);for(let i=0;i<t;i++){let s=0,a=0;for(let o=0;o<t;o++){const l=M3e(i*o,t,n),u=dne(e,o);s+=u.real*l.real-u.imag*l.imag,a+=u.real*l.imag+u.imag*l.real}n&&(s/=t,a/=t),I3e(r,s,a,i)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U$t(e){const{inputs:t,backend:n}=e,{input:r}=t,i=he(r.shape),s=r.shape[r.shape.length-1],a=i/s,o=tr({inputs:{x:r},backend:n,attrs:{shape:[a,s]}}),l=pMe(o,!1,n),u=tr({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const W$t={kernelName:K8,backendName:"cpu",kernelFunc:U$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zne(e){const{backend:t,attrs:n}=e,{shape:r,value:i,dtype:s}=n,a=s||Bb(i),o=Br(a,he(r));return j$t(o,i,a),t.makeTensorInfo(r,a,o)}const V$t={kernelName:Z8,backendName:"cpu",kernelFunc:Zne};function j$t(e,t,n){e.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H$t={kernelName:Q8,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,i=n,s=Fi(r.dtype,he(r.shape)),[a,o,l,u]=r.shape,c=i.data.get(r.dataId).values;for(let h=0;h<a;h++){const d=h*l*o*u;for(let p=0;p<o;p++){const g=p*(l*u);for(let m=0;m<l;m++){const v=m*u;for(let y=0;y<u;y++){const b=Math.round(l-m-1),x=d+g+v+y;let w=c[x];if(b>=0&&b<l){const C=b*u,$=d+g+C+y;w=c[$]}s[x]=w}}}}return{dataId:i.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:a,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r;let g=hMe({inputs:{x:i,filter:s},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h}});if(a){const m=g;if(c==="NCHW"&&a.shape.length===1&&a.shape[0]!==1){const v=tr({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=Bw({inputs:{a:g,b:v},backend:n}),n.disposeIntermediateTensorInfo(v)}else g=Bw({inputs:{a:g,b:a},backend:n});n.disposeIntermediateTensorInfo(m)}if(d){const m=g;if(c==="NCHW"&&d==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const v=tr({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});g=L5(n,g,d,v,p),n.disposeIntermediateTensorInfo(v)}else g=L5(n,g,d,o,p);n.disposeIntermediateTensorInfo(m)}return g}const G$t={kernelName:uT,backendName:"cpu",kernelFunc:q$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:a,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r;let g=dMe({inputs:{x:i,filter:s},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h}});if(a){const m=g;g=Bw({inputs:{a:g,b:a},backend:n}),n.disposeIntermediateTensorInfo(m)}if(d){const m=g;g=L5(n,g,d,o,p),n.disposeIntermediateTensorInfo(m)}return g}const X$t={kernelName:cT,backendName:"cpu",kernelFunc:Y$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K$t(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,s=he(r.shape),a=i.shape,o=a[a.length-1],[l,u,c,f]=f7(r,i);if(u===0)return n.makeTensorInfo(l,r.dtype,[]);const h=n.data.get(i.dataId).values,d=n.bufferSync(r),p=_Ne(h,d,r.dtype,u,o,c,f,r.shape,s);return n.makeTensorInfo(l,r.dtype,p.values)}const Z$t={kernelName:J8,backendName:"cpu",kernelFunc:K$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:s}=t,{axis:a,batchDims:o}=r;Ge([i,s],"gatherV2");const l=Ot(a,i.shape)[0],u=n.data.get(s.dataId).values,c=i.shape[l];for(let x=0;x<u.length;++x){const w=u[x];B(w<=c-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${c-1}]`)}let f=o;o==null&&(f=0);const h=he(s.shape),d=xne(i,s,l,f),p=tr({inputs:{x:i},backend:n,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),g=tr({inputs:{x:s},backend:n,attrs:{shape:[d.batchSize,h/d.batchSize]}}),m=[d.batchSize,d.outerSize,h/d.batchSize,d.sliceSize],v=n.bufferSync(g),y=n.bufferSync(p),b=SNe(y,v,m);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(d.outputShape,b.dtype,b.values)}const J$t={kernelName:OI,backendName:"cpu",kernelFunc:Q$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eCt(e){const{inputs:t,backend:n}=e,{input:r}=t,i=he(r.shape),s=r.shape[r.shape.length-1],a=i/s,o=tr({inputs:{x:r},backend:n,attrs:{shape:[a,s]}}),l=pMe(o,!0,n),u=tr({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const tCt={kernelName:ez,backendName:"cpu",kernelFunc:eCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nCt=Bn(YC,e=>Number.isFinite(e)?1:0,"bool"),rCt={kernelName:YC,backendName:"cpu",kernelFunc:nCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iCt=Bn(XC,e=>Math.abs(e)===1/0?1:0,"bool"),sCt={kernelName:XC,backendName:"cpu",kernelFunc:iCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aCt=Bn(KC,e=>Number.isNaN(e)?1:0,"bool"),oCt={kernelName:KC,backendName:"cpu",kernelFunc:aCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lCt(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:s}=n,a=DNe(r,i,s);return t.makeTensorInfo([a.length],"float32",a)}const uCt={kernelName:nz,backendName:"cpu",kernelFunc:lCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cCt=Bn(QC,e=>Math.log1p(e)),fCt={kernelName:QC,backendName:"cpu",kernelFunc:cCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hCt=ti((e,t)=>e&&t),dCt=xi(zI,hCt,null,"bool"),pCt={kernelName:zI,backendName:"cpu",kernelFunc:dCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gCt=Bn(UI,e=>e?0:1,"bool"),mCt={kernelName:UI,backendName:"cpu",kernelFunc:gCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vCt=ti((e,t)=>e||t),yCt=xi(WI,vCt,null,"bool"),bCt={kernelName:WI,backendName:"cpu",kernelFunc:yCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:s,bias:a,alpha:o,beta:l}=r;Ge(i,"LRN");const u=i.shape[3],c=u-1,f=n.data.get(i.dataId).values,h=he(i.shape),d=new Float32Array(h);function p(g){const m=g%u;let v=g-m+Math.max(0,m-s);const y=g-m+Math.min(m+s,c);let b=0;for(;v<=y;v++){const x=f[v];b+=x*x}return b}for(let g=0;g<h;g++){const m=p(g),v=f[g]*Math.pow(a+o*m,-l);d[g]=v}return n.makeTensorInfo(i.shape,i.dtype,d)}const wCt={kernelName:VI,backendName:"cpu",kernelFunc:xCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ct(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,y:s,dy:a}=t,{depthRadius:o,bias:l,alpha:u,beta:c}=r;Ge(a,"LRNGrad");const f=he(a.shape),h=a.shape[3],d=n.data.get(a.dataId).values,p=n.data.get(i.dataId).values,g=n.data.get(s.dataId).values,m=new Float32Array(f),v=f;for(let y=0;y<v;y++){const b=y%h,x=y-b+Math.max(0,b-o),w=y-b+Math.min(h,b+o+1);let C=0;for(let $=x;$<w;$++)C+=Math.pow(p[$],2);C=u*C+l;for(let $=x;$<w;$++){let _=-2*u*c*p[$]*g[y]/C;y===$&&(_+=Math.pow(C,-c)),_*=d[y],m[$]+=_}}return n.makeTensorInfo(a.shape,i.dtype,m)}const CCt={kernelName:rz,backendName:"cpu",kernelFunc:$Ct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gMe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:s,keepDims:a}=r,o=n;let l=i.shape;const u=l.length,c=Ot(s,l);let f=c;const h=Fr(f,u);let d=o.data.get(i.dataId).values;if(h!=null){const x=new Array(u);for(let w=0;w<x.length;w++)x[w]=l[h[w]];d=qne(d,l,i.dtype,h,x),f=Jr(f.length,u),l=x}Ge(i,"max"),vs("max",f,u);const[p,g]=Li(l,f),m=he(g),v=NNe(d,m,p,i.dtype),y=o.write(v,p,i.dtype);let b=p;return a&&(b=Zr(p,c)),{dataId:y,shape:b,dtype:i.dtype}}const _Ct={kernelName:jI,backendName:"cpu",kernelFunc:gMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;Ge(i,"maxPool");const{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=r,u=1;B(ms(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const c=Hu(i.shape,s,a,u,o,l);let f;if(c.filterWidth===1&&c.filterHeight===1&&Zt(c.inShape,c.outShape))f=Fh({inputs:{x:i},backend:n});else{const h=n.data.get(i.dataId).values,d=Je(i.shape),p=Xne(h,i.shape,i.dtype,d,c,"max");f=n.makeTensorInfo(c.outShape,i.dtype,p.values)}return f}const kCt={kernelName:HI,backendName:"cpu",kernelFunc:SCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ECt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:a,pad:o,dimRoundingMode:l,dataFormat:u}=r;Ge(i,"maxPool3d");const c=tg(i.shape,s,a,1,o,l,u),f=n.data.get(i.dataId).values,h=fMe(f,i.shape,i.dtype,Je(i.shape),c,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const ACt={kernelName:qI,backendName:"cpu",kernelFunc:ECt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TCt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,{filterSize:a,strides:o,pad:l,dimRoundingMode:u}=r;Ge([i,s],"maxPool3DGrad");const c=tg(s.shape,a,o,1,l,u),f=n.bufferSync(s),h=vwt(f,c),d=c.strideDepth,p=c.strideHeight,g=c.strideWidth,m=c.dilationDepth,v=c.dilationHeight,y=c.dilationWidth,b=c.effectiveFilterDepth,x=c.effectiveFilterHeight,w=c.effectiveFilterWidth,C=b-1-c.padInfo.front,$=w-1-c.padInfo.left,_=x-1-c.padInfo.top,k=Mt(s.shape,"float32"),E=n.bufferSync(i);for(let S=0;S<c.batchSize;++S)for(let I=0;I<c.inChannels;++I)for(let A=0;A<c.inDepth;++A)for(let D=0;D<c.inHeight;++D)for(let T=0;T<c.inWidth;++T){const N=A-C,F=D-_,R=T-$;let P=0;for(let V=0;V<b;V+=m){const z=(N+V)/d;if(!(z<0||z>=c.outDepth||Math.floor(z)!==z))for(let q=0;q<x;q+=v){const G=(F+q)/p;if(!(G<0||G>=c.outHeight||Math.floor(G)!==G))for(let K=0;K<w;K+=y){const Y=(R+K)/g;if(Y<0||Y>=c.outWidth||Math.floor(Y)!==Y)continue;const te=b*x*w-1-h.get(S,z,G,Y,I),Z=V*x*w+q*w+K,ae=te===Z?1:0;if(ae===0)continue;const O=E.get(S,z,G,Y,I);P+=O*ae}}}k.set(P,S,A,D,T,I)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const DCt={kernelName:sz,backendName:"cpu",kernelFunc:TCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ICt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s,output:a}=t,o=s;Ge([s,a],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:f}=r,h=Hu(o.shape,l,u,1,c,f),d=n.data.get(o.dataId).values,p=Mt(h.outShape,o.dtype,cMe(d,o.shape,o.dtype,h).values),g=h.strideHeight,m=h.strideWidth,v=h.dilationHeight,y=h.dilationWidth,b=h.effectiveFilterHeight,x=h.effectiveFilterWidth,w=x-1-h.padInfo.left,C=b-1-h.padInfo.top,$=Mt(o.shape,"float32"),_=n.data.get(i.dataId).values,k=Mt(i.shape,"float32",_);for(let E=0;E<h.batchSize;++E)for(let S=0;S<h.inChannels;++S)for(let I=0;I<h.inHeight;++I)for(let A=0;A<h.inWidth;++A){const D=I-C,T=A-w;let N=0;for(let F=0;F<b;F+=v){const R=(D+F)/g;if(!(R<0||R>=h.outHeight||Math.floor(R)!==R))for(let P=0;P<x;P+=y){const V=(T+P)/m;if(V<0||V>=h.outWidth||Math.floor(V)!==V)continue;const z=b*x-1-p.get(E,R,V,S),q=F*x+P,G=z===q?1:0;if(G===0)continue;const K=k.get(E,R,V,S);N+=K*G}}$.set(N,E,I,A,S)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const NCt={kernelName:iz,backendName:"cpu",kernelFunc:ICt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MCt(e,t,n,r,i){const s=Je(t),a=Xne(e,t,n,s,i,"max"),o=cMe(e,t,n,i,!0,r);return[a.values,o.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FCt={kernelName:az,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{filterSize:i,strides:s,pad:a,includeBatchInIndex:o}=t,l=n;Ge(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,c=Hu(r.shape,i,s,[1,1],a),[f,h]=MCt(u,r.shape,r.dtype,o,c),d=l.write(f,c.outShape,r.dtype),p=l.write(h,c.outShape,r.dtype);return[{dataId:d,shape:c.outShape,dtype:r.dtype},{dataId:p,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r,o=Ot(s,i.shape),u=Li(i.shape,o)[1],c=he(u),f=[],h=n.makeTensorInfo([],"float32",new Float32Array([c]));f.push(h);const d=Y0({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});f.push(d);const p=Kne({inputs:{a:d,b:h},backend:n});f.push(p);const g=LN({inputs:{x:p},backend:n,attrs:{axis:s,keepDims:a}});return f.forEach(m=>n.disposeIntermediateTensorInfo(m)),g}const RCt={kernelName:GI,backendName:"cpu",kernelFunc:OCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r;Ge(i,"min");const o=Ot(s,i.shape);let l=o;const u=Fr(l,i.shape.length);let c=i;u!=null&&(c=po({inputs:{x:i},backend:n,attrs:{perm:u}}),l=Jr(l.length,i.shape.length)),vs("min",l,c.shape.length);const[f,h]=Li(c.shape,l),d=he(h),p=hs(he(f),c.dtype),g=n.data.get(c.dataId).values;for(let v=0;v<p.length;++v){const y=v*d;let b=g[y];for(let x=0;x<d;++x){const w=g[y+x];(Number.isNaN(w)||w<b)&&(b=w)}p[v]=b}u!=null&&n.disposeIntermediateTensorInfo(c);const m=n.makeTensorInfo(f,c.dtype,p);if(a){const v=Zr(f,o),y=tr({inputs:{x:m},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(m),y}return m}const LCt={kernelName:YI,backendName:"cpu",kernelFunc:PCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,mode:a}=r;Ge(i,"mirrorPad");const o=s.map((b,x)=>b[0]+i.shape[x]+b[1]),l=s.map(b=>b[0]),u=s.map((b,x)=>b[0]+i.shape[x]),c=a==="reflect"?0:1,f=n.data.get(i.dataId).values,h=i.shape.length,d=Je(i.shape),p=he(o),g=o.length,m=Je(o),v=Fi(i.dtype,p);for(let b=0;b<p;b++){let x=zb(b,g,m);for(let C=0;C<g;C++)x[C]<l[C]?x[C]=l[C]*2-x[C]-c:x[C]>=u[C]&&(x[C]=(u[C]-1)*2-x[C]+c);x=x.map((C,$)=>C-l[$]);const w=Bc(x,h,d);v[b]=f[w]}return{dataId:n.write(v,o,i.dtype),shape:o,dtype:i.dtype}}const zCt={kernelName:XI,backendName:"cpu",kernelFunc:BCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UCt=ti((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),WCt=xi(t_,UCt),VCt={kernelName:t_,backendName:"cpu",kernelFunc:WCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mMe(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:s}=r,a=i.shape.length;let o=s;if(o===-1&&(o=a-1),o!==a-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${a} and dim was ${o}`);const l=Ot([o],i.shape),u=gMe({inputs:{x:i},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=Zr(u.shape,l),f=tr({inputs:{x:u},backend:n,attrs:{shape:c}}),h=Yne({inputs:{a:i,b:f},backend:n}),d=xNe({inputs:{x:h},backend:n}),p=LN({inputs:{x:d},backend:n,attrs:{axis:l,keepDims:!1}}),g=tr({inputs:{x:p},backend:n,attrs:{shape:c}}),m=Kne({inputs:{a:d,b:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const jCt={kernelName:dN,backendName:"cpu",kernelFunc:mMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HCt(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:s,seed:a,normalized:o}=r;Ge(i,"multinomial");const l=o?i:mMe({inputs:{logits:i},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],f=n.data.get(l.dataId).values,h=[u,s],d=hs(he(h),"int32");for(let p=0;p<u;++p){const g=p*c,m=new Float32Array(c-1);m[0]=f[g];for(let b=1;b<m.length;++b)m[b]=m[b-1]+f[g+b];const v=Xz.alea(a.toString()),y=p*s;for(let b=0;b<s;++b){const x=v();d[y+b]=m.length;for(let w=0;w<m.length;w++)if(x<m[w]){d[y+b]=w;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",d)}const qCt={kernelName:oz,backendName:"cpu",kernelFunc:HCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GCt=o7;function YCt(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=r;Ge(i,"NonMaxSuppression");const u=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,{selectedIndices:f}=GCt(u,c,a,o,l);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const XCt={kernelName:lz,backendName:"cpu",kernelFunc:YCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KCt=l7;function ZCt(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r;Ge(i,"NonMaxSuppressionPadded");const c=n.data.get(i.dataId).values,f=n.data.get(s.dataId).values,{selectedIndices:h,validOutputs:d}=KCt(c,f,a,o,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([d]))]}const QCt={kernelName:uz,backendName:"cpu",kernelFunc:ZCt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JCt=u7;function e_t(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r;Ge(i,"NonMaxSuppressionWithScore");const c=n.data.get(i.dataId).values,f=n.data.get(s.dataId).values,h=a,d=o,p=l,g=u,{selectedIndices:m,selectedScores:v}=JCt(c,f,h,d,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}const t_t={kernelName:cz,backendName:"cpu",kernelFunc:e_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n_t(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:s,depth:a,onValue:o,offValue:l}=r;Ge(i,"oneHot");const u=he(i.shape),c=new Float32Array(u*a);c.fill(l);const f=n.data.get(i.dataId).values;for(let h=0;h<u;++h)f[h]>=0&&f[h]<a&&(c[h*a+f[h]]=o);return n.makeTensorInfo([...i.shape,a],s,c)}const r_t={kernelName:JI,backendName:"cpu",kernelFunc:n_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z5(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const i=zy({inputs:{input:r},backend:n}),s=z5({inputs:{x:i},backend:n}),a=zw({inputs:{input:r},backend:n}),o=z5({inputs:{x:a},backend:n}),l=Uo({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),l}else return Zne({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const i_t={kernelName:vN,backendName:"cpu",kernelFunc:z5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vMe(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const i=zy({inputs:{input:r},backend:n}),s=vMe({inputs:{x:i},backend:n}),a=zw({inputs:{input:r},backend:n}),o=z5({inputs:{x:a},backend:n}),l=Uo({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),l}else return Zne({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const s_t={kernelName:QI,backendName:"cpu",kernelFunc:vMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yMe(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return B5({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const s=t[0].shape,a=t[0].dtype;t.forEach(c=>{gs(s,c.shape,"All tensors passed to stack must have matching shapes"),B(a===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=t.map(c=>{const f=B5({inputs:{input:c},backend:n,attrs:{dim:i}});return o.push(f),f}),u=Uw({inputs:l,backend:n,attrs:{axis:i}});return o.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const a_t={kernelName:eN,backendName:"cpu",kernelFunc:yMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,constantValue:a}=r;Ge(i,"pad");const o=s.map((y,b)=>y[0]+i.shape[b]+y[1]),l=s.map(y=>y[0]),u=n.data.get(i.dataId).values,c=he(i.shape),f=i.shape.length,h=Je(i.shape),d=he(o),p=o.length,g=Je(o),m=Fi(i.dtype,d);a!==0&&m.fill(a);for(let y=0;y<c;y++){const x=zb(y,f,h).map((C,$)=>C+l[$]),w=Bc(x,p,g);m[w]=u[y]}return{dataId:n.write(m,o,i.dtype),shape:o,dtype:i.dtype}}const bMe={kernelName:tN,backendName:"cpu",kernelFunc:o_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l_t=ti((e,t)=>Math.pow(e,t)),u_t=xi(r_,l_t),c_t={kernelName:r_,backendName:"cpu",kernelFunc:u_t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_t(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:s,indices:a}=t,o=i.map(m=>n.data.get(m.dataId).values),l=i.map(m=>m.shape),u=n.data.get(s.dataId).values,c=n.data.get(a.dataId).values,[f,h,d]=LNe(o,l,u,s.shape,s.dtype,c,a.shape),p=f.map(m=>n.makeTensorInfo([m.length],"int32",m)),g=n.makeTensorInfo(d,s.dtype,h);return p.concat([g])}const h_t={kernelName:fz,backendName:"cpu",kernelFunc:f_t};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_t(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:s}=t,a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,[u,c]=BNe(a,r.shape,r.dtype,o,i.shape,l,s.shape),f=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([c.length],r.dtype,c);return[f,h]}const p_t={kernelName:hz,backendName:"cpu",kernelFunc:d_t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g_t(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:s,defaultValue:a,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,u=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,f=n.data.get(a.dataId).values,h=o.map(m=>n.data.get(m.dataId).values),d=o.map(m=>m.shape),[p,g]=zNe(u,i.shape,c,s.shape,s.dtype,f,a.shape,h,d,l);return n.makeTensorInfo(p,s.dtype,g)}const m_t={kernelName:dz,backendName:"cpu",kernelFunc:g_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v_t(e){const{backend:t,attrs:n}=e,{start:r,stop:i,dtype:s,step:a}=n,o=UNe(r,i,a,s);return t.makeTensorInfo([o.length],s,o)}const y_t={kernelName:pz,backendName:"cpu",kernelFunc:v_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b_t=Bn(i_,e=>1/e),x_t={kernelName:i_,backendName:"cpu",kernelFunc:b_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w_t(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:a,size:o}=r;Ge(i,"resizeBilinear");const l=Je(i.shape),[u,c]=o,[f,h,d,p]=i.shape,g=n.data.get(i.dataId).values,m=new Float32Array(he([f,u,c,p])),v=[s&&u>1?h-1:h,s&&c>1?d-1:d],y=[s&&u>1?u-1:u,s&&c>1?c-1:c];let b=0;const x=v[0]/y[0],w=v[1]/y[1];for(let C=0;C<f;C++)for(let $=0;$<u;$++){let _;a?_=x*($+.5)-.5:_=x*$;const k=Math.max(0,Math.floor(_)),E=_-k,S=Math.min(h-1,Math.ceil(_)),I=C*l[0]+k*l[1],A=C*l[0]+S*l[1];for(let D=0;D<c;D++){let T;a?T=w*(D+.5)-.5:T=w*D;const N=Math.max(0,Math.floor(T)),F=T-N,R=Math.min(d-1,Math.ceil(T)),P=I+N*l[2],V=A+N*l[2],z=I+R*l[2],q=A+R*l[2];for(let G=0;G<p;G++){const K=g[P+G],Y=g[V+G],te=g[z+G],Z=g[q+G],ae=K+(te-K)*F,O=Y+(Z-Y)*F,L=ae+(O-ae)*E;m[b++]=L}}}return n.makeTensorInfo([f,u,c,p],"float32",m)}const $_t={kernelName:aN,backendName:"cpu",kernelFunc:w_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C_t(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:a}=r;Ge([s,i],"resizeBilinearGrad");const o=Je(i.shape),[l,u,c,f]=i.shape,[,h,d]=s.shape,p=new Float32Array(l*u*c*f),g=[a&&h>1?u-1:u,a&&d>1?c-1:c],m=[a&&h>1?h-1:h,a&&d>1?d-1:d],v=g[0]/m[0],y=g[1]/m[1],b=n.data.get(s.dataId).values;let x=0;for(let w=0;w<l;w++){const C=w*o[0];for(let $=0;$<h;$++){const _=$*v,k=Math.floor(_),E=Math.min(Math.ceil(_),u-1),S=C+k*o[1],I=C+E*o[1],A=_-k,D=1-A;for(let T=0;T<d;T++){const N=T*y,F=Math.floor(N),R=Math.min(Math.ceil(N),c-1),P=N-F,V=1-P,z=S+F*o[2],q=S+R*o[2],G=I+F*o[2],K=I+R*o[2],Y=D*V,te=D*P,Z=A*V,ae=A*P;for(let O=0;O<f;O++){const L=b[x++];p[z+O]+=L*Y,p[q+O]+=L*te,p[G+O]+=L*Z,p[K+O]+=L*ae}}}}return n.makeTensorInfo([l,c,u,f],"float32",p)}const __t={kernelName:vz,backendName:"cpu",kernelFunc:C_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S_t(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:a,size:o}=r;Ge(i,"resizeNearestNeighbor");const l=Je(i.shape),[u,c]=o,[f,h,d,p]=i.shape,g=n.data.get(i.dataId).values,m=new Float32Array(f*u*c*p),v=[s&&u>1?h-1:h,s&&c>1?d-1:d],y=[s&&u>1?u-1:u,s&&c>1?c-1:c],b=v[0]/y[0],x=v[1]/y[1];let w=0;for(let C=0;C<f;C++){const $=C*l[0];for(let _=0;_<u;_++){const k=a?b*(_+.5):b*_;let E=Math.min(h-1,s?Math.round(k):Math.floor(k));a&&(E=Math.max(0,E));const S=$+E*l[1];for(let I=0;I<c;I++){const A=a?x*(I+.5):x*I;let D=Math.min(d-1,s?Math.round(A):Math.floor(A));a&&(D=Math.max(0,D));const T=S+D*l[2];for(let N=0;N<p;N++){const F=g[T+N];m[w++]=F}}}}return n.makeTensorInfo([f,u,c,p],i.dtype,m)}const k_t={kernelName:sN,backendName:"cpu",kernelFunc:S_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E_t(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:a}=r;Ge([s,i],"resizeNearestNeighborGrad");const o=Je(i.shape),l=Je(s.shape),[u,c,f,h]=i.shape,[,d,p]=s.shape,g=new Float32Array(u*c*f*h),m=n.data.get(s.dataId).values,v=[a&&d>1?c-1:c,a&&p>1?f-1:f],y=[a&&d>1?d-1:d,a&&p>1?p-1:p],b=v[0]/y[0],x=v[1]/y[1],w=1/b,C=1/x,$=Math.ceil(w)*2+2,_=Math.ceil(C)*2+2;for(let k=0;k<u;k++){const E=k*o[0];for(let S=0;S<c;S++){const I=E+S*o[1],A=Math.floor(S*w),D=Math.floor(A-$/2);for(let T=0;T<f;T++){const N=I+T*o[2],F=Math.floor(T*C),R=Math.floor(F-_/2);for(let P=0;P<h;P++){let V=0;for(let z=0;z<$;z++){const q=z+D;if(q<0||q>=d)continue;const G=E+q*l[1],K=q*b,Y=Math.min(c-1,a?Math.round(K):Math.floor(K));if(S===Y)for(let te=0;te<_;te++){const Z=te+R;if(Z<0||Z>=p)continue;const ae=G+Z*l[2],O=Z*x,L=Math.min(f-1,a?Math.round(O):Math.floor(O));T===L&&(V+=m[ae+P])}}g[N+P]=V}}}}return n.makeTensorInfo(i.shape,i.dtype,g)}const A_t={kernelName:mz,backendName:"cpu",kernelFunc:E_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T_t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:s}=r;Ge(i,"reverse");const a=i.shape.length,o=Ot(s,i.shape);if(a===0)return Fh({inputs:{x:i},backend:n});const l=new oi(i.shape,i.dtype),u=n.bufferSync(i);for(let c=0;c<l.size;c++){const f=l.indexToLoc(c),h=f.slice();o.forEach(d=>h[d]=i.shape[d]-1-h[d]),l.set(u.get(...h),...f)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const D_t={kernelName:oN,backendName:"cpu",kernelFunc:T_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I_t={kernelName:Fz,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,{radians:i,fillValue:s,center:a}=t,o=n,l=Fi(r.dtype,he(r.shape)),[u,c,f,h]=r.shape,[d,p]=ine(a,c,f),g=255,m=Math.sin(i),v=Math.cos(i),y=o.data.get(r.dataId).values;for(let x=0;x<u;x++){const w=x*f*c*h;for(let C=0;C<c;C++){const $=C*(f*h);for(let _=0;_<f;_++){const k=_*h;for(let E=0;E<h;E++){const S=[u,C,_,E],I=S[2],A=S[1];let D=(I-d)*v-(A-p)*m,T=(I-d)*m+(A-p)*v;D=Math.round(D+d),T=Math.round(T+p);let N=s;if(typeof s!="number"&&(E===3?N=g:N=s[E]),D>=0&&D<f&&T>=0&&T<c){const R=T*(f*h),P=D*h,V=w+R+P+E;N=y[V]}const F=w+$+k+E;l[F]=N}}}}return{dataId:o.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N_t=Bn(o_,e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),M_t={kernelName:o_,backendName:"cpu",kernelFunc:N_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F_t(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:s}=t,{shape:a}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=jm(s,i,a),h=!0,d=n.bufferSync(i),p=n.bufferSync(s),g=A1(d,p,a,f,u,l,o,c,0,h);return n.makeTensorInfo(a,g.dtype,g.values)}const O_t={kernelName:yz,backendName:"cpu",kernelFunc:F_t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R_t(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<t?n=i+1:r=i;return r}function P_t(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<=t?n=i+1:r=i;return r}function L_t(e,t,n,r,i,s){const a=Br("int32",n*i);for(let o=0;o<n;++o){const l=e.slice(o*r,(o+1)*r),u=o*i;for(let c=0;c<i;++c)a[u+c]=s==="left"?R_t(l,t[c+u]):P_t(l,t[c+u])}return a}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B_t(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:s}=t,{side:a}=r,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,u=L_t(o,l,i.shape[0],i.shape[1],s.shape[1],a);return n.makeTensorInfo(s.shape,"int32",u)}const z_t={kernelName:xz,backendName:"cpu",kernelFunc:B_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U_t(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:s}=t;Ge([r,i,s],"select");const a=r.shape.length,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,c=fo(i.dtype,s.dtype),f=hs(he(i.shape),c);let h=0;const d=a===0||a>1||i.shape.length===1?1:he(i.shape.slice(1));for(let p=0;p<o.length;p++)for(let g=0;g<d;g++)o[p]===1?f[h++]=l[p]:f[h++]=u[p];return n.makeTensorInfo(i.shape,c,f)}const W_t={kernelName:lN,backendName:"cpu",kernelFunc:U_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V_t=p7,j_t=g7,H_t=Bn(u_,e=>e>=0?j_t*e:V_t*(Math.exp(e)-1)),q_t={kernelName:u_,backendName:"cpu",kernelFunc:H_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G_t=Bn(h_,e=>e<0?-1:e>0?1:0),Y_t={kernelName:h_,backendName:"cpu",kernelFunc:G_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X_t=Bn(c_,e=>Math.sin(e)),K_t={kernelName:c_,backendName:"cpu",kernelFunc:X_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z_t=Bn(f_,e=>Math.sinh(e)),Q_t={kernelName:f_,backendName:"cpu",kernelFunc:Z_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J_t=11920928955078125e-23,e0e=Math.log(J_t)+2,eSt=Bn(p_,e=>{const t=e>-e0e,n=e<e0e,r=Math.exp(e);let i;return n?i=r:t?i=e:i=Math.log(1+r),i}),tSt={kernelName:p_,backendName:"cpu",kernelFunc:eSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,paddings:a}=r;Ge([i],"spaceToBatchND");const o=he(s),l=[[0,0]];l.push(...a);for(let C=1+s.length;C<i.shape.length;++C)l.push([0,0]);const u=bMe.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),c=EN(u.shape,s,o,!1),f=AN(c.length,s.length,!1),h=TN(u.shape,s,o,!1),g=tr({inputs:{x:u},backend:n,attrs:{shape:c}}),y=po({inputs:{x:g},backend:n,attrs:{perm:f}}),w=tr({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),w}const rSt={kernelName:fN,backendName:"cpu",kernelFunc:nSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iSt(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:s,defaultValue:a}=t;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${i.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,c=n.data.get(a.dataId).values[0],[f,h,d,p,g]=HNe(o,r.shape,r.dtype,l,i.dtype,u,c);return[n.makeTensorInfo(h,r.dtype,f),n.makeTensorInfo([h[0]],i.dtype,d),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const sSt={kernelName:wz,backendName:"cpu",kernelFunc:iSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aSt(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:s}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const a=Array.from(n.data.get(i.dataId).values),o=n.data.get(r.dataId).values,l=Array.from(n.data.get(s.dataId).values),[u,c,f]=qNe(o,r.shape,r.dtype,a,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([f.length],s.dtype,new Int32Array(f))]}const oSt={kernelName:$z,backendName:"cpu",kernelFunc:aSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lSt(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,[u,c]=Gne(a,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const uSt={kernelName:Cz,backendName:"cpu",kernelFunc:lSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cSt(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,[u,c]=Gne(a,r.shape,r.dtype,o,l);return n.makeTensorInfo(c,r.dtype,u)}const fSt={kernelName:_z,backendName:"cpu",kernelFunc:cSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hSt(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:s,defaultValue:a}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:f,outputSize:h}=jm(s,i,o),d=!1,p=n.bufferSync(i);let g;switch(s.dtype){case"bool":{const m=n.bufferSync(s),v=Boolean(n.data.get(a.dataId).values[0]);g=A1(p,m,o,h,c,u,l,f,v,d);break}case"float32":{const m=n.bufferSync(s),v=n.data.get(a.dataId).values[0];g=A1(p,m,o,h,c,u,l,f,v,d);break}case"int32":{const m=n.bufferSync(s),v=n.data.get(a.dataId).values[0];g=A1(p,m,o,h,c,u,l,f,v,d);break}case"string":{const m=n.bufferSync(s),v=Ip(n.data.get(a.dataId).values[0]);g=A1(p,m,o,h,c,u,l,f,v,d);break}default:throw new Error(`Unsupported type ${s.dtype}`)}return n.makeTensorInfo(o,g.dtype,g.values)}const dSt={kernelName:Sz,backendName:"cpu",kernelFunc:hSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:s,axis:a}=r,o=Ot(a,i.shape)[0],l=bne(i,s,o),u=new Array(i.shape.length).fill(0),c=i.shape.slice();return l.map(f=>{const h=[...c];h[o]=f;const d=Uy({inputs:{x:i},backend:n,attrs:{begin:u,size:h}});return u[o]+=f,d})}const gSt={kernelName:hN,backendName:"cpu",kernelFunc:pSt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mSt={kernelName:kz,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{const{x:n}=e,r=t;Ge(n,"square");const i=r.data.get(n.dataId).values,s=new Float32Array(i.length);for(let o=0;o<i.length;++o){const l=i[o];s[o]=l*l}return{dataId:r.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vSt=Bn(w_,(e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),ySt={kernelName:w_,backendName:"cpu",kernelFunc:vSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,end:a,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:h}=r;Ge(i,"stridedSlice");const{finalShapeSparse:d,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:v,begin:y,end:b,strides:x}=ene(i.shape,s,a,o,l,u,c,f,h);let w;if(g)w=tr({inputs:{x:i},backend:n,attrs:{shape:p}});else if(m||v){B(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const C=Zte(y,b,x),$=Uy({inputs:{x:i},backend:n,attrs:{begin:y,size:C}});w=tr({inputs:{x:$},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo($)}else{const C=n.bufferSync(i),$=XNe(d,C,x,y);w=n.makeTensorInfo(p,$.dtype,$.values)}return w}const xSt={kernelName:Ez,backendName:"cpu",kernelFunc:bSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wSt(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:s,leftPad:a,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:f}=t,h=n.data.get(c.dataId).values,d=n.data.get(f.dataId).values,[p,g]=KNe(h,d,i,s,a,o,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(f.shape,"int32",g)]}const $St={kernelName:Az,backendName:"cpu",kernelFunc:wSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CSt(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:s,delimiter:a}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values[0],[u,c,f]=ZNe(o,l,i),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const _St={kernelName:Tz,backendName:"cpu",kernelFunc:CSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SSt(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:s}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const a=n.data.get(s.dataId).values,o=QNe(a,i);return n.makeTensorInfo(s.shape,"int32",o)}const kSt={kernelName:Dz,backendName:"cpu",kernelFunc:SSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ESt=Bn(y_,e=>Math.tan(e)),ASt={kernelName:y_,backendName:"cpu",kernelFunc:ESt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TSt=Bn(b_,e=>Math.tanh(e)),DSt={kernelName:b_,backendName:"cpu",kernelFunc:TSt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ISt(e){const{inputs:t,backend:n}=e,{tensor:r,indices:i,updates:s}=t,{sliceRank:a,numUpdates:o,sliceSize:l,strides:u,outputSize:c}=jm(s,i,r.shape),f=!1,h=n.bufferSync(i),d=n.bufferSync(s),p=n.bufferSync(r),g=A1(h,d,r.shape,c,l,o,a,u,p,f);return n.makeTensorInfo(r.shape,g.dtype,g.values)}const NSt={kernelName:bz,backendName:"cpu",kernelFunc:ISt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:s}=r;Ge(i,"tile");const a=eMe(n.bufferSync(i),s);return n.makeTensorInfo(a.shape,a.dtype,a.values)}const FSt={kernelName:x_,backendName:"cpu",kernelFunc:MSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:s,sorted:a}=r;Ge(i,"topk");const o=n.data.get(i.dataId).values,[l,u]=nMe(o,i.shape,i.dtype,s,a);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const RSt={kernelName:Iz,backendName:"cpu",kernelFunc:OSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PSt(e){const{inputs:t,attrs:n,backend:r}=e,{image:i,transforms:s}=t,{interpolation:a,fillMode:o,fillValue:l,outputShape:u}=n,[c,f,h,d]=i.shape,[p,g]=u!=null?u:[f,h],m=[c,p,g,d],v=Je(i.shape),y=v[0],b=v[1],x=v[2],w=Je(m),C=w[0],$=w[1],_=w[2],k=Fi(i.dtype,he(m));k.fill(l);const E=r.data.get(i.dataId).values,S=r.data.get(s.dataId).values;for(let A=0;A<c;++A){const D=s.shape[0]===1?S:S.subarray(A*8,A*8+8);for(let T=0;T<p;++T)for(let N=0;N<g;++N)for(let F=0;F<d;++F){let R;const P=D[6]*N+D[7]*T+1;if(P===0)continue;const V=(D[0]*N+D[1]*T+D[2])/P,z=(D[3]*N+D[4]*T+D[5])/P,q=t0e(V,h,o),G=t0e(z,f,o);switch(a){case"nearest":R=VSt(E,f,h,y,b,x,A,G,q,F,l);break;case"bilinear":R=jSt(E,f,h,y,b,x,A,G,q,F,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${a}`)}const K=A*C+T*$+N*_+F;k[K]=R}return r.makeTensorInfo(m,i.dtype,k)}return{dataId:r.write(k,m,i.dtype),shape:i.shape,dtype:i.dtype}}const LSt={kernelName:Nz,backendName:"cpu",kernelFunc:PSt};function t0e(e,t,n){switch(n){case"reflect":return BSt(e,t);case"wrap":return zSt(e,t);case"nearest":return WSt(e,t);case"constant":default:return USt(e)}}function BSt(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{const r=2*t;n-=r*Math.trunc(n/r),n>=t&&(n=r-n-1)}return P0(0,n,t-1)}function zSt(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{const r=t-1;n-=t*Math.trunc(n/r)}return P0(0,n,t-1)}function USt(e,t){return e}function WSt(e,t){return P0(0,e,t-1)}function iE(e,t,n,r,i,s,a,o,l,u,c){const f=a*r+o*i+l*s+u;return 0<=o&&o<t&&0<=l&&l<n?e[f]:c}function VSt(e,t,n,r,i,s,a,o,l,u,c){const f=Math.round(o),h=Math.round(l);return iE(e,t,n,r,i,s,a,f,h,u,c)}function jSt(e,t,n,r,i,s,a,o,l,u,c){const f=Math.floor(o),h=Math.floor(l),d=f+1,p=h+1,g=(p-l)*iE(e,t,n,r,i,s,a,f,h,u,c)+(l-h)*iE(e,t,n,r,i,s,a,f,p,u,c),m=(p-l)*iE(e,t,n,r,i,s,a,d,h,u,c)+(l-h)*iE(e,t,n,r,i,s,a,d,p,u,c);return(d-o)*g+(o-f)*m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HSt(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:s}=t;Ge(s,"unique");const a=r.data.get(s.dataId).values,{outputValues:o,outputShape:l,indices:u}=rMe(a,i,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}const qSt={kernelName:Mz,backendName:"cpu",kernelFunc:HSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GSt(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const a=i.shape.length,o=i.shape[s],l=new Array(a-1);let u=0;for(let d=0;d<a;d++)d!==s&&(l[u++]=i.shape[d]);const c=new Array(a).fill(0),f=i.shape.slice();f[s]=1;const h=new Array(o);for(let d=0;d<h.length;d++){c[s]=d;const p=Uy({inputs:{x:i},backend:n,attrs:{begin:c,size:f}});h[d]=tr({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const YSt={kernelName:gN,backendName:"cpu",kernelFunc:GSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:s}=t,{numSegments:a}=r;Ge(i,"unsortedSegmentSum");const o=i.shape.length,l=s.shape.length,u=[],c=[],f=o-l;let h=s;for(let p=0;p<f;++p){const g=B5({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=g,c.push(g)}for(let p=0;p<a;++p){const g=eg(p,"int32"),m=n.makeTensorInfo([],"int32",g),v=yNe({inputs:{a:m,b:h},backend:n}),y=Y0({inputs:{x:v},backend:n,attrs:{dtype:"float32"}}),b=E7({inputs:{a:y,b:i},backend:n}),x=LN({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});u.push(x),c.push(m),c.push(v),c.push(y),c.push(b),c.push(x)}const d=yMe({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(p=>n.disposeIntermediateTensorInfo(p)),d}const KSt={kernelName:mN,backendName:"cpu",kernelFunc:XSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZSt=[H2t,Sxt,G2t,X2t,Ixt,Z2t,J2t,twt,rwt,swt,owt,uwt,fwt,pwt,mwt,bwt,wwt,Cwt,Swt,V2t,Ewt,Twt,Iwt,Mxt,Mwt,Txt,Oxt,Owt,kxt,Pwt,Bwt,zwt,Wwt,jwt,qwt,Ywt,Kwt,Qwt,e$t,n$t,i$t,a$t,l$t,c$t,f$t,d$t,g$t,v$t,y$t,b$t,x$t,$$t,S$t,R2t,E$t,Rxt,O$t,Pxt,R$t,Bxt,W$t,V$t,H$t,Uxt,Vxt,G$t,X$t,Z$t,J$t,Hxt,Gxt,Ext,tCt,Lwt,rCt,sCt,oCt,P2t,Xxt,Zxt,uCt,Jxt,fCt,pCt,mCt,bCt,wCt,CCt,_Ct,t2t,kCt,ACt,DCt,NCt,FCt,RCt,LCt,r2t,zCt,VCt,qCt,s2t,o2t,XCt,QCt,t_t,u2t,r_t,s_t,a_t,bMe,c_t,B2t,h2t,h_t,p_t,m_t,y_t,Axt,QY,x_t,z2t,U2t,W2t,$_t,__t,k_t,A_t,D_t,I_t,M_t,x2t,O_t,z_t,W_t,q_t,$2t,Y_t,K_t,Q_t,C2t,jCt,tSt,rSt,sSt,oSt,uSt,fSt,dSt,gSt,k2t,mSt,A2t,D2t,ySt,xSt,$St,_St,kSt,F2t,C$t,ASt,DSt,NSt,FSt,RSt,LSt,c2t,qSt,YSt,KSt,i_t];for(const e of ZSt)Oz(e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s1={},iO={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function QSt(e,t){s1[e]=t}function Qc(e,t){if(!(e in s1)||t!=null){const r=ekt(e,t);if(r!==null)s1[e]=r;else return console.log("Could not get context for WebGL version",e),null}const n=s1[e];return n==null||n.isContextLost()?(delete s1[e],Qc(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),s1[e])}function JSt(e){if(!le().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function ekt(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=t==null?JSt(e):t;return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete s1[e]},!1),le().getBool("SOFTWARE_WEBGL_ENABLED")&&(iO.failIfMajorPerformanceCaveat=!1),e===1?n.getContext("webgl",iO)||n.getContext("experimental-webgl",iO):n.getContext("webgl2",iO)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ET;(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(ET||(ET={}));var Il;(function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"})(Il||(Il={}));var Qi;(function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Qi||(Qi={}));function BN(e,t){return[t,e]}function tkt(e,t){return e*t}function sO(e){const t=he(e),n=Math.ceil(t/4);return g5(n)}function E_(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function nkt(e,t){const[n,r]=E_(e,t);return n*r*4}function Qne(e,t){const n=e;let r,i,s,a,o,l,u,c,f,h;return le().getNumber("WEBGL_VERSION")===2?(r=n.R32F,i=n.R16F,s=n.RGBA16F,a=n.RGBA32F,o=n.RED,u=4,c=1,f=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(r=e.RGBA,i=e.RGBA,s=e.RGBA,a=n.RGBA,o=e.RGBA,u=4,c=4,f=t!=null?t.HALF_FLOAT_OES:null,h=e.FLOAT,l=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Be(e,t){const n=t();return le().getBool("DEBUG")&&rkt(e),n}function rkt(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+okt(e,t))}const ikt=596e-10,skt=65504;function akt(e){return!!(le().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||ikt<Math.abs(e)&&Math.abs(e)<skt)}function okt(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function aO(e,t){return ag(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function lkt(e,t){const n=ag(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Be(e,()=>e.shaderSource(n,t)),Be(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function ukt(e,t){const n=ag(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Be(e,()=>e.shaderSource(n,t)),Be(e,()=>e.compileShader(n)),le().get("ENGINE_COMPILE_ONLY"))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw xMe(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const ckt=/ERROR: [0-9]+:([0-9]+):/g;function xMe(e,t){const n=ckt.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}const r=+n[1],i=e.split(`
`),s=i.length.toString().length+2,a=i.map((f,h)=>X1((h+1).toString(),s)+f);let o=0;for(let f=0;f<a.length;f++)o=Math.max(a[f].length,o);const l=a.slice(0,r-1),u=a.slice(r-1,r),c=a.slice(r);console.log(l.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${X1(u[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function fkt(e){return ag(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function hkt(e,t){if(Be(e,()=>e.linkProgram(t)),!le().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function gj(e,t){if(Be(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function dkt(e,t){const n=ag(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Be(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),Be(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function pkt(e,t){const n=ag(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Be(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),Be(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function gkt(e){return ag(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function mkt(e,t){const n=le().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){const r=`[${e}x${t}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){const r=`[${e}x${t}]`,i=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}function vkt(e){return ag(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function n0e(e,t,n,r,i,s,a){const o=e.getAttribLocation(t,n);return o===-1?!1:(Be(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),Be(e,()=>e.vertexAttribPointer(o,i,e.FLOAT,!1,s,a)),Be(e,()=>e.enableVertexAttribArray(o)),!0)}function ykt(e,t,n){Ckt(e,n),Be(e,()=>e.activeTexture(e.TEXTURE0+n)),Be(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function bkt(e,t,n){return ag(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function xkt(e,t,n){return e.getUniformLocation(t,n)}function wkt(e,t,n,r){Be(e,()=>ykt(e,t,r)),Be(e,()=>e.uniform1i(n,r))}function mj(e,t,n){Be(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),Be(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function r0e(e,t){Be(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),Be(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function oO(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+$kt(e,t))}function $kt(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function ag(e,t,n){const r=Be(e,()=>t());if(r==null)throw new Error(n);return r}function Ckt(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){const i=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${i}.`)}}function Ww(e,t=2){return he(e.slice(0,e.length-t))}function Vw(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function lO(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[Ww(e),...Vw(e)]),t}function _kt(e,t=!1){let n=le().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=le().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&le().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n=n*2,r=r*2,e=e.map((o,l)=>l>=e.length-2?E8(e[l]):e[l]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=Jp(e).newShape);let i=he(e),s=null;e.length<=1&&i<=n?s=[1,i]:e.length===2&&e[0]<=n&&e[1]<=n?s=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?s=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?s=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?s=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(s=[e[0],e[1]*e[2]*e[3]]);const a=s!=null&&Math.max(...s)>r&&Math.min(...s)<=(t?2:1)&&Math.min(...s)>0;if(s==null||a)if(t){const o=Ww(e);let l=2,u=2;e.length&&([l,u]=Vw(e)),i=o*(l/2)*(u/2),s=g5(i).map(c=>c*2)}else s=g5(i);return s}function uO(e){return e%2===0}function U5(e,t){if(e=e.slice(-2),t=t.slice(-2),Zt(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){const n=e[e.length-1],r=t[t.length-1];if(n===r||uO(n)&&uO(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&uO(e[0])&&uO(t[0])}let vj,yj;function Skt(e){if(vj==null){const t=Qc(e);vj=t.getParameter(t.MAX_TEXTURE_SIZE)}return vj}function kkt(e){if(yj==null){const t=Qc(e);yj=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,yj)}function Ekt(e){if(e===0)return 0;let t;const n=Qc(e);return mu(n,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:mu(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function mu(e,t){return e.getExtension(t)!=null}function i0e(e){try{if(Qc(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function Akt(e){if(e===0)return!1;const t=Qc(e);if(e===1){if(!mu(t,"OES_texture_float"))return!1}else if(!mu(t,"EXT_color_buffer_float"))return!1;return eX(t)}function Tkt(e){if(e===0)return!1;const t=Qc(e);if(e===1){if(!mu(t,"OES_texture_float")||!mu(t,"WEBGL_color_buffer_float"))return!1}else{if(mu(t,"EXT_color_buffer_float"))return eX(t);const r="EXT_color_buffer_half_float";if(mu(t,r)){const i=t.getExtension(r);return Dkt(t,i)}return!1}return eX(t)}function eX(e){const t=Qne(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);const r=1,i=1;e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,r,i,0,t.textureFormatFloat,t.textureTypeFloat,null);const s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(s),a}function Dkt(e,t){const n=Qne(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const i=1,s=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,i,s,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(a),o}function Ikt(e){return e!==2?!1:Qc(e).fenceSync!=null}function zN(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&B(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ze=le();Ze.registerFlag("HAS_WEBGL",()=>Ze.getNumber("WEBGL_VERSION")>0);Ze.registerFlag("WEBGL_VERSION",()=>i0e(2)?2:i0e(1)?1:0);Ze.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ze.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ze.get("WEBGL_VERSION")===2);Ze.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ze.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ze.registerFlag("WEBGL_PACK",()=>Ze.getBool("HAS_WEBGL"));Ze.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_CLIP",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_REDUCE",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_CONV_IM2COL",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Skt(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>kkt(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const e=Ze.getNumber("WEBGL_VERSION");return e===0?0:Ekt(e)});Ze.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ze.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!rte());Ze.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Akt(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ze.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ze.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ze.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Tkt(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Ikt(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ze.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ze.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(e<0&&e!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)});Ze.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>rte()?1:-1,e=>{if(e<0&&e!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)});Ze.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ze.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ze.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ze.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ze.registerFlag("WEBGL_EXP_CONV",()=>!1);Ze.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ze.getBool("IS_TEST"));Ze.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ze.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ze.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ze.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ra(){let e,t,n,r,i,s,a,o,l,u;return le().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",s="outputColor",a="out vec4 outputColor;",o=le().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",s="gl_FragColor",a="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:s,defineOutput:a,defineSpecialNaN:o,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kb(e,t,n="index"){const r=Je(t);return r.map((i,s)=>{const a=`int ${e[s]} = ${n} / ${i}`,o=s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * ${i}`:`index -= ${e[s]} * ${i}`;return`${a}; ${o};`}).join("")}function A7(e,t,n="index"){const r=Je(t);return r.map((i,s)=>{const a=`int ${e[s]} = ${n} / outShapeStrides[${s}]`,o=s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * outShapeStrides[${s}]`:`index -= ${e[s]} * outShapeStrides[${s}]`;return`${a}; ${o};`}).join("")}function Nkt(e,t){const n=e.length,r=e.map(s=>`${t}[${s}]`),i=new Array(n-1);i[n-2]=r[n-1];for(let s=n-3;s>=0;--s)i[s]=`(${i[s+1]} * ${r[s+1]})`;return i}function Mkt(e,t,n="index"){const r=e.map((s,a)=>a),i=Nkt(r,t);return i.map((s,a)=>{const o=`int ${e[a]} = ${n} / ${i[a]}`,l=a===i.length-1?`int ${e[a+1]} = ${n} - ${e[a]} * ${i[a]}`:`index -= ${e[a]} * ${i[a]}`;return`${o}; ${l};`}).join("")}function Jne(e){const t=Je(e).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function ere(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const wMe=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:$Me}=Y3e;function Fkt(e,t,n){const r=[];if(e.forEach(d=>{const p=he(d.shapeInfo.logicalShape);if(d.shapeInfo.isUniform?r.push(`uniform float ${d.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${d.name};`),r.push(`uniform int offset${d.name};`)),n.enableShapeUniforms){const{uniformShape:g}=tre(n.packedInputs,d.shapeInfo.logicalShape,d.shapeInfo.texShape);switch(g.length){case 1:r.push(`uniform int ${d.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${d.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${d.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${d.name}Shape;`);break}r.push(`uniform ivec2 ${d.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(d=>{r.push(`uniform ${d.type} ${d.name}${d.arrayIndex?`[${d.arrayIndex}]`:""};`)});const i=r.join(`
`),s=e.map(d=>Okt(d,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),a=t.texShape,o=Ra(),l=Lkt(o);let u,c,f=Ukt(o);return t.isPacked?(u=Rkt(t.logicalShape,a,n.enableShapeUniforms),c=zkt(o)):(u=Pkt(t.logicalShape,a,n.enableShapeUniforms),c=Bkt(o)),n.packedInputs&&(f+=Hkt),[f,l,c,i,u,s,n.userCode].join(`
`)}function A_(e,t=!1){const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return rEt(e,t);case 1:return sEt(e,t);case 2:return oEt(e,t);case 3:return uEt(e,t);case 4:return fEt(e,t);case 5:return hEt(e);case 6:return dEt(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function CMe(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return nEt(e);case 1:return iEt(e,t);case 2:return aEt(e,t);case 3:return lEt(e,t);default:return cEt(e,t)}}function Okt(e,t,n=!1,r){let i="";n?i+=CMe(e,r):i+=A_(e,r);const s=e.shapeInfo.logicalShape,a=t.logicalShape;return s.length<=a.length&&(n?i+=pEt(e,t):i+=gEt(e,t)),i}function Rkt(e,t,n){switch(e.length){case 0:return _Me();case 1:return qkt(e,t,n);case 2:return eEt(e,t,n);case 3:return Ykt(e,t,n);default:return Kkt(e,t,n)}}function Pkt(e,t,n){switch(e.length){case 0:return _Me();case 1:return Gkt(e,t,n);case 2:return tEt(e,t,n);case 3:return Xkt(e,t,n);case 4:return Zkt(e,t,n);case 5:return Qkt(e,t);case 6:return Jkt(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}function Lkt(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function Bkt(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function zkt(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function Ukt(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Wkt}
    ${Vkt}
    ${jkt}
  `}const Wkt=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Vkt=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,jkt=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Hkt=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function _Me(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function qkt(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function Gkt(e,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function Ykt(e,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[2]/2),s=i*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec3(b, r, c);
    }
  `}function Xkt(e,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${A7(["r","c","d"],e)}
    return ivec3(r, c, d);
  }
`;const r=Kb(["r","c","d"],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function Kkt(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[e.length-1]/2),s=i*Math.ceil(e[e.length-2]/2);let a=s,o="",l="b, r, c";for(let u=2;u<e.length-1;u++)a*=e[e.length-u-1],o=`
      int b${u} = index / ${a};
      index -= b${u} * ${a};
    `+o,l=`b${u}, `+l;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${o}

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec${e.length}(${l});
    }
  `}function Zkt(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${A7(["r","c","d","d2"],e)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Kb(["r","c","d","d2"],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function Qkt(e,t){const n=Kb(["r","c","d","d2","d3"],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Jkt(e,t){const n=Kb(["r","c","d","d2","d3","d4"],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function eEt(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Zt(e,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const i=Math.ceil(e[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec2(r, c);
    }
  `}function tEt(e,t,n){return Zt(e,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function Zb(e){return`offset${e}`}function nEt(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Ra();return`
    vec4 ${n}() {
      return ${r.texture2D}(${t}, halfCR);
    }
  `}function rEt(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[i,s]=e.shapeInfo.texShape;if(i===1&&s===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Zb(n);if(t)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${a});
      return sampleTexture(${n}, uv);
    }
  `;const[o,l]=e.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${a});
      return sampleTexture(${n}, uv);
    }
  `}function iEt(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,s=Ra();if(t)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${s.texture2D}(${n}, uv);
    }
  `;const a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${a[0]}, ${a[1]}, index);
      return ${s.texture2D}(${n}, uv);
    }
  `}function sEt(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${T_(e)}
      }
    `;const i=e.shapeInfo.texShape,s=i[0],a=i[1];if(a===1&&s===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Zb(n);return a===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${s}.0);
        return sampleTexture(${n}, uv);
      }
    `:s===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${a}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${o});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${s}, ${a}, index + ${o});
      return sampleTexture(${n}, uv);
    }
  `}function aEt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape,a=s[0],o=s[1],l=Ra();if(s!=null&&Zt(n,s))return t?`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${a}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(t)return`
    vec4 ${i}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${i}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function oEt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape;if(s!=null&&Zt(n,s)){if(t)return`
      float ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const h=s[0],d=s[1];return`
    float ${i}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:a,keptDims:o}=Jp(n),l=a;if(l.length<n.length){const h=D_(e,l),d=["row","col"];return`
      ${A_(h,t)}
      float ${i}(int row, int col) {
        return ${i}(${I_(d,o)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${T_(e)}
      }
    `;const u=s[0],c=s[1],f=Zb(r);return c===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:t?`
      float ${i}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${i}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${f};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function lEt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape,a=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(n[0]===1){const h=n.slice(1),d=[1,2],p=D_(e,h),g=["b","row","col"];return`
        ${CMe(p,t)}
        vec4 ${i}(int b, int row, int col) {
          return ${i}(${I_(g,d)});
        }
      `}const o=Ra();if(t)return`
    vec4 ${i}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `;const l=a[0],u=a[1],c=Math.ceil(n[2]/2),f=c*Math.ceil(n[1]/2);return`
    vec4 ${i}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${f}, ${c}, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `}function uEt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[1]*n[2],a=n[2],{newShape:o,keptDims:l}=Jp(n),u=o;if(u.length<n.length){const g=D_(e,u),m=["row","col","depth"];return`
        ${A_(g,t)}
        float ${i}(int row, int col, int depth) {
          return ${i}(${I_(m,l)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${s}, ${a}, 1)));
        ${T_(e)}
      }
    `;const c=e.shapeInfo.texShape,f=c[0],h=c[1],d=e.shapeInfo.flatOffset;if(h===s&&d==null)return t?`
      float ${i}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${i}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${a}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${f}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(h===a&&d==null)return t?`
      float ${i}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=Zb(r);return t?`
    float ${i}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${i}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s} + col * ${a} + depth + ${p};
        vec2 uv = uvFromFlat(${f}, ${h}, index);
        return sampleTexture(${r}, uv);
      }
  `}function cEt(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=Ra();if(t)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);
    }
  `;const s=e.shapeInfo.logicalShape,a=s.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=l[0],c=l[1],f=Math.ceil(s[a-1]/2);let h=f*Math.ceil(s[a-2]/2),d="int b, int row, int col",p=`b * ${h} + (row / 2) * ${f} + (col / 2)`;for(let g=2;g<a-1;g++)d=`int b${g}, `+d,h*=s[a-g-1],p=`b${g} * ${h} + `+p;return`
    vec4 ${r}(${d}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${i.texture2D}(${n}, uv);
    }
  `}function fEt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[3],a=n[2]*s,o=n[1]*a,{newShape:l,keptDims:u}=Jp(n);if(l.length<n.length){const y=D_(e,l),b=["row","col","depth","depth2"];return`
      ${A_(y,t)}
      float ${i}(int row, int col, int depth, int depth2) {
        return ${i}(${I_(b,u)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${a}, ${s}, 1)));
        ${T_(e)}
      }
    `;const c=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,h=f[0],d=f[1],p=`int stride2 = ${r}Shape[3];`,g=`int stride1 = ${r}Shape[2] * stride2;`,m=`int stride0 = ${r}Shape[1] * stride1;`;if(d===o&&c==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        ${p}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${a}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${d}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(d===s&&c==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${d}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;const v=Zb(r);return t?`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${g}
      ${m}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${v});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} +
          depth * ${s} + depth2;
      vec2 uv = uvFromFlat(${h}, ${d}, index + ${v});
      return sampleTexture(${r}, uv);
    }
  `}function hEt(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],s=t[3]*i,a=t[2]*s,o=t[1]*a,{newShape:l,keptDims:u}=Jp(t);if(l.length<t.length){const g=D_(e,l),m=["row","col","depth","depth2","depth3"];return`
      ${A_(g)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${I_(m,u)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${a}, ${s}, ${i})) +
          depth3;
        ${T_(e)}
      }
    `;const c=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,h=f[0],d=f[1];if(d===o&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${a}, ${s}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${d}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(d===i&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${d}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Zb(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} + depth * ${s} +
          depth2 * ${i} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${d}, index);
      return sampleTexture(${n}, uv);
    }
  `}function dEt(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:s}=Jp(t);if(i.length<t.length){const m=D_(e,i),v=["row","col","depth","depth2","depth3","depth4"];return`
      ${A_(m)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${I_(v,s)});
      }
    `}const a=t[5],o=t[4]*a,l=t[3]*o,u=t[2]*l,c=t[1]*u;if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${a}, 1)));
        ${T_(e)}
      }
    `;const f=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],p=h[1];if(p===c&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${o}, ${a})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===a&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=Zb(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${o} + depth3 * ${a} + depth4 + ${g};
      vec2 uv = uvFromFlat(${d}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function T_(e){const t=e.name,n=he(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function pEt(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",s=e.shapeInfo.logicalShape.length,a=t.logicalShape.length,o=$Me(e.shapeInfo.logicalShape,t.logicalShape),l=jn(a),u=a-s;let c;const f=["x","y","z","w","u","v"];s===0?c="":a<2&&o.length>=1?c="coords = 0;":c=o.map(y=>`coords.${f[y+u]} = 0;`).join(`
`);let h="";a<2&&s>0?h="coords":h=e.shapeInfo.logicalShape.map((y,b)=>`coords.${f[b+u]}`).join(", ");let d="return outputValue;";const g=he(e.shapeInfo.logicalShape)===1,v=he(t.logicalShape)===1;if(s===1&&!g&&!v)d=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!v)a===1?d=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:d=`
        return vec4(outputValue.x);
      `;else if(o.length){const y=s-2,b=s-1;o.indexOf(y)>-1&&o.indexOf(b)>-1?d="return vec4(outputValue.x);":o.indexOf(y)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(b)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${i}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${h});
      ${d}
    }
  `}function gEt(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",s=t.texShape,a=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===l&&e.shapeInfo.flatOffset==null&&Zt(a,s))return`
      float ${i}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=jn(l),c=$Me(e.shapeInfo.logicalShape,t.logicalShape),f=l-o;let h;const d=["x","y","z","w","u","v"];o===0?h="":l<2&&c.length>=1?h="coords = 0;":h=c.map(g=>`coords.${d[g+f]} = 0;`).join(`
`);let p="";return l<2&&o>0?p="coords":p=e.shapeInfo.logicalShape.map((g,m)=>`coords.${d[m+f]}`).join(", "),`
    float ${i}() {
      ${u} coords = getOutputCoords();
      ${h}
      return get${r}(${p});
    }
  `}function jn(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function tre(e,t,n){const{newShape:r,keptDims:i}=Jp(t),s=t.length,a=e&&s===3&&t[0]===1,o=a?t.slice(1):r,l=!e&&s>1&&!Zt(t,n)&&r.length<s||a;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:i}}function D_(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function I_(e,t){return t.map(n=>e[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mEt(e,t,n,r){const i=n.map((c,f)=>{const h={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(h.flatOffset=c.texData.slice.flatOffset),{name:t.variableNames[f],shapeInfo:h}}),s=i.map(c=>c.shapeInfo),a={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=Fkt(i,a,t),l=ukt(e.gl,o),u=e.createProgram(l);return le().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:s,outShapeInfo:a,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(u),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:s,outShapeInfo:a},SMe(e,t,u)))}function SMe(e,t,n){const r=[],i=[];let s,a,o,l=null,u=null;u=e.getUniformLocation(n,"NAN",!1),le().getNumber("WEBGL_VERSION")===1&&(l=e.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const f of t.variableNames){const h={name:f,uniform:e.getUniformLocation(n,f,c),offset:e.getUniformLocation(n,`offset${f}`,c)};t.enableShapeUniforms&&(h.shape=e.getUniformLocation(n,`${f}Shape`,c),h.texShape=e.getUniformLocation(n,`${f}TexShape`,c)),r.push(h)}if(t.enableShapeUniforms&&(s=e.getUniformLocation(n,"outShape",c),o=e.getUniformLocation(n,"outShapeStrides",c),a=e.getUniformLocation(n,"outTexShape",c)),t.customUniforms)for(const f of t.customUniforms)i.push(e.getUniformLocation(n,f.name,c));return{variablesLocations:r,customUniformLocations:i,infLoc:l,nanLoc:u,outShapeLocation:s,outShapeStridesLocation:o,outTexShapeLocation:a}}function s0e(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((n,r)=>{const i=n.logicalShape,s=t[r],a=s.shape;if(!Zt(i,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${a} must match`);if(n.isUniform&&s.isUniform)return;const o=n.texShape,l=s.isUniform?null:s.texData.texShape;if(!Zt(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function vEt(e,t,n,r,i){t.program.enableShapeUniforms||(s0e(t.inShapeInfos,n),s0e([t.outShapeInfo],[r]));const s=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(s.texture,a[0],a[1]):e.setOutputMatrixTexture(s.texture,a[0],a[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),le().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:f,shape:h,texShape:d}=t.variablesLocations[l];if(h){const{uniformShape:p}=tre(t.program.packedInputs,u.shape,u.texData.texShape);switch(p.length){case 1:e.gl.uniform1iv(h,new Int32Array(p));break;case 2:e.gl.uniform2iv(h,new Int32Array(p));break;case 3:e.gl.uniform3iv(h,new Int32Array(p));break;case 4:e.gl.uniform4iv(h,new Int32Array(p));break}}if(d&&e.gl.uniform2i(d,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(he(u.shape)<2)e.gl.uniform1f(c,u.uniformValues[0]);else{let p=u.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),e.gl.uniform1fv(c,p)}continue}u.texData.slice!=null&&f!=null&&e.gl.uniform1i(f,u.texData.slice.flatOffset),e.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const o=t.outShapeLocation;if(o)switch(r.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(r.shape));break}if(t.outShapeStridesLocation){const l=Je(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l));break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i)for(let l=0;l<t.program.customUniforms.length;++l){const u=t.program.customUniforms[l],c=t.customUniformLocations[l],f=i[l];if(u.type==="float")e.gl.uniform1fv(c,f);else if(u.type==="vec2")e.gl.uniform2fv(c,f);else if(u.type==="vec3")e.gl.uniform3fv(c,f);else if(u.type==="vec4")e.gl.uniform4fv(c,f);else if(u.type==="int")e.gl.uniform1iv(c,f);else if(u.type==="ivec2")e.gl.uniform2iv(c,f);else if(u.type==="ivec3")e.gl.uniform3iv(c,f);else if(u.type==="ivec4")e.gl.uniform4iv(c,f);else throw Error(`uniform type ${u.type} is not supported yet.`)}e.executeProgram()}function yEt(e,t,n){let r="";t.concat(n).forEach(a=>{const o=a.texData!=null&&a.texData.slice!=null&&a.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!a.isUniform){const l=a.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:f}=tre(e.packedInputs,a.shape,l);let h="",d="",p="";if(c.length===1&&e.packedInputs){const w=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${w[0]>1}_${w[1]>1}`}else if(c.length===2&&!e.packedInputs)d=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!e.packedInputs){const w=Je(c);p=`${w[0]===l[1]}_${w[w.length-1]===l[1]}`}const g=a.shape.length,m=c.length===2&&Zt(a.shape,l),v=he(a.shape)===1,y=Ry(a.shape,n.shape),b=!e.packedInputs&&g===n.shape.length&&Zt(l,n.texData.texShape),x=e.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${g}_${b}_${u?f:""}_${c.length}_${v}_${y}_${m}_${h}_${d}_${p}_${x}_${o}`}else{const l=a.isUniform?"uniform":a.texData.texShape;r+=`${a.shape}_${l}_${o}`}});const i=e.userCode;let s=e.constructor.name;return s+="_"+r+"_"+i+`${le().getNumber("WEBGL_VERSION")}`,s}function Xs(e){return le().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bEt{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=ET.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Ra();this.outputShape=t,this.enableShapeUniforms=Xs(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?A7(["r","c","d"],t):Kb(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xEt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=ET.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Ra();this.outputShape=t,this.enableShapeUniforms=Xs(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?A7(["r","c","d"],t):Kb(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wEt{constructor(t){this.variableNames=["A"],this.outTexUsage=Il.DOWNLOAD;const n=Ra();this.outputShape=t,this.userCode=`
      ${wMe}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Et{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Il.DOWNLOAD;const n=Ra();this.outputShape=t,this.userCode=`
      ${wMe}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CEt={R:0,G:1,B:2,A:3};class a0e{constructor(t,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const i=Ra();this.outputShape=t,this.enableShapeUniforms=Xs(this.outputShape.length);let s="result";n&&(s="floor(result * 255. + 0.5)");let a="";for(let o=0;o<r.length;o++){const l=r[o];a+=`
          if(offset == ${o}) {
            result = values[${CEt[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?ere():Jne(t)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${i.texture2D}(A, uv);
          ${a}
        }
        ${i.output} = vec4(${s}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Et{constructor(t,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Ra();this.outputShape=t,this.enableShapeUniforms=Xs(this.outputShape.length);let i="",s="result";n&&(s="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let o=0;o<=1;o++){const l=a*2+o;i+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${a} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {
            localCoords[1] += ${a};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?ere():Jne(t)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${i}

          ${r.output} = ${s};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SEt(e){const t=Ra(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return lkt(e,n)}function kEt(e){const t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return dkt(e,t)}function EEt(e){const t=new Uint16Array([0,1,2,2,1,3]);return pkt(e,t)}function UN(e,t,n,r,i,s){mkt(t,n);const a=gkt(e),o=e.TEXTURE_2D;return Be(e,()=>e.bindTexture(o,a)),Be(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),Be(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),Be(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),Be(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),le().getNumber("WEBGL_VERSION")===1?Be(e,()=>e.texImage2D(o,0,r,t,n,0,i,s,null)):Be(e,()=>e.texStorage2D(o,1,r,t,n)),Be(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:a,texShape:[n,t]}}function kMe(e){return e.internalFormatFloat}function AEt(e,t,n,r){const[i,s]=BN(t,n);return UN(e,i,s,kMe(r),r.textureFormatFloat,e.FLOAT)}function EMe(e){return e.internalFormatHalfFloat}function TEt(e,t,n,r){const[i,s]=BN(t,n);return UN(e,i,s,EMe(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function AMe(e){return e.downloadTextureFormat}function DEt(e,t,n,r){const[i,s]=BN(t,n);return UN(e,i,s,AMe(r),e.RGBA,e.UNSIGNED_BYTE)}function TMe(e){return e.internalFormatPackedFloat}function IEt(e,t,n,r){const[i,s]=E_(t,n);return UN(e,i,s,TMe(r),e.RGBA,e.FLOAT)}function DMe(e){return e.internalFormatPackedHalfFloat}function NEt(e,t,n,r){const[i,s]=E_(t,n);return UN(e,i,s,DMe(r),e.RGBA,r.textureTypeHalfFloat)}function MEt(e,t,n){return Be(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),n0e(e,t,"clipSpacePos",n,3,20,0)&&n0e(e,t,"uv",n,2,20,12)}function FEt(e,t,n,r,i,s){Be(e,()=>e.bindTexture(e.TEXTURE_2D,t));let a,o,l;i instanceof Uint8Array?(a=new Uint8Array(n*r*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(a=new Float32Array(n*r*4),o=e.FLOAT,l=s.internalFormatPackedFloat),a.set(i),le().getNumber("WEBGL_VERSION")===2?Be(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,o,a)):Be(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,r,0,e.RGBA,o,a)),Be(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function OEt(e,t,n){Be(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?le().getNumber("WEBGL_VERSION")===2?Be(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):Be(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):le().getNumber("WEBGL_VERSION")===2?Be(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):Be(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),Be(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function REt(e,t,n,r){const i=e.createBuffer();Be(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,i));const o=4*4*t*n;return Be(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)),Be(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),Be(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),i}function PEt(e,t,n){const r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function LEt(e,t,n,r){const[i,s]=BN(t,n),a=4,o=new Uint8Array(tkt(t*n,a));return Be(e,()=>e.readPixels(0,0,i,s,r.downloadTextureFormat,e.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function BEt(e,t,n,r,i,s,a,o){const l=e,u=new Float32Array(nkt(s,a));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function zEt(e,t,n){const r=new Float32Array(t*n*4);return Be(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bj{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=le().getNumber("WEBGL_VERSION");if(t!=null?(this.gl=t,QSt(n,t)):this.gl=Qc(n),t=this.gl,le().getNumber("WEBGL_VERSION")===2){const s=t;this.createVertexArray=()=>Be(s,()=>s.createVertexArray()),this.bindVertexArray=a=>Be(s,()=>s.bindVertexArray(a)),this.deleteVertexArray=a=>Be(s,()=>s.deleteVertexArray(a)),this.getVertexArray=()=>Be(s,()=>s.getParameter(s.VERTEX_ARRAY_BINDING))}else if(t!=null){const s=t.getExtension("OES_vertex_array_object");if(s==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Be(t,()=>s.createVertexArrayOES()),this.bindVertexArray=a=>Be(t,()=>s.bindVertexArrayOES(a)),this.deleteVertexArray=a=>Be(t,()=>s.deleteVertexArrayOES(a)),this.getVertexArray=()=>Be(t,()=>t.getParameter(s.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),le().getNumber("WEBGL_VERSION")===1){const s="OES_texture_float",a="OES_texture_half_float";if(this.textureFloatExtension=aO(this.gl,s),mu(this.gl,a))this.textureHalfFloatExtension=aO(this.gl,a);else if(le().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),mu(this.gl,i))this.colorBufferHalfFloatExtension=aO(this.gl,i);else if(le().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",mu(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(mu(this.gl,i))this.colorBufferHalfFloatExtension=this.gl.getExtension(i);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=kEt(this.gl),this.indexBuffer=EEt(this.gl),this.framebuffer=vkt(this.gl),this.textureConfig=Qne(this.gl,this.textureHalfFloatExtension)}get debug(){return le().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;Be(t,()=>t.finish()),Be(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),Be(t,()=>t.deleteFramebuffer(this.framebuffer)),Be(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),Be(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),Be(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,n){return this.throwIfDisposed(),AEt(this.gl,t,n,this.textureConfig)}createFloat16MatrixTexture(t,n){return this.throwIfDisposed(),TEt(this.gl,t,n,this.textureConfig)}createUnsignedBytesMatrixTexture(t,n){return this.throwIfDisposed(),DEt(this.gl,t,n,this.textureConfig)}uploadPixelDataToTexture(t,n){this.throwIfDisposed(),OEt(this.gl,t,n)}uploadDenseMatrixToTexture(t,n,r,i){this.throwIfDisposed(),FEt(this.gl,t,n,r,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,n){return this.throwIfDisposed(),NEt(this.gl,t,n,this.textureConfig)}createPackedMatrixTexture(t,n){return this.throwIfDisposed(),IEt(this.gl,t,n,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(r0e(this.gl,this.framebuffer),this.outputTexture=null),Be(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,n,r){return this.downloadMatrixDriver(t,()=>LEt(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(t,n,r,i,s,a){return BEt(this.gl,t,n,r,i,s,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,n){return PEt(this.gl,t,n)}createBufferFromTexture(t,n,r){this.bindTextureToFrameBuffer(t);const i=REt(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let n,r;if(le().getBool("WEBGL_FENCE_API_ENABLED")){const i=t,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=()=>{const a=i.clientWaitSync(s,0,0);return a===i.ALREADY_SIGNALED||a===i.CONDITION_SATISFIED},n=s}else le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(t,n,r){return this.downloadMatrixDriver(t,()=>zEt(this.gl,n,r))}createProgram(t){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=SEt(n));const r=fkt(n);Be(n,()=>n.attachShader(r,this.vertexShader)),Be(n,()=>n.attachShader(r,t)),hkt(n,r);const i=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&gj(n,i),i}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const n=this.gl;Be(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),MEt(n,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&(Be(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&gj(this.gl,this.program),Be(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,n,r=!0){return this.throwIfDisposed(),r?bkt(this.gl,t,n):xkt(this.gl,t,n)}getAttributeLocation(t,n){return this.throwIfDisposed(),Be(this.gl,()=>this.gl.getAttribLocation(t,n))}getUniformLocationNoThrow(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)}setInputMatrixTexture(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),wkt(this.gl,t,n,r)}setOutputMatrixTexture(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)}setOutputPackedMatrixTexture(t,n,r){this.throwIfDisposed();const[i,s]=E_(n,r);this.setOutputMatrixTextureDriver(t,i,s)}setOutputMatrixWriteRegion(t,n,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,n)}setOutputPackedMatrixWriteRegion(t,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&gj(this.gl,this.program),oO(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Be(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Be(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=aO(this.gl,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.createQuery();return r.beginQuery(i.TIME_ELAPSED_EXT,s),s}const t=this.getQueryTimerExtensionWebGL1(),n=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,n),n}endQuery(){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await yY(()=>this.disposed||this.isQueryAvailable(t,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,n){if(n===0)return!0;if(n===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),s&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),i=r.getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}}pollFence(t){return new Promise(n=>{this.addItemToPoll(()=>t.isFencePassed(),()=>n())})}pollItems(){const t=UEt(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=t;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,n){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in le().platform&&(r=le().platform.setTimeoutCustom.bind(le().platform)),yY(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),mj(this.gl,t,this.framebuffer),this.debug&&oO(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(mj(this.gl,this.outputTexture,this.framebuffer),this.debug&&oO(this.gl)):r0e(this.gl,this.framebuffer)}downloadMatrixDriver(t,n){this.bindTextureToFrameBuffer(t);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(t,n,r){this.throwIfDisposed();const i=this.gl;mj(i,t,this.framebuffer),this.debug&&oO(i),this.outputTexture=t,Be(i,()=>i.viewport(0,0,n,r)),Be(i,()=>i.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(t,n,r,i){this.throwIfDisposed(),Be(this.gl,()=>this.gl.scissor(t,n,r,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function UEt(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:WEt,bincountImpl:IMe,bincountReduceImpl:VEt,bitwiseAndImpl:jEt,castImpl:HEt,ceilImpl:qEt,concatImpl:GEt,equalImpl:YEt,expImpl:XEt,expm1Impl:KEt,floorImpl:ZEt,gatherNdImpl:QEt,gatherV2Impl:JEt,greaterImpl:eAt,greaterEqualImpl:tAt,lessImpl:nAt,lessEqualImpl:rAt,linSpaceImpl:iAt,logImpl:sAt,maxImpl:aAt,maximumImpl:oAt,minimumImpl:lAt,multiplyImpl:uAt,negImpl:cAt,notEqualImpl:fAt,prodImpl:hAt,raggedGatherImpl:dAt,raggedRangeImpl:pAt,raggedTensorToTensorImpl:gAt,rangeImpl:mAt,rsqrtImpl:vAt,scatterImpl:yAt,sigmoidImpl:bAt,simpleAbsImpl:NMe,sliceImpl:xAt,sparseFillEmptyRowsImpl:wAt,sparseReshapeImpl:$At,sparseSegmentReductionImpl:MMe,sqrtImpl:CAt,staticRegexReplaceImpl:_At,stridedSliceImpl:SAt,stringNGramsImpl:kAt,stringSplitImpl:EAt,stringToHashBucketFastImpl:AAt,subImpl:TAt,tileImpl:DAt,topKImpl:IAt,transposeImpl:nre,uniqueImpl:NAt}=O2t;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FMe(e,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${e}.${n}`)}function pa(e,t){return t===1?[e]:FMe(e,t)}function MAt(e,t){if(e===1)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FAt{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=Xs(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=pa("rc",this.rank),r=jn(this.rank),i=this.getOutOfBoundsCondition(n),s=this.getSetup(n),a=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${i}) {
            setOutput(vec4(0));
          } else {
            ${s}

            setOutput(vec4(${a}));
          }
        }
      `}}getSourceCoordsArr(t){const n=[];for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){let s=`${r===0?"r":"rp1"}, ${i===0?"c":"cp1"}`;for(let a=2;a<this.rank;a++)s=`${t[t.length-1-a]},`+s;n.push(s)}return n}getOutOfBoundsCondition(t){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${t[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(t){if(this.rank===1)return"";const n=t.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],i=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${i};
    `}getOutput(t){const n=this.getSourceCoordsArr(t);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OMe{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=Xs(this.outputShape.length);let r="";for(let i=0;i<4;i++){let s="thisRC = rc;";i%2===1&&(s+="thisRC.z += 1;"),i>1&&(s+="thisRC.y += 1;"),r+=`
        ${s}
        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${i}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${i>0?"}":""}
      `}this.userCode=`
      ${OAt(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?ere():Jne(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};

        ${r}

        setOutput(result);
      }
    `}}function OAt(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?Mkt(["r","c","d"],"inputShape"):Kb(["r","c","d"],e)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RAt{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,n,r){const i=l0e(n,r),s=u0e(t,i,r);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);const a=o0e(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const l=this.freeTextures[s].pop();return this.usedTextures[s].push(l),l}let o;return i===Qi.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Qi.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Qi.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Qi.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Qi.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(o),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),o}releaseTexture(t,n,r,i){if(this.freeTextures==null)return;const s=l0e(r,i),a=u0e(n,s,i);a in this.freeTextures||(this.freeTextures[a]=[]);const o=o0e(n,s,this.gpgpu.gl,this.gpgpu.textureConfig,i),l=le().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=o):(this.freeTextures[a].push(t),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const u=this.usedTextures[a],c=u&&u.indexOf(t);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const t in this.freeTextures)this.freeTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function PAt(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function o0e(e,t,n,r,i){const s=LAt(t,r);let a;if(i){const[l,u]=E_(e[0],e[1]);a=l*u}else{const[l,u]=BN(e[0],e[1]);a=l*u}const o=PAt(n,s);return a*o}function LAt(e,t){switch(e){case Qi.PACKED_2X2_FLOAT32:return TMe(t);case Qi.PACKED_2X2_FLOAT16:return DMe(t);case Qi.UNPACKED_FLOAT32:return kMe(t);case Qi.UNPACKED_FLOAT16:return EMe(t);case Qi.PACKED_4X1_UNSIGNED_BYTE:return AMe(t);default:throw new Error(`Unknown physical texture type ${e}`)}}function BAt(e){return le().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Qi.PACKED_2X2_FLOAT32:Qi.UNPACKED_FLOAT32:e?Qi.PACKED_2X2_FLOAT16:Qi.UNPACKED_FLOAT16}function l0e(e,t){if(e===Il.UPLOAD)return Qi.PACKED_2X2_FLOAT32;if(e===Il.RENDER||e==null)return BAt(t);if(e===Il.DOWNLOAD||e===Il.PIXELS)return Qi.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function u0e(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jf{constructor(t,n){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=Xs(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Gu="if (isnan(x)) return x;",zAt="return x;",c0e="return abs(x);",UAt="return (x >= 0.0) ? x : (exp(x) - 1.0);",WAt=Gu+`
  return (x < 0.0) ? 0.0 : x;
`,VAt=Gu+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Mg="return x;",jAt="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HAt="return x;",qAt=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,GAt=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,YAt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XAt="return 1.0 / (1.0 + exp(-1.0 * x));";class Yg{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=Xs(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KAt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=Xs(this.outputShape.length);const n=t.length,r=pa("rc",n),i=jn(n),s=MAt(n,r),a=r.slice(-2),o=n<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`
      void main() {
        ${i} rc = getOutputCoords();
        vec4 packedInput = getA(${s});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZAt=n7,QAt=1e-7,JAt=1e-4,cO={};function eTt(e){return e in cO||(cO[e]={}),cO[e]}const tTt=le().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),nTt=600;function rTt(){return le().global.screen==null?1024:le().global.screen.height*le().global.screen.width*window.devicePixelRatio*nTt/1024/1024}class T7 extends k8{nextDataId(){return T7.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!le().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(t!=null){if(t instanceof bj)n=t;else{const r=Qc(le().getNumber("WEBGL_VERSION"),t);n=new bj(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Qc(le().getNumber("WEBGL_VERSION"));n=new bj(r),this.binaryCache=eTt(le().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new RAt(this.gpgpu),this.numMBBeforeWarning=rTt(),this.texData=new Gee(this,fc())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,n,r,i,s,a){const o=this.makeTensorInfo(n,r),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:t,texShape:[i,s]},l.texShape=[i,s];const u=lO(n),c=new a0e(u,!1,a),f=this.runWebGLProgram(c,[o],r,[[i,s]]);return f.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(o),f.dataId}write(t,n,r){if((le().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||le().getBool("DEBUG"))&&this.checkNumericalProblems(t),r==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={id:this.nextDataId()};return this.texData.set(i,{shape:n,dtype:r,values:t,usage:Il.UPLOAD,refCount:1}),i}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){const n=this.texData.get(t);n.refCount++}decRef(t){if(this.texData.has(t)){const n=this.texData.get(t);n.refCount--}}move(t,n,r,i,s){if(le().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:r,dtype:i,values:n,usage:Il.UPLOAD,refCount:s})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const n=this.texData.get(t),{values:r,dtype:i,complexTensorInfos:s,slice:a,shape:o,isPacked:l}=n;if(a!=null){let h;l?h=new Yg(o,Mg):h=new Jf(o,Mg);const d=this.runWebGLProgram(h,[{dataId:t,shape:o,dtype:i}],i),p=this.readSync(d.dataId);return this.disposeIntermediateTensorInfo(d),p}if(r!=null)return this.convertAndCacheOnCPU(t);if(i==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=ua());let f;if(i==="complex64"){const h=this.readSync(s.real.dataId),d=this.readSync(s.imag.dataId);f=Mp(h,d)}else f=this.getValuesFromTexture(t);return u&&(this.downloadWaitMs+=ua()-c),this.convertAndCacheOnCPU(t,f)}async read(t){if(this.pendingRead.has(t)){const p=this.pendingRead.get(t);return new Promise(g=>p.push(g))}const n=this.texData.get(t),{values:r,shape:i,slice:s,dtype:a,complexTensorInfos:o,isPacked:l}=n;if(s!=null){let p;l?p=new Yg(i,Mg):p=new Jf(i,Mg);const g=this.runWebGLProgram(p,[{dataId:t,shape:i,dtype:a}],a),m=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),m}if(r!=null)return this.convertAndCacheOnCPU(t);if(le().getBool("DEBUG")&&!le().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&le().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(a!=="complex64"&&le().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(t);const p=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(p.texture.texture,...sO(i))}this.pendingRead.set(t,[]),a!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(a==="complex64"){const p=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),g=p[0],m=p[1];f=Mp(g,m)}else if(u==null)f=this.getValuesFromTexture(t);else{const p=he(i);f=this.gpgpu.downloadFloat32MatrixFromBuffer(u,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const p=this.gpgpu.gl;Be(p,()=>p.deleteBuffer(u))}const h=this.convertAndCacheOnCPU(t,f),d=this.pendingRead.get(t);return this.pendingRead.delete(t),d.forEach(p=>p(h)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&fc().removeDataId(t,this),this.pendingDeletes--),h}readToGPU(t,n={}){const r=this.texData.get(t),{values:i,shape:s,slice:a,dtype:o,isPacked:l,texture:u}=r;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(a!=null){let d;l?d=new Yg(s,Mg):d=new Jf(s,Mg);const p=this.runWebGLProgram(d,[{dataId:t,shape:s,dtype:o}],o),g=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),g}if(u==null)throw i!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(t,n.customTexShape),f=fc().makeTensorFromTensorInfo(c),h=this.texData.get(c.dataId);return Object.assign({tensorRef:f},h.texture)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const r=n.map(i=>Ip(i));return Mt(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Mt(t.shape,t.dtype,n)}checkNumericalProblems(t){if(t!=null)for(let n=0;n<t.length;n++){const r=t[n];if(!akt(r))throw le().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(t){const{shape:n,dtype:r,isPacked:i}=this.texData.get(t),s=he(n);if(le().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(t),d=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(d.texture.texture,...sO(n)).subarray(0,s);return this.disposeIntermediateTensorInfo(h),p}const a=le().getBool("WEBGL_PACK")&&i===!0,o=a?lO(n):n,l=a?new $Et(o):new wEt(o),u=this.runWebGLProgram(l,[{shape:o,dtype:r,dataId:t}],"float32"),c=this.texData.get(u.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(u),f}timerAvailable(){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const n=this.activeTimers,r=[];let i=!1;this.programTimersStack==null?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,t();const s=Dh(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),a=Dh(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,i&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(s);o.kernelMs=tAe(l),o.getExtraProfileInfo=()=>l.map((u,c)=>({name:a[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ua(),endMs:null}}endTimer(t){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=ua(),t)}async getQueryTime(t){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const n=t;return n.endMs-n.startMs}disposeData(t,n=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(n?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!n&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:r}=this.texData.get(t);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:n,dtype:r,texShape:i,usage:s,isPacked:a,slice:o}=this.texData.get(t),l=o&&o.origDataId||t,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,s,a)));const c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,n=tTt){return le().getBool("WEBGL_CPU_FORWARD")&&t.every(r=>this.texData.get(r.dataId).texture==null&&he(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(t){kl("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=t.dataSync();return ZAt(t.shape,n)}packedUnaryOp(t,n,r){const i=new Yg(t.shape,n),s=this.compileAndRun(i,[t],r);return fc().makeTensorFromTensorInfo(s)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){const i=NMe(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,i)}if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,c0e,t.dtype);const n=new Jf(t.shape,c0e),r=this.compileAndRun(n,[t]);return fc().makeTensorFromTensorInfo(r)}makeTensorInfo(t,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&Kf(r[0])){const s=r.map(a=>th(a));i=this.write(s,t,n)}else i=this.write(r,t,n);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:n}}makeOutput(t,n,r){return fc().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,r),this)}unpackTensor(t){const n=new KAt(t.shape);return this.runWebGLProgram(n,[t],t.dtype)}packTensor(t){const n=new FAt(t.shape),r=!0;return this.runWebGLProgram(n,[t],t.dtype,null,r)}packedReshape(t,n){const r=[Ww(t.shape),...Vw(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},s=[Ww(n),...Vw(n)],a=new OMe(s,r),o=!0,l=[r],u=this.runWebGLProgram(a,[i],t.dtype,l,o);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(t,n){const r=this.texData.get(t),{isPacked:i,shape:s,dtype:a}=r;if(n!=null){const h=he(s),d=n[0]*n[1]*4;B(h<=d,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=lO(s);let l;i?l=new xEt(o):l=new bEt(o);const u=!0,c=[n!=null?n:sO(o)],f=this.runWebGLProgram(l,[{shape:o,dtype:a,dataId:t}],a,c,u,n);return{dtype:a,shape:s,dataId:f.dataId}}runWebGLProgram(t,n,r,i,s=!1,a){const o=this.makeTensorInfo(t.outputShape,r),l=this.texData.get(o.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===ET.DENSE){const v=a!=null?a:sO(t.outputShape);l.texShape=v.map(y=>y*2)}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),he(o.shape)===0)return l.values=Fi(o.dtype,0),o;const u=[],c=n.map(v=>{if(v.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(v.dataId);if(y.texture==null){if(!t.packedInputs&&he(v.shape)<=le().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:v.shape,texData:null,isUniform:!0,uniformValues:y.values};t.packedInputs&&(y.isPacked=!0,y.shape=v.shape)}if(this.uploadToGPU(v.dataId),!!y.isPacked!=!!t.packedInputs)v=y.isPacked?this.unpackTensor(v):this.packTensor(v),u.push(v),y=this.texData.get(v.dataId);else if(y.isPacked&&!U5(y.shape,v.shape)){const b=v,x=v.shape;v.shape=y.shape,v=this.packedReshape(v,x),u.push(v),y=this.texData.get(v.dataId),b.shape=x}return{shape:v.shape,texData:y,isUniform:!1}});this.uploadToGPU(o.dataId);const f={shape:o.shape,texData:l,isUniform:!1},h=yEt(t,c,f),d=this.getAndSaveBinary(h,()=>mEt(this.gpgpu,t,c,f)),p=this.activeTimers!=null;let g;p&&(g=this.startTimer()),le().get("ENGINE_COMPILE_ONLY")||vEt(this.gpgpu,d,c,f,i),u.forEach(v=>this.disposeIntermediateTensorInfo(v)),p&&(g=this.endTimer(g),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(g)}));const m=le().get("WEBGL_FLUSH_THRESHOLD");if(m>0){const v=ua();v-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=v)}if(!le().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&s===!1){const v=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),v}return o}compileAndRun(t,n,r,i,s=!1){return r=r||n[0].dtype,this.runWebGLProgram(t,n,r,i,s)}getAndSaveBinary(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(le().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ce(()=>{if(!le().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=le().getBool("DEBUG");le().set("DEBUG",!1);const n=this.abs(xt(1e-8)).dataSync()[0];if(le().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?QAt:JAt}uploadToGPU(t){const n=this.texData.get(t),{shape:r,dtype:i,values:s,texture:a,usage:o,isPacked:l}=n;if(a!=null)return;const u=this.activeTimers!=null;let c;u&&(c=ua());let f=n.texShape;if(f==null&&(f=_kt(r,l),n.texShape=f),s!=null){const h=lO(r);let d,p=f[1],g=f[0];const m=s instanceof Uint8Array||s instanceof Uint8ClampedArray;(l||!m)&&([p,g]=E_(f[0],f[1])),l?d=new _Et(h,m):d=new a0e(h,m);const v=m?[g,p]:f,y=this.makeTensorInfo(v,i),b=this.texData.get(y.dataId);m?b.usage=Il.PIXELS:b.usage=Il.UPLOAD,b.texShape=v,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),p,g,s);const x=[[g,p]],w=!0,C=this.runWebGLProgram(d,[y],i,x,w),$=this.texData.get(C.dataId);n.texShape=$.texShape,n.isPacked=$.isPacked,n.usage=$.usage,le().get("ENGINE_COMPILE_ONLY")?this.disposeData(C.dataId):(n.texture=$.texture,n.values=null,this.texData.delete(C.dataId)),this.disposeIntermediateTensorInfo(y),u&&(this.uploadWaitMs+=ua()-c)}else{const h=this.acquireTexture(f,o,i,l);n.texture=h}}convertAndCacheOnCPU(t,n){const r=this.texData.get(t),{dtype:i}=r;return n!=null&&(r.values=iTt(n,i)),r.values}acquireTexture(t,n,r,i){if(this.numBytesInGPU+=this.computeBytes(t,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${s} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,n,i)}computeBytes(t,n){return t[0]*t[1]*oT(n)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(n));return Promise.all(t)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(i=>{try{this.checkCompletion_(n),i(!0)}catch(s){throw s}});t.push(r)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await tne(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(xMe(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:i,nanLoc:s,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:l}=SMe(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=n,t.customUniformLocations=r,t.infLoc=i,t.nanLoc=s,t.outShapeLocation=a,t.outShapeStridesLocation=o,t.outTexShapeLocation=l}}createTensorFromGPUData(t,n,r){t.channels=t.channels||"RGBA";const{texture:i,height:s,width:a,channels:o}=t,l=fc().backend;if(!l.gpgpu.gl.isTexture(i))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(i,n,r,s,a,o);return fc().makeTensorFromDataId(u,n,r,l)}}T7.nextDataId=0;function iTt(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){const n=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}else throw new Error(`Unknown dtype ${t}`)}/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ite()&&ote("webgl",()=>new T7,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rre=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Wy{constructor(t,n,r){this.variableNames=["A","B"],this.outputShape=Ct(n,r),this.enableShapeUniforms=Xs(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qb=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class N_{constructor(t,n,r,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ct(n,r);const s=this.outputShape.length;this.enableShapeUniforms=Xs(s);let a="";if(i)if(s===0||he(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          ${jn(s)} coords = getOutputCoords();
        `,s===1)this.enableShapeUniforms?a+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:a+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=pa("coords",s);this.enableShapeUniforms?a+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= outShape[${s} - 2];
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= outShape[${s} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:a+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= ${this.outputShape[s-2]};
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= ${this.outputShape[s-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${a}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ol(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const sTt={kernelName:GC,backendName:"webgl",kernelFunc:ol};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gm(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,s=n.makeTensorInfo(r.shape,"complex64"),a=n.texData.get(s.dataId),o=ol({inputs:{x:r},backend:n}),l=ol({inputs:{x:i},backend:n});return a.complexTensorInfos={real:o,imag:l},s}const aTt={kernelName:R8,backendName:"webgl",kernelFunc:Gm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RMe="return (a < 0.) ? b * a : a;",PMe=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function oTt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:s}=r,a=n.makeTensorInfo([],"float32",eg(s,"float32")),o=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new N_(PMe,i.shape,a.shape):new Wy(RMe,i.shape,a.shape),l=n.runWebGLProgram(o,[i,a],"float32");return n.disposeIntermediateTensorInfo(a),l}const lTt={kernelName:PI,backendName:"webgl",kernelFunc:oTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LMe="return (a < 0.) ? b * a : a;",BMe=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function uTt(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t,s=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new N_(BMe,r.shape,i.shape):new Wy(LMe,r.shape,i.shape);return n.runWebGLProgram(s,[r,i],"float32")}const cTt={kernelName:nN,backendName:"webgl",kernelFunc:uTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M_="if (isnan(x)) return x;";function tn({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:s})=>{const{x:a}=i,o=s,l=r||a.dtype;if(o.shouldExecuteOnCPU([a])&&n!=null){const f=o.texData.get(a.dataId),h=n(f.values,l);return o.makeTensorInfo(a.shape,l,h)}const u=le().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null;let c;return u?c=new Yg(a.shape,t):c=new Jf(a.shape,e),o.runWebGLProgram(c,[a],l)}}function ys({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:s}){return({inputs:a,backend:o})=>{const{a:l,b:u}=a,c=o;if(r&&l.dtype==="complex64"){const p=c.texData.get(l.dataId),g=c.texData.get(u.dataId),[m,v]=[[p.complexTensorInfos.real,g.complexTensorInfos.real],[p.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(b=>{const[x,w]=b,C={dataId:x.dataId,dtype:x.dtype,shape:l.shape},$={dataId:w.dataId,dtype:w.dtype,shape:u.shape},_=new Wy(e,l.shape,u.shape);return c.runWebGLProgram(_,[C,$],fo(x.dtype,w.dtype))}),y=Gm({inputs:{real:m,imag:v},backend:c});return c.disposeIntermediateTensorInfo(m),c.disposeIntermediateTensorInfo(v),y}const f=s||fo(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&i!=null){const p=c.texData.get(l.dataId).values,g=c.texData.get(u.dataId).values,m=l.dtype==="string"?Fp(p):p,v=l.dtype==="string"?Fp(g):g,[y,b]=i(l.shape,u.shape,m,v,f),x=c.makeTensorInfo(b,f),w=c.texData.get(x.dataId);return w.values=y,x}const h=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null;let d;return h?d=new N_(t,l.shape,u.shape,n):d=new Wy(e,l.shape,u.shape),c.runWebGLProgram(d,[l,u],f)}}function AT(e,t=!1){if(e==="linear")return t?HAt:zAt;if(e==="relu")return t?GAt:WAt;if(e==="elu")return t?qAt:UAt;if(e==="relu6")return t?YAt:VAt;if(e==="prelu")return t?BMe:LMe;if(e==="leakyrelu")return t?PMe:RMe;if(e==="sigmoid")return t?XAt:jAt;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zMe{constructor(t,n,r,i=!1,s=!1,a=!1,o=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Xs(this.outputShape.length);const c=i?t[1]:t[2],f=Math.ceil(c/2),h=i?"i * 2, rc.y":"rc.y, i * 2",d=s?"rc.z, i * 2":"i * 2, rc.z",p=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",v="";o&&(l?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:u?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:m=`vec4 activation(vec4 x) {
          ${o}
        }`,v="result = activation(result);");const y=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let b="rc.x",x="rc.x";t[0]<n[0]?b=`imod(rc.x, ${t[0]})`:n[0]<t[0]&&(x=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${m}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${x};
        for (int i = 0; i < ${f}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${d});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${g[0]});
          result += (${p[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${v}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f0e={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class h0e{constructor(t,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ct(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d0e="return a * b;";function ire(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,s=fo(r.dtype,i.dtype);if(r.dtype==="complex64"){const o=n.texData.get(r.dataId),l=n.texData.get(i.dataId),u=new h0e(f0e.REAL,r.shape,i.shape),c=new h0e(f0e.IMAG,r.shape,i.shape),f=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:r.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:i.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:i.shape}],h=n.runWebGLProgram(u,f,"float32"),d=n.runWebGLProgram(c,f,"float32"),p=Gm({inputs:{real:h,imag:d},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),p}if(n.shouldExecuteOnCPU([r,i])){const o=n.texData.get(r.dataId),l=n.texData.get(i.dataId),[u,c]=uAt(r.shape,i.shape,o.values,l.values,s),f=n.makeTensorInfo(c,s),h=n.texData.get(f.dataId);return h.values=u,f}let a;return le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?a=new N_(d0e,r.shape,i.shape):a=new Wy(d0e,r.shape,i.shape),n.runWebGLProgram(a,[r,i],s)}const fTt={kernelName:n_,backendName:"webgl",kernelFunc:ire};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hTt(e,t,n){const r=[Ww(e.shape),...Vw(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},s=[Ww(t),...Vw(t)],a=new OMe(s,r),o=!0,l=[r],u=n.runWebGLProgram(a,[i],e.dtype,l,o);return{dataId:u.dataId,shape:t,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:s}=r,a=n,o=he(i.shape),l=Xee(s,o),u=he(l);B(o===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const c=a.texData.get(i.dataId);return c.isPacked&&!U5(i.shape,l)&&!(c.texture!==null&&U5(c.shape,l))?hTt(i,l,a):(a.incRef(i.dataId),{dataId:i.dataId,shape:l,dtype:i.dtype})}const dTt={kernelName:iN,backendName:"webgl",kernelFunc:Fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p0e{constructor(t,n){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:a}=t;this.outputShape=[i,a];const o=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const f=1/n;u=`sumValue += dot(values * ${Ny(f)?f.toPrecision(2):f}, ones);`}let c="";s%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pTt{constructor(t,n){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:a}=t;this.outputShape=[i,a];let o="0.0",l="";n==="prod"?o="1.0":n==="min"?(o="1.0 / 1e-20",l="min"):n==="max"&&(o="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,f=r%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,d="vec4";n==="all"?(o="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):n==="any"&&(o="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${f===2}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${f===3}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gTt(e){const t=[];for(;t.length===0||t[t.length-1].outSize!==1;){const n=t.length?t[t.length-1].outSize:e[1],r=d7(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}function Jb(e,t,n,r){const i=gTt(e.shape);let s=e;for(let a=0;a<i.length;a++){const{inSize:o,windowSize:l,outSize:u}=i[a];let c,f;n==="mean"?c=a===0?new p0e({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:u},o):new p0e({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:u}):c=new pTt({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:u},n),f=s,s=r.runWebGLProgram(c,[s],t),f.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(f)}return s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mTt{constructor(t,n){this.variableNames=["A"];const r=new Array(t.length);for(let a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;const i=jn(this.rank),s=vTt(n);this.userCode=`
    void main() {
      ${i} resRC = getOutputCoords();
      setOutput(getA(${s}));
    }
    `}}function vTt(e){const t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let i=0;i<e.length;i++)r[e[i]]=n[i];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yTt{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(t.length);for(let c=0;c<r.length;c++)r[c]=t[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=jn(this.rank),s=FMe("rc",this.rank),a=new Array(this.rank);for(let c=0;c<n.length;c++)a[n[c]]=s[c];const o=`vec2(${a.slice(-2).join()})`,l=`++${s[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${a.join()}), ${o})`;this.userCode=`
    void main() {
      ${i} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${s[this.rank-1]};
      if(++${s[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D7(e,t,n){const r=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yTt(e.shape,t):new mTt(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bTt(e,t,n,r){const i=t,s=e.shape.length,a=Ot(i,e.shape);let o=a;const l=Fr(o,s),u=l!=null;let c=e;u&&(c=D7(e,l,r),o=Jr(o.length,s)),vs("sum",o,s);const[f,h]=Li(c.shape,o);let d=f;n&&(d=Zr(f,a));const p=he(h),m=he(e.shape)/p,v=Fe({inputs:{x:c},attrs:{shape:[m,p]},backend:r}),y=Rz(e.dtype),b=Jb(v,y,"sum",r),x=Fe({inputs:{x:b},attrs:{shape:d},backend:r});return r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(b),u&&r.disposeIntermediateTensorInfo(c),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I7(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r;return bTt(i,s,a,n)}const xTt={kernelName:cN,backendName:"webgl",kernelFunc:I7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ia(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{perm:s}=r,a=n,o=i.shape.length,l=new Array(o);for(let c=0;c<l.length;c++)l[c]=i.shape[s[c]];let u;if(a.shouldExecuteOnCPU([i])){const f=a.texData.get(i.dataId).values,h=nre(f,i.shape,i.dtype,s,l);u=a.makeTensorInfo(l,i.dtype);const d=a.texData.get(u.dataId);d.values=h}else u=D7(i,s,a);return u}const wTt={kernelName:K1,backendName:"webgl",kernelFunc:Ia};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UMe=1e3;function W5({a:e,b:t,transposeA:n,transposeB:r,backend:i,bias:s=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:l=null}){const u=e.shape.length,c=t.shape.length,f=n?e.shape[u-2]:e.shape[u-1],h=r?t.shape[c-1]:t.shape[c-2],d=n?e.shape[u-1]:e.shape[u-2],p=r?t.shape[c-2]:t.shape[c-1],g=e.shape.slice(0,-2),m=t.shape.slice(0,-2),v=he(g),y=he(m),x=Ct(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([d,p]);B(f===h,()=>`Error in matMul: inner shapes (${f}) and (${h}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`);const w=n?[v,f,d]:[v,d,f],C=r?[y,p,h]:[y,h,p],$=Fe({inputs:{x:e},backend:i,attrs:{shape:w}}),_=Fe({inputs:{x:t},backend:i,attrs:{shape:C}}),k=[$,_],E=Math.max(v,y),S=n?$.shape[1]:$.shape[2],I=s!=null,A=a!=null,D=l==="leakyrelu",T=l!=null?AT(l,!0):null,N=I||A||D||T!=null;let F;if((d===1||p===1)&&S>UMe&&N===!1){let P=$,V=_;n&&(P=Ia({inputs:{x:$},backend:i,attrs:{perm:[0,2,1]}}),k.push(P)),r&&(V=Ia({inputs:{x:_},backend:i,attrs:{perm:[0,2,1]}}),k.push(V));const z=p!==1,q=p===1;let G=P;z&&(G=Fe({inputs:{x:P},backend:i,attrs:{shape:[E,S,1]}}),k.push(G));const K=p===1?2:1;let Y=V;q&&(Y=Fe({inputs:{x:V},backend:i,attrs:{shape:[E,1,S]}}),k.push(Y));const te=ire({inputs:{a:G,b:Y},backend:i});F=I7({inputs:{x:te},backend:i,attrs:{axis:K,keepDims:!0}}),k.push(te)}else{const P=fo(e.dtype,t.dtype),V=new zMe(w,C,[E,d,p],n,r,I,T,A,D),z=[$,_];if(s!=null&&z.push(s),A&&z.push(a),D){const q=i.makeTensorInfo([],"float32",eg(o,"float32"));z.push(q),k.push(q)}F=i.runWebGLProgram(V,z,P)}const R=Fe({inputs:{x:F},backend:i,attrs:{shape:x}});k.push(F);for(const P of k)i.disposeIntermediateTensorInfo(P);return R}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Tt(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s,bias:a,preluActivationWeights:o}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:f}=r;return W5({a:i,b:s,transposeA:l,transposeB:u,backend:n,bias:a,preluActivationWeights:o,leakyreluAlpha:f,activation:c})}const CTt={kernelName:lT,backendName:"webgl",kernelFunc:$Tt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g0e="return abs(x);";function _Tt(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const s=n.texData.get(r.dataId),a=NMe(s.values);return n.makeTensorInfo(r.shape,r.dtype,a)}let i;return le().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new Yg(r.shape,g0e):i=new Jf(r.shape,g0e),n.runWebGLProgram(i,[r],r.dtype)}const STt={kernelName:gI,backendName:"webgl",kernelFunc:_Tt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kTt=Gu+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,ETt=tn({opSnippet:kTt}),ATt={kernelName:EC,backendName:"webgl",kernelFunc:ETt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TTt=Gu+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,DTt=tn({opSnippet:TTt}),ITt={kernelName:AC,backendName:"webgl",kernelFunc:DTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m0e="return a + b;",NTt=ys({opSnippet:m0e,packedOpSnippet:m0e,supportsComplex:!0,cpuKernelImpl:WEt}),MTt={kernelName:Ub,backendName:"webgl",kernelFunc:NTt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FTt{constructor(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map((s,a)=>`T${a}`);const r=[];this.variableNames.forEach(s=>{r.push(`float v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OTt{constructor(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((s,a)=>`T${a}`);const r=[];this.variableNames.forEach(s=>{r.push(`vec4 v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4(e){const{inputs:t,backend:n}=e,r=t;if(r.length===1)return ol({inputs:{x:r[0]},backend:n});if(r.length>le().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=t4({inputs:r.slice(0,l),backend:n}),c=t4({inputs:r.slice(l),backend:n});return t4({inputs:[u,c],backend:n})}const i=r.map(l=>l.dtype).reduce((l,u)=>fo(l,u)),s=r.map(l=>l.shape),o=le().getBool("WEBGL_PACK")?new OTt(r[0].shape,s):new FTt(r[0].shape,s);return n.runWebGLProgram(o,r,i)}const RTt={kernelName:mI,backendName:"webgl",kernelFunc:t4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PTt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r,o=i.shape.length,l=Ot(s,i.shape);let u=l;const c=Fr(u,o);let f=i;c!=null&&(f=Ia({inputs:{x:i},backend:n,attrs:{perm:c}}),u=Jr(u.length,o)),vs("all",u,o);const[h,d]=Li(f.shape,u),p=he(d),g=Fe({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),m=Jb(g,g.dtype,"all",n);let v;if(a){const y=Zr(h,l);v=Fe({inputs:{x:m},backend:n,attrs:{shape:y}})}else v=Fe({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),c!=null&&n.disposeIntermediateTensorInfo(f),v}const LTt={kernelName:D8,backendName:"webgl",kernelFunc:PTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BTt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r,o=i.shape.length,l=Ot(s,i.shape);let u=l;const c=Fr(u,o);let f=i;c!=null&&(f=Ia({inputs:{x:i},backend:n,attrs:{perm:c}}),u=Jr(u.length,o)),vs("any",u,o);const[h,d]=Li(f.shape,u),p=he(d),g=Fe({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),m=Jb(g,g.dtype,"any",n);let v;if(a){const y=Zr(h,l);v=Fe({inputs:{x:m},backend:n,attrs:{shape:y}})}else v=Fe({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),c!=null&&n.disposeIntermediateTensorInfo(f),v}const zTt={kernelName:I8,backendName:"webgl",kernelFunc:BTt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UTt{constructor(t,n,r){this.variableNames=["A"];const{windowSize:i,batchSize:s,outSize:a}=t;r||this.variableNames.push("bestIndicesA"),this.outputShape=[s,a];const o=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${i};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${i}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WTt{constructor(t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,B(t.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const s=t[t.length-1],a=Math.ceil(s/n);this.outputShape=t.slice(0,-1),a>1&&this.outputShape.push(a),i||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,u=jn(l),c=pa("coords",l);let f,h;if(a===1){h=l+1;const _=jn(h);f=`
        ${_} sourceLocR = ${_}(${c.join()}, 0);
        ++${c[l-1]};
        ${_} sourceLocG = ${_}(${c.join()}, 0);
        ++${c[l-2]};
        ${_} sourceLocA = ${_}(${c.join()}, 0);
        --${c[l-1]};
        ${_} sourceLocB = ${_}(${c.join()}, 0);
        --${c[l-2]};`}else h=l,f=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const d=["x","y","z","w","u","v"].slice(0,h),p="."+d[h-1],g=d.map(_=>"int "+_),m=pa("sourceLocR",h-1).concat("inIdx.r"),v=pa("sourceLocG",h-1).concat("inIdx.g"),y=pa("sourceLocB",h-1).concat("inIdx.b"),b=pa("sourceLocA",h-1).concat("inIdx.a"),x=r==="max"?"greaterThan":"lessThan",w=i?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()})));`,C=`vec4(
            getAChannel(${m.join()}),
            hasNextCol ? getAChannel(${v.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,$=i?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${d.join()}),
                                          vec2(${d.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${d.join()}),
                               vec2(${d.slice(-2).join()}));
      }
      ${$}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${o[l-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${C};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${C};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${x}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WMe(e,t,n,r=null){let i=t.shape[0],s=t.shape[1];r!=null&&(i=r.shape[0],s=r.shape[1]);const a=d7(s),o={windowSize:a,inSize:s,batchSize:i,outSize:Math.ceil(s/a)},l=new UTt(o,n,r==null),u=[t];r!=null&&u.push(r);const c=e.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const f=WMe(e,t,n,c);return e.disposeIntermediateTensorInfo(c),f}function VMe(e,t,n,r=null){const i=r!=null?r.shape:t.shape,s=i[i.length-1],a=d7(s),o=new WTt(i,a,n,r==null),l=r==null?[t]:[t,r],u=e.runWebGLProgram(o,l,"int32");if(u.shape.length===t.shape.length){const c=VMe(e,t,n,u);return e.disposeIntermediateTensorInfo(u),c}return u}function jMe(e,t,n,r){const i=[n];if(vs("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!le().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const s=[],a=e.texData.get(t.dataId),o=a!==null&&a.isPacked;let l=t;o&&(l=e.unpackTensor(t),s.push(l));const[u,c]=Li(l.shape,i),f=he(c),h=Fe({inputs:{x:l},backend:e,attrs:{shape:[-1,f]}});s.push(h);const d=WMe(e,h,r);s.push(d);const p=Fe({inputs:{x:d},backend:e,attrs:{shape:u}});return s.forEach(g=>e.disposeIntermediateTensorInfo(g)),p}return VMe(e,t,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VTt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;let a=Ot(s,i.shape);const o=Fr(a,i.shape.length);let l=i;const u=[];o!=null&&(l=Ia({inputs:{x:i},backend:n,attrs:{perm:o}}),u.push(l),a=Jr(a.length,l.shape.length)),vs("argMax",[a[0]],l.shape.length);const c=jMe(n,l,a[0],"max");return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}const jTt={kernelName:vI,backendName:"webgl",kernelFunc:VTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HTt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;let a=Ot(s,i.shape);const o=Fr(a,i.shape.length);let l=i;const u=[];o!=null&&(l=Ia({inputs:{x:i},backend:n,attrs:{perm:o}}),u.push(l),a=Jr(a.length,l.shape.length)),vs("argMin",[a[0]],l.shape.length);const c=jMe(n,l,a[0],"min");return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}const qTt={kernelName:yI,backendName:"webgl",kernelFunc:HTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GTt=Gu+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,YTt=tn({opSnippet:GTt}),XTt={kernelName:TC,backendName:"webgl",kernelFunc:YTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KTt=Gu+"return log(x + sqrt(x * x + 1.0));",ZTt=tn({opSnippet:KTt}),QTt={kernelName:DC,backendName:"webgl",kernelFunc:ZTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JTt=Gu+`
  return atan(x);
`,e3t=tn({opSnippet:JTt}),t3t={kernelName:IC,backendName:"webgl",kernelFunc:e3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n3t=rre+`
  return atan(a, b);
`,r3t=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Qb+`
  return result;
`,i3t=ys({opSnippet:n3t,packedOpSnippet:r3t}),s3t={kernelName:MC,backendName:"webgl",kernelFunc:i3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a3t=Gu+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,o3t=tn({opSnippet:a3t}),l3t={kernelName:NC,backendName:"webgl",kernelFunc:o3t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TT{constructor(t,n,r,i=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const a=t.filterWidth,o=t.strideHeight,l=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,f=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const g=n==="avg",m=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,v=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let y="0.0";if(g||(y="-1.0 / 1e-20"),r){const _=">=";this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${d}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${_} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${i?s?m:v:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let x=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(x="avgValue / max(count, 1.0)");const w=Math.floor(a/4)*4,C=a%4,$=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${d}, ${p});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${w}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${$}
          }

          int xC = xCCorner + ${w};
          if (${C===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${C===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${C===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${$}
          }
        }
        setOutput(${x});
      }
    `}}class sre{constructor(t,n,r,i=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const a=t.filterWidth,o=t.strideDepth,l=t.strideHeight,u=t.strideWidth,c=t.dilationDepth,f=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,g=t.effectiveFilterWidth,m=t.padInfo.front,v=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const b=n==="avg";let x="0.0";if(b||(x="-1.0 / 1e-20"),r){const E=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${u});
        const ivec3 pads = ivec3(${m}, ${v}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${d};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${E} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${i?s?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${p} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / max(count, 1.0)");const $=Math.floor(a/4)*4,_=a%4,k=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${u});
      const ivec3 pads = ivec3(${m}, ${v}, ${y});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${$}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${k}
            }

            int xC = xCCorner + ${$};
            if (${_===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${_===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${_===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${k}
            }
          }
        }
        setOutput(${C});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u3t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;zN(i,"avgPool");const{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=r,u=1;B(ms(a,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const c=Hu(i.shape,s,a,u,o,l);if(c.filterWidth===1&&c.filterHeight===1&&Zt(c.inShape,c.outShape))return ol({inputs:{x:i},backend:n});const f=new TT(c,"avg",!1);return n.runWebGLProgram(f,[i],"float32")}const c3t={kernelName:bI,backendName:"webgl",kernelFunc:u3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f3t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:a,pad:o,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],f=tg(i.shape,s,a,c,o,l,u),h=new sre(f,"avg",!1);return n.runWebGLProgram(h,[i],"float32")}const h3t={kernelName:xI,backendName:"webgl",kernelFunc:f3t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d3t{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,s=t.strideWidth,a=t.dilationHeight,o=t.dilationWidth,l=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=l-1-t.padInfo.top,f=u-1-t.padInfo.left,h=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${f});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class p3t{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterDepth,r=t.filterHeight,i=t.filterWidth,s=t.strideDepth,a=t.strideHeight,o=t.strideWidth,l=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,f=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=f-1-t.padInfo.front,g=h-1-t.padInfo.top,m=d-1-t.padInfo.left,v=1/(n*r*i);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${g}, ${m});
      const float avgMultiplier = float(${v});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${s}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g3t(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,a=s,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=r,f=[1,1,1],h=tg(a.shape,o,l,f,u,c),d=new p3t(h);return n.runWebGLProgram(d,[i],a.dtype)}const m3t={kernelName:M8,backendName:"webgl",kernelFunc:g3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v3t(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,a=s;zN([i,s],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=r,c=Hu(a.shape,o,l,1,u),f=new d3t(c);return n.runWebGLProgram(f,[i],a.dtype)}const y3t={kernelName:N8,backendName:"webgl",kernelFunc:v3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b3t(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s}=t,{transposeA:a,transposeB:o}=r;return W5({a:i,b:s,transposeA:a,transposeB:o,backend:n})}const x3t={kernelName:wI,backendName:"webgl",kernelFunc:b3t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w3t{constructor(t,n,r,i,s,a){this.outputShape=[],this.variableNames=["x","mean","variance"],Ct(t,n),Ct(t,r);let o="0.0";i!=null&&(Ct(t,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";s!=null&&(Ct(t,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${a}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $3t{constructor(t,n,r,i,s,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ct(t,n),Ct(t,r);let o="vec4(0.0)";i!=null&&(Ct(t,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";s!=null&&(Ct(t,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${a}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C3t=({inputs:e,backend:t,attrs:n})=>{const{x:r,mean:i,variance:s,offset:a,scale:o}=e;B(i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),B(a==null||i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),B(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,i,s];let c=null;a!=null&&(c=a.shape,u.push(a));let f=null;o!=null&&(f=o.shape,u.push(o));const h=le().getBool("WEBGL_PACK_NORMALIZATION")?new $3t(r.shape,i.shape,s.shape,c,f,l):new w3t(r.shape,i.shape,s.shape,c,f,l);return t.runWebGLProgram(h,u,u[0].dtype)},_3t={kernelName:FI,backendName:"webgl",kernelFunc:C3t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S3t{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const n=jn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=k3t(this.rank);let i;const s=t.map((a,o)=>`sourceLoc.${tX[o]} = start[${o}] + coords.${tX[o]};`);i=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${s.join(`
`)}
      `,this.userCode=`
      void main() {
        ${i}
        setOutput(getSource(${r}));
      }
    `}}const tX=["x","y","z","w","u","v"];function k3t(e){if(e===1)return"sourceLoc";if(e<=6)return tX.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E3t{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=jn(this.rank),r=pa("coords",this.rank),i=pa("sourceLoc",this.rank),s=this.rank===1?"sourceLoc":`vec2(${i.slice(-2).join()})`,a=`getChannel(getSource(${i.join()}), ${s})`,o=`
      result.x = ${a};
      if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
        ++${i[this.rank-1]};
        result.y = ${a};
        --${i[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${t[this.rank-2]}) {
        ++${i[this.rank-2]};
        result.z = ${a};
        if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
          ++${i[this.rank-1]};
          result.w = ${a};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${t.map((c,f)=>`start[${f}]`).join()});`:t.map((c,f)=>`${i[f]} = ${r[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A3t(e,t,n,r){const i=r.texData.get(e.dataId),s=r.makeTensorInfo(n,e.dtype),a=r.texData.get(s.dataId);Object.assign(a,i),a.refCount=1,a.shape=n,a.dtype=e.dtype;let o=Jte(t,Je(e.shape));i.slice&&(o+=i.slice.flatOffset),a.slice={flatOffset:o,origDataId:i.slice&&i.slice.origDataId||e.dataId};const l=r.dataRefCount.get(a.slice.origDataId)||1;return r.dataRefCount.set(a.slice.origDataId,l+1),s}function F_(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,size:a}=r,[o,l]=h7(i,s,a);if(Kte(i,o,l),he(l)===0)return n.makeTensorInfo(l,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||i.dtype==="string"){const f=n.texData.get(i.dataId),h=xAt(f.values,o,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,h)}const{isPacked:u}=n.texData.get(i.dataId),c=Qte(i.shape,o,l);if(u||!c){const f=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new E3t(l):new S3t(l),h=[o];return n.runWebGLProgram(f,[i],i.dtype,h)}return n.uploadToGPU(i.dataId),A3t(i,o,l,n)}const T3t={kernelName:uN,backendName:"webgl",kernelFunc:F_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D3t=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,crops:a}=r;B(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=s.reduce((y,b)=>y*b),l=EN(i.shape,s,o),u=AN(l.length,s.length),c=TN(i.shape,s,o),f=sne(a,s.length),h=ane(c,a,s.length),d=[],p=Fe({inputs:{x:i},backend:n,attrs:{shape:l}}),g=Ia({inputs:{x:p},backend:n,attrs:{perm:u}}),m=Fe({inputs:{x:g},backend:n,attrs:{shape:c}}),v=F_({inputs:{x:m},backend:n,attrs:{begin:f,size:h}});return d.push(p),d.push(g),d.push(m),d.forEach(y=>n.disposeIntermediateTensorInfo(y)),v},I3t={kernelName:$I,backendName:"webgl",kernelFunc:D3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N3t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:a}=r,o=n.readSync(i.dataId),l=n.readSync(s.dataId),u=IMe(o,l,s.dtype,s.shape,a);return n.makeTensorInfo([a],s.dtype,u)}const M3t={kernelName:F8,backendName:"webgl",kernelFunc:N3t};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F3t=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,O3t=`
  return float(int(a.r) & int(b.r));
`;function R3t(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,s=le().getBool("WEBGL_PACK_BINARY_OPERATIONS"),a=le().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||a===1){const l=n.texData.get(r.dataId).values,u=n.texData.get(i.dataId).values,[c,f]=jEt(r.shape,i.shape,l,u,r.dtype),h=n.makeTensorInfo(f,r.dtype),d=n.texData.get(h.dataId);return d.values=c,h}let o;return s?o=new N_(F3t,r.shape,i.shape,!1):o=new Wy(O3t,r.shape,i.shape),n.runWebGLProgram(o,[r,i],r.dtype)}const P3t={kernelName:CI,backendName:"webgl",kernelFunc:R3t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L3t(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,s=n.readSync(r.dataId),a=n.readSync(i.dataId),o=Ct(Array.from(s),Array.from(a));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const B3t={kernelName:O8,backendName:"webgl",kernelFunc:L3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z3t="return float(a != b);",HMe=ys({opSnippet:z3t,cpuKernelImpl:fAt,dtype:"bool"}),U3t={kernelName:ZI,backendName:"webgl",kernelFunc:HMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WN(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return ol({inputs:{x:i.complexTensorInfos.real},backend:n})}const W3t={kernelName:gz,backendName:"webgl",kernelFunc:WN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V3t="return float(int(x));";function j3t(e,t){const n=new Jf(e.shape,V3t),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nX(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:s}=r;if(s==="complex64"){if(i.dtype==="complex64")return ol({inputs:{x:i},backend:n});const a=di(i.shape),o=nX({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),l=Gm({inputs:{real:o,imag:a},backend:n});return a.dispose(),n.disposeIntermediateTensorInfo(o),l}if(i.dtype==="complex64"){const a=WN({inputs:{input:i},backend:n}),o=nX({inputs:{x:a},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(a),o}if(!Kee(i.dtype,s)){const a=ol({inputs:{x:i},backend:n});return{dataId:a.dataId,shape:a.shape,dtype:s}}if(n.shouldExecuteOnCPU([i])){const a=n.texData.get(i.dataId).values,[o,l,u]=HEt(a,i.shape,i.dtype,s);return n.makeTensorInfo(o,l,u)}if(s==="int32")return j3t(i,n);if(s==="bool"){const a=n.makeTensorInfo([],"bool",Fi("bool",1)),l=HMe({inputs:{a:i,b:a},backend:n});return n.disposeIntermediateTensorInfo(a),l}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${s}`)}const H3t={kernelName:FC,backendName:"webgl",kernelFunc:nX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v0e="return ceil(x);",q3t=tn({opSnippet:v0e,packedOpSnippet:v0e,cpuKernelImpl:qEt}),G3t={kernelName:OC,backendName:"webgl",kernelFunc:q3t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y3t{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X3t{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{clipValueMin:s,clipValueMax:a}=r;let o;le().getBool("WEBGL_PACK_CLIP")?o=new X3t(i.shape):o=new Y3t(i.shape);const l=[[s],[a]];return n.runWebGLProgram(o,[i],i.dtype,l)}const Z3t={kernelName:RC,backendName:"webgl",kernelFunc:K3t};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q3t{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y0e(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function J3t(e){const{inputs:t,backend:n}=e,{x:r}=t,i=n.texData.get(r.dataId),s=new Q3t(r.shape),a=[y0e(r,i.complexTensorInfos.real),y0e(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(s,a,a[0].dtype)}const eDt={kernelName:_I,backendName:"webgl",kernelFunc:J3t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tDt{constructor(t){this.outputShape=[],this.outputShape=rh(t,1),this.variableNames=t.map((a,o)=>`T${o}`);const n=new Array(t.length-1);n[0]=t[0][1];for(let a=1;a<n.length;a++)n[a]=n[a-1]+t[a][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let a=1;a<n.length;a++){const o=n[a-1];r.push(`else if (yC < ${n[a]}) setOutput(getT${a}(yR, yC-${o}));`)}const i=n.length,s=n[n.length-1];r.push(`else setOutput(getT${i}(yR, yC-${s}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nDt{constructor(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=rh(t,n);const r=this.outputShape,i=r.length,s=jn(i),a=pa("coords",i),o=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((g,m)=>`T${m}`);const l=new Array(t.length-1);l[0]=t[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+t[g][n];const u=o[n],c=o.slice(-2),f=o.join();let h=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${f}), vec2(${c.join()}));
        }`;for(let g=1;g<l.length;g++){const m=l[g-1];h+=`
        if (${u} < ${l[g]}  && ${u} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${fO(o,u,m)}),
            vec2(${fO(c,u,m)}));
        }`}const d=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${d}(${fO(o,u,p)}),
          vec2(${fO(c,u,p)}));`,this.userCode=`
      float getValue(${o.map(g=>"int "+g)}) {
        ${h}
      }

      void main() {
        ${s} coords = getOutputCoords();
        vec4 result = vec4(getValue(${a}), 0., 0., 0.);

        ${a[i-1]} = ${a[i-1]} + 1;
        if (${a[i-1]} < ${r[i-1]}) {
          result.g = getValue(${a});
        }

        ${a[i-2]} = ${a[i-2]} + 1;
        if (${a[i-2]} < ${r[i-2]}) {
          result.a = getValue(${a});
        }

        ${a[i-1]} = ${a[i-1]} - 1;
        if (${a[i-2]} < ${r[i-2]} &&
            ${a[i-1]} < ${r[i-1]}) {
          result.b = getValue(${a});
        }
        setOutput(result);
      }
    `}}function fO(e,t,n){const r=e.indexOf(t);return e.map((s,a)=>a===r?`${s} - ${n}`:s).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N7(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return ol({inputs:{x:i.complexTensorInfos.imag},backend:n})}const rDt={kernelName:tz,backendName:"webgl",kernelFunc:N7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sE(e,t,n){const r=e[0].dtype;if(r==="complex64"){const d=e.map(y=>WN({inputs:{input:y},backend:n})),p=e.map(y=>N7({inputs:{input:y},backend:n})),g=sE(d,t,n),m=sE(p,t,n),v=Gm({inputs:{real:g,imag:m},backend:n});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),p.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),v}let i=n.shouldExecuteOnCPU(e);if(r==="string"&&(i=!0),i){const d=e.map(x=>{const C=[-1,he(x.shape.slice(t))];return Fe({inputs:{x},backend:n,attrs:{shape:C}})}),p=d.map(x=>({vals:n.readSync(x.dataId),shape:x.shape})),g=rh(d.map(x=>x.shape),1),m=d[0].shape[0]===1,v=GEt(p,g,r,m),y=rh(e.map(x=>x.shape),t),b=n.makeTensorInfo(y,r,v);return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),b}const s=e.filter(d=>he(d.shape)>0),a=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(s.length===1){const d=a?new Jf(e[0].shape,Mg):new Yg(e[0].shape,Mg);return n.runWebGLProgram(d,e,r)}const o=le().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>o){const d=[];for(let g=0;g<s.length;g+=o){const m=s.slice(g,g+o);d.push(sE(m,t,n))}const p=sE(d,t,n);for(const g of d)n.disposeIntermediateTensorInfo(g);return p}if(a){const d=new nDt(s.map(p=>p.shape),t);return n.runWebGLProgram(d,s,r)}const{tensors2D:l,outShape:u}=iDt(s,t,n),c=new tDt(l.map(d=>d.shape)),f=n.runWebGLProgram(c,l,r);l.forEach(d=>n.disposeIntermediateTensorInfo(d));const h=Fe({inputs:{x:f},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(f),h}function iDt(e,t,n){const r=rh(e.map(s=>s.shape),t);return{tensors2D:e.map(s=>Fe({inputs:{x:s},attrs:{shape:[-1,he(s.shape.slice(t))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qMe(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,s=Ot(i,t[0].shape)[0],a=t.map(u=>u.shape);nne(a,s);const o=rh(t.map(u=>u.shape),s);if(he(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);const l=t.filter(u=>he(u.shape)>0);return l.length===1?ol({inputs:{x:l[0]},backend:n}):sE(l,s,n)}const sDt={kernelName:SI,backendName:"webgl",kernelFunc:qMe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GMe{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const a=t.padInfo.top,o=t.padInfo.left,l=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,f=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,p=Math.floor(t.inChannels/4)*4,g=t.inChannels%4,m=t.dataFormat==="channelsLast",v=m?1:2,y=m?2:3,b=m?3:1;let x="",w="";r&&(i?x=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?x=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:x=`
          float activation(float x) {
            ${r}
          }
        `,w="result = activation(result);");const C=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${x}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${v}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${d}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${m}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${m}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${m}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${m}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${C}
        ${w}
        setOutput(result);
      }
    `}}class aDt{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const n=t.padInfo.front,r=t.padInfo.top,i=t.padInfo.left,s=t.strideDepth,a=t.strideHeight,o=t.strideWidth,l=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,f=t.filterDepth,h=t.filterHeight,d=t.filterWidth,p=Math.floor(t.inChannels/4)*4,g=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${s}, ${a}, ${o});
      const ivec3 pads = ivec3(${n}, ${r}, ${i});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YMe{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Xs(this.outputShape.length);const a=t.padInfo.left,o=t.strideWidth,l=t.dilationWidth,u=t.filterHeight,c=t.filterWidth,f=c;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<c;m++)h+=`
           vec4 xTexelC${m*2};
           int xTexelC${m*2}Ready;
           vec4 xTexelC${m*2+1};
           int xTexelC${m*2+1}Ready;
           vec4 xC${m};`;h+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {
       `;for(let m=0;m<c;m++)h+=`
           xTexelC${m*2} = vec4(0.0);
           xTexelC${m*2}Ready = 0;
           xTexelC${m*2+1} = vec4(0.0);
           xTexelC${m*2+1}Ready = 0;
           xC${m} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let m=0;m<(f+1)/2;m++){const v=m*2;if(h+=`
           xC = xCCorner + ${v*l};
           `,o===1){if(v<c&&(a%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }
               `,l===1&&v>0?h+=`
                 xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                   } else {
                     xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 xC${v} = xTexelC${v};
                 `,v+1<c)){const y=a%2===0?E8(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                     xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${v+1}.zw = vec2(0.0);
                     }
                     xTexelC${v+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                     } else {
                      xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                     }
                     `:h+=`
                     xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                     `):y===1?h+=`
                     xC${v+1} = xTexelC${v};
                     `:h+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                       xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${v+1}.zw = vec2(0.0);
                       }
                       xTexelC${v+1}Ready = 1;
                     }

                     xC${v+1} = xTexelC${v+1};
                     `}}else v<c&&(a%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                   xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${v+1}.zw = vec2(0.0);
                   }
                   xTexelC${v+1}Ready = 1;
                 }

                 xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
               `,v+1<c&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                   xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v+1}.zw = vec2(0.);
                   }
                   xTexelC${v+1}Ready = 1;
                 }

                 xC${v} = vec4(
                   xTexelC${v}.xy, xTexelC${v+1}.xy);
               `,v+1<c&&(h+=`
                   xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                 `)));v<c&&(h+=`
             wTexel = getW(r, ${v}, d1, d2);
             dotProd += xC${v}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${t.inChannels}) {
               dotProd += xC${v}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,v+1<c&&(h+=`
               wTexel = getW(r, ${v+1}, d1, d2);
               dotProd += xC${v+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${t.inChannels}) {
                 dotProd += xC${v+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let d="",p="";r&&(i?d=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:s?d=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:d=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${d}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oDt{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=Xs(this.outputShape.length);const{dataFormat:r}=n,i=Ra(),s=r==="channelsLast",a=s?1:2,o=s?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let f=0;f<=1;f++)u+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${a}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${s}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${i.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V5(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function XMe({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:o=null}){const l=e.shape,u=r.texData.get(e.dataId),c=n.inChannels,f=l[0]*l[1]*l[2],h=n.outChannels,d=n.dataFormat==="channelsLast",p=!1,g=!1;let m;const v=[];if(s!=null){const x=V5(s.shape,d);x!=null&&(s=Fe({inputs:{x:s},backend:r,attrs:{shape:x}}),v.push(s))}if(i!=null){const x=V5(i.shape,d);x!=null&&(i=Fe({inputs:{x:i},backend:r,attrs:{shape:x}}),v.push(i))}if(!((f===1||h===1)&&c>UMe)&&u.isPacked&&d&&u.texture!=null&&l[2]%2!==0&&Zt(u.shape.slice(-3),l.slice(-3))){const x=l[0]*l[1]*(l[2]+1),w={dataId:e.dataId,shape:[1,x,n.inChannels],dtype:e.dtype},C=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,B(U5(u.shape,w.shape),()=>`packed reshape ${u.shape} to ${w.shape} isn't free`);const $=Fe({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});v.push($);const _=W5({a:w,b:$,backend:r,transposeA:p,transposeB:g,bias:i,activation:o,preluActivationWeights:s,leakyreluAlpha:a}),k=r.texData.get(_.dataId);B(k.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=C,k.shape=n.outShape,m=ol({inputs:{x:_},backend:r}),m.shape=n.outShape,v.push(_)}else{const x=n.outHeight*n.outWidth,w=Fe({inputs:{x:e},backend:r,attrs:{shape:d?[n.batchSize,x,n.inChannels]:[n.batchSize,n.inChannels,x]}}),C=Fe({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),$=W5({a:d?w:C,b:d?C:w,transposeA:!d,transposeB:g,backend:r,bias:i,activation:o,preluActivationWeights:s,leakyreluAlpha:a});m=Fe({inputs:{x:$},backend:r,attrs:{shape:n.outShape}}),v.push(w),v.push(C),v.push($)}for(const x of v)r.disposeIntermediateTensorInfo(x);return m}function KMe({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:o=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:f,outHeight:h,dataFormat:d}=n,p=d==="channelsLast",g=l*u*c,m=h*f,v=[n.batchSize,g,m],y=!0,b=!1,x=[];if(s!=null){const R=V5(s.shape,p);R!=null&&(s=Fe({inputs:{x:s},backend:r,attrs:{shape:R}}),x.push(s))}if(i!=null){const R=V5(i.shape,p);R!=null&&(i=Fe({inputs:{x:i},backend:r,attrs:{shape:R}}),x.push(i))}const w=Fe({inputs:{x:t},backend:r,attrs:{shape:[1,g,he(t.shape)/g]}});x.push(w);const C=new oDt(v,n),$=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],_=r.runWebGLProgram(C,[e],"float32",$),k=Fe({inputs:{x:_},backend:r,attrs:{shape:v}});x.push(_),x.push(k);const E=i!=null,S=s!=null,I=o==="leakyrelu",A=o?AT(o,!0):null,D=new zMe(p?k.shape:w.shape,p?w.shape:k.shape,p?[n.batchSize,m,n.outChannels]:[n.batchSize,n.outChannels,m],y,b,E,A,S,I),T=p?[k,w]:[w,k];if(i&&T.push(i),S&&T.push(s),I){const R=r.makeTensorInfo([],"float32",eg(a,"float32"));T.push(R),x.push(R)}const N=r.runWebGLProgram(D,T,"float32"),F=Fe({inputs:{x:N},backend:r,attrs:{shape:n.outShape}});x.push(N);for(const R of x)r.disposeIntermediateTensorInfo(R);return F}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=r,f=ng(l),h=Pi(i.shape,s.shape,a,u,o,c,!1,f);let d;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))d=XMe({x:i,filter:s,convInfo:h,backend:n});else if(h.strideWidth<=2&&f==="channelsLast"&&le().getBool("WEBGL_EXP_CONV")){const g=new YMe(h),m=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];d=n.runWebGLProgram(g,[i,s],"float32",m)}else if(le().getBool("WEBGL_CONV_IM2COL"))d=KMe({x:i,filter:s,convInfo:h,backend:n});else{const g=new GMe(h);d=n.runWebGLProgram(g,[i,s],"float32")}const p=Fe({inputs:{x:d},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(d),p}const uDt={kernelName:kI,backendName:"webgl",kernelFunc:lDt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cDt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,s=t.padInfo.left,a=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              ${a?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class fDt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,s=t.strideWidth,a=t.dataFormat==="channelsLast",o=n-1-t.padInfo.top,l=r-1-t.padInfo.left,u=a?1:2,c=a?2:3,f=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${a}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class hDt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideDepth,r=t.strideHeight,i=t.strideWidth,s=t.padInfo.front,a=t.padInfo.top,o=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${s};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${a};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${i} - ${o};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class dDt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterDepth,r=t.filterHeight,i=t.filterWidth,s=t.strideDepth,a=t.strideHeight,o=t.strideWidth,l=n-1-t.padInfo.front,u=r-1-t.padInfo.top,c=i-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${s}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${i}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${i} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:a,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,f=ng(l),h=Pi(i.shape,c,a,1,o,u,!1,f),d=new cDt(h);return n.runWebGLProgram(d,[i,s],"float32")}const gDt={kernelName:P8,backendName:"webgl",kernelFunc:pDt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mDt{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=Xs(this.outputShape.length);const n=t.filterHeight,r=t.filterWidth,i=n-1-t.padInfo.top,s=r-1-t.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vDt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{inputShape:a,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=r,f=ng(u),h=Pi(a,s.shape,o,1,l,c,!1,f);if(le().getBool("WEBGL_PACK")&&f==="channelsLast"){const d=[[h.strideHeight,h.strideWidth]],p=new mDt(h);return n.runWebGLProgram(p,[i,s],"float32",d)}else{const d=new fDt(h);return n.runWebGLProgram(d,[i,s],"float32")}}const yDt={kernelName:EI,backendName:"webgl",kernelFunc:vDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dilations:l}=r,u=zm(i.shape,s.shape,a,l,o),c=new aDt(u);return n.runWebGLProgram(c,[i,s],"float32")}const xDt={kernelName:AI,backendName:"webgl",kernelFunc:bDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:a,pad:o,filterShape:l}=r,u=zm(i.shape,l,a,1,o),c=new hDt(u);return n.runWebGLProgram(c,[i,s],"float32")}const $Dt={kernelName:L8,backendName:"webgl",kernelFunc:wDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CDt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{pad:a,strides:o,inputShape:l}=r,u=zm(l,s.shape,o,1,a),c=new dDt(u);return n.runWebGLProgram(c,[i,s],"float32")}const _Dt={kernelName:B8,backendName:"webgl",kernelFunc:CDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SDt=M_+`
  return cos(x);
`,kDt=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Qb}
  return result;
`,EDt=tn({opSnippet:SDt,packedOpSnippet:kDt}),ADt={kernelName:PC,backendName:"webgl",kernelFunc:EDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TDt=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,DDt=tn({opSnippet:TDt}),IDt={kernelName:LC,backendName:"webgl",kernelFunc:DDt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NDt{constructor(t,n,r,i,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,o,l,u]=t,[c]=n,[f,h]=r;this.outputShape=[c,f,h,u];const d=i==="bilinear"?1:0,[p,g]=[`${o-1}.0`,`${l-1}.0`],[m,v,y]=f>1?[`${(o-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,x,w]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${m});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${a}) {
          return;
        }

        float height_scale = ${v};
        float width_scale = ${x};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${s}));
          return;
        }
        float in_x = ${w};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${s}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${d} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MDt=e=>{const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:s,boxInd:a}=t,{cropSize:o,method:l,extrapolationValue:u}=r,c=new NDt(i.shape,s.shape,o,l,u);return n.runWebGLProgram(c,[i,s,a],"float32")},FDt={kernelName:U8,backendName:"webgl",kernelFunc:MDt};var DT;(function(e){e.Prod="*",e.Sum="+"})(DT||(DT={}));class b0e{constructor(t,n,r,i){this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const s=this.outputShape.length,a=this.op===DT.Prod?"1.0":"0.0",o=r?a:`getX(${x0e(s,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=i?`end != ${l-1}`:"end != 0",c=i?"end + 1":"end - 1"):(u=i?`end + pow2 < ${l}`:"end >= pow2",c=i?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${jn(s)} coords = getOutputCoords();
        int end = ${w0e(s,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${w0e(s,"coords",this.op)} = idx;
          val ${this.op}= getX(${x0e(s,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function x0e(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function w0e(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZMe(e,t,n,r,i,s){const a=t.shape.length,o=Fr([r],a);let l=t;o!=null&&(l=Ia({inputs:{x:t},backend:n,attrs:{perm:o}}));const u=Jr(1,a)[0];if(u!==a-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);const c=l.shape[u];let f=ol({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){const d=new b0e(e,l.shape,!1,s),p=[[h]],g=f;f=n.runWebGLProgram(d,[f],f.dtype,p),n.disposeIntermediateTensorInfo(g)}if(i){const h=new b0e(e,l.shape,i,s),d=f;f=n.runWebGLProgram(h,[f],f.dtype),n.disposeIntermediateTensorInfo(d)}if(o!=null){const h=Um(o),d=Ia({inputs:{x:f},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(l),d}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ODt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:a,reverse:o}=r;return ZMe(DT.Prod,i,n,s,a,o)}const RDt={kernelName:z8,backendName:"webgl",kernelFunc:ODt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:a,reverse:o}=r;return ZMe(DT.Sum,i,n,s,a,o)}const LDt={kernelName:TI,backendName:"webgl",kernelFunc:PDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:a,binaryOutput:o}=r;if(i.shape.length===1){const l=n.readSync(i.dataId),u=n.readSync(s.dataId),c=IMe(l,u,s.dtype,s.shape,a);return n.makeTensorInfo([a],s.dtype,c)}else if(i.shape.length===2){const l=n.bufferSync(i),u=n.bufferSync(s),c=VEt(l,u,a,o);return n.makeTensorInfo(c.shape,s.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const zDt={kernelName:W8,backendName:"webgl",kernelFunc:BDt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UDt{constructor(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:s,dataFormat:a}=r,o=i.shape[0],l=a==="NHWC"?i.shape[1]:i.shape[2],u=a==="NHWC"?i.shape[2]:i.shape[3],c=a==="NHWC"?i.shape[3]:i.shape[1],f=l*s,h=u*s,d=c/(s*s),p=a==="NHWC"?[o,f,h,d]:[o,d,f,h],g=new UDt(p,s,a);return n.runWebGLProgram(g,[i],i.dtype)}const VDt={kernelName:V8,backendName:"webgl",kernelFunc:WDt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QMe{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Xs(this.outputShape.length);const a=t.filterHeight,o=t.filterWidth,l=t.outChannels/t.inChannels;let u="",c="";r&&(i?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const f=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${a}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JMe{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Xs(this.outputShape.length);const a=t.outChannels/t.inChannels,o=t.padInfo.left,l=t.strideWidth,u=t.dilationWidth,c=t.filterHeight,f=t.filterWidth,h=f;let d=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<f;v++)d+=`
          vec4 xTexelC${v*2};
          int xTexelC${v*2}Ready;
          vec4 xTexelC${v*2+1};
          int xTexelC${v*2+1}Ready;
          vec4 xC${v};`;d+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let v=0;v<f;v++)d+=`
          xTexelC${v*2} = vec4(0.0);
          xTexelC${v*2}Ready = 0;
          xTexelC${v*2+1} = vec4(0.0);
          xTexelC${v*2+1}Ready = 0;
          xC${v} = vec4(0.0);`;d+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let v=0;v<(h+1)/2;v++){const y=v*2;if(d+=`
          xC = xCCorner + ${y*u};
          `,l===1){if(y<f&&(o%2===1?(d+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,u===1&&y>0?d+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:d+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):d+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<f)){const b=o%2===0?E8(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(d+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,u>1?d+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:d+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):b===1?d+=`
                    xC${y+1} = xTexelC${y};
                    `:d+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<f&&(o%2===1?(d+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<f&&(d+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(d+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<f&&(d+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<f&&(d+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<f&&(d+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}d+=`
    }
  `,d+=`
      }
    `;let p="",g="";r&&(i?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,g="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${a};
        int q = d2 - d1 * ${a};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${d}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${m}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),B(ms(a,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const f=Pi(i.shape,s.shape,a,c,o,u,!0);let h;le().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?h=new JMe(f):h=new QMe(f);const d=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return n.runWebGLProgram(h,[i,s],"float32",d)}const HDt={kernelName:DI,backendName:"webgl",kernelFunc:jDt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qDt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,s=t.padInfo.left,a=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${a} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class GDt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,s=t.strideWidth,a=n-1-t.padInfo.top,o=r-1-t.padInfo.left,l=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:a,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=r,f=Pi(i.shape,c,a,o,l,u,!0),h=new qDt(f);return n.runWebGLProgram(h,[i,s],"float32")}const XDt={kernelName:j8,backendName:"webgl",kernelFunc:YDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KDt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{strides:a,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=r,f=Pi(c,s.shape,a,o,l,u,!0),h=new GDt(f);return n.runWebGLProgram(h,[i,s],"float32")}const ZDt={kernelName:H8,backendName:"webgl",kernelFunc:KDt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QDt{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JDt(e){const{inputs:t,backend:n}=e,{x:r}=t,i=[...r.shape,...r.shape],s=he(r.shape),a=Fe({inputs:{x:r},backend:n,attrs:{shape:[s]}}),o=new QDt(s),l=n.runWebGLProgram(o,[a],a.dtype),u=Fe({inputs:{x:l},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const eIt={kernelName:q8,backendName:"webgl",kernelFunc:JDt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tIt{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:n,inWidth:r,padInfo:i,strideHeight:s,strideWidth:a,filterHeight:o,filterWidth:l,dilationHeight:u,dilationWidth:c}=t,{top:f,left:h}=i;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${a});
      const ivec2 pads = ivec2(${f}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nIt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:a,pad:o,dilations:l}=r,u=xN(i.shape,s.shape,a,o,"NHWC",l);let c;const f=new tIt(u);c=n.runWebGLProgram(f,[i,s],"float32");const h=Fe({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),h}const rIt={kernelName:II,backendName:"webgl",kernelFunc:nIt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iIt(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,s=t,{allDims:a,summedDims:o,idDims:l}=pne(i,s.length);mne(a.length,l,s);const{path:u,steps:c}=vne(o,l),f=c.length;let h=null,d=a.length;const p=[];for(let g=0;g<f;++g){for(const m of c[g]){const{permutationIndices:v,expandDims:y}=gne(d,l[m]);let b;yne(v)?b=s[m]:(b=Ia({inputs:{x:s[m]},backend:n,attrs:{perm:v}}),p.push(b));const x=b.shape.slice();for(let w=0;w<y.length;++w)x.splice(y[w],0,1);Zt(b.shape,x)||(b=Fe({inputs:{x:b},backend:n,attrs:{shape:x}}),p.push(b)),h===null?h=b:(h=ire({inputs:{a:b,b:h},backend:n}),p.push(h))}g<f-1&&(u[g]>=0&&(h=I7({inputs:{x:h},backend:n,attrs:{axis:u[g]-(a.length-d),keepDims:!1}}),p.push(h)),d--)}for(const g of p)g!==h&&n.disposeIntermediateTensorInfo(g);return h}const sIt={kernelName:Y8,backendName:"webgl",kernelFunc:iIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aIt="return (x >= 0.0) ? x : (exp(x) - 1.0);",oIt=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,lIt=tn({opSnippet:aIt,packedOpSnippet:oIt}),uIt={kernelName:zC,backendName:"webgl",kernelFunc:lIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cIt="return (b >= 0.0) ? a : a * (b + 1.0);",fIt=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,hIt=e=>{const{inputs:t,backend:n}=e,{dy:r,y:i}=t,s=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new N_(fIt,r.shape,i.shape):new Wy(cIt,r.shape,i.shape);return n.runWebGLProgram(s,[r,i],r.dtype)},dIt={kernelName:X8,backendName:"webgl",kernelFunc:hIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pIt=`
  return vec4(equal(a, b));
`,gIt="return float(a == b);",mIt=ys({opSnippet:gIt,packedOpSnippet:pIt,dtype:"bool",cpuKernelImpl:YEt}),vIt={kernelName:NI,backendName:"webgl",kernelFunc:mIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yIt=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${one};
  float a1 = ${lne};
  float a2 = ${une};
  float a3 = ${cne};
  float a4 = ${fne};
  float a5 = ${hne};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,bIt=tn({opSnippet:yIt}),xIt={kernelName:UC,backendName:"webgl",kernelFunc:bIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wIt=M_+`
  return exp(x);
`,$It=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,eFe=tn({opSnippet:wIt,packedOpSnippet:$It,cpuKernelImpl:XEt,dtype:"float32"}),CIt={kernelName:WC,backendName:"webgl",kernelFunc:eFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rX(e){const{inputs:t,attrs:n,backend:r}=e,{dim:i}=n,{input:s}=t,a=s.shape.length,o=s.shape.slice();let l=i;return i<0&&(B(-(a+1)<=i,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+i+1),o.splice(l,0,1),Fe({inputs:{x:s},backend:r,attrs:{shape:o}})}const _It={kernelName:MI,backendName:"webgl",kernelFunc:rX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $0e="return exp(x) - 1.0;",SIt=tn({opSnippet:$0e,packedOpSnippet:$0e,cpuKernelImpl:KEt}),kIt={kernelName:VC,backendName:"webgl",kernelFunc:SIt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C0e{constructor(t,n,r){this.variableNames=["real","imag"];const i=n[1];this.outputShape=n;const s=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,a=r?`${i}.0`:"1.0";let o;if(t==="real")o="return real * expR - imag * expI;";else if(t==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${s};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${i});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${i}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${a};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tFe(e,t,n){const r=n.texData.get(e.dataId),i=he(e.shape),s=e.shape[e.shape.length-1],a=i/s,o=Fe({inputs:{x:e},backend:n,attrs:{shape:[a,s]}}),l=o.shape,u=new C0e("real",l,t),c=new C0e("imag",l,t),f=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(u,f,"float32"),d=n.runWebGLProgram(c,f,"float32"),p=Gm({inputs:{real:h,imag:d},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d);const g=Fe({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(p),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EIt(e){const{inputs:t,backend:n}=e,{input:r}=t;return tFe(r,!1,n)}const AIt={kernelName:K8,backendName:"webgl",kernelFunc:EIt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TIt{constructor(t,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VN(e){const{backend:t,attrs:n}=e,{shape:r,value:i}=n;let{dtype:s}=n;if(s=s||Bb(i),s==="string"){const a=Br(s,he(r));return a.fill(i),t.makeTensorInfo(r,s,a)}else{const a=new TIt(r,i),o=[[i]];return t.runWebGLProgram(a,[],s,o)}}const DIt={kernelName:Z8,backendName:"webgl",kernelFunc:VN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IIt{constructor(t){this.variableNames=["Image"],this.outputShape=[];const n=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NIt={kernelName:Q8,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{const{image:n}=e,r=t,i=new IIt(n.shape);return r.runWebGLProgram(i,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _0e="return floor(x);",MIt=tn({opSnippet:_0e,packedOpSnippet:_0e,cpuKernelImpl:ZEt}),FIt={kernelName:jC,backendName:"webgl",kernelFunc:MIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OIt=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,RIt=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,PIt=ys({opSnippet:OIt,packedOpSnippet:RIt,dtype:"int32"}),LIt={kernelName:HC,backendName:"webgl",kernelFunc:PIt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BIt{constructor(t){this.variableNames=["A"];const n=Ra(),[r,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zIt{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Ra(),[r,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${i}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UIt={kernelName:x5,backendName:"webgl",kernelFunc:WIt};let t2,xj=le().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function WIt(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:i}=t;const{numChannels:s}=r,a=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,[l,u]=a?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=[u,l],f=[u,l,s];if(o||a){const g=le().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(t2==null||g!==xj)&&(xj=g,t2=document.createElement("canvas").getContext("2d",{willReadFrequently:xj})),t2.canvas.width=l,t2.canvas.height=u,t2.drawImage(i,0,0,l,u),i=t2.canvas}const h=n.makeTensorInfo(c,"int32");n.texData.get(h.dataId).usage=Il.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),i);const d=le().getBool("WEBGL_PACK")?new zIt(f):new BIt(f),p=n.runWebGLProgram(d,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VIt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:a,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r,g=ng(c),m=Pi(i.shape,s.shape,l,f,u,h,!1,g);let v;const y=[],b=a!=null,x=o!=null,w=d==="leakyrelu",C=()=>{const _=[i,s],k=(E,S)=>{if(S==="NCHW"&&E.shape.length===1&&E.shape[0]!==1){const I=Fe({inputs:{x:E},backend:n,attrs:{shape:[E.shape[0],1,1]}});return y.push(I),I}return E};if(b&&_.push(k(a,c)),x&&_.push(k(o,c)),w){const E=n.makeTensorInfo([],"float32",eg(p,"float32"));_.push(E),y.push(E)}return _};if(m.filterHeight===1&&m.filterWidth===1&&m.dilationHeight===1&&m.dilationWidth===1&&m.strideHeight===1&&m.strideWidth===1&&(m.padInfo.type==="SAME"||m.padInfo.type==="VALID"))v=XMe({x:i,filter:s,convInfo:m,backend:n,bias:a,activation:d,preluActivationWeights:o,leakyreluAlpha:p});else if(m.strideWidth<=2&&g==="channelsLast"&&le().getBool("WEBGL_EXP_CONV")){const _=d?AT(d,!0):null,k=new YMe(m,b,_,x,w),E=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],S=C();v=n.runWebGLProgram(k,S,"float32",E)}else if(le().getBool("WEBGL_CONV_IM2COL"))v=KMe({x:i,filter:s,convInfo:m,backend:n,bias:a,activation:d,preluActivationWeights:o,leakyreluAlpha:p});else{const _=d?AT(d,!1):null,k=new GMe(m,b,_,x,w),E=C();v=n.runWebGLProgram(k,E,"float32")}const $=Fe({inputs:{x:v},backend:n,attrs:{shape:m.outShape}});return y.push(v),y.forEach(_=>n.disposeIntermediateTensorInfo(_)),$}const jIt={kernelName:uT,backendName:"webgl",kernelFunc:VIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HIt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:a,preluActivationWeights:o}=t,{strides:l,pad:u,dilations:c,dimRoundingMode:f,activation:h,leakyreluAlpha:d}=r,p=[];let g=c;g==null&&(g=[1,1]),B(ms(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const m=Pi(i.shape,s.shape,l,g,u,f,!0),v=le().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1,y=h?AT(h,v):null,b=[i,s],x=a!=null,w=o!=null,C=h==="leakyrelu";if(x&&b.push(a),w&&b.push(o),C){const E=n.makeTensorInfo([],"float32",eg(d,"float32"));b.push(E),p.push(E)}let $;v?$=new JMe(m,x,y,w,C):$=new QMe(m,x,y,w,C);const _=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],k=n.runWebGLProgram($,b,"float32",_);return p.forEach(E=>n.disposeIntermediateTensorInfo(E)),k}const qIt={kernelName:cT,backendName:"webgl",kernelFunc:HIt};class GIt{constructor(t,n,r,i){this.sliceDim=t,this.strides=n,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=r;const s=jn(r.length);let a=`
    int index;`;for(let o=0;o<this.sliceDim;o++)a+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${s} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${a}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YIt(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,s=i.shape,a=s[s.length-1],o=he(r.shape),[l,u,c,f]=f7(r,i),h=Fe({inputs:{x:i},backend:n,attrs:{shape:[u,a]}}),d=Fe({inputs:{x:r},backend:n,attrs:{shape:[he(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const v=n.readSync(i.dataId),y=n.bufferSync(r),b=QEt(v,y,r.dtype,u,a,c,f,r.shape,o);return n.makeTensorInfo(l,r.dtype,b.values)}const p=new GIt(a,f,[u,c],r.shape),g=n.runWebGLProgram(p,[d,h],d.dtype),m=Fe({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(g),m}const XIt={kernelName:J8,backendName:"webgl",kernelFunc:YIt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KIt{constructor(t,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=jn(this.rank),i=ZIt(t);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${i}));
      }
    `}}function ZIt(e,t){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<e.length;i++)i===2?r.push("index"):r.push(`${n[i]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nFe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:s}=t,{axis:a,batchDims:o}=r,l=Ot(a,i.shape)[0];if(le().get("DEBUG")){const y=n.readSync(s.dataId),b=i.shape[l];for(let x=0;x<y.length;++x){const w=y[x];B(w<=b-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${b-1}]`)}}const u=xne(i,s,l,o),c=he(s.shape),f=[],h=Fe({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),d=Fe({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});f.push(h),f.push(d);const p=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([i,s])||i.dtype==="string"){const y=n.bufferSync(d),b=n.bufferSync(h),x=JEt(b,y,p);return f.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(u.outputShape,x.dtype,x.values)}const g=new KIt(h.shape,p),m=n.runWebGLProgram(g,[h,d],h.dtype);f.push(m);const v=Fe({inputs:{x:m},backend:n,attrs:{shape:u.outputShape}});return f.forEach(y=>n.disposeIntermediateTensorInfo(y)),v}const QIt={kernelName:OI,backendName:"webgl",kernelFunc:nFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JIt="return float(a > b);",eNt=`
  return vec4(greaterThan(a, b));
`,tNt=ys({opSnippet:JIt,packedOpSnippet:eNt,cpuKernelImpl:eAt,dtype:"bool"}),nNt={kernelName:RI,backendName:"webgl",kernelFunc:tNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rNt="return float(a >= b);",iNt=`
  return vec4(greaterThanEqual(a, b));
`,sNt=ys({opSnippet:rNt,packedOpSnippet:iNt,dtype:"bool",cpuKernelImpl:tAt}),aNt={kernelName:qC,backendName:"webgl",kernelFunc:sNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oNt(e){const{inputs:t,backend:n}=e,{input:r}=t;return tFe(r,!0,n)}const lNt={kernelName:ez,backendName:"webgl",kernelFunc:oNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uNt="return float(!isnan(x) && !isinf(x));",cNt=tn({opSnippet:uNt,dtype:"bool"}),fNt={kernelName:YC,backendName:"webgl",kernelFunc:cNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hNt="return float(isinf(x));",dNt=tn({opSnippet:hNt,dtype:"bool"}),pNt={kernelName:XC,backendName:"webgl",kernelFunc:dNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gNt="return float(isnan(x));",mNt=tn({opSnippet:gNt,dtype:"bool"}),vNt={kernelName:KC,backendName:"webgl",kernelFunc:mNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yNt="return float(a < b);",bNt=`
  return vec4(lessThan(a, b));
`,xNt=ys({opSnippet:yNt,packedOpSnippet:bNt,cpuKernelImpl:nAt,dtype:"bool"}),wNt={kernelName:LI,backendName:"webgl",kernelFunc:xNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Nt="return float(a <= b);",CNt=`
  return vec4(lessThanEqual(a, b));
`,_Nt=ys({opSnippet:$Nt,packedOpSnippet:CNt,cpuKernelImpl:rAt,dtype:"bool"}),SNt={kernelName:BI,backendName:"webgl",kernelFunc:_Nt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kNt(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:s}=n,a=iAt(r,i,s);return t.makeTensorInfo([a.length],"float32",a)}const ENt={kernelName:nz,backendName:"webgl",kernelFunc:kNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ANt=M_+`
  return x < 0.0 ? 0./0. : log(x);
`,TNt=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,DNt=tn({opSnippet:ANt,packedOpSnippet:TNt,cpuKernelImpl:sAt}),INt={kernelName:ZC,backendName:"webgl",kernelFunc:DNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NNt=M_+`
  return log(1.0 + x);
`,MNt=tn({opSnippet:NNt}),FNt={kernelName:QC,backendName:"webgl",kernelFunc:MNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ONt="return float(a >= 1.0 && b >= 1.0);",RNt=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,PNt=ys({opSnippet:ONt,packedOpSnippet:RNt,dtype:"bool"}),LNt={kernelName:zI,backendName:"webgl",kernelFunc:PNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BNt="return float(!(x >= 1.0));",zNt=tn({opSnippet:BNt}),UNt={kernelName:UI,backendName:"webgl",kernelFunc:zNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WNt="return float(a >= 1.0 || b >= 1.0);",VNt=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,jNt=ys({opSnippet:WNt,packedOpSnippet:VNt,dtype:"bool"}),HNt={kernelName:WI,backendName:"webgl",kernelFunc:jNt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qNt{constructor(t,n,r,i,s){this.variableNames=["x"],this.outputShape=[];const a=n,o=t[3]-1;this.outputShape=t;let l;const u=`float(${r}) + float(${i}) * sum`;s===.5?l=`inversesqrt(${u})`:s===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${a}; j <= ${a}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GNt{constructor(t,n,r,i,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=n,o=t[3]-1;this.outputShape=t;let l;const u=`float(${r}) + float(${i}) * sum`;s===.5?l=`inversesqrt(${u})`:s===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${a};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${a}; j <= ${a}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YNt=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:s,bias:a,alpha:o,beta:l}=r,u=le().getBool("WEBGL_PACK_NORMALIZATION")?new GNt(i.shape,s,a,o,l):new qNt(i.shape,s,a,o,l);return n.runWebGLProgram(u,[i],i.dtype)},XNt={kernelName:VI,backendName:"webgl",kernelFunc:YNt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KNt{constructor(t,n,r,i,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=i,this.beta=s,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${i}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${i})
                * float(${s})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${s});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZNt=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i,y:s,dy:a}=t,{depthRadius:o,bias:l,alpha:u,beta:c}=r,f=new KNt(i.shape,o,l,u,c);return n.runWebGLProgram(f,[i,s,a],i.dtype)},QNt={kernelName:rz,backendName:"webgl",kernelFunc:ZNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JNt(e,t,n,r){const i=he(t),a=he(e.shape)/i,o=Fe({inputs:{x:e},attrs:{shape:[a,i]},backend:r}),l=Jb(o,e.dtype,"max",r),u=Fe({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rFe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:s,keepDims:a}=r,o=i.shape.length,l=Ot(s,i.shape);let u=l;const c=Fr(u,o),f=c!=null,h=n.shouldExecuteOnCPU([i]);let d=i;if(f){if(h){const b=n.texData.get(d.dataId).values,x=new Array(o);for(let $=0;$<x.length;$++)x[$]=i.shape[c[$]];const w=nre(b,i.shape,i.dtype,c,x);d=n.makeTensorInfo(x,i.dtype);const C=n.texData.get(d.dataId);C.values=w}else d=D7(i,c,n);u=Jr(u.length,o)}vs("max",u,o);const[p,g]=Li(d.shape,u);let m=p;a&&(m=Zr(p,l));let v;if(h){const b=n.texData.get(d.dataId).values,x=aAt(b,he(g),m,i.dtype);v=n.makeTensorInfo(m,i.dtype);const w=n.texData.get(v.dataId);w.values=x}else v=JNt(d,g,m,n);return f&&n.disposeIntermediateTensorInfo(d),v}const eMt={kernelName:jI,backendName:"webgl",kernelFunc:rFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tMt=rre+`
  return max(a, b);
`,nMt=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Qb+`
  return result;
`,rMt=ys({opSnippet:tMt,packedOpSnippet:nMt,cpuKernelImpl:oAt}),iMt={kernelName:JC,backendName:"webgl",kernelFunc:rMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sMt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;zN(i,"maxPool");const{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=r,u=1;B(ms(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const c=Hu(i.shape,s,a,u,o,l);if(c.filterWidth===1&&c.filterHeight===1&&Zt(c.inShape,c.outShape))return ol({inputs:{x:i},backend:n});const f=new TT(c,"max",!1);return n.runWebGLProgram(f,[i],i.dtype)}const aMt={kernelName:HI,backendName:"webgl",kernelFunc:sMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oMt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:a,pad:o,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],f=tg(i.shape,s,a,c,o,u,l),h=new sre(f,"max",!1);return n.runWebGLProgram(h,[i],i.dtype)}const lMt={kernelName:qI,backendName:"webgl",kernelFunc:oMt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uMt{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideHeight,r=t.strideWidth,i=t.dilationHeight,s=t.effectiveFilterHeight,a=t.effectiveFilterWidth,o=s-1-t.padInfo.top,l=a-1-t.padInfo.left,u=s*a-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${s};
          wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${a}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${a} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class cMt{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideDepth,r=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,a=t.dilationHeight,o=t.dilationWidth,l=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,f=l-1-t.padInfo.front,h=u-1-t.padInfo.top,d=c-1-t.padInfo.left,p=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${h}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${s}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${a}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fMt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,a=s,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=r,f=[1,1,1],h=tg(a.shape,o,l,f,u,c),d=new sre(h,"max",!0),p=n.runWebGLProgram(d,[a],a.dtype),g=new cMt(h),m=n.runWebGLProgram(g,[i,p],a.dtype);return n.disposeIntermediateTensorInfo(p),m}const hMt={kernelName:sz,backendName:"webgl",kernelFunc:fMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dMt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s,output:a}=t,o=s;zN([s,a],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:f}=r,h=Hu(o.shape,l,u,1,c,f),d=!0,p=new TT(h,"max",d),g=n.runWebGLProgram(p,[o],o.dtype),m=new uMt(h),v=n.runWebGLProgram(m,[i,g],o.dtype);return n.disposeIntermediateTensorInfo(g),v}const pMt={kernelName:iz,backendName:"webgl",kernelFunc:dMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gMt(e,t,n,r){let i=new TT(n,"max",!1);const s=r.runWebGLProgram(i,[e],"float32");i=new TT(n,"max",!0,!0,t);const a=r.runWebGLProgram(i,[e],"float32");return[s,a]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mMt={kernelName:az,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{filterSize:i,strides:s,pad:a,includeBatchInIndex:o}=t,l=n;B(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];B(ms(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);const c=Hu(r.shape,i,s,u,a),[f,h]=gMt(r,o,c,l);return[f,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vMt(e,t,n,r){const i=he(t),a=he(e.shape)/i,o=Fe({inputs:{x:e},attrs:{shape:[a,i]},backend:r}),l=Jb(o,"float32","mean",r),u=Fe({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yMt={kernelName:GI,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{keepDims:i,axis:s}=t,a=n,o=r.shape.length,l=Ot(s,r.shape);let u=l;const c=Fr(u,o),f=c!=null,h=a.shouldExecuteOnCPU([r]),d=[];let p=r;if(f){if(h){const x=a.texData.get(p.dataId).values,w=new Array(o);for(let _=0;_<w.length;_++)w[_]=r.shape[c[_]];const C=nre(x,r.shape,r.dtype,c,w);p=a.makeTensorInfo(w,r.dtype);const $=a.texData.get(p.dataId);$.values=C}else p=D7(r,c,a);d.push(p),u=Jr(u.length,o)}vs("sum",u,o);const[g,m]=Li(p.shape,u);let v=g;i&&(v=Zr(g,l));const y=vMt(p,m,v,a);for(const b of d)a.disposeIntermediateTensorInfo(b);return y}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bMt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r,o=i.shape.length,l=Ot(s,i.shape);let u=l;const c=Fr(u,o);let f=i;c!=null&&(f=Ia({inputs:{x:i},backend:n,attrs:{perm:c}}),u=Jr(u.length,i.shape.length)),vs("min",u,o);const[h,d]=Li(f.shape,u),p=he(d),g=Fe({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),m=Jb(g,g.dtype,"min",n);let v;if(a){const y=Zr(h,l);v=Fe({inputs:{x:m},backend:n,attrs:{shape:y}})}else v=Fe({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),c!=null&&n.disposeIntermediateTensorInfo(f),v}const xMt={kernelName:YI,backendName:"webgl",kernelFunc:bMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wMt=rre+`
  return min(a, b);
`,$Mt=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Qb+`
  return result;
`,CMt=ys({opSnippet:wMt,packedOpSnippet:$Mt,cpuKernelImpl:lAt}),_Mt={kernelName:e_,backendName:"webgl",kernelFunc:CMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SMt{constructor(t,n,r){this.variableNames=["x"],this.outputShape=n.map((c,f)=>c[0]+t[f]+c[1]);const i=t.length,s=jn(i),a=n.map(c=>c[0]).join(","),o=n.map((c,f)=>c[0]+t[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),u=r==="reflect"?0:1;if(i===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${a});
      ${s} end = ${s}(${o});

      void main() {
        ${s} outC = getOutputCoords();
        for (int i = 0; i < ${i}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${s} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kMt{constructor(t,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,g)=>p[0]+t[g]+p[1]);const i=t.length,s=jn(i),a=n.map(p=>p[0]).join(","),o=n.map((p,g)=>p[0]+t[g]).join(","),l=pa("rc",i),u=pa("source",i),c=`${l[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${u.slice(-2).join()})`,h=r==="reflect"?0:1;let d="";if(i===1){const p=`
        ${s} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;d=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[i-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
      `}else{const p=`
        ${s} source = rc;
        ${s} lt = ${s}(lessThan(source, start));
        ${s} gte = ${s}(greaterThanEqual(source, end));
        ${s} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;d=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[i-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
        rc = outputLoc;
        ${l[i-2]} += 1;
        if(${l[i-2]} < ${this.outputShape[i-2]}) {
          ${p}
          result[2] = getChannel(getX(${u.join()}), ${f});
          ${l[i-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${u.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${s} start = ${s}(${a});
      const ${s} end = ${s}(${o});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${d}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EMt=({inputs:e,backend:t,attrs:n})=>{const{x:r}=e,{paddings:i,mode:s}=n,a=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new kMt(r.shape,i,s):new SMt(r.shape,i,s);return t.runWebGLProgram(a,[r],r.dtype)},AMt={kernelName:XI,backendName:"webgl",kernelFunc:EMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TMt=`if (b == 0.0) return NAN;
  return mod(a, b);`,DMt=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Qb+`
  return result;
`,IMt=ys({opSnippet:TMt,packedOpSnippet:DMt}),NMt={kernelName:t_,backendName:"webgl",kernelFunc:IMt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MMt{constructor(t,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FMt=`
if (a == b) {
  return 1.0;
};
return a / b;`,OMt=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,iFe=ys({opSnippet:FMt,packedOpSnippet:OMt,checkOutOfBounds:!0}),RMt={kernelName:BC,backendName:"webgl",kernelFunc:iFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S0e="return a - b;",sFe=ys({opSnippet:S0e,packedOpSnippet:S0e,supportsComplex:!0,cpuKernelImpl:TAt}),PMt={kernelName:v_,backendName:"webgl",kernelFunc:sFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aFe(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:s}=r,a=Ot([s],i.shape),o=rFe({inputs:{x:i},backend:n,attrs:{reductionIndices:a,keepDims:!1}}),l=Zr(o.shape,a),u=Fe({inputs:{x:o},backend:n,attrs:{shape:l}}),c=sFe({inputs:{a:i,b:u},backend:n}),f=eFe({inputs:{x:c},backend:n}),h=I7({inputs:{x:f},backend:n,attrs:{axis:a,keepDims:!1}}),d=Fe({inputs:{x:h},backend:n,attrs:{shape:l}}),p=iFe({inputs:{a:f,b:d},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),p}const LMt={kernelName:dN,backendName:"webgl",kernelFunc:aFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BMt(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:s,seed:a,normalized:o}=r,l=o?i:aFe({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),u=l.shape[0],c=l.shape[1],f=new MMt(u,c,s),h=[[a]],d=n.runWebGLProgram(f,[l],"int32",h);return o||n.disposeIntermediateTensorInfo(l),d}const zMt={kernelName:oz,backendName:"webgl",kernelFunc:BMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UMt=Gu+`
  return -x;
`,WMt=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function VMt(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const s=n.texData.get(r.dataId),[a,o]=cAt(s.values,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,a)}let i;return le().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new Yg(r.shape,WMt):i=new Jf(r.shape,UMt),n.runWebGLProgram(i,[r],r.dtype)}const jMt={kernelName:KI,backendName:"webgl",kernelFunc:VMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HMt=o7;function qMt(e){kl("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=r,u=n.readSync(i.dataId),c=n.readSync(s.dataId),{selectedIndices:f}=HMt(u,c,a,o,l);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const GMt={kernelName:lz,backendName:"webgl",kernelFunc:qMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YMt=l7;function XMt(e){kl("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(i.dataId),f=n.readSync(s.dataId),{selectedIndices:h,validOutputs:d}=YMt(c,f,a,o,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([d]))]}const KMt={kernelName:uz,backendName:"webgl",kernelFunc:XMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZMt=u7;function QMt(e){kl("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(i.dataId),f=n.readSync(s.dataId),h=a,d=o,p=l,g=u,{selectedIndices:m,selectedScores:v}=ZMt(c,f,h,d,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}const JMt={kernelName:cz,backendName:"webgl",kernelFunc:QMt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eFt{constructor(t,n,r,i){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${i}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tFt=e=>{const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:s,depth:a,onValue:o,offValue:l}=r,u=he(i.shape),c=new eFt(u,a,o,l),f=Fe({inputs:{x:i},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(c,[f],s);n.disposeIntermediateTensorInfo(f);const d=[...i.shape,a],p=Fe({inputs:{x:h},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(h),p},nFt={kernelName:JI,backendName:"webgl",kernelFunc:tFt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j5(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="complex64"){const i=WN({inputs:{input:r},backend:n}),s=j5({inputs:{x:i},backend:n}),a=N7({inputs:{input:r},backend:n}),o=j5({inputs:{x:a},backend:n}),l=Gm({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),l}else return VN({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const rFt={kernelName:vN,backendName:"webgl",kernelFunc:j5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oFe(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const i=WN({inputs:{input:r},backend:n}),s=oFe({inputs:{x:i},backend:n}),a=N7({inputs:{input:r},backend:n}),o=j5({inputs:{x:a},backend:n}),l=Gm({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),l}else return VN({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const iFt={kernelName:QI,backendName:"webgl",kernelFunc:oFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sFt(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return rX({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const s=t[0].shape,a=t[0].dtype;t.forEach(c=>{gs(s,c.shape,"All tensors passed to stack must have matching shapes"),B(a===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=t.map(c=>{const f=rX({inputs:{input:c},backend:n,attrs:{dim:i}});return o.push(f),f}),u=qMe({inputs:l,backend:n,attrs:{axis:i}});return o.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const aFt={kernelName:eN,backendName:"webgl",kernelFunc:sFt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oFt{constructor(t,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+t[c]+u[1]);const i=t.length,s=jn(i),a=n.map(u=>u[0]).join(","),o=n.map((u,c)=>u[0]+t[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);if(i===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${a});
      ${s} end = ${s}(${o});

      void main() {
        ${s} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${s} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lFt{constructor(t,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,m)=>g[0]+t[m]+g[1]);const i=t.length,s=jn(i),a=n.map(g=>g[0]).join(","),o=n.map((g,m)=>g[0]+t[m]).join(","),l=pa("rc",i),u=pa("source",i),c=`${l[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${u.slice(-2).join()})`,h=[`${s} rc = outputLoc;`,`${l[i-1]} += 1;
       if(${c}) {
      `,i===1?"":`}
       rc = outputLoc;
       ${l[i-2]} += 1;
       if(${l[i-2]} < ${this.outputShape[i-2]}) {`,i===1?"":`  ${l[i-1]} += 1;
         if(${c}) {`],d=i===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let g=0,m=i===1?2:4;g<m;g++)p+=`
        ${h[g]}
        if (${d}) {
          result[${g}] = float(value);
        } else {
          ${s} source = rc - start;
          result[${g}] = getChannel(getX(${u.join()}), ${f});
        }
      `;p+=i===1?"} ":"}}",this.userCode=`
      const ${s} start = ${s}(${a});
      const ${s} end = ${s}(${o});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lFe=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,constantValue:a}=r;if(he(i.shape)===0){const u=s.map((c,f)=>c[0]+i.shape[f]+c[1]);return VN({backend:n,attrs:{shape:u,value:a,dtype:i.dtype}})}const o=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new lFt(i.shape,s,a):new oFt(i.shape,s,a),l=[[a]];return n.runWebGLProgram(o,[i],i.dtype,l)},uFt={kernelName:tN,backendName:"webgl",kernelFunc:lFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cFt=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,fFt=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Qb+`
  return result;
`,hFt=ys({opSnippet:cFt,packedOpSnippet:fFt}),dFt={kernelName:r_,backendName:"webgl",kernelFunc:hFt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pFt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:a}=r,o=i.shape.length,l=[],u=Ot(s,i.shape);let c=u;const f=Fr(c,o);let h=i;f!=null&&(h=Ia({inputs:{x:i},backend:n,attrs:{perm:f}}),c=Jr(c.length,o),l.push(h)),vs("prod",c,o);let d;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:g,outShape:m,outDtype:v}=hAt(h.shape,h.dtype,p,c);d=n.makeTensorInfo(m,v,g)}else{const[p,g]=Li(h.shape,c),m=he(g),v=Fe({inputs:{x:h},backend:n,attrs:{shape:[-1,m]}}),y=Rz(i.dtype),b=Jb(v,y,"prod",n);d=Fe({inputs:{x:b},backend:n,attrs:{shape:p}}),l.push(v),l.push(b)}if(a){l.push(d);const p=Zr(d.shape,u);d=Fe({inputs:{x:d},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),d}const gFt={kernelName:rN,backendName:"webgl",kernelFunc:pFt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mFt(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:s,indices:a}=t,{outputRaggedRank:o}=r,l=i.map(v=>n.readSync(v.dataId)),u=i.map(v=>v.shape),c=n.readSync(s.dataId),f=n.readSync(a.dataId),[h,d,p]=dAt(l,u,c,s.shape,s.dtype,f,a.shape,o),g=h.map(v=>n.makeTensorInfo([v.length],"int32",v)),m=n.makeTensorInfo(p,s.dtype,d);return g.concat([m])}const vFt={kernelName:fz,backendName:"webgl",kernelFunc:mFt};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yFt(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:s}=t,a=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(s.dataId),[u,c]=pAt(a,r.shape,r.dtype,o,i.shape,l,s.shape),f=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([c.length],r.dtype,c);return[f,h]}const bFt={kernelName:hz,backendName:"webgl",kernelFunc:yFt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xFt(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:s,defaultValue:a,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,u=n.readSync(i.dataId),c=n.readSync(s.dataId),f=n.readSync(a.dataId),h=o.map(m=>n.readSync(m.dataId)),d=o.map(m=>m.shape),[p,g]=gAt(u,i.shape,c,s.shape,s.dtype,f,a.shape,h,d,l);return n.makeTensorInfo(p,s.dtype,g)}const wFt={kernelName:dz,backendName:"webgl",kernelFunc:xFt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uFe=e=>{const{backend:t,attrs:n}=e,{start:r,stop:i,step:s,dtype:a}=n,o=mAt(r,i,s,a);return t.makeTensorInfo([o.length],a,o)},$Ft={kernelName:pz,backendName:"webgl",kernelFunc:uFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CFt="return 1.0 / x;",_Ft=tn({opSnippet:CFt}),SFt={kernelName:i_,backendName:"webgl",kernelFunc:_Ft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kFt=Gu+`
  return (x < 0.0) ? 0.0 : x;
`,EFt=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,AFt=tn({opSnippet:kFt,packedOpSnippet:EFt}),TFt={kernelName:s_,backendName:"webgl",kernelFunc:AFt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DFt=Gu+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,IFt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,NFt=tn({opSnippet:DFt,packedOpSnippet:IFt}),MFt={kernelName:a_,backendName:"webgl",kernelFunc:NFt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FFt{constructor(t,n,r,i,s){this.variableNames=["A"],this.outputShape=[];const[a,o,l,u]=t;this.outputShape=[a,n,r,u];const c=[i&&n>1?o-1:o,i&&r>1?l-1:l],f=[i&&n>1?n-1:n,i&&r>1?r-1:r];let h;s?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OFt{constructor(t,n,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,l,u]=t;this.outputShape=[a,n,r,u];const c=[i&&n>1?o-1:o,i&&r>1?l-1:l],f=[i&&n>1?n-1:n,i&&r>1?r-1:r];let h;s?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RFt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:a,size:o}=r,[l,u]=o,c=le().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new OFt(i.shape,l,u,s,a):new FFt(i.shape,l,u,s,a);return n.runWebGLProgram(c,[i],"float32")}const PFt={kernelName:aN,backendName:"webgl",kernelFunc:RFt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LFt{constructor(t,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,s]=n,[,a,o]=t,l=[r&&a>1?i-1:i,r&&o>1?s-1:s],u=[r&&a>1?a-1:a,r&&o>1?o-1:o],c=l[0]/u[0],f=l[1]/u[1],h=1/c,d=1/f,p=Math.ceil(h)*2+2,g=Math.ceil(d)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${d});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BFt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:a}=r,o=new LFt(s.shape,i.shape,a);return n.runWebGLProgram(o,[s],s.dtype)}const zFt={kernelName:vz,backendName:"webgl",kernelFunc:BFt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UFt{constructor(t,n,r,i,s){this.variableNames=["A"],this.outputShape=[];const[a,o,l,u]=t;this.outputShape=[a,n,r,u];const c=[i&&n>1?o-1:o,i&&r>1?l-1:l],f=[i&&n>1?n-1:n,i&&r>1?r-1:r],h=i?"0.5":"0.0";let d;s?d="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WFt{constructor(t,n,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,l,u]=t;this.outputShape=[a,n,r,u];const c=[i&&n>1?o-1:o,i&&r>1?l-1:l],f=[i&&n>1?n-1:n,i&&r>1?r-1:r],h=i?"0.5":"0.0";let d;s?d="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VFt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:a,size:o}=r,[l,u]=o,c=le().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new WFt(i.shape,l,u,s,a):new UFt(i.shape,l,u,s,a);return n.runWebGLProgram(c,[i],i.dtype)}const jFt={kernelName:sN,backendName:"webgl",kernelFunc:VFt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HFt{constructor(t,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,s]=n,[,a,o]=t,l=[r&&a>1?i-1:i,r&&o>1?s-1:s],u=[r&&a>1?a-1:a,r&&o>1?o-1:o],c=l[0]/u[0],f=l[1]/u[1],h=1/c,d=1/f,p=Math.ceil(h)*2+2,g=Math.ceil(d)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${d});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qFt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:a}=r,o=new HFt(s.shape,i.shape,a);return n.runWebGLProgram(o,[s],s.dtype)}const GFt={kernelName:mz,backendName:"webgl",kernelFunc:qFt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YFt{constructor(t,n){this.variableNames=["x"];const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=t,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}const i=o=>n.indexOf(o)!==-1&&t[o]!==1?`${t[o]} - coords[${o}] - 1`:`coords[${o}]`,s=t.map((o,l)=>i(l)).join(","),a=jn(r);this.userCode=`
      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XFt{constructor(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=t;const i=pa("rc",r),s=`${i[r-1]} + 1 < ${this.outputShape[r-1]}`,a=`${i[r-2]} + 1 < ${this.outputShape[r-2]}`,o=jn(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${s}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(i.slice())};
          if(${s}){
            result.g = ${u(i.slice())};
          }
          if(${a}) {
            result.b = ${c(i.slice())};
            if(${s}) {
              result.a = ${f(i.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function u(p){return p[r-1]="("+p[r-1]+" + 1)",h(p)}function c(p){return p[r-2]="("+p[r-2]+" + 1)",h(p)}function f(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",h(p)}function h(p){const g=t.map((y,b)=>d(b,p)),m=g.join(","),v=g.slice(-2).join(",");return`getChannel(getX(${m}), vec2(${v}))`}function d(p,g){return n.indexOf(p)!==-1&&t[p]!==1?`${t[p]} - ${g[p]} - 1`:`${g[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KFt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:s}=r,a=i.shape.length,o=Ot(s,i.shape);if(a===0)return ol({inputs:{x:i},backend:n});const l=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new XFt(i.shape,o):new YFt(i.shape,o);return n.runWebGLProgram(l,[i],i.dtype)}const ZFt={kernelName:oN,backendName:"webgl",kernelFunc:KFt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QFt{constructor(t,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=t[1],i=t[2];this.outputShape=t;let s="";typeof n=="number"?s=`float outputValue = ${n.toFixed(2)};`:s=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${s}
          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JFt={kernelName:Fz,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,{radians:i,fillValue:s,center:a}=t,o=n,l=new QFt(r.shape,s),[u,c]=ine(a,r.shape[1],r.shape[2]),f=[[u,c,Math.sin(i),Math.cos(i)]];return o.runWebGLProgram(l,[r],r.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eOt=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,tOt=tn({opSnippet:eOt}),nOt={kernelName:o_,backendName:"webgl",kernelFunc:tOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rOt="return inversesqrt(x);",iOt=tn({opSnippet:rOt,cpuKernelImpl:vAt}),sOt={kernelName:l_,backendName:"webgl",kernelFunc:iOt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class are{constructor(t,n,r,i,s,a,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const u=jn(s.length),c=jn(a.length);let f="";r===1?f="i":r===2&&(f="i, j");const h=`getIndices(${f})`;let d="";i===1?d="i":i===2&&(d="i, coords[1]");const p=`getUpdates(${d})`;let g="";l&&(g="coords[0], coords[1]");const m=`getDefaultValue(${g})`,v=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${s});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${v};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${m}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aOt{constructor(t,n,r,i,s,a,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;const u=jn(s.length),c=jn(a.length);let f="";r===1?f="i":r===2&&(f="i, j");const h=`getIndices(${f})`;let d="";i===1?d="i":i===2&&(d="i, coords[1]");const p=`getUpdates(${d})`;let g="";l&&(g="coords[0], coords[1]");const m=`getDefaultValue(${g})`,v=n>1?"strides[j]":"strides",y=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${s});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${t}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${v};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${m}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oOt(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:s}=t,{shape:a}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=jm(s,i,a),h=[f/u,u];if(f===0)return n.makeTensorInfo(a,i.dtype);const d=Fe({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),p=Fe({inputs:{x:s},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let m;le().getBool("WEBGL_PACK")?m=new aOt(l,o,d.shape.length,p.shape.length,c,h):m=new are(l,o,d.shape.length,p.shape.length,c,h);const v=n.runWebGLProgram(m,[p,d,g],p.dtype),y=Fe({inputs:{x:v},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),y}const lOt={kernelName:yz,backendName:"webgl",kernelFunc:oOt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uOt{constructor(t,n,r,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];const s="while (left < right) {",a=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,o=le().getNumber("WEBGL_VERSION")===2?s:a,l=i==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cOt(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:s}=t,{side:a}=r,o=new uOt(i.shape[0],i.shape[1],s.shape[1],a),l=[[i.shape[1]]];return n.runWebGLProgram(o,[i,s],"int32",l)}const fOt={kernelName:xz,backendName:"webgl",kernelFunc:cOt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hOt{constructor(t,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let i,s;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)s="resRC",i="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${o[c]}`),c<t&&l.push(`${o[c]}`);i=l.join(),s=u.join()}const a=jn(r);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        float cVal = getC(${i});
        if (cVal >= 1.0) {
          setOutput(getA(${s}));
        } else {
          setOutput(getB(${s}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dOt(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:s}=t,a=new hOt(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(a,[r,i,s],fo(i.dtype,s.dtype))}const pOt={kernelName:lN,backendName:"webgl",kernelFunc:dOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gOt=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${p7};
  float scale = ${g7};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,mOt=tn({opSnippet:gOt}),vOt={kernelName:u_,backendName:"webgl",kernelFunc:mOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yOt=M_+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,bOt=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,xOt=tn({opSnippet:yOt,packedOpSnippet:bOt,cpuKernelImpl:bAt}),wOt={kernelName:d_,backendName:"webgl",kernelFunc:xOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ot=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,COt=tn({opSnippet:$Ot}),_Ot={kernelName:h_,backendName:"webgl",kernelFunc:COt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SOt=M_+`
  return sin(x);
`,kOt=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Qb}
  return result;
`,EOt=tn({opSnippet:SOt,packedOpSnippet:kOt}),AOt={kernelName:c_,backendName:"webgl",kernelFunc:EOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TOt=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,DOt=tn({opSnippet:TOt}),IOt={kernelName:f_,backendName:"webgl",kernelFunc:DOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NOt=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,MOt=tn({opSnippet:NOt}),FOt={kernelName:p_,backendName:"webgl",kernelFunc:MOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OOt=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,paddings:a}=r;B(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=s.reduce((v,y)=>v*y),l=[[0,0]];l.push(...a);for(let v=1+s.length;v<i.shape.length;++v)l.push([0,0]);const u=[],c=lFe({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),f=EN(c.shape,s,o,!1),h=AN(f.length,s.length,!1),d=TN(c.shape,s,o,!1),p=Fe({inputs:{x:c},backend:n,attrs:{shape:f}}),g=Ia({inputs:{x:p},backend:n,attrs:{perm:h}}),m=Fe({inputs:{x:g},backend:n,attrs:{shape:d}});return u.push(c),u.push(p),u.push(g),u.forEach(v=>n.disposeIntermediateTensorInfo(v)),m},ROt={kernelName:fN,backendName:"webgl",kernelFunc:OOt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function POt(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:s,defaultValue:a}=t;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${i.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=n.readSync(r.dataId),l=n.readSync(i.dataId),u=n.readSync(s.dataId),c=n.readSync(a.dataId)[0],[f,h,d,p,g]=wAt(o,r.shape,r.dtype,l,i.dtype,u,c);return[n.makeTensorInfo(h,r.dtype,f),n.makeTensorInfo([h[0]],i.dtype,d),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const LOt={kernelName:wz,backendName:"webgl",kernelFunc:POt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BOt(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:s}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const a=Array.from(n.readSync(i.dataId)),o=n.readSync(r.dataId),l=Array.from(n.readSync(s.dataId)),[u,c,f]=$At(o,r.shape,r.dtype,a,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([f.length],s.dtype,new Int32Array(f))]}const zOt={kernelName:$z,backendName:"webgl",kernelFunc:BOt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UOt(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${s.shape}`);const a=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(s.dataId),[u,c]=MMe(a,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const WOt={kernelName:Cz,backendName:"webgl",kernelFunc:UOt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VOt(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${s.shape}`);const a=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(s.dataId),[u,c]=MMe(a,r.shape,r.dtype,o,l);return n.makeTensorInfo(c,r.dtype,u)}const jOt={kernelName:_z,backendName:"webgl",kernelFunc:VOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HOt(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:s,defaultValue:a}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:f,outputSize:h}=jm(s,i,o),d=!1;if(s.dtype==="string"){const v=n.bufferSync(i),y=n.bufferSync(s),b=Ip(n.readSync(a.dataId)[0]),x=yAt(v,y,o,h,c,u,l,f,b,d);return n.makeTensorInfo(o,x.dtype,x.values)}const p=new are(u,l,i.shape.length,s.shape.length,f,[h,1],d),g=n.runWebGLProgram(p,[s,i,a],s.dtype),m=Fe({inputs:{x:g},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(g),m}const qOt={kernelName:Sz,backendName:"webgl",kernelFunc:HOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GOt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:s,axis:a}=r,o=Ot(a,i.shape)[0],l=bne(i,s,o),u=i.shape.length,c=new Array(u).fill(0),f=i.shape.slice();return l.map(h=>{const d=[...f];d[o]=h;const p=F_({inputs:{x:i},backend:n,attrs:{begin:c,size:d}});return c[o]+=h,p})}const YOt={kernelName:hN,backendName:"webgl",kernelFunc:GOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k0e="return sqrt(x);",XOt=tn({opSnippet:k0e,packedOpSnippet:k0e,cpuKernelImpl:CAt}),KOt={kernelName:g_,backendName:"webgl",kernelFunc:XOt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZOt="return x * x;",QOt=tn({opSnippet:ZOt}),JOt={kernelName:kz,backendName:"webgl",kernelFunc:QOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E0e="return (a - b) * (a - b);",eRt=ys({opSnippet:E0e,packedOpSnippet:E0e}),tRt={kernelName:m_,backendName:"webgl",kernelFunc:eRt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nRt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");const s=n.readSync(i.dataId),a=Fp(s),o=_At(a,"string",r);return n.makeTensorInfo(i.shape,"string",o)}const rRt={kernelName:pN,backendName:"webgl",kernelFunc:nRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iRt({inputs:e,attrs:t,backend:n}){const{x:r}=e,i=Gu+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,s=new Jf(r.shape,i);return n.runWebGLProgram(s,[r],r.dtype)}const sRt={kernelName:w_,backendName:"webgl",kernelFunc:iRt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aRt{constructor(t,n,r){this.variableNames=["x"],this.outputShape=r;const i=r.length,s=jn(r.length),a=jn(r.length);let o="";if(i===1)o="coords * strides + begin";else{let l=0;o=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${s} begin = ${s}(${t});
      ${s} strides = ${s}(${n});

      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oRt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,end:a,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:h}=r,{finalShapeSparse:d,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:v,begin:y,end:b,strides:x}=ene(i.shape,s,a,o,l,u,c,f,h);let w;if(g)w=Fe({inputs:{x:i},backend:n,attrs:{shape:p}});else if(m||v){B(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const $=Zte(y,b,x),_=F_({inputs:{x:i},backend:n,attrs:{begin:y,size:$}});w=Fe({inputs:{x:_},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(_)}else if(n.shouldExecuteOnCPU([i])){const _=n.readSync(i.dataId),k=Mt(i.shape,i.dtype,_),E=SAt(d,k,x,y);w=n.makeTensorInfo(p,i.dtype,E.values)}else{const _=new aRt(y,x,d);w=n.runWebGLProgram(_,[i],i.dtype)}const C=Fe({inputs:{x:w},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(w),C}const lRt={kernelName:Ez,backendName:"webgl",kernelFunc:oRt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uRt(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:s,leftPad:a,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:f}=t,h=n.readSync(c.dataId),d=n.readSync(f.dataId),[p,g]=kAt(h,d,i,s,a,o,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(f.shape,"int32",g)]}const cRt={kernelName:Az,backendName:"webgl",kernelFunc:uRt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fRt(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:s,delimiter:a}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=n.readSync(s.dataId),l=n.readSync(a.dataId)[0],[u,c,f]=EAt(o,l,i),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const hRt={kernelName:Tz,backendName:"webgl",kernelFunc:fRt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dRt(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:s}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const a=n.readSync(s.dataId),o=AAt(a,i);return n.makeTensorInfo(s.shape,"int32",o)}const pRt={kernelName:Dz,backendName:"webgl",kernelFunc:dRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gRt="return tan(x);",mRt=tn({opSnippet:gRt}),vRt={kernelName:y_,backendName:"webgl",kernelFunc:mRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yRt=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,bRt=tn({opSnippet:yRt}),xRt={kernelName:b_,backendName:"webgl",kernelFunc:bRt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wRt(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:i,indices:s,updates:a}=t,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=jm(a,s,i.shape),h=[f/u,u];if(f===0)return n.makeTensorInfo(i.shape,s.dtype);const d=Fe({inputs:{x:s},backend:n,attrs:{shape:[l,o]}}),p=Fe({inputs:{x:a},backend:n,attrs:{shape:[l,u]}}),g=Fe({inputs:{x:i},backend:n,attrs:{shape:h}}),m=new are(l,o,d.shape.length,p.shape.length,c,h,!1,!0),v=n.runWebGLProgram(m,[p,d,g],g.dtype),y=Fe({inputs:{x:v},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),y}const $Rt={kernelName:bz,backendName:"webgl",kernelFunc:wRt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CRt{constructor(t,n){this.variableNames=["A"];const r=new Array(t.length);for(let a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;const i=jn(this.rank),s=_Rt(t);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        setOutput(getA(${s}));
      }
    `}}function _Rt(e){const t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<e.length;i++)r.push(`imod(${n[i]}, ${e[i]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cFe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:s}=r;if(i.dtype==="string"||i.shape.length>5){const l=n.readSync(i.dataId),u=i.dtype==="string"?l.map(h=>Ip(h)):l,c=Mt(i.shape,i.dtype,u),f=DAt(c,s);return n.makeTensorInfo(f.shape,f.dtype,f.values)}const a=new CRt(i.shape,s);return n.runWebGLProgram(a,[i],i.dtype)}const SRt={kernelName:x_,backendName:"webgl",kernelFunc:cFe};class kRt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class ERt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kv(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function A0e(e){let t=1;for(;t<e;)t*=2;return t}function ARt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:s,sorted:a}=r,o=le().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=le().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=i.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([i])||c<o||s>l){const E=n.readSync(i.dataId),[S,I]=IAt(E,u,i.dtype,s,a);return[n.makeTensorInfo(S.shape,S.dtype,S.values),n.makeTensorInfo(I.shape,I.dtype,I.values)]}if(s===0)return u[u.length-1]=0,[n.makeTensorInfo(u,i.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[i,VN({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const f=n.texData.get(i.dataId),h=f!==null&&f.isPacked,d=h?n.unpackTensor(i):i,g=he(u)/c,m=Fe({inputs:{x:d},attrs:{shape:[g,c]},backend:n});h&&kv(n,d);const v=A0e(s),y=A0e(c);let b=null;const x=()=>b===null?[m,m]:[m,b],w=(E,S,I)=>{const A=x(),D=new kRt(I),N=[[c],[b===null?1:0],[Number.NEGATIVE_INFINITY],[E],[S]],F=b;b=n.runWebGLProgram(D,A,"int32",N),kv(n,F)};for(let E=1;E<v;E*=2){const S=E*2;for(let I=E;I>=1;I/=2)w(S,I,[g,y])}for(let E=y;E>v;E/=2){const S=x(),I=new ERt([g,E/2]),D=[[c],[b===null?1:0],[v]],T=b;b=n.runWebGLProgram(I,S,"int32",D),kv(n,T);const N=v/2,F=N*2;for(let R=N;R>=1;R/=2)w(F,R,b.shape)}let C=b;b=F_({inputs:{x:b},backend:n,attrs:{begin:0,size:[g,s]}}),kv(n,C);let $=nFe({inputs:{x:m,indices:b},backend:n,attrs:{axis:1,batchDims:1}});kv(n,m);const _=u.slice(0,-1);_.push(s),C=b,b=Fe({inputs:{x:b},attrs:{shape:_},backend:n}),kv(n,C);const k=$;return $=Fe({inputs:{x:$},attrs:{shape:_},backend:n}),kv(n,k),[$,b]}const TRt={kernelName:Iz,backendName:"webgl",kernelFunc:ARt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DRt{constructor(t,n,r,i,s,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const o=r==="nearest"?1:2;let l;switch(i){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${s});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${s});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${t}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IRt(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,transforms:s}=t,{interpolation:a,fillMode:o,fillValue:l,outputShape:u}=r,[c,f,h,d]=i.shape,[p,g]=u!=null?u:[f,h],m=[c,p,g,d],v=new DRt(f,h,a,o,l,m);return n.runWebGLProgram(v,[i,s],"float32")}const NRt={kernelName:Nz,backendName:"webgl",kernelFunc:IRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MRt(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:s}=t;zN(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=r.readSync(s.dataId),{outputValues:o,outputShape:l,indices:u}=NAt(a,i,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}const FRt={kernelName:Mz,backendName:"webgl",kernelFunc:MRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ORt(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const a=i,o=a.shape.length,l=i.shape[s],u=new Array(o-1);let c=0;for(let g=0;g<o;g++)g!==s&&(u[c++]=a.shape[g]);const f=[],h=new Array(o).fill(0),d=a.shape.slice();d[s]=1;const p=new Array(l);for(let g=0;g<p.length;g++){h[s]=g;const m=F_({inputs:{x:a},backend:n,attrs:{begin:h,size:d}}),v=Fe({inputs:{x:m},backend:n,attrs:{shape:u}});p[g]=v,f.push(m)}return f.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const RRt={kernelName:gN,backendName:"webgl",kernelFunc:ORt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PRt{constructor(t,n){this.variableNames=["x","segmentIds"];const r=t.windowSize,i=t.batchSize,s=t.inSize,a=t.numSegments,o=a*Math.ceil(s/r);this.outputShape=[i,o];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,f=r%4,h=`
        sumValue += dot(values, segFilter);
    `;let d="";s%r>0&&(d=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `);let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${a})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${a})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LRt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:s}=t,{numSegments:a}=r,o=i.shape.length,l=[];let u=0;const c=Fr([u],o);let f=i;c!=null&&(f=Ia({inputs:{x:i},backend:n,attrs:{perm:c}}),l.push(f),u=Jr(1,o)[0]);const h=q3e(f.shape,u,a),d=he([f.shape[u]]),p=Fe({inputs:{x:f},backend:n,attrs:{shape:[-1,d]}});l.push(p);const g=Rz(i.dtype),m=(x,w,C,$,_)=>{const k=x.shape[0],E=x.shape[1],S=H3e(E,_),I={windowSize:S,inSize:E,batchSize:k,numSegments:_},A=new PRt(I,w),D=n.compileAndRun(A,[x,C],$);if(l.push(D),D.shape[1]===_)return D;const T=uFe({backend:n,attrs:{start:0,stop:_,step:1,dtype:"float32"}}),N=cFe({inputs:{x:T},backend:n,attrs:{reps:[E/S]}});return l.push(T),l.push(N),m(D,w,N,$,_)},v=m(p,"unsortedSegmentSum",s,g,a),y=Fe({inputs:{x:v},backend:n,attrs:{shape:h}});let b=y;if(c!=null){l.push(y);const x=Um(c);b=Ia({inputs:{x:b},backend:n,attrs:{perm:x}})}return l.forEach(x=>n.disposeIntermediateTensorInfo(x)),b}const BRt={kernelName:mN,backendName:"webgl",kernelFunc:LRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zRt=[CTt,STt,ATt,ITt,MTt,RTt,LTt,zTt,jTt,qTt,XTt,QTt,t3t,s3t,l3t,c3t,h3t,m3t,y3t,x3t,_3t,I3t,M3t,P3t,B3t,H3t,G3t,Z3t,aTt,eDt,sDt,uDt,gDt,yDt,xDt,$Dt,_Dt,ADt,IDt,FDt,RDt,LDt,zDt,VDt,HDt,XDt,ZDt,eIt,rIt,sIt,uIt,dIt,vIt,xIt,CIt,_It,kIt,AIt,DIt,NIt,FIt,LIt,UIt,jIt,qIt,XIt,QIt,nNt,aNt,sTt,lNt,rDt,fNt,pNt,vNt,lTt,wNt,SNt,ENt,INt,FNt,LNt,UNt,HNt,XNt,QNt,eMt,iMt,aMt,lMt,hMt,pMt,mMt,yMt,xMt,_Mt,AMt,NMt,zMt,fTt,jMt,GMt,KMt,JMt,U3t,nFt,iFt,aFt,uFt,dFt,cTt,gFt,vFt,bFt,wFt,$Ft,W3t,RMt,SFt,TFt,MFt,dTt,PFt,zFt,jFt,GFt,ZFt,JFt,nOt,sOt,lOt,fOt,pOt,vOt,wOt,_Ot,AOt,IOt,T3t,LMt,FOt,ROt,LOt,zOt,WOt,jOt,qOt,YOt,KOt,JOt,tRt,rRt,sRt,lRt,cRt,hRt,pRt,PMt,xTt,vRt,xRt,$Rt,SRt,TRt,NRt,wTt,FRt,RRt,BRt,rFt];for(const e of zRt)Oz(e);/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var URt=Object.defineProperty,WRt=Object.getOwnPropertyDescriptor,jN=(e,t,n,r)=>{for(var i=r>1?void 0:r?WRt(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&URt(t,n,i),i};let Vy=class extends St{connectedCallback(){super.connectedCallback();const e=new CustomEvent("network-created",{detail:this,bubbles:!0,composed:!0});this.dispatchEvent(e),this.renderRoot.addEventListener("layer-updated-neurons",t=>{const n=t.detail,r=Array.from(this.networkConf.layerConnections.keys()).filter(([i,s])=>i==n||s==n);for(const i of r)this.networkConf.layerConnections.get(i).requestUpdate()})}getLayerById(e){return this.networkConf.layers.get(e)}getInputLayers(){return Array.from(this.networkConf.layers.values()).filter(e=>e instanceof Us)}getOutputLayer(){return Array.from(this.networkConf.layers.values()).find(e=>e instanceof Qo)}getFreshId(){return this.networkConf.layers.size?Math.max(...this.networkConf.layers.keys())+1:1}addInputLayer({activation:e=null,pos:t=null,alert:n=!0}={}){const r=this.dataSet.getNonAssignedInputKeys();if(!r.length)return ja({message:"A new input layer could not be created! All input data was assigned to an input layer. If you want to have multiple input layers, unassign some data from another input layer first!",variant:"warning",icon:"x-circle"}),null;t||(t={...this.canvas.generatePos()});const i=this.getFreshId(),s=document.createElement("input-layer");return s.layerId=i,s.activation=e,s.pos=t,s.dataSetKeys=r,s.alert=n,s.addEventListener("query-layer-deletion",a=>{console.log(a.target),this.handleQueryLayerDeletion(a.target)}),this.networkConf.addLayer(s),s}addDenseLayer({units:e=2,activation:t="None",pos:n=null,alert:r=!0}={}){n||(n={...this.canvas.generatePos()});const i=this.getFreshId(),s=document.createElement("dense-layer");return s.layerId=i,s.units=e,s.activation=t,s.pos=n,s.alert=r,this.networkConf.addLayer(s),s}addOutputLayer({activation:e="None",pos:t=null,alert:n=!0}={}){const r=this.dataSet.getNonAssignedLabelKey();if(!r)return ja({message:"A new output layer could not be created! Multi-output models are currently not supported!",variant:"warning",icon:"x-circle"}),null;t||(t={...this.canvas.generatePos()});const i=this.getFreshId(),s=document.createElement("output-layer");return s.layerId=i,s.activation=e,s.pos=t,s.dataSetLabel=this.dataSet.getLabelByKey(r),s.alert=n,this.networkConf.addLayer(s),s}duplicateLayer(e){e instanceof Us?ja({message:`Cannot duplicate '${e.getName()}' since each data item can only be assigned to one input neuron. if you wish to have multiple input layers, create a new input layer!`,variant:"warning",icon:"x-circle"}):e instanceof Qo&&ja({message:`Cannot duplicate '${e.getName()}'! Only one output layer is allowed, multi-output models are not supported!`,variant:"warning",icon:"x-circle"});const t=e.cloneNode(!0),n=this.getFreshId(),r=this.canvas.getHeight(e.getCyId()),i={x:e.pos.x,y:e.pos.y-r-this.canvas.LAYER_DISTANCE};t.layerId=n,t.pos=i,this.networkConf.addLayer(t),ja({message:`${e.getName()} has been duplicated!`,variant:"success",icon:"check-circle"})}addLayerConnection(e,t){const n=document.createElement("c-layer-connection");n.sourceLayer=e,n.targetLayer=t,this.networkConf.addLayerConnection(n)}removeLayerConnection(e,t){this.networkConf.removeLayerConnection([e.layerId,t.layerId])}removeLayer(e){for(const[t,n]of this.networkConf.layerConnections.entries())(n.sourceLayer==e||n.targetLayer==e)&&(console.log("removing connection"),console.log(t),this.networkConf.removeLayerConnection(t),console.log(this.networkConf.layerConnections));if(e instanceof Us)for(const t of e.dataSetKeys)this.dataSet.unassignKey(t);e instanceof Qo&&this.dataSet.unassignKey(e.dataSetLabel.key),this.networkConf.removeLayer(e.layerId),this.selected.select()}handleDataSetChange(){if(this.dataSet){let e=`The data set has been set to '${this.dataSet.name}'!`;this.getInputLayers().length>=2&&(e+=" All inputs of this dataSet were assigned to the first input layer - all other input layers were deleted!"),ja({message:e,variant:"success",icon:"check-circle"});for(let n=0;n<this.getInputLayers().length;n++)n==0?this.getInputLayers()[n].dataSetKeys=this.dataSet.getNonAssignedInputKeys():this.removeLayer(this.getInputLayers()[n]);const t=this.getOutputLayer();t&&(t.dataSetLabel=this.dataSet.getLabelByKey(this.dataSet.getNonAssignedLabelKey()))}}buildModel(){return ixt({inputs:null,outputs:null})}handleQueryLayerDeletion(e){this.removeLayer(e)}render(){return de` ${Array.from(this.networkConf.layers.values())}
    ${Array.from(this.networkConf.layerConnections.values())}`}};Vy.styles=[kt];jN([En({context:Om,subscribe:!0})],Vy.prototype,"canvas",2);jN([En({context:Qp,subscribe:!0})],Vy.prototype,"networkConf",2);jN([En({context:Rm,subscribe:!0})],Vy.prototype,"dataSet",2);jN([En({context:kC,subscribe:!0})],Vy.prototype,"selected",2);Vy=jN([Ue("c-network")],Vy);var VRt=Object.defineProperty,jRt=Object.getOwnPropertyDescriptor,HRt=(e,t,n,r)=>{for(var i=r>1?void 0:r?jRt(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&VRt(t,n,i),i};let iX=class extends St{render(){return de`
      <c-card>
        <div slot="title">Welcome :)</div>
        <div slot="content">
          Your network is currently empty - select an option below to get
          started! You can also find these and a few more options (like for
          building your network from scratch) in the right menu under the tab
          'network'.
        </div>
      </c-card>
    `}};iX.styles=[kt];iX=HRt([Ue("canvas-info-card")],iX);var qRt=Object.defineProperty,GRt=Object.getOwnPropertyDescriptor,M7=(e,t,n,r)=>{for(var i=r>1?void 0:r?GRt(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&qRt(t,n,i),i};let jw=class extends St{_handleImport(){}_handleExport(){}async _handleClear(){this.dispatchEvent(new CustomEvent("clear-network",{bubbles:!0,composed:!0}));let e;this.dataSet.name?e=await q2.getDataSetByName(this.dataSet.name):e=await q2.getDataSetByName(q2.getOptions()[0]);const t=new CustomEvent("change-data-set",{detail:e,bubbles:!0,composed:!0});this.dispatchEvent(t)}async _handleCreateFeedForwardNetwork(e){await this._handleClear();const t=this.networkConf.network.addInputLayer({pos:{x:0,y:0},alert:!1}),n=this.networkConf.network.addDenseLayer({units:5,pos:{x:0,y:-300},alert:!1}),r=this.networkConf.network.addDenseLayer({pos:{x:-350,y:-600},alert:!1}),i=this.networkConf.network.addDenseLayer({units:3,pos:{x:300,y:-600},alert:!1}),s=this.networkConf.network.addOutputLayer({pos:{x:0,y:-900},alert:!1});setTimeout(()=>{this.networkConf.network.addLayerConnection(t,n),this.networkConf.network.addLayerConnection(n,r),this.networkConf.network.addLayerConnection(n,i),this.networkConf.network.addLayerConnection(r,s),this.networkConf.network.addLayerConnection(i,s),this.canvas.fit(),console.log(this.networkConf.layerConnections)},50),ja({message:"A new feed forward network has been created!",variant:"success",icon:"check-circle"})}render(){return de`
      <c-card>
        <div slot="title">Get started</div>
        <div slot="content">
          <c-button-group>
            <sl-button
              @click="${e=>{this._handleImport()}}"
            >
              <sl-icon slot="prefix" name="file-earmark-arrow-up"></sl-icon>
              Import
            </sl-button>
            <sl-button
              @click="${e=>{this._handleExport()}}"
            >
              <sl-icon slot="prefix" name="file-earmark-arrow-down"></sl-icon>
              Export
            </sl-button>
            <sl-button
              @click="${e=>{this._handleClear()}}"
            >
              <sl-icon slot="prefix" name="file-earmark-arrow-up"></sl-icon>
              Clear
            </sl-button>
          </c-button-group>
          <sl-button
            variant="primary"
            @click="${e=>{this._handleCreateFeedForwardNetwork()}}"
          >
            <sl-icon slot="prefix" name="file-earmark-plus"></sl-icon>
            Create feed forward network
          </sl-button>
        </div>
      </c-card>
    `}};jw.styles=[kt];M7([En({context:Om,subscribe:!0})],jw.prototype,"canvas",2);M7([En({context:Qp,subscribe:!0})],jw.prototype,"networkConf",2);M7([En({context:Rm,subscribe:!0})],jw.prototype,"dataSet",2);jw=M7([Ue("get-started-card")],jw);var YRt=Object.defineProperty,XRt=Object.getOwnPropertyDescriptor,F7=(e,t,n,r)=>{for(var i=r>1?void 0:r?XRt(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&YRt(t,n,i),i};let Hw=class extends St{async connectedCallback(){super.connectedCallback(),await this.updateComplete,this.dispatchEvent(new CustomEvent("canvas-created",{detail:this._canvasElm,bubbles:!0,composed:!0}))}_handleZoomIn(){this.canvas.zoomIn()}_handleCenter(){this.canvas.fit()}_handleZoomOut(){this.canvas.zoomOut()}render(){return de`
      <div id="canvasElm"></div>
      ${this.networkConf.layers.size?de``:de`
            <c-panel id="welcomeArea">
              <canvas-info-card></canvas-info-card>
              <get-started-card></get-started-card>
            </c-panel>
          `}
      <div id="canvasActions">
        <sl-tooltip content="Zoom in">
          <sl-button
            @click="${e=>this._handleZoomIn()}"
            circle
          >
            <sl-icon name="zoom-in"></sl-icon>
          </sl-button>
        </sl-tooltip>
        <sl-tooltip content="Zoom to network">
          <sl-button
            @click="${e=>this._handleCenter()}"
            circle
          >
            <sl-icon name="arrows-collapse"></sl-icon>
          </sl-button>
        </sl-tooltip>
        <sl-tooltip content="Zoom out">
          <sl-button
            @click="${e=>this._handleZoomOut()}"
            circle
          >
            <sl-icon name="zoom-out"></sl-icon>
          </sl-button>
        </sl-tooltip>
      </div>
    `}};Hw.styles=[kt,Qt`
      :host {
        position: relative;
      }

      #canvasElm {
        height: 100%;
        width: 100%;
        display: flex;
        align-items: center;
      }

      #welcomeArea {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
      }

      #canvasActions {
        position: absolute;
        bottom: 10px;
        right: 10px;
        display: grid;
        gap: 10px;
      }
    `];F7([gt("#canvasElm")],Hw.prototype,"_canvasElm",2);F7([En({context:Qp,subscribe:!0})],Hw.prototype,"networkConf",2);F7([En({context:Om,subscribe:!0})],Hw.prototype,"canvas",2);Hw=F7([Ue("canvas-area")],Hw);var KRt=Object.defineProperty,ZRt=Object.getOwnPropertyDescriptor,QRt=(e,t,n,r)=>{for(var i=r>1?void 0:r?ZRt(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&KRt(t,n,i),i};let sX=class extends St{render(){return de`
      <c-card>
        <div slot="title">Settings</div>
        <div slot="content">
          <p>
            Configure which options the users of this widget are allowed to view
            and edit
          </p>
          <h2>Network</h2>
          <sl-switch checked
            >Allow creating / changing the network topology using the 'quick
            setup' options</sl-switch
          >
          <sl-switch checked
            >Allow manual adding and removing of layers</sl-switch
          >
          <h2>DataSet</h2>
          <h2>Training</h2>
        </div>
      </c-card>
    `}};sX.styles=[kt];sX=QRt([Ue("settings-card")],sX);var JRt=Object.defineProperty,e4t=Object.getOwnPropertyDescriptor,t4t=(e,t,n,r)=>{for(var i=r>1?void 0:r?e4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&JRt(t,n,i),i};let aX=class extends St{render(){return de`
      <c-panel name="settings">
        <settings-card></settings-card>
      </c-panel>
    `}};aX.styles=[kt];aX=t4t([Ue("settings-panel")],aX);var n4t=Object.defineProperty,r4t=Object.getOwnPropertyDescriptor,i4t=(e,t,n,r)=>{for(var i=r>1?void 0:r?r4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&n4t(t,n,i),i};let oX=class extends St{render(){return de`
      <c-card>
        <div slot="title">Info</div>
        <div slot="content">
          Build your network by adding layers or choose a quick setup option
          below. Select layers in the graph to edit their properties and connect
          them with other layers.
        </div>
      </c-card>
    `}};oX.styles=[kt];oX=i4t([Ue("network-info-card")],oX);var s4t=Object.defineProperty,a4t=Object.getOwnPropertyDescriptor,fFe=(e,t,n,r)=>{for(var i=r>1?void 0:r?a4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&s4t(t,n,i),i};let H5=class extends St{_handleAddInputLayer(){this.networkConf.network.addInputLayer()}_handleAddDenseLayer(){this.networkConf.network.addDenseLayer()}_handleAddOutputLayer(){this.networkConf.network.addOutputLayer()}render(){return de`
      <c-card>
        <div slot="title">Add layer</div>
        <div slot="content">
          <c-button-group>
            <sl-button
              @click="${e=>this._handleAddInputLayer()}"
            >
              <sl-icon slot="prefix" name="plus-lg"></sl-icon>
              Input
            </sl-button>
            <sl-button
              @click="${e=>this._handleAddDenseLayer()}"
            >
              <sl-icon slot="prefix" name="plus-lg"></sl-icon>
              Dense
            </sl-button>
            <sl-button
              @click="${e=>this._handleAddOutputLayer()}"
            >
              <sl-icon slot="prefix" name="plus-lg"></sl-icon>
              Output
            </sl-button>
          </c-button-group>
        </div>
      </c-card>
    `}};H5.styles=[kt];fFe([En({context:Qp,subscribe:!0})],H5.prototype,"networkConf",2);H5=fFe([Ue("network-add-layer-card")],H5);var o4t=Object.defineProperty,l4t=Object.getOwnPropertyDescriptor,u4t=(e,t,n,r)=>{for(var i=r>1?void 0:r?l4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&o4t(t,n,i),i};let lX=class extends St{render(){return de`
      <c-panel name="network">
        <network-info-card></network-info-card>
        <get-started-card></get-started-card>
        <network-add-layer-card> </network-add-layer-card>
      </c-panel>
    `}};lX.styles=[kt];lX=u4t([Ue("network-panel")],lX);var c4t=Object.defineProperty,f4t=Object.getOwnPropertyDescriptor,hFe=(e,t,n,r)=>{for(var i=r>1?void 0:r?f4t(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&c4t(t,n,i),i};let q5=class extends St{_handleSelectDataProperty(e){this.dispatchEvent(new CustomEvent("clicked-data-property",{detail:e.key}))}render(){return de`
      <c-card>
        <div slot="title">Info</div>
        <div slot="content">
          <div>
            <p>${this.dataSet.description}</p>
            <h2>Inputs</h2>
            <div class="data-pills">
              ${this.dataSet.inputs.map(e=>de`
                  <c-data-info
                    .dataProperty="${e}"
                    class="clickable"
                    @click="${t=>this._handleSelectDataProperty(e)}"
                  ></c-data-info>
                `)}
            </div>
            <h2>Output</h2>
            <div class="data-pills">
              <c-data-info .dataProperty="${this.dataSet.label}"></c-data-info>
            </div>
          </div>
        </div>
      </c-card>
    `}};q5.styles=[kt,Qt`
      .data-pills {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        gap: 5px;
      }

      .clickable:hover {
        cursor: pointer;
      }
    `];hFe([J()],q5.prototype,"dataSet",2);q5=hFe([Ue("data-set-info-card")],q5);var dFe={};const pFe=Fb(Svt);var ore={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var h4t=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),d4t=Object.prototype.hasOwnProperty;function uX(e,t){return d4t.call(e,t)}function cX(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)uX(e,i)&&r.push(i);return r}function Nl(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function fX(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function Yv(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function gFe(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function hX(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(hX(e[t]))return!0}else if(typeof e=="object"){for(var r=cX(e),i=r.length,s=0;s<i;s++)if(hX(e[r[s]]))return!0}}return!1}function T0e(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var mFe=function(e){h4t(t,e);function t(n,r,i,s,a){var o=this.constructor,l=e.call(this,T0e(n,{name:r,index:i,operation:s,tree:a}))||this;return l.name=r,l.index=i,l.operation=s,l.tree=a,Object.setPrototypeOf(l,o.prototype),l.message=T0e(n,{name:r,index:i,operation:s,tree:a}),l}return t}(Error),Hr=mFe,p4t=Nl,N2={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=G5(n,this.path);r&&(r=Nl(r));var i=ey(n,{op:"remove",path:this.from}).removed;return ey(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=G5(n,this.from);return ey(n,{op:"add",path:this.path,value:Nl(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:IT(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},g4t={add:function(e,t,n){return fX(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:N2.move,copy:N2.copy,test:N2.test,_get:N2._get};function G5(e,t){if(t=="")return e;var n={op:"_get",path:t};return ey(e,n),n.value}function ey(e,t,n,r,i,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):Y5(t,0)),t.path===""){var a={newDocument:e};if(t.op==="add")return a.newDocument=t.value,a;if(t.op==="replace")return a.newDocument=t.value,a.removed=e,a;if(t.op==="move"||t.op==="copy")return a.newDocument=G5(e,t.from),t.op==="move"&&(a.removed=e),a;if(t.op==="test"){if(a.test=IT(e,t.value),a.test===!1)throw new Hr("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return a.newDocument=e,a}else{if(t.op==="remove")return a.removed=e,a.newDocument=null,a;if(t.op==="_get")return t.value=e,a;if(n)throw new Hr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return a}}else{r||(e=Nl(e));var o=t.path||"",l=o.split("/"),u=e,c=1,f=l.length,h=void 0,d=void 0,p=void 0;for(typeof n=="function"?p=n:p=Y5;;){if(d=l[c],d&&d.indexOf("~")!=-1&&(d=gFe(d)),i&&(d=="__proto__"||d=="prototype"&&c>0&&l[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&h===void 0&&(u[d]===void 0?h=l.slice(0,c).join("/"):c==f-1&&(h=t.path),h!==void 0&&p(t,0,e,h)),c++,Array.isArray(u)){if(d==="-")d=u.length;else{if(n&&!fX(d))throw new Hr("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);fX(d)&&(d=~~d)}if(c>=f){if(n&&t.op==="add"&&d>u.length)throw new Hr("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var a=g4t[t.op].call(t,u,d,e);if(a.test===!1)throw new Hr("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return a}}else if(c>=f){var a=N2[t.op].call(t,u,d,e);if(a.test===!1)throw new Hr("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return a}if(u=u[d],n&&c<f&&(!u||typeof u!="object"))throw new Hr("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function O7(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new Hr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Nl(e));for(var s=new Array(t.length),a=0,o=t.length;a<o;a++)s[a]=ey(e,t[a],n,!0,i,a),e=s[a].newDocument;return s.newDocument=e,s}function m4t(e,t,n){var r=ey(e,t);if(r.test===!1)throw new Hr("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function Y5(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Hr("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(N2[e.op]){if(typeof e.path!="string")throw new Hr("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Hr('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Hr("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Hr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&hX(e.value))throw new Hr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new Hr("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Hr("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var a={op:"_get",path:e.from,value:void 0},o=vFe([a],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new Hr("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Hr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function vFe(e,t,n){try{if(!Array.isArray(e))throw new Hr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)O7(Nl(t),Nl(e),n||!0);else{n=n||Y5;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof Hr)return i;throw i}}function IT(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,s,a;if(n&&r){if(s=e.length,s!=t.length)return!1;for(i=s;i--!==0;)if(!IT(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var o=Object.keys(e);if(s=o.length,s!==Object.keys(t).length)return!1;for(i=s;i--!==0;)if(!t.hasOwnProperty(o[i]))return!1;for(i=s;i--!==0;)if(a=o[i],!IT(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}const v4t=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:Hr,deepClone:p4t,getValueByPointer:G5,applyOperation:ey,applyPatch:O7,applyReducer:m4t,validator:Y5,validate:vFe,_areEquals:IT},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var lre=new WeakMap,y4t=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),b4t=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function x4t(e){return lre.get(e)}function w4t(e,t){return e.observers.get(t)}function $4t(e,t){e.observers.delete(t.callback)}function C4t(e,t){t.unobserve()}function _4t(e,t){var n=[],r,i=x4t(e);if(!i)i=new y4t(e),lre.set(e,i);else{var s=w4t(i,t);r=s&&s.observer}if(r)return r;if(r={},i.value=Nl(e),t){r.callback=t,r.next=null;var a=function(){dX(r)},o=function(){clearTimeout(r.next),r.next=setTimeout(a)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return r.patches=n,r.object=e,r.unobserve=function(){dX(r),clearTimeout(r.next),$4t(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},i.observers.set(t,new b4t(t,r)),r}function dX(e,t){t===void 0&&(t=!1);var n=lre.get(e.object);ure(n.value,e.object,e.patches,"",t),e.patches.length&&O7(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function ure(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=cX(t),a=cX(e),o=!1,l=a.length-1;l>=0;l--){var u=a[l],c=e[u];if(uX(t,u)&&!(t[u]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[u];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?ure(c,f,n,r+"/"+Yv(u),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+Yv(u),value:Nl(c)}),n.push({op:"replace",path:r+"/"+Yv(u),value:Nl(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+Yv(u),value:Nl(c)}),n.push({op:"remove",path:r+"/"+Yv(u)}),o=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!o&&s.length==a.length))for(var l=0;l<s.length;l++){var u=s[l];!uX(e,u)&&t[u]!==void 0&&n.push({op:"add",path:r+"/"+Yv(u),value:Nl(t[u])})}}}function S4t(e,t,n){n===void 0&&(n=!1);var r=[];return ure(e,t,r,"",n),r}const k4t=Object.freeze(Object.defineProperty({__proto__:null,unobserve:C4t,observe:_4t,generate:dX,compare:S4t},Symbol.toStringTag,{value:"Module"}));Object.assign({},v4t,k4t,{JsonPatchError:mFe,deepClone:Nl,escapePathComponent:Yv,unescapePathComponent:gFe});var E4t=/("(?:[^\\"]|\\.)*")|[:,]/g,wj=function(t,n){var r,i,s;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,s=n.replacer,function a(o,l,u){var c,f,h,d,p,g,m,v,y,b,x,w;if(o&&typeof o.toJSON=="function"&&(o=o.toJSON()),x=JSON.stringify(o,s),x===void 0)return x;if(m=i-l.length-u,x.length<=m&&(y=x.replace(E4t,function(C,$){return $||C+" "}),y.length<=m))return y;if(s!=null&&(o=JSON.parse(x),s=void 0),typeof o=="object"&&o!==null){if(v=l+r,h=[],f=0,Array.isArray(o))for(b="[",c="]",m=o.length;f<m;f++)h.push(a(o[f],v,f===m-1?0:1)||"null");else for(b="{",c="}",g=Object.keys(o),m=g.length;f<m;f++)d=g[f],p=JSON.stringify(d)+": ",w=a(o[d],v,p.length+(f===m-1?0:1)),w!==void 0&&h.push(p+w);if(h.length>0)return[b,r+h.join(`,
`+v),c].join(`
`+l)}return x}(t,"",0)},jy={exports:{}};const A4t="2.0.0",yFe=256,T4t=Number.MAX_SAFE_INTEGER||9007199254740991,D4t=16,I4t=yFe-6,N4t=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var R7={MAX_LENGTH:yFe,MAX_SAFE_COMPONENT_LENGTH:D4t,MAX_SAFE_BUILD_LENGTH:I4t,MAX_SAFE_INTEGER:T4t,RELEASE_TYPES:N4t,SEMVER_SPEC_VERSION:A4t,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const M4t=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var P7=M4t;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=R7,s=P7;t=e.exports={};const a=t.re=[],o=t.safeRe=[],l=t.src=[],u=t.t={};let c=0;const f="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",i],[f,r]],d=g=>{for(const[m,v]of h)g=g.split(`${m}*`).join(`${m}{0,${v}}`).split(`${m}+`).join(`${m}{1,${v}}`);return g},p=(g,m,v)=>{const y=d(m),b=c++;s(g,b,m),u[g]=b,l[b]=m,a[b]=new RegExp(m,v?"g":void 0),o[b]=new RegExp(y,v?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),p("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${l[u.NUMERICIDENTIFIER]}|${l[u.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NUMERICIDENTIFIERLOOSE]}|${l[u.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${f}+`),p("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),p("FULL",`^${l[u.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),p("LOOSE",`^${l[u.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),p("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),p("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),p("COERCERTL",l[u.COERCE],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(jy,jy.exports);const F4t=Object.freeze({loose:!0}),O4t=Object.freeze({}),R4t=e=>e?typeof e!="object"?F4t:e:O4t;var cre=R4t;const D0e=/^[0-9]+$/,bFe=(e,t)=>{const n=D0e.test(e),r=D0e.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},P4t=(e,t)=>bFe(t,e);var xFe={compareIdentifiers:bFe,rcompareIdentifiers:P4t};const hO=P7,{MAX_LENGTH:I0e,MAX_SAFE_INTEGER:dO}=R7,{safeRe:N0e,t:M0e}=jy.exports,L4t=cre,{compareIdentifiers:n2}=xFe;class uc{constructor(t,n){if(n=L4t(n),t instanceof uc){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>I0e)throw new TypeError(`version is longer than ${I0e} characters`);hO("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?N0e[M0e.LOOSE]:N0e[M0e.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>dO||this.major<0)throw new TypeError("Invalid major version");if(this.minor>dO||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>dO||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const s=+i;if(s>=0&&s<dO)return s}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(hO("SemVer.compare",this.version,this.options,t),!(t instanceof uc)){if(typeof t=="string"&&t===this.version)return 0;t=new uc(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof uc||(t=new uc(t,this.options)),n2(this.major,t.major)||n2(this.minor,t.minor)||n2(this.patch,t.patch)}comparePre(t){if(t instanceof uc||(t=new uc(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(hO("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return n2(r,i)}while(++n)}compareBuild(t){t instanceof uc||(t=new uc(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(hO("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return n2(r,i)}while(++n)}inc(t,n,r){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(r)?1:0;if(!n&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(n===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(n){let s=[n,i];r===!1&&(s=[n]),n2(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}var ko=uc;const F0e=ko,B4t=(e,t,n=!1)=>{if(e instanceof F0e)return e;try{return new F0e(e,t)}catch(r){if(!n)return null;throw r}};var O_=B4t;const z4t=O_,U4t=(e,t)=>{const n=z4t(e,t);return n?n.version:null};var W4t=U4t;const V4t=O_,j4t=(e,t)=>{const n=V4t(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var H4t=j4t;const O0e=ko,q4t=(e,t,n,r,i)=>{typeof n=="string"&&(i=r,r=n,n=void 0);try{return new O0e(e instanceof O0e?e.version:e,n).inc(t,r,i).version}catch{return null}};var G4t=q4t;const R0e=O_,Y4t=(e,t)=>{const n=R0e(e,null,!0),r=R0e(t,null,!0),i=n.compare(r);if(i===0)return null;const s=i>0,a=s?n:r,o=s?r:n,l=!!a.prerelease.length;if(!!o.prerelease.length&&!l)return!o.patch&&!o.minor?"major":a.patch?"patch":a.minor?"minor":"major";const c=l?"pre":"";return n.major!==r.major?c+"major":n.minor!==r.minor?c+"minor":n.patch!==r.patch?c+"patch":"prerelease"};var X4t=Y4t;const K4t=ko,Z4t=(e,t)=>new K4t(e,t).major;var Q4t=Z4t;const J4t=ko,e5t=(e,t)=>new J4t(e,t).minor;var t5t=e5t;const n5t=ko,r5t=(e,t)=>new n5t(e,t).patch;var i5t=r5t;const s5t=O_,a5t=(e,t)=>{const n=s5t(e,t);return n&&n.prerelease.length?n.prerelease:null};var o5t=a5t;const P0e=ko,l5t=(e,t,n)=>new P0e(e,n).compare(new P0e(t,n));var ff=l5t;const u5t=ff,c5t=(e,t,n)=>u5t(t,e,n);var f5t=c5t;const h5t=ff,d5t=(e,t)=>h5t(e,t,!0);var p5t=d5t;const L0e=ko,g5t=(e,t,n)=>{const r=new L0e(e,n),i=new L0e(t,n);return r.compare(i)||r.compareBuild(i)};var fre=g5t;const m5t=fre,v5t=(e,t)=>e.sort((n,r)=>m5t(n,r,t));var y5t=v5t;const b5t=fre,x5t=(e,t)=>e.sort((n,r)=>b5t(r,n,t));var w5t=x5t;const $5t=ff,C5t=(e,t,n)=>$5t(e,t,n)>0;var L7=C5t;const _5t=ff,S5t=(e,t,n)=>_5t(e,t,n)<0;var hre=S5t;const k5t=ff,E5t=(e,t,n)=>k5t(e,t,n)===0;var wFe=E5t;const A5t=ff,T5t=(e,t,n)=>A5t(e,t,n)!==0;var $Fe=T5t;const D5t=ff,I5t=(e,t,n)=>D5t(e,t,n)>=0;var dre=I5t;const N5t=ff,M5t=(e,t,n)=>N5t(e,t,n)<=0;var pre=M5t;const F5t=wFe,O5t=$Fe,R5t=L7,P5t=dre,L5t=hre,B5t=pre,z5t=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return F5t(e,n,r);case"!=":return O5t(e,n,r);case">":return R5t(e,n,r);case">=":return P5t(e,n,r);case"<":return L5t(e,n,r);case"<=":return B5t(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var CFe=z5t;const U5t=ko,W5t=O_,{safeRe:pO,t:gO}=jy.exports,V5t=(e,t)=>{if(e instanceof U5t)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(pO[gO.COERCE]);else{let r;for(;(r=pO[gO.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||r.index+r[0].length!==n.index+n[0].length)&&(n=r),pO[gO.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;pO[gO.COERCERTL].lastIndex=-1}return n===null?null:W5t(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var j5t=V5t,$j,B0e;function H5t(){return B0e||(B0e=1,$j=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}),$j}var q5t=xn;xn.Node=Hy;xn.create=xn;function xn(e){var t=this;if(t instanceof xn||(t=new xn),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}xn.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};xn.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};xn.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};xn.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)Y5t(this,arguments[e]);return this.length};xn.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)X5t(this,arguments[e]);return this.length};xn.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};xn.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};xn.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next};xn.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev};xn.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};xn.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};xn.prototype.map=function(e,t){t=t||this;for(var n=new xn,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n};xn.prototype.mapReverse=function(e,t){t=t||this;for(var n=new xn,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n};xn.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=e(n,r.value,i),r=r.next;return n};xn.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=e(n,r.value,i),r=r.prev;return n};xn.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};xn.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};xn.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new xn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(;i!==null&&r<t;r++,i=i.next)n.push(i.value);return n};xn.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new xn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;i!==null&&r>t;r--)i=i.prev;for(;i!==null&&r>e;r--,i=i.prev)n.push(i.value);return n};xn.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(var s=[],r=0;i&&r<t;r++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=G5t(this,i,n[r]);return s};xn.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function G5t(e,t,n){var r=t===e.head?new Hy(n,null,t,e):new Hy(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function Y5t(e,t){e.tail=new Hy(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function X5t(e,t){e.head=new Hy(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Hy(e,t,n,r){if(!(this instanceof Hy))return new Hy(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{H5t()(xn)}catch{}const K5t=q5t,a1=Symbol("max"),zd=Symbol("length"),r2=Symbol("lengthCalculator"),sA=Symbol("allowStale"),T1=Symbol("maxAge"),Pd=Symbol("dispose"),z0e=Symbol("noDisposeOnSet"),Yi=Symbol("lruList"),cc=Symbol("cache"),_Fe=Symbol("updateAgeOnGet"),Cj=()=>1;class Z5t{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[a1]=t.max||1/0;const n=t.length||Cj;if(this[r2]=typeof n!="function"?Cj:n,this[sA]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[T1]=t.maxAge||0,this[Pd]=t.dispose,this[z0e]=t.noDisposeOnSet||!1,this[_Fe]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[a1]=t||1/0,KS(this)}get max(){return this[a1]}set allowStale(t){this[sA]=!!t}get allowStale(){return this[sA]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[T1]=t,KS(this)}get maxAge(){return this[T1]}set lengthCalculator(t){typeof t!="function"&&(t=Cj),t!==this[r2]&&(this[r2]=t,this[zd]=0,this[Yi].forEach(n=>{n.length=this[r2](n.value,n.key),this[zd]+=n.length})),KS(this)}get lengthCalculator(){return this[r2]}get length(){return this[zd]}get itemCount(){return this[Yi].length}rforEach(t,n){n=n||this;for(let r=this[Yi].tail;r!==null;){const i=r.prev;U0e(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(let r=this[Yi].head;r!==null;){const i=r.next;U0e(this,t,r,n),r=i}}keys(){return this[Yi].toArray().map(t=>t.key)}values(){return this[Yi].toArray().map(t=>t.value)}reset(){this[Pd]&&this[Yi]&&this[Yi].length&&this[Yi].forEach(t=>this[Pd](t.key,t.value)),this[cc]=new Map,this[Yi]=new K5t,this[zd]=0}dump(){return this[Yi].map(t=>X5(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Yi]}set(t,n,r){if(r=r||this[T1],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,s=this[r2](n,t);if(this[cc].has(t)){if(s>this[a1])return Z2(this,this[cc].get(t)),!1;const l=this[cc].get(t).value;return this[Pd]&&(this[z0e]||this[Pd](t,l.value)),l.now=i,l.maxAge=r,l.value=n,this[zd]+=s-l.length,l.length=s,this.get(t),KS(this),!0}const a=new Q5t(t,n,s,i,r);return a.length>this[a1]?(this[Pd]&&this[Pd](t,n),!1):(this[zd]+=a.length,this[Yi].unshift(a),this[cc].set(t,this[Yi].head),KS(this),!0)}has(t){if(!this[cc].has(t))return!1;const n=this[cc].get(t).value;return!X5(this,n)}get(t){return _j(this,t,!0)}peek(t){return _j(this,t,!1)}pop(){const t=this[Yi].tail;return t?(Z2(this,t),t.value):null}del(t){Z2(this,this[cc].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const i=t[r],s=i.e||0;if(s===0)this.set(i.k,i.v);else{const a=s-n;a>0&&this.set(i.k,i.v,a)}}}prune(){this[cc].forEach((t,n)=>_j(this,n,!1))}}const _j=(e,t,n)=>{const r=e[cc].get(t);if(r){const i=r.value;if(X5(e,i)){if(Z2(e,r),!e[sA])return}else n&&(e[_Fe]&&(r.value.now=Date.now()),e[Yi].unshiftNode(r));return i.value}},X5=(e,t)=>{if(!t||!t.maxAge&&!e[T1])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[T1]&&n>e[T1]},KS=e=>{if(e[zd]>e[a1])for(let t=e[Yi].tail;e[zd]>e[a1]&&t!==null;){const n=t.prev;Z2(e,t),t=n}},Z2=(e,t)=>{if(t){const n=t.value;e[Pd]&&e[Pd](n.key,n.value),e[zd]-=n.length,e[cc].delete(n.key),e[Yi].removeNode(t)}};class Q5t{constructor(t,n,r,i,s){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=s||0}}const U0e=(e,t,n,r)=>{let i=n.value;X5(e,i)&&(Z2(e,n),e[sA]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var J5t=Z5t,Sj,W0e;function hf(){if(W0e)return Sj;W0e=1;class e{constructor(D,T){if(T=r(T),D instanceof e)return D.loose===!!T.loose&&D.includePrerelease===!!T.includePrerelease?D:new e(D.raw,T);if(D instanceof i)return this.raw=D.value,this.set=[[D]],this.format(),this;if(this.options=T,this.loose=!!T.loose,this.includePrerelease=!!T.includePrerelease,this.raw=D.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(N=>this.parseRange(N.trim())).filter(N=>N.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const N=this.set[0];if(this.set=this.set.filter(F=>!p(F[0])),this.set.length===0)this.set=[N];else if(this.set.length>1){for(const F of this.set)if(F.length===1&&g(F[0])){this.set=[F];break}}}this.format()}format(){return this.range=this.set.map(D=>D.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(D){const N=((this.options.includePrerelease&&h)|(this.options.loose&&d))+":"+D,F=n.get(N);if(F)return F;const R=this.options.loose,P=R?o[l.HYPHENRANGELOOSE]:o[l.HYPHENRANGE];D=D.replace(P,S(this.options.includePrerelease)),s("hyphen replace",D),D=D.replace(o[l.COMPARATORTRIM],u),s("comparator trim",D),D=D.replace(o[l.TILDETRIM],c),s("tilde trim",D),D=D.replace(o[l.CARETTRIM],f),s("caret trim",D);let V=D.split(" ").map(K=>v(K,this.options)).join(" ").split(/\s+/).map(K=>E(K,this.options));R&&(V=V.filter(K=>(s("loose invalid filter",K,this.options),!!K.match(o[l.COMPARATORLOOSE])))),s("range list",V);const z=new Map,q=V.map(K=>new i(K,this.options));for(const K of q){if(p(K))return[K];z.set(K.value,K)}z.size>1&&z.has("")&&z.delete("");const G=[...z.values()];return n.set(N,G),G}intersects(D,T){if(!(D instanceof e))throw new TypeError("a Range is required");return this.set.some(N=>m(N,T)&&D.set.some(F=>m(F,T)&&N.every(R=>F.every(P=>R.intersects(P,T)))))}test(D){if(!D)return!1;if(typeof D=="string")try{D=new a(D,this.options)}catch{return!1}for(let T=0;T<this.set.length;T++)if(I(this.set[T],D,this.options))return!0;return!1}}Sj=e;const t=J5t,n=new t({max:1e3}),r=cre,i=B7(),s=P7,a=ko,{safeRe:o,t:l,comparatorTrimReplace:u,tildeTrimReplace:c,caretTrimReplace:f}=jy.exports,{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:d}=R7,p=A=>A.value==="<0.0.0-0",g=A=>A.value==="",m=(A,D)=>{let T=!0;const N=A.slice();let F=N.pop();for(;T&&N.length;)T=N.every(R=>F.intersects(R,D)),F=N.pop();return T},v=(A,D)=>(s("comp",A,D),A=w(A,D),s("caret",A),A=b(A,D),s("tildes",A),A=$(A,D),s("xrange",A),A=k(A,D),s("stars",A),A),y=A=>!A||A.toLowerCase()==="x"||A==="*",b=(A,D)=>A.trim().split(/\s+/).map(T=>x(T,D)).join(" "),x=(A,D)=>{const T=D.loose?o[l.TILDELOOSE]:o[l.TILDE];return A.replace(T,(N,F,R,P,V)=>{s("tilde",A,N,F,R,P,V);let z;return y(F)?z="":y(R)?z=`>=${F}.0.0 <${+F+1}.0.0-0`:y(P)?z=`>=${F}.${R}.0 <${F}.${+R+1}.0-0`:V?(s("replaceTilde pr",V),z=`>=${F}.${R}.${P}-${V} <${F}.${+R+1}.0-0`):z=`>=${F}.${R}.${P} <${F}.${+R+1}.0-0`,s("tilde return",z),z})},w=(A,D)=>A.trim().split(/\s+/).map(T=>C(T,D)).join(" "),C=(A,D)=>{s("caret",A,D);const T=D.loose?o[l.CARETLOOSE]:o[l.CARET],N=D.includePrerelease?"-0":"";return A.replace(T,(F,R,P,V,z)=>{s("caret",A,F,R,P,V,z);let q;return y(R)?q="":y(P)?q=`>=${R}.0.0${N} <${+R+1}.0.0-0`:y(V)?R==="0"?q=`>=${R}.${P}.0${N} <${R}.${+P+1}.0-0`:q=`>=${R}.${P}.0${N} <${+R+1}.0.0-0`:z?(s("replaceCaret pr",z),R==="0"?P==="0"?q=`>=${R}.${P}.${V}-${z} <${R}.${P}.${+V+1}-0`:q=`>=${R}.${P}.${V}-${z} <${R}.${+P+1}.0-0`:q=`>=${R}.${P}.${V}-${z} <${+R+1}.0.0-0`):(s("no pr"),R==="0"?P==="0"?q=`>=${R}.${P}.${V}${N} <${R}.${P}.${+V+1}-0`:q=`>=${R}.${P}.${V}${N} <${R}.${+P+1}.0-0`:q=`>=${R}.${P}.${V} <${+R+1}.0.0-0`),s("caret return",q),q})},$=(A,D)=>(s("replaceXRanges",A,D),A.split(/\s+/).map(T=>_(T,D)).join(" ")),_=(A,D)=>{A=A.trim();const T=D.loose?o[l.XRANGELOOSE]:o[l.XRANGE];return A.replace(T,(N,F,R,P,V,z)=>{s("xRange",A,N,F,R,P,V,z);const q=y(R),G=q||y(P),K=G||y(V),Y=K;return F==="="&&Y&&(F=""),z=D.includePrerelease?"-0":"",q?F===">"||F==="<"?N="<0.0.0-0":N="*":F&&Y?(G&&(P=0),V=0,F===">"?(F=">=",G?(R=+R+1,P=0,V=0):(P=+P+1,V=0)):F==="<="&&(F="<",G?R=+R+1:P=+P+1),F==="<"&&(z="-0"),N=`${F+R}.${P}.${V}${z}`):G?N=`>=${R}.0.0${z} <${+R+1}.0.0-0`:K&&(N=`>=${R}.${P}.0${z} <${R}.${+P+1}.0-0`),s("xRange return",N),N})},k=(A,D)=>(s("replaceStars",A,D),A.trim().replace(o[l.STAR],"")),E=(A,D)=>(s("replaceGTE0",A,D),A.trim().replace(o[D.includePrerelease?l.GTE0PRE:l.GTE0],"")),S=A=>(D,T,N,F,R,P,V,z,q,G,K,Y,te)=>(y(N)?T="":y(F)?T=`>=${N}.0.0${A?"-0":""}`:y(R)?T=`>=${N}.${F}.0${A?"-0":""}`:P?T=`>=${T}`:T=`>=${T}${A?"-0":""}`,y(q)?z="":y(G)?z=`<${+q+1}.0.0-0`:y(K)?z=`<${q}.${+G+1}.0-0`:Y?z=`<=${q}.${G}.${K}-${Y}`:A?z=`<${q}.${G}.${+K+1}-0`:z=`<=${z}`,`${T} ${z}`.trim()),I=(A,D,T)=>{for(let N=0;N<A.length;N++)if(!A[N].test(D))return!1;if(D.prerelease.length&&!T.includePrerelease){for(let N=0;N<A.length;N++)if(s(A[N].semver),A[N].semver!==i.ANY&&A[N].semver.prerelease.length>0){const F=A[N].semver;if(F.major===D.major&&F.minor===D.minor&&F.patch===D.patch)return!0}return!1}return!0};return Sj}var kj,V0e;function B7(){if(V0e)return kj;V0e=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=n(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),a("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(c){const f=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],h=c.match(f);if(!h)throw new TypeError(`Invalid comparator: ${c}`);this.operator=h[1]!==void 0?h[1]:"",this.operator==="="&&(this.operator=""),h[2]?this.semver=new o(h[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(a("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new o(c,this.options)}catch{return!1}return s(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new l(this.value,f).test(c.semver):(f=n(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||s(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||s(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}kj=t;const n=cre,{safeRe:r,t:i}=jy.exports,s=CFe,a=P7,o=ko,l=hf();return kj}const ePt=hf(),tPt=(e,t,n)=>{try{t=new ePt(t,n)}catch{return!1}return t.test(e)};var z7=tPt;const nPt=hf(),rPt=(e,t)=>new nPt(e,t).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));var iPt=rPt;const sPt=ko,aPt=hf(),oPt=(e,t,n)=>{let r=null,i=null,s=null;try{s=new aPt(t,n)}catch{return null}return e.forEach(a=>{s.test(a)&&(!r||i.compare(a)===-1)&&(r=a,i=new sPt(r,n))}),r};var lPt=oPt;const uPt=ko,cPt=hf(),fPt=(e,t,n)=>{let r=null,i=null,s=null;try{s=new cPt(t,n)}catch{return null}return e.forEach(a=>{s.test(a)&&(!r||i.compare(a)===1)&&(r=a,i=new uPt(r,n))}),r};var hPt=fPt;const Ej=ko,dPt=hf(),j0e=L7,pPt=(e,t)=>{e=new dPt(e,t);let n=new Ej("0.0.0");if(e.test(n)||(n=new Ej("0.0.0-0"),e.test(n)))return n;n=null;for(let r=0;r<e.set.length;++r){const i=e.set[r];let s=null;i.forEach(a=>{const o=new Ej(a.semver.version);switch(a.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!s||j0e(o,s))&&(s=o);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!n||j0e(n,s))&&(n=s)}return n&&e.test(n)?n:null};var gPt=pPt;const mPt=hf(),vPt=(e,t)=>{try{return new mPt(e,t).range||"*"}catch{return null}};var yPt=vPt;const bPt=ko,SFe=B7(),{ANY:xPt}=SFe,wPt=hf(),$Pt=z7,H0e=L7,q0e=hre,CPt=pre,_Pt=dre,SPt=(e,t,n,r)=>{e=new bPt(e,r),t=new wPt(t,r);let i,s,a,o,l;switch(n){case">":i=H0e,s=CPt,a=q0e,o=">",l=">=";break;case"<":i=q0e,s=_Pt,a=H0e,o="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if($Pt(e,t,r))return!1;for(let u=0;u<t.set.length;++u){const c=t.set[u];let f=null,h=null;if(c.forEach(d=>{d.semver===xPt&&(d=new SFe(">=0.0.0")),f=f||d,h=h||d,i(d.semver,f.semver,r)?f=d:a(d.semver,h.semver,r)&&(h=d)}),f.operator===o||f.operator===l||(!h.operator||h.operator===o)&&s(e,h.semver))return!1;if(h.operator===l&&a(e,h.semver))return!1}return!0};var gre=SPt;const kPt=gre,EPt=(e,t,n)=>kPt(e,t,">",n);var APt=EPt;const TPt=gre,DPt=(e,t,n)=>TPt(e,t,"<",n);var IPt=DPt;const G0e=hf(),NPt=(e,t,n)=>(e=new G0e(e,n),t=new G0e(t,n),e.intersects(t,n));var MPt=NPt;const FPt=z7,OPt=ff;var RPt=(e,t,n)=>{const r=[];let i=null,s=null;const a=e.sort((c,f)=>OPt(c,f,n));for(const c of a)FPt(c,t,n)?(s=c,i||(i=c)):(s&&r.push([i,s]),s=null,i=null);i&&r.push([i,null]);const o=[];for(const[c,f]of r)c===f?o.push(c):!f&&c===a[0]?o.push("*"):f?c===a[0]?o.push(`<=${f}`):o.push(`${c} - ${f}`):o.push(`>=${c}`);const l=o.join(" || "),u=typeof t.raw=="string"?t.raw:String(t);return l.length<u.length?l:t};const Y0e=hf(),mre=B7(),{ANY:Aj}=mre,ZS=z7,vre=ff,PPt=(e,t,n={})=>{if(e===t)return!0;e=new Y0e(e,n),t=new Y0e(t,n);let r=!1;e:for(const i of e.set){for(const s of t.set){const a=BPt(i,s,n);if(r=r||a!==null,a)continue e}if(r)return!1}return!0},LPt=[new mre(">=0.0.0-0")],X0e=[new mre(">=0.0.0")],BPt=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===Aj){if(t.length===1&&t[0].semver===Aj)return!0;n.includePrerelease?e=LPt:e=X0e}if(t.length===1&&t[0].semver===Aj){if(n.includePrerelease)return!0;t=X0e}const r=new Set;let i,s;for(const d of e)d.operator===">"||d.operator===">="?i=K0e(i,d,n):d.operator==="<"||d.operator==="<="?s=Z0e(s,d,n):r.add(d.semver);if(r.size>1)return null;let a;if(i&&s){if(a=vre(i.semver,s.semver,n),a>0)return null;if(a===0&&(i.operator!==">="||s.operator!=="<="))return null}for(const d of r){if(i&&!ZS(d,String(i),n)||s&&!ZS(d,String(s),n))return null;for(const p of t)if(!ZS(d,String(p),n))return!1;return!0}let o,l,u,c,f=s&&!n.includePrerelease&&s.semver.prerelease.length?s.semver:!1,h=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&s.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const d of t){if(c=c||d.operator===">"||d.operator===">=",u=u||d.operator==="<"||d.operator==="<=",i){if(h&&d.semver.prerelease&&d.semver.prerelease.length&&d.semver.major===h.major&&d.semver.minor===h.minor&&d.semver.patch===h.patch&&(h=!1),d.operator===">"||d.operator===">="){if(o=K0e(i,d,n),o===d&&o!==i)return!1}else if(i.operator===">="&&!ZS(i.semver,String(d),n))return!1}if(s){if(f&&d.semver.prerelease&&d.semver.prerelease.length&&d.semver.major===f.major&&d.semver.minor===f.minor&&d.semver.patch===f.patch&&(f=!1),d.operator==="<"||d.operator==="<="){if(l=Z0e(s,d,n),l===d&&l!==s)return!1}else if(s.operator==="<="&&!ZS(s.semver,String(d),n))return!1}if(!d.operator&&(s||i)&&a!==0)return!1}return!(i&&u&&!s&&a!==0||s&&c&&!i&&a!==0||h||f)},K0e=(e,t,n)=>{if(!e)return t;const r=vre(e.semver,t.semver,n);return r>0?e:r<0||t.operator===">"&&e.operator===">="?t:e},Z0e=(e,t,n)=>{if(!e)return t;const r=vre(e.semver,t.semver,n);return r<0?e:r>0||t.operator==="<"&&e.operator==="<="?t:e};var zPt=PPt;const Tj=jy.exports,Q0e=R7,UPt=ko,J0e=xFe,WPt=O_,VPt=W4t,jPt=H4t,HPt=G4t,qPt=X4t,GPt=Q4t,YPt=t5t,XPt=i5t,KPt=o5t,ZPt=ff,QPt=f5t,JPt=p5t,eLt=fre,tLt=y5t,nLt=w5t,rLt=L7,iLt=hre,sLt=wFe,aLt=$Fe,oLt=dre,lLt=pre,uLt=CFe,cLt=j5t,fLt=B7(),hLt=hf(),dLt=z7,pLt=iPt,gLt=lPt,mLt=hPt,vLt=gPt,yLt=yPt,bLt=gre,xLt=APt,wLt=IPt,$Lt=MPt,CLt=RPt,_Lt=zPt;var kFe={parse:WPt,valid:VPt,clean:jPt,inc:HPt,diff:qPt,major:GPt,minor:YPt,patch:XPt,prerelease:KPt,compare:ZPt,rcompare:QPt,compareLoose:JPt,compareBuild:eLt,sort:tLt,rsort:nLt,gt:rLt,lt:iLt,eq:sLt,neq:aLt,gte:oLt,lte:lLt,cmp:uLt,coerce:cLt,Comparator:fLt,Range:hLt,satisfies:dLt,toComparators:pLt,maxSatisfying:gLt,minSatisfying:mLt,minVersion:vLt,validRange:yLt,outside:bLt,gtr:xLt,ltr:wLt,intersects:$Lt,simplifyRange:CLt,subset:_Lt,SemVer:UPt,re:Tj.re,src:Tj.src,tokens:Tj.t,SEMVER_SPEC_VERSION:Q0e.SEMVER_SPEC_VERSION,RELEASE_TYPES:Q0e.RELEASE_TYPES,compareIdentifiers:J0e.compareIdentifiers,rcompareIdentifiers:J0e.rcompareIdentifiers};function og(e,t,n){return e.fields=t||[],e.fname=n,e}function SLt(e){return e==null?null:e.fname}function EFe(e){return e==null?null:e.fields}function AFe(e){return e.length===1?kLt(e[0]):ELt(e)}const kLt=e=>function(t){return t[e]},ELt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function n4(e){throw Error(e)}function yre(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o),s+=e.substring(++o,++o),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||n4("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&n4("Access path missing closing bracket: "+e),r&&n4("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function bre(e,t,n){const r=yre(e);return e=r.length===1?r[0]:e,og((n&&n.get||AFe)(r),[e],t||e)}const ALt=bre("id"),xre=og(e=>e,[],"identity"),TLt=og(()=>0,[],"zero"),DLt=og(()=>1,[],"one"),ILt=og(()=>!0,[],"true"),NLt=og(()=>!1,[],"false");function mO(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const TFe=0,DFe=1,IFe=2,NFe=3,MFe=4;function MLt(e,t){let n=e||TFe;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=DFe&&mO(t||"error","ERROR",arguments),this},warn(){return n>=IFe&&mO(t||"warn","WARN",arguments),this},info(){return n>=NFe&&mO(t||"log","INFO",arguments),this},debug(){return n>=MFe&&mO(t||"log","DEBUG",arguments),this}}}var U7=Array.isArray;function K5(e){return e===Object(e)}const eme=e=>e!=="__proto__";function wre(...e){return e.reduce((t,n)=>{for(const r in n)if(r==="signals")t.signals=FLt(t.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;W7(t,r,n[r],i)}return t},{})}function W7(e,t,n,r){if(!eme(t))return;let i,s;if(K5(n)&&!U7(n)){s=K5(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?W7(s,i,n[i]):eme(i)&&(s[i]=n[i])}else e[t]=n}function FLt(e,t){if(e==null)return t;const n={},r=[];function i(s){n[s.name]||(n[s.name]=1,r.push(s))}return t.forEach(i),e.forEach(i),r}function R_(e){return e[e.length-1]}function $re(e){return e==null||e===""?null:+e}const FFe=e=>t=>e*Math.exp(t),OFe=e=>t=>Math.log(e*t),RFe=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),PFe=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Z5=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function V7(e,t,n,r){const i=n(e[0]),s=n(R_(e)),a=(s-i)*t;return[r(i-a),r(s-a)]}function OLt(e,t){return V7(e,t,$re,xre)}function RLt(e,t){var n=Math.sign(e[0]);return V7(e,t,OFe(n),FFe(n))}function PLt(e,t,n){return V7(e,t,Z5(n),Z5(1/n))}function LLt(e,t,n){return V7(e,t,RFe(n),PFe(n))}function j7(e,t,n,r,i){const s=r(e[0]),a=r(R_(e)),o=t!=null?r(t):(s+a)/2;return[i(o+(s-o)*n),i(o+(a-o)*n)]}function BLt(e,t,n){return j7(e,t,n,$re,xre)}function zLt(e,t,n){const r=Math.sign(e[0]);return j7(e,t,n,OFe(r),FFe(r))}function ULt(e,t,n,r){return j7(e,t,n,Z5(r),Z5(1/r))}function WLt(e,t,n,r){return j7(e,t,n,RFe(r),PFe(r))}function VLt(e){return 1+~~(new Date(e).getMonth()/3)}function jLt(e){return 1+~~(new Date(e).getUTCMonth()/3)}function NT(e){return e!=null?U7(e)?e:[e]:[]}function HLt(e,t,n){let r=e[0],i=e[1],s;return i<r&&(s=i,i=r,r=s),s=i-r,s>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-s),r+s]}function H7(e){return typeof e=="function"}const qLt="descending";function GLt(e,t,n){n=n||{},t=NT(t)||[];const r=[],i=[],s={},a=n.comparator||YLt;return NT(e).forEach((o,l)=>{o!=null&&(r.push(t[l]===qLt?-1:1),i.push(o=H7(o)?o:bre(o,null,n)),(EFe(o)||[]).forEach(u=>s[u]=1))}),i.length===0?null:og(a(i,r),Object.keys(s))}const Cre=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),YLt=(e,t)=>e.length===1?XLt(e[0],t[0]):KLt(e,t,e.length),XLt=(e,t)=>function(n,r){return Cre(e(n),e(r))*t},KLt=(e,t,n)=>(t.push(0),function(r,i){let s,a=0,o=-1;for(;a===0&&++o<n;)s=e[o],a=Cre(s(r),s(i));return a*t[o]});function ZLt(e){return H7(e)?e:()=>e}function QLt(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function _re(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function JLt(e,t){let n=0,r,i,s,a;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(s=a=i;n<r;++n)i=e[n],i!=null&&(i<s&&(s=i),i>a&&(a=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(s=a=i;n<r;++n)i=t(e[n]),i!=null&&(i<s&&(s=i),i>a&&(a=i))}return[s,a]}function e6t(e,t){const n=e.length;let r=-1,i,s,a,o,l;if(t==null){for(;++r<n;)if(s=e[r],s!=null&&s>=s){i=a=s;break}if(r===n)return[-1,-1];for(o=l=r;++r<n;)s=e[r],s!=null&&(i>s&&(i=s,o=r),a<s&&(a=s,l=r))}else{for(;++r<n;)if(s=t(e[r],r,e),s!=null&&s>=s){i=a=s;break}if(r===n)return[-1,-1];for(o=l=r;++r<n;)s=t(e[r],r,e),s!=null&&(i>s&&(i=s,o=r),a<s&&(a=s,l=r))}return[o,l]}const t6t=Object.prototype.hasOwnProperty;function o1(e,t){return t6t.call(e,t)}const vO={};function n6t(e){let t={},n;function r(s){return o1(t,s)&&t[s]!==vO}const i={size:0,empty:0,object:t,has:r,get(s){return r(s)?t[s]:void 0},set(s,a){return r(s)||(++i.size,t[s]===vO&&--i.empty),t[s]=a,this},delete(s){return r(s)&&(--i.size,++i.empty,t[s]=vO),this},clear(){i.size=i.empty=0,i.object=t={}},test(s){return arguments.length?(n=s,i):n},clean(){const s={};let a=0;for(const o in t){const l=t[o];l!==vO&&(!n||!n(l))&&(s[o]=l,++a)}i.size=a,i.empty=0,i.object=t=s}};return e&&Object.keys(e).forEach(s=>{i.set(s,e[s])}),i}function r6t(e,t,n,r,i,s){if(!n&&n!==0)return s;const a=+n;let o=e[0],l=R_(e),u;l<o&&(u=o,o=l,l=u),u=Math.abs(t-o);const c=Math.abs(l-t);return u<c&&u<=a?r:c<=a?i:s}function i6t(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),_re(r,n)}function s6t(e,t,n,r){let i=t[0],s=t[t.length-1],a;return i>s&&(a=i,i=s,s=a),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=s:e<s)}function LFe(e){return typeof e=="boolean"}function BFe(e){return Object.prototype.toString.call(e)==="[object Date]"}function a6t(e){return e&&H7(e[Symbol.iterator])}function zFe(e){return typeof e=="number"}function o6t(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function MT(e){return typeof e=="string"}function l6t(e,t,n){e&&(e=t?NT(e).map(o=>o.replace(/\\(.)/g,"$1")):NT(e));const r=e&&e.length,i=n&&n.get||AFe,s=o=>i(t?[o]:yre(o));let a;if(!r)a=function(){return""};else if(r===1){const o=s(e[0]);a=function(l){return""+o(l)}}else{const o=e.map(s);a=function(l){let u=""+o[0](l),c=0;for(;++c<r;)u+="|"+o[c](l);return u}}return og(a,e,"key")}function u6t(e,t){const n=e[0],r=R_(e),i=+t;return i?i===1?r:n+i*(r-n):n}const c6t=1e4;function f6t(e){e=+e||c6t;let t,n,r;const i=()=>{t={},n={},r=0},s=(a,o)=>(++r>e&&(n=t,t={},r=1),t[a]=o);return i(),{clear:i,has:a=>o1(t,a)||o1(n,a),get:a=>o1(t,a)?t[a]:o1(n,a)?s(a,n[a]):void 0,set:(a,o)=>o1(t,a)?t[a]=o:s(a,o)}}function h6t(e,t,n,r){const i=t.length,s=n.length;if(!s)return t;if(!i)return n;const a=r||new t.constructor(i+s);let o=0,l=0,u=0;for(;o<i&&l<s;++u)a[u]=e(t[o],n[l])>0?n[l++]:t[o++];for(;o<i;++o,++u)a[u]=t[o];for(;l<s;++l,++u)a[u]=n[l];return a}function aE(e,t){let n="";for(;--t>=0;)n+=e;return n}function d6t(e,t,n,r){const i=n||" ",s=e+"",a=t-s.length;return a<=0?s:r==="left"?aE(i,a)+s:r==="center"?aE(i,~~(a/2))+s+aE(i,Math.ceil(a/2)):s+aE(i,a)}function p6t(e){return e&&R_(e)-e[0]||0}function UFe(e){return U7(e)?"["+e.map(UFe)+"]":K5(e)||MT(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function g6t(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const m6t=e=>zFe(e)||BFe(e)?e:Date.parse(e);function v6t(e,t){return t=t||m6t,e==null||e===""?null:t(e)}function y6t(e){return e==null||e===""?null:e+""}function b6t(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function x6t(e,t,n,r){const i=r!=null?r:"\u2026",s=e+"",a=s.length,o=Math.max(0,t-i.length);return a<=t?s:n==="left"?i+s.slice(a-o):n==="center"?s.slice(0,Math.ceil(o/2))+i+s.slice(a-~~(o/2)):s.slice(0,o)+i}function w6t(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const s=t(e[i]);s&&n(s,i,e)}}else e.forEach(n)}function Jl(e,t,n){return e.fields=t||[],e.fname=n,e}function li(e){return e==null?null:e.fname}function ao(e){return e==null?null:e.fields}function WFe(e){return e.length===1?$6t(e[0]):C6t(e)}const $6t=e=>function(t){return t[e]},C6t=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function $e(e){throw Error(e)}function Sre(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||$e("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&$e("Access path missing closing bracket: "+e),r&&$e("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function Hl(e,t,n){const r=Sre(e);return e=r.length===1?r[0]:e,Jl((n&&n.get||WFe)(r),[e],t||e)}const q7=Hl("id"),ll=Jl(e=>e,[],"identity"),l1=Jl(()=>0,[],"zero"),HN=Jl(()=>1,[],"one"),Jc=Jl(()=>!0,[],"true"),Ev=Jl(()=>!1,[],"false");function _6t(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const S6t=0,VFe=1,k6t=2,E6t=3,A6t=4;function T6t(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_6t,r=e||S6t;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=VFe&&n(t||"error","ERROR",arguments),this},warn(){return r>=k6t&&n(t||"warn","WARN",arguments),this},info(){return r>=E6t&&n(t||"log","INFO",arguments),this},debug(){return r>=A6t&&n(t||"log","DEBUG",arguments),this}}}var at=Array.isArray;function Ft(e){return e===Object(e)}const tme=e=>e!=="__proto__";function D6t(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((r,i)=>{for(const s in i)if(s==="signals")r.signals=I6t(r.signals,i.signals);else{const a=s==="legend"?{layout:1}:s==="style"?!0:null;jFe(r,s,i[s],a)}return r},{})}function jFe(e,t,n,r){if(!tme(t))return;let i,s;if(Ft(n)&&!at(n)){s=Ft(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?jFe(s,i,n[i]):tme(i)&&(s[i]=n[i])}else e[t]=n}function I6t(e,t){if(e==null)return t;const n={},r=[];function i(s){n[s.name]||(n[s.name]=1,r.push(s))}return t.forEach(i),e.forEach(i),r}function ln(e){return e[e.length-1]}function io(e){return e==null||e===""?null:+e}const HFe=e=>t=>e*Math.exp(t),qFe=e=>t=>Math.log(e*t),GFe=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),YFe=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Q5=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function G7(e,t,n,r){const i=n(e[0]),s=n(ln(e)),a=(s-i)*t;return[r(i-a),r(s-a)]}function N6t(e,t){return G7(e,t,io,ll)}function M6t(e,t){var n=Math.sign(e[0]);return G7(e,t,qFe(n),HFe(n))}function F6t(e,t,n){return G7(e,t,Q5(n),Q5(1/n))}function O6t(e,t,n){return G7(e,t,GFe(n),YFe(n))}function Y7(e,t,n,r,i){const s=r(e[0]),a=r(ln(e)),o=t!=null?r(t):(s+a)/2;return[i(o+(s-o)*n),i(o+(a-o)*n)]}function XFe(e,t,n){return Y7(e,t,n,io,ll)}function KFe(e,t,n){const r=Math.sign(e[0]);return Y7(e,t,n,qFe(r),HFe(r))}function pX(e,t,n,r){return Y7(e,t,n,Q5(r),Q5(1/r))}function ZFe(e,t,n,r){return Y7(e,t,n,GFe(r),YFe(r))}function R6t(e){return 1+~~(new Date(e).getMonth()/3)}function P6t(e){return 1+~~(new Date(e).getUTCMonth()/3)}function ct(e){return e!=null?at(e)?e:[e]:[]}function L6t(e,t,n){let r=e[0],i=e[1],s;return i<r&&(s=i,i=r,r=s),s=i-r,s>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-s),r+s]}function Ut(e){return typeof e=="function"}const B6t="descending";function QFe(e,t,n){n=n||{},t=ct(t)||[];const r=[],i=[],s={},a=n.comparator||z6t;return ct(e).forEach((o,l)=>{o!=null&&(r.push(t[l]===B6t?-1:1),i.push(o=Ut(o)?o:Hl(o,null,n)),(ao(o)||[]).forEach(u=>s[u]=1))}),i.length===0?null:Jl(a(i,r),Object.keys(s))}const kre=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),z6t=(e,t)=>e.length===1?U6t(e[0],t[0]):W6t(e,t,e.length),U6t=(e,t)=>function(n,r){return kre(e(n),e(r))*t},W6t=(e,t,n)=>(t.push(0),function(r,i){let s,a=0,o=-1;for(;a===0&&++o<n;)s=e[o],a=kre(s(r),s(i));return a*t[o]});function go(e){return Ut(e)?e:()=>e}function JFe(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function zt(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function Op(e,t){let n=0,r,i,s,a;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(s=a=i;n<r;++n)i=e[n],i!=null&&(i<s&&(s=i),i>a&&(a=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(s=a=i;n<r;++n)i=t(e[n]),i!=null&&(i<s&&(s=i),i>a&&(a=i))}return[s,a]}function V6t(e,t){const n=e.length;let r=-1,i,s,a,o,l;if(t==null){for(;++r<n;)if(s=e[r],s!=null&&s>=s){i=a=s;break}if(r===n)return[-1,-1];for(o=l=r;++r<n;)s=e[r],s!=null&&(i>s&&(i=s,o=r),a<s&&(a=s,l=r))}else{for(;++r<n;)if(s=t(e[r],r,e),s!=null&&s>=s){i=a=s;break}if(r===n)return[-1,-1];for(o=l=r;++r<n;)s=t(e[r],r,e),s!=null&&(i>s&&(i=s,o=r),a<s&&(a=s,l=r))}return[o,l]}const j6t=Object.prototype.hasOwnProperty;function bt(e,t){return j6t.call(e,t)}const yO={};function qN(e){let t={},n;function r(s){return bt(t,s)&&t[s]!==yO}const i={size:0,empty:0,object:t,has:r,get(s){return r(s)?t[s]:void 0},set(s,a){return r(s)||(++i.size,t[s]===yO&&--i.empty),t[s]=a,this},delete(s){return r(s)&&(--i.size,++i.empty,t[s]=yO),this},clear(){i.size=i.empty=0,i.object=t={}},test(s){return arguments.length?(n=s,i):n},clean(){const s={};let a=0;for(const o in t){const l=t[o];l!==yO&&(!n||!n(l))&&(s[o]=l,++a)}i.size=a,i.empty=0,i.object=t=s}};return e&&Object.keys(e).forEach(s=>{i.set(s,e[s])}),i}function H6t(e,t,n,r,i,s){if(!n&&n!==0)return s;const a=+n;let o=e[0],l=ln(e),u;l<o&&(u=o,o=l,l=u),u=Math.abs(t-o);const c=Math.abs(l-t);return u<c&&u<=a?r:c<=a?i:s}function Ie(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),zt(r,n)}function oE(e,t,n,r){let i=t[0],s=t[t.length-1],a;return i>s&&(a=i,i=s,s=a),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=s:e<s)}function q6t(e){return typeof e=="boolean"}function ty(e){return Object.prototype.toString.call(e)==="[object Date]"}function G6t(e){return e&&Ut(e[Symbol.iterator])}function FT(e){return typeof e=="number"}function Y6t(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function wr(e){return typeof e=="string"}function eOe(e,t,n){e&&(e=t?ct(e).map(o=>o.replace(/\\(.)/g,"$1")):ct(e));const r=e&&e.length,i=n&&n.get||WFe,s=o=>i(t?[o]:Sre(o));let a;if(!r)a=function(){return""};else if(r===1){const o=s(e[0]);a=function(l){return""+o(l)}}else{const o=e.map(s);a=function(l){let u=""+o[0](l),c=0;for(;++c<r;)u+="|"+o[c](l);return u}}return Jl(a,e,"key")}function X6t(e,t){const n=e[0],r=ln(e),i=+t;return i?i===1?r:n+i*(r-n):n}const K6t=1e4;function Z6t(e){e=+e||K6t;let t,n,r;const i=()=>{t={},n={},r=0},s=(a,o)=>(++r>e&&(n=t,t={},r=1),t[a]=o);return i(),{clear:i,has:a=>bt(t,a)||bt(n,a),get:a=>bt(t,a)?t[a]:bt(n,a)?s(a,n[a]):void 0,set:(a,o)=>bt(t,a)?t[a]=o:s(a,o)}}function Q6t(e,t,n,r){const i=t.length,s=n.length;if(!s)return t;if(!i)return n;const a=r||new t.constructor(i+s);let o=0,l=0,u=0;for(;o<i&&l<s;++u)a[u]=e(t[o],n[l])>0?n[l++]:t[o++];for(;o<i;++o,++u)a[u]=t[o];for(;l<s;++l,++u)a[u]=n[l];return a}function bO(e,t){let n="";for(;--t>=0;)n+=e;return n}function J6t(e,t,n,r){const i=n||" ",s=e+"",a=t-s.length;return a<=0?s:r==="left"?bO(i,a)+s:r==="center"?bO(i,~~(a/2))+s+bO(i,Math.ceil(a/2)):s+bO(i,a)}function X7(e){return e&&ln(e)-e[0]||0}function ot(e){return at(e)?"["+e.map(ot)+"]":Ft(e)||wr(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function tOe(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const eBt=e=>FT(e)||ty(e)?e:Date.parse(e);function nOe(e,t){return t=t||eBt,e==null||e===""?null:t(e)}function rOe(e){return e==null||e===""?null:e+""}function Oh(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function tBt(e,t,n,r){const i=r!=null?r:"\u2026",s=e+"",a=s.length,o=Math.max(0,t-i.length);return a<=t?s:n==="left"?i+s.slice(a-o):n==="center"?s.slice(0,Math.ceil(o/2))+i+s.slice(a-~~(o/2)):s.slice(0,o)+i}function Xv(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const s=t(e[i]);s&&n(s,i,e)}}else e.forEach(n)}var nme={},Dj={},Ij=34,QS=10,Nj=13;function iOe(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function nBt(e,t){var n=iOe(e);return function(r,i){return t(n(r),i,e)}}function rme(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Mo(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function rBt(e){return e<0?"-"+Mo(-e,6):e>9999?"+"+Mo(e,6):Mo(e,4)}function iBt(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":rBt(e.getUTCFullYear())+"-"+Mo(e.getUTCMonth()+1,2)+"-"+Mo(e.getUTCDate(),2)+(i?"T"+Mo(t,2)+":"+Mo(n,2)+":"+Mo(r,2)+"."+Mo(i,3)+"Z":r?"T"+Mo(t,2)+":"+Mo(n,2)+":"+Mo(r,2)+"Z":n||t?"T"+Mo(t,2)+":"+Mo(n,2)+"Z":"")}function sBt(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,h){var d,p,g=i(f,function(m,v){if(d)return d(m,v-1);p=m,d=h?nBt(m,h):iOe(m)});return g.columns=p||[],g}function i(f,h){var d=[],p=f.length,g=0,m=0,v,y=p<=0,b=!1;f.charCodeAt(p-1)===QS&&--p,f.charCodeAt(p-1)===Nj&&--p;function x(){if(y)return Dj;if(b)return b=!1,nme;var C,$=g,_;if(f.charCodeAt($)===Ij){for(;g++<p&&f.charCodeAt(g)!==Ij||f.charCodeAt(++g)===Ij;);return(C=g)>=p?y=!0:(_=f.charCodeAt(g++))===QS?b=!0:_===Nj&&(b=!0,f.charCodeAt(g)===QS&&++g),f.slice($+1,C-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(C=g++))===QS)b=!0;else if(_===Nj)b=!0,f.charCodeAt(g)===QS&&++g;else if(_!==n)continue;return f.slice($,C)}return y=!0,f.slice($,p)}for(;(v=x())!==Dj;){for(var w=[];v!==nme&&v!==Dj;)w.push(v),v=x();h&&(w=h(w,m++))==null||d.push(w)}return d}function s(f,h){return f.map(function(d){return h.map(function(p){return c(d[p])}).join(e)})}function a(f,h){return h==null&&(h=rme(f)),[h.map(c).join(e)].concat(s(f,h)).join(`
`)}function o(f,h){return h==null&&(h=rme(f)),s(f,h).join(`
`)}function l(f){return f.map(u).join(`
`)}function u(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?iBt(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:a,formatBody:o,formatRows:l,formatRow:u,formatValue:c}}function aBt(e){return e}function oBt(e){if(e==null)return aBt;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],a=e.translate[1];return function(o,l){l||(t=n=0);var u=2,c=o.length,f=new Array(c);for(f[0]=(t+=o[0])*r+s,f[1]=(n+=o[1])*i+a;u<c;)f[u]=o[u],++u;return f}}function lBt(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function sOe(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return ime(e,n)})}:ime(e,t)}function ime(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,s=aOe(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function aOe(e,t){var n=oBt(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var h=r[c<0?~c:c],d=0,p=h.length;d<p;++d)f.push(n(h[d],d));c<0&&lBt(f,p)}function s(c){return n(c)}function a(c){for(var f=[],h=0,d=c.length;h<d;++h)i(c[h],f);return f.length<2&&f.push(f[0]),f}function o(c){for(var f=a(c);f.length<4;)f.push(f[0]);return f}function l(c){return c.map(o)}function u(c){var f=c.type,h;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(u)};case"Point":h=s(c.coordinates);break;case"MultiPoint":h=c.coordinates.map(s);break;case"LineString":h=a(c.arcs);break;case"MultiLineString":h=c.arcs.map(a);break;case"Polygon":h=l(c.arcs);break;case"MultiPolygon":h=c.arcs.map(l);break;default:return null}return{type:f,coordinates:h}}return u(t)}function uBt(e,t){var n={},r={},i={},s=[],a=-1;t.forEach(function(u,c){var f=e.arcs[u<0?~u:u],h;f.length<3&&!f[1][0]&&!f[1][1]&&(h=t[++a],t[a]=u,t[c]=h)}),t.forEach(function(u){var c=o(u),f=c[0],h=c[1],d,p;if(d=i[f])if(delete i[d.end],d.push(u),d.end=h,p=r[h]){delete r[p.start];var g=p===d?d:d.concat(p);r[g.start=d.start]=i[g.end=p.end]=g}else r[d.start]=i[d.end]=d;else if(d=r[h])if(delete r[d.start],d.unshift(u),d.start=f,p=i[f]){delete i[p.end];var m=p===d?d:p.concat(d);r[m.start=p.start]=i[m.end=d.end]=m}else r[d.start]=i[d.end]=d;else d=[u],r[d.start=f]=i[d.end=h]=d});function o(u){var c=e.arcs[u<0?~u:u],f=c[0],h;return e.transform?(h=[0,0],c.forEach(function(d){h[0]+=d[0],h[1]+=d[1]})):h=c[c.length-1],u<0?[h,f]:[f,h]}function l(u,c){for(var f in u){var h=u[f];delete c[h.start],delete h.start,delete h.end,h.forEach(function(d){n[d<0?~d:d]=1}),s.push(h)}}return l(i,r),l(r,i),t.forEach(function(u){n[u<0?~u:u]||s.push([u])}),s}function oOe(e){return aOe(e,cBt.apply(this,arguments))}function cBt(e,t,n){var r,i,s;if(arguments.length>1)r=fBt(e,t,n);else for(i=0,r=new Array(s=e.arcs.length);i<s;++i)r[i]=i;return{type:"MultiLineString",arcs:uBt(e,r)}}function fBt(e,t,n){var r=[],i=[],s;function a(f){var h=f<0?~f:f;(i[h]||(i[h]=[])).push({i:f,g:s})}function o(f){f.forEach(a)}function l(f){f.forEach(o)}function u(f){f.forEach(l)}function c(f){switch(s=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":o(f.arcs);break;case"MultiLineString":case"Polygon":l(f.arcs);break;case"MultiPolygon":u(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}class qw extends Map{constructor(t,n=cOe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(gX(this,t))}has(t){return super.has(gX(this,t))}set(t,n){return super.set(lOe(this,t),n)}delete(t){return super.delete(uOe(this,t))}}class J5 extends Set{constructor(t,n=cOe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(gX(this,t))}add(t){return super.add(lOe(this,t))}delete(t){return super.delete(uOe(this,t))}}function gX({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function lOe({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function uOe({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function cOe(e){return e!==null&&typeof e=="object"?e.valueOf():e}const hBt=Math.sqrt(50),dBt=Math.sqrt(10),pBt=Math.sqrt(2);function fOe(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=hBt?10:s>=dBt?5:s>=pBt?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?fOe(e,t,n*2):[o,l,u]}function sme(e,t,n){return t=+t,e=+e,n=+n,fOe(e,t,n)[2]}function gBt(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?sme(t,e,n):sme(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function mBt(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function eP(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Gw(e){return e=eP(Math.abs(e)),e?e[1]:NaN}function vBt(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function yBt(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var bBt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function OT(e){if(!(t=bBt.exec(e)))throw new Error("invalid format: "+e);var t;return new Ere({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}OT.prototype=Ere.prototype;function Ere(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Ere.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function xBt(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var hOe;function wBt(e,t){var n=eP(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(hOe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+eP(e,Math.max(0,t+s-1))[0]}function ame(e,t){var n=eP(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const ome={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:mBt,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>ame(e*100,t),r:ame,s:wBt,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function lme(e){return e}var ume=Array.prototype.map,cme=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function dOe(e){var t=e.grouping===void 0||e.thousands===void 0?lme:vBt(ume.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?lme:yBt(ume.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=OT(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):ome[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var C=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=g==="$"?r:/[%p]/.test(w)?a:"",_=ome[w],k=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(S){var I=C,A=$,D,T,N;if(w==="c")A=_(S)+A,S="";else{S=+S;var F=S<0||1/S<0;if(S=isNaN(S)?l:_(Math.abs(S),b),x&&(S=xBt(S)),F&&+S==0&&p!=="+"&&(F=!1),I=(F?p==="("?p:o:p==="-"||p==="("?"":p)+I,A=(w==="s"?cme[8+hOe/3]:"")+A+(F&&p==="("?")":""),k){for(D=-1,T=S.length;++D<T;)if(N=S.charCodeAt(D),48>N||N>57){A=(N===46?i+S.slice(D+1):S.slice(D))+A,S=S.slice(0,D);break}}}y&&!m&&(S=t(S,1/0));var R=I.length+S.length+A.length,P=R<v?new Array(v-R+1).join(h):"";switch(y&&m&&(S=t(P+S,P.length?v-A.length:1/0),P=""),d){case"<":S=I+S+A+P;break;case"=":S=I+P+S+A;break;case"^":S=P.slice(0,R=P.length>>1)+I+S+A+P.slice(R);break;default:S=P+I+S+A;break}return s(S)}return E.toString=function(){return f+""},E}function c(f,h){var d=u((f=OT(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Gw(h)/3)))*3,g=Math.pow(10,-p),m=cme[8+p/3];return function(v){return d(g*v)+m}}return{format:u,formatPrefix:c}}var xO,pOe,gOe;$Bt({thousands:",",grouping:[3],currency:["$",""]});function $Bt(e){return xO=dOe(e),pOe=xO.format,gOe=xO.formatPrefix,xO}function CBt(e){return Math.max(0,-Gw(Math.abs(e)))}function _Bt(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Gw(t)/3)))*3-Gw(Math.abs(e)))}function SBt(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Gw(t)-Gw(e))+1}const Mj=new Date,Fj=new Date;function Bi(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>Bi(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(Mj.setTime(+s),Fj.setTime(+a),e(Mj),e(Fj),Math.floor(n(Mj,Fj))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const RT=Bi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);RT.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Bi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):RT);RT.range;const PT=1e3,X0=PT*60,LT=X0*60,BT=LT*24,mOe=BT*7,Are=Bi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*PT)},(e,t)=>(t-e)/PT,e=>e.getUTCSeconds());Are.range;const vOe=Bi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*PT)},(e,t)=>{e.setTime(+e+t*X0)},(e,t)=>(t-e)/X0,e=>e.getMinutes());vOe.range;const yOe=Bi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*X0)},(e,t)=>(t-e)/X0,e=>e.getUTCMinutes());yOe.range;const bOe=Bi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*PT-e.getMinutes()*X0)},(e,t)=>{e.setTime(+e+t*LT)},(e,t)=>(t-e)/LT,e=>e.getHours());bOe.range;const xOe=Bi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*LT)},(e,t)=>(t-e)/LT,e=>e.getUTCHours());xOe.range;const aA=Bi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*X0)/BT,e=>e.getDate()-1);aA.range;const oA=Bi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/BT,e=>e.getUTCDate()-1);oA.range;const kBt=Bi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/BT,e=>Math.floor(e/BT));kBt.range;function ex(e){return Bi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*X0)/mOe)}const Tre=ex(0),EBt=ex(1),ABt=ex(2),TBt=ex(3),DBt=ex(4),IBt=ex(5),NBt=ex(6);Tre.range;EBt.range;ABt.range;TBt.range;DBt.range;IBt.range;NBt.range;function tx(e){return Bi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/mOe)}const Dre=tx(0),MBt=tx(1),FBt=tx(2),OBt=tx(3),RBt=tx(4),PBt=tx(5),LBt=tx(6);Dre.range;MBt.range;FBt.range;OBt.range;RBt.range;PBt.range;LBt.range;const mX=Bi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());mX.range;const vX=Bi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());vX.range;const Ire=Bi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ire.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Bi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Ire.range;const Nre=Bi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Nre.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Bi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Nre.range;function Oj(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function BBt(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function zBt(e){let t,n,r;e.length!==2?(t=Oj,n=(o,l)=>Oj(e(o),l),r=(o,l)=>e(o)-l):(t=e===Oj||e===BBt?e:UBt,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function UBt(){return 0}const WBt=Math.sqrt(50),VBt=Math.sqrt(10),jBt=Math.sqrt(2);function wOe(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=WBt?10:s>=VBt?5:s>=jBt?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?wOe(e,t,n*2):[o,l,u]}function fme(e,t,n){return t=+t,e=+e,n=+n,wOe(e,t,n)[2]}function hme(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?fme(t,e,n):fme(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}const wa="year",ql="quarter",oo="month",es="week",Gl="date",eo="day",Rp="dayofyear",Ou="hours",Ru="minutes",ef="seconds",Rh="milliseconds",$Oe=[wa,ql,oo,es,Gl,eo,Rp,Ou,Ru,ef,Rh],Rj=$Oe.reduce((e,t,n)=>(e[t]=1+n,e),{});function COe(e){const t=ct(e).slice(),n={};return t.length||$e("Missing time unit."),t.forEach(i=>{bt(Rj,i)?n[i]=1:$e(`Invalid time unit: ${i}.`)}),(n[es]||n[eo]?1:0)+(n[ql]||n[oo]||n[Gl]?1:0)+(n[Rp]?1:0)>1&&$e(`Incompatible time units: ${e}`),t.sort((i,s)=>Rj[i]-Rj[s]),t}const HBt={[wa]:"%Y ",[ql]:"Q%q ",[oo]:"%b ",[Gl]:"%d ",[es]:"W%U ",[eo]:"%a ",[Rp]:"%j ",[Ou]:"%H:00",[Ru]:"00:%M",[ef]:":%S",[Rh]:".%L",[`${wa}-${oo}`]:"%Y-%m ",[`${wa}-${oo}-${Gl}`]:"%Y-%m-%d ",[`${Ou}-${Ru}`]:"%H:%M"};function qBt(e,t){const n=zt({},HBt,t),r=COe(e),i=r.length;let s="",a=0,o,l;for(a=0;a<i;)for(o=r.length;o>a;--o)if(l=r.slice(a,o).join("-"),n[l]!=null){s+=n[l],a=o;break}return s.trim()}const u1=new Date;function Mre(e){return u1.setFullYear(e),u1.setMonth(0),u1.setDate(1),u1.setHours(0,0,0,0),u1}function GBt(e){return _Oe(new Date(e))}function YBt(e){return yX(new Date(e))}function _Oe(e){return aA.count(Mre(e.getFullYear())-1,e)}function yX(e){return Tre.count(Mre(e.getFullYear())-1,e)}function bX(e){return Mre(e).getDay()}function XBt(e,t,n,r,i,s,a){if(0<=e&&e<100){const o=new Date(-1,t,n,r,i,s,a);return o.setFullYear(e),o}return new Date(e,t,n,r,i,s,a)}function KBt(e){return SOe(new Date(e))}function ZBt(e){return xX(new Date(e))}function SOe(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return oA.count(t-1,e)}function xX(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Dre.count(t-1,e)}function wX(e){return u1.setTime(Date.UTC(e,0,1)),u1.getUTCDay()}function QBt(e,t,n,r,i,s,a){if(0<=e&&e<100){const o=new Date(Date.UTC(-1,t,n,r,i,s,a));return o.setUTCFullYear(n.y),o}return new Date(Date.UTC(e,t,n,r,i,s,a))}function kOe(e,t,n,r,i){const s=t||1,a=ln(e),o=(v,y,b)=>(b=b||v,JBt(n[b],r[b],v===a&&s,y)),l=new Date,u=Oh(e),c=u[wa]?o(wa):go(2012),f=u[oo]?o(oo):u[ql]?o(ql):l1,h=u[es]&&u[eo]?o(eo,1,es+eo):u[es]?o(es,1):u[eo]?o(eo,1):u[Gl]?o(Gl,1):u[Rp]?o(Rp,1):HN,d=u[Ou]?o(Ou):l1,p=u[Ru]?o(Ru):l1,g=u[ef]?o(ef):l1,m=u[Rh]?o(Rh):l1;return function(v){l.setTime(+v);const y=c(l);return i(y,f(l),h(l,y),d(l),p(l),g(l),m(l))}}function JBt(e,t,n,r){const i=n<=1?e:r?(s,a)=>r+n*Math.floor((e(s,a)-r)/n):(s,a)=>n*Math.floor(e(s,a)/n);return t?(s,a)=>t(i(s,a),a):i}function Yw(e,t,n){return t+e*7-(n+6)%7}const e8t={[wa]:e=>e.getFullYear(),[ql]:e=>Math.floor(e.getMonth()/3),[oo]:e=>e.getMonth(),[Gl]:e=>e.getDate(),[Ou]:e=>e.getHours(),[Ru]:e=>e.getMinutes(),[ef]:e=>e.getSeconds(),[Rh]:e=>e.getMilliseconds(),[Rp]:e=>_Oe(e),[es]:e=>yX(e),[es+eo]:(e,t)=>Yw(yX(e),e.getDay(),bX(t)),[eo]:(e,t)=>Yw(1,e.getDay(),bX(t))},t8t={[ql]:e=>3*e,[es]:(e,t)=>Yw(e,0,bX(t))};function n8t(e,t){return kOe(e,t||1,e8t,t8t,XBt)}const r8t={[wa]:e=>e.getUTCFullYear(),[ql]:e=>Math.floor(e.getUTCMonth()/3),[oo]:e=>e.getUTCMonth(),[Gl]:e=>e.getUTCDate(),[Ou]:e=>e.getUTCHours(),[Ru]:e=>e.getUTCMinutes(),[ef]:e=>e.getUTCSeconds(),[Rh]:e=>e.getUTCMilliseconds(),[Rp]:e=>SOe(e),[es]:e=>xX(e),[eo]:(e,t)=>Yw(1,e.getUTCDay(),wX(t)),[es+eo]:(e,t)=>Yw(xX(e),e.getUTCDay(),wX(t))},i8t={[ql]:e=>3*e,[es]:(e,t)=>Yw(e,0,wX(t))};function s8t(e,t){return kOe(e,t||1,r8t,i8t,QBt)}const a8t={[wa]:Ire,[ql]:mX.every(3),[oo]:mX,[es]:Tre,[Gl]:aA,[eo]:aA,[Rp]:aA,[Ou]:bOe,[Ru]:vOe,[ef]:Are,[Rh]:RT},o8t={[wa]:Nre,[ql]:vX.every(3),[oo]:vX,[es]:Dre,[Gl]:oA,[eo]:oA,[Rp]:oA,[Ou]:xOe,[Ru]:yOe,[ef]:Are,[Rh]:RT};function GN(e){return a8t[e]}function YN(e){return o8t[e]}function EOe(e,t,n){return e?e.offset(t,n):void 0}function l8t(e,t,n){return EOe(GN(e),t,n)}function u8t(e,t,n){return EOe(YN(e),t,n)}function AOe(e,t,n,r){return e?e.range(t,n,r):void 0}function c8t(e,t,n,r){return AOe(GN(e),t,n,r)}function f8t(e,t,n,r){return AOe(YN(e),t,n,r)}const lE=1e3,uE=lE*60,cE=uE*60,K7=cE*24,h8t=K7*7,dme=K7*30,$X=K7*365,TOe=[wa,oo,Gl,Ou,Ru,ef,Rh],fE=TOe.slice(0,-1),hE=fE.slice(0,-1),dE=hE.slice(0,-1),d8t=dE.slice(0,-1),p8t=[wa,es],pme=[wa,oo],DOe=[wa],JS=[[fE,1,lE],[fE,5,5*lE],[fE,15,15*lE],[fE,30,30*lE],[hE,1,uE],[hE,5,5*uE],[hE,15,15*uE],[hE,30,30*uE],[dE,1,cE],[dE,3,3*cE],[dE,6,6*cE],[dE,12,12*cE],[d8t,1,K7],[p8t,1,h8t],[pme,1,dme],[pme,3,3*dme],[DOe,1,$X]];function g8t(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(X7(t))/n;let i=zBt(o=>o[2]).right(JS,r),s,a;return i===JS.length?(s=DOe,a=hme(t[0]/$X,t[1]/$X,n)):i?(i=JS[r/JS[i-1][2]<JS[i][2]/r?i-1:i],s=i[0],a=i[1]):(s=TOe,a=Math.max(hme(t[0],t[1],n),1)),{units:s,step:a}}const Pj=new Date,Lj=new Date;function ad(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>ad(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(Pj.setTime(+s),Lj.setTime(+a),e(Pj),e(Lj),Math.floor(n(Pj,Lj))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const m8t=1e3,Fre=m8t*60,v8t=Fre*60,zT=v8t*24,IOe=zT*7,Ore=ad(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Fre)/zT,e=>e.getDate()-1);Ore.range;const Rre=ad(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/zT,e=>e.getUTCDate()-1);Rre.range;const y8t=ad(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/zT,e=>Math.floor(e/zT));y8t.range;function nx(e){return ad(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Fre)/IOe)}const NOe=nx(0),tP=nx(1),b8t=nx(2),x8t=nx(3),Xw=nx(4),w8t=nx(5),$8t=nx(6);NOe.range;tP.range;b8t.range;x8t.range;Xw.range;w8t.range;$8t.range;function rx(e){return ad(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/IOe)}const MOe=rx(0),nP=rx(1),C8t=rx(2),_8t=rx(3),Kw=rx(4),S8t=rx(5),k8t=rx(6);MOe.range;nP.range;C8t.range;_8t.range;Kw.range;S8t.range;k8t.range;const qy=ad(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());qy.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ad(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});qy.range;const Gy=ad(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Gy.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ad(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Gy.range;function Bj(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function zj(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ek(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function FOe(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=tk(i),c=nk(i),f=tk(s),h=nk(s),d=tk(a),p=nk(a),g=tk(o),m=nk(o),v=tk(l),y=nk(l),b={a:F,A:R,b:P,B:V,c:null,d:xme,e:xme,f:X8t,g:szt,G:ozt,H:q8t,I:G8t,j:Y8t,L:OOe,m:K8t,M:Z8t,p:z,q,Q:Cme,s:_me,S:Q8t,u:J8t,U:ezt,V:tzt,w:nzt,W:rzt,x:null,X:null,y:izt,Y:azt,Z:lzt,"%":$me},x={a:G,A:K,b:Y,B:te,c:null,d:wme,e:wme,f:hzt,g:$zt,G:_zt,H:uzt,I:czt,j:fzt,L:POe,m:dzt,M:pzt,p:Z,q:ae,Q:Cme,s:_me,S:gzt,u:mzt,U:vzt,V:yzt,w:bzt,W:xzt,x:null,X:null,y:wzt,Y:Czt,Z:Szt,"%":$me},w={a:E,A:S,b:I,B:A,c:D,d:yme,e:yme,f:W8t,g:vme,G:mme,H:bme,I:bme,j:L8t,L:U8t,m:P8t,M:B8t,p:k,q:R8t,Q:j8t,s:H8t,S:z8t,u:I8t,U:N8t,V:M8t,w:D8t,W:F8t,x:T,X:N,y:vme,Y:mme,Z:O8t,"%":V8t};b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x);function C(O,L){return function(W){var M=[],ue=-1,X=0,se=O.length,oe,pe,Ce;for(W instanceof Date||(W=new Date(+W));++ue<se;)O.charCodeAt(ue)===37&&(M.push(O.slice(X,ue)),(pe=gme[oe=O.charAt(++ue)])!=null?oe=O.charAt(++ue):pe=oe==="e"?" ":"0",(Ce=L[oe])&&(oe=Ce(W,pe)),M.push(oe),X=ue+1);return M.push(O.slice(X,ue)),M.join("")}}function $(O,L){return function(W){var M=ek(1900,void 0,1),ue=_(M,O,W+="",0),X,se;if(ue!=W.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(L&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(X=zj(ek(M.y,0,1)),se=X.getUTCDay(),X=se>4||se===0?nP.ceil(X):nP(X),X=Rre.offset(X,(M.V-1)*7),M.y=X.getUTCFullYear(),M.m=X.getUTCMonth(),M.d=X.getUTCDate()+(M.w+6)%7):(X=Bj(ek(M.y,0,1)),se=X.getDay(),X=se>4||se===0?tP.ceil(X):tP(X),X=Ore.offset(X,(M.V-1)*7),M.y=X.getFullYear(),M.m=X.getMonth(),M.d=X.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),se="Z"in M?zj(ek(M.y,0,1)).getUTCDay():Bj(ek(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(se+5)%7:M.w+M.U*7-(se+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,zj(M)):Bj(M)}}function _(O,L,W,M){for(var ue=0,X=L.length,se=W.length,oe,pe;ue<X;){if(M>=se)return-1;if(oe=L.charCodeAt(ue++),oe===37){if(oe=L.charAt(ue++),pe=w[oe in gme?L.charAt(ue++):oe],!pe||(M=pe(O,W,M))<0)return-1}else if(oe!=W.charCodeAt(M++))return-1}return M}function k(O,L,W){var M=u.exec(L.slice(W));return M?(O.p=c.get(M[0].toLowerCase()),W+M[0].length):-1}function E(O,L,W){var M=d.exec(L.slice(W));return M?(O.w=p.get(M[0].toLowerCase()),W+M[0].length):-1}function S(O,L,W){var M=f.exec(L.slice(W));return M?(O.w=h.get(M[0].toLowerCase()),W+M[0].length):-1}function I(O,L,W){var M=v.exec(L.slice(W));return M?(O.m=y.get(M[0].toLowerCase()),W+M[0].length):-1}function A(O,L,W){var M=g.exec(L.slice(W));return M?(O.m=m.get(M[0].toLowerCase()),W+M[0].length):-1}function D(O,L,W){return _(O,t,L,W)}function T(O,L,W){return _(O,n,L,W)}function N(O,L,W){return _(O,r,L,W)}function F(O){return a[O.getDay()]}function R(O){return s[O.getDay()]}function P(O){return l[O.getMonth()]}function V(O){return o[O.getMonth()]}function z(O){return i[+(O.getHours()>=12)]}function q(O){return 1+~~(O.getMonth()/3)}function G(O){return a[O.getUTCDay()]}function K(O){return s[O.getUTCDay()]}function Y(O){return l[O.getUTCMonth()]}function te(O){return o[O.getUTCMonth()]}function Z(O){return i[+(O.getUTCHours()>=12)]}function ae(O){return 1+~~(O.getUTCMonth()/3)}return{format:function(O){var L=C(O+="",b);return L.toString=function(){return O},L},parse:function(O){var L=$(O+="",!1);return L.toString=function(){return O},L},utcFormat:function(O){var L=C(O+="",x);return L.toString=function(){return O},L},utcParse:function(O){var L=$(O+="",!0);return L.toString=function(){return O},L}}}var gme={"-":"",_:" ",0:"0"},bs=/^\s*\d+/,E8t=/^%/,A8t=/[\\^$*+?|[\]().{}]/g;function wn(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function T8t(e){return e.replace(A8t,"\\$&")}function tk(e){return new RegExp("^(?:"+e.map(T8t).join("|")+")","i")}function nk(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function D8t(e,t,n){var r=bs.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function I8t(e,t,n){var r=bs.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function N8t(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function M8t(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function F8t(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function mme(e,t,n){var r=bs.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function vme(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function O8t(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function R8t(e,t,n){var r=bs.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function P8t(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function yme(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function L8t(e,t,n){var r=bs.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function bme(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function B8t(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function z8t(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function U8t(e,t,n){var r=bs.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function W8t(e,t,n){var r=bs.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function V8t(e,t,n){var r=E8t.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function j8t(e,t,n){var r=bs.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function H8t(e,t,n){var r=bs.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function xme(e,t){return wn(e.getDate(),t,2)}function q8t(e,t){return wn(e.getHours(),t,2)}function G8t(e,t){return wn(e.getHours()%12||12,t,2)}function Y8t(e,t){return wn(1+Ore.count(qy(e),e),t,3)}function OOe(e,t){return wn(e.getMilliseconds(),t,3)}function X8t(e,t){return OOe(e,t)+"000"}function K8t(e,t){return wn(e.getMonth()+1,t,2)}function Z8t(e,t){return wn(e.getMinutes(),t,2)}function Q8t(e,t){return wn(e.getSeconds(),t,2)}function J8t(e){var t=e.getDay();return t===0?7:t}function ezt(e,t){return wn(NOe.count(qy(e)-1,e),t,2)}function ROe(e){var t=e.getDay();return t>=4||t===0?Xw(e):Xw.ceil(e)}function tzt(e,t){return e=ROe(e),wn(Xw.count(qy(e),e)+(qy(e).getDay()===4),t,2)}function nzt(e){return e.getDay()}function rzt(e,t){return wn(tP.count(qy(e)-1,e),t,2)}function izt(e,t){return wn(e.getFullYear()%100,t,2)}function szt(e,t){return e=ROe(e),wn(e.getFullYear()%100,t,2)}function azt(e,t){return wn(e.getFullYear()%1e4,t,4)}function ozt(e,t){var n=e.getDay();return e=n>=4||n===0?Xw(e):Xw.ceil(e),wn(e.getFullYear()%1e4,t,4)}function lzt(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+wn(t/60|0,"0",2)+wn(t%60,"0",2)}function wme(e,t){return wn(e.getUTCDate(),t,2)}function uzt(e,t){return wn(e.getUTCHours(),t,2)}function czt(e,t){return wn(e.getUTCHours()%12||12,t,2)}function fzt(e,t){return wn(1+Rre.count(Gy(e),e),t,3)}function POe(e,t){return wn(e.getUTCMilliseconds(),t,3)}function hzt(e,t){return POe(e,t)+"000"}function dzt(e,t){return wn(e.getUTCMonth()+1,t,2)}function pzt(e,t){return wn(e.getUTCMinutes(),t,2)}function gzt(e,t){return wn(e.getUTCSeconds(),t,2)}function mzt(e){var t=e.getUTCDay();return t===0?7:t}function vzt(e,t){return wn(MOe.count(Gy(e)-1,e),t,2)}function LOe(e){var t=e.getUTCDay();return t>=4||t===0?Kw(e):Kw.ceil(e)}function yzt(e,t){return e=LOe(e),wn(Kw.count(Gy(e),e)+(Gy(e).getUTCDay()===4),t,2)}function bzt(e){return e.getUTCDay()}function xzt(e,t){return wn(nP.count(Gy(e)-1,e),t,2)}function wzt(e,t){return wn(e.getUTCFullYear()%100,t,2)}function $zt(e,t){return e=LOe(e),wn(e.getUTCFullYear()%100,t,2)}function Czt(e,t){return wn(e.getUTCFullYear()%1e4,t,4)}function _zt(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Kw(e):Kw.ceil(e),wn(e.getUTCFullYear()%1e4,t,4)}function Szt(){return"+0000"}function $me(){return"%"}function Cme(e){return+e}function _me(e){return Math.floor(+e/1e3)}var i2,BOe,zOe,UOe,WOe;kzt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function kzt(e){return i2=FOe(e),BOe=i2.format,zOe=i2.parse,UOe=i2.utcFormat,WOe=i2.utcParse,i2}function pE(e){const t={};return n=>t[n]||(t[n]=e(n))}function Ezt(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=Azt(r,i);const a=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+a}}function Azt(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function VOe(e){const t=pE(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=OT(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return Ezt(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,a){a=OT(a==null?",f":a);const o=gBt(r,i,s),l=Math.max(Math.abs(r),Math.abs(i));let u;if(a.precision==null)switch(a.type){case"s":return isNaN(u=_Bt(o,l))||(a.precision=u),n(a,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=SBt(o,l))||(a.precision=u-(a.type==="e"));break}case"f":case"%":{isNaN(u=CBt(o))||(a.precision=u-(a.type==="%")*2);break}}return t(a)}}}let CX;Tzt();function Tzt(){return CX=VOe({format:pOe,formatPrefix:gOe})}function jOe(e){return VOe(dOe(e))}function _X(e){return arguments.length?CX=jOe(e):CX}function Sme(e,t,n){n=n||{},Ft(n)||$e(`Invalid time multi-format specifier: ${n}`);const r=t(ef),i=t(Ru),s=t(Ou),a=t(Gl),o=t(es),l=t(oo),u=t(ql),c=t(wa),f=e(n[Rh]||".%L"),h=e(n[ef]||":%S"),d=e(n[Ru]||"%I:%M"),p=e(n[Ou]||"%I %p"),g=e(n[Gl]||n[eo]||"%a %d"),m=e(n[es]||"%b %d"),v=e(n[oo]||"%B"),y=e(n[ql]||"%B"),b=e(n[wa]||"%Y");return x=>(r(x)<x?f:i(x)<x?h:s(x)<x?d:a(x)<x?p:l(x)<x?o(x)<x?g:m:c(x)<x?u(x)<x?v:y:b)(x)}function HOe(e){const t=pE(e.format),n=pE(e.utcFormat);return{timeFormat:r=>wr(r)?t(r):Sme(t,GN,r),utcFormat:r=>wr(r)?n(r):Sme(n,YN,r),timeParse:pE(e.parse),utcParse:pE(e.utcParse)}}let SX;Dzt();function Dzt(){return SX=HOe({format:BOe,parse:zOe,utcFormat:UOe,utcParse:WOe})}function qOe(e){return HOe(FOe(e))}function rP(e){return arguments.length?SX=qOe(e):SX}const kX=(e,t)=>zt({},e,t);function Izt(e,t){const n=e?jOe(e):_X(),r=t?qOe(t):rP();return kX(n,r)}function Nzt(e,t){const n=arguments.length;return n&&n!==2&&$e("defaultLocale expects either zero or two arguments."),n?kX(_X(e),rP(t)):kX(_X(),rP())}const Mzt=/^(data:|([A-Za-z]+:)?\/\/)/,Fzt=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Ozt=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,kme="file://";function Rzt(e,t){return n=>({options:n||{},sanitize:Lzt,load:Pzt,fileAccess:!!t,file:Bzt(t),http:Uzt(e)})}async function Pzt(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function Lzt(e,t){t=zt({},this.options,t);const n=this.fileAccess,r={href:null};let i,s,a;const o=Fzt.test(e.replace(Ozt,""));(e==null||typeof e!="string"||!o)&&$e("Sanitize failure, invalid URI: "+ot(e));const l=Mzt.test(e);return(a=t.baseURL)&&!l&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),s=(i=e.startsWith(kme))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice(kme.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!s}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function Bzt(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,s)=>{i?r(i):n(s)})}):zzt}async function zzt(){$e("No file system access.")}function Uzt(e){return e?async function(t,n){const r=zt({},this.options.http,n),i=n&&n.response,s=await e(t,r);return s.ok?Ut(s[i])?s[i]():s.text():$e(s.status+""+s.statusText)}:Wzt}async function Wzt(){$e("No HTTP fetch method available.")}const Vzt=e=>e!=null&&e===e,jzt=e=>e==="true"||e==="false"||e===!0||e===!1,Hzt=e=>!Number.isNaN(Date.parse(e)),GOe=e=>!Number.isNaN(+e)&&!(e instanceof Date),qzt=e=>GOe(e)&&Number.isInteger(+e),Eme={boolean:tOe,integer:io,number:io,date:nOe,string:rOe,unknown:ll},wO=[jzt,qzt,GOe,Hzt],Gzt=["boolean","integer","number","date"];function Yzt(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=wO.length,i=wO.map((s,a)=>a+1);for(let s=0,a=0,o,l;s<n;++s)for(l=t?e[s][t]:e[s],o=0;o<r;++o)if(i[o]&&Vzt(l)&&!wO[o](l)&&(i[o]=0,++a,a===wO.length))return"string";return Gzt[i.reduce((s,a)=>s===0?a:s,0)-1]}function Xzt(e,t){return t.reduce((n,r)=>(n[r]=Yzt(e,r),n),{})}function Ame(e){const t=function(n,r){const i={delimiter:e};return Pre(n,r?zt(r,i):i)};return t.responseType="text",t}function Pre(e,t){return t.header&&(e=t.header.map(ot).join(t.delimiter)+`
`+e),sBt(t.delimiter).parse(e+"")}Pre.responseType="text";function Kzt(e){return typeof Buffer=="function"&&Ut(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function Lre(e,t){const n=t&&t.property?Hl(t.property):ll;return Ft(e)&&!Kzt(e)?Zzt(n(e),t):n(JSON.parse(e))}Lre.responseType="json";function Zzt(e,t){return!at(e)&&G6t(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const Qzt={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function YOe(e,t){let n,r,i,s;return e=Lre(e,t),t&&t.feature?(n=sOe,i=t.feature):t&&t.mesh?(n=oOe,i=t.mesh,s=Qzt[t.filter]):$e("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,s):$e("Invalid TopoJSON object: "+i),r&&r.features||[r]}YOe.responseType="json";const Uj={dsv:Pre,csv:Ame(","),tsv:Ame("	"),json:Lre,topojson:YOe};function XOe(e,t){return arguments.length>1?(Uj[e]=t,this):bt(Uj,e)?Uj[e]:null}function Jzt(e){const t=XOe(e);return t&&t.responseType||"text"}function e7t(e,t,n,r){t=t||{};const i=XOe(t.type||"json");return i||$e("Unknown data format type: "+t.type),e=i(e,t),t.parse&&t7t(e,t.parse,n,r),bt(e,"columns")&&delete e.columns,e}function t7t(e,t,n,r){if(!e.length)return;const i=rP();n=n||i.timeParse,r=r||i.utcParse;let s=e.columns||Object.keys(e[0]),a,o,l,u,c,f;t==="auto"&&(t=Xzt(e,s)),s=Object.keys(t);const h=s.map(d=>{const p=t[d];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?r:n)(m);if(!Eme[p])throw Error("Illegal format pattern: "+d+":"+p);return Eme[p]});for(l=0,c=e.length,f=s.length;l<c;++l)for(a=e[l],u=0;u<f;++u)o=s[u],a[o]=h[u](a[o])}const Bre=Rzt(typeof fetch<"u"&&fetch,null);function Z7(e){const t=e||ll,n=[],r={};return n.add=i=>{const s=t(i);return r[s]||(r[s]=1,n.push(i)),n},n.remove=i=>{const s=t(i);if(r[s]){r[s]=0;const a=n.indexOf(i);a>=0&&n.splice(a,1)}return n},n}async function r4(e,t){try{await t(e)}catch(n){e.error(n)}}const KOe=Symbol("vega_id");let n7t=1;function P_(e){return!!(e&&nt(e))}function nt(e){return e[KOe]}function ZOe(e,t){return e[KOe]=t,e}function Tn(e){const t=e===Object(e)?e:{data:e};return nt(t)?t:ZOe(t,n7t++)}function zre(e){return Q7(e,Tn({}))}function Q7(e,t){for(const n in e)t[n]=e[n];return t}function QOe(e,t){return ZOe(t,nt(e))}function ix(e,t){return e?t?(n,r)=>e(n,r)||nt(t(n))-nt(t(r)):(n,r)=>e(n,r)||nt(n)-nt(r):null}function JOe(e){return e&&e.constructor===sx}function sx(){const e=[],t=[],n=[],r=[],i=[];let s=null,a=!1;return{constructor:sx,insert(o){const l=ct(o),u=l.length;for(let c=0;c<u;++c)e.push(l[c]);return this},remove(o){const l=Ut(o)?r:t,u=ct(o),c=u.length;for(let f=0;f<c;++f)l.push(u[f]);return this},modify(o,l,u){const c={field:l,value:go(u)};return Ut(o)?(c.filter=o,i.push(c)):(c.tuple=o,n.push(c)),this},encode(o,l){return Ut(o)?i.push({filter:o,field:l}):n.push({tuple:o,field:l}),this},clean(o){return s=o,this},reflow(){return a=!0,this},pulse(o,l){const u={},c={};let f,h,d,p,g,m;for(f=0,h=l.length;f<h;++f)u[nt(l[f])]=1;for(f=0,h=t.length;f<h;++f)g=t[f],u[nt(g)]=-1;for(f=0,h=r.length;f<h;++f)p=r[f],l.forEach(y=>{p(y)&&(u[nt(y)]=-1)});for(f=0,h=e.length;f<h;++f)g=e[f],m=nt(g),u[m]?u[m]=1:o.add.push(Tn(e[f]));for(f=0,h=l.length;f<h;++f)g=l[f],u[nt(g)]<0&&o.rem.push(g);function v(y,b,x){x?y[b]=x(y):o.encode=b,a||(c[nt(y)]=y)}for(f=0,h=n.length;f<h;++f)d=n[f],g=d.tuple,p=d.field,m=u[nt(g)],m>0&&(v(g,p,d.value),o.modifies(p));for(f=0,h=i.length;f<h;++f)d=i[f],p=d.filter,l.forEach(y=>{p(y)&&u[nt(y)]>0&&v(y,d.field,d.value)}),o.modifies(d.field);if(a)o.mod=t.length||r.length?l.filter(y=>u[nt(y)]>0):l.slice();else for(m in c)o.mod.push(c[m]);return(s||s==null&&(t.length||r.length))&&o.clean(!0),o}}}const i4="_:mod:_";function J7(){Object.defineProperty(this,i4,{writable:!0,value:{}})}J7.prototype={set(e,t,n,r){const i=this,s=i[e],a=i[i4];return t!=null&&t>=0?(s[t]!==n||r)&&(s[t]=n,a[t+":"+e]=-1,a[e]=-1):(s!==n||r)&&(i[e]=n,a[e]=at(n)?1+n.length:-1),i},modified(e,t){const n=this[i4];if(arguments.length){if(at(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[i4]={},this}};let r7t=0;const i7t="pulse",s7t=new J7,a7t=1,o7t=2;function Jn(e,t,n,r){this.id=++r7t,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function Tme(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Jn.prototype={targets(){return this._targets||(this._targets=Z7(q7))},set(e){return this.value!==e?(this.value=e,1):0},skip:Tme(a7t),modified:Tme(o7t),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new J7,i=this._argops=this._argops||[],s=[];let a,o,l,u;const c=(f,h,d)=>{d instanceof Jn?(d!==this&&(t&&d.targets().add(this),s.push(d)),i.push({op:d,name:f,index:h})):r.set(f,h,d)};for(a in e)if(o=e[a],a===i7t)ct(o).forEach(f=>{f instanceof Jn?f!==this&&(f.targets().add(this),s.push(f)):$e("Pulse parameters must be operator instances.")}),this.source=o;else if(at(o))for(r.set(a,-1,Array(l=o.length)),u=0;u<l;++u)c(a,u,o[u]);else c(a,-1,o);return this.marshall().clear(),n&&(i.initonly=!0),s},marshall(e){const t=this._argval||s7t,n=this._argops;let r,i,s,a;if(n){const o=n.length;for(i=0;i<o;++i)r=n[i],s=r.op,a=s.modified()&&s.stamp===e,t.set(r.name,r.index,s.value,a);if(n.initonly){for(i=0;i<o;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function l7t(e,t,n,r){let i=1,s;return e instanceof Jn?s=e:e&&e.prototype instanceof Jn?s=new e:Ut(e)?s=new Jn(null,e):(i=0,s=new Jn(e,t)),this.rank(s),i&&(r=n,n=t),n&&this.connect(s,s.parameters(n,r)),this.touch(s),s}function u7t(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let c7t=0;function e9(e,t,n){this.id=++c7t,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Ig(e,t,n){return new e9(e,t,n)}e9.prototype={_filter:Jc,_apply:ll,targets(){return this._targets||(this._targets=Z7(q7))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Ig(e);return this.targets().add(t),t},apply(e){const t=Ig(null,e);return this.targets().add(t),t},merge(){const e=Ig();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Ig();return this.targets().add(Ig(null,null,JFe(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(Ig(null,null,()=>n=!0)),t.targets().add(Ig(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Jc,this._targets=null}};function f7t(e,t,n,r){const i=this,s=Ig(n,r),a=function(u){u.dataflow=i;try{s.receive(u)}catch(c){i.error(c)}finally{i.run()}};let o;typeof e=="string"&&typeof document<"u"?o=document.querySelectorAll(e):o=ct(e);const l=o.length;for(let u=0;u<l;++u)o[u].addEventListener(t,a);return s}function h7t(e,t){const n=this.locale();return e7t(e,t,n.timeParse,n.utcParse)}function d7t(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function p7t(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:Jzt(t&&t.type)});try{i=n.parse(i,t)}catch(s){r=-2,n.warn("Data ingestion failed",e,s)}}catch(s){r=-1,n.warn("Loading failed",e,s)}return{data:i,status:r}}async function g7t(e,t,n){const r=this,i=r._pending||m7t(r);i.requests+=1;const s=await r.request(t,n);return r.pulse(e,r.changeset().remove(Jc).insert(s.data||[])),i.done(),s}function m7t(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const v7t={skip:!0};function y7t(e,t,n,r,i){return(e instanceof Jn?x7t:b7t)(this,e,t,n,r,i),this}function b7t(e,t,n,r,i,s){const a=zt({},s,v7t);let o,l;Ut(n)||(n=go(n)),r===void 0?o=u=>e.touch(n(u)):Ut(r)?(l=new Jn(null,r,i,!1),o=u=>{l.evaluate(u);const c=n(u),f=l.value;JOe(f)?e.pulse(c,f,s):e.update(c,f,a)}):o=u=>e.update(n(u),r,a),t.apply(o)}function x7t(e,t,n,r,i,s){if(r===void 0)t.targets().add(n);else{const a=s||{},o=new Jn(null,w7t(n,r),i,!1);o.modified(a.force),o.rank=t.rank,t.targets().add(o),n&&(o.skip(!0),o.value=n.value,o.targets().add(n),e.connect(n,[o]))}}function w7t(e,t){return t=Ut(t)?t:go(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function $7t(e){e.rank=++this._rank}function C7t(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&$e("Cycle detected in dataflow graph.")}const iP={},Nf=1<<0,Fg=1<<1,Ld=1<<2,_7t=Nf|Fg,Dme=Nf|Ld,s2=Nf|Fg|Ld,Ime=1<<3,rk=1<<4,Nme=1<<5,Mme=1<<6;function m0(e,t,n){this.dataflow=e,this.stamp=t==null?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Wj(e,t){const n=[];return Xv(e,t,r=>n.push(r)),n}function Fme(e,t){const n={};return e.visit(t,r=>{n[nt(r)]=1}),r=>n[nt(r)]?null:r}function $O(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}m0.prototype={StopPropagation:iP,ADD:Nf,REM:Fg,MOD:Ld,ADD_REM:_7t,ADD_MOD:Dme,ALL:s2,REFLOW:Ime,SOURCE:rk,NO_SOURCE:Nme,NO_FIELDS:Mme,fork(e){return new m0(this.dataflow).init(this,e)},clone(){const e=this.fork(s2);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(s2|rk)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new m0(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&Mme)&&(n.fields=e.fields),t&Nf?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Fg?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Ld?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&Nme?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||s2;return t&Nf&&this.add.length||t&Fg&&this.rem.length||t&Ld&&this.mod.length},reflow(e){if(e)return this.fork(s2).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Ld,Fme(this,Nf))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return at(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?at(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Nf&&(n.addF=$O(n.addF,t)),e&Fg&&(n.remF=$O(n.remF,t)),e&Ld&&(n.modF=$O(n.modF,t)),e&rk&&(n.srcF=$O(n.srcF,t)),n},materialize(e){e=e||s2;const t=this;return e&Nf&&t.addF&&(t.add=Wj(t.add,t.addF),t.addF=null),e&Fg&&t.remF&&(t.rem=Wj(t.rem,t.remF),t.remF=null),e&Ld&&t.modF&&(t.mod=Wj(t.mod,t.modF),t.modF=null),e&rk&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&rk)return Xv(n.source,n.srcF,r),n;e&Nf&&Xv(n.add,n.addF,r),e&Fg&&Xv(n.rem,n.remF,r),e&Ld&&Xv(n.mod,n.modF,r);const i=n.source;if(e&Ime&&i){const s=n.add.length+n.mod.length;s===i.length||(s?Xv(i,Fme(n,Dme),r):Xv(i,n.srcF,r))}return n}};function Ure(e,t,n,r){const i=this;let s=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(const a of n)if(a.stamp===t){if(a.fields){const o=i.fields||(i.fields={});for(const l in a.fields)o[l]=1}a.changed(i.ADD)&&(s|=i.ADD),a.changed(i.REM)&&(s|=i.REM),a.changed(i.MOD)&&(s|=i.MOD)}this.changes=s}Ie(Ure,m0,{fork(e){const t=new m0(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?at(e)?e.some(r=>n[r]):n[e]:0},filter(){$e("MultiPulse does not support filtering.")},materialize(){$e("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let s=0;if(e&n.SOURCE)for(;s<i;++s)r[s].visit(e,t);else for(;s<i;++s)r[s].stamp===n.stamp&&r[s].visit(e,t);return n}});async function S7t(e,t,n){const r=this,i=[];if(r._pulse)return eRe(r);if(r._pending&&await r._pending,t&&await r4(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const s=++r._clock;r._pulse=new m0(r,s,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=Z7(q7);let a=0,o,l,u;try{for(;r._heap.size()>0;){if(o=r._heap.pop(),o.rank!==o.qrank){r._enqueue(o,!0);continue}l=o.run(r._getPulse(o,e)),l.then?l=await l:l.async&&(i.push(l.async),l=iP),l!==iP&&o._targets&&o._targets.forEach(c=>r._enqueue(c)),++a}}catch(c){r._heap.clear(),u=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${s}: ${a} operators`),u&&(r._postrun=[],r.error(u)),r._postrun.length){const c=r._postrun.sort((f,h)=>h.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await r4(r,c[f].callback)}return n&&await r4(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(h){r.error(h)}})})),r}async function k7t(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function E7t(e,t,n){return this._pulse?eRe(this):(this.evaluate(e,t,n),this)}function A7t(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function eRe(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function T7t(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function D7t(e,t){const n=e.source,r=this._clock;return n&&at(n)?new Ure(this,r,n.map(i=>i.pulse),t):this._input[e.id]||I7t(this._pulse,n&&n.pulse)}function I7t(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==iP&&(e.source=t.source),e)}const Wre={skip:!1,force:!1};function N7t(e,t){const n=t||Wre;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function M7t(e,t,n){const r=n||Wre;return(e.set(t)||r.force)&&this.touch(e,r),this}function F7t(e,t,n){this.touch(e,n||Wre);const r=new m0(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function O7t(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),tRe(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,R7t(t,0,e)):r=n,r}}}function tRe(e,t,n,r){let i,s;const a=e[n];for(;n>t;){if(s=n-1>>1,i=e[s],r(a,i)<0){e[n]=i,n=s;continue}break}return e[n]=a}function R7t(e,t,n){const r=t,i=e.length,s=e[t];let a=(t<<1)+1,o;for(;a<i;)o=a+1,o<i&&n(e[a],e[o])>=0&&(a=o),e[t]=e[a],t=a,a=(t<<1)+1;return e[t]=s,tRe(e,r,t,n)}function Q2(){this.logger(T6t()),this.logLevel(VFe),this._clock=0,this._rank=0,this._locale=Nzt();try{this._loader=Bre()}catch{}this._touched=Z7(q7),this._input={},this._pulse=null,this._heap=O7t((e,t)=>e.qrank-t.qrank),this._postrun=[]}function ik(e){return function(){return this._log[e].apply(this,arguments)}}Q2.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:ik("error"),warn:ik("warn"),info:ik("info"),debug:ik("debug"),logLevel:ik("level"),cleanThreshold:1e4,add:l7t,connect:u7t,rank:$7t,rerank:C7t,pulse:F7t,touch:N7t,update:M7t,changeset:sx,ingest:d7t,parse:h7t,preload:g7t,request:p7t,events:f7t,on:y7t,evaluate:S7t,run:E7t,runAsync:k7t,runAfter:A7t,_enqueue:T7t,_getPulse:D7t};function me(e,t){Jn.call(this,e,null,t)}Ie(me,Jn,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Zw={};function nRe(e){const t=rRe(e);return t&&t.Definition||null}function rRe(e){return e=e&&e.toLowerCase(),bt(Zw,e)?Zw[e]:null}function sP(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function P7t(e){return e===null?NaN:+e}function*L7t(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}function B7t(e,t){let n=0,r,i=0,s=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,s+=r*(a-i));else{let a=-1;for(let o of e)(o=t(o,++a,e))!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,s+=r*(o-i))}if(n>1)return s/(n-1)}function z7t(e,t){const n=B7t(e,t);return n&&Math.sqrt(n)}function U7t(e=sP){if(e===sP)return iRe;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function iRe(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function Ome(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Rme(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function sRe(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?iRe:U7t(i);r>n;){if(r-n>600){const l=r-n+1,u=t-n+1,c=Math.log(l),f=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*f*(l-f)/l)*(u-l/2<0?-1:1),d=Math.max(n,Math.floor(t-u*f/l+h)),p=Math.min(r,Math.floor(t+(l-u)*f/l+h));sRe(e,t,d,p,i)}const s=e[t];let a=n,o=r;for(sk(e,n,t),i(e[r],s)>0&&sk(e,n,r);a<o;){for(sk(e,a,o),++a,--o;i(e[a],s)<0;)++a;for(;i(e[o],s)>0;)--o}i(e[n],s)===0?sk(e,n,o):(++o,sk(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}return e}function sk(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function EX(e,t,n){if(e=Float64Array.from(L7t(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return Rme(e);if(t>=1)return Ome(e);var r,i=(r-1)*t,s=Math.floor(i),a=Ome(sRe(e,s).subarray(0,s+1)),o=Rme(e.subarray(s+1));return a+(o-a)*(i-s)}}function W7t(e,t,n=P7t){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function V7t(e,t){return EX(e,.5,t)}function*aRe(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function oRe(e,t,n){const r=Float64Array.from(aRe(e,n));return r.sort(sP),t.map(i=>W7t(r,i))}function lRe(e,t){return oRe(e,[.25,.5,.75],t)}function uRe(e,t){const n=e.length,r=z7t(e,t),i=lRe(e,t),s=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,s)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function j7t(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let s=e.extent[0],a=e.extent[1],o,l,u,c,f,h;const d=e.span||a-s||Math.abs(s)||1;if(e.step)o=e.step;else if(e.steps){for(c=d/t,f=0,h=e.steps.length;f<h&&e.steps[f]<c;++f);o=e.steps[Math.max(0,f-1)]}else{for(l=Math.ceil(Math.log(t)/r),u=e.minstep||0,o=Math.max(u,Math.pow(n,Math.round(Math.log(d)/r)-l));Math.ceil(d/o)>t;)o*=n;for(f=0,h=i.length;f<h;++f)c=o/i[f],c>=u&&d/c<=t&&(o=c)}c=Math.log(o);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/o+g)*o,s=s<c?c-o:c,a=Math.ceil(a/o)*o),{start:s,stop:a===s?s+o:a,step:o}}var Pp=Math.random;function H7t(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(aRe(e,r)),s=i.length,a=t;let o,l,u,c;for(u=0,c=Array(a);u<a;++u){for(o=0,l=0;l<s;++l)o+=i[~~(Pp()*s)];c[u]=o/s}return c.sort(sP),[EX(c,n/2),EX(c,1-n/2)]}function q7t(e,t,n,r){r=r||(h=>h);const i=e.length,s=new Float64Array(i);let a=0,o=1,l=r(e[0]),u=l,c=l+t,f;for(;o<i;++o){if(f=r(e[o]),f>=c){for(u=(l+u)/2;a<o;++a)s[a]=u;c=f+t,l=f}u=f}for(u=(l+u)/2;a<o;++a)s[a]=u;return n?G7t(s,t+t/4):s}function G7t(e,t){const n=e.length;let r=0,i=1,s,a;for(;e[r]===e[i];)++i;for(;i<n;){for(s=i+1;e[i]===e[s];)++s;if(e[i]-e[i-1]<t){for(a=i+(r+s-i-i>>1);a<i;)e[a++]=e[i];for(;a>i;)e[a--]=e[r]}r=i,i=s}return e}const cRe=Math.sqrt(2*Math.PI),Y7t=Math.SQRT2;let ak=NaN;function Vre(e,t){e=e||0,t=t==null?1:t;let n=0,r=0,i,s;if(ak===ak)n=ak,ak=NaN;else{do n=Pp()*2-1,r=Pp()*2-1,i=n*n+r*r;while(i===0||i>1);s=Math.sqrt(-2*Math.log(i)/i),n*=s,ak=r*s}return e+n*t}function fRe(e,t,n){n=n==null?1:n;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*cRe)}function jre(e,t,n){t=t||0,n=n==null?1:n;const r=(e-t)/n,i=Math.abs(r);let s;if(i>37)s=0;else{const a=Math.exp(-i*i/2);let o;i<7.07106781186547?(o=.0352624965998911*i+.700383064443688,o=o*i+6.37396220353165,o=o*i+33.912866078383,o=o*i+112.079291497871,o=o*i+221.213596169931,o=o*i+220.206867912376,s=a*o,o=.0883883476483184*i+1.75566716318264,o=o*i+16.064177579207,o=o*i+86.7807322029461,o=o*i+296.564248779674,o=o*i+637.333633378831,o=o*i+793.826512519948,o=o*i+440.413735824752,s=s/o):(o=i+.65,o=i+4/o,o=i+3/o,o=i+2/o,o=i+1/o,s=a/o/2.506628274631)}return r>0?1-s:s}function Hre(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*Y7t*X7t(2*e-1)}function X7t(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function hRe(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s==null?1:s,i):r},sample:()=>Vre(n,r),pdf:s=>fRe(s,n,r),cdf:s=>jre(s,n,r),icdf:s=>Hre(s,n,r)};return i.mean(e).stdev(t)}function dRe(e,t){const n=hRe();let r=0;const i={data(s){return arguments.length?(e=s,r=s?s.length:0,i.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=uRe(e)),i):t},sample(){return e[~~(Pp()*r)]+t*n.sample()},pdf(s){let a=0,o=0;for(;o<r;++o)a+=n.pdf((s-e[o])/t);return a/t/r},cdf(s){let a=0,o=0;for(;o<r;++o)a+=n.cdf((s-e[o])/t);return a/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function pRe(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+Vre()*t)}function gRe(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*cRe*e)}function mRe(e,t,n){return jre(Math.log(e),t,n)}function vRe(e,t,n){return Math.exp(Hre(e,t,n))}function K7t(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s==null?1:s,i):r},sample:()=>pRe(n,r),pdf:s=>gRe(s,n,r),cdf:s=>mRe(s,n,r),icdf:s=>vRe(s,n,r)};return i.mean(e).stdev(t)}function Z7t(e,t){let n=0,r;function i(a){const o=[];let l=0,u;for(u=0;u<n;++u)l+=o[u]=a[u]==null?1:+a[u];for(u=0;u<n;++u)o[u]/=l;return o}const s={weights(a){return arguments.length?(r=i(t=a||[]),s):t},distributions(a){return arguments.length?(a?(n=a.length,e=a):(n=0,e=[]),s.weights(t)):e},sample(){const a=Pp();let o=e[n-1],l=r[0],u=0;for(;u<n-1;l+=r[++u])if(a<l){o=e[u];break}return o.sample()},pdf(a){let o=0,l=0;for(;l<n;++l)o+=r[l]*e[l].pdf(a);return o},cdf(a){let o=0,l=0;for(;l<n;++l)o+=r[l]*e[l].cdf(a);return o},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function yRe(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*Pp()}function bRe(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function xRe(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function wRe(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function Q7t(e,t){let n,r;const i={min(s){return arguments.length?(n=s||0,i):n},max(s){return arguments.length?(r=s==null?1:s,i):r},sample:()=>yRe(n,r),pdf:s=>bRe(s,n,r),cdf:s=>xRe(s,n,r),icdf:s=>wRe(s,n,r)};return t==null&&(t=e==null?1:e,e=0),i.min(e).max(t)}function J7t(e,t,n){let r=0,i=0;for(const s of e){const a=n(s);t(s)==null||a==null||isNaN(a)||(r+=(a-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function XN(e,t,n,r){const i=r-e*e,s=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-s*e,s]}function t9(e,t,n,r){e=e.filter(d=>{let p=t(d),g=n(d);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((d,p)=>t(d)-t(p));const i=e.length,s=new Float64Array(i),a=new Float64Array(i);let o=0,l=0,u=0,c,f,h;for(h of e)s[o]=c=+t(h),a[o]=f=+n(h),++o,l+=(c-l)/o,u+=(f-u)/o;for(o=0;o<i;++o)s[o]-=l,a[o]-=u;return[s,a,l,u]}function KN(e,t,n,r){let i=-1,s,a;for(const o of e)s=t(o),a=n(o),s!=null&&(s=+s)>=s&&a!=null&&(a=+a)>=a&&r(s,a,++i)}function L_(e,t,n,r,i){let s=0,a=0;return KN(e,t,n,(o,l)=>{const u=l-i(o),c=l-r;s+=u*u,a+=c*c}),1-s/a}function $Re(e,t,n){let r=0,i=0,s=0,a=0,o=0;KN(e,t,n,(c,f)=>{++o,r+=(c-r)/o,i+=(f-i)/o,s+=(c*f-s)/o,a+=(c*c-a)/o});const l=XN(r,i,s,a),u=c=>l[0]+l[1]*c;return{coef:l,predict:u,rSquared:L_(e,t,n,i,u)}}function e9t(e,t,n){let r=0,i=0,s=0,a=0,o=0;KN(e,t,n,(c,f)=>{++o,c=Math.log(c),r+=(c-r)/o,i+=(f-i)/o,s+=(c*f-s)/o,a+=(c*c-a)/o});const l=XN(r,i,s,a),u=c=>l[0]+l[1]*Math.log(c);return{coef:l,predict:u,rSquared:L_(e,t,n,i,u)}}function t9t(e,t,n){const[r,i,s,a]=t9(e,t,n);let o=0,l=0,u=0,c=0,f=0,h,d,p;KN(e,t,n,(y,b)=>{h=r[f++],d=Math.log(b),p=h*b,o+=(b*d-o)/f,l+=(p-l)/f,u+=(p*d-u)/f,c+=(h*p-c)/f});const[g,m]=XN(l/a,o/a,u/a,c/a),v=y=>Math.exp(g+m*(y-s));return{coef:[Math.exp(g-m*s),m],predict:v,rSquared:L_(e,t,n,a,v)}}function n9t(e,t,n){let r=0,i=0,s=0,a=0,o=0,l=0;KN(e,t,n,(f,h)=>{const d=Math.log(f),p=Math.log(h);++l,r+=(d-r)/l,i+=(p-i)/l,s+=(d*p-s)/l,a+=(d*d-a)/l,o+=(h-o)/l});const u=XN(r,i,s,a),c=f=>u[0]*Math.pow(f,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:L_(e,t,n,o,c)}}function CRe(e,t,n){const[r,i,s,a]=t9(e,t,n),o=r.length;let l=0,u=0,c=0,f=0,h=0,d,p,g,m;for(d=0;d<o;)p=r[d],g=i[d++],m=p*p,l+=(m-l)/d,u+=(m*p-u)/d,c+=(m*m-c)/d,f+=(p*g-f)/d,h+=(m*g-h)/d;const v=c-l*l,y=l*v-u*u,b=(h*l-f*u)/y,x=(f*v-h*u)/y,w=-b*l,C=$=>($=$-s,b*$*$+x*$+w+a);return{coef:[w-x*s+b*s*s+a,x-2*b*s,b],predict:C,rSquared:L_(e,t,n,a,C)}}function r9t(e,t,n,r){if(r===0)return J7t(e,t,n);if(r===1)return $Re(e,t,n);if(r===2)return CRe(e,t,n);const[i,s,a,o]=t9(e,t,n),l=i.length,u=[],c=[],f=r+1;let h,d,p,g,m;for(h=0;h<f;++h){for(p=0,g=0;p<l;++p)g+=Math.pow(i[p],h)*s[p];for(u.push(g),m=new Float64Array(f),d=0;d<f;++d){for(p=0,g=0;p<l;++p)g+=Math.pow(i[p],h+d);m[d]=g}c.push(m)}c.push(u);const v=s9t(c),y=b=>{b-=a;let x=o+v[0]+v[1]*b+v[2]*b*b;for(h=3;h<f;++h)x+=v[h]*Math.pow(b,h);return x};return{coef:i9t(f,v,-a,o),predict:y,rSquared:L_(e,t,n,o,y)}}function i9t(e,t,n,r){const i=Array(e);let s,a,o,l;for(s=0;s<e;++s)i[s]=0;for(s=e-1;s>=0;--s)for(o=t[s],l=1,i[s]+=o,a=1;a<=s;++a)l*=(s+1-a)/a,i[s-a]+=o*Math.pow(n,a)*l;return i[0]+=r,i}function s9t(e){const t=e.length-1,n=[];let r,i,s,a,o;for(r=0;r<t;++r){for(a=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][a])&&(a=i);for(s=r;s<t+1;++s)o=e[s][r],e[s][r]=e[s][a],e[s][a]=o;for(i=r+1;i<t;++i)for(s=t;s>=r;s--)e[s][i]-=e[s][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(o=0,s=i+1;s<t;++s)o+=e[s][i]*n[s];n[i]=(e[t][i]-o)/e[i][i]}return n}const Pme=2,Lme=1e-12;function a9t(e,t,n,r){const[i,s,a,o]=t9(e,t,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),h=new Float64Array(l).fill(1);for(let d=-1;++d<=Pme;){const p=[0,u-1];for(let m=0;m<l;++m){const v=i[m],y=p[0],b=p[1],x=v-i[y]>i[b]-v?y:b;let w=0,C=0,$=0,_=0,k=0;const E=1/Math.abs(i[x]-v||1);for(let A=y;A<=b;++A){const D=i[A],T=s[A],N=o9t(Math.abs(v-D)*E)*h[A],F=D*N;w+=N,C+=F,$+=T*N,_+=T*F,k+=D*F}const[S,I]=XN(C/w,$/w,_/w,k/w);c[m]=S+I*v,f[m]=Math.abs(s[m]-c[m]),l9t(i,m+1,p)}if(d===Pme)break;const g=V7t(f);if(Math.abs(g)<Lme)break;for(let m=0,v,y;m<l;++m)v=f[m]/(6*g),h[m]=v>=1?Lme:(y=1-v*v)*y}return u9t(i,c,a,o)}function o9t(e){return(e=1-e*e*e)*e*e}function l9t(e,t,n){const r=e[t];let i=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>i&&e[s]-r<=r-e[i];)n[0]=++i,n[1]=s,++s}function u9t(e,t,n,r){const i=e.length,s=[];let a=0,o=0,l=[],u;for(;a<i;++a)u=e[a]+n,l[0]===u?l[1]+=(t[a]-l[1])/++o:(o=0,l[1]+=r,l=[u,t[a]],s.push(l));return l[1]+=r,s}const c9t=.5*Math.PI/180;function qre(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=g=>[g,e(g)],s=t[0],a=t[1],o=a-s,l=o/r,u=[i(s)],c=[];if(n===r){for(let g=1;g<r;++g)u.push(i(s+g/n*o));return u.push(i(a)),u}else{c.push(i(a));for(let g=n;--g>0;)c.push(i(s+g/n*o))}let f=u[0],h=c[c.length-1];const d=1/o,p=f9t(f[1],c);for(;h;){const g=i((f[0]+h[0])/2);g[0]-f[0]>=l&&h9t(f,g,h,d,p)>c9t?c.push(g):(f=h,u.push(h),c.pop()),h=c[c.length-1]}return u}function f9t(e,t){let n=e,r=e;const i=t.length;for(let s=0;s<i;++s){const a=t[s][1];a<n&&(n=a),a>r&&(r=a)}return 1/(r-n)}function h9t(e,t,n,r,i){const s=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),a=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(s-a)}function B_(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ZN(e){let t=e,n=e;e.length===1&&(t=(a,o)=>e(a)-o,n=d9t(e));function r(a,o,l,u){for(l==null&&(l=0),u==null&&(u=a.length);l<u;){const c=l+u>>>1;n(a[c],o)<0?l=c+1:u=c}return l}function i(a,o,l,u){for(l==null&&(l=0),u==null&&(u=a.length);l<u;){const c=l+u>>>1;n(a[c],o)>0?u=c:l=c+1}return l}function s(a,o,l,u){l==null&&(l=0),u==null&&(u=a.length);const c=r(a,o,l,u-1);return c>l&&t(a[c-1],o)>-t(a[c],o)?c-1:c}return{left:r,center:s,right:i}}function d9t(e){return(t,n)=>B_(e(t),n)}function _Re(e){return e===null?NaN:+e}function*p9t(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const SRe=ZN(B_),aP=SRe.right,g9t=SRe.left;ZN(_Re).center;const QN=aP;function m9t(e,t){let n=0,r,i=0,s=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,s+=r*(a-i));else{let a=-1;for(let o of e)(o=t(o,++a,e))!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,s+=r*(o-i))}if(n>1)return s/(n-1)}function v9t(e,t){const n=m9t(e,t);return n&&Math.sqrt(n)}class lo{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],a=t+s,o=Math.abs(t)<Math.abs(s)?t-(a-s):s-(a-t);o&&(n[r++]=o),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,s=i-(a-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=a+i,i==r-a&&(a=r))}return a}}function y9t(e,t){return Array.from(t,n=>e[n])}var AX=Math.sqrt(50),TX=Math.sqrt(10),DX=Math.sqrt(2);function IX(e,t,n){var r,i=-1,s,a,o;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(s=e,e=t,t=s),(o=kRe(e,t,n))===0||!isFinite(o))return[];if(o>0){let l=Math.round(e/o),u=Math.round(t/o);for(l*o<e&&++l,u*o>t&&--u,a=new Array(s=u-l+1);++i<s;)a[i]=(l+i)*o}else{o=-o;let l=Math.round(e*o),u=Math.round(t*o);for(l/o<e&&++l,u/o>t&&--u,a=new Array(s=u-l+1);++i<s;)a[i]=(l+i)/o}return r&&a.reverse(),a}function kRe(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,i);return i>=0?(s>=AX?10:s>=TX?5:s>=DX?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=AX?10:s>=TX?5:s>=DX?2:1)}function K0(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=AX?i*=10:s>=TX?i*=5:s>=DX&&(i*=2),t<e?-i:i}function ny(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function NX(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function ERe(e,t,n=0,r=e.length-1,i=B_){for(;r>n;){if(r-n>600){const l=r-n+1,u=t-n+1,c=Math.log(l),f=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*f*(l-f)/l)*(u-l/2<0?-1:1),d=Math.max(n,Math.floor(t-u*f/l+h)),p=Math.min(r,Math.floor(t+(l-u)*f/l+h));ERe(e,t,d,p,i)}const s=e[t];let a=n,o=r;for(ok(e,n,t),i(e[r],s)>0&&ok(e,n,r);a<o;){for(ok(e,a,o),++a,--o;i(e[a],s)<0;)++a;for(;i(e[o],s)>0;)--o}i(e[n],s)===0?ok(e,n,o):(++o,ok(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}return e}function ok(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function MX(e,t,n){if(e=Float64Array.from(p9t(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return NX(e);if(t>=1)return ny(e);var r,i=(r-1)*t,s=Math.floor(i),a=ny(ERe(e,s).subarray(0,s+1)),o=NX(e.subarray(s+1));return a+(o-a)*(i-s)}}function ARe(e,t,n=_Re){if(!!(r=e.length)){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function b9t(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n}function TRe(e,t){return MX(e,.5,t)}function*x9t(e){for(const t of e)yield*t}function DRe(e){return Array.from(x9t(e))}function Ml(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function IRe(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function w9t(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function FX(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:w9t(e)}function NRe(e,t,n){return n||e+(t?"_"+t:"")}const Vj=()=>{},$9t={init:Vj,add:Vj,rem:Vj,idx:0},UT={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},JN=Object.keys(UT);function C9t(e,t){return n=>zt({name:e,out:n||e},$9t,t)}JN.forEach(e=>{UT[e]=C9t(e,UT[e])});function MRe(e,t){return UT[e](t)}function FRe(e,t){return e.idx-t.idx}function _9t(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{!r.req||r.req.forEach(i=>{t[i]||n(t[i]=UT[i]())})};return e.forEach(n),Object.values(t).sort(FRe)}function S9t(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function k9t(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function E9t(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function A9t(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function ORe(e,t){const n=t||ll,r=_9t(e),i=e.slice().sort(FRe);function s(a){this._ops=r,this._out=i,this.cell=a,this.init()}return s.prototype.init=S9t,s.prototype.add=k9t,s.prototype.rem=E9t,s.prototype.set=A9t,s.prototype.get=n,s.fields=e.map(a=>a.out),s}function Gre(e){this._key=e?Hl(e):nt,this.reset()}const Ks=Gre.prototype;Ks.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Ks.add=function(e){this._add.push(e)};Ks.rem=function(e){this._rem.push(e)};Ks.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,s=Array(r-i),a={};let o,l,u;for(o=0;o<i;++o)a[n(t[o])]=1;for(o=0,l=0;o<r;++o)a[n(u=e[o])]?a[n(u)]=0:s[l++]=u;return this._rem=[],this._add=s};Ks.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,s;for(;--r>=0;)s=e(t[r])+"",bt(n,s)||(n[s]=1,++i);return i};Ks.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=V6t(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Ks.argmin=function(e){return this.extent(e)[0]||{}};Ks.argmax=function(e){return this.extent(e)[1]||{}};Ks.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Ks.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Ks.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=lRe(this.values(),e),this._get=e),this._q};Ks.q1=function(e){return this.quartile(e)[0]};Ks.q2=function(e){return this.quartile(e)[1]};Ks.q3=function(e){return this.quartile(e)[2]};Ks.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=H7t(this.values(),1e3,.05,e),this._get=e),this._ci};Ks.ci0=function(e){return this.ci(e)[0]};Ks.ci1=function(e){return this.ci(e)[1]};function Z0(e){me.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Z0.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:JN},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};Ie(Z0,me,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function s(o){let l,u,c,f;for(l in o)for(c=o[l].tuple,u=0;u<i;++u)r[u][f=c[n[u]]]=f}s(e._prev),s(t);function a(o,l,u){const c=n[u],f=r[u++];for(const h in f){const d=o?o+"|"+h:h;l[c]=f[h],u<i?a(d,l,u):t[d]||e.cell(d,l)}}a("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(m){const v=ct(ao(m)),y=v.length;let b=0,x;for(;b<y;++b)r[x=v[b]]||(r[x]=1,t.push(x))}this._dims=ct(e.groupby),this._dnames=this._dims.map(m=>{const v=li(m);return i(m),n.push(v),v}),this.cellkey=e.key?e.key:FX(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],a=e.ops||["count"],o=e.as||[],l=s.length,u={};let c,f,h,d,p,g;for(l!==a.length&&$e("Unmatched number of fields and aggregate ops."),g=0;g<l;++g){if(c=s[g],f=a[g],c==null&&f!=="count"&&$e("Null aggregate field specified."),d=li(c),p=NRe(f,d,o[g]),n.push(p),f==="count"){this._counts.push(p);continue}h=u[d],h||(i(c),h=u[d]=[],h.field=c,this._measures.push(h)),f!=="count"&&(this._countOnly=!1),h.push(MRe(f,p))}return this._measures=this._measures.map(m=>ORe(m,m.field)),{}},cellkey:FX(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let s=0;s<i;++s)n.agg[s]=new r[s](n)}return n.store&&(n.data=new Gre),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,s={};for(let a=0;a<i;++a)s[n[a]]=r[a](e);return t?QOe(t.tuple,s):Tn(s)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,s=r.length;i<s;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,s=r.length;i<s;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,s=r.length;i<s;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,s=e.add,a=e.rem,o=e.mod;let l,u,c,f;if(r)for(u in r)l=r[u],(!i||l.num)&&a.push(l.tuple);for(c=0,f=this._alen;c<f;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)l=n[c],(l.num===0&&i?a:o).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const T9t=1e-14;function Yre(e){me.call(this,null,e)}Yre.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};Ie(Yre,me,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,s=r.step,a=e.as||["bin0","bin1"],o=a[0],l=a[1];let u;return e.modified()?(t=t.reflow(!0),u=t.SOURCE):u=t.modified(ao(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?c=>{const f=r(c);c[o]=f,c[l]=f==null?null:i+s*(1+(f-i)/s)}:c=>c[o]=r(c)),t.modifies(n?a:o)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=j7t(e),r=n.step;let i=n.start,s=i+Math.ceil((n.stop-i)/r)*r,a,o;(a=e.anchor)!=null&&(o=a-(i+r*Math.floor((a-i)/r)),i+=o,s+=o);const l=function(u){let c=io(t(u));return c==null?null:c<i?-1/0:c>s?1/0:(c=Math.max(i,Math.min(c,s-r)),i+r*Math.floor(T9t+(c-i)/r))};return l.start=i,l.stop=n.stop,l.step=r,this.value=Jl(l,ao(t),e.name||"bin_"+li(t))}});function RRe(e,t,n){const r=e;let i=t||[],s=n||[],a={},o=0;return{add:l=>s.push(l),remove:l=>a[r(l)]=++o,size:()=>i.length,data:(l,u)=>(o&&(i=i.filter(c=>!a[r(c)]),a={},o=0),u&&l&&i.sort(l),s.length&&(i=l?Q6t(l,i,s.sort(l)):i.concat(s),s=[]),i)}}function Xre(e){me.call(this,[],e)}Xre.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};Ie(Xre,me,{transform(e,t){const n=t.fork(t.ALL),r=RRe(nt,this.value,n.materialize(n.ADD).add),i=e.sort,s=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(s),this.value=n.source=r.data(ix(i),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function PRe(e){Jn.call(this,null,D9t,e)}Ie(PRe,Jn);function D9t(e){return this.value&&!e.modified()?this.value:QFe(e.fields,e.orders)}function Kre(e){me.call(this,null,e)}Kre.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function I9t(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}Ie(Kre,me,{transform(e,t){const n=f=>h=>{for(var d=I9t(o(h),e.case,s)||[],p,g=0,m=d.length;g<m;++g)a.test(p=d[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,s=this._match,a=this._stop,o=e.field,l=e.as||["text","count"],u=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,u):(t.visit(t.ADD,u),t.visit(t.REM,c)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],s=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let o,l,u;for(o in n)l=r[o],u=n[o]||0,!l&&u?(r[o]=l=Tn({}),l[i]=o,l[s]=u,a.add.push(l)):u===0?(l&&a.rem.push(l),n[o]=null,r[o]=null):l[s]!==u&&(l[s]=u,a.mod.push(l));return a.modifies(t)}});function Zre(e){me.call(this,null,e)}Zre.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};Ie(Zre,me,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],s=r[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let o=this.value;return a?(o&&(n.rem=o),o=t.materialize(t.SOURCE).source,n.add=this.value=N9t(o,i,s,e.filter||Jc)):n.mod=o,n.source=this.value,n.modifies(r)}});function N9t(e,t,n,r){for(var i=[],s={},a=e.length,o=0,l,u;o<a;++o)for(s[t]=u=e[o],l=0;l<a;++l)s[n]=e[l],r(s)&&(i.push(Tn(s)),s={},s[t]=u);return i}const Bme={kde:dRe,mixture:Z7t,normal:hRe,lognormal:K7t,uniform:Q7t},M9t="distributions",zme="function",F9t="field";function LRe(e,t){const n=e[zme];bt(Bme,n)||$e("Unknown distribution function: "+n);const r=Bme[n]();for(const i in e)i===F9t?r.data((e.from||t()).map(e[i])):i===M9t?r[i](e[i].map(s=>LRe(s,t))):typeof r[i]===zme&&r[i](e[i]);return r}function Qre(e){me.call(this,null,e)}const BRe=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],O9t={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:BRe},{name:"weights",type:"number",array:!0}]};Qre.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:BRe.concat(O9t)},{name:"as",type:"string",array:!0,default:["value","density"]}]};Ie(Qre,me,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=LRe(e.distribution,R9t(t)),i=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let a=e.method||"pdf";a!=="pdf"&&a!=="cdf"&&$e("Invalid density method: "+a),!e.extent&&!r.data&&$e("Missing density extent parameter."),a=r[a];const o=e.as||["value","density"],l=e.extent||Op(r.data()),u=qre(a,l,i,s).map(c=>{const f={};return f[o[0]]=c[0],f[o[1]]=c[1],Tn(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function R9t(e){return()=>e.materialize(e.SOURCE).source}function zRe(e,t){return e?e.map((n,r)=>t[r]||li(n)):null}function Jre(e,t,n){const r=[],i=f=>f(l);let s,a,o,l,u,c;if(t==null)r.push(e.map(n));else for(s={},a=0,o=e.length;a<o;++a)l=e[a],u=t.map(i),c=s[u],c||(s[u]=c=[],c.dims=u,r.push(c)),c.push(n(l));return r}const URe="bin";function eie(e){me.call(this,null,e)}eie.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:URe}]};const P9t=(e,t)=>X7(Op(e,t))/30;Ie(eie,me,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=Jre(t.source,e.groupby,ll),i=e.smooth||!1,s=e.field,a=e.step||P9t(n,s),o=ix((p,g)=>s(p)-s(g)),l=e.as||URe,u=r.length;let c=1/0,f=-1/0,h=0,d;for(;h<u;++h){const p=r[h].sort(o);d=-1;for(const g of q7t(p,a,i,s))g<c&&(c=g),g>f&&(f=g),p[++d][l]=g}return this.value={start:c,stop:f,step:a},t.reflow(!0).modifies(l)}});function WRe(e){Jn.call(this,null,L9t,e),this.modified(!0)}Ie(WRe,Jn);function L9t(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:Jl(n=>t(n,e),ao(t),li(t))}function tie(e){me.call(this,[void 0,void 0],e)}tie.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};Ie(tie,me,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let s=n[0],a=n[1];if((i||s==null)&&(s=1/0,a=-1/0),t.visit(i?t.SOURCE:t.ADD,o=>{const l=io(r(o));l!=null&&(l<s&&(s=l),l>a&&(a=l))}),!Number.isFinite(s)||!Number.isFinite(a)){let o=li(r);o&&(o=` for field "${o}"`),t.dataflow.warn(`Infinite extent${o}: [${s}, ${a}]`),s=a=void 0}this.value=[s,a]}});function nie(e,t){Jn.call(this,e),this.parent=t,this.count=0}Ie(nie,Jn,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function n9(e){me.call(this,{},e),this._keys=qN();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}Ie(n9,me,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let s=bt(i,e)&&i[e],a,o;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(o=r||(o=this._group[e])&&o.tuple,a=n.dataflow,s=new nie(n.fork(n.NO_SOURCE),this),a.add(s).connect(t(a,e,o)),i[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,s=this._keys,a=e.modified("key"),o=l=>this.subflow(l,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,l=>{const u=nt(l),c=s.get(u);c!==void 0&&(s.delete(u),o(c).rem(l))}),t.visit(t.ADD,l=>{const u=r(l);s.set(nt(l),u),o(u).add(l)}),a||t.modified(r.fields)?t.visit(t.MOD,l=>{const u=nt(l),c=s.get(u),f=r(l);c===f?o(f).mod(l):(s.set(u,f),o(c).rem(l),o(f).add(l))}):t.changed(t.MOD)&&t.visit(t.MOD,l=>{o(s.get(nt(l))).mod(l)}),a&&t.visit(t.REFLOW,l=>{const u=nt(l),c=s.get(u),f=r(l);c!==f&&(s.set(u,f),o(c).rem(l),o(f).add(l))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}});function VRe(e){Jn.call(this,null,B9t,e)}Ie(VRe,Jn);function B9t(e){return this.value&&!e.modified()?this.value:at(e.name)?ct(e.name).map(t=>Hl(t)):Hl(e.name,e.as)}function rie(e){me.call(this,qN(),e)}rie.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};Ie(rie,me,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),s=i.add,a=i.rem,o=i.mod,l=e.expr;let u=!0;t.visit(t.REM,f=>{const h=nt(f);r.has(h)?r.delete(h):a.push(f)}),t.visit(t.ADD,f=>{l(f,e)?s.push(f):r.set(nt(f),1)});function c(f){const h=nt(f),d=l(f,e),p=r.get(h);d&&p?(r.delete(h),s.push(f)):!d&&!p?(r.set(h,1),a.push(f)):u&&d&&!p&&o.push(f)}return t.visit(t.MOD,c),e.modified()&&(u=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function iie(e){me.call(this,[],e)}iie.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};Ie(iie,me,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=zRe(r,e.as||[]),s=e.index||null,a=i.length;return n.rem=this.value,t.visit(t.SOURCE,o=>{const l=r.map(p=>p(o)),u=l.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,h,d;for(;c<u;++c){for(h=zre(o),f=0;f<a;++f)h[i[f]]=(d=l[f][c])==null?null:d;s&&(h[s]=c),n.add.push(h)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(i)}});function sie(e){me.call(this,[],e)}sie.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};Ie(sie,me,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(li),s=e.as||["key","value"],a=s[0],o=s[1],l=r.length;return n.rem=this.value,t.visit(t.SOURCE,u=>{for(let c=0,f;c<l;++c)f=zre(u),f[a]=i[c],f[o]=r[c](u),n.add.push(f)}),this.value=n.source=n.add,n.modifies(s)}});function aie(e){me.call(this,null,e)}aie.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};Ie(aie,me,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),s=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(s,a=>a[r]=n(a,e))}});function jRe(e){me.call(this,[],e)}Ie(jRe,me,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,s=e.size-i.length,a,o,l;if(s>0){for(a=[];--s>=0;)a.push(l=Tn(r(e))),i.push(l);n.add=n.add.length?n.materialize(n.ADD).add.concat(a):a}else o=i.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,i=i.slice(-s);return n.source=this.value=i,n}});const CO={value:"value",median:TRe,mean:b9t,min:NX,max:ny},z9t=[];function oie(e){me.call(this,[],e)}oie.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function U9t(e){var t=e.method||CO.value,n;if(CO[t]==null)$e("Unrecognized imputation method: "+t);else return t===CO.value?(n=e.value!==void 0?e.value:0,()=>n):CO[t]}function W9t(e){const t=e.field;return n=>n?t(n):NaN}Ie(oie,me,{transform(e,t){var n=t.fork(t.ALL),r=U9t(e),i=W9t(e),s=li(e.field),a=li(e.key),o=(e.groupby||[]).map(li),l=V9t(t.source,e.groupby,e.key,e.keyvals),u=[],c=this.value,f=l.domain.length,h,d,p,g,m,v,y,b,x,w;for(m=0,b=l.length;m<b;++m)for(h=l[m],p=h.values,d=NaN,y=0;y<f;++y)if(h[y]==null){for(g=l.domain[y],w={_impute:!0},v=0,x=p.length;v<x;++v)w[o[v]]=p[v];w[a]=g,w[s]=Number.isNaN(d)?d=r(h,i):d,u.push(Tn(w))}return u.length&&(n.add=n.materialize(n.ADD).add.concat(u)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=u,n}});function V9t(e,t,n,r){var i=v=>v(m),s=[],a=r?r.slice():[],o={},l={},u,c,f,h,d,p,g,m;for(a.forEach((v,y)=>o[v]=y+1),h=0,g=e.length;h<g;++h)m=e[h],p=n(m),d=o[p]||(o[p]=a.push(p)),c=(u=t?t.map(i):z9t)+"",(f=l[c])||(f=l[c]=[],s.push(f),f.values=u),f[d-1]=m;return s.domain=a,s}function lie(e){Z0.call(this,e)}lie.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:JN},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};Ie(lie,Z0,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(i=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{zt(s,i[n.cellkey(s)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function uie(e){me.call(this,null,e)}uie.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};Ie(uie,me,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Jre(r,e.groupby,e.field),s=(e.groupby||[]).map(li),a=e.bandwidth,o=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],u=[];let c=e.extent,f=e.steps||e.minsteps||25,h=e.steps||e.maxsteps||200;o!=="pdf"&&o!=="cdf"&&$e("Invalid density method: "+o),e.resolve==="shared"&&(c||(c=Op(r,e.field)),f=h=e.steps||h),i.forEach(d=>{const p=dRe(d,a)[o],g=e.counts?d.length:1,m=c||Op(d);qre(p,m,f,h).forEach(v=>{const y={};for(let b=0;b<s.length;++b)y[s[b]]=d.dims[b];y[l[0]]=v[0],y[l[1]]=v[1]*g,u.push(Tn(y))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function HRe(e){Jn.call(this,null,j9t,e)}Ie(HRe,Jn);function j9t(e){return this.value&&!e.modified()?this.value:eOe(e.fields,e.flat)}function qRe(e){me.call(this,[],e),this._pending=null}Ie(qRe,me,{transform(e,t){const n=t.dataflow;return this._pending?jj(this,t,this._pending):H9t(e)?t.StopPropagation:e.values?jj(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=ct(i.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(r=>jj(this,t,ct(r.data)))}});function H9t(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function jj(e,t,n){n.forEach(Tn);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function cie(e){me.call(this,{},e)}cie.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};Ie(cie,me,{transform(e,t){const n=e.fields,r=e.index,i=e.values,s=e.default==null?null:e.default,a=e.modified(),o=n.length;let l=a?t.SOURCE:t.ADD,u=t,c=e.as,f,h,d;return i?(h=i.length,o>1&&!c&&$e('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==o*h&&$e('The "as" parameter has too few output field names.'),c=c||i.map(li),f=function(p){for(var g=0,m=0,v,y;g<o;++g)if(y=r.get(n[g](p)),y==null)for(v=0;v<h;++v,++m)p[c[m]]=s;else for(v=0;v<h;++v,++m)p[c[m]]=i[v](y)}):(c||$e("Missing output field names."),f=function(p){for(var g=0,m;g<o;++g)m=r.get(n[g](p)),p[c[g]]=m==null?s:m}),a?u=t.reflow(!0):(d=n.some(p=>t.modified(p.fields)),l|=d?t.MOD:0),t.visit(l,f),u.modifies(c)}});function GRe(e){Jn.call(this,null,q9t,e)}Ie(GRe,Jn);function q9t(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,s,a;for(s=0;s<n;++s)a=t[s],a[0]<r&&(r=a[0]),a[1]>i&&(i=a[1]);return[r,i]}function YRe(e){Jn.call(this,null,G9t,e)}Ie(YRe,Jn);function G9t(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function XRe(e){me.call(this,null,e)}Ie(XRe,me,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function fie(e){Z0.call(this,e)}fie.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:JN,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};Ie(fie,Z0,{_transform:Z0.prototype.transform,transform(e,t){return this._transform(Y9t(e,t),t)}});function Y9t(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",s=ao(n).concat(ao(r)),a=K9t(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:a.map(()=>i),fields:a.map(o=>X9t(o,n,r,s)),as:a.map(o=>o+""),modified:e.modified.bind(e)}}function X9t(e,t,n,r){return Jl(i=>t(i)===e?n(i):NaN,r,e+"")}function K9t(e,t,n){const r={},i=[];return n.visit(n.SOURCE,s=>{const a=e(s);r[a]||(r[a]=1,i.push(a))}),i.sort(kre),t?i.slice(0,t):i}function KRe(e){n9.call(this,e)}Ie(KRe,n9,{transform(e,t){const n=e.subflow,r=e.field,i=s=>this.subflow(nt(s),n,t,s);return(e.modified("field")||r&&t.modified(ao(r)))&&$e("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,s=>{const a=i(s);r(s).forEach(o=>a.mod(o))}),t.visit(t.ADD,s=>{const a=i(s);r(s).forEach(o=>a.add(Tn(o)))}),t.visit(t.REM,s=>{const a=i(s);r(s).forEach(o=>a.rem(o))})):(t.visit(t.MOD,s=>i(s).mod(s)),t.visit(t.ADD,s=>i(s).add(s)),t.visit(t.REM,s=>i(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}});function hie(e){me.call(this,null,e)}hie.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};Ie(hie,me,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=zRe(e.fields,e.as||[]),s=r?(o,l)=>Z9t(o,l,r,i):Q7;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,o=>{const l=nt(o);n.rem.push(a[l]),a[l]=null}),t.visit(t.ADD,o=>{const l=s(o,Tn({}));a[nt(o)]=l,n.add.push(l)}),t.visit(t.MOD,o=>{n.mod.push(s(o,a[nt(o)]))}),n}});function Z9t(e,t,n,r){for(let i=0,s=n.length;i<s;++i)t[r[i]]=n[i](e);return t}function ZRe(e){me.call(this,null,e)}Ie(ZRe,me,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function die(e){me.call(this,null,e)}die.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const Q9t=1e-14;Ie(die,me,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,s=Jre(i,e.groupby,e.field),a=(e.groupby||[]).map(li),o=[],l=e.step||.01,u=e.probs||Ml(l/2,1-Q9t,l),c=u.length;return s.forEach(f=>{const h=oRe(f,u);for(let d=0;d<c;++d){const p={};for(let g=0;g<a.length;++g)p[a[g]]=f.dims[g];p[r[0]]=u[d],p[r[1]]=h[d],o.push(Tn(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=o,n}});function QRe(e){me.call(this,null,e)}Ie(QRe,me,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const s=nt(i);n.rem.push(r[s]),r[s]=null}),t.visit(t.ADD,i=>{const s=zre(i);r[nt(i)]=s,n.add.push(s)}),t.visit(t.MOD,i=>{const s=r[nt(i)];for(const a in i)s[a]=i[a],n.modifies(a);n.mod.push(s)})),n}});function pie(e){me.call(this,[],e),this.count=0}pie.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};Ie(pie,me,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,s=this.value.reduce((c,f)=>(c[nt(f)]=1,c),{});let a=this.value,o=this.count,l=0;function u(c){let f,h;a.length<i?a.push(c):(h=~~((o+1)*Pp()),h<a.length&&h>=l&&(f=a[h],s[nt(f)]&&n.rem.push(f),a[h]=c)),++o}if(t.rem.length&&(t.visit(t.REM,c=>{const f=nt(c);s[f]&&(s[f]=-1,n.rem.push(c)),--o}),a=a.filter(c=>s[nt(c)]!==-1)),(t.rem.length||r)&&a.length<i&&t.source&&(l=o=a.length,t.visit(t.SOURCE,c=>{s[nt(c)]||u(c)}),l=-1),r&&a.length>i){const c=a.length-i;for(let f=0;f<c;++f)s[nt(a[f])]=-1,n.rem.push(a[f]);a=a.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[nt(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(n.add=a.filter(c=>!s[nt(c)])),this.count=o,this.value=n.source=a,n}});function gie(e){me.call(this,null,e)}gie.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};Ie(gie,me,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Ml(e.start,e.stop,e.step||1).map(i=>{const s={};return s[r]=i,Tn(s)}),n.add=t.add.concat(this.value),n}});function JRe(e){me.call(this,null,e),this.modified(!0)}Ie(JRe,me,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function mie(e){me.call(this,null,e)}const e4e=["unit0","unit1"];mie.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:$Oe,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:e4e}]};Ie(mie,me,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",s=this._floor(e,t),a=(i?YN:GN)(s.unit).offset,o=e.as||e4e,l=o[0],u=o[1],c=s.step;let f=s.start||1/0,h=s.stop||-1/0,d=t.ADD;return(e.modified()||t.modified(ao(n)))&&(t=t.reflow(!0),d=t.SOURCE,f=1/0,h=-1/0),t.visit(d,p=>{const g=n(p);let m,v;g==null?(p[l]=null,r&&(p[u]=null)):(p[l]=m=v=s(g),r&&(p[u]=v=a(m,c)),m<f&&(f=m),v>h&&(h=v))}),s.start=f,s.stop=h,t.modifies(r?o:l)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:g8t({extent:e.extent||Op(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=COe(r),a=this.value||{},o=(n?s8t:n8t)(s,i);return o.unit=ln(s),o.units=s,o.step=i,o.start=a.start,o.stop=a.stop,this.value=o}});function t4e(e){me.call(this,qN(),e)}Ie(t4e,me,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,s=o=>i.set(r(o),o);let a=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,o=>i.delete(r(o))),t.visit(t.ADD,s)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function n4e(e){me.call(this,null,e)}Ie(n4e,me,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(ix(e.sort)):t.source).map(e.field))}});function J9t(e,t,n,r){const i=WT[e](t,n);return{init:i.init||l1,update:function(s,a){a[r]=i.next(s)}}}const WT={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=WT.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||$e("ntile num must be greater than zero.");const n=WT.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||$e("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=eUt(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function eUt(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const tUt=Object.keys(WT);function r4e(e){const t=ct(e.ops),n=ct(e.fields),r=ct(e.params),i=ct(e.as),s=this.outputs=[],a=this.windows=[],o={},l={},u=[],c=[];let f=!0;function h(d){ct(ao(d)).forEach(p=>o[p]=1)}h(e.sort),t.forEach((d,p)=>{const g=n[p],m=li(g),v=NRe(d,m,i[p]);if(h(g),s.push(v),bt(WT,d))a.push(J9t(d,n[p],r[p],v));else{if(g==null&&d!=="count"&&$e("Null aggregate field specified."),d==="count"){u.push(v);return}f=!1;let y=l[m];y||(y=l[m]=[],y.field=g,c.push(y)),y.push(MRe(d,v))}}),(u.length||c.length)&&(this.cell=nUt(c,u,f)),this.inputs=Object.keys(o)}const i4e=r4e.prototype;i4e.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};i4e.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,s=r&&r.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(i[a]);for(a=e.p1;a<e.i1;++a)n.add(i[a]);n.set(t)}for(a=0;a<s;++a)r[a].update(e,t)};function nUt(e,t,n){e=e.map(l=>ORe(l,l.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,s=r.agg=Array(i),a=0;a<i;++a)s[a]=new e[a](r);if(r.store)var o=r.data=new Gre;return r.add=function(l){if(r.num+=1,!n){o&&o.add(l);for(let u=0;u<i;++u)s[u].add(s[u].get(l),l)}},r.rem=function(l){if(r.num-=1,!n){o&&o.rem(l);for(let u=0;u<i;++u)s[u].rem(s[u].get(l),l)}},r.set=function(l){let u,c;for(o&&o.values(),u=0,c=t.length;u<c;++u)l[t[u]]=r.num;if(!n)for(u=0,c=s.length;u<c;++u)s[u].set(l)},r.init=function(){r.num=0,o&&o.reset();for(let l=0;l<i;++l)s[l].init()},r}function vie(e){me.call(this,{},e),this._mlen=0,this._mods=[]}vie.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:tUt.concat(JN)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};Ie(vie,me,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=ix(e.sort),i=FX(e.groupby),s=o=>this.group(i(o));let a=this.state;(!a||n)&&(a=this.state=new r4e(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,o=>s(o).add(o))):(t.visit(t.REM,o=>s(o).remove(o)),t.visit(t.ADD,o=>s(o).add(o)));for(let o=0,l=this._mlen;o<l;++o)rUt(this._mods[o],a,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=RRe(nt),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function rUt(e,t,n,r){const i=r.sort,s=i&&!r.ignorePeers,a=r.frame||[null,0],o=e.data(n),l=o.length,u=s?ZN(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:o,compare:i||go(-1)};t.init();for(let f=0;f<l;++f)iUt(c,a,f,l),s&&sUt(c,u),t.update(c,o[f])}function iUt(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function sUt(e,t){const n=e.i0,r=e.i1-1,i=e.compare,s=e.data,a=s.length-1;n>0&&!i(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),r<a&&!i(s[r],s[r+1])&&(e.i1=t.right(s,s[r]))}const aUt=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Z0,bin:Yre,collect:Xre,compare:PRe,countpattern:Kre,cross:Zre,density:Qre,dotbin:eie,expression:WRe,extent:tie,facet:n9,field:VRe,filter:rie,flatten:iie,fold:sie,formula:aie,generate:jRe,impute:oie,joinaggregate:lie,kde:uie,key:HRe,load:qRe,lookup:cie,multiextent:GRe,multivalues:YRe,params:XRe,pivot:fie,prefacet:KRe,project:hie,proxy:ZRe,quantile:die,relay:QRe,sample:pie,sequence:gie,sieve:JRe,subflow:nie,timeunit:mie,tupleindex:t4e,values:n4e,window:vie},Symbol.toStringTag,{value:"Module"}));function In(e){return function(){return e}}const Ume=Math.abs,Qs=Math.atan2,Av=Math.cos,oUt=Math.max,Hj=Math.min,Sf=Math.sin,D1=Math.sqrt,ta=1e-12,Qw=Math.PI,oP=Qw/2,s4e=2*Qw;function lUt(e){return e>1?0:e<-1?Qw:Math.acos(e)}function Wme(e){return e>=1?oP:e<=-1?-oP:Math.asin(e)}const OX=Math.PI,RX=2*OX,Kv=1e-6,uUt=RX-Kv;function a4e(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function cUt(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return a4e;const n=10**t;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class fUt{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?a4e:cUt(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,a){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,l=r-t,u=i-n,c=a-t,f=o-n,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>Kv)if(!(Math.abs(f*l-u*c)>Kv)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let d=r-a,p=i-o,g=l*l+u*u,m=d*d+p*p,v=Math.sqrt(g),y=Math.sqrt(h),b=s*Math.tan((OX-Math.acos((g+h-m)/(2*v*y)))/2),x=b/y,w=b/v;Math.abs(x-1)>Kv&&this._append`L${t+x*c},${n+x*f}`,this._append`A${s},${s},0,0,${+(f*d>c*p)},${this._x1=t+w*l},${this._y1=n+w*u}`}}arc(t,n,r,i,s,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),l=r*Math.sin(i),u=t+o,c=n+l,f=1^a,h=a?i-s:s-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>Kv||Math.abs(this._y1-c)>Kv)&&this._append`L${u},${c}`,r&&(h<0&&(h=h%RX+RX),h>uUt?this._append`A${r},${r},0,1,${f},${t-o},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:h>Kv&&this._append`A${r},${r},0,${+(h>=OX)},${f},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function r9(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new fUt(t)}function hUt(e){return e.innerRadius}function dUt(e){return e.outerRadius}function pUt(e){return e.startAngle}function gUt(e){return e.endAngle}function mUt(e){return e&&e.padAngle}function vUt(e,t,n,r,i,s,a,o){var l=n-e,u=r-t,c=a-i,f=o-s,h=f*l-c*u;if(!(h*h<ta))return h=(c*(t-s)-f*(e-i))/h,[e+h*l,t+h*u]}function _O(e,t,n,r,i,s,a){var o=e-n,l=t-r,u=(a?s:-s)/D1(o*o+l*l),c=u*l,f=-u*o,h=e+c,d=t+f,p=n+c,g=r+f,m=(h+p)/2,v=(d+g)/2,y=p-h,b=g-d,x=y*y+b*b,w=i-s,C=h*g-p*d,$=(b<0?-1:1)*D1(oUt(0,w*w*x-C*C)),_=(C*b-y*$)/x,k=(-C*y-b*$)/x,E=(C*b+y*$)/x,S=(-C*y+b*$)/x,I=_-m,A=k-v,D=E-m,T=S-v;return I*I+A*A>D*D+T*T&&(_=E,k=S),{cx:_,cy:k,x01:-c,y01:-f,x11:_*(i/w-1),y11:k*(i/w-1)}}function yUt(){var e=hUt,t=dUt,n=In(0),r=null,i=pUt,s=gUt,a=mUt,o=null,l=r9(u);function u(){var c,f,h=+e.apply(this,arguments),d=+t.apply(this,arguments),p=i.apply(this,arguments)-oP,g=s.apply(this,arguments)-oP,m=Ume(g-p),v=g>p;if(o||(o=c=l()),d<h&&(f=d,d=h,h=f),!(d>ta))o.moveTo(0,0);else if(m>s4e-ta)o.moveTo(d*Av(p),d*Sf(p)),o.arc(0,0,d,p,g,!v),h>ta&&(o.moveTo(h*Av(g),h*Sf(g)),o.arc(0,0,h,g,p,v));else{var y=p,b=g,x=p,w=g,C=m,$=m,_=a.apply(this,arguments)/2,k=_>ta&&(r?+r.apply(this,arguments):D1(h*h+d*d)),E=Hj(Ume(d-h)/2,+n.apply(this,arguments)),S=E,I=E,A,D;if(k>ta){var T=Wme(k/h*Sf(_)),N=Wme(k/d*Sf(_));(C-=T*2)>ta?(T*=v?1:-1,x+=T,w-=T):(C=0,x=w=(p+g)/2),($-=N*2)>ta?(N*=v?1:-1,y+=N,b-=N):($=0,y=b=(p+g)/2)}var F=d*Av(y),R=d*Sf(y),P=h*Av(w),V=h*Sf(w);if(E>ta){var z=d*Av(b),q=d*Sf(b),G=h*Av(x),K=h*Sf(x),Y;if(m<Qw)if(Y=vUt(F,R,G,K,z,q,P,V)){var te=F-Y[0],Z=R-Y[1],ae=z-Y[0],O=q-Y[1],L=1/Sf(lUt((te*ae+Z*O)/(D1(te*te+Z*Z)*D1(ae*ae+O*O)))/2),W=D1(Y[0]*Y[0]+Y[1]*Y[1]);S=Hj(E,(h-W)/(L-1)),I=Hj(E,(d-W)/(L+1))}else S=I=0}$>ta?I>ta?(A=_O(G,K,F,R,d,I,v),D=_O(z,q,P,V,d,I,v),o.moveTo(A.cx+A.x01,A.cy+A.y01),I<E?o.arc(A.cx,A.cy,I,Qs(A.y01,A.x01),Qs(D.y01,D.x01),!v):(o.arc(A.cx,A.cy,I,Qs(A.y01,A.x01),Qs(A.y11,A.x11),!v),o.arc(0,0,d,Qs(A.cy+A.y11,A.cx+A.x11),Qs(D.cy+D.y11,D.cx+D.x11),!v),o.arc(D.cx,D.cy,I,Qs(D.y11,D.x11),Qs(D.y01,D.x01),!v))):(o.moveTo(F,R),o.arc(0,0,d,y,b,!v)):o.moveTo(F,R),!(h>ta)||!(C>ta)?o.lineTo(P,V):S>ta?(A=_O(P,V,z,q,h,-S,v),D=_O(F,R,G,K,h,-S,v),o.lineTo(A.cx+A.x01,A.cy+A.y01),S<E?o.arc(A.cx,A.cy,S,Qs(A.y01,A.x01),Qs(D.y01,D.x01),!v):(o.arc(A.cx,A.cy,S,Qs(A.y01,A.x01),Qs(A.y11,A.x11),!v),o.arc(0,0,h,Qs(A.cy+A.y11,A.cx+A.x11),Qs(D.cy+D.y11,D.cx+D.x11),v),o.arc(D.cx,D.cy,S,Qs(D.y11,D.x11),Qs(D.y01,D.x01),!v))):o.arc(0,0,h,w,x,v)}if(o.closePath(),c)return o=null,c+""||null}return u.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-Qw/2;return[Av(f)*c,Sf(f)*c]},u.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:In(+c),u):e},u.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:In(+c),u):t},u.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:In(+c),u):n},u.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:In(+c),u):r},u.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:In(+c),u):i},u.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:In(+c),u):s},u.padAngle=function(c){return arguments.length?(a=typeof c=="function"?c:In(+c),u):a},u.context=function(c){return arguments.length?(o=c==null?null:c,u):o},u}function o4e(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function l4e(e){this._context=e}l4e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function yie(e){return new l4e(e)}function u4e(e){return e[0]}function c4e(e){return e[1]}function f4e(e,t){var n=In(!0),r=null,i=yie,s=null,a=r9(o);e=typeof e=="function"?e:e===void 0?u4e:In(e),t=typeof t=="function"?t:t===void 0?c4e:In(t);function o(l){var u,c=(l=o4e(l)).length,f,h=!1,d;for(r==null&&(s=i(d=a())),u=0;u<=c;++u)!(u<c&&n(f=l[u],u,l))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(f,u,l),+t(f,u,l));if(d)return s=null,d+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:In(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:In(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:In(!!l),o):n},o.curve=function(l){return arguments.length?(i=l,r!=null&&(s=i(r)),o):i},o.context=function(l){return arguments.length?(l==null?r=s=null:s=i(r=l),o):r},o}function h4e(e,t,n){var r=null,i=In(!0),s=null,a=yie,o=null,l=r9(u);e=typeof e=="function"?e:e===void 0?u4e:In(+e),t=typeof t=="function"?t:In(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?c4e:In(+n);function u(f){var h,d,p,g=(f=o4e(f)).length,m,v=!1,y,b=new Array(g),x=new Array(g);for(s==null&&(o=a(y=l())),h=0;h<=g;++h){if(!(h<g&&i(m=f[h],h,f))===v)if(v=!v)d=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=h-1;p>=d;--p)o.point(b[p],x[p]);o.lineEnd(),o.areaEnd()}v&&(b[h]=+e(m,h,f),x[h]=+t(m,h,f),o.point(r?+r(m,h,f):b[h],n?+n(m,h,f):x[h]))}if(y)return o=null,y+""||null}function c(){return f4e().defined(i).curve(a).context(s)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:In(+f),r=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:In(+f),u):e},u.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:In(+f),u):r},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:In(+f),n=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:In(+f),u):t},u.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:In(+f),u):n},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(n)},u.lineX1=function(){return c().x(r).y(t)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:In(!!f),u):i},u.curve=function(f){return arguments.length?(a=f,s!=null&&(o=a(s)),u):a},u.context=function(f){return arguments.length?(f==null?s=o=null:o=a(s=f),u):s},u}const bUt={draw(e,t){const n=D1(t/Qw);e.moveTo(n,0),e.arc(0,0,n,0,s4e)}};function xUt(e,t){let n=null,r=r9(i);e=typeof e=="function"?e:In(e||bUt),t=typeof t=="function"?t:In(t===void 0?64:+t);function i(){let s;if(n||(n=s=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:In(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:In(+s),i):t},i.context=function(s){return arguments.length?(n=s==null?null:s,i):n},i}function Q0(){}function lP(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function i9(e){this._context=e}i9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:lP(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:lP(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function wUt(e){return new i9(e)}function d4e(e){this._context=e}d4e.prototype={areaStart:Q0,areaEnd:Q0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:lP(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function $Ut(e){return new d4e(e)}function p4e(e){this._context=e}p4e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:lP(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function CUt(e){return new p4e(e)}function g4e(e,t){this._basis=new i9(e),this._beta=t}g4e.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,a=t[n]-i,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*s),this._beta*t[o]+(1-this._beta)*(i+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const _Ut=function e(t){function n(r){return t===1?new i9(r):new g4e(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function uP(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function bie(e,t){this._context=e,this._k=(1-t)/6}bie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:uP(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:uP(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const SUt=function e(t){function n(r){return new bie(r,t)}return n.tension=function(r){return e(+r)},n}(0);function xie(e,t){this._context=e,this._k=(1-t)/6}xie.prototype={areaStart:Q0,areaEnd:Q0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:uP(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const kUt=function e(t){function n(r){return new xie(r,t)}return n.tension=function(r){return e(+r)},n}(0);function wie(e,t){this._context=e,this._k=(1-t)/6}wie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:uP(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const EUt=function e(t){function n(r){return new wie(r,t)}return n.tension=function(r){return e(+r)},n}(0);function $ie(e,t,n){var r=e._x1,i=e._y1,s=e._x2,a=e._y2;if(e._l01_a>ta){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>ta){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,s,a,e._x2,e._y2)}function m4e(e,t){this._context=e,this._alpha=t}m4e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:$ie(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const AUt=function e(t){function n(r){return t?new m4e(r,t):new bie(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function v4e(e,t){this._context=e,this._alpha=t}v4e.prototype={areaStart:Q0,areaEnd:Q0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:$ie(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const TUt=function e(t){function n(r){return t?new v4e(r,t):new xie(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function y4e(e,t){this._context=e,this._alpha=t}y4e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:$ie(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const DUt=function e(t){function n(r){return t?new y4e(r,t):new wie(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function b4e(e){this._context=e}b4e.prototype={areaStart:Q0,areaEnd:Q0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function IUt(e){return new b4e(e)}function Vme(e){return e<0?-1:1}function jme(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),o=(s*i+a*r)/(r+i);return(Vme(s)+Vme(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function Hme(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function qj(e,t,n){var r=e._x0,i=e._y0,s=e._x1,a=e._y1,o=(s-r)/3;e._context.bezierCurveTo(r+o,i+o*t,s-o,a-o*n,s,a)}function cP(e){this._context=e}cP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:qj(this,this._t0,Hme(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,qj(this,Hme(this,n=jme(this,e,t)),n);break;default:qj(this,this._t0,n=jme(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function x4e(e){this._context=new w4e(e)}(x4e.prototype=Object.create(cP.prototype)).point=function(e,t){cP.prototype.point.call(this,t,e)};function w4e(e){this._context=e}w4e.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function NUt(e){return new cP(e)}function MUt(e){return new x4e(e)}function $4e(e){this._context=e}$4e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=qme(e),i=qme(t),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function qme(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),a=new Array(n);for(i[0]=0,s[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function FUt(e){return new $4e(e)}function s9(e,t){this._context=e,this._t=t}s9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function OUt(e){return new s9(e,.5)}function RUt(e){return new s9(e,0)}function PUt(e){return new s9(e,1)}const PX=Math.PI,LX=2*PX,Zv=1e-6,LUt=LX-Zv;function C4e(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function BUt(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return C4e;const n=10**t;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class _4e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?C4e:BUt(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,a){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,l=r-t,u=i-n,c=a-t,f=o-n,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>Zv)if(!(Math.abs(f*l-u*c)>Zv)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let d=r-a,p=i-o,g=l*l+u*u,m=d*d+p*p,v=Math.sqrt(g),y=Math.sqrt(h),b=s*Math.tan((PX-Math.acos((g+h-m)/(2*v*y)))/2),x=b/y,w=b/v;Math.abs(x-1)>Zv&&this._append`L${t+x*c},${n+x*f}`,this._append`A${s},${s},0,0,${+(f*d>c*p)},${this._x1=t+w*l},${this._y1=n+w*u}`}}arc(t,n,r,i,s,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),l=r*Math.sin(i),u=t+o,c=n+l,f=1^a,h=a?i-s:s-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>Zv||Math.abs(this._y1-c)>Zv)&&this._append`L${u},${c}`,r&&(h<0&&(h=h%LX+LX),h>LUt?this._append`A${r},${r},0,1,${f},${t-o},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:h>Zv&&this._append`A${r},${r},0,${+(h>=PX)},${f},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Cie(){return new _4e}Cie.prototype=_4e.prototype;function Yu(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const _ie=()=>typeof Image<"u"?Image:null;function s4(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function zUt(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function S4e(e){let t,n,r;e.length!==2?(t=s4,n=(o,l)=>s4(e(o),l),r=(o,l)=>e(o)-l):(t=e===s4||e===zUt?e:UUt,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function UUt(){return 0}function WUt(e){return e===null?NaN:+e}const VUt=S4e(s4),BX=VUt.right;S4e(WUt).center;const jUt=BX;function HUt(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function lA(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function qUt(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Sie(e){let t,n,r;e.length!==2?(t=lA,n=(o,l)=>lA(e(o),l),r=(o,l)=>e(o)-l):(t=e===lA||e===qUt?e:GUt,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function GUt(){return 0}function k4e(e){return e===null?NaN:+e}const YUt=Sie(lA),XUt=YUt.right;Sie(k4e).center;const a9=XUt,KUt=Math.sqrt(50),ZUt=Math.sqrt(10),QUt=Math.sqrt(2);function fP(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=KUt?10:s>=ZUt?5:s>=QUt?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?fP(e,t,n*2):[o,l,u]}function zX(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,a]=r?fP(t,e,n):fP(e,t,n);if(!(s>=i))return[];const o=s-i+1,l=new Array(o);if(r)if(a<0)for(let u=0;u<o;++u)l[u]=(s-u)/-a;else for(let u=0;u<o;++u)l[u]=(s-u)*a;else if(a<0)for(let u=0;u<o;++u)l[u]=(i+u)/-a;else for(let u=0;u<o;++u)l[u]=(i+u)*a;return l}function UX(e,t,n){return t=+t,e=+e,n=+n,fP(e,t,n)[2]}function WX(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?UX(t,e,n):UX(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function JUt(e,t,n=k4e){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function od(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ym(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const VX=Symbol("implicit");function kie(){var e=new qw,t=[],n=[],r=VX;function i(s){let a=e.get(s);if(a===void 0){if(r!==VX)return r;e.set(s,a=t.push(s)-1)}return n[a%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new qw;for(const a of s)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return kie(t,n).unknown(r)},od.apply(i,arguments),i}function Eie(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function E4e(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function eM(){}var VT=.7,hP=1/VT,J2="\\s*([+-]?\\d+)\\s*",jT="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ah="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",eWt=/^#([0-9a-f]{3,8})$/,tWt=new RegExp(`^rgb\\(${J2},${J2},${J2}\\)$`),nWt=new RegExp(`^rgb\\(${ah},${ah},${ah}\\)$`),rWt=new RegExp(`^rgba\\(${J2},${J2},${J2},${jT}\\)$`),iWt=new RegExp(`^rgba\\(${ah},${ah},${ah},${jT}\\)$`),sWt=new RegExp(`^hsl\\(${jT},${ah},${ah}\\)$`),aWt=new RegExp(`^hsla\\(${jT},${ah},${ah},${jT}\\)$`),Gme={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Eie(eM,HT,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Yme,formatHex:Yme,formatHex8:oWt,formatHsl:lWt,formatRgb:Xme,toString:Xme});function Yme(){return this.rgb().formatHex()}function oWt(){return this.rgb().formatHex8()}function lWt(){return A4e(this).formatHsl()}function Xme(){return this.rgb().formatRgb()}function HT(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=eWt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Kme(t):n===3?new Go(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?SO(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?SO(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=tWt.exec(e))?new Go(t[1],t[2],t[3],1):(t=nWt.exec(e))?new Go(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=rWt.exec(e))?SO(t[1],t[2],t[3],t[4]):(t=iWt.exec(e))?SO(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=sWt.exec(e))?Jme(t[1],t[2]/100,t[3]/100,1):(t=aWt.exec(e))?Jme(t[1],t[2]/100,t[3]/100,t[4]):Gme.hasOwnProperty(e)?Kme(Gme[e]):e==="transparent"?new Go(NaN,NaN,NaN,0):null}function Kme(e){return new Go(e>>16&255,e>>8&255,e&255,1)}function SO(e,t,n,r){return r<=0&&(e=t=n=NaN),new Go(e,t,n,r)}function uWt(e){return e instanceof eM||(e=HT(e)),e?(e=e.rgb(),new Go(e.r,e.g,e.b,e.opacity)):new Go}function jX(e,t,n,r){return arguments.length===1?uWt(e):new Go(e,t,n,r==null?1:r)}function Go(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Eie(Go,jX,E4e(eM,{brighter(e){return e=e==null?hP:Math.pow(hP,e),new Go(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?VT:Math.pow(VT,e),new Go(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Go(ry(this.r),ry(this.g),ry(this.b),dP(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Zme,formatHex:Zme,formatHex8:cWt,formatRgb:Qme,toString:Qme}));function Zme(){return`#${I1(this.r)}${I1(this.g)}${I1(this.b)}`}function cWt(){return`#${I1(this.r)}${I1(this.g)}${I1(this.b)}${I1((isNaN(this.opacity)?1:this.opacity)*255)}`}function Qme(){const e=dP(this.opacity);return`${e===1?"rgb(":"rgba("}${ry(this.r)}, ${ry(this.g)}, ${ry(this.b)}${e===1?")":`, ${e})`}`}function dP(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ry(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function I1(e){return e=ry(e),(e<16?"0":"")+e.toString(16)}function Jme(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new $c(e,t,n,r)}function A4e(e){if(e instanceof $c)return new $c(e.h,e.s,e.l,e.opacity);if(e instanceof eM||(e=HT(e)),!e)return new $c;if(e instanceof $c)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new $c(a,o,l,e.opacity)}function fWt(e,t,n,r){return arguments.length===1?A4e(e):new $c(e,t,n,r==null?1:r)}function $c(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Eie($c,fWt,E4e(eM,{brighter(e){return e=e==null?hP:Math.pow(hP,e),new $c(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?VT:Math.pow(VT,e),new $c(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Go(Gj(e>=240?e-240:e+120,i,r),Gj(e,i,r),Gj(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new $c(eve(this.h),kO(this.s),kO(this.l),dP(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=dP(this.opacity);return`${e===1?"hsl(":"hsla("}${eve(this.h)}, ${kO(this.s)*100}%, ${kO(this.l)*100}%${e===1?")":`, ${e})`}`}}));function eve(e){return e=(e||0)%360,e<0?e+360:e}function kO(e){return Math.max(0,Math.min(1,e||0))}function Gj(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Aie=e=>()=>e;function hWt(e,t){return function(n){return e+n*t}}function dWt(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function pWt(e){return(e=+e)==1?T4e:function(t,n){return n-t?dWt(t,n,e):Aie(isNaN(t)?n:t)}}function T4e(e,t){var n=t-e;return n?hWt(e,n):Aie(isNaN(e)?t:e)}const tve=function e(t){var n=pWt(t);function r(i,s){var a=n((i=jX(i)).r,(s=jX(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=T4e(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function gWt(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function mWt(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function vWt(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=z_(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function yWt(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function pP(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function bWt(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=z_(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var HX=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Yj=new RegExp(HX.source,"g");function xWt(e){return function(){return e}}function wWt(e){return function(t){return e(t)+""}}function $Wt(e,t){var n=HX.lastIndex=Yj.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=HX.exec(e))&&(i=Yj.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:pP(r,i)})),n=Yj.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?wWt(l[0].x):xWt(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)o[(f=l[c]).i]=f.x(u);return o.join("")})}function z_(e,t){var n=typeof t,r;return t==null||n==="boolean"?Aie(t):(n==="number"?pP:n==="string"?(r=HT(t))?(t=r,tve):$Wt:t instanceof HT?tve:t instanceof Date?yWt:mWt(t)?gWt:Array.isArray(t)?vWt:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?bWt:pP)(e,t)}function Tie(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function CWt(e,t){t===void 0&&(t=e,e=z_);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function _Wt(e){return function(){return e}}function qX(e){return+e}var nve=[0,1];function Yo(e){return e}function GX(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:_Wt(isNaN(t)?NaN:.5)}function SWt(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function kWt(e,t,n){var r=e[0],i=e[1],s=t[0],a=t[1];return i<r?(r=GX(i,r),s=n(a,s)):(r=GX(r,i),s=n(s,a)),function(o){return s(r(o))}}function EWt(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=GX(e[a],e[a+1]),s[a]=n(t[a],t[a+1]);return function(o){var l=a9(e,o,1,r)-1;return s[l](i[l](o))}}function tM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function o9(){var e=nve,t=nve,n=z_,r,i,s,a=Yo,o,l,u;function c(){var h=Math.min(e.length,t.length);return a!==Yo&&(a=SWt(e[0],e[h-1])),o=h>2?EWt:kWt,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?s:(l||(l=o(e.map(r),t,n)))(r(a(h)))}return f.invert=function(h){return a(i((u||(u=o(t,e.map(r),pP)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,qX),c()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),n=Tie,c()},f.clamp=function(h){return arguments.length?(a=h?!0:Yo,c()):a!==Yo},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,d){return r=h,i=d,c()}}function D4e(){return o9()(Yo,Yo)}function AWt(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function gP(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Jw(e){return e=gP(Math.abs(e)),e?e[1]:NaN}function TWt(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function DWt(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var IWt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function qT(e){if(!(t=IWt.exec(e)))throw new Error("invalid format: "+e);var t;return new Die({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}qT.prototype=Die.prototype;function Die(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Die.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function NWt(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var I4e;function MWt(e,t){var n=gP(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(I4e=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+gP(e,Math.max(0,t+s-1))[0]}function rve(e,t){var n=gP(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const ive={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:AWt,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>rve(e*100,t),r:rve,s:MWt,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function sve(e){return e}var ave=Array.prototype.map,ove=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function FWt(e){var t=e.grouping===void 0||e.thousands===void 0?sve:TWt(ave.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?sve:DWt(ave.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=qT(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):ive[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var C=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=g==="$"?r:/[%p]/.test(w)?a:"",_=ive[w],k=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(S){var I=C,A=$,D,T,N;if(w==="c")A=_(S)+A,S="";else{S=+S;var F=S<0||1/S<0;if(S=isNaN(S)?l:_(Math.abs(S),b),x&&(S=NWt(S)),F&&+S==0&&p!=="+"&&(F=!1),I=(F?p==="("?p:o:p==="-"||p==="("?"":p)+I,A=(w==="s"?ove[8+I4e/3]:"")+A+(F&&p==="("?")":""),k){for(D=-1,T=S.length;++D<T;)if(N=S.charCodeAt(D),48>N||N>57){A=(N===46?i+S.slice(D+1):S.slice(D))+A,S=S.slice(0,D);break}}}y&&!m&&(S=t(S,1/0));var R=I.length+S.length+A.length,P=R<v?new Array(v-R+1).join(h):"";switch(y&&m&&(S=t(P+S,P.length?v-A.length:1/0),P=""),d){case"<":S=I+S+A+P;break;case"=":S=I+P+S+A;break;case"^":S=P.slice(0,R=P.length>>1)+I+S+A+P.slice(R);break;default:S=P+I+S+A;break}return s(S)}return E.toString=function(){return f+""},E}function c(f,h){var d=u((f=qT(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Jw(h)/3)))*3,g=Math.pow(10,-p),m=ove[8+p/3];return function(v){return d(g*v)+m}}return{format:u,formatPrefix:c}}var EO,Iie,N4e;OWt({thousands:",",grouping:[3],currency:["$",""]});function OWt(e){return EO=FWt(e),Iie=EO.format,N4e=EO.formatPrefix,EO}function RWt(e){return Math.max(0,-Jw(Math.abs(e)))}function PWt(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Jw(t)/3)))*3-Jw(Math.abs(e)))}function LWt(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Jw(t)-Jw(e))+1}function M4e(e,t,n,r){var i=WX(e,t,n),s;switch(r=qT(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=PWt(i,a))&&(r.precision=s),N4e(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=LWt(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=RWt(i))&&(r.precision=s-(r.type==="%")*2);break}}return Iie(r)}function ax(e){var t=e.domain;return e.ticks=function(n){var r=t();return zX(r[0],r[r.length-1],n==null?10:n)},e.tickFormat=function(n,r){var i=t();return M4e(i[0],i[i.length-1],n==null?10:n,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,a=r[i],o=r[s],l,u,c=10;for(o<a&&(u=a,a=o,o=u,u=i,i=s,s=u);c-- >0;){if(u=UX(a,o,n),u===l)return r[i]=a,r[s]=o,t(r);if(u>0)a=Math.floor(a/u)*u,o=Math.ceil(o/u)*u;else if(u<0)a=Math.ceil(a*u)/u,o=Math.floor(o*u)/u;else break;l=u}return e},e}function F4e(){var e=D4e();return e.copy=function(){return tM(e,F4e())},od.apply(e,arguments),ax(e)}function O4e(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,qX),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return O4e(e).unknown(t)},e=arguments.length?Array.from(e,qX):[0,1],ax(n)}function R4e(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),e[n]=t.floor(i),e[r]=t.ceil(s),e}function lve(e){return Math.log(e)}function uve(e){return Math.exp(e)}function BWt(e){return-Math.log(-e)}function zWt(e){return-Math.exp(-e)}function UWt(e){return isFinite(e)?+("1e"+e):e<0?0:e}function WWt(e){return e===10?UWt:e===Math.E?Math.exp:t=>Math.pow(e,t)}function VWt(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function cve(e){return(t,n)=>-e(-t,n)}function Nie(e){const t=e(lve,uve),n=t.domain;let r=10,i,s;function a(){return i=VWt(r),s=WWt(r),n()[0]<0?(i=cve(i),s=cve(s),e(BWt,zWt)):e(lve,uve),t}return t.base=function(o){return arguments.length?(r=+o,a()):r},t.domain=function(o){return arguments.length?(n(o),a()):n()},t.ticks=o=>{const l=n();let u=l[0],c=l[l.length-1];const f=c<u;f&&([u,c]=[c,u]);let h=i(u),d=i(c),p,g;const m=o==null?10:+o;let v=[];if(!(r%1)&&d-h<m){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(p=1;p<r;++p)if(g=h<0?p/s(-h):p*s(h),!(g<u)){if(g>c)break;v.push(g)}}else for(;h<=d;++h)for(p=r-1;p>=1;--p)if(g=h>0?p/s(-h):p*s(h),!(g<u)){if(g>c)break;v.push(g)}v.length*2<m&&(v=zX(u,c,m))}else v=zX(h,d,Math.min(d-h,m)).map(s);return f?v.reverse():v},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=qT(l)).precision==null&&(l.trim=!0),l=Iie(l)),o===1/0)return l;const u=Math.max(1,r*o/t.ticks().length);return c=>{let f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=()=>n(R4e(n(),{floor:o=>s(Math.floor(i(o))),ceil:o=>s(Math.ceil(i(o)))})),t}function P4e(){const e=Nie(o9()).domain([1,10]);return e.copy=()=>tM(e,P4e()).base(e.base()),od.apply(e,arguments),e}function fve(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function hve(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Mie(e){var t=1,n=e(fve(t),hve(t));return n.constant=function(r){return arguments.length?e(fve(t=+r),hve(t)):t},ax(n)}function L4e(){var e=Mie(o9());return e.copy=function(){return tM(e,L4e()).constant(e.constant())},od.apply(e,arguments)}function dve(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function jWt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function HWt(e){return e<0?-e*e:e*e}function Fie(e){var t=e(Yo,Yo),n=1;function r(){return n===1?e(Yo,Yo):n===.5?e(jWt,HWt):e(dve(n),dve(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},ax(t)}function Oie(){var e=Fie(o9());return e.copy=function(){return tM(e,Oie()).exponent(e.exponent())},od.apply(e,arguments),e}function qWt(){return Oie.apply(null,arguments).exponent(.5)}function B4e(){var e=[],t=[],n=[],r;function i(){var a=0,o=Math.max(1,t.length);for(n=new Array(o-1);++a<o;)n[a-1]=JUt(e,a/o);return s}function s(a){return a==null||isNaN(a=+a)?r:t[a9(n,a)]}return s.invertExtent=function(a){var o=t.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},s.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let o of a)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(lA),i()},s.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return B4e().domain(e).range(t).unknown(r)},od.apply(s,arguments)}function z4e(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function a(l){return l!=null&&l<=l?i[a9(r,l,0,n)]:s}function o(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return a}return a.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},a.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,o()):i.slice()},a.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},a.unknown=function(l){return arguments.length&&(s=l),a},a.thresholds=function(){return r.slice()},a.copy=function(){return z4e().domain([e,t]).range(i).unknown(s)},od.apply(ax(a),arguments)}function U4e(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[a9(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var a=t.indexOf(s);return[e[a-1],e[a]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return U4e().domain(e).range(t).unknown(n)},od.apply(i,arguments)}const Xj=new Date,Kj=new Date;function zi(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>zi(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(Xj.setTime(+s),Kj.setTime(+a),e(Xj),e(Kj),Math.floor(n(Xj,Kj))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const mP=zi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);mP.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?zi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):mP);mP.range;const Zd=1e3,vu=Zd*60,Qd=vu*60,Lp=Qd*24,Rie=Lp*7,pve=Lp*30,Zj=Lp*365,N1=zi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Zd)},(e,t)=>(t-e)/Zd,e=>e.getUTCSeconds());N1.range;const Pie=zi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Zd)},(e,t)=>{e.setTime(+e+t*vu)},(e,t)=>(t-e)/vu,e=>e.getMinutes());Pie.range;const Lie=zi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*vu)},(e,t)=>(t-e)/vu,e=>e.getUTCMinutes());Lie.range;const Bie=zi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Zd-e.getMinutes()*vu)},(e,t)=>{e.setTime(+e+t*Qd)},(e,t)=>(t-e)/Qd,e=>e.getHours());Bie.range;const zie=zi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Qd)},(e,t)=>(t-e)/Qd,e=>e.getUTCHours());zie.range;const nM=zi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*vu)/Lp,e=>e.getDate()-1);nM.range;const l9=zi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Lp,e=>e.getUTCDate()-1);l9.range;const W4e=zi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Lp,e=>Math.floor(e/Lp));W4e.range;function ox(e){return zi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*vu)/Rie)}const u9=ox(0),vP=ox(1),GWt=ox(2),YWt=ox(3),e$=ox(4),XWt=ox(5),KWt=ox(6);u9.range;vP.range;GWt.range;YWt.range;e$.range;XWt.range;KWt.range;function lx(e){return zi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/Rie)}const c9=lx(0),yP=lx(1),ZWt=lx(2),QWt=lx(3),t$=lx(4),JWt=lx(5),eVt=lx(6);c9.range;yP.range;ZWt.range;QWt.range;t$.range;JWt.range;eVt.range;const Uie=zi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Uie.range;const Wie=zi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Wie.range;const Bp=zi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Bp.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:zi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Bp.range;const zp=zi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());zp.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:zi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});zp.range;function V4e(e,t,n,r,i,s){const a=[[N1,1,Zd],[N1,5,5*Zd],[N1,15,15*Zd],[N1,30,30*Zd],[s,1,vu],[s,5,5*vu],[s,15,15*vu],[s,30,30*vu],[i,1,Qd],[i,3,3*Qd],[i,6,6*Qd],[i,12,12*Qd],[r,1,Lp],[r,2,2*Lp],[n,1,Rie],[t,1,pve],[t,3,3*pve],[e,1,Zj]];function o(u,c,f){const h=c<u;h&&([u,c]=[c,u]);const d=f&&typeof f.range=="function"?f:l(u,c,f),p=d?d.range(u,+c+1):[];return h?p.reverse():p}function l(u,c,f){const h=Math.abs(c-u)/f,d=Sie(([,,m])=>m).right(a,h);if(d===a.length)return e.every(WX(u/Zj,c/Zj,f));if(d===0)return mP.every(Math.max(WX(u,c,f),1));const[p,g]=a[h/a[d-1][2]<a[d][2]/h?d-1:d];return p.every(g)}return[o,l]}const[tVt,nVt]=V4e(zp,Wie,c9,W4e,zie,Lie),[rVt,iVt]=V4e(Bp,Uie,u9,nM,Bie,Pie);function Qj(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Jj(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function lk(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function sVt(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=uk(i),c=ck(i),f=uk(s),h=ck(s),d=uk(a),p=ck(a),g=uk(o),m=ck(o),v=uk(l),y=ck(l),b={a:F,A:R,b:P,B:V,c:null,d:xve,e:xve,f:AVt,g:LVt,G:zVt,H:SVt,I:kVt,j:EVt,L:j4e,m:TVt,M:DVt,p:z,q,Q:Cve,s:_ve,S:IVt,u:NVt,U:MVt,V:FVt,w:OVt,W:RVt,x:null,X:null,y:PVt,Y:BVt,Z:UVt,"%":$ve},x={a:G,A:K,b:Y,B:te,c:null,d:wve,e:wve,f:HVt,g:tjt,G:rjt,H:WVt,I:VVt,j:jVt,L:q4e,m:qVt,M:GVt,p:Z,q:ae,Q:Cve,s:_ve,S:YVt,u:XVt,U:KVt,V:ZVt,w:QVt,W:JVt,x:null,X:null,y:ejt,Y:njt,Z:ijt,"%":$ve},w={a:E,A:S,b:I,B:A,c:D,d:yve,e:yve,f:wVt,g:vve,G:mve,H:bve,I:bve,j:vVt,L:xVt,m:mVt,M:yVt,p:k,q:gVt,Q:CVt,s:_Vt,S:bVt,u:cVt,U:fVt,V:hVt,w:uVt,W:dVt,x:T,X:N,y:vve,Y:mve,Z:pVt,"%":$Vt};b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x);function C(O,L){return function(W){var M=[],ue=-1,X=0,se=O.length,oe,pe,Ce;for(W instanceof Date||(W=new Date(+W));++ue<se;)O.charCodeAt(ue)===37&&(M.push(O.slice(X,ue)),(pe=gve[oe=O.charAt(++ue)])!=null?oe=O.charAt(++ue):pe=oe==="e"?" ":"0",(Ce=L[oe])&&(oe=Ce(W,pe)),M.push(oe),X=ue+1);return M.push(O.slice(X,ue)),M.join("")}}function $(O,L){return function(W){var M=lk(1900,void 0,1),ue=_(M,O,W+="",0),X,se;if(ue!=W.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(L&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(X=Jj(lk(M.y,0,1)),se=X.getUTCDay(),X=se>4||se===0?yP.ceil(X):yP(X),X=l9.offset(X,(M.V-1)*7),M.y=X.getUTCFullYear(),M.m=X.getUTCMonth(),M.d=X.getUTCDate()+(M.w+6)%7):(X=Qj(lk(M.y,0,1)),se=X.getDay(),X=se>4||se===0?vP.ceil(X):vP(X),X=nM.offset(X,(M.V-1)*7),M.y=X.getFullYear(),M.m=X.getMonth(),M.d=X.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),se="Z"in M?Jj(lk(M.y,0,1)).getUTCDay():Qj(lk(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(se+5)%7:M.w+M.U*7-(se+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,Jj(M)):Qj(M)}}function _(O,L,W,M){for(var ue=0,X=L.length,se=W.length,oe,pe;ue<X;){if(M>=se)return-1;if(oe=L.charCodeAt(ue++),oe===37){if(oe=L.charAt(ue++),pe=w[oe in gve?L.charAt(ue++):oe],!pe||(M=pe(O,W,M))<0)return-1}else if(oe!=W.charCodeAt(M++))return-1}return M}function k(O,L,W){var M=u.exec(L.slice(W));return M?(O.p=c.get(M[0].toLowerCase()),W+M[0].length):-1}function E(O,L,W){var M=d.exec(L.slice(W));return M?(O.w=p.get(M[0].toLowerCase()),W+M[0].length):-1}function S(O,L,W){var M=f.exec(L.slice(W));return M?(O.w=h.get(M[0].toLowerCase()),W+M[0].length):-1}function I(O,L,W){var M=v.exec(L.slice(W));return M?(O.m=y.get(M[0].toLowerCase()),W+M[0].length):-1}function A(O,L,W){var M=g.exec(L.slice(W));return M?(O.m=m.get(M[0].toLowerCase()),W+M[0].length):-1}function D(O,L,W){return _(O,t,L,W)}function T(O,L,W){return _(O,n,L,W)}function N(O,L,W){return _(O,r,L,W)}function F(O){return a[O.getDay()]}function R(O){return s[O.getDay()]}function P(O){return l[O.getMonth()]}function V(O){return o[O.getMonth()]}function z(O){return i[+(O.getHours()>=12)]}function q(O){return 1+~~(O.getMonth()/3)}function G(O){return a[O.getUTCDay()]}function K(O){return s[O.getUTCDay()]}function Y(O){return l[O.getUTCMonth()]}function te(O){return o[O.getUTCMonth()]}function Z(O){return i[+(O.getUTCHours()>=12)]}function ae(O){return 1+~~(O.getUTCMonth()/3)}return{format:function(O){var L=C(O+="",b);return L.toString=function(){return O},L},parse:function(O){var L=$(O+="",!1);return L.toString=function(){return O},L},utcFormat:function(O){var L=C(O+="",x);return L.toString=function(){return O},L},utcParse:function(O){var L=$(O+="",!0);return L.toString=function(){return O},L}}}var gve={"-":"",_:" ",0:"0"},xs=/^\s*\d+/,aVt=/^%/,oVt=/[\\^$*+?|[\]().{}]/g;function $n(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function lVt(e){return e.replace(oVt,"\\$&")}function uk(e){return new RegExp("^(?:"+e.map(lVt).join("|")+")","i")}function ck(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function uVt(e,t,n){var r=xs.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function cVt(e,t,n){var r=xs.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function fVt(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function hVt(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function dVt(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function mve(e,t,n){var r=xs.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function vve(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function pVt(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function gVt(e,t,n){var r=xs.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function mVt(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function yve(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function vVt(e,t,n){var r=xs.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function bve(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function yVt(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function bVt(e,t,n){var r=xs.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function xVt(e,t,n){var r=xs.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function wVt(e,t,n){var r=xs.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function $Vt(e,t,n){var r=aVt.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function CVt(e,t,n){var r=xs.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function _Vt(e,t,n){var r=xs.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function xve(e,t){return $n(e.getDate(),t,2)}function SVt(e,t){return $n(e.getHours(),t,2)}function kVt(e,t){return $n(e.getHours()%12||12,t,2)}function EVt(e,t){return $n(1+nM.count(Bp(e),e),t,3)}function j4e(e,t){return $n(e.getMilliseconds(),t,3)}function AVt(e,t){return j4e(e,t)+"000"}function TVt(e,t){return $n(e.getMonth()+1,t,2)}function DVt(e,t){return $n(e.getMinutes(),t,2)}function IVt(e,t){return $n(e.getSeconds(),t,2)}function NVt(e){var t=e.getDay();return t===0?7:t}function MVt(e,t){return $n(u9.count(Bp(e)-1,e),t,2)}function H4e(e){var t=e.getDay();return t>=4||t===0?e$(e):e$.ceil(e)}function FVt(e,t){return e=H4e(e),$n(e$.count(Bp(e),e)+(Bp(e).getDay()===4),t,2)}function OVt(e){return e.getDay()}function RVt(e,t){return $n(vP.count(Bp(e)-1,e),t,2)}function PVt(e,t){return $n(e.getFullYear()%100,t,2)}function LVt(e,t){return e=H4e(e),$n(e.getFullYear()%100,t,2)}function BVt(e,t){return $n(e.getFullYear()%1e4,t,4)}function zVt(e,t){var n=e.getDay();return e=n>=4||n===0?e$(e):e$.ceil(e),$n(e.getFullYear()%1e4,t,4)}function UVt(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+$n(t/60|0,"0",2)+$n(t%60,"0",2)}function wve(e,t){return $n(e.getUTCDate(),t,2)}function WVt(e,t){return $n(e.getUTCHours(),t,2)}function VVt(e,t){return $n(e.getUTCHours()%12||12,t,2)}function jVt(e,t){return $n(1+l9.count(zp(e),e),t,3)}function q4e(e,t){return $n(e.getUTCMilliseconds(),t,3)}function HVt(e,t){return q4e(e,t)+"000"}function qVt(e,t){return $n(e.getUTCMonth()+1,t,2)}function GVt(e,t){return $n(e.getUTCMinutes(),t,2)}function YVt(e,t){return $n(e.getUTCSeconds(),t,2)}function XVt(e){var t=e.getUTCDay();return t===0?7:t}function KVt(e,t){return $n(c9.count(zp(e)-1,e),t,2)}function G4e(e){var t=e.getUTCDay();return t>=4||t===0?t$(e):t$.ceil(e)}function ZVt(e,t){return e=G4e(e),$n(t$.count(zp(e),e)+(zp(e).getUTCDay()===4),t,2)}function QVt(e){return e.getUTCDay()}function JVt(e,t){return $n(yP.count(zp(e)-1,e),t,2)}function ejt(e,t){return $n(e.getUTCFullYear()%100,t,2)}function tjt(e,t){return e=G4e(e),$n(e.getUTCFullYear()%100,t,2)}function njt(e,t){return $n(e.getUTCFullYear()%1e4,t,4)}function rjt(e,t){var n=e.getUTCDay();return e=n>=4||n===0?t$(e):t$.ceil(e),$n(e.getUTCFullYear()%1e4,t,4)}function ijt(){return"+0000"}function $ve(){return"%"}function Cve(e){return+e}function _ve(e){return Math.floor(+e/1e3)}var a2,Y4e,X4e;sjt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function sjt(e){return a2=sVt(e),Y4e=a2.format,a2.parse,X4e=a2.utcFormat,a2.utcParse,a2}function ajt(e){return new Date(e)}function ojt(e){return e instanceof Date?+e:+new Date(+e)}function Vie(e,t,n,r,i,s,a,o,l,u){var c=D4e(),f=c.invert,h=c.domain,d=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),x=u("%Y");function w(C){return(l(C)<C?d:o(C)<C?p:a(C)<C?g:s(C)<C?m:r(C)<C?i(C)<C?v:y:n(C)<C?b:x)(C)}return c.invert=function(C){return new Date(f(C))},c.domain=function(C){return arguments.length?h(Array.from(C,ojt)):h().map(ajt)},c.ticks=function(C){var $=h();return e($[0],$[$.length-1],C==null?10:C)},c.tickFormat=function(C,$){return $==null?w:u($)},c.nice=function(C){var $=h();return(!C||typeof C.range!="function")&&(C=t($[0],$[$.length-1],C==null?10:C)),C?h(R4e($,C)):c},c.copy=function(){return tM(c,Vie(e,t,n,r,i,s,a,o,l,u))},c}function ljt(){return od.apply(Vie(rVt,iVt,Bp,Uie,u9,nM,Bie,Pie,N1,Y4e).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ujt(){return od.apply(Vie(tVt,nVt,zp,Wie,c9,l9,zie,Lie,N1,X4e).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function f9(){var e=0,t=1,n,r,i,s,a=Yo,o=!1,l;function u(f){return f==null||isNaN(f=+f)?l:a(i===0?.5:(f=(s(f)-n)*i,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(a=f,u):a};function c(f){return function(h){var d,p;return arguments.length?([d,p]=h,a=f(d,p),u):[a(0),a(1)]}}return u.range=c(z_),u.rangeRound=c(Tie),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function Xm(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function jie(){var e=ax(f9()(Yo));return e.copy=function(){return Xm(e,jie())},Ym.apply(e,arguments)}function K4e(){var e=Nie(f9()).domain([1,10]);return e.copy=function(){return Xm(e,K4e()).base(e.base())},Ym.apply(e,arguments)}function Z4e(){var e=Mie(f9());return e.copy=function(){return Xm(e,Z4e()).constant(e.constant())},Ym.apply(e,arguments)}function Hie(){var e=Fie(f9());return e.copy=function(){return Xm(e,Hie()).exponent(e.exponent())},Ym.apply(e,arguments)}function cjt(){return Hie.apply(null,arguments).exponent(.5)}function h9(){var e=0,t=.5,n=1,r=1,i,s,a,o,l,u=Yo,c,f=!1,h;function d(g){return isNaN(g=+g)?h:(g=.5+((g=+c(g))-s)*(r*g<r*s?o:l),u(f?Math.max(0,Math.min(1,g)):g))}d.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),s=c(t=+t),a=c(n=+n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d):[e,t,n]},d.clamp=function(g){return arguments.length?(f=!!g,d):f},d.interpolator=function(g){return arguments.length?(u=g,d):u};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,u=CWt(g,[v,y,b]),d):[u(0),u(.5),u(1)]}}return d.range=p(z_),d.rangeRound=p(Tie),d.unknown=function(g){return arguments.length?(h=g,d):h},function(g){return c=g,i=g(e),s=g(t),a=g(n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d}}function Q4e(){var e=ax(h9()(Yo));return e.copy=function(){return Xm(e,Q4e())},Ym.apply(e,arguments)}function J4e(){var e=Nie(h9()).domain([.1,1,10]);return e.copy=function(){return Xm(e,J4e()).base(e.base())},Ym.apply(e,arguments)}function e5e(){var e=Mie(h9());return e.copy=function(){return Xm(e,e5e()).constant(e.constant())},Ym.apply(e,arguments)}function qie(){var e=Fie(h9());return e.copy=function(){return Xm(e,qie()).exponent(e.exponent())},Ym.apply(e,arguments)}function fjt(){return qie.apply(null,arguments).exponent(.5)}function U_(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function rM(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Km(){}var Yy=.7,n$=1/Yy,ew="\\s*([+-]?\\d+)\\s*",GT="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",oh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hjt=/^#([0-9a-f]{3,8})$/,djt=new RegExp(`^rgb\\(${ew},${ew},${ew}\\)$`),pjt=new RegExp(`^rgb\\(${oh},${oh},${oh}\\)$`),gjt=new RegExp(`^rgba\\(${ew},${ew},${ew},${GT}\\)$`),mjt=new RegExp(`^rgba\\(${oh},${oh},${oh},${GT}\\)$`),vjt=new RegExp(`^hsl\\(${GT},${oh},${oh}\\)$`),yjt=new RegExp(`^hsla\\(${GT},${oh},${oh},${GT}\\)$`),Sve={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};U_(Km,YT,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:kve,formatHex:kve,formatHex8:bjt,formatHsl:xjt,formatRgb:Eve,toString:Eve});function kve(){return this.rgb().formatHex()}function bjt(){return this.rgb().formatHex8()}function xjt(){return t5e(this).formatHsl()}function Eve(){return this.rgb().formatRgb()}function YT(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=hjt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Ave(t):n===3?new ts(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?AO(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?AO(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=djt.exec(e))?new ts(t[1],t[2],t[3],1):(t=pjt.exec(e))?new ts(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=gjt.exec(e))?AO(t[1],t[2],t[3],t[4]):(t=mjt.exec(e))?AO(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=vjt.exec(e))?Ive(t[1],t[2]/100,t[3]/100,1):(t=yjt.exec(e))?Ive(t[1],t[2]/100,t[3]/100,t[4]):Sve.hasOwnProperty(e)?Ave(Sve[e]):e==="transparent"?new ts(NaN,NaN,NaN,0):null}function Ave(e){return new ts(e>>16&255,e>>8&255,e&255,1)}function AO(e,t,n,r){return r<=0&&(e=t=n=NaN),new ts(e,t,n,r)}function Gie(e){return e instanceof Km||(e=YT(e)),e?(e=e.rgb(),new ts(e.r,e.g,e.b,e.opacity)):new ts}function bP(e,t,n,r){return arguments.length===1?Gie(e):new ts(e,t,n,r==null?1:r)}function ts(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}U_(ts,bP,rM(Km,{brighter(e){return e=e==null?n$:Math.pow(n$,e),new ts(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Yy:Math.pow(Yy,e),new ts(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ts(iy(this.r),iy(this.g),iy(this.b),xP(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Tve,formatHex:Tve,formatHex8:wjt,formatRgb:Dve,toString:Dve}));function Tve(){return`#${M1(this.r)}${M1(this.g)}${M1(this.b)}`}function wjt(){return`#${M1(this.r)}${M1(this.g)}${M1(this.b)}${M1((isNaN(this.opacity)?1:this.opacity)*255)}`}function Dve(){const e=xP(this.opacity);return`${e===1?"rgb(":"rgba("}${iy(this.r)}, ${iy(this.g)}, ${iy(this.b)}${e===1?")":`, ${e})`}`}function xP(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function iy(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function M1(e){return e=iy(e),(e<16?"0":"")+e.toString(16)}function Ive(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Cc(e,t,n,r)}function t5e(e){if(e instanceof Cc)return new Cc(e.h,e.s,e.l,e.opacity);if(e instanceof Km||(e=YT(e)),!e)return new Cc;if(e instanceof Cc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new Cc(a,o,l,e.opacity)}function YX(e,t,n,r){return arguments.length===1?t5e(e):new Cc(e,t,n,r==null?1:r)}function Cc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}U_(Cc,YX,rM(Km,{brighter(e){return e=e==null?n$:Math.pow(n$,e),new Cc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Yy:Math.pow(Yy,e),new Cc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ts(eH(e>=240?e-240:e+120,i,r),eH(e,i,r),eH(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Cc(Nve(this.h),TO(this.s),TO(this.l),xP(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=xP(this.opacity);return`${e===1?"hsl(":"hsla("}${Nve(this.h)}, ${TO(this.s)*100}%, ${TO(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Nve(e){return e=(e||0)%360,e<0?e+360:e}function TO(e){return Math.max(0,Math.min(1,e||0))}function eH(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const n5e=Math.PI/180,r5e=180/Math.PI,wP=18,i5e=.96422,s5e=1,a5e=.82521,o5e=4/29,tw=6/29,l5e=3*tw*tw,$jt=tw*tw*tw;function u5e(e){if(e instanceof lh)return new lh(e.l,e.a,e.b,e.opacity);if(e instanceof Jd)return c5e(e);e instanceof ts||(e=Gie(e));var t=iH(e.r),n=iH(e.g),r=iH(e.b),i=tH((.2225045*t+.7168786*n+.0606169*r)/s5e),s,a;return t===n&&n===r?s=a=i:(s=tH((.4360747*t+.3850649*n+.1430804*r)/i5e),a=tH((.0139322*t+.0971045*n+.7141733*r)/a5e)),new lh(116*i-16,500*(s-i),200*(i-a),e.opacity)}function XX(e,t,n,r){return arguments.length===1?u5e(e):new lh(e,t,n,r==null?1:r)}function lh(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}U_(lh,XX,rM(Km,{brighter(e){return new lh(this.l+wP*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new lh(this.l-wP*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=i5e*nH(t),e=s5e*nH(e),n=a5e*nH(n),new ts(rH(3.1338561*t-1.6168667*e-.4906146*n),rH(-.9787684*t+1.9161415*e+.033454*n),rH(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function tH(e){return e>$jt?Math.pow(e,1/3):e/l5e+o5e}function nH(e){return e>tw?e*e*e:l5e*(e-o5e)}function rH(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function iH(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Cjt(e){if(e instanceof Jd)return new Jd(e.h,e.c,e.l,e.opacity);if(e instanceof lh||(e=u5e(e)),e.a===0&&e.b===0)return new Jd(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*r5e;return new Jd(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function KX(e,t,n,r){return arguments.length===1?Cjt(e):new Jd(e,t,n,r==null?1:r)}function Jd(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function c5e(e){if(isNaN(e.h))return new lh(e.l,0,0,e.opacity);var t=e.h*n5e;return new lh(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}U_(Jd,KX,rM(Km,{brighter(e){return new Jd(this.h,this.c,this.l+wP*(e==null?1:e),this.opacity)},darker(e){return new Jd(this.h,this.c,this.l-wP*(e==null?1:e),this.opacity)},rgb(){return c5e(this).rgb()}}));var f5e=-.14861,Yie=1.78277,Xie=-.29227,d9=-.90649,XT=1.97294,Mve=XT*d9,Fve=XT*Yie,Ove=Yie*Xie-d9*f5e;function _jt(e){if(e instanceof sy)return new sy(e.h,e.s,e.l,e.opacity);e instanceof ts||(e=Gie(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Ove*r+Mve*t-Fve*n)/(Ove+Mve-Fve),s=r-i,a=(XT*(n-i)-Xie*s)/d9,o=Math.sqrt(a*a+s*s)/(XT*i*(1-i)),l=o?Math.atan2(a,s)*r5e-120:NaN;return new sy(l<0?l+360:l,o,i,e.opacity)}function ZX(e,t,n,r){return arguments.length===1?_jt(e):new sy(e,t,n,r==null?1:r)}function sy(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}U_(sy,ZX,rM(Km,{brighter(e){return e=e==null?n$:Math.pow(n$,e),new sy(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Yy:Math.pow(Yy,e),new sy(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*n5e,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new ts(255*(t+n*(f5e*r+Yie*i)),255*(t+n*(Xie*r+d9*i)),255*(t+n*(XT*r)),this.opacity)}}));function h5e(e,t,n,r,i){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*n+(1+3*e+3*s-3*a)*r+a*i)/6}function d5e(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],a=r>0?e[r-1]:2*i-s,o=r<t-1?e[r+2]:2*s-i;return h5e((n-r/t)*t,a,i,s,o)}}function p5e(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],a=e[(r+1)%t],o=e[(r+2)%t];return h5e((n-r/t)*t,i,s,a,o)}}const p9=e=>()=>e;function g5e(e,t){return function(n){return e+n*t}}function Sjt(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function g9(e,t){var n=t-e;return n?g5e(e,n>180||n<-180?n-360*Math.round(n/360):n):p9(isNaN(e)?t:e)}function kjt(e){return(e=+e)==1?ns:function(t,n){return n-t?Sjt(t,n,e):p9(isNaN(t)?n:t)}}function ns(e,t){var n=t-e;return n?g5e(e,n):p9(isNaN(e)?t:e)}const QX=function e(t){var n=kjt(t);function r(i,s){var a=n((i=bP(i)).r,(s=bP(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=ns(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function m5e(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),a,o;for(a=0;a<n;++a)o=bP(t[a]),r[a]=o.r||0,i[a]=o.g||0,s[a]=o.b||0;return r=e(r),i=e(i),s=e(s),o.opacity=1,function(l){return o.r=r(l),o.g=i(l),o.b=s(l),o+""}}}var Ejt=m5e(d5e),Ajt=m5e(p5e);function Kie(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function v5e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Tjt(e,t){return(v5e(t)?Kie:y5e)(e,t)}function y5e(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=m9(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function b5e(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Rf(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function x5e(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=m9(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var JX=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sH=new RegExp(JX.source,"g");function Djt(e){return function(){return e}}function Ijt(e){return function(t){return e(t)+""}}function w5e(e,t){var n=JX.lastIndex=sH.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=JX.exec(e))&&(i=sH.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:Rf(r,i)})),n=sH.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?Ijt(l[0].x):Djt(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)o[(f=l[c]).i]=f.x(u);return o.join("")})}function m9(e,t){var n=typeof t,r;return t==null||n==="boolean"?p9(t):(n==="number"?Rf:n==="string"?(r=YT(t))?(t=r,QX):w5e:t instanceof YT?QX:t instanceof Date?b5e:v5e(t)?Kie:Array.isArray(t)?y5e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?x5e:Rf)(e,t)}function Njt(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Mjt(e,t){var n=g9(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function Fjt(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Rve=180/Math.PI,eK={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function $5e(e,t,n,r,i,s){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*Rve,skewX:Math.atan(l)*Rve,scaleX:a,scaleY:o}}var DO;function Ojt(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?eK:$5e(t.a,t.b,t.c,t.d,t.e,t.f)}function Rjt(e){return e==null||(DO||(DO=document.createElementNS("http://www.w3.org/2000/svg","g")),DO.setAttribute("transform",e),!(e=DO.transform.baseVal.consolidate()))?eK:(e=e.matrix,$5e(e.a,e.b,e.c,e.d,e.e,e.f))}function C5e(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push("translate(",null,t,null,n);p.push({i:g-4,x:Rf(u,f)},{i:g-2,x:Rf(c,h)})}else(f||h)&&d.push("translate("+f+t+h+n)}function a(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:Rf(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function o(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:Rf(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push(i(d)+"scale(",null,",",null,")");p.push({i:g-4,x:Rf(u,f)},{i:g-2,x:Rf(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=e(u),c=e(c),s(u.translateX,u.translateY,c.translateX,c.translateY,f,h),a(u.rotate,c.rotate,f,h),o(u.skewX,c.skewX,f,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,g=h.length,m;++p<g;)f[(m=h[p]).i]=m.x(d);return f.join("")}}}var Pjt=C5e(Ojt,"px, ","px)","deg)"),Ljt=C5e(Rjt,", ",")",")"),Bjt=1e-12;function Pve(e){return((e=Math.exp(e))+1/e)/2}function zjt(e){return((e=Math.exp(e))-1/e)/2}function Ujt(e){return((e=Math.exp(2*e))-1)/(e+1)}const Wjt=function e(t,n,r){function i(s,a){var o=s[0],l=s[1],u=s[2],c=a[0],f=a[1],h=a[2],d=c-o,p=f-l,g=d*d+p*p,m,v;if(g<Bjt)v=Math.log(h/u)/t,m=function($){return[o+$*d,l+$*p,u*Math.exp(t*$*v)]};else{var y=Math.sqrt(g),b=(h*h-u*u+r*g)/(2*u*n*y),x=(h*h-u*u-r*g)/(2*h*n*y),w=Math.log(Math.sqrt(b*b+1)-b),C=Math.log(Math.sqrt(x*x+1)-x);v=(C-w)/t,m=function($){var _=$*v,k=Pve(w),E=u/(n*y)*(k*Ujt(t*_+w)-zjt(w));return[o+E*d,l+E*p,u*k/Pve(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(s){var a=Math.max(.001,+s),o=a*a,l=o*o;return e(a,o,l)},i}(Math.SQRT2,2,4);function _5e(e){return function(t,n){var r=e((t=YX(t)).h,(n=YX(n)).h),i=ns(t.s,n.s),s=ns(t.l,n.l),a=ns(t.opacity,n.opacity);return function(o){return t.h=r(o),t.s=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const Vjt=_5e(g9);var jjt=_5e(ns);function Hjt(e,t){var n=ns((e=XX(e)).l,(t=XX(t)).l),r=ns(e.a,t.a),i=ns(e.b,t.b),s=ns(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=s(a),e+""}}function S5e(e){return function(t,n){var r=e((t=KX(t)).h,(n=KX(n)).h),i=ns(t.c,n.c),s=ns(t.l,n.l),a=ns(t.opacity,n.opacity);return function(o){return t.h=r(o),t.c=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const qjt=S5e(g9);var Gjt=S5e(ns);function k5e(e){return function t(n){n=+n;function r(i,s){var a=e((i=ZX(i)).h,(s=ZX(s)).h),o=ns(i.s,s.s),l=ns(i.l,s.l),u=ns(i.opacity,s.opacity);return function(c){return i.h=a(c),i.s=o(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}const Yjt=k5e(g9);var Xjt=k5e(ns);function E5e(e,t){t===void 0&&(t=e,e=m9);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function Kjt(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const Zjt=Object.freeze(Object.defineProperty({__proto__:null,interpolate:m9,interpolateArray:Tjt,interpolateBasis:d5e,interpolateBasisClosed:p5e,interpolateDate:b5e,interpolateDiscrete:Njt,interpolateHue:Mjt,interpolateNumber:Rf,interpolateNumberArray:Kie,interpolateObject:x5e,interpolateRound:Fjt,interpolateString:w5e,interpolateTransformCss:Pjt,interpolateTransformSvg:Ljt,interpolateZoom:Wjt,interpolateRgb:QX,interpolateRgbBasis:Ejt,interpolateRgbBasisClosed:Ajt,interpolateHsl:Vjt,interpolateHslLong:jjt,interpolateLab:Hjt,interpolateHcl:qjt,interpolateHclLong:Gjt,interpolateCubehelix:Yjt,interpolateCubehelixLong:Xjt,piecewise:E5e,quantize:Kjt},Symbol.toStringTag,{value:"Module"}));function Zie(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const Qjt="identity",r$="linear",Up="log",iM="pow",sM="sqrt",v9="symlog",Xy="time",Ky="utc",uh="sequential",W_="diverging",i$="quantile",y9="quantize",b9="threshold",Qie="ordinal",tK="point",A5e="band",Jie="bin-ordinal",Ui="continuous",aM="discrete",oM="discretizing",Xu="interpolating",ese="temporal";function Jjt(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function eHt(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,a,o,l,u;for(i<r&&(o=r,r=i,i=o),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(s<0&&(s=l),a=l);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[a]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function tse(){const e=kie().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,a=!1,o=0,l=0,u=.5;delete e.unknown;function c(){const f=t().length,h=r[1]<r[0],d=r[1-h],p=Zie(f,o,l);let g=r[h-0];i=(d-g)/(p||1),a&&(i=Math.floor(i)),g+=(d-g-i*(f-o))*u,s=i*(1-o),a&&(g=Math.round(g),s=Math.round(s));const m=HUt(f).map(v=>g+i*v);return n(h?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),o=l,c()):o},e.paddingInner=function(f){return arguments.length?(o=Math.max(0,Math.min(1,f)),c()):o},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const h=r[1]<r[0],d=h?n().reverse():n(),p=d.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<d[0]||g>r[1-h])))return v=Math.max(0,BX(d,g)-1),y=g===m?v:BX(d,m)-1,g-d[v]>s+1e-10&&++v,h&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const h=e.invertRange([f,f]);return h&&h[0]},e.copy=function(){return tse().domain(t()).range(r).round(a).paddingInner(o).paddingOuter(l).align(u)},c()}function T5e(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return T5e(t())},e}function tHt(){return T5e(tse().paddingInner(1))}var nHt=Array.prototype.map;function rHt(e){return nHt.call(e,io)}const iHt=Array.prototype.slice;function D5e(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(jUt(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=rHt(r),n):e.slice()},n.range=function(r){return arguments.length?(t=iHt.call(r),n):t.slice()},n.tickFormat=function(r,i){return M4e(e[0],ln(e),r==null?10:r,i)},n.copy=function(){return D5e().domain(n.domain()).range(n.range())},n}const $P=new Map,I5e=Symbol("vega_scale");function N5e(e){return e[I5e]=!0,e}function sHt(e){return e&&e[I5e]===!0}function aHt(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?Jjt(s):s.invertExtent?eHt(s):void 0),s.type=e,N5e(s)};return r.metadata=Oh(ct(n)),r}function Dn(e,t,n){return arguments.length>1?($P.set(e,aHt(e,t,n)),this):M5e(e)?$P.get(e):void 0}Dn(Qjt,O4e);Dn(r$,F4e,Ui);Dn(Up,P4e,[Ui,Up]);Dn(iM,Oie,Ui);Dn(sM,qWt,Ui);Dn(v9,L4e,Ui);Dn(Xy,ljt,[Ui,ese]);Dn(Ky,ujt,[Ui,ese]);Dn(uh,jie,[Ui,Xu]);Dn(`${uh}-${r$}`,jie,[Ui,Xu]);Dn(`${uh}-${Up}`,K4e,[Ui,Xu,Up]);Dn(`${uh}-${iM}`,Hie,[Ui,Xu]);Dn(`${uh}-${sM}`,cjt,[Ui,Xu]);Dn(`${uh}-${v9}`,Z4e,[Ui,Xu]);Dn(`${W_}-${r$}`,Q4e,[Ui,Xu]);Dn(`${W_}-${Up}`,J4e,[Ui,Xu,Up]);Dn(`${W_}-${iM}`,qie,[Ui,Xu]);Dn(`${W_}-${sM}`,fjt,[Ui,Xu]);Dn(`${W_}-${v9}`,e5e,[Ui,Xu]);Dn(i$,B4e,[oM,i$]);Dn(y9,z4e,oM);Dn(b9,U4e,oM);Dn(Jie,D5e,[aM,oM]);Dn(Qie,kie,aM);Dn(A5e,tse,aM);Dn(tK,tHt,aM);function M5e(e){return $P.has(e)}function ux(e,t){const n=$P.get(e);return n&&n.metadata[t]}function nse(e){return ux(e,Ui)}function s$(e){return ux(e,aM)}function nK(e){return ux(e,oM)}function F5e(e){return ux(e,Up)}function oHt(e){return ux(e,ese)}function O5e(e){return ux(e,Xu)}function R5e(e){return ux(e,i$)}const lHt=["clamp","base","constant","exponent"];function uHt(e,t){const n=t[0],r=ln(t)-n;return function(i){return e(n+i*r)}}function rse(e,t,n){return E5e(L5e(t||"rgb",n),e)}function cHt(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function P5e(e,t,n){const r=n-t;let i,s,a;return!r||!Number.isFinite(r)?go(.5):(i=(s=e.type).indexOf("-"),s=i<0?s:s.slice(i+1),a=Dn(s)().domain([t,n]).range([0,1]),lHt.forEach(o=>e[o]?a[o](e[o]()):0),a)}function L5e(e,t){const n=Zjt[fHt(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function fHt(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const hHt={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},dHt={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function B5e(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function z5e(e,t){for(const n in e)U5e(n,t(e[n]))}const Lve={};z5e(dHt,B5e);z5e(hHt,e=>rse(B5e(e)));function U5e(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(Lve[e]=t,this):Lve[e]}const a4="symbol",pHt="discrete",gHt="gradient",mHt=e=>at(e)?e.map(t=>String(t)):String(e),vHt=(e,t)=>e[1]-t[1],yHt=(e,t)=>t[1]-e[1];function ise(e,t,n){let r;return FT(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(X7(e.domain())/n||1)))),Ft(t)&&(r=t.step,t=t.interval),wr(t)&&(t=e.type===Xy?GN(t):e.type==Ky?YN(t):$e("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function W5e(e,t,n){let r=e.range(),i=r[0],s=ln(r),a=vHt;if(i>s&&(r=s,s=i,i=r,a=yHt),i=Math.floor(i),s=Math.ceil(s),t=t.map(o=>[o,e(o)]).filter(o=>i<=o[1]&&o[1]<=s).sort(a).map(o=>o[0]),n>0&&t.length>1){const o=[t[0],ln(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=o)}return t}function sse(e,t){return e.bins?W5e(e,e.bins):e.ticks?e.ticks(t):e.domain()}function V5e(e,t,n,r,i,s){const a=t.type;let o=mHt;if(a===Xy||i===Xy)o=e.timeFormat(r);else if(a===Ky||i===Ky)o=e.utcFormat(r);else if(F5e(a)){const l=e.formatFloat(r);if(s||t.bins)o=l;else{const u=j5e(t,n,!1);o=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();o=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(o=e.format(r));return o}function j5e(e,t,n){const r=sse(e,t),i=e.base(),s=Math.log(i),a=Math.max(1,i*t/r.length),o=l=>{let u=l/Math.pow(i,Math.round(Math.log(l)/s));return u*i<i-.5&&(u*=i),u<=a};return n?r.filter(o):o}const rK={[i$]:"quantiles",[y9]:"thresholds",[b9]:"domain"},H5e={[i$]:"quantiles",[y9]:"domain"};function q5e(e,t){return e.bins?wHt(e.bins):e.type===Up?j5e(e,t,!0):rK[e.type]?xHt(e[rK[e.type]]()):sse(e,t)}function bHt(e,t,n){const r=t[H5e[t.type]](),i=r.length;let s=i>1?r[1]-r[0]:r[0],a;for(a=1;a<i;++a)s=Math.min(s,r[a]-r[a-1]);return e.formatSpan(0,s,3*10,n)}function xHt(e){const t=[-1/0].concat(e);return t.max=1/0,t}function wHt(e){const t=e.slice(0,-1);return t.max=ln(e),t}const $Ht=e=>rK[e.type]||e.bins;function G5e(e,t,n,r,i,s,a){const o=H5e[t.type]&&s!==Xy&&s!==Ky?bHt(e,t,i):V5e(e,t,n,i,s,a);return r===a4&&$Ht(t)?CHt(o):r===pHt?_Ht(o):SHt(o)}const CHt=e=>(t,n,r)=>{const i=Bve(r[n+1],Bve(r.max,1/0)),s=zve(t,e),a=zve(i,e);return s&&a?s+" \u2013 "+a:a?"< "+a:"\u2265 "+s},Bve=(e,t)=>e!=null?e:t,_Ht=e=>(t,n)=>n?e(t):null,SHt=e=>t=>e(t),zve=(e,t)=>Number.isFinite(e)?t(e):null;function kHt(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+ln(t),s=i-r;if(e.type===b9){const a=n?s/n:.1;r-=a,i+=a,s=i-r}return a=>(a-r)/s}function EHt(e,t,n,r){const i=r||t.type;return wr(n)&&oHt(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===Xy?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===Ky?e.utcFormat("%A, %d %B %Y, %X UTC"):G5e(e,t,5,null,n,r,!0)}function Y5e(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=EHt(e,t,n.format,n.formatType);if(nK(t.type)){const s=q5e(t).slice(1).map(i),a=s.length;return`${a} boundar${a===1?"y":"ies"}: ${s.join(", ")}`}else if(s$(t.type)){const s=t.domain(),a=s.length,o=a>r?s.slice(0,r-2).map(i).join(", ")+", ending with "+s.slice(-1).map(i):s.map(i).join(", ");return`${a} value${a===1?"":"s"}: ${o}`}else{const s=t.domain();return`values from ${i(s[0])} to ${i(ln(s))}`}}let AHt=0;const CP="p_";function ase(e){return e&&e.gradient}function X5e(e,t,n){const r=e.gradient;let i=e.id,s=r==="radial"?CP:"";return i||(i=e.id="gradient_"+AHt++,r==="radial"?(e.x1=kf(e.x1,.5),e.y1=kf(e.y1,.5),e.r1=kf(e.r1,0),e.x2=kf(e.x2,.5),e.y2=kf(e.y2,.5),e.r2=kf(e.r2,.5),s=CP):(e.x1=kf(e.x1,0),e.y1=kf(e.y1,0),e.x2=kf(e.x2,1),e.y2=kf(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+s+i+")"}function kf(e,t){return e!=null?e:t}function THt(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,s){return n.push({offset:i,color:s}),r}}}const Uve={basis:{curve:wUt},"basis-closed":{curve:$Ut},"basis-open":{curve:CUt},bundle:{curve:_Ut,tension:"beta",value:.85},cardinal:{curve:SUt,tension:"tension",value:0},"cardinal-open":{curve:EUt,tension:"tension",value:0},"cardinal-closed":{curve:kUt,tension:"tension",value:0},"catmull-rom":{curve:AUt,tension:"alpha",value:.5},"catmull-rom-closed":{curve:TUt,tension:"alpha",value:.5},"catmull-rom-open":{curve:DUt,tension:"alpha",value:.5},linear:{curve:yie},"linear-closed":{curve:IUt},monotone:{horizontal:MUt,vertical:NUt},natural:{curve:FUt},step:{curve:OUt},"step-after":{curve:PUt},"step-before":{curve:RUt}};function K5e(e,t,n){var r=bt(Uve,e)&&Uve[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const DHt={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},IHt=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,NHt=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,MHt=/^((\s+,?\s*)|(,\s*))/,FHt=/^[01]/;function ose(e){const t=[];return(e.match(IHt)||[]).forEach(r=>{let i=r[0];const s=i.toLowerCase(),a=DHt[s],o=OHt(s,a,r.slice(1).trim()),l=o.length;if(l<a||l&&l%a!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...o.slice(0,a)]),l!==a){s==="m"&&(i=i==="M"?"L":"l");for(let u=a;u<l;u+=a)t.push([i,...o.slice(u,u+a)])}}),t}function OHt(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let s=0;s<t;++s){const a=e==="a"&&(s===3||s===4)?FHt:NHt,o=n.slice(i).match(a);if(o===null)throw Error("Invalid SVG path, incorrect parameter type");i+=o[0].length,r.push(+o[0]);const l=n.slice(i).match(MHt);l!==null&&(i+=l[0].length)}return r}const J0=Math.PI/180,RHt=1e-14,c1=Math.PI/2,Lf=Math.PI*2,o2=Math.sqrt(3)/2;var aH={},oH={},Z5e=[].join;function PHt(e,t,n,r,i,s,a,o,l){const u=Z5e.call(arguments);if(aH[u])return aH[u];const c=a*J0,f=Math.sin(c),h=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const d=h*(o-e)*.5+f*(l-t)*.5,p=h*(l-t)*.5-f*(o-e)*.5;let g=d*d/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=h/n,v=f/n,y=-f/r,b=h/r,x=m*o+v*l,w=y*o+b*l,C=m*e+v*t,$=y*e+b*t;let k=1/((C-x)*(C-x)+($-w)*($-w))-.25;k<0&&(k=0);let E=Math.sqrt(k);s==i&&(E=-E);const S=.5*(x+C)-E*($-w),I=.5*(w+$)+E*(C-x),A=Math.atan2(w-I,x-S);let T=Math.atan2($-I,C-S)-A;T<0&&s===1?T+=Lf:T>0&&s===0&&(T-=Lf);const N=Math.ceil(Math.abs(T/(c1+.001))),F=[];for(let R=0;R<N;++R){const P=A+R*T/N,V=A+(R+1)*T/N;F[R]=[S,I,P,V,n,r,f,h]}return aH[u]=F}function LHt(e){const t=Z5e.call(e);if(oH[t])return oH[t];var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7];const c=u*a,f=-l*o,h=l*a,d=u*o,p=Math.cos(i),g=Math.sin(i),m=Math.cos(s),v=Math.sin(s),y=.5*(s-i),b=Math.sin(y*.5),x=8/3*b*b/Math.sin(y),w=n+p-x*g,C=r+g+x*p,$=n+m,_=r+v,k=$+x*v,E=_-x*m;return oH[t]=[c*w+f*C,h*w+d*C,c*k+f*E,h*k+d*E,c*$+f*_,h*$+d*_]}const iu=["l",0,0,0,0,0,0,0];function BHt(e,t,n){const r=iu[0]=e[0];if(r==="a"||r==="A")iu[1]=t*e[1],iu[2]=n*e[2],iu[3]=e[3],iu[4]=e[4],iu[5]=e[5],iu[6]=t*e[6],iu[7]=n*e[7];else if(r==="h"||r==="H")iu[1]=t*e[1];else if(r==="v"||r==="V")iu[1]=n*e[1];else for(var i=1,s=e.length;i<s;++i)iu[i]=(i%2==1?t:n)*e[i];return iu}function _P(e,t,n,r,i,s){var a,o=null,l=0,u=0,c=0,f=0,h,d,p,g,m=0,v=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),s==null&&(s=i),e.beginPath&&e.beginPath();for(var y=0,b=t.length;y<b;++y){switch(a=t[y],(i!==1||s!==1)&&(a=BHt(a,i,s)),a[0]){case"l":l+=a[1],u+=a[2],e.lineTo(l+n,u+r);break;case"L":l=a[1],u=a[2],e.lineTo(l+n,u+r);break;case"h":l+=a[1],e.lineTo(l+n,u+r);break;case"H":l=a[1],e.lineTo(l+n,u+r);break;case"v":u+=a[1],e.lineTo(l+n,u+r);break;case"V":u=a[1],e.lineTo(l+n,u+r);break;case"m":l+=a[1],u+=a[2],m=l,v=u,e.moveTo(l+n,u+r);break;case"M":l=a[1],u=a[2],m=l,v=u,e.moveTo(l+n,u+r);break;case"c":h=l+a[5],d=u+a[6],c=l+a[3],f=u+a[4],e.bezierCurveTo(l+a[1]+n,u+a[2]+r,c+n,f+r,h+n,d+r),l=h,u=d;break;case"C":l=a[5],u=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,c+n,f+r,l+n,u+r);break;case"s":h=l+a[3],d=u+a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,l+a[1]+n,u+a[2]+r,h+n,d+r),c=l+a[1],f=u+a[2],l=h,u=d;break;case"S":h=a[3],d=a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,a[1]+n,a[2]+r,h+n,d+r),l=h,u=d,c=a[1],f=a[2];break;case"q":h=l+a[3],d=u+a[4],c=l+a[1],f=u+a[2],e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d;break;case"Q":h=a[3],d=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,h+n,d+r),l=h,u=d,c=a[1],f=a[2];break;case"t":h=l+a[1],d=u+a[2],o[0].match(/[QqTt]/)===null?(c=l,f=u):o[0]==="t"?(c=2*l-p,f=2*u-g):o[0]==="q"&&(c=2*l-c,f=2*u-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d,c=l+a[1],f=u+a[2];break;case"T":h=a[1],d=a[2],c=2*l-c,f=2*u-f,e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d;break;case"a":Wve(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+l+n,a[7]+u+r]),l+=a[6],u+=a[7];break;case"A":Wve(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),l=a[6],u=a[7];break;case"z":case"Z":l=m,u=v,e.closePath();break}o=a}}function Wve(e,t,n,r){const i=PHt(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let s=0;s<i.length;++s){const a=LHt(i[s]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const Vve=.5773502691896257,jve={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Lf)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,s=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-s),e.lineTo(i,-s),e.lineTo(0,-n),e.lineTo(-i,-s),e.lineTo(-r,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=o2*n,i=r-n*Vve,s=n/4;e.moveTo(0,-r-i),e.lineTo(-s,r-i),e.lineTo(s,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=o2*n,i=r-n*Vve;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=o2*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=o2*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=o2*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=o2*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function zHt(e){return bt(jve,e)?jve[e]:UHt(e)}var lH={};function UHt(e){if(!bt(lH,e)){const t=ose(e);lH[e]={draw:function(n,r){_P(n,t,0,0,Math.sqrt(r)/2)}}}return lH[e]}const Eg=.448084975506;function WHt(e){return e.x}function VHt(e){return e.y}function jHt(e){return e.width}function HHt(e){return e.height}function Td(e){return typeof e=="function"?e:()=>+e}function IO(e,t,n){return Math.max(t,Math.min(e,n))}function qHt(){var e=WHt,t=VHt,n=jHt,r=HHt,i=Td(0),s=i,a=i,o=i,l=null;function u(c,f,h){var d,p=f!=null?f:+e.call(this,c),g=h!=null?h:+t.call(this,c),m=+n.call(this,c),v=+r.call(this,c),y=Math.min(m,v)/2,b=IO(+i.call(this,c),0,y),x=IO(+s.call(this,c),0,y),w=IO(+a.call(this,c),0,y),C=IO(+o.call(this,c),0,y);if(l||(l=d=Cie()),b<=0&&x<=0&&w<=0&&C<=0)l.rect(p,g,m,v);else{var $=p+m,_=g+v;l.moveTo(p+b,g),l.lineTo($-x,g),l.bezierCurveTo($-Eg*x,g,$,g+Eg*x,$,g+x),l.lineTo($,_-C),l.bezierCurveTo($,_-Eg*C,$-Eg*C,_,$-C,_),l.lineTo(p+w,_),l.bezierCurveTo(p+Eg*w,_,p,_-Eg*w,p,_-w),l.lineTo(p,g+b),l.bezierCurveTo(p,g+Eg*b,p+Eg*b,g,p+b,g),l.closePath()}if(d)return l=null,d+""||null}return u.x=function(c){return arguments.length?(e=Td(c),u):e},u.y=function(c){return arguments.length?(t=Td(c),u):t},u.width=function(c){return arguments.length?(n=Td(c),u):n},u.height=function(c){return arguments.length?(r=Td(c),u):r},u.cornerRadius=function(c,f,h,d){return arguments.length?(i=Td(c),s=f!=null?Td(f):i,o=h!=null?Td(h):i,a=d!=null?Td(d):s,u):i},u.context=function(c){return arguments.length?(l=c==null?null:c,u):l},u}function GHt(){var e,t,n,r,i=null,s,a,o,l;function u(f,h,d){const p=d/2;if(s){var g=o-h,m=f-a;if(g||m){var v=Math.sqrt(g*g+m*m),y=(g/=v)*l,b=(m/=v)*l,x=Math.atan2(m,g);i.moveTo(a-y,o-b),i.lineTo(f-g*p,h-m*p),i.arc(f,h,p,x-Math.PI,x),i.lineTo(a+y,o+b),i.arc(a,o,l,x,x+Math.PI)}else i.arc(f,h,p,0,Lf);i.closePath()}else s=1;a=f,o=h,l=p}function c(f){var h,d=f.length,p,g=!1,m;for(i==null&&(i=m=Cie()),h=0;h<=d;++h)!(h<d&&r(p=f[h],h,f))===g&&(g=!g)&&(s=0),g&&u(+e(p,h,f),+t(p,h,f),+n(p,h,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function lM(e,t){return e!=null?e:t}const uM=e=>e.x||0,cM=e=>e.y||0,YHt=e=>e.width||0,XHt=e=>e.height||0,KHt=e=>(e.x||0)+(e.width||0),ZHt=e=>(e.y||0)+(e.height||0),QHt=e=>e.startAngle||0,JHt=e=>e.endAngle||0,eqt=e=>e.padAngle||0,tqt=e=>e.innerRadius||0,nqt=e=>e.outerRadius||0,rqt=e=>e.cornerRadius||0,iqt=e=>lM(e.cornerRadiusTopLeft,e.cornerRadius)||0,sqt=e=>lM(e.cornerRadiusTopRight,e.cornerRadius)||0,aqt=e=>lM(e.cornerRadiusBottomRight,e.cornerRadius)||0,oqt=e=>lM(e.cornerRadiusBottomLeft,e.cornerRadius)||0,lqt=e=>lM(e.size,64),uqt=e=>e.size||1,x9=e=>e.defined!==!1,cqt=e=>zHt(e.shape||"circle"),fqt=yUt().startAngle(QHt).endAngle(JHt).padAngle(eqt).innerRadius(tqt).outerRadius(nqt).cornerRadius(rqt),hqt=h4e().x(uM).y1(cM).y0(ZHt).defined(x9),dqt=h4e().y(cM).x1(uM).x0(KHt).defined(x9),pqt=f4e().x(uM).y(cM).defined(x9),gqt=qHt().x(uM).y(cM).width(YHt).height(XHt).cornerRadius(iqt,sqt,aqt,oqt),mqt=xUt().type(cqt).size(lqt),vqt=GHt().x(uM).y(cM).defined(x9).size(uqt);function lse(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function yqt(e,t){return fqt.context(e)(t)}function bqt(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?dqt:hqt).curve(K5e(r,n.orient,n.tension)).context(e)(t)}function xqt(e,t){const n=t[0],r=n.interpolate||"linear";return pqt.curve(K5e(r,n.orient,n.tension)).context(e)(t)}function V_(e,t,n,r){return gqt.context(e)(t,n,r)}function wqt(e,t){return(t.mark.shape||t.shape).context(e)(t)}function $qt(e,t){return mqt.context(e)(t)}function Cqt(e,t){return vqt.context(e)(t)}var _qt=1;function use(e,t,n){var r=t.clip,i=e._defs,s=t.clip_id||(t.clip_id="clip"+_qt++),a=i.clipping[s]||(i.clipping[s]={id:s});return Ut(r)?a.path=r(null):lse(n)?a.path=V_(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+s+")"}function Oi(e){this.clear(),e&&this.union(e)}Oi.prototype={clone(){return new Oi(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:s,y2:a}=this,o=Math.cos(e),l=Math.sin(e),u=t-t*o+n*l,c=n-t*l-n*o;return[o*r-l*i+u,l*r+o*i+c,o*r-l*a+u,l*r+o*a+c,o*s-l*i+u,l*s+o*i+c,o*s-l*a+u,l*s+o*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function cse(e){this.mark=e,this.bounds=this.bounds||new Oi}function fse(e){cse.call(this,e),this.items=this.items||[]}Ie(fse,cse);function Q5e(e){this._pending=0,this._loader=e||Bre()}function Hve(e){e._pending+=1}function fk(e){e._pending-=1}Q5e.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return Hve(t),t._loader.sanitize(e,{context:"href"}).then(n=>(fk(t),n)).catch(()=>(fk(t),null))},loadImage(e){const t=this,n=_ie();return Hve(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const s=new n,a=bt(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(s.crossOrigin=a),s.onload=()=>fk(t),s.onerror=()=>fk(t),s.src=i,s}).catch(r=>(fk(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function Zm(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Sqt(t,r):0))}return e}function Sqt(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const kqt=Lf-1e-8;let w9,o4,l4,F1,iK,u4,sK,aK;const Xg=(e,t)=>w9.add(e,t),c4=(e,t)=>Xg(o4=e,l4=t),qve=e=>Xg(e,w9.y1),Gve=e=>Xg(w9.x1,e),f1=(e,t)=>iK*e+sK*t,h1=(e,t)=>u4*e+aK*t,uH=(e,t)=>Xg(f1(e,t),h1(e,t)),cH=(e,t)=>c4(f1(e,t),h1(e,t));function $9(e,t){return w9=e,t?(F1=t*J0,iK=aK=Math.cos(F1),u4=Math.sin(F1),sK=-u4):(iK=aK=1,F1=u4=sK=0),Eqt}const Eqt={beginPath(){},closePath(){},moveTo:cH,lineTo:cH,rect(e,t,n,r){F1?(uH(e+n,t),uH(e+n,t+r),uH(e,t+r),cH(e,t)):(Xg(e+n,t+r),c4(e,t))},quadraticCurveTo(e,t,n,r){const i=f1(e,t),s=h1(e,t),a=f1(n,r),o=h1(n,r);Yve(o4,i,a,qve),Yve(l4,s,o,Gve),c4(a,o)},bezierCurveTo(e,t,n,r,i,s){const a=f1(e,t),o=h1(e,t),l=f1(n,r),u=h1(n,r),c=f1(i,s),f=h1(i,s);Xve(o4,a,l,c,qve),Xve(l4,o,u,f,Gve),c4(c,f)},arc(e,t,n,r,i,s){if(r+=F1,i+=F1,o4=n*Math.cos(i)+e,l4=n*Math.sin(i)+t,Math.abs(i-r)>kqt)Xg(e-n,t-n),Xg(e+n,t+n);else{const a=u=>Xg(n*Math.cos(u)+e,n*Math.sin(u)+t);let o,l;if(a(r),a(i),i!==r)if(r=r%Lf,r<0&&(r+=Lf),i=i%Lf,i<0&&(i+=Lf),i<r&&(s=!s,o=r,r=i,i=o),s)for(i-=Lf,o=r-r%c1,l=0;l<4&&o>i;++l,o-=c1)a(o);else for(o=r-r%c1+c1,l=0;l<4&&o<i;++l,o=o+c1)a(o)}}};function Yve(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function Xve(e,t,n,r,i){const s=r-e+3*t-3*n,a=e+n-2*t,o=e-t;let l=0,u=0,c;Math.abs(s)>RHt?(c=a*a+o*s,c>=0&&(c=Math.sqrt(c),l=(-a+c)/s,u=(-a-c)/s)):l=.5*o/a,0<l&&l<1&&i(Kve(l,e,t,n,r)),0<u&&u<1&&i(Kve(u,e,t,n,r))}function Kve(e,t,n,r,i){const s=1-e,a=s*s,o=e*e;return a*s*t+3*a*e*n+3*s*o*r+o*e*i}var v0=(v0=Yu(1,1))?v0.getContext("2d"):null;const oK=new Oi;function J5e(e){return function(t,n){if(!v0)return!0;e(v0,t),oK.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:s,y2:a}=oK;for(let o=i;o<=a;++o)for(let l=r;l<=s;++l)if(v0.isPointInPath(l,o))return!0;return!1}}function ePe(e,t){return t.contains(e.x||0,e.y||0)}function tPe(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,s=e.height||0;return t.intersects(oK.set(n,r,n+i,r+s))}function Aqt(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:r;return gE(t,n,r,i,s)}function gE(e,t,n,r,i){const{x1:s,y1:a,x2:o,y2:l}=e,u=r-t,c=i-n;let f=0,h=1,d,p,g,m;for(m=0;m<4;++m){if(m===0&&(d=-u,p=-(s-t)),m===1&&(d=u,p=o-t),m===2&&(d=-c,p=-(a-n)),m===3&&(d=c,p=l-n),Math.abs(d)<1e-10&&p<0)return!1;if(g=p/d,d<0){if(g>h)return!1;g>f&&(f=g)}else if(d>0){if(g<f)return!1;g<h&&(h=g)}}return!0}function a$(e,t){e.globalCompositeOperation=t.blend||"source-over"}function ic(e,t){return e==null?t:e}function Zve(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function Tqt(e,t,n){const r=n.width(),i=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+ic(t.x1,.5)*r,n.y1+ic(t.y1,.5)*i,Math.max(r,i)*ic(t.r1,0),n.x1+ic(t.x2,.5)*r,n.y1+ic(t.y2,.5)*i,Math.max(r,i)*ic(t.r2,.5));else{const a=ic(t.x1,0),o=ic(t.y1,0),l=ic(t.x2,1),u=ic(t.y2,0);if(a===l||o===u||r===i)s=e.createLinearGradient(n.x1+a*r,n.y1+o*i,n.x1+l*r,n.y1+u*i);else{const c=Yu(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=Zve(f.createLinearGradient(a,o,l,u),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return Zve(s,t.stops)}function nPe(e,t,n){return ase(n)?Tqt(e,n,t.bounds):n}function SP(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=nPe(e,t,t.fill),!0):!1}var Dqt=[];function o$(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=nPe(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Dqt),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function Iqt(e,t){return e.zindex-t.zindex||e.index-t.index}function rPe(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,s;for(i=0,s=t.length;i<s;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(Iqt)}function Ph(e,t){var n=e.items,r,i;if(!n||!n.length)return;const s=rPe(e);if(s&&s.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=s}for(r=0,i=n.length;r<i;++r)t(n[r])}function lK(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const s=rPe(e);for(s&&s.length&&(n=s),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===s){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function hse(e){return function(t,n,r){Ph(n,i=>{(!r||r.intersects(i.bounds))&&iPe(e,t,i,i)})}}function Nqt(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&iPe(e,t,n.items[0],n.items)}}function iPe(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(a$(t,n),n.fill&&SP(t,n,i)&&t.fill(),n.stroke&&o$(t,n,i)&&t.stroke()))}function C9(e){return e=e||Jc,function(t,n,r,i,s,a){return r*=t.pixelRatio,i*=t.pixelRatio,lK(n,o=>{const l=o.bounds;if(!(l&&!l.contains(s,a)||!l)&&e(t,o,r,i,s,a))return o})}}function fM(e,t){return function(n,r,i,s){var a=Array.isArray(r)?r[0]:r,o=t==null?a.fill:t,l=a.stroke&&n.isPointInStroke,u,c;return l&&(u=a.strokeWidth,c=a.strokeCap,n.lineWidth=u!=null?u:1,n.lineCap=c!=null?c:"butt"),e(n,r)?!1:o&&n.isPointInPath(i,s)||l&&n.isPointInStroke(i,s)}}function dse(e){return C9(fM(e))}function ay(e,t){return"translate("+e+","+t+")"}function pse(e){return"rotate("+e+")"}function Mqt(e,t){return"scale("+e+","+t+")"}function sPe(e){return ay(e.x||0,e.y||0)}function Fqt(e){return ay(e.x||0,e.y||0)+(e.angle?" "+pse(e.angle):"")}function Oqt(e){return ay(e.x||0,e.y||0)+(e.angle?" "+pse(e.angle):"")+(e.scaleX||e.scaleY?" "+Mqt(e.scaleX||1,e.scaleY||1):"")}function gse(e,t,n){function r(a,o){a("transform",Fqt(o)),a("d",t(null,o))}function i(a,o){return t($9(a,o.angle),o),Zm(a,o).translate(o.x||0,o.y||0)}function s(a,o){var l=o.x||0,u=o.y||0,c=o.angle||0;a.translate(l,u),c&&a.rotate(c*=J0),a.beginPath(),t(a,o),c&&a.rotate(-c),a.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:hse(s),pick:dse(s),isect:n||J5e(s)}}var Rqt=gse("arc",yqt);function Pqt(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,s=1/0,a,o;--i>=0;)e[i].defined!==!1&&(o=Math.abs(e[i][r]-n),o<s&&(s=o,a=e[i]));return a}function Lqt(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,s,a;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],s=e[r].y-t[1],a=i*i+s*s,a<n))return e[r];return null}function Bqt(e,t){for(var n=e.length,r,i,s;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],s=r*r+i*i,r=e[n].size||1,s<r*r))return e[n];return null}function mse(e,t,n){function r(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))}function i(l,u){var c=u.items;return c.length===0?l:(t($9(l),c),Zm(l,c[0]))}function s(l,u){l.beginPath(),t(l,u)}const a=fM(s);function o(l,u,c,f,h,d){var p=u.items,g=u.bounds;return!p||!p.length||g&&!g.contains(h,d)?null:(c*=l.pixelRatio,f*=l.pixelRatio,a(l,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:Nqt(s),pick:o,isect:ePe,tip:n}}var zqt=mse("area",bqt,Pqt);function Uqt(e,t){var n=t.clip;e.save(),Ut(n)?(e.beginPath(),n(e),e.clip()):aPe(e,t.group)}function aPe(e,t){e.beginPath(),lse(t)?V_(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function oPe(e){const t=ic(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Wqt(e,t){e("transform",sPe(t))}function lPe(e,t){const n=oPe(t);e("d",V_(null,t,n,n))}function Vqt(e,t){e("class","background"),e("aria-hidden",!0),lPe(e,t)}function jqt(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?lPe(e,t):e("d","")}function Hqt(e,t,n){const r=t.clip?use(n,t,t):null;e("clip-path",r)}function qqt(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Zm(e,t),e.translate(t.x||0,t.y||0)}function KT(e,t,n,r){const i=oPe(t);e.beginPath(),V_(e,t,(n||0)+i,(r||0)+i)}const Gqt=fM(KT),Yqt=fM(KT,!1),Xqt=fM(KT,!0);function Kqt(e,t,n){Ph(t,r=>{const i=r.x||0,s=r.y||0,a=r.strokeForeground,o=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&o&&(KT(e,r,i,s),a$(e,r),r.fill&&SP(e,r,o)&&e.fill(),r.stroke&&!a&&o$(e,r,o)&&e.stroke()),e.save(),e.translate(i,s),r.clip&&aPe(e,r),n&&n.translate(-i,-s),Ph(r,l=>{this.draw(e,l,n)}),n&&n.translate(i,s),e.restore(),a&&r.stroke&&o&&(KT(e,r,i,s),a$(e,r),o$(e,r,o)&&e.stroke())})}function Zqt(e,t,n,r,i,s){if(t.bounds&&!t.bounds.contains(i,s)||!t.items)return null;const a=n*e.pixelRatio,o=r*e.pixelRatio;return lK(t,l=>{let u,c,f;const h=l.bounds;if(h&&!h.contains(i,s))return;c=l.x||0,f=l.y||0;const d=c+(l.width||0),p=f+(l.height||0),g=l.clip;if(g&&(i<c||i>d||s<f||s>p))return;if(e.save(),e.translate(c,f),c=i-c,f=s-f,g&&lse(l)&&!Xqt(e,l,a,o))return e.restore(),null;const m=l.strokeForeground,v=t.interactive!==!1;return v&&m&&l.stroke&&Yqt(e,l,a,o)?(e.restore(),l):(u=lK(l,y=>Qqt(y,c,f)?this.pick(y,n,r,c,f):null),!u&&v&&(l.fill||!m&&l.stroke)&&Gqt(e,l,a,o)&&(u=l),e.restore(),u||null)})}function Qqt(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Jqt={type:"group",tag:"g",nested:!1,attr:Wqt,bound:qqt,draw:Kqt,pick:Zqt,isect:tPe,content:Hqt,background:Vqt,foreground:jqt},ZT={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function vse(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function yse(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function bse(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function _9(e,t){return e==="center"?t/2:e==="right"?t:0}function S9(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function eGt(e,t,n){const r=vse(t,n),i=yse(t,r),s=bse(t,r),a=(t.x||0)-_9(t.align,i),o=(t.y||0)-S9(t.baseline,s),l=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",l,ZT["xmlns:xlink"],"xlink:href"),e("transform",ay(a,o)),e("width",i),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function tGt(e,t){const n=t.image,r=yse(t,n),i=bse(t,n),s=(t.x||0)-_9(t.align,r),a=(t.y||0)-S9(t.baseline,i);return e.set(s,a,s+r,a+i)}function nGt(e,t,n){Ph(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=vse(r,this);let s=yse(r,i),a=bse(r,i);if(s===0||a===0)return;let o=(r.x||0)-_9(r.align,s),l=(r.y||0)-S9(r.baseline,a),u,c,f,h;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(h=s/c,l+=(a-h)/2,a=h):(h=a*c,o+=(s-h)/2,s=h))),(i.complete||i.toDataURL)&&(a$(e,r),e.globalAlpha=(u=r.opacity)!=null?u:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,o,l,s,a))})}var rGt={type:"image",tag:"image",nested:!1,attr:eGt,bound:tGt,draw:nGt,pick:C9(),isect:Jc,get:vse,xOffset:_9,yOffset:S9},iGt=mse("line",xqt,Lqt);function sGt(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",Oqt(t)),e("d",t.path)}function f4(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,s=t.scaleX||1,a=t.scaleY||1,o=(t.angle||0)*J0,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=ose(n)).path=n),o&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(o),_P(e,l,0,0,s,a),e.rotate(-o),e.translate(-r,-i)):_P(e,l,r,i,s,a)}function aGt(e,t){return f4($9(e,t.angle),t)?e.set(0,0,0,0):Zm(e,t,!0)}var oGt={type:"path",tag:"path",nested:!1,attr:sGt,bound:aGt,draw:hse(f4),pick:dse(f4),isect:J5e(f4)};function lGt(e,t){e("d",V_(null,t))}function uGt(e,t){var n,r;return Zm(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function Qve(e,t){e.beginPath(),V_(e,t)}var cGt={type:"rect",tag:"path",nested:!1,attr:lGt,bound:uGt,draw:hse(Qve),pick:dse(Qve),isect:tPe};function fGt(e,t){e("transform",sPe(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function hGt(e,t){var n,r;return Zm(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function uPe(e,t,n){var r,i,s,a;return t.stroke&&o$(e,t,n)?(r=t.x||0,i=t.y||0,s=t.x2!=null?t.x2:r,a=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(s,a),!0):!1}function dGt(e,t,n){Ph(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&uPe(e,r,i)&&(a$(e,r),e.stroke())}})}function pGt(e,t,n,r){return e.isPointInStroke?uPe(e,t,1)&&e.isPointInStroke(n,r):!1}var gGt={type:"rule",tag:"line",nested:!1,attr:fGt,bound:hGt,draw:dGt,pick:C9(pGt),isect:Aqt},mGt=gse("shape",wqt),vGt=gse("symbol",$qt,ePe);const Jve=Z6t();var bp={height:lg,measureWidth:xse,estimateWidth:uK,width:uK,canvas:cPe};cPe(!0);function cPe(e){bp.width=e&&v0?xse:uK}function uK(e,t){return fPe(em(e,t),lg(e))}function fPe(e,t){return~~(.8*e.length*t)}function xse(e,t){return lg(e)<=0||!(t=em(e,t))?0:hPe(t,wse(e))}function hPe(e,t){const n=`(${t}) ${e}`;let r=Jve.get(n);return r===void 0&&(v0.font=t,r=v0.measureText(e).width,Jve.set(n,r)),r}function lg(e){return e.fontSize!=null?+e.fontSize||0:11}function Zy(e){return e.lineHeight!=null?e.lineHeight:lg(e)+2}function yGt(e){return at(e)?e.length>1?e:e[0]:e}function hM(e){return yGt(e.lineBreak&&e.text&&!at(e.text)?e.text.split(e.lineBreak):e.text)}function dPe(e){const t=hM(e);return(at(t)?t.length-1:0)*Zy(e)}function em(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?xGt(e,n):n}function bGt(e){if(bp.width===xse){const t=wse(e);return n=>hPe(n,t)}else{const t=lg(e);return n=>fPe(n,t)}}function xGt(e,t){var n=+e.limit,r=bGt(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",s=e.dir==="rtl",a=0,o=t.length,l;if(n-=r(i),s){for(;a<o;)l=a+o>>>1,r(t.slice(l))>n?a=l+1:o=l;return i+t.slice(a)}else{for(;a<o;)l=1+(a+o>>>1),r(t.slice(0,l))<n?a=l:o=l-1;return t.slice(0,a)+i}}function k9(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function wse(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+lg(e)+"px "+k9(e,t)}function $se(e){var t=e.baseline,n=lg(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Zy(e):t==="line-bottom"?.29*n-.5*Zy(e):0)}const wGt={left:"start",center:"middle",right:"end"},uA=new Oi;function E9(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-c1,t+=r*Math.cos(i),n+=r*Math.sin(i)),uA.x1=t,uA.y1=n,uA}function $Gt(e,t){var n=t.dx||0,r=(t.dy||0)+$se(t),i=E9(t),s=i.x1,a=i.y1,o=t.angle||0,l;e("text-anchor",wGt[t.align]||"start"),o?(l=ay(s,a)+" "+pse(o),(n||r)&&(l+=" "+ay(n,r))):l=ay(s+n,a+r),e("transform",l)}function Cse(e,t,n){var r=bp.height(t),i=t.align,s=E9(t),a=s.x1,o=s.y1,l=t.dx||0,u=(t.dy||0)+$se(t)-Math.round(.8*r),c=hM(t),f;if(at(c)?(r+=Zy(t)*(c.length-1),f=c.reduce((h,d)=>Math.max(h,bp.width(t,d)),0)):f=bp.width(t,c),i==="center"?l-=f/2:i==="right"&&(l-=f),e.set(l+=a,u+=o,l+f,u+r),t.angle&&!n)e.rotate(t.angle*J0,a,o);else if(n===2)return e.rotatedPoints(t.angle*J0,a,o);return e}function CGt(e,t,n){Ph(t,r=>{var i=r.opacity==null?1:r.opacity,s,a,o,l,u,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=wse(r),e.textAlign=r.align||"left",s=E9(r),a=s.x1,o=s.y1,r.angle&&(e.save(),e.translate(a,o),e.rotate(r.angle*J0),a=o=0),a+=r.dx||0,o+=(r.dy||0)+$se(r),c=hM(r),a$(e,r),at(c))for(u=Zy(r),l=0;l<c.length;++l)f=em(r,c[l]),r.fill&&SP(e,r,i)&&e.fillText(f,a,o),r.stroke&&o$(e,r,i)&&e.strokeText(f,a,o),o+=u;else f=em(r,c),r.fill&&SP(e,r,i)&&e.fillText(f,a,o),r.stroke&&o$(e,r,i)&&e.strokeText(f,a,o);r.angle&&e.restore()}})}function _Gt(e,t,n,r,i,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=E9(t),o=a.x1,l=a.y1,u=Cse(uA,t,1),c=-t.angle*J0,f=Math.cos(c),h=Math.sin(c),d=f*i-h*s+(o-f*o+h*l),p=h*i+f*s+(l-h*o-f*l);return u.contains(d,p)}function SGt(e,t){const n=Cse(uA,e,2);return gE(t,n[0],n[1],n[2],n[3])||gE(t,n[0],n[1],n[4],n[5])||gE(t,n[4],n[5],n[6],n[7])||gE(t,n[2],n[3],n[6],n[7])}var kGt={type:"text",tag:"text",nested:!1,attr:$Gt,bound:Cse,draw:CGt,pick:C9(_Gt),isect:SGt},EGt=mse("trail",Cqt,Bqt),Pu={arc:Rqt,area:zqt,group:Jqt,image:rGt,line:iGt,path:oGt,rect:cGt,rule:gGt,shape:mGt,symbol:vGt,text:kGt,trail:EGt};function e1e(e,t,n){var r=Pu[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Oi),e,n)}var t1e={mark:null};function AGt(e,t,n){var r=Pu[e.marktype],i=r.bound,s=e.items,a=s&&s.length,o,l,u,c;if(r.nested)return a?u=s[0]:(t1e.mark=e,u=t1e),c=e1e(u,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Oi,a)for(o=0,l=s.length;o<l;++o)t.union(e1e(s[o],i,n));return e.bounds=t}const TGt=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function DGt(e,t){return JSON.stringify(e,TGt,t)}function IGt(e){const t=typeof e=="string"?JSON.parse(e):e;return pPe(t)}function pPe(e){var t=e.marktype,n=e.items,r,i,s;if(n)for(i=0,s=n.length;i<s;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&pPe(n[i]);return t&&AGt(e),e}function gPe(e){arguments.length?this.root=IGt(e):(this.root=mPe({marktype:"group",name:"root",role:"frame"}),this.root.items=[new fse(this.root)])}gPe.prototype={toJSON(e){return DGt(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=mPe(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function mPe(e,t){const n={bounds:new Oi,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function O1(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function vPe(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Al(e,t,n,r){var i=e.childNodes[t],s;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(s=i||null,i=O1(e.ownerDocument,n,r),e.insertBefore(i,s)),i}function Bf(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function yPe(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function _se(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function NGt(e,t,n,r){var i=e&&e.mark,s,a;if(i&&(s=Pu[i.marktype]).tip){for(a=_se(t,n),a[0]-=r[0],a[1]-=r[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=s.tip(i.items,a)}return e}function Qy(e,t){this._active=null,this._handlers={},this._loader=e||Bre(),this._tooltip=t||MGt}function MGt(e,t,n,r){e.element().setAttribute("title",r||"")}Qy.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),s=O1(null,"a");for(const a in r)s.setAttribute(a,r[a]);s.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=NGt(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,s=i.width(),a=i.height();let o=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)o+=e.x||0,l+=e.y||0;return{x:o,y:l,width:s,height:a,left:o,top:l,right:o+s,bottom:l+a}}};function ug(e){this._el=null,this._bgcolor=null,this._loader=new Q5e(e)}ug.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(s=>{s&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const FGt="keydown",OGt="keypress",RGt="keyup",bPe="dragenter",h4="dragleave",xPe="dragover",cK="mousedown",PGt="mouseup",kP="mousemove",cA="mouseout",wPe="mouseover",EP="click",LGt="dblclick",BGt="wheel",$Pe="mousewheel",AP="touchstart",TP="touchmove",DP="touchend",zGt=[FGt,OGt,RGt,bPe,h4,xPe,cK,PGt,kP,cA,wPe,EP,LGt,BGt,$Pe,AP,TP,DP],fK=kP,QT=cA,hK=EP;function A9(e,t){Qy.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const UGt=e=>e===AP||e===TP||e===DP?[AP,TP,DP]:[e];function n1e(e,t){UGt(t).forEach(n=>WGt(e,n))}function WGt(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function r1e(e,t,n){return function(r){const i=this._active,s=this.pickEvent(r);s===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=s,this.fire(t,r),this.fire(e,r))}}function i1e(e){return function(t){this.fire(e,t),this._active=null}}Ie(A9,Qy,{initialize(e,t,n){return this._canvas=e&&vPe(e,"canvas"),[EP,cK,kP,cA,h4].forEach(r=>n1e(this,r)),Qy.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:zGt,DOMMouseScroll(e){this.fire($Pe,e)},mousemove:r1e(kP,wPe,cA),dragover:r1e(xPe,bPe,h4),mouseout:i1e(cA),dragleave:i1e(h4),mousedown(e){this._down=this._active,this.fire(cK,e)},click(e){this._down===this._active&&(this.fire(EP,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(AP,e,!0)},touchmove(e){this.fire(TP,e,!0)},touchend(e){this.fire(DP,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===hK&&r&&r.href?this.handleHref(t,r,r.href):(e===fK||e===QT)&&this.handleTooltip(t,r,e!==QT),i)for(let s=0,a=i.length;s<a;++s)i[s].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(n1e(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=_se(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const s=this.context();return Pu[e.marktype].pick.call(this,s,e,t,n,r,i)}});function VGt(){return typeof window<"u"&&window.devicePixelRatio||1}var jGt=VGt();function HGt(e,t,n,r,i,s){const a=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,o=e.getContext("2d"),l=a?jGt:i;e.width=t*l,e.height=n*l;for(const u in s)o[u]=s[u];return a&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),o.pixelRatio=l,o.setTransform(l,0,0,l,l*r[0],l*r[1]),e}function dK(e){ug.call(this,e),this._options={},this._redraw=!1,this._dirty=new Oi,this._tempb=new Oi}const s1e=ug.prototype,qGt=(e,t,n)=>new Oi().set(0,0,t,n).translate(-e[0],-e[1]);function GGt(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}Ie(dK,ug,{initialize(e,t,n,r,i,s){return this._options=s||{},this._canvas=this._options.externalContext?null:Yu(1,1,this._options.type),e&&this._canvas&&(Bf(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),s1e.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(s1e.resize.call(this,e,t,n,r),this._canvas)HGt(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||$e("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,s=this._dirty,a=qGt(n,r,i);t.save();const o=this._redraw||s.empty()?(this._redraw=!1,a.expand(1)):GGt(t,a.intersect(s),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,o),t.restore(),s.clear(),this},draw(e,t,n){const r=Pu[t.marktype];t.clip&&Uqt(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,s=this.context();i.type!=="pdf"&&!i.externalContext&&s.clearRect(e,t,n,r),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,r))}});function CPe(e,t){Qy.call(this,e,t);const n=this;n._hrefHandler=pK(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=pK(n,(r,i)=>{n.handleTooltip(r,i,r.type!==QT)})}const pK=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};Ie(CPe,Qy,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(hK,this._hrefHandler),r.removeEventListener(fK,this._tooltipHandler),r.removeEventListener(QT,this._tooltipHandler)),this._svg=r=e&&vPe(e,"svg"),r&&(r.addEventListener(hK,this._hrefHandler),r.addEventListener(fK,this._tooltipHandler),r.addEventListener(QT,this._tooltipHandler)),Qy.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const s={type:e,handler:t,listener:pK(this,t)};(r[n]||(r[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const _Pe="aria-hidden",Sse="aria-label",kse="role",Ese="aria-roledescription",SPe="graphics-object",Ase="graphics-symbol",kPe=(e,t,n)=>({[kse]:e,[Ese]:t,[Sse]:n||void 0}),YGt=Oh(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),a1e={axis:{desc:"axis",caption:ZGt},legend:{desc:"legend",caption:QGt},"title-text":{desc:"title",caption:e=>`Title text '${l1e(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${l1e(e)}'`}},o1e={ariaRole:kse,ariaRoleDescription:Ese,description:Sse};function EPe(e,t){const n=t.aria===!1;if(e(_Pe,n||void 0),n||t.description==null)for(const r in o1e)e(o1e[r],void 0);else{const r=t.mark.marktype;e(Sse,t.description),e(kse,t.ariaRole||(r==="group"?SPe:Ase)),e(Ese,t.ariaRoleDescription||`${r} mark`)}}function APe(e){return e.aria===!1?{[_Pe]:!0}:YGt[e.role]?null:a1e[e.role]?KGt(e,a1e[e.role]):XGt(e)}function XGt(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return kPe(n?SPe:Ase,`${t} mark container`,e.description)}function KGt(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return kPe(t.role||Ase,t.desc,n.description||r(n))}catch{return null}}function l1e(e){return ct(e.text).join(" ")}function ZGt(e){const t=e.datum,n=e.orient,r=t.title?TPe(e):null,i=e.context,s=i.scales[t.scale].value,a=i.dataflow.locale(),o=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${s$(o)?"discrete":o} scale with ${Y5e(a,s,e)}`}function QGt(e){const t=e.datum,n=t.title?TPe(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,s=Object.keys(i),a=e.context,o=a.scales[i[s[0]]].value,l=a.dataflow.locale();return eYt(r)+(n?` titled '${n}'`:"")+` for ${JGt(s)} with ${Y5e(l,o,e)}`}function TPe(e){try{return ct(ln(e.items).items[0].text).join(" ")}catch{return null}}function JGt(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+ln(e)}function eYt(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const DPe=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),tYt=e=>DPe(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function IPe(){let e="",t="",n="";const r=[],i=()=>t=n="",s=l=>{t&&(e+=`${t}>${n}`,i()),r.push(l)},a=(l,u)=>(u!=null&&(t+=` ${l}="${tYt(u)}"`),o),o={open(l){s(l),t="<"+l;for(var u=arguments.length,c=new Array(u>1?u-1:0),f=1;f<u;f++)c[f-1]=arguments[f];for(const h of c)for(const d in h)a(d,h[d]);return o},close(){const l=r.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,i(),o},attr:a,text:l=>(n+=DPe(l),o),toString:()=>e};return o}const nYt=e=>NPe(IPe(),e)+"";function NPe(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const r of n)r.nodeType===3?e.text(r.nodeValue):NPe(e,r)}return e.close()}const IP={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},NP={blend:"mix-blend-mode"},MPe={fill:"none","stroke-miterlimit":10},hk=0,u1e="http://www.w3.org/2000/xmlns/",_i=ZT.xmlns;function FPe(e){ug.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const fH=ug.prototype;Ie(FPe,ug,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=Al(e,0,"svg",_i),this._svg.setAttributeNS(u1e,"xmlns",_i),this._svg.setAttributeNS(u1e,"xmlns:xlink",ZT["xmlns:xlink"]),this._svg.setAttribute("version",ZT.version),this._svg.setAttribute("class","marks"),Bf(e,1),this._root=Al(this._svg,hk,"g",_i),Kg(this._root,MPe),Bf(this._svg,hk+1)),this.background(this._bgcolor),fH.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),fH.background.apply(this,arguments)},resize(e,t,n,r){return fH.resize.call(this,e,t,n,r),this._svg&&(Kg(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Al(e,hk,"rect",_i),Kg(n,{width:this._width,height:this._height,fill:t}));const r=nYt(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Bf(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,s,a,o,l;for(a=0,o=e.length;a<o;++a)if(n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,s=Pu[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,c1e(n,t),r.items.forEach(u=>{u.dirty=t})),!r.zdirty){if(n.exit){s.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(s,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null;continue}n=s.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,c1e(n,t)):this._update(s,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Pu[t.marktype],s=t.interactive===!1?"none":null,a=i.tag==="g",o=f1e(t,e,n,"g",r);o.setAttribute("class",yPe(t));const l=APe(t);for(const h in l)za(o,h,l[h]);a||za(o,"pointer-events",s),za(o,"clip-path",t.clip?use(this,t,t.group):null);let u=null,c=0;const f=h=>{const d=this.isDirty(h),p=f1e(h,o,u,i.tag,r);d&&(this._update(i,p,h),a&&sYt(this,p,h)),u=p,++c};return i.nested?t.items.length&&f(t.items[0]):Ph(t,f),Bf(o,c),o},_update(e,t,n){ep=t,sa=t.__values__,EPe(fA,n),e.attr(fA,n,this);const r=oYt[e.type];r&&r.call(this,e,t,n),ep&&this.style(ep,n)},style(e,t){if(t!=null){for(const n in IP){let r=n==="font"?k9(t):t[n];if(r===sa[n])continue;const i=IP[n];r==null?e.removeAttribute(i):(ase(r)&&(r=X5e(r,this._defs.gradient,OPe())),e.setAttribute(i,r+"")),sa[n]=r}for(const n in NP)d4(e,NP[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=Al(e,hk+1,"defs",_i)),r=rYt(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=Al(e,hk+1,"defs",_i)),r=iYt(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):Bf(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function c1e(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function rYt(e,t,n){let r,i,s;if(t.gradient==="radial"){let a=Al(e,n++,"pattern",_i);Kg(a,{id:CP+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=Al(a,0,"rect",_i),Kg(a,{width:1,height:1,fill:`url(${OPe()}#${t.id})`}),e=Al(e,n++,"radialGradient",_i),Kg(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Al(e,n++,"linearGradient",_i),Kg(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)s=Al(e,r,"stop",_i),s.setAttribute("offset",t.stops[r].offset),s.setAttribute("stop-color",t.stops[r].color);return Bf(e,r),n}function iYt(e,t,n){let r;return e=Al(e,n,"clipPath",_i),e.setAttribute("id",t.id),t.path?(r=Al(e,0,"path",_i),r.setAttribute("d",t.path)):(r=Al(e,0,"rect",_i),Kg(r,{x:0,y:0,width:t.width,height:t.height})),Bf(e,1),n+1}function sYt(e,t,n){t=t.lastChild.previousSibling;let r,i=0;Ph(n,s=>{r=e.mark(t,s,r),++i}),Bf(t,1+i)}function f1e(e,t,n,r,i){let s=e._svg,a;if(!s&&(a=t.ownerDocument,s=O1(a,r,_i),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},r==="g"))){const o=O1(a,"path",_i);s.appendChild(o),o.__data__=e;const l=O1(a,"g",_i);s.appendChild(l),l.__data__=e;const u=O1(a,"path",_i);s.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(s.ownerSVGElement!==i||aYt(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function aYt(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let ep=null,sa=null;const oYt={group(e,t,n){const r=ep=t.childNodes[2];sa=r.__values__,e.foreground(fA,n,this),sa=t.__values__,ep=t.childNodes[1],e.content(fA,n,this);const i=ep=t.childNodes[0];e.background(fA,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==sa.events&&(za(r,"pointer-events",s),za(i,"pointer-events",s),sa.events=s),n.strokeForeground&&n.stroke){const a=n.fill;za(r,"display",null),this.style(i,n),za(i,"stroke",null),a&&(n.fill=null),sa=r.__values__,this.style(r,n),a&&(n.fill=a),ep=null}else za(r,"display","none")},image(e,t,n){n.smooth===!1?(d4(t,"image-rendering","optimizeSpeed"),d4(t,"image-rendering","pixelated")):d4(t,"image-rendering",null)},text(e,t,n){const r=hM(n);let i,s,a,o;at(r)?(s=r.map(l=>em(n,l)),i=s.join(`
`),i!==sa.text&&(Bf(t,0),a=t.ownerDocument,o=Zy(n),s.forEach((l,u)=>{const c=O1(a,"tspan",_i);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",o)),t.appendChild(c)}),sa.text=i)):(s=em(n,r),s!==sa.text&&(t.textContent=s,sa.text=s)),za(t,"font-family",k9(n)),za(t,"font-size",lg(n)+"px"),za(t,"font-style",n.fontStyle),za(t,"font-variant",n.fontVariant),za(t,"font-weight",n.fontWeight)}};function fA(e,t,n){t!==sa[e]&&(n?lYt(ep,e,t,n):za(ep,e,t),sa[e]=t)}function d4(e,t,n){n!==sa[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),sa[t]=n)}function Kg(e,t){for(const n in t)za(e,n,t[n])}function za(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function lYt(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function OPe(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function RPe(e){ug.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}Ie(RPe,ug,{svg(){return this._text},_render(e){const t=IPe();t.open("svg",zt({},ZT,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",MPe,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Pu[t.marktype],r=n.tag,i=[EPe,n.attr];e.open("g",{class:yPe(t),"clip-path":t.clip?use(this,t,t.group):null},APe(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const s=a=>{const o=this.href(a);if(o&&e.open("a",o),e.open(r,this.attr(t,a,i,r!=="g"?r:null)),r==="text"){const l=hM(a);if(at(l)){const u={x:0,dy:Zy(a)};for(let c=0;c<l.length;++c)e.open("tspan",c?u:null).text(em(a,l[c])).close()}else e.text(em(a,l))}else if(r==="g"){const l=a.strokeForeground,u=a.fill,c=a.stroke;l&&c&&(a.stroke=null),e.open("path",this.attr(t,a,n.background,"bgrect")).close(),e.open("g",this.attr(t,a,n.content)),Ph(a,f=>this.mark(e,f)),e.close(),l&&c?(u&&(a.fill=null),a.stroke=c,e.open("path",this.attr(t,a,n.foreground,"bgrect")).close(),u&&(a.fill=u)):e.open("path",this.attr(t,a,n.foreground,"bgfore")).close()}e.close(),o&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):Ph(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},s=(a,o,l,u)=>{i[u||a]=o};return Array.isArray(n)?n.forEach(a=>a(s,t,this)):n(s,t,this),r&&uYt(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const s=t[i],a=s.stops;s.gradient==="radial"?(e.open("pattern",{id:CP+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:i,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let o=0;o<a.length;++o)e.open("stop",{offset:a[o].offset,"stop-color":a[o].color}).close();e.close()}for(const i in n){const s=n[i];e.open("clipPath",{id:i}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});function uYt(e,t,n,r,i){let s;if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=k9(t),e["font-size"]=lg(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in IP){let o=t[a];const l=IP[a];o==="transparent"&&(l==="fill"||l==="stroke")||o!=null&&(ase(o)&&(o=X5e(o,i.gradient,"")),e[l]=o)}for(const a in NP){const o=t[a];o!=null&&(s=s||[],s.push(`${NP[a]}: ${o};`))}return s&&(e.style=s.join(" ")),e}const PPe="canvas",LPe="png",BPe="svg",zPe="none",R1={Canvas:PPe,PNG:LPe,SVG:BPe,None:zPe},l$={};l$[PPe]=l$[LPe]={renderer:dK,headless:dK,handler:A9};l$[BPe]={renderer:FPe,headless:RPe,handler:CPe};l$[zPe]={};function Tse(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(l$[e]=t,this):l$[e]}function cYt(e,t,n){const r=[],i=new Oi().union(t),s=e.marktype;return s?UPe(e,i,n,r):s==="group"?WPe(e,i,n,r):$e("Intersect scene must be mark node or group item.")}function UPe(e,t,n,r){if(fYt(e,t,n)){const i=e.items,s=e.marktype,a=i.length;let o=0;if(s==="group")for(;o<a;++o)WPe(i[o],t,n,r);else for(const l=Pu[s].isect;o<a;++o){const u=i[o];VPe(u,t,l)&&r.push(u)}}return r}function fYt(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function WPe(e,t,n,r){n&&n(e.mark)&&VPe(e,t,Pu.group.isect)&&r.push(e);const i=e.items,s=i&&i.length;if(s){const a=e.x||0,o=e.y||0;t.translate(-a,-o);for(let l=0;l<s;++l)UPe(i[l],t,n,r);t.translate(a,o)}return r}function VPe(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const hH=new Oi;function hYt(e){const t=e.clip;if(Ut(t))t($9(hH.clear()));else if(t)hH.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(hH)}const u$="top",_c="left",Nc="right",tm="bottom",dYt="top-left",pYt="top-right",gYt="bottom-left",mYt="bottom-right",Dse="start",gK="middle",Va="end",vYt="x",yYt="y",T9="group",Ise="axis",Nse="title",bYt="frame",xYt="scope",Mse="legend",jPe="row-header",HPe="row-footer",qPe="row-title",GPe="column-header",YPe="column-footer",XPe="column-title",wYt="padding",$Yt="symbol",KPe="fit",ZPe="fit-x",QPe="fit-y",CYt="pad",Fse="none",NO="all",mK="each",Ose="flush",Zg="column",Qg="row";function JPe(e){me.call(this,null,e)}Ie(JPe,me,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,s=Pu[i],a=s.bound;let o=r.bounds,l;if(s.nested)r.items.length&&n.dirty(r.items[0]),o=MO(r,a),r.items.forEach(u=>{u.bounds.clear().union(o)});else if(i===T9||e.modified())switch(t.visit(t.MOD,u=>n.dirty(u)),o.clear(),r.items.forEach(u=>o.union(MO(u,a))),r.role){case Ise:case Mse:case Nse:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,u=>{o.union(MO(u,a))}),t.visit(t.MOD,u=>{l=l||o.alignsWith(u.bounds),n.dirty(u),o.union(MO(u,a))}),l&&(o.clear(),r.items.forEach(u=>o.union(u.bounds)));return hYt(r),t.modifies("bounds")}});function MO(e,t,n){return t(e.bounds.clear(),e,n)}const h1e=":vega_identifier:";function Rse(e){me.call(this,0,e)}Rse.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};Ie(Rse,me,{transform(e,t){const n=_Yt(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,s=>s[r]=s[r]||++i),n.set(this.value=i),t}});function _Yt(e){return e._signals[h1e]||(e._signals[h1e]=e.add(0))}function eLe(e){me.call(this,null,e)}Ie(eLe,me,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,SYt(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===T9?fse:cse;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function SYt(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function tLe(e){me.call(this,null,e)}const d1e={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!nLe(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},nLe=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),p1e=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,s;n<r;i=s,++n)if(nLe(i,s=e[n].bounds,t))return!0},kYt=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},EYt=(e,t,n)=>{var r=e.range(),i=new Oi;return t===u$||t===tm?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),s=>i.encloses(s.bounds)},g1e=e=>(e.forEach(t=>t.opacity=1),e),m1e=(e,t)=>e.reflow(t.modified()).modifies("opacity");Ie(tLe,me,{transform(e,t){const n=d1e[e.method]||d1e.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,s,a;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(g1e(i),t=m1e(t,e)),t;if(i=i.filter(kYt),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),s=g1e(i),t=m1e(t,e),s.length>=3&&p1e(s,r)){do s=n(s,r);while(s.length>=3&&p1e(s,r));s.length<3&&!ln(i).opacity&&(s.length>1&&(ln(s).opacity=0),ln(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(a=EYt(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(l=>{a(l)||(l.opacity=0)}));const o=s[0].mark.bounds.clear();return i.forEach(l=>{l.opacity&&o.union(l.bounds)}),t}});function rLe(e){me.call(this,null,e)}Ie(rLe,me,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const na=new Oi;function M2(e,t,n){return e[t]===n?0:(e[t]=n,1)}function AYt(e){var t=e.items[0].orient;return t===_c||t===Nc}function TYt(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function DYt(e,t,n,r){var i=t.items[0],s=i.datum,a=i.translate!=null?i.translate:.5,o=i.orient,l=TYt(s),u=i.range,c=i.offset,f=i.position,h=i.minExtent,d=i.maxExtent,p=s.title&&i.items[l[2]].items[0],g=i.titlePadding,m=i.bounds,v=p&&dPe(p),y=0,b=0,x,w;switch(na.clear().union(m),m.clear(),(x=l[0])>-1&&m.union(i.items[x].bounds),(x=l[1])>-1&&m.union(i.items[x].bounds),o){case u$:y=f||0,b=-c,w=Math.max(h,Math.min(d,-m.y1)),m.add(0,-w).add(u,0),p&&FO(e,p,w,g,v,0,-1,m);break;case _c:y=-c,b=f||0,w=Math.max(h,Math.min(d,-m.x1)),m.add(-w,0).add(0,u),p&&FO(e,p,w,g,v,1,-1,m);break;case Nc:y=n+c,b=f||0,w=Math.max(h,Math.min(d,m.x2)),m.add(0,0).add(w,u),p&&FO(e,p,w,g,v,1,1,m);break;case tm:y=f||0,b=r+c,w=Math.max(h,Math.min(d,m.y2)),m.add(0,0).add(u,w),p&&FO(e,p,w,g,0,0,1,m);break;default:y=i.x,b=i.y}return Zm(m.translate(y,b),i),M2(i,"x",y+a)|M2(i,"y",b+a)&&(i.bounds=na,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function FO(e,t,n,r,i,s,a,o){const l=t.bounds;if(t.auto){const u=a*(n+i+r);let c=0,f=0;e.dirty(t),s?c=(t.x||0)-(t.x=u):f=(t.y||0)-(t.y=u),t.mark.bounds.clear().union(l.translate(-c,-f)),e.dirty(t)}o.union(l)}const v1e=(e,t)=>Math.floor(Math.min(e,t)),y1e=(e,t)=>Math.ceil(Math.max(e,t));function IYt(e){var t=e.items,n=t.length,r=0,i,s;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],s=i.items,i.marktype===T9)switch(i.role){case Ise:case Mse:case Nse:break;case jPe:a.rowheaders.push(...s);break;case HPe:a.rowfooters.push(...s);break;case GPe:a.colheaders.push(...s);break;case YPe:a.colfooters.push(...s);break;case qPe:a.rowtitle=s[0];break;case XPe:a.coltitle=s[0];break;default:a.marks.push(...s)}return a}function NYt(e){return new Oi().set(0,0,e.width||0,e.height||0)}function MYt(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function $r(e,t,n){const r=Ft(e)?e[t]:e;return r!=null?r:n!==void 0?n:0}function b1e(e){return e<0?Math.ceil(-e):0}function iLe(e,t,n){var r=!n.nodirty,i=n.bounds===Ose?NYt:MYt,s=na.set(0,0,0,0),a=$r(n.align,Zg),o=$r(n.align,Qg),l=$r(n.padding,Zg),u=$r(n.padding,Qg),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),h=t.length,d=Array(h),p=Array(c),g=0,m=Array(h),v=Array(f),y=0,b=Array(h),x=Array(h),w=Array(h),C,$,_,k,E,S,I,A,D,T,N;for($=0;$<c;++$)p[$]=0;for($=0;$<f;++$)v[$]=0;for($=0;$<h;++$)S=t[$],E=w[$]=i(S),S.x=S.x||0,b[$]=0,S.y=S.y||0,x[$]=0,_=$%c,k=~~($/c),g=Math.max(g,I=Math.ceil(E.x2)),y=Math.max(y,A=Math.ceil(E.y2)),p[_]=Math.max(p[_],I),v[k]=Math.max(v[k],A),d[$]=l+b1e(E.x1),m[$]=u+b1e(E.y1),r&&e.dirty(t[$]);for($=0;$<h;++$)$%c===0&&(d[$]=0),$<c&&(m[$]=0);if(a===mK)for(_=1;_<c;++_){for(N=0,$=_;$<h;$+=c)N<d[$]&&(N=d[$]);for($=_;$<h;$+=c)d[$]=N+p[_-1]}else if(a===NO){for(N=0,$=0;$<h;++$)$%c&&N<d[$]&&(N=d[$]);for($=0;$<h;++$)$%c&&(d[$]=N+g)}else for(a=!1,_=1;_<c;++_)for($=_;$<h;$+=c)d[$]+=p[_-1];if(o===mK)for(k=1;k<f;++k){for(N=0,$=k*c,C=$+c;$<C;++$)N<m[$]&&(N=m[$]);for($=k*c;$<C;++$)m[$]=N+v[k-1]}else if(o===NO){for(N=0,$=c;$<h;++$)N<m[$]&&(N=m[$]);for($=c;$<h;++$)m[$]=N+y}else for(o=!1,k=1;k<f;++k)for($=k*c,C=$+c;$<C;++$)m[$]+=v[k-1];for(D=0,$=0;$<h;++$)D=d[$]+($%c?D:0),b[$]+=D-t[$].x;for(_=0;_<c;++_)for(T=0,$=_;$<h;$+=c)T+=m[$],x[$]+=T-t[$].y;if(a&&$r(n.center,Zg)&&f>1)for($=0;$<h;++$)E=a===NO?g:p[$%c],D=E-w[$].x2-t[$].x-b[$],D>0&&(b[$]+=D/2);if(o&&$r(n.center,Qg)&&c!==1)for($=0;$<h;++$)E=o===NO?y:v[~~($/c)],T=E-w[$].y2-t[$].y-x[$],T>0&&(x[$]+=T/2);for($=0;$<h;++$)s.union(w[$].translate(b[$],x[$]));switch(D=$r(n.anchor,vYt),T=$r(n.anchor,yYt),$r(n.anchor,Zg)){case Va:D-=s.width();break;case gK:D-=s.width()/2}switch($r(n.anchor,Qg)){case Va:T-=s.height();break;case gK:T-=s.height()/2}for(D=Math.round(D),T=Math.round(T),s.clear(),$=0;$<h;++$)t[$].mark.bounds.clear();for($=0;$<h;++$)S=t[$],S.x+=b[$]+=D,S.y+=x[$]+=T,s.union(S.mark.bounds.union(S.bounds.translate(b[$],x[$]))),r&&e.dirty(S);return s}function FYt(e,t,n){var r=IYt(t),i=r.marks,s=n.bounds===Ose?OYt:RYt,a=n.offset,o=n.columns||i.length,l=o<=0?1:Math.ceil(i.length/o),u=l*o,c,f,h,d,p,g,m;const v=iLe(e,i,n);v.empty()&&v.set(0,0,0,0),r.rowheaders&&(g=$r(n.headerBand,Qg,null),c=OO(e,r.rowheaders,i,o,l,-$r(a,"rowHeader"),v1e,0,s,"x1",0,o,1,g)),r.colheaders&&(g=$r(n.headerBand,Zg,null),f=OO(e,r.colheaders,i,o,o,-$r(a,"columnHeader"),v1e,1,s,"y1",0,1,o,g)),r.rowfooters&&(g=$r(n.footerBand,Qg,null),h=OO(e,r.rowfooters,i,o,l,$r(a,"rowFooter"),y1e,0,s,"x2",o-1,o,1,g)),r.colfooters&&(g=$r(n.footerBand,Zg,null),d=OO(e,r.colfooters,i,o,o,$r(a,"columnFooter"),y1e,1,s,"y2",u-o,1,o,g)),r.rowtitle&&(p=$r(n.titleAnchor,Qg),m=$r(a,"rowTitle"),m=p===Va?h+m:c-m,g=$r(n.titleBand,Qg,.5),x1e(e,r.rowtitle,m,0,v,g)),r.coltitle&&(p=$r(n.titleAnchor,Zg),m=$r(a,"columnTitle"),m=p===Va?d+m:f-m,g=$r(n.titleBand,Zg,.5),x1e(e,r.coltitle,m,1,v,g))}function OYt(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function RYt(e,t){return e.bounds[t]}function OO(e,t,n,r,i,s,a,o,l,u,c,f,h,d){var p=n.length,g=0,m=0,v,y,b,x,w,C,$,_,k;if(!p)return g;for(v=c;v<p;v+=f)n[v]&&(g=a(g,l(n[v],u)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=s,y=0,x=t.length;y<x;++y)e.dirty(t[y]),t[y].mark.bounds.clear();for(v=c,y=0,x=t.length;y<x;++y,v+=f){for(C=t[y],w=C.mark.bounds,b=v;b>=0&&($=n[b])==null;b-=h);o?(_=d==null?$.x:Math.round($.bounds.x1+d*$.bounds.width()),k=g):(_=g,k=d==null?$.y:Math.round($.bounds.y1+d*$.bounds.height())),w.union(C.bounds.translate(_-(C.x||0),k-(C.y||0))),C.x=_,C.y=k,e.dirty(C),m=a(m,w[u])}return m}function x1e(e,t,n,r,i,s){if(!!t){e.dirty(t);var a=n,o=n;r?a=Math.round(i.x1+s*i.width()):o=Math.round(i.y1+s*i.height()),t.bounds.translate(a-(t.x||0),o-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=o,e.dirty(t)}}function PYt(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function LYt(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function BYt(e,t,n,r,i,s,a){const o=PYt(n,t),l=LYt(e,o("offset",0)),u=o("anchor",Dse),c=u===Va?1:u===gK?.5:0,f={align:mK,bounds:o("bounds",Ose),columns:o("direction")==="vertical"?1:e.length,padding:o("margin",8),center:o("center"),nodirty:!0};switch(t){case _c:f.anchor={x:Math.floor(r.x1)-l,column:Va,y:c*(a||r.height()+2*r.y1),row:u};break;case Nc:f.anchor={x:Math.ceil(r.x2)+l,y:c*(a||r.height()+2*r.y1),row:u};break;case u$:f.anchor={y:Math.floor(i.y1)-l,row:Va,x:c*(s||i.width()+2*i.x1),column:u};break;case tm:f.anchor={y:Math.ceil(i.y2)+l,x:c*(s||i.width()+2*i.x1),column:u};break;case dYt:f.anchor={x:l,y:l};break;case pYt:f.anchor={x:s-l,y:l,column:Va};break;case gYt:f.anchor={x:l,y:a-l,row:Va};break;case mYt:f.anchor={x:s-l,y:a-l,column:Va,row:Va};break}return f}function zYt(e,t){var n=t.items[0],r=n.datum,i=n.orient,s=n.bounds,a=n.x,o=n.y,l,u;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),WYt(e,n,n.items[0].items[0]),s=UYt(n,s),l=2*n.padding,u=2*n.padding,s.empty()||(l=Math.ceil(s.width()+l),u=Math.ceil(s.height()+u)),r.type===$Yt&&VYt(n.items[0].items[0].items[0].items),i!==Fse&&(n.x=a=0,n.y=o=0),n.width=l,n.height=u,Zm(s.set(a,o,a+l,o+u),n),n.mark.bounds.clear().union(s),n}function UYt(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function WYt(e,t,n){var r=t.padding,i=r-n.x,s=r-n.y;if(!t.datum.title)(i||s)&&dk(e,n,i,s);else{var a=t.items[1].items[0],o=a.anchor,l=t.titlePadding||0,u=r-a.x,c=r-a.y;switch(a.orient){case _c:i+=Math.ceil(a.bounds.width())+l;break;case Nc:case tm:break;default:s+=a.bounds.height()+l}switch((i||s)&&dk(e,n,i,s),a.orient){case _c:c+=l2(t,n,a,o,1,1);break;case Nc:u+=l2(t,n,a,Va,0,0)+l,c+=l2(t,n,a,o,1,1);break;case tm:u+=l2(t,n,a,o,0,0),c+=l2(t,n,a,Va,-1,0,1)+l;break;default:u+=l2(t,n,a,o,0,0)}(u||c)&&dk(e,a,u,c),(u=Math.round(a.bounds.x1-r))<0&&(dk(e,n,-u,0),dk(e,a,-u,0))}}function l2(e,t,n,r,i,s,a){const o=e.datum.type!=="symbol",l=n.datum.vgrad,u=o&&(s||!l)&&!a?t.items[0]:t,c=u.bounds[i?"y2":"x2"]-e.padding,f=l&&s?c:0,h=l&&s?0:c,d=i<=0?0:dPe(n);return Math.round(r===Dse?f:r===Va?h-d:.5*(c-d))}function dk(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function VYt(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function jYt(e,t,n,r,i){var s=t.items[0],a=s.frame,o=s.orient,l=s.anchor,u=s.offset,c=s.padding,f=s.items[0].items[0],h=s.items[1]&&s.items[1].items[0],d=o===_c||o===Nc?r:n,p=0,g=0,m=0,v=0,y=0,b;if(a!==T9?o===_c?(p=i.y2,d=i.y1):o===Nc?(p=i.y1,d=i.y2):(p=i.x1,d=i.x2):o===_c&&(p=r,d=0),b=l===Dse?p:l===Va?d:(p+d)/2,h&&h.text){switch(o){case u$:case tm:y=f.bounds.height()+c;break;case _c:v=f.bounds.width()+c;break;case Nc:v=-f.bounds.width()-c;break}na.clear().union(h.bounds),na.translate(v-(h.x||0),y-(h.y||0)),M2(h,"x",v)|M2(h,"y",y)&&(e.dirty(h),h.bounds.clear().union(na),h.mark.bounds.clear().union(na),e.dirty(h)),na.clear().union(h.bounds)}else na.clear();switch(na.union(f.bounds),o){case u$:g=b,m=i.y1-na.height()-u;break;case _c:g=i.x1-na.width()-u,m=b;break;case Nc:g=i.x2+na.width()+u,m=b;break;case tm:g=b,m=i.y2+u;break;default:g=s.x,m=s.y}return M2(s,"x",g)|M2(s,"y",m)&&(na.translate(g,m),e.dirty(s),s.bounds.clear().union(na),t.bounds.clear().union(na),e.dirty(s)),s.bounds}function sLe(e){me.call(this,null,e)}Ie(sLe,me,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&FYt(n,r,e.layout),qYt(n,r,e)}),HYt(e.mark.group)?t.reflow():t}});function HYt(e){return e&&e.mark.role!=="legend-entry"}function qYt(e,t,n){var r=t.items,i=Math.max(0,t.width||0),s=Math.max(0,t.height||0),a=new Oi().set(0,0,i,s),o=a.clone(),l=a.clone(),u=[],c,f,h,d,p,g;for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case Ise:d=AYt(f)?o:l,d.union(DYt(e,f,i,s));break;case Nse:c=f;break;case Mse:u.push(zYt(e,f));break;case bYt:case xYt:case jPe:case HPe:case qPe:case GPe:case YPe:case XPe:o.union(f.bounds),l.union(f.bounds);break;default:a.union(f.bounds)}if(u.length){const m={};u.forEach(v=>{h=v.orient||Nc,h!==Fse&&(m[h]||(m[h]=[])).push(v)});for(const v in m){const y=m[v];iLe(e,y,BYt(y,v,n.legends,o,l,i,s))}u.forEach(v=>{const y=v.bounds;if(y.equals(v._bounds)||(v.bounds=v._bounds,e.dirty(v),v.bounds=y,e.dirty(v)),n.autosize&&(n.autosize.type===KPe||n.autosize.type===ZPe||n.autosize.type===QPe))switch(v.orient){case _c:case Nc:a.add(y.x1,0).add(y.x2,0);break;case u$:case tm:a.add(0,y.y1).add(0,y.y2)}else a.union(y)})}a.union(o).union(l),c&&a.union(jYt(e,c,i,s,a)),t.clip&&a.set(0,0,t.width||0,t.height||0),GYt(e,t,a,n)}function GYt(e,t,n,r){const i=r.autosize||{},s=i.type;if(e._autosize<1||!s)return;let a=e._width,o=e._height,l=Math.max(0,t.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const h=Math.max(0,Math.ceil(n.x2-l)),d=Math.max(0,Math.ceil(n.y2-c));if(i.contains===wYt){const p=e.padding();a-=p.left+p.right,o-=p.top+p.bottom}s===Fse?(u=0,f=0,l=a,c=o):s===KPe?(l=Math.max(0,a-u-h),c=Math.max(0,o-f-d)):s===ZPe?(l=Math.max(0,a-u-h),o=c+f+d):s===QPe?(a=l+u+h,c=Math.max(0,o-f-d)):s===CYt&&(a=l+u+h,o=c+f+d),e._resizeView(a,o,l,c,[u,f],i.resize)}const YYt=Object.freeze(Object.defineProperty({__proto__:null,bound:JPe,identifier:Rse,mark:eLe,overlap:tLe,render:rLe,viewlayout:sLe},Symbol.toStringTag,{value:"Module"}));function j_(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function dM(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Qm(){}var Jy=.7,c$=1/Jy,nw="\\s*([+-]?\\d+)\\s*",JT="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ch="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",XYt=/^#([0-9a-f]{3,8})$/,KYt=new RegExp("^rgb\\("+[nw,nw,nw]+"\\)$"),ZYt=new RegExp("^rgb\\("+[ch,ch,ch]+"\\)$"),QYt=new RegExp("^rgba\\("+[nw,nw,nw,JT]+"\\)$"),JYt=new RegExp("^rgba\\("+[ch,ch,ch,JT]+"\\)$"),eXt=new RegExp("^hsl\\("+[JT,ch,ch]+"\\)$"),tXt=new RegExp("^hsla\\("+[JT,ch,ch,JT]+"\\)$"),w1e={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};j_(Qm,e3,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:$1e,formatHex:$1e,formatHsl:nXt,formatRgb:C1e,toString:C1e});function $1e(){return this.rgb().formatHex()}function nXt(){return aLe(this).formatHsl()}function C1e(){return this.rgb().formatRgb()}function e3(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=XYt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?_1e(t):n===3?new Ms(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?RO(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?RO(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=KYt.exec(e))?new Ms(t[1],t[2],t[3],1):(t=ZYt.exec(e))?new Ms(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=QYt.exec(e))?RO(t[1],t[2],t[3],t[4]):(t=JYt.exec(e))?RO(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=eXt.exec(e))?E1e(t[1],t[2]/100,t[3]/100,1):(t=tXt.exec(e))?E1e(t[1],t[2]/100,t[3]/100,t[4]):w1e.hasOwnProperty(e)?_1e(w1e[e]):e==="transparent"?new Ms(NaN,NaN,NaN,0):null}function _1e(e){return new Ms(e>>16&255,e>>8&255,e&255,1)}function RO(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ms(e,t,n,r)}function Pse(e){return e instanceof Qm||(e=e3(e)),e?(e=e.rgb(),new Ms(e.r,e.g,e.b,e.opacity)):new Ms}function nm(e,t,n,r){return arguments.length===1?Pse(e):new Ms(e,t,n,r==null?1:r)}function Ms(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}j_(Ms,nm,dM(Qm,{brighter:function(e){return e=e==null?c$:Math.pow(c$,e),new Ms(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Jy:Math.pow(Jy,e),new Ms(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:S1e,formatHex:S1e,formatRgb:k1e,toString:k1e}));function S1e(){return"#"+dH(this.r)+dH(this.g)+dH(this.b)}function k1e(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function dH(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function E1e(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new zf(e,t,n,r)}function aLe(e){if(e instanceof zf)return new zf(e.h,e.s,e.l,e.opacity);if(e instanceof Qm||(e=e3(e)),!e)return new zf;if(e instanceof zf)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new zf(a,o,l,e.opacity)}function MP(e,t,n,r){return arguments.length===1?aLe(e):new zf(e,t,n,r==null?1:r)}function zf(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}j_(zf,MP,dM(Qm,{brighter:function(e){return e=e==null?c$:Math.pow(c$,e),new zf(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Jy:Math.pow(Jy,e),new zf(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Ms(pH(e>=240?e-240:e+120,i,r),pH(e,i,r),pH(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function pH(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const oLe=Math.PI/180,lLe=180/Math.PI,FP=18,uLe=.96422,cLe=1,fLe=.82521,hLe=4/29,rw=6/29,dLe=3*rw*rw,rXt=rw*rw*rw;function pLe(e){if(e instanceof fh)return new fh(e.l,e.a,e.b,e.opacity);if(e instanceof tp)return gLe(e);e instanceof Ms||(e=Pse(e));var t=yH(e.r),n=yH(e.g),r=yH(e.b),i=gH((.2225045*t+.7168786*n+.0606169*r)/cLe),s,a;return t===n&&n===r?s=a=i:(s=gH((.4360747*t+.3850649*n+.1430804*r)/uLe),a=gH((.0139322*t+.0971045*n+.7141733*r)/fLe)),new fh(116*i-16,500*(s-i),200*(i-a),e.opacity)}function OP(e,t,n,r){return arguments.length===1?pLe(e):new fh(e,t,n,r==null?1:r)}function fh(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}j_(fh,OP,dM(Qm,{brighter:function(e){return new fh(this.l+FP*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new fh(this.l-FP*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=uLe*mH(t),e=cLe*mH(e),n=fLe*mH(n),new Ms(vH(3.1338561*t-1.6168667*e-.4906146*n),vH(-.9787684*t+1.9161415*e+.033454*n),vH(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function gH(e){return e>rXt?Math.pow(e,1/3):e/dLe+hLe}function mH(e){return e>rw?e*e*e:dLe*(e-hLe)}function vH(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function yH(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function iXt(e){if(e instanceof tp)return new tp(e.h,e.c,e.l,e.opacity);if(e instanceof fh||(e=pLe(e)),e.a===0&&e.b===0)return new tp(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*lLe;return new tp(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function RP(e,t,n,r){return arguments.length===1?iXt(e):new tp(e,t,n,r==null?1:r)}function tp(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function gLe(e){if(isNaN(e.h))return new fh(e.l,0,0,e.opacity);var t=e.h*oLe;return new fh(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}j_(tp,RP,dM(Qm,{brighter:function(e){return new tp(this.h,this.c,this.l+FP*(e==null?1:e),this.opacity)},darker:function(e){return new tp(this.h,this.c,this.l-FP*(e==null?1:e),this.opacity)},rgb:function(){return gLe(this).rgb()}}));var mLe=-.14861,Lse=1.78277,Bse=-.29227,D9=-.90649,t3=1.97294,A1e=t3*D9,T1e=t3*Lse,D1e=Lse*Bse-D9*mLe;function sXt(e){if(e instanceof oy)return new oy(e.h,e.s,e.l,e.opacity);e instanceof Ms||(e=Pse(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(D1e*r+A1e*t-T1e*n)/(D1e+A1e-T1e),s=r-i,a=(t3*(n-i)-Bse*s)/D9,o=Math.sqrt(a*a+s*s)/(t3*i*(1-i)),l=o?Math.atan2(a,s)*lLe-120:NaN;return new oy(l<0?l+360:l,o,i,e.opacity)}function vK(e,t,n,r){return arguments.length===1?sXt(e):new oy(e,t,n,r==null?1:r)}function oy(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}j_(oy,vK,dM(Qm,{brighter:function(e){return e=e==null?c$:Math.pow(c$,e),new oy(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Jy:Math.pow(Jy,e),new oy(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*oLe,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Ms(255*(t+n*(mLe*r+Lse*i)),255*(t+n*(Bse*r+D9*i)),255*(t+n*(t3*r)),this.opacity)}}));function vLe(e,t,n,r,i){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*n+(1+3*e+3*s-3*a)*r+a*i)/6}function yLe(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],a=r>0?e[r-1]:2*i-s,o=r<t-1?e[r+2]:2*s-i;return vLe((n-r/t)*t,a,i,s,o)}}function bLe(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],a=e[(r+1)%t],o=e[(r+2)%t];return vLe((n-r/t)*t,i,s,a,o)}}const I9=e=>()=>e;function xLe(e,t){return function(n){return e+n*t}}function aXt(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function N9(e,t){var n=t-e;return n?xLe(e,n>180||n<-180?n-360*Math.round(n/360):n):I9(isNaN(e)?t:e)}function oXt(e){return(e=+e)==1?rs:function(t,n){return n-t?aXt(t,n,e):I9(isNaN(t)?n:t)}}function rs(e,t){var n=t-e;return n?xLe(e,n):I9(isNaN(e)?t:e)}const yK=function e(t){var n=oXt(t);function r(i,s){var a=n((i=nm(i)).r,(s=nm(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=rs(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function wLe(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),a,o;for(a=0;a<n;++a)o=nm(t[a]),r[a]=o.r||0,i[a]=o.g||0,s[a]=o.b||0;return r=e(r),i=e(i),s=e(s),o.opacity=1,function(l){return o.r=r(l),o.g=i(l),o.b=s(l),o+""}}}var lXt=wLe(yLe),uXt=wLe(bLe);function zse(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function $Le(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function cXt(e,t){return($Le(t)?zse:CLe)(e,t)}function CLe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=Jm(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function _Le(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function yc(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function SLe(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Jm(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var bK=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,bH=new RegExp(bK.source,"g");function fXt(e){return function(){return e}}function hXt(e){return function(t){return e(t)+""}}function kLe(e,t){var n=bK.lastIndex=bH.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=bK.exec(e))&&(i=bH.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:yc(r,i)})),n=bH.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?hXt(l[0].x):fXt(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)o[(f=l[c]).i]=f.x(u);return o.join("")})}function Jm(e,t){var n=typeof t,r;return t==null||n==="boolean"?I9(t):(n==="number"?yc:n==="string"?(r=e3(t))?(t=r,yK):kLe:t instanceof e3?yK:t instanceof Date?_Le:$Le(t)?zse:Array.isArray(t)?CLe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?SLe:yc)(e,t)}function dXt(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function pXt(e,t){var n=N9(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function pM(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var I1e=180/Math.PI,xK={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ELe(e,t,n,r,i,s){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*I1e,skewX:Math.atan(l)*I1e,scaleX:a,scaleY:o}}var PO;function gXt(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?xK:ELe(t.a,t.b,t.c,t.d,t.e,t.f)}function mXt(e){return e==null||(PO||(PO=document.createElementNS("http://www.w3.org/2000/svg","g")),PO.setAttribute("transform",e),!(e=PO.transform.baseVal.consolidate()))?xK:(e=e.matrix,ELe(e.a,e.b,e.c,e.d,e.e,e.f))}function ALe(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push("translate(",null,t,null,n);p.push({i:g-4,x:yc(u,f)},{i:g-2,x:yc(c,h)})}else(f||h)&&d.push("translate("+f+t+h+n)}function a(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:yc(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function o(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:yc(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push(i(d)+"scale(",null,",",null,")");p.push({i:g-4,x:yc(u,f)},{i:g-2,x:yc(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=e(u),c=e(c),s(u.translateX,u.translateY,c.translateX,c.translateY,f,h),a(u.rotate,c.rotate,f,h),o(u.skewX,c.skewX,f,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,g=h.length,m;++p<g;)f[(m=h[p]).i]=m.x(d);return f.join("")}}}var vXt=ALe(gXt,"px, ","px)","deg)"),yXt=ALe(mXt,", ",")",")"),bXt=1e-12;function N1e(e){return((e=Math.exp(e))+1/e)/2}function xXt(e){return((e=Math.exp(e))-1/e)/2}function wXt(e){return((e=Math.exp(2*e))-1)/(e+1)}const $Xt=function e(t,n,r){function i(s,a){var o=s[0],l=s[1],u=s[2],c=a[0],f=a[1],h=a[2],d=c-o,p=f-l,g=d*d+p*p,m,v;if(g<bXt)v=Math.log(h/u)/t,m=function($){return[o+$*d,l+$*p,u*Math.exp(t*$*v)]};else{var y=Math.sqrt(g),b=(h*h-u*u+r*g)/(2*u*n*y),x=(h*h-u*u-r*g)/(2*h*n*y),w=Math.log(Math.sqrt(b*b+1)-b),C=Math.log(Math.sqrt(x*x+1)-x);v=(C-w)/t,m=function($){var _=$*v,k=N1e(w),E=u/(n*y)*(k*wXt(t*_+w)-xXt(w));return[o+E*d,l+E*p,u*k/N1e(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(s){var a=Math.max(.001,+s),o=a*a,l=o*o;return e(a,o,l)},i}(Math.SQRT2,2,4);function TLe(e){return function(t,n){var r=e((t=MP(t)).h,(n=MP(n)).h),i=rs(t.s,n.s),s=rs(t.l,n.l),a=rs(t.opacity,n.opacity);return function(o){return t.h=r(o),t.s=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const CXt=TLe(N9);var _Xt=TLe(rs);function SXt(e,t){var n=rs((e=OP(e)).l,(t=OP(t)).l),r=rs(e.a,t.a),i=rs(e.b,t.b),s=rs(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=s(a),e+""}}function DLe(e){return function(t,n){var r=e((t=RP(t)).h,(n=RP(n)).h),i=rs(t.c,n.c),s=rs(t.l,n.l),a=rs(t.opacity,n.opacity);return function(o){return t.h=r(o),t.c=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const kXt=DLe(N9);var EXt=DLe(rs);function ILe(e){return function t(n){n=+n;function r(i,s){var a=e((i=vK(i)).h,(s=vK(s)).h),o=rs(i.s,s.s),l=rs(i.l,s.l),u=rs(i.opacity,s.opacity);return function(c){return i.h=a(c),i.s=o(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}const AXt=ILe(N9);var TXt=ILe(rs);function Use(e,t){t===void 0&&(t=e,e=Jm);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function DXt(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const IXt=Object.freeze(Object.defineProperty({__proto__:null,interpolate:Jm,interpolateArray:cXt,interpolateBasis:yLe,interpolateBasisClosed:bLe,interpolateDate:_Le,interpolateDiscrete:dXt,interpolateHue:pXt,interpolateNumber:yc,interpolateNumberArray:zse,interpolateObject:SLe,interpolateRound:pM,interpolateString:kLe,interpolateTransformCss:vXt,interpolateTransformSvg:yXt,interpolateZoom:$Xt,interpolateRgb:yK,interpolateRgbBasis:lXt,interpolateRgbBasisClosed:uXt,interpolateHsl:CXt,interpolateHslLong:_Xt,interpolateLab:SXt,interpolateHcl:kXt,interpolateHclLong:EXt,interpolateCubehelix:AXt,interpolateCubehelixLong:TXt,piecewise:Use,quantize:DXt},Symbol.toStringTag,{value:"Module"}));function NLe(e){me.call(this,null,e)}Ie(NLe,me,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,s=e.scale,a=e.count==null?e.values?e.values.length:10:e.count,o=ise(s,a,e.minstep),l=e.format||V5e(n,s,o,e.formatSpecifier,e.formatType,!!e.values),u=e.values?W5e(s,e.values,o):sse(s,o);return i&&(r.rem=i),i=u.map((c,f)=>Tn({index:f/(u.length-1||1),value:c,label:l(c)})),e.extra&&i.length&&i.push(Tn({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function MLe(e){me.call(this,null,e)}function NXt(){return Tn({})}function MXt(e){const t=qN().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}Ie(MLe,me,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||NXt,s=e.key||nt,a=this.value;return at(r.encode)&&(r.encode=null),a&&(e.modified("key")||t.modified(s))&&$e("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=MXt(s)),t.visit(t.ADD,o=>{const l=s(o);let u=a.get(l);u?u.exit?(a.empty--,r.add.push(u)):r.mod.push(u):(u=i(o),a.set(l,u),r.add.push(u)),u.datum=o,u.exit=!1}),t.visit(t.MOD,o=>{const l=s(o),u=a.get(l);u&&(u.datum=o,r.mod.push(u))}),t.visit(t.REM,o=>{const l=s(o),u=a.get(l);o===u.datum&&!u.exit&&(r.rem.push(u),u.exit=!0,++a.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}});function FLe(e){me.call(this,null,e)}Ie(FLe,me,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,s=t.encode;if(at(s))if(n.changed()||s.every(f=>i[f]))s=s[0],n.encode=null;else return t.StopPropagation;var a=s==="enter",o=i.update||Ev,l=i.enter||Ev,u=i.exit||Ev,c=(s&&!a?i[s]:o)||Ev;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{l(f,e),o(f,e)}),n.modifies(l.output),n.modifies(o.output),c!==Ev&&c!==o&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&u!==Ev&&(t.visit(t.REM,f=>{u(f,e)}),n.modifies(u.output)),a||c!==Ev){const f=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(f,h=>{const d=l(h,e)||r;(c(h,e)||d)&&n.mod.push(h)}),n.mod.length&&n.modifies(l.output)):t.visit(f,h=>{(c(h,e)||r)&&n.mod.push(h)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function OLe(e){me.call(this,[],e)}Ie(OLe,me,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,s=e.type||a4,a=e.scale,o=+e.limit,l=ise(a,e.count==null?5:e.count,e.minstep),u=!!e.values||s===a4,c=e.format||G5e(n,a,l,s,e.formatSpecifier,e.formatType,u),f=e.values||q5e(a,l),h,d,p,g,m;return i&&(r.rem=i),s===a4?(o&&f.length>o?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,o-1),m=!0):i=f,Ut(p=e.size)?(!e.values&&a(i[0])===0&&(i=i.slice(1)),g=i.reduce((v,y)=>Math.max(v,p(y,e)),0)):p=go(g=p||8),i=i.map((v,y)=>Tn({index:y,label:c(v,y,i),value:v,offset:g,size:p(v,e)})),m&&(m=f[i.length],i.push(Tn({index:i.length,label:"\u2026".concat(f.length-i.length," entries"),value:m,offset:g,size:p(m,e)})))):s===gHt?(h=a.domain(),d=P5e(a,h[0],ln(h)),f.length<3&&!e.values&&h[0]!==ln(h)&&(f=[h[0],ln(h)]),i=f.map((v,y)=>Tn({index:y,label:c(v,y,f),value:v,perc:d(v)}))):(p=f.length-1,d=kHt(a),i=f.map((v,y)=>Tn({index:y,label:c(v,y,f),value:v,perc:y?d(v):0,perc2:y===p?1:d(f[y+1])}))),r.source=i,r.add=i,this.value=i,r}});const FXt=e=>e.source.x,OXt=e=>e.source.y,RXt=e=>e.target.x,PXt=e=>e.target.y;function Wse(e){me.call(this,{},e)}Wse.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};Ie(Wse,me,{transform(e,t){var n=e.sourceX||FXt,r=e.sourceY||OXt,i=e.targetX||RXt,s=e.targetY||PXt,a=e.as||"path",o=e.orient||"vertical",l=e.shape||"line",u=M1e.get(l+"-"+o)||M1e.get(l);return u||$e("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[a]=u(n(c),r(c),i(c),s(c))}),t.reflow(e.modified()).modifies(a)}});const RLe=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,LXt=(e,t,n,r)=>RLe(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),PLe=(e,t,n,r)=>{var i=n-e,s=r-t,a=Math.sqrt(i*i+s*s)/2,o=180*Math.atan2(s,i)/Math.PI;return"M"+e+","+t+"A"+a+","+a+" "+o+" 0 1 "+n+","+r},BXt=(e,t,n,r)=>PLe(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),LLe=(e,t,n,r)=>{const i=n-e,s=r-t,a=.2*(i+s),o=.2*(s-i);return"M"+e+","+t+"C"+(e+a)+","+(t+o)+" "+(n+o)+","+(r-a)+" "+n+","+r},zXt=(e,t,n,r)=>LLe(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),UXt=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,WXt=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,VXt=(e,t,n,r)=>{const i=Math.cos(e),s=Math.sin(e),a=Math.cos(n),o=Math.sin(n),l=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*s+"A"+t+","+t+" 0 0,"+(l?1:0)+" "+t*a+","+t*o+"L"+r*a+","+r*o},jXt=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},HXt=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},qXt=(e,t,n,r)=>{const i=Math.cos(e),s=Math.sin(e),a=Math.cos(n),o=Math.sin(n),l=(t+r)/2;return"M"+t*i+","+t*s+"C"+l*i+","+l*s+" "+l*a+","+l*o+" "+r*a+","+r*o},M1e=qN({line:RLe,"line-radial":LXt,arc:PLe,"arc-radial":BXt,curve:LLe,"curve-radial":zXt,"orthogonal-horizontal":UXt,"orthogonal-vertical":WXt,"orthogonal-radial":VXt,"diagonal-horizontal":jXt,"diagonal-vertical":HXt,"diagonal-radial":qXt});function Vse(e){me.call(this,null,e)}Vse.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};Ie(Vse,me,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],s=e.field||HN,a=e.startAngle||0,o=e.endAngle!=null?e.endAngle:2*Math.PI,l=t.source,u=l.map(s),c=u.length,f=a,h=(o-a)/IRe(u),d=Ml(c),p,g,m;for(e.sort&&d.sort((v,y)=>u[v]-u[y]),p=0;p<c;++p)m=u[d[p]],g=l[d[p]],g[r]=f,g[i]=f+=m*h;return this.value=u,t.reflow(e.modified()).modifies(n)}});const GXt=5;function YXt(e){const t=e.type;return!e.bins&&(t===r$||t===iM||t===sM)}function BLe(e){return nse(e)&&e!==uh}const XXt=Oh(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function zLe(e){me.call(this,null,e),this.modified(!0)}Ie(zLe,me,{transform(e,t){var n=t.dataflow,r=this.value,i=KXt(e);(!r||i!==r.type)&&(this.value=r=Dn(i)());for(i in e)if(!XXt[i]){if(i==="padding"&&BLe(r.type))continue;Ut(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return nKt(r,e,tKt(r,e,QXt(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function KXt(e){var t=e.type,n="",r;return t===uh?uh+"-"+r$:(ZXt(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?uh+"-":r===3?W_+"-":""),(n+t||r$).toLowerCase())}function ZXt(e){const t=e.type;return nse(t)&&t!==Xy&&t!==Ky&&(e.scheme||e.range&&e.range.length&&e.range.every(wr))}function QXt(e,t,n){const r=JXt(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,s=e.type,a=t.zero||t.zero===void 0&&YXt(e),o,l;if(!i)return 0;if(BLe(s)&&t.padding&&i[0]!==ln(i)&&(i=eKt(s,i,t.range,t.padding,t.exponent,t.constant)),(a||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(o=(i=i.slice()).length-1||1,a&&(i[0]>0&&(i[0]=0),i[o]<0&&(i[o]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[o]=t.domainMax),t.domainMid!=null)){l=t.domainMid;const u=l>i[o]?o+1:l<i[0]?0:o;u!==o&&n.warn("Scale domainMid exceeds domain min or max.",l),i.splice(u,0,l)}return e.domain(ULe(s,i,n)),s===Qie&&e.unknown(t.domainImplicit?VX:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&ise(e,t.nice)||null),i.length}function JXt(e,t,n){return t?(e.domain(ULe(e.type,t,n)),t.length):-1}function eKt(e,t,n,r,i,s){var a=Math.abs(ln(n)-n[0]),o=a/(a-2*r),l=e===Up?KFe(t,null,o):e===sM?pX(t,null,o,.5):e===iM?pX(t,null,o,i||1):e===v9?ZFe(t,null,o,s||1):XFe(t,null,o);return t=t.slice(),t[0]=l[0],t[t.length-1]=l[1],t}function ULe(e,t,n){if(F5e(e)){var r=Math.abs(t.reduce((i,s)=>i+(s<0?-1:s>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+ot(t))}return t}function tKt(e,t,n){let r=t.bins;if(r&&!at(r)){const i=e.domain(),s=i[0],a=ln(i),o=r.step;let l=r.start==null?s:r.start,u=r.stop==null?a:r.stop;o||$e("Scale bins parameter missing step property."),l<s&&(l=o*Math.ceil(s/o)),u>a&&(u=o*Math.floor(a/o)),r=Ml(l,u+o/2,o)}return r?e.bins=r:e.bins&&delete e.bins,e.type===Jie&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function nKt(e,t,n){var r=e.type,i=t.round||!1,s=t.range;if(t.rangeStep!=null)s=rKt(r,t,n);else if(t.scheme&&(s=iKt(r,t,n),Ut(s))){if(e.interpolator)return e.interpolator(s);$e("Scale type ".concat(r," does not support interpolating color schemes."))}if(s&&O5e(r))return e.interpolator(rse(wK(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(L5e(t.interpolate,t.interpolateGamma)):Ut(e.round)?e.round(i):Ut(e.rangeRound)&&e.interpolate(i?pM:Jm),s&&e.range(wK(s,t.reverse))}function rKt(e,t,n){e!==A5e&&e!==tK&&$e("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===tK?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*Zie(n,i,r)]}function iKt(e,t,n){var r=t.schemeExtent,i,s;return at(t.scheme)?s=rse(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),s=U5e(i),s||$e("Unrecognized scheme name: ".concat(t.scheme))),n=e===b9?n+1:e===Jie?n-1:e===i$||e===y9?+t.schemeCount||GXt:n,O5e(e)?F1e(s,r,t.reverse):Ut(s)?cHt(F1e(s,r),n):e===Qie?s:s.slice(0,n)}function F1e(e,t,n){return Ut(e)&&(t||n)?uHt(e,wK(t||[0,1],n)):e}function wK(e,t){return t?e.slice().reverse():e}function WLe(e){me.call(this,null,e)}Ie(WLe,me,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(ix(e.sort)),this.modified(n),t}});const O1e="zero",VLe="center",jLe="normalize",HLe=["y0","y1"];function jse(e){me.call(this,null,e)}jse.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:O1e,values:[O1e,VLe,jLe]},{name:"as",type:"string",array:!0,length:2,default:HLe}]};Ie(jse,me,{transform(e,t){var n=e.as||HLe,r=n[0],i=n[1],s=ix(e.sort),a=e.field||HN,o=e.offset===VLe?sKt:e.offset===jLe?aKt:oKt,l,u,c,f;for(l=lKt(t.source,e.groupby,s,a),u=0,c=l.length,f=l.max;u<c;++u)o(l[u],f,a,r,i);return t.reflow(e.modified()).modifies(n)}});function sKt(e,t,n,r,i){for(var s=(t-e.sum)/2,a=e.length,o=0,l;o<a;++o)l=e[o],l[r]=s,l[i]=s+=Math.abs(n(l))}function aKt(e,t,n,r,i){for(var s=1/e.sum,a=0,o=e.length,l=0,u=0,c;l<o;++l)c=e[l],c[r]=a,c[i]=a=s*(u+=Math.abs(n(c)))}function oKt(e,t,n,r,i){for(var s=0,a=0,o=e.length,l=0,u,c;l<o;++l)c=e[l],u=+n(c),u<0?(c[r]=a,c[i]=a+=u):(c[r]=s,c[i]=s+=u)}function lKt(e,t,n,r){var i=[],s=g=>g(c),a,o,l,u,c,f,h,d,p;if(t==null)i.push(e.slice());else for(a={},o=0,l=e.length;o<l;++o)c=e[o],f=t.map(s),h=a[f],h||(a[f]=h=[],i.push(h)),h.push(c);for(f=0,p=0,u=i.length;f<u;++f){for(h=i[f],o=0,d=0,l=h.length;o<l;++o)d+=Math.abs(r(h[o]));h.sum=d,d>p&&(p=d),n&&h.sort(n)}return i.max=p,i}const uKt=Object.freeze(Object.defineProperty({__proto__:null,axisticks:NLe,datajoin:MLe,encode:FLe,legendentries:OLe,linkpath:Wse,pie:Vse,scale:zLe,sortitems:WLe,stack:jse},Symbol.toStringTag,{value:"Module"}));class eb{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],a=t+s,o=Math.abs(t)<Math.abs(s)?t-(a-s):s-(a-t);o&&(n[r++]=o),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,s=i-(a-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=a+i,i==r-a&&(a=r))}return a}}function*cKt(e){for(const t of e)yield*t}function qLe(e){return Array.from(cKt(e))}var Nt=1e-6,GLe=1e-12,Yt=Math.PI,Gr=Yt/2,R1e=Yt/4,Yl=Yt*2,aa=180/Yt,Pr=Yt/180,Pn=Math.abs,H_=Math.atan,Wp=Math.atan2,Lt=Math.cos,YLe=Math.exp,PP=Math.log,xH=Math.pow,Dt=Math.sin,yu=Math.sign||function(e){return e>0?1:e<0?-1:0},ul=Math.sqrt,Hse=Math.tan;function XLe(e){return e>1?0:e<-1?Yt:Math.acos(e)}function Lu(e){return e>1?Gr:e<-1?-Gr:Math.asin(e)}function bu(){}function LP(e,t){e&&L1e.hasOwnProperty(e.type)&&L1e[e.type](e,t)}var P1e={Feature:function(e,t){LP(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)LP(n[r].geometry,t)}},L1e={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){$K(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)$K(n[r],t,0)},Polygon:function(e,t){B1e(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)B1e(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)LP(n[r],t)}};function $K(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function B1e(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)$K(e[n],t,1);t.polygonEnd()}function _2(e,t){e&&P1e.hasOwnProperty(e.type)?P1e[e.type](e,t):LP(e,t)}function CK(e){return[Wp(e[1],e[0]),Lu(e[2])]}function f$(e){var t=e[0],n=e[1],r=Lt(n);return[r*Lt(t),r*Dt(t),Dt(n)]}function LO(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function BP(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function wH(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function BO(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function _K(e){var t=ul(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function SK(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function kK(e,t){return Pn(e)>Yt&&(e-=Math.round(e/Yl)*Yl),[e,t]}kK.invert=kK;function KLe(e,t,n){return(e%=Yl)?t||n?SK(U1e(e),W1e(t,n)):U1e(e):t||n?W1e(t,n):kK}function z1e(e){return function(t,n){return t+=e,Pn(t)>Yt&&(t-=Math.round(t/Yl)*Yl),[t,n]}}function U1e(e){var t=z1e(e);return t.invert=z1e(-e),t}function W1e(e,t){var n=Lt(e),r=Dt(e),i=Lt(t),s=Dt(t);function a(o,l){var u=Lt(l),c=Lt(o)*u,f=Dt(o)*u,h=Dt(l),d=h*n+c*r;return[Wp(f*i-d*s,c*n-h*r),Lu(d*i+f*s)]}return a.invert=function(o,l){var u=Lt(l),c=Lt(o)*u,f=Dt(o)*u,h=Dt(l),d=h*i-f*s;return[Wp(f*i+h*s,c*n+d*r),Lu(d*n-c*r)]},a}function fKt(e){e=KLe(e[0]*Pr,e[1]*Pr,e.length>2?e[2]*Pr:0);function t(n){return n=e(n[0]*Pr,n[1]*Pr),n[0]*=aa,n[1]*=aa,n}return t.invert=function(n){return n=e.invert(n[0]*Pr,n[1]*Pr),n[0]*=aa,n[1]*=aa,n},t}function hKt(e,t,n,r,i,s){if(!!n){var a=Lt(t),o=Dt(t),l=r*n;i==null?(i=t+r*Yl,s=t-l/2):(i=V1e(a,i),s=V1e(a,s),(r>0?i<s:i>s)&&(i+=r*Yl));for(var u,c=i;r>0?c>s:c<s;c-=l)u=CK([a,-o*Lt(c),-o*Dt(c)]),e.point(u[0],u[1])}}function V1e(e,t){t=f$(t),t[0]-=e,_K(t);var n=XLe(-t[1]);return((-t[2]<0?-n:n)+Yl-Nt)%Yl}function ZLe(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:bu,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function p4(e,t){return Pn(e[0]-t[0])<Nt&&Pn(e[1]-t[1])<Nt}function zO(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function QLe(e,t,n,r,i){var s=[],a=[],o,l;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],v=p[g],y;if(p4(m,v)){if(!m[2]&&!v[2]){for(i.lineStart(),o=0;o<g;++o)i.point((m=p[o])[0],m[1]);i.lineEnd();return}v[0]+=2*Nt}s.push(y=new zO(m,p,null,!0)),a.push(y.o=new zO(m,null,y,!1)),s.push(y=new zO(v,p,null,!1)),a.push(y.o=new zO(v,null,y,!0))}}),!!s.length){for(a.sort(t),j1e(s),j1e(a),o=0,l=a.length;o<l;++o)a[o].e=n=!n;for(var u=s[0],c,f;;){for(var h=u,d=!0;h.v;)if((h=h.n)===u)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,l=c.length;o<l;++o)i.point((f=c[o])[0],f[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(c=h.p.z,o=c.length-1;o>=0;--o)i.point((f=c[o])[0],f[1]);else r(h.x,h.p.x,-1,i);h=h.p}h=h.o,c=h.z,d=!d}while(!h.v);i.lineEnd()}}}function j1e(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function $H(e){return Pn(e[0])<=Yt?e[0]:yu(e[0])*((Pn(e[0])+Yt)%Yl-Yt)}function dKt(e,t){var n=$H(t),r=t[1],i=Dt(r),s=[Dt(n),-Lt(n),0],a=0,o=0,l=new eb;i===1?r=Gr+Nt:i===-1&&(r=-Gr-Nt);for(var u=0,c=e.length;u<c;++u)if(!!(h=(f=e[u]).length))for(var f,h,d=f[h-1],p=$H(d),g=d[1]/2+R1e,m=Dt(g),v=Lt(g),y=0;y<h;++y,p=x,m=C,v=$,d=b){var b=f[y],x=$H(b),w=b[1]/2+R1e,C=Dt(w),$=Lt(w),_=x-p,k=_>=0?1:-1,E=k*_,S=E>Yt,I=m*C;if(l.add(Wp(I*k*Dt(E),v*$+I*Lt(E))),a+=S?_+k*Yl:_,S^p>=n^x>=n){var A=BP(f$(d),f$(b));_K(A);var D=BP(s,A);_K(D);var T=(S^_>=0?-1:1)*Lu(D[2]);(r>T||r===T&&(A[0]||A[1]))&&(o+=S^_>=0?1:-1)}}return(a<-Nt||a<Nt&&l<-GLe)^o&1}function JLe(e,t,n,r){return function(i){var s=t(i),a=ZLe(),o=t(a),l=!1,u,c,f,h={point:d,lineStart:g,lineEnd:m,polygonStart:function(){h.point=v,h.lineStart=y,h.lineEnd=b,c=[],u=[]},polygonEnd:function(){h.point=d,h.lineStart=g,h.lineEnd=m,c=qLe(c);var x=dKt(u,r);c.length?(l||(i.polygonStart(),l=!0),QLe(c,gKt,x,n,i)):x&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),c=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(x,w){e(x,w)&&i.point(x,w)}function p(x,w){s.point(x,w)}function g(){h.point=p,s.lineStart()}function m(){h.point=d,s.lineEnd()}function v(x,w){f.push([x,w]),o.point(x,w)}function y(){o.lineStart(),f=[]}function b(){v(f[0][0],f[0][1]),o.lineEnd();var x=o.clean(),w=a.result(),C,$=w.length,_,k,E;if(f.pop(),u.push(f),f=null,!!$){if(x&1){if(k=w[0],(_=k.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),C=0;C<_;++C)i.point((E=k[C])[0],E[1]);i.lineEnd()}return}$>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(pKt))}}return h}}function pKt(e){return e.length>1}function gKt(e,t){return((e=e.x)[0]<0?e[1]-Gr-Nt:Gr-e[1])-((t=t.x)[0]<0?t[1]-Gr-Nt:Gr-t[1])}const H1e=JLe(function(){return!0},mKt,yKt,[-Yt,-Gr]);function mKt(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,a){var o=s>0?Yt:-Yt,l=Pn(s-t);Pn(l-Yt)<Nt?(e.point(t,n=(n+a)/2>0?Gr:-Gr),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(s,n),i=0):r!==o&&l>=Yt&&(Pn(t-r)<Nt&&(t-=r*Nt),Pn(s-o)<Nt&&(s-=o*Nt),n=vKt(t,n,s,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),i=0),e.point(t=s,n=a),r=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function vKt(e,t,n,r){var i,s,a=Dt(e-n);return Pn(a)>Nt?H_((Dt(t)*(s=Lt(r))*Dt(n)-Dt(r)*(i=Lt(t))*Dt(e))/(i*s*a)):(t+r)/2}function yKt(e,t,n,r){var i;if(e==null)i=n*Gr,r.point(-Yt,i),r.point(0,i),r.point(Yt,i),r.point(Yt,0),r.point(Yt,-i),r.point(0,-i),r.point(-Yt,-i),r.point(-Yt,0),r.point(-Yt,i);else if(Pn(e[0]-t[0])>Nt){var s=e[0]<t[0]?Yt:-Yt;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function bKt(e){var t=Lt(e),n=6*Pr,r=t>0,i=Pn(t)>Nt;function s(c,f,h,d){hKt(d,e,n,h,c,f)}function a(c,f){return Lt(c)*Lt(f)>t}function o(c){var f,h,d,p,g;return{lineStart:function(){p=d=!1,g=1},point:function(m,v){var y=[m,v],b,x=a(m,v),w=r?x?0:u(m,v):x?u(m+(m<0?Yt:-Yt),v):0;if(!f&&(p=d=x)&&c.lineStart(),x!==d&&(b=l(f,y),(!b||p4(f,b)||p4(y,b))&&(y[2]=1)),x!==d)g=0,x?(c.lineStart(),b=l(y,f),c.point(b[0],b[1])):(b=l(f,y),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var C;!(w&h)&&(C=l(y,f,!0))&&(g=0,r?(c.lineStart(),c.point(C[0][0],C[0][1]),c.point(C[1][0],C[1][1]),c.lineEnd()):(c.point(C[1][0],C[1][1]),c.lineEnd(),c.lineStart(),c.point(C[0][0],C[0][1],3)))}x&&(!f||!p4(f,y))&&c.point(y[0],y[1]),f=y,d=x,h=w},lineEnd:function(){d&&c.lineEnd(),f=null},clean:function(){return g|(p&&d)<<1}}}function l(c,f,h){var d=f$(c),p=f$(f),g=[1,0,0],m=BP(d,p),v=LO(m,m),y=m[0],b=v-y*y;if(!b)return!h&&c;var x=t*v/b,w=-t*y/b,C=BP(g,m),$=BO(g,x),_=BO(m,w);wH($,_);var k=C,E=LO($,k),S=LO(k,k),I=E*E-S*(LO($,$)-1);if(!(I<0)){var A=ul(I),D=BO(k,(-E-A)/S);if(wH(D,$),D=CK(D),!h)return D;var T=c[0],N=f[0],F=c[1],R=f[1],P;N<T&&(P=T,T=N,N=P);var V=N-T,z=Pn(V-Yt)<Nt,q=z||V<Nt;if(!z&&R<F&&(P=F,F=R,R=P),q?z?F+R>0^D[1]<(Pn(D[0]-T)<Nt?F:R):F<=D[1]&&D[1]<=R:V>Yt^(T<=D[0]&&D[0]<=N)){var G=BO(k,(-E+A)/S);return wH(G,$),[D,CK(G)]}}}function u(c,f){var h=r?e:Yt-e,d=0;return c<-h?d|=1:c>h&&(d|=2),f<-h?d|=4:f>h&&(d|=8),d}return JLe(a,o,s,r?[0,-e]:[-Yt,e-Yt])}function xKt(e,t,n,r,i,s){var a=e[0],o=e[1],l=t[0],u=t[1],c=0,f=1,h=l-a,d=u-o,p;if(p=n-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=i-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}if(p=r-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=s-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=a+c*h,e[1]=o+c*d),f<1&&(t[0]=a+f*h,t[1]=o+f*d),!0}}}}}var mE=1e9,UO=-mE;function e6e(e,t,n,r){function i(u,c){return e<=u&&u<=n&&t<=c&&c<=r}function s(u,c,f,h){var d=0,p=0;if(u==null||(d=a(u,f))!==(p=a(c,f))||l(u,c)<0^f>0)do h.point(d===0||d===3?e:n,d>1?r:t);while((d=(d+f+4)%4)!==p);else h.point(c[0],c[1])}function a(u,c){return Pn(u[0]-e)<Nt?c>0?0:3:Pn(u[0]-n)<Nt?c>0?2:1:Pn(u[1]-t)<Nt?c>0?1:0:c>0?3:2}function o(u,c){return l(u.x,c.x)}function l(u,c){var f=a(u,1),h=a(c,1);return f!==h?f-h:f===0?c[1]-u[1]:f===1?u[0]-c[0]:f===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,f=ZLe(),h,d,p,g,m,v,y,b,x,w,C,$={point:_,lineStart:I,lineEnd:A,polygonStart:E,polygonEnd:S};function _(T,N){i(T,N)&&c.point(T,N)}function k(){for(var T=0,N=0,F=d.length;N<F;++N)for(var R=d[N],P=1,V=R.length,z=R[0],q,G,K=z[0],Y=z[1];P<V;++P)q=K,G=Y,z=R[P],K=z[0],Y=z[1],G<=r?Y>r&&(K-q)*(r-G)>(Y-G)*(e-q)&&++T:Y<=r&&(K-q)*(r-G)<(Y-G)*(e-q)&&--T;return T}function E(){c=f,h=[],d=[],C=!0}function S(){var T=k(),N=C&&T,F=(h=qLe(h)).length;(N||F)&&(u.polygonStart(),N&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),F&&QLe(h,o,T,s,u),u.polygonEnd()),c=u,h=d=p=null}function I(){$.point=D,d&&d.push(p=[]),w=!0,x=!1,y=b=NaN}function A(){h&&(D(g,m),v&&x&&f.rejoin(),h.push(f.result())),$.point=_,x&&c.lineEnd()}function D(T,N){var F=i(T,N);if(d&&p.push([T,N]),w)g=T,m=N,v=F,w=!1,F&&(c.lineStart(),c.point(T,N));else if(F&&x)c.point(T,N);else{var R=[y=Math.max(UO,Math.min(mE,y)),b=Math.max(UO,Math.min(mE,b))],P=[T=Math.max(UO,Math.min(mE,T)),N=Math.max(UO,Math.min(mE,N))];xKt(R,P,e,t,n,r)?(x||(c.lineStart(),c.point(R[0],R[1])),c.point(P[0],P[1]),F||c.lineEnd(),C=!1):F&&(c.lineStart(),c.point(T,N),C=!1)}y=T,b=N,x=F}return $}}const n3=e=>e;var CH=new eb,EK=new eb,t6e,n6e,AK,TK,Wg={point:bu,lineStart:bu,lineEnd:bu,polygonStart:function(){Wg.lineStart=wKt,Wg.lineEnd=CKt},polygonEnd:function(){Wg.lineStart=Wg.lineEnd=Wg.point=bu,CH.add(Pn(EK)),EK=new eb},result:function(){var e=CH/2;return CH=new eb,e}};function wKt(){Wg.point=$Kt}function $Kt(e,t){Wg.point=r6e,t6e=AK=e,n6e=TK=t}function r6e(e,t){EK.add(TK*e-AK*t),AK=e,TK=t}function CKt(){r6e(t6e,n6e)}const q1e=Wg;var h$=1/0,zP=h$,r3=-h$,UP=r3,_Kt={point:SKt,lineStart:bu,lineEnd:bu,polygonStart:bu,polygonEnd:bu,result:function(){var e=[[h$,zP],[r3,UP]];return r3=UP=-(zP=h$=1/0),e}};function SKt(e,t){e<h$&&(h$=e),e>r3&&(r3=e),t<zP&&(zP=t),t>UP&&(UP=t)}const WP=_Kt;var DK=0,IK=0,vE=0,VP=0,jP=0,F2=0,NK=0,MK=0,yE=0,i6e,s6e,Uf,Wf,Sc={point:tb,lineStart:G1e,lineEnd:Y1e,polygonStart:function(){Sc.lineStart=AKt,Sc.lineEnd=TKt},polygonEnd:function(){Sc.point=tb,Sc.lineStart=G1e,Sc.lineEnd=Y1e},result:function(){var e=yE?[NK/yE,MK/yE]:F2?[VP/F2,jP/F2]:vE?[DK/vE,IK/vE]:[NaN,NaN];return DK=IK=vE=VP=jP=F2=NK=MK=yE=0,e}};function tb(e,t){DK+=e,IK+=t,++vE}function G1e(){Sc.point=kKt}function kKt(e,t){Sc.point=EKt,tb(Uf=e,Wf=t)}function EKt(e,t){var n=e-Uf,r=t-Wf,i=ul(n*n+r*r);VP+=i*(Uf+e)/2,jP+=i*(Wf+t)/2,F2+=i,tb(Uf=e,Wf=t)}function Y1e(){Sc.point=tb}function AKt(){Sc.point=DKt}function TKt(){a6e(i6e,s6e)}function DKt(e,t){Sc.point=a6e,tb(i6e=Uf=e,s6e=Wf=t)}function a6e(e,t){var n=e-Uf,r=t-Wf,i=ul(n*n+r*r);VP+=i*(Uf+e)/2,jP+=i*(Wf+t)/2,F2+=i,i=Wf*e-Uf*t,NK+=i*(Uf+e),MK+=i*(Wf+t),yE+=i*3,tb(Uf=e,Wf=t)}const X1e=Sc;function o6e(e){this._context=e}o6e.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Yl);break}}},result:bu};var FK=new eb,_H,l6e,u6e,bE,xE,HP={point:bu,lineStart:function(){HP.point=IKt},lineEnd:function(){_H&&c6e(l6e,u6e),HP.point=bu},polygonStart:function(){_H=!0},polygonEnd:function(){_H=null},result:function(){var e=+FK;return FK=new eb,e}};function IKt(e,t){HP.point=c6e,l6e=bE=e,u6e=xE=t}function c6e(e,t){bE-=e,xE-=t,FK.add(ul(bE*bE+xE*xE)),bE=e,xE=t}const K1e=HP;let Z1e,qP,Q1e,J1e;class eye{constructor(t){this._append=t==null?f6e:NKt(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==Q1e||this._append!==qP){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,Q1e=r,qP=this._append,J1e=this._,this._=i}this._+=J1e;break}}}result(){const t=this._;return this._="",t.length?t:null}}function f6e(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function NKt(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return f6e;if(t!==Z1e){const n=10**t;Z1e=t,qP=function(i){let s=1;this._+=i[0];for(const a=i.length;s<a;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return qP}function h6e(e,t){let n=3,r=4.5,i,s;function a(o){return o&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),_2(o,i(s))),s.result()}return a.area=function(o){return _2(o,i(q1e)),q1e.result()},a.measure=function(o){return _2(o,i(K1e)),K1e.result()},a.bounds=function(o){return _2(o,i(WP)),WP.result()},a.centroid=function(o){return _2(o,i(X1e)),X1e.result()},a.projection=function(o){return arguments.length?(i=o==null?(e=null,n3):(e=o).stream,a):e},a.context=function(o){return arguments.length?(s=o==null?(t=null,new eye(n)):new o6e(t=o),typeof r!="function"&&s.pointRadius(r),a):t},a.pointRadius=function(o){return arguments.length?(r=typeof o=="function"?o:(s.pointRadius(+o),+o),a):r},a.digits=function(o){if(!arguments.length)return n;if(o==null)n=null;else{const l=Math.floor(o);if(!(l>=0))throw new RangeError(`invalid digits: ${o}`);n=l}return t===null&&(s=new eye(n)),a},a.projection(e).digits(n).context(t)}function M9(e){return function(t){var n=new OK;for(var r in e)n[r]=e[r];return n.stream=t,n}}function OK(){}OK.prototype={constructor:OK,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function qse(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),_2(n,e.stream(WP)),t(WP.result()),r!=null&&e.clipExtent(r),e}function F9(e,t,n){return qse(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),o=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(s-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,l])},n)}function Gse(e,t,n){return F9(e,[[0,0],t],n)}function Yse(e,t,n){return qse(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),a=(i-s*(r[1][0]+r[0][0]))/2,o=-s*r[0][1];e.scale(150*s).translate([a,o])},n)}function Xse(e,t,n){return qse(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),a=-s*r[0][0],o=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,o])},n)}var tye=16,MKt=Lt(30*Pr);function nye(e,t){return+t?OKt(e,t):FKt(e)}function FKt(e){return M9({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function OKt(e,t){function n(r,i,s,a,o,l,u,c,f,h,d,p,g,m){var v=u-r,y=c-i,b=v*v+y*y;if(b>4*t&&g--){var x=a+h,w=o+d,C=l+p,$=ul(x*x+w*w+C*C),_=Lu(C/=$),k=Pn(Pn(C)-1)<Nt||Pn(s-f)<Nt?(s+f)/2:Wp(w,x),E=e(k,_),S=E[0],I=E[1],A=S-r,D=I-i,T=y*A-v*D;(T*T/b>t||Pn((v*A+y*D)/b-.5)>.3||a*h+o*d+l*p<MKt)&&(n(r,i,s,a,o,l,S,I,k,x/=$,w/=$,C,g,m),m.point(S,I),n(S,I,k,x,w,C,u,c,f,h,d,p,g,m))}}return function(r){var i,s,a,o,l,u,c,f,h,d,p,g,m={point:v,lineStart:y,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=y}};function v(_,k){_=e(_,k),r.point(_[0],_[1])}function y(){f=NaN,m.point=b,r.lineStart()}function b(_,k){var E=f$([_,k]),S=e(_,k);n(f,h,c,d,p,g,f=S[0],h=S[1],c=_,d=E[0],p=E[1],g=E[2],tye,r),r.point(f,h)}function x(){m.point=v,r.lineEnd()}function w(){y(),m.point=C,m.lineEnd=$}function C(_,k){b(i=_,k),s=f,a=h,o=d,l=p,u=g,m.point=b}function $(){n(f,h,c,d,p,g,s,a,i,o,l,u,tye,r),m.lineEnd=x,x()}return m}}var RKt=M9({point:function(e,t){this.stream.point(e*Pr,t*Pr)}});function PKt(e){return M9({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function LKt(e,t,n,r,i){function s(a,o){return a*=r,o*=i,[t+e*a,n-e*o]}return s.invert=function(a,o){return[(a-t)/e*r,(n-o)/e*i]},s}function rye(e,t,n,r,i,s){if(!s)return LKt(e,t,n,r,i);var a=Lt(s),o=Dt(s),l=a*e,u=o*e,c=a/e,f=o/e,h=(o*n-a*t)/e,d=(o*t+a*n)/e;function p(g,m){return g*=r,m*=i,[l*g-u*m+t,n-u*g-l*m]}return p.invert=function(g,m){return[r*(c*g-f*m+h),i*(d-f*g-c*m)]},p}function cg(e){return d6e(function(){return e})()}function d6e(e){var t,n=150,r=480,i=250,s=0,a=0,o=0,l=0,u=0,c,f=0,h=1,d=1,p=null,g=H1e,m=null,v,y,b,x=n3,w=.5,C,$,_,k,E;function S(T){return _(T[0]*Pr,T[1]*Pr)}function I(T){return T=_.invert(T[0],T[1]),T&&[T[0]*aa,T[1]*aa]}S.stream=function(T){return k&&E===T?k:k=RKt(PKt(c)(g(C(x(E=T)))))},S.preclip=function(T){return arguments.length?(g=T,p=void 0,D()):g},S.postclip=function(T){return arguments.length?(x=T,m=v=y=b=null,D()):x},S.clipAngle=function(T){return arguments.length?(g=+T?bKt(p=T*Pr):(p=null,H1e),D()):p*aa},S.clipExtent=function(T){return arguments.length?(x=T==null?(m=v=y=b=null,n3):e6e(m=+T[0][0],v=+T[0][1],y=+T[1][0],b=+T[1][1]),D()):m==null?null:[[m,v],[y,b]]},S.scale=function(T){return arguments.length?(n=+T,A()):n},S.translate=function(T){return arguments.length?(r=+T[0],i=+T[1],A()):[r,i]},S.center=function(T){return arguments.length?(s=T[0]%360*Pr,a=T[1]%360*Pr,A()):[s*aa,a*aa]},S.rotate=function(T){return arguments.length?(o=T[0]%360*Pr,l=T[1]%360*Pr,u=T.length>2?T[2]%360*Pr:0,A()):[o*aa,l*aa,u*aa]},S.angle=function(T){return arguments.length?(f=T%360*Pr,A()):f*aa},S.reflectX=function(T){return arguments.length?(h=T?-1:1,A()):h<0},S.reflectY=function(T){return arguments.length?(d=T?-1:1,A()):d<0},S.precision=function(T){return arguments.length?(C=nye($,w=T*T),D()):ul(w)},S.fitExtent=function(T,N){return F9(S,T,N)},S.fitSize=function(T,N){return Gse(S,T,N)},S.fitWidth=function(T,N){return Yse(S,T,N)},S.fitHeight=function(T,N){return Xse(S,T,N)};function A(){var T=rye(n,0,0,h,d,f).apply(null,t(s,a)),N=rye(n,r-T[0],i-T[1],h,d,f);return c=KLe(o,l,u),$=SK(t,N),_=SK(c,$),C=nye($,w),D()}function D(){return k=E=null,S}return function(){return t=e.apply(this,arguments),S.invert=t.invert&&I,A()}}function Kse(e){var t=0,n=Yt/3,r=d6e(e),i=r(t,n);return i.parallels=function(s){return arguments.length?r(t=s[0]*Pr,n=s[1]*Pr):[t*aa,n*aa]},i}function BKt(e){var t=Lt(e);function n(r,i){return[r*t,Dt(i)/t]}return n.invert=function(r,i){return[r/t,Lu(i*t)]},n}function zKt(e,t){var n=Dt(e),r=(n+Dt(t))/2;if(Pn(r)<Nt)return BKt(e);var i=1+n*(2*r-n),s=ul(i)/r;function a(o,l){var u=ul(i-2*r*Dt(l))/r;return[u*Dt(o*=r),s-u*Lt(o)]}return a.invert=function(o,l){var u=s-l,c=Wp(o,Pn(u))*yu(u);return u*r<0&&(c-=Yt*yu(o)*yu(u)),[c/r,Lu((i-(o*o+u*u)*r*r)/(2*r))]},a}function GP(){return Kse(zKt).scale(155.424).center([0,33.6442])}function p6e(){return GP().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function UKt(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function WKt(){var e,t,n=p6e(),r,i=GP().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,a=GP().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o,l,u={point:function(h,d){l=[h,d]}};function c(h){var d=h[0],p=h[1];return l=null,r.point(d,p),l||(s.point(d,p),l)||(o.point(d,p),l)}c.invert=function(h){var d=n.scale(),p=n.translate(),g=(h[0]-p[0])/d,m=(h[1]-p[1])/d;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?a:n).invert(h)},c.stream=function(h){return e&&t===h?e:e=UKt([n.stream(t=h),i.stream(h),a.stream(h)])},c.precision=function(h){return arguments.length?(n.precision(h),i.precision(h),a.precision(h),f()):n.precision()},c.scale=function(h){return arguments.length?(n.scale(h),i.scale(h*.35),a.scale(h),c.translate(n.translate())):n.scale()},c.translate=function(h){if(!arguments.length)return n.translate();var d=n.scale(),p=+h[0],g=+h[1];return r=n.translate(h).clipExtent([[p-.455*d,g-.238*d],[p+.455*d,g+.238*d]]).stream(u),s=i.translate([p-.307*d,g+.201*d]).clipExtent([[p-.425*d+Nt,g+.12*d+Nt],[p-.214*d-Nt,g+.234*d-Nt]]).stream(u),o=a.translate([p-.205*d,g+.212*d]).clipExtent([[p-.214*d+Nt,g+.166*d+Nt],[p-.115*d-Nt,g+.234*d-Nt]]).stream(u),f()},c.fitExtent=function(h,d){return F9(c,h,d)},c.fitSize=function(h,d){return Gse(c,h,d)},c.fitWidth=function(h,d){return Yse(c,h,d)},c.fitHeight=function(h,d){return Xse(c,h,d)};function f(){return e=t=null,c}return c.scale(1070)}function g6e(e){return function(t,n){var r=Lt(t),i=Lt(n),s=e(r*i);return s===1/0?[2,0]:[s*i*Dt(t),s*Dt(n)]}}function gM(e){return function(t,n){var r=ul(t*t+n*n),i=e(r),s=Dt(i),a=Lt(i);return[Wp(t*s,r*a),Lu(r&&n*s/r)]}}var m6e=g6e(function(e){return ul(2/(1+e))});m6e.invert=gM(function(e){return 2*Lu(e/2)});function VKt(){return cg(m6e).scale(124.75).clipAngle(180-.001)}var v6e=g6e(function(e){return(e=XLe(e))&&e/Dt(e)});v6e.invert=gM(function(e){return e});function jKt(){return cg(v6e).scale(79.4188).clipAngle(180-.001)}function O9(e,t){return[e,PP(Hse((Gr+t)/2))]}O9.invert=function(e,t){return[e,2*H_(YLe(t))-Gr]};function HKt(){return y6e(O9).scale(961/Yl)}function y6e(e){var t=cg(e),n=t.center,r=t.scale,i=t.translate,s=t.clipExtent,a=null,o,l,u;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=o=l=u=null:(a=+f[0][0],o=+f[0][1],l=+f[1][0],u=+f[1][1]),c()):a==null?null:[[a,o],[l,u]]};function c(){var f=Yt*r(),h=t(fKt(t.rotate()).invert([0,0]));return s(a==null?[[h[0]-f,h[1]-f],[h[0]+f,h[1]+f]]:e===O9?[[Math.max(h[0]-f,a),o],[Math.min(h[0]+f,l),u]]:[[a,Math.max(h[1]-f,o)],[l,Math.min(h[1]+f,u)]])}return c()}function WO(e){return Hse((Gr+e)/2)}function qKt(e,t){var n=Lt(e),r=e===t?Dt(e):PP(n/Lt(t))/PP(WO(t)/WO(e)),i=n*xH(WO(e),r)/r;if(!r)return O9;function s(a,o){i>0?o<-Gr+Nt&&(o=-Gr+Nt):o>Gr-Nt&&(o=Gr-Nt);var l=i/xH(WO(o),r);return[l*Dt(r*a),i-l*Lt(r*a)]}return s.invert=function(a,o){var l=i-o,u=yu(r)*ul(a*a+l*l),c=Wp(a,Pn(l))*yu(l);return l*r<0&&(c-=Yt*yu(a)*yu(l)),[c/r,2*H_(xH(i/u,1/r))-Gr]},s}function GKt(){return Kse(qKt).scale(109.5).parallels([30,30])}function YP(e,t){return[e,t]}YP.invert=YP;function YKt(){return cg(YP).scale(152.63)}function XKt(e,t){var n=Lt(e),r=e===t?Dt(e):(n-Lt(t))/(t-e),i=n/r+e;if(Pn(r)<Nt)return YP;function s(a,o){var l=i-o,u=r*a;return[l*Dt(u),i-l*Lt(u)]}return s.invert=function(a,o){var l=i-o,u=Wp(a,Pn(l))*yu(l);return l*r<0&&(u-=Yt*yu(a)*yu(l)),[u/r,i-yu(r)*ul(a*a+l*l)]},s}function KKt(){return Kse(XKt).scale(131.154).center([0,13.9389])}var hA=1.340264,dA=-.081106,pA=893e-6,gA=.003796,XP=ul(3)/2,ZKt=12;function b6e(e,t){var n=Lu(XP*Dt(t)),r=n*n,i=r*r*r;return[e*Lt(n)/(XP*(hA+3*dA*r+i*(7*pA+9*gA*r))),n*(hA+dA*r+i*(pA+gA*r))]}b6e.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,s=0,a,o,l;s<ZKt&&(o=n*(hA+dA*r+i*(pA+gA*r))-t,l=hA+3*dA*r+i*(7*pA+9*gA*r),n-=a=o/l,r=n*n,i=r*r*r,!(Pn(a)<GLe));++s);return[XP*e*(hA+3*dA*r+i*(7*pA+9*gA*r))/Lt(n),Lu(Dt(n)/XP)]};function QKt(){return cg(b6e).scale(177.158)}function x6e(e,t){var n=Lt(t),r=Lt(e)*n;return[n*Dt(e)/r,Dt(t)/r]}x6e.invert=gM(H_);function JKt(){return cg(x6e).scale(144.049).clipAngle(60)}function eZt(){var e=1,t=0,n=0,r=1,i=1,s=0,a,o,l=null,u,c,f,h=1,d=1,p=M9({point:function(x,w){var C=b([x,w]);this.stream.point(C[0],C[1])}}),g=n3,m,v;function y(){return h=e*r,d=e*i,m=v=null,b}function b(x){var w=x[0]*h,C=x[1]*d;if(s){var $=C*a-w*o;w=w*a+C*o,C=$}return[w+t,C+n]}return b.invert=function(x){var w=x[0]-t,C=x[1]-n;if(s){var $=C*a+w*o;w=w*a-C*o,C=$}return[w/h,C/d]},b.stream=function(x){return m&&v===x?m:m=p(g(v=x))},b.postclip=function(x){return arguments.length?(g=x,l=u=c=f=null,y()):g},b.clipExtent=function(x){return arguments.length?(g=x==null?(l=u=c=f=null,n3):e6e(l=+x[0][0],u=+x[0][1],c=+x[1][0],f=+x[1][1]),y()):l==null?null:[[l,u],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,y()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],y()):[t,n]},b.angle=function(x){return arguments.length?(s=x%360*Pr,o=Dt(s),a=Lt(s),y()):s*aa},b.reflectX=function(x){return arguments.length?(r=x?-1:1,y()):r<0},b.reflectY=function(x){return arguments.length?(i=x?-1:1,y()):i<0},b.fitExtent=function(x,w){return F9(b,x,w)},b.fitSize=function(x,w){return Gse(b,x,w)},b.fitWidth=function(x,w){return Yse(b,x,w)},b.fitHeight=function(x,w){return Xse(b,x,w)},b}function w6e(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}w6e.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,a=s*s;n-=i=(n*(1.007226+s*(.015085+a*(-.044475+.028874*s-.005916*a)))-t)/(1.007226+s*(.015085*3+a*(-.044475*7+.028874*9*s-.005916*11*a)))}while(Pn(i)>Nt&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function tZt(){return cg(w6e).scale(175.295)}function $6e(e,t){return[Lt(t)*Dt(e),Dt(t)]}$6e.invert=gM(Lu);function nZt(){return cg($6e).scale(249.5).clipAngle(90+Nt)}function C6e(e,t){var n=Lt(t),r=1+Lt(e)*n;return[n*Dt(e)/r,Dt(t)/r]}C6e.invert=gM(function(e){return 2*H_(e)});function rZt(){return cg(C6e).scale(250).clipAngle(142)}function _6e(e,t){return[PP(Hse((Gr+t)/2)),-e]}_6e.invert=function(e,t){return[-t,2*H_(YLe(e))-Gr]};function iZt(){var e=y6e(_6e),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}class sZt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],a=t+s,o=Math.abs(t)<Math.abs(s)?t-(a-s):s-(a-t);o&&(n[r++]=o),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,s=i-(a-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=a+i,i==r-a&&(a=r))}return a}}function*aZt(e){for(const t of e)yield*t}function S6e(e){return Array.from(aZt(e))}var ar=1e-6,oZt=1e-12,hn=Math.PI,xu=hn/2,iye=hn/4,tf=hn*2,Dd=180/hn,wl=hn/180,Kr=Math.abs,lZt=Math.atan,i3=Math.atan2,ii=Math.cos,si=Math.sin,uZt=Math.sign||function(e){return e>0?1:e<0?-1:0},R9=Math.sqrt;function cZt(e){return e>1?0:e<-1?hn:Math.acos(e)}function s3(e){return e>1?xu:e<-1?-xu:Math.asin(e)}function wE(){}function KP(e,t){e&&aye.hasOwnProperty(e.type)&&aye[e.type](e,t)}var sye={Feature:function(e,t){KP(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)KP(n[r].geometry,t)}},aye={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){RK(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)RK(n[r],t,0)},Polygon:function(e,t){oye(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)oye(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)KP(n[r],t)}};function RK(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function oye(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)RK(e[n],t,1);t.polygonEnd()}function fZt(e,t){e&&sye.hasOwnProperty(e.type)?sye[e.type](e,t):KP(e,t)}function PK(e){return[i3(e[1],e[0]),s3(e[2])]}function d$(e){var t=e[0],n=e[1],r=ii(n);return[r*ii(t),r*si(t),si(n)]}function VO(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ZP(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function SH(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function jO(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function LK(e){var t=R9(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function BK(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function zK(e,t){return Kr(e)>hn&&(e-=Math.round(e/tf)*tf),[e,t]}zK.invert=zK;function hZt(e,t,n){return(e%=tf)?t||n?BK(uye(e),cye(t,n)):uye(e):t||n?cye(t,n):zK}function lye(e){return function(t,n){return t+=e,Kr(t)>hn&&(t-=Math.round(t/tf)*tf),[t,n]}}function uye(e){var t=lye(e);return t.invert=lye(-e),t}function cye(e,t){var n=ii(e),r=si(e),i=ii(t),s=si(t);function a(o,l){var u=ii(l),c=ii(o)*u,f=si(o)*u,h=si(l),d=h*n+c*r;return[i3(f*i-d*s,c*n-h*r),s3(d*i+f*s)]}return a.invert=function(o,l){var u=ii(l),c=ii(o)*u,f=si(o)*u,h=si(l),d=h*i-f*s;return[i3(f*i+h*s,c*n+d*r),s3(d*n-c*r)]},a}function dZt(e,t,n,r,i,s){if(!!n){var a=ii(t),o=si(t),l=r*n;i==null?(i=t+r*tf,s=t-l/2):(i=fye(a,i),s=fye(a,s),(r>0?i<s:i>s)&&(i+=r*tf));for(var u,c=i;r>0?c>s:c<s;c-=l)u=PK([a,-o*ii(c),-o*si(c)]),e.point(u[0],u[1])}}function fye(e,t){t=d$(t),t[0]-=e,LK(t);var n=cZt(-t[1]);return((-t[2]<0?-n:n)+tf-ar)%tf}function k6e(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:wE,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function g4(e,t){return Kr(e[0]-t[0])<ar&&Kr(e[1]-t[1])<ar}function HO(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function E6e(e,t,n,r,i){var s=[],a=[],o,l;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],v=p[g],y;if(g4(m,v)){if(!m[2]&&!v[2]){for(i.lineStart(),o=0;o<g;++o)i.point((m=p[o])[0],m[1]);i.lineEnd();return}v[0]+=2*ar}s.push(y=new HO(m,p,null,!0)),a.push(y.o=new HO(m,null,y,!1)),s.push(y=new HO(v,p,null,!1)),a.push(y.o=new HO(v,null,y,!0))}}),!!s.length){for(a.sort(t),hye(s),hye(a),o=0,l=a.length;o<l;++o)a[o].e=n=!n;for(var u=s[0],c,f;;){for(var h=u,d=!0;h.v;)if((h=h.n)===u)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,l=c.length;o<l;++o)i.point((f=c[o])[0],f[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(c=h.p.z,o=c.length-1;o>=0;--o)i.point((f=c[o])[0],f[1]);else r(h.x,h.p.x,-1,i);h=h.p}h=h.o,c=h.z,d=!d}while(!h.v);i.lineEnd()}}}function hye(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function kH(e){return Kr(e[0])<=hn?e[0]:uZt(e[0])*((Kr(e[0])+hn)%tf-hn)}function pZt(e,t){var n=kH(t),r=t[1],i=si(r),s=[si(n),-ii(n),0],a=0,o=0,l=new sZt;i===1?r=xu+ar:i===-1&&(r=-xu-ar);for(var u=0,c=e.length;u<c;++u)if(!!(h=(f=e[u]).length))for(var f,h,d=f[h-1],p=kH(d),g=d[1]/2+iye,m=si(g),v=ii(g),y=0;y<h;++y,p=x,m=C,v=$,d=b){var b=f[y],x=kH(b),w=b[1]/2+iye,C=si(w),$=ii(w),_=x-p,k=_>=0?1:-1,E=k*_,S=E>hn,I=m*C;if(l.add(i3(I*k*si(E),v*$+I*ii(E))),a+=S?_+k*tf:_,S^p>=n^x>=n){var A=ZP(d$(d),d$(b));LK(A);var D=ZP(s,A);LK(D);var T=(S^_>=0?-1:1)*s3(D[2]);(r>T||r===T&&(A[0]||A[1]))&&(o+=S^_>=0?1:-1)}}return(a<-ar||a<ar&&l<-oZt)^o&1}function A6e(e,t,n,r){return function(i){var s=t(i),a=k6e(),o=t(a),l=!1,u,c,f,h={point:d,lineStart:g,lineEnd:m,polygonStart:function(){h.point=v,h.lineStart=y,h.lineEnd=b,c=[],u=[]},polygonEnd:function(){h.point=d,h.lineStart=g,h.lineEnd=m,c=S6e(c);var x=pZt(u,r);c.length?(l||(i.polygonStart(),l=!0),E6e(c,mZt,x,n,i)):x&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),c=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(x,w){e(x,w)&&i.point(x,w)}function p(x,w){s.point(x,w)}function g(){h.point=p,s.lineStart()}function m(){h.point=d,s.lineEnd()}function v(x,w){f.push([x,w]),o.point(x,w)}function y(){o.lineStart(),f=[]}function b(){v(f[0][0],f[0][1]),o.lineEnd();var x=o.clean(),w=a.result(),C,$=w.length,_,k,E;if(f.pop(),u.push(f),f=null,!!$){if(x&1){if(k=w[0],(_=k.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),C=0;C<_;++C)i.point((E=k[C])[0],E[1]);i.lineEnd()}return}$>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(gZt))}}return h}}function gZt(e){return e.length>1}function mZt(e,t){return((e=e.x)[0]<0?e[1]-xu-ar:xu-e[1])-((t=t.x)[0]<0?t[1]-xu-ar:xu-t[1])}const dye=A6e(function(){return!0},vZt,bZt,[-hn,-xu]);function vZt(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,a){var o=s>0?hn:-hn,l=Kr(s-t);Kr(l-hn)<ar?(e.point(t,n=(n+a)/2>0?xu:-xu),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(s,n),i=0):r!==o&&l>=hn&&(Kr(t-r)<ar&&(t-=r*ar),Kr(s-o)<ar&&(s-=o*ar),n=yZt(t,n,s,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),i=0),e.point(t=s,n=a),r=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function yZt(e,t,n,r){var i,s,a=si(e-n);return Kr(a)>ar?lZt((si(t)*(s=ii(r))*si(n)-si(r)*(i=ii(t))*si(e))/(i*s*a)):(t+r)/2}function bZt(e,t,n,r){var i;if(e==null)i=n*xu,r.point(-hn,i),r.point(0,i),r.point(hn,i),r.point(hn,0),r.point(hn,-i),r.point(0,-i),r.point(-hn,-i),r.point(-hn,0),r.point(-hn,i);else if(Kr(e[0]-t[0])>ar){var s=e[0]<t[0]?hn:-hn;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function xZt(e){var t=ii(e),n=6*wl,r=t>0,i=Kr(t)>ar;function s(c,f,h,d){dZt(d,e,n,h,c,f)}function a(c,f){return ii(c)*ii(f)>t}function o(c){var f,h,d,p,g;return{lineStart:function(){p=d=!1,g=1},point:function(m,v){var y=[m,v],b,x=a(m,v),w=r?x?0:u(m,v):x?u(m+(m<0?hn:-hn),v):0;if(!f&&(p=d=x)&&c.lineStart(),x!==d&&(b=l(f,y),(!b||g4(f,b)||g4(y,b))&&(y[2]=1)),x!==d)g=0,x?(c.lineStart(),b=l(y,f),c.point(b[0],b[1])):(b=l(f,y),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var C;!(w&h)&&(C=l(y,f,!0))&&(g=0,r?(c.lineStart(),c.point(C[0][0],C[0][1]),c.point(C[1][0],C[1][1]),c.lineEnd()):(c.point(C[1][0],C[1][1]),c.lineEnd(),c.lineStart(),c.point(C[0][0],C[0][1],3)))}x&&(!f||!g4(f,y))&&c.point(y[0],y[1]),f=y,d=x,h=w},lineEnd:function(){d&&c.lineEnd(),f=null},clean:function(){return g|(p&&d)<<1}}}function l(c,f,h){var d=d$(c),p=d$(f),g=[1,0,0],m=ZP(d,p),v=VO(m,m),y=m[0],b=v-y*y;if(!b)return!h&&c;var x=t*v/b,w=-t*y/b,C=ZP(g,m),$=jO(g,x),_=jO(m,w);SH($,_);var k=C,E=VO($,k),S=VO(k,k),I=E*E-S*(VO($,$)-1);if(!(I<0)){var A=R9(I),D=jO(k,(-E-A)/S);if(SH(D,$),D=PK(D),!h)return D;var T=c[0],N=f[0],F=c[1],R=f[1],P;N<T&&(P=T,T=N,N=P);var V=N-T,z=Kr(V-hn)<ar,q=z||V<ar;if(!z&&R<F&&(P=F,F=R,R=P),q?z?F+R>0^D[1]<(Kr(D[0]-T)<ar?F:R):F<=D[1]&&D[1]<=R:V>hn^(T<=D[0]&&D[0]<=N)){var G=jO(k,(-E+A)/S);return SH(G,$),[D,PK(G)]}}}function u(c,f){var h=r?e:hn-e,d=0;return c<-h?d|=1:c>h&&(d|=2),f<-h?d|=4:f>h&&(d|=8),d}return A6e(a,o,s,r?[0,-e]:[-hn,e-hn])}function wZt(e,t,n,r,i,s){var a=e[0],o=e[1],l=t[0],u=t[1],c=0,f=1,h=l-a,d=u-o,p;if(p=n-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=i-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}if(p=r-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=s-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=a+c*h,e[1]=o+c*d),f<1&&(t[0]=a+f*h,t[1]=o+f*d),!0}}}}}var $E=1e9,qO=-$E;function $Zt(e,t,n,r){function i(u,c){return e<=u&&u<=n&&t<=c&&c<=r}function s(u,c,f,h){var d=0,p=0;if(u==null||(d=a(u,f))!==(p=a(c,f))||l(u,c)<0^f>0)do h.point(d===0||d===3?e:n,d>1?r:t);while((d=(d+f+4)%4)!==p);else h.point(c[0],c[1])}function a(u,c){return Kr(u[0]-e)<ar?c>0?0:3:Kr(u[0]-n)<ar?c>0?2:1:Kr(u[1]-t)<ar?c>0?1:0:c>0?3:2}function o(u,c){return l(u.x,c.x)}function l(u,c){var f=a(u,1),h=a(c,1);return f!==h?f-h:f===0?c[1]-u[1]:f===1?u[0]-c[0]:f===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,f=k6e(),h,d,p,g,m,v,y,b,x,w,C,$={point:_,lineStart:I,lineEnd:A,polygonStart:E,polygonEnd:S};function _(T,N){i(T,N)&&c.point(T,N)}function k(){for(var T=0,N=0,F=d.length;N<F;++N)for(var R=d[N],P=1,V=R.length,z=R[0],q,G,K=z[0],Y=z[1];P<V;++P)q=K,G=Y,z=R[P],K=z[0],Y=z[1],G<=r?Y>r&&(K-q)*(r-G)>(Y-G)*(e-q)&&++T:Y<=r&&(K-q)*(r-G)<(Y-G)*(e-q)&&--T;return T}function E(){c=f,h=[],d=[],C=!0}function S(){var T=k(),N=C&&T,F=(h=S6e(h)).length;(N||F)&&(u.polygonStart(),N&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),F&&E6e(h,o,T,s,u),u.polygonEnd()),c=u,h=d=p=null}function I(){$.point=D,d&&d.push(p=[]),w=!0,x=!1,y=b=NaN}function A(){h&&(D(g,m),v&&x&&f.rejoin(),h.push(f.result())),$.point=_,x&&c.lineEnd()}function D(T,N){var F=i(T,N);if(d&&p.push([T,N]),w)g=T,m=N,v=F,w=!1,F&&(c.lineStart(),c.point(T,N));else if(F&&x)c.point(T,N);else{var R=[y=Math.max(qO,Math.min($E,y)),b=Math.max(qO,Math.min($E,b))],P=[T=Math.max(qO,Math.min($E,T)),N=Math.max(qO,Math.min($E,N))];wZt(R,P,e,t,n,r)?(x||(c.lineStart(),c.point(R[0],R[1])),c.point(P[0],P[1]),F||c.lineEnd(),C=!1):F&&(c.lineStart(),c.point(T,N),C=!1)}y=T,b=N,x=F}return $}}const pye=e=>e;var p$=1/0,QP=p$,a3=-p$,JP=a3,CZt={point:_Zt,lineStart:wE,lineEnd:wE,polygonStart:wE,polygonEnd:wE,result:function(){var e=[[p$,QP],[a3,JP]];return a3=JP=-(QP=p$=1/0),e}};function _Zt(e,t){e<p$&&(p$=e),e>a3&&(a3=e),t<QP&&(QP=t),t>JP&&(JP=t)}const gye=CZt;function Zse(e){return function(t){var n=new UK;for(var r in e)n[r]=e[r];return n.stream=t,n}}function UK(){}UK.prototype={constructor:UK,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Qse(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),fZt(n,e.stream(gye)),t(gye.result()),r!=null&&e.clipExtent(r),e}function T6e(e,t,n){return Qse(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),o=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(s-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,l])},n)}function SZt(e,t,n){return T6e(e,[[0,0],t],n)}function kZt(e,t,n){return Qse(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),a=(i-s*(r[1][0]+r[0][0]))/2,o=-s*r[0][1];e.scale(150*s).translate([a,o])},n)}function EZt(e,t,n){return Qse(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),a=-s*r[0][0],o=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,o])},n)}var mye=16,AZt=ii(30*wl);function vye(e,t){return+t?DZt(e,t):TZt(e)}function TZt(e){return Zse({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function DZt(e,t){function n(r,i,s,a,o,l,u,c,f,h,d,p,g,m){var v=u-r,y=c-i,b=v*v+y*y;if(b>4*t&&g--){var x=a+h,w=o+d,C=l+p,$=R9(x*x+w*w+C*C),_=s3(C/=$),k=Kr(Kr(C)-1)<ar||Kr(s-f)<ar?(s+f)/2:i3(w,x),E=e(k,_),S=E[0],I=E[1],A=S-r,D=I-i,T=y*A-v*D;(T*T/b>t||Kr((v*A+y*D)/b-.5)>.3||a*h+o*d+l*p<AZt)&&(n(r,i,s,a,o,l,S,I,k,x/=$,w/=$,C,g,m),m.point(S,I),n(S,I,k,x,w,C,u,c,f,h,d,p,g,m))}}return function(r){var i,s,a,o,l,u,c,f,h,d,p,g,m={point:v,lineStart:y,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=y}};function v(_,k){_=e(_,k),r.point(_[0],_[1])}function y(){f=NaN,m.point=b,r.lineStart()}function b(_,k){var E=d$([_,k]),S=e(_,k);n(f,h,c,d,p,g,f=S[0],h=S[1],c=_,d=E[0],p=E[1],g=E[2],mye,r),r.point(f,h)}function x(){m.point=v,r.lineEnd()}function w(){y(),m.point=C,m.lineEnd=$}function C(_,k){b(i=_,k),s=f,a=h,o=d,l=p,u=g,m.point=b}function $(){n(f,h,c,d,p,g,s,a,i,o,l,u,mye,r),m.lineEnd=x,x()}return m}}var IZt=Zse({point:function(e,t){this.stream.point(e*wl,t*wl)}});function NZt(e){return Zse({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function MZt(e,t,n,r,i){function s(a,o){return a*=r,o*=i,[t+e*a,n-e*o]}return s.invert=function(a,o){return[(a-t)/e*r,(n-o)/e*i]},s}function yye(e,t,n,r,i,s){if(!s)return MZt(e,t,n,r,i);var a=ii(s),o=si(s),l=a*e,u=o*e,c=a/e,f=o/e,h=(o*n-a*t)/e,d=(o*t+a*n)/e;function p(g,m){return g*=r,m*=i,[l*g-u*m+t,n-u*g-l*m]}return p.invert=function(g,m){return[r*(c*g-f*m+h),i*(d-f*g-c*m)]},p}function FZt(e){return OZt(function(){return e})()}function OZt(e){var t,n=150,r=480,i=250,s=0,a=0,o=0,l=0,u=0,c,f=0,h=1,d=1,p=null,g=dye,m=null,v,y,b,x=pye,w=.5,C,$,_,k,E;function S(T){return _(T[0]*wl,T[1]*wl)}function I(T){return T=_.invert(T[0],T[1]),T&&[T[0]*Dd,T[1]*Dd]}S.stream=function(T){return k&&E===T?k:k=IZt(NZt(c)(g(C(x(E=T)))))},S.preclip=function(T){return arguments.length?(g=T,p=void 0,D()):g},S.postclip=function(T){return arguments.length?(x=T,m=v=y=b=null,D()):x},S.clipAngle=function(T){return arguments.length?(g=+T?xZt(p=T*wl):(p=null,dye),D()):p*Dd},S.clipExtent=function(T){return arguments.length?(x=T==null?(m=v=y=b=null,pye):$Zt(m=+T[0][0],v=+T[0][1],y=+T[1][0],b=+T[1][1]),D()):m==null?null:[[m,v],[y,b]]},S.scale=function(T){return arguments.length?(n=+T,A()):n},S.translate=function(T){return arguments.length?(r=+T[0],i=+T[1],A()):[r,i]},S.center=function(T){return arguments.length?(s=T[0]%360*wl,a=T[1]%360*wl,A()):[s*Dd,a*Dd]},S.rotate=function(T){return arguments.length?(o=T[0]%360*wl,l=T[1]%360*wl,u=T.length>2?T[2]%360*wl:0,A()):[o*Dd,l*Dd,u*Dd]},S.angle=function(T){return arguments.length?(f=T%360*wl,A()):f*Dd},S.reflectX=function(T){return arguments.length?(h=T?-1:1,A()):h<0},S.reflectY=function(T){return arguments.length?(d=T?-1:1,A()):d<0},S.precision=function(T){return arguments.length?(C=vye($,w=T*T),D()):R9(w)},S.fitExtent=function(T,N){return T6e(S,T,N)},S.fitSize=function(T,N){return SZt(S,T,N)},S.fitWidth=function(T,N){return kZt(S,T,N)},S.fitHeight=function(T,N){return EZt(S,T,N)};function A(){var T=yye(n,0,0,h,d,f).apply(null,t(s,a)),N=yye(n,r-T[0],i-T[1],h,d,f);return c=hZt(o,l,u),$=BK(t,N),_=BK(c,$),C=vye($,w),D()}function D(){return k=E=null,S}return function(){return t=e.apply(this,arguments),S.invert=t.invert&&I,A()}}var RZt=Math.abs,WK=Math.cos,eL=Math.sin,PZt=1e-6,D6e=Math.PI,VK=D6e/2,bye=LZt(2);function xye(e){return e>1?VK:e<-1?-VK:Math.asin(e)}function LZt(e){return e>0?Math.sqrt(e):0}function BZt(e,t){var n=e*eL(t),r=30,i;do t-=i=(t+eL(t)-n)/(1+WK(t));while(RZt(i)>PZt&&--r>0);return t/2}function zZt(e,t,n){function r(i,s){return[e*i*WK(s=BZt(n,s)),t*eL(s)]}return r.invert=function(i,s){return s=xye(s/t),[i/(e*WK(s)),xye((2*s+eL(2*s))/n)]},r}var UZt=zZt(bye/VK,bye,D6e);function WZt(){return FZt(UZt).scale(169.529)}const VZt=h6e(),jK=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function jZt(e,t){return function n(){const r=t();return r.type=e,r.path=h6e().projection(r),r.copy=r.copy||function(){const i=n();return jK.forEach(s=>{r[s]&&i[s](r[s]())}),i.path.pointRadius(r.path.pointRadius()),i},N5e(r)}}function I6e(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(tL[e]=jZt(e,t),this):tL[e]||null}function N6e(e){return e&&e.path||VZt}const tL={albers:p6e,albersusa:WKt,azimuthalequalarea:VKt,azimuthalequidistant:jKt,conicconformal:GKt,conicequalarea:GP,conicequidistant:KKt,equalEarth:QKt,equirectangular:YKt,gnomonic:JKt,identity:eZt,mercator:HKt,mollweide:WZt,naturalEarth1:tZt,orthographic:nZt,stereographic:rZt,transversemercator:iZt};for(const e in tL)I6e(e,tL[e]);var lt=1e-6,nL=1e-12,jt=Math.PI,Yr=jt/2,rL=jt/4,mo=jt*2,ni=180/jt,Ht=jt/180,on=Math.abs,q_=Math.atan,Bu=Math.atan2,ft=Math.cos,GO=Math.ceil,M6e=Math.exp,HK=Math.hypot,iL=Math.log,EH=Math.pow,st=Math.sin,wu=Math.sign||function(e){return e>0?1:e<0?-1:0},vo=Math.sqrt,Jse=Math.tan;function F6e(e){return e>1?0:e<-1?jt:Math.acos(e)}function cl(e){return e>1?Yr:e<-1?-Yr:Math.asin(e)}function Fs(){}function sL(e,t){e&&$ye.hasOwnProperty(e.type)&&$ye[e.type](e,t)}var wye={Feature:function(e,t){sL(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)sL(n[r].geometry,t)}},$ye={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){qK(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)qK(n[r],t,0)},Polygon:function(e,t){Cye(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Cye(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)sL(n[r],t)}};function qK(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function Cye(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)qK(e[n],t,1);t.polygonEnd()}function Xd(e,t){e&&wye.hasOwnProperty(e.type)?wye[e.type](e,t):sL(e,t)}var aL=new lo,oL=new lo,O6e,R6e,GK,YK,XK,Lh={point:Fs,lineStart:Fs,lineEnd:Fs,polygonStart:function(){aL=new lo,Lh.lineStart=HZt,Lh.lineEnd=qZt},polygonEnd:function(){var e=+aL;oL.add(e<0?mo+e:e),this.lineStart=this.lineEnd=this.point=Fs},sphere:function(){oL.add(mo)}};function HZt(){Lh.point=GZt}function qZt(){P6e(O6e,R6e)}function GZt(e,t){Lh.point=P6e,O6e=e,R6e=t,e*=Ht,t*=Ht,GK=e,YK=ft(t=t/2+rL),XK=st(t)}function P6e(e,t){e*=Ht,t*=Ht,t=t/2+rL;var n=e-GK,r=n>=0?1:-1,i=r*n,s=ft(t),a=st(t),o=XK*a,l=YK*s+o*ft(i),u=o*r*st(i);aL.add(Bu(u,l)),GK=e,YK=s,XK=a}function YZt(e){return oL=new lo,Xd(e,Lh),oL*2}function lL(e){return[Bu(e[1],e[0]),cl(e[2])]}function nb(e){var t=e[0],n=e[1],r=ft(n);return[r*ft(t),r*st(t),st(n)]}function YO(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function g$(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function AH(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function XO(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function uL(e){var t=vo(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Or,Bo,Vr,_l,Qv,L6e,B6e,iw,mA,Og,Vp,Ud={point:KK,lineStart:_ye,lineEnd:Sye,polygonStart:function(){Ud.point=U6e,Ud.lineStart=XZt,Ud.lineEnd=KZt,mA=new lo,Lh.polygonStart()},polygonEnd:function(){Lh.polygonEnd(),Ud.point=KK,Ud.lineStart=_ye,Ud.lineEnd=Sye,aL<0?(Or=-(Vr=180),Bo=-(_l=90)):mA>lt?_l=90:mA<-lt&&(Bo=-90),Vp[0]=Or,Vp[1]=Vr},sphere:function(){Or=-(Vr=180),Bo=-(_l=90)}};function KK(e,t){Og.push(Vp=[Or=e,Vr=e]),t<Bo&&(Bo=t),t>_l&&(_l=t)}function z6e(e,t){var n=nb([e*Ht,t*Ht]);if(iw){var r=g$(iw,n),i=[r[1],-r[0],0],s=g$(i,r);uL(s),s=lL(s);var a=e-Qv,o=a>0?1:-1,l=s[0]*ni*o,u,c=on(a)>180;c^(o*Qv<l&&l<o*e)?(u=s[1]*ni,u>_l&&(_l=u)):(l=(l+360)%360-180,c^(o*Qv<l&&l<o*e)?(u=-s[1]*ni,u<Bo&&(Bo=u)):(t<Bo&&(Bo=t),t>_l&&(_l=t))),c?e<Qv?$l(Or,e)>$l(Or,Vr)&&(Vr=e):$l(e,Vr)>$l(Or,Vr)&&(Or=e):Vr>=Or?(e<Or&&(Or=e),e>Vr&&(Vr=e)):e>Qv?$l(Or,e)>$l(Or,Vr)&&(Vr=e):$l(e,Vr)>$l(Or,Vr)&&(Or=e)}else Og.push(Vp=[Or=e,Vr=e]);t<Bo&&(Bo=t),t>_l&&(_l=t),iw=n,Qv=e}function _ye(){Ud.point=z6e}function Sye(){Vp[0]=Or,Vp[1]=Vr,Ud.point=KK,iw=null}function U6e(e,t){if(iw){var n=e-Qv;mA.add(on(n)>180?n+(n>0?360:-360):n)}else L6e=e,B6e=t;Lh.point(e,t),z6e(e,t)}function XZt(){Lh.lineStart()}function KZt(){U6e(L6e,B6e),Lh.lineEnd(),on(mA)>lt&&(Or=-(Vr=180)),Vp[0]=Or,Vp[1]=Vr,iw=null}function $l(e,t){return(t-=e)<0?t+360:t}function ZZt(e,t){return e[0]-t[0]}function kye(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function QZt(e){var t,n,r,i,s,a,o;if(_l=Vr=-(Or=Bo=1/0),Og=[],Xd(e,Ud),n=Og.length){for(Og.sort(ZZt),t=1,r=Og[0],s=[r];t<n;++t)i=Og[t],kye(r,i[0])||kye(r,i[1])?($l(r[0],i[1])>$l(r[0],r[1])&&(r[1]=i[1]),$l(i[0],r[1])>$l(r[0],r[1])&&(r[0]=i[0])):s.push(r=i);for(a=-1/0,n=s.length-1,t=0,r=s[n];t<=n;r=i,++t)i=s[t],(o=$l(r[1],i[0]))>a&&(a=o,Or=i[0],Vr=r[1])}return Og=Vp=null,Or===1/0||Bo===1/0?[[NaN,NaN],[NaN,NaN]]:[[Or,Bo],[Vr,_l]]}var CE,cL,fL,hL,dL,pL,gL,mL,ZK,QK,JK,W6e,V6e,Ga,Ya,Xa,Mc={sphere:Fs,point:eae,lineStart:Eye,lineEnd:Aye,polygonStart:function(){Mc.lineStart=tQt,Mc.lineEnd=nQt},polygonEnd:function(){Mc.lineStart=Eye,Mc.lineEnd=Aye}};function eae(e,t){e*=Ht,t*=Ht;var n=ft(t);mM(n*ft(e),n*st(e),st(t))}function mM(e,t,n){++CE,fL+=(e-fL)/CE,hL+=(t-hL)/CE,dL+=(n-dL)/CE}function Eye(){Mc.point=JZt}function JZt(e,t){e*=Ht,t*=Ht;var n=ft(t);Ga=n*ft(e),Ya=n*st(e),Xa=st(t),Mc.point=eQt,mM(Ga,Ya,Xa)}function eQt(e,t){e*=Ht,t*=Ht;var n=ft(t),r=n*ft(e),i=n*st(e),s=st(t),a=Bu(vo((a=Ya*s-Xa*i)*a+(a=Xa*r-Ga*s)*a+(a=Ga*i-Ya*r)*a),Ga*r+Ya*i+Xa*s);cL+=a,pL+=a*(Ga+(Ga=r)),gL+=a*(Ya+(Ya=i)),mL+=a*(Xa+(Xa=s)),mM(Ga,Ya,Xa)}function Aye(){Mc.point=eae}function tQt(){Mc.point=rQt}function nQt(){j6e(W6e,V6e),Mc.point=eae}function rQt(e,t){W6e=e,V6e=t,e*=Ht,t*=Ht,Mc.point=j6e;var n=ft(t);Ga=n*ft(e),Ya=n*st(e),Xa=st(t),mM(Ga,Ya,Xa)}function j6e(e,t){e*=Ht,t*=Ht;var n=ft(t),r=n*ft(e),i=n*st(e),s=st(t),a=Ya*s-Xa*i,o=Xa*r-Ga*s,l=Ga*i-Ya*r,u=HK(a,o,l),c=cl(u),f=u&&-c/u;ZK.add(f*a),QK.add(f*o),JK.add(f*l),cL+=c,pL+=c*(Ga+(Ga=r)),gL+=c*(Ya+(Ya=i)),mL+=c*(Xa+(Xa=s)),mM(Ga,Ya,Xa)}function iQt(e){CE=cL=fL=hL=dL=pL=gL=mL=0,ZK=new lo,QK=new lo,JK=new lo,Xd(e,Mc);var t=+ZK,n=+QK,r=+JK,i=HK(t,n,r);return i<nL&&(t=pL,n=gL,r=mL,cL<lt&&(t=fL,n=hL,r=dL),i=HK(t,n,r),i<nL)?[NaN,NaN]:[Bu(n,t)*ni,cl(r/i)*ni]}function eZ(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function tZ(e,t){return[on(e)>jt?e+Math.round(-e/mo)*mo:e,t]}tZ.invert=tZ;function H6e(e,t,n){return(e%=mo)?t||n?eZ(Dye(e),Iye(t,n)):Dye(e):t||n?Iye(t,n):tZ}function Tye(e){return function(t,n){return t+=e,[t>jt?t-mo:t<-jt?t+mo:t,n]}}function Dye(e){var t=Tye(e);return t.invert=Tye(-e),t}function Iye(e,t){var n=ft(e),r=st(e),i=ft(t),s=st(t);function a(o,l){var u=ft(l),c=ft(o)*u,f=st(o)*u,h=st(l),d=h*n+c*r;return[Bu(f*i-d*s,c*n-h*r),cl(d*i+f*s)]}return a.invert=function(o,l){var u=ft(l),c=ft(o)*u,f=st(o)*u,h=st(l),d=h*i-f*s;return[Bu(f*i+h*s,c*n+d*r),cl(d*n-c*r)]},a}function sQt(e){e=H6e(e[0]*Ht,e[1]*Ht,e.length>2?e[2]*Ht:0);function t(n){return n=e(n[0]*Ht,n[1]*Ht),n[0]*=ni,n[1]*=ni,n}return t.invert=function(n){return n=e.invert(n[0]*Ht,n[1]*Ht),n[0]*=ni,n[1]*=ni,n},t}function aQt(e,t,n,r,i,s){if(!!n){var a=ft(t),o=st(t),l=r*n;i==null?(i=t+r*mo,s=t-l/2):(i=Nye(a,i),s=Nye(a,s),(r>0?i<s:i>s)&&(i+=r*mo));for(var u,c=i;r>0?c>s:c<s;c-=l)u=lL([a,-o*ft(c),-o*st(c)]),e.point(u[0],u[1])}}function Nye(e,t){t=nb(t),t[0]-=e,uL(t);var n=F6e(-t[1]);return((-t[2]<0?-n:n)+mo-lt)%mo}function q6e(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Fs,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function m4(e,t){return on(e[0]-t[0])<lt&&on(e[1]-t[1])<lt}function KO(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function G6e(e,t,n,r,i){var s=[],a=[],o,l;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],v=p[g],y;if(m4(m,v)){if(!m[2]&&!v[2]){for(i.lineStart(),o=0;o<g;++o)i.point((m=p[o])[0],m[1]);i.lineEnd();return}v[0]+=2*lt}s.push(y=new KO(m,p,null,!0)),a.push(y.o=new KO(m,null,y,!1)),s.push(y=new KO(v,p,null,!1)),a.push(y.o=new KO(v,null,y,!0))}}),!!s.length){for(a.sort(t),Mye(s),Mye(a),o=0,l=a.length;o<l;++o)a[o].e=n=!n;for(var u=s[0],c,f;;){for(var h=u,d=!0;h.v;)if((h=h.n)===u)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,l=c.length;o<l;++o)i.point((f=c[o])[0],f[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(c=h.p.z,o=c.length-1;o>=0;--o)i.point((f=c[o])[0],f[1]);else r(h.x,h.p.x,-1,i);h=h.p}h=h.o,c=h.z,d=!d}while(!h.v);i.lineEnd()}}}function Mye(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function TH(e){return on(e[0])<=jt?e[0]:wu(e[0])*((on(e[0])+jt)%mo-jt)}function oQt(e,t){var n=TH(t),r=t[1],i=st(r),s=[st(n),-ft(n),0],a=0,o=0,l=new lo;i===1?r=Yr+lt:i===-1&&(r=-Yr-lt);for(var u=0,c=e.length;u<c;++u)if(!!(h=(f=e[u]).length))for(var f,h,d=f[h-1],p=TH(d),g=d[1]/2+rL,m=st(g),v=ft(g),y=0;y<h;++y,p=x,m=C,v=$,d=b){var b=f[y],x=TH(b),w=b[1]/2+rL,C=st(w),$=ft(w),_=x-p,k=_>=0?1:-1,E=k*_,S=E>jt,I=m*C;if(l.add(Bu(I*k*st(E),v*$+I*ft(E))),a+=S?_+k*mo:_,S^p>=n^x>=n){var A=g$(nb(d),nb(b));uL(A);var D=g$(s,A);uL(D);var T=(S^_>=0?-1:1)*cl(D[2]);(r>T||r===T&&(A[0]||A[1]))&&(o+=S^_>=0?1:-1)}}return(a<-lt||a<lt&&l<-nL)^o&1}function Y6e(e,t,n,r){return function(i){var s=t(i),a=q6e(),o=t(a),l=!1,u,c,f,h={point:d,lineStart:g,lineEnd:m,polygonStart:function(){h.point=v,h.lineStart=y,h.lineEnd=b,c=[],u=[]},polygonEnd:function(){h.point=d,h.lineStart=g,h.lineEnd=m,c=DRe(c);var x=oQt(u,r);c.length?(l||(i.polygonStart(),l=!0),G6e(c,uQt,x,n,i)):x&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),c=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(x,w){e(x,w)&&i.point(x,w)}function p(x,w){s.point(x,w)}function g(){h.point=p,s.lineStart()}function m(){h.point=d,s.lineEnd()}function v(x,w){f.push([x,w]),o.point(x,w)}function y(){o.lineStart(),f=[]}function b(){v(f[0][0],f[0][1]),o.lineEnd();var x=o.clean(),w=a.result(),C,$=w.length,_,k,E;if(f.pop(),u.push(f),f=null,!!$){if(x&1){if(k=w[0],(_=k.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),C=0;C<_;++C)i.point((E=k[C])[0],E[1]);i.lineEnd()}return}$>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(lQt))}}return h}}function lQt(e){return e.length>1}function uQt(e,t){return((e=e.x)[0]<0?e[1]-Yr-lt:Yr-e[1])-((t=t.x)[0]<0?t[1]-Yr-lt:Yr-t[1])}const Fye=Y6e(function(){return!0},cQt,hQt,[-jt,-Yr]);function cQt(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,a){var o=s>0?jt:-jt,l=on(s-t);on(l-jt)<lt?(e.point(t,n=(n+a)/2>0?Yr:-Yr),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(s,n),i=0):r!==o&&l>=jt&&(on(t-r)<lt&&(t-=r*lt),on(s-o)<lt&&(s-=o*lt),n=fQt(t,n,s,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),i=0),e.point(t=s,n=a),r=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function fQt(e,t,n,r){var i,s,a=st(e-n);return on(a)>lt?q_((st(t)*(s=ft(r))*st(n)-st(r)*(i=ft(t))*st(e))/(i*s*a)):(t+r)/2}function hQt(e,t,n,r){var i;if(e==null)i=n*Yr,r.point(-jt,i),r.point(0,i),r.point(jt,i),r.point(jt,0),r.point(jt,-i),r.point(0,-i),r.point(-jt,-i),r.point(-jt,0),r.point(-jt,i);else if(on(e[0]-t[0])>lt){var s=e[0]<t[0]?jt:-jt;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function dQt(e){var t=ft(e),n=6*Ht,r=t>0,i=on(t)>lt;function s(c,f,h,d){aQt(d,e,n,h,c,f)}function a(c,f){return ft(c)*ft(f)>t}function o(c){var f,h,d,p,g;return{lineStart:function(){p=d=!1,g=1},point:function(m,v){var y=[m,v],b,x=a(m,v),w=r?x?0:u(m,v):x?u(m+(m<0?jt:-jt),v):0;if(!f&&(p=d=x)&&c.lineStart(),x!==d&&(b=l(f,y),(!b||m4(f,b)||m4(y,b))&&(y[2]=1)),x!==d)g=0,x?(c.lineStart(),b=l(y,f),c.point(b[0],b[1])):(b=l(f,y),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var C;!(w&h)&&(C=l(y,f,!0))&&(g=0,r?(c.lineStart(),c.point(C[0][0],C[0][1]),c.point(C[1][0],C[1][1]),c.lineEnd()):(c.point(C[1][0],C[1][1]),c.lineEnd(),c.lineStart(),c.point(C[0][0],C[0][1],3)))}x&&(!f||!m4(f,y))&&c.point(y[0],y[1]),f=y,d=x,h=w},lineEnd:function(){d&&c.lineEnd(),f=null},clean:function(){return g|(p&&d)<<1}}}function l(c,f,h){var d=nb(c),p=nb(f),g=[1,0,0],m=g$(d,p),v=YO(m,m),y=m[0],b=v-y*y;if(!b)return!h&&c;var x=t*v/b,w=-t*y/b,C=g$(g,m),$=XO(g,x),_=XO(m,w);AH($,_);var k=C,E=YO($,k),S=YO(k,k),I=E*E-S*(YO($,$)-1);if(!(I<0)){var A=vo(I),D=XO(k,(-E-A)/S);if(AH(D,$),D=lL(D),!h)return D;var T=c[0],N=f[0],F=c[1],R=f[1],P;N<T&&(P=T,T=N,N=P);var V=N-T,z=on(V-jt)<lt,q=z||V<lt;if(!z&&R<F&&(P=F,F=R,R=P),q?z?F+R>0^D[1]<(on(D[0]-T)<lt?F:R):F<=D[1]&&D[1]<=R:V>jt^(T<=D[0]&&D[0]<=N)){var G=XO(k,(-E+A)/S);return AH(G,$),[D,lL(G)]}}}function u(c,f){var h=r?e:jt-e,d=0;return c<-h?d|=1:c>h&&(d|=2),f<-h?d|=4:f>h&&(d|=8),d}return Y6e(a,o,s,r?[0,-e]:[-jt,e-jt])}function pQt(e,t,n,r,i,s){var a=e[0],o=e[1],l=t[0],u=t[1],c=0,f=1,h=l-a,d=u-o,p;if(p=n-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=i-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}if(p=r-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=s-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=a+c*h,e[1]=o+c*d),f<1&&(t[0]=a+f*h,t[1]=o+f*d),!0}}}}}var _E=1e9,ZO=-_E;function X6e(e,t,n,r){function i(u,c){return e<=u&&u<=n&&t<=c&&c<=r}function s(u,c,f,h){var d=0,p=0;if(u==null||(d=a(u,f))!==(p=a(c,f))||l(u,c)<0^f>0)do h.point(d===0||d===3?e:n,d>1?r:t);while((d=(d+f+4)%4)!==p);else h.point(c[0],c[1])}function a(u,c){return on(u[0]-e)<lt?c>0?0:3:on(u[0]-n)<lt?c>0?2:1:on(u[1]-t)<lt?c>0?1:0:c>0?3:2}function o(u,c){return l(u.x,c.x)}function l(u,c){var f=a(u,1),h=a(c,1);return f!==h?f-h:f===0?c[1]-u[1]:f===1?u[0]-c[0]:f===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,f=q6e(),h,d,p,g,m,v,y,b,x,w,C,$={point:_,lineStart:I,lineEnd:A,polygonStart:E,polygonEnd:S};function _(T,N){i(T,N)&&c.point(T,N)}function k(){for(var T=0,N=0,F=d.length;N<F;++N)for(var R=d[N],P=1,V=R.length,z=R[0],q,G,K=z[0],Y=z[1];P<V;++P)q=K,G=Y,z=R[P],K=z[0],Y=z[1],G<=r?Y>r&&(K-q)*(r-G)>(Y-G)*(e-q)&&++T:Y<=r&&(K-q)*(r-G)<(Y-G)*(e-q)&&--T;return T}function E(){c=f,h=[],d=[],C=!0}function S(){var T=k(),N=C&&T,F=(h=DRe(h)).length;(N||F)&&(u.polygonStart(),N&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),F&&G6e(h,o,T,s,u),u.polygonEnd()),c=u,h=d=p=null}function I(){$.point=D,d&&d.push(p=[]),w=!0,x=!1,y=b=NaN}function A(){h&&(D(g,m),v&&x&&f.rejoin(),h.push(f.result())),$.point=_,x&&c.lineEnd()}function D(T,N){var F=i(T,N);if(d&&p.push([T,N]),w)g=T,m=N,v=F,w=!1,F&&(c.lineStart(),c.point(T,N));else if(F&&x)c.point(T,N);else{var R=[y=Math.max(ZO,Math.min(_E,y)),b=Math.max(ZO,Math.min(_E,b))],P=[T=Math.max(ZO,Math.min(_E,T)),N=Math.max(ZO,Math.min(_E,N))];pQt(R,P,e,t,n,r)?(x||(c.lineStart(),c.point(R[0],R[1])),c.point(P[0],P[1]),F||c.lineEnd(),C=!1):F&&(c.lineStart(),c.point(T,N),C=!1)}y=T,b=N,x=F}return $}}function Oye(e,t,n){var r=Ml(e,t-lt,n).concat(t);return function(i){return r.map(function(s){return[i,s]})}}function Rye(e,t,n){var r=Ml(e,t-lt,n).concat(t);return function(i){return r.map(function(s){return[s,i]})}}function gQt(){var e,t,n,r,i,s,a,o,l=10,u=l,c=90,f=360,h,d,p,g,m=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return Ml(GO(r/c)*c,n,c).map(p).concat(Ml(GO(o/f)*f,a,f).map(g)).concat(Ml(GO(t/l)*l,e,l).filter(function(b){return on(b%c)>lt}).map(h)).concat(Ml(GO(s/u)*u,i,u).filter(function(b){return on(b%f)>lt}).map(d))}return v.lines=function(){return y().map(function(b){return{type:"LineString",coordinates:b}})},v.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(a).slice(1),p(n).reverse().slice(1),g(o).reverse().slice(1))]}},v.extent=function(b){return arguments.length?v.extentMajor(b).extentMinor(b):v.extentMinor()},v.extentMajor=function(b){return arguments.length?(r=+b[0][0],n=+b[1][0],o=+b[0][1],a=+b[1][1],r>n&&(b=r,r=n,n=b),o>a&&(b=o,o=a,a=b),v.precision(m)):[[r,o],[n,a]]},v.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],s=+b[0][1],i=+b[1][1],t>e&&(b=t,t=e,e=b),s>i&&(b=s,s=i,i=b),v.precision(m)):[[t,s],[e,i]]},v.step=function(b){return arguments.length?v.stepMajor(b).stepMinor(b):v.stepMinor()},v.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],v):[c,f]},v.stepMinor=function(b){return arguments.length?(l=+b[0],u=+b[1],v):[l,u]},v.precision=function(b){return arguments.length?(m=+b,h=Oye(s,i,90),d=Rye(t,e,m),p=Oye(o,a,90),g=Rye(r,n,m),v):m},v.extentMajor([[-180,-90+lt],[180,90-lt]]).extentMinor([[-180,-80-lt],[180,80+lt]])}const o3=e=>e;var DH=new lo,nZ=new lo,K6e,Z6e,rZ,iZ,Vg={point:Fs,lineStart:Fs,lineEnd:Fs,polygonStart:function(){Vg.lineStart=mQt,Vg.lineEnd=yQt},polygonEnd:function(){Vg.lineStart=Vg.lineEnd=Vg.point=Fs,DH.add(on(nZ)),nZ=new lo},result:function(){var e=DH/2;return DH=new lo,e}};function mQt(){Vg.point=vQt}function vQt(e,t){Vg.point=Q6e,K6e=rZ=e,Z6e=iZ=t}function Q6e(e,t){nZ.add(iZ*e-rZ*t),rZ=e,iZ=t}function yQt(){Q6e(K6e,Z6e)}const Pye=Vg;var m$=1/0,vL=m$,l3=-m$,yL=l3,bQt={point:xQt,lineStart:Fs,lineEnd:Fs,polygonStart:Fs,polygonEnd:Fs,result:function(){var e=[[m$,vL],[l3,yL]];return l3=yL=-(vL=m$=1/0),e}};function xQt(e,t){e<m$&&(m$=e),e>l3&&(l3=e),t<vL&&(vL=t),t>yL&&(yL=t)}const bL=bQt;var sZ=0,aZ=0,SE=0,xL=0,wL=0,O2=0,oZ=0,lZ=0,kE=0,J6e,eBe,Vf,jf,kc={point:rb,lineStart:Lye,lineEnd:Bye,polygonStart:function(){kc.lineStart=CQt,kc.lineEnd=_Qt},polygonEnd:function(){kc.point=rb,kc.lineStart=Lye,kc.lineEnd=Bye},result:function(){var e=kE?[oZ/kE,lZ/kE]:O2?[xL/O2,wL/O2]:SE?[sZ/SE,aZ/SE]:[NaN,NaN];return sZ=aZ=SE=xL=wL=O2=oZ=lZ=kE=0,e}};function rb(e,t){sZ+=e,aZ+=t,++SE}function Lye(){kc.point=wQt}function wQt(e,t){kc.point=$Qt,rb(Vf=e,jf=t)}function $Qt(e,t){var n=e-Vf,r=t-jf,i=vo(n*n+r*r);xL+=i*(Vf+e)/2,wL+=i*(jf+t)/2,O2+=i,rb(Vf=e,jf=t)}function Bye(){kc.point=rb}function CQt(){kc.point=SQt}function _Qt(){tBe(J6e,eBe)}function SQt(e,t){kc.point=tBe,rb(J6e=Vf=e,eBe=jf=t)}function tBe(e,t){var n=e-Vf,r=t-jf,i=vo(n*n+r*r);xL+=i*(Vf+e)/2,wL+=i*(jf+t)/2,O2+=i,i=jf*e-Vf*t,oZ+=i*(Vf+e),lZ+=i*(jf+t),kE+=i*3,rb(Vf=e,jf=t)}const zye=kc;function nBe(e){this._context=e}nBe.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,mo);break}}},result:Fs};var uZ=new lo,IH,rBe,iBe,EE,AE,$L={point:Fs,lineStart:function(){$L.point=kQt},lineEnd:function(){IH&&sBe(rBe,iBe),$L.point=Fs},polygonStart:function(){IH=!0},polygonEnd:function(){IH=null},result:function(){var e=+uZ;return uZ=new lo,e}};function kQt(e,t){$L.point=sBe,rBe=EE=e,iBe=AE=t}function sBe(e,t){EE-=e,AE-=t,uZ.add(vo(EE*EE+AE*AE)),EE=e,AE=t}const Uye=$L;function aBe(){this._string=[]}aBe.prototype={_radius:4.5,_circle:Wye(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=Wye(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function Wye(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function oBe(e,t){var n=4.5,r,i;function s(a){return a&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),Xd(a,r(i))),i.result()}return s.area=function(a){return Xd(a,r(Pye)),Pye.result()},s.measure=function(a){return Xd(a,r(Uye)),Uye.result()},s.bounds=function(a){return Xd(a,r(bL)),bL.result()},s.centroid=function(a){return Xd(a,r(zye)),zye.result()},s.projection=function(a){return arguments.length?(r=a==null?(e=null,o3):(e=a).stream,s):e},s.context=function(a){return arguments.length?(i=a==null?(t=null,new aBe):new nBe(t=a),typeof n!="function"&&i.pointRadius(n),s):t},s.pointRadius=function(a){return arguments.length?(n=typeof a=="function"?a:(i.pointRadius(+a),+a),s):n},s.projection(e).context(t)}function P9(e){return function(t){var n=new cZ;for(var r in e)n[r]=e[r];return n.stream=t,n}}function cZ(){}cZ.prototype={constructor:cZ,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function tae(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Xd(n,e.stream(bL)),t(bL.result()),r!=null&&e.clipExtent(r),e}function L9(e,t,n){return tae(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),o=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(s-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,l])},n)}function nae(e,t,n){return L9(e,[[0,0],t],n)}function rae(e,t,n){return tae(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),a=(i-s*(r[1][0]+r[0][0]))/2,o=-s*r[0][1];e.scale(150*s).translate([a,o])},n)}function iae(e,t,n){return tae(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),a=-s*r[0][0],o=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,o])},n)}var Vye=16,EQt=ft(30*Ht);function jye(e,t){return+t?TQt(e,t):AQt(e)}function AQt(e){return P9({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function TQt(e,t){function n(r,i,s,a,o,l,u,c,f,h,d,p,g,m){var v=u-r,y=c-i,b=v*v+y*y;if(b>4*t&&g--){var x=a+h,w=o+d,C=l+p,$=vo(x*x+w*w+C*C),_=cl(C/=$),k=on(on(C)-1)<lt||on(s-f)<lt?(s+f)/2:Bu(w,x),E=e(k,_),S=E[0],I=E[1],A=S-r,D=I-i,T=y*A-v*D;(T*T/b>t||on((v*A+y*D)/b-.5)>.3||a*h+o*d+l*p<EQt)&&(n(r,i,s,a,o,l,S,I,k,x/=$,w/=$,C,g,m),m.point(S,I),n(S,I,k,x,w,C,u,c,f,h,d,p,g,m))}}return function(r){var i,s,a,o,l,u,c,f,h,d,p,g,m={point:v,lineStart:y,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=y}};function v(_,k){_=e(_,k),r.point(_[0],_[1])}function y(){f=NaN,m.point=b,r.lineStart()}function b(_,k){var E=nb([_,k]),S=e(_,k);n(f,h,c,d,p,g,f=S[0],h=S[1],c=_,d=E[0],p=E[1],g=E[2],Vye,r),r.point(f,h)}function x(){m.point=v,r.lineEnd()}function w(){y(),m.point=C,m.lineEnd=$}function C(_,k){b(i=_,k),s=f,a=h,o=d,l=p,u=g,m.point=b}function $(){n(f,h,c,d,p,g,s,a,i,o,l,u,Vye,r),m.lineEnd=x,x()}return m}}var DQt=P9({point:function(e,t){this.stream.point(e*Ht,t*Ht)}});function IQt(e){return P9({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function NQt(e,t,n,r,i){function s(a,o){return a*=r,o*=i,[t+e*a,n-e*o]}return s.invert=function(a,o){return[(a-t)/e*r,(n-o)/e*i]},s}function Hye(e,t,n,r,i,s){if(!s)return NQt(e,t,n,r,i);var a=ft(s),o=st(s),l=a*e,u=o*e,c=a/e,f=o/e,h=(o*n-a*t)/e,d=(o*t+a*n)/e;function p(g,m){return g*=r,m*=i,[l*g-u*m+t,n-u*g-l*m]}return p.invert=function(g,m){return[r*(c*g-f*m+h),i*(d-f*g-c*m)]},p}function ld(e){return lBe(function(){return e})()}function lBe(e){var t,n=150,r=480,i=250,s=0,a=0,o=0,l=0,u=0,c,f=0,h=1,d=1,p=null,g=Fye,m=null,v,y,b,x=o3,w=.5,C,$,_,k,E;function S(T){return _(T[0]*Ht,T[1]*Ht)}function I(T){return T=_.invert(T[0],T[1]),T&&[T[0]*ni,T[1]*ni]}S.stream=function(T){return k&&E===T?k:k=DQt(IQt(c)(g(C(x(E=T)))))},S.preclip=function(T){return arguments.length?(g=T,p=void 0,D()):g},S.postclip=function(T){return arguments.length?(x=T,m=v=y=b=null,D()):x},S.clipAngle=function(T){return arguments.length?(g=+T?dQt(p=T*Ht):(p=null,Fye),D()):p*ni},S.clipExtent=function(T){return arguments.length?(x=T==null?(m=v=y=b=null,o3):X6e(m=+T[0][0],v=+T[0][1],y=+T[1][0],b=+T[1][1]),D()):m==null?null:[[m,v],[y,b]]},S.scale=function(T){return arguments.length?(n=+T,A()):n},S.translate=function(T){return arguments.length?(r=+T[0],i=+T[1],A()):[r,i]},S.center=function(T){return arguments.length?(s=T[0]%360*Ht,a=T[1]%360*Ht,A()):[s*ni,a*ni]},S.rotate=function(T){return arguments.length?(o=T[0]%360*Ht,l=T[1]%360*Ht,u=T.length>2?T[2]%360*Ht:0,A()):[o*ni,l*ni,u*ni]},S.angle=function(T){return arguments.length?(f=T%360*Ht,A()):f*ni},S.reflectX=function(T){return arguments.length?(h=T?-1:1,A()):h<0},S.reflectY=function(T){return arguments.length?(d=T?-1:1,A()):d<0},S.precision=function(T){return arguments.length?(C=jye($,w=T*T),D()):vo(w)},S.fitExtent=function(T,N){return L9(S,T,N)},S.fitSize=function(T,N){return nae(S,T,N)},S.fitWidth=function(T,N){return rae(S,T,N)},S.fitHeight=function(T,N){return iae(S,T,N)};function A(){var T=Hye(n,0,0,h,d,f).apply(null,t(s,a)),N=Hye(n,r-T[0],i-T[1],h,d,f);return c=H6e(o,l,u),$=eZ(t,N),_=eZ(c,$),C=jye($,w),D()}function D(){return k=E=null,S}return function(){return t=e.apply(this,arguments),S.invert=t.invert&&I,A()}}function sae(e){var t=0,n=jt/3,r=lBe(e),i=r(t,n);return i.parallels=function(s){return arguments.length?r(t=s[0]*Ht,n=s[1]*Ht):[t*ni,n*ni]},i}function MQt(e){var t=ft(e);function n(r,i){return[r*t,st(i)/t]}return n.invert=function(r,i){return[r/t,cl(i*t)]},n}function FQt(e,t){var n=st(e),r=(n+st(t))/2;if(on(r)<lt)return MQt(e);var i=1+n*(2*r-n),s=vo(i)/r;function a(o,l){var u=vo(i-2*r*st(l))/r;return[u*st(o*=r),s-u*ft(o)]}return a.invert=function(o,l){var u=s-l,c=Bu(o,on(u))*wu(u);return u*r<0&&(c-=jt*wu(o)*wu(u)),[c/r,cl((i-(o*o+u*u)*r*r)/(2*r))]},a}function CL(){return sae(FQt).scale(155.424).center([0,33.6442])}function uBe(){return CL().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function OQt(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function RQt(){var e,t,n=uBe(),r,i=CL().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,a=CL().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o,l,u={point:function(h,d){l=[h,d]}};function c(h){var d=h[0],p=h[1];return l=null,r.point(d,p),l||(s.point(d,p),l)||(o.point(d,p),l)}c.invert=function(h){var d=n.scale(),p=n.translate(),g=(h[0]-p[0])/d,m=(h[1]-p[1])/d;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?a:n).invert(h)},c.stream=function(h){return e&&t===h?e:e=OQt([n.stream(t=h),i.stream(h),a.stream(h)])},c.precision=function(h){return arguments.length?(n.precision(h),i.precision(h),a.precision(h),f()):n.precision()},c.scale=function(h){return arguments.length?(n.scale(h),i.scale(h*.35),a.scale(h),c.translate(n.translate())):n.scale()},c.translate=function(h){if(!arguments.length)return n.translate();var d=n.scale(),p=+h[0],g=+h[1];return r=n.translate(h).clipExtent([[p-.455*d,g-.238*d],[p+.455*d,g+.238*d]]).stream(u),s=i.translate([p-.307*d,g+.201*d]).clipExtent([[p-.425*d+lt,g+.12*d+lt],[p-.214*d-lt,g+.234*d-lt]]).stream(u),o=a.translate([p-.205*d,g+.212*d]).clipExtent([[p-.214*d+lt,g+.166*d+lt],[p-.115*d-lt,g+.234*d-lt]]).stream(u),f()},c.fitExtent=function(h,d){return L9(c,h,d)},c.fitSize=function(h,d){return nae(c,h,d)},c.fitWidth=function(h,d){return rae(c,h,d)},c.fitHeight=function(h,d){return iae(c,h,d)};function f(){return e=t=null,c}return c.scale(1070)}function cBe(e){return function(t,n){var r=ft(t),i=ft(n),s=e(r*i);return s===1/0?[2,0]:[s*i*st(t),s*st(n)]}}function vM(e){return function(t,n){var r=vo(t*t+n*n),i=e(r),s=st(i),a=ft(i);return[Bu(t*s,r*a),cl(r&&n*s/r)]}}var fBe=cBe(function(e){return vo(2/(1+e))});fBe.invert=vM(function(e){return 2*cl(e/2)});function PQt(){return ld(fBe).scale(124.75).clipAngle(180-.001)}var hBe=cBe(function(e){return(e=F6e(e))&&e/st(e)});hBe.invert=vM(function(e){return e});function LQt(){return ld(hBe).scale(79.4188).clipAngle(180-.001)}function B9(e,t){return[e,iL(Jse((Yr+t)/2))]}B9.invert=function(e,t){return[e,2*q_(M6e(t))-Yr]};function BQt(){return dBe(B9).scale(961/mo)}function dBe(e){var t=ld(e),n=t.center,r=t.scale,i=t.translate,s=t.clipExtent,a=null,o,l,u;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=o=l=u=null:(a=+f[0][0],o=+f[0][1],l=+f[1][0],u=+f[1][1]),c()):a==null?null:[[a,o],[l,u]]};function c(){var f=jt*r(),h=t(sQt(t.rotate()).invert([0,0]));return s(a==null?[[h[0]-f,h[1]-f],[h[0]+f,h[1]+f]]:e===B9?[[Math.max(h[0]-f,a),o],[Math.min(h[0]+f,l),u]]:[[a,Math.max(h[1]-f,o)],[l,Math.min(h[1]+f,u)]])}return c()}function QO(e){return Jse((Yr+e)/2)}function zQt(e,t){var n=ft(e),r=e===t?st(e):iL(n/ft(t))/iL(QO(t)/QO(e)),i=n*EH(QO(e),r)/r;if(!r)return B9;function s(a,o){i>0?o<-Yr+lt&&(o=-Yr+lt):o>Yr-lt&&(o=Yr-lt);var l=i/EH(QO(o),r);return[l*st(r*a),i-l*ft(r*a)]}return s.invert=function(a,o){var l=i-o,u=wu(r)*vo(a*a+l*l),c=Bu(a,on(l))*wu(l);return l*r<0&&(c-=jt*wu(a)*wu(l)),[c/r,2*q_(EH(i/u,1/r))-Yr]},s}function UQt(){return sae(zQt).scale(109.5).parallels([30,30])}function _L(e,t){return[e,t]}_L.invert=_L;function WQt(){return ld(_L).scale(152.63)}function VQt(e,t){var n=ft(e),r=e===t?st(e):(n-ft(t))/(t-e),i=n/r+e;if(on(r)<lt)return _L;function s(a,o){var l=i-o,u=r*a;return[l*st(u),i-l*ft(u)]}return s.invert=function(a,o){var l=i-o,u=Bu(a,on(l))*wu(l);return l*r<0&&(u-=jt*wu(a)*wu(l)),[u/r,i-wu(r)*vo(a*a+l*l)]},s}function jQt(){return sae(VQt).scale(131.154).center([0,13.9389])}var vA=1.340264,yA=-.081106,bA=893e-6,xA=.003796,SL=vo(3)/2,HQt=12;function pBe(e,t){var n=cl(SL*st(t)),r=n*n,i=r*r*r;return[e*ft(n)/(SL*(vA+3*yA*r+i*(7*bA+9*xA*r))),n*(vA+yA*r+i*(bA+xA*r))]}pBe.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,s=0,a,o,l;s<HQt&&(o=n*(vA+yA*r+i*(bA+xA*r))-t,l=vA+3*yA*r+i*(7*bA+9*xA*r),n-=a=o/l,r=n*n,i=r*r*r,!(on(a)<nL));++s);return[SL*e*(vA+3*yA*r+i*(7*bA+9*xA*r))/ft(n),cl(st(n)/SL)]};function qQt(){return ld(pBe).scale(177.158)}function gBe(e,t){var n=ft(t),r=ft(e)*n;return[n*st(e)/r,st(t)/r]}gBe.invert=vM(q_);function GQt(){return ld(gBe).scale(144.049).clipAngle(60)}function YQt(){var e=1,t=0,n=0,r=1,i=1,s=0,a,o,l=null,u,c,f,h=1,d=1,p=P9({point:function(x,w){var C=b([x,w]);this.stream.point(C[0],C[1])}}),g=o3,m,v;function y(){return h=e*r,d=e*i,m=v=null,b}function b(x){var w=x[0]*h,C=x[1]*d;if(s){var $=C*a-w*o;w=w*a+C*o,C=$}return[w+t,C+n]}return b.invert=function(x){var w=x[0]-t,C=x[1]-n;if(s){var $=C*a+w*o;w=w*a-C*o,C=$}return[w/h,C/d]},b.stream=function(x){return m&&v===x?m:m=p(g(v=x))},b.postclip=function(x){return arguments.length?(g=x,l=u=c=f=null,y()):g},b.clipExtent=function(x){return arguments.length?(g=x==null?(l=u=c=f=null,o3):X6e(l=+x[0][0],u=+x[0][1],c=+x[1][0],f=+x[1][1]),y()):l==null?null:[[l,u],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,y()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],y()):[t,n]},b.angle=function(x){return arguments.length?(s=x%360*Ht,o=st(s),a=ft(s),y()):s*ni},b.reflectX=function(x){return arguments.length?(r=x?-1:1,y()):r<0},b.reflectY=function(x){return arguments.length?(i=x?-1:1,y()):i<0},b.fitExtent=function(x,w){return L9(b,x,w)},b.fitSize=function(x,w){return nae(b,x,w)},b.fitWidth=function(x,w){return rae(b,x,w)},b.fitHeight=function(x,w){return iae(b,x,w)},b}function mBe(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}mBe.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,a=s*s;n-=i=(n*(1.007226+s*(.015085+a*(-.044475+.028874*s-.005916*a)))-t)/(1.007226+s*(.015085*3+a*(-.044475*7+.028874*9*s-.005916*11*a)))}while(on(i)>lt&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function XQt(){return ld(mBe).scale(175.295)}function vBe(e,t){return[ft(t)*st(e),st(t)]}vBe.invert=vM(cl);function KQt(){return ld(vBe).scale(249.5).clipAngle(90+lt)}function yBe(e,t){var n=ft(t),r=1+ft(e)*n;return[n*st(e)/r,st(t)/r]}yBe.invert=vM(function(e){return 2*q_(e)});function ZQt(){return ld(yBe).scale(250).clipAngle(142)}function bBe(e,t){return[iL(Jse((Yr+t)/2)),-e]}bBe.invert=function(e,t){return[-t,2*q_(M6e(e))-Yr]};function QQt(){var e=dBe(bBe),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}function JQt(){}const Id=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function xBe(){var e=1,t=1,n=o;function r(l,u){return u.map(c=>i(l,c))}function i(l,u){var c=[],f=[];return s(l,u,h=>{n(h,l,u),eJt(h)>0?c.push([h]):f.push(h)}),f.forEach(h=>{for(var d=0,p=c.length,g;d<p;++d)if(tJt((g=c[d])[0],h)!==-1){g.push(h);return}}),{type:"MultiPolygon",value:u,coordinates:c}}function s(l,u,c){var f=new Array,h=new Array,d,p,g,m,v,y;for(d=p=-1,m=l[0]>=u,Id[m<<1].forEach(b);++d<e-1;)g=m,m=l[d+1]>=u,Id[g|m<<1].forEach(b);for(Id[m<<0].forEach(b);++p<t-1;){for(d=-1,m=l[p*e+e]>=u,v=l[p*e]>=u,Id[m<<1|v<<2].forEach(b);++d<e-1;)g=m,m=l[p*e+e+d+1]>=u,y=v,v=l[p*e+d+1]>=u,Id[g|m<<1|v<<2|y<<3].forEach(b);Id[m|v<<3].forEach(b)}for(d=-1,v=l[p*e]>=u,Id[v<<2].forEach(b);++d<e-1;)y=v,v=l[p*e+d+1]>=u,Id[v<<2|y<<3].forEach(b);Id[v<<3].forEach(b);function b(x){var w=[x[0][0]+d,x[0][1]+p],C=[x[1][0]+d,x[1][1]+p],$=a(w),_=a(C),k,E;(k=h[$])?(E=f[_])?(delete h[k.end],delete f[E.start],k===E?(k.ring.push(C),c(k.ring)):f[k.start]=h[E.end]={start:k.start,end:E.end,ring:k.ring.concat(E.ring)}):(delete h[k.end],k.ring.push(C),h[k.end=_]=k):(k=f[_])?(E=h[$])?(delete f[k.start],delete h[E.end],k===E?(k.ring.push(C),c(k.ring)):f[E.start]=h[k.end]={start:E.start,end:k.end,ring:E.ring.concat(k.ring)}):(delete f[k.start],k.ring.unshift(w),f[k.start=$]=k):f[$]=h[_]={start:$,end:_,ring:[w,C]}}}function a(l){return l[0]*2+l[1]*(e+1)*4}function o(l,u,c){l.forEach(f=>{var h=f[0],d=f[1],p=h|0,g=d|0,m,v=u[g*e+p];h>0&&h<e&&p===h&&(m=u[g*e+p-1],f[0]=h+(c-m)/(v-m)-.5),d>0&&d<t&&g===d&&(m=u[(g-1)*e+p],f[1]=d+(c-m)/(v-m)-.5)})}return r.contour=i,r.size=function(l){if(!arguments.length)return[e,t];var u=Math.floor(l[0]),c=Math.floor(l[1]);return u>=0&&c>=0||$e("invalid size"),e=u,t=c,r},r.smooth=function(l){return arguments.length?(n=l?o:JQt,r):n===o},r}function eJt(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function tJt(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=nJt(e,t[n]))return i;return 0}function nJt(e,t){for(var n=t[0],r=t[1],i=-1,s=0,a=e.length,o=a-1;s<a;o=s++){var l=e[s],u=l[0],c=l[1],f=e[o],h=f[0],d=f[1];if(rJt(l,f,t))return 0;c>r!=d>r&&n<(h-u)*(r-c)/(d-c)+u&&(i=-i)}return i}function rJt(e,t,n){var r;return iJt(e,t,n)&&sJt(e[r=+(e[0]===t[0])],n[r],t[r])}function iJt(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function sJt(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function wBe(e,t,n){return function(r){var i=Op(r),s=n?Math.min(i[0],0):i[0],a=i[1],o=a-s,l=t?K0(s,a,e):o/(e+1);return Ml(s+l,a,l)}}function aae(e){me.call(this,null,e)}aae.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};Ie(aae,me,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||ll,s=xBe().smooth(e.smooth!==!1),a=e.thresholds||aJt(r,i,e),o=e.as===null?null:e.as||"contour",l=[];return r.forEach(u=>{const c=i(u),f=s.size([c.width,c.height])(c.values,at(a)?a:a(c.values));oJt(f,c,u,e),f.forEach(h=>{l.push(Q7(u,Tn(o!=null?{[o]:h}:h)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function aJt(e,t,n){const r=wBe(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>ny(t(i).values)))}function oJt(e,t,n,r){let i=r.scale||t.scale,s=r.translate||t.translate;if(Ut(i)&&(i=i(n,r)),Ut(s)&&(s=s(n,r)),(i===1||i==null)&&!s)return;const a=(FT(i)?i:i[0])||1,o=(FT(i)?i:i[1])||1,l=s&&s[0]||0,u=s&&s[1]||0;e.forEach($Be(t,a,o,l,u))}function $Be(e,t,n,r,i){const s=e.x1||0,a=e.y1||0,o=t*n<0;function l(f){f.forEach(u)}function u(f){o&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-s)*t+r,f[1]=(f[1]-a)*n+i}return function(f){return f.coordinates.forEach(l),f}}function qye(e,t,n){const r=e>=0?e:uRe(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function NH(e){return Ut(e)?e:go(+e)}function CBe(){var e=l=>l[0],t=l=>l[1],n=HN,r=[-1,-1],i=960,s=500,a=2;function o(l,u){const c=qye(r[0],l,e)>>a,f=qye(r[1],l,t)>>a,h=c?c+2:0,d=f?f+2:0,p=2*h+(i>>a),g=2*d+(s>>a),m=new Float32Array(p*g),v=new Float32Array(p*g);let y=m;l.forEach(x=>{const w=h+(+e(x)>>a),C=d+(+t(x)>>a);w>=0&&w<p&&C>=0&&C<g&&(m[w+C*p]+=+n(x))}),c>0&&f>0?(u2(p,g,m,v,c),c2(p,g,v,m,f),u2(p,g,m,v,c),c2(p,g,v,m,f),u2(p,g,m,v,c),c2(p,g,v,m,f)):c>0?(u2(p,g,m,v,c),u2(p,g,v,m,c),u2(p,g,m,v,c),y=v):f>0&&(c2(p,g,m,v,f),c2(p,g,v,m,f),c2(p,g,m,v,f),y=v);const b=u?Math.pow(2,-2*a):1/IRe(y);for(let x=0,w=p*g;x<w;++x)y[x]*=b;return{values:y,scale:1<<a,width:p,height:g,x1:h,y1:d,x2:h+(i>>a),y2:d+(s>>a)}}return o.x=function(l){return arguments.length?(e=NH(l),o):e},o.y=function(l){return arguments.length?(t=NH(l),o):t},o.weight=function(l){return arguments.length?(n=NH(l),o):n},o.size=function(l){if(!arguments.length)return[i,s];var u=+l[0],c=+l[1];return u>=0&&c>=0||$e("invalid size"),i=u,s=c,o},o.cellSize=function(l){return arguments.length?((l=+l)>=1||$e("invalid cell size"),a=Math.floor(Math.log(l)/Math.LN2),o):1<<a},o.bandwidth=function(l){return arguments.length?(l=ct(l),l.length===1&&(l=[+l[0],+l[0]]),l.length!==2&&$e("invalid bandwidth"),r=l,o):r},o}function u2(e,t,n,r,i){const s=(i<<1)+1;for(let a=0;a<t;++a)for(let o=0,l=0;o<e+i;++o)o<e&&(l+=n[o+a*e]),o>=i&&(o>=s&&(l-=n[o-s+a*e]),r[o-i+a*e]=l/Math.min(o+1,e-1+s-o,s))}function c2(e,t,n,r,i){const s=(i<<1)+1;for(let a=0;a<e;++a)for(let o=0,l=0;o<t+i;++o)o<t&&(l+=n[a+o*e]),o>=i&&(o>=s&&(l-=n[a+(o-s)*e]),r[a+(o-i)*e]=l/Math.min(o+1,t-1+s-o,s))}function oae(e){me.call(this,null,e)}oae.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const lJt=["x","y","weight","size","cellSize","bandwidth"];function _Be(e,t){return lJt.forEach(n=>t[n]!=null?e[n](t[n]):0),e}Ie(oae,me,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=uJt(r,e.groupby),s=(e.groupby||[]).map(li),a=_Be(CBe(),e),o=e.as||"grid",l=[];function u(c,f){for(let h=0;h<s.length;++h)c[s[h]]=f[h];return c}return l=i.map(c=>Tn(u({[o]:a(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function uJt(e,t){var n=[],r=c=>c(o),i,s,a,o,l,u;if(t==null)n.push(e);else for(i={},s=0,a=e.length;s<a;++s)o=e[s],l=t.map(r),u=i[l],u||(i[l]=u=[],u.dims=l,n.push(u)),u.push(o);return n}function lae(e){me.call(this,null,e)}lae.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};Ie(lae,me,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=xBe().smooth(e.smooth!==!1),i=e.values,s=e.thresholds||wBe(e.count||10,e.nice,!!i),a=e.size,o,l;return i||(i=t.materialize(t.SOURCE).source,o=_Be(CBe(),e)(i,!0),l=$Be(o,o.scale||1,o.scale||1,0,0),a=[o.width,o.height],i=o.values),s=at(s)?s:s(i),i=r.size(a)(i,s),l&&i.forEach(l),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(Tn),n}});const fZ="Feature",uae="FeatureCollection",cJt="MultiPoint";function cae(e){me.call(this,null,e)}cae.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};Ie(cae,me,{transform(e,t){var n=this._features,r=this._points,i=e.fields,s=i&&i[0],a=i&&i[1],o=e.geojson||!i&&ll,l=t.ADD,u;u=e.modified()||t.changed(t.REM)||t.modified(ao(o))||s&&t.modified(ao(s))||a&&t.modified(ao(a)),(!this.value||u)&&(l=t.SOURCE,this._features=n=[],this._points=r=[]),o&&t.visit(l,c=>n.push(o(c))),s&&a&&(t.visit(l,c=>{var f=s(c),h=a(c);f!=null&&h!=null&&(f=+f)===f&&(h=+h)===h&&r.push([f,h])}),n=n.concat({type:fZ,geometry:{type:cJt,coordinates:r}})),this.value={type:uae,features:n}}});function fae(e){me.call(this,null,e)}fae.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};Ie(fae,me,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||ll,s=e.as||"path",a=n.SOURCE;!r||e.modified()?(this.value=r=N6e(e.projection),n.materialize().reflow()):a=i===ll||t.modified(i.fields)?n.ADD_MOD:n.ADD;const o=fJt(r,e.pointRadius);return n.visit(a,l=>l[s]=r(i(l))),r.pointRadius(o),n.modifies(s)}});function fJt(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function hae(e){me.call(this,null,e)}hae.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};Ie(hae,me,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],s=e.as||["x","y"],a=s[0],o=s[1],l;function u(c){const f=n([r(c),i(c)]);f?(c[a]=f[0],c[o]=f[1]):(c[a]=void 0,c[o]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(l=t.modified(r.fields)||t.modified(i.fields),t.visit(l?t.ADD_MOD:t.ADD,u)),t.modifies(s)}});function dae(e){me.call(this,null,e)}dae.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};Ie(dae,me,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",s=n.ADD;return(!r||e.modified())&&(this.value=r=hJt(N6e(e.projection),e.field||Hl("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,a=>a[i]=r),n.modifies(i)}});function hJt(e,t,n){const r=n==null?i=>e(t(i)):i=>{var s=e.pointRadius(),a=e.pointRadius(n)(t(i));return e.pointRadius(s),a};return r.context=i=>(e.context(i),r),r}function pae(e){me.call(this,[],e),this.generator=gQt()}pae.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};Ie(pae,me,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const s in e)Ut(r[s])&&r[s](e[s]);return i=r(),n.length?t.mod.push(QOe(n[0],i)):t.add.push(Tn(i)),n[0]=i,t}});function gae(e){me.call(this,null,e)}gae.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};Ie(gae,me,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||ll,s=pJt(e.opacity,e),a=dJt(e.color,e),o=e.as||"image",l={$x:0,$y:0,$value:0,$max:r?ny(n.map(u=>ny(i(u).values))):0};return n.forEach(u=>{const c=i(u),f=zt({},u,l);r||(f.$max=ny(c.values||[])),u[o]=gJt(c,f,a.dep?a:go(a(f)),s.dep?s:go(s(f)))}),t.reflow(!0).modifies(o)}});function dJt(e,t){let n;return Ut(e)?(n=r=>nm(e(r,t)),n.dep=SBe(e)):n=go(nm(e||"#888")),n}function pJt(e,t){let n;return Ut(e)?(n=r=>e(r,t),n.dep=SBe(e)):e?n=go(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function SBe(e){if(!Ut(e))return!1;const t=Oh(ao(e));return t.$x||t.$y||t.$value||t.$max}function gJt(e,t,n,r){const i=e.width,s=e.height,a=e.x1||0,o=e.y1||0,l=e.x2||i,u=e.y2||s,c=e.values,f=c?m=>c[m]:l1,h=Yu(l-a,u-o),d=h.getContext("2d"),p=d.getImageData(0,0,l-a,u-o),g=p.data;for(let m=o,v=0;m<u;++m){t.$y=m-o;for(let y=a,b=m*i;y<l;++y,v+=4){t.$x=y-a,t.$value=f(y+b);const x=n(t);g[v+0]=x.r,g[v+1]=x.g,g[v+2]=x.b,g[v+3]=~~(255*r(t))}}return d.putImageData(p,0,0),h}function kBe(e){me.call(this,null,e),this.modified(!0)}Ie(kBe,me,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=vJt(e.type),jK.forEach(r=>{e[r]!=null&&Gye(n,r,e[r])})):jK.forEach(r=>{e.modified(r)&&Gye(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&mJt(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function mJt(e,t){const n=yJt(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function vJt(e){const t=I6e((e||"mercator").toLowerCase());return t||$e("Unrecognized projection type: "+e),t()}function Gye(e,t,n){Ut(e[t])&&e[t](n)}function yJt(e){return e=ct(e),e.length===1?e[0]:{type:uae,features:e.reduce((t,n)=>t.concat(bJt(n)),[])}}function bJt(e){return e.type===uae?e.features:ct(e).filter(t=>t!=null).map(t=>t.type===fZ?t:{type:fZ,geometry:t})}const xJt=Object.freeze(Object.defineProperty({__proto__:null,contour:lae,geojson:cae,geopath:fae,geopoint:hae,geoshape:dae,graticule:pae,heatmap:gae,isocontour:aae,kde2d:oae,projection:kBe},Symbol.toStringTag,{value:"Module"}));function wJt(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,a=n.length,o,l=0,u=0;for(s=0;s<a;++s)o=n[s],l+=o.x,u+=o.y;for(l=(l/a-e)*r,u=(u/a-t)*r,s=0;s<a;++s)o=n[s],o.x-=l,o.y-=u}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function $Jt(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return EBe(this.cover(t,n),t,n,e)}function EBe(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,a={data:r},o=e._x0,l=e._y0,u=e._x1,c=e._y1,f,h,d,p,g,m,v,y;if(!s)return e._root=a,e;for(;s.length;)if((g=t>=(f=(o+u)/2))?o=f:u=f,(m=n>=(h=(l+c)/2))?l=h:c=h,i=s,!(s=s[v=m<<1|g]))return i[v]=a,e;if(d=+e._x.call(null,s.data),p=+e._y.call(null,s.data),t===d&&n===p)return a.next=s,i?i[v]=a:e._root=a,e;do i=i?i[v]=new Array(4):e._root=new Array(4),(g=t>=(f=(o+u)/2))?o=f:u=f,(m=n>=(h=(l+c)/2))?l=h:c=h;while((v=m<<1|g)===(y=(p>=h)<<1|d>=f));return i[y]=s,i[v]=a,e}function CJt(e){var t,n,r=e.length,i,s,a=new Array(r),o=new Array(r),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(a[n]=i,o[n]=s,i<l&&(l=i),i>c&&(c=i),s<u&&(u=s),s>f&&(f=s));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<r;++n)EBe(this,a[n],o[n],e[n]);return this}function _Jt(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var a=i-n||1,o=this._root,l,u;n>e||e>=i||r>t||t>=s;)switch(u=(t<r)<<1|e<n,l=new Array(4),l[u]=o,o=l,a*=2,u){case 0:i=n+a,s=r+a;break;case 1:n=i-a,s=r+a;break;case 2:i=n+a,r=s-a;break;case 3:n=i-a,r=s-a;break}this._root&&this._root.length&&(this._root=o)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function SJt(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function kJt(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function to(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function EJt(e,t,n){var r,i=this._x0,s=this._y0,a,o,l,u,c=this._x1,f=this._y1,h=[],d=this._root,p,g;for(d&&h.push(new to(d,i,s,c,f)),n==null?n=1/0:(i=e-n,s=t-n,c=e+n,f=t+n,n*=n);p=h.pop();)if(!(!(d=p.node)||(a=p.x0)>c||(o=p.y0)>f||(l=p.x1)<i||(u=p.y1)<s))if(d.length){var m=(a+l)/2,v=(o+u)/2;h.push(new to(d[3],m,v,l,u),new to(d[2],a,v,m,u),new to(d[1],m,o,l,v),new to(d[0],a,o,m,v)),(g=(t>=v)<<1|e>=m)&&(p=h[h.length-1],h[h.length-1]=h[h.length-1-g],h[h.length-1-g]=p)}else{var y=e-+this._x.call(null,d.data),b=t-+this._y.call(null,d.data),x=y*y+b*b;if(x<n){var w=Math.sqrt(n=x);i=e-w,s=t-w,c=e+w,f=t+w,r=d.data}}return r}function AJt(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,a=this._x0,o=this._y0,l=this._x1,u=this._y1,c,f,h,d,p,g,m,v;if(!n)return this;if(n.length)for(;;){if((p=c>=(h=(a+l)/2))?a=h:l=h,(g=f>=(d=(o+u)/2))?o=d:u=d,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,v=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[m]=s:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[v]=n:this._root=n),this):(this._root=s,this)}function TJt(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function DJt(){return this._root}function IJt(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function NJt(e){var t=[],n,r=this._root,i,s,a,o,l;for(r&&t.push(new to(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,a=n.y0,o=n.x1,l=n.y1)&&r.length){var u=(s+o)/2,c=(a+l)/2;(i=r[3])&&t.push(new to(i,u,c,o,l)),(i=r[2])&&t.push(new to(i,s,c,u,l)),(i=r[1])&&t.push(new to(i,u,a,o,c)),(i=r[0])&&t.push(new to(i,s,a,u,c))}return this}function MJt(e){var t=[],n=[],r;for(this._root&&t.push(new to(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,a=r.x0,o=r.y0,l=r.x1,u=r.y1,c=(a+l)/2,f=(o+u)/2;(s=i[0])&&t.push(new to(s,a,o,c,f)),(s=i[1])&&t.push(new to(s,c,o,l,f)),(s=i[2])&&t.push(new to(s,a,f,c,u)),(s=i[3])&&t.push(new to(s,c,f,l,u))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function FJt(e){return e[0]}function OJt(e){return arguments.length?(this._x=e,this):this._x}function RJt(e){return e[1]}function PJt(e){return arguments.length?(this._y=e,this):this._y}function mae(e,t,n){var r=new vae(t==null?FJt:t,n==null?RJt:n,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function vae(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function Yye(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Eo=mae.prototype=vae.prototype;Eo.copy=function(){var e=new vae(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Yye(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=Yye(r));return e};Eo.add=$Jt;Eo.addAll=CJt;Eo.cover=_Jt;Eo.data=SJt;Eo.extent=kJt;Eo.find=EJt;Eo.remove=AJt;Eo.removeAll=TJt;Eo.root=DJt;Eo.size=IJt;Eo.visit=NJt;Eo.visitAfter=MJt;Eo.x=OJt;Eo.y=PJt;function so(e){return function(){return e}}function Jg(e){return(e()-.5)*1e-6}function LJt(e){return e.x+e.vx}function BJt(e){return e.y+e.vy}function zJt(e){var t,n,r,i=1,s=1;typeof e!="function"&&(e=so(e==null?1:+e));function a(){for(var u,c=t.length,f,h,d,p,g,m,v=0;v<s;++v)for(f=mae(t,LJt,BJt).visitAfter(o),u=0;u<c;++u)h=t[u],g=n[h.index],m=g*g,d=h.x+h.vx,p=h.y+h.vy,f.visit(y);function y(b,x,w,C,$){var _=b.data,k=b.r,E=g+k;if(_){if(_.index>h.index){var S=d-_.x-_.vx,I=p-_.y-_.vy,A=S*S+I*I;A<E*E&&(S===0&&(S=Jg(r),A+=S*S),I===0&&(I=Jg(r),A+=I*I),A=(E-(A=Math.sqrt(A)))/A*i,h.vx+=(S*=A)*(E=(k*=k)/(m+k)),h.vy+=(I*=A)*E,_.vx-=S*(E=1-E),_.vy-=I*E)}return}return x>d+E||C<d-E||w>p+E||$<p-E}}function o(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(!!t){var u,c=t.length,f;for(n=new Array(c),u=0;u<c;++u)f=t[u],n[f.index]=+e(f,u,t)}}return a.initialize=function(u,c){t=u,r=c,l()},a.iterations=function(u){return arguments.length?(s=+u,a):s},a.strength=function(u){return arguments.length?(i=+u,a):i},a.radius=function(u){return arguments.length?(e=typeof u=="function"?u:so(+u),l(),a):e},a}function UJt(e){return e.index}function Xye(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function WJt(e){var t=UJt,n=f,r,i=so(30),s,a,o,l,u,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(o[m.source.index],o[m.target.index])}function h(m){for(var v=0,y=e.length;v<c;++v)for(var b=0,x,w,C,$,_,k,E;b<y;++b)x=e[b],w=x.source,C=x.target,$=C.x+C.vx-w.x-w.vx||Jg(u),_=C.y+C.vy-w.y-w.vy||Jg(u),k=Math.sqrt($*$+_*_),k=(k-s[b])/k*m*r[b],$*=k,_*=k,C.vx-=$*(E=l[b]),C.vy-=_*E,w.vx+=$*(E=1-E),w.vy+=_*E}function d(){if(!!a){var m,v=a.length,y=e.length,b=new Map(a.map((w,C)=>[t(w,C,a),w])),x;for(m=0,o=new Array(v);m<y;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=Xye(b,x.source)),typeof x.target!="object"&&(x.target=Xye(b,x.target)),o[x.source.index]=(o[x.source.index]||0)+1,o[x.target.index]=(o[x.target.index]||0)+1;for(m=0,l=new Array(y);m<y;++m)x=e[m],l[m]=o[x.source.index]/(o[x.source.index]+o[x.target.index]);r=new Array(y),p(),s=new Array(y),g()}}function p(){if(!!a)for(var m=0,v=e.length;m<v;++m)r[m]=+n(e[m],m,e)}function g(){if(!!a)for(var m=0,v=e.length;m<v;++m)s[m]=+i(e[m],m,e)}return h.initialize=function(m,v){a=m,u=v,d()},h.links=function(m){return arguments.length?(e=m,d(),h):e},h.id=function(m){return arguments.length?(t=m,h):t},h.iterations=function(m){return arguments.length?(c=+m,h):c},h.strength=function(m){return arguments.length?(n=typeof m=="function"?m:so(+m),p(),h):n},h.distance=function(m){return arguments.length?(i=typeof m=="function"?m:so(+m),g(),h):i},h}var VJt={value:()=>{}};function ABe(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new v4(n)}function v4(e){this._=e}function jJt(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}v4.prototype=ABe.prototype={constructor:v4,on:function(e,t){var n=this._,r=jJt(e+"",n),i,s=-1,a=r.length;if(arguments.length<2){for(;++s<a;)if((i=(e=r[s]).type)&&(i=HJt(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<a;)if(i=(e=r[s]).type)n[i]=Kye(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Kye(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new v4(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function HJt(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Kye(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=VJt,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var v$=0,TE=0,pk=0,TBe=1e3,kL,DE,EL=0,ib=0,z9=0,u3=typeof performance=="object"&&performance.now?performance:Date,DBe=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function yae(){return ib||(DBe(qJt),ib=u3.now()+z9)}function qJt(){ib=0}function AL(){this._call=this._time=this._next=null}AL.prototype=IBe.prototype={constructor:AL,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?yae():+n)+(t==null?0:+t),!this._next&&DE!==this&&(DE?DE._next=this:kL=this,DE=this),this._call=e,this._time=n,hZ()},stop:function(){this._call&&(this._call=null,this._time=1/0,hZ())}};function IBe(e,t,n){var r=new AL;return r.restart(e,t,n),r}function GJt(){yae(),++v$;for(var e=kL,t;e;)(t=ib-e._time)>=0&&e._call.call(null,t),e=e._next;--v$}function Zye(){ib=(EL=u3.now())+z9,v$=TE=0;try{GJt()}finally{v$=0,XJt(),ib=0}}function YJt(){var e=u3.now(),t=e-EL;t>TBe&&(z9-=t,EL=e)}function XJt(){for(var e,t=kL,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:kL=n);DE=e,hZ(r)}function hZ(e){if(!v$){TE&&(TE=clearTimeout(TE));var t=e-ib;t>24?(e<1/0&&(TE=setTimeout(Zye,e-u3.now()-z9)),pk&&(pk=clearInterval(pk))):(pk||(EL=u3.now(),pk=setInterval(YJt,TBe)),v$=1,DBe(Zye))}}function KJt(e,t,n){var r=new AL,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(s,a,o){a=+a,o=o==null?yae():+o,r._restart(function l(u){u+=i,r._restart(l,i+=a,o),s(u)},a,o)},r.restart(e,t,n),r)}const ZJt=1664525,QJt=1013904223,Qye=4294967296;function JJt(){let e=1;return()=>(e=(ZJt*e+QJt)%Qye)/Qye}function een(e){return e.x}function ten(e){return e.y}var nen=10,ren=Math.PI*(3-Math.sqrt(5));function ien(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,a=.6,o=new Map,l=IBe(f),u=ABe("tick","end"),c=JJt();e==null&&(e=[]);function f(){h(),u.call("tick",t),n<r&&(l.stop(),u.call("end",t))}function h(g){var m,v=e.length,y;g===void 0&&(g=1);for(var b=0;b<g;++b)for(n+=(s-n)*i,o.forEach(function(x){x(n)}),m=0;m<v;++m)y=e[m],y.fx==null?y.x+=y.vx*=a:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=a:(y.y=y.fy,y.vy=0);return t}function d(){for(var g=0,m=e.length,v;g<m;++g){if(v=e[g],v.index=g,v.fx!=null&&(v.x=v.fx),v.fy!=null&&(v.y=v.fy),isNaN(v.x)||isNaN(v.y)){var y=nen*Math.sqrt(.5+g),b=g*ren;v.x=y*Math.cos(b),v.y=y*Math.sin(b)}(isNaN(v.vx)||isNaN(v.vy))&&(v.vx=v.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return d(),t={tick:h,restart:function(){return l.restart(f),t},stop:function(){return l.stop(),t},nodes:function(g){return arguments.length?(e=g,d(),o.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(s=+g,t):s},velocityDecay:function(g){return arguments.length?(a=1-g,t):1-a},randomSource:function(g){return arguments.length?(c=g,o.forEach(p),t):c},force:function(g,m){return arguments.length>1?(m==null?o.delete(g):o.set(g,p(m)),t):o.get(g)},find:function(g,m,v){var y=0,b=e.length,x,w,C,$,_;for(v==null?v=1/0:v*=v,y=0;y<b;++y)$=e[y],x=g-$.x,w=m-$.y,C=x*x+w*w,C<v&&(_=$,v=C);return _},on:function(g,m){return arguments.length>1?(u.on(g,m),t):u.on(g)}}}function sen(){var e,t,n,r,i=so(-30),s,a=1,o=1/0,l=.81;function u(d){var p,g=e.length,m=mae(e,een,ten).visitAfter(f);for(r=d,p=0;p<g;++p)t=e[p],m.visit(h)}function c(){if(!!e){var d,p=e.length,g;for(s=new Array(p),d=0;d<p;++d)g=e[d],s[g.index]=+i(g,d,e)}}function f(d){var p=0,g,m,v=0,y,b,x;if(d.length){for(y=b=x=0;x<4;++x)(g=d[x])&&(m=Math.abs(g.value))&&(p+=g.value,v+=m,y+=m*g.x,b+=m*g.y);d.x=y/v,d.y=b/v}else{g=d,g.x=g.data.x,g.y=g.data.y;do p+=s[g.data.index];while(g=g.next)}d.value=p}function h(d,p,g,m){if(!d.value)return!0;var v=d.x-t.x,y=d.y-t.y,b=m-p,x=v*v+y*y;if(b*b/l<x)return x<o&&(v===0&&(v=Jg(n),x+=v*v),y===0&&(y=Jg(n),x+=y*y),x<a&&(x=Math.sqrt(a*x)),t.vx+=v*d.value*r/x,t.vy+=y*d.value*r/x),!0;if(d.length||x>=o)return;(d.data!==t||d.next)&&(v===0&&(v=Jg(n),x+=v*v),y===0&&(y=Jg(n),x+=y*y),x<a&&(x=Math.sqrt(a*x)));do d.data!==t&&(b=s[d.data.index]*r/x,t.vx+=v*b,t.vy+=y*b);while(d=d.next)}return u.initialize=function(d,p){e=d,n=p,c()},u.strength=function(d){return arguments.length?(i=typeof d=="function"?d:so(+d),c(),u):i},u.distanceMin=function(d){return arguments.length?(a=d*d,u):Math.sqrt(a)},u.distanceMax=function(d){return arguments.length?(o=d*d,u):Math.sqrt(o)},u.theta=function(d){return arguments.length?(l=d*d,u):Math.sqrt(l)},u}function aen(e){var t=so(.1),n,r,i;typeof e!="function"&&(e=so(e==null?0:+e));function s(o){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vx+=(i[l]-c.x)*r[l]*o}function a(){if(!!n){var o,l=n.length;for(r=new Array(l),i=new Array(l),o=0;o<l;++o)r[o]=isNaN(i[o]=+e(n[o],o,n))?0:+t(n[o],o,n)}}return s.initialize=function(o){n=o,a()},s.strength=function(o){return arguments.length?(t=typeof o=="function"?o:so(+o),a(),s):t},s.x=function(o){return arguments.length?(e=typeof o=="function"?o:so(+o),a(),s):e},s}function oen(e){var t=so(.1),n,r,i;typeof e!="function"&&(e=so(e==null?0:+e));function s(o){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vy+=(i[l]-c.y)*r[l]*o}function a(){if(!!n){var o,l=n.length;for(r=new Array(l),i=new Array(l),o=0;o<l;++o)r[o]=isNaN(i[o]=+e(n[o],o,n))?0:+t(n[o],o,n)}}return s.initialize=function(o){n=o,a()},s.strength=function(o){return arguments.length?(t=typeof o=="function"?o:so(+o),a(),s):t},s.y=function(o){return arguments.length?(e=typeof o=="function"?o:so(+o),a(),s):e},s}const Jye={center:wJt,collide:zJt,nbody:sen,link:WJt,x:aen,y:oen},IE="forces",dZ=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],len=["static","iterations"],NBe=["x","y","vx","vy"];function bae(e){me.call(this,null,e)}bae.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:NBe}]};Ie(bae,me,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(dZ),s=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&MBe(n,e,0,t)):(this.value=n=cen(t.source,e),n.on("tick",uen(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(len)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let o=this._argops,l=0,u=o.length,c;l<u;++l)if(c=o[l],!(c.name!==IE||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,s=r.length,a;i<s;++i)if(r[i].name==="links"&&(a=r[i].op.source)){n.pulse(a,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(NBe)}});function uen(e,t){return()=>e.touch(t).run()}function cen(e,t){const n=ien(e),r=n.stop,i=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,i()),n.stop=()=>(s=!0,r()),MBe(n,t,!0).on("end",()=>s=!0)}function MBe(e,t,n,r){var i=ct(t.forces),s,a,o,l;for(s=0,a=dZ.length;s<a;++s)o=dZ[s],o!==IE&&t.modified(o)&&e[o](t[o]);for(s=0,a=i.length;s<a;++s)l=IE+s,o=n||t.modified(IE,s)?hen(i[s]):r&&fen(i[s],r)?e.force(l):null,o&&e.force(l,o);for(a=e.numForces||0;s<a;++s)e.force(IE+s,null);return e.numForces=i.length,e}function fen(e,t){var n,r;for(n in e)if(Ut(r=e[n])&&t.modified(ao(r)))return 1;return 0}function hen(e){var t,n;bt(Jye,e.force)||$e("Unrecognized force: "+e.force),t=Jye[e.force]();for(n in e)Ut(t[n])&&den(t[n],e[n],e);return t}function den(e,t,n){e(Ut(t)?r=>t(r,n):t)}const pen=Object.freeze(Object.defineProperty({__proto__:null,force:bae},Symbol.toStringTag,{value:"Module"}));function gen(e,t){return e.parent===t.parent?1:2}function men(e){return e.reduce(ven,0)/e.length}function ven(e,t){return e+t.x}function yen(e){return 1+e.reduce(ben,0)}function ben(e,t){return Math.max(e,t.y)}function xen(e){for(var t;t=e.children;)e=t[0];return e}function wen(e){for(var t;t=e.children;)e=t[t.length-1];return e}function $en(){var e=gen,t=1,n=1,r=!1;function i(s){var a,o=0;s.eachAfter(function(h){var d=h.children;d?(h.x=men(d),h.y=yen(d)):(h.x=a?o+=e(h,a):0,h.y=0,a=h)});var l=xen(s),u=wen(s),c=l.x-e(l,u)/2,f=u.x+e(u,l)/2;return s.eachAfter(r?function(h){h.x=(h.x-s.x)*t,h.y=(s.y-h.y)*n}:function(h){h.x=(h.x-c)/(f-c)*t,h.y=(1-(s.y?h.y/s.y:1))*n})}return i.separation=function(s){return arguments.length?(e=s,i):e},i.size=function(s){return arguments.length?(r=!1,t=+s[0],n=+s[1],i):r?null:[t,n]},i.nodeSize=function(s){return arguments.length?(r=!0,t=+s[0],n=+s[1],i):r?[t,n]:null},i}function Cen(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function _en(){return this.eachAfter(Cen)}function Sen(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function ken(e,t){for(var n=this,r=[n],i,s,a=-1;n=r.pop();)if(e.call(t,n,++a,this),i=n.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function Een(e,t){for(var n=this,r=[n],i=[],s,a,o,l=-1;n=r.pop();)if(i.push(n),s=n.children)for(a=0,o=s.length;a<o;++a)r.push(s[a]);for(;n=i.pop();)e.call(t,n,++l,this);return this}function Aen(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function Ten(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Den(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Ien(e){for(var t=this,n=Nen(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function Nen(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function Men(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Fen(){return Array.from(this)}function Oen(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Ren(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*Pen(){var e=this,t,n=[e],r,i,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,s=r.length;i<s;++i)n.push(r[i]);while(n.length)}function xae(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=zen)):t===void 0&&(t=Ben);for(var n=new y$(e),r,i=[n],s,a,o,l;r=i.pop();)if((a=t(r.data))&&(l=(a=Array.from(a)).length))for(r.children=a,o=l-1;o>=0;--o)i.push(s=a[o]=new y$(a[o])),s.parent=r,s.depth=r.depth+1;return n.eachBefore(FBe)}function Len(){return xae(this).eachBefore(Uen)}function Ben(e){return e.children}function zen(e){return Array.isArray(e)?e[1]:null}function Uen(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function FBe(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function y$(e){this.data=e,this.depth=this.height=0,this.parent=null}y$.prototype=xae.prototype={constructor:y$,count:_en,each:Sen,eachAfter:Een,eachBefore:ken,find:Aen,sum:Ten,sort:Den,path:Ien,ancestors:Men,descendants:Fen,leaves:Oen,links:Ren,copy:Len,[Symbol.iterator]:Pen};function Wen(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ven(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function jen(e){for(var t=0,n=(e=Ven(Array.from(e))).length,r=[],i,s;t<n;)i=e[t],s&&OBe(s,i)?++t:(s=qen(r=Hen(r,i)),t=0);return s}function Hen(e,t){var n,r;if(MH(t,e))return[t];for(n=0;n<e.length;++n)if(JO(t,e[n])&&MH(NE(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(JO(NE(e[n],e[r]),t)&&JO(NE(e[n],t),e[r])&&JO(NE(e[r],t),e[n])&&MH(RBe(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function JO(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function OBe(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function MH(e,t){for(var n=0;n<t.length;++n)if(!OBe(e,t[n]))return!1;return!0}function qen(e){switch(e.length){case 1:return Gen(e[0]);case 2:return NE(e[0],e[1]);case 3:return RBe(e[0],e[1],e[2])}}function Gen(e){return{x:e.x,y:e.y,r:e.r}}function NE(e,t){var n=e.x,r=e.y,i=e.r,s=t.x,a=t.y,o=t.r,l=s-n,u=a-r,c=o-i,f=Math.sqrt(l*l+u*u);return{x:(n+s+l/f*c)/2,y:(r+a+u/f*c)/2,r:(f+i+o)/2}}function RBe(e,t,n){var r=e.x,i=e.y,s=e.r,a=t.x,o=t.y,l=t.r,u=n.x,c=n.y,f=n.r,h=r-a,d=r-u,p=i-o,g=i-c,m=l-s,v=f-s,y=r*r+i*i-s*s,b=y-a*a-o*o+l*l,x=y-u*u-c*c+f*f,w=d*p-h*g,C=(p*x-g*b)/(w*2)-r,$=(g*m-p*v)/w,_=(d*b-h*x)/(w*2)-i,k=(h*v-d*m)/w,E=$*$+k*k-1,S=2*(s+C*$+_*k),I=C*C+_*_-s*s,A=-(E?(S+Math.sqrt(S*S-4*E*I))/(2*E):I/S);return{x:r+C+$*A,y:i+_+k*A,r:A}}function ebe(e,t,n){var r=e.x-t.x,i,s,a=e.y-t.y,o,l,u=r*r+a*a;u?(s=t.r+n.r,s*=s,l=e.r+n.r,l*=l,s>l?(i=(u+l-s)/(2*u),o=Math.sqrt(Math.max(0,l/u-i*i)),n.x=e.x-i*r-o*a,n.y=e.y-i*a+o*r):(i=(u+s-l)/(2*u),o=Math.sqrt(Math.max(0,s/u-i*i)),n.x=t.x+i*r-o*a,n.y=t.y+i*a+o*r)):(n.x=t.x+n.r,n.y=t.y)}function tbe(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function nbe(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,s=(t.y*n.r+n.y*t.r)/r;return i*i+s*s}function eR(e){this._=e,this.next=null,this.previous=null}function Yen(e){if(!(i=(e=Wen(e)).length))return 0;var t,n,r,i,s,a,o,l,u,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;ebe(n,t,r=e[2]),t=new eR(t),n=new eR(n),r=new eR(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(o=3;o<i;++o){ebe(t._,n._,r=e[o]),r=new eR(r),l=n.next,u=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(tbe(l._,r._)){n=l,t.next=n,n.previous=t,--o;continue e}c+=l._.r,l=l.next}else{if(tbe(u._,r._)){t=u,t.next=n,n.previous=t,--o;continue e}f+=u._.r,u=u.previous}while(l!==u.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,s=nbe(t);(r=r.next)!==n;)(a=nbe(r))<s&&(t=r,s=a);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=jen(t),o=0;o<i;++o)t=e[o],t.x-=r.x,t.y-=r.y;return r.r}function Xen(e){return e==null?null:TL(e)}function TL(e){if(typeof e!="function")throw new Error;return e}function d1(){return 0}function S2(e){return function(){return e}}function Ken(e){return Math.sqrt(e.value)}function Zen(){var e=null,t=1,n=1,r=d1;function i(s){return s.x=t/2,s.y=n/2,e?s.eachBefore(rbe(e)).eachAfter(FH(r,.5)).eachBefore(ibe(1)):s.eachBefore(rbe(Ken)).eachAfter(FH(d1,1)).eachAfter(FH(r,s.r/Math.min(t,n))).eachBefore(ibe(Math.min(t,n)/(2*s.r))),s}return i.radius=function(s){return arguments.length?(e=Xen(s),i):e},i.size=function(s){return arguments.length?(t=+s[0],n=+s[1],i):[t,n]},i.padding=function(s){return arguments.length?(r=typeof s=="function"?s:S2(+s),i):r},i}function rbe(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function FH(e,t){return function(n){if(r=n.children){var r,i,s=r.length,a=e(n)*t||0,o;if(a)for(i=0;i<s;++i)r[i].r+=a;if(o=Yen(r),a)for(i=0;i<s;++i)r[i].r-=a;n.r=o+a}}}function ibe(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function PBe(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function yM(e,t,n,r,i){for(var s=e.children,a,o=-1,l=s.length,u=e.value&&(r-t)/e.value;++o<l;)a=s[o],a.y0=n,a.y1=i,a.x0=t,a.x1=t+=a.value*u}function Qen(){var e=1,t=1,n=0,r=!1;function i(a){var o=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/o,a.eachBefore(s(t,o)),r&&a.eachBefore(PBe),a}function s(a,o){return function(l){l.children&&yM(l,l.x0,a*(l.depth+1)/o,l.x1,a*(l.depth+2)/o);var u=l.x0,c=l.y0,f=l.x1-n,h=l.y1-n;f<u&&(u=f=(u+f)/2),h<c&&(c=h=(c+h)/2),l.x0=u,l.y0=c,l.x1=f,l.y1=h}}return i.round=function(a){return arguments.length?(r=!!a,i):r},i.size=function(a){return arguments.length?(e=+a[0],t=+a[1],i):[e,t]},i.padding=function(a){return arguments.length?(n=+a,i):n},i}var Jen={depth:-1},sbe={};function etn(e){return e.id}function ttn(e){return e.parentId}function abe(){var e=etn,t=ttn;function n(r){var i=Array.from(r),s=i.length,a,o,l,u,c,f,h,d=new Map;for(o=0;o<s;++o)a=i[o],c=i[o]=new y$(a),(f=e(a,o,r))!=null&&(f+="")&&(h=c.id=f,d.set(h,d.has(h)?sbe:c)),(f=t(a,o,r))!=null&&(f+="")&&(c.parent=f);for(o=0;o<s;++o)if(c=i[o],f=c.parent){if(u=d.get(f),!u)throw new Error("missing: "+f);if(u===sbe)throw new Error("ambiguous: "+f);u.children?u.children.push(c):u.children=[c],c.parent=u}else{if(l)throw new Error("multiple roots");l=c}if(!l)throw new Error("no root");if(l.parent=Jen,l.eachBefore(function(p){p.depth=p.parent.depth+1,--s}).eachBefore(FBe),l.parent=null,s>0)throw new Error("cycle");return l}return n.id=function(r){return arguments.length?(e=TL(r),n):e},n.parentId=function(r){return arguments.length?(t=TL(r),n):t},n}function ntn(e,t){return e.parent===t.parent?1:2}function OH(e){var t=e.children;return t?t[0]:e.t}function RH(e){var t=e.children;return t?t[t.length-1]:e.t}function rtn(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function itn(e){for(var t=0,n=0,r=e.children,i=r.length,s;--i>=0;)s=r[i],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function stn(e,t,n){return e.a.parent===t.parent?e.a:n}function y4(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}y4.prototype=Object.create(y$.prototype);function atn(e){for(var t=new y4(e,0),n,r=[t],i,s,a,o;n=r.pop();)if(s=n._.children)for(n.children=new Array(o=s.length),a=o-1;a>=0;--a)r.push(i=n.children[a]=new y4(s[a],a)),i.parent=n;return(t.parent=new y4(null,0)).children=[t],t}function otn(){var e=ntn,t=1,n=1,r=null;function i(u){var c=atn(u);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(a),r)u.eachBefore(l);else{var f=u,h=u,d=u;u.eachBefore(function(y){y.x<f.x&&(f=y),y.x>h.x&&(h=y),y.depth>d.depth&&(d=y)});var p=f===h?1:e(f,h)/2,g=p-f.x,m=t/(h.x+p+g),v=n/(d.depth||1);u.eachBefore(function(y){y.x=(y.x+g)*m,y.y=y.depth*v})}return u}function s(u){var c=u.children,f=u.parent.children,h=u.i?f[u.i-1]:null;if(c){itn(u);var d=(c[0].z+c[c.length-1].z)/2;h?(u.z=h.z+e(u._,h._),u.m=u.z-d):u.z=d}else h&&(u.z=h.z+e(u._,h._));u.parent.A=o(u,h,u.parent.A||f[0])}function a(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function o(u,c,f){if(c){for(var h=u,d=u,p=c,g=h.parent.children[0],m=h.m,v=d.m,y=p.m,b=g.m,x;p=RH(p),h=OH(h),p&&h;)g=OH(g),d=RH(d),d.a=u,x=p.z+y-h.z-m+e(p._,h._),x>0&&(rtn(stn(p,u,f),u,x),m+=x,v+=x),y+=p.m,m+=h.m,b+=g.m,v+=d.m;p&&!RH(d)&&(d.t=p,d.m+=y-v),h&&!OH(g)&&(g.t=h,g.m+=m-b,f=u)}return f}function l(u){u.x*=t,u.y=u.depth*n}return i.separation=function(u){return arguments.length?(e=u,i):e},i.size=function(u){return arguments.length?(r=!1,t=+u[0],n=+u[1],i):r?null:[t,n]},i.nodeSize=function(u){return arguments.length?(r=!0,t=+u[0],n=+u[1],i):r?[t,n]:null},i}function U9(e,t,n,r,i){for(var s=e.children,a,o=-1,l=s.length,u=e.value&&(i-n)/e.value;++o<l;)a=s[o],a.x0=t,a.x1=r,a.y0=n,a.y1=n+=a.value*u}var LBe=(1+Math.sqrt(5))/2;function BBe(e,t,n,r,i,s){for(var a=[],o=t.children,l,u,c=0,f=0,h=o.length,d,p,g=t.value,m,v,y,b,x,w,C;c<h;){d=i-n,p=s-r;do m=o[f++].value;while(!m&&f<h);for(v=y=m,w=Math.max(p/d,d/p)/(g*e),C=m*m*w,x=Math.max(y/C,C/v);f<h;++f){if(m+=u=o[f].value,u<v&&(v=u),u>y&&(y=u),C=m*m*w,b=Math.max(y/C,C/v),b>x){m-=u;break}x=b}a.push(l={value:m,dice:d<p,children:o.slice(c,f)}),l.dice?yM(l,n,r,i,g?r+=p*m/g:s):U9(l,n,r,g?n+=d*m/g:i,s),g-=m,c=f}return a}const zBe=function e(t){function n(r,i,s,a,o){BBe(t,r,i,s,a,o)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(LBe);function ltn(){var e=zBe,t=!1,n=1,r=1,i=[0],s=d1,a=d1,o=d1,l=d1,u=d1;function c(h){return h.x0=h.y0=0,h.x1=n,h.y1=r,h.eachBefore(f),i=[0],t&&h.eachBefore(PBe),h}function f(h){var d=i[h.depth],p=h.x0+d,g=h.y0+d,m=h.x1-d,v=h.y1-d;m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),h.x0=p,h.y0=g,h.x1=m,h.y1=v,h.children&&(d=i[h.depth+1]=s(h)/2,p+=u(h)-d,g+=a(h)-d,m-=o(h)-d,v-=l(h)-d,m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),e(h,p,g,m,v))}return c.round=function(h){return arguments.length?(t=!!h,c):t},c.size=function(h){return arguments.length?(n=+h[0],r=+h[1],c):[n,r]},c.tile=function(h){return arguments.length?(e=TL(h),c):e},c.padding=function(h){return arguments.length?c.paddingInner(h).paddingOuter(h):c.paddingInner()},c.paddingInner=function(h){return arguments.length?(s=typeof h=="function"?h:S2(+h),c):s},c.paddingOuter=function(h){return arguments.length?c.paddingTop(h).paddingRight(h).paddingBottom(h).paddingLeft(h):c.paddingTop()},c.paddingTop=function(h){return arguments.length?(a=typeof h=="function"?h:S2(+h),c):a},c.paddingRight=function(h){return arguments.length?(o=typeof h=="function"?h:S2(+h),c):o},c.paddingBottom=function(h){return arguments.length?(l=typeof h=="function"?h:S2(+h),c):l},c.paddingLeft=function(h){return arguments.length?(u=typeof h=="function"?h:S2(+h),c):u},c}function utn(e,t,n,r,i){var s=e.children,a,o=s.length,l,u=new Array(o+1);for(u[0]=l=a=0;a<o;++a)u[a+1]=l+=s[a].value;c(0,o,e.value,t,n,r,i);function c(f,h,d,p,g,m,v){if(f>=h-1){var y=s[f];y.x0=p,y.y0=g,y.x1=m,y.y1=v;return}for(var b=u[f],x=d/2+b,w=f+1,C=h-1;w<C;){var $=w+C>>>1;u[$]<x?w=$+1:C=$}x-u[w-1]<u[w]-x&&f+1<w&&--w;var _=u[w]-b,k=d-_;if(m-p>v-g){var E=d?(p*k+m*_)/d:m;c(f,w,_,p,g,E,v),c(w,h,k,E,g,m,v)}else{var S=d?(g*k+v*_)/d:v;c(f,w,_,p,g,m,S),c(w,h,k,p,S,m,v)}}}function ctn(e,t,n,r,i){(e.depth&1?U9:yM)(e,t,n,r,i)}const ftn=function e(t){function n(r,i,s,a,o){if((l=r._squarify)&&l.ratio===t)for(var l,u,c,f,h=-1,d,p=l.length,g=r.value;++h<p;){for(u=l[h],c=u.children,f=u.value=0,d=c.length;f<d;++f)u.value+=c[f].value;u.dice?yM(u,i,s,a,g?s+=(o-s)*u.value/g:o):U9(u,i,s,g?i+=(a-i)*u.value/g:a,o),g-=u.value}else r._squarify=l=BBe(t,r,i,s,a,o),l.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(LBe);function pZ(e,t,n){const r={};return e.each(i=>{const s=i.data;n(s)&&(r[t(s)]=i)}),e.lookup=r,e}function wae(e){me.call(this,null,e)}wae.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const htn=e=>e.values;Ie(wae,me,{transform(e,t){t.source||$e("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),s=this.value;return(!s||r||t.changed())&&(s&&s.each(a=>{a.children&&P_(a.data)&&i.rem.push(a.data)}),this.value=s=xae({values:ct(e.keys).reduce((a,o)=>(a.key(o),a),dtn()).entries(i.source)},htn),n&&s.each(a=>{a.children&&(a=Tn(a.data),i.add.push(a),i.source.push(a))}),pZ(s,nt,nt)),i.source.root=s,i}});function dtn(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,s){if(s>=e.length)return i;const a=i.length,o=e[s++],l={},u={};let c=-1,f,h,d;for(;++c<a;)f=o(h=i[c])+"",(d=l[f])?d.push(h):l[f]=[h];for(f in l)u[f]=n(l[f],s);return u}function r(i,s){if(++s>e.length)return i;const a=[];for(const o in i)a.push({key:o,values:r(i[o],s)});return a}return t}function fg(e){me.call(this,null,e)}const ptn=(e,t)=>e.parent===t.parent?1:2;Ie(fg,me,{transform(e,t){(!t.source||!t.source.root)&&$e(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,s=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(ix(e.sort,a=>a.data)),gtn(n,this.params,e),n.separation&&n.separation(e.separation!==!1?ptn:HN);try{this.value=n(i)}catch(a){$e(a)}return i.each(a=>mtn(a,r,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});function gtn(e,t,n){for(let r,i=0,s=t.length;i<s;++i)r=t[i],r in n&&e[r](n[r])}function mtn(e,t,n){const r=e.data,i=t.length-1;for(let s=0;s<i;++s)r[n[s]]=e[t[s]];r[n[i]]=e.children?e.children.length:0}const gZ=["x","y","r","depth","children"];function $ae(e){fg.call(this,e)}$ae.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:gZ.length,default:gZ}]};Ie($ae,fg,{layout:Zen,params:["radius","size","padding"],fields:gZ});const mZ=["x0","y0","x1","y1","depth","children"];function Cae(e){fg.call(this,e)}Cae.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:mZ.length,default:mZ}]};Ie(Cae,fg,{layout:Qen,params:["size","round","padding"],fields:mZ});function _ae(e){me.call(this,null,e)}_ae.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};Ie(_ae,me,{transform(e,t){t.source||$e("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),s=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),s&&(n=i.source.length?pZ(abe().id(e.key).parentId(e.parentKey)(i.source),e.key,Jc):pZ(abe()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const obe={tidy:otn,cluster:$en},vZ=["x","y","depth","children"];function Sae(e){fg.call(this,e)}Sae.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:vZ.length,default:vZ}]};Ie(Sae,fg,{layout(e){const t=e||"tidy";if(bt(obe,t))return obe[t]();$e("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:vZ});function kae(e){me.call(this,[],e)}kae.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};Ie(kae,me,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),s={};return r||$e("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,a=>s[nt(a)]=1),r.each(a=>{const o=a.data,l=a.parent&&a.parent.data;l&&s[nt(o)]&&s[nt(l)]&&i.add.push(Tn({source:l,target:o}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,a=>s[nt(a)]=1),n.forEach(a=>{(s[nt(a.source)]||s[nt(a.target)])&&i.mod.push(a)})),i}});const lbe={binary:utn,dice:yM,slice:U9,slicedice:ctn,squarify:zBe,resquarify:ftn},yZ=["x0","y0","x1","y1","depth","children"];function Eae(e){fg.call(this,e)}Eae.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:yZ.length,default:yZ}]};Ie(Eae,fg,{layout(){const e=ltn();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{bt(lbe,t)?e.tile(lbe[t]):$e("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:yZ});const vtn=Object.freeze(Object.defineProperty({__proto__:null,nest:wae,pack:$ae,partition:Cae,stratify:_ae,tree:Sae,treelinks:kae,treemap:Eae},Symbol.toStringTag,{value:"Module"})),ytn=4278190080,btn=268435456,xtn=.0625;function wtn(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function $tn(e,t,n,r){const i=e.width,s=e.height,a=n||r,o=Yu(i,s).getContext("2d");t.forEach(m=>UBe(o,m,a));const l=new Uint32Array(o.getImageData(0,0,i,s).data.buffer),u=e.bitmap(),c=a&&e.bitmap();let f,h,d,p,g;for(h=0;h<s;++h)for(f=0;f<i;++f)g=l[h*i+f]&ytn,g&&(d=e(f),p=e(h),r||u.set(d,p),a&&g^btn&&c.set(d,p));return[u,c]}function UBe(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(s=>UBe(e,s.items,n))}):Pu[r].draw(e,{items:n?t.map(Ctn):t})}function Ctn(e){const t=Q7(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=xtn,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const Nd=5,La=31,c3=32,Rg=new Uint32Array(c3+1),bc=new Uint32Array(c3+1);bc[0]=0;Rg[0]=~bc[0];for(let e=1;e<=c3;++e)bc[e]=bc[e-1]<<1|1,Rg[e]=~bc[e];function _tn(e,t){const n=new Uint32Array(~~((e*t+c3)/c3));function r(s,a){n[s]|=a}function i(s,a){n[s]&=a}return{array:n,get:(s,a)=>{const o=a*e+s;return n[o>>>Nd]&1<<(o&La)},set:(s,a)=>{const o=a*e+s;r(o>>>Nd,1<<(o&La))},clear:(s,a)=>{const o=a*e+s;i(o>>>Nd,~(1<<(o&La)))},getRange:(s,a,o,l)=>{let u=l,c,f,h,d;for(;u>=a;--u)if(c=u*e+s,f=u*e+o,h=c>>>Nd,d=f>>>Nd,h===d){if(n[h]&Rg[c&La]&bc[(f&La)+1])return!0}else{if(n[h]&Rg[c&La]||n[d]&bc[(f&La)+1])return!0;for(let p=h+1;p<d;++p)if(n[p])return!0}return!1},setRange:(s,a,o,l)=>{let u,c,f,h,d;for(;a<=l;++a)if(u=a*e+s,c=a*e+o,f=u>>>Nd,h=c>>>Nd,f===h)r(f,Rg[u&La]&bc[(c&La)+1]);else for(r(f,Rg[u&La]),r(h,bc[(c&La)+1]),d=f+1;d<h;++d)r(d,4294967295)},clearRange:(s,a,o,l)=>{let u,c,f,h,d;for(;a<=l;++a)if(u=a*e+s,c=a*e+o,f=u>>>Nd,h=c>>>Nd,f===h)i(f,bc[u&La]|Rg[(c&La)+1]);else for(i(f,bc[u&La]),i(h,Rg[(c&La)+1]),d=f+1;d<h;++d)i(d,0)},outOfBounds:(s,a,o,l)=>s<0||a<0||l>=t||o>=e}}function Stn(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),s=~~((t+2*n+r)/r),a=o=>~~((o+n)/r);return a.invert=o=>o*r-n,a.bitmap=()=>_tn(i,s),a.ratio=r,a.padding=n,a.width=e,a.height=t,a}function ktn(e,t,n,r){const i=e.width,s=e.height;return function(a){const o=a.datum.datum.items[r].items,l=o.length,u=a.datum.fontSize,c=bp.width(a.datum,a.datum.text);let f=0,h,d,p,g,m,v,y;for(let b=0;b<l;++b)h=o[b].x,p=o[b].y,d=o[b].x2===void 0?h:o[b].x2,g=o[b].y2===void 0?p:o[b].y2,m=(h+d)/2,v=(p+g)/2,y=Math.abs(d-h+g-p),y>=f&&(f=y,a.x=m,a.y=v);return m=c/2,v=u/2,h=a.x-m,d=a.x+m,p=a.y-v,g=a.y+v,a.align="center",h<0&&d<=i?a.align="left":0<=h&&i<d&&(a.align="right"),a.baseline="middle",p<0&&g<=s?a.baseline="top":0<=p&&s<g&&(a.baseline="bottom"),!0}}function DL(e,t,n,r,i,s){let a=n/2;return e-a<0||e+a>i||t-(a=r/2)<0||t+a>s}function e0(e,t,n,r,i,s,a,o){const l=i*s/(r*2),u=e(t-l),c=e(t+l),f=e(n-(s=s/2)),h=e(n+s);return a.outOfBounds(u,f,c,h)||a.getRange(u,f,c,h)||o&&o.getRange(u,f,c,h)}function Etn(e,t,n,r){const i=e.width,s=e.height,a=t[0],o=t[1];function l(u,c,f,h,d){const p=e.invert(u),g=e.invert(c);let m=f,v=s,y;if(!DL(p,g,h,d,i,s)&&!e0(e,p,g,d,h,m,a,o)&&!e0(e,p,g,d,h,d,a,null)){for(;v-m>=1;)y=(m+v)/2,e0(e,p,g,d,h,y,a,o)?v=y:m=y;if(m>f)return[p,g,m,!0]}}return function(u){const c=u.datum.datum.items[r].items,f=c.length,h=u.datum.fontSize,d=bp.width(u.datum,u.datum.text);let p=n?h:0,g=!1,m=!1,v=0,y,b,x,w,C,$,_,k,E,S,I,A,D,T,N,F,R;for(let P=0;P<f;++P){for(y=c[P].x,x=c[P].y,b=c[P].x2===void 0?y:c[P].x2,w=c[P].y2===void 0?x:c[P].y2,y>b&&(R=y,y=b,b=R),x>w&&(R=x,x=w,w=R),E=e(y),I=e(b),S=~~((E+I)/2),A=e(x),T=e(w),D=~~((A+T)/2),_=S;_>=E;--_)for(k=D;k>=A;--k)F=l(_,k,p,d,h),F&&([u.x,u.y,p,g]=F);for(_=S;_<=I;++_)for(k=D;k<=T;++k)F=l(_,k,p,d,h),F&&([u.x,u.y,p,g]=F);!g&&!n&&(N=Math.abs(b-y+w-x),C=(y+b)/2,$=(x+w)/2,N>=v&&!DL(C,$,d,h,i,s)&&!e0(e,C,$,h,d,h,a,null)&&(v=N,u.x=C,u.y=$,m=!0))}return g||m?(C=d/2,$=h/2,a.setRange(e(u.x-C),e(u.y-$),e(u.x+C),e(u.y+$)),u.align="center",u.baseline="middle",!0):!1}}const Atn=[-1,-1,1,1],Ttn=[-1,1,-1,1];function Dtn(e,t,n,r){const i=e.width,s=e.height,a=t[0],o=t[1],l=e.bitmap();return function(u){const c=u.datum.datum.items[r].items,f=c.length,h=u.datum.fontSize,d=bp.width(u.datum,u.datum.text),p=[];let g=n?h:0,m=!1,v=!1,y=0,b,x,w,C,$,_,k,E,S,I,A,D;for(let T=0;T<f;++T){for(b=c[T].x,w=c[T].y,x=c[T].x2===void 0?b:c[T].x2,C=c[T].y2===void 0?w:c[T].y2,p.push([e((b+x)/2),e((w+C)/2)]);p.length;)if([k,E]=p.pop(),!(a.get(k,E)||o.get(k,E)||l.get(k,E))){l.set(k,E);for(let N=0;N<4;++N)$=k+Atn[N],_=E+Ttn[N],l.outOfBounds($,_,$,_)||p.push([$,_]);if($=e.invert(k),_=e.invert(E),S=g,I=s,!DL($,_,d,h,i,s)&&!e0(e,$,_,h,d,S,a,o)&&!e0(e,$,_,h,d,h,a,null)){for(;I-S>=1;)A=(S+I)/2,e0(e,$,_,h,d,A,a,o)?I=A:S=A;S>g&&(u.x=$,u.y=_,g=S,m=!0)}}!m&&!n&&(D=Math.abs(x-b+C-w),$=(b+x)/2,_=(w+C)/2,D>=y&&!DL($,_,d,h,i,s)&&!e0(e,$,_,h,d,h,a,null)&&(y=D,u.x=$,u.y=_,v=!0))}return m||v?($=d/2,_=h/2,a.setRange(e(u.x-$),e(u.y-_),e(u.x+$),e(u.y+_)),u.align="center",u.baseline="middle",!0):!1}}const Itn=["right","center","left"],Ntn=["bottom","middle","top"];function Mtn(e,t,n,r){const i=e.width,s=e.height,a=t[0],o=t[1],l=r.length;return function(u){const c=u.boundary,f=u.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>s)return!1;let h=0,d,p,g,m,v,y,b,x,w,C,$,_,k,E,S;for(let I=0;I<l;++I){if(d=(n[I]&3)-1,p=(n[I]>>>2&3)-1,g=d===0&&p===0||r[I]<0,m=d&&p?Math.SQRT1_2:1,v=r[I]<0?-1:1,y=c[1+d]+r[I]*d*m,$=c[4+p]+v*f*p/2+r[I]*p*m,x=$-f/2,w=$+f/2,_=e(y),E=e(x),S=e(w),!h)if(ube(_,_,E,S,a,o,y,y,x,w,c,g))h=bp.width(u.datum,u.datum.text);else continue;if(C=y+v*h*d/2,y=C-h/2,b=C+h/2,_=e(y),k=e(b),ube(_,k,E,S,a,o,y,b,x,w,c,g))return u.x=d?d*v<0?b:y:C,u.y=p?p*v<0?w:x:$,u.align=Itn[d*v+1],u.baseline=Ntn[p*v+1],a.setRange(_,E,k,S),!0}return!1}}function ube(e,t,n,r,i,s,a,o,l,u,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&s?s.getRange(e,n,t,r)||!Ftn(a,l,o,u,c):i.getRange(e,n,t,r)))}function Ftn(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}const PH=0,LH=4,BH=8,zH=0,UH=1,WH=2,Otn={"top-left":PH+zH,top:PH+UH,"top-right":PH+WH,left:LH+zH,middle:LH+UH,right:LH+WH,"bottom-left":BH+zH,bottom:BH+UH,"bottom-right":BH+WH},Rtn={naive:ktn,"reduced-search":Etn,floodfill:Dtn};function Ptn(e,t,n,r,i,s,a,o,l,u,c){if(!e.length)return e;const f=Math.max(r.length,i.length),h=Ltn(r,f),d=Btn(i,f),p=ztn(e[0].datum),g=p==="group"&&e[0].datum.items[l].marktype,m=g==="area",v=Utn(p,g,o,l),y=Stn(t[0],t[1],u),b=m&&c==="naive",x=e.map($=>({datum:$,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:v($)}));let w;if(!b){n&&x.sort((_,k)=>n(_.datum,k.datum));let $=!1;for(let _=0;_<d.length&&!$;++_)$=d[_]===5||h[_]<0;p&&(a||m)&&(s=[e.map(_=>_.datum)].concat(s)),w=s.length?$tn(y,s,$,m):wtn(y,a&&x)}const C=m?Rtn[c](y,w,a,l):Mtn(y,w,d,h);return x.forEach($=>$.opacity=+C($)),x}function Ltn(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Btn(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=Otn[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function ztn(e){return e&&e.mark&&e.mark.marktype}function Utn(e,t,n,r){const i=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?e==="line"||e==="area"?s=>i(s.datum):t==="line"?s=>{const a=s.datum.items[r].items;return i(a.length?a[n==="start"?0:a.length-1]:{x:NaN,y:NaN})}:s=>{const a=s.datum.bounds;return[a.x1,(a.x1+a.x2)/2,a.x2,a.y1,(a.y1+a.y2)/2,a.y2]}:i}const bZ=["x","y","opacity","align","baseline"],WBe=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function Aae(e){me.call(this,null,e)}Aae.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:WBe},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:bZ.length,default:bZ}]};Ie(Aae,me,{transform(e,t){function n(s){const a=e[s];return Ut(a)&&t.modified(a.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&$e("Size parameter should be specified as a [width, height] array.");const i=e.as||bZ;return Ptn(t.materialize(t.SOURCE).source,e.size,e.sort,ct(e.offset||1),ct(e.anchor||WBe),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach(s=>{const a=s.datum;a[i[0]]=s.x,a[i[1]]=s.y,a[i[2]]=s.opacity,a[i[3]]=s.align,a[i[4]]=s.baseline}),t.reflow(r).modifies(i)}});const Wtn=Object.freeze(Object.defineProperty({__proto__:null,label:Aae},Symbol.toStringTag,{value:"Module"}));function VBe(e,t){var n=[],r=function(c){return c(o)},i,s,a,o,l,u;if(t==null)n.push(e);else for(i={},s=0,a=e.length;s<a;++s)o=e[s],l=t.map(r),u=i[l],u||(i[l]=u=[],u.dims=l,n.push(u)),u.push(o);return n}function Tae(e){me.call(this,null,e)}Tae.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};Ie(Tae,me,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=VBe(r,e.groupby),s=(e.groupby||[]).map(li),a=s.length,o=e.as||[li(e.x),li(e.y)],l=[];i.forEach(u=>{a9t(u,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let h=0;h<a;++h)f[s[h]]=u.dims[h];f[o[0]]=c[0],f[o[1]]=c[1],l.push(Tn(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const xZ={linear:$Re,log:e9t,exp:t9t,pow:n9t,quad:CRe,poly:r9t},Vtn=(e,t)=>e==="poly"?t:e==="quad"?2:1;function Dae(e){me.call(this,null,e)}Dae.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(xZ)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};Ie(Dae,me,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=VBe(r,e.groupby),s=(e.groupby||[]).map(li),a=e.method||"linear",o=e.order||3,l=Vtn(a,o),u=e.as||[li(e.x),li(e.y)],c=xZ[a],f=[];let h=e.extent;bt(xZ,a)||$e("Invalid regression method: "+a),h!=null&&a==="log"&&h[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),h=null),i.forEach(d=>{if(d.length<=l){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(d,e.x,e.y,o);if(e.params){f.push(Tn({keys:d.dims,coef:g.coef,rSquared:g.rSquared}));return}const m=h||Op(d,e.x),v=y=>{const b={};for(let x=0;x<s.length;++x)b[s[x]]=d.dims[x];b[u[0]]=y[0],b[u[1]]=y[1],f.push(Tn(b))};a==="linear"?m.forEach(y=>v([y,g.predict(y)])):qre(g.predict,m,25,200).forEach(v)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const jtn=Object.freeze(Object.defineProperty({__proto__:null,loess:Tae,regression:Dae},Symbol.toStringTag,{value:"Module"})),cbe=Math.pow(2,-52),tR=new Uint32Array(512);class IL{static from(t,n=Xtn,r=Ktn){const i=t.length,s=new Float64Array(i*2);for(let a=0;a<i;a++){const o=t[a];s[2*a]=n(o),s[2*a+1]=r(o)}return new IL(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:s}=this,a=t.length>>1;let o=1/0,l=1/0,u=-1/0,c=-1/0;for(let E=0;E<a;E++){const S=t[2*E],I=t[2*E+1];S<o&&(o=S),I<l&&(l=I),S>u&&(u=S),I>c&&(c=I),this._ids[E]=E}const f=(o+u)/2,h=(l+c)/2;let d=1/0,p,g,m;for(let E=0;E<a;E++){const S=VH(f,h,t[2*E],t[2*E+1]);S<d&&(p=E,d=S)}const v=t[2*p],y=t[2*p+1];d=1/0;for(let E=0;E<a;E++){if(E===p)continue;const S=VH(v,y,t[2*E],t[2*E+1]);S<d&&S>0&&(g=E,d=S)}let b=t[2*g],x=t[2*g+1],w=1/0;for(let E=0;E<a;E++){if(E===p||E===g)continue;const S=Gtn(v,y,b,x,t[2*E],t[2*E+1]);S<w&&(m=E,w=S)}let C=t[2*m],$=t[2*m+1];if(w===1/0){for(let I=0;I<a;I++)this._dists[I]=t[2*I]-t[0]||t[2*I+1]-t[1];R2(this._ids,this._dists,0,a-1);const E=new Uint32Array(a);let S=0;for(let I=0,A=-1/0;I<a;I++){const D=this._ids[I];this._dists[D]>A&&(E[S++]=D,A=this._dists[D])}this.hull=E.subarray(0,S),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(nR(v,y,b,x,C,$)){const E=g,S=b,I=x;g=m,b=C,x=$,m=E,C=S,$=I}const _=Ytn(v,y,b,x,C,$);this._cx=_.x,this._cy=_.y;for(let E=0;E<a;E++)this._dists[E]=VH(t[2*E],t[2*E+1],_.x,_.y);R2(this._ids,this._dists,0,a-1),this._hullStart=p;let k=3;r[p]=n[m]=g,r[g]=n[p]=m,r[m]=n[g]=p,i[p]=0,i[g]=1,i[m]=2,s.fill(-1),s[this._hashKey(v,y)]=p,s[this._hashKey(b,x)]=g,s[this._hashKey(C,$)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let E=0,S,I;E<this._ids.length;E++){const A=this._ids[E],D=t[2*A],T=t[2*A+1];if(E>0&&Math.abs(D-S)<=cbe&&Math.abs(T-I)<=cbe||(S=D,I=T,A===p||A===g||A===m))continue;let N=0;for(let z=0,q=this._hashKey(D,T);z<this._hashSize&&(N=s[(q+z)%this._hashSize],!(N!==-1&&N!==r[N]));z++);N=n[N];let F=N,R;for(;R=r[F],!nR(D,T,t[2*F],t[2*F+1],t[2*R],t[2*R+1]);)if(F=R,F===N){F=-1;break}if(F===-1)continue;let P=this._addTriangle(F,A,r[F],-1,-1,i[F]);i[A]=this._legalize(P+2),i[F]=P,k++;let V=r[F];for(;R=r[V],nR(D,T,t[2*V],t[2*V+1],t[2*R],t[2*R+1]);)P=this._addTriangle(V,A,R,i[A],-1,i[V]),i[A]=this._legalize(P+2),r[V]=V,k--,V=R;if(F===N)for(;R=n[F],nR(D,T,t[2*R],t[2*R+1],t[2*F],t[2*F+1]);)P=this._addTriangle(R,A,F,-1,i[F],i[R]),this._legalize(P+2),i[R]=P,r[F]=F,k--,F=R;this._hullStart=n[A]=F,r[F]=n[V]=A,r[A]=V,s[this._hashKey(D,T)]=A,s[this._hashKey(t[2*F],t[2*F+1])]=F}this.hull=new Uint32Array(k);for(let E=0,S=this._hullStart;E<k;E++)this.hull[E]=S,S=r[S];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(Htn(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let s=0,a=0;for(;;){const o=r[t],l=t-t%3;if(a=l+(t+2)%3,o===-1){if(s===0)break;t=tR[--s];continue}const u=o-o%3,c=l+(t+1)%3,f=u+(o+2)%3,h=n[a],d=n[t],p=n[c],g=n[f];if(qtn(i[2*h],i[2*h+1],i[2*d],i[2*d+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[o]=h;const v=r[f];if(v===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,v),this._link(o,r[a]),this._link(a,f);const y=u+(o+1)%3;s<tR.length&&(tR[s++]=y)}else{if(s===0)break;t=tR[--s]}}return a}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,s,a){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=n,this._triangles[o+2]=r,this._link(o,i),this._link(o+1,s),this._link(o+2,a),this.trianglesLen+=3,o}}function Htn(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function VH(e,t,n,r){const i=e-n,s=t-r;return i*i+s*s}function jH(e,t,n,r,i,s){const a=(r-t)*(i-e),o=(n-e)*(s-t);return Math.abs(a-o)>=33306690738754716e-32*Math.abs(a+o)?a-o:0}function nR(e,t,n,r,i,s){return(jH(i,s,e,t,n,r)||jH(e,t,n,r,i,s)||jH(n,r,i,s,e,t))<0}function qtn(e,t,n,r,i,s,a,o){const l=e-a,u=t-o,c=n-a,f=r-o,h=i-a,d=s-o,p=l*l+u*u,g=c*c+f*f,m=h*h+d*d;return l*(f*m-g*d)-u*(c*m-g*h)+p*(c*d-f*h)<0}function Gtn(e,t,n,r,i,s){const a=n-e,o=r-t,l=i-e,u=s-t,c=a*a+o*o,f=l*l+u*u,h=.5/(a*u-o*l),d=(u*c-o*f)*h,p=(a*f-l*c)*h;return d*d+p*p}function Ytn(e,t,n,r,i,s){const a=n-e,o=r-t,l=i-e,u=s-t,c=a*a+o*o,f=l*l+u*u,h=.5/(a*u-o*l),d=e+(u*c-o*f)*h,p=t+(a*f-l*c)*h;return{x:d,y:p}}function R2(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const s=e[i],a=t[s];let o=i-1;for(;o>=n&&t[e[o]]>a;)e[o+1]=e[o--];e[o+1]=s}else{const i=n+r>>1;let s=n+1,a=r;gk(e,i,s),t[e[n]]>t[e[r]]&&gk(e,n,r),t[e[s]]>t[e[r]]&&gk(e,s,r),t[e[n]]>t[e[s]]&&gk(e,n,s);const o=e[s],l=t[o];for(;;){do s++;while(t[e[s]]<l);do a--;while(t[e[a]]>l);if(a<s)break;gk(e,s,a)}e[n+1]=e[a],e[a]=o,r-s+1>=a-n?(R2(e,t,s,r),R2(e,t,n,a-1)):(R2(e,t,n,a-1),R2(e,t,s,r))}}function gk(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Xtn(e){return e[0]}function Ktn(e){return e[1]}const fbe=1e-6;class P1{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,s=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${s}`:(Math.abs(this._x1-i)>fbe||Math.abs(this._y1-s)>fbe)&&(this._+="L"+i+","+s),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=s}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class wZ{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class Ztn{constructor(t,[n,r,i,s]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((s=+s)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=s,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,s=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let d=0,p=0,g=r.length,m,v;d<g;d+=3,p+=2){const y=r[d]*2,b=r[d+1]*2,x=r[d+2]*2,w=t[y],C=t[y+1],$=t[b],_=t[b+1],k=t[x],E=t[x+1],S=$-w,I=_-C,A=k-w,D=E-C,T=S*S+I*I,N=A*A+D*D,F=(S*D-I*A)*2;if(!F)m=(w+k)/2-1e8*D,v=(C+E)/2+1e8*A;else if(Math.abs(F)<1e-8)m=(w+k)/2,v=(C+E)/2;else{const R=1/F;m=w+(D*T-I*N)*R,v=C+(S*N-A*T)*R}s[p]=m,s[p+1]=v}let a=n[n.length-1],o,l=a*4,u,c=t[2*a],f,h=t[2*a+1];i.fill(0);for(let d=0;d<n.length;++d)a=n[d],o=l,u=c,f=h,l=a*4,c=t[2*a],h=t[2*a+1],i[o+2]=i[l]=f-h,i[o+3]=i[l+1]=c-u}render(t){const n=t==null?t=new P1:void 0,{delaunay:{halfedges:r,inedges:i,hull:s},circumcenters:a,vectors:o}=this;if(s.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const h=r[c];if(h<c)continue;const d=Math.floor(c/3)*2,p=Math.floor(h/3)*2,g=a[d],m=a[d+1],v=a[p],y=a[p+1];this._renderSegment(g,m,v,y,t)}let l,u=s[s.length-1];for(let c=0;c<s.length;++c){l=u,u=s[c];const f=Math.floor(i[u]/3)*2,h=a[f],d=a[f+1],p=l*4,g=this._project(h,d,o[p+2],o[p+3]);g&&this._renderSegment(h,d,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new P1:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new P1:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let s=i.length;for(;i[0]===i[s-2]&&i[1]===i[s-1]&&s>1;)s-=2;for(let a=2;a<s;a+=2)(i[a]!==i[a-2]||i[a+1]!==i[a-1])&&n.lineTo(i[a],i[a+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new wZ;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,s){let a;const o=this._regioncode(t,n),l=this._regioncode(r,i);o===0&&l===0?(s.moveTo(t,n),s.lineTo(r,i)):(a=this._clipSegment(t,n,r,i,o,l))&&(s.moveTo(a[0],a[1]),s.lineTo(a[2],a[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i){e:for(let s=0,a=n.length;s<a;s+=2)for(let o=0,l=i.length;o<l;o+=2)if(n[s]==i[o]&&n[s+1]==i[o+1]&&n[(s+2)%a]==i[(o+l-2)%l]&&n[(s+3)%a]==i[(o+l-1)%l]){yield r;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:s}}=this,a=r[t];if(a===-1)return null;const o=[];let l=a;do{const u=Math.floor(l/3);if(o.push(n[u*2],n[u*2+1]),l=l%3===2?l-2:l+1,s[l]!==t)break;l=i[l]}while(l!==a&&l!==-1);return o}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let i=null,s,a,o=n[r-2],l=n[r-1],u,c=this._regioncode(o,l),f,h;for(let d=0;d<r;d+=2)if(s=o,a=l,o=n[d],l=n[d+1],u=c,c=this._regioncode(o,l),u===0&&c===0)f=h,h=0,i?i.push(o,l):i=[o,l];else{let p,g,m,v,y;if(u===0){if((p=this._clipSegment(s,a,o,l,u,c))===null)continue;[g,m,v,y]=p}else{if((p=this._clipSegment(o,l,s,a,c,u))===null)continue;[v,y,g,m]=p,f=h,h=this._edgecode(g,m),f&&h&&this._edge(t,f,h,i,i.length),i?i.push(g,m):i=[g,m]}f=h,h=this._edgecode(v,y),f&&h&&this._edge(t,f,h,i,i.length),i?i.push(v,y):i=[v,y]}if(i)f=h,h=this._edgecode(i[0],i[1]),f&&h&&this._edge(t,f,h,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,s,a){for(;;){if(s===0&&a===0)return[t,n,r,i];if(s&a)return null;let o,l,u=s||a;u&8?(o=t+(r-t)*(this.ymax-n)/(i-n),l=this.ymax):u&4?(o=t+(r-t)*(this.ymin-n)/(i-n),l=this.ymin):u&2?(l=n+(i-n)*(this.xmax-t)/(r-t),o=this.xmax):(l=n+(i-n)*(this.xmin-t)/(r-t),o=this.xmin),s?(t=o,n=l,s=this._regioncode(t,n)):(r=o,i=l,a=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,s,a){let o=Array.from(n),l;if((l=this._project(o[0],o[1],r,i))&&o.unshift(l[0],l[1]),(l=this._project(o[o.length-2],o[o.length-1],s,a))&&o.push(l[0],l[1]),o=this._clipFinite(t,o))for(let u=0,c=o.length,f,h=this._edgecode(o[c-2],o[c-1]);u<c;u+=2)f=h,h=this._edgecode(o[u],o[u+1]),f&&h&&(u=this._edge(t,f,h,o,u),c=o.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return o}_edge(t,n,r,i,s){for(;n!==r;){let a,o;switch(n){case 5:n=4;continue;case 4:n=6,a=this.xmax,o=this.ymin;break;case 6:n=2;continue;case 2:n=10,a=this.xmax,o=this.ymax;break;case 10:n=8;continue;case 8:n=9,a=this.xmin,o=this.ymax;break;case 9:n=1;continue;case 1:n=5,a=this.xmin,o=this.ymin;break}(i[s]!==a||i[s+1]!==o)&&this.contains(t,a,o)&&(i.splice(s,0,a,o),s+=2)}if(i.length>4)for(let a=0;a<i.length;a+=2){const o=(a+2)%i.length,l=(a+4)%i.length;(i[a]===i[o]&&i[o]===i[l]||i[a+1]===i[o+1]&&i[o+1]===i[l+1])&&(i.splice(o,2),a-=2)}return s}_project(t,n,r,i){let s=1/0,a,o,l;if(i<0){if(n<=this.ymin)return null;(a=(this.ymin-n)/i)<s&&(l=this.ymin,o=t+(s=a)*r)}else if(i>0){if(n>=this.ymax)return null;(a=(this.ymax-n)/i)<s&&(l=this.ymax,o=t+(s=a)*r)}if(r>0){if(t>=this.xmax)return null;(a=(this.xmax-t)/r)<s&&(o=this.xmax,l=n+(s=a)*i)}else if(r<0){if(t<=this.xmin)return null;(a=(this.xmin-t)/r)<s&&(o=this.xmin,l=n+(s=a)*i)}return[o,l]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const Qtn=2*Math.PI,f2=Math.pow;function Jtn(e){return e[0]}function enn(e){return e[1]}function tnn(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],s=2*t[r+1],a=2*t[r+2];if((n[a]-n[i])*(n[s+1]-n[i+1])-(n[s]-n[i])*(n[a+1]-n[i+1])>1e-10)return!1}return!0}function nnn(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class Iae{static from(t,n=Jtn,r=enn,i){return new Iae("length"in t?rnn(t,n,r,i):Float64Array.from(inn(t,n,r,i)))}constructor(t){this._delaunator=new IL(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&tnn(t)){this.collinear=Int32Array.from({length:n.length/2},(h,d)=>d).sort((h,d)=>n[2*h]-n[2*d]||n[2*h+1]-n[2*d+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[n[2*l],n[2*l+1],n[2*u],n[2*u+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let h=0,d=n.length/2;h<d;++h){const p=nnn(n[2*h],n[2*h+1],f);n[2*h]=p[0],n[2*h+1]=p[1]}this._delaunator=new IL(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let l=0,u=r.length;l<u;++l){const c=s[l%3===2?l-2:l+1];(r[l]===-1||a[c]===-1)&&(a[c]=l)}for(let l=0,u=i.length;l<u;++l)o[i[l]]=l;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],a[i[0]]=1,i.length===2&&(a[i[1]]=0))}voronoi(t){return new Ztn(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:s,triangles:a,collinear:o}=this;if(o){const f=o.indexOf(t);f>0&&(yield o[f-1]),f<o.length-1&&(yield o[f+1]);return}const l=n[t];if(l===-1)return;let u=l,c=-1;do{if(yield c=a[u],u=u%3===2?u-2:u+1,a[u]!==t)return;if(u=s[u],u===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(u!==l)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let s;for(;(s=this._step(r,t,n))>=0&&s!==r&&s!==i;)r=s;return s}_step(t,n,r){const{inedges:i,hull:s,_hullIndex:a,halfedges:o,triangles:l,points:u}=this;if(i[t]===-1||!u.length)return(t+1)%(u.length>>1);let c=t,f=f2(n-u[t*2],2)+f2(r-u[t*2+1],2);const h=i[t];let d=h;do{let p=l[d];const g=f2(n-u[p*2],2)+f2(r-u[p*2+1],2);if(g<f&&(f=g,c=p),d=d%3===2?d-2:d+1,l[d]!==t)break;if(d=o[d],d===-1){if(d=s[(a[t]+1)%s.length],d!==p&&f2(n-u[d*2],2)+f2(r-u[d*2+1],2)<f)return d;break}}while(d!==h);return c}render(t){const n=t==null?t=new P1:void 0,{points:r,halfedges:i,triangles:s}=this;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l<a)continue;const u=s[a]*2,c=s[l]*2;t.moveTo(r[u],r[u+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=t==null?t=new P1:void 0,{points:i}=this;for(let s=0,a=i.length;s<a;s+=2){const o=i[s],l=i[s+1];t.moveTo(o+n,l),t.arc(o,l,n,0,Qtn)}return r&&r.value()}renderHull(t){const n=t==null?t=new P1:void 0,{hull:r,points:i}=this,s=r[0]*2,a=r.length;t.moveTo(i[s],i[s+1]);for(let o=1;o<a;++o){const l=2*r[o];t.lineTo(i[l],i[l+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new wZ;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new P1:void 0,{points:i,triangles:s}=this,a=s[t*=3]*2,o=s[t+1]*2,l=s[t+2]*2;return n.moveTo(i[a],i[a+1]),n.lineTo(i[o],i[o+1]),n.lineTo(i[l],i[l+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new wZ;return this.renderTriangle(t,n),n.value()}}function rnn(e,t,n,r){const i=e.length,s=new Float64Array(i*2);for(let a=0;a<i;++a){const o=e[a];s[a*2]=t.call(r,o,a,e),s[a*2+1]=n.call(r,o,a,e)}return s}function*inn(e,t,n,r){let i=0;for(const s of e)yield t.call(r,s,i,e),yield n.call(r,s,i,e),++i}function Nae(e){me.call(this,null,e)}Nae.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const snn=[-1e5,-1e5,1e5,1e5];Ie(Nae,me,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:snn;const s=this.value=Iae.from(r,e.x,e.y).voronoi(i);for(let a=0,o=r.length;a<o;++a){const l=s.cellPolygon(a);r[a][n]=l?ann(l):null}return t.reflow(e.modified()).modifies(n)}});function ann(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}const onn=Object.freeze(Object.defineProperty({__proto__:null,voronoi:Nae},Symbol.toStringTag,{value:"Module"}));var HH=Math.PI/180,ME=1<<11>>5,b4=1<<11;function lnn(){var e=[256,256],t,n,r,i,s,a,o,l=jBe,u=[],c=Math.random,f={};f.layout=function(){for(var p=h(Yu()),g=pnn((e[0]>>5)*e[1]),m=null,v=u.length,y=-1,b=[],x=u.map(C=>({text:t(C),font:n(C),style:i(C),weight:s(C),rotate:a(C),size:~~(r(C)+1e-14),padding:o(C),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:C})).sort((C,$)=>$.size-C.size);++y<v;){var w=x[y];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,unn(p,w,x,y),w.hasText&&d(g,w,m)&&(b.push(w),m?fnn(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return b};function h(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(ME<<5)/g,p.height=b4/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}function d(p,g,m){for(var v=g.x,y=g.y,b=Math.sqrt(e[0]*e[0]+e[1]*e[1]),x=l(e),w=c()<.5?1:-1,C=-w,$,_,k;($=x(C+=w))&&(_=~~$[0],k=~~$[1],!(Math.min(Math.abs(_),Math.abs(k))>=b));)if(g.x=v+_,g.y=y+k,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!cnn(g,p,e[0]))&&(!m||hnn(g,m))){for(var E=g.sprite,S=g.width>>5,I=e[0]>>5,A=g.x-(S<<4),D=A&127,T=32-D,N=g.y1-g.y0,F=(g.y+g.y0)*I+(A>>5),R,P=0;P<N;P++){R=0;for(var V=0;V<=S;V++)p[F+V]|=R<<T|(V<S?(R=E[P*S+V])>>>D:0);F+=I}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(u=p,f):u},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=Tv(p),f):n},f.fontStyle=function(p){return arguments.length?(i=Tv(p),f):i},f.fontWeight=function(p){return arguments.length?(s=Tv(p),f):s},f.rotate=function(p){return arguments.length?(a=Tv(p),f):a},f.text=function(p){return arguments.length?(t=Tv(p),f):t},f.spiral=function(p){return arguments.length?(l=gnn[p]||p,f):l},f.fontSize=function(p){return arguments.length?(r=Tv(p),f):r},f.padding=function(p){return arguments.length?(o=Tv(p),f):o},f.random=function(p){return arguments.length?(c=p,f):c},f}function unn(e,t,n,r){if(!t.sprite){var i=e.context,s=e.ratio;i.clearRect(0,0,(ME<<5)/s,b4/s);var a=0,o=0,l=0,u=n.length,c,f,h,d,p;for(--r;++r<u;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=i.measureText(t.text+"m").width*s,h=t.size<<1,t.rotate){var g=Math.sin(t.rotate*HH),m=Math.cos(t.rotate*HH),v=c*m,y=c*g,b=h*m,x=h*g;c=Math.max(Math.abs(v+x),Math.abs(v-x))+31>>5<<5,h=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else c=c+31>>5<<5;if(h>l&&(l=h),a+c>=ME<<5&&(a=0,o+=l,l=0),o+h>=b4)break;i.translate((a+(c>>1))/s,(o+(h>>1))/s),t.rotate&&i.rotate(t.rotate*HH),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=h,t.xoff=a,t.yoff=o,t.x1=c>>1,t.y1=h>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,a+=c}for(var w=i.getImageData(0,0,(ME<<5)/s,b4/s).data,C=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,h=t.y1-t.y0,d=0;d<h*f;d++)C[d]=0;if(a=t.xoff,a==null)return;o=t.yoff;var $=0,_=-1;for(p=0;p<h;p++){for(d=0;d<c;d++){var k=f*p+(d>>5),E=w[(o+p)*(ME<<5)+(a+d)<<2]?1<<31-d%32:0;C[k]|=E,$|=E}$?_=p:(t.y0++,h--,p--,o++)}t.y1=t.y0+_,t.sprite=C.slice(0,(t.y1-t.y0)*f)}}}function cnn(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,s=e.x-(i<<4),a=s&127,o=32-a,l=e.y1-e.y0,u=(e.y+e.y0)*n+(s>>5),c,f=0;f<l;f++){c=0;for(var h=0;h<=i;h++)if((c<<o|(h<i?(c=r[f*i+h])>>>a:0))&t[u+h])return!0;u+=n}return!1}function fnn(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function hnn(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function jBe(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function dnn(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(s){var a=s<0?-1:1;switch(Math.sqrt(1+4*a*s)-a&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function pnn(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Tv(e){return typeof e=="function"?e:function(){return e}}var gnn={archimedean:jBe,rectangular:dnn};const HBe=["x","y","font","fontSize","fontStyle","fontWeight","angle"],mnn=["text","font","rotate","fontSize","fontStyle","fontWeight"];function Mae(e){me.call(this,lnn(),e)}Mae.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:HBe}]};Ie(Mae,me,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&$e("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return Ut(g)&&t.modified(g.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||mnn.some(n)))return;const i=t.materialize(t.SOURCE).source,s=this.value,a=e.as||HBe;let o=e.fontSize||14,l;if(Ut(o)?l=e.fontSizeRange:o=go(o),l){const p=o,g=Dn("sqrt")().domain(Op(i,p)).range(l);o=m=>g(p(m))}i.forEach(p=>{p[a[0]]=NaN,p[a[1]]=NaN,p[a[3]]=0});const u=s.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(o).random(Pp).layout(),c=s.size(),f=c[0]>>1,h=c[1]>>1,d=u.length;for(let p=0,g,m;p<d;++p)g=u[p],m=g.datum,m[a[0]]=g.x+f,m[a[1]]=g.y+h,m[a[2]]=g.font,m[a[3]]=g.size,m[a[4]]=g.style,m[a[5]]=g.weight,m[a[6]]=g.rotate;return t.reflow(r).modifies(a)}});const vnn=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:Mae},Symbol.toStringTag,{value:"Module"})),ynn=e=>new Uint8Array(e),bnn=e=>new Uint16Array(e),wA=e=>new Uint32Array(e);function xnn(){let e=8,t=[],n=wA(0),r=rR(0,e),i=rR(0,e);return{data:()=>t,seen:()=>n=wnn(n,t.length),add(s){for(let a=0,o=t.length,l=s.length,u;a<l;++a)u=s[a],u._index=o++,t.push(u)},remove(s,a){const o=t.length,l=Array(o-s),u=t;let c,f,h;for(f=0;!a[f]&&f<o;++f)l[f]=t[f],u[f]=f;for(h=f;f<o;++f)c=t[f],a[f]?u[f]=-1:(u[f]=h,r[h]=r[f],i[h]=i[f],l[h]=c,c._index=h++),r[f]=0;return t=l,u},size:()=>t.length,curr:()=>r,prev:()=>i,reset:s=>i[s]=r[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,a){r[s]|=a},clear(s,a){r[s]&=~a},resize(s,a){const o=r.length;(s>o||a>e)&&(e=Math.max(a,e),r=rR(s,e,r),i=rR(s,e))}}}function wnn(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function rR(e,t,n){const r=(t<257?ynn:t<65537?bnn:wA)(e);return n&&r.set(n),r}function hbe(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,s){const a=this,o=a.bisect(a.range,i.value),l=i.index,u=o[0],c=o[1],f=l.length;let h;for(h=0;h<u;++h)s[l[h]]|=r;for(h=c;h<f;++h)s[l[h]]|=r;return a}}}function dbe(){let e=wA(0),t=[],n=0;function r(o,l,u){if(!l.length)return[];const c=n,f=l.length,h=wA(f);let d=Array(f),p,g,m;for(m=0;m<f;++m)d[m]=o(l[m]),h[m]=m;if(d=$nn(d,h),c)p=t,g=e,t=Array(c+f),e=wA(c+f),Cnn(u,p,g,c,d,h,f,t,e);else{if(u>0)for(m=0;m<f;++m)h[m]+=u;t=d,e=h}return n=c+f,{index:h,value:d}}function i(o,l){const u=n;let c,f,h;for(f=0;!l[e[f]]&&f<u;++f);for(h=f;f<u;++f)l[c=e[f]]||(e[h]=c,t[h]=t[f],++h);n=u-o}function s(o){for(let l=0,u=n;l<u;++l)e[l]=o[e[l]]}function a(o,l){let u;return l?u=l.length:(l=t,u=n),[g9t(l,o[0],0,u),aP(l,o[1],0,u)]}return{insert:r,remove:i,bisect:a,reindex:s,index:()=>e,size:()=>n}}function $nn(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],s=e[r];return i<s?-1:i>s?1:0}),y9t(e,t)}function Cnn(e,t,n,r,i,s,a,o,l){let u=0,c=0,f;for(f=0;u<r&&c<a;++f)t[u]<i[c]?(o[f]=t[u],l[f]=n[u++]):(o[f]=i[c],l[f]=s[c++]+e);for(;u<r;++u,++f)o[f]=t[u],l[f]=n[u];for(;c<a;++c,++f)o[f]=i[c],l[f]=s[c]+e}function Fae(e){me.call(this,xnn(),e),this._indices=null,this._dims=null}Fae.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};Ie(Fae,me,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},s=this._dims=[],a=r.length;let o=0,l,u;for(;o<a;++o)l=n[o].fname,u=i[l]||(i[l]=dbe()),s.push(hbe(u,o,r[o]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,s=this._indices,a=this._dims,o=this.value,l=o.curr(),u=o.prev(),c=o.all(),f=n.rem=n.add,h=n.mod,d=i.length,p={};let g,m,v,y,b,x,w,C,$;if(u.set(l),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&o.add(t.add),t.mod.length)for(x={},y=t.mod,w=0,C=y.length;w<C;++w)x[y[w]._index]=1;for(w=0;w<d;++w)$=r[w],(!a[w]||e.modified("fields",w)||t.modified($.fields))&&(v=$.fname,(g=p[v])||(s[v]=m=dbe(),p[v]=g=m.insert($,t.source,0)),a[w]=hbe(m,w,i[w]).onAdd(g,l));for(w=0,C=o.data().length;w<C;++w)b[w]||(u[w]!==l[w]?f.push(w):x[w]&&l[w]!==c&&h.push(w));return o.mask=(1<<d)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,s=this._dims,a=this._indices,o=e.fields,l={},u=n.add,c=i.size()+r.length,f=s.length;let h=i.size(),d,p,g;i.resize(c,f),i.add(r);const m=i.curr(),v=i.prev(),y=i.all();for(d=0;d<f;++d)p=o[d].fname,g=l[p]||(l[p]=a[p].insert(o[d],r,h)),s[d].onAdd(g,m);for(;h<c;++h)v[h]=y,m[h]!==y&&u.push(h)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),s=r.all(),a=e.mod;let o,l,u;for(o=0,l=a.length;o<l;++o)u=a[o]._index,i[u]!==s&&n.push(u)},remove(e,t,n){const r=this._indices,i=this.value,s=i.curr(),a=i.prev(),o=i.all(),l={},u=n.rem,c=t.rem;let f,h,d,p;for(f=0,h=c.length;f<h;++f)d=c[f]._index,l[d]=1,a[d]=p=s[d],s[d]=o,p!==o&&u.push(d);for(d in r)r[d].remove(h,l);return this.reindex(t,h,l),l},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const s=i.remove(t,n);for(const a in r)r[a].reindex(s)})},update(e,t,n){const r=this._dims,i=e.query,s=t.stamp,a=r.length;let o=0,l,u;for(n.filters=0,u=0;u<a;++u)e.modified("query",u)&&(l=u,++o);if(o===1)o=r[l].one,this.incrementOne(r[l],i[l],n.add,n.rem);else for(u=0,o=0;u<a;++u)!e.modified("query",u)||(o|=r[u].one,this.incrementAll(r[u],i[u],s,n.add),n.rem=n.add);return o},incrementAll(e,t,n,r){const i=this.value,s=i.seen(),a=i.curr(),o=i.prev(),l=e.index(),u=e.bisect(e.range),c=e.bisect(t),f=c[0],h=c[1],d=u[0],p=u[1],g=e.one;let m,v,y;if(f<d)for(m=f,v=Math.min(d,h);m<v;++m)y=l[m],s[y]!==n&&(o[y]=a[y],s[y]=n,r.push(y)),a[y]^=g;else if(f>d)for(m=d,v=Math.min(f,p);m<v;++m)y=l[m],s[y]!==n&&(o[y]=a[y],s[y]=n,r.push(y)),a[y]^=g;if(h>p)for(m=Math.max(f,p),v=h;m<v;++m)y=l[m],s[y]!==n&&(o[y]=a[y],s[y]=n,r.push(y)),a[y]^=g;else if(h<p)for(m=Math.max(d,h),v=p;m<v;++m)y=l[m],s[y]!==n&&(o[y]=a[y],s[y]=n,r.push(y)),a[y]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,s=i.curr(),a=e.index(),o=e.bisect(e.range),l=e.bisect(t),u=l[0],c=l[1],f=o[0],h=o[1],d=e.one;let p,g,m;if(u<f)for(p=u,g=Math.min(f,c);p<g;++p)m=a[p],s[m]^=d,n.push(m);else if(u>f)for(p=f,g=Math.min(u,h);p<g;++p)m=a[p],s[m]^=d,r.push(m);if(c>h)for(p=Math.max(u,h),g=c;p<g;++p)m=a[p],s[m]^=d,n.push(m);else if(c<h)for(p=Math.max(f,c),g=h;p<g;++p)m=a[p],s[m]^=d,r.push(m);e.range=t.slice()}});function Oae(e){me.call(this,null,e)}Oae.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};Ie(Oae,me,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)===0)return t.StopPropagation;const s=t.fork(t.ALL),a=r.data(),o=r.curr(),l=r.prev(),u=c=>o[c]&n?null:a[c];return s.filter(s.MOD,u),i&i-1?(s.filter(s.ADD,c=>{const f=o[c]&n;return!f&&f^l[c]&n?a[c]:null}),s.filter(s.REM,c=>{const f=o[c]&n;return f&&!(f^(f^l[c]&n))?a[c]:null})):(s.filter(s.ADD,u),s.filter(s.REM,c=>(o[c]&n)===i?a[c]:null)),s.filter(s.SOURCE,c=>u(c._index))}});const _nn=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:Fae,resolvefilter:Oae},Symbol.toStringTag,{value:"Module"}));function*qBe(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function GBe(e,t,n){const r=Float64Array.from(qBe(e,n));return r.sort(B_),t.map(i=>ARe(r,i))}function YBe(e,t){return GBe(e,[.25,.5,.75],t)}function XBe(e,t){const n=e.length,r=v9t(e,t),i=YBe(e,t),s=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,s)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function Snn(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let s=e.extent[0],a=e.extent[1],o,l,u,c,f,h;const d=e.span||a-s||Math.abs(s)||1;if(e.step)o=e.step;else if(e.steps){for(c=d/t,f=0,h=e.steps.length;f<h&&e.steps[f]<c;++f);o=e.steps[Math.max(0,f-1)]}else{for(l=Math.ceil(Math.log(t)/r),u=e.minstep||0,o=Math.max(u,Math.pow(n,Math.round(Math.log(d)/r)-l));Math.ceil(d/o)>t;)o*=n;for(f=0,h=i.length;f<h;++f)c=o/i[f],c>=u&&d/c<=t&&(o=c)}c=Math.log(o);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/o+g)*o,s=s<c?c-o:c,a=Math.ceil(a/o)*o),{start:s,stop:a===s?s+o:a,step:o}}var jp=Math.random;function knn(e){jp=e}function Enn(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(qBe(e,r)),s=i.length,a=t;let o,l,u,c;for(u=0,c=Array(a);u<a;++u){for(o=0,l=0;l<s;++l)o+=i[~~(jp()*s)];c[u]=o/s}return c.sort(B_),[MX(c,n/2),MX(c,1-n/2)]}function Ann(e,t,n,r){r=r||(h=>h);const i=e.length,s=new Float64Array(i);let a=0,o=1,l=r(e[0]),u=l,c=l+t,f;for(;o<i;++o){if(f=r(e[o]),f>=c){for(u=(l+u)/2;a<o;++a)s[a]=u;c=f+t,l=f}u=f}for(u=(l+u)/2;a<o;++a)s[a]=u;return n?Tnn(s,t+t/4):s}function Tnn(e,t){const n=e.length;let r=0,i=1,s,a;for(;e[r]===e[i];)++i;for(;i<n;){for(s=i+1;e[i]===e[s];)++s;if(e[i]-e[i-1]<t){for(a=i+(r+s-i-i>>1);a<i;)e[a++]=e[i];for(;a>i;)e[a--]=e[r]}r=i,i=s}return e}function Dnn(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function Inn(e,t){t==null&&(t=e,e=0);let n,r,i;const s={min(a){return arguments.length?(n=a||0,i=r-n,s):n},max(a){return arguments.length?(r=a||0,i=r-n,s):r},sample(){return n+Math.floor(i*jp())},pdf(a){return a===Math.floor(a)&&a>=n&&a<r?1/i:0},cdf(a){const o=Math.floor(a);return o<n?0:o>=r?1:(o-n+1)/i},icdf(a){return a>=0&&a<=1?n-1+Math.floor(a*i):NaN}};return s.min(e).max(t)}const KBe=Math.sqrt(2*Math.PI),Nnn=Math.SQRT2;let mk=NaN;function Rae(e,t){e=e||0,t=t==null?1:t;let n=0,r=0,i,s;if(mk===mk)n=mk,mk=NaN;else{do n=jp()*2-1,r=jp()*2-1,i=n*n+r*r;while(i===0||i>1);s=Math.sqrt(-2*Math.log(i)/i),n*=s,mk=r*s}return e+n*t}function ZBe(e,t,n){n=n==null?1:n;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*KBe)}function Pae(e,t,n){t=t||0,n=n==null?1:n;const r=(e-t)/n,i=Math.abs(r);let s;if(i>37)s=0;else{const a=Math.exp(-i*i/2);let o;i<7.07106781186547?(o=.0352624965998911*i+.700383064443688,o=o*i+6.37396220353165,o=o*i+33.912866078383,o=o*i+112.079291497871,o=o*i+221.213596169931,o=o*i+220.206867912376,s=a*o,o=.0883883476483184*i+1.75566716318264,o=o*i+16.064177579207,o=o*i+86.7807322029461,o=o*i+296.564248779674,o=o*i+637.333633378831,o=o*i+793.826512519948,o=o*i+440.413735824752,s=s/o):(o=i+.65,o=i+4/o,o=i+3/o,o=i+2/o,o=i+1/o,s=a/o/2.506628274631)}return r>0?1-s:s}function Lae(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*Nnn*Mnn(2*e-1)}function Mnn(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function QBe(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s==null?1:s,i):r},sample:()=>Rae(n,r),pdf:s=>ZBe(s,n,r),cdf:s=>Pae(s,n,r),icdf:s=>Lae(s,n,r)};return i.mean(e).stdev(t)}function Fnn(e,t){const n=QBe();let r=0;const i={data(s){return arguments.length?(e=s,r=s?s.length:0,i.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=XBe(e)),i):t},sample(){return e[~~(jp()*r)]+t*n.sample()},pdf(s){let a=0,o=0;for(;o<r;++o)a+=n.pdf((s-e[o])/t);return a/t/r},cdf(s){let a=0,o=0;for(;o<r;++o)a+=n.cdf((s-e[o])/t);return a/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function JBe(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+Rae()*t)}function e8e(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*KBe*e)}function t8e(e,t,n){return Pae(Math.log(e),t,n)}function n8e(e,t,n){return Math.exp(Lae(e,t,n))}function Onn(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s==null?1:s,i):r},sample:()=>JBe(n,r),pdf:s=>e8e(s,n,r),cdf:s=>t8e(s,n,r),icdf:s=>n8e(s,n,r)};return i.mean(e).stdev(t)}function Rnn(e,t){let n=0,r;function i(a){const o=[];let l=0,u;for(u=0;u<n;++u)l+=o[u]=a[u]==null?1:+a[u];for(u=0;u<n;++u)o[u]/=l;return o}const s={weights(a){return arguments.length?(r=i(t=a||[]),s):t},distributions(a){return arguments.length?(a?(n=a.length,e=a):(n=0,e=[]),s.weights(t)):e},sample(){const a=jp();let o=e[n-1],l=r[0],u=0;for(;u<n-1;l+=r[++u])if(a<l){o=e[u];break}return o.sample()},pdf(a){let o=0,l=0;for(;l<n;++l)o+=r[l]*e[l].pdf(a);return o},cdf(a){let o=0,l=0;for(;l<n;++l)o+=r[l]*e[l].cdf(a);return o},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function r8e(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*jp()}function i8e(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function s8e(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function a8e(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function Pnn(e,t){let n,r;const i={min(s){return arguments.length?(n=s||0,i):n},max(s){return arguments.length?(r=s==null?1:s,i):r},sample:()=>r8e(n,r),pdf:s=>i8e(s,n,r),cdf:s=>s8e(s,n,r),icdf:s=>a8e(s,n,r)};return t==null&&(t=e==null?1:e,e=0),i.min(e).max(t)}function bM(e,t,n,r){const i=r-e*e,s=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-s*e,s]}function W9(e,t,n,r){e=e.filter(d=>{let p=t(d),g=n(d);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((d,p)=>t(d)-t(p));const i=e.length,s=new Float64Array(i),a=new Float64Array(i);let o=0,l=0,u=0,c,f,h;for(h of e)s[o]=c=+t(h),a[o]=f=+n(h),++o,l+=(c-l)/o,u+=(f-u)/o;for(o=0;o<i;++o)s[o]-=l,a[o]-=u;return[s,a,l,u]}function xM(e,t,n,r){let i=-1,s,a;for(const o of e)s=t(o),a=n(o),s!=null&&(s=+s)>=s&&a!=null&&(a=+a)>=a&&r(s,a,++i)}function G_(e,t,n,r,i){let s=0,a=0;return xM(e,t,n,(o,l)=>{const u=l-i(o),c=l-r;s+=u*u,a+=c*c}),1-s/a}function o8e(e,t,n){let r=0,i=0,s=0,a=0,o=0;xM(e,t,n,(c,f)=>{++o,r+=(c-r)/o,i+=(f-i)/o,s+=(c*f-s)/o,a+=(c*c-a)/o});const l=bM(r,i,s,a),u=c=>l[0]+l[1]*c;return{coef:l,predict:u,rSquared:G_(e,t,n,i,u)}}function Lnn(e,t,n){let r=0,i=0,s=0,a=0,o=0;xM(e,t,n,(c,f)=>{++o,c=Math.log(c),r+=(c-r)/o,i+=(f-i)/o,s+=(c*f-s)/o,a+=(c*c-a)/o});const l=bM(r,i,s,a),u=c=>l[0]+l[1]*Math.log(c);return{coef:l,predict:u,rSquared:G_(e,t,n,i,u)}}function Bnn(e,t,n){const[r,i,s,a]=W9(e,t,n);let o=0,l=0,u=0,c=0,f=0,h,d,p;xM(e,t,n,(y,b)=>{h=r[f++],d=Math.log(b),p=h*b,o+=(b*d-o)/f,l+=(p-l)/f,u+=(p*d-u)/f,c+=(h*p-c)/f});const[g,m]=bM(l/a,o/a,u/a,c/a),v=y=>Math.exp(g+m*(y-s));return{coef:[Math.exp(g-m*s),m],predict:v,rSquared:G_(e,t,n,a,v)}}function znn(e,t,n){let r=0,i=0,s=0,a=0,o=0,l=0;xM(e,t,n,(f,h)=>{const d=Math.log(f),p=Math.log(h);++l,r+=(d-r)/l,i+=(p-i)/l,s+=(d*p-s)/l,a+=(d*d-a)/l,o+=(h-o)/l});const u=bM(r,i,s,a),c=f=>u[0]*Math.pow(f,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:G_(e,t,n,o,c)}}function l8e(e,t,n){const[r,i,s,a]=W9(e,t,n),o=r.length;let l=0,u=0,c=0,f=0,h=0,d,p,g,m;for(d=0;d<o;)p=r[d],g=i[d++],m=p*p,l+=(m-l)/d,u+=(m*p-u)/d,c+=(m*m-c)/d,f+=(p*g-f)/d,h+=(m*g-h)/d;const v=c-l*l,y=l*v-u*u,b=(h*l-f*u)/y,x=(f*v-h*u)/y,w=-b*l,C=$=>($=$-s,b*$*$+x*$+w+a);return{coef:[w-x*s+b*s*s+a,x-2*b*s,b],predict:C,rSquared:G_(e,t,n,a,C)}}function Unn(e,t,n,r){if(r===1)return o8e(e,t,n);if(r===2)return l8e(e,t,n);const[i,s,a,o]=W9(e,t,n),l=i.length,u=[],c=[],f=r+1;let h,d,p,g,m;for(h=0;h<f;++h){for(p=0,g=0;p<l;++p)g+=Math.pow(i[p],h)*s[p];for(u.push(g),m=new Float64Array(f),d=0;d<f;++d){for(p=0,g=0;p<l;++p)g+=Math.pow(i[p],h+d);m[d]=g}c.push(m)}c.push(u);const v=Vnn(c),y=b=>{b-=a;let x=o+v[0]+v[1]*b+v[2]*b*b;for(h=3;h<f;++h)x+=v[h]*Math.pow(b,h);return x};return{coef:Wnn(f,v,-a,o),predict:y,rSquared:G_(e,t,n,o,y)}}function Wnn(e,t,n,r){const i=Array(e);let s,a,o,l;for(s=0;s<e;++s)i[s]=0;for(s=e-1;s>=0;--s)for(o=t[s],l=1,i[s]+=o,a=1;a<=s;++a)l*=(s+1-a)/a,i[s-a]+=o*Math.pow(n,a)*l;return i[0]+=r,i}function Vnn(e){const t=e.length-1,n=[];let r,i,s,a,o;for(r=0;r<t;++r){for(a=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][a])&&(a=i);for(s=r;s<t+1;++s)o=e[s][r],e[s][r]=e[s][a],e[s][a]=o;for(i=r+1;i<t;++i)for(s=t;s>=r;s--)e[s][i]-=e[s][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(o=0,s=i+1;s<t;++s)o+=e[s][i]*n[s];n[i]=(e[t][i]-o)/e[i][i]}return n}const pbe=2,gbe=1e-12;function jnn(e,t,n,r){const[i,s,a,o]=W9(e,t,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),h=new Float64Array(l).fill(1);for(let d=-1;++d<=pbe;){const p=[0,u-1];for(let m=0;m<l;++m){const v=i[m],y=p[0],b=p[1],x=v-i[y]>i[b]-v?y:b;let w=0,C=0,$=0,_=0,k=0;const E=1/Math.abs(i[x]-v||1);for(let A=y;A<=b;++A){const D=i[A],T=s[A],N=Hnn(Math.abs(v-D)*E)*h[A],F=D*N;w+=N,C+=F,$+=T*N,_+=T*F,k+=D*F}const[S,I]=bM(C/w,$/w,_/w,k/w);c[m]=S+I*v,f[m]=Math.abs(s[m]-c[m]),qnn(i,m+1,p)}if(d===pbe)break;const g=TRe(f);if(Math.abs(g)<gbe)break;for(let m=0,v,y;m<l;++m)v=f[m]/(6*g),h[m]=v>=1?gbe:(y=1-v*v)*y}return Gnn(i,c,a,o)}function Hnn(e){return(e=1-e*e*e)*e*e}function qnn(e,t,n){const r=e[t];let i=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>i&&e[s]-r<=r-e[i];)n[0]=++i,n[1]=s,++s}function Gnn(e,t,n,r){const i=e.length,s=[];let a=0,o=0,l=[],u;for(;a<i;++a)u=e[a]+n,l[0]===u?l[1]+=(t[a]-l[1])/++o:(o=0,l[1]+=r,l=[u,t[a]],s.push(l));return l[1]+=r,s}const Ynn=.5*Math.PI/180;function Xnn(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=g=>[g,e(g)],s=t[0],a=t[1],o=a-s,l=o/r,u=[i(s)],c=[];if(n===r){for(let g=1;g<r;++g)u.push(i(s+g/n*o));return u.push(i(a)),u}else{c.push(i(a));for(let g=n;--g>0;)c.push(i(s+g/n*o))}let f=u[0],h=c[c.length-1];const d=1/o,p=Knn(f[1],c);for(;h;){const g=i((f[0]+h[0])/2);g[0]-f[0]>=l&&Znn(f,g,h,d,p)>Ynn?c.push(g):(f=h,u.push(h),c.pop()),h=c[c.length-1]}return u}function Knn(e,t){let n=e,r=e;const i=t.length;for(let s=0;s<i;++s){const a=t[s][1];a<n&&(n=a),a>r&&(r=a)}return 1/(r-n)}function Znn(e,t,n,r,i){const s=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),a=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(s-a)}function Y_(e,t,n){return e.fields=t||[],e.fname=n,e}function Qnn(e){return e.length===1?Jnn(e[0]):ern(e)}const Jnn=e=>function(t){return t[e]},ern=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function sw(e){throw Error(e)}function trn(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||sw("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&sw("Access path missing closing bracket: "+e),r&&sw("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function nrn(e,t,n){const r=trn(e);return e=r.length===1?r[0]:e,Y_((n&&n.get||Qnn)(r),[e],t||e)}nrn("id");Y_(e=>e,[],"identity");const vk=Y_(()=>0,[],"zero"),rrn=Y_(()=>1,[],"one");Y_(()=>!0,[],"true");Y_(()=>!1,[],"false");var irn=Array.isArray;function u8e(e){return e[e.length-1]}function srn(e){return e!=null?irn(e)?e:[e]:[]}function arn(e){return typeof e=="function"}function orn(e){return arn(e)?e:()=>e}function lrn(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}const urn=Object.prototype.hasOwnProperty;function crn(e,t){return urn.call(e,t)}function frn(e){return e&&u8e(e)-e[0]||0}function hrn(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}var qH=new Date,GH=new Date;function ws(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=function(s){return e(s=new Date(+s)),s},i.ceil=function(s){return e(s=new Date(s-1)),t(s,1),e(s),s},i.round=function(s){var a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=function(s,a){return t(s=new Date(+s),a==null?1:Math.floor(a)),s},i.range=function(s,a,o){var l=[],u;if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=function(s){return ws(function(a){if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},function(a,o){if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););})},n&&(i.count=function(s,a){return qH.setTime(+s),GH.setTime(+a),e(qH),e(GH),Math.floor(n(qH,GH))},i.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?function(a){return r(a)%s===0}:function(a){return i.count(0,a)%s===0}):i}),i}var NL=ws(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});NL.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ws(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):NL};const Bae=NL;NL.range;const np=1e3,$u=np*60,rp=$u*60,sb=rp*24,zae=sb*7,mbe=sb*30,YH=sb*365;var c8e=ws(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*np)},function(e,t){return(t-e)/np},function(e){return e.getUTCSeconds()});const t0=c8e;c8e.range;var f8e=ws(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*np)},function(e,t){e.setTime(+e+t*$u)},function(e,t){return(t-e)/$u},function(e){return e.getMinutes()});const Uae=f8e;f8e.range;var h8e=ws(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*np-e.getMinutes()*$u)},function(e,t){e.setTime(+e+t*rp)},function(e,t){return(t-e)/rp},function(e){return e.getHours()});const Wae=h8e;h8e.range;var d8e=ws(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*$u)/sb,e=>e.getDate()-1);const y0=d8e;d8e.range;function cx(e){return ws(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*$u)/zae})}var X_=cx(0),ML=cx(1),drn=cx(2),prn=cx(3),b$=cx(4),grn=cx(5),mrn=cx(6);X_.range;ML.range;drn.range;prn.range;b$.range;grn.range;mrn.range;var p8e=ws(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()});const FL=p8e;p8e.range;var Vae=ws(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Vae.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ws(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};const rm=Vae;Vae.range;var g8e=ws(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*$u)},function(e,t){return(t-e)/$u},function(e){return e.getUTCMinutes()});const jae=g8e;g8e.range;var m8e=ws(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*rp)},function(e,t){return(t-e)/rp},function(e){return e.getUTCHours()});const Hae=m8e;m8e.range;var v8e=ws(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/sb},function(e){return e.getUTCDate()-1});const b0=v8e;v8e.range;function fx(e){return ws(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/zae})}var K_=fx(0),OL=fx(1),vrn=fx(2),yrn=fx(3),x$=fx(4),brn=fx(5),xrn=fx(6);K_.range;OL.range;vrn.range;yrn.range;x$.range;brn.range;xrn.range;var y8e=ws(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()});const RL=y8e;y8e.range;var qae=ws(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});qae.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ws(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};const im=qae;qae.range;function b8e(e,t,n,r,i,s){const a=[[t0,1,np],[t0,5,5*np],[t0,15,15*np],[t0,30,30*np],[s,1,$u],[s,5,5*$u],[s,15,15*$u],[s,30,30*$u],[i,1,rp],[i,3,3*rp],[i,6,6*rp],[i,12,12*rp],[r,1,sb],[r,2,2*sb],[n,1,zae],[t,1,mbe],[t,3,3*mbe],[e,1,YH]];function o(u,c,f){const h=c<u;h&&([u,c]=[c,u]);const d=f&&typeof f.range=="function"?f:l(u,c,f),p=d?d.range(u,+c+1):[];return h?p.reverse():p}function l(u,c,f){const h=Math.abs(c-u)/f,d=ZN(([,,m])=>m).right(a,h);if(d===a.length)return e.every(K0(u/YH,c/YH,f));if(d===0)return Bae.every(Math.max(K0(u,c,f),1));const[p,g]=a[h/a[d-1][2]<a[d][2]/h?d-1:d];return p.every(g)}return[o,l]}const[wrn,$rn]=b8e(im,RL,K_,b0,Hae,jae),[Crn,_rn]=b8e(rm,FL,X_,y0,Wae,Uae),uo="year",zu="quarter",el="month",Os="week",Uu="date",no="day",Bh="dayofyear",nf="hours",rf="minutes",zh="seconds",Uh="milliseconds",x8e=[uo,zu,el,Os,Uu,no,Bh,nf,rf,zh,Uh],XH=x8e.reduce((e,t,n)=>(e[t]=1+n,e),{});function w8e(e){const t=srn(e).slice(),n={};return t.length||sw("Missing time unit."),t.forEach(i=>{crn(XH,i)?n[i]=1:sw("Invalid time unit: ".concat(i,"."))}),(n[Os]||n[no]?1:0)+(n[zu]||n[el]||n[Uu]?1:0)+(n[Bh]?1:0)>1&&sw("Incompatible time units: ".concat(e)),t.sort((i,s)=>XH[i]-XH[s]),t}const Srn={[uo]:"%Y ",[zu]:"Q%q ",[el]:"%b ",[Uu]:"%d ",[Os]:"W%U ",[no]:"%a ",[Bh]:"%j ",[nf]:"%H:00",[rf]:"00:%M",[zh]:":%S",[Uh]:".%L",["".concat(uo,"-").concat(el)]:"%Y-%m ",["".concat(uo,"-").concat(el,"-").concat(Uu)]:"%Y-%m-%d ",["".concat(nf,"-").concat(rf)]:"%H:%M"};function krn(e,t){const n=lrn({},Srn,t),r=w8e(e),i=r.length;let s="",a=0,o,l;for(a=0;a<i;)for(o=r.length;o>a;--o)if(l=r.slice(a,o).join("-"),n[l]!=null){s+=n[l],a=o;break}return s.trim()}const p1=new Date;function Gae(e){return p1.setFullYear(e),p1.setMonth(0),p1.setDate(1),p1.setHours(0,0,0,0),p1}function Ern(e){return $8e(new Date(e))}function Arn(e){return $Z(new Date(e))}function $8e(e){return y0.count(Gae(e.getFullYear())-1,e)}function $Z(e){return X_.count(Gae(e.getFullYear())-1,e)}function CZ(e){return Gae(e).getDay()}function Trn(e,t,n,r,i,s,a){if(0<=e&&e<100){const o=new Date(-1,t,n,r,i,s,a);return o.setFullYear(e),o}return new Date(e,t,n,r,i,s,a)}function Drn(e){return C8e(new Date(e))}function Irn(e){return _Z(new Date(e))}function C8e(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return b0.count(t-1,e)}function _Z(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return K_.count(t-1,e)}function SZ(e){return p1.setTime(Date.UTC(e,0,1)),p1.getUTCDay()}function Nrn(e,t,n,r,i,s,a){if(0<=e&&e<100){const o=new Date(Date.UTC(-1,t,n,r,i,s,a));return o.setUTCFullYear(n.y),o}return new Date(Date.UTC(e,t,n,r,i,s,a))}function _8e(e,t,n,r,i){const s=t||1,a=u8e(e),o=(v,y,b)=>(b=b||v,Mrn(n[b],r[b],v===a&&s,y)),l=new Date,u=hrn(e),c=u[uo]?o(uo):orn(2012),f=u[el]?o(el):u[zu]?o(zu):vk,h=u[Os]&&u[no]?o(no,1,Os+no):u[Os]?o(Os,1):u[no]?o(no,1):u[Uu]?o(Uu,1):u[Bh]?o(Bh,1):rrn,d=u[nf]?o(nf):vk,p=u[rf]?o(rf):vk,g=u[zh]?o(zh):vk,m=u[Uh]?o(Uh):vk;return function(v){l.setTime(+v);const y=c(l);return i(y,f(l),h(l,y),d(l),p(l),g(l),m(l))}}function Mrn(e,t,n,r){const i=n<=1?e:r?(s,a)=>r+n*Math.floor((e(s,a)-r)/n):(s,a)=>n*Math.floor(e(s,a)/n);return t?(s,a)=>t(i(s,a),a):i}function w$(e,t,n){return t+e*7-(n+6)%7}const Frn={[uo]:e=>e.getFullYear(),[zu]:e=>Math.floor(e.getMonth()/3),[el]:e=>e.getMonth(),[Uu]:e=>e.getDate(),[nf]:e=>e.getHours(),[rf]:e=>e.getMinutes(),[zh]:e=>e.getSeconds(),[Uh]:e=>e.getMilliseconds(),[Bh]:e=>$8e(e),[Os]:e=>$Z(e),[Os+no]:(e,t)=>w$($Z(e),e.getDay(),CZ(t)),[no]:(e,t)=>w$(1,e.getDay(),CZ(t))},Orn={[zu]:e=>3*e,[Os]:(e,t)=>w$(e,0,CZ(t))};function Rrn(e,t){return _8e(e,t||1,Frn,Orn,Trn)}const Prn={[uo]:e=>e.getUTCFullYear(),[zu]:e=>Math.floor(e.getUTCMonth()/3),[el]:e=>e.getUTCMonth(),[Uu]:e=>e.getUTCDate(),[nf]:e=>e.getUTCHours(),[rf]:e=>e.getUTCMinutes(),[zh]:e=>e.getUTCSeconds(),[Uh]:e=>e.getUTCMilliseconds(),[Bh]:e=>C8e(e),[Os]:e=>_Z(e),[no]:(e,t)=>w$(1,e.getUTCDay(),SZ(t)),[Os+no]:(e,t)=>w$(_Z(e),e.getUTCDay(),SZ(t))},Lrn={[zu]:e=>3*e,[Os]:(e,t)=>w$(e,0,SZ(t))};function Brn(e,t){return _8e(e,t||1,Prn,Lrn,Nrn)}const zrn={[uo]:rm,[zu]:FL.every(3),[el]:FL,[Os]:X_,[Uu]:y0,[no]:y0,[Bh]:y0,[nf]:Wae,[rf]:Uae,[zh]:t0,[Uh]:Bae},Urn={[uo]:im,[zu]:RL.every(3),[el]:RL,[Os]:K_,[Uu]:b0,[no]:b0,[Bh]:b0,[nf]:Hae,[rf]:jae,[zh]:t0,[Uh]:Bae};function Yae(e){return zrn[e]}function Xae(e){return Urn[e]}function S8e(e,t,n){return e?e.offset(t,n):void 0}function Wrn(e,t,n){return S8e(Yae(e),t,n)}function Vrn(e,t,n){return S8e(Xae(e),t,n)}function k8e(e,t,n,r){return e?e.range(t,n,r):void 0}function jrn(e,t,n,r){return k8e(Yae(e),t,n,r)}function Hrn(e,t,n,r){return k8e(Xae(e),t,n,r)}const FE=1e3,OE=FE*60,RE=OE*60,V9=RE*24,qrn=V9*7,vbe=V9*30,kZ=V9*365,E8e=[uo,el,Uu,nf,rf,zh,Uh],PE=E8e.slice(0,-1),LE=PE.slice(0,-1),BE=LE.slice(0,-1),Grn=BE.slice(0,-1),Yrn=[uo,Os],ybe=[uo,el],A8e=[uo],yk=[[PE,1,FE],[PE,5,5*FE],[PE,15,15*FE],[PE,30,30*FE],[LE,1,OE],[LE,5,5*OE],[LE,15,15*OE],[LE,30,30*OE],[BE,1,RE],[BE,3,3*RE],[BE,6,6*RE],[BE,12,12*RE],[Grn,1,V9],[Yrn,1,qrn],[ybe,1,vbe],[ybe,3,3*vbe],[A8e,1,kZ]];function Xrn(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(frn(t))/n;let i=ZN(o=>o[2]).right(yk,r),s,a;return i===yk.length?(s=A8e,a=K0(t[0]/kZ,t[1]/kZ,n)):i?(i=yk[r/yk[i-1][2]<yk[i][2]/r?i-1:i],s=i[0],a=i[1]):(s=E8e,a=Math.max(K0(t[0],t[1],n),1)),{units:s,step:a}}function Z_(e,t,n){return e.fields=t||[],e.fname=n,e}function Krn(e){return e.length===1?Zrn(e[0]):Qrn(e)}const Zrn=e=>function(t){return t[e]},Qrn=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Wc(e){throw Error(e)}function Jrn(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||Wc("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&Wc("Access path missing closing bracket: "+e),r&&Wc("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function T8e(e,t,n){const r=Jrn(e);return e=r.length===1?r[0]:e,Z_((n&&n.get||Krn)(r),[e],t||e)}T8e("id");const D8e=Z_(e=>e,[],"identity");Z_(()=>0,[],"zero");Z_(()=>1,[],"one");Z_(()=>!0,[],"true");Z_(()=>!1,[],"false");var I8e=Array.isArray;function Kae(e){return e===Object(e)}function bbe(e){return e==null||e===""?null:+e}function Zae(e){return typeof e=="function"}function Qae(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}const ein=Object.prototype.hasOwnProperty;function N8e(e,t){return ein.call(e,t)}function tin(e){return Object.prototype.toString.call(e)==="[object Date]"}function nin(e){return e&&Zae(e[Symbol.iterator])}function rin(e){return typeof e=="number"}function EZ(e){return typeof e=="string"}function Jae(e){return I8e(e)?"["+e.map(Jae)+"]":Kae(e)||EZ(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function iin(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const sin=e=>rin(e)||tin(e)?e:Date.parse(e);function ain(e,t){return t=t||sin,e==null||e===""?null:t(e)}function oin(e){return e==null||e===""?null:e+""}var xbe={},KH={},ZH=34,bk=10,QH=13;function M8e(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function lin(e,t){var n=M8e(e);return function(r,i){return t(n(r),i,e)}}function wbe(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Fo(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function uin(e){return e<0?"-"+Fo(-e,6):e>9999?"+"+Fo(e,6):Fo(e,4)}function cin(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":uin(e.getUTCFullYear())+"-"+Fo(e.getUTCMonth()+1,2)+"-"+Fo(e.getUTCDate(),2)+(i?"T"+Fo(t,2)+":"+Fo(n,2)+":"+Fo(r,2)+"."+Fo(i,3)+"Z":r?"T"+Fo(t,2)+":"+Fo(n,2)+":"+Fo(r,2)+"Z":n||t?"T"+Fo(t,2)+":"+Fo(n,2)+"Z":"")}function fin(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,h){var d,p,g=i(f,function(m,v){if(d)return d(m,v-1);p=m,d=h?lin(m,h):M8e(m)});return g.columns=p||[],g}function i(f,h){var d=[],p=f.length,g=0,m=0,v,y=p<=0,b=!1;f.charCodeAt(p-1)===bk&&--p,f.charCodeAt(p-1)===QH&&--p;function x(){if(y)return KH;if(b)return b=!1,xbe;var C,$=g,_;if(f.charCodeAt($)===ZH){for(;g++<p&&f.charCodeAt(g)!==ZH||f.charCodeAt(++g)===ZH;);return(C=g)>=p?y=!0:(_=f.charCodeAt(g++))===bk?b=!0:_===QH&&(b=!0,f.charCodeAt(g)===bk&&++g),f.slice($+1,C-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(C=g++))===bk)b=!0;else if(_===QH)b=!0,f.charCodeAt(g)===bk&&++g;else if(_!==n)continue;return f.slice($,C)}return y=!0,f.slice($,p)}for(;(v=x())!==KH;){for(var w=[];v!==xbe&&v!==KH;)w.push(v),v=x();h&&(w=h(w,m++))==null||d.push(w)}return d}function s(f,h){return f.map(function(d){return h.map(function(p){return c(d[p])}).join(e)})}function a(f,h){return h==null&&(h=wbe(f)),[h.map(c).join(e)].concat(s(f,h)).join(`
`)}function o(f,h){return h==null&&(h=wbe(f)),s(f,h).join(`
`)}function l(f){return f.map(u).join(`
`)}function u(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?cin(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:a,formatBody:o,formatRows:l,formatRow:u,formatValue:c}}const hin=Math.sqrt(50),din=Math.sqrt(10),pin=Math.sqrt(2);function F8e(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=hin?10:s>=din?5:s>=pin?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?F8e(e,t,n*2):[o,l,u]}function $be(e,t,n){return t=+t,e=+e,n=+n,F8e(e,t,n)[2]}function gin(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?$be(t,e,n):$be(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function min(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function PL(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function $$(e){return e=PL(Math.abs(e)),e?e[1]:NaN}function vin(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function yin(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var bin=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function f3(e){if(!(t=bin.exec(e)))throw new Error("invalid format: "+e);var t;return new eoe({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}f3.prototype=eoe.prototype;function eoe(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}eoe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function xin(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var O8e;function win(e,t){var n=PL(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(O8e=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+PL(e,Math.max(0,t+s-1))[0]}function Cbe(e,t){var n=PL(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const _be={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:min,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Cbe(e*100,t),r:Cbe,s:win,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Sbe(e){return e}var kbe=Array.prototype.map,Ebe=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function $in(e){var t=e.grouping===void 0||e.thousands===void 0?Sbe:vin(kbe.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?Sbe:yin(kbe.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=f3(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):_be[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var C=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=g==="$"?r:/[%p]/.test(w)?a:"",_=_be[w],k=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(S){var I=C,A=$,D,T,N;if(w==="c")A=_(S)+A,S="";else{S=+S;var F=S<0||1/S<0;if(S=isNaN(S)?l:_(Math.abs(S),b),x&&(S=xin(S)),F&&+S==0&&p!=="+"&&(F=!1),I=(F?p==="("?p:o:p==="-"||p==="("?"":p)+I,A=(w==="s"?Ebe[8+O8e/3]:"")+A+(F&&p==="("?")":""),k){for(D=-1,T=S.length;++D<T;)if(N=S.charCodeAt(D),48>N||N>57){A=(N===46?i+S.slice(D+1):S.slice(D))+A,S=S.slice(0,D);break}}}y&&!m&&(S=t(S,1/0));var R=I.length+S.length+A.length,P=R<v?new Array(v-R+1).join(h):"";switch(y&&m&&(S=t(P+S,P.length?v-A.length:1/0),P=""),d){case"<":S=I+S+A+P;break;case"=":S=I+P+S+A;break;case"^":S=P.slice(0,R=P.length>>1)+I+S+A+P.slice(R);break;default:S=P+I+S+A;break}return s(S)}return E.toString=function(){return f+""},E}function c(f,h){var d=u((f=f3(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor($$(h)/3)))*3,g=Math.pow(10,-p),m=Ebe[8+p/3];return function(v){return d(g*v)+m}}return{format:u,formatPrefix:c}}var iR,R8e,P8e;Cin({thousands:",",grouping:[3],currency:["$",""]});function Cin(e){return iR=$in(e),R8e=iR.format,P8e=iR.formatPrefix,iR}function _in(e){return Math.max(0,-$$(Math.abs(e)))}function Sin(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor($$(t)/3)))*3-$$(Math.abs(e)))}function kin(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,$$(t)-$$(e))+1}const JH=new Date,eq=new Date;function Wi(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>Wi(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(JH.setTime(+s),eq.setTime(+a),e(JH),e(eq),Math.floor(n(JH,eq))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const h3=Wi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);h3.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Wi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):h3);h3.range;const d3=1e3,sm=d3*60,p3=sm*60,g3=p3*24,L8e=g3*7,toe=Wi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*d3)},(e,t)=>(t-e)/d3,e=>e.getUTCSeconds());toe.range;const B8e=Wi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*d3)},(e,t)=>{e.setTime(+e+t*sm)},(e,t)=>(t-e)/sm,e=>e.getMinutes());B8e.range;const z8e=Wi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*sm)},(e,t)=>(t-e)/sm,e=>e.getUTCMinutes());z8e.range;const U8e=Wi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*d3-e.getMinutes()*sm)},(e,t)=>{e.setTime(+e+t*p3)},(e,t)=>(t-e)/p3,e=>e.getHours());U8e.range;const W8e=Wi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*p3)},(e,t)=>(t-e)/p3,e=>e.getUTCHours());W8e.range;const aw=Wi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*sm)/g3,e=>e.getDate()-1);aw.range;const ow=Wi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/g3,e=>e.getUTCDate()-1);ow.range;const Ein=Wi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/g3,e=>Math.floor(e/g3));Ein.range;function hx(e){return Wi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*sm)/L8e)}const noe=hx(0),LL=hx(1),Ain=hx(2),Tin=hx(3),C$=hx(4),Din=hx(5),Iin=hx(6);noe.range;LL.range;Ain.range;Tin.range;C$.range;Din.range;Iin.range;function dx(e){return Wi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/L8e)}const roe=dx(0),BL=dx(1),Nin=dx(2),Min=dx(3),_$=dx(4),Fin=dx(5),Oin=dx(6);roe.range;BL.range;Nin.range;Min.range;_$.range;Fin.range;Oin.range;const AZ=Wi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());AZ.range;const TZ=Wi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());TZ.range;const am=Wi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());am.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Wi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});am.range;const om=Wi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());om.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Wi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});om.range;const m3="year",v3="quarter",y3="month",b3="week",x3="date",j9="day",ioe="dayofyear",w3="hours",$3="minutes",C3="seconds",H9="milliseconds",Rin=[m3,v3,y3,b3,x3,j9,ioe,w3,$3,C3,H9];Rin.reduce((e,t,n)=>(e[t]=1+n,e),{});const Pin={[m3]:am,[v3]:AZ.every(3),[y3]:AZ,[b3]:noe,[x3]:aw,[j9]:aw,[ioe]:aw,[w3]:U8e,[$3]:B8e,[C3]:toe,[H9]:h3},Lin={[m3]:om,[v3]:TZ.every(3),[y3]:TZ,[b3]:roe,[x3]:ow,[j9]:ow,[ioe]:ow,[w3]:W8e,[$3]:z8e,[C3]:toe,[H9]:h3};function Bin(e){return Pin[e]}function zin(e){return Lin[e]}function tq(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function nq(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function xk(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function V8e(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=wk(i),c=$k(i),f=wk(s),h=$k(s),d=wk(a),p=$k(a),g=wk(o),m=$k(o),v=wk(l),y=$k(l),b={a:F,A:R,b:P,B:V,c:null,d:Mbe,e:Mbe,f:usn,g:bsn,G:wsn,H:asn,I:osn,j:lsn,L:j8e,m:csn,M:fsn,p:z,q,Q:Rbe,s:Pbe,S:hsn,u:dsn,U:psn,V:gsn,w:msn,W:vsn,x:null,X:null,y:ysn,Y:xsn,Z:$sn,"%":Obe},x={a:G,A:K,b:Y,B:te,c:null,d:Fbe,e:Fbe,f:ksn,g:Rsn,G:Lsn,H:Csn,I:_sn,j:Ssn,L:q8e,m:Esn,M:Asn,p:Z,q:ae,Q:Rbe,s:Pbe,S:Tsn,u:Dsn,U:Isn,V:Nsn,w:Msn,W:Fsn,x:null,X:null,y:Osn,Y:Psn,Z:Bsn,"%":Obe},w={a:E,A:S,b:I,B:A,c:D,d:Ibe,e:Ibe,f:nsn,g:Dbe,G:Tbe,H:Nbe,I:Nbe,j:Qin,L:tsn,m:Zin,M:Jin,p:k,q:Kin,Q:isn,s:ssn,S:esn,u:Hin,U:qin,V:Gin,w:jin,W:Yin,x:T,X:N,y:Dbe,Y:Tbe,Z:Xin,"%":rsn};b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x);function C(O,L){return function(W){var M=[],ue=-1,X=0,se=O.length,oe,pe,Ce;for(W instanceof Date||(W=new Date(+W));++ue<se;)O.charCodeAt(ue)===37&&(M.push(O.slice(X,ue)),(pe=Abe[oe=O.charAt(++ue)])!=null?oe=O.charAt(++ue):pe=oe==="e"?" ":"0",(Ce=L[oe])&&(oe=Ce(W,pe)),M.push(oe),X=ue+1);return M.push(O.slice(X,ue)),M.join("")}}function $(O,L){return function(W){var M=xk(1900,void 0,1),ue=_(M,O,W+="",0),X,se;if(ue!=W.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(L&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(X=nq(xk(M.y,0,1)),se=X.getUTCDay(),X=se>4||se===0?BL.ceil(X):BL(X),X=ow.offset(X,(M.V-1)*7),M.y=X.getUTCFullYear(),M.m=X.getUTCMonth(),M.d=X.getUTCDate()+(M.w+6)%7):(X=tq(xk(M.y,0,1)),se=X.getDay(),X=se>4||se===0?LL.ceil(X):LL(X),X=aw.offset(X,(M.V-1)*7),M.y=X.getFullYear(),M.m=X.getMonth(),M.d=X.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),se="Z"in M?nq(xk(M.y,0,1)).getUTCDay():tq(xk(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(se+5)%7:M.w+M.U*7-(se+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,nq(M)):tq(M)}}function _(O,L,W,M){for(var ue=0,X=L.length,se=W.length,oe,pe;ue<X;){if(M>=se)return-1;if(oe=L.charCodeAt(ue++),oe===37){if(oe=L.charAt(ue++),pe=w[oe in Abe?L.charAt(ue++):oe],!pe||(M=pe(O,W,M))<0)return-1}else if(oe!=W.charCodeAt(M++))return-1}return M}function k(O,L,W){var M=u.exec(L.slice(W));return M?(O.p=c.get(M[0].toLowerCase()),W+M[0].length):-1}function E(O,L,W){var M=d.exec(L.slice(W));return M?(O.w=p.get(M[0].toLowerCase()),W+M[0].length):-1}function S(O,L,W){var M=f.exec(L.slice(W));return M?(O.w=h.get(M[0].toLowerCase()),W+M[0].length):-1}function I(O,L,W){var M=v.exec(L.slice(W));return M?(O.m=y.get(M[0].toLowerCase()),W+M[0].length):-1}function A(O,L,W){var M=g.exec(L.slice(W));return M?(O.m=m.get(M[0].toLowerCase()),W+M[0].length):-1}function D(O,L,W){return _(O,t,L,W)}function T(O,L,W){return _(O,n,L,W)}function N(O,L,W){return _(O,r,L,W)}function F(O){return a[O.getDay()]}function R(O){return s[O.getDay()]}function P(O){return l[O.getMonth()]}function V(O){return o[O.getMonth()]}function z(O){return i[+(O.getHours()>=12)]}function q(O){return 1+~~(O.getMonth()/3)}function G(O){return a[O.getUTCDay()]}function K(O){return s[O.getUTCDay()]}function Y(O){return l[O.getUTCMonth()]}function te(O){return o[O.getUTCMonth()]}function Z(O){return i[+(O.getUTCHours()>=12)]}function ae(O){return 1+~~(O.getUTCMonth()/3)}return{format:function(O){var L=C(O+="",b);return L.toString=function(){return O},L},parse:function(O){var L=$(O+="",!1);return L.toString=function(){return O},L},utcFormat:function(O){var L=C(O+="",x);return L.toString=function(){return O},L},utcParse:function(O){var L=$(O+="",!0);return L.toString=function(){return O},L}}}var Abe={"-":"",_:" ",0:"0"},$s=/^\s*\d+/,Uin=/^%/,Win=/[\\^$*+?|[\]().{}]/g;function Cn(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function Vin(e){return e.replace(Win,"\\$&")}function wk(e){return new RegExp("^(?:"+e.map(Vin).join("|")+")","i")}function $k(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function jin(e,t,n){var r=$s.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Hin(e,t,n){var r=$s.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function qin(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Gin(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Yin(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Tbe(e,t,n){var r=$s.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Dbe(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Xin(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Kin(e,t,n){var r=$s.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function Zin(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Ibe(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Qin(e,t,n){var r=$s.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Nbe(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Jin(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function esn(e,t,n){var r=$s.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function tsn(e,t,n){var r=$s.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function nsn(e,t,n){var r=$s.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function rsn(e,t,n){var r=Uin.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function isn(e,t,n){var r=$s.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function ssn(e,t,n){var r=$s.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Mbe(e,t){return Cn(e.getDate(),t,2)}function asn(e,t){return Cn(e.getHours(),t,2)}function osn(e,t){return Cn(e.getHours()%12||12,t,2)}function lsn(e,t){return Cn(1+aw.count(am(e),e),t,3)}function j8e(e,t){return Cn(e.getMilliseconds(),t,3)}function usn(e,t){return j8e(e,t)+"000"}function csn(e,t){return Cn(e.getMonth()+1,t,2)}function fsn(e,t){return Cn(e.getMinutes(),t,2)}function hsn(e,t){return Cn(e.getSeconds(),t,2)}function dsn(e){var t=e.getDay();return t===0?7:t}function psn(e,t){return Cn(noe.count(am(e)-1,e),t,2)}function H8e(e){var t=e.getDay();return t>=4||t===0?C$(e):C$.ceil(e)}function gsn(e,t){return e=H8e(e),Cn(C$.count(am(e),e)+(am(e).getDay()===4),t,2)}function msn(e){return e.getDay()}function vsn(e,t){return Cn(LL.count(am(e)-1,e),t,2)}function ysn(e,t){return Cn(e.getFullYear()%100,t,2)}function bsn(e,t){return e=H8e(e),Cn(e.getFullYear()%100,t,2)}function xsn(e,t){return Cn(e.getFullYear()%1e4,t,4)}function wsn(e,t){var n=e.getDay();return e=n>=4||n===0?C$(e):C$.ceil(e),Cn(e.getFullYear()%1e4,t,4)}function $sn(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Cn(t/60|0,"0",2)+Cn(t%60,"0",2)}function Fbe(e,t){return Cn(e.getUTCDate(),t,2)}function Csn(e,t){return Cn(e.getUTCHours(),t,2)}function _sn(e,t){return Cn(e.getUTCHours()%12||12,t,2)}function Ssn(e,t){return Cn(1+ow.count(om(e),e),t,3)}function q8e(e,t){return Cn(e.getUTCMilliseconds(),t,3)}function ksn(e,t){return q8e(e,t)+"000"}function Esn(e,t){return Cn(e.getUTCMonth()+1,t,2)}function Asn(e,t){return Cn(e.getUTCMinutes(),t,2)}function Tsn(e,t){return Cn(e.getUTCSeconds(),t,2)}function Dsn(e){var t=e.getUTCDay();return t===0?7:t}function Isn(e,t){return Cn(roe.count(om(e)-1,e),t,2)}function G8e(e){var t=e.getUTCDay();return t>=4||t===0?_$(e):_$.ceil(e)}function Nsn(e,t){return e=G8e(e),Cn(_$.count(om(e),e)+(om(e).getUTCDay()===4),t,2)}function Msn(e){return e.getUTCDay()}function Fsn(e,t){return Cn(BL.count(om(e)-1,e),t,2)}function Osn(e,t){return Cn(e.getUTCFullYear()%100,t,2)}function Rsn(e,t){return e=G8e(e),Cn(e.getUTCFullYear()%100,t,2)}function Psn(e,t){return Cn(e.getUTCFullYear()%1e4,t,4)}function Lsn(e,t){var n=e.getUTCDay();return e=n>=4||n===0?_$(e):_$.ceil(e),Cn(e.getUTCFullYear()%1e4,t,4)}function Bsn(){return"+0000"}function Obe(){return"%"}function Rbe(e){return+e}function Pbe(e){return Math.floor(+e/1e3)}var h2,Y8e,X8e,K8e,Z8e;zsn({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function zsn(e){return h2=V8e(e),Y8e=h2.format,X8e=h2.parse,K8e=h2.utcFormat,Z8e=h2.utcParse,h2}function zE(e){const t={};return n=>t[n]||(t[n]=e(n))}function Usn(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=Wsn(r,i);const a=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+a}}function Wsn(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function Vsn(e){const t=zE(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=f3(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return Usn(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,a){a=f3(a==null?",f":a);const o=gin(r,i,s),l=Math.max(Math.abs(r),Math.abs(i));let u;if(a.precision==null)switch(a.type){case"s":return isNaN(u=Sin(o,l))||(a.precision=u),n(a,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=kin(o,l))||(a.precision=u-(a.type==="e"));break}case"f":case"%":{isNaN(u=_in(o))||(a.precision=u-(a.type==="%")*2);break}}return t(a)}}}jsn();function jsn(){return Vsn({format:R8e,formatPrefix:P8e})}function Lbe(e,t,n){n=n||{},Kae(n)||Wc(`Invalid time multi-format specifier: ${n}`);const r=t(C3),i=t($3),s=t(w3),a=t(x3),o=t(b3),l=t(y3),u=t(v3),c=t(m3),f=e(n[H9]||".%L"),h=e(n[C3]||":%S"),d=e(n[$3]||"%I:%M"),p=e(n[w3]||"%I %p"),g=e(n[x3]||n[j9]||"%a %d"),m=e(n[b3]||"%b %d"),v=e(n[y3]||"%B"),y=e(n[v3]||"%B"),b=e(n[m3]||"%Y");return x=>(r(x)<x?f:i(x)<x?h:s(x)<x?d:a(x)<x?p:l(x)<x?o(x)<x?g:m:c(x)<x?u(x)<x?v:y:b)(x)}function Q8e(e){const t=zE(e.format),n=zE(e.utcFormat);return{timeFormat:r=>EZ(r)?t(r):Lbe(t,Bin,r),utcFormat:r=>EZ(r)?n(r):Lbe(n,zin,r),timeParse:zE(e.parse),utcParse:zE(e.utcParse)}}let DZ;Hsn();function Hsn(){return DZ=Q8e({format:Y8e,parse:X8e,utcFormat:K8e,utcParse:Z8e})}function qsn(e){return Q8e(V8e(e))}function Gsn(e){return arguments.length?DZ=qsn(e):DZ}const Ysn=/^(data:|([A-Za-z]+:)?\/\/)/,Xsn=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Ksn=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Bbe="file://";function Zsn(e,t){return n=>({options:n||{},sanitize:Jsn,load:Qsn,fileAccess:!!t,file:ean(t),http:nan(e)})}async function Qsn(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function Jsn(e,t){t=Qae({},this.options,t);const n=this.fileAccess,r={href:null};let i,s,a;const o=Xsn.test(e.replace(Ksn,""));(e==null||typeof e!="string"||!o)&&Wc("Sanitize failure, invalid URI: "+Jae(e));const l=Ysn.test(e);return(a=t.baseURL)&&!l&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),s=(i=e.startsWith(Bbe))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice(Bbe.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!s}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function ean(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,s)=>{i?r(i):n(s)})}):tan}async function tan(){Wc("No file system access.")}function nan(e){return e?async function(t,n){const r=Qae({},this.options.http,n),i=n&&n.response,s=await e(t,r);return s.ok?Zae(s[i])?s[i]():s.text():Wc(s.status+""+s.statusText)}:ran}async function ran(){Wc("No HTTP fetch method available.")}const ian=e=>e!=null&&e===e,san=e=>e==="true"||e==="false"||e===!0||e===!1,aan=e=>!Number.isNaN(Date.parse(e)),J8e=e=>!Number.isNaN(+e)&&!(e instanceof Date),oan=e=>J8e(e)&&Number.isInteger(+e),IZ={boolean:iin,integer:bbe,number:bbe,date:ain,string:oin,unknown:D8e},sR=[san,oan,J8e,aan],lan=["boolean","integer","number","date"];function eze(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=sR.length,i=sR.map((s,a)=>a+1);for(let s=0,a=0,o,l;s<n;++s)for(l=t?e[s][t]:e[s],o=0;o<r;++o)if(i[o]&&ian(l)&&!sR[o](l)&&(i[o]=0,++a,a===sR.length))return"string";return lan[i.reduce((s,a)=>s===0?a:s,0)-1]}function tze(e,t){return t.reduce((n,r)=>(n[r]=eze(e,r),n),{})}function zbe(e){const t=function(n,r){const i={delimiter:e};return soe(n,r?Qae(r,i):i)};return t.responseType="text",t}function soe(e,t){return t.header&&(e=t.header.map(Jae).join(t.delimiter)+`
`+e),fin(t.delimiter).parse(e+"")}soe.responseType="text";function uan(e){return typeof Buffer=="function"&&Zae(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function aoe(e,t){const n=t&&t.property?T8e(t.property):D8e;return Kae(e)&&!uan(e)?can(n(e),t):n(JSON.parse(e))}aoe.responseType="json";function can(e,t){return!I8e(e)&&nin(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const fan={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function nze(e,t){let n,r,i,s;return e=aoe(e,t),t&&t.feature?(n=sOe,i=t.feature):t&&t.mesh?(n=oOe,i=t.mesh,s=fan[t.filter]):Wc("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,s):Wc("Invalid TopoJSON object: "+i),r&&r.features||[r]}nze.responseType="json";const x4={dsv:soe,csv:zbe(","),tsv:zbe("	"),json:aoe,topojson:nze};function ooe(e,t){return arguments.length>1?(x4[e]=t,this):N8e(x4,e)?x4[e]:null}function han(e){const t=ooe(e);return t&&t.responseType||"text"}function dan(e,t,n,r){t=t||{};const i=ooe(t.type||"json");return i||Wc("Unknown data format type: "+t.type),e=i(e,t),t.parse&&pan(e,t.parse,n,r),N8e(e,"columns")&&delete e.columns,e}function pan(e,t,n,r){if(!e.length)return;const i=Gsn();n=n||i.timeParse,r=r||i.utcParse;let s=e.columns||Object.keys(e[0]),a,o,l,u,c,f;t==="auto"&&(t=tze(e,s)),s=Object.keys(t);const h=s.map(d=>{const p=t[d];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?r:n)(m);if(!IZ[p])throw Error("Illegal format pattern: "+d+":"+p);return IZ[p]});for(l=0,c=e.length,f=s.length;l<c;++l)for(a=e[l],u=0;u<f;++u)o=s[u],a[o]=h[u](a[o])}const gan=Zsn(typeof fetch<"u"&&fetch,null);function Q_(e,t,n){return e.fields=t||[],e.fname=n,e}function man(e){return e.length===1?van(e[0]):yan(e)}const van=e=>function(t){return t[e]},yan=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function hh(e){throw Error(e)}function ban(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||hh("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&hh("Access path missing closing bracket: "+e),r&&hh("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function xan(e,t,n){const r=ban(e);return e=r.length===1?r[0]:e,Q_((n&&n.get||man)(r),[e],t||e)}xan("id");Q_(e=>e,[],"identity");Q_(()=>0,[],"zero");Q_(()=>1,[],"one");const rze=Q_(()=>!0,[],"true");Q_(()=>!1,[],"false");var ud=Array.isArray;function zL(e){return e===Object(e)}function ab(e){return e[e.length-1]}function wan(e){return e==null||e===""?null:+e}function loe(e){return e!=null?ud(e)?e:[e]:[]}function q9(e){return typeof e=="function"}function G9(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}const $an=Object.prototype.hasOwnProperty;function Kd(e,t){return $an.call(e,t)}function J_(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),G9(r,n)}function Ube(e){return typeof e=="number"}function UL(e){return typeof e=="string"}const Can=1e4;function _an(e){e=+e||Can;let t,n,r;const i=()=>{t={},n={},r=0},s=(a,o)=>(++r>e&&(n=t,t={},r=1),t[a]=o);return i(),{clear:i,has:a=>Kd(t,a)||Kd(n,a),get:a=>Kd(t,a)?t[a]:Kd(n,a)?s(a,n[a]):void 0,set:(a,o)=>Kd(t,a)?t[a]=o:s(a,o)}}function ize(e){return ud(e)?"["+e.map(ize)+"]":zL(e)||UL(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function sze(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}const NZ=Math.PI,MZ=2*NZ,Jv=1e-6,San=MZ-Jv;function FZ(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function px(){return new FZ}FZ.prototype=px.prototype={constructor:FZ,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,s){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var s=this._x1,a=this._y1,o=n-e,l=r-t,u=s-e,c=a-t,f=u*u+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>Jv)if(!(Math.abs(c*o-l*u)>Jv)||!i)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var h=n-s,d=r-a,p=o*o+l*l,g=h*h+d*d,m=Math.sqrt(p),v=Math.sqrt(f),y=i*Math.tan((NZ-Math.acos((p+f-g)/(2*m*v)))/2),b=y/v,x=y/m;Math.abs(b-1)>Jv&&(this._+="L"+(e+b*u)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*h>u*d)+","+(this._x1=e+x*o)+","+(this._y1=t+x*l)}},arc:function(e,t,n,r,i,s){e=+e,t=+t,n=+n,s=!!s;var a=n*Math.cos(r),o=n*Math.sin(r),l=e+a,u=t+o,c=1^s,f=s?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+l+","+u:(Math.abs(this._x1-l)>Jv||Math.abs(this._y1-u)>Jv)&&(this._+="L"+l+","+u),n&&(f<0&&(f=f%MZ+MZ),f>San?this._+="A"+n+","+n+",0,1,"+c+","+(e-a)+","+(t-o)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):f>Jv&&(this._+="A"+n+","+n+",0,"+ +(f>=NZ)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function Nn(e){return function(){return e}}var Wbe=Math.abs,Js=Math.atan2,Dv=Math.cos,kan=Math.max,rq=Math.min,Ef=Math.sin,P2=Math.sqrt,ra=1e-12,S$=Math.PI,WL=S$/2,aze=2*S$;function Ean(e){return e>1?0:e<-1?S$:Math.acos(e)}function Vbe(e){return e>=1?WL:e<=-1?-WL:Math.asin(e)}function Aan(e){return e.innerRadius}function Tan(e){return e.outerRadius}function Dan(e){return e.startAngle}function Ian(e){return e.endAngle}function Nan(e){return e&&e.padAngle}function Man(e,t,n,r,i,s,a,o){var l=n-e,u=r-t,c=a-i,f=o-s,h=f*l-c*u;if(!(h*h<ra))return h=(c*(t-s)-f*(e-i))/h,[e+h*l,t+h*u]}function aR(e,t,n,r,i,s,a){var o=e-n,l=t-r,u=(a?s:-s)/P2(o*o+l*l),c=u*l,f=-u*o,h=e+c,d=t+f,p=n+c,g=r+f,m=(h+p)/2,v=(d+g)/2,y=p-h,b=g-d,x=y*y+b*b,w=i-s,C=h*g-p*d,$=(b<0?-1:1)*P2(kan(0,w*w*x-C*C)),_=(C*b-y*$)/x,k=(-C*y-b*$)/x,E=(C*b+y*$)/x,S=(-C*y+b*$)/x,I=_-m,A=k-v,D=E-m,T=S-v;return I*I+A*A>D*D+T*T&&(_=E,k=S),{cx:_,cy:k,x01:-c,y01:-f,x11:_*(i/w-1),y11:k*(i/w-1)}}function Fan(){var e=Aan,t=Tan,n=Nn(0),r=null,i=Dan,s=Ian,a=Nan,o=null;function l(){var u,c,f=+e.apply(this,arguments),h=+t.apply(this,arguments),d=i.apply(this,arguments)-WL,p=s.apply(this,arguments)-WL,g=Wbe(p-d),m=p>d;if(o||(o=u=px()),h<f&&(c=h,h=f,f=c),!(h>ra))o.moveTo(0,0);else if(g>aze-ra)o.moveTo(h*Dv(d),h*Ef(d)),o.arc(0,0,h,d,p,!m),f>ra&&(o.moveTo(f*Dv(p),f*Ef(p)),o.arc(0,0,f,p,d,m));else{var v=d,y=p,b=d,x=p,w=g,C=g,$=a.apply(this,arguments)/2,_=$>ra&&(r?+r.apply(this,arguments):P2(f*f+h*h)),k=rq(Wbe(h-f)/2,+n.apply(this,arguments)),E=k,S=k,I,A;if(_>ra){var D=Vbe(_/f*Ef($)),T=Vbe(_/h*Ef($));(w-=D*2)>ra?(D*=m?1:-1,b+=D,x-=D):(w=0,b=x=(d+p)/2),(C-=T*2)>ra?(T*=m?1:-1,v+=T,y-=T):(C=0,v=y=(d+p)/2)}var N=h*Dv(v),F=h*Ef(v),R=f*Dv(x),P=f*Ef(x);if(k>ra){var V=h*Dv(y),z=h*Ef(y),q=f*Dv(b),G=f*Ef(b),K;if(g<S$&&(K=Man(N,F,q,G,V,z,R,P))){var Y=N-K[0],te=F-K[1],Z=V-K[0],ae=z-K[1],O=1/Ef(Ean((Y*Z+te*ae)/(P2(Y*Y+te*te)*P2(Z*Z+ae*ae)))/2),L=P2(K[0]*K[0]+K[1]*K[1]);E=rq(k,(f-L)/(O-1)),S=rq(k,(h-L)/(O+1))}}C>ra?S>ra?(I=aR(q,G,N,F,h,S,m),A=aR(V,z,R,P,h,S,m),o.moveTo(I.cx+I.x01,I.cy+I.y01),S<k?o.arc(I.cx,I.cy,S,Js(I.y01,I.x01),Js(A.y01,A.x01),!m):(o.arc(I.cx,I.cy,S,Js(I.y01,I.x01),Js(I.y11,I.x11),!m),o.arc(0,0,h,Js(I.cy+I.y11,I.cx+I.x11),Js(A.cy+A.y11,A.cx+A.x11),!m),o.arc(A.cx,A.cy,S,Js(A.y11,A.x11),Js(A.y01,A.x01),!m))):(o.moveTo(N,F),o.arc(0,0,h,v,y,!m)):o.moveTo(N,F),!(f>ra)||!(w>ra)?o.lineTo(R,P):E>ra?(I=aR(R,P,V,z,f,-E,m),A=aR(N,F,q,G,f,-E,m),o.lineTo(I.cx+I.x01,I.cy+I.y01),E<k?o.arc(I.cx,I.cy,E,Js(I.y01,I.x01),Js(A.y01,A.x01),!m):(o.arc(I.cx,I.cy,E,Js(I.y01,I.x01),Js(I.y11,I.x11),!m),o.arc(0,0,f,Js(I.cy+I.y11,I.cx+I.x11),Js(A.cy+A.y11,A.cx+A.x11),m),o.arc(A.cx,A.cy,E,Js(A.y11,A.x11),Js(A.y01,A.x01),!m))):o.arc(0,0,f,x,b,m)}if(o.closePath(),u)return o=null,u+""||null}return l.centroid=function(){var u=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-S$/2;return[Dv(c)*u,Ef(c)*u]},l.innerRadius=function(u){return arguments.length?(e=typeof u=="function"?u:Nn(+u),l):e},l.outerRadius=function(u){return arguments.length?(t=typeof u=="function"?u:Nn(+u),l):t},l.cornerRadius=function(u){return arguments.length?(n=typeof u=="function"?u:Nn(+u),l):n},l.padRadius=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:Nn(+u),l):r},l.startAngle=function(u){return arguments.length?(i=typeof u=="function"?u:Nn(+u),l):i},l.endAngle=function(u){return arguments.length?(s=typeof u=="function"?u:Nn(+u),l):s},l.padAngle=function(u){return arguments.length?(a=typeof u=="function"?u:Nn(+u),l):a},l.context=function(u){return arguments.length?(o=u==null?null:u,l):o},l}function oze(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function lze(e){this._context=e}lze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function uoe(e){return new lze(e)}function uze(e){return e[0]}function cze(e){return e[1]}function fze(e,t){var n=Nn(!0),r=null,i=uoe,s=null;e=typeof e=="function"?e:e===void 0?uze:Nn(e),t=typeof t=="function"?t:t===void 0?cze:Nn(t);function a(o){var l,u=(o=oze(o)).length,c,f=!1,h;for(r==null&&(s=i(h=px())),l=0;l<=u;++l)!(l<u&&n(c=o[l],l,o))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+e(c,l,o),+t(c,l,o));if(h)return s=null,h+""||null}return a.x=function(o){return arguments.length?(e=typeof o=="function"?o:Nn(+o),a):e},a.y=function(o){return arguments.length?(t=typeof o=="function"?o:Nn(+o),a):t},a.defined=function(o){return arguments.length?(n=typeof o=="function"?o:Nn(!!o),a):n},a.curve=function(o){return arguments.length?(i=o,r!=null&&(s=i(r)),a):i},a.context=function(o){return arguments.length?(o==null?r=s=null:s=i(r=o),a):r},a}function hze(e,t,n){var r=null,i=Nn(!0),s=null,a=uoe,o=null;e=typeof e=="function"?e:e===void 0?uze:Nn(+e),t=typeof t=="function"?t:Nn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?cze:Nn(+n);function l(c){var f,h,d,p=(c=oze(c)).length,g,m=!1,v,y=new Array(p),b=new Array(p);for(s==null&&(o=a(v=px())),f=0;f<=p;++f){if(!(f<p&&i(g=c[f],f,c))===m)if(m=!m)h=f,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),d=f-1;d>=h;--d)o.point(y[d],b[d]);o.lineEnd(),o.areaEnd()}m&&(y[f]=+e(g,f,c),b[f]=+t(g,f,c),o.point(r?+r(g,f,c):y[f],n?+n(g,f,c):b[f]))}if(v)return o=null,v+""||null}function u(){return fze().defined(i).curve(a).context(s)}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:Nn(+c),r=null,l):e},l.x0=function(c){return arguments.length?(e=typeof c=="function"?c:Nn(+c),l):e},l.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Nn(+c),l):r},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:Nn(+c),n=null,l):t},l.y0=function(c){return arguments.length?(t=typeof c=="function"?c:Nn(+c),l):t},l.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Nn(+c),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(c){return arguments.length?(i=typeof c=="function"?c:Nn(!!c),l):i},l.curve=function(c){return arguments.length?(a=c,s!=null&&(o=a(s)),l):a},l.context=function(c){return arguments.length?(c==null?s=o=null:o=a(s=c),l):s},l}const Oan={draw:function(e,t){var n=Math.sqrt(t/S$);e.moveTo(n,0),e.arc(0,0,n,0,aze)}};function Ran(e,t){var n=null;e=typeof e=="function"?e:Nn(e||Oan),t=typeof t=="function"?t:Nn(t===void 0?64:+t);function r(){var i;if(n||(n=i=px()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:Nn(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:Nn(+i),r):t},r.context=function(i){return arguments.length?(n=i==null?null:i,r):n},r}function lm(){}function VL(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Y9(e){this._context=e}Y9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:VL(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:VL(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Pan(e){return new Y9(e)}function dze(e){this._context=e}dze.prototype={areaStart:lm,areaEnd:lm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:VL(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Lan(e){return new dze(e)}function pze(e){this._context=e}pze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:VL(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Ban(e){return new pze(e)}function gze(e,t){this._basis=new Y9(e),this._beta=t}gze.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,a=t[n]-i,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*s),this._beta*t[o]+(1-this._beta)*(i+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const zan=function e(t){function n(r){return t===1?new Y9(r):new gze(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function jL(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function coe(e,t){this._context=e,this._k=(1-t)/6}coe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:jL(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:jL(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Uan=function e(t){function n(r){return new coe(r,t)}return n.tension=function(r){return e(+r)},n}(0);function foe(e,t){this._context=e,this._k=(1-t)/6}foe.prototype={areaStart:lm,areaEnd:lm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:jL(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Wan=function e(t){function n(r){return new foe(r,t)}return n.tension=function(r){return e(+r)},n}(0);function hoe(e,t){this._context=e,this._k=(1-t)/6}hoe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:jL(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Van=function e(t){function n(r){return new hoe(r,t)}return n.tension=function(r){return e(+r)},n}(0);function doe(e,t,n){var r=e._x1,i=e._y1,s=e._x2,a=e._y2;if(e._l01_a>ra){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>ra){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,s,a,e._x2,e._y2)}function mze(e,t){this._context=e,this._alpha=t}mze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:doe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const jan=function e(t){function n(r){return t?new mze(r,t):new coe(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function vze(e,t){this._context=e,this._alpha=t}vze.prototype={areaStart:lm,areaEnd:lm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:doe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Han=function e(t){function n(r){return t?new vze(r,t):new foe(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function yze(e,t){this._context=e,this._alpha=t}yze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:doe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const qan=function e(t){function n(r){return t?new yze(r,t):new hoe(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function bze(e){this._context=e}bze.prototype={areaStart:lm,areaEnd:lm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Gan(e){return new bze(e)}function jbe(e){return e<0?-1:1}function Hbe(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),o=(s*i+a*r)/(r+i);return(jbe(s)+jbe(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function qbe(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function iq(e,t,n){var r=e._x0,i=e._y0,s=e._x1,a=e._y1,o=(s-r)/3;e._context.bezierCurveTo(r+o,i+o*t,s-o,a-o*n,s,a)}function HL(e){this._context=e}HL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:iq(this,this._t0,qbe(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,iq(this,qbe(this,n=Hbe(this,e,t)),n);break;default:iq(this,this._t0,n=Hbe(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function xze(e){this._context=new wze(e)}(xze.prototype=Object.create(HL.prototype)).point=function(e,t){HL.prototype.point.call(this,t,e)};function wze(e){this._context=e}wze.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function Yan(e){return new HL(e)}function Xan(e){return new xze(e)}function $ze(e){this._context=e}$ze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=Gbe(e),i=Gbe(t),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Gbe(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),a=new Array(n);for(i[0]=0,s[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function Kan(e){return new $ze(e)}function X9(e,t){this._context=e,this._t=t}X9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Zan(e){return new X9(e,.5)}function Qan(e){return new X9(e,0)}function Jan(e){return new X9(e,1)}function $A(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function eon(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function poe(e){let t,n,r;e.length!==2?(t=$A,n=(o,l)=>$A(e(o),l),r=(o,l)=>e(o)-l):(t=e===$A||e===eon?e:ton,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function ton(){return 0}function Cze(e){return e===null?NaN:+e}const non=poe($A),OZ=non.right;poe(Cze).center;const wM=OZ,ron=Math.sqrt(50),ion=Math.sqrt(10),son=Math.sqrt(2);function qL(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=ron?10:s>=ion?5:s>=son?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?qL(e,t,n*2):[o,l,u]}function RZ(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,a]=r?qL(t,e,n):qL(e,t,n);if(!(s>=i))return[];const o=s-i+1,l=new Array(o);if(r)if(a<0)for(let u=0;u<o;++u)l[u]=(s-u)/-a;else for(let u=0;u<o;++u)l[u]=(s-u)*a;else if(a<0)for(let u=0;u<o;++u)l[u]=(i+u)/-a;else for(let u=0;u<o;++u)l[u]=(i+u)*a;return l}function PZ(e,t,n){return t=+t,e=+e,n=+n,qL(e,t,n)[2]}function GL(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?PZ(t,e,n):PZ(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function aon(e,t,n=Cze){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function oon(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function lon(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function YL(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function k$(e){return e=YL(Math.abs(e)),e?e[1]:NaN}function uon(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function con(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var fon=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ob(e){if(!(t=fon.exec(e)))throw new Error("invalid format: "+e);var t;return new goe({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ob.prototype=goe.prototype;function goe(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}goe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function hon(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var _ze;function don(e,t){var n=YL(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(_ze=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+YL(e,Math.max(0,t+s-1))[0]}function Ybe(e,t){var n=YL(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Xbe={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:lon,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Ybe(e*100,t),r:Ybe,s:don,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Kbe(e){return e}var Zbe=Array.prototype.map,Qbe=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function pon(e){var t=e.grouping===void 0||e.thousands===void 0?Kbe:uon(Zbe.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?Kbe:con(Zbe.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=ob(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):Xbe[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var C=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=g==="$"?r:/[%p]/.test(w)?a:"",_=Xbe[w],k=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(S){var I=C,A=$,D,T,N;if(w==="c")A=_(S)+A,S="";else{S=+S;var F=S<0||1/S<0;if(S=isNaN(S)?l:_(Math.abs(S),b),x&&(S=hon(S)),F&&+S==0&&p!=="+"&&(F=!1),I=(F?p==="("?p:o:p==="-"||p==="("?"":p)+I,A=(w==="s"?Qbe[8+_ze/3]:"")+A+(F&&p==="("?")":""),k){for(D=-1,T=S.length;++D<T;)if(N=S.charCodeAt(D),48>N||N>57){A=(N===46?i+S.slice(D+1):S.slice(D))+A,S=S.slice(0,D);break}}}y&&!m&&(S=t(S,1/0));var R=I.length+S.length+A.length,P=R<v?new Array(v-R+1).join(h):"";switch(y&&m&&(S=t(P+S,P.length?v-A.length:1/0),P=""),d){case"<":S=I+S+A+P;break;case"=":S=I+P+S+A;break;case"^":S=P.slice(0,R=P.length>>1)+I+S+A+P.slice(R);break;default:S=P+I+S+A;break}return s(S)}return E.toString=function(){return f+""},E}function c(f,h){var d=u((f=ob(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(k$(h)/3)))*3,g=Math.pow(10,-p),m=Qbe[8+p/3];return function(v){return d(g*v)+m}}return{format:u,formatPrefix:c}}var oR,K9,moe;gon({thousands:",",grouping:[3],currency:["$",""]});function gon(e){return oR=pon(e),K9=oR.format,moe=oR.formatPrefix,oR}function Sze(e){return Math.max(0,-k$(Math.abs(e)))}function kze(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(k$(t)/3)))*3-k$(Math.abs(e)))}function Eze(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,k$(t)-k$(e))+1}const sq=new Date,aq=new Date;function Vi(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>Vi(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(sq.setTime(+s),aq.setTime(+a),e(sq),e(aq),Math.floor(n(sq,aq))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const E$=Vi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);E$.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Vi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):E$);E$.range;const ip=1e3,Cu=ip*60,sp=Cu*60,Hp=sp*24,voe=Hp*7,Jbe=Hp*30,oq=Hp*365,ap=Vi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ip)},(e,t)=>(t-e)/ip,e=>e.getUTCSeconds());ap.range;const Z9=Vi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ip)},(e,t)=>{e.setTime(+e+t*Cu)},(e,t)=>(t-e)/Cu,e=>e.getMinutes());Z9.range;const Q9=Vi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Cu)},(e,t)=>(t-e)/Cu,e=>e.getUTCMinutes());Q9.range;const J9=Vi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ip-e.getMinutes()*Cu)},(e,t)=>{e.setTime(+e+t*sp)},(e,t)=>(t-e)/sp,e=>e.getHours());J9.range;const eU=Vi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*sp)},(e,t)=>(t-e)/sp,e=>e.getUTCHours());eU.range;const x0=Vi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Cu)/Hp,e=>e.getDate()-1);x0.range;const ly=Vi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Hp,e=>e.getUTCDate()-1);ly.range;const Aze=Vi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Hp,e=>Math.floor(e/Hp));Aze.range;function gx(e){return Vi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Cu)/voe)}const $M=gx(0),XL=gx(1),mon=gx(2),von=gx(3),A$=gx(4),yon=gx(5),bon=gx(6);$M.range;XL.range;mon.range;von.range;A$.range;yon.range;bon.range;function mx(e){return Vi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/voe)}const CM=mx(0),KL=mx(1),xon=mx(2),won=mx(3),T$=mx(4),$on=mx(5),Con=mx(6);CM.range;KL.range;xon.range;won.range;T$.range;$on.range;Con.range;const _3=Vi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());_3.range;const S3=Vi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());S3.range;const Wh=Vi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Wh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Wh.range;const Vh=Vi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Vh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Vh.range;function Tze(e,t,n,r,i,s){const a=[[ap,1,ip],[ap,5,5*ip],[ap,15,15*ip],[ap,30,30*ip],[s,1,Cu],[s,5,5*Cu],[s,15,15*Cu],[s,30,30*Cu],[i,1,sp],[i,3,3*sp],[i,6,6*sp],[i,12,12*sp],[r,1,Hp],[r,2,2*Hp],[n,1,voe],[t,1,Jbe],[t,3,3*Jbe],[e,1,oq]];function o(u,c,f){const h=c<u;h&&([u,c]=[c,u]);const d=f&&typeof f.range=="function"?f:l(u,c,f),p=d?d.range(u,+c+1):[];return h?p.reverse():p}function l(u,c,f){const h=Math.abs(c-u)/f,d=poe(([,,m])=>m).right(a,h);if(d===a.length)return e.every(GL(u/oq,c/oq,f));if(d===0)return E$.every(Math.max(GL(u,c,f),1));const[p,g]=a[h/a[d-1][2]<a[d][2]/h?d-1:d];return p.every(g)}return[o,l]}const[_on,Son]=Tze(Vh,S3,CM,Aze,eU,Q9),[kon,Eon]=Tze(Wh,_3,$M,x0,J9,Z9),k3="year",E3="quarter",A3="month",T3="week",D3="date",tU="day",yoe="dayofyear",I3="hours",N3="minutes",M3="seconds",nU="milliseconds",Aon=[k3,E3,A3,T3,D3,tU,yoe,I3,N3,M3,nU];Aon.reduce((e,t,n)=>(e[t]=1+n,e),{});const Ton={[k3]:Wh,[E3]:_3.every(3),[A3]:_3,[T3]:$M,[D3]:x0,[tU]:x0,[yoe]:x0,[I3]:J9,[N3]:Z9,[M3]:ap,[nU]:E$},Don={[k3]:Vh,[E3]:S3.every(3),[A3]:S3,[T3]:CM,[D3]:ly,[tU]:ly,[yoe]:ly,[I3]:eU,[N3]:Q9,[M3]:ap,[nU]:E$};function Ion(e){return Ton[e]}function Non(e){return Don[e]}function lq(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function uq(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ck(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Mon(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=_k(i),c=Sk(i),f=_k(s),h=Sk(s),d=_k(a),p=Sk(a),g=_k(o),m=Sk(o),v=_k(l),y=Sk(l),b={a:F,A:R,b:P,B:V,c:null,d:sxe,e:sxe,f:nln,g:hln,G:pln,H:Jon,I:eln,j:tln,L:Dze,m:rln,M:iln,p:z,q,Q:lxe,s:uxe,S:sln,u:aln,U:oln,V:lln,w:uln,W:cln,x:null,X:null,y:fln,Y:dln,Z:gln,"%":oxe},x={a:G,A:K,b:Y,B:te,c:null,d:axe,e:axe,f:bln,g:Tln,G:Iln,H:mln,I:vln,j:yln,L:Nze,m:xln,M:wln,p:Z,q:ae,Q:lxe,s:uxe,S:$ln,u:Cln,U:_ln,V:Sln,w:kln,W:Eln,x:null,X:null,y:Aln,Y:Dln,Z:Nln,"%":oxe},w={a:E,A:S,b:I,B:A,c:D,d:rxe,e:rxe,f:Xon,g:nxe,G:txe,H:ixe,I:ixe,j:Hon,L:Yon,m:jon,M:qon,p:k,q:Von,Q:Zon,s:Qon,S:Gon,u:Lon,U:Bon,V:zon,w:Pon,W:Uon,x:T,X:N,y:nxe,Y:txe,Z:Won,"%":Kon};b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x);function C(O,L){return function(W){var M=[],ue=-1,X=0,se=O.length,oe,pe,Ce;for(W instanceof Date||(W=new Date(+W));++ue<se;)O.charCodeAt(ue)===37&&(M.push(O.slice(X,ue)),(pe=exe[oe=O.charAt(++ue)])!=null?oe=O.charAt(++ue):pe=oe==="e"?" ":"0",(Ce=L[oe])&&(oe=Ce(W,pe)),M.push(oe),X=ue+1);return M.push(O.slice(X,ue)),M.join("")}}function $(O,L){return function(W){var M=Ck(1900,void 0,1),ue=_(M,O,W+="",0),X,se;if(ue!=W.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(L&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(X=uq(Ck(M.y,0,1)),se=X.getUTCDay(),X=se>4||se===0?KL.ceil(X):KL(X),X=ly.offset(X,(M.V-1)*7),M.y=X.getUTCFullYear(),M.m=X.getUTCMonth(),M.d=X.getUTCDate()+(M.w+6)%7):(X=lq(Ck(M.y,0,1)),se=X.getDay(),X=se>4||se===0?XL.ceil(X):XL(X),X=x0.offset(X,(M.V-1)*7),M.y=X.getFullYear(),M.m=X.getMonth(),M.d=X.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),se="Z"in M?uq(Ck(M.y,0,1)).getUTCDay():lq(Ck(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(se+5)%7:M.w+M.U*7-(se+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,uq(M)):lq(M)}}function _(O,L,W,M){for(var ue=0,X=L.length,se=W.length,oe,pe;ue<X;){if(M>=se)return-1;if(oe=L.charCodeAt(ue++),oe===37){if(oe=L.charAt(ue++),pe=w[oe in exe?L.charAt(ue++):oe],!pe||(M=pe(O,W,M))<0)return-1}else if(oe!=W.charCodeAt(M++))return-1}return M}function k(O,L,W){var M=u.exec(L.slice(W));return M?(O.p=c.get(M[0].toLowerCase()),W+M[0].length):-1}function E(O,L,W){var M=d.exec(L.slice(W));return M?(O.w=p.get(M[0].toLowerCase()),W+M[0].length):-1}function S(O,L,W){var M=f.exec(L.slice(W));return M?(O.w=h.get(M[0].toLowerCase()),W+M[0].length):-1}function I(O,L,W){var M=v.exec(L.slice(W));return M?(O.m=y.get(M[0].toLowerCase()),W+M[0].length):-1}function A(O,L,W){var M=g.exec(L.slice(W));return M?(O.m=m.get(M[0].toLowerCase()),W+M[0].length):-1}function D(O,L,W){return _(O,t,L,W)}function T(O,L,W){return _(O,n,L,W)}function N(O,L,W){return _(O,r,L,W)}function F(O){return a[O.getDay()]}function R(O){return s[O.getDay()]}function P(O){return l[O.getMonth()]}function V(O){return o[O.getMonth()]}function z(O){return i[+(O.getHours()>=12)]}function q(O){return 1+~~(O.getMonth()/3)}function G(O){return a[O.getUTCDay()]}function K(O){return s[O.getUTCDay()]}function Y(O){return l[O.getUTCMonth()]}function te(O){return o[O.getUTCMonth()]}function Z(O){return i[+(O.getUTCHours()>=12)]}function ae(O){return 1+~~(O.getUTCMonth()/3)}return{format:function(O){var L=C(O+="",b);return L.toString=function(){return O},L},parse:function(O){var L=$(O+="",!1);return L.toString=function(){return O},L},utcFormat:function(O){var L=C(O+="",x);return L.toString=function(){return O},L},utcParse:function(O){var L=$(O+="",!0);return L.toString=function(){return O},L}}}var exe={"-":"",_:" ",0:"0"},Cs=/^\s*\d+/,Fon=/^%/,Oon=/[\\^$*+?|[\]().{}]/g;function _n(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function Ron(e){return e.replace(Oon,"\\$&")}function _k(e){return new RegExp("^(?:"+e.map(Ron).join("|")+")","i")}function Sk(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Pon(e,t,n){var r=Cs.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Lon(e,t,n){var r=Cs.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Bon(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function zon(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Uon(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function txe(e,t,n){var r=Cs.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function nxe(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Won(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Von(e,t,n){var r=Cs.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function jon(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function rxe(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Hon(e,t,n){var r=Cs.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function ixe(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function qon(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Gon(e,t,n){var r=Cs.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Yon(e,t,n){var r=Cs.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Xon(e,t,n){var r=Cs.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Kon(e,t,n){var r=Fon.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Zon(e,t,n){var r=Cs.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Qon(e,t,n){var r=Cs.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function sxe(e,t){return _n(e.getDate(),t,2)}function Jon(e,t){return _n(e.getHours(),t,2)}function eln(e,t){return _n(e.getHours()%12||12,t,2)}function tln(e,t){return _n(1+x0.count(Wh(e),e),t,3)}function Dze(e,t){return _n(e.getMilliseconds(),t,3)}function nln(e,t){return Dze(e,t)+"000"}function rln(e,t){return _n(e.getMonth()+1,t,2)}function iln(e,t){return _n(e.getMinutes(),t,2)}function sln(e,t){return _n(e.getSeconds(),t,2)}function aln(e){var t=e.getDay();return t===0?7:t}function oln(e,t){return _n($M.count(Wh(e)-1,e),t,2)}function Ize(e){var t=e.getDay();return t>=4||t===0?A$(e):A$.ceil(e)}function lln(e,t){return e=Ize(e),_n(A$.count(Wh(e),e)+(Wh(e).getDay()===4),t,2)}function uln(e){return e.getDay()}function cln(e,t){return _n(XL.count(Wh(e)-1,e),t,2)}function fln(e,t){return _n(e.getFullYear()%100,t,2)}function hln(e,t){return e=Ize(e),_n(e.getFullYear()%100,t,2)}function dln(e,t){return _n(e.getFullYear()%1e4,t,4)}function pln(e,t){var n=e.getDay();return e=n>=4||n===0?A$(e):A$.ceil(e),_n(e.getFullYear()%1e4,t,4)}function gln(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+_n(t/60|0,"0",2)+_n(t%60,"0",2)}function axe(e,t){return _n(e.getUTCDate(),t,2)}function mln(e,t){return _n(e.getUTCHours(),t,2)}function vln(e,t){return _n(e.getUTCHours()%12||12,t,2)}function yln(e,t){return _n(1+ly.count(Vh(e),e),t,3)}function Nze(e,t){return _n(e.getUTCMilliseconds(),t,3)}function bln(e,t){return Nze(e,t)+"000"}function xln(e,t){return _n(e.getUTCMonth()+1,t,2)}function wln(e,t){return _n(e.getUTCMinutes(),t,2)}function $ln(e,t){return _n(e.getUTCSeconds(),t,2)}function Cln(e){var t=e.getUTCDay();return t===0?7:t}function _ln(e,t){return _n(CM.count(Vh(e)-1,e),t,2)}function Mze(e){var t=e.getUTCDay();return t>=4||t===0?T$(e):T$.ceil(e)}function Sln(e,t){return e=Mze(e),_n(T$.count(Vh(e),e)+(Vh(e).getUTCDay()===4),t,2)}function kln(e){return e.getUTCDay()}function Eln(e,t){return _n(KL.count(Vh(e)-1,e),t,2)}function Aln(e,t){return _n(e.getUTCFullYear()%100,t,2)}function Tln(e,t){return e=Mze(e),_n(e.getUTCFullYear()%100,t,2)}function Dln(e,t){return _n(e.getUTCFullYear()%1e4,t,4)}function Iln(e,t){var n=e.getUTCDay();return e=n>=4||n===0?T$(e):T$.ceil(e),_n(e.getUTCFullYear()%1e4,t,4)}function Nln(){return"+0000"}function oxe(){return"%"}function lxe(e){return+e}function uxe(e){return Math.floor(+e/1e3)}var d2,boe,Fze,xoe,Oze;Mln({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Mln(e){return d2=Mon(e),boe=d2.format,Fze=d2.parse,xoe=d2.utcFormat,Oze=d2.utcParse,d2}function UE(e){const t={};return n=>t[n]||(t[n]=e(n))}function Fln(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=Oln(r,i);const a=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+a}}function Oln(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function Rln(e){const t=UE(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=ob(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return Fln(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,a){a=ob(a==null?",f":a);const o=GL(r,i,s),l=Math.max(Math.abs(r),Math.abs(i));let u;if(a.precision==null)switch(a.type){case"s":return isNaN(u=kze(o,l))||(a.precision=u),n(a,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=Eze(o,l))||(a.precision=u-(a.type==="e"));break}case"f":case"%":{isNaN(u=Sze(o))||(a.precision=u-(a.type==="%")*2);break}}return t(a)}}}Pln();function Pln(){return Rln({format:K9,formatPrefix:moe})}function cxe(e,t,n){n=n||{},zL(n)||hh(`Invalid time multi-format specifier: ${n}`);const r=t(M3),i=t(N3),s=t(I3),a=t(D3),o=t(T3),l=t(A3),u=t(E3),c=t(k3),f=e(n[nU]||".%L"),h=e(n[M3]||":%S"),d=e(n[N3]||"%I:%M"),p=e(n[I3]||"%I %p"),g=e(n[D3]||n[tU]||"%a %d"),m=e(n[T3]||"%b %d"),v=e(n[A3]||"%B"),y=e(n[E3]||"%B"),b=e(n[k3]||"%Y");return x=>(r(x)<x?f:i(x)<x?h:s(x)<x?d:a(x)<x?p:l(x)<x?o(x)<x?g:m:c(x)<x?u(x)<x?v:y:b)(x)}function Lln(e){const t=UE(e.format),n=UE(e.utcFormat);return{timeFormat:r=>UL(r)?t(r):cxe(t,Ion,r),utcFormat:r=>UL(r)?n(r):cxe(n,Non,r),timeParse:UE(e.parse),utcParse:UE(e.utcParse)}}Bln();function Bln(){return Lln({format:boe,parse:Fze,utcFormat:xoe,utcParse:Oze})}const zln=/^(data:|([A-Za-z]+:)?\/\/)/,Uln=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Wln=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,fxe="file://";function Vln(e,t){return n=>({options:n||{},sanitize:Hln,load:jln,fileAccess:!!t,file:qln(t),http:Yln(e)})}async function jln(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function Hln(e,t){t=G9({},this.options,t);const n=this.fileAccess,r={href:null};let i,s,a;const o=Uln.test(e.replace(Wln,""));(e==null||typeof e!="string"||!o)&&hh("Sanitize failure, invalid URI: "+ize(e));const l=zln.test(e);return(a=t.baseURL)&&!l&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),s=(i=e.startsWith(fxe))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice(fxe.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!s}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function qln(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,s)=>{i?r(i):n(s)})}):Gln}async function Gln(){hh("No file system access.")}function Yln(e){return e?async function(t,n){const r=G9({},this.options.http,n),i=n&&n.response,s=await e(t,r);return s.ok?q9(s[i])?s[i]():s.text():hh(s.status+""+s.statusText)}:Xln}async function Xln(){hh("No HTTP fetch method available.")}const Rze=Vln(typeof fetch<"u"&&fetch,null);function cd(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ev(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const hxe=Symbol("implicit");function woe(){var e=new qw,t=[],n=[],r=hxe;function i(s){let a=e.get(s);if(a===void 0){if(r!==hxe)return r;e.set(s,a=t.push(s)-1)}return n[a%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new qw;for(const a of s)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return woe(t,n).unknown(r)},cd.apply(i,arguments),i}function eS(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function _M(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function tv(){}var lb=.7,D$=1/lb,lw="\\s*([+-]?\\d+)\\s*",F3="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",dh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Kln=/^#([0-9a-f]{3,8})$/,Zln=new RegExp(`^rgb\\(${lw},${lw},${lw}\\)$`),Qln=new RegExp(`^rgb\\(${dh},${dh},${dh}\\)$`),Jln=new RegExp(`^rgba\\(${lw},${lw},${lw},${F3}\\)$`),eun=new RegExp(`^rgba\\(${dh},${dh},${dh},${F3}\\)$`),tun=new RegExp(`^hsl\\(${F3},${dh},${dh}\\)$`),nun=new RegExp(`^hsla\\(${F3},${dh},${dh},${F3}\\)$`),dxe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};eS(tv,O3,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:pxe,formatHex:pxe,formatHex8:run,formatHsl:iun,formatRgb:gxe,toString:gxe});function pxe(){return this.rgb().formatHex()}function run(){return this.rgb().formatHex8()}function iun(){return Pze(this).formatHsl()}function gxe(){return this.rgb().formatRgb()}function O3(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Kln.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?mxe(t):n===3?new is(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?lR(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?lR(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Zln.exec(e))?new is(t[1],t[2],t[3],1):(t=Qln.exec(e))?new is(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Jln.exec(e))?lR(t[1],t[2],t[3],t[4]):(t=eun.exec(e))?lR(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=tun.exec(e))?bxe(t[1],t[2]/100,t[3]/100,1):(t=nun.exec(e))?bxe(t[1],t[2]/100,t[3]/100,t[4]):dxe.hasOwnProperty(e)?mxe(dxe[e]):e==="transparent"?new is(NaN,NaN,NaN,0):null}function mxe(e){return new is(e>>16&255,e>>8&255,e&255,1)}function lR(e,t,n,r){return r<=0&&(e=t=n=NaN),new is(e,t,n,r)}function $oe(e){return e instanceof tv||(e=O3(e)),e?(e=e.rgb(),new is(e.r,e.g,e.b,e.opacity)):new is}function ZL(e,t,n,r){return arguments.length===1?$oe(e):new is(e,t,n,r==null?1:r)}function is(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}eS(is,ZL,_M(tv,{brighter(e){return e=e==null?D$:Math.pow(D$,e),new is(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?lb:Math.pow(lb,e),new is(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new is(uy(this.r),uy(this.g),uy(this.b),QL(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:vxe,formatHex:vxe,formatHex8:sun,formatRgb:yxe,toString:yxe}));function vxe(){return`#${L1(this.r)}${L1(this.g)}${L1(this.b)}`}function sun(){return`#${L1(this.r)}${L1(this.g)}${L1(this.b)}${L1((isNaN(this.opacity)?1:this.opacity)*255)}`}function yxe(){const e=QL(this.opacity);return`${e===1?"rgb(":"rgba("}${uy(this.r)}, ${uy(this.g)}, ${uy(this.b)}${e===1?")":`, ${e})`}`}function QL(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function uy(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function L1(e){return e=uy(e),(e<16?"0":"")+e.toString(16)}function bxe(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ec(e,t,n,r)}function Pze(e){if(e instanceof Ec)return new Ec(e.h,e.s,e.l,e.opacity);if(e instanceof tv||(e=O3(e)),!e)return new Ec;if(e instanceof Ec)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new Ec(a,o,l,e.opacity)}function LZ(e,t,n,r){return arguments.length===1?Pze(e):new Ec(e,t,n,r==null?1:r)}function Ec(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}eS(Ec,LZ,_M(tv,{brighter(e){return e=e==null?D$:Math.pow(D$,e),new Ec(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?lb:Math.pow(lb,e),new Ec(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new is(cq(e>=240?e-240:e+120,i,r),cq(e,i,r),cq(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Ec(xxe(this.h),uR(this.s),uR(this.l),QL(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=QL(this.opacity);return`${e===1?"hsl(":"hsla("}${xxe(this.h)}, ${uR(this.s)*100}%, ${uR(this.l)*100}%${e===1?")":`, ${e})`}`}}));function xxe(e){return e=(e||0)%360,e<0?e+360:e}function uR(e){return Math.max(0,Math.min(1,e||0))}function cq(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Lze=Math.PI/180,Bze=180/Math.PI,JL=18,zze=.96422,Uze=1,Wze=.82521,Vze=4/29,uw=6/29,jze=3*uw*uw,aun=uw*uw*uw;function Hze(e){if(e instanceof ph)return new ph(e.l,e.a,e.b,e.opacity);if(e instanceof op)return qze(e);e instanceof is||(e=$oe(e));var t=pq(e.r),n=pq(e.g),r=pq(e.b),i=fq((.2225045*t+.7168786*n+.0606169*r)/Uze),s,a;return t===n&&n===r?s=a=i:(s=fq((.4360747*t+.3850649*n+.1430804*r)/zze),a=fq((.0139322*t+.0971045*n+.7141733*r)/Wze)),new ph(116*i-16,500*(s-i),200*(i-a),e.opacity)}function BZ(e,t,n,r){return arguments.length===1?Hze(e):new ph(e,t,n,r==null?1:r)}function ph(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}eS(ph,BZ,_M(tv,{brighter(e){return new ph(this.l+JL*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new ph(this.l-JL*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=zze*hq(t),e=Uze*hq(e),n=Wze*hq(n),new is(dq(3.1338561*t-1.6168667*e-.4906146*n),dq(-.9787684*t+1.9161415*e+.033454*n),dq(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function fq(e){return e>aun?Math.pow(e,1/3):e/jze+Vze}function hq(e){return e>uw?e*e*e:jze*(e-Vze)}function dq(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function pq(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function oun(e){if(e instanceof op)return new op(e.h,e.c,e.l,e.opacity);if(e instanceof ph||(e=Hze(e)),e.a===0&&e.b===0)return new op(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Bze;return new op(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function zZ(e,t,n,r){return arguments.length===1?oun(e):new op(e,t,n,r==null?1:r)}function op(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function qze(e){if(isNaN(e.h))return new ph(e.l,0,0,e.opacity);var t=e.h*Lze;return new ph(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}eS(op,zZ,_M(tv,{brighter(e){return new op(this.h,this.c,this.l+JL*(e==null?1:e),this.opacity)},darker(e){return new op(this.h,this.c,this.l-JL*(e==null?1:e),this.opacity)},rgb(){return qze(this).rgb()}}));var Gze=-.14861,Coe=1.78277,_oe=-.29227,rU=-.90649,R3=1.97294,wxe=R3*rU,$xe=R3*Coe,Cxe=Coe*_oe-rU*Gze;function lun(e){if(e instanceof cy)return new cy(e.h,e.s,e.l,e.opacity);e instanceof is||(e=$oe(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Cxe*r+wxe*t-$xe*n)/(Cxe+wxe-$xe),s=r-i,a=(R3*(n-i)-_oe*s)/rU,o=Math.sqrt(a*a+s*s)/(R3*i*(1-i)),l=o?Math.atan2(a,s)*Bze-120:NaN;return new cy(l<0?l+360:l,o,i,e.opacity)}function UZ(e,t,n,r){return arguments.length===1?lun(e):new cy(e,t,n,r==null?1:r)}function cy(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}eS(cy,UZ,_M(tv,{brighter(e){return e=e==null?D$:Math.pow(D$,e),new cy(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?lb:Math.pow(lb,e),new cy(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*Lze,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new is(255*(t+n*(Gze*r+Coe*i)),255*(t+n*(_oe*r+rU*i)),255*(t+n*(R3*r)),this.opacity)}}));function Yze(e,t,n,r,i){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*n+(1+3*e+3*s-3*a)*r+a*i)/6}function Xze(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],a=r>0?e[r-1]:2*i-s,o=r<t-1?e[r+2]:2*s-i;return Yze((n-r/t)*t,a,i,s,o)}}function Kze(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],a=e[(r+1)%t],o=e[(r+2)%t];return Yze((n-r/t)*t,i,s,a,o)}}const iU=e=>()=>e;function Zze(e,t){return function(n){return e+n*t}}function uun(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function sU(e,t){var n=t-e;return n?Zze(e,n>180||n<-180?n-360*Math.round(n/360):n):iU(isNaN(e)?t:e)}function cun(e){return(e=+e)==1?ss:function(t,n){return n-t?uun(t,n,e):iU(isNaN(t)?n:t)}}function ss(e,t){var n=t-e;return n?Zze(e,n):iU(isNaN(e)?t:e)}const WZ=function e(t){var n=cun(t);function r(i,s){var a=n((i=ZL(i)).r,(s=ZL(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=ss(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function Qze(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),a,o;for(a=0;a<n;++a)o=ZL(t[a]),r[a]=o.r||0,i[a]=o.g||0,s[a]=o.b||0;return r=e(r),i=e(i),s=e(s),o.opacity=1,function(l){return o.r=r(l),o.g=i(l),o.b=s(l),o+""}}}var fun=Qze(Xze),hun=Qze(Kze);function Soe(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function Jze(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function dun(e,t){return(Jze(t)?Soe:e7e)(e,t)}function e7e(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=vx(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function t7e(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function xc(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function n7e(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=vx(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var VZ=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gq=new RegExp(VZ.source,"g");function pun(e){return function(){return e}}function gun(e){return function(t){return e(t)+""}}function r7e(e,t){var n=VZ.lastIndex=gq.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=VZ.exec(e))&&(i=gq.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:xc(r,i)})),n=gq.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?gun(l[0].x):pun(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)o[(f=l[c]).i]=f.x(u);return o.join("")})}function vx(e,t){var n=typeof t,r;return t==null||n==="boolean"?iU(t):(n==="number"?xc:n==="string"?(r=O3(t))?(t=r,WZ):r7e:t instanceof O3?WZ:t instanceof Date?t7e:Jze(t)?Soe:Array.isArray(t)?e7e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?n7e:xc)(e,t)}function mun(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function vun(e,t){var n=sU(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function aU(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var _xe=180/Math.PI,jZ={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function i7e(e,t,n,r,i,s){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*_xe,skewX:Math.atan(l)*_xe,scaleX:a,scaleY:o}}var cR;function yun(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?jZ:i7e(t.a,t.b,t.c,t.d,t.e,t.f)}function bun(e){return e==null||(cR||(cR=document.createElementNS("http://www.w3.org/2000/svg","g")),cR.setAttribute("transform",e),!(e=cR.transform.baseVal.consolidate()))?jZ:(e=e.matrix,i7e(e.a,e.b,e.c,e.d,e.e,e.f))}function s7e(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push("translate(",null,t,null,n);p.push({i:g-4,x:xc(u,f)},{i:g-2,x:xc(c,h)})}else(f||h)&&d.push("translate("+f+t+h+n)}function a(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:xc(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function o(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:xc(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push(i(d)+"scale(",null,",",null,")");p.push({i:g-4,x:xc(u,f)},{i:g-2,x:xc(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=e(u),c=e(c),s(u.translateX,u.translateY,c.translateX,c.translateY,f,h),a(u.rotate,c.rotate,f,h),o(u.skewX,c.skewX,f,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,g=h.length,m;++p<g;)f[(m=h[p]).i]=m.x(d);return f.join("")}}}var xun=s7e(yun,"px, ","px)","deg)"),wun=s7e(bun,", ",")",")"),$un=1e-12;function Sxe(e){return((e=Math.exp(e))+1/e)/2}function Cun(e){return((e=Math.exp(e))-1/e)/2}function _un(e){return((e=Math.exp(2*e))-1)/(e+1)}const Sun=function e(t,n,r){function i(s,a){var o=s[0],l=s[1],u=s[2],c=a[0],f=a[1],h=a[2],d=c-o,p=f-l,g=d*d+p*p,m,v;if(g<$un)v=Math.log(h/u)/t,m=function($){return[o+$*d,l+$*p,u*Math.exp(t*$*v)]};else{var y=Math.sqrt(g),b=(h*h-u*u+r*g)/(2*u*n*y),x=(h*h-u*u-r*g)/(2*h*n*y),w=Math.log(Math.sqrt(b*b+1)-b),C=Math.log(Math.sqrt(x*x+1)-x);v=(C-w)/t,m=function($){var _=$*v,k=Sxe(w),E=u/(n*y)*(k*_un(t*_+w)-Cun(w));return[o+E*d,l+E*p,u*k/Sxe(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(s){var a=Math.max(.001,+s),o=a*a,l=o*o;return e(a,o,l)},i}(Math.SQRT2,2,4);function a7e(e){return function(t,n){var r=e((t=LZ(t)).h,(n=LZ(n)).h),i=ss(t.s,n.s),s=ss(t.l,n.l),a=ss(t.opacity,n.opacity);return function(o){return t.h=r(o),t.s=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const kun=a7e(sU);var Eun=a7e(ss);function Aun(e,t){var n=ss((e=BZ(e)).l,(t=BZ(t)).l),r=ss(e.a,t.a),i=ss(e.b,t.b),s=ss(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=s(a),e+""}}function o7e(e){return function(t,n){var r=e((t=zZ(t)).h,(n=zZ(n)).h),i=ss(t.c,n.c),s=ss(t.l,n.l),a=ss(t.opacity,n.opacity);return function(o){return t.h=r(o),t.c=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const Tun=o7e(sU);var Dun=o7e(ss);function l7e(e){return function t(n){n=+n;function r(i,s){var a=e((i=UZ(i)).h,(s=UZ(s)).h),o=ss(i.s,s.s),l=ss(i.l,s.l),u=ss(i.opacity,s.opacity);return function(c){return i.h=a(c),i.s=o(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}const Iun=l7e(sU);var Nun=l7e(ss);function koe(e,t){t===void 0&&(t=e,e=vx);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function Mun(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const Fun=Object.freeze(Object.defineProperty({__proto__:null,interpolate:vx,interpolateArray:dun,interpolateBasis:Xze,interpolateBasisClosed:Kze,interpolateDate:t7e,interpolateDiscrete:mun,interpolateHue:vun,interpolateNumber:xc,interpolateNumberArray:Soe,interpolateObject:n7e,interpolateRound:aU,interpolateString:r7e,interpolateTransformCss:xun,interpolateTransformSvg:wun,interpolateZoom:Sun,interpolateRgb:WZ,interpolateRgbBasis:fun,interpolateRgbBasisClosed:hun,interpolateHsl:kun,interpolateHslLong:Eun,interpolateLab:Aun,interpolateHcl:Tun,interpolateHclLong:Dun,interpolateCubehelix:Iun,interpolateCubehelixLong:Nun,piecewise:koe,quantize:Mun},Symbol.toStringTag,{value:"Module"}));function Oun(e){return function(){return e}}function HZ(e){return+e}var kxe=[0,1];function Xo(e){return e}function qZ(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Oun(isNaN(t)?NaN:.5)}function Run(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Pun(e,t,n){var r=e[0],i=e[1],s=t[0],a=t[1];return i<r?(r=qZ(i,r),s=n(a,s)):(r=qZ(r,i),s=n(s,a)),function(o){return s(r(o))}}function Lun(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=qZ(e[a],e[a+1]),s[a]=n(t[a],t[a+1]);return function(o){var l=wM(e,o,1,r)-1;return s[l](i[l](o))}}function SM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function oU(){var e=kxe,t=kxe,n=vx,r,i,s,a=Xo,o,l,u;function c(){var h=Math.min(e.length,t.length);return a!==Xo&&(a=Run(e[0],e[h-1])),o=h>2?Lun:Pun,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?s:(l||(l=o(e.map(r),t,n)))(r(a(h)))}return f.invert=function(h){return a(i((u||(u=o(t,e.map(r),xc)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,HZ),c()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),n=aU,c()},f.clamp=function(h){return arguments.length?(a=h?!0:Xo,c()):a!==Xo},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,d){return r=h,i=d,c()}}function u7e(){return oU()(Xo,Xo)}function c7e(e,t,n,r){var i=GL(e,t,n),s;switch(r=ob(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=kze(i,a))&&(r.precision=s),moe(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=Eze(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=Sze(i))&&(r.precision=s-(r.type==="%")*2);break}}return K9(r)}function yx(e){var t=e.domain;return e.ticks=function(n){var r=t();return RZ(r[0],r[r.length-1],n==null?10:n)},e.tickFormat=function(n,r){var i=t();return c7e(i[0],i[i.length-1],n==null?10:n,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,a=r[i],o=r[s],l,u,c=10;for(o<a&&(u=a,a=o,o=u,u=i,i=s,s=u);c-- >0;){if(u=PZ(a,o,n),u===l)return r[i]=a,r[s]=o,t(r);if(u>0)a=Math.floor(a/u)*u,o=Math.ceil(o/u)*u;else if(u<0)a=Math.ceil(a*u)/u,o=Math.floor(o*u)/u;else break;l=u}return e},e}function f7e(){var e=u7e();return e.copy=function(){return SM(e,f7e())},cd.apply(e,arguments),yx(e)}function h7e(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,HZ),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return h7e(e).unknown(t)},e=arguments.length?Array.from(e,HZ):[0,1],yx(n)}function d7e(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),e[n]=t.floor(i),e[r]=t.ceil(s),e}function Exe(e){return Math.log(e)}function Axe(e){return Math.exp(e)}function Bun(e){return-Math.log(-e)}function zun(e){return-Math.exp(-e)}function Uun(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Wun(e){return e===10?Uun:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Vun(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Txe(e){return(t,n)=>-e(-t,n)}function Eoe(e){const t=e(Exe,Axe),n=t.domain;let r=10,i,s;function a(){return i=Vun(r),s=Wun(r),n()[0]<0?(i=Txe(i),s=Txe(s),e(Bun,zun)):e(Exe,Axe),t}return t.base=function(o){return arguments.length?(r=+o,a()):r},t.domain=function(o){return arguments.length?(n(o),a()):n()},t.ticks=o=>{const l=n();let u=l[0],c=l[l.length-1];const f=c<u;f&&([u,c]=[c,u]);let h=i(u),d=i(c),p,g;const m=o==null?10:+o;let v=[];if(!(r%1)&&d-h<m){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(p=1;p<r;++p)if(g=h<0?p/s(-h):p*s(h),!(g<u)){if(g>c)break;v.push(g)}}else for(;h<=d;++h)for(p=r-1;p>=1;--p)if(g=h>0?p/s(-h):p*s(h),!(g<u)){if(g>c)break;v.push(g)}v.length*2<m&&(v=RZ(u,c,m))}else v=RZ(h,d,Math.min(d-h,m)).map(s);return f?v.reverse():v},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=ob(l)).precision==null&&(l.trim=!0),l=K9(l)),o===1/0)return l;const u=Math.max(1,r*o/t.ticks().length);return c=>{let f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=()=>n(d7e(n(),{floor:o=>s(Math.floor(i(o))),ceil:o=>s(Math.ceil(i(o)))})),t}function p7e(){const e=Eoe(oU()).domain([1,10]);return e.copy=()=>SM(e,p7e()).base(e.base()),cd.apply(e,arguments),e}function Dxe(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Ixe(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Aoe(e){var t=1,n=e(Dxe(t),Ixe(t));return n.constant=function(r){return arguments.length?e(Dxe(t=+r),Ixe(t)):t},yx(n)}function g7e(){var e=Aoe(oU());return e.copy=function(){return SM(e,g7e()).constant(e.constant())},cd.apply(e,arguments)}function Nxe(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function jun(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Hun(e){return e<0?-e*e:e*e}function Toe(e){var t=e(Xo,Xo),n=1;function r(){return n===1?e(Xo,Xo):n===.5?e(jun,Hun):e(Nxe(n),Nxe(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},yx(t)}function Doe(){var e=Toe(oU());return e.copy=function(){return SM(e,Doe()).exponent(e.exponent())},cd.apply(e,arguments),e}function qun(){return Doe.apply(null,arguments).exponent(.5)}function m7e(){var e=[],t=[],n=[],r;function i(){var a=0,o=Math.max(1,t.length);for(n=new Array(o-1);++a<o;)n[a-1]=aon(e,a/o);return s}function s(a){return a==null||isNaN(a=+a)?r:t[wM(n,a)]}return s.invertExtent=function(a){var o=t.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},s.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let o of a)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort($A),i()},s.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return m7e().domain(e).range(t).unknown(r)},cd.apply(s,arguments)}function v7e(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function a(l){return l!=null&&l<=l?i[wM(r,l,0,n)]:s}function o(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return a}return a.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},a.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,o()):i.slice()},a.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},a.unknown=function(l){return arguments.length&&(s=l),a},a.thresholds=function(){return r.slice()},a.copy=function(){return v7e().domain([e,t]).range(i).unknown(s)},cd.apply(yx(a),arguments)}function y7e(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[wM(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var a=t.indexOf(s);return[e[a-1],e[a]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return y7e().domain(e).range(t).unknown(n)},cd.apply(i,arguments)}function Gun(e){return new Date(e)}function Yun(e){return e instanceof Date?+e:+new Date(+e)}function Ioe(e,t,n,r,i,s,a,o,l,u){var c=u7e(),f=c.invert,h=c.domain,d=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),x=u("%Y");function w(C){return(l(C)<C?d:o(C)<C?p:a(C)<C?g:s(C)<C?m:r(C)<C?i(C)<C?v:y:n(C)<C?b:x)(C)}return c.invert=function(C){return new Date(f(C))},c.domain=function(C){return arguments.length?h(Array.from(C,Yun)):h().map(Gun)},c.ticks=function(C){var $=h();return e($[0],$[$.length-1],C==null?10:C)},c.tickFormat=function(C,$){return $==null?w:u($)},c.nice=function(C){var $=h();return(!C||typeof C.range!="function")&&(C=t($[0],$[$.length-1],C==null?10:C)),C?h(d7e($,C)):c},c.copy=function(){return SM(c,Ioe(e,t,n,r,i,s,a,o,l,u))},c}function Xun(){return cd.apply(Ioe(kon,Eon,Wh,_3,$M,x0,J9,Z9,ap,boe).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Kun(){return cd.apply(Ioe(_on,Son,Vh,S3,CM,ly,eU,Q9,ap,xoe).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function lU(){var e=0,t=1,n,r,i,s,a=Xo,o=!1,l;function u(f){return f==null||isNaN(f=+f)?l:a(i===0?.5:(f=(s(f)-n)*i,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(a=f,u):a};function c(f){return function(h){var d,p;return arguments.length?([d,p]=h,a=f(d,p),u):[a(0),a(1)]}}return u.range=c(vx),u.rangeRound=c(aU),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function nv(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Noe(){var e=yx(lU()(Xo));return e.copy=function(){return nv(e,Noe())},ev.apply(e,arguments)}function b7e(){var e=Eoe(lU()).domain([1,10]);return e.copy=function(){return nv(e,b7e()).base(e.base())},ev.apply(e,arguments)}function x7e(){var e=Aoe(lU());return e.copy=function(){return nv(e,x7e()).constant(e.constant())},ev.apply(e,arguments)}function Moe(){var e=Toe(lU());return e.copy=function(){return nv(e,Moe()).exponent(e.exponent())},ev.apply(e,arguments)}function Zun(){return Moe.apply(null,arguments).exponent(.5)}function uU(){var e=0,t=.5,n=1,r=1,i,s,a,o,l,u=Xo,c,f=!1,h;function d(g){return isNaN(g=+g)?h:(g=.5+((g=+c(g))-s)*(r*g<r*s?o:l),u(f?Math.max(0,Math.min(1,g)):g))}d.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),s=c(t=+t),a=c(n=+n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d):[e,t,n]},d.clamp=function(g){return arguments.length?(f=!!g,d):f},d.interpolator=function(g){return arguments.length?(u=g,d):u};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,u=koe(g,[v,y,b]),d):[u(0),u(.5),u(1)]}}return d.range=p(vx),d.rangeRound=p(aU),d.unknown=function(g){return arguments.length?(h=g,d):h},function(g){return c=g,i=g(e),s=g(t),a=g(n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d}}function w7e(){var e=yx(uU()(Xo));return e.copy=function(){return nv(e,w7e())},ev.apply(e,arguments)}function $7e(){var e=Eoe(uU()).domain([.1,1,10]);return e.copy=function(){return nv(e,$7e()).base(e.base())},ev.apply(e,arguments)}function C7e(){var e=Aoe(uU());return e.copy=function(){return nv(e,C7e()).constant(e.constant())},ev.apply(e,arguments)}function Foe(){var e=Toe(uU());return e.copy=function(){return nv(e,Foe()).exponent(e.exponent())},ev.apply(e,arguments)}function Qun(){return Foe.apply(null,arguments).exponent(.5)}function Jun(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const ecn="identity",Ooe="linear",um="log",Roe="pow",Poe="sqrt",Loe="symlog",P3="time",L3="utc",tS="sequential",kM="diverging",e6="quantile",Boe="quantize",_7e="threshold",tcn="ordinal",ncn="point",rcn="band",icn="bin-ordinal",_s="continuous",EM="discrete",AM="discretizing",df="interpolating",zoe="temporal";function scn(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function acn(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,a,o,l,u;for(i<r&&(o=r,r=i,i=o),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(s<0&&(s=l),a=l);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[a]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function Uoe(){const e=woe().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,a=!1,o=0,l=0,u=.5;delete e.unknown;function c(){const f=t().length,h=r[1]<r[0],d=r[1-h],p=Jun(f,o,l);let g=r[h-0];i=(d-g)/(p||1),a&&(i=Math.floor(i)),g+=(d-g-i*(f-o))*u,s=i*(1-o),a&&(g=Math.round(g),s=Math.round(s));const m=oon(f).map(v=>g+i*v);return n(h?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),o=l,c()):o},e.paddingInner=function(f){return arguments.length?(o=Math.max(0,Math.min(1,f)),c()):o},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const h=r[1]<r[0],d=h?n().reverse():n(),p=d.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<d[0]||g>r[1-h])))return v=Math.max(0,OZ(d,g)-1),y=g===m?v:OZ(d,m)-1,g-d[v]>s+1e-10&&++v,h&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const h=e.invertRange([f,f]);return h&&h[0]},e.copy=function(){return Uoe().domain(t()).range(r).round(a).paddingInner(o).paddingOuter(l).align(u)},c()}function S7e(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return S7e(t())},e}function ocn(){return S7e(Uoe().paddingInner(1))}var lcn=Array.prototype.map;function ucn(e){return lcn.call(e,wan)}const ccn=Array.prototype.slice;function k7e(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(wM(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=ucn(r),n):e.slice()},n.range=function(r){return arguments.length?(t=ccn.call(r),n):t.slice()},n.tickFormat=function(r,i){return c7e(e[0],ab(e),r==null?10:r,i)},n.copy=function(){return k7e().domain(n.domain()).range(n.range())},n}const t6=new Map,fcn=Symbol("vega_scale");function hcn(e){return e[fcn]=!0,e}function dcn(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?scn(s):s.invertExtent?acn(s):void 0),s.type=e,hcn(s)};return r.metadata=sze(loe(n)),r}function dr(e,t,n){return arguments.length>1?(t6.set(e,dcn(e,t,n)),this):pcn(e)?t6.get(e):void 0}dr(ecn,h7e);dr(Ooe,f7e,_s);dr(um,p7e,[_s,um]);dr(Roe,Doe,_s);dr(Poe,qun,_s);dr(Loe,g7e,_s);dr(P3,Xun,[_s,zoe]);dr(L3,Kun,[_s,zoe]);dr(tS,Noe,[_s,df]);dr(`${tS}-${Ooe}`,Noe,[_s,df]);dr(`${tS}-${um}`,b7e,[_s,df,um]);dr(`${tS}-${Roe}`,Moe,[_s,df]);dr(`${tS}-${Poe}`,Zun,[_s,df]);dr(`${tS}-${Loe}`,x7e,[_s,df]);dr(`${kM}-${Ooe}`,w7e,[_s,df]);dr(`${kM}-${um}`,$7e,[_s,df,um]);dr(`${kM}-${Roe}`,Foe,[_s,df]);dr(`${kM}-${Poe}`,Qun,[_s,df]);dr(`${kM}-${Loe}`,C7e,[_s,df]);dr(e6,m7e,[AM,e6]);dr(Boe,v7e,AM);dr(_7e,y7e,AM);dr(icn,k7e,[EM,AM]);dr(tcn,woe,EM);dr(rcn,Uoe,EM);dr(ncn,ocn,EM);function pcn(e){return t6.has(e)}function cU(e,t){const n=t6.get(e);return n&&n.metadata[t]}function E7e(e){return cU(e,EM)}function gcn(e){return cU(e,AM)}function mcn(e){return cU(e,um)}function vcn(e){return cU(e,zoe)}function ycn(e,t,n){return koe(bcn(t||"rgb",n),e)}function bcn(e,t){const n=Fun[xcn(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function xcn(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const wcn={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},$cn={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function A7e(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function T7e(e,t){for(const n in e)Ccn(n,t(e[n]))}const Mxe={};T7e($cn,A7e);T7e(wcn,e=>ycn(A7e(e)));function Ccn(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(Mxe[e]=t,this):Mxe[e]}const _cn="symbol",Scn="discrete",kcn=e=>ud(e)?e.map(t=>String(t)):String(e),Ecn=(e,t)=>e[1]-t[1],Acn=(e,t)=>t[1]-e[1];function Tcn(e,t,n){let r=e.range(),i=r[0],s=ab(r),a=Ecn;if(i>s&&(r=s,s=i,i=r,a=Acn),i=Math.floor(i),s=Math.ceil(s),t=t.map(o=>[o,e(o)]).filter(o=>i<=o[1]&&o[1]<=s).sort(a).map(o=>o[0]),n>0&&t.length>1){const o=[t[0],ab(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=o)}return t}function D7e(e,t){return e.bins?Tcn(e,e.bins):e.ticks?e.ticks(t):e.domain()}function Dcn(e,t,n,r,i,s){const a=t.type;let o=kcn;if(a===P3||i===P3)o=e.timeFormat(r);else if(a===L3||i===L3)o=e.utcFormat(r);else if(mcn(a)){const l=e.formatFloat(r);if(s||t.bins)o=l;else{const u=I7e(t,n,!1);o=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();o=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(o=e.format(r));return o}function I7e(e,t,n){const r=D7e(e,t),i=e.base(),s=Math.log(i),a=Math.max(1,i*t/r.length),o=l=>{let u=l/Math.pow(i,Math.round(Math.log(l)/s));return u*i<i-.5&&(u*=i),u<=a};return n?r.filter(o):o}const GZ={[e6]:"quantiles",[Boe]:"thresholds",[_7e]:"domain"},N7e={[e6]:"quantiles",[Boe]:"domain"};function Icn(e,t){return e.bins?Fcn(e.bins):e.type===um?I7e(e,t,!0):GZ[e.type]?Mcn(e[GZ[e.type]]()):D7e(e,t)}function Ncn(e,t,n){const r=t[N7e[t.type]](),i=r.length;let s=i>1?r[1]-r[0]:r[0],a;for(a=1;a<i;++a)s=Math.min(s,r[a]-r[a-1]);return e.formatSpan(0,s,3*10,n)}function Mcn(e){const t=[-1/0].concat(e);return t.max=1/0,t}function Fcn(e){const t=e.slice(0,-1);return t.max=ab(e),t}const Ocn=e=>GZ[e.type]||e.bins;function Rcn(e,t,n,r,i,s,a){const o=N7e[t.type]&&s!==P3&&s!==L3?Ncn(e,t,i):Dcn(e,t,n,i,s,a);return r===_cn&&Ocn(t)?Pcn(o):r===Scn?Lcn(o):Bcn(o)}const Pcn=e=>(t,n,r)=>{const i=Fxe(r[n+1],Fxe(r.max,1/0)),s=Oxe(t,e),a=Oxe(i,e);return s&&a?s+" \u2013 "+a:a?"< "+a:"\u2265 "+s},Fxe=(e,t)=>e!=null?e:t,Lcn=e=>(t,n)=>n?e(t):null,Bcn=e=>t=>e(t),Oxe=(e,t)=>Number.isFinite(e)?t(e):null;function zcn(e,t,n,r){const i=r||t.type;return UL(n)&&vcn(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===P3?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===L3?e.utcFormat("%A, %d %B %Y, %X UTC"):Rcn(e,t,5,null,n,r,!0)}function M7e(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=zcn(e,t,n.format,n.formatType);if(gcn(t.type)){const s=Icn(t).slice(1).map(i),a=s.length;return`${a} boundar${a===1?"y":"ies"}: ${s.join(", ")}`}else if(E7e(t.type)){const s=t.domain(),a=s.length,o=a>r?s.slice(0,r-2).map(i).join(", ")+", ending with "+s.slice(-1).map(i):s.map(i).join(", ");return`${a} value${a===1?"":"s"}: ${o}`}else{const s=t.domain();return`values from ${i(s[0])} to ${i(ab(s))}`}}let F7e=0;function Ucn(){F7e=0}const n6="p_";function Woe(e){return e&&e.gradient}function O7e(e,t,n){const r=e.gradient;let i=e.id,s=r==="radial"?n6:"";return i||(i=e.id="gradient_"+F7e++,r==="radial"?(e.x1=Af(e.x1,.5),e.y1=Af(e.y1,.5),e.r1=Af(e.r1,0),e.x2=Af(e.x2,.5),e.y2=Af(e.y2,.5),e.r2=Af(e.r2,.5),s=n6):(e.x1=Af(e.x1,0),e.y1=Af(e.y1,0),e.x2=Af(e.x2,1),e.y2=Af(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+s+i+")"}function Af(e,t){return e!=null?e:t}function Wcn(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,s){return n.push({offset:i,color:s}),r}}}const Rxe={basis:{curve:Pan},"basis-closed":{curve:Lan},"basis-open":{curve:Ban},bundle:{curve:zan,tension:"beta",value:.85},cardinal:{curve:Uan,tension:"tension",value:0},"cardinal-open":{curve:Van,tension:"tension",value:0},"cardinal-closed":{curve:Wan,tension:"tension",value:0},"catmull-rom":{curve:jan,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Han,tension:"alpha",value:.5},"catmull-rom-open":{curve:qan,tension:"alpha",value:.5},linear:{curve:uoe},"linear-closed":{curve:Gan},monotone:{horizontal:Xan,vertical:Yan},natural:{curve:Kan},step:{curve:Zan},"step-after":{curve:Jan},"step-before":{curve:Qan}};function Voe(e,t,n){var r=Kd(Rxe,e)&&Rxe[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const Vcn={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},kk=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function B3(e){const t=[];let n,r,i,s,a,o,l,u,c,f;const h=e.slice().replace(kk[0],"###$1").split(kk[1]).slice(1);for(l=0,c=h.length;l<c;++l){for(n=h[l],r=n.slice(1).trim().replace(kk[2],"$1###$2").replace(kk[3],"$1###$2").split(kk[4]),a=n.charAt(0),i=[a],u=0,f=r.length;u<f;++u)(s=+r[u])===s&&i.push(s);if(o=Vcn[a.toLowerCase()],i.length-1>o){const d=i.length;for(u=1,t.push([a].concat(i.slice(u,u+=o))),a=a==="M"?"L":a==="m"?"l":a;u<d;u+=o)t.push([a].concat(i.slice(u,u+o)))}else t.push(i)}return t}const cm=Math.PI/180,jcn=1e-14,g1=Math.PI/2,Hf=Math.PI*2,p2=Math.sqrt(3)/2;var mq={},vq={},R7e=[].join;function Hcn(e,t,n,r,i,s,a,o,l){const u=R7e.call(arguments);if(mq[u])return mq[u];const c=a*cm,f=Math.sin(c),h=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const d=h*(o-e)*.5+f*(l-t)*.5,p=h*(l-t)*.5-f*(o-e)*.5;let g=d*d/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=h/n,v=f/n,y=-f/r,b=h/r,x=m*o+v*l,w=y*o+b*l,C=m*e+v*t,$=y*e+b*t;let k=1/((C-x)*(C-x)+($-w)*($-w))-.25;k<0&&(k=0);let E=Math.sqrt(k);s==i&&(E=-E);const S=.5*(x+C)-E*($-w),I=.5*(w+$)+E*(C-x),A=Math.atan2(w-I,x-S);let T=Math.atan2($-I,C-S)-A;T<0&&s===1?T+=Hf:T>0&&s===0&&(T-=Hf);const N=Math.ceil(Math.abs(T/(g1+.001))),F=[];for(let R=0;R<N;++R){const P=A+R*T/N,V=A+(R+1)*T/N;F[R]=[S,I,P,V,n,r,f,h]}return mq[u]=F}function qcn(e){const t=R7e.call(e);if(vq[t])return vq[t];var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7];const c=u*a,f=-l*o,h=l*a,d=u*o,p=Math.cos(i),g=Math.sin(i),m=Math.cos(s),v=Math.sin(s),y=.5*(s-i),b=Math.sin(y*.5),x=8/3*b*b/Math.sin(y),w=n+p-x*g,C=r+g+x*p,$=n+m,_=r+v,k=$+x*v,E=_-x*m;return vq[t]=[c*w+f*C,h*w+d*C,c*k+f*E,h*k+d*E,c*$+f*_,h*$+d*_]}const su=["l",0,0,0,0,0,0,0];function Gcn(e,t,n){const r=su[0]=e[0];if(r==="a"||r==="A")su[1]=t*e[1],su[2]=n*e[2],su[3]=e[3],su[4]=e[4],su[5]=e[5],su[6]=t*e[6],su[7]=n*e[7];else if(r==="h"||r==="H")su[1]=t*e[1];else if(r==="v"||r==="V")su[1]=n*e[1];else for(var i=1,s=e.length;i<s;++i)su[i]=(i%2==1?t:n)*e[i];return su}function r6(e,t,n,r,i,s){var a,o=null,l=0,u=0,c=0,f=0,h,d,p,g;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),s==null&&(s=i),e.beginPath&&e.beginPath();for(var m=0,v=t.length;m<v;++m){switch(a=t[m],(i!==1||s!==1)&&(a=Gcn(a,i,s)),a[0]){case"l":l+=a[1],u+=a[2],e.lineTo(l+n,u+r);break;case"L":l=a[1],u=a[2],e.lineTo(l+n,u+r);break;case"h":l+=a[1],e.lineTo(l+n,u+r);break;case"H":l=a[1],e.lineTo(l+n,u+r);break;case"v":u+=a[1],e.lineTo(l+n,u+r);break;case"V":u=a[1],e.lineTo(l+n,u+r);break;case"m":l+=a[1],u+=a[2],e.moveTo(l+n,u+r);break;case"M":l=a[1],u=a[2],e.moveTo(l+n,u+r);break;case"c":h=l+a[5],d=u+a[6],c=l+a[3],f=u+a[4],e.bezierCurveTo(l+a[1]+n,u+a[2]+r,c+n,f+r,h+n,d+r),l=h,u=d;break;case"C":l=a[5],u=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,c+n,f+r,l+n,u+r);break;case"s":h=l+a[3],d=u+a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,l+a[1]+n,u+a[2]+r,h+n,d+r),c=l+a[1],f=u+a[2],l=h,u=d;break;case"S":h=a[3],d=a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,a[1]+n,a[2]+r,h+n,d+r),l=h,u=d,c=a[1],f=a[2];break;case"q":h=l+a[3],d=u+a[4],c=l+a[1],f=u+a[2],e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d;break;case"Q":h=a[3],d=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,h+n,d+r),l=h,u=d,c=a[1],f=a[2];break;case"t":h=l+a[1],d=u+a[2],o[0].match(/[QqTt]/)===null?(c=l,f=u):o[0]==="t"?(c=2*l-p,f=2*u-g):o[0]==="q"&&(c=2*l-c,f=2*u-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d,c=l+a[1],f=u+a[2];break;case"T":h=a[1],d=a[2],c=2*l-c,f=2*u-f,e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d;break;case"a":Pxe(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+l+n,a[7]+u+r]),l+=a[6],u+=a[7];break;case"A":Pxe(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),l=a[6],u=a[7];break;case"z":case"Z":e.closePath();break}o=a}}function Pxe(e,t,n,r){const i=Hcn(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let s=0;s<i.length;++s){const a=qcn(i[s]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const Lxe=.5773502691896257,Bxe={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Hf)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,s=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-s),e.lineTo(i,-s),e.lineTo(0,-n),e.lineTo(-i,-s),e.lineTo(-r,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=p2*n,i=r-n*Lxe,s=n/4;e.moveTo(0,-r-i),e.lineTo(-s,r-i),e.lineTo(s,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=p2*n,i=r-n*Lxe;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=p2*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=p2*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=p2*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=p2*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function P7e(e){return Kd(Bxe,e)?Bxe[e]:Ycn(e)}var yq={};function Ycn(e){if(!Kd(yq,e)){const t=B3(e);yq[e]={draw:function(n,r){r6(n,t,0,0,Math.sqrt(r)/2)}}}return yq[e]}const Ag=.448084975506;function Xcn(e){return e.x}function Kcn(e){return e.y}function Zcn(e){return e.width}function Qcn(e){return e.height}function Md(e){return typeof e=="function"?e:()=>+e}function fR(e,t,n){return Math.max(t,Math.min(e,n))}function L7e(){var e=Xcn,t=Kcn,n=Zcn,r=Qcn,i=Md(0),s=i,a=i,o=i,l=null;function u(c,f,h){var d,p=f!=null?f:+e.call(this,c),g=h!=null?h:+t.call(this,c),m=+n.call(this,c),v=+r.call(this,c),y=Math.min(m,v)/2,b=fR(+i.call(this,c),0,y),x=fR(+s.call(this,c),0,y),w=fR(+a.call(this,c),0,y),C=fR(+o.call(this,c),0,y);if(l||(l=d=px()),b<=0&&x<=0&&w<=0&&C<=0)l.rect(p,g,m,v);else{var $=p+m,_=g+v;l.moveTo(p+b,g),l.lineTo($-x,g),l.bezierCurveTo($-Ag*x,g,$,g+Ag*x,$,g+x),l.lineTo($,_-C),l.bezierCurveTo($,_-Ag*C,$-Ag*C,_,$-C,_),l.lineTo(p+w,_),l.bezierCurveTo(p+Ag*w,_,p,_-Ag*w,p,_-w),l.lineTo(p,g+b),l.bezierCurveTo(p,g+Ag*b,p+Ag*b,g,p+b,g),l.closePath()}if(d)return l=null,d+""||null}return u.x=function(c){return arguments.length?(e=Md(c),u):e},u.y=function(c){return arguments.length?(t=Md(c),u):t},u.width=function(c){return arguments.length?(n=Md(c),u):n},u.height=function(c){return arguments.length?(r=Md(c),u):r},u.cornerRadius=function(c,f,h,d){return arguments.length?(i=Md(c),s=f!=null?Md(f):i,o=h!=null?Md(h):i,a=d!=null?Md(d):s,u):i},u.context=function(c){return arguments.length?(l=c==null?null:c,u):l},u}function B7e(){var e,t,n,r,i=null,s,a,o,l;function u(f,h,d){const p=d/2;if(s){var g=o-h,m=f-a;if(g||m){var v=Math.sqrt(g*g+m*m),y=(g/=v)*l,b=(m/=v)*l,x=Math.atan2(m,g);i.moveTo(a-y,o-b),i.lineTo(f-g*p,h-m*p),i.arc(f,h,p,x-Math.PI,x),i.lineTo(a+y,o+b),i.arc(a,o,l,x,x+Math.PI)}else i.arc(f,h,p,0,Hf);i.closePath()}else s=1;a=f,o=h,l=p}function c(f){var h,d=f.length,p,g=!1,m;for(i==null&&(i=m=px()),h=0;h<=d;++h)!(h<d&&r(p=f[h],h,f))===g&&(g=!g)&&(s=0),g&&u(+e(p,h,f),+t(p,h,f),+n(p,h,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function TM(e,t){return e!=null?e:t}const DM=e=>e.x||0,IM=e=>e.y||0,Jcn=e=>e.width||0,efn=e=>e.height||0,tfn=e=>(e.x||0)+(e.width||0),nfn=e=>(e.y||0)+(e.height||0),rfn=e=>e.startAngle||0,ifn=e=>e.endAngle||0,sfn=e=>e.padAngle||0,afn=e=>e.innerRadius||0,ofn=e=>e.outerRadius||0,lfn=e=>e.cornerRadius||0,ufn=e=>TM(e.cornerRadiusTopLeft,e.cornerRadius)||0,cfn=e=>TM(e.cornerRadiusTopRight,e.cornerRadius)||0,ffn=e=>TM(e.cornerRadiusBottomRight,e.cornerRadius)||0,hfn=e=>TM(e.cornerRadiusBottomLeft,e.cornerRadius)||0,dfn=e=>TM(e.size,64),pfn=e=>e.size||1,fU=e=>e.defined!==!1,gfn=e=>P7e(e.shape||"circle"),mfn=Fan().startAngle(rfn).endAngle(ifn).padAngle(sfn).innerRadius(afn).outerRadius(ofn).cornerRadius(lfn),vfn=hze().x(DM).y1(IM).y0(nfn).defined(fU),yfn=hze().y(IM).x1(DM).x0(tfn).defined(fU),bfn=fze().x(DM).y(IM).defined(fU),xfn=L7e().x(DM).y(IM).width(Jcn).height(efn).cornerRadius(ufn,cfn,ffn,hfn),wfn=Ran().type(gfn).size(dfn),$fn=B7e().x(DM).y(IM).defined(fU).size(pfn);function joe(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Cfn(e,t){return mfn.context(e)(t)}function _fn(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?yfn:vfn).curve(Voe(r,n.orient,n.tension)).context(e)(t)}function Sfn(e,t){const n=t[0],r=n.interpolate||"linear";return bfn.curve(Voe(r,n.orient,n.tension)).context(e)(t)}function nS(e,t,n,r){return xfn.context(e)(t,n,r)}function kfn(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Efn(e,t){return wfn.context(e)(t)}function Afn(e,t){return $fn.context(e)(t)}var z7e=1;function U7e(){z7e=1}function Hoe(e,t,n){var r=t.clip,i=e._defs,s=t.clip_id||(t.clip_id="clip"+z7e++),a=i.clipping[s]||(i.clipping[s]={id:s});return q9(r)?a.path=r(null):joe(n)?a.path=nS(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+s+")"}function fl(e){this.clear(),e&&this.union(e)}fl.prototype={clone(){return new fl(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:s,y2:a}=this,o=Math.cos(e),l=Math.sin(e),u=t-t*o+n*l,c=n-t*l-n*o;return[o*r-l*i+u,l*r+o*i+c,o*r-l*a+u,l*r+o*a+c,o*s-l*i+u,l*s+o*i+c,o*s-l*a+u,l*s+o*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function qoe(e){this.mark=e,this.bounds=this.bounds||new fl}function Goe(e){qoe.call(this,e),this.items=this.items||[]}J_(Goe,qoe);function Yoe(e){this._pending=0,this._loader=e||Rze()}function zxe(e){e._pending+=1}function Ek(e){e._pending-=1}Yoe.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return zxe(t),t._loader.sanitize(e,{context:"href"}).then(n=>(Ek(t),n)).catch(()=>(Ek(t),null))},loadImage(e){const t=this,n=_ie();return zxe(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const s=new n,a=Kd(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(s.crossOrigin=a),s.onload=()=>Ek(t),s.onerror=()=>Ek(t),s.src=i,s}).catch(r=>(Ek(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function bx(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Tfn(t,r):0))}return e}function Tfn(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const Dfn=Hf-1e-8;let hU,w4,$4,B1,YZ,C4,XZ,KZ;const n0=(e,t)=>hU.add(e,t),_4=(e,t)=>n0(w4=e,$4=t),Uxe=e=>n0(e,hU.y1),Wxe=e=>n0(hU.x1,e),m1=(e,t)=>YZ*e+XZ*t,v1=(e,t)=>C4*e+KZ*t,bq=(e,t)=>n0(m1(e,t),v1(e,t)),xq=(e,t)=>_4(m1(e,t),v1(e,t));function NM(e,t){return hU=e,t?(B1=t*cm,YZ=KZ=Math.cos(B1),C4=Math.sin(B1),XZ=-C4):(YZ=KZ=1,B1=C4=XZ=0),Ifn}const Ifn={beginPath(){},closePath(){},moveTo:xq,lineTo:xq,rect(e,t,n,r){B1?(bq(e+n,t),bq(e+n,t+r),bq(e,t+r),xq(e,t)):(n0(e+n,t+r),_4(e,t))},quadraticCurveTo(e,t,n,r){const i=m1(e,t),s=v1(e,t),a=m1(n,r),o=v1(n,r);Vxe(w4,i,a,Uxe),Vxe($4,s,o,Wxe),_4(a,o)},bezierCurveTo(e,t,n,r,i,s){const a=m1(e,t),o=v1(e,t),l=m1(n,r),u=v1(n,r),c=m1(i,s),f=v1(i,s);jxe(w4,a,l,c,Uxe),jxe($4,o,u,f,Wxe),_4(c,f)},arc(e,t,n,r,i,s){if(r+=B1,i+=B1,w4=n*Math.cos(i)+e,$4=n*Math.sin(i)+t,Math.abs(i-r)>Dfn)n0(e-n,t-n),n0(e+n,t+n);else{const a=u=>n0(n*Math.cos(u)+e,n*Math.sin(u)+t);let o,l;if(a(r),a(i),i!==r)if(r=r%Hf,r<0&&(r+=Hf),i=i%Hf,i<0&&(i+=Hf),i<r&&(s=!s,o=r,r=i,i=o),s)for(i-=Hf,o=r-r%g1,l=0;l<4&&o>i;++l,o-=g1)a(o);else for(o=r-r%g1+g1,l=0;l<4&&o<i;++l,o=o+g1)a(o)}}};function Vxe(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function jxe(e,t,n,r,i){const s=r-e+3*t-3*n,a=e+n-2*t,o=e-t;let l=0,u=0,c;Math.abs(s)>jcn?(c=a*a+o*s,c>=0&&(c=Math.sqrt(c),l=(-a+c)/s,u=(-a-c)/s)):l=.5*o/a,0<l&&l<1&&i(Hxe(l,e,t,n,r)),0<u&&u<1&&i(Hxe(u,e,t,n,r))}function Hxe(e,t,n,r,i){const s=1-e,a=s*s,o=e*e;return a*s*t+3*a*e*n+3*s*o*r+o*e*i}var w0=(w0=Yu(1,1))?w0.getContext("2d"):null;const ZZ=new fl;function Xoe(e){return function(t,n){if(!w0)return!0;e(w0,t),ZZ.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:s,y2:a}=ZZ;for(let o=i;o<=a;++o)for(let l=r;l<=s;++l)if(w0.isPointInPath(l,o))return!0;return!1}}function Koe(e,t){return t.contains(e.x||0,e.y||0)}function W7e(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,s=e.height||0;return t.intersects(ZZ.set(n,r,n+i,r+s))}function V7e(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:r;return L2(t,n,r,i,s)}function L2(e,t,n,r,i){const{x1:s,y1:a,x2:o,y2:l}=e,u=r-t,c=i-n;let f=0,h=1,d,p,g,m;for(m=0;m<4;++m){if(m===0&&(d=-u,p=-(s-t)),m===1&&(d=u,p=o-t),m===2&&(d=-c,p=-(a-n)),m===3&&(d=c,p=l-n),Math.abs(d)<1e-10&&p<0)return!1;if(g=p/d,d<0){if(g>h)return!1;g>f&&(f=g)}else if(d>0){if(g<f)return!1;g<h&&(h=g)}}return!0}function I$(e,t){e.globalCompositeOperation=t.blend||"source-over"}function sc(e,t){return e==null?t:e}function qxe(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function Nfn(e,t,n){const r=n.width(),i=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+sc(t.x1,.5)*r,n.y1+sc(t.y1,.5)*i,Math.max(r,i)*sc(t.r1,0),n.x1+sc(t.x2,.5)*r,n.y1+sc(t.y2,.5)*i,Math.max(r,i)*sc(t.r2,.5));else{const a=sc(t.x1,0),o=sc(t.y1,0),l=sc(t.x2,1),u=sc(t.y2,0);if(a===l||o===u||r===i)s=e.createLinearGradient(n.x1+a*r,n.y1+o*i,n.x1+l*r,n.y1+u*i);else{const c=Yu(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=qxe(f.createLinearGradient(a,o,l,u),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return qxe(s,t.stops)}function j7e(e,t,n){return Woe(n)?Nfn(e,n,t.bounds):n}function i6(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=j7e(e,t,t.fill),!0):!1}var Mfn=[];function N$(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=j7e(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Mfn),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function Ffn(e,t){return e.zindex-t.zindex||e.index-t.index}function Zoe(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,s;for(i=0,s=t.length;i<s;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(Ffn)}function sf(e,t){var n=e.items,r,i;if(!n||!n.length)return;const s=Zoe(e);if(s&&s.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=s}for(r=0,i=n.length;r<i;++r)t(n[r])}function s6(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const s=Zoe(e);for(s&&s.length&&(n=s),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===s){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function Qoe(e){return function(t,n,r){sf(n,i=>{(!r||r.intersects(i.bounds))&&H7e(e,t,i,i)})}}function Ofn(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&H7e(e,t,n.items[0],n.items)}}function H7e(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(I$(t,n),n.fill&&i6(t,n,i)&&t.fill(),n.stroke&&N$(t,n,i)&&t.stroke()))}function dU(e){return e=e||rze,function(t,n,r,i,s,a){return r*=t.pixelRatio,i*=t.pixelRatio,s6(n,o=>{const l=o.bounds;if(!(l&&!l.contains(s,a)||!l)&&e(t,o,r,i,s,a))return o})}}function MM(e,t){return function(n,r,i,s){var a=Array.isArray(r)?r[0]:r,o=t==null?a.fill:t,l=a.stroke&&n.isPointInStroke,u,c;return l&&(u=a.strokeWidth,c=a.strokeCap,n.lineWidth=u!=null?u:1,n.lineCap=c!=null?c:"butt"),e(n,r)?!1:o&&n.isPointInPath(i,s)||l&&n.isPointInStroke(i,s)}}function Joe(e){return dU(MM(e))}function fy(e,t){return"translate("+e+","+t+")"}function ele(e){return"rotate("+e+")"}function Rfn(e,t){return"scale("+e+","+t+")"}function q7e(e){return fy(e.x||0,e.y||0)}function Pfn(e){return fy(e.x||0,e.y||0)+(e.angle?" "+ele(e.angle):"")}function Lfn(e){return fy(e.x||0,e.y||0)+(e.angle?" "+ele(e.angle):"")+(e.scaleX||e.scaleY?" "+Rfn(e.scaleX||1,e.scaleY||1):"")}function tle(e,t,n){function r(a,o){a("transform",Pfn(o)),a("d",t(null,o))}function i(a,o){return t(NM(a,o.angle),o),bx(a,o).translate(o.x||0,o.y||0)}function s(a,o){var l=o.x||0,u=o.y||0,c=o.angle||0;a.translate(l,u),c&&a.rotate(c*=cm),a.beginPath(),t(a,o),c&&a.rotate(-c),a.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:Qoe(s),pick:Joe(s),isect:n||Xoe(s)}}var Bfn=tle("arc",Cfn);function zfn(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,s=1/0,a,o;--i>=0;)e[i].defined!==!1&&(o=Math.abs(e[i][r]-n),o<s&&(s=o,a=e[i]));return a}function Ufn(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,s,a;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],s=e[r].y-t[1],a=i*i+s*s,a<n))return e[r];return null}function Wfn(e,t){for(var n=e.length,r,i,s;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],s=r*r+i*i,r=e[n].size||1,s<r*r))return e[n];return null}function nle(e,t,n){function r(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))}function i(l,u){var c=u.items;return c.length===0?l:(t(NM(l),c),bx(l,c[0]))}function s(l,u){l.beginPath(),t(l,u)}const a=MM(s);function o(l,u,c,f,h,d){var p=u.items,g=u.bounds;return!p||!p.length||g&&!g.contains(h,d)?null:(c*=l.pixelRatio,f*=l.pixelRatio,a(l,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:Ofn(s),pick:o,isect:Koe,tip:n}}var Vfn=nle("area",_fn,zfn);function jfn(e,t){var n=t.clip;e.save(),q9(n)?(e.beginPath(),n(e),e.clip()):G7e(e,t.group)}function G7e(e,t){e.beginPath(),joe(t)?nS(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function Y7e(e){const t=sc(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Hfn(e,t){e("transform",q7e(t))}function X7e(e,t){const n=Y7e(t);e("d",nS(null,t,n,n))}function qfn(e,t){e("class","background"),e("aria-hidden",!0),X7e(e,t)}function Gfn(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?X7e(e,t):e("d","")}function Yfn(e,t,n){const r=t.clip?Hoe(n,t,t):null;e("clip-path",r)}function Xfn(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),bx(e,t),e.translate(t.x||0,t.y||0)}function z3(e,t,n,r){const i=Y7e(t);e.beginPath(),nS(e,t,(n||0)+i,(r||0)+i)}const Kfn=MM(z3),Zfn=MM(z3,!1),Qfn=MM(z3,!0);function Jfn(e,t,n){sf(t,r=>{const i=r.x||0,s=r.y||0,a=r.strokeForeground,o=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&o&&(z3(e,r,i,s),I$(e,r),r.fill&&i6(e,r,o)&&e.fill(),r.stroke&&!a&&N$(e,r,o)&&e.stroke()),e.save(),e.translate(i,s),r.clip&&G7e(e,r),n&&n.translate(-i,-s),sf(r,l=>{this.draw(e,l,n)}),n&&n.translate(i,s),e.restore(),a&&r.stroke&&o&&(z3(e,r,i,s),I$(e,r),N$(e,r,o)&&e.stroke())})}function ehn(e,t,n,r,i,s){if(t.bounds&&!t.bounds.contains(i,s)||!t.items)return null;const a=n*e.pixelRatio,o=r*e.pixelRatio;return s6(t,l=>{let u,c,f;const h=l.bounds;if(h&&!h.contains(i,s))return;c=l.x||0,f=l.y||0;const d=c+(l.width||0),p=f+(l.height||0),g=l.clip;if(g&&(i<c||i>d||s<f||s>p))return;if(e.save(),e.translate(c,f),c=i-c,f=s-f,g&&joe(l)&&!Qfn(e,l,a,o))return e.restore(),null;const m=l.strokeForeground,v=t.interactive!==!1;return v&&m&&l.stroke&&Zfn(e,l,a,o)?(e.restore(),l):(u=s6(l,y=>thn(y,c,f)?this.pick(y,n,r,c,f):null),!u&&v&&(l.fill||!m&&l.stroke)&&Kfn(e,l,a,o)&&(u=l),e.restore(),u||null)})}function thn(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var nhn={type:"group",tag:"g",nested:!1,attr:Hfn,bound:Xfn,draw:Jfn,pick:ehn,isect:W7e,content:Yfn,background:qfn,foreground:Gfn},U3={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function rle(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function ile(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function sle(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function pU(e,t){return e==="center"?t/2:e==="right"?t:0}function gU(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function rhn(e,t,n){const r=rle(t,n),i=ile(t,r),s=sle(t,r),a=(t.x||0)-pU(t.align,i),o=(t.y||0)-gU(t.baseline,s),l=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",l,U3["xmlns:xlink"],"xlink:href"),e("transform",fy(a,o)),e("width",i),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function ihn(e,t){const n=t.image,r=ile(t,n),i=sle(t,n),s=(t.x||0)-pU(t.align,r),a=(t.y||0)-gU(t.baseline,i);return e.set(s,a,s+r,a+i)}function shn(e,t,n){sf(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=rle(r,this);let s=ile(r,i),a=sle(r,i);if(s===0||a===0)return;let o=(r.x||0)-pU(r.align,s),l=(r.y||0)-gU(r.baseline,a),u,c,f,h;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(h=s/c,l+=(a-h)/2,a=h):(h=a*c,o+=(s-h)/2,s=h))),(i.complete||i.toDataURL)&&(I$(e,r),e.globalAlpha=(u=r.opacity)!=null?u:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,o,l,s,a))})}var ahn={type:"image",tag:"image",nested:!1,attr:rhn,bound:ihn,draw:shn,pick:dU(),isect:rze,get:rle,xOffset:pU,yOffset:gU},ohn=nle("line",Sfn,Ufn);function lhn(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",Lfn(t)),e("d",t.path)}function S4(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,s=t.scaleX||1,a=t.scaleY||1,o=(t.angle||0)*cm,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=B3(n)).path=n),o&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(o),r6(e,l,0,0,s,a),e.rotate(-o),e.translate(-r,-i)):r6(e,l,r,i,s,a)}function uhn(e,t){return S4(NM(e,t.angle),t)?e.set(0,0,0,0):bx(e,t,!0)}var chn={type:"path",tag:"path",nested:!1,attr:lhn,bound:uhn,draw:Qoe(S4),pick:Joe(S4),isect:Xoe(S4)};function fhn(e,t){e("d",nS(null,t))}function hhn(e,t){var n,r;return bx(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function Gxe(e,t){e.beginPath(),nS(e,t)}var dhn={type:"rect",tag:"path",nested:!1,attr:fhn,bound:hhn,draw:Qoe(Gxe),pick:Joe(Gxe),isect:W7e};function phn(e,t){e("transform",q7e(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function ghn(e,t){var n,r;return bx(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function K7e(e,t,n){var r,i,s,a;return t.stroke&&N$(e,t,n)?(r=t.x||0,i=t.y||0,s=t.x2!=null?t.x2:r,a=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(s,a),!0):!1}function mhn(e,t,n){sf(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&K7e(e,r,i)&&(I$(e,r),e.stroke())}})}function vhn(e,t,n,r){return e.isPointInStroke?K7e(e,t,1)&&e.isPointInStroke(n,r):!1}var yhn={type:"rule",tag:"line",nested:!1,attr:phn,bound:ghn,draw:mhn,pick:dU(vhn),isect:V7e},bhn=tle("shape",kfn),xhn=tle("symbol",Efn,Koe);const Yxe=_an();var cw={height:fd,measureWidth:ale,estimateWidth:QZ,width:QZ,canvas:Z7e};Z7e(!0);function Z7e(e){cw.width=e&&w0?ale:QZ}function QZ(e,t){return Q7e(hm(e,t),fd(e))}function Q7e(e,t){return~~(.8*e.length*t)}function ale(e,t){return fd(e)<=0||!(t=hm(e,t))?0:J7e(t,mU(e))}function J7e(e,t){const n=`(${t}) ${e}`;let r=Yxe.get(n);return r===void 0&&(w0.font=t,r=w0.measureText(e).width,Yxe.set(n,r)),r}function fd(e){return e.fontSize!=null?+e.fontSize||0:11}function fm(e){return e.lineHeight!=null?e.lineHeight:fd(e)+2}function whn(e){return ud(e)?e.length>1?e:e[0]:e}function FM(e){return whn(e.lineBreak&&e.text&&!ud(e.text)?e.text.split(e.lineBreak):e.text)}function $hn(e){const t=FM(e);return(ud(t)?t.length-1:0)*fm(e)}function hm(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?_hn(e,n):n}function Chn(e){if(cw.width===ale){const t=mU(e);return n=>J7e(n,t)}else{const t=fd(e);return n=>Q7e(n,t)}}function _hn(e,t){var n=+e.limit,r=Chn(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",s=e.dir==="rtl",a=0,o=t.length,l;if(n-=r(i),s){for(;a<o;)l=a+o>>>1,r(t.slice(l))>n?a=l+1:o=l;return i+t.slice(a)}else{for(;a<o;)l=1+(a+o>>>1),r(t.slice(0,l))<n?a=l:o=l-1;return t.slice(0,a)+i}}function OM(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function mU(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+fd(e)+"px "+OM(e,t)}function ole(e){var t=e.baseline,n=fd(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*fm(e):t==="line-bottom"?.29*n-.5*fm(e):0)}const Shn={left:"start",center:"middle",right:"end"},CA=new fl;function vU(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-g1,t+=r*Math.cos(i),n+=r*Math.sin(i)),CA.x1=t,CA.y1=n,CA}function khn(e,t){var n=t.dx||0,r=(t.dy||0)+ole(t),i=vU(t),s=i.x1,a=i.y1,o=t.angle||0,l;e("text-anchor",Shn[t.align]||"start"),o?(l=fy(s,a)+" "+ele(o),(n||r)&&(l+=" "+fy(n,r))):l=fy(s+n,a+r),e("transform",l)}function lle(e,t,n){var r=cw.height(t),i=t.align,s=vU(t),a=s.x1,o=s.y1,l=t.dx||0,u=(t.dy||0)+ole(t)-Math.round(.8*r),c=FM(t),f;if(ud(c)?(r+=fm(t)*(c.length-1),f=c.reduce((h,d)=>Math.max(h,cw.width(t,d)),0)):f=cw.width(t,c),i==="center"?l-=f/2:i==="right"&&(l-=f),e.set(l+=a,u+=o,l+f,u+r),t.angle&&!n)e.rotate(t.angle*cm,a,o);else if(n===2)return e.rotatedPoints(t.angle*cm,a,o);return e}function Ehn(e,t,n){sf(t,r=>{var i=r.opacity==null?1:r.opacity,s,a,o,l,u,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=mU(r),e.textAlign=r.align||"left",s=vU(r),a=s.x1,o=s.y1,r.angle&&(e.save(),e.translate(a,o),e.rotate(r.angle*cm),a=o=0),a+=r.dx||0,o+=(r.dy||0)+ole(r),c=FM(r),I$(e,r),ud(c))for(u=fm(r),l=0;l<c.length;++l)f=hm(r,c[l]),r.fill&&i6(e,r,i)&&e.fillText(f,a,o),r.stroke&&N$(e,r,i)&&e.strokeText(f,a,o),o+=u;else f=hm(r,c),r.fill&&i6(e,r,i)&&e.fillText(f,a,o),r.stroke&&N$(e,r,i)&&e.strokeText(f,a,o);r.angle&&e.restore()}})}function Ahn(e,t,n,r,i,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=vU(t),o=a.x1,l=a.y1,u=lle(CA,t,1),c=-t.angle*cm,f=Math.cos(c),h=Math.sin(c),d=f*i-h*s+(o-f*o+h*l),p=h*i+f*s+(l-h*o-f*l);return u.contains(d,p)}function Thn(e,t){const n=lle(CA,e,2);return L2(t,n[0],n[1],n[2],n[3])||L2(t,n[0],n[1],n[4],n[5])||L2(t,n[4],n[5],n[6],n[7])||L2(t,n[2],n[3],n[6],n[7])}var Dhn={type:"text",tag:"text",nested:!1,attr:khn,bound:lle,draw:Ehn,pick:dU(Ahn),isect:Thn},Ihn=nle("trail",Afn,Wfn),af={arc:Bfn,area:Vfn,group:nhn,image:ahn,line:ohn,path:chn,rect:dhn,rule:yhn,shape:bhn,symbol:xhn,text:Dhn,trail:Ihn};function JZ(e,t,n){var r=af[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new fl),e,n)}var Xxe={mark:null};function e9e(e,t,n){var r=af[e.marktype],i=r.bound,s=e.items,a=s&&s.length,o,l,u,c;if(r.nested)return a?u=s[0]:(Xxe.mark=e,u=Xxe),c=JZ(u,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new fl,a)for(o=0,l=s.length;o<l;++o)t.union(JZ(s[o],i,n));return e.bounds=t}const Nhn=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function t9e(e,t){return JSON.stringify(e,Nhn,t)}function n9e(e){const t=typeof e=="string"?JSON.parse(e):e;return r9e(t)}function r9e(e){var t=e.marktype,n=e.items,r,i,s;if(n)for(i=0,s=n.length;i<s;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&r9e(n[i]);return t&&e9e(e),e}function i9e(e){arguments.length?this.root=n9e(e):(this.root=s9e({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Goe(this.root)])}i9e.prototype={toJSON(e){return t9e(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=s9e(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function s9e(e,t){const n={bounds:new fl,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function r0(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function ule(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Wo(e,t,n,r){var i=e.childNodes[t],s;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(s=i||null,i=r0(e.ownerDocument,n,r),e.insertBefore(i,s)),i}function Ac(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function a9e(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function cle(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Mhn(e,t,n,r){var i=e&&e.mark,s,a;if(i&&(s=af[i.marktype]).tip){for(a=cle(t,n),a[0]-=r[0],a[1]-=r[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=s.tip(i.items,a)}return e}function dm(e,t){this._active=null,this._handlers={},this._loader=e||Rze(),this._tooltip=t||Fhn}function Fhn(e,t,n,r){e.element().setAttribute("title",r||"")}dm.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),s=r0(null,"a");for(const a in r)s.setAttribute(a,r[a]);s.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=Mhn(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,s=i.width(),a=i.height();let o=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)o+=e.x||0,l+=e.y||0;return{x:o,y:l,width:s,height:a,left:o,top:l,right:o+s,bottom:l+a}}};function hd(e){this._el=null,this._bgcolor=null,this._loader=new Yoe(e)}hd.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(s=>{s&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const Ohn="keydown",Rhn="keypress",Phn="keyup",o9e="dragenter",k4="dragleave",l9e="dragover",eQ="mousedown",Lhn="mouseup",a6="mousemove",_A="mouseout",u9e="mouseover",o6="click",Bhn="dblclick",zhn="wheel",c9e="mousewheel",l6="touchstart",u6="touchmove",c6="touchend",Uhn=[Ohn,Rhn,Phn,o9e,k4,l9e,eQ,Lhn,a6,_A,u9e,o6,Bhn,zhn,c9e,l6,u6,c6],tQ=a6,W3=_A,nQ=o6;function fle(e,t){dm.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const Whn=e=>e===l6||e===u6||e===c6?[l6,u6,c6]:[e];function Kxe(e,t){Whn(t).forEach(n=>Vhn(e,n))}function Vhn(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function Zxe(e,t,n){return function(r){const i=this._active,s=this.pickEvent(r);s===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=s,this.fire(t,r),this.fire(e,r))}}function Qxe(e){return function(t){this.fire(e,t),this._active=null}}J_(fle,dm,{initialize(e,t,n){return this._canvas=e&&ule(e,"canvas"),[o6,eQ,a6,_A,k4].forEach(r=>Kxe(this,r)),dm.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:Uhn,DOMMouseScroll(e){this.fire(c9e,e)},mousemove:Zxe(a6,u9e,_A),dragover:Zxe(l9e,o9e,k4),mouseout:Qxe(_A),dragleave:Qxe(k4),mousedown(e){this._down=this._active,this.fire(eQ,e)},click(e){this._down===this._active&&(this.fire(o6,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(l6,e,!0)},touchmove(e){this.fire(u6,e,!0)},touchend(e){this.fire(c6,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===nQ&&r&&r.href?this.handleHref(t,r,r.href):(e===tQ||e===W3)&&this.handleTooltip(t,r,e!==W3),i)for(let s=0,a=i.length;s<a;++s)i[s].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(Kxe(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=cle(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const s=this.context();return af[e.marktype].pick.call(this,s,e,t,n,r,i)}});function jhn(){return typeof window<"u"&&window.devicePixelRatio||1}var Hhn=jhn();function qhn(e,t,n,r,i,s){const a=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,o=e.getContext("2d"),l=a?Hhn:i;e.width=t*l,e.height=n*l;for(const u in s)o[u]=s[u];return a&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),o.pixelRatio=l,o.setTransform(l,0,0,l,l*r[0],l*r[1]),e}function f6(e){hd.call(this,e),this._options={},this._redraw=!1,this._dirty=new fl,this._tempb=new fl}const Jxe=hd.prototype,Ghn=(e,t,n)=>new fl().set(0,0,t,n).translate(-e[0],-e[1]);function Yhn(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}J_(f6,hd,{initialize(e,t,n,r,i,s){return this._options=s||{},this._canvas=this._options.externalContext?null:Yu(1,1,this._options.type),e&&this._canvas&&(Ac(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Jxe.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(Jxe.resize.call(this,e,t,n,r),this._canvas)qhn(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||hh("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,s=this._dirty,a=Ghn(n,r,i);t.save();const o=this._redraw||s.empty()?(this._redraw=!1,a.expand(1)):Yhn(t,a.intersect(s),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,o),t.restore(),s.clear(),this},draw(e,t,n){const r=af[t.marktype];t.clip&&jfn(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,s=this.context();i.type!=="pdf"&&!i.externalContext&&s.clearRect(e,t,n,r),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,r))}});function hle(e,t){dm.call(this,e,t);const n=this;n._hrefHandler=rQ(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=rQ(n,(r,i)=>{n.handleTooltip(r,i,r.type!==W3)})}const rQ=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};J_(hle,dm,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(nQ,this._hrefHandler),r.removeEventListener(tQ,this._tooltipHandler),r.removeEventListener(W3,this._tooltipHandler)),this._svg=r=e&&ule(e,"svg"),r&&(r.addEventListener(nQ,this._hrefHandler),r.addEventListener(tQ,this._tooltipHandler),r.addEventListener(W3,this._tooltipHandler)),dm.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const s={type:e,handler:t,listener:rQ(this,t)};(r[n]||(r[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const f9e="aria-hidden",dle="aria-label",ple="role",gle="aria-roledescription",h9e="graphics-object",mle="graphics-symbol",d9e=(e,t,n)=>({[ple]:e,[gle]:t,[dle]:n||void 0}),Xhn=sze(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),e2e={axis:{desc:"axis",caption:Qhn},legend:{desc:"legend",caption:Jhn},"title-text":{desc:"title",caption:e=>`Title text '${n2e(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${n2e(e)}'`}},t2e={ariaRole:ple,ariaRoleDescription:gle,description:dle};function p9e(e,t){const n=t.aria===!1;if(e(f9e,n||void 0),n||t.description==null)for(const r in t2e)e(t2e[r],void 0);else{const r=t.mark.marktype;e(dle,t.description),e(ple,t.ariaRole||(r==="group"?h9e:mle)),e(gle,t.ariaRoleDescription||`${r} mark`)}}function g9e(e){return e.aria===!1?{[f9e]:!0}:Xhn[e.role]?null:e2e[e.role]?Zhn(e,e2e[e.role]):Khn(e)}function Khn(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return d9e(n?h9e:mle,`${t} mark container`,e.description)}function Zhn(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return d9e(t.role||mle,t.desc,n.description||r(n))}catch{return null}}function n2e(e){return loe(e.text).join(" ")}function Qhn(e){const t=e.datum,n=e.orient,r=t.title?m9e(e):null,i=e.context,s=i.scales[t.scale].value,a=i.dataflow.locale(),o=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${E7e(o)?"discrete":o} scale with ${M7e(a,s,e)}`}function Jhn(e){const t=e.datum,n=t.title?m9e(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,s=Object.keys(i),a=e.context,o=a.scales[i[s[0]]].value,l=a.dataflow.locale();return tdn(r)+(n?` titled '${n}'`:"")+` for ${edn(s)} with ${M7e(l,o,e)}`}function m9e(e){try{return loe(ab(e.items).items[0].text).join(" ")}catch{return null}}function edn(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+ab(e)}function tdn(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const v9e=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ndn=e=>v9e(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function vle(){let e="",t="",n="";const r=[],i=()=>t=n="",s=l=>{t&&(e+=`${t}>${n}`,i()),r.push(l)},a=(l,u)=>(u!=null&&(t+=` ${l}="${ndn(u)}"`),o),o={open(l,...u){s(l),t="<"+l;for(const c of u)for(const f in c)a(f,c[f]);return o},close(){const l=r.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,i(),o},attr:a,text:l=>(n+=v9e(l),o),toString:()=>e};return o}const y9e=e=>b9e(vle(),e)+"";function b9e(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let i=0;i<r;i++){const s=n[i];s.nodeType===3?e.text(s.nodeValue):b9e(e,s)}}return e.close()}const h6={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},x9e={fill:"none","stroke-miterlimit":10},Ak=0,r2e="http://www.w3.org/2000/xmlns/",Si=U3.xmlns;function yle(e){hd.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const wq=hd.prototype;J_(yle,hd,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=Wo(e,0,"svg",Si),this._svg.setAttributeNS(r2e,"xmlns",Si),this._svg.setAttributeNS(r2e,"xmlns:xlink",U3["xmlns:xlink"]),this._svg.setAttribute("version",U3.version),this._svg.setAttribute("class","marks"),Ac(e,1),this._root=Wo(this._svg,Ak,"g",Si),i0(this._root,x9e),Ac(this._svg,Ak+1)),this.background(this._bgcolor),wq.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),wq.background.apply(this,arguments)},resize(e,t,n,r){return wq.resize.call(this,e,t,n,r),this._svg&&(i0(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Wo(e,Ak,"rect",Si),i0(n,{width:this._width,height:this._height,fill:t}));const r=y9e(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Ac(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,s,a,o,l;for(a=0,o=e.length;a<o;++a)if(n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,s=af[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,i2e(n,t),r.items.forEach(u=>{u.dirty=t})),!r.zdirty){if(n.exit){s.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(s,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null;continue}n=s.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,i2e(n,t)):this._update(s,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=af[t.marktype],s=t.interactive===!1?"none":null,a=i.tag==="g";let o=null,l=0;const u=s2e(t,e,n,"g",r);u.setAttribute("class",a9e(t));const c=g9e(t);for(const h in c)Ua(u,h,c[h]);a||Ua(u,"pointer-events",s),Ua(u,"clip-path",t.clip?Hoe(this,t,t.group):null);const f=h=>{const d=this.isDirty(h),p=s2e(h,u,o,i.tag,r);d&&(this._update(i,p,h),a&&sdn(this,p,h)),o=p,++l};return i.nested?t.items.length&&f(t.items[0]):sf(t,f),Ac(u,l),u},_update(e,t,n){lp=t,oa=t.__values__,p9e(SA,n),e.attr(SA,n,this);const r=odn[e.type];r&&r.call(this,e,t,n),lp&&this.style(lp,n)},style(e,t){if(t!=null)for(const n in h6){let r=n==="font"?OM(t):t[n];if(r===oa[n])continue;const i=h6[n];r==null?e.removeAttribute(i):(Woe(r)&&(r=O7e(r,this._defs.gradient,w9e())),e.setAttribute(i,r+"")),oa[n]=r}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=Wo(e,Ak+1,"defs",Si)),r=rdn(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=Wo(e,Ak+1,"defs",Si)),r=idn(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):Ac(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function i2e(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function rdn(e,t,n){let r,i,s;if(t.gradient==="radial"){let a=Wo(e,n++,"pattern",Si);i0(a,{id:n6+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=Wo(a,0,"rect",Si),i0(a,{width:1,height:1,fill:`url(${w9e()}#${t.id})`}),e=Wo(e,n++,"radialGradient",Si),i0(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Wo(e,n++,"linearGradient",Si),i0(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)s=Wo(e,r,"stop",Si),s.setAttribute("offset",t.stops[r].offset),s.setAttribute("stop-color",t.stops[r].color);return Ac(e,r),n}function idn(e,t,n){let r;return e=Wo(e,n,"clipPath",Si),e.setAttribute("id",t.id),t.path?(r=Wo(e,0,"path",Si),r.setAttribute("d",t.path)):(r=Wo(e,0,"rect",Si),i0(r,{x:0,y:0,width:t.width,height:t.height})),Ac(e,1),n+1}function sdn(e,t,n){t=t.lastChild.previousSibling;let r,i=0;sf(n,s=>{r=e.mark(t,s,r),++i}),Ac(t,1+i)}function s2e(e,t,n,r,i){let s=e._svg,a;if(!s&&(a=t.ownerDocument,s=r0(a,r,Si),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},r==="g"))){const o=r0(a,"path",Si);s.appendChild(o),o.__data__=e;const l=r0(a,"g",Si);s.appendChild(l),l.__data__=e;const u=r0(a,"path",Si);s.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(s.ownerSVGElement!==i||adn(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function adn(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let lp=null,oa=null;const odn={group(e,t,n){const r=lp=t.childNodes[2];oa=r.__values__,e.foreground(SA,n,this),oa=t.__values__,lp=t.childNodes[1],e.content(SA,n,this);const i=lp=t.childNodes[0];e.background(SA,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==oa.events&&(Ua(r,"pointer-events",s),Ua(i,"pointer-events",s),oa.events=s),n.strokeForeground&&n.stroke){const a=n.fill;Ua(r,"display",null),this.style(i,n),Ua(i,"stroke",null),a&&(n.fill=null),oa=r.__values__,this.style(r,n),a&&(n.fill=a),lp=null}else Ua(r,"display","none")},image(e,t,n){n.smooth===!1?($q(t,"image-rendering","optimizeSpeed"),$q(t,"image-rendering","pixelated")):$q(t,"image-rendering",null)},text(e,t,n){const r=FM(n);let i,s,a,o;ud(r)?(s=r.map(l=>hm(n,l)),i=s.join(`
`),i!==oa.text&&(Ac(t,0),a=t.ownerDocument,o=fm(n),s.forEach((l,u)=>{const c=r0(a,"tspan",Si);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",o)),t.appendChild(c)}),oa.text=i)):(s=hm(n,r),s!==oa.text&&(t.textContent=s,oa.text=s)),Ua(t,"font-family",OM(n)),Ua(t,"font-size",fd(n)+"px"),Ua(t,"font-style",n.fontStyle),Ua(t,"font-variant",n.fontVariant),Ua(t,"font-weight",n.fontWeight)}};function SA(e,t,n){t!==oa[e]&&(n?ldn(lp,e,t,n):Ua(lp,e,t),oa[e]=t)}function $q(e,t,n){n!==oa[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),oa[t]=n)}function i0(e,t){for(const n in t)Ua(e,n,t[n])}function Ua(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function ldn(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function w9e(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function ble(e){hd.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}J_(ble,hd,{svg(){return this._text},_render(e){const t=vle();t.open("svg",G9({},U3,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",x9e,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=af[t.marktype],r=n.tag,i=[p9e,n.attr];e.open("g",{class:a9e(t),"clip-path":t.clip?Hoe(this,t,t.group):null},g9e(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const s=a=>{const o=this.href(a);if(o&&e.open("a",o),e.open(r,this.attr(t,a,i,r!=="g"?r:null)),r==="text"){const l=FM(a);if(ud(l)){const u={x:0,dy:fm(a)};for(let c=0;c<l.length;++c)e.open("tspan",c?u:null).text(hm(a,l[c])).close()}else e.text(hm(a,l))}else if(r==="g"){const l=a.strokeForeground,u=a.fill,c=a.stroke;l&&c&&(a.stroke=null),e.open("path",this.attr(t,a,n.background,"bgrect")).close(),e.open("g",this.attr(t,a,n.content)),sf(a,f=>this.mark(e,f)),e.close(),l&&c?(u&&(a.fill=null),a.stroke=c,e.open("path",this.attr(t,a,n.foreground,"bgrect")).close(),u&&(a.fill=u)):e.open("path",this.attr(t,a,n.foreground,"bgfore")).close()}e.close(),o&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):sf(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},s=(a,o,l,u)=>{i[u||a]=o};return Array.isArray(n)?n.forEach(a=>a(s,t,this)):n(s,t,this),r&&udn(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const s=t[i],a=s.stops;s.gradient==="radial"?(e.open("pattern",{id:n6+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:i,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let o=0;o<a.length;++o)e.open("stop",{offset:a[o].offset,"stop-color":a[o].color}).close();e.close()}for(const i in n){const s=n[i];e.open("clipPath",{id:i}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});function udn(e,t,n,r,i){if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),r==="text"&&(e["font-family"]=OM(t),e["font-size"]=fd(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const s in h6){let a=t[s];const o=h6[s];a==="transparent"&&(o==="fill"||o==="stroke")||a!=null&&(Woe(a)&&(a=O7e(a,i.gradient,"")),e[o]=a)}return e}const $9e="canvas",C9e="png",_9e="svg",S9e="none",cdn={Canvas:$9e,PNG:C9e,SVG:_9e,None:S9e},M$={};M$[$9e]=M$[C9e]={renderer:f6,headless:f6,handler:fle};M$[_9e]={renderer:yle,headless:ble,handler:hle};M$[S9e]={};function fdn(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(M$[e]=t,this):M$[e]}function hdn(e,t,n){const r=[],i=new fl().union(t),s=e.marktype;return s?k9e(e,i,n,r):s==="group"?E9e(e,i,n,r):hh("Intersect scene must be mark node or group item.")}function k9e(e,t,n,r){if(ddn(e,t,n)){const i=e.items,s=e.marktype,a=i.length;let o=0;if(s==="group")for(;o<a;++o)E9e(i[o],t,n,r);else for(const l=af[s].isect;o<a;++o){const u=i[o];A9e(u,t,l)&&r.push(u)}}return r}function ddn(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function E9e(e,t,n,r){n&&n(e.mark)&&A9e(e,t,af.group.isect)&&r.push(e);const i=e.items,s=i&&i.length;if(s){const a=e.x||0,o=e.y||0;t.translate(-a,-o);for(let l=0;l<s;++l)k9e(i[l],t,n,r);t.translate(a,o)}return r}function A9e(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const Cq=new fl;function pdn(e){const t=e.clip;if(q9(t))t(NM(Cq.clear()));else if(t)Cq.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(Cq)}const gdn=1e-9;function xle(e,t,n){return e===t?!0:n==="path"?T9e(e,t):e instanceof Date&&t instanceof Date?+e==+t:Ube(e)&&Ube(t)?Math.abs(e-t)<=gdn:!e||!t||!zL(e)&&!zL(t)?e==t:mdn(e,t)}function T9e(e,t){return xle(B3(e),B3(t))}function mdn(e,t){var n=Object.keys(e),r=Object.keys(t),i,s;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),s=n.length-1;s>=0;s--)if(n[s]!=r[s])return!1;for(s=n.length-1;s>=0;s--)if(i=n[s],!xle(e[i],t[i],i))return!1;return typeof e==typeof t}function vdn(){U7e(),Ucn()}function rS(e,t,n){return e.fields=t||[],e.fname=n,e}function ydn(e){return e.length===1?bdn(e[0]):xdn(e)}const bdn=e=>function(t){return t[e]},xdn=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function _q(e){throw Error(e)}function wdn(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||_q("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&_q("Access path missing closing bracket: "+e),r&&_q("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function $dn(e,t,n){const r=wdn(e);return e=r.length===1?r[0]:e,rS((n&&n.get||ydn)(r),[e],t||e)}$dn("id");rS(e=>e,[],"identity");rS(()=>0,[],"zero");rS(()=>1,[],"one");rS(()=>!0,[],"true");rS(()=>!1,[],"false");var Cdn=Array.isArray;function D9e(e){return e[e.length-1]}function _dn(e){return e==null||e===""?null:+e}function Sdn(e){return e!=null?Cdn(e)?e:[e]:[]}const kdn=Object.prototype.hasOwnProperty;function Edn(e,t){return kdn.call(e,t)}function Adn(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function dd(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function rv(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const a2e=Symbol("implicit");function wle(){var e=new Map,t=[],n=[],r=a2e;function i(s){var a=s+"",o=e.get(a);if(!o){if(r!==a2e)return r;e.set(a,o=t.push(s))}return n[(o-1)%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new Map;for(const a of s){const o=a+"";e.has(o)||e.set(o,t.push(a))}return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return wle(t,n).unknown(r)},dd.apply(i,arguments),i}function Tdn(e){return function(){return e}}function iQ(e){return+e}var o2e=[0,1];function Ko(e){return e}function sQ(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Tdn(isNaN(t)?NaN:.5)}function Ddn(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Idn(e,t,n){var r=e[0],i=e[1],s=t[0],a=t[1];return i<r?(r=sQ(i,r),s=n(a,s)):(r=sQ(r,i),s=n(s,a)),function(o){return s(r(o))}}function Ndn(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=sQ(e[a],e[a+1]),s[a]=n(t[a],t[a+1]);return function(o){var l=QN(e,o,1,r)-1;return s[l](i[l](o))}}function RM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function yU(){var e=o2e,t=o2e,n=Jm,r,i,s,a=Ko,o,l,u;function c(){var h=Math.min(e.length,t.length);return a!==Ko&&(a=Ddn(e[0],e[h-1])),o=h>2?Ndn:Idn,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?s:(l||(l=o(e.map(r),t,n)))(r(a(h)))}return f.invert=function(h){return a(i((u||(u=o(t,e.map(r),yc)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,iQ),c()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),n=pM,c()},f.clamp=function(h){return arguments.length?(a=h?!0:Ko,c()):a!==Ko},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,d){return r=h,i=d,c()}}function I9e(){return yU()(Ko,Ko)}function Mdn(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function d6(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function F$(e){return e=d6(Math.abs(e)),e?e[1]:NaN}function Fdn(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function Odn(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Rdn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function O$(e){if(!(t=Rdn.exec(e)))throw new Error("invalid format: "+e);var t;return new $le({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}O$.prototype=$le.prototype;function $le(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}$le.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Pdn(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var N9e;function Ldn(e,t){var n=d6(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(N9e=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+d6(e,Math.max(0,t+s-1))[0]}function l2e(e,t){var n=d6(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const u2e={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Mdn,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>l2e(e*100,t),r:l2e,s:Ldn,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function c2e(e){return e}var f2e=Array.prototype.map,h2e=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function M9e(e){var t=e.grouping===void 0||e.thousands===void 0?c2e:Fdn(f2e.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?c2e:Odn(f2e.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=O$(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):u2e[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var C=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=g==="$"?r:/[%p]/.test(w)?a:"",_=u2e[w],k=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(S){var I=C,A=$,D,T,N;if(w==="c")A=_(S)+A,S="";else{S=+S;var F=S<0||1/S<0;if(S=isNaN(S)?l:_(Math.abs(S),b),x&&(S=Pdn(S)),F&&+S==0&&p!=="+"&&(F=!1),I=(F?p==="("?p:o:p==="-"||p==="("?"":p)+I,A=(w==="s"?h2e[8+N9e/3]:"")+A+(F&&p==="("?")":""),k){for(D=-1,T=S.length;++D<T;)if(N=S.charCodeAt(D),48>N||N>57){A=(N===46?i+S.slice(D+1):S.slice(D))+A,S=S.slice(0,D);break}}}y&&!m&&(S=t(S,1/0));var R=I.length+S.length+A.length,P=R<v?new Array(v-R+1).join(h):"";switch(y&&m&&(S=t(P+S,P.length?v-A.length:1/0),P=""),d){case"<":S=I+S+A+P;break;case"=":S=I+P+S+A;break;case"^":S=P.slice(0,R=P.length>>1)+I+S+A+P.slice(R);break;default:S=P+I+S+A;break}return s(S)}return E.toString=function(){return f+""},E}function c(f,h){var d=u((f=O$(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(F$(h)/3)))*3,g=Math.pow(10,-p),m=h2e[8+p/3];return function(v){return d(g*v)+m}}return{format:u,formatPrefix:c}}var hR,bU,Cle;Bdn({thousands:",",grouping:[3],currency:["$",""]});function Bdn(e){return hR=M9e(e),bU=hR.format,Cle=hR.formatPrefix,hR}function F9e(e){return Math.max(0,-F$(Math.abs(e)))}function O9e(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(F$(t)/3)))*3-F$(Math.abs(e)))}function R9e(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,F$(t)-F$(e))+1}function P9e(e,t,n,r){var i=K0(e,t,n),s;switch(r=O$(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=O9e(i,a))&&(r.precision=s),Cle(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=R9e(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=F9e(i))&&(r.precision=s-(r.type==="%")*2);break}}return bU(r)}function xx(e){var t=e.domain;return e.ticks=function(n){var r=t();return IX(r[0],r[r.length-1],n==null?10:n)},e.tickFormat=function(n,r){var i=t();return P9e(i[0],i[i.length-1],n==null?10:n,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,a=r[i],o=r[s],l,u,c=10;for(o<a&&(u=a,a=o,o=u,u=i,i=s,s=u);c-- >0;){if(u=kRe(a,o,n),u===l)return r[i]=a,r[s]=o,t(r);if(u>0)a=Math.floor(a/u)*u,o=Math.ceil(o/u)*u;else if(u<0)a=Math.ceil(a*u)/u,o=Math.floor(o*u)/u;else break;l=u}return e},e}function L9e(){var e=I9e();return e.copy=function(){return RM(e,L9e())},dd.apply(e,arguments),xx(e)}function B9e(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,iQ),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return B9e(e).unknown(t)},e=arguments.length?Array.from(e,iQ):[0,1],xx(n)}function z9e(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),e[n]=t.floor(i),e[r]=t.ceil(s),e}function d2e(e){return Math.log(e)}function p2e(e){return Math.exp(e)}function zdn(e){return-Math.log(-e)}function Udn(e){return-Math.exp(-e)}function Wdn(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Vdn(e){return e===10?Wdn:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function jdn(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function g2e(e){return function(t){return-e(-t)}}function _le(e){var t=e(d2e,p2e),n=t.domain,r=10,i,s;function a(){return i=jdn(r),s=Vdn(r),n()[0]<0?(i=g2e(i),s=g2e(s),e(zdn,Udn)):e(d2e,p2e),t}return t.base=function(o){return arguments.length?(r=+o,a()):r},t.domain=function(o){return arguments.length?(n(o),a()):n()},t.ticks=function(o){var l=n(),u=l[0],c=l[l.length-1],f;(f=c<u)&&(h=u,u=c,c=h);var h=i(u),d=i(c),p,g,m,v=o==null?10:+o,y=[];if(!(r%1)&&d-h<v){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(g=1,p=s(h);g<r;++g)if(m=p*g,!(m<u)){if(m>c)break;y.push(m)}}else for(;h<=d;++h)for(g=r-1,p=s(h);g>=1;--g)if(m=p*g,!(m<u)){if(m>c)break;y.push(m)}y.length*2<v&&(y=IX(u,c,v))}else y=IX(h,d,Math.min(d-h,v)).map(s);return f?y.reverse():y},t.tickFormat=function(o,l){if(l==null&&(l=r===10?".0e":","),typeof l!="function"&&(l=bU(l)),o===1/0)return l;o==null&&(o=10);var u=Math.max(1,r*o/t.ticks().length);return function(c){var f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=function(){return n(z9e(n(),{floor:function(o){return s(Math.floor(i(o)))},ceil:function(o){return s(Math.ceil(i(o)))}}))},t}function U9e(){var e=_le(yU()).domain([1,10]);return e.copy=function(){return RM(e,U9e()).base(e.base())},dd.apply(e,arguments),e}function m2e(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function v2e(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Sle(e){var t=1,n=e(m2e(t),v2e(t));return n.constant=function(r){return arguments.length?e(m2e(t=+r),v2e(t)):t},xx(n)}function W9e(){var e=Sle(yU());return e.copy=function(){return RM(e,W9e()).constant(e.constant())},dd.apply(e,arguments)}function y2e(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Hdn(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function qdn(e){return e<0?-e*e:e*e}function kle(e){var t=e(Ko,Ko),n=1;function r(){return n===1?e(Ko,Ko):n===.5?e(Hdn,qdn):e(y2e(n),y2e(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},xx(t)}function Ele(){var e=kle(yU());return e.copy=function(){return RM(e,Ele()).exponent(e.exponent())},dd.apply(e,arguments),e}function Gdn(){return Ele.apply(null,arguments).exponent(.5)}function V9e(){var e=[],t=[],n=[],r;function i(){var a=0,o=Math.max(1,t.length);for(n=new Array(o-1);++a<o;)n[a-1]=ARe(e,a/o);return s}function s(a){return a==null||isNaN(a=+a)?r:t[QN(n,a)]}return s.invertExtent=function(a){var o=t.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},s.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let o of a)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(B_),i()},s.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return V9e().domain(e).range(t).unknown(r)},dd.apply(s,arguments)}function j9e(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function a(l){return l!=null&&l<=l?i[QN(r,l,0,n)]:s}function o(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return a}return a.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},a.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,o()):i.slice()},a.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},a.unknown=function(l){return arguments.length&&(s=l),a},a.thresholds=function(){return r.slice()},a.copy=function(){return j9e().domain([e,t]).range(i).unknown(s)},dd.apply(xx(a),arguments)}function H9e(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[QN(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var a=t.indexOf(s);return[e[a-1],e[a]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return H9e().domain(e).range(t).unknown(n)},dd.apply(i,arguments)}function Sq(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function kq(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Tk(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function q9e(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=Dk(i),c=Ik(i),f=Dk(s),h=Ik(s),d=Dk(a),p=Ik(a),g=Dk(o),m=Ik(o),v=Dk(l),y=Ik(l),b={a:F,A:R,b:P,B:V,c:null,d:_2e,e:_2e,f:mpn,g:kpn,G:Apn,H:dpn,I:ppn,j:gpn,L:G9e,m:vpn,M:ypn,p:z,q,Q:E2e,s:A2e,S:bpn,u:xpn,U:wpn,V:$pn,w:Cpn,W:_pn,x:null,X:null,y:Spn,Y:Epn,Z:Tpn,"%":k2e},x={a:G,A:K,b:Y,B:te,c:null,d:S2e,e:S2e,f:Mpn,g:Vpn,G:Hpn,H:Dpn,I:Ipn,j:Npn,L:X9e,m:Fpn,M:Opn,p:Z,q:ae,Q:E2e,s:A2e,S:Rpn,u:Ppn,U:Lpn,V:Bpn,w:zpn,W:Upn,x:null,X:null,y:Wpn,Y:jpn,Z:qpn,"%":k2e},w={a:E,A:S,b:I,B:A,c:D,d:$2e,e:$2e,f:upn,g:w2e,G:x2e,H:C2e,I:C2e,j:spn,L:lpn,m:ipn,M:apn,p:k,q:rpn,Q:fpn,s:hpn,S:opn,u:Qdn,U:Jdn,V:epn,w:Zdn,W:tpn,x:T,X:N,y:w2e,Y:x2e,Z:npn,"%":cpn};b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x);function C(O,L){return function(W){var M=[],ue=-1,X=0,se=O.length,oe,pe,Ce;for(W instanceof Date||(W=new Date(+W));++ue<se;)O.charCodeAt(ue)===37&&(M.push(O.slice(X,ue)),(pe=b2e[oe=O.charAt(++ue)])!=null?oe=O.charAt(++ue):pe=oe==="e"?" ":"0",(Ce=L[oe])&&(oe=Ce(W,pe)),M.push(oe),X=ue+1);return M.push(O.slice(X,ue)),M.join("")}}function $(O,L){return function(W){var M=Tk(1900,void 0,1),ue=_(M,O,W+="",0),X,se;if(ue!=W.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(L&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(X=kq(Tk(M.y,0,1)),se=X.getUTCDay(),X=se>4||se===0?OL.ceil(X):OL(X),X=b0.offset(X,(M.V-1)*7),M.y=X.getUTCFullYear(),M.m=X.getUTCMonth(),M.d=X.getUTCDate()+(M.w+6)%7):(X=Sq(Tk(M.y,0,1)),se=X.getDay(),X=se>4||se===0?ML.ceil(X):ML(X),X=y0.offset(X,(M.V-1)*7),M.y=X.getFullYear(),M.m=X.getMonth(),M.d=X.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),se="Z"in M?kq(Tk(M.y,0,1)).getUTCDay():Sq(Tk(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(se+5)%7:M.w+M.U*7-(se+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,kq(M)):Sq(M)}}function _(O,L,W,M){for(var ue=0,X=L.length,se=W.length,oe,pe;ue<X;){if(M>=se)return-1;if(oe=L.charCodeAt(ue++),oe===37){if(oe=L.charAt(ue++),pe=w[oe in b2e?L.charAt(ue++):oe],!pe||(M=pe(O,W,M))<0)return-1}else if(oe!=W.charCodeAt(M++))return-1}return M}function k(O,L,W){var M=u.exec(L.slice(W));return M?(O.p=c.get(M[0].toLowerCase()),W+M[0].length):-1}function E(O,L,W){var M=d.exec(L.slice(W));return M?(O.w=p.get(M[0].toLowerCase()),W+M[0].length):-1}function S(O,L,W){var M=f.exec(L.slice(W));return M?(O.w=h.get(M[0].toLowerCase()),W+M[0].length):-1}function I(O,L,W){var M=v.exec(L.slice(W));return M?(O.m=y.get(M[0].toLowerCase()),W+M[0].length):-1}function A(O,L,W){var M=g.exec(L.slice(W));return M?(O.m=m.get(M[0].toLowerCase()),W+M[0].length):-1}function D(O,L,W){return _(O,t,L,W)}function T(O,L,W){return _(O,n,L,W)}function N(O,L,W){return _(O,r,L,W)}function F(O){return a[O.getDay()]}function R(O){return s[O.getDay()]}function P(O){return l[O.getMonth()]}function V(O){return o[O.getMonth()]}function z(O){return i[+(O.getHours()>=12)]}function q(O){return 1+~~(O.getMonth()/3)}function G(O){return a[O.getUTCDay()]}function K(O){return s[O.getUTCDay()]}function Y(O){return l[O.getUTCMonth()]}function te(O){return o[O.getUTCMonth()]}function Z(O){return i[+(O.getUTCHours()>=12)]}function ae(O){return 1+~~(O.getUTCMonth()/3)}return{format:function(O){var L=C(O+="",b);return L.toString=function(){return O},L},parse:function(O){var L=$(O+="",!1);return L.toString=function(){return O},L},utcFormat:function(O){var L=C(O+="",x);return L.toString=function(){return O},L},utcParse:function(O){var L=$(O+="",!0);return L.toString=function(){return O},L}}}var b2e={"-":"",_:" ",0:"0"},Ss=/^\s*\d+/,Ydn=/^%/,Xdn=/[\\^$*+?|[\]().{}]/g;function Sn(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function Kdn(e){return e.replace(Xdn,"\\$&")}function Dk(e){return new RegExp("^(?:"+e.map(Kdn).join("|")+")","i")}function Ik(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Zdn(e,t,n){var r=Ss.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Qdn(e,t,n){var r=Ss.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Jdn(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function epn(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function tpn(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function x2e(e,t,n){var r=Ss.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function w2e(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function npn(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function rpn(e,t,n){var r=Ss.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function ipn(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function $2e(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function spn(e,t,n){var r=Ss.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function C2e(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function apn(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function opn(e,t,n){var r=Ss.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function lpn(e,t,n){var r=Ss.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function upn(e,t,n){var r=Ss.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function cpn(e,t,n){var r=Ydn.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function fpn(e,t,n){var r=Ss.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function hpn(e,t,n){var r=Ss.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function _2e(e,t){return Sn(e.getDate(),t,2)}function dpn(e,t){return Sn(e.getHours(),t,2)}function ppn(e,t){return Sn(e.getHours()%12||12,t,2)}function gpn(e,t){return Sn(1+y0.count(rm(e),e),t,3)}function G9e(e,t){return Sn(e.getMilliseconds(),t,3)}function mpn(e,t){return G9e(e,t)+"000"}function vpn(e,t){return Sn(e.getMonth()+1,t,2)}function ypn(e,t){return Sn(e.getMinutes(),t,2)}function bpn(e,t){return Sn(e.getSeconds(),t,2)}function xpn(e){var t=e.getDay();return t===0?7:t}function wpn(e,t){return Sn(X_.count(rm(e)-1,e),t,2)}function Y9e(e){var t=e.getDay();return t>=4||t===0?b$(e):b$.ceil(e)}function $pn(e,t){return e=Y9e(e),Sn(b$.count(rm(e),e)+(rm(e).getDay()===4),t,2)}function Cpn(e){return e.getDay()}function _pn(e,t){return Sn(ML.count(rm(e)-1,e),t,2)}function Spn(e,t){return Sn(e.getFullYear()%100,t,2)}function kpn(e,t){return e=Y9e(e),Sn(e.getFullYear()%100,t,2)}function Epn(e,t){return Sn(e.getFullYear()%1e4,t,4)}function Apn(e,t){var n=e.getDay();return e=n>=4||n===0?b$(e):b$.ceil(e),Sn(e.getFullYear()%1e4,t,4)}function Tpn(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Sn(t/60|0,"0",2)+Sn(t%60,"0",2)}function S2e(e,t){return Sn(e.getUTCDate(),t,2)}function Dpn(e,t){return Sn(e.getUTCHours(),t,2)}function Ipn(e,t){return Sn(e.getUTCHours()%12||12,t,2)}function Npn(e,t){return Sn(1+b0.count(im(e),e),t,3)}function X9e(e,t){return Sn(e.getUTCMilliseconds(),t,3)}function Mpn(e,t){return X9e(e,t)+"000"}function Fpn(e,t){return Sn(e.getUTCMonth()+1,t,2)}function Opn(e,t){return Sn(e.getUTCMinutes(),t,2)}function Rpn(e,t){return Sn(e.getUTCSeconds(),t,2)}function Ppn(e){var t=e.getUTCDay();return t===0?7:t}function Lpn(e,t){return Sn(K_.count(im(e)-1,e),t,2)}function K9e(e){var t=e.getUTCDay();return t>=4||t===0?x$(e):x$.ceil(e)}function Bpn(e,t){return e=K9e(e),Sn(x$.count(im(e),e)+(im(e).getUTCDay()===4),t,2)}function zpn(e){return e.getUTCDay()}function Upn(e,t){return Sn(OL.count(im(e)-1,e),t,2)}function Wpn(e,t){return Sn(e.getUTCFullYear()%100,t,2)}function Vpn(e,t){return e=K9e(e),Sn(e.getUTCFullYear()%100,t,2)}function jpn(e,t){return Sn(e.getUTCFullYear()%1e4,t,4)}function Hpn(e,t){var n=e.getUTCDay();return e=n>=4||n===0?x$(e):x$.ceil(e),Sn(e.getUTCFullYear()%1e4,t,4)}function qpn(){return"+0000"}function k2e(){return"%"}function E2e(e){return+e}function A2e(e){return Math.floor(+e/1e3)}var g2,Ale,Z9e,Tle,Q9e;Gpn({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Gpn(e){return g2=q9e(e),Ale=g2.format,Z9e=g2.parse,Tle=g2.utcFormat,Q9e=g2.utcParse,g2}function Ypn(e){return new Date(e)}function Xpn(e){return e instanceof Date?+e:+new Date(+e)}function Dle(e,t,n,r,i,s,a,o,l,u){var c=I9e(),f=c.invert,h=c.domain,d=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),x=u("%Y");function w(C){return(l(C)<C?d:o(C)<C?p:a(C)<C?g:s(C)<C?m:r(C)<C?i(C)<C?v:y:n(C)<C?b:x)(C)}return c.invert=function(C){return new Date(f(C))},c.domain=function(C){return arguments.length?h(Array.from(C,Xpn)):h().map(Ypn)},c.ticks=function(C){var $=h();return e($[0],$[$.length-1],C==null?10:C)},c.tickFormat=function(C,$){return $==null?w:u($)},c.nice=function(C){var $=h();return(!C||typeof C.range!="function")&&(C=t($[0],$[$.length-1],C==null?10:C)),C?h(z9e($,C)):c},c.copy=function(){return RM(c,Dle(e,t,n,r,i,s,a,o,l,u))},c}function Kpn(){return dd.apply(Dle(Crn,_rn,rm,FL,X_,y0,Wae,Uae,t0,Ale).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Zpn(){return dd.apply(Dle(wrn,$rn,im,RL,K_,b0,Hae,jae,t0,Tle).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function xU(){var e=0,t=1,n,r,i,s,a=Ko,o=!1,l;function u(f){return f==null||isNaN(f=+f)?l:a(i===0?.5:(f=(s(f)-n)*i,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(a=f,u):a};function c(f){return function(h){var d,p;return arguments.length?([d,p]=h,a=f(d,p),u):[a(0),a(1)]}}return u.range=c(Jm),u.rangeRound=c(pM),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function iv(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Ile(){var e=xx(xU()(Ko));return e.copy=function(){return iv(e,Ile())},rv.apply(e,arguments)}function J9e(){var e=_le(xU()).domain([1,10]);return e.copy=function(){return iv(e,J9e()).base(e.base())},rv.apply(e,arguments)}function eUe(){var e=Sle(xU());return e.copy=function(){return iv(e,eUe()).constant(e.constant())},rv.apply(e,arguments)}function Nle(){var e=kle(xU());return e.copy=function(){return iv(e,Nle()).exponent(e.exponent())},rv.apply(e,arguments)}function Qpn(){return Nle.apply(null,arguments).exponent(.5)}function wU(){var e=0,t=.5,n=1,r=1,i,s,a,o,l,u=Ko,c,f=!1,h;function d(g){return isNaN(g=+g)?h:(g=.5+((g=+c(g))-s)*(r*g<r*s?o:l),u(f?Math.max(0,Math.min(1,g)):g))}d.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),s=c(t=+t),a=c(n=+n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d):[e,t,n]},d.clamp=function(g){return arguments.length?(f=!!g,d):f},d.interpolator=function(g){return arguments.length?(u=g,d):u};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,u=Use(g,[v,y,b]),d):[u(0),u(.5),u(1)]}}return d.range=p(Jm),d.rangeRound=p(pM),d.unknown=function(g){return arguments.length?(h=g,d):h},function(g){return c=g,i=g(e),s=g(t),a=g(n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d}}function tUe(){var e=xx(wU()(Ko));return e.copy=function(){return iv(e,tUe())},rv.apply(e,arguments)}function nUe(){var e=_le(wU()).domain([.1,1,10]);return e.copy=function(){return iv(e,nUe()).base(e.base())},rv.apply(e,arguments)}function rUe(){var e=Sle(wU());return e.copy=function(){return iv(e,rUe()).constant(e.constant())},rv.apply(e,arguments)}function Mle(){var e=kle(wU());return e.copy=function(){return iv(e,Mle()).exponent(e.exponent())},rv.apply(e,arguments)}function Jpn(){return Mle.apply(null,arguments).exponent(.5)}const Eq=new Date,Aq=new Date;function ji(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>ji(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(Eq.setTime(+s),Aq.setTime(+a),e(Eq),e(Aq),Math.floor(n(Eq,Aq))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const V3=ji(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);V3.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ji(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):V3);V3.range;const j3=1e3,pm=j3*60,H3=pm*60,q3=H3*24,iUe=q3*7,Fle=ji(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*j3)},(e,t)=>(t-e)/j3,e=>e.getUTCSeconds());Fle.range;const sUe=ji(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*j3)},(e,t)=>{e.setTime(+e+t*pm)},(e,t)=>(t-e)/pm,e=>e.getMinutes());sUe.range;const aUe=ji(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*pm)},(e,t)=>(t-e)/pm,e=>e.getUTCMinutes());aUe.range;const oUe=ji(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*j3-e.getMinutes()*pm)},(e,t)=>{e.setTime(+e+t*H3)},(e,t)=>(t-e)/H3,e=>e.getHours());oUe.range;const lUe=ji(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*H3)},(e,t)=>(t-e)/H3,e=>e.getUTCHours());lUe.range;const E4=ji(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*pm)/q3,e=>e.getDate()-1);E4.range;const A4=ji(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/q3,e=>e.getUTCDate()-1);A4.range;const egn=ji(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/q3,e=>Math.floor(e/q3));egn.range;function wx(e){return ji(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*pm)/iUe)}const uUe=wx(0),tgn=wx(1),ngn=wx(2),rgn=wx(3),ign=wx(4),sgn=wx(5),agn=wx(6);uUe.range;tgn.range;ngn.range;rgn.range;ign.range;sgn.range;agn.range;function $x(e){return ji(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/iUe)}const cUe=$x(0),ogn=$x(1),lgn=$x(2),ugn=$x(3),cgn=$x(4),fgn=$x(5),hgn=$x(6);cUe.range;ogn.range;lgn.range;ugn.range;cgn.range;fgn.range;hgn.range;const aQ=ji(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());aQ.range;const oQ=ji(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());oQ.range;const Ole=ji(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ole.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ji(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Ole.range;const Rle=ji(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Rle.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ji(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Rle.range;const Ple="year",Lle="quarter",Ble="month",zle="week",Ule="date",Wle="day",Vle="dayofyear",jle="hours",Hle="minutes",qle="seconds",Gle="milliseconds",dgn=[Ple,Lle,Ble,zle,Ule,Wle,Vle,jle,Hle,qle,Gle];dgn.reduce((e,t,n)=>(e[t]=1+n,e),{});Ple+"",Lle+"",aQ.every(3),Ble+"",zle+"",Ule+"",Wle+"",Vle+"",jle+"",Hle+"",qle+"",Gle+"";Ple+"",Lle+"",oQ.every(3),Ble+"",zle+"",Ule+"",Wle+"",Vle+"",jle+"",Hle+"",qle+"",Gle+"";function pgn(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const ggn="identity",Yle="linear",R$="log",Xle="pow",Kle="sqrt",Zle="symlog",mgn="time",vgn="utc",iS="sequential",PM="diverging",T2e="quantile",ygn="quantize",bgn="threshold",xgn="ordinal",wgn="point",$gn="band",Cgn="bin-ordinal",ks="continuous",$U="discrete",CU="discretizing",pf="interpolating",fUe="temporal";function _gn(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function Sgn(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,a,o,l,u;for(i<r&&(o=r,r=i,i=o),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(s<0&&(s=l),a=l);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[a]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function Qle(){const e=wle().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,a=!1,o=0,l=0,u=.5;delete e.unknown;function c(){const f=t().length,h=r[1]<r[0],d=r[1-h],p=pgn(f,o,l);let g=r[h-0];i=(d-g)/(p||1),a&&(i=Math.floor(i)),g+=(d-g-i*(f-o))*u,s=i*(1-o),a&&(g=Math.round(g),s=Math.round(s));const m=Ml(f).map(v=>g+i*v);return n(h?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),o=l,c()):o},e.paddingInner=function(f){return arguments.length?(o=Math.max(0,Math.min(1,f)),c()):o},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const h=r[1]<r[0],d=h?n().reverse():n(),p=d.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<d[0]||g>r[1-h])))return v=Math.max(0,aP(d,g)-1),y=g===m?v:aP(d,m)-1,g-d[v]>s+1e-10&&++v,h&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const h=e.invertRange([f,f]);return h&&h[0]},e.copy=function(){return Qle().domain(t()).range(r).round(a).paddingInner(o).paddingOuter(l).align(u)},c()}function hUe(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return hUe(t())},e}function kgn(){return hUe(Qle().paddingInner(1))}var Egn=Array.prototype.map;function Agn(e){return Egn.call(e,_dn)}const Tgn=Array.prototype.slice;function dUe(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(QN(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=Agn(r),n):e.slice()},n.range=function(r){return arguments.length?(t=Tgn.call(r),n):t.slice()},n.tickFormat=function(r,i){return P9e(e[0],D9e(e),r==null?10:r,i)},n.copy=function(){return dUe().domain(n.domain()).range(n.range())},n}const lQ={};function Dgn(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?_gn(s):s.invertExtent?Sgn(s):void 0),s.type=e,s};return r.metadata=Adn(Sdn(n)),r}function rr(e,t,n){return arguments.length>1?(lQ[e]=Dgn(e,t,n),this):Ign(e)?lQ[e]:void 0}rr(ggn,B9e);rr(Yle,L9e,ks);rr(R$,U9e,[ks,R$]);rr(Xle,Ele,ks);rr(Kle,Gdn,ks);rr(Zle,W9e,ks);rr(mgn,Kpn,[ks,fUe]);rr(vgn,Zpn,[ks,fUe]);rr(iS,Ile,[ks,pf]);rr("".concat(iS,"-").concat(Yle),Ile,[ks,pf]);rr("".concat(iS,"-").concat(R$),J9e,[ks,pf,R$]);rr("".concat(iS,"-").concat(Xle),Nle,[ks,pf]);rr("".concat(iS,"-").concat(Kle),Qpn,[ks,pf]);rr("".concat(iS,"-").concat(Zle),eUe,[ks,pf]);rr("".concat(PM,"-").concat(Yle),tUe,[ks,pf]);rr("".concat(PM,"-").concat(R$),nUe,[ks,pf,R$]);rr("".concat(PM,"-").concat(Xle),Mle,[ks,pf]);rr("".concat(PM,"-").concat(Kle),Jpn,[ks,pf]);rr("".concat(PM,"-").concat(Zle),rUe,[ks,pf]);rr(T2e,V9e,[CU,T2e]);rr(ygn,j9e,CU);rr(bgn,H9e,CU);rr(Cgn,dUe,[$U,CU]);rr(xgn,wle,$U);rr($gn,Qle,$U);rr(wgn,kgn,$U);function Ign(e){return Edn(lQ,e)}function Ngn(e,t){const n=t[0],r=D9e(t)-n;return function(i){return e(n+i*r)}}function pUe(e,t,n){return Use(gUe(t||"rgb",n),e)}function Mgn(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function gUe(e,t){const n=IXt[Fgn(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function Fgn(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const Ogn={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},Rgn={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function mUe(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function vUe(e,t){for(const n in e)yUe(n,t(e[n]))}const D2e={};vUe(Rgn,mUe);vUe(Ogn,e=>pUe(mUe(e)));function yUe(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(D2e[e]=t,this):D2e[e]}var Pgn=Math.abs,uQ=Math.cos,p6=Math.sin,Lgn=1e-6,bUe=Math.PI,cQ=bUe/2,I2e=Bgn(2);function N2e(e){return e>1?cQ:e<-1?-cQ:Math.asin(e)}function Bgn(e){return e>0?Math.sqrt(e):0}function zgn(e,t){var n=e*p6(t),r=30,i;do t-=i=(t+p6(t)-n)/(1+uQ(t));while(Pgn(i)>Lgn&&--r>0);return t/2}function Ugn(e,t,n){function r(i,s){return[e*i*uQ(s=zgn(n,s)),t*p6(s)]}return r.invert=function(i,s){return s=N2e(s/t),[i/(e*uQ(s)),N2e((2*s+p6(2*s))/n)]},r}var Wgn=Ugn(I2e/cQ,I2e,bUe);function Vgn(){return ld(Wgn).scale(169.529)}oBe();const jgn=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Hgn(e,t){return function n(){const r=t();return r.type=e,r.path=oBe().projection(r),r.copy=r.copy||function(){const i=n();return jgn.forEach(s=>{r[s]&&i[s](r[s]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function xUe(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(g6[e]=Hgn(e,t),this):g6[e]||null}const g6={albers:uBe,albersusa:RQt,azimuthalequalarea:PQt,azimuthalequidistant:LQt,conicconformal:UQt,conicequalarea:CL,conicequidistant:jQt,equalEarth:qQt,equirectangular:WQt,gnomonic:GQt,identity:YQt,mercator:BQt,mollweide:Vgn,naturalEarth1:XQt,orthographic:KQt,stereographic:ZQt,transversemercator:QQt};for(const e in g6)xUe(e,g6[e]);const qgn="RawCode",ub="Literal",Ggn="Property",Ygn="Identifier",Xgn="ArrayExpression",Kgn="BinaryExpression",wUe="CallExpression",Zgn="ConditionalExpression",Qgn="LogicalExpression",Jgn="MemberExpression",e0n="ObjectExpression",t0n="UnaryExpression";function gf(e){this.type=e}gf.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=n0n(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function n0n(e){switch(e.type){case Xgn:return e.elements;case Kgn:case Qgn:return[e.left,e.right];case wUe:return[e.callee].concat(e.arguments);case Zgn:return[e.test,e.consequent,e.alternate];case Jgn:return[e.object,e.property];case e0n:return e.properties;case Ggn:return[e.key,e.value];case t0n:return[e.argument];case Ygn:case ub:case qgn:default:return[]}}var pd,Ye,be,$a,zn,_U=1,LM=2,cb=3,sv=4,SU=5,Cx=6,Oo=7,BM=8,r0n=9;pd={};pd[_U]="Boolean";pd[LM]="<end>";pd[cb]="Identifier";pd[sv]="Keyword";pd[SU]="Null";pd[Cx]="Numeric";pd[Oo]="Punctuator";pd[BM]="String";pd[r0n]="RegularExpression";var i0n="ArrayExpression",s0n="BinaryExpression",a0n="CallExpression",o0n="ConditionalExpression",$Ue="Identifier",l0n="Literal",u0n="LogicalExpression",c0n="MemberExpression",f0n="ObjectExpression",h0n="Property",d0n="UnaryExpression",as="Unexpected token %0",p0n="Unexpected number",g0n="Unexpected string",m0n="Unexpected identifier",v0n="Unexpected reserved word",y0n="Unexpected end of input",fQ="Invalid regular expression",Tq="Invalid regular expression: missing /",CUe="Octal literals are not allowed in strict mode.",b0n="Duplicate data property in object literal not allowed in strict mode",Rs="ILLEGAL",G3="Disabled.",x0n=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),w0n=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function kU(e,t){if(!e)throw new Error("ASSERT: "+t)}function Wd(e){return e>=48&&e<=57}function Jle(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function kA(e){return"01234567".indexOf(e)>=0}function $0n(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Y3(e){return e===10||e===13||e===8232||e===8233}function zM(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&x0n.test(String.fromCharCode(e))}function m6(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&w0n.test(String.fromCharCode(e))}const C0n={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function _Ue(){for(;be<$a;){const e=Ye.charCodeAt(be);if($0n(e)||Y3(e))++be;else break}}function hQ(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)be<$a&&Jle(Ye[be])?(r=Ye[be++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):yn({},as,Rs);return String.fromCharCode(i)}function _0n(){var e,t,n,r;for(e=Ye[be],t=0,e==="}"&&yn({},as,Rs);be<$a&&(e=Ye[be++],!!Jle(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&yn({},as,Rs),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function SUe(){var e,t;for(e=Ye.charCodeAt(be++),t=String.fromCharCode(e),e===92&&(Ye.charCodeAt(be)!==117&&yn({},as,Rs),++be,e=hQ("u"),(!e||e==="\\"||!zM(e.charCodeAt(0)))&&yn({},as,Rs),t=e);be<$a&&(e=Ye.charCodeAt(be),!!m6(e));)++be,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Ye.charCodeAt(be)!==117&&yn({},as,Rs),++be,e=hQ("u"),(!e||e==="\\"||!m6(e.charCodeAt(0)))&&yn({},as,Rs),t+=e);return t}function S0n(){var e,t;for(e=be++;be<$a;){if(t=Ye.charCodeAt(be),t===92)return be=e,SUe();if(m6(t))++be;else break}return Ye.slice(e,be)}function k0n(){var e,t,n;return e=be,t=Ye.charCodeAt(be)===92?SUe():S0n(),t.length===1?n=cb:C0n.hasOwnProperty(t)?n=sv:t==="null"?n=SU:t==="true"||t==="false"?n=_U:n=cb,{type:n,value:t,start:e,end:be}}function Dq(){var e=be,t=Ye.charCodeAt(be),n,r=Ye[be],i,s,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++be,{type:Oo,value:String.fromCharCode(t),start:e,end:be};default:if(n=Ye.charCodeAt(be+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return be+=2,{type:Oo,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:be};case 33:case 61:return be+=2,Ye.charCodeAt(be)===61&&++be,{type:Oo,value:Ye.slice(e,be),start:e,end:be}}}if(a=Ye.substr(be,4),a===">>>=")return be+=4,{type:Oo,value:a,start:e,end:be};if(s=a.substr(0,3),s===">>>"||s==="<<="||s===">>=")return be+=3,{type:Oo,value:s,start:e,end:be};if(i=s.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return be+=2,{type:Oo,value:i,start:e,end:be};if(i==="//"&&yn({},as,Rs),"<>=!+-*%&|^/".indexOf(r)>=0)return++be,{type:Oo,value:r,start:e,end:be};yn({},as,Rs)}function E0n(e){let t="";for(;be<$a&&Jle(Ye[be]);)t+=Ye[be++];return t.length===0&&yn({},as,Rs),zM(Ye.charCodeAt(be))&&yn({},as,Rs),{type:Cx,value:parseInt("0x"+t,16),start:e,end:be}}function A0n(e){let t="0"+Ye[be++];for(;be<$a&&kA(Ye[be]);)t+=Ye[be++];return(zM(Ye.charCodeAt(be))||Wd(Ye.charCodeAt(be)))&&yn({},as,Rs),{type:Cx,value:parseInt(t,8),octal:!0,start:e,end:be}}function M2e(){var e,t,n;if(n=Ye[be],kU(Wd(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=be,e="",n!=="."){if(e=Ye[be++],n=Ye[be],e==="0"){if(n==="x"||n==="X")return++be,E0n(t);if(kA(n))return A0n(t);n&&Wd(n.charCodeAt(0))&&yn({},as,Rs)}for(;Wd(Ye.charCodeAt(be));)e+=Ye[be++];n=Ye[be]}if(n==="."){for(e+=Ye[be++];Wd(Ye.charCodeAt(be));)e+=Ye[be++];n=Ye[be]}if(n==="e"||n==="E")if(e+=Ye[be++],n=Ye[be],(n==="+"||n==="-")&&(e+=Ye[be++]),Wd(Ye.charCodeAt(be)))for(;Wd(Ye.charCodeAt(be));)e+=Ye[be++];else yn({},as,Rs);return zM(Ye.charCodeAt(be))&&yn({},as,Rs),{type:Cx,value:parseFloat(e),start:t,end:be}}function T0n(){var e="",t,n,r,i,s=!1;for(t=Ye[be],kU(t==="'"||t==='"',"String literal must starts with a quote"),n=be,++be;be<$a;)if(r=Ye[be++],r===t){t="";break}else if(r==="\\")if(r=Ye[be++],!r||!Y3(r.charCodeAt(0)))switch(r){case"u":case"x":Ye[be]==="{"?(++be,e+=_0n()):e+=hQ(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:kA(r)?(i="01234567".indexOf(r),i!==0&&(s=!0),be<$a&&kA(Ye[be])&&(s=!0,i=i*8+"01234567".indexOf(Ye[be++]),"0123".indexOf(r)>=0&&be<$a&&kA(Ye[be])&&(i=i*8+"01234567".indexOf(Ye[be++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&Ye[be]===`
`&&++be;else{if(Y3(r.charCodeAt(0)))break;e+=r}return t!==""&&yn({},as,Rs),{type:BM,value:e,octal:s,start:n,end:be}}function D0n(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";yn({},fQ)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{yn({},fQ)}try{return new RegExp(e,t)}catch{return null}}function I0n(){var e,t,n,r,i;for(e=Ye[be],kU(e==="/","Regular expression literal must start with a slash"),t=Ye[be++],n=!1,r=!1;be<$a;)if(e=Ye[be++],t+=e,e==="\\")e=Ye[be++],Y3(e.charCodeAt(0))&&yn({},Tq),t+=e;else if(Y3(e.charCodeAt(0)))yn({},Tq);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||yn({},Tq),i=t.substr(1,t.length-2),{value:i,literal:t}}function N0n(){var e,t,n;for(t="",n="";be<$a&&(e=Ye[be],!!m6(e.charCodeAt(0)));)++be,e==="\\"&&be<$a?yn({},as,Rs):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&yn({},fQ,n),{value:n,literal:t}}function M0n(){var e,t,n,r;return zn=null,_Ue(),e=be,t=I0n(),n=N0n(),r=D0n(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:be}}function F0n(e){return e.type===cb||e.type===sv||e.type===_U||e.type===SU}function kUe(){if(_Ue(),be>=$a)return{type:LM,start:be,end:be};const e=Ye.charCodeAt(be);return zM(e)?k0n():e===40||e===41||e===59?Dq():e===39||e===34?T0n():e===46?Wd(Ye.charCodeAt(be+1))?M2e():Dq():Wd(e)?M2e():Dq()}function Vo(){const e=zn;return be=e.end,zn=kUe(),be=e.end,e}function EUe(){const e=be;zn=kUe(),be=e}function O0n(e){const t=new gf(i0n);return t.elements=e,t}function F2e(e,t,n){const r=new gf(e==="||"||e==="&&"?u0n:s0n);return r.operator=e,r.left=t,r.right=n,r}function R0n(e,t){const n=new gf(a0n);return n.callee=e,n.arguments=t,n}function P0n(e,t,n){const r=new gf(o0n);return r.test=e,r.consequent=t,r.alternate=n,r}function eue(e){const t=new gf($Ue);return t.name=e,t}function WE(e){const t=new gf(l0n);return t.value=e.value,t.raw=Ye.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function O2e(e,t,n){const r=new gf(c0n);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function L0n(e){const t=new gf(f0n);return t.properties=e,t}function R2e(e,t,n){const r=new gf(h0n);return r.key=t,r.value=n,r.kind=e,r}function B0n(e,t){const n=new gf(d0n);return n.operator=e,n.argument=t,n.prefix=!0,n}function yn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(s,a)=>(kU(a<r.length,"Message reference must be in range"),r[a]));throw n=new Error(i),n.index=be,n.description=i,n}function EU(e){e.type===LM&&yn(e,y0n),e.type===Cx&&yn(e,p0n),e.type===BM&&yn(e,g0n),e.type===cb&&yn(e,m0n),e.type===sv&&yn(e,v0n),yn(e,as,e.value)}function Ca(e){const t=Vo();(t.type!==Oo||t.value!==e)&&EU(t)}function pr(e){return zn.type===Oo&&zn.value===e}function Iq(e){return zn.type===sv&&zn.value===e}function z0n(){const e=[];for(be=zn.start,Ca("[");!pr("]");)pr(",")?(Vo(),e.push(null)):(e.push(fb()),pr("]")||Ca(","));return Vo(),O0n(e)}function P2e(){be=zn.start;const e=Vo();return e.type===BM||e.type===Cx?(e.octal&&yn(e,CUe),WE(e)):eue(e.value)}function U0n(){var e,t,n,r;if(be=zn.start,e=zn,e.type===cb)return n=P2e(),Ca(":"),r=fb(),R2e("init",n,r);if(e.type===LM||e.type===Oo)EU(e);else return t=P2e(),Ca(":"),r=fb(),R2e("init",t,r)}function W0n(){var e=[],t,n,r,i={},s=String;for(be=zn.start,Ca("{");!pr("}");)t=U0n(),t.key.type===$Ue?n=t.key.name:n=s(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?yn({},b0n):i[r]=!0,e.push(t),pr("}")||Ca(",");return Ca("}"),L0n(e)}function V0n(){Ca("(");const e=tue();return Ca(")"),e}const j0n={if:1};function H0n(){var e,t,n;if(pr("("))return V0n();if(pr("["))return z0n();if(pr("{"))return W0n();if(e=zn.type,be=zn.start,e===cb||j0n[zn.value])n=eue(Vo().value);else if(e===BM||e===Cx)zn.octal&&yn(zn,CUe),n=WE(Vo());else{if(e===sv)throw new Error(G3);e===_U?(t=Vo(),t.value=t.value==="true",n=WE(t)):e===SU?(t=Vo(),t.value=null,n=WE(t)):pr("/")||pr("/=")?(n=WE(M0n()),EUe()):EU(Vo())}return n}function q0n(){const e=[];if(Ca("("),!pr(")"))for(;be<$a&&(e.push(fb()),!pr(")"));)Ca(",");return Ca(")"),e}function G0n(){be=zn.start;const e=Vo();return F0n(e)||EU(e),eue(e.value)}function Y0n(){return Ca("."),G0n()}function X0n(){Ca("[");const e=tue();return Ca("]"),e}function K0n(){var e,t,n;for(e=H0n();;)if(pr("."))n=Y0n(),e=O2e(".",e,n);else if(pr("("))t=q0n(),e=R0n(e,t);else if(pr("["))n=X0n(),e=O2e("[",e,n);else break;return e}function L2e(){const e=K0n();if(zn.type===Oo&&(pr("++")||pr("--")))throw new Error(G3);return e}function T4(){var e,t;if(zn.type!==Oo&&zn.type!==sv)t=L2e();else{if(pr("++")||pr("--"))throw new Error(G3);if(pr("+")||pr("-")||pr("~")||pr("!"))e=Vo(),t=T4(),t=B0n(e.value,t);else{if(Iq("delete")||Iq("void")||Iq("typeof"))throw new Error(G3);t=L2e()}}return t}function B2e(e){let t=0;if(e.type!==Oo&&e.type!==sv)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Z0n(){var e,t,n,r,i,s,a,o,l,u;if(e=zn,l=T4(),r=zn,i=B2e(r),i===0)return l;for(r.prec=i,Vo(),t=[e,zn],a=T4(),s=[l,r,a];(i=B2e(zn))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)a=s.pop(),o=s.pop().value,l=s.pop(),t.pop(),n=F2e(o,l,a),s.push(n);r=Vo(),r.prec=i,s.push(r),t.push(zn),n=T4(),s.push(n)}for(u=s.length-1,n=s[u],t.pop();u>1;)t.pop(),n=F2e(s[u-1].value,s[u-2],n),u-=2;return n}function fb(){var e,t,n;return e=Z0n(),pr("?")&&(Vo(),t=fb(),Ca(":"),n=fb(),e=P0n(e,t,n)),e}function tue(){const e=fb();if(pr(","))throw new Error(G3);return e}function Q0n(e){Ye=e,be=0,$a=Ye.length,zn=null,EUe();const t=tue();if(zn.type!==LM)throw new Error("Unexpect token after expression.");return t}var AUe={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function TUe(e){function t(a,o,l,u){let c=e(o[0]);return l&&(c=l+"("+c+")",l.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(u<0?"":u===0?"()":"("+o.slice(1).map(e).join(",")+")")}function n(a,o,l){return u=>t(a,u,o,l)}const r="new Date",i="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&$e("Missing arguments to clamp function."),a.length>3&&$e("Too many arguments to clamp function.");const o=a.map(e);return"Math.max("+o[1]+", Math.min("+o[2]+","+o[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:s,test:n("test",s),if:function(a){a.length<3&&$e("Missing arguments to if function."),a.length>3&&$e("Too many arguments to if function.");const o=a.map(e);return"("+o[0]+"?"+o[1]+":"+o[2]+")"}}}function J0n(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function emn(e){e=e||{};const t=e.allowed?Oh(e.allowed):{},n=e.forbidden?Oh(e.forbidden):{},r=e.constants||AUe,i=(e.functions||TUe)(f),s=e.globalvar,a=e.fieldvar,o=Ut(s)?s:p=>`${s}["${p}"]`;let l={},u={},c=0;function f(p){if(wr(p))return p;const g=h[p.type];return g==null&&$e("Unsupported type: "+p.type),g(p)}const h={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:bt(n,g)?$e("Illegal identifier: "+g):bt(r,g)?r[g]:bt(t,g)?g:(l[g]=1,o(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const v=f(p.property);return m===a&&(u[J0n(v)]=1),g&&(c-=1),m+(g?"."+v:"["+v+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&$e("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,v=bt(i,g)&&i[g];return v||$e("Unrecognized function: "+g),Ut(v)?v(m):v+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function d(p){const g={code:f(p),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},g}return d.functions=i,d.constants=r,d}class $0{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],a=t+s,o=Math.abs(t)<Math.abs(s)?t-(a-s):s-(a-t);o&&(n[r++]=o),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,s=i-(a-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=a+i,i==r-a&&(a=r))}return a}}function tmn(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}var v6=1e-6,z2e=1e-12,UM=Math.PI,U2e=UM/2,DUe=UM/4,W2e=UM*2,EA=180/UM,Na=UM/180,nue=Math.abs,AU=Math.atan2,yo=Math.cos,dQ=Math.hypot,bo=Math.sin,IUe=Math.sqrt;function rue(e){return e>1?U2e:e<-1?-U2e:Math.asin(e)}function VE(){}function y6(e,t){e&&j2e.hasOwnProperty(e.type)&&j2e[e.type](e,t)}var V2e={Feature:function(e,t){y6(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)y6(n[r].geometry,t)}},j2e={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){pQ(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)pQ(n[r],t,0)},Polygon:function(e,t){H2e(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)H2e(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)y6(n[r],t)}};function pQ(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function H2e(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)pQ(e[n],t,1);t.polygonEnd()}function iue(e,t){e&&V2e.hasOwnProperty(e.type)?V2e[e.type](e,t):y6(e,t)}var b6=new $0,x6=new $0,NUe,MUe,gQ,mQ,vQ,jh={point:VE,lineStart:VE,lineEnd:VE,polygonStart:function(){b6=new $0,jh.lineStart=nmn,jh.lineEnd=rmn},polygonEnd:function(){var e=+b6;x6.add(e<0?W2e+e:e),this.lineStart=this.lineEnd=this.point=VE},sphere:function(){x6.add(W2e)}};function nmn(){jh.point=imn}function rmn(){FUe(NUe,MUe)}function imn(e,t){jh.point=FUe,NUe=e,MUe=t,e*=Na,t*=Na,gQ=e,mQ=yo(t=t/2+DUe),vQ=bo(t)}function FUe(e,t){e*=Na,t*=Na,t=t/2+DUe;var n=e-gQ,r=n>=0?1:-1,i=r*n,s=yo(t),a=bo(t),o=vQ*a,l=mQ*s+o*yo(i),u=o*r*bo(i);b6.add(AU(u,l)),gQ=e,mQ=s,vQ=a}function smn(e){return x6=new $0,iue(e,jh),x6*2}function amn(e){return[AU(e[1],e[0]),rue(e[2])]}function omn(e){var t=e[0],n=e[1],r=yo(n);return[r*yo(t),r*bo(t),bo(n)]}function q2e(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function lmn(e){var t=IUe(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Rr,zo,jr,Sl,e1,OUe,RUe,fw,AA,Pg,qp,Vd={point:yQ,lineStart:G2e,lineEnd:Y2e,polygonStart:function(){Vd.point=LUe,Vd.lineStart=umn,Vd.lineEnd=cmn,AA=new $0,jh.polygonStart()},polygonEnd:function(){jh.polygonEnd(),Vd.point=yQ,Vd.lineStart=G2e,Vd.lineEnd=Y2e,b6<0?(Rr=-(jr=180),zo=-(Sl=90)):AA>v6?Sl=90:AA<-v6&&(zo=-90),qp[0]=Rr,qp[1]=jr},sphere:function(){Rr=-(jr=180),zo=-(Sl=90)}};function yQ(e,t){Pg.push(qp=[Rr=e,jr=e]),t<zo&&(zo=t),t>Sl&&(Sl=t)}function PUe(e,t){var n=omn([e*Na,t*Na]);if(fw){var r=q2e(fw,n),i=[r[1],-r[0],0],s=q2e(i,r);lmn(s),s=amn(s);var a=e-e1,o=a>0?1:-1,l=s[0]*EA*o,u,c=nue(a)>180;c^(o*e1<l&&l<o*e)?(u=s[1]*EA,u>Sl&&(Sl=u)):(l=(l+360)%360-180,c^(o*e1<l&&l<o*e)?(u=-s[1]*EA,u<zo&&(zo=u)):(t<zo&&(zo=t),t>Sl&&(Sl=t))),c?e<e1?Cl(Rr,e)>Cl(Rr,jr)&&(jr=e):Cl(e,jr)>Cl(Rr,jr)&&(Rr=e):jr>=Rr?(e<Rr&&(Rr=e),e>jr&&(jr=e)):e>e1?Cl(Rr,e)>Cl(Rr,jr)&&(jr=e):Cl(e,jr)>Cl(Rr,jr)&&(Rr=e)}else Pg.push(qp=[Rr=e,jr=e]);t<zo&&(zo=t),t>Sl&&(Sl=t),fw=n,e1=e}function G2e(){Vd.point=PUe}function Y2e(){qp[0]=Rr,qp[1]=jr,Vd.point=yQ,fw=null}function LUe(e,t){if(fw){var n=e-e1;AA.add(nue(n)>180?n+(n>0?360:-360):n)}else OUe=e,RUe=t;jh.point(e,t),PUe(e,t)}function umn(){jh.lineStart()}function cmn(){LUe(OUe,RUe),jh.lineEnd(),nue(AA)>v6&&(Rr=-(jr=180)),qp[0]=Rr,qp[1]=jr,fw=null}function Cl(e,t){return(t-=e)<0?t+360:t}function fmn(e,t){return e[0]-t[0]}function X2e(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function hmn(e){var t,n,r,i,s,a,o;if(Sl=jr=-(Rr=zo=1/0),Pg=[],iue(e,Vd),n=Pg.length){for(Pg.sort(fmn),t=1,r=Pg[0],s=[r];t<n;++t)i=Pg[t],X2e(r,i[0])||X2e(r,i[1])?(Cl(r[0],i[1])>Cl(r[0],r[1])&&(r[1]=i[1]),Cl(i[0],r[1])>Cl(r[0],r[1])&&(r[0]=i[0])):s.push(r=i);for(a=-1/0,n=s.length-1,t=0,r=s[n];t<=n;r=i,++t)i=s[t],(o=Cl(r[1],i[0]))>a&&(a=o,Rr=i[0],jr=r[1])}return Pg=qp=null,Rr===1/0||zo===1/0?[[NaN,NaN],[NaN,NaN]]:[[Rr,zo],[jr,Sl]]}var jE,w6,$6,C6,_6,S6,k6,E6,bQ,xQ,wQ,BUe,zUe,Ka,Za,Qa,Fc={sphere:VE,point:sue,lineStart:K2e,lineEnd:Z2e,polygonStart:function(){Fc.lineStart=gmn,Fc.lineEnd=mmn},polygonEnd:function(){Fc.lineStart=K2e,Fc.lineEnd=Z2e}};function sue(e,t){e*=Na,t*=Na;var n=yo(t);WM(n*yo(e),n*bo(e),bo(t))}function WM(e,t,n){++jE,$6+=(e-$6)/jE,C6+=(t-C6)/jE,_6+=(n-_6)/jE}function K2e(){Fc.point=dmn}function dmn(e,t){e*=Na,t*=Na;var n=yo(t);Ka=n*yo(e),Za=n*bo(e),Qa=bo(t),Fc.point=pmn,WM(Ka,Za,Qa)}function pmn(e,t){e*=Na,t*=Na;var n=yo(t),r=n*yo(e),i=n*bo(e),s=bo(t),a=AU(IUe((a=Za*s-Qa*i)*a+(a=Qa*r-Ka*s)*a+(a=Ka*i-Za*r)*a),Ka*r+Za*i+Qa*s);w6+=a,S6+=a*(Ka+(Ka=r)),k6+=a*(Za+(Za=i)),E6+=a*(Qa+(Qa=s)),WM(Ka,Za,Qa)}function Z2e(){Fc.point=sue}function gmn(){Fc.point=vmn}function mmn(){UUe(BUe,zUe),Fc.point=sue}function vmn(e,t){BUe=e,zUe=t,e*=Na,t*=Na,Fc.point=UUe;var n=yo(t);Ka=n*yo(e),Za=n*bo(e),Qa=bo(t),WM(Ka,Za,Qa)}function UUe(e,t){e*=Na,t*=Na;var n=yo(t),r=n*yo(e),i=n*bo(e),s=bo(t),a=Za*s-Qa*i,o=Qa*r-Ka*s,l=Ka*i-Za*r,u=dQ(a,o,l),c=rue(u),f=u&&-c/u;bQ.add(f*a),xQ.add(f*o),wQ.add(f*l),w6+=c,S6+=c*(Ka+(Ka=r)),k6+=c*(Za+(Za=i)),E6+=c*(Qa+(Qa=s)),WM(Ka,Za,Qa)}function ymn(e){jE=w6=$6=C6=_6=S6=k6=E6=0,bQ=new $0,xQ=new $0,wQ=new $0,iue(e,Fc);var t=+bQ,n=+xQ,r=+wQ,i=dQ(t,n,r);return i<z2e&&(t=S6,n=k6,r=E6,w6<v6&&(t=$6,n=C6,r=_6),i=dQ(t,n,r),i<z2e)?[NaN,NaN]:[AU(n,t)*EA,rue(r/i)*EA]}function VM(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function TU(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function _x(){}var X3=.7,A6=1/X3,hw="\\s*([+-]?\\d+)\\s*",K3="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bmn=/^#([0-9a-f]{3,8})$/,xmn=new RegExp(`^rgb\\(${hw},${hw},${hw}\\)$`),wmn=new RegExp(`^rgb\\(${gh},${gh},${gh}\\)$`),$mn=new RegExp(`^rgba\\(${hw},${hw},${hw},${K3}\\)$`),Cmn=new RegExp(`^rgba\\(${gh},${gh},${gh},${K3}\\)$`),_mn=new RegExp(`^hsl\\(${K3},${gh},${gh}\\)$`),Smn=new RegExp(`^hsla\\(${K3},${gh},${gh},${K3}\\)$`),Q2e={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};VM(_x,aue,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:J2e,formatHex:J2e,formatHex8:kmn,formatHsl:Emn,formatRgb:ewe,toString:ewe});function J2e(){return this.rgb().formatHex()}function kmn(){return this.rgb().formatHex8()}function Emn(){return VUe(this).formatHsl()}function ewe(){return this.rgb().formatRgb()}function aue(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=bmn.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?twe(t):n===3?new ma(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?dR(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?dR(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=xmn.exec(e))?new ma(t[1],t[2],t[3],1):(t=wmn.exec(e))?new ma(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=$mn.exec(e))?dR(t[1],t[2],t[3],t[4]):(t=Cmn.exec(e))?dR(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=_mn.exec(e))?iwe(t[1],t[2]/100,t[3]/100,1):(t=Smn.exec(e))?iwe(t[1],t[2]/100,t[3]/100,t[4]):Q2e.hasOwnProperty(e)?twe(Q2e[e]):e==="transparent"?new ma(NaN,NaN,NaN,0):null}function twe(e){return new ma(e>>16&255,e>>8&255,e&255,1)}function dR(e,t,n,r){return r<=0&&(e=t=n=NaN),new ma(e,t,n,r)}function WUe(e){return e instanceof _x||(e=aue(e)),e?(e=e.rgb(),new ma(e.r,e.g,e.b,e.opacity)):new ma}function oue(e,t,n,r){return arguments.length===1?WUe(e):new ma(e,t,n,r==null?1:r)}function ma(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}VM(ma,oue,TU(_x,{brighter(e){return e=e==null?A6:Math.pow(A6,e),new ma(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?X3:Math.pow(X3,e),new ma(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ma(hy(this.r),hy(this.g),hy(this.b),T6(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:nwe,formatHex:nwe,formatHex8:Amn,formatRgb:rwe,toString:rwe}));function nwe(){return`#${z1(this.r)}${z1(this.g)}${z1(this.b)}`}function Amn(){return`#${z1(this.r)}${z1(this.g)}${z1(this.b)}${z1((isNaN(this.opacity)?1:this.opacity)*255)}`}function rwe(){const e=T6(this.opacity);return`${e===1?"rgb(":"rgba("}${hy(this.r)}, ${hy(this.g)}, ${hy(this.b)}${e===1?")":`, ${e})`}`}function T6(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function hy(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function z1(e){return e=hy(e),(e<16?"0":"")+e.toString(16)}function iwe(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Tc(e,t,n,r)}function VUe(e){if(e instanceof Tc)return new Tc(e.h,e.s,e.l,e.opacity);if(e instanceof _x||(e=aue(e)),!e)return new Tc;if(e instanceof Tc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new Tc(a,o,l,e.opacity)}function jUe(e,t,n,r){return arguments.length===1?VUe(e):new Tc(e,t,n,r==null?1:r)}function Tc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}VM(Tc,jUe,TU(_x,{brighter(e){return e=e==null?A6:Math.pow(A6,e),new Tc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?X3:Math.pow(X3,e),new Tc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ma(Nq(e>=240?e-240:e+120,i,r),Nq(e,i,r),Nq(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Tc(swe(this.h),pR(this.s),pR(this.l),T6(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=T6(this.opacity);return`${e===1?"hsl(":"hsla("}${swe(this.h)}, ${pR(this.s)*100}%, ${pR(this.l)*100}%${e===1?")":`, ${e})`}`}}));function swe(e){return e=(e||0)%360,e<0?e+360:e}function pR(e){return Math.max(0,Math.min(1,e||0))}function Nq(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Tmn=Math.PI/180,Dmn=180/Math.PI,D6=18,HUe=.96422,qUe=1,GUe=.82521,YUe=4/29,dw=6/29,XUe=3*dw*dw,Imn=dw*dw*dw;function KUe(e){if(e instanceof mh)return new mh(e.l,e.a,e.b,e.opacity);if(e instanceof up)return JUe(e);e instanceof ma||(e=WUe(e));var t=Rq(e.r),n=Rq(e.g),r=Rq(e.b),i=Mq((.2225045*t+.7168786*n+.0606169*r)/qUe),s,a;return t===n&&n===r?s=a=i:(s=Mq((.4360747*t+.3850649*n+.1430804*r)/HUe),a=Mq((.0139322*t+.0971045*n+.7141733*r)/GUe)),new mh(116*i-16,500*(s-i),200*(i-a),e.opacity)}function ZUe(e,t,n,r){return arguments.length===1?KUe(e):new mh(e,t,n,r==null?1:r)}function mh(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}VM(mh,ZUe,TU(_x,{brighter(e){return new mh(this.l+D6*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new mh(this.l-D6*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=HUe*Fq(t),e=qUe*Fq(e),n=GUe*Fq(n),new ma(Oq(3.1338561*t-1.6168667*e-.4906146*n),Oq(-.9787684*t+1.9161415*e+.033454*n),Oq(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Mq(e){return e>Imn?Math.pow(e,1/3):e/XUe+YUe}function Fq(e){return e>dw?e*e*e:XUe*(e-YUe)}function Oq(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Rq(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Nmn(e){if(e instanceof up)return new up(e.h,e.c,e.l,e.opacity);if(e instanceof mh||(e=KUe(e)),e.a===0&&e.b===0)return new up(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Dmn;return new up(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function QUe(e,t,n,r){return arguments.length===1?Nmn(e):new up(e,t,n,r==null?1:r)}function up(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function JUe(e){if(isNaN(e.h))return new mh(e.l,0,0,e.opacity);var t=e.h*Tmn;return new mh(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}VM(up,QUe,TU(_x,{brighter(e){return new up(this.h,this.c,this.l+D6*(e==null?1:e),this.opacity)},darker(e){return new up(this.h,this.c,this.l-D6*(e==null?1:e),this.opacity)},rgb(){return JUe(this).rgb()}}));function Pq(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Mmn(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Fmn(e){let t,n,r;e.length!==2?(t=Pq,n=(o,l)=>Pq(e(o),l),r=(o,l)=>e(o)-l):(t=e===Pq||e===Mmn?e:Omn,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function Omn(){return 0}function Rmn(e,...t){e=new J5(e),t=t.map(Pmn);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e}function Pmn(e){return e instanceof J5?e:new J5(e)}function Lmn(...e){const t=new J5;for(const n of e)for(const r of n)t.add(r);return t}const lue="intersect",awe="union",Bmn="vlMulti",zmn="vlPoint",owe="or",Umn="and",Pf="_vgsid_",Z3=Hl(Pf),Wmn="E",Vmn="R",jmn="R-E",Hmn="R-LE",qmn="R-RE",I6="index:unit";function lwe(e,t){for(var n=t.fields,r=t.values,i=n.length,s=0,a,o;s<i;++s)if(o=n[s],o.getter=Hl.getter||Hl(o.field),a=o.getter(e),ty(a)&&(a=io(a)),ty(r[s])&&(r[s]=io(r[s])),ty(r[s][0])&&(r[s]=r[s].map(io)),o.type===Wmn){if(at(r[s])?r[s].indexOf(a)<0:a!==r[s])return!1}else if(o.type===Vmn){if(!oE(a,r[s]))return!1}else if(o.type===qmn){if(!oE(a,r[s],!0,!1))return!1}else if(o.type===jmn){if(!oE(a,r[s],!1,!1))return!1}else if(o.type===Hmn&&!oE(a,r[s],!1,!0))return!1;return!0}function eWe(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],s=r?r[I6]&&r[I6].value:void 0,a=n===lue,o=i.length,l=0,u,c,f,h,d;l<o;++l)if(u=i[l],s&&a){if(c=c||{},f=c[h=u.unit]||0,f===-1)continue;if(d=lwe(t,u),c[h]=d?-1:++f,d&&s.size===1)return!0;if(!d&&f===s.get(h).count)return!1}else if(d=lwe(t,u),a^d)return d;return o&&a}const tWe=Fmn(Z3),Gmn=tWe.left,Ymn=tWe.right;function nWe(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],s=r?r[I6]&&r[I6].value:void 0,a=n===lue,o=Z3(t),l=Gmn(i,o);if(l===i.length||Z3(i[l])!==o)return!1;if(s&&a){if(s.size===1)return!0;if(Ymn(i,o)-l<s.size)return!1}return!0}function rWe(e,t){return e.map(n=>zt(t.fields?{values:t.fields.map(r=>(r.getter||(r.getter=Hl(r.field)))(n.datum))}:{[Pf]:Z3(n.datum)},t))}function iWe(e,t,n,r){for(var i=this.context.data[e],s=i?i.values.value:[],a={},o={},l={},u,c,f,h,d,p,g,m,v,y,b=s.length,x=0,w,C;x<b;++x)if(u=s[x],h=u.unit,c=u.fields,f=u.values,c&&f){for(w=0,C=c.length;w<C;++w)d=c[w],g=a[d.field]||(a[d.field]={}),m=g[h]||(g[h]=[]),l[d.field]=v=d.type.charAt(0),y=Lq[`${v}_union`],g[h]=y(m,ct(f[w]));n&&(m=o[h]||(o[h]=[]),m.push(ct(f).reduce(($,_,k)=>($[c[k].field]=_,$),{})))}else d=Pf,p=Z3(u),g=a[d]||(a[d]={}),m=g[h]||(g[h]=[]),m.push(p),n&&(m=o[h]||(o[h]=[]),m.push({[Pf]:p}));if(t=t||awe,a[Pf]?a[Pf]=Lq[`${Pf}_${t}`](...Object.values(a[Pf])):Object.keys(a).forEach($=>{a[$]=Object.keys(a[$]).map(_=>a[$][_]).reduce((_,k)=>_===void 0?k:Lq[`${l[$]}_${t}`](_,k))}),s=Object.keys(o),n&&s.length){const $=r?zmn:Bmn;a[$]=t===awe?{[owe]:s.reduce((_,k)=>(_.push(...o[k]),_),[])}:{[Umn]:s.map(_=>({[owe]:o[_]}))}}return a}var Lq={[`${Pf}_union`]:Lmn,[`${Pf}_intersect`]:Rmn,E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=io(t[0]),r=io(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=io(t[0]),r=io(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const Xmn=":",Kmn="@";function sS(e,t,n,r){t[0].type!==ub&&$e("First argument to selection functions must be a string literal.");const i=t[0].value,s=t.length>=2&&ln(t).value,a="unit",o=Kmn+a,l=Xmn+i;s===lue&&!bt(r,o)&&(r[o]=n.getData(i).indataRef(n,a)),bt(r,l)||(r[l]=n.getData(i).tuplesRef())}function sWe(e){const t=this.context.data[e];return t?t.values.value:[]}function Zmn(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function Qmn(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(Jc).insert(t)),1}function Jmn(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const jM=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},evn=jM("format"),aWe=jM("timeFormat"),tvn=jM("utcFormat"),nvn=jM("timeParse"),rvn=jM("utcParse"),gR=new Date(2e3,0,1);function DU(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(gR.setYear(2e3),gR.setMonth(e),gR.setDate(t),aWe.call(this,gR,n))}function ivn(e){return DU.call(this,e,1,"%B")}function svn(e){return DU.call(this,e,1,"%b")}function avn(e){return DU.call(this,0,2+e,"%A")}function ovn(e){return DU.call(this,0,2+e,"%a")}const lvn=":",uvn="@",$Q="%",oWe="$";function uue(e,t,n,r){t[0].type!==ub&&$e("First argument to data functions must be a string literal.");const i=t[0].value,s=lvn+i;if(!bt(s,r))try{r[s]=n.getData(i).tuplesRef()}catch{}}function cvn(e,t,n,r){t[0].type!==ub&&$e("First argument to indata must be a string literal."),t[1].type!==ub&&$e("Second argument to indata must be a string literal.");const i=t[0].value,s=t[1].value,a=uvn+s;bt(a,r)||(r[a]=n.getData(i).indataRef(n,s))}function tl(e,t,n,r){if(t[0].type===ub)uwe(n,r,t[0].value);else for(e in n.scales)uwe(n,r,e)}function uwe(e,t,n){const r=$Q+n;if(!bt(t,r))try{t[r]=e.scaleRef(n)}catch{}}function hg(e,t){if(Ut(e))return e;if(wr(e)){const n=t.scales[e];return n&&sHt(n.value)?n.value:void 0}}function fvn(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=tl,n._range=tl,n._scale=tl;const r=i=>"_["+(i.type===ub?ot($Q+i.value):ot($Q)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function cue(e,t){return function(n,r,i){if(n){const s=hg(n,(i||this).context);return s&&s.path[e](r)}else return t(r)}}const hvn=cue("area",smn),dvn=cue("bounds",hmn),pvn=cue("centroid",ymn);function gvn(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function fue(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function mvn(){return fue(this.context.dataflow,"warn",arguments)}function vvn(){return fue(this.context.dataflow,"info",arguments)}function yvn(){return fue(this.context.dataflow,"debug",arguments)}function Bq(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function CQ(e){const t=oue(e),n=Bq(t.r),r=Bq(t.g),i=Bq(t.b);return .2126*n+.7152*r+.0722*i}function bvn(e,t){const n=CQ(e),r=CQ(t),i=Math.max(n,r),s=Math.min(n,r);return(i+.05)/(s+.05)}function xvn(){const e=[].slice.call(arguments);return e.unshift({}),zt(...e)}function lWe(e,t){return e===t||e!==e&&t!==t?!0:at(e)?at(t)&&e.length===t.length?wvn(e,t):!1:Ft(e)&&Ft(t)?uWe(e,t):!1}function wvn(e,t){for(let n=0,r=e.length;n<r;++n)if(!lWe(e[n],t[n]))return!1;return!0}function uWe(e,t){for(const n in e)if(!lWe(e[n],t[n]))return!1;return!0}function cwe(e){return t=>uWe(e,t)}function $vn(e,t,n,r,i,s){const a=this.context.dataflow,o=this.context.data[e],l=o.input,u=a.stamp();let c=o.changes,f,h;if(a._trigger===!1||!(l.value.length||t||r))return 0;if((!c||c.stamp<u)&&(o.changes=c=a.changeset(),c.stamp=u,a.runAfter(()=>{o.modified=!0,a.pulse(l,c).run()},!0,1)),n&&(f=n===!0?Jc:at(n)||P_(n)?n:cwe(n),c.remove(f)),t&&c.insert(t),r&&(f=cwe(r),l.value.some(f)?c.remove(f):c.insert(r)),i)for(h in s)c.modify(i,h,s[h]);return 1}function Cvn(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)}function _vn(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const fwe={};function Svn(e,t){const n=fwe[t]||(fwe[t]=Hl(t));return at(e)?e.map(n):n(e)}function hue(e){return at(e)||ArrayBuffer.isView(e)?e:null}function due(e){return hue(e)||(wr(e)?e:null)}function kvn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return hue(e).join(...n)}function Evn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return due(e).indexOf(...n)}function Avn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return due(e).lastIndexOf(...n)}function Tvn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return due(e).slice(...n)}function Dvn(e,t,n){return Ut(n)&&$e("Function argument passed to replace."),String(e).replace(t,n)}function Ivn(e){return hue(e).slice().reverse()}function Nvn(e,t,n){return Zie(e||0,t||0,n||0)}function Mvn(e,t){const n=hg(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Fvn(e,t){const n=hg(e,(t||this).context);return n?n.copy():void 0}function Ovn(e,t){const n=hg(e,(t||this).context);return n?n.domain():[]}function Rvn(e,t,n){const r=hg(e,(n||this).context);return r?at(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function Pvn(e,t){const n=hg(e,(t||this).context);return n&&n.range?n.range():[]}function Lvn(e,t,n){const r=hg(e,(n||this).context);return r?r(t):void 0}function Bvn(e,t,n,r,i){e=hg(e,(i||this).context);const s=THt(t,n);let a=e.domain(),o=a[0],l=ln(a),u=ll;return l-o?u=P5e(e,o,l):e=(e.interpolator?Dn("sequential")().interpolator(e.interpolator()):Dn("linear")().interpolate(e.interpolate()).range(e.range())).domain([o=0,l=1]),e.ticks&&(a=e.ticks(+r||15),o!==a[0]&&a.unshift(o),l!==ln(a)&&a.push(l)),a.forEach(c=>s.stop(u(c),e(c))),s}function zvn(e,t,n){const r=hg(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function Uvn(e){let t=null;return function(n){return n?_P(n,t=t||ose(e)):e}}const cWe=e=>e.data;function fWe(e,t){const n=sWe.call(t,e);return n.root&&n.root.lookup||{}}function Wvn(e,t,n){const r=fWe(e,this),i=r[t],s=r[n];return i&&s?i.path(s).map(cWe):void 0}function Vvn(e,t){const n=fWe(e,this)[t];return n?n.ancestors().map(cWe):void 0}const hWe=()=>typeof window<"u"&&window||null;function jvn(){const e=hWe();return e?e.screen:{}}function Hvn(){const e=hWe();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function qvn(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function dWe(e,t,n){if(!e)return[];const[r,i]=e,s=new Oi().set(r[0],r[1],i[0],i[1]),a=n||this.context.dataflow.scenegraph().root;return cYt(a,s,Gvn(t))}function Gvn(e){let t=null;if(e){const n=ct(e.marktype),r=ct(e.markname);t=i=>(!n.length||n.some(s=>i.marktype===s))&&(!r.length||r.some(s=>i.name===s))}return t}function Yvn(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=ct(e);const i=e[e.length-1];return i===void 0||Math.hypot(i[0]-t,i[1]-n)>r?[...e,[t,n]]:e}function Xvn(e){return ct(e).reduce((t,n,r)=>{let[i,s]=n;return t+=r==0?`M ${i},${s} `:r===e.length-1?" Z":`L ${i},${s} `},"")}function Kvn(e,t,n){const{x:r,y:i,mark:s}=n,a=new Oi().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[l,u]of t)l<a.x1&&(a.x1=l),l>a.x2&&(a.x2=l),u<a.y1&&(a.y1=u),u>a.y2&&(a.y2=u);return a.translate(r,i),dWe([[a.x1,a.y1],[a.x2,a.y2]],e,s).filter(l=>Zvn(l.x,l.y,t))}function Zvn(e,t,n){let r=0;for(let i=0,s=n.length-1;i<n.length;s=i++){const[a,o]=n[s],[l,u]=n[i];u>t!=o>t&&e<(a-l)*(t-u)/(o-u)+l&&r++}return r&1}const Q3={random(){return Pp()},cumulativeNormal:jre,cumulativeLogNormal:mRe,cumulativeUniform:xRe,densityNormal:fRe,densityLogNormal:gRe,densityUniform:bRe,quantileNormal:Hre,quantileLogNormal:vRe,quantileUniform:wRe,sampleNormal:Vre,sampleLogNormal:pRe,sampleUniform:yRe,isArray:at,isBoolean:q6t,isDate:ty,isDefined(e){return e!==void 0},isNumber:FT,isObject:Ft,isRegExp:Y6t,isString:wr,isTuple:P_,isValid(e){return e!=null&&e===e},toBoolean:tOe,toDate(e){return nOe(e)},toNumber:io,toString:rOe,indexof:Evn,join:kvn,lastindexof:Avn,replace:Dvn,reverse:Ivn,slice:Tvn,flush:H6t,lerp:X6t,merge:xvn,pad:J6t,peek:ln,pluck:Svn,span:X7,inrange:oE,truncate:tBt,rgb:oue,lab:ZUe,hcl:QUe,hsl:jUe,luminance:CQ,contrast:bvn,sequence:tmn,format:evn,utcFormat:tvn,utcParse:rvn,utcOffset:u8t,utcSequence:f8t,timeFormat:aWe,timeParse:nvn,timeOffset:l8t,timeSequence:c8t,timeUnitSpecifier:qBt,monthFormat:ivn,monthAbbrevFormat:svn,dayFormat:avn,dayAbbrevFormat:ovn,quarter:R6t,utcquarter:P6t,week:YBt,utcweek:ZBt,dayofyear:GBt,utcdayofyear:KBt,warn:mvn,info:vvn,debug:yvn,extent(e){return Op(e)},inScope:gvn,intersect:dWe,clampRange:L6t,pinchDistance:Cvn,pinchAngle:_vn,screen:jvn,containerSize:qvn,windowSize:Hvn,bandspace:Nvn,setdata:Qmn,pathShape:Uvn,panLinear:N6t,panLog:M6t,panPow:F6t,panSymlog:O6t,zoomLinear:XFe,zoomLog:KFe,zoomPow:pX,zoomSymlog:ZFe,encode:Jmn,modify:$vn,lassoAppend:Yvn,lassoPath:Xvn,intersectLasso:Kvn},Qvn=["view","item","group","xy","x","y"],Jvn="event.vega.",pWe="this.",pue={},gWe={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${ot(oWe+e)}]`,functions:e1n,constants:AUe,visitors:pue},_Q=emn(gWe);function e1n(e){const t=TUe(e);Qvn.forEach(n=>t[n]=Jvn+n);for(const n in Q3)t[n]=pWe+n;return zt(t,fvn(e,Q3,pue)),t}function Hi(e,t,n){return arguments.length===1?Q3[e]:(Q3[e]=t,n&&(pue[e]=n),_Q&&(_Q.functions[e]=pWe+e),this)}Hi("bandwidth",Mvn,tl);Hi("copy",Fvn,tl);Hi("domain",Ovn,tl);Hi("range",Pvn,tl);Hi("invert",Rvn,tl);Hi("scale",Lvn,tl);Hi("gradient",Bvn,tl);Hi("geoArea",hvn,tl);Hi("geoBounds",dvn,tl);Hi("geoCentroid",pvn,tl);Hi("geoShape",zvn,tl);Hi("indata",Zmn,cvn);Hi("data",sWe,uue);Hi("treePath",Wvn,uue);Hi("treeAncestors",Vvn,uue);Hi("vlSelectionTest",eWe,sS);Hi("vlSelectionIdTest",nWe,sS);Hi("vlSelectionResolve",iWe,sS);Hi("vlSelectionTuples",rWe);function Hh(e,t){const n={};let r;try{e=wr(e)?e:ot(e)+"",r=Q0n(e)}catch{$e("Expression parse error: "+e)}r.visit(s=>{if(s.type!==wUe)return;const a=s.callee.name,o=gWe.visitors[a];o&&o(a,s.arguments,t,n)});const i=_Q(r);return i.globals.forEach(s=>{const a=oWe+s;!bt(n,a)&&t.getSignal(s)&&(n[a]=t.signalRef(s))}),{$expr:zt({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function t1n(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const n1n=Oh(["rule"]),hwe=Oh(["group","image","rect"]);function r1n(e,t){let n="";return n1n[t]||(e.x2&&(e.x?(hwe[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(hwe[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function gue(e){return(e+"").toLowerCase()}function i1n(e){return gue(e)==="operator"}function s1n(e){return gue(e)==="collect"}function Nk(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function a1n(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${r}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${r} : `}var o1n={operator:(e,t)=>Nk(e,["_"],t.code),parameter:(e,t)=>Nk(e,["datum","_"],t.code),event:(e,t)=>Nk(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return Nk(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const s in r){const a="o["+ot(s)+"]";i+=`$=${r[s].code};if(${a}!==$)${a}=$,m=1;`}return i+=r1n(r,n),i+="return m;",Nk(e,["item","_"],i)},codegen:{get(e){const t=`[${e.map(ot).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const r=(s,a)=>{const o=t[a];let l,u;return s.path?(l=`a${s.path}`,u=`b${s.path}`):((n=n||{})["f"+a]=s,l=`this.f${a}(a)`,u=`this.f${a}(b)`),a1n(l,u,-o,o)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function l1n(e){const t=this;i1n(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function u1n(e){const t=this;if(e.params){const n=t.get(e.id);n||$e("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function c1n(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=at(i)?i.map(s=>dwe(s,n,t)):dwe(i,n,t)}return t}function dwe(e,t,n){if(!e||!Ft(e))return e;for(let r=0,i=pwe.length,s;r<i;++r)if(s=pwe[r],bt(e,s.key))return s.parse(e,t,n);return e}var pwe=[{key:"$ref",parse:f1n},{key:"$key",parse:d1n},{key:"$expr",parse:h1n},{key:"$field",parse:p1n},{key:"$encode",parse:m1n},{key:"$compare",parse:g1n},{key:"$context",parse:v1n},{key:"$subflow",parse:y1n},{key:"$tupleid",parse:b1n}];function f1n(e,t){return t.get(e.$ref)||$e("Operator not defined: "+e.$ref)}function h1n(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=Jl(t.parameterExpression(e.$expr),e.$fields))}function d1n(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=eOe(e.$key,e.$flat,t.expr.codegen))}function p1n(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Hl(e.$field,e.$name,t.expr.codegen))}function g1n(e,t){const n="c:"+e.$compare+"_"+e.$order,r=ct(e.$compare).map(i=>i&&i.$tupleid?nt:i);return t.fn[n]||(t.fn[n]=QFe(r,e.$order,t.expr.codegen))}function m1n(e,t){const n=e.$encode,r={};for(const i in n){const s=n[i];r[i]=Jl(t.encodeExpression(s.$expr),s.$fields),r[i].output=s.$output}return r}function v1n(e,t){return t}function y1n(e,t){const n=e.$subflow;return function(r,i,s){const a=t.fork().parse(n),o=a.get(n.operators[0].id),l=a.signals.parent;return l&&l.set(s),o.detachSubflow=()=>t.detach(a),o}}function b1n(){return nt}function x1n(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(s=>t.get(s)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(s=>t.get(s)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&$e("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function w1n(e){var t=this,n=Ft(n=e.source)?n.$ref:n,r=t.get(n),i=null,s=e.update,a=void 0;r||$e("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(a=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,r,i,s,a)}const $1n={skip:!0};function C1n(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(s=>{const a=t.signals[s];e.signals(s,a)&&(r[s]=a.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(s=>{const a=t.data[s];e.data(s,a)&&(i[s]=a.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n}function _1n(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(s=>{n.update(t.signals[s],i[s],$1n)}),Object.keys(r||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(Jc).insert(r[s]))}),(e.subcontext||[]).forEach((s,a)=>{const o=t.subcontext[a];o&&o.setState(s)})}function mWe(e,t,n,r){return new vWe(e,t,n,r)}function vWe(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||o1n,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function gwe(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}vWe.prototype=gwe.prototype={fork(){const e=new gwe(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),s1n(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(r.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),r.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const a=n.data[s]||(n.data[s]={});e.data[s].forEach(o=>a[o]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[gue(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:t1n,parseOperator:l1n,parseOperatorParameters:u1n,parseParameters:c1n,parseStream:x1n,parseUpdate:w1n,getState:C1n,setState:_1n};function S1n(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),yWe(t,e.description()))}function yWe(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function k1n(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const zq="default";function E1n(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:zq,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,s=i?wr(i)?i:i.user:zq,a=r.item&&r.item.cursor||null;return i&&s===i.user&&a==i.item?i:{user:s,item:a}}),e.add(null,function(n){let r=n.cursor,i=this.value;return wr(r)||(i=r.item,r=r.user),SQ(e,r&&r!==zq?r:i||r),i},{cursor:t})}function SQ(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function N6(e,t){var n=e._runtime.data;return bt(n,t)||$e("Unrecognized data set: "+t),n[t]}function A1n(e,t){return arguments.length<2?N6(this,e).values.value:IU.call(this,e,sx().remove(Jc).insert(t))}function IU(e,t){JOe(t)||$e("Second argument to changes must be a changeset.");const n=N6(this,e);return n.modified=!0,this.pulse(n.input,t)}function T1n(e,t){return IU.call(this,e,sx().insert(t))}function D1n(e,t){return IU.call(this,e,sx().remove(t))}function bWe(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function xWe(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function NU(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function I1n(e){var t=NU(e),n=bWe(e),r=xWe(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(s){e.error(s)}})}function N1n(e,t,n){var r=e._renderer,i=r&&r.canvas(),s,a,o;return i&&(o=NU(e),a=t.changedTouches?t.changedTouches[0]:t,s=_se(a,i),s[0]-=o[0],s[1]-=o[1]),t.dataflow=e,t.item=n,t.vega=M1n(e,n,s),t}function M1n(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(a){var o=r,l;if(a){for(l=t;l;l=l.mark.group)if(l.mark.name===a){o=l;break}}return o&&o.mark&&o.mark.interactive?o:{}}function s(a){if(!a)return n;wr(a)&&(a=i(a));const o=n.slice();for(;a;)o[0]-=a.x||0,o[1]-=a.y||0,a=a.mark&&a.mark.group;return o}return{view:go(e),item:go(t||{}),group:i,xy:s,x:a=>s(a)[0],y:a=>s(a)[1]}}const mwe="view",F1n="timer",O1n="window",R1n={trap:!1};function P1n(e){const t=zt({defaults:{}},e),n=(r,i)=>{i.forEach(s=>{at(r[s])&&(r[s]=Oh(r[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function wWe(e,t,n,r){e._eventListeners.push({type:n,sources:ct(t),handler:r})}function L1n(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function mR(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||Ft(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function B1n(e,t,n){var r=this,i=new e9(n),s=function(u,c){r.runAsync(null,()=>{e===mwe&&L1n(r,t)&&u.preventDefault(),i.receive(N1n(r,u,c))})},a;if(e===F1n)mR(r,"timer",t)&&r.timer(s,t);else if(e===mwe)mR(r,"view",t)&&r.addEventListener(t,s,R1n);else if(e===O1n?mR(r,"window",t)&&typeof window<"u"&&(a=[window]):typeof document<"u"&&mR(r,"selector",t)&&(a=document.querySelectorAll(e)),!a)r.warn("Can not resolve event source: "+e);else{for(var o=0,l=a.length;o<l;++o)a[o].addEventListener(t,s);wWe(r,a,t,s)}return i}function vwe(e){return e.item}function ywe(e){return e.item.mark.source}function bwe(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function z1n(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",vwe),ywe,bwe(e)),this.on(this.events("view","mouseout",vwe),ywe,bwe(t)),this}function U1n(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,s;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(s=n[r],i=s.sources.length;--i>=0;)s.sources[i].removeEventListener(s.type,s.handler);return e&&e.call(this,this._handler,null,null,null),this}function Pl(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const W1n="vega-bind",V1n="vega-bind-name",j1n="vega-bind-radio";function H1n(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:a=>{a!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,a)})}},r.debounce&&(i.update=JFe(r.debounce,i.update))),(r.input==null&&r.element?q1n:Y1n)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function q1n(e,t,n,r){const i=n.event||"input",s=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,s),wWe(r,t,i,s),e.set=a=>{t.value=a,t.dispatchEvent(G1n(i))}}function G1n(e){return typeof Event<"u"?new Event(e):{type:e}}function Y1n(e,t,n,r){const i=r.signal(n.signal),s=Pl("div",{class:W1n}),a=n.input==="radio"?s:s.appendChild(Pl("label"));a.appendChild(Pl("span",{class:V1n},n.name||n.signal)),t.appendChild(s);let o=X1n;switch(n.input){case"checkbox":o=K1n;break;case"select":o=Z1n;break;case"radio":o=Q1n;break;case"range":o=J1n;break}o(e,a,n,i)}function X1n(e,t,n,r){const i=Pl("input");for(const s in n)s!=="signal"&&s!=="element"&&i.setAttribute(s==="input"?"type":s,n[s]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=s=>i.value=s}function K1n(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const s=Pl("input",i);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=a=>s.checked=!!a||null}function Z1n(e,t,n,r){const i=Pl("select",{name:n.signal}),s=n.labels||[];n.options.forEach((a,o)=>{const l={value:a};M6(a,r)&&(l.selected=!0),i.appendChild(Pl("option",l,(s[o]||a)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=a=>{for(let o=0,l=n.options.length;o<l;++o)if(M6(n.options[o],a)){i.selectedIndex=o;return}}}function Q1n(e,t,n,r){const i=Pl("span",{class:j1n}),s=n.labels||[];t.appendChild(i),e.elements=n.options.map((a,o)=>{const l={type:"radio",name:n.signal,value:a};M6(a,r)&&(l.checked=!0);const u=Pl("input",l);u.addEventListener("change",()=>e.update(a));const c=Pl("label",{},(s[o]||a)+"");return c.prepend(u),i.appendChild(c),u}),e.set=a=>{const o=e.elements,l=o.length;for(let u=0;u<l;++u)M6(o[u].value,a)&&(o[u].checked=!0)}}function J1n(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,s=n.min||Math.min(0,i,+r)||0,a=n.step||K0(s,i,100),o=Pl("input",{type:"range",name:n.signal,min:s,max:i,step:a});o.value=r;const l=Pl("span",{},+r);t.appendChild(o),t.appendChild(l);const u=()=>{l.textContent=o.value,e.update(+o.value)};o.addEventListener("input",u),o.addEventListener("change",u),e.elements=[o],e.set=c=>{o.value=c,l.textContent=c}}function M6(e,t){return e===t||e+""==t+""}function $We(e,t,n,r,i,s){return t=t||new r(e.loader()),t.initialize(n,bWe(e),xWe(e),NU(e),i,s).background(e.background())}function mue(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function eyn(e,t,n,r){const i=new r(e.loader(),mue(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,NU(e),e);return t&&t.handlers().forEach(s=>{i.on(s.type,s.handler)}),i}function tyn(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,s=Tse(r);e=n._el=e?Uq(n,e,!0):null,S1n(n),s||n.error("Unrecognized renderer type: "+r);const a=s.handler||A9,o=e?s.renderer:s.headless;return n._renderer=o?$We(n,n._renderer,e,o):null,n._handler=eyn(n,n._handler,e,a),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=Uq(n,t,!0):e.appendChild(Pl("form",{class:"vega-bindings"})),n._bind.forEach(l=>{l.param.element&&i!=="container"&&(l.element=Uq(n,l.param.element,!!l.param.input))}),n._bind.forEach(l=>{H1n(n,l.element||t,l)})),n}function Uq(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}const Mk=e=>+e||0,nyn=e=>({top:e,bottom:e,left:e,right:e});function xwe(e){return Ft(e)?{top:Mk(e.top),bottom:Mk(e.bottom),left:Mk(e.left),right:Mk(e.right)}:nyn(Mk(e))}async function vue(e,t,n,r){const i=Tse(t),s=i&&i.headless;return s||$e("Unrecognized renderer type: "+t),await e.runAsync(),$We(e,null,null,s,n,r).renderAsync(e._scenegraph.root)}async function ryn(e,t){e!==R1.Canvas&&e!==R1.SVG&&e!==R1.PNG&&$e("Unrecognized image type: "+e);const n=await vue(this,e,t);return e===R1.SVG?iyn(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function iyn(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function syn(e,t){return(await vue(this,R1.Canvas,e,t)).canvas()}async function ayn(e){return(await vue(this,R1.SVG,e)).svg()}function oyn(e,t,n){return mWe(e,Zw,Q3,n).parse(t)}function lyn(e){var t=this._runtime.scales;return bt(t,e)||$e("Unrecognized scale or projection: "+e),t[e].value}var CWe="width",_We="height",yue="padding",wwe={skip:!0};function SWe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===yue?r.left+r.right:0)}function kWe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===yue?r.top+r.bottom:0)}function uyn(e){var t=e._signals,n=t[CWe],r=t[_We],i=t[yue];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,o=>{e._width=o.size,e._viewWidth=SWe(e,o.size),s()},{size:n}),e._resizeHeight=e.add(null,o=>{e._height=o.size,e._viewHeight=kWe(e,o.size),s()},{size:r});const a=e.add(null,s,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}function cyn(e,t,n,r,i,s){this.runAfter(a=>{let o=0;a._autosize=0,a.width()!==n&&(o=1,a.signal(CWe,n,wwe),a._resizeWidth.skip(!0)),a.height()!==r&&(o=1,a.signal(_We,r,wwe),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),(a._origin[0]!==i[0]||a._origin[1]!==i[1])&&(a._resize=1,a._origin=i),o&&a.run("enter"),s&&a.runAfter(l=>l.resize())},!1,1)}function fyn(e){return this._runtime.getState(e||{data:hyn,signals:dyn,recurse:!0})}function hyn(e,t){return t.modified&&at(t.input.value)&&e.indexOf("_:vega:_")}function dyn(e,t){return!(e==="parent"||t instanceof Zw.proxy)}function pyn(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function gyn(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(KJt(n,t))}function myn(e,t,n,r){const i=e.element();i&&i.setAttribute("title",vyn(r))}function vyn(e){return e==null?"":at(e)?EWe(e):Ft(e)&&!ty(e)?yyn(e):e+""}function yyn(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(at(n)?EWe(n):AWe(n))}).join(`
`)}function EWe(e){return"["+e.map(AWe).join(", ")+"]"}function AWe(e){return at(e)?"[\u2026]":Ft(e)&&!ty(e)?"{\u2026}":e}function TWe(e,t){const n=this;if(t=t||{},Q2.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const s=zt({},e.locale,t.locale);n.locale(Izt(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||R1.Canvas,n._scenegraph=new gPe;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||myn,n._redraw=!0,n._handler=new A9().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=P1n(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=oyn(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:zt({},s)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=SWe(n,n._width),n._viewHeight=kWe(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,uyn(n),k1n(n),E1n(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function vR(e,t){return bt(e._signals,t)?e._signals[t]:$e("Unrecognized signal name: "+ot(t))}function DWe(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function $we(e,t,n,r){let i=DWe(n,r);return i||(i=mue(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function Cwe(e,t,n){const r=DWe(t,n);return r&&t._targets.remove(r),e}Ie(TWe,Q2,{async evaluate(e,t,n){if(await Q2.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,I1n(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&r4(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&yWe(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=vR(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",xwe(e)):xwe(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Tse(e)||$e("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Q2.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(vR(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:cyn,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=mue(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,s;--r>=0;)if(s=n[r].type,i=n[r].handler,e===s&&(t===i||t===i.raw)){this._handler.off(s,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return $we(this,e,vR(this,e),t)},removeSignalListener(e,t){return Cwe(this,vR(this,e),t)},addDataListener(e,t){return $we(this,e,N6(this,e).values,t)},removeDataListener(e,t){return Cwe(this,N6(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=SQ(this,null);this._globalCursor=!!e,t&&SQ(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:gyn,events:B1n,finalize:U1n,hover:z1n,data:A1n,change:IU,insert:T1n,remove:D1n,scale:lyn,initialize:tyn,toImageURL:ryn,toCanvas:syn,toSVG:ayn,getState:fyn,setState:pyn});function aS(e,t,n){return e.fields=t||[],e.fname=n,e}function byn(e){return e.length===1?xyn(e[0]):wyn(e)}const xyn=e=>function(t){return t[e]},wyn=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function TA(e){throw Error(e)}function $yn(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||TA("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&TA("Access path missing closing bracket: "+e),r&&TA("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function Cyn(e,t,n){const r=$yn(e);return e=r.length===1?r[0]:e,aS((n&&n.get||byn)(r),[e],t||e)}Cyn("id");aS(e=>e,[],"identity");aS(()=>0,[],"zero");aS(()=>1,[],"one");aS(()=>!0,[],"true");aS(()=>!1,[],"false");function _yn(e){return e===Object(e)}function Syn(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function _we(e){return typeof e=="string"}const Wq=new Date,Vq=new Date;function qi(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>qi(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(Wq.setTime(+s),Vq.setTime(+a),e(Wq),e(Vq),Math.floor(n(Wq,Vq))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const J3=qi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);J3.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?qi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):J3);J3.range;const eD=1e3,gm=eD*60,tD=gm*60,nD=tD*24,IWe=nD*7,bue=qi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*eD)},(e,t)=>(t-e)/eD,e=>e.getUTCSeconds());bue.range;const NWe=qi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*eD)},(e,t)=>{e.setTime(+e+t*gm)},(e,t)=>(t-e)/gm,e=>e.getMinutes());NWe.range;const MWe=qi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*gm)},(e,t)=>(t-e)/gm,e=>e.getUTCMinutes());MWe.range;const FWe=qi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*eD-e.getMinutes()*gm)},(e,t)=>{e.setTime(+e+t*tD)},(e,t)=>(t-e)/tD,e=>e.getHours());FWe.range;const OWe=qi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*tD)},(e,t)=>(t-e)/tD,e=>e.getUTCHours());OWe.range;const D4=qi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*gm)/nD,e=>e.getDate()-1);D4.range;const I4=qi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/nD,e=>e.getUTCDate()-1);I4.range;const kyn=qi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/nD,e=>Math.floor(e/nD));kyn.range;function Sx(e){return qi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*gm)/IWe)}const RWe=Sx(0),Eyn=Sx(1),Ayn=Sx(2),Tyn=Sx(3),Dyn=Sx(4),Iyn=Sx(5),Nyn=Sx(6);RWe.range;Eyn.range;Ayn.range;Tyn.range;Dyn.range;Iyn.range;Nyn.range;function kx(e){return qi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/IWe)}const PWe=kx(0),Myn=kx(1),Fyn=kx(2),Oyn=kx(3),Ryn=kx(4),Pyn=kx(5),Lyn=kx(6);PWe.range;Myn.range;Fyn.range;Oyn.range;Ryn.range;Pyn.range;Lyn.range;const kQ=qi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());kQ.range;const EQ=qi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());EQ.range;const xue=qi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());xue.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:qi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});xue.range;const wue=qi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());wue.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:qi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});wue.range;const rD="year",iD="quarter",sD="month",aD="week",oD="date",MU="day",$ue="dayofyear",lD="hours",uD="minutes",cD="seconds",FU="milliseconds",Byn=[rD,iD,sD,aD,oD,MU,$ue,lD,uD,cD,FU];Byn.reduce((e,t,n)=>(e[t]=1+n,e),{});const zyn={[rD]:xue,[iD]:kQ.every(3),[sD]:kQ,[aD]:RWe,[oD]:D4,[MU]:D4,[$ue]:D4,[lD]:FWe,[uD]:NWe,[cD]:bue,[FU]:J3},Uyn={[rD]:wue,[iD]:EQ.every(3),[sD]:EQ,[aD]:PWe,[oD]:I4,[MU]:I4,[$ue]:I4,[lD]:OWe,[uD]:MWe,[cD]:bue,[FU]:J3};function Wyn(e){return zyn[e]}function Vyn(e){return Uyn[e]}function HE(e){const t={};return n=>t[n]||(t[n]=e(n))}function jyn(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=Hyn(r,i);const a=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+a}}function Hyn(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function LWe(e){const t=HE(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=O$(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return jyn(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,a){a=O$(a==null?",f":a);const o=K0(r,i,s),l=Math.max(Math.abs(r),Math.abs(i));let u;if(a.precision==null)switch(a.type){case"s":return isNaN(u=O9e(o,l))||(a.precision=u),n(a,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=R9e(o,l))||(a.precision=u-(a.type==="e"));break}case"f":case"%":{isNaN(u=F9e(o))||(a.precision=u-(a.type==="%")*2);break}}return t(a)}}}let AQ;BWe();function BWe(){return AQ=LWe({format:bU,formatPrefix:Cle})}function zWe(e){return LWe(M9e(e))}function F6(e){return arguments.length?AQ=zWe(e):AQ}function Swe(e,t,n){n=n||{},_yn(n)||TA("Invalid time multi-format specifier: ".concat(n));const r=t(cD),i=t(uD),s=t(lD),a=t(oD),o=t(aD),l=t(sD),u=t(iD),c=t(rD),f=e(n[FU]||".%L"),h=e(n[cD]||":%S"),d=e(n[uD]||"%I:%M"),p=e(n[lD]||"%I %p"),g=e(n[oD]||n[MU]||"%a %d"),m=e(n[aD]||"%b %d"),v=e(n[sD]||"%B"),y=e(n[iD]||"%B"),b=e(n[rD]||"%Y");return x=>(r(x)<x?f:i(x)<x?h:s(x)<x?d:a(x)<x?p:l(x)<x?o(x)<x?g:m:c(x)<x?u(x)<x?v:y:b)(x)}function UWe(e){const t=HE(e.format),n=HE(e.utcFormat);return{timeFormat:r=>_we(r)?t(r):Swe(t,Wyn,r),utcFormat:r=>_we(r)?n(r):Swe(n,Vyn,r),timeParse:HE(e.parse),utcParse:HE(e.utcParse)}}let TQ;WWe();function WWe(){return TQ=UWe({format:Ale,parse:Z9e,utcFormat:Tle,utcParse:Q9e})}function VWe(e){return UWe(q9e(e))}function O6(e){return arguments.length?TQ=VWe(e):TQ}const DQ=(e,t)=>Syn({},e,t);function qyn(e,t){const n=e?zWe(e):F6(),r=t?VWe(t):O6();return DQ(n,r)}function jWe(e,t){const n=arguments.length;return n&&n!==2&&TA("defaultLocale expects either zero or two arguments."),n?DQ(F6(e),O6(t)):DQ(F6(),O6())}function Gyn(){return BWe(),WWe(),jWe()}function oS(e,t,n){return e.fields=t||[],e.fname=n,e}function Yyn(e){return e.length===1?Xyn(e[0]):Kyn(e)}const Xyn=e=>function(t){return t[e]},Kyn=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function br(e){throw Error(e)}function Zyn(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||br("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&br("Access path missing closing bracket: "+e),r&&br("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function HWe(e,t,n){const r=Zyn(e);return e=r.length===1?r[0]:e,oS((n&&n.get||Yyn)(r),[e],t||e)}HWe("id");const Cue=oS(e=>e,[],"identity");oS(()=>0,[],"zero");oS(()=>1,[],"one");const OU=oS(()=>!0,[],"true");oS(()=>!1,[],"false");var Ma=Array.isArray;function fD(e){return e===Object(e)}function xo(e){return e[e.length-1]}function RU(e){return e==null||e===""?null:+e}const qWe=e=>t=>e*Math.exp(t),GWe=e=>t=>Math.log(e*t),YWe=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),XWe=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,R6=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function PU(e,t,n,r){const i=n(e[0]),s=n(xo(e)),a=(s-i)*t;return[r(i-a),r(s-a)]}function Qyn(e,t){return PU(e,t,RU,Cue)}function Jyn(e,t){var n=Math.sign(e[0]);return PU(e,t,GWe(n),qWe(n))}function ebn(e,t,n){return PU(e,t,R6(n),R6(1/n))}function tbn(e,t,n){return PU(e,t,YWe(n),XWe(n))}function LU(e,t,n,r,i){const s=r(e[0]),a=r(xo(e)),o=t!=null?r(t):(s+a)/2;return[i(o+(s-o)*n),i(o+(a-o)*n)]}function nbn(e,t,n){return LU(e,t,n,RU,Cue)}function rbn(e,t,n){const r=Math.sign(e[0]);return LU(e,t,n,GWe(r),qWe(r))}function ibn(e,t,n,r){return LU(e,t,n,R6(r),R6(1/r))}function sbn(e,t,n,r){return LU(e,t,n,YWe(r),XWe(r))}function abn(e){return 1+~~(new Date(e).getMonth()/3)}function obn(e){return 1+~~(new Date(e).getUTCMonth()/3)}function P$(e){return e!=null?Ma(e)?e:[e]:[]}function lbn(e,t,n){let r=e[0],i=e[1],s;return i<r&&(s=i,i=r,r=s),s=i-r,s>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-s),r+s]}function mm(e){return typeof e=="function"}function ubn(e){return mm(e)?e:()=>e}function Ex(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function cbn(e,t){let n=0,r,i,s,a;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(s=a=i;n<r;++n)i=e[n],i!=null&&(i<s&&(s=i),i>a&&(a=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(s=a=i;n<r;++n)i=t(e[n]),i!=null&&(i<s&&(s=i),i>a&&(a=i))}return[s,a]}const fbn=Object.prototype.hasOwnProperty;function Ns(e,t){return fbn.call(e,t)}function hbn(e,t,n,r,i,s){if(!n&&n!==0)return s;const a=+n;let o=e[0],l=xo(e),u;l<o&&(u=o,o=l,l=u),u=Math.abs(t-o);const c=Math.abs(l-t);return u<c&&u<=a?r:c<=a?i:s}function lS(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ex(r,n)}function dbn(e,t,n,r){let i=t[0],s=t[t.length-1],a;return i>s&&(a=i,i=s,s=a),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=s:e<s)}function pbn(e){return typeof e=="boolean"}function KWe(e){return Object.prototype.toString.call(e)==="[object Date]"}function ZWe(e){return typeof e=="number"}function gbn(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function vm(e){return typeof e=="string"}function mbn(e,t){const n=e[0],r=xo(e),i=+t;return i?i===1?r:n+i*(r-n):n}const vbn=1e4;function ybn(e){e=+e||vbn;let t,n,r;const i=()=>{t={},n={},r=0},s=(a,o)=>(++r>e&&(n=t,t={},r=1),t[a]=o);return i(),{clear:i,has:a=>Ns(t,a)||Ns(n,a),get:a=>Ns(t,a)?t[a]:Ns(n,a)?s(a,n[a]):void 0,set:(a,o)=>Ns(t,a)?t[a]=o:s(a,o)}}function yR(e,t){let n="";for(;--t>=0;)n+=e;return n}function bbn(e,t,n,r){const i=n||" ",s=e+"",a=t-s.length;return a<=0?s:r==="left"?yR(i,a)+s:r==="center"?yR(i,~~(a/2))+s+yR(i,Math.ceil(a/2)):s+yR(i,a)}function xbn(e){return e&&xo(e)-e[0]||0}function hD(e){return Ma(e)?"["+e.map(hD)+"]":fD(e)||vm(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function wbn(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const $bn=e=>ZWe(e)||KWe(e)?e:Date.parse(e);function Cbn(e,t){return t=t||$bn,e==null||e===""?null:t(e)}function _bn(e){return e==null||e===""?null:e+""}function P6(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function Sbn(e,t,n,r){const i=r!=null?r:"\u2026",s=e+"",a=s.length,o=Math.max(0,t-i.length);return a<=t?s:n==="left"?i+s.slice(a-o):n==="center"?s.slice(0,Math.ceil(o/2))+i+s.slice(a-~~(o/2)):s.slice(0,o)+i}const dD="Literal";var gd,kbn=1,Ebn=2,Abn=3,Tbn=4,Dbn=5,Ibn=6,Nbn=7,Mbn=8,Fbn=9;gd={};gd[kbn]="Boolean";gd[Ebn]="<end>";gd[Abn]="Identifier";gd[Tbn]="Keyword";gd[Dbn]="Null";gd[Ibn]="Numeric";gd[Nbn]="Punctuator";gd[Mbn]="String";gd[Fbn]="RegularExpression";var QWe={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function JWe(e){function t(a,o,l,u){let c=e(o[0]);return l&&(c=l+"("+c+")",l.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(u<0?"":u===0?"()":"("+o.slice(1).map(e).join(",")+")")}function n(a,o,l){return u=>t(a,u,o,l)}const r="new Date",i="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&br("Missing arguments to clamp function."),a.length>3&&br("Too many arguments to clamp function.");const o=a.map(e);return"Math.max("+o[1]+", Math.min("+o[2]+","+o[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:s,test:n("test",s),if:function(a){a.length<3&&br("Missing arguments to if function."),a.length>3&&br("Too many arguments to if function.");const o=a.map(e);return"("+o[0]+"?"+o[1]+":"+o[2]+")"}}}function Obn(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function Rbn(e){e=e||{};const t=e.allowed?P6(e.allowed):{},n=e.forbidden?P6(e.forbidden):{},r=e.constants||QWe,i=(e.functions||JWe)(f),s=e.globalvar,a=e.fieldvar,o=mm(s)?s:p=>`${s}["${p}"]`;let l={},u={},c=0;function f(p){if(vm(p))return p;const g=h[p.type];return g==null&&br("Unsupported type: "+p.type),g(p)}const h={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:Ns(n,g)?br("Illegal identifier: "+g):Ns(r,g)?r[g]:Ns(t,g)?g:(l[g]=1,o(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const v=f(p.property);return m===a&&(u[Obn(v)]=1),g&&(c-=1),m+(g?"."+v:"["+v+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&br("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,v=Ns(i,g)&&i[g];return v||br("Unrecognized function: "+g),mm(v)?v(m):v+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function d(p){const g={code:f(p),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},g}return d.functions=i,d.constants=r,d}function N4(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Pbn(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function eVe(e){let t,n,r;e.length!==2?(t=N4,n=(o,l)=>N4(e(o),l),r=(o,l)=>e(o)-l):(t=e===N4||e===Pbn?e:Lbn,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function Lbn(){return 0}function Bbn(e){return e===null?NaN:+e}const zbn=eVe(N4),IQ=zbn.right;eVe(Bbn).center;const Ubn=IQ;function Wbn(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function DA(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Vbn(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function tVe(e){let t,n,r;e.length!==2?(t=DA,n=(o,l)=>DA(e(o),l),r=(o,l)=>e(o)-l):(t=e===DA||e===Vbn?e:jbn,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function jbn(){return 0}function nVe(e){return e===null?NaN:+e}const Hbn=tVe(DA),qbn=Hbn.right;tVe(nVe).center;const BU=qbn,Gbn=Math.sqrt(50),Ybn=Math.sqrt(10),Xbn=Math.sqrt(2);function L6(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=Gbn?10:s>=Ybn?5:s>=Xbn?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?L6(e,t,n*2):[o,l,u]}function NQ(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,a]=r?L6(t,e,n):L6(e,t,n);if(!(s>=i))return[];const o=s-i+1,l=new Array(o);if(r)if(a<0)for(let u=0;u<o;++u)l[u]=(s-u)/-a;else for(let u=0;u<o;++u)l[u]=(s-u)*a;else if(a<0)for(let u=0;u<o;++u)l[u]=(i+u)/-a;else for(let u=0;u<o;++u)l[u]=(i+u)*a;return l}function MQ(e,t,n){return t=+t,e=+e,n=+n,L6(e,t,n)[2]}function Kbn(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?MQ(t,e,n):MQ(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function Zbn(e,t,n=nVe){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function md(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function av(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const kwe=Symbol("implicit");function _ue(){var e=new qw,t=[],n=[],r=kwe;function i(s){let a=e.get(s);if(a===void 0){if(r!==kwe)return r;e.set(s,a=t.push(s)-1)}return n[a%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new qw;for(const a of s)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return _ue(t,n).unknown(r)},md.apply(i,arguments),i}function uS(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function HM(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ov(){}var hb=.7,L$=1/hb,pw="\\s*([+-]?\\d+)\\s*",pD="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",vh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Qbn=/^#([0-9a-f]{3,8})$/,Jbn=new RegExp(`^rgb\\(${pw},${pw},${pw}\\)$`),exn=new RegExp(`^rgb\\(${vh},${vh},${vh}\\)$`),txn=new RegExp(`^rgba\\(${pw},${pw},${pw},${pD}\\)$`),nxn=new RegExp(`^rgba\\(${vh},${vh},${vh},${pD}\\)$`),rxn=new RegExp(`^hsl\\(${pD},${vh},${vh}\\)$`),ixn=new RegExp(`^hsla\\(${pD},${vh},${vh},${pD}\\)$`),Ewe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};uS(ov,gD,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Awe,formatHex:Awe,formatHex8:sxn,formatHsl:axn,formatRgb:Twe,toString:Twe});function Awe(){return this.rgb().formatHex()}function sxn(){return this.rgb().formatHex8()}function axn(){return rVe(this).formatHsl()}function Twe(){return this.rgb().formatRgb()}function gD(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Qbn.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Dwe(t):n===3?new os(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?bR(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?bR(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Jbn.exec(e))?new os(t[1],t[2],t[3],1):(t=exn.exec(e))?new os(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=txn.exec(e))?bR(t[1],t[2],t[3],t[4]):(t=nxn.exec(e))?bR(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=rxn.exec(e))?Mwe(t[1],t[2]/100,t[3]/100,1):(t=ixn.exec(e))?Mwe(t[1],t[2]/100,t[3]/100,t[4]):Ewe.hasOwnProperty(e)?Dwe(Ewe[e]):e==="transparent"?new os(NaN,NaN,NaN,0):null}function Dwe(e){return new os(e>>16&255,e>>8&255,e&255,1)}function bR(e,t,n,r){return r<=0&&(e=t=n=NaN),new os(e,t,n,r)}function Sue(e){return e instanceof ov||(e=gD(e)),e?(e=e.rgb(),new os(e.r,e.g,e.b,e.opacity)):new os}function B6(e,t,n,r){return arguments.length===1?Sue(e):new os(e,t,n,r==null?1:r)}function os(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}uS(os,B6,HM(ov,{brighter(e){return e=e==null?L$:Math.pow(L$,e),new os(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?hb:Math.pow(hb,e),new os(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new os(dy(this.r),dy(this.g),dy(this.b),z6(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Iwe,formatHex:Iwe,formatHex8:oxn,formatRgb:Nwe,toString:Nwe}));function Iwe(){return`#${U1(this.r)}${U1(this.g)}${U1(this.b)}`}function oxn(){return`#${U1(this.r)}${U1(this.g)}${U1(this.b)}${U1((isNaN(this.opacity)?1:this.opacity)*255)}`}function Nwe(){const e=z6(this.opacity);return`${e===1?"rgb(":"rgba("}${dy(this.r)}, ${dy(this.g)}, ${dy(this.b)}${e===1?")":`, ${e})`}`}function z6(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function dy(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function U1(e){return e=dy(e),(e<16?"0":"")+e.toString(16)}function Mwe(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Dc(e,t,n,r)}function rVe(e){if(e instanceof Dc)return new Dc(e.h,e.s,e.l,e.opacity);if(e instanceof ov||(e=gD(e)),!e)return new Dc;if(e instanceof Dc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new Dc(a,o,l,e.opacity)}function FQ(e,t,n,r){return arguments.length===1?rVe(e):new Dc(e,t,n,r==null?1:r)}function Dc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}uS(Dc,FQ,HM(ov,{brighter(e){return e=e==null?L$:Math.pow(L$,e),new Dc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?hb:Math.pow(hb,e),new Dc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new os(jq(e>=240?e-240:e+120,i,r),jq(e,i,r),jq(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Dc(Fwe(this.h),xR(this.s),xR(this.l),z6(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=z6(this.opacity);return`${e===1?"hsl(":"hsla("}${Fwe(this.h)}, ${xR(this.s)*100}%, ${xR(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Fwe(e){return e=(e||0)%360,e<0?e+360:e}function xR(e){return Math.max(0,Math.min(1,e||0))}function jq(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const iVe=Math.PI/180,sVe=180/Math.PI,U6=18,aVe=.96422,oVe=1,lVe=.82521,uVe=4/29,gw=6/29,cVe=3*gw*gw,lxn=gw*gw*gw;function fVe(e){if(e instanceof yh)return new yh(e.l,e.a,e.b,e.opacity);if(e instanceof cp)return hVe(e);e instanceof os||(e=Sue(e));var t=Yq(e.r),n=Yq(e.g),r=Yq(e.b),i=Hq((.2225045*t+.7168786*n+.0606169*r)/oVe),s,a;return t===n&&n===r?s=a=i:(s=Hq((.4360747*t+.3850649*n+.1430804*r)/aVe),a=Hq((.0139322*t+.0971045*n+.7141733*r)/lVe)),new yh(116*i-16,500*(s-i),200*(i-a),e.opacity)}function OQ(e,t,n,r){return arguments.length===1?fVe(e):new yh(e,t,n,r==null?1:r)}function yh(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}uS(yh,OQ,HM(ov,{brighter(e){return new yh(this.l+U6*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new yh(this.l-U6*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=aVe*qq(t),e=oVe*qq(e),n=lVe*qq(n),new os(Gq(3.1338561*t-1.6168667*e-.4906146*n),Gq(-.9787684*t+1.9161415*e+.033454*n),Gq(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Hq(e){return e>lxn?Math.pow(e,1/3):e/cVe+uVe}function qq(e){return e>gw?e*e*e:cVe*(e-uVe)}function Gq(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Yq(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function uxn(e){if(e instanceof cp)return new cp(e.h,e.c,e.l,e.opacity);if(e instanceof yh||(e=fVe(e)),e.a===0&&e.b===0)return new cp(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*sVe;return new cp(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function RQ(e,t,n,r){return arguments.length===1?uxn(e):new cp(e,t,n,r==null?1:r)}function cp(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function hVe(e){if(isNaN(e.h))return new yh(e.l,0,0,e.opacity);var t=e.h*iVe;return new yh(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}uS(cp,RQ,HM(ov,{brighter(e){return new cp(this.h,this.c,this.l+U6*(e==null?1:e),this.opacity)},darker(e){return new cp(this.h,this.c,this.l-U6*(e==null?1:e),this.opacity)},rgb(){return hVe(this).rgb()}}));var dVe=-.14861,kue=1.78277,Eue=-.29227,zU=-.90649,mD=1.97294,Owe=mD*zU,Rwe=mD*kue,Pwe=kue*Eue-zU*dVe;function cxn(e){if(e instanceof py)return new py(e.h,e.s,e.l,e.opacity);e instanceof os||(e=Sue(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Pwe*r+Owe*t-Rwe*n)/(Pwe+Owe-Rwe),s=r-i,a=(mD*(n-i)-Eue*s)/zU,o=Math.sqrt(a*a+s*s)/(mD*i*(1-i)),l=o?Math.atan2(a,s)*sVe-120:NaN;return new py(l<0?l+360:l,o,i,e.opacity)}function PQ(e,t,n,r){return arguments.length===1?cxn(e):new py(e,t,n,r==null?1:r)}function py(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}uS(py,PQ,HM(ov,{brighter(e){return e=e==null?L$:Math.pow(L$,e),new py(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?hb:Math.pow(hb,e),new py(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*iVe,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new os(255*(t+n*(dVe*r+kue*i)),255*(t+n*(Eue*r+zU*i)),255*(t+n*(mD*r)),this.opacity)}}));function pVe(e,t,n,r,i){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*n+(1+3*e+3*s-3*a)*r+a*i)/6}function gVe(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],a=r>0?e[r-1]:2*i-s,o=r<t-1?e[r+2]:2*s-i;return pVe((n-r/t)*t,a,i,s,o)}}function mVe(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],a=e[(r+1)%t],o=e[(r+2)%t];return pVe((n-r/t)*t,i,s,a,o)}}const UU=e=>()=>e;function vVe(e,t){return function(n){return e+n*t}}function fxn(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function WU(e,t){var n=t-e;return n?vVe(e,n>180||n<-180?n-360*Math.round(n/360):n):UU(isNaN(e)?t:e)}function hxn(e){return(e=+e)==1?ls:function(t,n){return n-t?fxn(t,n,e):UU(isNaN(t)?n:t)}}function ls(e,t){var n=t-e;return n?vVe(e,n):UU(isNaN(e)?t:e)}const LQ=function e(t){var n=hxn(t);function r(i,s){var a=n((i=B6(i)).r,(s=B6(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=ls(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function yVe(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),a,o;for(a=0;a<n;++a)o=B6(t[a]),r[a]=o.r||0,i[a]=o.g||0,s[a]=o.b||0;return r=e(r),i=e(i),s=e(s),o.opacity=1,function(l){return o.r=r(l),o.g=i(l),o.b=s(l),o+""}}}var dxn=yVe(gVe),pxn=yVe(mVe);function Aue(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function bVe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function gxn(e,t){return(bVe(t)?Aue:xVe)(e,t)}function xVe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=Ax(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function wVe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function wc(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function $Ve(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Ax(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var BQ=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xq=new RegExp(BQ.source,"g");function mxn(e){return function(){return e}}function vxn(e){return function(t){return e(t)+""}}function CVe(e,t){var n=BQ.lastIndex=Xq.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=BQ.exec(e))&&(i=Xq.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:wc(r,i)})),n=Xq.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?vxn(l[0].x):mxn(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)o[(f=l[c]).i]=f.x(u);return o.join("")})}function Ax(e,t){var n=typeof t,r;return t==null||n==="boolean"?UU(t):(n==="number"?wc:n==="string"?(r=gD(t))?(t=r,LQ):CVe:t instanceof gD?LQ:t instanceof Date?wVe:bVe(t)?Aue:Array.isArray(t)?xVe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?$Ve:wc)(e,t)}function yxn(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function bxn(e,t){var n=WU(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function VU(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Lwe=180/Math.PI,zQ={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _Ve(e,t,n,r,i,s){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*Lwe,skewX:Math.atan(l)*Lwe,scaleX:a,scaleY:o}}var wR;function xxn(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?zQ:_Ve(t.a,t.b,t.c,t.d,t.e,t.f)}function wxn(e){return e==null||(wR||(wR=document.createElementNS("http://www.w3.org/2000/svg","g")),wR.setAttribute("transform",e),!(e=wR.transform.baseVal.consolidate()))?zQ:(e=e.matrix,_Ve(e.a,e.b,e.c,e.d,e.e,e.f))}function SVe(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push("translate(",null,t,null,n);p.push({i:g-4,x:wc(u,f)},{i:g-2,x:wc(c,h)})}else(f||h)&&d.push("translate("+f+t+h+n)}function a(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:wc(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function o(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:wc(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,h,d,p){if(u!==f||c!==h){var g=d.push(i(d)+"scale(",null,",",null,")");p.push({i:g-4,x:wc(u,f)},{i:g-2,x:wc(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=e(u),c=e(c),s(u.translateX,u.translateY,c.translateX,c.translateY,f,h),a(u.rotate,c.rotate,f,h),o(u.skewX,c.skewX,f,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,g=h.length,m;++p<g;)f[(m=h[p]).i]=m.x(d);return f.join("")}}}var $xn=SVe(xxn,"px, ","px)","deg)"),Cxn=SVe(wxn,", ",")",")"),_xn=1e-12;function Bwe(e){return((e=Math.exp(e))+1/e)/2}function Sxn(e){return((e=Math.exp(e))-1/e)/2}function kxn(e){return((e=Math.exp(2*e))-1)/(e+1)}const Exn=function e(t,n,r){function i(s,a){var o=s[0],l=s[1],u=s[2],c=a[0],f=a[1],h=a[2],d=c-o,p=f-l,g=d*d+p*p,m,v;if(g<_xn)v=Math.log(h/u)/t,m=function($){return[o+$*d,l+$*p,u*Math.exp(t*$*v)]};else{var y=Math.sqrt(g),b=(h*h-u*u+r*g)/(2*u*n*y),x=(h*h-u*u-r*g)/(2*h*n*y),w=Math.log(Math.sqrt(b*b+1)-b),C=Math.log(Math.sqrt(x*x+1)-x);v=(C-w)/t,m=function($){var _=$*v,k=Bwe(w),E=u/(n*y)*(k*kxn(t*_+w)-Sxn(w));return[o+E*d,l+E*p,u*k/Bwe(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(s){var a=Math.max(.001,+s),o=a*a,l=o*o;return e(a,o,l)},i}(Math.SQRT2,2,4);function kVe(e){return function(t,n){var r=e((t=FQ(t)).h,(n=FQ(n)).h),i=ls(t.s,n.s),s=ls(t.l,n.l),a=ls(t.opacity,n.opacity);return function(o){return t.h=r(o),t.s=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const Axn=kVe(WU);var Txn=kVe(ls);function Dxn(e,t){var n=ls((e=OQ(e)).l,(t=OQ(t)).l),r=ls(e.a,t.a),i=ls(e.b,t.b),s=ls(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=s(a),e+""}}function EVe(e){return function(t,n){var r=e((t=RQ(t)).h,(n=RQ(n)).h),i=ls(t.c,n.c),s=ls(t.l,n.l),a=ls(t.opacity,n.opacity);return function(o){return t.h=r(o),t.c=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const Ixn=EVe(WU);var Nxn=EVe(ls);function AVe(e){return function t(n){n=+n;function r(i,s){var a=e((i=PQ(i)).h,(s=PQ(s)).h),o=ls(i.s,s.s),l=ls(i.l,s.l),u=ls(i.opacity,s.opacity);return function(c){return i.h=a(c),i.s=o(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}const Mxn=AVe(WU);var Fxn=AVe(ls);function Tue(e,t){t===void 0&&(t=e,e=Ax);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function Oxn(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const Rxn=Object.freeze(Object.defineProperty({__proto__:null,interpolate:Ax,interpolateArray:gxn,interpolateBasis:gVe,interpolateBasisClosed:mVe,interpolateDate:wVe,interpolateDiscrete:yxn,interpolateHue:bxn,interpolateNumber:wc,interpolateNumberArray:Aue,interpolateObject:$Ve,interpolateRound:VU,interpolateString:CVe,interpolateTransformCss:$xn,interpolateTransformSvg:Cxn,interpolateZoom:Exn,interpolateRgb:LQ,interpolateRgbBasis:dxn,interpolateRgbBasisClosed:pxn,interpolateHsl:Axn,interpolateHslLong:Txn,interpolateLab:Dxn,interpolateHcl:Ixn,interpolateHclLong:Nxn,interpolateCubehelix:Mxn,interpolateCubehelixLong:Fxn,piecewise:Tue,quantize:Oxn},Symbol.toStringTag,{value:"Module"}));function Pxn(e){return function(){return e}}function UQ(e){return+e}var zwe=[0,1];function Zo(e){return e}function WQ(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Pxn(isNaN(t)?NaN:.5)}function Lxn(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Bxn(e,t,n){var r=e[0],i=e[1],s=t[0],a=t[1];return i<r?(r=WQ(i,r),s=n(a,s)):(r=WQ(r,i),s=n(s,a)),function(o){return s(r(o))}}function zxn(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=WQ(e[a],e[a+1]),s[a]=n(t[a],t[a+1]);return function(o){var l=BU(e,o,1,r)-1;return s[l](i[l](o))}}function qM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function jU(){var e=zwe,t=zwe,n=Ax,r,i,s,a=Zo,o,l,u;function c(){var h=Math.min(e.length,t.length);return a!==Zo&&(a=Lxn(e[0],e[h-1])),o=h>2?zxn:Bxn,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?s:(l||(l=o(e.map(r),t,n)))(r(a(h)))}return f.invert=function(h){return a(i((u||(u=o(t,e.map(r),wc)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,UQ),c()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),n=VU,c()},f.clamp=function(h){return arguments.length?(a=h?!0:Zo,c()):a!==Zo},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,d){return r=h,i=d,c()}}function TVe(){return jU()(Zo,Zo)}function Uxn(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function W6(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function B$(e){return e=W6(Math.abs(e)),e?e[1]:NaN}function Wxn(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function Vxn(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var jxn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function db(e){if(!(t=jxn.exec(e)))throw new Error("invalid format: "+e);var t;return new Due({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}db.prototype=Due.prototype;function Due(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Due.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Hxn(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var DVe;function qxn(e,t){var n=W6(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(DVe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+W6(e,Math.max(0,t+s-1))[0]}function Uwe(e,t){var n=W6(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Wwe={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Uxn,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Uwe(e*100,t),r:Uwe,s:qxn,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Vwe(e){return e}var jwe=Array.prototype.map,Hwe=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Gxn(e){var t=e.grouping===void 0||e.thousands===void 0?Vwe:Wxn(jwe.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?Vwe:Vxn(jwe.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=db(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):Wwe[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var C=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=g==="$"?r:/[%p]/.test(w)?a:"",_=Wwe[w],k=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(S){var I=C,A=$,D,T,N;if(w==="c")A=_(S)+A,S="";else{S=+S;var F=S<0||1/S<0;if(S=isNaN(S)?l:_(Math.abs(S),b),x&&(S=Hxn(S)),F&&+S==0&&p!=="+"&&(F=!1),I=(F?p==="("?p:o:p==="-"||p==="("?"":p)+I,A=(w==="s"?Hwe[8+DVe/3]:"")+A+(F&&p==="("?")":""),k){for(D=-1,T=S.length;++D<T;)if(N=S.charCodeAt(D),48>N||N>57){A=(N===46?i+S.slice(D+1):S.slice(D))+A,S=S.slice(0,D);break}}}y&&!m&&(S=t(S,1/0));var R=I.length+S.length+A.length,P=R<v?new Array(v-R+1).join(h):"";switch(y&&m&&(S=t(P+S,P.length?v-A.length:1/0),P=""),d){case"<":S=I+S+A+P;break;case"=":S=I+P+S+A;break;case"^":S=P.slice(0,R=P.length>>1)+I+S+A+P.slice(R);break;default:S=P+I+S+A;break}return s(S)}return E.toString=function(){return f+""},E}function c(f,h){var d=u((f=db(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(B$(h)/3)))*3,g=Math.pow(10,-p),m=Hwe[8+p/3];return function(v){return d(g*v)+m}}return{format:u,formatPrefix:c}}var $R,HU,Iue;Yxn({thousands:",",grouping:[3],currency:["$",""]});function Yxn(e){return $R=Gxn(e),HU=$R.format,Iue=$R.formatPrefix,$R}function IVe(e){return Math.max(0,-B$(Math.abs(e)))}function NVe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(B$(t)/3)))*3-B$(Math.abs(e)))}function MVe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,B$(t)-B$(e))+1}function FVe(e,t,n,r){var i=Kbn(e,t,n),s;switch(r=db(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=NVe(i,a))&&(r.precision=s),Iue(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=MVe(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=IVe(i))&&(r.precision=s-(r.type==="%")*2);break}}return HU(r)}function Tx(e){var t=e.domain;return e.ticks=function(n){var r=t();return NQ(r[0],r[r.length-1],n==null?10:n)},e.tickFormat=function(n,r){var i=t();return FVe(i[0],i[i.length-1],n==null?10:n,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,a=r[i],o=r[s],l,u,c=10;for(o<a&&(u=a,a=o,o=u,u=i,i=s,s=u);c-- >0;){if(u=MQ(a,o,n),u===l)return r[i]=a,r[s]=o,t(r);if(u>0)a=Math.floor(a/u)*u,o=Math.ceil(o/u)*u;else if(u<0)a=Math.ceil(a*u)/u,o=Math.floor(o*u)/u;else break;l=u}return e},e}function OVe(){var e=TVe();return e.copy=function(){return qM(e,OVe())},md.apply(e,arguments),Tx(e)}function RVe(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,UQ),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return RVe(e).unknown(t)},e=arguments.length?Array.from(e,UQ):[0,1],Tx(n)}function PVe(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),e[n]=t.floor(i),e[r]=t.ceil(s),e}function qwe(e){return Math.log(e)}function Gwe(e){return Math.exp(e)}function Xxn(e){return-Math.log(-e)}function Kxn(e){return-Math.exp(-e)}function Zxn(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Qxn(e){return e===10?Zxn:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Jxn(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Ywe(e){return(t,n)=>-e(-t,n)}function Nue(e){const t=e(qwe,Gwe),n=t.domain;let r=10,i,s;function a(){return i=Jxn(r),s=Qxn(r),n()[0]<0?(i=Ywe(i),s=Ywe(s),e(Xxn,Kxn)):e(qwe,Gwe),t}return t.base=function(o){return arguments.length?(r=+o,a()):r},t.domain=function(o){return arguments.length?(n(o),a()):n()},t.ticks=o=>{const l=n();let u=l[0],c=l[l.length-1];const f=c<u;f&&([u,c]=[c,u]);let h=i(u),d=i(c),p,g;const m=o==null?10:+o;let v=[];if(!(r%1)&&d-h<m){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(p=1;p<r;++p)if(g=h<0?p/s(-h):p*s(h),!(g<u)){if(g>c)break;v.push(g)}}else for(;h<=d;++h)for(p=r-1;p>=1;--p)if(g=h>0?p/s(-h):p*s(h),!(g<u)){if(g>c)break;v.push(g)}v.length*2<m&&(v=NQ(u,c,m))}else v=NQ(h,d,Math.min(d-h,m)).map(s);return f?v.reverse():v},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=db(l)).precision==null&&(l.trim=!0),l=HU(l)),o===1/0)return l;const u=Math.max(1,r*o/t.ticks().length);return c=>{let f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=()=>n(PVe(n(),{floor:o=>s(Math.floor(i(o))),ceil:o=>s(Math.ceil(i(o)))})),t}function LVe(){const e=Nue(jU()).domain([1,10]);return e.copy=()=>qM(e,LVe()).base(e.base()),md.apply(e,arguments),e}function Xwe(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Kwe(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Mue(e){var t=1,n=e(Xwe(t),Kwe(t));return n.constant=function(r){return arguments.length?e(Xwe(t=+r),Kwe(t)):t},Tx(n)}function BVe(){var e=Mue(jU());return e.copy=function(){return qM(e,BVe()).constant(e.constant())},md.apply(e,arguments)}function Zwe(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function e2n(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function t2n(e){return e<0?-e*e:e*e}function Fue(e){var t=e(Zo,Zo),n=1;function r(){return n===1?e(Zo,Zo):n===.5?e(e2n,t2n):e(Zwe(n),Zwe(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Tx(t)}function Oue(){var e=Fue(jU());return e.copy=function(){return qM(e,Oue()).exponent(e.exponent())},md.apply(e,arguments),e}function n2n(){return Oue.apply(null,arguments).exponent(.5)}function zVe(){var e=[],t=[],n=[],r;function i(){var a=0,o=Math.max(1,t.length);for(n=new Array(o-1);++a<o;)n[a-1]=Zbn(e,a/o);return s}function s(a){return a==null||isNaN(a=+a)?r:t[BU(n,a)]}return s.invertExtent=function(a){var o=t.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},s.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let o of a)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(DA),i()},s.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return zVe().domain(e).range(t).unknown(r)},md.apply(s,arguments)}function UVe(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function a(l){return l!=null&&l<=l?i[BU(r,l,0,n)]:s}function o(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return a}return a.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},a.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,o()):i.slice()},a.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},a.unknown=function(l){return arguments.length&&(s=l),a},a.thresholds=function(){return r.slice()},a.copy=function(){return UVe().domain([e,t]).range(i).unknown(s)},md.apply(Tx(a),arguments)}function WVe(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[BU(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var a=t.indexOf(s);return[e[a-1],e[a]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return WVe().domain(e).range(t).unknown(n)},md.apply(i,arguments)}const Kq=new Date,Zq=new Date;function Gi(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>Gi(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(Kq.setTime(+s),Zq.setTime(+a),e(Kq),e(Zq),Math.floor(n(Kq,Zq))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const z$=Gi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);z$.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Gi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):z$);z$.range;const fp=1e3,_u=fp*60,hp=_u*60,Gp=hp*24,Rue=Gp*7,Qwe=Gp*30,Qq=Gp*365,dp=Gi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*fp)},(e,t)=>(t-e)/fp,e=>e.getUTCSeconds());dp.range;const qU=Gi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*fp)},(e,t)=>{e.setTime(+e+t*_u)},(e,t)=>(t-e)/_u,e=>e.getMinutes());qU.range;const GU=Gi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*_u)},(e,t)=>(t-e)/_u,e=>e.getUTCMinutes());GU.range;const YU=Gi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*fp-e.getMinutes()*_u)},(e,t)=>{e.setTime(+e+t*hp)},(e,t)=>(t-e)/hp,e=>e.getHours());YU.range;const XU=Gi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*hp)},(e,t)=>(t-e)/hp,e=>e.getUTCHours());XU.range;const xp=Gi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*_u)/Gp,e=>e.getDate()-1);xp.range;const C0=Gi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Gp,e=>e.getUTCDate()-1);C0.range;const VVe=Gi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Gp,e=>Math.floor(e/Gp));VVe.range;function Dx(e){return Gi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*_u)/Rue)}const cS=Dx(0),V6=Dx(1),r2n=Dx(2),i2n=Dx(3),U$=Dx(4),s2n=Dx(5),a2n=Dx(6);cS.range;V6.range;r2n.range;i2n.range;U$.range;s2n.range;a2n.range;function Ix(e){return Gi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/Rue)}const fS=Ix(0),j6=Ix(1),o2n=Ix(2),l2n=Ix(3),W$=Ix(4),u2n=Ix(5),c2n=Ix(6);fS.range;j6.range;o2n.range;l2n.range;W$.range;u2n.range;c2n.range;const vD=Gi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());vD.range;const yD=Gi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());yD.range;const qh=Gi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());qh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Gi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});qh.range;const Gh=Gi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Gh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Gi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Gh.range;function Jq(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function f2n(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function h2n(e){let t,n,r;e.length!==2?(t=Jq,n=(o,l)=>Jq(e(o),l),r=(o,l)=>e(o)-l):(t=e===Jq||e===f2n?e:d2n,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function d2n(){return 0}const p2n=Math.sqrt(50),g2n=Math.sqrt(10),m2n=Math.sqrt(2);function jVe(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=p2n?10:s>=g2n?5:s>=m2n?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?jVe(e,t,n*2):[o,l,u]}function Jwe(e,t,n){return t=+t,e=+e,n=+n,jVe(e,t,n)[2]}function e$e(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?Jwe(t,e,n):Jwe(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function HVe(e,t,n,r,i,s){const a=[[dp,1,fp],[dp,5,5*fp],[dp,15,15*fp],[dp,30,30*fp],[s,1,_u],[s,5,5*_u],[s,15,15*_u],[s,30,30*_u],[i,1,hp],[i,3,3*hp],[i,6,6*hp],[i,12,12*hp],[r,1,Gp],[r,2,2*Gp],[n,1,Rue],[t,1,Qwe],[t,3,3*Qwe],[e,1,Qq]];function o(u,c,f){const h=c<u;h&&([u,c]=[c,u]);const d=f&&typeof f.range=="function"?f:l(u,c,f),p=d?d.range(u,+c+1):[];return h?p.reverse():p}function l(u,c,f){const h=Math.abs(c-u)/f,d=h2n(([,,m])=>m).right(a,h);if(d===a.length)return e.every(e$e(u/Qq,c/Qq,f));if(d===0)return z$.every(Math.max(e$e(u,c,f),1));const[p,g]=a[h/a[d-1][2]<a[d][2]/h?d-1:d];return p.every(g)}return[o,l]}const[v2n,y2n]=HVe(Gh,yD,fS,VVe,XU,GU),[b2n,x2n]=HVe(qh,vD,cS,xp,YU,qU);function eG(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function tG(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Fk(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function w2n(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=Ok(i),c=Rk(i),f=Ok(s),h=Rk(s),d=Ok(a),p=Rk(a),g=Ok(o),m=Rk(o),v=Ok(l),y=Rk(l),b={a:F,A:R,b:P,B:V,c:null,d:a$e,e:a$e,f:j2n,g:ewn,G:nwn,H:U2n,I:W2n,j:V2n,L:qVe,m:H2n,M:q2n,p:z,q,Q:u$e,s:c$e,S:G2n,u:Y2n,U:X2n,V:K2n,w:Z2n,W:Q2n,x:null,X:null,y:J2n,Y:twn,Z:rwn,"%":l$e},x={a:G,A:K,b:Y,B:te,c:null,d:o$e,e:o$e,f:own,g:vwn,G:bwn,H:iwn,I:swn,j:awn,L:YVe,m:lwn,M:uwn,p:Z,q:ae,Q:u$e,s:c$e,S:cwn,u:fwn,U:hwn,V:dwn,w:pwn,W:gwn,x:null,X:null,y:mwn,Y:ywn,Z:xwn,"%":l$e},w={a:E,A:S,b:I,B:A,c:D,d:i$e,e:i$e,f:P2n,g:r$e,G:n$e,H:s$e,I:s$e,j:M2n,L:R2n,m:N2n,M:F2n,p:k,q:I2n,Q:B2n,s:z2n,S:O2n,u:k2n,U:E2n,V:A2n,w:S2n,W:T2n,x:T,X:N,y:r$e,Y:n$e,Z:D2n,"%":L2n};b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x);function C(O,L){return function(W){var M=[],ue=-1,X=0,se=O.length,oe,pe,Ce;for(W instanceof Date||(W=new Date(+W));++ue<se;)O.charCodeAt(ue)===37&&(M.push(O.slice(X,ue)),(pe=t$e[oe=O.charAt(++ue)])!=null?oe=O.charAt(++ue):pe=oe==="e"?" ":"0",(Ce=L[oe])&&(oe=Ce(W,pe)),M.push(oe),X=ue+1);return M.push(O.slice(X,ue)),M.join("")}}function $(O,L){return function(W){var M=Fk(1900,void 0,1),ue=_(M,O,W+="",0),X,se;if(ue!=W.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(L&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(X=tG(Fk(M.y,0,1)),se=X.getUTCDay(),X=se>4||se===0?j6.ceil(X):j6(X),X=C0.offset(X,(M.V-1)*7),M.y=X.getUTCFullYear(),M.m=X.getUTCMonth(),M.d=X.getUTCDate()+(M.w+6)%7):(X=eG(Fk(M.y,0,1)),se=X.getDay(),X=se>4||se===0?V6.ceil(X):V6(X),X=xp.offset(X,(M.V-1)*7),M.y=X.getFullYear(),M.m=X.getMonth(),M.d=X.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),se="Z"in M?tG(Fk(M.y,0,1)).getUTCDay():eG(Fk(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(se+5)%7:M.w+M.U*7-(se+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,tG(M)):eG(M)}}function _(O,L,W,M){for(var ue=0,X=L.length,se=W.length,oe,pe;ue<X;){if(M>=se)return-1;if(oe=L.charCodeAt(ue++),oe===37){if(oe=L.charAt(ue++),pe=w[oe in t$e?L.charAt(ue++):oe],!pe||(M=pe(O,W,M))<0)return-1}else if(oe!=W.charCodeAt(M++))return-1}return M}function k(O,L,W){var M=u.exec(L.slice(W));return M?(O.p=c.get(M[0].toLowerCase()),W+M[0].length):-1}function E(O,L,W){var M=d.exec(L.slice(W));return M?(O.w=p.get(M[0].toLowerCase()),W+M[0].length):-1}function S(O,L,W){var M=f.exec(L.slice(W));return M?(O.w=h.get(M[0].toLowerCase()),W+M[0].length):-1}function I(O,L,W){var M=v.exec(L.slice(W));return M?(O.m=y.get(M[0].toLowerCase()),W+M[0].length):-1}function A(O,L,W){var M=g.exec(L.slice(W));return M?(O.m=m.get(M[0].toLowerCase()),W+M[0].length):-1}function D(O,L,W){return _(O,t,L,W)}function T(O,L,W){return _(O,n,L,W)}function N(O,L,W){return _(O,r,L,W)}function F(O){return a[O.getDay()]}function R(O){return s[O.getDay()]}function P(O){return l[O.getMonth()]}function V(O){return o[O.getMonth()]}function z(O){return i[+(O.getHours()>=12)]}function q(O){return 1+~~(O.getMonth()/3)}function G(O){return a[O.getUTCDay()]}function K(O){return s[O.getUTCDay()]}function Y(O){return l[O.getUTCMonth()]}function te(O){return o[O.getUTCMonth()]}function Z(O){return i[+(O.getUTCHours()>=12)]}function ae(O){return 1+~~(O.getUTCMonth()/3)}return{format:function(O){var L=C(O+="",b);return L.toString=function(){return O},L},parse:function(O){var L=$(O+="",!1);return L.toString=function(){return O},L},utcFormat:function(O){var L=C(O+="",x);return L.toString=function(){return O},L},utcParse:function(O){var L=$(O+="",!0);return L.toString=function(){return O},L}}}var t$e={"-":"",_:" ",0:"0"},Es=/^\s*\d+/,$2n=/^%/,C2n=/[\\^$*+?|[\]().{}]/g;function kn(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function _2n(e){return e.replace(C2n,"\\$&")}function Ok(e){return new RegExp("^(?:"+e.map(_2n).join("|")+")","i")}function Rk(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function S2n(e,t,n){var r=Es.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function k2n(e,t,n){var r=Es.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function E2n(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function A2n(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function T2n(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function n$e(e,t,n){var r=Es.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function r$e(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function D2n(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function I2n(e,t,n){var r=Es.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function N2n(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function i$e(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function M2n(e,t,n){var r=Es.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function s$e(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function F2n(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function O2n(e,t,n){var r=Es.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function R2n(e,t,n){var r=Es.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function P2n(e,t,n){var r=Es.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function L2n(e,t,n){var r=$2n.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function B2n(e,t,n){var r=Es.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function z2n(e,t,n){var r=Es.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function a$e(e,t){return kn(e.getDate(),t,2)}function U2n(e,t){return kn(e.getHours(),t,2)}function W2n(e,t){return kn(e.getHours()%12||12,t,2)}function V2n(e,t){return kn(1+xp.count(qh(e),e),t,3)}function qVe(e,t){return kn(e.getMilliseconds(),t,3)}function j2n(e,t){return qVe(e,t)+"000"}function H2n(e,t){return kn(e.getMonth()+1,t,2)}function q2n(e,t){return kn(e.getMinutes(),t,2)}function G2n(e,t){return kn(e.getSeconds(),t,2)}function Y2n(e){var t=e.getDay();return t===0?7:t}function X2n(e,t){return kn(cS.count(qh(e)-1,e),t,2)}function GVe(e){var t=e.getDay();return t>=4||t===0?U$(e):U$.ceil(e)}function K2n(e,t){return e=GVe(e),kn(U$.count(qh(e),e)+(qh(e).getDay()===4),t,2)}function Z2n(e){return e.getDay()}function Q2n(e,t){return kn(V6.count(qh(e)-1,e),t,2)}function J2n(e,t){return kn(e.getFullYear()%100,t,2)}function ewn(e,t){return e=GVe(e),kn(e.getFullYear()%100,t,2)}function twn(e,t){return kn(e.getFullYear()%1e4,t,4)}function nwn(e,t){var n=e.getDay();return e=n>=4||n===0?U$(e):U$.ceil(e),kn(e.getFullYear()%1e4,t,4)}function rwn(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+kn(t/60|0,"0",2)+kn(t%60,"0",2)}function o$e(e,t){return kn(e.getUTCDate(),t,2)}function iwn(e,t){return kn(e.getUTCHours(),t,2)}function swn(e,t){return kn(e.getUTCHours()%12||12,t,2)}function awn(e,t){return kn(1+C0.count(Gh(e),e),t,3)}function YVe(e,t){return kn(e.getUTCMilliseconds(),t,3)}function own(e,t){return YVe(e,t)+"000"}function lwn(e,t){return kn(e.getUTCMonth()+1,t,2)}function uwn(e,t){return kn(e.getUTCMinutes(),t,2)}function cwn(e,t){return kn(e.getUTCSeconds(),t,2)}function fwn(e){var t=e.getUTCDay();return t===0?7:t}function hwn(e,t){return kn(fS.count(Gh(e)-1,e),t,2)}function XVe(e){var t=e.getUTCDay();return t>=4||t===0?W$(e):W$.ceil(e)}function dwn(e,t){return e=XVe(e),kn(W$.count(Gh(e),e)+(Gh(e).getUTCDay()===4),t,2)}function pwn(e){return e.getUTCDay()}function gwn(e,t){return kn(j6.count(Gh(e)-1,e),t,2)}function mwn(e,t){return kn(e.getUTCFullYear()%100,t,2)}function vwn(e,t){return e=XVe(e),kn(e.getUTCFullYear()%100,t,2)}function ywn(e,t){return kn(e.getUTCFullYear()%1e4,t,4)}function bwn(e,t){var n=e.getUTCDay();return e=n>=4||n===0?W$(e):W$.ceil(e),kn(e.getUTCFullYear()%1e4,t,4)}function xwn(){return"+0000"}function l$e(){return"%"}function u$e(e){return+e}function c$e(e){return Math.floor(+e/1e3)}var m2,Pue,KVe,Lue,ZVe;wwn({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function wwn(e){return m2=w2n(e),Pue=m2.format,KVe=m2.parse,Lue=m2.utcFormat,ZVe=m2.utcParse,m2}function $wn(e){return new Date(e)}function Cwn(e){return e instanceof Date?+e:+new Date(+e)}function Bue(e,t,n,r,i,s,a,o,l,u){var c=TVe(),f=c.invert,h=c.domain,d=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),x=u("%Y");function w(C){return(l(C)<C?d:o(C)<C?p:a(C)<C?g:s(C)<C?m:r(C)<C?i(C)<C?v:y:n(C)<C?b:x)(C)}return c.invert=function(C){return new Date(f(C))},c.domain=function(C){return arguments.length?h(Array.from(C,Cwn)):h().map($wn)},c.ticks=function(C){var $=h();return e($[0],$[$.length-1],C==null?10:C)},c.tickFormat=function(C,$){return $==null?w:u($)},c.nice=function(C){var $=h();return(!C||typeof C.range!="function")&&(C=t($[0],$[$.length-1],C==null?10:C)),C?h(PVe($,C)):c},c.copy=function(){return qM(c,Bue(e,t,n,r,i,s,a,o,l,u))},c}function _wn(){return md.apply(Bue(b2n,x2n,qh,vD,cS,xp,YU,qU,dp,Pue).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Swn(){return md.apply(Bue(v2n,y2n,Gh,yD,fS,C0,XU,GU,dp,Lue).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function KU(){var e=0,t=1,n,r,i,s,a=Zo,o=!1,l;function u(f){return f==null||isNaN(f=+f)?l:a(i===0?.5:(f=(s(f)-n)*i,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(a=f,u):a};function c(f){return function(h){var d,p;return arguments.length?([d,p]=h,a=f(d,p),u):[a(0),a(1)]}}return u.range=c(Ax),u.rangeRound=c(VU),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function lv(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function zue(){var e=Tx(KU()(Zo));return e.copy=function(){return lv(e,zue())},av.apply(e,arguments)}function QVe(){var e=Nue(KU()).domain([1,10]);return e.copy=function(){return lv(e,QVe()).base(e.base())},av.apply(e,arguments)}function JVe(){var e=Mue(KU());return e.copy=function(){return lv(e,JVe()).constant(e.constant())},av.apply(e,arguments)}function Uue(){var e=Fue(KU());return e.copy=function(){return lv(e,Uue()).exponent(e.exponent())},av.apply(e,arguments)}function kwn(){return Uue.apply(null,arguments).exponent(.5)}function ZU(){var e=0,t=.5,n=1,r=1,i,s,a,o,l,u=Zo,c,f=!1,h;function d(g){return isNaN(g=+g)?h:(g=.5+((g=+c(g))-s)*(r*g<r*s?o:l),u(f?Math.max(0,Math.min(1,g)):g))}d.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),s=c(t=+t),a=c(n=+n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d):[e,t,n]},d.clamp=function(g){return arguments.length?(f=!!g,d):f},d.interpolator=function(g){return arguments.length?(u=g,d):u};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,u=Tue(g,[v,y,b]),d):[u(0),u(.5),u(1)]}}return d.range=p(Ax),d.rangeRound=p(VU),d.unknown=function(g){return arguments.length?(h=g,d):h},function(g){return c=g,i=g(e),s=g(t),a=g(n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,d}}function eje(){var e=Tx(ZU()(Zo));return e.copy=function(){return lv(e,eje())},av.apply(e,arguments)}function tje(){var e=Nue(ZU()).domain([.1,1,10]);return e.copy=function(){return lv(e,tje()).base(e.base())},av.apply(e,arguments)}function nje(){var e=Mue(ZU());return e.copy=function(){return lv(e,nje()).constant(e.constant())},av.apply(e,arguments)}function Wue(){var e=Fue(ZU());return e.copy=function(){return lv(e,Wue()).exponent(e.exponent())},av.apply(e,arguments)}function Ewn(){return Wue.apply(null,arguments).exponent(.5)}const _0="year",pb="quarter",wp="month",gb="week",ym="date",hS="day",GM="dayofyear",mb="hours",vb="minutes",V$="seconds",YM="milliseconds",Awn=[_0,pb,wp,gb,ym,hS,GM,mb,vb,V$,YM],nG=Awn.reduce((e,t,n)=>(e[t]=1+n,e),{});function Twn(e){const t=P$(e).slice(),n={};return t.length||br("Missing time unit."),t.forEach(i=>{Ns(nG,i)?n[i]=1:br(`Invalid time unit: ${i}.`)}),(n[gb]||n[hS]?1:0)+(n[pb]||n[wp]||n[ym]?1:0)+(n[GM]?1:0)>1&&br(`Incompatible time units: ${e}`),t.sort((i,s)=>nG[i]-nG[s]),t}const Dwn={[_0]:"%Y ",[pb]:"Q%q ",[wp]:"%b ",[ym]:"%d ",[gb]:"W%U ",[hS]:"%a ",[GM]:"%j ",[mb]:"%H:00",[vb]:"00:%M",[V$]:":%S",[YM]:".%L",[`${_0}-${wp}`]:"%Y-%m ",[`${_0}-${wp}-${ym}`]:"%Y-%m-%d ",[`${mb}-${vb}`]:"%H:%M"};function Iwn(e,t){const n=Ex({},Dwn,t),r=Twn(e),i=r.length;let s="",a=0,o,l;for(a=0;a<i;)for(o=r.length;o>a;--o)if(l=r.slice(a,o).join("-"),n[l]!=null){s+=n[l],a=o;break}return s.trim()}const Pk=new Date;function rje(e){return Pk.setFullYear(e),Pk.setMonth(0),Pk.setDate(1),Pk.setHours(0,0,0,0),Pk}function Nwn(e){return Fwn(new Date(e))}function Mwn(e){return Own(new Date(e))}function Fwn(e){return xp.count(rje(e.getFullYear())-1,e)}function Own(e){return cS.count(rje(e.getFullYear())-1,e)}function Rwn(e){return Lwn(new Date(e))}function Pwn(e){return Bwn(new Date(e))}function Lwn(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return C0.count(t-1,e)}function Bwn(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return fS.count(t-1,e)}const zwn={[_0]:qh,[pb]:vD.every(3),[wp]:vD,[gb]:cS,[ym]:xp,[hS]:xp,[GM]:xp,[mb]:YU,[vb]:qU,[V$]:dp,[YM]:z$},Uwn={[_0]:Gh,[pb]:yD.every(3),[wp]:yD,[gb]:fS,[ym]:C0,[hS]:C0,[GM]:C0,[mb]:XU,[vb]:GU,[V$]:dp,[YM]:z$};function Vue(e){return zwn[e]}function jue(e){return Uwn[e]}function ije(e,t,n){return e?e.offset(t,n):void 0}function Wwn(e,t,n){return ije(Vue(e),t,n)}function Vwn(e,t,n){return ije(jue(e),t,n)}function sje(e,t,n,r){return e?e.range(t,n,r):void 0}function jwn(e,t,n,r){return sje(Vue(e),t,n,r)}function Hwn(e,t,n,r){return sje(jue(e),t,n,r)}function aje(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const qwn="identity",Hue="linear",bm="log",que="pow",Gue="sqrt",Yue="symlog",bD="time",xD="utc",dS="sequential",XM="diverging",H6="quantile",Xue="quantize",oje="threshold",Gwn="ordinal",Ywn="point",Xwn="band",Kwn="bin-ordinal",As="continuous",KM="discrete",ZM="discretizing",mf="interpolating",Kue="temporal";function Zwn(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function Qwn(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,a,o,l,u;for(i<r&&(o=r,r=i,i=o),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(s<0&&(s=l),a=l);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[a]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function Zue(){const e=_ue().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,a=!1,o=0,l=0,u=.5;delete e.unknown;function c(){const f=t().length,h=r[1]<r[0],d=r[1-h],p=aje(f,o,l);let g=r[h-0];i=(d-g)/(p||1),a&&(i=Math.floor(i)),g+=(d-g-i*(f-o))*u,s=i*(1-o),a&&(g=Math.round(g),s=Math.round(s));const m=Wbn(f).map(v=>g+i*v);return n(h?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),o=l,c()):o},e.paddingInner=function(f){return arguments.length?(o=Math.max(0,Math.min(1,f)),c()):o},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const h=r[1]<r[0],d=h?n().reverse():n(),p=d.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<d[0]||g>r[1-h])))return v=Math.max(0,IQ(d,g)-1),y=g===m?v:IQ(d,m)-1,g-d[v]>s+1e-10&&++v,h&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const h=e.invertRange([f,f]);return h&&h[0]},e.copy=function(){return Zue().domain(t()).range(r).round(a).paddingInner(o).paddingOuter(l).align(u)},c()}function lje(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return lje(t())},e}function Jwn(){return lje(Zue().paddingInner(1))}var e$n=Array.prototype.map;function t$n(e){return e$n.call(e,RU)}const n$n=Array.prototype.slice;function uje(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(Ubn(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=t$n(r),n):e.slice()},n.range=function(r){return arguments.length?(t=n$n.call(r),n):t.slice()},n.tickFormat=function(r,i){return FVe(e[0],xo(e),r==null?10:r,i)},n.copy=function(){return uje().domain(n.domain()).range(n.range())},n}const q6=new Map,r$n=Symbol("vega_scale");function i$n(e){return e[r$n]=!0,e}function s$n(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?Zwn(s):s.invertExtent?Qwn(s):void 0),s.type=e,i$n(s)};return r.metadata=P6(P$(n)),r}function Hn(e,t,n){return arguments.length>1?(q6.set(e,s$n(e,t,n)),this):a$n(e)?q6.get(e):void 0}Hn(qwn,RVe);Hn(Hue,OVe,As);Hn(bm,LVe,[As,bm]);Hn(que,Oue,As);Hn(Gue,n2n,As);Hn(Yue,BVe,As);Hn(bD,_wn,[As,Kue]);Hn(xD,Swn,[As,Kue]);Hn(dS,zue,[As,mf]);Hn(`${dS}-${Hue}`,zue,[As,mf]);Hn(`${dS}-${bm}`,QVe,[As,mf,bm]);Hn(`${dS}-${que}`,Uue,[As,mf]);Hn(`${dS}-${Gue}`,kwn,[As,mf]);Hn(`${dS}-${Yue}`,JVe,[As,mf]);Hn(`${XM}-${Hue}`,eje,[As,mf]);Hn(`${XM}-${bm}`,tje,[As,mf,bm]);Hn(`${XM}-${que}`,Wue,[As,mf]);Hn(`${XM}-${Gue}`,Ewn,[As,mf]);Hn(`${XM}-${Yue}`,nje,[As,mf]);Hn(H6,zVe,[ZM,H6]);Hn(Xue,UVe,ZM);Hn(oje,WVe,ZM);Hn(Kwn,uje,[KM,ZM]);Hn(Gwn,_ue,KM);Hn(Xwn,Zue,KM);Hn(Ywn,Jwn,KM);function a$n(e){return q6.has(e)}function QU(e,t){const n=q6.get(e);return n&&n.metadata[t]}function cje(e){return QU(e,KM)}function o$n(e){return QU(e,ZM)}function l$n(e){return QU(e,bm)}function u$n(e){return QU(e,Kue)}const c$n=["clamp","base","constant","exponent"];function f$n(e,t,n){return Tue(d$n(t||"rgb",n),e)}function h$n(e,t,n){const r=n-t;let i,s,a;return!r||!Number.isFinite(r)?ubn(.5):(i=(s=e.type).indexOf("-"),s=i<0?s:s.slice(i+1),a=Hn(s)().domain([t,n]).range([0,1]),c$n.forEach(o=>e[o]?a[o](e[o]()):0),a)}function d$n(e,t){const n=Rxn[p$n(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function p$n(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const g$n={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},m$n={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function fje(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function hje(e,t){for(const n in e)v$n(n,t(e[n]))}const f$e={};hje(m$n,fje);hje(g$n,e=>f$n(fje(e)));function v$n(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(f$e[e]=t,this):f$e[e]}const y$n="symbol",b$n="discrete",x$n=e=>Ma(e)?e.map(t=>String(t)):String(e),w$n=(e,t)=>e[1]-t[1],$$n=(e,t)=>t[1]-e[1];function C$n(e,t,n){let r=e.range(),i=r[0],s=xo(r),a=w$n;if(i>s&&(r=s,s=i,i=r,a=$$n),i=Math.floor(i),s=Math.ceil(s),t=t.map(o=>[o,e(o)]).filter(o=>i<=o[1]&&o[1]<=s).sort(a).map(o=>o[0]),n>0&&t.length>1){const o=[t[0],xo(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=o)}return t}function dje(e,t){return e.bins?C$n(e,e.bins):e.ticks?e.ticks(t):e.domain()}function _$n(e,t,n,r,i,s){const a=t.type;let o=x$n;if(a===bD||i===bD)o=e.timeFormat(r);else if(a===xD||i===xD)o=e.utcFormat(r);else if(l$n(a)){const l=e.formatFloat(r);if(s||t.bins)o=l;else{const u=pje(t,n,!1);o=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();o=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(o=e.format(r));return o}function pje(e,t,n){const r=dje(e,t),i=e.base(),s=Math.log(i),a=Math.max(1,i*t/r.length),o=l=>{let u=l/Math.pow(i,Math.round(Math.log(l)/s));return u*i<i-.5&&(u*=i),u<=a};return n?r.filter(o):o}const VQ={[H6]:"quantiles",[Xue]:"thresholds",[oje]:"domain"},gje={[H6]:"quantiles",[Xue]:"domain"};function S$n(e,t){return e.bins?A$n(e.bins):e.type===bm?pje(e,t,!0):VQ[e.type]?E$n(e[VQ[e.type]]()):dje(e,t)}function k$n(e,t,n){const r=t[gje[t.type]](),i=r.length;let s=i>1?r[1]-r[0]:r[0],a;for(a=1;a<i;++a)s=Math.min(s,r[a]-r[a-1]);return e.formatSpan(0,s,3*10,n)}function E$n(e){const t=[-1/0].concat(e);return t.max=1/0,t}function A$n(e){const t=e.slice(0,-1);return t.max=xo(e),t}const T$n=e=>VQ[e.type]||e.bins;function D$n(e,t,n,r,i,s,a){const o=gje[t.type]&&s!==bD&&s!==xD?k$n(e,t,i):_$n(e,t,n,i,s,a);return r===y$n&&T$n(t)?I$n(o):r===b$n?N$n(o):M$n(o)}const I$n=e=>(t,n,r)=>{const i=h$e(r[n+1],h$e(r.max,1/0)),s=d$e(t,e),a=d$e(i,e);return s&&a?s+" \u2013 "+a:a?"< "+a:"\u2265 "+s},h$e=(e,t)=>e!=null?e:t,N$n=e=>(t,n)=>n?e(t):null,M$n=e=>t=>e(t),d$e=(e,t)=>Number.isFinite(e)?t(e):null;function F$n(e,t,n,r){const i=r||t.type;return vm(n)&&u$n(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===bD?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===xD?e.utcFormat("%A, %d %B %Y, %X UTC"):D$n(e,t,5,null,n,r,!0)}function mje(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=F$n(e,t,n.format,n.formatType);if(o$n(t.type)){const s=S$n(t).slice(1).map(i),a=s.length;return`${a} boundar${a===1?"y":"ies"}: ${s.join(", ")}`}else if(cje(t.type)){const s=t.domain(),a=s.length,o=a>r?s.slice(0,r-2).map(i).join(", ")+", ending with "+s.slice(-1).map(i):s.map(i).join(", ");return`${a} value${a===1?"":"s"}: ${o}`}else{const s=t.domain();return`values from ${i(s[0])} to ${i(xo(s))}`}}function Mn(e){return function(){return e}}const p$e=Math.abs,ea=Math.atan2,Iv=Math.cos,O$n=Math.max,rG=Math.min,Tf=Math.sin,W1=Math.sqrt,ia=1e-12,j$=Math.PI,G6=j$/2,vje=2*j$;function R$n(e){return e>1?0:e<-1?j$:Math.acos(e)}function g$e(e){return e>=1?G6:e<=-1?-G6:Math.asin(e)}const jQ=Math.PI,HQ=2*jQ,t1=1e-6,P$n=HQ-t1;function yje(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function L$n(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return yje;const n=10**t;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class Que{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?yje:L$n(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,a){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,l=r-t,u=i-n,c=a-t,f=o-n,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>t1)if(!(Math.abs(f*l-u*c)>t1)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let d=r-a,p=i-o,g=l*l+u*u,m=d*d+p*p,v=Math.sqrt(g),y=Math.sqrt(h),b=s*Math.tan((jQ-Math.acos((g+h-m)/(2*v*y)))/2),x=b/y,w=b/v;Math.abs(x-1)>t1&&this._append`L${t+x*c},${n+x*f}`,this._append`A${s},${s},0,0,${+(f*d>c*p)},${this._x1=t+w*l},${this._y1=n+w*u}`}}arc(t,n,r,i,s,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),l=r*Math.sin(i),u=t+o,c=n+l,f=1^a,h=a?i-s:s-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>t1||Math.abs(this._y1-c)>t1)&&this._append`L${u},${c}`,r&&(h<0&&(h=h%HQ+HQ),h>P$n?this._append`A${r},${r},0,1,${f},${t-o},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:h>t1&&this._append`A${r},${r},0,${+(h>=jQ)},${f},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Jue(){return new Que}Jue.prototype=Que.prototype;function JU(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new Que(t)}function B$n(e){return e.innerRadius}function z$n(e){return e.outerRadius}function U$n(e){return e.startAngle}function W$n(e){return e.endAngle}function V$n(e){return e&&e.padAngle}function j$n(e,t,n,r,i,s,a,o){var l=n-e,u=r-t,c=a-i,f=o-s,h=f*l-c*u;if(!(h*h<ia))return h=(c*(t-s)-f*(e-i))/h,[e+h*l,t+h*u]}function CR(e,t,n,r,i,s,a){var o=e-n,l=t-r,u=(a?s:-s)/W1(o*o+l*l),c=u*l,f=-u*o,h=e+c,d=t+f,p=n+c,g=r+f,m=(h+p)/2,v=(d+g)/2,y=p-h,b=g-d,x=y*y+b*b,w=i-s,C=h*g-p*d,$=(b<0?-1:1)*W1(O$n(0,w*w*x-C*C)),_=(C*b-y*$)/x,k=(-C*y-b*$)/x,E=(C*b+y*$)/x,S=(-C*y+b*$)/x,I=_-m,A=k-v,D=E-m,T=S-v;return I*I+A*A>D*D+T*T&&(_=E,k=S),{cx:_,cy:k,x01:-c,y01:-f,x11:_*(i/w-1),y11:k*(i/w-1)}}function H$n(){var e=B$n,t=z$n,n=Mn(0),r=null,i=U$n,s=W$n,a=V$n,o=null,l=JU(u);function u(){var c,f,h=+e.apply(this,arguments),d=+t.apply(this,arguments),p=i.apply(this,arguments)-G6,g=s.apply(this,arguments)-G6,m=p$e(g-p),v=g>p;if(o||(o=c=l()),d<h&&(f=d,d=h,h=f),!(d>ia))o.moveTo(0,0);else if(m>vje-ia)o.moveTo(d*Iv(p),d*Tf(p)),o.arc(0,0,d,p,g,!v),h>ia&&(o.moveTo(h*Iv(g),h*Tf(g)),o.arc(0,0,h,g,p,v));else{var y=p,b=g,x=p,w=g,C=m,$=m,_=a.apply(this,arguments)/2,k=_>ia&&(r?+r.apply(this,arguments):W1(h*h+d*d)),E=rG(p$e(d-h)/2,+n.apply(this,arguments)),S=E,I=E,A,D;if(k>ia){var T=g$e(k/h*Tf(_)),N=g$e(k/d*Tf(_));(C-=T*2)>ia?(T*=v?1:-1,x+=T,w-=T):(C=0,x=w=(p+g)/2),($-=N*2)>ia?(N*=v?1:-1,y+=N,b-=N):($=0,y=b=(p+g)/2)}var F=d*Iv(y),R=d*Tf(y),P=h*Iv(w),V=h*Tf(w);if(E>ia){var z=d*Iv(b),q=d*Tf(b),G=h*Iv(x),K=h*Tf(x),Y;if(m<j$)if(Y=j$n(F,R,G,K,z,q,P,V)){var te=F-Y[0],Z=R-Y[1],ae=z-Y[0],O=q-Y[1],L=1/Tf(R$n((te*ae+Z*O)/(W1(te*te+Z*Z)*W1(ae*ae+O*O)))/2),W=W1(Y[0]*Y[0]+Y[1]*Y[1]);S=rG(E,(h-W)/(L-1)),I=rG(E,(d-W)/(L+1))}else S=I=0}$>ia?I>ia?(A=CR(G,K,F,R,d,I,v),D=CR(z,q,P,V,d,I,v),o.moveTo(A.cx+A.x01,A.cy+A.y01),I<E?o.arc(A.cx,A.cy,I,ea(A.y01,A.x01),ea(D.y01,D.x01),!v):(o.arc(A.cx,A.cy,I,ea(A.y01,A.x01),ea(A.y11,A.x11),!v),o.arc(0,0,d,ea(A.cy+A.y11,A.cx+A.x11),ea(D.cy+D.y11,D.cx+D.x11),!v),o.arc(D.cx,D.cy,I,ea(D.y11,D.x11),ea(D.y01,D.x01),!v))):(o.moveTo(F,R),o.arc(0,0,d,y,b,!v)):o.moveTo(F,R),!(h>ia)||!(C>ia)?o.lineTo(P,V):S>ia?(A=CR(P,V,z,q,h,-S,v),D=CR(F,R,G,K,h,-S,v),o.lineTo(A.cx+A.x01,A.cy+A.y01),S<E?o.arc(A.cx,A.cy,S,ea(A.y01,A.x01),ea(D.y01,D.x01),!v):(o.arc(A.cx,A.cy,S,ea(A.y01,A.x01),ea(A.y11,A.x11),!v),o.arc(0,0,h,ea(A.cy+A.y11,A.cx+A.x11),ea(D.cy+D.y11,D.cx+D.x11),v),o.arc(D.cx,D.cy,S,ea(D.y11,D.x11),ea(D.y01,D.x01),!v))):o.arc(0,0,h,w,x,v)}if(o.closePath(),c)return o=null,c+""||null}return u.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-j$/2;return[Iv(f)*c,Tf(f)*c]},u.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Mn(+c),u):e},u.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Mn(+c),u):t},u.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Mn(+c),u):n},u.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Mn(+c),u):r},u.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:Mn(+c),u):i},u.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Mn(+c),u):s},u.padAngle=function(c){return arguments.length?(a=typeof c=="function"?c:Mn(+c),u):a},u.context=function(c){return arguments.length?(o=c==null?null:c,u):o},u}function bje(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function xje(e){this._context=e}xje.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function ece(e){return new xje(e)}function wje(e){return e[0]}function $je(e){return e[1]}function Cje(e,t){var n=Mn(!0),r=null,i=ece,s=null,a=JU(o);e=typeof e=="function"?e:e===void 0?wje:Mn(e),t=typeof t=="function"?t:t===void 0?$je:Mn(t);function o(l){var u,c=(l=bje(l)).length,f,h=!1,d;for(r==null&&(s=i(d=a())),u=0;u<=c;++u)!(u<c&&n(f=l[u],u,l))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(f,u,l),+t(f,u,l));if(d)return s=null,d+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:Mn(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:Mn(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:Mn(!!l),o):n},o.curve=function(l){return arguments.length?(i=l,r!=null&&(s=i(r)),o):i},o.context=function(l){return arguments.length?(l==null?r=s=null:s=i(r=l),o):r},o}function _je(e,t,n){var r=null,i=Mn(!0),s=null,a=ece,o=null,l=JU(u);e=typeof e=="function"?e:e===void 0?wje:Mn(+e),t=typeof t=="function"?t:Mn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?$je:Mn(+n);function u(f){var h,d,p,g=(f=bje(f)).length,m,v=!1,y,b=new Array(g),x=new Array(g);for(s==null&&(o=a(y=l())),h=0;h<=g;++h){if(!(h<g&&i(m=f[h],h,f))===v)if(v=!v)d=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=h-1;p>=d;--p)o.point(b[p],x[p]);o.lineEnd(),o.areaEnd()}v&&(b[h]=+e(m,h,f),x[h]=+t(m,h,f),o.point(r?+r(m,h,f):b[h],n?+n(m,h,f):x[h]))}if(y)return o=null,y+""||null}function c(){return Cje().defined(i).curve(a).context(s)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:Mn(+f),r=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Mn(+f),u):e},u.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Mn(+f),u):r},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:Mn(+f),n=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Mn(+f),u):t},u.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Mn(+f),u):n},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(n)},u.lineX1=function(){return c().x(r).y(t)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:Mn(!!f),u):i},u.curve=function(f){return arguments.length?(a=f,s!=null&&(o=a(s)),u):a},u.context=function(f){return arguments.length?(f==null?s=o=null:o=a(s=f),u):s},u}const q$n={draw(e,t){const n=W1(t/j$);e.moveTo(n,0),e.arc(0,0,n,0,vje)}};function G$n(e,t){let n=null,r=JU(i);e=typeof e=="function"?e:Mn(e||q$n),t=typeof t=="function"?t:Mn(t===void 0?64:+t);function i(){let s;if(n||(n=s=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:Mn(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:Mn(+s),i):t},i.context=function(s){return arguments.length?(n=s==null?null:s,i):n},i}function xm(){}function Y6(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function eW(e){this._context=e}eW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Y6(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Y6(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Y$n(e){return new eW(e)}function Sje(e){this._context=e}Sje.prototype={areaStart:xm,areaEnd:xm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Y6(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function X$n(e){return new Sje(e)}function kje(e){this._context=e}kje.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Y6(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function K$n(e){return new kje(e)}function Eje(e,t){this._basis=new eW(e),this._beta=t}Eje.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,a=t[n]-i,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*s),this._beta*t[o]+(1-this._beta)*(i+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const Z$n=function e(t){function n(r){return t===1?new eW(r):new Eje(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function X6(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function tce(e,t){this._context=e,this._k=(1-t)/6}tce.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:X6(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:X6(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Q$n=function e(t){function n(r){return new tce(r,t)}return n.tension=function(r){return e(+r)},n}(0);function nce(e,t){this._context=e,this._k=(1-t)/6}nce.prototype={areaStart:xm,areaEnd:xm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:X6(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const J$n=function e(t){function n(r){return new nce(r,t)}return n.tension=function(r){return e(+r)},n}(0);function rce(e,t){this._context=e,this._k=(1-t)/6}rce.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:X6(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const eCn=function e(t){function n(r){return new rce(r,t)}return n.tension=function(r){return e(+r)},n}(0);function ice(e,t,n){var r=e._x1,i=e._y1,s=e._x2,a=e._y2;if(e._l01_a>ia){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>ia){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,s,a,e._x2,e._y2)}function Aje(e,t){this._context=e,this._alpha=t}Aje.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:ice(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const tCn=function e(t){function n(r){return t?new Aje(r,t):new tce(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Tje(e,t){this._context=e,this._alpha=t}Tje.prototype={areaStart:xm,areaEnd:xm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:ice(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const nCn=function e(t){function n(r){return t?new Tje(r,t):new nce(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Dje(e,t){this._context=e,this._alpha=t}Dje.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ice(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const rCn=function e(t){function n(r){return t?new Dje(r,t):new rce(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Ije(e){this._context=e}Ije.prototype={areaStart:xm,areaEnd:xm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function iCn(e){return new Ije(e)}function m$e(e){return e<0?-1:1}function v$e(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),o=(s*i+a*r)/(r+i);return(m$e(s)+m$e(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function y$e(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function iG(e,t,n){var r=e._x0,i=e._y0,s=e._x1,a=e._y1,o=(s-r)/3;e._context.bezierCurveTo(r+o,i+o*t,s-o,a-o*n,s,a)}function K6(e){this._context=e}K6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:iG(this,this._t0,y$e(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,iG(this,y$e(this,n=v$e(this,e,t)),n);break;default:iG(this,this._t0,n=v$e(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Nje(e){this._context=new Mje(e)}(Nje.prototype=Object.create(K6.prototype)).point=function(e,t){K6.prototype.point.call(this,t,e)};function Mje(e){this._context=e}Mje.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function sCn(e){return new K6(e)}function aCn(e){return new Nje(e)}function Fje(e){this._context=e}Fje.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=b$e(e),i=b$e(t),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function b$e(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),a=new Array(n);for(i[0]=0,s[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function oCn(e){return new Fje(e)}function tW(e,t){this._context=e,this._t=t}tW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function lCn(e){return new tW(e,.5)}function uCn(e){return new tW(e,0)}function cCn(e){return new tW(e,1)}const fCn=Math.sqrt(50),hCn=Math.sqrt(10),dCn=Math.sqrt(2);function Oje(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=fCn?10:s>=hCn?5:s>=dCn?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?Oje(e,t,n*2):[o,l,u]}function x$e(e,t,n){return t=+t,e=+e,n=+n,Oje(e,t,n)[2]}function pCn(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?x$e(t,e,n):x$e(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function qE(e){const t={};return n=>t[n]||(t[n]=e(n))}function gCn(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=mCn(r,i);const a=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+a}}function mCn(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function vCn(e){const t=qE(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=db(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return gCn(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,a){a=db(a==null?",f":a);const o=pCn(r,i,s),l=Math.max(Math.abs(r),Math.abs(i));let u;if(a.precision==null)switch(a.type){case"s":return isNaN(u=NVe(o,l))||(a.precision=u),n(a,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=MVe(o,l))||(a.precision=u-(a.type==="e"));break}case"f":case"%":{isNaN(u=IVe(o))||(a.precision=u-(a.type==="%")*2);break}}return t(a)}}}yCn();function yCn(){return vCn({format:HU,formatPrefix:Iue})}function w$e(e,t,n){n=n||{},fD(n)||br(`Invalid time multi-format specifier: ${n}`);const r=t(V$),i=t(vb),s=t(mb),a=t(ym),o=t(gb),l=t(wp),u=t(pb),c=t(_0),f=e(n[YM]||".%L"),h=e(n[V$]||":%S"),d=e(n[vb]||"%I:%M"),p=e(n[mb]||"%I %p"),g=e(n[ym]||n[hS]||"%a %d"),m=e(n[gb]||"%b %d"),v=e(n[wp]||"%B"),y=e(n[pb]||"%B"),b=e(n[_0]||"%Y");return x=>(r(x)<x?f:i(x)<x?h:s(x)<x?d:a(x)<x?p:l(x)<x?o(x)<x?g:m:c(x)<x?u(x)<x?v:y:b)(x)}function bCn(e){const t=qE(e.format),n=qE(e.utcFormat);return{timeFormat:r=>vm(r)?t(r):w$e(t,Vue,r),utcFormat:r=>vm(r)?n(r):w$e(n,jue,r),timeParse:qE(e.parse),utcParse:qE(e.utcParse)}}xCn();function xCn(){return bCn({format:Pue,parse:KVe,utcFormat:Lue,utcParse:ZVe})}const wCn=/^(data:|([A-Za-z]+:)?\/\/)/,$Cn=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,CCn=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,$$e="file://";function _Cn(e,t){return n=>({options:n||{},sanitize:kCn,load:SCn,fileAccess:!!t,file:ECn(t),http:TCn(e)})}async function SCn(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function kCn(e,t){t=Ex({},this.options,t);const n=this.fileAccess,r={href:null};let i,s,a;const o=$Cn.test(e.replace(CCn,""));(e==null||typeof e!="string"||!o)&&br("Sanitize failure, invalid URI: "+hD(e));const l=wCn.test(e);return(a=t.baseURL)&&!l&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),s=(i=e.startsWith($$e))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice($$e.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!s}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function ECn(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,s)=>{i?r(i):n(s)})}):ACn}async function ACn(){br("No file system access.")}function TCn(e){return e?async function(t,n){const r=Ex({},this.options.http,n),i=n&&n.response,s=await e(t,r);return s.ok?mm(s[i])?s[i]():s.text():br(s.status+""+s.statusText)}:DCn}async function DCn(){br("No HTTP fetch method available.")}const Rje=_Cn(typeof fetch<"u"&&fetch,null);let ICn=0;const Z6="p_";function sce(e){return e&&e.gradient}function Pje(e,t,n){const r=e.gradient;let i=e.id,s=r==="radial"?Z6:"";return i||(i=e.id="gradient_"+ICn++,r==="radial"?(e.x1=Df(e.x1,.5),e.y1=Df(e.y1,.5),e.r1=Df(e.r1,0),e.x2=Df(e.x2,.5),e.y2=Df(e.y2,.5),e.r2=Df(e.r2,.5),s=Z6):(e.x1=Df(e.x1,0),e.y1=Df(e.y1,0),e.x2=Df(e.x2,1),e.y2=Df(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+s+i+")"}function Df(e,t){return e!=null?e:t}function NCn(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,s){return n.push({offset:i,color:s}),r}}}const C$e={basis:{curve:Y$n},"basis-closed":{curve:X$n},"basis-open":{curve:K$n},bundle:{curve:Z$n,tension:"beta",value:.85},cardinal:{curve:Q$n,tension:"tension",value:0},"cardinal-open":{curve:eCn,tension:"tension",value:0},"cardinal-closed":{curve:J$n,tension:"tension",value:0},"catmull-rom":{curve:tCn,tension:"alpha",value:.5},"catmull-rom-closed":{curve:nCn,tension:"alpha",value:.5},"catmull-rom-open":{curve:rCn,tension:"alpha",value:.5},linear:{curve:ece},"linear-closed":{curve:iCn},monotone:{horizontal:aCn,vertical:sCn},natural:{curve:oCn},step:{curve:lCn},"step-after":{curve:cCn},"step-before":{curve:uCn}};function Lje(e,t,n){var r=Ns(C$e,e)&&C$e[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const MCn={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},FCn=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,OCn=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,RCn=/^((\s+,?\s*)|(,\s*))/,PCn=/^[01]/;function ace(e){const t=[];return(e.match(FCn)||[]).forEach(r=>{let i=r[0];const s=i.toLowerCase(),a=MCn[s],o=LCn(s,a,r.slice(1).trim()),l=o.length;if(l<a||l&&l%a!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...o.slice(0,a)]),l!==a){s==="m"&&(i=i==="M"?"L":"l");for(let u=a;u<l;u+=a)t.push([i,...o.slice(u,u+a)])}}),t}function LCn(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let s=0;s<t;++s){const a=e==="a"&&(s===3||s===4)?PCn:OCn,o=n.slice(i).match(a);if(o===null)throw Error("Invalid SVG path, incorrect parameter type");i+=o[0].length,r.push(+o[0]);const l=n.slice(i).match(RCn);l!==null&&(i+=l[0].length)}return r}const wm=Math.PI/180,BCn=1e-14,y1=Math.PI/2,qf=Math.PI*2,v2=Math.sqrt(3)/2;var sG={},aG={},Bje=[].join;function zCn(e,t,n,r,i,s,a,o,l){const u=Bje.call(arguments);if(sG[u])return sG[u];const c=a*wm,f=Math.sin(c),h=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const d=h*(o-e)*.5+f*(l-t)*.5,p=h*(l-t)*.5-f*(o-e)*.5;let g=d*d/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=h/n,v=f/n,y=-f/r,b=h/r,x=m*o+v*l,w=y*o+b*l,C=m*e+v*t,$=y*e+b*t;let k=1/((C-x)*(C-x)+($-w)*($-w))-.25;k<0&&(k=0);let E=Math.sqrt(k);s==i&&(E=-E);const S=.5*(x+C)-E*($-w),I=.5*(w+$)+E*(C-x),A=Math.atan2(w-I,x-S);let T=Math.atan2($-I,C-S)-A;T<0&&s===1?T+=qf:T>0&&s===0&&(T-=qf);const N=Math.ceil(Math.abs(T/(y1+.001))),F=[];for(let R=0;R<N;++R){const P=A+R*T/N,V=A+(R+1)*T/N;F[R]=[S,I,P,V,n,r,f,h]}return sG[u]=F}function UCn(e){const t=Bje.call(e);if(aG[t])return aG[t];var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7];const c=u*a,f=-l*o,h=l*a,d=u*o,p=Math.cos(i),g=Math.sin(i),m=Math.cos(s),v=Math.sin(s),y=.5*(s-i),b=Math.sin(y*.5),x=8/3*b*b/Math.sin(y),w=n+p-x*g,C=r+g+x*p,$=n+m,_=r+v,k=$+x*v,E=_-x*m;return aG[t]=[c*w+f*C,h*w+d*C,c*k+f*E,h*k+d*E,c*$+f*_,h*$+d*_]}const au=["l",0,0,0,0,0,0,0];function WCn(e,t,n){const r=au[0]=e[0];if(r==="a"||r==="A")au[1]=t*e[1],au[2]=n*e[2],au[3]=e[3],au[4]=e[4],au[5]=e[5],au[6]=t*e[6],au[7]=n*e[7];else if(r==="h"||r==="H")au[1]=t*e[1];else if(r==="v"||r==="V")au[1]=n*e[1];else for(var i=1,s=e.length;i<s;++i)au[i]=(i%2==1?t:n)*e[i];return au}function Q6(e,t,n,r,i,s){var a,o=null,l=0,u=0,c=0,f=0,h,d,p,g,m=0,v=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),s==null&&(s=i),e.beginPath&&e.beginPath();for(var y=0,b=t.length;y<b;++y){switch(a=t[y],(i!==1||s!==1)&&(a=WCn(a,i,s)),a[0]){case"l":l+=a[1],u+=a[2],e.lineTo(l+n,u+r);break;case"L":l=a[1],u=a[2],e.lineTo(l+n,u+r);break;case"h":l+=a[1],e.lineTo(l+n,u+r);break;case"H":l=a[1],e.lineTo(l+n,u+r);break;case"v":u+=a[1],e.lineTo(l+n,u+r);break;case"V":u=a[1],e.lineTo(l+n,u+r);break;case"m":l+=a[1],u+=a[2],m=l,v=u,e.moveTo(l+n,u+r);break;case"M":l=a[1],u=a[2],m=l,v=u,e.moveTo(l+n,u+r);break;case"c":h=l+a[5],d=u+a[6],c=l+a[3],f=u+a[4],e.bezierCurveTo(l+a[1]+n,u+a[2]+r,c+n,f+r,h+n,d+r),l=h,u=d;break;case"C":l=a[5],u=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,c+n,f+r,l+n,u+r);break;case"s":h=l+a[3],d=u+a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,l+a[1]+n,u+a[2]+r,h+n,d+r),c=l+a[1],f=u+a[2],l=h,u=d;break;case"S":h=a[3],d=a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,a[1]+n,a[2]+r,h+n,d+r),l=h,u=d,c=a[1],f=a[2];break;case"q":h=l+a[3],d=u+a[4],c=l+a[1],f=u+a[2],e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d;break;case"Q":h=a[3],d=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,h+n,d+r),l=h,u=d,c=a[1],f=a[2];break;case"t":h=l+a[1],d=u+a[2],o[0].match(/[QqTt]/)===null?(c=l,f=u):o[0]==="t"?(c=2*l-p,f=2*u-g):o[0]==="q"&&(c=2*l-c,f=2*u-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d,c=l+a[1],f=u+a[2];break;case"T":h=a[1],d=a[2],c=2*l-c,f=2*u-f,e.quadraticCurveTo(c+n,f+r,h+n,d+r),l=h,u=d;break;case"a":_$e(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+l+n,a[7]+u+r]),l+=a[6],u+=a[7];break;case"A":_$e(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),l=a[6],u=a[7];break;case"z":case"Z":l=m,u=v,e.closePath();break}o=a}}function _$e(e,t,n,r){const i=zCn(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let s=0;s<i.length;++s){const a=UCn(i[s]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const S$e=.5773502691896257,k$e={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,qf)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,s=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-s),e.lineTo(i,-s),e.lineTo(0,-n),e.lineTo(-i,-s),e.lineTo(-r,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=v2*n,i=r-n*S$e,s=n/4;e.moveTo(0,-r-i),e.lineTo(-s,r-i),e.lineTo(s,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=v2*n,i=r-n*S$e;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=v2*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=v2*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=v2*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=v2*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function VCn(e){return Ns(k$e,e)?k$e[e]:jCn(e)}var oG={};function jCn(e){if(!Ns(oG,e)){const t=ace(e);oG[e]={draw:function(n,r){Q6(n,t,0,0,Math.sqrt(r)/2)}}}return oG[e]}const Tg=.448084975506;function HCn(e){return e.x}function qCn(e){return e.y}function GCn(e){return e.width}function YCn(e){return e.height}function Fd(e){return typeof e=="function"?e:()=>+e}function _R(e,t,n){return Math.max(t,Math.min(e,n))}function XCn(){var e=HCn,t=qCn,n=GCn,r=YCn,i=Fd(0),s=i,a=i,o=i,l=null;function u(c,f,h){var d,p=f!=null?f:+e.call(this,c),g=h!=null?h:+t.call(this,c),m=+n.call(this,c),v=+r.call(this,c),y=Math.min(m,v)/2,b=_R(+i.call(this,c),0,y),x=_R(+s.call(this,c),0,y),w=_R(+a.call(this,c),0,y),C=_R(+o.call(this,c),0,y);if(l||(l=d=Jue()),b<=0&&x<=0&&w<=0&&C<=0)l.rect(p,g,m,v);else{var $=p+m,_=g+v;l.moveTo(p+b,g),l.lineTo($-x,g),l.bezierCurveTo($-Tg*x,g,$,g+Tg*x,$,g+x),l.lineTo($,_-C),l.bezierCurveTo($,_-Tg*C,$-Tg*C,_,$-C,_),l.lineTo(p+w,_),l.bezierCurveTo(p+Tg*w,_,p,_-Tg*w,p,_-w),l.lineTo(p,g+b),l.bezierCurveTo(p,g+Tg*b,p+Tg*b,g,p+b,g),l.closePath()}if(d)return l=null,d+""||null}return u.x=function(c){return arguments.length?(e=Fd(c),u):e},u.y=function(c){return arguments.length?(t=Fd(c),u):t},u.width=function(c){return arguments.length?(n=Fd(c),u):n},u.height=function(c){return arguments.length?(r=Fd(c),u):r},u.cornerRadius=function(c,f,h,d){return arguments.length?(i=Fd(c),s=f!=null?Fd(f):i,o=h!=null?Fd(h):i,a=d!=null?Fd(d):s,u):i},u.context=function(c){return arguments.length?(l=c==null?null:c,u):l},u}function KCn(){var e,t,n,r,i=null,s,a,o,l;function u(f,h,d){const p=d/2;if(s){var g=o-h,m=f-a;if(g||m){var v=Math.sqrt(g*g+m*m),y=(g/=v)*l,b=(m/=v)*l,x=Math.atan2(m,g);i.moveTo(a-y,o-b),i.lineTo(f-g*p,h-m*p),i.arc(f,h,p,x-Math.PI,x),i.lineTo(a+y,o+b),i.arc(a,o,l,x,x+Math.PI)}else i.arc(f,h,p,0,qf);i.closePath()}else s=1;a=f,o=h,l=p}function c(f){var h,d=f.length,p,g=!1,m;for(i==null&&(i=m=Jue()),h=0;h<=d;++h)!(h<d&&r(p=f[h],h,f))===g&&(g=!g)&&(s=0),g&&u(+e(p,h,f),+t(p,h,f),+n(p,h,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function QM(e,t){return e!=null?e:t}const JM=e=>e.x||0,eF=e=>e.y||0,ZCn=e=>e.width||0,QCn=e=>e.height||0,JCn=e=>(e.x||0)+(e.width||0),e_n=e=>(e.y||0)+(e.height||0),t_n=e=>e.startAngle||0,n_n=e=>e.endAngle||0,r_n=e=>e.padAngle||0,i_n=e=>e.innerRadius||0,s_n=e=>e.outerRadius||0,a_n=e=>e.cornerRadius||0,o_n=e=>QM(e.cornerRadiusTopLeft,e.cornerRadius)||0,l_n=e=>QM(e.cornerRadiusTopRight,e.cornerRadius)||0,u_n=e=>QM(e.cornerRadiusBottomRight,e.cornerRadius)||0,c_n=e=>QM(e.cornerRadiusBottomLeft,e.cornerRadius)||0,f_n=e=>QM(e.size,64),h_n=e=>e.size||1,nW=e=>e.defined!==!1,d_n=e=>VCn(e.shape||"circle"),p_n=H$n().startAngle(t_n).endAngle(n_n).padAngle(r_n).innerRadius(i_n).outerRadius(s_n).cornerRadius(a_n),g_n=_je().x(JM).y1(eF).y0(e_n).defined(nW),m_n=_je().y(eF).x1(JM).x0(JCn).defined(nW),v_n=Cje().x(JM).y(eF).defined(nW),y_n=XCn().x(JM).y(eF).width(ZCn).height(QCn).cornerRadius(o_n,l_n,u_n,c_n),b_n=G$n().type(d_n).size(f_n),x_n=KCn().x(JM).y(eF).defined(nW).size(h_n);function oce(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function w_n(e,t){return p_n.context(e)(t)}function $_n(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?m_n:g_n).curve(Lje(r,n.orient,n.tension)).context(e)(t)}function C_n(e,t){const n=t[0],r=n.interpolate||"linear";return v_n.curve(Lje(r,n.orient,n.tension)).context(e)(t)}function pS(e,t,n,r){return y_n.context(e)(t,n,r)}function __n(e,t){return(t.mark.shape||t.shape).context(e)(t)}function S_n(e,t){return b_n.context(e)(t)}function k_n(e,t){return x_n.context(e)(t)}var E_n=1;function lce(e,t,n){var r=t.clip,i=e._defs,s=t.clip_id||(t.clip_id="clip"+E_n++),a=i.clipping[s]||(i.clipping[s]={id:s});return mm(r)?a.path=r(null):oce(n)?a.path=pS(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+s+")"}function of(e){this.clear(),e&&this.union(e)}of.prototype={clone(){return new of(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:s,y2:a}=this,o=Math.cos(e),l=Math.sin(e),u=t-t*o+n*l,c=n-t*l-n*o;return[o*r-l*i+u,l*r+o*i+c,o*r-l*a+u,l*r+o*a+c,o*s-l*i+u,l*s+o*i+c,o*s-l*a+u,l*s+o*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function zje(e){this.mark=e,this.bounds=this.bounds||new of}function A_n(e){zje.call(this,e),this.items=this.items||[]}lS(A_n,zje);function Uje(e){this._pending=0,this._loader=e||Rje()}function E$e(e){e._pending+=1}function Lk(e){e._pending-=1}Uje.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return E$e(t),t._loader.sanitize(e,{context:"href"}).then(n=>(Lk(t),n)).catch(()=>(Lk(t),null))},loadImage(e){const t=this,n=_ie();return E$e(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const s=new n,a=Ns(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(s.crossOrigin=a),s.onload=()=>Lk(t),s.onerror=()=>Lk(t),s.src=i,s}).catch(r=>(Lk(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function gS(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?T_n(t,r):0))}return e}function T_n(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const D_n=qf-1e-8;let rW,M4,F4,V1,qQ,O4,GQ,YQ;const s0=(e,t)=>rW.add(e,t),R4=(e,t)=>s0(M4=e,F4=t),A$e=e=>s0(e,rW.y1),T$e=e=>s0(rW.x1,e),b1=(e,t)=>qQ*e+GQ*t,x1=(e,t)=>O4*e+YQ*t,lG=(e,t)=>s0(b1(e,t),x1(e,t)),uG=(e,t)=>R4(b1(e,t),x1(e,t));function uce(e,t){return rW=e,t?(V1=t*wm,qQ=YQ=Math.cos(V1),O4=Math.sin(V1),GQ=-O4):(qQ=YQ=1,V1=O4=GQ=0),I_n}const I_n={beginPath(){},closePath(){},moveTo:uG,lineTo:uG,rect(e,t,n,r){V1?(lG(e+n,t),lG(e+n,t+r),lG(e,t+r),uG(e,t)):(s0(e+n,t+r),R4(e,t))},quadraticCurveTo(e,t,n,r){const i=b1(e,t),s=x1(e,t),a=b1(n,r),o=x1(n,r);D$e(M4,i,a,A$e),D$e(F4,s,o,T$e),R4(a,o)},bezierCurveTo(e,t,n,r,i,s){const a=b1(e,t),o=x1(e,t),l=b1(n,r),u=x1(n,r),c=b1(i,s),f=x1(i,s);I$e(M4,a,l,c,A$e),I$e(F4,o,u,f,T$e),R4(c,f)},arc(e,t,n,r,i,s){if(r+=V1,i+=V1,M4=n*Math.cos(i)+e,F4=n*Math.sin(i)+t,Math.abs(i-r)>D_n)s0(e-n,t-n),s0(e+n,t+n);else{const a=u=>s0(n*Math.cos(u)+e,n*Math.sin(u)+t);let o,l;if(a(r),a(i),i!==r)if(r=r%qf,r<0&&(r+=qf),i=i%qf,i<0&&(i+=qf),i<r&&(s=!s,o=r,r=i,i=o),s)for(i-=qf,o=r-r%y1,l=0;l<4&&o>i;++l,o-=y1)a(o);else for(o=r-r%y1+y1,l=0;l<4&&o<i;++l,o=o+y1)a(o)}}};function D$e(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function I$e(e,t,n,r,i){const s=r-e+3*t-3*n,a=e+n-2*t,o=e-t;let l=0,u=0,c;Math.abs(s)>BCn?(c=a*a+o*s,c>=0&&(c=Math.sqrt(c),l=(-a+c)/s,u=(-a-c)/s)):l=.5*o/a,0<l&&l<1&&i(N$e(l,e,t,n,r)),0<u&&u<1&&i(N$e(u,e,t,n,r))}function N$e(e,t,n,r,i){const s=1-e,a=s*s,o=e*e;return a*s*t+3*a*e*n+3*s*o*r+o*e*i}var S0=(S0=Yu(1,1))?S0.getContext("2d"):null;const XQ=new of;function Wje(e){return function(t,n){if(!S0)return!0;e(S0,t),XQ.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:s,y2:a}=XQ;for(let o=i;o<=a;++o)for(let l=r;l<=s;++l)if(S0.isPointInPath(l,o))return!0;return!1}}function Vje(e,t){return t.contains(e.x||0,e.y||0)}function jje(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,s=e.height||0;return t.intersects(XQ.set(n,r,n+i,r+s))}function N_n(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:r;return GE(t,n,r,i,s)}function GE(e,t,n,r,i){const{x1:s,y1:a,x2:o,y2:l}=e,u=r-t,c=i-n;let f=0,h=1,d,p,g,m;for(m=0;m<4;++m){if(m===0&&(d=-u,p=-(s-t)),m===1&&(d=u,p=o-t),m===2&&(d=-c,p=-(a-n)),m===3&&(d=c,p=l-n),Math.abs(d)<1e-10&&p<0)return!1;if(g=p/d,d<0){if(g>h)return!1;g>f&&(f=g)}else if(d>0){if(g<f)return!1;g<h&&(h=g)}}return!0}function H$(e,t){e.globalCompositeOperation=t.blend||"source-over"}function ac(e,t){return e==null?t:e}function M$e(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function M_n(e,t,n){const r=n.width(),i=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+ac(t.x1,.5)*r,n.y1+ac(t.y1,.5)*i,Math.max(r,i)*ac(t.r1,0),n.x1+ac(t.x2,.5)*r,n.y1+ac(t.y2,.5)*i,Math.max(r,i)*ac(t.r2,.5));else{const a=ac(t.x1,0),o=ac(t.y1,0),l=ac(t.x2,1),u=ac(t.y2,0);if(a===l||o===u||r===i)s=e.createLinearGradient(n.x1+a*r,n.y1+o*i,n.x1+l*r,n.y1+u*i);else{const c=Yu(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=M$e(f.createLinearGradient(a,o,l,u),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return M$e(s,t.stops)}function Hje(e,t,n){return sce(n)?M_n(e,n,t.bounds):n}function J6(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=Hje(e,t,t.fill),!0):!1}var F_n=[];function q$(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=Hje(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||F_n),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function O_n(e,t){return e.zindex-t.zindex||e.index-t.index}function qje(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,s;for(i=0,s=t.length;i<s;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(O_n)}function Yh(e,t){var n=e.items,r,i;if(!n||!n.length)return;const s=qje(e);if(s&&s.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=s}for(r=0,i=n.length;r<i;++r)t(n[r])}function KQ(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const s=qje(e);for(s&&s.length&&(n=s),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===s){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function cce(e){return function(t,n,r){Yh(n,i=>{(!r||r.intersects(i.bounds))&&Gje(e,t,i,i)})}}function R_n(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&Gje(e,t,n.items[0],n.items)}}function Gje(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(H$(t,n),n.fill&&J6(t,n,i)&&t.fill(),n.stroke&&q$(t,n,i)&&t.stroke()))}function iW(e){return e=e||OU,function(t,n,r,i,s,a){return r*=t.pixelRatio,i*=t.pixelRatio,KQ(n,o=>{const l=o.bounds;if(!(l&&!l.contains(s,a)||!l)&&e(t,o,r,i,s,a))return o})}}function tF(e,t){return function(n,r,i,s){var a=Array.isArray(r)?r[0]:r,o=t==null?a.fill:t,l=a.stroke&&n.isPointInStroke,u,c;return l&&(u=a.strokeWidth,c=a.strokeCap,n.lineWidth=u!=null?u:1,n.lineCap=c!=null?c:"butt"),e(n,r)?!1:o&&n.isPointInPath(i,s)||l&&n.isPointInStroke(i,s)}}function fce(e){return iW(tF(e))}function gy(e,t){return"translate("+e+","+t+")"}function hce(e){return"rotate("+e+")"}function P_n(e,t){return"scale("+e+","+t+")"}function Yje(e){return gy(e.x||0,e.y||0)}function L_n(e){return gy(e.x||0,e.y||0)+(e.angle?" "+hce(e.angle):"")}function B_n(e){return gy(e.x||0,e.y||0)+(e.angle?" "+hce(e.angle):"")+(e.scaleX||e.scaleY?" "+P_n(e.scaleX||1,e.scaleY||1):"")}function dce(e,t,n){function r(a,o){a("transform",L_n(o)),a("d",t(null,o))}function i(a,o){return t(uce(a,o.angle),o),gS(a,o).translate(o.x||0,o.y||0)}function s(a,o){var l=o.x||0,u=o.y||0,c=o.angle||0;a.translate(l,u),c&&a.rotate(c*=wm),a.beginPath(),t(a,o),c&&a.rotate(-c),a.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:cce(s),pick:fce(s),isect:n||Wje(s)}}var z_n=dce("arc",w_n);function U_n(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,s=1/0,a,o;--i>=0;)e[i].defined!==!1&&(o=Math.abs(e[i][r]-n),o<s&&(s=o,a=e[i]));return a}function W_n(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,s,a;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],s=e[r].y-t[1],a=i*i+s*s,a<n))return e[r];return null}function V_n(e,t){for(var n=e.length,r,i,s;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],s=r*r+i*i,r=e[n].size||1,s<r*r))return e[n];return null}function pce(e,t,n){function r(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))}function i(l,u){var c=u.items;return c.length===0?l:(t(uce(l),c),gS(l,c[0]))}function s(l,u){l.beginPath(),t(l,u)}const a=tF(s);function o(l,u,c,f,h,d){var p=u.items,g=u.bounds;return!p||!p.length||g&&!g.contains(h,d)?null:(c*=l.pixelRatio,f*=l.pixelRatio,a(l,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:R_n(s),pick:o,isect:Vje,tip:n}}var j_n=pce("area",$_n,U_n);function H_n(e,t){var n=t.clip;e.save(),mm(n)?(e.beginPath(),n(e),e.clip()):Xje(e,t.group)}function Xje(e,t){e.beginPath(),oce(t)?pS(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function Kje(e){const t=ac(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function q_n(e,t){e("transform",Yje(t))}function Zje(e,t){const n=Kje(t);e("d",pS(null,t,n,n))}function G_n(e,t){e("class","background"),e("aria-hidden",!0),Zje(e,t)}function Y_n(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?Zje(e,t):e("d","")}function X_n(e,t,n){const r=t.clip?lce(n,t,t):null;e("clip-path",r)}function K_n(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),gS(e,t),e.translate(t.x||0,t.y||0)}function wD(e,t,n,r){const i=Kje(t);e.beginPath(),pS(e,t,(n||0)+i,(r||0)+i)}const Z_n=tF(wD),Q_n=tF(wD,!1),J_n=tF(wD,!0);function eSn(e,t,n){Yh(t,r=>{const i=r.x||0,s=r.y||0,a=r.strokeForeground,o=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&o&&(wD(e,r,i,s),H$(e,r),r.fill&&J6(e,r,o)&&e.fill(),r.stroke&&!a&&q$(e,r,o)&&e.stroke()),e.save(),e.translate(i,s),r.clip&&Xje(e,r),n&&n.translate(-i,-s),Yh(r,l=>{this.draw(e,l,n)}),n&&n.translate(i,s),e.restore(),a&&r.stroke&&o&&(wD(e,r,i,s),H$(e,r),q$(e,r,o)&&e.stroke())})}function tSn(e,t,n,r,i,s){if(t.bounds&&!t.bounds.contains(i,s)||!t.items)return null;const a=n*e.pixelRatio,o=r*e.pixelRatio;return KQ(t,l=>{let u,c,f;const h=l.bounds;if(h&&!h.contains(i,s))return;c=l.x||0,f=l.y||0;const d=c+(l.width||0),p=f+(l.height||0),g=l.clip;if(g&&(i<c||i>d||s<f||s>p))return;if(e.save(),e.translate(c,f),c=i-c,f=s-f,g&&oce(l)&&!J_n(e,l,a,o))return e.restore(),null;const m=l.strokeForeground,v=t.interactive!==!1;return v&&m&&l.stroke&&Q_n(e,l,a,o)?(e.restore(),l):(u=KQ(l,y=>nSn(y,c,f)?this.pick(y,n,r,c,f):null),!u&&v&&(l.fill||!m&&l.stroke)&&Z_n(e,l,a,o)&&(u=l),e.restore(),u||null)})}function nSn(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var rSn={type:"group",tag:"g",nested:!1,attr:q_n,bound:K_n,draw:eSn,pick:tSn,isect:jje,content:X_n,background:G_n,foreground:Y_n},$D={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function gce(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function mce(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function vce(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function sW(e,t){return e==="center"?t/2:e==="right"?t:0}function aW(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function iSn(e,t,n){const r=gce(t,n),i=mce(t,r),s=vce(t,r),a=(t.x||0)-sW(t.align,i),o=(t.y||0)-aW(t.baseline,s),l=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",l,$D["xmlns:xlink"],"xlink:href"),e("transform",gy(a,o)),e("width",i),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function sSn(e,t){const n=t.image,r=mce(t,n),i=vce(t,n),s=(t.x||0)-sW(t.align,r),a=(t.y||0)-aW(t.baseline,i);return e.set(s,a,s+r,a+i)}function aSn(e,t,n){Yh(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=gce(r,this);let s=mce(r,i),a=vce(r,i);if(s===0||a===0)return;let o=(r.x||0)-sW(r.align,s),l=(r.y||0)-aW(r.baseline,a),u,c,f,h;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(h=s/c,l+=(a-h)/2,a=h):(h=a*c,o+=(s-h)/2,s=h))),(i.complete||i.toDataURL)&&(H$(e,r),e.globalAlpha=(u=r.opacity)!=null?u:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,o,l,s,a))})}var oSn={type:"image",tag:"image",nested:!1,attr:iSn,bound:sSn,draw:aSn,pick:iW(),isect:OU,get:gce,xOffset:sW,yOffset:aW},lSn=pce("line",C_n,W_n);function uSn(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",B_n(t)),e("d",t.path)}function P4(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,s=t.scaleX||1,a=t.scaleY||1,o=(t.angle||0)*wm,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=ace(n)).path=n),o&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(o),Q6(e,l,0,0,s,a),e.rotate(-o),e.translate(-r,-i)):Q6(e,l,r,i,s,a)}function cSn(e,t){return P4(uce(e,t.angle),t)?e.set(0,0,0,0):gS(e,t,!0)}var fSn={type:"path",tag:"path",nested:!1,attr:uSn,bound:cSn,draw:cce(P4),pick:fce(P4),isect:Wje(P4)};function hSn(e,t){e("d",pS(null,t))}function dSn(e,t){var n,r;return gS(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function F$e(e,t){e.beginPath(),pS(e,t)}var pSn={type:"rect",tag:"path",nested:!1,attr:hSn,bound:dSn,draw:cce(F$e),pick:fce(F$e),isect:jje};function gSn(e,t){e("transform",Yje(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function mSn(e,t){var n,r;return gS(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function Qje(e,t,n){var r,i,s,a;return t.stroke&&q$(e,t,n)?(r=t.x||0,i=t.y||0,s=t.x2!=null?t.x2:r,a=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(s,a),!0):!1}function vSn(e,t,n){Yh(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&Qje(e,r,i)&&(H$(e,r),e.stroke())}})}function ySn(e,t,n,r){return e.isPointInStroke?Qje(e,t,1)&&e.isPointInStroke(n,r):!1}var bSn={type:"rule",tag:"line",nested:!1,attr:gSn,bound:mSn,draw:vSn,pick:iW(ySn),isect:N_n},xSn=dce("shape",__n),wSn=dce("symbol",S_n,Vje);const O$e=ybn();var IA={height:dg,measureWidth:yce,estimateWidth:ZQ,width:ZQ,canvas:Jje};Jje(!0);function Jje(e){IA.width=e&&S0?yce:ZQ}function ZQ(e,t){return eHe($m(e,t),dg(e))}function eHe(e,t){return~~(.8*e.length*t)}function yce(e,t){return dg(e)<=0||!(t=$m(e,t))?0:tHe(t,bce(e))}function tHe(e,t){const n=`(${t}) ${e}`;let r=O$e.get(n);return r===void 0&&(S0.font=t,r=S0.measureText(e).width,O$e.set(n,r)),r}function dg(e){return e.fontSize!=null?+e.fontSize||0:11}function G$(e){return e.lineHeight!=null?e.lineHeight:dg(e)+2}function $Sn(e){return Ma(e)?e.length>1?e:e[0]:e}function oW(e){return $Sn(e.lineBreak&&e.text&&!Ma(e.text)?e.text.split(e.lineBreak):e.text)}function $m(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?_Sn(e,n):n}function CSn(e){if(IA.width===yce){const t=bce(e);return n=>tHe(n,t)}else{const t=dg(e);return n=>eHe(n,t)}}function _Sn(e,t){var n=+e.limit,r=CSn(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",s=e.dir==="rtl",a=0,o=t.length,l;if(n-=r(i),s){for(;a<o;)l=a+o>>>1,r(t.slice(l))>n?a=l+1:o=l;return i+t.slice(a)}else{for(;a<o;)l=1+(a+o>>>1),r(t.slice(0,l))<n?a=l:o=l-1;return t.slice(0,a)+i}}function lW(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function bce(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+dg(e)+"px "+lW(e,t)}function xce(e){var t=e.baseline,n=dg(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*G$(e):t==="line-bottom"?.29*n-.5*G$(e):0)}const SSn={left:"start",center:"middle",right:"end"},NA=new of;function uW(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-y1,t+=r*Math.cos(i),n+=r*Math.sin(i)),NA.x1=t,NA.y1=n,NA}function kSn(e,t){var n=t.dx||0,r=(t.dy||0)+xce(t),i=uW(t),s=i.x1,a=i.y1,o=t.angle||0,l;e("text-anchor",SSn[t.align]||"start"),o?(l=gy(s,a)+" "+hce(o),(n||r)&&(l+=" "+gy(n,r))):l=gy(s+n,a+r),e("transform",l)}function wce(e,t,n){var r=IA.height(t),i=t.align,s=uW(t),a=s.x1,o=s.y1,l=t.dx||0,u=(t.dy||0)+xce(t)-Math.round(.8*r),c=oW(t),f;if(Ma(c)?(r+=G$(t)*(c.length-1),f=c.reduce((h,d)=>Math.max(h,IA.width(t,d)),0)):f=IA.width(t,c),i==="center"?l-=f/2:i==="right"&&(l-=f),e.set(l+=a,u+=o,l+f,u+r),t.angle&&!n)e.rotate(t.angle*wm,a,o);else if(n===2)return e.rotatedPoints(t.angle*wm,a,o);return e}function ESn(e,t,n){Yh(t,r=>{var i=r.opacity==null?1:r.opacity,s,a,o,l,u,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=bce(r),e.textAlign=r.align||"left",s=uW(r),a=s.x1,o=s.y1,r.angle&&(e.save(),e.translate(a,o),e.rotate(r.angle*wm),a=o=0),a+=r.dx||0,o+=(r.dy||0)+xce(r),c=oW(r),H$(e,r),Ma(c))for(u=G$(r),l=0;l<c.length;++l)f=$m(r,c[l]),r.fill&&J6(e,r,i)&&e.fillText(f,a,o),r.stroke&&q$(e,r,i)&&e.strokeText(f,a,o),o+=u;else f=$m(r,c),r.fill&&J6(e,r,i)&&e.fillText(f,a,o),r.stroke&&q$(e,r,i)&&e.strokeText(f,a,o);r.angle&&e.restore()}})}function ASn(e,t,n,r,i,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=uW(t),o=a.x1,l=a.y1,u=wce(NA,t,1),c=-t.angle*wm,f=Math.cos(c),h=Math.sin(c),d=f*i-h*s+(o-f*o+h*l),p=h*i+f*s+(l-h*o-f*l);return u.contains(d,p)}function TSn(e,t){const n=wce(NA,e,2);return GE(t,n[0],n[1],n[2],n[3])||GE(t,n[0],n[1],n[4],n[5])||GE(t,n[4],n[5],n[6],n[7])||GE(t,n[2],n[3],n[6],n[7])}var DSn={type:"text",tag:"text",nested:!1,attr:kSn,bound:wce,draw:ESn,pick:iW(ASn),isect:TSn},ISn=pce("trail",k_n,V_n),Cm={arc:z_n,area:j_n,group:rSn,image:oSn,line:lSn,path:fSn,rect:pSn,rule:bSn,shape:xSn,symbol:wSn,text:DSn,trail:ISn};function j1(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function nHe(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Tl(e,t,n,r){var i=e.childNodes[t],s;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(s=i||null,i=j1(e.ownerDocument,n,r),e.insertBefore(i,s)),i}function Gf(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function rHe(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function iHe(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function NSn(e,t,n,r){var i=e&&e.mark,s,a;if(i&&(s=Cm[i.marktype]).tip){for(a=iHe(t,n),a[0]-=r[0],a[1]-=r[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=s.tip(i.items,a)}return e}function yb(e,t){this._active=null,this._handlers={},this._loader=e||Rje(),this._tooltip=t||MSn}function MSn(e,t,n,r){e.element().setAttribute("title",r||"")}yb.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),s=j1(null,"a");for(const a in r)s.setAttribute(a,r[a]);s.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=NSn(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,s=i.width(),a=i.height();let o=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)o+=e.x||0,l+=e.y||0;return{x:o,y:l,width:s,height:a,left:o,top:l,right:o+s,bottom:l+a}}};function pg(e){this._el=null,this._bgcolor=null,this._loader=new Uje(e)}pg.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(s=>{s&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const FSn="keydown",OSn="keypress",RSn="keyup",sHe="dragenter",L4="dragleave",aHe="dragover",QQ="mousedown",PSn="mouseup",eB="mousemove",MA="mouseout",oHe="mouseover",tB="click",LSn="dblclick",BSn="wheel",lHe="mousewheel",nB="touchstart",rB="touchmove",iB="touchend",zSn=[FSn,OSn,RSn,sHe,L4,aHe,QQ,PSn,eB,MA,oHe,tB,LSn,BSn,lHe,nB,rB,iB],JQ=eB,CD=MA,eJ=tB;function USn(e,t){yb.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const WSn=e=>e===nB||e===rB||e===iB?[nB,rB,iB]:[e];function R$e(e,t){WSn(t).forEach(n=>VSn(e,n))}function VSn(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function P$e(e,t,n){return function(r){const i=this._active,s=this.pickEvent(r);s===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=s,this.fire(t,r),this.fire(e,r))}}function L$e(e){return function(t){this.fire(e,t),this._active=null}}lS(USn,yb,{initialize(e,t,n){return this._canvas=e&&nHe(e,"canvas"),[tB,QQ,eB,MA,L4].forEach(r=>R$e(this,r)),yb.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:zSn,DOMMouseScroll(e){this.fire(lHe,e)},mousemove:P$e(eB,oHe,MA),dragover:P$e(aHe,sHe,L4),mouseout:L$e(MA),dragleave:L$e(L4),mousedown(e){this._down=this._active,this.fire(QQ,e)},click(e){this._down===this._active&&(this.fire(tB,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(nB,e,!0)},touchmove(e){this.fire(rB,e,!0)},touchend(e){this.fire(iB,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===eJ&&r&&r.href?this.handleHref(t,r,r.href):(e===JQ||e===CD)&&this.handleTooltip(t,r,e!==CD),i)for(let s=0,a=i.length;s<a;++s)i[s].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(R$e(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=iHe(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const s=this.context();return Cm[e.marktype].pick.call(this,s,e,t,n,r,i)}});function jSn(){return typeof window<"u"&&window.devicePixelRatio||1}var HSn=jSn();function qSn(e,t,n,r,i,s){const a=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,o=e.getContext("2d"),l=a?HSn:i;e.width=t*l,e.height=n*l;for(const u in s)o[u]=s[u];return a&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),o.pixelRatio=l,o.setTransform(l,0,0,l,l*r[0],l*r[1]),e}function GSn(e){pg.call(this,e),this._options={},this._redraw=!1,this._dirty=new of,this._tempb=new of}const B$e=pg.prototype,YSn=(e,t,n)=>new of().set(0,0,t,n).translate(-e[0],-e[1]);function XSn(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}lS(GSn,pg,{initialize(e,t,n,r,i,s){return this._options=s||{},this._canvas=this._options.externalContext?null:Yu(1,1,this._options.type),e&&this._canvas&&(Gf(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),B$e.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(B$e.resize.call(this,e,t,n,r),this._canvas)qSn(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||br("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,s=this._dirty,a=YSn(n,r,i);t.save();const o=this._redraw||s.empty()?(this._redraw=!1,a.expand(1)):XSn(t,a.intersect(s),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,o),t.restore(),s.clear(),this},draw(e,t,n){const r=Cm[t.marktype];t.clip&&H_n(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,s=this.context();i.type!=="pdf"&&!i.externalContext&&s.clearRect(e,t,n,r),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,r))}});function KSn(e,t){yb.call(this,e,t);const n=this;n._hrefHandler=tJ(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=tJ(n,(r,i)=>{n.handleTooltip(r,i,r.type!==CD)})}const tJ=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};lS(KSn,yb,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(eJ,this._hrefHandler),r.removeEventListener(JQ,this._tooltipHandler),r.removeEventListener(CD,this._tooltipHandler)),this._svg=r=e&&nHe(e,"svg"),r&&(r.addEventListener(eJ,this._hrefHandler),r.addEventListener(JQ,this._tooltipHandler),r.addEventListener(CD,this._tooltipHandler)),yb.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const s={type:e,handler:t,listener:tJ(this,t)};(r[n]||(r[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const uHe="aria-hidden",$ce="aria-label",Cce="role",_ce="aria-roledescription",cHe="graphics-object",Sce="graphics-symbol",fHe=(e,t,n)=>({[Cce]:e,[_ce]:t,[$ce]:n||void 0}),ZSn=P6(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),z$e={axis:{desc:"axis",caption:ekn},legend:{desc:"legend",caption:tkn},"title-text":{desc:"title",caption:e=>`Title text '${W$e(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${W$e(e)}'`}},U$e={ariaRole:Cce,ariaRoleDescription:_ce,description:$ce};function hHe(e,t){const n=t.aria===!1;if(e(uHe,n||void 0),n||t.description==null)for(const r in U$e)e(U$e[r],void 0);else{const r=t.mark.marktype;e($ce,t.description),e(Cce,t.ariaRole||(r==="group"?cHe:Sce)),e(_ce,t.ariaRoleDescription||`${r} mark`)}}function dHe(e){return e.aria===!1?{[uHe]:!0}:ZSn[e.role]?null:z$e[e.role]?JSn(e,z$e[e.role]):QSn(e)}function QSn(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return fHe(n?cHe:Sce,`${t} mark container`,e.description)}function JSn(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return fHe(t.role||Sce,t.desc,n.description||r(n))}catch{return null}}function W$e(e){return P$(e.text).join(" ")}function ekn(e){const t=e.datum,n=e.orient,r=t.title?pHe(e):null,i=e.context,s=i.scales[t.scale].value,a=i.dataflow.locale(),o=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${cje(o)?"discrete":o} scale with ${mje(a,s,e)}`}function tkn(e){const t=e.datum,n=t.title?pHe(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,s=Object.keys(i),a=e.context,o=a.scales[i[s[0]]].value,l=a.dataflow.locale();return rkn(r)+(n?` titled '${n}'`:"")+` for ${nkn(s)} with ${mje(l,o,e)}`}function pHe(e){try{return P$(xo(e.items).items[0].text).join(" ")}catch{return null}}function nkn(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+xo(e)}function rkn(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const gHe=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ikn=e=>gHe(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function mHe(){let e="",t="",n="";const r=[],i=()=>t=n="",s=l=>{t&&(e+=`${t}>${n}`,i()),r.push(l)},a=(l,u)=>(u!=null&&(t+=` ${l}="${ikn(u)}"`),o),o={open(l){s(l),t="<"+l;for(var u=arguments.length,c=new Array(u>1?u-1:0),f=1;f<u;f++)c[f-1]=arguments[f];for(const h of c)for(const d in h)a(d,h[d]);return o},close(){const l=r.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,i(),o},attr:a,text:l=>(n+=gHe(l),o),toString:()=>e};return o}const skn=e=>vHe(mHe(),e)+"";function vHe(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const r of n)r.nodeType===3?e.text(r.nodeValue):vHe(e,r)}return e.close()}const sB={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},aB={blend:"mix-blend-mode"},yHe={fill:"none","stroke-miterlimit":10},Bk=0,V$e="http://www.w3.org/2000/xmlns/",ki=$D.xmlns;function akn(e){pg.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const cG=pg.prototype;lS(akn,pg,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=Tl(e,0,"svg",ki),this._svg.setAttributeNS(V$e,"xmlns",ki),this._svg.setAttributeNS(V$e,"xmlns:xlink",$D["xmlns:xlink"]),this._svg.setAttribute("version",$D.version),this._svg.setAttribute("class","marks"),Gf(e,1),this._root=Tl(this._svg,Bk,"g",ki),a0(this._root,yHe),Gf(this._svg,Bk+1)),this.background(this._bgcolor),cG.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),cG.background.apply(this,arguments)},resize(e,t,n,r){return cG.resize.call(this,e,t,n,r),this._svg&&(a0(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Tl(e,Bk,"rect",ki),a0(n,{width:this._width,height:this._height,fill:t}));const r=skn(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Gf(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,s,a,o,l;for(a=0,o=e.length;a<o;++a)if(n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,s=Cm[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,j$e(n,t),r.items.forEach(u=>{u.dirty=t})),!r.zdirty){if(n.exit){s.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(s,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null;continue}n=s.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,j$e(n,t)):this._update(s,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Cm[t.marktype],s=t.interactive===!1?"none":null,a=i.tag==="g",o=H$e(t,e,n,"g",r);o.setAttribute("class",rHe(t));const l=dHe(t);for(const h in l)Wa(o,h,l[h]);a||Wa(o,"pointer-events",s),Wa(o,"clip-path",t.clip?lce(this,t,t.group):null);let u=null,c=0;const f=h=>{const d=this.isDirty(h),p=H$e(h,o,u,i.tag,r);d&&(this._update(i,p,h),a&&ukn(this,p,h)),u=p,++c};return i.nested?t.items.length&&f(t.items[0]):Yh(t,f),Gf(o,c),o},_update(e,t,n){pp=t,la=t.__values__,hHe(FA,n),e.attr(FA,n,this);const r=fkn[e.type];r&&r.call(this,e,t,n),pp&&this.style(pp,n)},style(e,t){if(t!=null){for(const n in sB){let r=n==="font"?lW(t):t[n];if(r===la[n])continue;const i=sB[n];r==null?e.removeAttribute(i):(sce(r)&&(r=Pje(r,this._defs.gradient,bHe())),e.setAttribute(i,r+"")),la[n]=r}for(const n in aB)B4(e,aB[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=Tl(e,Bk+1,"defs",ki)),r=okn(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=Tl(e,Bk+1,"defs",ki)),r=lkn(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):Gf(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function j$e(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function okn(e,t,n){let r,i,s;if(t.gradient==="radial"){let a=Tl(e,n++,"pattern",ki);a0(a,{id:Z6+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=Tl(a,0,"rect",ki),a0(a,{width:1,height:1,fill:`url(${bHe()}#${t.id})`}),e=Tl(e,n++,"radialGradient",ki),a0(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Tl(e,n++,"linearGradient",ki),a0(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)s=Tl(e,r,"stop",ki),s.setAttribute("offset",t.stops[r].offset),s.setAttribute("stop-color",t.stops[r].color);return Gf(e,r),n}function lkn(e,t,n){let r;return e=Tl(e,n,"clipPath",ki),e.setAttribute("id",t.id),t.path?(r=Tl(e,0,"path",ki),r.setAttribute("d",t.path)):(r=Tl(e,0,"rect",ki),a0(r,{x:0,y:0,width:t.width,height:t.height})),Gf(e,1),n+1}function ukn(e,t,n){t=t.lastChild.previousSibling;let r,i=0;Yh(n,s=>{r=e.mark(t,s,r),++i}),Gf(t,1+i)}function H$e(e,t,n,r,i){let s=e._svg,a;if(!s&&(a=t.ownerDocument,s=j1(a,r,ki),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},r==="g"))){const o=j1(a,"path",ki);s.appendChild(o),o.__data__=e;const l=j1(a,"g",ki);s.appendChild(l),l.__data__=e;const u=j1(a,"path",ki);s.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(s.ownerSVGElement!==i||ckn(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function ckn(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let pp=null,la=null;const fkn={group(e,t,n){const r=pp=t.childNodes[2];la=r.__values__,e.foreground(FA,n,this),la=t.__values__,pp=t.childNodes[1],e.content(FA,n,this);const i=pp=t.childNodes[0];e.background(FA,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==la.events&&(Wa(r,"pointer-events",s),Wa(i,"pointer-events",s),la.events=s),n.strokeForeground&&n.stroke){const a=n.fill;Wa(r,"display",null),this.style(i,n),Wa(i,"stroke",null),a&&(n.fill=null),la=r.__values__,this.style(r,n),a&&(n.fill=a),pp=null}else Wa(r,"display","none")},image(e,t,n){n.smooth===!1?(B4(t,"image-rendering","optimizeSpeed"),B4(t,"image-rendering","pixelated")):B4(t,"image-rendering",null)},text(e,t,n){const r=oW(n);let i,s,a,o;Ma(r)?(s=r.map(l=>$m(n,l)),i=s.join(`
`),i!==la.text&&(Gf(t,0),a=t.ownerDocument,o=G$(n),s.forEach((l,u)=>{const c=j1(a,"tspan",ki);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",o)),t.appendChild(c)}),la.text=i)):(s=$m(n,r),s!==la.text&&(t.textContent=s,la.text=s)),Wa(t,"font-family",lW(n)),Wa(t,"font-size",dg(n)+"px"),Wa(t,"font-style",n.fontStyle),Wa(t,"font-variant",n.fontVariant),Wa(t,"font-weight",n.fontWeight)}};function FA(e,t,n){t!==la[e]&&(n?hkn(pp,e,t,n):Wa(pp,e,t),la[e]=t)}function B4(e,t,n){n!==la[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),la[t]=n)}function a0(e,t){for(const n in t)Wa(e,n,t[n])}function Wa(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function hkn(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function bHe(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function dkn(e){pg.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}lS(dkn,pg,{svg(){return this._text},_render(e){const t=mHe();t.open("svg",Ex({},$D,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",yHe,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Cm[t.marktype],r=n.tag,i=[hHe,n.attr];e.open("g",{class:rHe(t),"clip-path":t.clip?lce(this,t,t.group):null},dHe(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const s=a=>{const o=this.href(a);if(o&&e.open("a",o),e.open(r,this.attr(t,a,i,r!=="g"?r:null)),r==="text"){const l=oW(a);if(Ma(l)){const u={x:0,dy:G$(a)};for(let c=0;c<l.length;++c)e.open("tspan",c?u:null).text($m(a,l[c])).close()}else e.text($m(a,l))}else if(r==="g"){const l=a.strokeForeground,u=a.fill,c=a.stroke;l&&c&&(a.stroke=null),e.open("path",this.attr(t,a,n.background,"bgrect")).close(),e.open("g",this.attr(t,a,n.content)),Yh(a,f=>this.mark(e,f)),e.close(),l&&c?(u&&(a.fill=null),a.stroke=c,e.open("path",this.attr(t,a,n.foreground,"bgrect")).close(),u&&(a.fill=u)):e.open("path",this.attr(t,a,n.foreground,"bgfore")).close()}e.close(),o&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):Yh(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},s=(a,o,l,u)=>{i[u||a]=o};return Array.isArray(n)?n.forEach(a=>a(s,t,this)):n(s,t,this),r&&pkn(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const s=t[i],a=s.stops;s.gradient==="radial"?(e.open("pattern",{id:Z6+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:i,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let o=0;o<a.length;++o)e.open("stop",{offset:a[o].offset,"stop-color":a[o].color}).close();e.close()}for(const i in n){const s=n[i];e.open("clipPath",{id:i}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});function pkn(e,t,n,r,i){let s;if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=lW(t),e["font-size"]=dg(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in sB){let o=t[a];const l=sB[a];o==="transparent"&&(l==="fill"||l==="stroke")||o!=null&&(sce(o)&&(o=Pje(o,i.gradient,"")),e[l]=o)}for(const a in aB){const o=t[a];o!=null&&(s=s||[],s.push(`${aB[a]}: ${o};`))}return s&&(e.style=s.join(" ")),e}function gkn(e,t,n){const r=[],i=new of().union(t),s=e.marktype;return s?xHe(e,i,n,r):s==="group"?wHe(e,i,n,r):br("Intersect scene must be mark node or group item.")}function xHe(e,t,n,r){if(mkn(e,t,n)){const i=e.items,s=e.marktype,a=i.length;let o=0;if(s==="group")for(;o<a;++o)wHe(i[o],t,n,r);else for(const l=Cm[s].isect;o<a;++o){const u=i[o];$He(u,t,l)&&r.push(u)}}return r}function mkn(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function wHe(e,t,n,r){n&&n(e.mark)&&$He(e,t,Cm.group.isect)&&r.push(e);const i=e.items,s=i&&i.length;if(s){const a=e.x||0,o=e.y||0;t.translate(-a,-o);for(let l=0;l<s;++l)xHe(i[l],t,n,r);t.translate(a,o)}return r}function $He(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}new of;var oB=Math.random;const CHe=Math.sqrt(2*Math.PI),vkn=Math.SQRT2;let zk=NaN;function _He(e,t){e=e||0,t=t==null?1:t;let n=0,r=0,i,s;if(zk===zk)n=zk,zk=NaN;else{do n=oB()*2-1,r=oB()*2-1,i=n*n+r*r;while(i===0||i>1);s=Math.sqrt(-2*Math.log(i)/i),n*=s,zk=r*s}return e+n*t}function ykn(e,t,n){n=n==null?1:n;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*CHe)}function SHe(e,t,n){t=t||0,n=n==null?1:n;const r=(e-t)/n,i=Math.abs(r);let s;if(i>37)s=0;else{const a=Math.exp(-i*i/2);let o;i<7.07106781186547?(o=.0352624965998911*i+.700383064443688,o=o*i+6.37396220353165,o=o*i+33.912866078383,o=o*i+112.079291497871,o=o*i+221.213596169931,o=o*i+220.206867912376,s=a*o,o=.0883883476483184*i+1.75566716318264,o=o*i+16.064177579207,o=o*i+86.7807322029461,o=o*i+296.564248779674,o=o*i+637.333633378831,o=o*i+793.826512519948,o=o*i+440.413735824752,s=s/o):(o=i+.65,o=i+4/o,o=i+3/o,o=i+2/o,o=i+1/o,s=a/o/2.506628274631)}return r>0?1-s:s}function kHe(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*vkn*bkn(2*e-1)}function bkn(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function xkn(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+_He()*t)}function wkn(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*CHe*e)}function $kn(e,t,n){return SHe(Math.log(e),t,n)}function Ckn(e,t,n){return Math.exp(kHe(e,t,n))}function _kn(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*oB()}function Skn(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function kkn(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Ekn(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function EHe(e){const t=this.context.data[e];return t?t.values.value:[]}function Akn(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function Tkn(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(OU).insert(t)),1}function Dkn(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const nF=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},Ikn=nF("format"),AHe=nF("timeFormat"),Nkn=nF("utcFormat"),Mkn=nF("timeParse"),Fkn=nF("utcParse"),SR=new Date(2e3,0,1);function cW(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(SR.setYear(2e3),SR.setMonth(e),SR.setDate(t),AHe.call(this,SR,n))}function Okn(e){return cW.call(this,e,1,"%B")}function Rkn(e){return cW.call(this,e,1,"%b")}function Pkn(e){return cW.call(this,0,2+e,"%A")}function Lkn(e){return cW.call(this,0,2+e,"%a")}const Bkn=":",zkn="@",nJ="%",Ukn="$";function kce(e,t,n,r){t[0].type!==dD&&br("First argument to data functions must be a string literal.");const i=t[0].value,s=Bkn+i;if(!Ns(s,r))try{r[s]=n.getData(i).tuplesRef()}catch{}}function Wkn(e,t,n,r){t[0].type!==dD&&br("First argument to indata must be a string literal."),t[1].type!==dD&&br("Second argument to indata must be a string literal.");const i=t[0].value,s=t[1].value,a=zkn+s;Ns(a,r)||(r[a]=n.getData(i).indataRef(n,s))}function nl(e,t,n,r){if(t[0].type===dD)q$e(n,r,t[0].value);else for(e in n.scales)q$e(n,r,e)}function q$e(e,t,n){const r=nJ+n;if(!Ns(t,r))try{t[r]=e.scaleRef(n)}catch{}}function gg(e,t){let n;return mm(e)?e:vm(e)?(n=t.scales[e])&&n.value:void 0}function Vkn(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=nl,n._range=nl,n._scale=nl;const r=i=>"_["+(i.type===dD?hD(nJ+i.value):hD(nJ)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function Ece(e,t){return function(n,r,i){if(n){const s=gg(n,(i||this).context);return s&&s.path[e](r)}else return t(r)}}const jkn=Ece("area",YZt),Hkn=Ece("bounds",QZt),qkn=Ece("centroid",iQt);function Gkn(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function Ace(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function Ykn(){return Ace(this.context.dataflow,"warn",arguments)}function Xkn(){return Ace(this.context.dataflow,"info",arguments)}function Kkn(){return Ace(this.context.dataflow,"debug",arguments)}function fG(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function rJ(e){const t=nm(e),n=fG(t.r),r=fG(t.g),i=fG(t.b);return .2126*n+.7152*r+.0722*i}function Zkn(e,t){const n=rJ(e),r=rJ(t),i=Math.max(n,r),s=Math.min(n,r);return(i+.05)/(s+.05)}function Qkn(){const e=[].slice.call(arguments);return e.unshift({}),Ex(...e)}function THe(e,t){return e===t||e!==e&&t!==t?!0:Ma(e)?Ma(t)&&e.length===t.length?Jkn(e,t):!1:fD(e)&&fD(t)?DHe(e,t):!1}function Jkn(e,t){for(let n=0,r=e.length;n<r;++n)if(!THe(e[n],t[n]))return!1;return!0}function DHe(e,t){for(const n in e)if(!THe(e[n],t[n]))return!1;return!0}function G$e(e){return t=>DHe(e,t)}function eEn(e,t,n,r,i,s){const a=this.context.dataflow,o=this.context.data[e],l=o.input,u=a.stamp();let c=o.changes,f,h;if(a._trigger===!1||!(l.value.length||t||r))return 0;if((!c||c.stamp<u)&&(o.changes=c=a.changeset(),c.stamp=u,a.runAfter(()=>{o.modified=!0,a.pulse(l,c).run()},!0,1)),n&&(f=n===!0?OU:Ma(n)||P_(n)?n:G$e(n),c.remove(f)),t&&c.insert(t),r&&(f=G$e(r),l.value.some(f)?c.remove(f):c.insert(r)),i)for(h in s)c.modify(i,h,s[h]);return 1}function tEn(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function nEn(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const Y$e={};function rEn(e,t){const n=Y$e[t]||(Y$e[t]=HWe(t));return Ma(e)?e.map(n):n(e)}function Tce(e){return Ma(e)||ArrayBuffer.isView(e)?e:null}function Dce(e){return Tce(e)||(vm(e)?e:null)}function iEn(e,...t){return Tce(e).join(...t)}function sEn(e,...t){return Dce(e).indexOf(...t)}function aEn(e,...t){return Dce(e).lastIndexOf(...t)}function oEn(e,...t){return Dce(e).slice(...t)}function lEn(e,t,n){return mm(n)&&br("Function argument passed to replace."),String(e).replace(t,n)}function uEn(e){return Tce(e).slice().reverse()}function cEn(e,t,n){return aje(e||0,t||0,n||0)}function fEn(e,t){const n=gg(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function hEn(e,t){const n=gg(e,(t||this).context);return n?n.copy():void 0}function dEn(e,t){const n=gg(e,(t||this).context);return n?n.domain():[]}function pEn(e,t,n){const r=gg(e,(n||this).context);return r?Ma(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function gEn(e,t){const n=gg(e,(t||this).context);return n&&n.range?n.range():[]}function mEn(e,t,n){const r=gg(e,(n||this).context);return r?r(t):void 0}function vEn(e,t,n,r,i){e=gg(e,(i||this).context);const s=NCn(t,n);let a=e.domain(),o=a[0],l=xo(a),u=Cue;return l-o?u=h$n(e,o,l):e=(e.interpolator?Hn("sequential")().interpolator(e.interpolator()):Hn("linear")().interpolate(e.interpolate()).range(e.range())).domain([o=0,l=1]),e.ticks&&(a=e.ticks(+r||15),o!==a[0]&&a.unshift(o),l!==xo(a)&&a.push(l)),a.forEach(c=>s.stop(u(c),e(c))),s}function yEn(e,t,n){const r=gg(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function bEn(e){let t=null;return function(n){return n?Q6(n,t=t||ace(e)):e}}const IHe=e=>e.data;function NHe(e,t){const n=EHe.call(t,e);return n.root&&n.root.lookup||{}}function xEn(e,t,n){const r=NHe(e,this),i=r[t],s=r[n];return i&&s?i.path(s).map(IHe):void 0}function wEn(e,t){const n=NHe(e,this)[t];return n?n.ancestors().map(IHe):void 0}const MHe=()=>typeof window<"u"&&window||null;function $En(){const e=MHe();return e?e.screen:{}}function CEn(){const e=MHe();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function _En(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function SEn(e,t,n){if(!e)return[];const[r,i]=e,s=new of().set(r[0],r[1],i[0],i[1]),a=n||this.context.dataflow.scenegraph().root;return gkn(a,s,kEn(t))}function kEn(e){let t=null;if(e){const n=P$(e.marktype),r=P$(e.markname);t=i=>(!n.length||n.some(s=>i.marktype===s))&&(!r.length||r.some(s=>i.name===s))}return t}const lB={random(){return oB()},cumulativeNormal:SHe,cumulativeLogNormal:$kn,cumulativeUniform:kkn,densityNormal:ykn,densityLogNormal:wkn,densityUniform:Skn,quantileNormal:kHe,quantileLogNormal:Ckn,quantileUniform:Ekn,sampleNormal:_He,sampleLogNormal:xkn,sampleUniform:_kn,isArray:Ma,isBoolean:pbn,isDate:KWe,isDefined(e){return e!==void 0},isNumber:ZWe,isObject:fD,isRegExp:gbn,isString:vm,isTuple:P_,isValid(e){return e!=null&&e===e},toBoolean:wbn,toDate:Cbn,toNumber:RU,toString:_bn,indexof:sEn,join:iEn,lastindexof:aEn,replace:lEn,reverse:uEn,slice:oEn,flush:hbn,lerp:mbn,merge:Qkn,pad:bbn,peek:xo,pluck:rEn,span:xbn,inrange:dbn,truncate:Sbn,rgb:nm,lab:OP,hcl:RP,hsl:MP,luminance:rJ,contrast:Zkn,sequence:Ml,format:Ikn,utcFormat:Nkn,utcParse:Fkn,utcOffset:Vwn,utcSequence:Hwn,timeFormat:AHe,timeParse:Mkn,timeOffset:Wwn,timeSequence:jwn,timeUnitSpecifier:Iwn,monthFormat:Okn,monthAbbrevFormat:Rkn,dayFormat:Pkn,dayAbbrevFormat:Lkn,quarter:abn,utcquarter:obn,week:Mwn,utcweek:Pwn,dayofyear:Nwn,utcdayofyear:Rwn,warn:Ykn,info:Xkn,debug:Kkn,extent:cbn,inScope:Gkn,intersect:SEn,clampRange:lbn,pinchDistance:tEn,pinchAngle:nEn,screen:$En,containerSize:_En,windowSize:CEn,bandspace:cEn,setdata:Tkn,pathShape:bEn,panLinear:Qyn,panLog:Jyn,panPow:ebn,panSymlog:tbn,zoomLinear:nbn,zoomLog:rbn,zoomPow:ibn,zoomSymlog:sbn,encode:Dkn,modify:eEn},EEn=["view","item","group","xy","x","y"],AEn="event.vega.",FHe="this.",Ice={},TEn={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${hD(Ukn+e)}]`,functions:DEn,constants:QWe,visitors:Ice},X$e=Rbn(TEn);function DEn(e){const t=JWe(e);EEn.forEach(n=>t[n]=AEn+n);for(const n in lB)t[n]=FHe+n;return Ex(t,Vkn(e,lB,Ice)),t}function wi(e,t,n){return arguments.length===1?lB[e]:(lB[e]=t,n&&(Ice[e]=n),X$e&&(X$e.functions[e]=FHe+e),this)}wi("bandwidth",fEn,nl);wi("copy",hEn,nl);wi("domain",dEn,nl);wi("range",gEn,nl);wi("invert",pEn,nl);wi("scale",mEn,nl);wi("gradient",vEn,nl);wi("geoArea",jkn,nl);wi("geoBounds",Hkn,nl);wi("geoCentroid",qkn,nl);wi("geoShape",yEn,nl);wi("indata",Akn,Wkn);wi("data",EHe,kce);wi("treePath",xEn,kce);wi("treeAncestors",wEn,kce);wi("vlSelectionTest",eWe,sS);wi("vlSelectionIdTest",nWe,sS);wi("vlSelectionResolve",iWe,sS);wi("vlSelectionTuples",rWe);const IEn="view",uB="[",cB="]",OHe="{",RHe="}",NEn=":",PHe=",",MEn="@",FEn=">",OEn=/[[\]{}]/,REn={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let LHe,BHe;function PEn(e,t,n){return LHe=t||IEn,BHe=n||REn,zHe(e.trim()).map(iJ)}function LEn(e){return BHe[e]}function OA(e,t,n,r,i){const s=e.length;let a=0,o;for(;t<s;++t){if(o=e[t],!a&&o===n)return t;i&&i.indexOf(o)>=0?--a:r&&r.indexOf(o)>=0&&++a}return t}function zHe(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=OA(e,i,PHe,uB+OHe,cB+RHe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function iJ(e){return e[0]==="["?BEn(e):zEn(e)}function BEn(e){const t=e.length;let n=1,r;if(n=OA(e,n,cB,uB,cB),n===t)throw"Empty between selector: "+e;if(r=zHe(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==FEn)throw"Expected '>' after between selector: "+e;r=r.map(iJ);const i=iJ(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function zEn(e){const t={source:LHe},n=[];let r=[0,0],i=0,s=0,a=e.length,o=0,l,u;if(e[a-1]===RHe){if(o=e.lastIndexOf(OHe),o>=0){try{r=UEn(e.substring(o+1,a-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,o).trim(),a=e.length}else throw"Unmatched right brace: "+e;o=0}if(!a)throw e;if(e[0]===MEn&&(i=++o),l=OA(e,o,NEn),l<a&&(n.push(e.substring(s,l).trim()),s=o=++l),o=OA(e,o,uB),o===a)n.push(e.substring(s,a).trim());else if(n.push(e.substring(s,o).trim()),u=[],s=++o,s===a)throw"Unmatched left bracket: "+e;for(;o<a;){if(o=OA(e,o,cB),o===a)throw"Unmatched left bracket: "+e;if(u.push(e.substring(s,o).trim()),o<a-1&&e[++o]!==uB)throw"Expected left bracket: "+e;s=++o}if(!(a=n.length)||OEn.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],i?t.markname=n[0].slice(1):LEn(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),u!=null&&(t.filter=u),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function UEn(e){const t=e.split(PHe);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function WEn(e){return Ft(e)?e:{type:e||"pad"}}const Uk=e=>+e||0,VEn=e=>({top:e,bottom:e,left:e,right:e});function jEn(e){return Ft(e)?e.signal?e:{top:Uk(e.top),bottom:Uk(e.bottom),left:Uk(e.left),right:Uk(e.right)}:VEn(Uk(e))}const us=e=>Ft(e)&&!at(e)?zt({},e):{value:e};function K$e(e,t,n,r){return n!=null?(Ft(n)&&!at(n)||at(n)&&n.length&&Ft(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function qs(e,t,n){for(const r in t)K$e(e,r,t[r]);for(const r in n)K$e(e,r,n[r],"update")}function mS(e,t,n){for(const r in t)n&&bt(n,r)||(e[r]=zt(e[r]||{},t[r]));return e}function k2(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const Nce="mark",Mce="frame",Fce="scope",HEn="axis",qEn="axis-domain",GEn="axis-grid",YEn="axis-label",XEn="axis-tick",KEn="axis-title",ZEn="legend",QEn="legend-band",JEn="legend-entry",eAn="legend-gradient",UHe="legend-label",tAn="legend-symbol",nAn="legend-title",rAn="title",iAn="title-text",sAn="title-subtitle";function aAn(e,t,n,r,i){const s={},a={};let o,l,u,c;l="lineBreak",t==="text"&&i[l]!=null&&!k2(l,e)&&hG(s,l,i[l]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===Mce?i.group:n===Nce?zt({},i.mark,i[t]):null;for(l in c)u=k2(l,e)||(l==="fill"||l==="stroke")&&(k2("fill",e)||k2("stroke",e)),u||hG(s,l,c[l]);ct(r).forEach(f=>{const h=i.style&&i.style[f];for(const d in h)k2(d,e)||hG(s,d,h[d])}),e=zt({},e);for(l in s)c=s[l],c.signal?(o=o||{})[l]=c:a[l]=c;return e.enter=zt(a,e.enter),o&&(e.update=zt(o,e.update)),e}function hG(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const WHe=e=>wr(e)?ot(e):e.signal?`(${e.signal})`:VHe(e);function fW(e){if(e.gradient!=null)return lAn(e);let t=e.signal?`(${e.signal})`:e.color?oAn(e.color):e.field!=null?VHe(e.field):e.value!==void 0?ot(e.value):void 0;return e.scale!=null&&(t=uAn(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${z4(e.exponent)})`),e.mult!=null&&(t+=`*${z4(e.mult)}`),e.offset!=null&&(t+=`+${z4(e.offset)}`),e.round&&(t=`round(${t})`),t}const kR=(e,t,n,r)=>`(${e}(${[t,n,r].map(fW).join(",")})+'')`;function oAn(e){return e.c?kR("hcl",e.h,e.c,e.l):e.h||e.s?kR("hsl",e.h,e.s,e.l):e.l||e.a?kR("lab",e.l,e.a,e.b):e.r||e.g||e.b?kR("rgb",e.r,e.g,e.b):null}function lAn(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:ot(n));for(;t.length&&ln(t)==null;)t.pop();return t.unshift(WHe(e.gradient)),`gradient(${t.join(",")})`}function z4(e){return Ft(e)?"("+fW(e)+")":e}function VHe(e){return jHe(Ft(e)?e:{datum:e})}function jHe(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):$e("Invalid field reference: "+ot(e));return e.signal||(r=wr(r)?Sre(r).map(ot).join("]["):jHe(r)),t+"["+r+"]"}function uAn(e,t){const n=WHe(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+z4(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function cAn(e){let t="";return e.forEach(n=>{const r=fW(n);t+=n.test?`(${n.test})?${r}:`:r}),ln(t)===":"&&(t+="null"),t}function HHe(e,t,n,r,i,s){const a={};s=s||{},s.encoders={$encode:a},e=aAn(e,t,n,r,i.config);for(const o in e)a[o]=fAn(e[o],t,s,i);return s}function fAn(e,t,n,r){const i={},s={};for(const a in e)e[a]!=null&&(i[a]=dAn(hAn(e[a]),r,n,s));return{$expr:{marktype:t,channels:i},$fields:Object.keys(s),$output:Object.keys(e)}}function hAn(e){return at(e)?cAn(e):fW(e)}function dAn(e,t,n,r){const i=Hh(e,t);return i.$fields.forEach(s=>r[s]=1),zt(n,i.$params),i.$expr}const pAn="outer",gAn=["value","update","init","react","bind"];function Z$e(e,t){$e(e+' for "outer" push: '+ot(t))}function qHe(e,t){const n=e.name;if(e.push===pAn)t.signals[n]||Z$e("No prior signal definition",n),gAn.forEach(r=>{e[r]!==void 0&&Z$e("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function sJ(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function hW(e,t,n,r){return new sJ(e,t,n,r)}function fB(e,t){return hW("operator",e,t)}function tt(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function _D(e,t){return t?{$field:e,$name:t}:{$field:e}}const aJ=_D("key");function Q$e(e,t){return{$compare:e,$order:t}}function mAn(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const vAn="ascending",yAn="descending";function bAn(e){return Ft(e)?(e.order===yAn?"-":"+")+dW(e.op,e.field):""}function dW(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const Oce="scope",oJ="view";function Ii(e){return e&&e.signal}function xAn(e){return e&&e.expr}function U4(e){if(Ii(e))return!0;if(Ft(e)){for(const t in e)if(U4(e[t]))return!0}return!1}function pc(e,t){return e!=null?e:t}function my(e){return e&&e.signal||e}const J$e="timer";function SD(e,t){return(e.merge?$An:e.stream?CAn:e.type?_An:$e("Invalid stream specification: "+ot(e)))(e,t)}function wAn(e){return e===Oce?oJ:e||oJ}function $An(e,t){const n=e.merge.map(i=>SD(i,t)),r=Rce({merge:n},e,t);return t.addStream(r).id}function CAn(e,t){const n=SD(e.stream,t),r=Rce({stream:n},e,t);return t.addStream(r).id}function _An(e,t){let n;e.type===J$e?(n=t.event(J$e,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(wAn(e.source),e.type);const r=Rce({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function Rce(e,t,n){let r=t.between;return r&&(r.length!==2&&$e('Stream "between" parameter must have 2 entries: '+ot(t)),e.between=[SD(r[0],n),SD(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(SAn(t.marktype,t.markname,t.markrole)),t.source===Oce&&r.push("inScope(event.item)"),r.length&&(e.filter=Hh("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function SAn(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const kAn={code:"_.$value",ast:{type:"Identifier",value:"value"}};function EAn(e,t,n){const r=e.encode,i={target:n};let s=e.events,a=e.update,o=[];s||$e("Signal update missing events specification."),wr(s)&&(s=PEn(s,t.isSubscope()?Oce:oJ)),s=ct(s).filter(l=>l.signal||l.scale?(o.push(l),0):1),o.length>1&&(o=[TAn(o)]),s.length&&o.push(s.length>1?{merge:s}:s[0]),r!=null&&(a&&$e("Signal encode and update are mutually exclusive."),a="encode(item(),"+ot(r)+")"),i.update=wr(a)?Hh(a,t):a.expr!=null?Hh(a.expr,t):a.value!=null?a.value:a.signal!=null?{$expr:kAn,$params:{$value:t.signalRef(a.signal)}}:$e("Invalid signal update specification."),e.force&&(i.options={force:!0}),o.forEach(l=>t.addUpdate(zt(AAn(l,t),i)))}function AAn(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):SD(e,t)}}function TAn(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function DAn(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?$e("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=Hh(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>EAn(i,t,n.id))}const Xn=e=>(t,n,r)=>hW(e,n,t||void 0,r),GHe=Xn("aggregate"),IAn=Xn("axisticks"),YHe=Xn("bound"),vf=Xn("collect"),eCe=Xn("compare"),NAn=Xn("datajoin"),XHe=Xn("encode"),MAn=Xn("expression"),FAn=Xn("facet"),OAn=Xn("field"),RAn=Xn("key"),PAn=Xn("legendentries"),LAn=Xn("load"),BAn=Xn("mark"),zAn=Xn("multiextent"),UAn=Xn("multivalues"),WAn=Xn("overlap"),VAn=Xn("params"),KHe=Xn("prefacet"),jAn=Xn("projection"),HAn=Xn("proxy"),qAn=Xn("relay"),ZHe=Xn("render"),GAn=Xn("scale"),Nx=Xn("sieve"),YAn=Xn("sortitems"),QHe=Xn("viewlayout"),XAn=Xn("values");let KAn=0;const JHe={min:"min",max:"max",count:"sum"};function ZAn(e,t){const n=e.type||"linear";M5e(n)||$e("Unrecognized scale type: "+ot(n)),t.addScale(e.name,{type:n,domain:void 0})}function QAn(e,t){const n=t.getScale(e.name).params;let r;n.domain=eqe(e.domain,e,t),e.range!=null&&(n.range=nqe(e,t,n)),e.interpolate!=null&&lTn(e.interpolate,n),e.nice!=null&&(n.nice=oTn(e.nice)),e.bins!=null&&(n.bins=aTn(e.bins,t));for(r in e)bt(n,r)||r==="name"||(n[r]=Su(e[r],t))}function Su(e,t){return Ft(e)?e.signal?t.signalRef(e.signal):$e("Unsupported object: "+ot(e)):e}function W4(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Su(n,t))}function pW(e){$e("Can not find data set: "+ot(e))}function eqe(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&$e("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(at(e)?JAn:e.fields?tTn:eTn)(e,t,n)}function JAn(e,t,n){return e.map(r=>Su(r,n))}function eTn(e,t,n){const r=n.getData(e.data);return r||pW(e.data),s$(t.type)?r.valuesRef(n,e.field,tqe(e.sort,!1)):R5e(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function tTn(e,t,n){const r=e.data,i=e.fields.reduce((s,a)=>(a=wr(a)?{data:r,field:a}:at(a)||a.signal?nTn(a,n):a,s.push(a),s),[]);return(s$(t.type)?rTn:R5e(t.type)?iTn:sTn)(e,n,i)}function nTn(e,t){const n="_:vega:_"+KAn++,r=vf({});if(at(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+ot(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Nx({})]),{data:n,field:"data"}}function rTn(e,t,n){const r=tqe(e.sort,!0);let i,s;const a=n.map(u=>{const c=t.getData(u.data);return c||pW(u.data),c.countsRef(t,u.field,r)}),o={groupby:aJ,pulse:a};r&&(i=r.op||"count",s=r.field?dW(i,r.field):"count",o.ops=[JHe[i]],o.fields=[t.fieldRef(s)],o.as=[s]),i=t.add(GHe(o));const l=t.add(vf({pulse:tt(i)}));return s=t.add(XAn({field:aJ,sort:t.sortRef(r),pulse:tt(l)})),tt(s)}function tqe(e,t){return e&&(!e.field&&!e.op?Ft(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?$e("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!JHe[e.op]&&$e("Multiple domain scales can not be sorted using "+e.op)),e}function iTn(e,t,n){const r=n.map(i=>{const s=t.getData(i.data);return s||pW(i.data),s.domainRef(t,i.field)});return tt(t.add(UAn({values:r})))}function sTn(e,t,n){const r=n.map(i=>{const s=t.getData(i.data);return s||pW(i.data),s.extentRef(t,i.field)});return tt(t.add(zAn({extents:r})))}function aTn(e,t){return e.signal||at(e)?W4(e,t):t.objectProperty(e)}function oTn(e){return Ft(e)?{interval:Su(e.interval),step:Su(e.step)}:Su(e)}function lTn(e,t){t.interpolate=Su(e.type||e),e.gamma!=null&&(t.interpolateGamma=Su(e.gamma))}function nqe(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(wr(i)){if(r&&bt(r,i))return e=zt({},e,{range:r[i]}),nqe(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=s$(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:$e("Unrecognized scale range value: "+ot(i))}else if(i.scheme){n.scheme=at(i.scheme)?W4(i.scheme,t):Su(i.scheme,t),i.extent&&(n.schemeExtent=W4(i.extent,t)),i.count&&(n.schemeCount=Su(i.count,t));return}else if(i.step){n.rangeStep=Su(i.step,t);return}else{if(s$(e.type)&&!at(i))return eqe(i,e,t);at(i)||$e("Unsupported range type: "+ot(i))}return i.map(s=>(at(s)?W4:Su)(s,t))}function uTn(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=lJ(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=lJ(n[i],i,t));t.addProjection(e.name,r)}function lJ(e,t,n){return at(e)?e.map(r=>lJ(r,t,n)):Ft(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:$e("Unsupported parameter object: "+ot(e)):e}const yf="top",vS="left",yS="right",_m="bottom",rqe="center",cTn="vertical",fTn="start",hTn="middle",dTn="end",uJ="index",Pce="label",pTn="offset",Y$="perc",gTn="perc2",Tu="value",rF="guide-label",Lce="guide-title",mTn="group-title",vTn="group-subtitle",tCe="symbol",V4="gradient",cJ="discrete",fJ="size",yTn="shape",bTn="fill",xTn="stroke",wTn="strokeWidth",$Tn="strokeDash",CTn="opacity",Bce=[fJ,yTn,bTn,xTn,wTn,$Tn,CTn],iF={name:1,style:1,interactive:1},sn={value:0},Du={value:1},gW="group",iqe="rect",zce="rule",_Tn="symbol",Mx="text";function kD(e){return e.type=gW,e.interactive=e.interactive||!1,e}function bl(e,t){const n=(r,i)=>pc(e[r],pc(t[r],i));return n.isVertical=r=>cTn===pc(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>pc(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>pc(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>pc(e.columns,pc(t.columns,+n.isVertical(!0))),n}function sqe(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function STn(e,t,n){const r=t.config.style[n];return r&&r[e]}function mW(e,t,n){return`item.anchor === '${fTn}' ? ${e} : item.anchor === '${dTn}' ? ${t} : ${n}`}const Uce=mW(ot(vS),ot(yS),ot(rqe));function kTn(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},Ft(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function aqe(e,t){return t?e?Ft(e)?Object.assign({},e,{offset:aqe(e.offset,t)}):{value:e,offset:t}:t:e}function Xl(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=mS(e.encode,t,iF)):e.interactive=!1,e}function ETn(e,t,n,r){const i=bl(e,n),s=i.isVertical(),a=i.gradientThickness(),o=i.gradientLength();let l,u,c,f,h;s?(u=[0,1],c=[0,0],f=a,h=o):(u=[0,0],c=[1,0],f=o,h=a);const d={enter:l={opacity:sn,x:sn,y:sn,width:us(f),height:us(h)},update:zt({},l,{opacity:Du,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:sn}};return qs(d,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Xl({type:iqe,role:eAn,encode:d},r)}function ATn(e,t,n,r,i){const s=bl(e,n),a=s.isVertical(),o=s.gradientThickness(),l=s.gradientLength();let u,c,f,h,d="";a?(u="y",f="y2",c="x",h="width",d="1-"):(u="x",f="x2",c="y",h="height");const p={opacity:sn,fill:{scale:t,field:Tu}};p[u]={signal:d+"datum."+Y$,mult:l},p[c]=sn,p[f]={signal:d+"datum."+gTn,mult:l},p[h]=us(o);const g={enter:p,update:zt({},p,{opacity:Du}),exit:{opacity:sn}};return qs(g,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),Xl({type:iqe,role:QEn,key:Tu,from:i,encode:g},r)}const TTn=`datum.${Y$}<=0?"${vS}":datum.${Y$}>=1?"${yS}":"${rqe}"`,DTn=`datum.${Y$}<=0?"${_m}":datum.${Y$}>=1?"${yf}":"${hTn}"`;function nCe(e,t,n,r){const i=bl(e,t),s=i.isVertical(),a=us(i.gradientThickness()),o=i.gradientLength();let l=i("labelOverlap"),u,c,f,h,d="";const p={enter:u={opacity:sn},update:c={opacity:Du,text:{field:Pce}},exit:{opacity:sn}};return qs(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:pc(e.labelLimit,t.gradientLabelLimit)}),s?(u.align={value:"left"},u.baseline=c.baseline={signal:DTn},f="y",h="x",d="1-"):(u.align=c.align={signal:TTn},u.baseline={value:"top"},f="x",h="y"),u[f]=c[f]={signal:d+"datum."+Y$,mult:o},u[h]=c[h]=a,a.offset=pc(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:i("labelSeparation"),method:l,order:"datum."+uJ}:void 0,Xl({type:Mx,role:UHe,style:rF,key:Tu,from:r,encode:p,overlap:l},n)}function ITn(e,t,n,r,i){const s=bl(e,t),a=n.entries,o=!!(a&&a.interactive),l=a?a.name:void 0,u=s("clipHeight"),c=s("symbolOffset"),f={data:"value"},h=`(${i}) ? datum.${pTn} : datum.${fJ}`,d=u?us(u):{field:fJ},p=`datum.${uJ}`,g=`max(1, ${i})`;let m,v,y,b,x;d.mult=.5,m={enter:v={opacity:sn,x:{signal:h,mult:.5,offset:c},y:d},update:y={opacity:Du,x:v.x,y:v.y},exit:{opacity:sn}};let w=null,C=null;e.fill||(w=t.symbolBaseFillColor,C=t.symbolBaseStrokeColor),qs(m,{fill:s("symbolFillColor",w),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",C),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),Bce.forEach(E=>{e[E]&&(y[E]=v[E]={scale:e[E],field:Tu})});const $=Xl({type:_Tn,role:tAn,key:Tu,from:f,clip:u?!0:void 0,encode:m},n.symbols),_=us(c);_.offset=s("labelOffset"),m={enter:v={opacity:sn,x:{signal:h,offset:_},y:d},update:y={opacity:Du,text:{field:Pce},x:v.x,y:v.y},exit:{opacity:sn}},qs(m,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const k=Xl({type:Mx,role:UHe,style:rF,key:Tu,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!u},width:sn,height:u?us(u):sn,opacity:sn},exit:{opacity:sn},update:y={opacity:Du,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(b=`ceil(item.mark.items.length / ${g})`,y.row.signal=`${p}%${b}`,y.column.signal=`floor(${p} / ${b})`,x={field:["row",p]}):(y.row.signal=`floor(${p} / ${g})`,y.column.signal=`${p} % ${g}`,x={field:p}),y.column.signal=`(${i})?${y.column.signal}:${p}`,r={facet:{data:r,name:"value",groupby:uJ}},kD({role:Fce,from:r,encode:mS(m,a,iF),marks:[$,k],name:l,interactive:o,sort:x})}function NTn(e,t){const n=bl(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const Wce='item.orient === "left"',Vce='item.orient === "right"',vW=`(${Wce} || ${Vce})`,MTn=`datum.vgrad && ${vW}`,FTn=mW('"top"','"bottom"','"middle"'),OTn=mW('"right"','"left"','"center"'),RTn=`datum.vgrad && ${Vce} ? (${OTn}) : (${vW} && !(datum.vgrad && ${Wce})) ? "left" : ${Uce}`,PTn=`item._anchor || (${vW} ? "middle" : "start")`,LTn=`${MTn} ? (${Wce} ? -90 : 90) : 0`,BTn=`${vW} ? (datum.vgrad ? (${Vce} ? "bottom" : "top") : ${FTn}) : "top"`;function zTn(e,t,n,r){const i=bl(e,t),s={enter:{opacity:sn},update:{opacity:Du,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:sn}};return qs(s,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:PTn},angle:{signal:LTn},align:{signal:RTn},baseline:{signal:BTn},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Xl({type:Mx,role:nAn,style:Lce,from:r,encode:s},n)}function UTn(e,t){let n;return Ft(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+rCe(e.path)+")":e.sphere&&(n="geoShape("+rCe(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function rCe(e){return Ft(e)&&e.signal?e.signal:ot(e)}function oqe(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===gW?Fce:t||Nce}function WTn(e){return{marktype:e.type,name:e.name||void 0,role:e.role||oqe(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function VTn(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function jce(e,t){const n=nRe(e.type);n||$e("Unrecognized transform type: "+ot(e.type));const r=hW(n.type.toLowerCase(),null,lqe(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function lqe(e,t,n){const r={},i=e.params.length;for(let s=0;s<i;++s){const a=e.params[s];r[a.name]=jTn(a,t,n)}return r}function jTn(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return HTn(e,t,n);if(i===void 0){e.required&&$e("Missing required "+ot(t.type)+" parameter: "+ot(e.name));return}else{if(r==="param")return qTn(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!Ii(i)?i.map(s=>iCe(e,s,n)):iCe(e,i,n)}function iCe(e,t,n){const r=e.type;if(Ii(t))return aCe(r)?$e("Expression references can not be signals."):dG(r)?n.fieldRef(t):oCe(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||dG(r);return i&&GTn(t)?n.exprRef(t.expr,t.as):i&&YTn(t)?_D(t.field,t.as):aCe(r)?Hh(t,n):XTn(r)?tt(n.getData(t).values):dG(r)?_D(t):oCe(r)?n.compareRef(t):t}}function HTn(e,t,n){return wr(t.from)||$e('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function qTn(e,t,n){const r=t[e.name];return e.array?(at(r)||$e("Expected an array of sub-parameters. Instead: "+ot(r)),r.map(i=>sCe(e,i,n))):sCe(e,r,n)}function sCe(e,t,n){const r=e.params.length;let i;for(let a=0;a<r;++a){i=e.params[a];for(const o in i.key)if(i.key[o]!==t[o]){i=null;break}if(i)break}i||$e("Unsupported parameter: "+ot(t));const s=zt(lqe(i,t,n),i.key);return tt(n.add(VAn(s)))}const GTn=e=>e&&e.expr,YTn=e=>e&&e.field,XTn=e=>e==="data",aCe=e=>e==="expr",dG=e=>e==="field",oCe=e=>e==="compare";function KTn(e,t,n){let r,i,s,a,o;return e?(r=e.facet)&&(t||$e("Only group marks can be faceted."),r.field!=null?a=o=j4(r,n):(e.data?o=tt(n.getData(e.data).aggregate):(s=jce(zt({type:"aggregate",groupby:ct(r.groupby)},r.aggregate),n),s.params.key=n.keyRef(r.groupby),s.params.pulse=j4(r,n),a=o=tt(n.add(s))),i=n.keyRef(r.groupby,!0))):a=tt(n.add(vf(null,[{}]))),a||(a=j4(e,n)),{key:i,pulse:a,parent:o}}function j4(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:tt(t.getData(e.data).output)}function bb(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}bb.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let s=t[0],a=null,o=1;for(s&&s.type==="load"&&(s=t[1]),e.add(t[0]);o<n;++o)t[o].params.pulse=tt(t[o-1]),e.add(t[o]),t[o].type==="aggregate"&&(a=t[o]);return new bb(e,s,i,r,a)};function uqe(e){return wr(e)?e:null}function lCe(e,t,n){const r=dW(n.op,n.field);let i;if(t.ops){for(let s=0,a=t.as.length;s<a;++s)if(t.as[s]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function Wk(e,t,n,r,i,s,a){const o=t[n]||(t[n]={}),l=bAn(s);let u=uqe(i),c,f;if(u!=null&&(e=t.scope,u=u+(l?"|"+l:""),c=o[u]),!c){const h=s?{field:aJ,pulse:t.countsRef(e,i,s)}:{field:e.fieldRef(i),pulse:tt(t.output)};l&&(h.sort=e.sortRef(s)),f=e.add(hW(r,void 0,h)),a&&(t.index[i]=f),c=tt(f),u!=null&&(o[u]=c)}return c}bb.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),s=uqe(t);let a,o,l;return s!=null&&(e=r.scope,a=i[s]),a?n&&n.field&&lCe(e,a.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:tt(r.output)},n&&n.field&&lCe(e,l,n),o=e.add(GHe(l)),a=e.add(vf({pulse:tt(o)})),a={agg:o,ref:tt(a)},s!=null&&(i[s]=a)),a.ref},tuplesRef(){return tt(this.values)},extentRef(e,t){return Wk(e,this,"extent","extent",t,!1)},domainRef(e,t){return Wk(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return Wk(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return Wk(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return Wk(e,this,"indata","tupleindex",t,!0,!0)}};function ZTn(e,t,n){const r=e.from.facet,i=r.name,s=j4(r,t);let a;r.name||$e("Facet must have a name: "+ot(r)),r.data||$e("Facet must reference a data set: "+ot(r)),r.field?a=t.add(KHe({field:t.fieldRef(r.field),pulse:s})):r.groupby?a=t.add(FAn({key:t.keyRef(r.groupby),group:tt(t.proxy(n.parent)),pulse:s})):$e("Facet must specify groupby or field: "+ot(r));const o=t.fork(),l=o.add(vf()),u=o.add(Nx({pulse:tt(l)}));o.addData(i,new bb(o,l,l,u)),o.addSignal("parent",null),a.params.subflow={$subflow:o.parse(e).toRuntime()}}function QTn(e,t,n){const r=t.add(KHe({pulse:n.pulse})),i=t.fork();i.add(Nx()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function cqe(e,t,n){const r=e.remove,i=e.insert,s=e.toggle,a=e.modify,o=e.values,l=t.add(fB()),u="if("+e.trigger+',modify("'+n+'",'+[i,r,s,a,o].map(f=>f==null?"null":f).join(",")+"),0)",c=Hh(u,t);l.update=c.$expr,l.params=c.$params}function yW(e,t){const n=oqe(e),r=e.type===gW,i=e.from&&e.from.facet,s=e.overlap;let a=e.layout||n===Fce||n===Mce,o,l,u,c,f,h,d;const p=n===Nce||a||i,g=KTn(e.from,r,t);l=t.add(NAn({key:g.key||(e.key?_D(e.key):void 0),pulse:g.pulse,clean:!r}));const m=tt(l);l=u=t.add(vf({pulse:m})),l=t.add(BAn({markdef:WTn(e),interactive:VTn(e.interactive,t),clip:UTn(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:tt(l)}));const v=tt(l);l=c=t.add(XHe(HHe(e.encode,e.type,n,e.style,t,{mod:!1,pulse:v}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(C=>{const $=jce(C,t),_=$.metadata;(_.generates||_.changes)&&$e("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),$.params.pulse=tt(l),t.add(l=$)}),e.sort&&(l=t.add(YAn({sort:t.compareRef(e.sort),pulse:tt(l)})));const y=tt(l);(i||a)&&(a=t.add(QHe({layout:t.objectProperty(e.layout),legends:t.legends,mark:v,pulse:y})),h=tt(a));const b=t.add(YHe({mark:v,pulse:h||y}));d=tt(b),r&&(p&&(o=t.operators,o.pop(),a&&o.pop()),t.pushState(y,h||d,m),i?ZTn(e,t,g):p?QTn(e,t,g):t.parse(e),t.popState(),p&&(a&&o.push(a),o.push(b))),s&&(d=JTn(s,d,t));const x=t.add(ZHe({pulse:d})),w=t.add(Nx({pulse:tt(x)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new bb(t,u,x,w)),e.on&&e.on.forEach(C=>{(C.insert||C.remove||C.toggle)&&$e("Marks only support modify triggers."),cqe(C,t,f)}))}function JTn(e,t,n){const r=e.method,i=e.bound,s=e.separation,a={separation:Ii(s)?n.signalRef(s.signal):s,method:Ii(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(a.sort=n.compareRef({field:e.order})),i){const o=i.tolerance;a.boundTolerance=Ii(o)?n.signalRef(o.signal):+o,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return tt(n.add(WAn(a)))}function e3n(e,t){const n=t.config.legend,r=e.encode||{},i=bl(e,n),s=r.legend||{},a=s.name||void 0,o=s.interactive,l=s.style,u={};let c=0,f,h,d;Bce.forEach(b=>e[b]?(u[b]=e[b],c=c||e[b]):0),c||$e("Missing valid scale for legend.");const p=t3n(e,t.scaleType(c)),g={title:e.title!=null,scales:u,type:p,vgrad:p!=="symbol"&&i.isVertical()},m=tt(t.add(vf(null,[g]))),v={enter:{x:{value:0},y:{value:0}}},y=tt(t.add(PAn(h={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===V4?(d=[ETn(e,c,n,r.gradient),nCe(e,n,r.labels,y)],h.count=h.count||t.signalRef(`max(2,2*floor((${my(i.gradientLength())})/100))`)):p===cJ?d=[ATn(e,c,n,r.gradient,y),nCe(e,n,r.labels,y)]:(f=NTn(e,n),d=[ITn(e,n,r,y,my(f.columns))],h.size=i3n(e,t,d[0].marks)),d=[kD({role:JEn,from:m,encode:v,marks:d,layout:f,interactive:o})],g.title&&d.push(zTn(e,n,r.title,m)),yW(kD({role:ZEn,from:m,encode:mS(r3n(i,e,n),s,iF),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:o,style:l}),t)}function t3n(e,t){let n=e.type||tCe;return!e.type&&n3n(e)===1&&(e.fill||e.stroke)&&(n=nse(t)?V4:nK(t)?cJ:tCe),n!==V4?n:nK(t)?cJ:V4}function n3n(e){return Bce.reduce((t,n)=>t+(e[n]?1:0),0)}function r3n(e,t,n){const r={enter:{},update:{}};return qs(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function i3n(e,t,n){const r=my(uCe("size",e,n)),i=my(uCe("strokeWidth",e,n)),s=my(s3n(n[1].encode,t,rF));return Hh(`max(ceil(sqrt(${r})+${i}),${s})`,t)}function uCe(e,t,n){return t[e]?`scale("${t[e]}",datum)`:sqe(e,n[0].encode)}function s3n(e,t,n){return sqe("fontSize",e)||STn("fontSize",t,n)}const a3n=`item.orient==="${vS}"?-90:item.orient==="${yS}"?90:0`;function o3n(e,t){e=wr(e)?{text:e}:e;const n=bl(e,t.config.title),r=e.encode||{},i=r.group||{},s=i.name||void 0,a=i.interactive,o=i.style,l=[],u={},c=tt(t.add(vf(null,[u])));return l.push(c3n(e,n,l3n(e),c)),e.subtitle&&l.push(f3n(e,n,r.subtitle,c)),yW(kD({role:rAn,from:c,encode:u3n(n,i),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:a,style:o}),t)}function l3n(e){const t=e.encode;return t&&t.title||zt({name:e.name,interactive:e.interactive,style:e.style},t)}function u3n(e,t){const n={enter:{},update:{}};return qs(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:Uce},angle:{signal:a3n},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),mS(n,t,iF)}function c3n(e,t,n,r){const i={value:0},s=e.text,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return qs(a,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Xl({type:Mx,role:iAn,style:mTn,from:r,encode:a},n)}function f3n(e,t,n,r){const i={value:0},s=e.subtitle,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return qs(a,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Xl({type:Mx,role:sAn,style:vTn,from:r,encode:a},n)}function h3n(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(jce(r,t))}),e.on&&e.on.forEach(r=>{cqe(r,t,e.name)}),t.addDataPipeline(e.name,d3n(e,t,n))}function d3n(e,t,n){const r=[];let i=null,s=!1,a=!1,o,l,u,c,f;for(e.values?Ii(e.values)||U4(e.format)?(r.push(cCe(t,e)),r.push(i=Nv())):r.push(i=Nv({$ingest:e.values,$format:e.format})):e.url?U4(e.url)||U4(e.format)?(r.push(cCe(t,e)),r.push(i=Nv())):r.push(i=Nv({$request:e.url,$format:e.format})):e.source&&(i=o=ct(e.source).map(h=>tt(t.getData(h).output)),r.push(null)),l=0,u=n.length;l<u;++l)c=n[l],f=c.metadata,!i&&!f.source&&r.push(i=Nv()),r.push(c),f.generates&&(a=!0),f.modifies&&!a&&(s=!0),f.source?i=c:f.changes&&(i=null);return o&&(u=o.length-1,r[0]=qAn({derive:s,pulse:u?o:o[0]}),(s||u)&&r.splice(1,0,Nv())),i||r.push(Nv()),r.push(Nx({})),r}function Nv(e){const t=vf({},e);return t.metadata={source:!0},t}function cCe(e,t){return LAn({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const fqe=e=>e===_m||e===yf,bW=(e,t,n)=>Ii(e)?v3n(e.signal,t,n):e===vS||e===yf?t:n,cs=(e,t,n)=>Ii(e)?g3n(e.signal,t,n):fqe(e)?t:n,Vc=(e,t,n)=>Ii(e)?m3n(e.signal,t,n):fqe(e)?n:t,hqe=(e,t,n)=>Ii(e)?y3n(e.signal,t,n):e===yf?{value:t}:{value:n},p3n=(e,t,n)=>Ii(e)?b3n(e.signal,t,n):e===yS?{value:t}:{value:n},g3n=(e,t,n)=>dqe(`${e} === '${yf}' || ${e} === '${_m}'`,t,n),m3n=(e,t,n)=>dqe(`${e} !== '${yf}' && ${e} !== '${_m}'`,t,n),v3n=(e,t,n)=>Hce(`${e} === '${vS}' || ${e} === '${yf}'`,t,n),y3n=(e,t,n)=>Hce(`${e} === '${yf}'`,t,n),b3n=(e,t,n)=>Hce(`${e} === '${yS}'`,t,n),dqe=(e,t,n)=>(t=t!=null?us(t):t,n=n!=null?us(n):n,fCe(t)&&fCe(n)?(t=t?t.signal||ot(t.value):null,n=n?n.signal||ot(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[zt({test:e},t)].concat(n||[])),fCe=e=>e==null||Object.keys(e).length===1,Hce=(e,t,n)=>({signal:`${e} ? (${B2(t)}) : (${B2(n)})`}),x3n=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${vS}' ? (${B2(r)}) : `:"")+(n!=null?`${e} === '${_m}' ? (${B2(n)}) : `:"")+(i!=null?`${e} === '${yS}' ? (${B2(i)}) : `:"")+(t!=null?`${e} === '${yf}' ? (${B2(t)}) : `:"")+"(null)"}),B2=e=>Ii(e)?e.signal:e==null?null:ot(e),w3n=(e,t)=>t===0?0:Ii(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},mw=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function y2(e,t,n,r){let i;if(t&&bt(t,e))return t[e];if(bt(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[Lce][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[rF][i]}return null}function hCe(e){const t={};for(const n of e)if(!!n)for(const r in n)t[r]=1;return Object.keys(t)}function $3n(e,t){var n=t.config,r=n.style,i=n.axis,s=t.scaleType(e.scale)==="band"&&n.axisBand,a=e.orient,o,l,u;if(Ii(a)){const f=hCe([n.axisX,n.axisY]),h=hCe([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);o={};for(u of f)o[u]=cs(a,y2(u,n.axisX,i,r),y2(u,n.axisY,i,r));l={};for(u of h)l[u]=x3n(a.signal,y2(u,n.axisTop,i,r),y2(u,n.axisBottom,i,r),y2(u,n.axisLeft,i,r),y2(u,n.axisRight,i,r))}else o=a===yf||a===_m?n.axisX:n.axisY,l=n["axis"+a[0].toUpperCase()+a.slice(1)];return o||l||s?zt({},i,o,l,s):i}function C3n(e,t,n,r){const i=bl(e,t),s=e.orient;let a,o;const l={enter:a={opacity:sn},update:o={opacity:Du},exit:{opacity:sn}};qs(l,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=dCe(e,0),c=dCe(e,1);return a.x=o.x=cs(s,u,sn),a.x2=o.x2=cs(s,c),a.y=o.y=Vc(s,u,sn),a.y2=o.y2=Vc(s,c),Xl({type:zce,role:qEn,from:r,encode:l},n)}function dCe(e,t){return{scale:e.scale,range:t}}function _3n(e,t,n,r,i){const s=bl(e,t),a=e.orient,o=e.gridScale,l=bW(a,1,-1),u=S3n(e.offset,l);let c,f,h;const d={enter:c={opacity:sn},update:h={opacity:Du},exit:f={opacity:sn}};qs(d,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const p={scale:e.scale,field:Tu,band:i.band,extra:i.extra,offset:i.offset,round:s("tickRound")},g=cs(a,{signal:"height"},{signal:"width"}),m=o?{scale:o,range:0,mult:l,offset:u}:{value:0,offset:u},v=o?{scale:o,range:1,mult:l,offset:u}:zt(g,{mult:l,offset:u});return c.x=h.x=cs(a,p,m),c.y=h.y=Vc(a,p,m),c.x2=h.x2=Vc(a,v),c.y2=h.y2=cs(a,v),f.x=cs(a,p),f.y=Vc(a,p),Xl({type:zce,role:GEn,key:Tu,from:r,encode:d},n)}function S3n(e,t){if(t!==1)if(!Ft(e))e=Ii(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=zt({},e);for(;n.mult!=null;)if(Ft(n.mult))n=n.mult=zt({},n.mult);else return n.mult=Ii(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function k3n(e,t,n,r,i,s){const a=bl(e,t),o=e.orient,l=bW(o,-1,1);let u,c,f;const h={enter:u={opacity:sn},update:f={opacity:Du},exit:c={opacity:sn}};qs(h,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const d=us(i);d.mult=l;const p={scale:e.scale,field:Tu,band:s.band,extra:s.extra,offset:s.offset,round:a("tickRound")};return f.y=u.y=cs(o,sn,p),f.y2=u.y2=cs(o,d),c.x=cs(o,p),f.x=u.x=Vc(o,sn,p),f.x2=u.x2=Vc(o,d),c.y=Vc(o,p),Xl({type:zce,role:XEn,key:Tu,from:r,encode:h},n)}function pG(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function E3n(e,t,n,r,i,s){const a=bl(e,t),o=e.orient,l=e.scale,u=bW(o,-1,1),c=my(a("labelFlush")),f=my(a("labelFlushOffset")),h=a("labelAlign"),d=a("labelBaseline");let p=c===0||!!c,g;const m=us(i);m.mult=u,m.offset=us(a("labelPadding")||0),m.offset.mult=u;const v={scale:l,field:Tu,band:.5,offset:aqe(s.offset,a("labelOffset"))},y=cs(o,p?pG(l,c,'"left"','"right"','"center"'):{value:"center"},p3n(o,"left","right")),b=cs(o,hqe(o,"bottom","top"),p?pG(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=pG(l,c,`-(${f})`,f,0);p=p&&f;const w={opacity:sn,x:cs(o,v,m),y:Vc(o,v,m)},C={enter:w,update:g={opacity:Du,text:{field:Pce},x:w.x,y:w.y,align:y,baseline:b},exit:{opacity:sn,x:w.x,y:w.y}};qs(C,{dx:!h&&p?cs(o,x):null,dy:!d&&p?Vc(o,x):null}),qs(C,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:h,baseline:d});const $=a("labelBound");let _=a("labelOverlap");return _=_||$?{separation:a("labelSeparation"),method:_,order:"datum.index",bound:$?{scale:l,orient:o,tolerance:$}:null}:void 0,g.align!==y&&(g.align=mw(g.align,y)),g.baseline!==b&&(g.baseline=mw(g.baseline,b)),Xl({type:Mx,role:YEn,style:rF,key:Tu,from:r,encode:C,overlap:_},n)}function A3n(e,t,n,r){const i=bl(e,t),s=e.orient,a=bW(s,-1,1);let o,l;const u={enter:o={opacity:sn,anchor:us(i("titleAnchor",null)),align:{signal:Uce}},update:l=zt({},o,{opacity:Du,text:us(e.title)}),exit:{opacity:sn}},c={signal:`lerp(range("${e.scale}"), ${mW(0,1,.5)})`};return l.x=cs(s,c),l.y=Vc(s,c),o.angle=cs(s,sn,w3n(a,90)),o.baseline=cs(s,hqe(s,_m,yf),{value:_m}),l.angle=o.angle,l.baseline=o.baseline,qs(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),T3n(i,s,u,n),u.update.align=mw(u.update.align,o.align),u.update.angle=mw(u.update.angle,o.angle),u.update.baseline=mw(u.update.baseline,o.baseline),Xl({type:Mx,role:KEn,style:Lce,from:r,encode:u},n)}function T3n(e,t,n,r){const i=(o,l)=>o!=null?(n.update[l]=mw(us(o),n.update[l]),!1):!k2(l,r),s=i(e("titleX"),"x"),a=i(e("titleY"),"y");n.enter.auto=a===s?us(a):cs(t,us(a),us(s))}function D3n(e,t){const n=$3n(e,t),r=e.encode||{},i=r.axis||{},s=i.name||void 0,a=i.interactive,o=i.style,l=bl(e,n),u=kTn(l),c={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:e.title!=null},f=tt(t.add(vf({},[c]))),h=tt(t.add(IAn({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),d=[];let p;return c.grid&&d.push(_3n(e,n,r.grid,h,u)),c.ticks&&(p=l("tickSize"),d.push(k3n(e,n,r.ticks,h,p,u))),c.labels&&(p=c.ticks?p:0,d.push(E3n(e,n,r.labels,h,p,u))),c.domain&&d.push(C3n(e,n,r.domain,f)),c.title&&d.push(A3n(e,n,r.title,f)),yW(kD({role:HEn,from:f,encode:mS(I3n(l,e),i,iF),marks:d,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:s,interactive:a,style:o}),t)}function I3n(e,t){const n={enter:{},update:{}};return qs(n,{orient:e("orient"),offset:e("offset")||0,position:pc(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function pqe(e,t,n){const r=ct(e.signals),i=ct(e.scales);return n||r.forEach(s=>qHe(s,t)),ct(e.projections).forEach(s=>uTn(s,t)),i.forEach(s=>ZAn(s,t)),ct(e.data).forEach(s=>h3n(s,t)),i.forEach(s=>QAn(s,t)),(n||r).forEach(s=>DAn(s,t)),ct(e.axes).forEach(s=>D3n(s,t)),ct(e.marks).forEach(s=>yW(s,t)),ct(e.legends).forEach(s=>e3n(s,t)),e.title&&o3n(e.title,t),t.parseLambdas(),t}const N3n=e=>mS({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function M3n(e,t){const n=t.config,r=tt(t.root=t.add(fB())),i=F3n(e,n);i.forEach(u=>qHe(u,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(vf()),a=t.add(XHe(HHe(N3n(e.encode),gW,Mce,e.style,t,{pulse:tt(s)}))),o=t.add(QHe({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:tt(a)}));t.operators.pop(),t.pushState(tt(a),tt(o),null),pqe(e,t,i),t.operators.push(o);let l=t.add(YHe({mark:r,pulse:tt(o)}));return l=t.add(ZHe({pulse:tt(l)})),l=t.add(Nx({pulse:tt(l)})),t.addData("root",new bb(t,s,s,l)),t}function Vk(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function F3n(e,t){const n=a=>pc(e[a],t[a]),r=[Vk("background",n("background")),Vk("autosize",WEn(n("autosize"))),Vk("padding",jEn(n("padding"))),Vk("width",n("width")||0),Vk("height",n("height")||0)],i=r.reduce((a,o)=>(a[o.name]=o,a),{}),s={};return ct(e.signals).forEach(a=>{bt(i,a.name)?a=zt(i[a.name],a):r.push(a),s[a.name]=a}),ct(t.signals).forEach(a=>{!bt(s,a.name)&&!bt(i,a.name)&&r.push(a)}),r}function gqe(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function pCe(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}gqe.prototype=pCe.prototype={parse(e){return pqe(e,this)},fork(){return new pCe(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof sJ?tt(e):e;return this.add(HAn({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,s){let a,o;r&&(a=r.data||(r.data={}),o=a[i]||(a[i]=[]),o.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(tt(this.add(Nx({pulse:e})))),this._parent.push(t),this._lookup.push(n?tt(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return ln(this._parent)},encode(){return ln(this._encode)},lookup(){return ln(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(wr(e))return _D(e,t);e.signal||$e("Unsupported field reference: "+ot(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=tt(this.add(OAn(i)))}return r},compareRef(e){let t=!1;const n=s=>Ii(s)?(t=!0,this.signalRef(s.signal)):xAn(s)?(t=!0,this.exprRef(s.expr)):s,r=ct(e.field).map(n),i=ct(e.order).map(n);return t?tt(this.add(eCe({fields:r,orders:i}))):Q$e(r,i)},keyRef(e,t){let n=!1;const r=s=>Ii(s)?(n=!0,tt(i[s.signal])):s,i=this.signals;return e=ct(e).map(r),n?tt(this.add(RAn({fields:e,flat:t}))):mAn(e,t)},sortRef(e){if(!e)return e;const t=dW(e.op,e.field),n=e.order||vAn;return n.signal?tt(this.add(eCe({fields:t,orders:this.signalRef(n.signal)}))):Q$e(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return bt(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&$e("Duplicate signal name: "+ot(e));const n=t instanceof sJ?t:this.add(fB(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||$e("Unrecognized signal name: "+ot(e)),this.signals[e]},signalRef(e){return this.signals[e]?tt(this.signals[e]):(bt(this.lambdas,e)||(this.lambdas[e]=this.add(fB(null))),tt(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=Hh(r,this),s=this.lambdas[r];s.params=i.$params,s.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Ft(e)?e:this.signalRef(e.signal||qce(e))},exprRef(e,t){const n={expr:Hh(e,this)};return t&&(n.expr.$name=t),tt(this.add(MAn(n)))},addBinding(e,t){this.bindings||$e("Nested signals do not support binding: "+ot(e)),this.bindings.push(zt({signal:e},t))},addScaleProj(e,t){bt(this.scales,e)&&$e("Duplicate scale or projection name: "+ot(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,GAn(t))},addProjection(e,t){this.addScaleProj(e,jAn(t))},getScale(e){return this.scales[e]||$e("Unrecognized scale name: "+ot(e)),this.scales[e]},scaleRef(e){return tt(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return bt(this.data,e)&&$e("Duplicate data set name: "+ot(e)),this.data[e]=t},getData(e){return this.data[e]||$e("Undefined data set name: "+ot(e)),this.data[e]},addDataPipeline(e,t){return bt(this.data,e)&&$e("Duplicate data set name: "+ot(e)),this.addData(e,bb.fromEntries(this,t))}};function qce(e){return(at(e)?O3n:R3n)(e)}function O3n(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(Ft(i)?i.signal||qce(i):ot(i))}return n+"]"}function R3n(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+ot(r)+":"+(Ft(i)?i.signal||qce(i):ot(i));return t+"}"}function P3n(){const e="sans-serif",r="#4c78a8",i="#000",s="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:a}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function L3n(e,t,n){return Ft(e)||$e("Input Vega specification must be an object."),t=D6t(P3n(),t,e.config),M3n(e,new gqe(t,n)).toRuntime()}function bS(e,t,n){return e.fields=t||[],e.fname=n,e}function B3n(e){return e.length===1?z3n(e[0]):U3n(e)}const z3n=e=>function(t){return t[e]},U3n=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Oc(e){throw Error(e)}function W3n(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||Oc("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&Oc("Access path missing closing bracket: "+e),r&&Oc("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function V3n(e,t,n){const r=W3n(e);return e=r.length===1?r[0]:e,bS((n&&n.get||B3n)(r),[e],t||e)}V3n("id");bS(e=>e,[],"identity");bS(()=>0,[],"zero");bS(()=>1,[],"one");bS(()=>!0,[],"true");bS(()=>!1,[],"false");function gCe(e){return typeof e=="function"}const j3n=Object.prototype.hasOwnProperty;function ER(e,t){return j3n.call(e,t)}function H3n(e){return typeof e=="string"}function mCe(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}const q3n="RawCode",G3n="Literal",Y3n="Property",X3n="Identifier",K3n="ArrayExpression",Z3n="BinaryExpression",Q3n="CallExpression",J3n="ConditionalExpression",eDn="LogicalExpression",tDn="MemberExpression",nDn="ObjectExpression",rDn="UnaryExpression";function bf(e){this.type=e}bf.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=iDn(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function iDn(e){switch(e.type){case K3n:return e.elements;case Z3n:case eDn:return[e.left,e.right];case Q3n:return[e.callee].concat(e.arguments);case J3n:return[e.test,e.consequent,e.alternate];case tDn:return[e.object,e.property];case nDn:return e.properties;case Y3n:return[e.key,e.value];case rDn:return[e.argument];case X3n:case G3n:case q3n:default:return[]}}var vd,Xe,xe,_a,Un,xW=1,sF=2,xb=3,uv=4,wW=5,Fx=6,Ro=7,aF=8,sDn=9;vd={};vd[xW]="Boolean";vd[sF]="<end>";vd[xb]="Identifier";vd[uv]="Keyword";vd[wW]="Null";vd[Fx]="Numeric";vd[Ro]="Punctuator";vd[aF]="String";vd[sDn]="RegularExpression";var aDn="ArrayExpression",oDn="BinaryExpression",lDn="CallExpression",uDn="ConditionalExpression",mqe="Identifier",cDn="Literal",fDn="LogicalExpression",hDn="MemberExpression",dDn="ObjectExpression",pDn="Property",gDn="UnaryExpression",fs="Unexpected token %0",mDn="Unexpected number",vDn="Unexpected string",yDn="Unexpected identifier",bDn="Unexpected reserved word",xDn="Unexpected end of input",hJ="Invalid regular expression",gG="Invalid regular expression: missing /",vqe="Octal literals are not allowed in strict mode.",wDn="Duplicate data property in object literal not allowed in strict mode",Ps="ILLEGAL",ED="Disabled.",$Dn=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),CDn=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function $W(e,t){if(!e)throw new Error("ASSERT: "+t)}function jd(e){return e>=48&&e<=57}function Gce(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function RA(e){return"01234567".indexOf(e)>=0}function _Dn(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function AD(e){return e===10||e===13||e===8232||e===8233}function oF(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&$Dn.test(String.fromCharCode(e))}function hB(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&CDn.test(String.fromCharCode(e))}const SDn={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function yqe(){for(;xe<_a;){const e=Xe.charCodeAt(xe);if(_Dn(e)||AD(e))++xe;else break}}function dJ(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)xe<_a&&Gce(Xe[xe])?(r=Xe[xe++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):bn({},fs,Ps);return String.fromCharCode(i)}function kDn(){var e,t,n,r;for(e=Xe[xe],t=0,e==="}"&&bn({},fs,Ps);xe<_a&&(e=Xe[xe++],!!Gce(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&bn({},fs,Ps),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function bqe(){var e,t;for(e=Xe.charCodeAt(xe++),t=String.fromCharCode(e),e===92&&(Xe.charCodeAt(xe)!==117&&bn({},fs,Ps),++xe,e=dJ("u"),(!e||e==="\\"||!oF(e.charCodeAt(0)))&&bn({},fs,Ps),t=e);xe<_a&&(e=Xe.charCodeAt(xe),!!hB(e));)++xe,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Xe.charCodeAt(xe)!==117&&bn({},fs,Ps),++xe,e=dJ("u"),(!e||e==="\\"||!hB(e.charCodeAt(0)))&&bn({},fs,Ps),t+=e);return t}function EDn(){var e,t;for(e=xe++;xe<_a;){if(t=Xe.charCodeAt(xe),t===92)return xe=e,bqe();if(hB(t))++xe;else break}return Xe.slice(e,xe)}function ADn(){var e,t,n;return e=xe,t=Xe.charCodeAt(xe)===92?bqe():EDn(),t.length===1?n=xb:SDn.hasOwnProperty(t)?n=uv:t==="null"?n=wW:t==="true"||t==="false"?n=xW:n=xb,{type:n,value:t,start:e,end:xe}}function mG(){var e=xe,t=Xe.charCodeAt(xe),n,r=Xe[xe],i,s,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++xe,{type:Ro,value:String.fromCharCode(t),start:e,end:xe};default:if(n=Xe.charCodeAt(xe+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return xe+=2,{type:Ro,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:xe};case 33:case 61:return xe+=2,Xe.charCodeAt(xe)===61&&++xe,{type:Ro,value:Xe.slice(e,xe),start:e,end:xe}}}if(a=Xe.substr(xe,4),a===">>>=")return xe+=4,{type:Ro,value:a,start:e,end:xe};if(s=a.substr(0,3),s===">>>"||s==="<<="||s===">>=")return xe+=3,{type:Ro,value:s,start:e,end:xe};if(i=s.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return xe+=2,{type:Ro,value:i,start:e,end:xe};if(i==="//"&&bn({},fs,Ps),"<>=!+-*%&|^/".indexOf(r)>=0)return++xe,{type:Ro,value:r,start:e,end:xe};bn({},fs,Ps)}function TDn(e){let t="";for(;xe<_a&&Gce(Xe[xe]);)t+=Xe[xe++];return t.length===0&&bn({},fs,Ps),oF(Xe.charCodeAt(xe))&&bn({},fs,Ps),{type:Fx,value:parseInt("0x"+t,16),start:e,end:xe}}function DDn(e){let t="0"+Xe[xe++];for(;xe<_a&&RA(Xe[xe]);)t+=Xe[xe++];return(oF(Xe.charCodeAt(xe))||jd(Xe.charCodeAt(xe)))&&bn({},fs,Ps),{type:Fx,value:parseInt(t,8),octal:!0,start:e,end:xe}}function vCe(){var e,t,n;if(n=Xe[xe],$W(jd(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=xe,e="",n!=="."){if(e=Xe[xe++],n=Xe[xe],e==="0"){if(n==="x"||n==="X")return++xe,TDn(t);if(RA(n))return DDn(t);n&&jd(n.charCodeAt(0))&&bn({},fs,Ps)}for(;jd(Xe.charCodeAt(xe));)e+=Xe[xe++];n=Xe[xe]}if(n==="."){for(e+=Xe[xe++];jd(Xe.charCodeAt(xe));)e+=Xe[xe++];n=Xe[xe]}if(n==="e"||n==="E")if(e+=Xe[xe++],n=Xe[xe],(n==="+"||n==="-")&&(e+=Xe[xe++]),jd(Xe.charCodeAt(xe)))for(;jd(Xe.charCodeAt(xe));)e+=Xe[xe++];else bn({},fs,Ps);return oF(Xe.charCodeAt(xe))&&bn({},fs,Ps),{type:Fx,value:parseFloat(e),start:t,end:xe}}function IDn(){var e="",t,n,r,i,s=!1;for(t=Xe[xe],$W(t==="'"||t==='"',"String literal must starts with a quote"),n=xe,++xe;xe<_a;)if(r=Xe[xe++],r===t){t="";break}else if(r==="\\")if(r=Xe[xe++],!r||!AD(r.charCodeAt(0)))switch(r){case"u":case"x":Xe[xe]==="{"?(++xe,e+=kDn()):e+=dJ(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:RA(r)?(i="01234567".indexOf(r),i!==0&&(s=!0),xe<_a&&RA(Xe[xe])&&(s=!0,i=i*8+"01234567".indexOf(Xe[xe++]),"0123".indexOf(r)>=0&&xe<_a&&RA(Xe[xe])&&(i=i*8+"01234567".indexOf(Xe[xe++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&Xe[xe]===`
`&&++xe;else{if(AD(r.charCodeAt(0)))break;e+=r}return t!==""&&bn({},fs,Ps),{type:aF,value:e,octal:s,start:n,end:xe}}function NDn(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";bn({},hJ)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{bn({},hJ)}try{return new RegExp(e,t)}catch{return null}}function MDn(){var e,t,n,r,i;for(e=Xe[xe],$W(e==="/","Regular expression literal must start with a slash"),t=Xe[xe++],n=!1,r=!1;xe<_a;)if(e=Xe[xe++],t+=e,e==="\\")e=Xe[xe++],AD(e.charCodeAt(0))&&bn({},gG),t+=e;else if(AD(e.charCodeAt(0)))bn({},gG);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||bn({},gG),i=t.substr(1,t.length-2),{value:i,literal:t}}function FDn(){var e,t,n;for(t="",n="";xe<_a&&(e=Xe[xe],!!hB(e.charCodeAt(0)));)++xe,e==="\\"&&xe<_a?bn({},fs,Ps):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&bn({},hJ,n),{value:n,literal:t}}function ODn(){var e,t,n,r;return Un=null,yqe(),e=xe,t=MDn(),n=FDn(),r=NDn(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:xe}}function RDn(e){return e.type===xb||e.type===uv||e.type===xW||e.type===wW}function xqe(){if(yqe(),xe>=_a)return{type:sF,start:xe,end:xe};const e=Xe.charCodeAt(xe);return oF(e)?ADn():e===40||e===41||e===59?mG():e===39||e===34?IDn():e===46?jd(Xe.charCodeAt(xe+1))?vCe():mG():jd(e)?vCe():mG()}function jo(){const e=Un;return xe=e.end,Un=xqe(),xe=e.end,e}function wqe(){const e=xe;Un=xqe(),xe=e}function PDn(e){const t=new bf(aDn);return t.elements=e,t}function yCe(e,t,n){const r=new bf(e==="||"||e==="&&"?fDn:oDn);return r.operator=e,r.left=t,r.right=n,r}function LDn(e,t){const n=new bf(lDn);return n.callee=e,n.arguments=t,n}function BDn(e,t,n){const r=new bf(uDn);return r.test=e,r.consequent=t,r.alternate=n,r}function Yce(e){const t=new bf(mqe);return t.name=e,t}function YE(e){const t=new bf(cDn);return t.value=e.value,t.raw=Xe.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function bCe(e,t,n){const r=new bf(hDn);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function zDn(e){const t=new bf(dDn);return t.properties=e,t}function xCe(e,t,n){const r=new bf(pDn);return r.key=t,r.value=n,r.kind=e,r}function UDn(e,t){const n=new bf(gDn);return n.operator=e,n.argument=t,n.prefix=!0,n}function bn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(s,a)=>($W(a<r.length,"Message reference must be in range"),r[a]));throw n=new Error(i),n.index=xe,n.description=i,n}function CW(e){e.type===sF&&bn(e,xDn),e.type===Fx&&bn(e,mDn),e.type===aF&&bn(e,vDn),e.type===xb&&bn(e,yDn),e.type===uv&&bn(e,bDn),bn(e,fs,e.value)}function Sa(e){const t=jo();(t.type!==Ro||t.value!==e)&&CW(t)}function gr(e){return Un.type===Ro&&Un.value===e}function vG(e){return Un.type===uv&&Un.value===e}function WDn(){const e=[];for(xe=Un.start,Sa("[");!gr("]");)gr(",")?(jo(),e.push(null)):(e.push(wb()),gr("]")||Sa(","));return jo(),PDn(e)}function wCe(){xe=Un.start;const e=jo();return e.type===aF||e.type===Fx?(e.octal&&bn(e,vqe),YE(e)):Yce(e.value)}function VDn(){var e,t,n,r;if(xe=Un.start,e=Un,e.type===xb)return n=wCe(),Sa(":"),r=wb(),xCe("init",n,r);if(e.type===sF||e.type===Ro)CW(e);else return t=wCe(),Sa(":"),r=wb(),xCe("init",t,r)}function jDn(){var e=[],t,n,r,i={},s=String;for(xe=Un.start,Sa("{");!gr("}");)t=VDn(),t.key.type===mqe?n=t.key.name:n=s(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?bn({},wDn):i[r]=!0,e.push(t),gr("}")||Sa(",");return Sa("}"),zDn(e)}function HDn(){Sa("(");const e=Xce();return Sa(")"),e}const qDn={if:1};function GDn(){var e,t,n;if(gr("("))return HDn();if(gr("["))return WDn();if(gr("{"))return jDn();if(e=Un.type,xe=Un.start,e===xb||qDn[Un.value])n=Yce(jo().value);else if(e===aF||e===Fx)Un.octal&&bn(Un,vqe),n=YE(jo());else{if(e===uv)throw new Error(ED);e===xW?(t=jo(),t.value=t.value==="true",n=YE(t)):e===wW?(t=jo(),t.value=null,n=YE(t)):gr("/")||gr("/=")?(n=YE(ODn()),wqe()):CW(jo())}return n}function YDn(){const e=[];if(Sa("("),!gr(")"))for(;xe<_a&&(e.push(wb()),!gr(")"));)Sa(",");return Sa(")"),e}function XDn(){xe=Un.start;const e=jo();return RDn(e)||CW(e),Yce(e.value)}function KDn(){return Sa("."),XDn()}function ZDn(){Sa("[");const e=Xce();return Sa("]"),e}function QDn(){var e,t,n;for(e=GDn();;)if(gr("."))n=KDn(),e=bCe(".",e,n);else if(gr("("))t=YDn(),e=LDn(e,t);else if(gr("["))n=ZDn(),e=bCe("[",e,n);else break;return e}function $Ce(){const e=QDn();if(Un.type===Ro&&(gr("++")||gr("--")))throw new Error(ED);return e}function H4(){var e,t;if(Un.type!==Ro&&Un.type!==uv)t=$Ce();else{if(gr("++")||gr("--"))throw new Error(ED);if(gr("+")||gr("-")||gr("~")||gr("!"))e=jo(),t=H4(),t=UDn(e.value,t);else{if(vG("delete")||vG("void")||vG("typeof"))throw new Error(ED);t=$Ce()}}return t}function CCe(e){let t=0;if(e.type!==Ro&&e.type!==uv)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function JDn(){var e,t,n,r,i,s,a,o,l,u;if(e=Un,l=H4(),r=Un,i=CCe(r),i===0)return l;for(r.prec=i,jo(),t=[e,Un],a=H4(),s=[l,r,a];(i=CCe(Un))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)a=s.pop(),o=s.pop().value,l=s.pop(),t.pop(),n=yCe(o,l,a),s.push(n);r=jo(),r.prec=i,s.push(r),t.push(Un),n=H4(),s.push(n)}for(u=s.length-1,n=s[u],t.pop();u>1;)t.pop(),n=yCe(s[u-1].value,s[u-2],n),u-=2;return n}function wb(){var e,t,n;return e=JDn(),gr("?")&&(jo(),t=wb(),Sa(":"),n=wb(),e=BDn(e,t,n)),e}function Xce(){const e=wb();if(gr(","))throw new Error(ED);return e}function eIn(e){Xe=e,xe=0,_a=Xe.length,Un=null,wqe();const t=Xce();if(Un.type!==sF)throw new Error("Unexpect token after expression.");return t}var tIn={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function nIn(e){function t(a,o,l,u){let c=e(o[0]);return l&&(c=l+"("+c+")",l.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(u<0?"":u===0?"()":"("+o.slice(1).map(e).join(",")+")")}function n(a,o,l){return u=>t(a,u,o,l)}const r="new Date",i="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&Oc("Missing arguments to clamp function."),a.length>3&&Oc("Too many arguments to clamp function.");const o=a.map(e);return"Math.max("+o[1]+", Math.min("+o[2]+","+o[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:s,test:n("test",s),if:function(a){a.length<3&&Oc("Missing arguments to if function."),a.length>3&&Oc("Too many arguments to if function.");const o=a.map(e);return"("+o[0]+"?"+o[1]+":"+o[2]+")"}}}function rIn(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function iIn(e){e=e||{};const t=e.allowed?mCe(e.allowed):{},n=e.forbidden?mCe(e.forbidden):{},r=e.constants||tIn,i=(e.functions||nIn)(f),s=e.globalvar,a=e.fieldvar,o=gCe(s)?s:p=>"".concat(s,'["').concat(p,'"]');let l={},u={},c=0;function f(p){if(H3n(p))return p;const g=h[p.type];return g==null&&Oc("Unsupported type: "+p.type),g(p)}const h={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:ER(n,g)?Oc("Illegal identifier: "+g):ER(r,g)?r[g]:ER(t,g)?g:(l[g]=1,o(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const v=f(p.property);return m===a&&(u[rIn(v)]=1),g&&(c-=1),m+(g?"."+v:"["+v+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&Oc("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,v=ER(i,g)&&i[g];return v||Oc("Unrecognized function: "+g),gCe(v)?v(m):v+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function d(p){const g={code:f(p),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},g}return d.functions=i,d.constants=r,d}const sIn="view",dB="[",pB="]",$qe="{",Cqe="}",aIn=":",_qe=",",oIn="@",lIn=">",uIn=/[[\]{}]/,cIn={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Sqe,kqe;function Ox(e,t,n){return Sqe=t||sIn,kqe=n||cIn,Eqe(e.trim()).map(pJ)}function fIn(e){return kqe[e]}function PA(e,t,n,r,i){const s=e.length;let a=0,o;for(;t<s;++t){if(o=e[t],!a&&o===n)return t;i&&i.indexOf(o)>=0?--a:r&&r.indexOf(o)>=0&&++a}return t}function Eqe(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=PA(e,i,_qe,dB+$qe,pB+Cqe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function pJ(e){return e[0]==="["?hIn(e):dIn(e)}function hIn(e){const t=e.length;let n=1,r;if(n=PA(e,n,pB,dB,pB),n===t)throw"Empty between selector: "+e;if(r=Eqe(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==lIn)throw"Expected '>' after between selector: "+e;r=r.map(pJ);const i=pJ(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function dIn(e){const t={source:Sqe},n=[];let r=[0,0],i=0,s=0,a=e.length,o=0,l,u;if(e[a-1]===Cqe){if(o=e.lastIndexOf($qe),o>=0){try{r=pIn(e.substring(o+1,a-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,o).trim(),a=e.length}else throw"Unmatched right brace: "+e;o=0}if(!a)throw e;if(e[0]===oIn&&(i=++o),l=PA(e,o,aIn),l<a&&(n.push(e.substring(s,l).trim()),s=o=++l),o=PA(e,o,dB),o===a)n.push(e.substring(s,a).trim());else if(n.push(e.substring(s,o).trim()),u=[],s=++o,s===a)throw"Unmatched left bracket: "+e;for(;o<a;){if(o=PA(e,o,pB),o===a)throw"Unmatched left bracket: "+e;if(u.push(e.substring(s,o).trim()),o<a-1&&e[++o]!==dB)throw"Expected left bracket: "+e;s=++o}if(!(a=n.length)||uIn.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],i?t.markname=n[0].slice(1):fIn(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),u!=null&&(t.filter=u),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function pIn(e){const t=e.split(_qe);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}var gIn="vega",mIn="5.20.0",vIn="The Vega visualization grammar.",yIn=["vega","visualization","interaction","dataflow","library","data","d3"],bIn="BSD-3-Clause",xIn="UW Interactive Data Lab (http://idl.cs.washington.edu)",wIn="build/vega-node.js",$In="build/vega.module.js",CIn="build/vega.min.js",_In="build/vega.min.js",SIn="index.d.ts",kIn="vega/vega",EIn={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},AIn={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.3","vega-encode":"~4.8.3","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.0","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.0.0","vega-loader":"~4.4.0","vega-parser":"~6.1.3","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.9","vega-time":"~2.0.4","vega-transforms":"~4.9.3","vega-typings":"~0.20.0","vega-util":"~1.16.1","vega-view":"~5.10.0","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},TIn={"vega-schema":"*"},DIn="f262105e75449760b0f35fda70e6b576a31d68a4",IIn={name:gIn,version:mIn,description:vIn,keywords:yIn,license:bIn,author:xIn,main:wIn,module:$In,unpkg:CIn,jsdelivr:_In,types:SIn,repository:kIn,scripts:EIn,dependencies:AIn,devDependencies:TIn,gitHead:DIn};_re(Zw,aUt,YYt,uKt,xJt,pen,Wtn,vtn,jtn,onn,vnn,_nn);const NIn=IIn.version,MIn=Object.freeze(Object.defineProperty({__proto__:null,version:NIn,Dataflow:Q2,EventStream:e9,MultiPulse:Ure,Operator:Jn,Parameters:J7,Pulse:m0,Transform:me,changeset:sx,definition:nRe,ingest:Tn,isTuple:P_,transform:rRe,transforms:Zw,tupleid:nt,interpolate:gUe,interpolateColors:pUe,interpolateRange:Ngn,quantizeInterpolator:Mgn,scale:rr,scheme:yUe,projection:xUe,View:TWe,defaultLocale:jWe,formatLocale:F6,locale:qyn,resetDefaultLocale:Gyn,timeFormatLocale:O6,expressionFunction:wi,parse:L3n,runtimeContext:mWe,codegenExpression:iIn,parseExpression:eIn,parseSelector:Ox,Debug:MFe,Error:DFe,Info:NFe,None:TFe,Warn:IFe,accessor:og,accessorFields:EFe,accessorName:SLt,array:NT,ascending:Cre,clampRange:HLt,compare:GLt,constant:ZLt,debounce:QLt,error:n4,extend:_re,extent:JLt,extentIndex:e6t,falsy:NLt,fastmap:n6t,field:bre,flush:r6t,hasOwnProperty:o1,id:ALt,identity:xre,inherits:i6t,inrange:s6t,isArray:U7,isBoolean:LFe,isDate:BFe,isFunction:H7,isIterable:a6t,isNumber:zFe,isObject:K5,isRegExp:o6t,isString:MT,key:l6t,lerp:u6t,logger:MLt,lruCache:f6t,merge:h6t,mergeConfig:wre,one:DLt,pad:d6t,panLinear:OLt,panLog:RLt,panPow:PLt,panSymlog:LLt,peek:R_,quarter:VLt,repeat:aE,span:p6t,splitAccessPath:yre,stringValue:UFe,toBoolean:g6t,toDate:v6t,toNumber:$re,toSet:b6t,toString:y6t,truncate:x6t,truthy:ILt,utcquarter:jLt,visitArray:w6t,writeConfig:W7,zero:TLt,zoomLinear:BLt,zoomLog:zLt,zoomPow:ULt,zoomSymlog:WLt,bandwidthNRD:XBe,bin:Snn,bootstrapCI:Enn,cumulativeLogNormal:t8e,cumulativeNormal:Pae,cumulativeUniform:s8e,densityLogNormal:e8e,densityNormal:ZBe,densityUniform:i8e,dotbin:Ann,quantileLogNormal:n8e,quantileNormal:Lae,quantileUniform:a8e,quantiles:GBe,quartiles:YBe,get random(){return jp},randomInteger:Inn,randomKDE:Fnn,randomLCG:Dnn,randomLogNormal:Onn,randomMixture:Rnn,randomNormal:QBe,randomUniform:Pnn,regressionExp:Bnn,regressionLinear:o8e,regressionLoess:jnn,regressionLog:Lnn,regressionPoly:Unn,regressionPow:znn,regressionQuad:l8e,sampleCurve:Xnn,sampleLogNormal:JBe,sampleNormal:Rae,sampleUniform:r8e,setRandom:knn,DATE:Uu,DAY:no,DAYOFYEAR:Bh,HOURS:nf,MILLISECONDS:Uh,MINUTES:rf,MONTH:el,QUARTER:zu,SECONDS:zh,TIME_UNITS:x8e,WEEK:Os,YEAR:uo,dayofyear:Ern,timeBin:Xrn,timeFloor:Rrn,timeInterval:Yae,timeOffset:Wrn,timeSequence:jrn,timeUnitSpecifier:krn,timeUnits:w8e,utcFloor:Brn,utcInterval:Xae,utcOffset:Vrn,utcSequence:Hrn,utcdayofyear:Drn,utcweek:Irn,week:Arn,format:x4,formats:ooe,inferType:eze,inferTypes:tze,loader:gan,read:dan,responseType:han,typeParsers:IZ,Bounds:fl,CanvasHandler:fle,CanvasRenderer:f6,Gradient:Wcn,GroupItem:Goe,Handler:dm,Item:qoe,Marks:af,RenderType:cdn,Renderer:hd,ResourceLoader:Yoe,SVGHandler:hle,SVGRenderer:yle,SVGStringRenderer:ble,Scenegraph:i9e,boundClip:pdn,boundContext:NM,boundItem:JZ,boundMark:e9e,boundStroke:bx,domChild:Wo,domClear:Ac,domCreate:r0,domFind:ule,font:mU,fontFamily:OM,fontSize:fd,intersect:hdn,intersectBoxLine:L2,intersectPath:Xoe,intersectPoint:Koe,intersectRule:V7e,lineHeight:fm,markup:vle,multiLineOffset:$hn,pathCurves:Voe,pathEqual:T9e,pathParse:B3,pathRectangle:L7e,pathRender:r6,pathSymbols:P7e,pathTrail:B7e,point:cle,renderModule:fdn,resetSVGClipId:U7e,resetSVGDefIds:vdn,sceneEqual:xle,sceneFromJSON:n9e,scenePickVisit:s6,sceneToJSON:t9e,sceneVisit:sf,sceneZOrder:Zoe,serializeXML:y9e,textMetrics:cw},Symbol.toStringTag,{value:"Module"})),FIn="vega-lite",OIn='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',RIn="4.13.1",PIn=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],LIn="https://vega.github.io/vega-lite/",BIn="Vega-Lite is a concise high-level language for interactive visualization.",zIn="build/vega-lite.js",UIn="build/vega-lite.min.js",WIn="build/vega-lite.min.js",VIn="build/src/index",jIn="build/src/index.d.ts",HIn={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},qIn={test:"test"},GIn={changelog:"conventional-changelog -p angular -r 2",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"},YIn={type:"git",url:"https://github.com/vega/vega-lite.git"},XIn="BSD-3-Clause",KIn={url:"https://github.com/vega/vega-lite/issues"},ZIn={"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2",ajv:"^6.12.2",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.7.0",concurrently:"^5.2.0","conventional-changelog-cli":"^2.0.34",d3:"^5.16.0",eslint:"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3",jest:"^26.0.1","jest-puppeteer":"^4.4.0",mkdirp:"^1.0.4",prettier:"^2.0.5",puppeteer:"^3.1.0",rollup:"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7",terser:"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1",typescript:"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},QIn={"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0",yargs:"~15.3.1"},JIn={vega:"^5.12.1"},eNn={preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1},tNn={name:FIn,author:OIn,version:RIn,collaborators:PIn,homepage:LIn,description:BIn,main:zIn,unpkg:UIn,jsdelivr:WIn,module:VIn,types:jIn,bin:HIn,directories:qIn,scripts:GIn,repository:YIn,license:XIn,bugs:KIn,devDependencies:ZIn,dependencies:QIn,peerDependencies:JIn,jest:eNn};function xS(e,t,n){return e.fields=t||[],e.fname=n,e}function nNn(e){return e.length===1?rNn(e[0]):iNn(e)}const rNn=e=>function(t){return t[e]},iNn=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function yG(e){throw Error(e)}function Rx(e){var t=[],n=null,r=0,i=e.length,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<i;++o)if(l=e[o],l==="\\")s+=e.substring(a,o),s+=e.substring(++o,++o),a=o;else if(l===n)u(),n=null,r=-1;else{if(n)continue;a===r&&l==='"'||a===r&&l==="'"?(a=o+1,n=l):l==="."&&!r?o>a?u():a=o+1:l==="["?(o>a&&u(),r=a=o+1):l==="]"&&(r||yG("Access path missing open bracket: "+e),r>0&&u(),r=0,a=o+1)}return r&&yG("Access path missing closing bracket: "+e),n&&yG("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function sNn(e,t,n){const r=Rx(e);return e=r.length===1?r[0]:e,xS((n&&n.get||nNn)(r),[e],t||e)}var lF=[];sNn("id");var aNn=xS(function(e){return e},lF,"identity");xS(function(){return 0},lF,"zero");xS(function(){return 1},lF,"one");xS(function(){return!0},lF,"true");xS(function(){return!1},lF,"false");function AR(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var oNn=0,lNn=1,Aqe=2,uNn=3,cNn=4;function fNn(e,t){var n=e||oNn;return{level:function(r){return arguments.length?(n=+r,this):n},error:function(){return n>=lNn&&AR(t||"error","ERROR",arguments),this},warn:function(){return n>=Aqe&&AR(t||"warn","WARN",arguments),this},info:function(){return n>=uNn&&AR(t||"log","INFO",arguments),this},debug:function(){return n>=cNn&&AR(t||"log","DEBUG",arguments),this}}}const ut=Array.isArray;function ds(e){return e===Object(e)}const _Ce=e=>e!=="__proto__";function Tqe(...e){return e.reduce((t,n)=>{for(var r in n)if(r==="signals")t.signals=hNn(t.signals,n.signals);else{var i=r==="legend"?{layout:1}:r==="style"?!0:null;Kce(t,r,n[r],i)}return t},{})}function Kce(e,t,n,r){if(!!_Ce(t)){var i,s;if(ds(n)&&!ut(n)){s=ds(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?Kce(s,i,n[i]):_Ce(i)&&(s[i]=n[i])}else e[t]=n}}function hNn(e,t){if(e==null)return t;const n={},r=[];function i(s){n[s.name]||(n[s.name]=1,r.push(s))}return t.forEach(i),e.forEach(i),r}function ci(e){return e!=null?ut(e)?e:[e]:[]}function dNn(e){return typeof e=="function"}const pNn=Object.prototype.hasOwnProperty;function H1(e,t){return pNn.call(e,t)}function uF(e){return typeof e=="boolean"}function yi(e){return typeof e=="number"}function qt(e){return typeof e=="string"}function an(e){return ut(e)?"["+e.map(an)+"]":ds(e)||qt(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Px(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function it(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var Dqe={exports:{}};(function(e){var t=function(){function n(h,d){return d!=null&&h instanceof d}var r;try{r=Map}catch{r=function(){}}var i;try{i=Set}catch{i=function(){}}var s;try{s=Promise}catch{s=function(){}}function a(h,d,p,g,m){typeof d=="object"&&(p=d.depth,g=d.prototype,m=d.includeNonEnumerable,d=d.circular);var v=[],y=[],b=typeof Buffer<"u";typeof d>"u"&&(d=!0),typeof p>"u"&&(p=1/0);function x(w,C){if(w===null)return null;if(C===0)return w;var $,_;if(typeof w!="object")return w;if(n(w,r))$=new r;else if(n(w,i))$=new i;else if(n(w,s))$=new s(function(F,R){w.then(function(P){F(x(P,C-1))},function(P){R(x(P,C-1))})});else if(a.__isArray(w))$=[];else if(a.__isRegExp(w))$=new RegExp(w.source,f(w)),w.lastIndex&&($.lastIndex=w.lastIndex);else if(a.__isDate(w))$=new Date(w.getTime());else{if(b&&Buffer.isBuffer(w))return Buffer.allocUnsafe?$=Buffer.allocUnsafe(w.length):$=new Buffer(w.length),w.copy($),$;n(w,Error)?$=Object.create(w):typeof g>"u"?(_=Object.getPrototypeOf(w),$=Object.create(_)):($=Object.create(g),_=g)}if(d){var k=v.indexOf(w);if(k!=-1)return y[k];v.push(w),y.push($)}n(w,r)&&w.forEach(function(F,R){var P=x(R,C-1),V=x(F,C-1);$.set(P,V)}),n(w,i)&&w.forEach(function(F){var R=x(F,C-1);$.add(R)});for(var E in w){var S;_&&(S=Object.getOwnPropertyDescriptor(_,E)),!(S&&S.set==null)&&($[E]=x(w[E],C-1))}if(Object.getOwnPropertySymbols)for(var I=Object.getOwnPropertySymbols(w),E=0;E<I.length;E++){var A=I[E],D=Object.getOwnPropertyDescriptor(w,A);D&&!D.enumerable&&!m||($[A]=x(w[A],C-1),D.enumerable||Object.defineProperty($,A,{enumerable:!1}))}if(m)for(var T=Object.getOwnPropertyNames(w),E=0;E<T.length;E++){var N=T[E],D=Object.getOwnPropertyDescriptor(w,N);D&&D.enumerable||($[N]=x(w[N],C-1),Object.defineProperty($,N,{enumerable:!1}))}return $}return x(h,p)}a.clonePrototype=function(d){if(d===null)return null;var p=function(){};return p.prototype=d,new p};function o(h){return Object.prototype.toString.call(h)}a.__objToStr=o;function l(h){return typeof h=="object"&&o(h)==="[object Date]"}a.__isDate=l;function u(h){return typeof h=="object"&&o(h)==="[object Array]"}a.__isArray=u;function c(h){return typeof h=="object"&&o(h)==="[object RegExp]"}a.__isRegExp=c;function f(h){var d="";return h.global&&(d+="g"),h.ignoreCase&&(d+="i"),h.multiline&&(d+="m"),d}return a.__getRegExpFlags=f,a}();e.exports&&(e.exports=t)})(Dqe);const gNn=Dqe.exports;var mNn=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(s=Object.keys(t),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var a=s[i];if(!e(t[a],n[a]))return!1}return!0}return t!==t&&n!==n},TD=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(s){return function(a){return function(o,l){var u={key:o,value:a[o]},c={key:l,value:a[l]};return s(u,c)}}}(t.cmp),i=[];return function s(a){if(a&&a.toJSON&&typeof a.toJSON=="function"&&(a=a.toJSON()),a!==void 0){if(typeof a=="number")return isFinite(a)?""+a:"null";if(typeof a!="object")return JSON.stringify(a);var o,l;if(Array.isArray(a)){for(l="[",o=0;o<a.length;o++)o&&(l+=","),l+=s(a[o])||"null";return l+"]"}if(a===null)return"null";if(i.indexOf(a)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=i.push(a)-1,c=Object.keys(a).sort(r&&r(a));for(l="",o=0;o<c.length;o++){var f=c[o],h=s(a[f]);!h||(l&&(l+=","),l+=JSON.stringify(f)+":"+h)}return i.splice(u,1),"{"+l+"}"}}(e)};function Zce(e){return!!e.or}function Qce(e){return!!e.and}function Jce(e){return!!e.not}function q4(e,t){if(Jce(e))q4(e.not,t);else if(Qce(e))for(const n of e.and)q4(n,t);else if(Zce(e))for(const n of e.or)q4(n,t);else t(e)}function G4(e,t){return Jce(e)?{not:G4(e.not,t)}:Qce(e)?{and:e.and.map(n=>G4(n,t))}:Zce(e)?{or:e.or.map(n=>G4(n,t))}:t(e)}const cF=mNn,Gt=gNn;function DD(e,t){const n={};for(const r of t)H1(e,r)&&(n[r]=e[r]);return n}function $p(e,t){const n=Object.assign({},e);for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>TD(e)).join(",")})`};const Sr=TD;function pn(e){if(yi(e))return e;const t=qt(e)?e:TD(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function SCe(e){return e===!1||e===null}function ht(e,t){return e.indexOf(t)>-1}function ID(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function Iqe(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function vNn(e,...t){for(const n of t)yNn(e,n!=null?n:{});return e}function yNn(e,t){for(const n of Ne(t))Kce(e,n,t[n],!0)}function o0(e,t){const n=[],r={};let i;for(const s of e)i=t(s),!(i in r)&&(r[i]=1,n.push(s));return n}function bNn(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Nqe(e,t){for(const n of e)if(t.has(n))return!0;return!1}function kCe(e){const t=new Set;for(const n of e){const i=Rx(n).map((a,o)=>o===0?a:`[${a}]`),s=i.map((a,o)=>i.slice(0,o+1).join(""));for(const a of s)t.add(a)}return t}function Mqe(e,t){return e===void 0||t===void 0?!0:Nqe(kCe(e),kCe(t))}function er(e){return Ne(e).length===0}const Ne=Object.keys,k0=Object.values;function Fqe(e){const t=[];for(const n in e)H1(e,n)&&t.push({key:n,value:e[n]});return t}function gB(e){return e===!0||e===!1}function Er(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function LA(e,t){return Jce(e)?"!("+LA(e.not,t)+")":Qce(e)?"("+e.and.map(n=>LA(n,t)).join(") && (")+")":Zce(e)?"("+e.or.map(n=>LA(n,t)).join(") || (")+")":t(e)}function gJ(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&gJ(e[n],t)&&delete e[n],er(e)}function _W(e){return e.charAt(0).toUpperCase()+e.substr(1)}function Oqe(e,t="datum"){const n=Rx(e),r=[];for(let i=1;i<=n.length;i++){const s=`[${n.slice(0,i).map(an).join("][")}]`;r.push(`${t}${s}`)}return r.join(" && ")}function xNn(e,t="datum"){return`${t}[${an(Rx(e).join("."))}]`}function wNn(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Sm(e){return`${Rx(e).map(wNn).join("\\.")}`}function X$(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function Rqe(e){return`${Rx(e).join(".")}`}function ND(e){return e?Rx(e).length:0}function bi(...e){for(const t of e)if(t!==void 0)return t}let $Nn=42;function CNn(e){const t=++$Nn;return e?String(e)+t:t}function _Nn(e){return SNn(e)?e:`__${e}`}function SNn(e){return e.indexOf("__")===0}function mB(e){if(e!==void 0)return(e%360+360)%360}function efe(e){return yi(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const ECe={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function tfe(e){return e&&e.condition}const Pqe=["domain","grid","labels","ticks","title"],kNn={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},Lqe={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},ENn=Object.assign(Object.assign({},Lqe),{style:1,labelExpr:1,encoding:1});function ACe(e){return!!ENn[e]}const Ao={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},Bqe=Ao.arc,SW=Ao.area,kW=Ao.bar,ANn=Ao.image,EW=Ao.line,AW=Ao.point,TNn=Ao.rect,vB=Ao.rule,zqe=Ao.text,nfe=Ao.tick,DNn=Ao.trail,rfe=Ao.circle,ife=Ao.square,Uqe=Ao.geoshape;function Lx(e){return ht(["line","area","trail"],e)}function TCe(e){return ht(["rect","bar","image","arc"],e)}const Wqe=Ne(Ao);function Xh(e){return e.type}Px(Wqe);const INn=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],NNn=["fill","fillOpacity"],MNn=[...INn,...NNn],FNn={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1},DCe=Ne(FNn),ONn={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},RNn={color:"#4c78a8",invalid:"filter",timeUnitBand:1},PNn={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Vqe=5,LNn={binSpacing:1,continuousBandSize:Vqe,timeUnitBandPosition:.5},BNn={binSpacing:0,continuousBandSize:Vqe,timeUnitBandPosition:.5},zNn={thickness:1};function UNn(e){return Xh(e)?e.type:e}function mg(e){return"mark"in e}class TW{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return mg(t)?UNn(t.mark)===this.name:!1}}const WNn={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},VNn={count:1,min:1,max:1};function km(e){return!!e&&!!e.argmin}function Bx(e){return!!e&&!!e.argmax}function sfe(e){return qt(e)&&!!WNn[e]}const jNn=["count","valid","missing","distinct"];function jqe(e){return qt(e)&&ht(jNn,e)}function HNn(e){return qt(e)&&ht(["min","max"],e)}const qNn=["count","sum","distinct","valid","missing"],GNn=["mean","average","median","q1","q3","min","max"],YNn=Px(GNn),Cp="row",_p="column",DW="facet",Ur="x",Ni="y",xf="x2",yd="y2",bd="radius",vg="radius2",wf="theta",yg="theta2",xd="latitude",wd="longitude",$f="latitude2",Wu="longitude2",hl="color",$d="fill",Cd="stroke",dl="shape",bg="size",zx="angle",xg="opacity",cv="fillOpacity",fv="strokeOpacity",hv="strokeWidth",dv="strokeDash",fF="text",hF="order",dF="detail",IW="key",$b="tooltip",NW="href",MW="url",FW="description",XNn={x:1,y:1,x2:1,y2:1},Hqe={theta:1,theta2:1,radius:1,radius2:1};function qqe(e){return e in Hqe}const afe={longitude:1,longitude2:1,latitude:1,latitude2:1};function KNn(e){switch(e){case xd:return"y";case $f:return"y2";case wd:return"x";case Wu:return"x2"}}function ZNn(e){return e in afe}const QNn=Ne(afe),Gqe=Object.assign(Object.assign(Object.assign(Object.assign({},XNn),Hqe),afe),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function vw(e){return e===hl||e===$d||e===Cd}const Yqe={row:1,column:1,facet:1},ku=Ne(Yqe),ofe=Object.assign(Object.assign({},Gqe),Yqe),Xqe=Ne(ofe),JNn=it(ofe,["order","detail","tooltip"]),eMn=it(JNn,["row","column","facet"]);function tMn(e){return!!eMn[e]}function Kqe(e){return!!ofe[e]}const nMn=[xf,yd,$f,Wu,yg,vg];function Zqe(e){return Ux(e)!==e}function Ux(e){switch(e){case xf:return Ur;case yd:return Ni;case $f:return xd;case Wu:return wd;case yg:return wf;case vg:return bd}return e}function Em(e){if(qqe(e))switch(e){case wf:return"startAngle";case yg:return"endAngle";case bd:return"outerRadius";case vg:return"innerRadius"}return e}function _d(e){switch(e){case Ur:return xf;case Ni:return yd;case xd:return $f;case wd:return Wu;case wf:return yg;case bd:return vg}}function Sd(e){switch(e){case Ur:case xf:return"width";case Ni:case yd:return"height"}}function rMn(e){switch(e){case Ur:return"xOffset";case Ni:return"yOffset";case xf:return"x2Offset";case yd:return"y2Offset";case wf:return"thetaOffset";case bd:return"radiusOffset";case yg:return"theta2Offset";case vg:return"radius2Offset"}}const lfe=it(Gqe,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),iMn=Ne(lfe),pv={x:1,y:1},Vu=Ne(pv);function Kh(e){return e in pv}const ufe={theta:1,radius:1},sMn=Ne(ufe);function OW(e){return e==="width"?Ur:Ni}const Qqe=it(lfe,["text","tooltip","href","url","description","detail","key","order"]),aMn=Ne(Qqe);function oMn(e){return!!lfe[e]}function lMn(e){switch(e){case hl:case $d:case Cd:case bg:case dl:case xg:case hv:case dv:return!0;case cv:case fv:case zx:return!1}}const Jqe=Object.assign(Object.assign(Object.assign({},pv),ufe),Qqe),RW=Ne(Jqe);function gv(e){return!!Jqe[e]}function uMn(e,t){return fMn(e)[t]}const eGe={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},cMn=it(eGe,["geoshape"]);function fMn(e){switch(e){case hl:case $d:case Cd:case FW:case dF:case IW:case $b:case NW:case hF:case xg:case cv:case fv:case hv:case DW:case Cp:case _p:return eGe;case Ur:case Ni:case xd:case wd:return cMn;case xf:case yd:case $f:case Wu:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case bg:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case dv:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case dl:return{point:"always",geoshape:"always"};case fF:return{text:"always"};case zx:return{point:"always",square:"always",text:"always"};case MW:return{image:"always"};case wf:return{text:"always",arc:"always"};case bd:return{text:"always",arc:"always"};case yg:case vg:return{arc:"always"}}}function Y4(e){switch(e){case Ur:case Ni:case wf:case bd:case bg:case zx:case hv:case xg:case cv:case fv:case xf:case yd:case yg:case vg:return;case DW:case Cp:case _p:case dl:case dv:case fF:case $b:case NW:case MW:case FW:return"discrete";case hl:case $d:case Cd:return"flexible";case xd:case wd:case $f:case Wu:case dF:case IW:case hF:return}}function tGe(e){return uF(e)&&(e=VW(e,void 0)),"bin"+Ne(e).map(t=>PW(e[t])?Er(`_${t}_${Object.entries(e[t])}`):Er(`_${t}_${e[t]}`)).join("")}function hr(e){return e===!0||pF(e)&&!e.binned}function Ja(e){return e==="binned"||pF(e)&&e.binned===!0}function pF(e){return ds(e)}function PW(e){return e==null?void 0:e.selection}function ICe(e){switch(e){case Cp:case _p:case bg:case hl:case $d:case Cd:case hv:case xg:case cv:case fv:case dl:return 6;case dv:return 4;default:return 10}}function cfe(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const hMn='Autosize "fit" only works for single views and layered views.';function NCe(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function MCe(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function FCe(e){return e?`Dropping "fit-${e}" because spec has discrete ${Sd(e)}.`:'Dropping "fit" because spec has discrete size.'}function OCe(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function dMn(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function pMn(e){return`The "nearest" transform is not supported for ${e} marks.`}function nGe(e){return`Selection not supported for ${e} yet.`}function gMn(e){return`Cannot find a selection named "${e}".`}const mMn="Scale bindings are currently only supported for scales with unbinned, continuous domains.",vMn="Legend bindings are only supported for selections over an individual field or encoding channel.";function yMn(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}function bMn(e){return`Unknown repeated value "${e}".`}function RCe(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const xMn="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function wMn(e){return`Unrecognized parse "${e}".`}function PCe(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function $Mn(e){return`Ignoring an invalid transform: ${Sr(e)}.`}const CMn='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function LCe(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function _Mn(e){return`Layer's shared ${e.join(",")} channel ${e.length===1?"is":"are"} overriden.`}function SMn(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Sr(t)} is overridden by a child projection ${Sr(n)}.`}const kMn="Arc marks uses theta channel rather than angle, replacing angle with theta.";function EMn(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Sr(n)}}.`}function rGe(e){return`Invalid field type "${e}".`}function AMn(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function TMn(e){return`Invalid aggregation operator "${e}".`}function DMn(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function iGe(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function mJ(e,t){return`Dropping ${Sr(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const IMn="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function LW(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function NMn(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function MMn(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function FMn(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function bG(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function OMn(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function RMn(e,t){return`Specified orient "${e}" overridden with "${t}".`}const PMn=`Scale's "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.`;function LMn(e){return`Cannot use the scale property "${e}" with non-color channel.`}function BMn(e){return`Using unaggregated domain with raw field has no effect (${Sr(e)}).`}function zMn(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function UMn(e){return`Unaggregated domain is currently unsupported for log scale (${Sr(e)}).`}function WMn(e){return`Cannot apply size to non-oriented mark "${e}".`}function VMn(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function jMn(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function sGe(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function aGe(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function HMn(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Sr(n)} and ${Sr(r)}). Using ${Sr(n)}.`}function qMn(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Sr(n)} and ${Sr(r)}). Using the union of the two domains.`}function GMn(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function YMn(e){return`Dropping sort property ${Sr(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const BCe="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",XMn="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",KMn="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",ZMn="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function QMn(e){return`Cannot stack "${e}" if there is already "${e}2".`}function JMn(e){return`Cannot stack non-linear scale (${e}).`}function eFn(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function yB(e,t){return`Invalid ${e}: ${Sr(t)}.`}function tFn(e){return`Dropping day from datetime ${Sr(e)} as day cannot be combined with other units.`}function nFn(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function rFn(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function iFn(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function sFn(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}function zCe(e){return`1D error band does not support ${e}.`}function oGe(e){return`Channel ${e} is required for "binned" bin.`}function aFn(e){return`Domain for ${e} is required for threshold scale.`}const lGe=fNn(Aqe);let K$=lGe;function oFn(e){return K$=e,K$}function lFn(){return K$=lGe,K$}function Te(...e){K$.warn(...e)}function uFn(...e){K$.debug(...e)}function wS(e){if(e&&ds(e)){for(const t of hfe)if(t in e)return!0}return!1}const uGe=["january","february","march","april","may","june","july","august","september","october","november","december"],cFn=uGe.map(e=>e.substr(0,3)),cGe=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],fFn=cGe.map(e=>e.substr(0,3));function hFn(e){if(efe(e)&&(e=+e),yi(e))return e>4&&Te(yB("quarter",e)),e-1;throw new Error(yB("quarter",e))}function dFn(e){if(efe(e)&&(e=+e),yi(e))return e-1;{const t=e.toLowerCase(),n=uGe.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=cFn.indexOf(r);if(i!==-1)return i;throw new Error(yB("month",e))}}function pFn(e){if(efe(e)&&(e=+e),yi(e))return e%7;{const t=e.toLowerCase(),n=cGe.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=fFn.indexOf(r);if(i!==-1)return i;throw new Error(yB("day",e))}}function ffe(e,t){const n=[];if(t&&e.day!==void 0&&Ne(e).length>1&&(Te(tFn(e)),e=Gt(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?dFn(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?hFn(e.quarter):e.quarter;n.push(yi(r)?r*3:r+"*3")}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?pFn(e.day):e.day;n.push(yi(r)?r+1:r+"+1")}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i>"u"?0:i)}return n}function MD(e){const n=ffe(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function gFn(e){const n=ffe(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function mFn(e){const t=ffe(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const fGe={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},hfe=Ne(fGe);function vFn(e){return!!fGe[e]}function dfe(e){return e.startsWith("utc")}function yFn(e){return e.substr(3)}const bFn={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function pfe(e){const t=[];for(const n of hfe)hGe(e,n)&&t.push(n);return t}function hGe(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function xFn(e,t,{end:n}={end:!1}){const r=Oqe(t),i=dfe(e)?"utc":"";function s(l){return l==="quarter"?`(${i}quarter(${r})-1)`:`${i}${l}(${r})`}let a;const o={};for(const l of hfe)hGe(e,l)&&(o[l]=s(l),a=l);return n&&(o[a]+="+1"),gFn(o)}function dGe(e){if(!e)return;const t=pfe(e);return`timeUnitSpecifier(${TD(t)}, ${TD(bFn)})`}function wFn(e,t,n){if(!e)return;const r=dGe(e);return`${n||dfe(e)?"utc":"time"}Format(${t}, ${r})`}function wo(e){if(!e)return;let t;return qt(e)?t={unit:e}:ds(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),dfe(t.unit)&&(t.utc=!0,t.unit=yFn(t.unit)),t}function $Fn(e){const t=wo(e),{utc:n}=t,r=it(t,["utc"]);return r.unit?(n?"utc":"")+Ne(r).map(i=>Er(`${i==="unit"?"":`_${i}_`}${r[i]}`)).join(""):(n?"utc":"")+"timeunit"+Ne(r).map(i=>Er(`_${i}_${r[i]}`)).join("")}function wt(e){return e&&!!e.signal}function mv(e){return!!e.step}function CFn(e){return ut(e)?!1:"fields"in e&&!("data"in e)}function _Fn(e){return ut(e)?!1:"fields"in e&&"data"in e}function l0(e){return ut(e)?!1:"field"in e&&"data"in e}const SFn={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1},kFn=Ne(SFn),EFn={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},xG=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function AFn(e){return e==null?void 0:e.selection}function gfe(e){return e&&!!e.field&&e.equal!==void 0}function pGe(e){return e&&!!e.field&&e.lt!==void 0}function gGe(e){return e&&!!e.field&&e.lte!==void 0}function mGe(e){return e&&!!e.field&&e.gt!==void 0}function vGe(e){return e&&!!e.field&&e.gte!==void 0}function mfe(e){if(e&&e.field){if(ut(e.range)&&e.range.length===2)return!0;if(wt(e.range))return!0}return!1}function vfe(e){return e&&!!e.field&&(ut(e.oneOf)||ut(e.in))}function TFn(e){return e&&!!e.field&&e.valid!==void 0}function yGe(e){return vfe(e)||gfe(e)||mfe(e)||pGe(e)||mGe(e)||gGe(e)||vGe(e)}function If(e,t){return Nfe(e,{timeUnit:t,wrapTime:!0})}function DFn(e,t){return e.map(n=>If(n,t))}function bGe(e,t=!0){var n;const{field:r}=e,i=(n=wo(e.timeUnit))===null||n===void 0?void 0:n.unit,s=i?"time("+xFn(i,r)+")":Me(e,{expr:"datum"});if(gfe(e))return s+"==="+If(e.equal,i);if(pGe(e)){const a=e.lt;return`${s}<${If(a,i)}`}else if(mGe(e)){const a=e.gt;return`${s}>${If(a,i)}`}else if(gGe(e)){const a=e.lte;return`${s}<=${If(a,i)}`}else if(vGe(e)){const a=e.gte;return`${s}>=${If(a,i)}`}else{if(vfe(e))return`indexof([${DFn(e.oneOf,i).join(",")}], ${s}) !== -1`;if(TFn(e))return yfe(s,e.valid);if(mfe(e)){const{range:a}=e,o=wt(a)?{signal:`${a.signal}[0]`}:a[0],l=wt(a)?{signal:`${a.signal}[1]`}:a[1];if(o!==null&&l!==null&&t)return"inrange("+s+", ["+If(o,i)+", "+If(l,i)+"])";const u=[];return o!==null&&u.push(`${s} >= ${If(o,i)}`),l!==null&&u.push(`${s} <= ${If(l,i)}`),u.length>0?u.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function yfe(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function IFn(e){var t;return yGe(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=wo(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const $S={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},Cb=$S.quantitative,bfe=$S.ordinal,Z$=$S.temporal,xfe=$S.nominal,CS=$S.geojson,NFn=Ne($S);function MFn(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Cb:return"quantitative";case"t":case Z$:return"temporal";case"o":case bfe:return"ordinal";case"n":case xfe:return"nominal";case CS:return"geojson"}}const fi={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},vJ={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},FFn=Ne(vJ);function OFn(e,t){const n=vJ[e],r=vJ[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const RFn={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function UCe(e){return RFn[e]}const xGe=["linear","log","pow","sqrt","symlog","time","utc"],PFn=Px(xGe),LFn=["linear","log","pow","sqrt","symlog"],BFn=Px(LFn);function zFn(e){return e in BFn}const UFn=["quantile","quantize","threshold"],WFn=Px(UFn),VFn=xGe.concat(["quantile","quantize","threshold","sequential","identity"]),jFn=Px(VFn),HFn=["ordinal","bin-ordinal","point","band"],qFn=Px(HFn);function pl(e){return e in qFn}function ju(e){return e in jFn}function Rc(e){return e in PFn}function bB(e){return e in WFn}const GFn={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function YFn(e){return!qt(e)&&!!e.name}function wGe(e){return e==null?void 0:e.selection}function XFn(e){return e&&e.unionWith}const KFn={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},ZFn=it(KFn,["type","domain","range","scheme"]),QFn=Ne(ZFn);JFn();function $Ge(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!ht(["point","band","identity"],e);case"bins":return!ht(["point","band","identity","ordinal"],e);case"round":return Rc(e)||e==="band"||e==="point";case"padding":return Rc(e)||ht(["point","band"],e);case"paddingOuter":case"align":return ht(["point","band"],e);case"paddingInner":return e==="band";case"domainMid":case"clamp":return Rc(e);case"nice":return Rc(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return ju(e)&&!ht(["log","time","utc","threshold","quantile"],e)}}function CGe(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return vw(e)?void 0:LMn(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function _Ge(e,t){return ht([bfe,xfe],t)?e===void 0||pl(e):t===Z$?ht([fi.TIME,fi.UTC,void 0],e):t===Cb?ht([fi.LOG,fi.POW,fi.SQRT,fi.SYMLOG,fi.QUANTILE,fi.QUANTIZE,fi.THRESHOLD,fi.LINEAR,void 0],e):!0}function SGe(e,t){if(!gv(e))return!1;switch(e){case Ur:case Ni:case wf:case bd:return Rc(t)||ht(["band","point"],t);case bg:case hv:case xg:case cv:case fv:case zx:return Rc(t)||bB(t)||ht(["band","point","ordinal"],t);case hl:case $d:case Cd:return t!=="band";case dv:return t==="ordinal"||bB(t);case dl:return t==="ordinal"}}function JFn(){var e;const t={};for(const n of Xqe)for(const r of NFn)for(const i of FFn){const s=eOn(n,r);SGe(n,i)&&_Ge(i,r)&&(t[s]=(e=t[s])!==null&&e!==void 0?e:[],t[s].push(i))}return t}function eOn(e,t){return e+"_"+t}function wfe(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:s}=e,a=EGe(e);return Le(n)&&!jqe(n.aggregate)&&i&&Rc(i.get("type"))&&i.get("zero")===!1?kGe({fieldDef:n,channel:t,markDef:r,ref:a,config:s}):a}function kGe({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return Lx(n.type)||Ln("invalid",n,i)===null?r:[tOn(e,t),r]}function tOn(e,t){const n=$fe(e,!0),i=Ux(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function $fe(e,t=!0){return yfe(qt(e)?e:Me(e,{expr:"datum"}),!t)}function nOn(e){const{datum:t}=e;return wS(t)?MD(t):`${JSON.stringify(t)}`}function vy(e,t,n,r){const i={};if(t&&(i.scale=t),vv(e)){const{datum:s}=e;wS(s)?i.signal=MD(s):wt(s)?i.signal=s.signal:i.value=s}else i.field=Me(e,n);if(r){const{offset:s,band:a}=r;s&&(i.offset=s),a&&(i.band=a)}return i}function xB({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,band:s=.5}){const a=0<s&&s<1?"datum":void 0,o=Me(t,{expr:a,suffix:i}),l=n!==void 0?Me(n,{expr:a}):Me(t,{suffix:"end",expr:a}),u={};if(s===0||s===1){u.scale=e;const c=s===0?o:l;u.field=c}else{const c=`${s} * ${o} + ${1-s} * ${l}`;u.signal=`scale("${e}", ${c})`}return r&&(u.offset=r),u}function EGe({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:s,scale:a,stack:o,offset:l,defaultRef:u,band:c}){var f;if(t){if(_t(t)){if(Kl(t)){c=c!=null?c:mF({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:o,config:i,isMidPoint:!0});const{bin:d,timeUnit:p,type:g}=t;if(hr(d)||c&&p&&g===Z$)return o&&o.impute?vy(t,s,{binSuffix:"mid"},{offset:l}):c?xB({scaleName:s,fieldOrDatumDef:t,band:c,offset:l}):vy(t,s,vF(t,e)?{binSuffix:"range"}:{},{offset:l});if(Ja(d)){if(Le(n))return xB({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:c,offset:l});Te(oGe(e===Ur?xf:yd))}}const h=a==null?void 0:a.get("type");return vy(t,s,pl(h)?{binSuffix:"range"}:{},{offset:l,band:h==="band"?(f=c!=null?c:t.band)!==null&&f!==void 0?f:.5:void 0})}else if(Yp(t)){const h=t.value,d=l?{offset:l}:{};return Object.assign(Object.assign({},BA(e,h)),d)}}return dNn(u)&&(u=u()),u&&Object.assign(Object.assign({},u),l?{offset:l}:{})}function BA(e,t){return ht(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:ht(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:ai(t)}function _b(e){return e&&e!=="number"&&e!=="time"}function AGe(e,t,n){return`${e}(${t}${n?`, ${JSON.stringify(n)}`:""})`}const rOn=" \u2013 ";function Cfe({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:s}){var a,o;if(_b(n))return _fe({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:s});const l=TGe(e,r,i);if(jW(e)){const u=sOn(l,Le(e)?(a=wo(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0,t,s.timeFormat,Tfe(e)&&((o=e.scale)===null||o===void 0?void 0:o.type)===fi.UTC);return u?{signal:u}:void 0}if(t=NGe(Lg(e),t,s),Le(e)&&hr(e.bin)){const u=Me(e,{expr:r,binSuffix:"end"});return{signal:BW(l,u,t,n,s)}}else return t||Lg(e)==="quantitative"?{signal:`${MGe(l,t)}`}:{signal:`isValid(${l}) ? ${l} : ""+${l}`}}function TGe(e,t,n){return Le(e)?n?`${Me(e,{expr:t,suffix:"end"})}-${Me(e,{expr:t,suffix:"start"})}`:Me(e,{expr:t}):nOn(e)}function _fe({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:s,field:a}){if(a=a!=null?a:TGe(e,r,i),Le(e)&&hr(e.bin)){const o=Me(e,{expr:r,binSuffix:"end"});return{signal:BW(a,o,t,n,s)}}return{signal:AGe(n,a,t)}}function DGe(e,t,n,r,i,s){var a;if(!_b(r)){if(jW(e)){const o=Le(e)?(a=wo(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0;return iOn(n,o,i,s)}return NGe(t,n,i)}}function IGe(e,t,n){if(e&&(wt(e)||e==="number"||e==="time"))return e;if(jW(t)&&n!=="time"&&n!=="utc")return"time"}function NGe(e,t,n){if(qt(t))return t;if(e===Cb)return n.numberFormat}function iOn(e,t,n,r){return e||(t?{signal:dGe(t)}:r?void 0:n.timeFormat)}function MGe(e,t){return`format(${e}, "${t||""}")`}function WCe(e,t,n,r){var i;return _b(n)?AGe(n,e,t):MGe(e,(i=qt(t)?t:void 0)!==null&&i!==void 0?i:r.numberFormat)}function BW(e,t,n,r,i){const s=WCe(e,n,r,i),a=WCe(t,n,r,i);return`${yfe(e,!1)} ? "null" : ${s} + "${rOn}" + ${a}`}function sOn(e,t,n,r,i){return!t||n?(n=qt(n)?n:r,`${i?"utc":"time"}Format(${e}, '${n}')`):wFn(t,e,i)}const zW="min",aOn={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function VCe(e){return e in aOn}function FGe(e){return!!e&&!!e.encoding}function bh(e){return!!e&&(e.op==="count"||!!e.field)}function OGe(e){return!!e&&ut(e)}function gF(e){return"row"in e||"column"in e}function Sfe(e){return!!e&&"header"in e}function UW(e){return"facet"in e}function oOn(e){return e.selection}function lOn(e){return e&&!qt(e)&&"repeat"in e}function jCe(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function RGe(e){return Kl(e)&&"sort"in e}function mF({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:i,config:s,isMidPoint:a}){if(_t(t)&&t.band!==void 0)return t.band;if(Le(t)){const{timeUnit:o,bin:l}=t;if(o&&!n)return a?Sb("timeUnitBandPosition",r,s):TCe(r.type)?Sb("timeUnitBand",r,s):0;if(hr(l))return TCe(r.type)&&!a?1:.5}if((i==null?void 0:i.fieldChannel)===e&&a)return .5}function kfe(e,t,n,r,i,s){return hr(t.bin)||t.timeUnit&&Kl(t)&&t.type==="temporal"?!!mF({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:i,config:s}):!1}function Efe(e){return!!e&&"condition"in e}function WW(e){const t=e&&e.condition;return!!t&&!ut(t)&&Le(t)}function Afe(e){const t=e&&e.condition;return!!t&&!ut(t)&&_t(t)}function uOn(e){const t=e&&e.condition;return!!t&&(ut(t)||Yp(t))}function Le(e){return!!e&&(!!e.field||e.aggregate==="count")}function Lg(e){return e&&e.type}function vv(e){return!!e&&"datum"in e}function eh(e){return Kl(e)&&zGe(e)||yJ(e)}function yJ(e){return vv(e)&&yi(e.datum)}function _t(e){return Le(e)||vv(e)}function Kl(e){return!!e&&("field"in e&&"type"in e||e.aggregate==="count")}function Yp(e){return e&&"value"in e&&"value"in e}function Tfe(e){return!!e&&("scale"in e||"sort"in e)}function Dfe(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function PGe(e){return!!e&&"legend"in e}function LGe(e){return!!e&&("format"in e||"formatType"in e)}function cOn(e){return"op"in e}function Me(e,t={}){var n,r,i;let s=e.field;const a=t.prefix;let o=t.suffix,l="";if(fOn(e))s=_Nn("count");else{let u;if(!t.nofn)if(cOn(e))u=e.op;else{const{bin:c,aggregate:f,timeUnit:h}=e;hr(c)?(u=tGe(c),o=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")):f?Bx(f)?(l=`["${s}"]`,s=`argmax_${f.argmax}`):km(f)?(l=`["${s}"]`,s=`argmin_${f.argmin}`):u=String(f):h&&(u=$Fn(h),o=(!ht(["range","mid"],t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:""))}u&&(s=s?`${u}_${s}`:u)}return o&&(s=`${s}_${o}`),a&&(s=`${a}_${s}`),t.forAs?Rqe(s):t.expr?xNn(s,t.expr)+l:Sm(s)+l}function BGe(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Le(e)&&!!e.bin;case"temporal":return!1}throw new Error(rGe(e.type))}function zGe(e){return!BGe(e)}function fOn(e){return e.aggregate==="count"}function hOn(e,t){var n;const{field:r,bin:i,timeUnit:s,aggregate:a}=e;if(a==="count")return t.countTitle;if(hr(i))return`${r} (binned)`;if(s){const o=(n=wo(s))===null||n===void 0?void 0:n.unit;if(o)return`${r} (${pfe(o).join("-")})`}else if(a)return Bx(a)?`${r} for max ${a.argmax}`:km(a)?`${r} for min ${a.argmin}`:`${_W(a)} of ${r}`;return r}function dOn(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(Bx(t))return`${i} for argmax(${t.argmax})`;if(km(t))return`${i} for argmin(${t.argmin})`;const s=wo(r),a=t||(s==null?void 0:s.unit)||(s==null?void 0:s.maxbins)&&"timeunit"||hr(n)&&"bin";return a?a.toUpperCase()+"("+i+")":i}const UGe=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return dOn(e);default:return hOn(e,t)}};let WGe=UGe;function VGe(e){WGe=e}function pOn(){VGe(UGe)}function yy(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,s;const o=((i=Ife(e))!==null&&i!==void 0?i:{}).title;if(!Le(e))return o;const l=e,u=r?jGe(l,t):void 0;return n?bi(o,l.title,u):(s=o!=null?o:l.title)!==null&&s!==void 0?s:u}function Ife(e){if(Dfe(e)&&e.axis)return e.axis;if(PGe(e)&&e.legend)return e.legend;if(Sfe(e)&&e.header)return e.header}function jGe(e,t){return WGe(e,t)}function wB(e){var t;if(LGe(e)){const{format:n,formatType:r}=e;return{format:n,formatType:r}}else{const n=(t=Ife(e))!==null&&t!==void 0?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function gOn(e,t){if(e.timeUnit)return"temporal";if(hr(e.bin))return"quantitative";switch(Y4(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function Zh(e){if(Le(e))return e;if(WW(e))return e.condition}function Ti(e){if(_t(e))return e;if(Afe(e))return e.condition}function bJ(e,t,n){if(qt(e)||yi(e)||uF(e)){const r=qt(e)?"string":yi(e)?"number":"boolean";return Te(EMn(t,r,e)),{value:e}}return _t(e)?$B(e,t,n):Afe(e)?Object.assign(Object.assign({},e),{condition:$B(e.condition,t,n)}):e}function $B(e,t,n){if(LGe(e)){const{format:r,formatType:i}=e,s=it(e,["format","formatType"]);if(_b(i)&&!n.customFormatTypes)return Te(LCe(t)),$B(s,t,n)}else{const r=Dfe(e)?"axis":PGe(e)?"legend":Sfe(e)?"header":null;if(r&&e[r]){const i=e[r],{format:s,formatType:a}=i,o=it(i,["format","formatType"]);if(_b(a)&&!n.customFormatTypes)return Te(LCe(t)),$B(Object.assign(Object.assign({},e),{[r]:o}),t,n)}}return Le(e)?HGe(e,t):mOn(e)}function mOn(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=yi(n)?"quantitative":qt(n)?"nominal":wS(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function HGe(e,t){const{aggregate:n,timeUnit:r,bin:i,field:s}=e,a=Object.assign({},e);if(n&&!sfe(n)&&!Bx(n)&&!km(n)&&(Te(TMn(n)),delete a.aggregate),r&&(a.timeUnit=wo(r)),s&&(a.field=`${s}`),hr(i)&&(a.bin=VW(i,t)),Ja(i)&&!Kh(t)&&Te(`Channel ${t} should not be used with "binned" bin.`),Kl(a)){const{type:o}=a,l=MFn(o);o!==l&&(a.type=l),o!=="quantitative"&&jqe(n)&&(Te(AMn(o,n)),a.type="quantitative")}else if(!Zqe(t)){const o=gOn(a,t);Te(DMn(t,o)),a.type=o}if(Kl(a)){const{compatible:o,warning:l}=vOn(a,t);o||Te(l)}if(RGe(a)&&qt(a.sort)){const{sort:o}=a;if(VCe(o))return Object.assign(Object.assign({},a),{sort:{encoding:o}});const l=o.substr(1);if(o.charAt(0)==="-"&&VCe(l))return Object.assign(Object.assign({},a),{sort:{encoding:l,order:"descending"}})}if(Sfe(a)){const{header:o}=a,{orient:l}=o,u=it(o,["orient"]);if(l)return Object.assign(Object.assign({},a),{header:Object.assign(Object.assign({},u),{labelOrient:o.labelOrient||l,titleOrient:o.titleOrient||l})})}return a}function VW(e,t){return uF(e)?{maxbins:ICe(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:ICe(t)}):e}const Mv={compatible:!0};function vOn(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case Cp:case _p:case DW:return zGe(e)?{compatible:!1,warning:MMn(t)}:Mv;case Ur:case Ni:case hl:case $d:case Cd:case fF:case dF:case IW:case $b:case NW:case MW:case zx:case wf:case bd:case FW:return Mv;case wd:case Wu:case xd:case $f:return n!==Cb?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Mv;case xg:case cv:case fv:case hv:case bg:case yg:case vg:case xf:case yd:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Mv;case dv:return ht(["ordinal","nominal"],e.type)?Mv:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case dl:return ht(["ordinal","nominal","geojson"],e.type)?Mv:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case hF:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Mv}}function jW(e){const{formatType:t}=wB(e);return t==="time"||!t&&yOn(e)}function yOn(e){return e&&(e.type==="temporal"||Le(e)&&!!e.timeUnit)}function Nfe(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var s;const a=t&&((s=wo(t))===null||s===void 0?void 0:s.unit);let o=a||n==="temporal",l;return wt(e)?l=e.signal:wS(e)?(o=!0,l=MD(e)):(qt(e)||yi(e))&&o&&(l=`datetime(${JSON.stringify(e)})`,vFn(a)&&(yi(e)&&e<1e4||qt(e)&&isNaN(Date.parse(e)))&&(l=MD({[a]:e}))),l?r&&o?`time(${l})`:l:i?void 0:JSON.stringify(e)}function qGe(e,t){const{type:n}=e;return t.map(r=>{const i=Nfe(r,{timeUnit:Le(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function vF(e,t){return hr(e.bin)?gv(t)&&ht(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function GGe(e){const{anchor:t,frame:n,offset:r,orient:i,color:s,subtitleColor:a,subtitleFont:o,subtitleFontSize:l,subtitleFontStyle:u,subtitleFontWeight:c,subtitleLineHeight:f,subtitlePadding:h}=e,d=it(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},d),s?{fill:s}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},a?{subtitleColor:a}:{}),o?{subtitleFont:o}:{}),l?{subtitleFontSize:l}:{}),u?{subtitleFontStyle:u}:{}),c?{subtitleFontWeight:c}:{}),f?{subtitleLineHeight:f}:{}),h?{subtitlePadding:h}:{}),v=DD(p,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:p,subtitleMarkConfig:v,nonMark:g,subtitle:m}}function Bg(e){return qt(e)||ut(e)&&qt(e[0])}function ai(e){return wt(e)?e:e!==void 0?{value:e}:void 0}function HCe(e){return wt(e)?e.signal:an(e.value)}function FD(e){return wt(e)?e.signal:e==null?null:an(e)}function bOn(e,t,n){for(const r of n){const i=Sb(r,t.markDef,t.config);i!==void 0&&(e[r]=ai(i))}return e}function YGe(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function Ln(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:s}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:s&&(!i||i===e)?void 0:Sb(e,t,n,r)}function Sb(e,t,n,{vgChannel:r}={}){return bi(r?CB(e,t,n.style):void 0,CB(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function CB(e,t,n){return XGe(e,YGe(t),n)}function XGe(e,t,n){t=ci(t);let r;for(const i of t){const s=n[i];s&&s[e]!==void 0&&(r=s[e])}return r}function KGe(e,t){return ci(e).reduce((n,r)=>{var i;return n.field.push(Me(r,t)),n.order.push((i=r.sort)!==null&&i!==void 0?i:"ascending"),n},{field:[],order:[]})}function ZGe(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(cF(i,r))return;n.push(r)}),n}function QGe(e,t){return cF(e,t)||!t?e:e?[...ci(e),...ci(t)].join(", "):t}function JGe(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((Bg(n)||wt(n))&&(Bg(r)||wt(r)))return{explicit:e.explicit,value:QGe(n,r)};if(Bg(n)||wt(n))return{explicit:e.explicit,value:n};if(Bg(r)||wt(r))return{explicit:e.explicit,value:r};if(!Bg(n)&&!wt(n)&&!Bg(r)&&!wt(r))return{explicit:e.explicit,value:ZGe(n,r)};throw new Error("It should never reach here")}function by(e,t){const n=e&&e[t];return n?ut(n)?ID(n,r=>!!r.field):Le(n)||WW(n):!1}function Mfe(e){return ID(Xqe,t=>{if(by(e,t)){const n=e[t];if(ut(n))return ID(n,r=>!!r.aggregate);{const r=Zh(n);return r&&!!r.aggregate}}return!1})}function Ffe(e,t){const n=[],r=[],i=[],s=[],a={};return Ofe(e,(o,l)=>{if(Le(o)){const{field:u,aggregate:c,bin:f,timeUnit:h}=o,d=it(o,["field","aggregate","bin","timeUnit"]);if(c||h||f){const p=Ife(o),g=p&&p.title;let m=Me(o,{forAs:!0});const v=Object.assign(Object.assign(Object.assign({},g?[]:{title:yy(o,t,{allowDisabling:!0})}),d),{field:m});if(c){let y;if(Bx(c)?(y="argmax",m=Me({op:"argmax",field:c.argmax},{forAs:!0}),v.field=`${m}.${u}`):km(c)?(y="argmin",m=Me({op:"argmin",field:c.argmin},{forAs:!0}),v.field=`${m}.${u}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(y=c),y){const b={op:y,as:m};u&&(b.field=u),s.push(b)}}else if(n.push(m),Kl(o)&&hr(f)){if(r.push({bin:f,field:u,as:m}),n.push(Me(o,{binSuffix:"end"})),vF(o,l)&&n.push(Me(o,{binSuffix:"range"})),Kh(l)){const y={field:m+"_end"};a[l+"2"]=y}v.bin="binned",Zqe(l)||(v.type=Cb)}else if(h){i.push({timeUnit:h,field:u,as:m});const y=Kl(o)&&o.type!==Z$&&"time";y&&(l===fF||l===$b?v.formatType=y:oMn(l)?v.legend=Object.assign({formatType:y},v.legend):Kh(l)&&(v.axis=Object.assign({formatType:y},v.axis)))}a[l]=v}else n.push(u),a[l]=e[l]}else a[l]=e[l]}),{bins:r,timeUnits:i,aggregate:s,groupby:n,encoding:a}}function xOn(e,t,n){const r=uMn(t,n);if(r){if(r==="binned"){const i=e[t===xf?Ur:Ni];return!!(Le(i)&&Le(e[t])&&Ja(i.bin))}}else return!1;return!0}function wOn(e,t,n){const r=t.type;return Ne(e).reduce((i,s)=>{if(!Kqe(s))return Te(NMn(s)),i;const a=e[s];if(s==="angle"&&r==="arc"&&!e.theta&&(Te(kMn),s=wf),!xOn(e,s,r))return Te(LW(s,r)),i;if(s===bg&&r==="line"){const o=Zh(e[s]);if(o!=null&&o.aggregate)return Te(IMn),i}if(s===hl&&(t.filled?"fill"in e:"stroke"in e))return Te(iGe("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(s===dF||s===hF&&!ut(a)&&!Yp(a)||s===$b&&ut(a))a&&(i[s]=ci(a).reduce((o,l)=>(Le(l)?o.push(HGe(l,s)):Te(mJ(l,s)),o),[]));else{if(s===$b&&a===null)i[s]=null;else if(!Le(a)&&!vv(a)&&!Yp(a)&&!Efe(a)&&!wt(a))return Te(mJ(a,s)),i;i[s]=bJ(a,s,n)}return i},{})}function $On(e){const t=[];for(const n of Ne(e))if(by(e,n)){const r=e[n],i=ci(r);for(const s of i)Le(s)?t.push(s):WW(s)&&t.push(s.condition)}return t}function Ofe(e,t,n){if(!!e)for(const r of Ne(e)){const i=e[r];if(ut(i))for(const s of i)t.call(n,s,r);else t.call(n,i,r)}}function eYe(e,t,n,r){return e?Ne(e).reduce((i,s)=>{const a=e[s];return ut(a)?a.reduce((o,l)=>t.call(r,o,l,s),i):t.call(r,i,a,s)},n):n}function tYe(e,t){return Ne(t).reduce((n,r)=>{switch(r){case Ur:case Ni:case NW:case FW:case MW:case xf:case yd:case wf:case yg:case bd:case vg:case xd:case wd:case $f:case Wu:case fF:case dl:case zx:case $b:return n;case hF:if(e==="line"||e==="trail")return n;case dF:case IW:{const i=t[r];if(ut(i)||Le(i))for(const s of ci(i))s.aggregate||n.push(Me(s,{}));return n}case bg:if(e==="trail")return n;case hl:case $d:case Cd:case xg:case cv:case fv:case dv:case hv:{const i=Zh(t[r]);return i&&!i.aggregate&&n.push(Me(i,{})),n}}},[])}function COn(e){const{tooltip:t}=e,n=it(e,["tooltip"]);if(!t)return{filteredEncoding:e};let r,i;if(ut(t)){for(const s of t)s.aggregate?(r||(r=[]),r.push(s)):(i||(i=[]),i.push(s));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return ut(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function xJ(e,t,n,r=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...e.map(({fieldPrefix:s,titlePrefix:a})=>{const o=r?` of ${t.field}`:"";return{field:s+t.field,type:t.type,title:wt(a)?{signal:a+`"${escape(o)}"`}:a+o}}),...$On(n)]}}function nYe(e){const{axis:t,title:n,field:r}=e;return t&&t.title!==void 0?void 0:bi(n,r)}function Rfe(e,t,n,r,i){const{scale:s,axis:a}=n;return({partName:o,mark:l,positionPrefix:u,endPositionPrefix:c=void 0,aria:f,extraEncoding:h={}})=>{const d=nYe(n);return rYe(e,o,i,f,{mark:l,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:u+"_"+n.field,type:n.type},d!==void 0?{title:d}:{}),s!==void 0?{scale:s}:{}),a!==void 0?{axis:a}:{})},qt(c)?{[t+"2"]:{field:c+"_"+n.field}}:{}),r),h)})}}function rYe(e,t,n,r,i){const{clip:s,color:a,opacity:o}=e,l=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),s?{clip:s}:{}),a?{color:a}:{}),o?{opacity:o}:{}),Xh(i.mark)?i.mark:{type:i.mark}),{style:`${l}-${t}`}),uF(e[t])?{}:e[t]),r===!1?{aria:r}:{})})]:[]}function iYe(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",s=r[i],a=r[i+"2"],o=r[i+"Error"],l=r[i+"Error2"];return{continuousAxisChannelDef:TR(s,n),continuousAxisChannelDef2:TR(a,n),continuousAxisChannelDefError:TR(o,n),continuousAxisChannelDefError2:TR(l,n),continuousAxis:i}}function TR(e,t){if(e&&e.aggregate){const{aggregate:n}=e,r=it(e,["aggregate"]);return n!==t&&Te(iFn(n,t)),r}else return e}function sYe(e,t){const{mark:n,encoding:r}=e,{x:i,y:s}=r;if(eh(i)){if(eh(s)){const a=Le(i)&&i.aggregate,o=Le(s)&&s.aggregate;if(!a&&o===t)return"vertical";if(!o&&a===t)return"horizontal";if(a===t&&o===t)throw new Error("Both x and y cannot have aggregate");return Xh(n)&&n.orient?n.orient:"vertical"}return"horizontal"}else{if(eh(s))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}}const _B="boxplot",_On=["box","median","outliers","rule","ticks"],SOn=new TW(_B,oYe);function aYe(e){return yi(e)?"tukey":e}function oYe(e,{config:t}){var n,r;const{mark:i,encoding:s,selection:a,projection:o}=e,l=it(e,["mark","encoding","selection","projection"]),u=Xh(i)?i:{type:i};a&&Te(nGe("boxplot"));const c=(n=u.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=Ln("size",u,t),h=aYe(c),{transform:d,continuousAxisChannelDef:p,continuousAxis:g,groupby:m,aggregate:v,encodingWithoutContinuousAxis:y,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:w}=kOn(e,c,t),{color:C,size:$}=y,_=it(y,["color","size"]),k=P=>Rfe(u,g,p,P,t.boxplot),E=k(_),S=k(y),I=k(Object.assign(Object.assign({},_),$?{size:$}:{})),A=xJ([{fieldPrefix:h==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:h==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],p,y),D={type:"tick",color:"black",opacity:1,orient:b,invalid:null},T=h==="min-max"?A:xJ([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],p,y),N=[...E({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:T}),...E({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:T}),...E({partName:"ticks",mark:D,positionPrefix:"lower_whisker",aria:!1,extraEncoding:T}),...E({partName:"ticks",mark:D,positionPrefix:"upper_whisker",aria:!1,extraEncoding:T})],F=[...h!=="tukey"?N:[],...S({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:x,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:A}),...I({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},ds(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:b,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:A})];let R;if(h!=="min-max"){const P=`datum["lower_box_${p.field}"]`,V=`datum["upper_box_${p.field}"]`,z=`(${V} - ${P})`,q=`${P} - ${c} * ${z}`,G=`${V} + ${c} * ${z}`,K=`datum["${p.field}"]`,Y={joinaggregate:lYe(p.field),groupby:m};let te;h==="tukey"&&(te={transform:[{filter:`(${q} <= ${K}) && (${K} <= ${G})`},{aggregate:[{op:"min",field:p.field,as:"lower_whisker_"+p.field},{op:"max",field:p.field,as:"upper_whisker_"+p.field},{op:"min",field:"lower_box_"+p.field,as:"lower_box_"+p.field},{op:"max",field:"upper_box_"+p.field,as:"upper_box_"+p.field},...v],groupby:m}],layer:N});const Z=it(_,["tooltip"]),{scale:ae,axis:O}=p,L=nYe(p),W=rYe(u,"outliers",t.boxplot,!0,{transform:[{filter:`(${K} < ${q}) || (${K} > ${G})`}],mark:"point",encoding:Object.assign(Object.assign({[g]:Object.assign(Object.assign(Object.assign({field:p.field,type:p.type},L!==void 0?{title:L}:{}),ae!==void 0?{scale:ae}:{}),O!==void 0?{axis:O}:{})},Z),w?{tooltip:w}:{})})[0];W&&te?R={transform:[Y],layer:[W,te]}:W?(R=W,R.transform.unshift(Y)):te&&(R=te,R.transform.unshift(Y))}return R?Object.assign(Object.assign({},l),{layer:[R,{transform:d,layer:F}]}):Object.assign(Object.assign({},l),{transform:((r=l.transform)!==null&&r!==void 0?r:[]).concat(d),layer:F})}function lYe(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function kOn(e,t,n){const r=sYe(e,_B),{continuousAxisChannelDef:i,continuousAxis:s}=iYe(e,r,_B),a=i.field,o=aYe(t),l=[...lYe(a),{op:"median",field:a,as:"mid_box_"+a},{op:"min",field:a,as:(o==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:a,as:(o==="min-max"?"upper_whisker_":"max_")+a}],u=o==="min-max"||o==="tukey"?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:"iqr_"+a},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:"upper_whisker_"+a},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:"lower_whisker_"+a}],c=e.encoding,f=s;c[f];const h=it(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:d,filteredEncoding:p}=COn(h),{bins:g,timeUnits:m,aggregate:v,groupby:y,encoding:b}=Ffe(p,n),x=r==="vertical"?"horizontal":"vertical",w=r;return{transform:[...g,...m,{aggregate:[...v,...l],groupby:y},...u],groupby:y,aggregate:v,continuousAxisChannelDef:i,continuousAxis:s,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:d}}const Pfe="errorbar",EOn=["ticks","rule"],AOn=new TW(Pfe,uYe);function uYe(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:s,ticksOrient:a,markDef:o,outerSpec:l,tooltipEncoding:u}=cYe(e,Pfe,t),c=Rfe(o,i,r,s,t.errorbar),f={type:"tick",orient:a},h=[...c({partName:"ticks",mark:f,positionPrefix:"lower",aria:!1,extraEncoding:u}),...c({partName:"ticks",mark:f,positionPrefix:"upper",aria:!1,extraEncoding:u}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return Object.assign(Object.assign(Object.assign({},l),{transform:n}),h.length>1?{layer:h}:Object.assign({},h[0]))}function TOn(e,t){const{encoding:n}=e;if(DOn(n))return{orient:sYe(e,t),inputType:"raw"};const r=IOn(n),i=NOn(n),s=n.x,a=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const o=n.x2,l=n.y2;if(_t(o)&&_t(l))throw new Error(`${t} cannot have both x2 and y2`);if(_t(o)){if(eh(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(_t(l)){if(eh(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const o=n.xError,l=n.xError2,u=n.yError,c=n.yError2;if(_t(l)&&!_t(o))throw new Error(`${t} cannot have xError2 without xError`);if(_t(c)&&!_t(u))throw new Error(`${t} cannot have yError2 without yError`);if(_t(o)&&_t(u))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(_t(o)){if(eh(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(_t(u)){if(eh(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function DOn(e){return(_t(e.x)||_t(e.y))&&!_t(e.x2)&&!_t(e.y2)&&!_t(e.xError)&&!_t(e.xError2)&&!_t(e.yError)&&!_t(e.yError2)}function IOn(e){return _t(e.x2)||_t(e.y2)}function NOn(e){return _t(e.xError)||_t(e.xError2)||_t(e.yError)||_t(e.yError2)}function cYe(e,t,n){var r;const{mark:i,encoding:s,selection:a,projection:o}=e,l=it(e,["mark","encoding","selection","projection"]),u=Xh(i)?i:{type:i};a&&Te(nGe(t));const{orient:c,inputType:f}=TOn(e,t),{continuousAxisChannelDef:h,continuousAxisChannelDef2:d,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=iYe(e,c,t),{errorBarSpecificAggregate:v,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:x}=MOn(u,h,d,p,g,f,t,n),w=s,C=m;w[C];const $=m==="x"?"x2":"y2";w[$];const _=m==="x"?"xError":"yError";w[_];const k=m==="x"?"xError2":"yError2";w[k];const E=it(w,[typeof C=="symbol"?C:C+"",typeof $=="symbol"?$:$+"",typeof _=="symbol"?_:_+"",typeof k=="symbol"?k:k+""]),{bins:S,timeUnits:I,aggregate:A,groupby:D,encoding:T}=Ffe(E,n),N=[...A,...v],F=f!=="raw"?[]:D,R=xJ(b,h,T,x);return{transform:[...(r=l.transform)!==null&&r!==void 0?r:[],...S,...I,...N.length===0?[]:[{aggregate:N,groupby:F}],...y],groupby:F,continuousAxisChannelDef:h,continuousAxis:m,encodingWithoutContinuousAxis:T,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:l,tooltipEncoding:R}}function MOn(e,t,n,r,i,s,a,o){let l=[],u=[];const c=t.field;let f,h=!1;if(s==="raw"){const d=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":o.errorbar.center,p=e.extent?e.extent:d==="mean"?"stderr":"iqr";if(d==="median"!=(p==="iqr")&&Te(rFn(d,p,a)),p==="stderr"||p==="stdev")l=[{op:p,field:c,as:"extent_"+c},{op:d,field:c,as:"center_"+c}],u=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:"upper_"+c},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:"lower_"+c}],f=[{fieldPrefix:"center_",titlePrefix:_W(d)},{fieldPrefix:"upper_",titlePrefix:qCe(d,p,"+")},{fieldPrefix:"lower_",titlePrefix:qCe(d,p,"-")}],h=!0;else{e.center&&e.extent&&Te(sFn(e.extent,a));let g,m,v;p==="ci"?(g="mean",m="ci0",v="ci1"):(g="median",m="q1",v="q3"),l=[{op:m,field:c,as:"lower_"+c},{op:v,field:c,as:"upper_"+c},{op:g,field:c,as:"center_"+c}],f=[{fieldPrefix:"upper_",titlePrefix:yy({field:c,aggregate:v,type:"quantitative"},o,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:yy({field:c,aggregate:m,type:"quantitative"},o,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:yy({field:c,aggregate:g,type:"quantitative"},o,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&Te(nFn(e.center,e.extent)),s==="aggregated-upper-lower"?(f=[],u=[{calculate:`datum["${n.field}"]`,as:"upper_"+c},{calculate:`datum["${c}"]`,as:"lower_"+c}]):s==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:"upper_"+c}],i?u.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:"lower_"+c}):u.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:"lower_"+c}));for(const d of u)f.push({fieldPrefix:d.as.substring(0,6),titlePrefix:X$(X$(d.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:f,tooltipTitleWithFieldName:h}}function qCe(e,t,n){return _W(e)+" "+n+" "+t}const Lfe="errorband",FOn=["band","borders"],OOn=new TW(Lfe,fYe);function fYe(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:s,markDef:a,outerSpec:o,tooltipEncoding:l}=cYe(e,Lfe,t),u=a,c=Rfe(u,i,r,s,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let h={type:f?"area":"rect"},d={type:f?"line":"rule"};const p=Object.assign(Object.assign({},u.interpolate?{interpolate:u.interpolate}:{}),u.tension&&u.interpolate?{tension:u.tension}:{});return f?(h=Object.assign(Object.assign(Object.assign({},h),p),{ariaRoleDescription:"errorband"}),d=Object.assign(Object.assign({},d),p)):u.interpolate?Te(zCe("interpolate")):u.tension&&Te(zCe("tension")),Object.assign(Object.assign({},o),{transform:n,layer:[...c({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l}),...c({partName:"borders",mark:d,positionPrefix:"lower",aria:!1,extraEncoding:l}),...c({partName:"borders",mark:d,positionPrefix:"upper",aria:!1,extraEncoding:l})]})}const hYe={};function Bfe(e,t,n){const r=new TW(e,t);hYe[e]={normalizer:r,parts:n}}function ROn(){return Ne(hYe)}Bfe(_B,oYe,_On);Bfe(Pfe,uYe,EOn);Bfe(Lfe,fYe,FOn);const POn=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],dYe=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],LOn={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},BOn={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},zOn={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Q$="_vgsid_",UOn={single:{on:"click",fields:[Q$],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[Q$],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function zfe(e){return!!e&&(e==="legend"||!!e.legend)}function wG(e){return zfe(e)&&ds(e)}function WOn(e){return HW(e)||Wfe(e)||Ufe(e)}function Ufe(e){return"concat"in e}function HW(e){return"vconcat"in e}function Wfe(e){return"hconcat"in e}function Qh(e){return ds(e)&&e.step!==void 0}function GCe(e){return e.view||e.width||e.height}const YCe=20,VOn={align:1,bounds:1,center:1,columns:1,spacing:1},jOn=Ne(VOn);function HOn(e,t,n){var r,i;const s=n[t],a={},{spacing:o,columns:l}=s;o!==void 0&&(a.spacing=o),l!==void 0&&(UW(e)&&!gF(e.facet)||Ufe(e))&&(a.columns=l),HW(e)&&(a.columns=1);for(const u of jOn)if(e[u]!==void 0)if(u==="spacing"){const c=e[u];a[u]=yi(c)?c:{row:(r=c.row)!==null&&r!==void 0?r:o,column:(i=c.column)!==null&&i!==void 0?i:o}}else a[u]=e[u];return a}function wJ(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function SB(e,t){const n=OD(e,t);return Qh(n)?n.step:Vfe}function OD(e,t){var n;const r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return bi(r,{step:e.step})}const Vfe=20,qOn={continuousWidth:200,continuousHeight:200,step:Vfe},GOn={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:qOn,mark:RNn,arc:{},area:{},bar:LNn,circle:{},geoshape:{},image:{},line:{},point:{},rect:BNn,rule:{color:"black"},square:{},text:{color:"black"},tick:zNn,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:GFn,projection:{},legend:BOn,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:UOn,style:{},title:{},facet:{spacing:YCe},concat:{spacing:YCe}},Od=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],XCe={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},KCe={blue:Od[0],orange:Od[1],red:Od[2],teal:Od[3],green:Od[4],yellow:Od[5],purple:Od[6],pink:Od[7],brown:Od[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function YOn(e={}){return{signals:[{name:"color",value:ds(e)?Object.assign(Object.assign({},KCe),e):KCe}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function XOn(e){return{signals:[{name:"fontSize",value:ds(e)?Object.assign(Object.assign({},XCe),e):XCe}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function KOn(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function pYe(e={}){const{color:t,font:n,fontSize:r}=e,i=it(e,["color","font","fontSize"]);return Tqe({},GOn,n?KOn(n):{},t?YOn(t):{},r?XOn(r):{},i||{})}const ZOn=["view",...Wqe],QOn=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],JOn=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},ONn);function eRn(e){e=Gt(e);for(const t of QOn)delete e[t];if(e.axis)for(const t in e.axis)tfe(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of POn)delete e.legend[t];if(e.mark){for(const t of DCe)delete e.mark[t];e.mark.tooltip&&ds(e.mark.tooltip)&&delete e.mark.tooltip}for(const t of ZOn){for(const r of DCe)delete e[t][r];const n=JOn[t];if(n)for(const r of n)delete e[t][r];nRn(e,t)}for(const t of ROn())delete e[t];tRn(e);for(const t in e)ds(e[t])&&er(e[t])&&delete e[t];return er(e)?void 0:e}function tRn(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=GGe(e.title);er(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),er(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),er(r)?delete e.title:e.title=r}function nRn(e,t,n,r){const i=r?e[t][r]:e[t];t==="view"&&(n="cell");const s=Object.assign(Object.assign({},i),e.style[n!=null?n:t]);er(s)||(e.style[n!=null?n:t]=s),r||delete e[t]}function qW(e){return"layer"in e}function rRn(e){return"repeat"in e}function iRn(e){return!ut(e.repeat)&&e.repeat.layer}class gYe{map(t,n){return UW(t)?this.mapFacet(t,n):rRn(t)?this.mapRepeat(t,n):Wfe(t)?this.mapHConcat(t,n):HW(t)?this.mapVConcat(t,n):Ufe(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(qW(t))return this.mapLayer(t,n);if(mg(t))return this.mapUnit(t,n);throw new Error(cfe(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(r=>this.map(r,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(r=>this.map(r,n))})}mapConcat(t,n){const{concat:r}=t,i=it(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(s=>this.map(s,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const sRn={zero:1,center:1,normalize:1};function aRn(e){return e in sRn}const oRn=new Set([Bqe,kW,SW,vB,AW,rfe,ife,EW,zqe,nfe]),lRn=new Set([kW,SW,Bqe]);function ZCe(e,t){var n,r;const i=t==="x"?"y":"radius",s=e[t],a=e[i];if(Le(s)&&Le(a))if(Lg(s)==="quantitative"&&Lg(a)==="quantitative"){if(s.stack)return t;if(a.stack)return i;const o=Le(s)&&!!s.aggregate,l=Le(a)&&!!a.aggregate;if(o!==l)return o?t:i;{const u=(n=s.scale)===null||n===void 0?void 0:n.type,c=(r=a.scale)===null||r===void 0?void 0:r.type;if(u&&u!=="linear")return i;if(c&&c!=="linear")return t}}else{if(Lg(s)==="quantitative")return t;if(Lg(a)==="quantitative")return i}else{if(Lg(s)==="quantitative")return t;if(Lg(a)==="quantitative")return i}}function uRn(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function mYe(e,t,n={}){const r=Xh(e)?e.type:e;if(!oRn.has(r))return null;const i=ZCe(t,"x")||ZCe(t,"theta");if(!i)return null;const s=t[i],a=Le(s)?Me(s,{}):void 0;let o=uRn(i),l=t[o],u=Le(l)?Me(l,{}):void 0;u===a&&(u=void 0,l=void 0,o=void 0);const c=iMn.reduce((h,d)=>{if(d!=="tooltip"&&by(t,d)){const p=t[d];for(const g of ci(p)){const m=Zh(g);if(m.aggregate)continue;const v=Me(m,{});(!v||v!==u)&&h.push({channel:d,fieldDef:m})}}return h},[]);let f;if(s.stack!==void 0?uF(s.stack)?f=s.stack?"zero":null:f=s.stack:c.length>0&&lRn.has(r)&&(f="zero"),!f||!aRn(f)||Mfe(t)&&c.length===0)return null;if(s.scale&&s.scale.type&&s.scale.type!==fi.LINEAR){if(n.disallowNonLinearStack)return null;Te(JMn(s.scale.type))}return _t(t[_d(i)])?(s.stack!==void 0&&Te(QMn(i)),null):(Le(s)&&s.aggregate&&!ht(qNn,s.aggregate)&&Te(eFn(s.aggregate)),{groupbyChannel:l?o:void 0,groupbyField:u,fieldChannel:i,impute:s.impute===null?!1:Lx(r),stackBy:c,offset:f})}function cRn(e){const t=it(e,["point","line"]);return Ne(t).length>1?t:t.type}function fRn(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:$p(e[t],["point","line"])}));return e}function $G(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?ds(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?ds(t.point)?t.point:{}:void 0}function QCe(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class hRn{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(mg(t)){const{mark:r,encoding:i}=t,s=Xh(r)?r:{type:r};switch(s.type){case"line":case"rule":case"trail":return!!$G(s,n[s.type],i);case"area":return!!$G(s,n[s.type],i)||!!QCe(s,n[s.type])}}return!1}run(t,n,r){const{config:i}=n,{selection:s,projection:a,encoding:o,mark:l}=t,u=it(t,["selection","projection","encoding","mark"]),c=Xh(l)?l:{type:l},f=$G(c,i[c.type],o),h=c.type==="area"&&QCe(c,i[c.type]),d=[Object.assign(Object.assign({},s?{selection:s}:{}),{mark:cRn(Object.assign(Object.assign({},c.type==="area"&&c.opacity===void 0&&c.fillOpacity===void 0?{opacity:.7}:{}),c)),encoding:$p(o,["shape"])})],p=mYe(c,o);let g=o;if(p){const{fieldChannel:m,offset:v}=p;g=Object.assign(Object.assign({},o),{[m]:Object.assign(Object.assign({},o[m]),v?{stack:v}:{})})}return h&&d.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"line"},DD(c,["clip","interpolate","tension","tooltip"])),h),encoding:g})),f&&d.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},DD(c,["clip","tooltip"])),f),encoding:g})),r(Object.assign(Object.assign({},u),{layer:d}),Object.assign(Object.assign({},n),{config:fRn(i)}))}}class dRn{constructor(){this.name="RangeStep"}hasMatchingType(t){var n;if(mg(t)&&t.encoding)for(const r of Vu){const i=t.encoding[r];if(i&&_t(i)&&!((n=i==null?void 0:i.scale)===null||n===void 0)&&n.rangeStep)return!0}return!1}run(t){var n;const r={};let i=Object.assign({},t.encoding);for(const s of Vu){const a=Sd(s),o=i[s];if(o&&_t(o)&&!((n=o==null?void 0:o.scale)===null||n===void 0)&&n.rangeStep){const{scale:l}=o,u=it(o,["scale"]),c=l,f=it(c,["rangeStep"]);r[a]={step:l.rangeStep},Te(PMn),i=Object.assign(Object.assign({},i),{[s]:Object.assign(Object.assign({},u),er(f)?{}:{scale:f})})}}return Object.assign(Object.assign(Object.assign({},r),t),{encoding:i})}}function pRn(e,t){return t?gF(e)?yYe(e,t):vYe(e,t):e}function CG(e,t){return t?yYe(e,t):e}function $J(e,t,n){const r=t[e];if(lOn(r)){if(r.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[r.repeat]});Te(bMn(r.repeat));return}return t}function vYe(e,t){if(e=$J("field",e,t),e!==void 0){if(e===null)return null;if(RGe(e)&&bh(e.sort)){const n=$J("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function JCe(e,t){if(Le(e))return vYe(e,t);{const n=$J("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function e_e(e,t){if(_t(e)){const n=JCe(e,t);if(n)return n;if(Efe(e))return{condition:e.condition}}else{if(Afe(e)){const n=JCe(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):it(e,["condition"])}return e}}function yYe(e,t){const n={};for(const r in e)if(H1(e,r)){const i=e[r];if(ut(i))n[r]=i.map(s=>e_e(s,t)).filter(s=>s);else{const s=e_e(i,t);s!==void 0&&(n[r]=s)}}return n}class gRn{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(mg(t)){const{encoding:n,mark:r}=t;if(r==="line")for(const i of nMn){const s=Ux(i),a=n[s];if(n[i]&&(Le(a)&&!Ja(a.bin)||vv(a)))return!0}}return!1}run(t,n,r){const{encoding:i}=t;return Te(OMn(!!i.x2,!!i.y2)),r(Object.assign(Object.assign({},t),{mark:"rule"}),n)}}class mRn extends gYe{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[SOn,AOn,OOn,new hRn,new gRn,new dRn]}map(t,n){if(mg(t)){const r=by(t.encoding,Cp),i=by(t.encoding,_p),s=by(t.encoding,DW);if(r||i||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,s=Object.assign(Object.assign({},t),{encoding:CG(t.encoding,n.repeater)});if(r||i)return this.mapUnitWithParentEncodingOrProjection(s,n);const a=this.mapLayerOrUnit.bind(this);for(const o of this.nonFacetUnitNormalizers)if(o.hasMatchingType(s,n.config))return o.run(s,n,a);return s}mapRepeat(t,n){return iRn(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i}=t,s=it(t,["repeat","spec"]),{row:a,column:o,layer:l}=r,{repeater:u={},repeaterPrefix:c=""}=n;return a||o?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},a?{row:a}:{}),o?{column:o}:{}),spec:{repeat:{layer:l},spec:i}}),n):Object.assign(Object.assign({},s),{layer:l.map(f=>{const h=Object.assign(Object.assign({},u),{layer:f}),d=(i.name||"")+c+`child__layer_${Er(f)}`,p=this.mapLayerOrUnit(i,Object.assign(Object.assign({},n),{repeater:h,repeaterPrefix:d}));return p.name=d,p})})}mapNonLayerRepeat(t,n){var r;const{repeat:i,spec:s,data:a}=t,o=it(t,["repeat","spec","data"]);!ut(i)&&t.columns&&(t=$p(t,["columns"]),Te(RCe("repeat")));const l=[],{repeater:u={},repeaterPrefix:c=""}=n,f=!ut(i)&&i.row||[u?u.row:null],h=!ut(i)&&i.column||[u?u.column:null],d=ut(i)&&i||[u?u.repeat:null];for(const g of d)for(const m of f)for(const v of h){const y={repeat:g,row:m,column:v,layer:u.layer},b=(s.name||"")+c+"child__"+(ut(i)?`${Er(g)}`:(i.row?`row_${Er(m)}`:"")+(i.column?`column_${Er(v)}`:"")),x=this.map(s,Object.assign(Object.assign({},n),{repeater:y,repeaterPrefix:b}));x.name=b,l.push($p(x,["data"]))}const p=ut(i)?t.columns:i.column?i.column.length:1;return Object.assign(Object.assign({data:(r=s.data)!==null&&r!==void 0?r:a,align:"all"},o),{columns:p,concat:l})}mapFacet(t,n){const{facet:r}=t;return gF(r)&&t.columns&&(t=$p(t,["columns"]),Te(RCe("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:s,parentProjection:a,config:o}=n,l=n_e({parentProjection:a,projection:i}),u=t_e({parentEncoding:s,encoding:CG(r,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),l?{projection:l}:{}),u?{encoding:u}:{}),{config:o})}mapFacetedUnit(t,n){const r=t.encoding,{row:i,column:s,facet:a}=r,o=it(r,["row","column","facet"]),{mark:l,width:u,projection:c,height:f,view:h,selection:d,encoding:p}=t,g=it(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:m,layout:v}=this.getFacetMappingAndLayout({row:i,column:s,facet:a},n),y=CG(o,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),v),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{width:u}:{}),f?{height:f}:{}),h?{view:h}:{}),c?{projection:c}:{}),{mark:l,encoding:y}),d?{selection:d}:{})}),n)}getFacetMappingAndLayout(t,n){var r;const{row:i,column:s,facet:a}=t;if(i||s){a&&Te(FMn([...i?[Cp]:[],...s?[_p]:[]]));const o={},l={};for(const u of[Cp,_p]){const c=t[u];if(c){const f=it(c,["align","center","spacing","columns"]);o[u]=f;for(const h of["align","center","spacing"])c[h]!==void 0&&(l[h]=(r=l[h])!==null&&r!==void 0?r:{},l[h][u]=c[h])}}return{facetMapping:o,layout:l}}else{const{align:o,center:l,spacing:u,columns:c}=a,f=it(a,["align","center","spacing","columns"]);return{facetMapping:pRn(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},o?{align:o}:{}),l?{center:l}:{}),u?{spacing:u}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:r,parentProjection:i}=n,s=it(n,["parentEncoding","parentProjection"]);const{encoding:a,projection:o}=t,l=it(t,["encoding","projection"]),u=Object.assign(Object.assign({},s),{parentEncoding:t_e({parentEncoding:r,encoding:a}),parentProjection:n_e({parentProjection:i,projection:o})});return super.mapLayer(l,u)}}function t_e(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const i=Ne(t).reduce((s,a)=>(n[a]&&s.push(a),s),[]);i.length>0&&Te(_Mn(i))}const r=Object.assign(Object.assign({},t!=null?t:{}),n!=null?n:{});return er(r)?void 0:r}function n_e(e){const{parentProjection:t,projection:n}=e;return t&&n&&Te(SMn({parentProjection:t,projection:n})),n!=null?n:t}function bYe(e,t){t===void 0&&(t=pYe(e.config));const n=yRn(e,t),{width:r,height:i}=e,s=bRn(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),s?{autosize:s}:{})}const vRn=new mRn;function yRn(e,t={}){return vRn.map(e,{config:t})}function r_e(e){return qt(e)?{type:e}:e!=null?e:{}}function bRn(e,t,n){let{width:r,height:i}=t;const s=mg(e)||qW(e),a={};s?r=="container"&&i=="container"?(a.type="fit",a.contains="padding"):r=="container"?(a.type="fit-x",a.contains="padding"):i=="container"&&(a.type="fit-y",a.contains="padding"):(r=="container"&&(Te(NCe("width")),r=void 0),i=="container"&&(Te(NCe("height")),i=void 0));const o=Object.assign(Object.assign(Object.assign({type:"pad"},a),n?r_e(n.autosize):{}),r_e(e.autosize));if(o.type==="fit"&&!s&&(Te(hMn),o.type="pad"),r=="container"&&!(o.type=="fit"||o.type=="fit-x")&&Te(MCe("width")),i=="container"&&!(o.type=="fit"||o.type=="fit-y")&&Te(MCe("height")),!cF(o,{type:"pad"}))return o}function xRn(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function wRn(e){return e?`fit-${OW(e)}`:"fit"}const $Rn=["background","padding"];function i_e(e){return $Rn.reduce((t,n)=>(e&&e[n]!==void 0&&(t[n]=e[n]),t),{})}class wg{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new wg(Gt(this.explicit),Gt(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return bi(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,n){n.value!==void 0&&this.set(t,n.value,n.explicit)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,n){n.explicit[t]!==void 0?this.set(t,n.explicit[t],!0):n.implicit[t]!==void 0&&this.set(t,n.implicit[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of Ne(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function q1(e){return{explicit:!0,value:e}}function xl(e){return{explicit:!1,value:e}}function xYe(e){return(t,n,r,i)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:GW(t,n,r,i)}}function GW(e,t,n,r){return e.explicit&&t.explicit&&Te(HMn(n,r,e.value,t.value)),e}function Am(e,t,n,r,i=GW){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:cF(e.value,t.value)?e:i(e,t,n,r)}class CRn extends wg{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function RD(e){return"url"in e}function kB(e){return"values"in e}function wYe(e){return"name"in e&&!RD(e)&&!kB(e)&&!xy(e)}function xy(e){return e&&($Ye(e)||CYe(e)||jfe(e))}function $Ye(e){return"sequence"in e}function CYe(e){return"sphere"in e}function jfe(e){return"graticule"in e}const fa="main",EB="raw";function _Ye(e){return"filter"in e}function _Rn(e){return(e==null?void 0:e.stop)!==void 0}function SRn(e){return"lookup"in e}function kRn(e){return"data"in e}function ERn(e){return"selection"in e}function ARn(e){return"pivot"in e}function TRn(e){return"density"in e}function DRn(e){return"quantile"in e}function IRn(e){return"regression"in e}function NRn(e){return"loess"in e}function MRn(e){return"sample"in e}function FRn(e){return"window"in e}function ORn(e){return"joinaggregate"in e}function RRn(e){return"flatten"in e}function PRn(e){return"calculate"in e}function LRn(e){return"bin"in e}function BRn(e){return"impute"in e}function zRn(e){return"timeUnit"in e}function URn(e){return"aggregate"in e}function WRn(e){return"stack"in e}function VRn(e){return"fold"in e}function jRn(e){return e.map(t=>_Ye(t)?{filter:G4(t.filter,IFn)}:t)}function yF(e,t,n,r){const i=Efe(t)&&t.condition,s=r(t);if(i){const o=ci(i).map(l=>{const u=r(l),c=oOn(l)?KYe(e,l.selection):IB(e,l.test);return Object.assign({test:c},u)});return{[n]:[...o,...s!==void 0?[s]:[]]}}else return s!==void 0?{[n]:s}:{}}function Hfe(e,t="text"){const n=e.encoding[t];return yF(e,n,t,r=>YW(r,e.config))}function YW(e,t,n="datum"){if(e){if(Yp(e))return ai(e.value);if(_t(e)){const{format:r,formatType:i}=wB(e);return Cfe({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function SYe(e,t={}){const{encoding:n,markDef:r,config:i,stack:s}=e,a=n.tooltip;if(ut(a))return{tooltip:s_e({tooltip:a},s,i,t)};{const o=t.reactiveGeom?"datum.datum":"datum";return yF(e,a,"tooltip",l=>{const u=YW(l,i,o);if(u)return u;if(l===null)return;let c=Ln("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),qt(c))return{value:c};if(ds(c))return c.content==="encoding"?s_e(n,s,i,t):{signal:o}})}}function kYe(e,t,n,{reactiveGeom:r}={}){const i={},s=r?"datum.datum":"datum",a=[];function o(u,c){const f=Ux(c),h=Kl(u)?u:Object.assign(Object.assign({},u),{type:e[f].type}),d=ci(yy(h,n,{allowDisabling:!1})).join(", ");let p;if(Kh(c)){const g=c==="x"?"x2":"y2",m=Zh(e[g]);if(Ja(h.bin)&&m){const v=Me(h,{expr:s}),y=Me(m,{expr:s}),{format:b,formatType:x}=wB(h);p=BW(v,y,b,x,n),i[g]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:y}=wB(h);p=Cfe({fieldOrDatumDef:h,format:v,formatType:y,expr:s,config:n,normalizeStack:!0}).signal}}p=p!=null?p:YW(h,n,s).signal,a.push({channel:c,key:d,value:p})}Ofe(e,(u,c)=>{Le(u)?o(u,c):WW(u)&&o(u.condition,c)});const l={};for(const{channel:u,key:c,value:f}of a)!i[u]&&!l[c]&&(l[an(c)]=f);return l}function s_e(e,t,n,{reactiveGeom:r}={}){const i=kYe(e,t,n,{reactiveGeom:r}),s=Fqe(i).map(({key:a,value:o})=>`${a}: ${o}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function HRn(e){const{markDef:t,config:n}=e,r=Ln("aria",t,n);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),qRn(e)),GRn(e))}function qRn(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=Ln("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in EFn?{}:{ariaRoleDescription:{value:t}}}function GRn(e){const{encoding:t,markDef:n,config:r,stack:i}=e,s=t.description;if(s)return yF(e,s,"description",l=>YW(l,e.config));const a=Ln("description",n,r);if(a!=null)return{description:ai(a)};if(r.aria===!1)return{};const o=kYe(t,i,r);if(!er(o))return{description:{signal:Fqe(o).map(({key:l,value:u})=>`${l} + ": " + (${u})`).join(' + "; " + ')}}}function Ji(e,t,n={}){const{markDef:r,encoding:i,config:s}=t,{vgChannel:a}=n;let{defaultRef:o,defaultValue:l}=n;o===void 0&&(l=l!=null?l:Ln(e,r,s,{vgChannel:a,ignoreVgConfig:!0}),l!==void 0&&(o=ai(l)));const u=i[e];return yF(t,u,a!=null?a:e,c=>EGe({channel:e,channelDef:c,markDef:r,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:o}))}function EYe(e,t={filled:void 0}){var n,r,i,s;const{markDef:a,encoding:o,config:l}=e,{type:u}=a,c=(n=t.filled)!==null&&n!==void 0?n:Ln("filled",a,l),f=ht(["bar","point","circle","square","geoshape"],u)?"transparent":void 0,h=(i=(r=Ln(c===!0?"color":void 0,a,l,{vgChannel:"fill"}))!==null&&r!==void 0?r:l.mark[c===!0&&"color"])!==null&&i!==void 0?i:f,d=(s=Ln(c===!1?"color":void 0,a,l,{vgChannel:"stroke"}))!==null&&s!==void 0?s:l.mark[c===!1&&"color"],p=c?"fill":"stroke",g=Object.assign(Object.assign({},h?{fill:ai(h)}:{}),d?{stroke:ai(d)}:{});return a.color&&(c?a.fill:a.stroke)&&Te(iGe("property",{fill:"fill"in a,stroke:"stroke"in a})),Object.assign(Object.assign(Object.assign(Object.assign({},g),Ji("color",e,{vgChannel:p,defaultValue:c?h:d})),Ji("fill",e,{defaultValue:o.fill?h:void 0})),Ji("stroke",e,{defaultValue:o.stroke?d:void 0}))}function PD(e,t){const n=rMn(e),r=t[n];if(r)return r}function va(e,t,{defaultPos:n,vgChannel:r,isMidPoint:i}){const{encoding:s,markDef:a,config:o,stack:l}=t,u=s[e],c=s[_d(e)],f=t.scaleName(e),h=t.getScaleComponent(e),d=PD(e,a),p=qfe({model:t,defaultPos:n,channel:e,scaleName:f,scale:h}),g=!u&&Kh(e)&&(s.latitude||s.longitude)?{field:t.getName(e)}:YRn({channel:e,channelDef:u,channel2Def:c,markDef:a,config:o,isMidPoint:i,scaleName:f,scale:h,stack:l,offset:d,defaultRef:p});return g?{[r||e]:g}:void 0}function YRn(e){const{channel:t,channelDef:n,isMidPoint:r,scaleName:i,stack:s,offset:a,markDef:o,config:l}=e;if(_t(n)&&s&&t===s.fieldChannel){if(Le(n)){const u=mF({channel:t,fieldDef:n,isMidPoint:r,markDef:o,stack:s,config:l});if(u!==void 0)return xB({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:u,offset:a})}return vy(n,i,{suffix:"end"},{offset:a})}return wfe(e)}function qfe({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:s,config:a}=e;return()=>{const o=Ux(n),l=Em(n),u=Ln(n,s,a,{vgChannel:l});if(u!==void 0)return BA(n,u);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!ht([fi.LOG,fi.TIME,fi.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return o==="y"?{field:{group:"height"}}:{value:0};switch(o){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Sd(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const XRn={left:"x",center:"xc",right:"x2"},KRn={top:"y",middle:"yc",bottom:"y2"};function AYe(e,t,n,r="middle"){if(e==="radius"||e==="theta")return Em(e);const s=Ln(e==="x"?"align":"baseline",t,n);return e==="x"?XRn[s||(r==="top"?"left":"center")]:KRn[s||r]}function AB(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?TYe(e,t,{defaultPos:n,defaultPos2:r}):va(e,t,{defaultPos:n})}function TYe(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:s}=t,a=_d(e),o=Sd(e),l=ZRn(t,r,a),u=l[o]?AYe(e,i,s):Em(e);return Object.assign(Object.assign({},va(e,t,{defaultPos:n,vgChannel:u})),l)}function ZRn(e,t,n){const{encoding:r,mark:i,markDef:s,stack:a,config:o}=e,l=Ux(n),u=Sd(n),c=Em(n),f=r[l],h=e.scaleName(l),d=e.getScaleComponent(l),p=n in r||n in s?PD(n,e.markDef):PD(l,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude))return{[c]:{field:e.getName(n)}};const g=QRn({channel:n,channelDef:f,channel2Def:r[n],markDef:s,config:o,scaleName:h,scale:d,stack:a,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:DR(n,s)||DR(n,{[n]:CB(n,s,o.style),[u]:CB(u,s,o.style)})||DR(n,o[i])||DR(n,o.mark)||{[c]:qfe({model:e,defaultPos:t,channel:n,scaleName:h,scale:d})()}}function QRn({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:s,scale:a,stack:o,offset:l,defaultRef:u}){return _t(t)&&o&&e.charAt(0)===o.fieldChannel.charAt(0)?vy(t,s,{suffix:"start"},{offset:l}):wfe({channel:e,channelDef:n,scaleName:s,scale:a,stack:o,markDef:r,config:i,offset:l,defaultRef:u})}function DR(e,t){const n=Sd(e),r=Em(e);if(t[r]!==void 0)return{[r]:BA(e,t[r])};if(t[e]!==void 0)return{[r]:BA(e,t[e])};if(t[n])return{[n]:BA(e,t[n])}}function Tm(e,t,n){var r,i,s,a;const{config:o,encoding:l,markDef:u,stack:c}=e,f=_d(t),h=Sd(t),d=l[t],p=l[f],g=e.getScaleComponent(t),m=g?g.get("type"):void 0,v=e.scaleName(t),y=u.orient,b=(i=(r=l[h])!==null&&r!==void 0?r:l.size)!==null&&i!==void 0?i:Ln("size",u,o,{vgChannel:h}),x=n==="bar"&&(t==="x"?y==="vertical":y==="horizontal");if(Le(d)&&(hr(d.bin)||Ja(d.bin)||d.timeUnit&&!p)&&!b&&!pl(m)){const w=mF({channel:t,fieldDef:d,stack:c,markDef:u,config:o}),C=(s=e.component.axes[t])===null||s===void 0?void 0:s[0],$=(a=C==null?void 0:C.get("translate"))!==null&&a!==void 0?a:.5;return t4n({fieldDef:d,fieldDef2:p,channel:t,markDef:u,scaleName:v,band:w,axisTranslate:$,spacing:Kh(t)?Ln("binSpacing",u,o):void 0,reverse:g.get("reverse"),config:o})}else return(_t(d)&&pl(m)||x)&&!p?e4n(n,d,t,e):TYe(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function JRn(e,t,n,r,i,s){if(r){const l=r.get("type");if(l==="point"||l==="band"){if(i[e].discreteBandSize!==void 0)return{value:i[e].discreteBandSize};if(l===fi.POINT){const u=r.get("range");return mv(u)&&yi(u.step)?{value:u.step-2}:{value:Vfe-2}}else return{scale:n,band:s}}else return{value:i[e].continuousBandSize}}const a=SB(i.view,t),o=bi(i[e].discreteBandSize,a-2);return o!==void 0?{value:o}:void 0}function e4n(e,t,n,r){var i;const{markDef:s,encoding:a,config:o,stack:l}=r,u=s.orient,c=r.scaleName(n),f=r.getScaleComponent(n),h=Sd(n),d=_d(n),p=u==="horizontal"&&n==="y"||u==="vertical"&&n==="x",g=Ln(p?"size":h,s,o,{vgChannel:h});let m;(a.size||g!==void 0)&&(p?m=Ji("size",r,{vgChannel:h,defaultValue:g}):Te(WMn(s.type)));const v=(i=_t(t)?mF({channel:n,fieldDef:t,markDef:s,stack:l,config:o}):void 0)!==null&&i!==void 0?i:1;m=m||{[h]:JRn(e,h,c,f,o,v)};const y=(f==null?void 0:f.get("type"))!=="band"||!("band"in m[h]),b=AYe(n,s,o,y?"middle":"top"),x=PD(n,s),w=wfe({channel:n,channelDef:t,markDef:s,config:o,scaleName:c,scale:f,stack:l,offset:x,defaultRef:qfe({model:r,defaultPos:"mid",channel:n,scaleName:c,scale:f}),band:y?.5:(1-v)/2});if(h)return Object.assign({[b]:w},m);{const C=Em(d),$=m[h],_=x?Object.assign(Object.assign({},$),{offset:x}):$;return{[b]:w,[C]:ut(w)?[w[0],Object.assign(Object.assign({},w[1]),{offset:_})]:Object.assign(Object.assign({},w),{offset:_})}}}function jk(e,t,n,r,i){if(qqe(e))return 0;const s=e==="x"||e==="y2"?-t/2:t/2;if(wt(n)){const a=FD(i);return{signal:`${n.signal} ? ${r-s}${a?"-"+a:""} : ${r+s}${a?"+"+a:""}`}}else{if(wt(i)){const a=r+(n?-s:s);return{signal:`${a||""}${n?" - ":a?" + ":""}${i.signal}`}}return i=i||0,r+(n?-i-s:+i+s)}}function t4n({fieldDef:e,fieldDef2:t,channel:n,band:r,scaleName:i,markDef:s,spacing:a=0,axisTranslate:o,reverse:l,config:u}){const c=_d(n),f=Em(n),h=Em(c),d=PD(n,s);if(hr(e.bin)||e.timeUnit)return{[h]:a_e({channel:n,fieldDef:e,scaleName:i,markDef:s,band:(1-r)/2,offset:jk(c,a,l,o,d),config:u}),[f]:a_e({channel:n,fieldDef:e,scaleName:i,markDef:s,band:1-(1-r)/2,offset:jk(n,a,l,o,d),config:u})};if(Ja(e.bin)){const p=vy(e,i,{},{offset:jk(c,a,l,o,d)});if(Le(t))return{[h]:p,[f]:vy(t,i,{},{offset:jk(n,a,l,o,d)})};if(pF(e.bin)&&e.bin.step)return{[h]:p,[f]:{signal:`scale("${i}", ${Me(e,{expr:"datum"})} + ${e.bin.step})`,offset:jk(n,a,l,o,d)}}}Te(oGe(c))}function a_e({channel:e,fieldDef:t,scaleName:n,markDef:r,band:i,offset:s,config:a}){const o=xB({scaleName:n,fieldOrDatumDef:t,band:i,offset:s});return kGe({fieldDef:t,channel:e,markDef:r,ref:o,config:a})}const n4n=new Set(["aria"]);function Ku(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?EYe(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},r4n(e.markDef,t)),o_e(e,"fill",n)),o_e(e,"stroke",r)),Ji("opacity",e)),Ji("fillOpacity",e)),Ji("strokeOpacity",e)),Ji("strokeWidth",e)),Ji("strokeDash",e)),SYe(e)),Hfe(e,"href")),HRn(e))}function o_e(e,t,n){const{config:r,mark:i,markDef:s}=e;if(Ln("invalid",s,r)==="hide"&&n&&!Lx(i)){const o=i4n(e,{invalid:!0,channels:RW});if(o)return{[t]:[{test:o,value:null},...ci(n)]}}return n?{[t]:n}:{}}function r4n(e,t){return kFn.reduce((n,r)=>(!n4n.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=ai(e[r])),n),{})}function i4n(e,{invalid:t=!1,channels:n}){const r=n.reduce((s,a)=>{const o=e.getScaleComponent(a);if(o){const l=o.get("type"),u=e.vgField(a,{expr:"datum"});u&&ju(l)&&(s[u]=!0)}return s},{}),i=Ne(r);if(i.length>0){const s=t?"||":"&&";return i.map(a=>$fe(a,t)).join(` ${s} `)}}function Gfe(e){const{config:t,markDef:n}=e;if(Ln("invalid",n,t)){const i=s4n(e,{channels:Vu});if(i)return{defined:{signal:i}}}return{}}function s4n(e,{invalid:t=!1,channels:n}){const r=n.reduce((s,a)=>{const o=e.getScaleComponent(a);if(o){const l=o.get("type"),u=e.vgField(a,{expr:"datum"});u&&ju(l)&&(s[u]=!0)}return s},{}),i=Ne(r);if(i.length>0){const s=t?"||":"&&";return i.map(a=>$fe(a,t)).join(` ${s} `)}}function l_e(e,t){if(t!==void 0)return{[e]:ai(t)}}const _G="voronoi",DYe={has:e=>e.type!=="interval"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(_G)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,s=e.mark;if(Lx(s))return Te(pMn(s)),n;const a={name:e.getName(_G),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},SYe(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let o=0,l=!1;return n.forEach((u,c)=>{var f;const h=(f=u.name)!==null&&f!==void 0?f:"";h===e.component.mark[0].name?o=c:h.indexOf(_G)>=0&&(l=!0)}),l||n.splice(o+1,0,a),n}};class Kn{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.indexOf(t)>-1){console.warn("Attempt to add the same child twice.");return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class co extends Kn{constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${CNn()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class xh extends Kn{constructor(t,n){super(t),this.formula=n}clone(){return new xh(null,Gt(this.formula))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,s,a)=>{const{field:o,timeUnit:l}=s,u=qr(n)?n.encoding[_d(a)]:void 0,c=qr(n)&&kfe(a,s,u,n.stack,n.markDef,n.config);if(l){const f=Me(s,{forAs:!0});i[pn({as:f,field:o,timeUnit:l})]=Object.assign({as:f,field:o,timeUnit:l},c?{band:!0}:{})}return i},{});return er(r)?null:new xh(t,r)}static makeFromTransform(t,n){const r=Object.assign({},n),{timeUnit:i}=r,s=it(r,["timeUnit"]),a=wo(i),o=Object.assign(Object.assign({},s),{timeUnit:a});return new xh(t,{[pn(o)]:o})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)(!this.formula[n]||t.formula[n].band)&&(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(k0(this.formula).map(t=>t.as))}dependentFields(){return new Set(k0(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${pn(this.formula)}`}assemble(){const t=[];for(const n of k0(this.formula)){const{field:r,as:i,timeUnit:s}=n,a=wo(s),{unit:o,utc:l}=a,u=it(a,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Sm(r),type:"timeunit"},o?{units:pfe(o)}:{}),l?{timezone:"utc"}:{}),u),{as:[i,`${i}_end`]}))}return t}}const bF="_tuple_fields";class a4n{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const o4n={has:()=>!0,parse:(e,t,n)=>{var r,i,s;const a=t.name,o=(r=t.project)!==null&&r!==void 0?r:t.project=new a4n,l={},u={},c=new Set,f=(h,d)=>{const p=d==="visual"?h.channel:h.field;let g=Er(`${a}_${p}`);for(let m=1;c.has(g);m++)g=Er(`${a}_${p}_${m}`);return c.add(g),{[d]:g}};if(!n.fields&&!n.encodings){const h=e.config.selection[n.type];if(n.init)for(const d of ci(n.init))for(const p of Ne(d))tMn(p)?(n.encodings||(n.encodings=[])).push(p):n.type==="interval"?(Te('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=h.encodings):(n.fields||(n.fields=[])).push(p);else n.encodings=h.encodings,n.fields=h.fields}for(const h of(i=n.fields)!==null&&i!==void 0?i:[]){const d={type:"E",field:h};d.signals=Object.assign({},f(d,"data")),o.items.push(d),o.hasField[h]=d}for(const h of(s=n.encodings)!==null&&s!==void 0?s:[]){const d=e.fieldDef(h);if(d){let p=d.field;if(d.aggregate){Te(dMn(h,d.aggregate));continue}else if(!p){Te(OCe(h));continue}if(d.timeUnit){p=e.vgField(h);const g={timeUnit:d.timeUnit,as:p,field:d.field};u[pn(g)]=g}if(!l[p]){let g="E";if(t.type==="interval"){const v=e.getScaleComponent(h).get("type");ju(v)&&(g="R")}else d.bin&&(g="R-RE");const m={field:p,channel:h,type:g};m.signals=Object.assign(Object.assign({},f(m,"data")),f(m,"visual")),o.items.push(l[p]=m),o.hasField[p]=o.hasChannel[h]=l[p]}}else Te(OCe(h))}if(n.init){const h=d=>o.items.map(p=>d[p.channel]!==void 0?d[p.channel]:d[p.field]);if(n.type==="interval")t.init=h(n.init);else{const d=ci(n.init);t.init=d.map(h)}}er(u)||(o.timeUnit=new xh(null,u))},signals:(e,t,n)=>{const r=t.name+bF;return n.filter(s=>s.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(s=>{const a=it(s,["signals","hasLegend"]);return a.field=Sm(a.field),a})})}},IYe={has:e=>e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!zfe(e.bind),parse:(e,t,n,r)=>{r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,s=t.bind,a=t.init&&t.init[0],o=DYe.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((l,u)=>{var c,f;const h=Er(`${r}_${l.field}`);n.filter(p=>p.name===h).length||n.unshift(Object.assign(Object.assign({name:h},a?{init:J$(a[u])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${o}[${an(l.field)}] : null`}]:[],bind:(f=(c=s[l.field])!==null&&c!==void 0?c:s[l.channel])!==null&&f!==void 0?f:s}))}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,s=n.filter(u=>u.name===r+Jh)[0],a=r+bF,o=i.items.map(u=>Er(`${r}_${u.field}`)),l=o.map(u=>`${u} !== null`).join(" && ");return o.length&&(s.update=`${l} ? {fields: ${a}, values: [${o.join(", ")}]} : null`),delete s.value,delete s.on,n}},TB="_toggle",NYe={has:e=>e.type==="multi"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+TB,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Jh,r=t.name+TB;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${Sp(e)}}, `)+`${r} ? ${n} : null`}},l4n={has:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t,n)=>{n.clear&&(t.clear=qt(n.clear)?Ox(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if(IYe.has(t))for(const r of t.project.items){const i=n.findIndex(s=>s.name===Er(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,s){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:s})}if(t.type==="interval")for(const i of t.project.items){const s=n.findIndex(a=>a.name===i.signals.visual);if(r(s,"[0, 0]"),s===-1){const a=n.findIndex(o=>o.name===i.signals.data);r(a,"null")}}else{let i=n.findIndex(s=>s.name===t.name+Jh);r(i,"null"),NYe.has(t)&&(i=n.findIndex(s=>s.name===t.name+TB),r(i,"false"))}return n}},Dm={has:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!gv(i))continue;const s=e.getScaleComponent(i),a=s?s.get("type"):void 0;if(!s||!ju(a)){Te(mMn);continue}const o={selection:t.name,field:r.field};s.set("selectionExtent",o,!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(a=>n.filter(o=>o.name===a.signals.data).length===0);if(!e.parent||_J(e)||r.length===0)return n;const i=n.filter(a=>a.name===t.name)[0];let s=i.update;if(s.indexOf(UYe)>=0)i.update=`{${r.map(a=>`${an(a.field)}: ${a.signals.data}`).join(", ")}}`;else{for(const a of r){const o=`${an(a.field)}: ${a.signals.data}`;s.indexOf(o)<0&&(s=`${s.substring(0,s.length-1)}, ${o}}`)}i.update=s}return n.concat(r.map(a=>({name:a.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!_J(e))for(const r of t.scales){const i=n.filter(s=>s.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function CJ(e,t){return`domain(${an(e.scaleName(t))})`}function _J(e){var t;return e.parent&&AS(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:_J(e.parent.parent))}const MYe={has:e=>{const t=e.resolve==="global"&&e.bind&&zfe(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Q$;return t&&!n&&Te(vMn),t&&n},parse:(e,t,n,r)=>{var i;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){const o='event.item && indexof(event.item.mark.role, "legend") < 0';for(const l of t.events)l.filter=ci((i=l.filter)!==null&&i!==void 0?i:[]),l.filter.indexOf(o)<0&&l.filter.push(o)}const s=wG(t.bind)?t.bind.legend:"click",a=qt(s)?Ox(s,"view"):ci(s);t.bind={legend:{merge:a}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=wG(t.bind)&&t.bind.legend,s=a=>o=>{const l=Gt(o);return l.markname=a,l};for(const a of t.project.items){if(!a.hasLegend)continue;const o=`${Er(a.field)}_legend`,l=`${r}_${o}`;if(n.filter(c=>c.name===l).length===0){const c=i.merge.map(s(`${o}_symbols`)).concat(i.merge.map(s(`${o}_labels`))).concat(i.merge.map(s(`${o}_entries`)));n.unshift(Object.assign(Object.assign({name:l},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${l}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,s=n.find(h=>h.name===r+Jh),a=r+bF,o=i.items.filter(h=>h.hasLegend).map(h=>Er(`${r}_${Er(h.field)}_legend`)),u=`${o.map(h=>`${h} !== null`).join(" && ")} ? {fields: ${a}, values: [${o.join(", ")}]} : null`;t.events&&o.length>0?s.on.push({events:o.map(h=>({signal:h})),update:u}):o.length>0&&(s.update=u,delete s.value,delete s.on);const c=n.find(h=>h.name===r+TB),f=wG(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function u4n(e,t,n){var r;const i=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;Wx(e,s=>{var a,o;const l=(a=s.project.hasField[i])!==null&&a!==void 0?a:s.project.hasChannel[t];if(l&&MYe.has(s)){const u=(o=n.get("selections"))!==null&&o!==void 0?o:[];u.push(s.name),n.set("selections",u,!1),l.hasLegend=!0}})}const FYe="_translate_anchor",OYe="_translate_delta",c4n={has:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=Dm.has(t),s=r+FYe,{x:a,y:o}=t.project.hasChannel;let l=Ox(t.translate,"scope");return i||(l=l.map(u=>(u.between[0].markname=r+zA,u))),n.push({name:s,value:{},on:[{events:l.map(u=>u.between[0]),update:"{x: x(unit), y: y(unit)"+(a!==void 0?", extent_x: "+(i?CJ(e,Ur):`slice(${a.signals.visual})`):"")+(o!==void 0?", extent_y: "+(i?CJ(e,Ni):`slice(${o.signals.visual})`):"")+"}"}]},{name:r+OYe,value:{},on:[{events:l,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),a!==void 0&&u_e(e,t,a,"width",n),o!==void 0&&u_e(e,t,o,"height",n),n}};function u_e(e,t,n,r,i){var s;const a=t.name,o=a+FYe,l=a+OYe,u=n.channel,c=Dm.has(t),f=i.filter(x=>x.name===n.signals[c?"data":"visual"])[0],h=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(u),p=d.get("type"),g=c&&u===Ur?"-":"",m=`${o}.extent_${u}`,v=`${g}${l}.${u} / `+(c?`${h}`:`span(${m})`),b=`${c?p==="log"?"panLog":p==="pow"?"panPow":"panLinear":"panLinear"}(${m}, ${v}`+(c&&p==="pow"?`, ${(s=d.get("exponent"))!==null&&s!==void 0?s:1}`:"")+")";f.on.push({events:{signal:l},update:c?b:`clampRange(${b}, 0, ${h})`})}const RYe="_zoom_anchor",PYe="_zoom_delta",f4n={has:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=Dm.has(t),s=r+PYe,{x:a,y:o}=t.project.hasChannel,l=an(e.scaleName(Ur)),u=an(e.scaleName(Ni));let c=Ox(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+zA,f))),n.push({name:r+RYe,on:[{events:c,update:i?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),a!==void 0&&c_e(e,t,a,"width",n),o!==void 0&&c_e(e,t,o,"height",n),n}};function c_e(e,t,n,r,i){var s;const a=t.name,o=n.channel,l=Dm.has(t),u=i.filter(y=>y.name===n.signals[l?"data":"visual"])[0],c=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(o),h=f.get("type"),d=l?CJ(e,o):u.name,p=a+PYe,g=`${a}${RYe}.${o}`,v=`${l?h==="log"?"zoomLog":h==="pow"?"zoomPow":"zoomLinear":"zoomLinear"}(${d}, ${g}, ${p}`+(l&&h==="pow"?`, ${(s=f.get("exponent"))!==null&&s!==void 0?s:1}`:"")+")";u.on.push({events:{signal:p},update:l?v:`clampRange(${v}, 0, ${c})`})}const h4n=[o4n,NYe,Dm,MYe,c4n,f4n,IYe,DYe,l4n];function XW(e,t){for(const n of h4n)n.has(e)&&t(n)}function J$(e,t=!0,n=aNn){if(ut(e)){const r=e.map(i=>J$(i,t,n));return t?`[${r.join(", ")}]`:r}else if(wS(e))return n(t?MD(e):mFn(e));return t?n(JSON.stringify(e)):e}function d4n(e,t){return Wx(e,(n,r)=>{const i=n.name;let s=r.modifyExpr(e,n);t.push(...r.signals(e,n)),XW(n,a=>{a.signals&&(t=a.signals(e,n,t)),a.modifyExpr&&(s=a.modifyExpr(e,n,s))}),t.push({name:i+C4n,on:[{events:{signal:n.name+Jh},update:`modify(${an(n.name+kb)}, ${s})`}]})}),Yfe(t)}function p4n(e,t){if(e.component.selection&&Ne(e.component.selection).length){const n=an(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Ox("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return Yfe(t)}function g4n(e,t){let n=!1;return Wx(e,(r,i)=>{const s=r.name,a=an(s+kb);if(t.filter(l=>l.name===s).length===0){const l=r.resolve==="global"?"union":r.resolve,u=r.type==="multi"?", true)":")";t.push({name:r.name,update:`${UYe}(${a}, ${an(l)}${u}`})}n=!0,i.topLevelSignals&&(t=i.topLevelSignals(e,r,t)),XW(r,l=>{l.topLevelSignals&&(t=l.topLevelSignals(e,r,t))})}),n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),Yfe(t)}function m4n(e,t){const n=[...t];return Wx(e,r=>{const i={name:r.name+kb};if(r.init){const a=r.project.items.map(l=>it(l,["signals"])),o=r.init.map(l=>J$(l,!1));i.values=r.type==="interval"?[{unit:Sp(e,{escape:!1}),fields:a,values:o}]:o.map(l=>({unit:Sp(e,{escape:!1}),fields:a,values:l}))}n.filter(a=>a.name===r.name+kb).length||n.push(i)}),n}function LYe(e,t){return Wx(e,(n,r)=>{t=r.marks?r.marks(e,n,t):t,XW(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function v4n(e,t){for(const n of e.children)qr(n)&&(t=LYe(n,t));return t}function y4n(e,t){const n=t.selection,r=e.getSelectionComponent(n,Er(n));return{signal:ZYe(r,t)}}function Yfe(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const zA="_brush",SJ="_scale_trigger",b4n={signals:(e,t)=>{const n=t.name,r=n+bF,i=Dm.has(t),s=[],a=[],o=[];if(t.translate&&!i){const c=`!event.item || event.item.mark.name !== ${an(n+zA)}`;BYe(t,(f,h)=>{var d;const p=ci((d=h.between[0].filter)!==null&&d!==void 0?d:h.between[0].filter=[]);return p.indexOf(c)<0&&p.push(c),f})}t.project.items.forEach((c,f)=>{const h=c.channel;if(h!==Ur&&h!==Ni){Te("Interval selections only support x and y encoding channels.");return}const d=t.init?t.init[f]:null,p=x4n(e,t,c,d),g=c.signals.data,m=c.signals.visual,v=an(e.scaleName(h)),y=e.getScaleComponent(h).get("type"),b=ju(y)?"+":"";s.push(...p),a.push(g),o.push({scaleName:e.scaleName(h),expr:`(!isArray(${g}) || (${b}invert(${v}, ${m})[0] === ${b}${g}[0] && ${b}invert(${v}, ${m})[1] === ${b}${g}[1]))`})}),i||s.push({name:n+SJ,value:{},on:[{events:o.map(c=>({scale:c.scaleName})),update:o.map(c=>c.expr).join(" && ")+` ? ${n+SJ} : {}`}]});const l=t.init,u=`unit: ${Sp(e)}, fields: ${r}, values`;return s.concat(Object.assign(Object.assign({name:n+Jh},l?{init:`{${u}: ${J$(l)}}`}:{}),{on:[{events:[{signal:a.join(" || ")}],update:a.join(" && ")+` ? {${u}: [${a}]} : null`}]}))},modifyExpr:(e,t)=>t.name+Jh+", "+(t.resolve==="global"?"true":`{unit: ${Sp(e)}}`),marks:(e,t,n)=>{const r=t.name,{x:i,y:s}=t.project.hasChannel,a=i&&i.signals.visual,o=s&&s.signals.visual,l=`data(${an(t.name+kb)})`;if(Dm.has(t))return n;const u={x:i!==void 0?{signal:`${a}[0]`}:{value:0},y:s!==void 0?{signal:`${o}[0]`}:{value:0},x2:i!==void 0?{signal:`${a}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${o}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of Ne(u))u[m]=[Object.assign({test:`${l}.length && ${l}[0].unit === ${Sp(e)}`},u[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:h,cursor:d}=c,p=it(c,["fill","fillOpacity","cursor"]),g=Ne(p).reduce((m,v)=>(m[v]=[{test:[i!==void 0&&`${a}[0] !== ${a}[1]`,s!==void 0&&`${o}[0] !== ${o}[1]`].filter(y=>y).join(" && "),value:p[v]},{value:null}],m),{});return[{name:r+zA+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:h}},update:u}},...n,{name:r+zA,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},d?{cursor:{value:d}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},u),g)}}]}};function x4n(e,t,n,r){const i=n.channel,s=n.signals.visual,a=n.signals.data,o=Dm.has(t),l=an(e.scaleName(i)),u=e.getScaleComponent(i),c=u?u.get("type"):void 0,f=g=>`scale(${l}, ${g})`,h=e.getSizeSignalRef(i===Ur?"width":"height").signal,d=`${i}(unit)`,p=BYe(t,(g,m)=>[...g,{events:m.between[0],update:`[${d}, ${d}]`},{events:m,update:`[${s}[0], clamp(${d}, 0, ${h})]`}]);return p.push({events:{signal:t.name+SJ},update:ju(c)?`[${f(`${a}[0]`)}, ${f(`${a}[1]`)}]`:"[0, 0]"}),o?[{name:a,on:[]}]:[Object.assign(Object.assign({name:s},r?{init:J$(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:a},r?{init:J$(r)}:{}),{on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${l}, ${s})`}]})]}function BYe(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):(Te(`${r} is not an ordered event stream for interval selections.`),n),[])}function zYe(e,t){const n=t.name,r=n+bF,i=t.project,s="(item().isVoronoi ? datum.datum : datum)",a=i.items.map(u=>{const c=e.fieldDef(u.channel);return c&&c.bin?`[${s}[${an(e.vgField(u.channel,{}))}], ${s}[${an(e.vgField(u.channel,{binSuffix:"end"}))}]]`:`${s}[${an(u.field)}]`}).join(", "),o=`unit: ${Sp(e)}, fields: ${r}, values`,l=t.events;return[{name:n+Jh,on:l?[{events:l,update:`datum && item().mark.marktype !== 'group' ? {${o}: [${a}]} : null`,force:!0}]:[]}]}const w4n={signals:zYe,modifyExpr:(e,t)=>t.name+Jh+", "+(t.resolve==="global"?"null":`{unit: ${Sp(e)}}`)},$4n={signals:zYe,modifyExpr:(e,t)=>t.name+Jh+", "+(t.resolve==="global"?"true":`{unit: ${Sp(e)}}`)},kb="_store",Jh="_tuple",C4n="_modify",UYe="vlSelectionResolve",_4n={single:$4n,multi:w4n,interval:b4n};function Wx(e,t){const n=e.component.selection;if(n){for(const r of k0(n))if(t(r,_4n[r.type])===!0)break}}function S4n(e){let t=e.parent;for(;t&&!Hc(t);)t=t.parent;return t}function Sp(e,{escape:t}={escape:!0}){let n=t?an(e.name):e.name;const r=S4n(e);if(r){const{facet:i}=r;for(const s of ku)i[s]&&(n+=` + '__facet_${s}_' + (facet[${an(r.vgField(s))}])`)}return n}function Xfe(e){let t=!1;return Wx(e,n=>{t=t||n.project.items.some(r=>r.field===Q$)}),t}const k4n="RawCode",E4n="Literal",A4n="Property",T4n="Identifier",D4n="ArrayExpression",I4n="BinaryExpression",N4n="CallExpression",M4n="ConditionalExpression",F4n="LogicalExpression",O4n="MemberExpression",R4n="ObjectExpression",P4n="UnaryExpression";function Cf(e){this.type=e}Cf.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=L4n(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function L4n(e){switch(e.type){case D4n:return e.elements;case I4n:case F4n:return[e.left,e.right];case N4n:return[e.callee].concat(e.arguments);case M4n:return[e.test,e.consequent,e.alternate];case O4n:return[e.object,e.property];case R4n:return e.properties;case A4n:return[e.key,e.value];case P4n:return[e.argument];case T4n:case E4n:case k4n:default:return[]}}var kd,Ke,we,ka,Wn,KW=1,xF=2,Eb=3,yv=4,ZW=5,Vx=6,Po=7,wF=8,B4n=9;kd={};kd[KW]="Boolean";kd[xF]="<end>";kd[Eb]="Identifier";kd[yv]="Keyword";kd[ZW]="Null";kd[Vx]="Numeric";kd[Po]="Punctuator";kd[wF]="String";kd[B4n]="RegularExpression";var z4n="ArrayExpression",U4n="BinaryExpression",W4n="CallExpression",V4n="ConditionalExpression",WYe="Identifier",j4n="Literal",H4n="LogicalExpression",q4n="MemberExpression",G4n="ObjectExpression",Y4n="Property",X4n="UnaryExpression",Ls="Unexpected token %0",K4n="Unexpected number",Z4n="Unexpected string",Q4n="Unexpected identifier",J4n="Unexpected reserved word",e5n="Unexpected end of input",kJ="Invalid regular expression",SG="Invalid regular expression: missing /",VYe="Octal literals are not allowed in strict mode.",t5n="Duplicate data property in object literal not allowed in strict mode",ya="ILLEGAL",LD="Disabled.",n5n=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),r5n=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function QW(e,t){if(!e)throw new Error("ASSERT: "+t)}function Hd(e){return e>=48&&e<=57}function Kfe(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function UA(e){return"01234567".indexOf(e)>=0}function i5n(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function BD(e){return e===10||e===13||e===8232||e===8233}function $F(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&n5n.test(String.fromCharCode(e))}function DB(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&r5n.test(String.fromCharCode(e))}var s5n={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function jYe(){for(var e;we<ka&&(e=Ke.charCodeAt(we),i5n(e)||BD(e));)++we}function EJ(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)we<ka&&Kfe(Ke[we])?(r=Ke[we++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):An({},Ls,ya);return String.fromCharCode(i)}function a5n(){var e,t,n,r;for(e=Ke[we],t=0,e==="}"&&An({},Ls,ya);we<ka&&(e=Ke[we++],!!Kfe(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&An({},Ls,ya),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function HYe(){var e,t;for(e=Ke.charCodeAt(we++),t=String.fromCharCode(e),e===92&&(Ke.charCodeAt(we)!==117&&An({},Ls,ya),++we,e=EJ("u"),(!e||e==="\\"||!$F(e.charCodeAt(0)))&&An({},Ls,ya),t=e);we<ka&&(e=Ke.charCodeAt(we),!!DB(e));)++we,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Ke.charCodeAt(we)!==117&&An({},Ls,ya),++we,e=EJ("u"),(!e||e==="\\"||!DB(e.charCodeAt(0)))&&An({},Ls,ya),t+=e);return t}function o5n(){var e,t;for(e=we++;we<ka;){if(t=Ke.charCodeAt(we),t===92)return we=e,HYe();if(DB(t))++we;else break}return Ke.slice(e,we)}function l5n(){var e,t,n;return e=we,t=Ke.charCodeAt(we)===92?HYe():o5n(),t.length===1?n=Eb:s5n.hasOwnProperty(t)?n=yv:t==="null"?n=ZW:t==="true"||t==="false"?n=KW:n=Eb,{type:n,value:t,start:e,end:we}}function kG(){var e=we,t=Ke.charCodeAt(we),n,r=Ke[we],i,s,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++we,{type:Po,value:String.fromCharCode(t),start:e,end:we};default:if(n=Ke.charCodeAt(we+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return we+=2,{type:Po,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:we};case 33:case 61:return we+=2,Ke.charCodeAt(we)===61&&++we,{type:Po,value:Ke.slice(e,we),start:e,end:we}}}if(a=Ke.substr(we,4),a===">>>=")return we+=4,{type:Po,value:a,start:e,end:we};if(s=a.substr(0,3),s===">>>"||s==="<<="||s===">>=")return we+=3,{type:Po,value:s,start:e,end:we};if(i=s.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return we+=2,{type:Po,value:i,start:e,end:we};if("<>=!+-*%&|^/".indexOf(r)>=0)return++we,{type:Po,value:r,start:e,end:we};An({},Ls,ya)}function u5n(e){for(var t="";we<ka&&Kfe(Ke[we]);)t+=Ke[we++];return t.length===0&&An({},Ls,ya),$F(Ke.charCodeAt(we))&&An({},Ls,ya),{type:Vx,value:parseInt("0x"+t,16),start:e,end:we}}function c5n(e){for(var t="0"+Ke[we++];we<ka&&UA(Ke[we]);)t+=Ke[we++];return($F(Ke.charCodeAt(we))||Hd(Ke.charCodeAt(we)))&&An({},Ls,ya),{type:Vx,value:parseInt(t,8),octal:!0,start:e,end:we}}function f_e(){var e,t,n;if(n=Ke[we],QW(Hd(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=we,e="",n!=="."){if(e=Ke[we++],n=Ke[we],e==="0"){if(n==="x"||n==="X")return++we,u5n(t);if(UA(n))return c5n(t);n&&Hd(n.charCodeAt(0))&&An({},Ls,ya)}for(;Hd(Ke.charCodeAt(we));)e+=Ke[we++];n=Ke[we]}if(n==="."){for(e+=Ke[we++];Hd(Ke.charCodeAt(we));)e+=Ke[we++];n=Ke[we]}if(n==="e"||n==="E")if(e+=Ke[we++],n=Ke[we],(n==="+"||n==="-")&&(e+=Ke[we++]),Hd(Ke.charCodeAt(we)))for(;Hd(Ke.charCodeAt(we));)e+=Ke[we++];else An({},Ls,ya);return $F(Ke.charCodeAt(we))&&An({},Ls,ya),{type:Vx,value:parseFloat(e),start:t,end:we}}function f5n(){var e="",t,n,r,i,s=!1;for(t=Ke[we],QW(t==="'"||t==='"',"String literal must starts with a quote"),n=we,++we;we<ka;)if(r=Ke[we++],r===t){t="";break}else if(r==="\\")if(r=Ke[we++],!r||!BD(r.charCodeAt(0)))switch(r){case"u":case"x":Ke[we]==="{"?(++we,e+=a5n()):e+=EJ(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:UA(r)?(i="01234567".indexOf(r),i!==0&&(s=!0),we<ka&&UA(Ke[we])&&(s=!0,i=i*8+"01234567".indexOf(Ke[we++]),"0123".indexOf(r)>=0&&we<ka&&UA(Ke[we])&&(i=i*8+"01234567".indexOf(Ke[we++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&Ke[we]===`
`&&++we;else{if(BD(r.charCodeAt(0)))break;e+=r}return t!==""&&An({},Ls,ya),{type:wF,value:e,octal:s,start:n,end:we}}function h5n(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(r,i){if(parseInt(i,16)<=1114111)return"x";An({},kJ)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{An({},kJ)}try{return new RegExp(e,t)}catch{return null}}function d5n(){var e,t,n,r,i;for(e=Ke[we],QW(e==="/","Regular expression literal must start with a slash"),t=Ke[we++],n=!1,r=!1;we<ka;)if(e=Ke[we++],t+=e,e==="\\")e=Ke[we++],BD(e.charCodeAt(0))&&An({},SG),t+=e;else if(BD(e.charCodeAt(0)))An({},SG);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||An({},SG),i=t.substr(1,t.length-2),{value:i,literal:t}}function p5n(){var e,t,n;for(t="",n="";we<ka&&(e=Ke[we],!!DB(e.charCodeAt(0)));)++we,e==="\\"&&we<ka?An({},Ls,ya):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&An({},kJ,n),{value:n,literal:t}}function g5n(){var e,t,n,r;return Wn=null,jYe(),e=we,t=d5n(),n=p5n(),r=h5n(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:we}}function m5n(e){return e.type===Eb||e.type===yv||e.type===KW||e.type===ZW}function qYe(){var e;return jYe(),we>=ka?{type:xF,start:we,end:we}:(e=Ke.charCodeAt(we),$F(e)?l5n():e===40||e===41||e===59?kG():e===39||e===34?f5n():e===46?Hd(Ke.charCodeAt(we+1))?f_e():kG():Hd(e)?f_e():kG())}function Ho(){var e;return e=Wn,we=e.end,Wn=qYe(),we=e.end,e}function GYe(){var e;e=we,Wn=qYe(),we=e}function v5n(e){var t=new Cf(z4n);return t.elements=e,t}function h_e(e,t,n){var r=new Cf(e==="||"||e==="&&"?H4n:U4n);return r.operator=e,r.left=t,r.right=n,r}function y5n(e,t){var n=new Cf(W4n);return n.callee=e,n.arguments=t,n}function b5n(e,t,n){var r=new Cf(V4n);return r.test=e,r.consequent=t,r.alternate=n,r}function Zfe(e){var t=new Cf(WYe);return t.name=e,t}function XE(e){var t=new Cf(j4n);return t.value=e.value,t.raw=Ke.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function d_e(e,t,n){var r=new Cf(q4n);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function x5n(e){var t=new Cf(G4n);return t.properties=e,t}function p_e(e,t,n){var r=new Cf(Y4n);return r.key=t,r.value=n,r.kind=e,r}function w5n(e,t){var n=new Cf(X4n);return n.operator=e,n.argument=t,n.prefix=!0,n}function An(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(s,a){return QW(a<r.length,"Message reference must be in range"),r[a]});throw n=new Error(i),n.index=we,n.description=i,n}function JW(e){e.type===xF&&An(e,e5n),e.type===Vx&&An(e,K4n),e.type===wF&&An(e,Z4n),e.type===Eb&&An(e,Q4n),e.type===yv&&An(e,J4n),An(e,Ls,e.value)}function Ea(e){var t=Ho();(t.type!==Po||t.value!==e)&&JW(t)}function mr(e){return Wn.type===Po&&Wn.value===e}function EG(e){return Wn.type===yv&&Wn.value===e}function $5n(){var e=[];for(we=Wn.start,Ea("[");!mr("]");)mr(",")?(Ho(),e.push(null)):(e.push(Ab()),mr("]")||Ea(","));return Ho(),v5n(e)}function g_e(){var e;return we=Wn.start,e=Ho(),e.type===wF||e.type===Vx?(e.octal&&An(e,VYe),XE(e)):Zfe(e.value)}function C5n(){var e,t,n,r;if(we=Wn.start,e=Wn,e.type===Eb)return n=g_e(),Ea(":"),r=Ab(),p_e("init",n,r);if(e.type===xF||e.type===Po)JW(e);else return t=g_e(),Ea(":"),r=Ab(),p_e("init",t,r)}function _5n(){var e=[],t,n,r,i={},s=String;for(we=Wn.start,Ea("{");!mr("}");)t=C5n(),t.key.type===WYe?n=t.key.name:n=s(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?An({},t5n):i[r]=!0,e.push(t),mr("}")||Ea(",");return Ea("}"),x5n(e)}function S5n(){var e;return Ea("("),e=Qfe(),Ea(")"),e}var k5n={if:1};function E5n(){var e,t,n;if(mr("("))return S5n();if(mr("["))return $5n();if(mr("{"))return _5n();if(e=Wn.type,we=Wn.start,e===Eb||k5n[Wn.value])n=Zfe(Ho().value);else if(e===wF||e===Vx)Wn.octal&&An(Wn,VYe),n=XE(Ho());else{if(e===yv)throw new Error(LD);e===KW?(t=Ho(),t.value=t.value==="true",n=XE(t)):e===ZW?(t=Ho(),t.value=null,n=XE(t)):mr("/")||mr("/=")?(n=XE(g5n()),GYe()):JW(Ho())}return n}function A5n(){var e=[];if(Ea("("),!mr(")"))for(;we<ka&&(e.push(Ab()),!mr(")"));)Ea(",");return Ea(")"),e}function T5n(){var e;return we=Wn.start,e=Ho(),m5n(e)||JW(e),Zfe(e.value)}function D5n(){return Ea("."),T5n()}function I5n(){var e;return Ea("["),e=Qfe(),Ea("]"),e}function N5n(){var e,t,n;for(e=E5n();;)if(mr("."))n=D5n(),e=d_e(".",e,n);else if(mr("("))t=A5n(),e=y5n(e,t);else if(mr("["))n=I5n(),e=d_e("[",e,n);else break;return e}function m_e(){var e=N5n();if(Wn.type===Po&&(mr("++")||mr("--")))throw new Error(LD);return e}function X4(){var e,t;if(Wn.type!==Po&&Wn.type!==yv)t=m_e();else{if(mr("++")||mr("--"))throw new Error(LD);if(mr("+")||mr("-")||mr("~")||mr("!"))e=Ho(),t=X4(),t=w5n(e.value,t);else{if(EG("delete")||EG("void")||EG("typeof"))throw new Error(LD);t=m_e()}}return t}function v_e(e){var t=0;if(e.type!==Po&&e.type!==yv)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function M5n(){var e,t,n,r,i,s,a,o,l,u;if(e=Wn,l=X4(),r=Wn,i=v_e(r),i===0)return l;for(r.prec=i,Ho(),t=[e,Wn],a=X4(),s=[l,r,a];(i=v_e(Wn))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)a=s.pop(),o=s.pop().value,l=s.pop(),t.pop(),n=h_e(o,l,a),s.push(n);r=Ho(),r.prec=i,s.push(r),t.push(Wn),n=X4(),s.push(n)}for(u=s.length-1,n=s[u],t.pop();u>1;)t.pop(),n=h_e(s[u-1].value,s[u-2],n),u-=2;return n}function Ab(){var e,t,n;return e=M5n(),mr("?")&&(Ho(),t=Ab(),Ea(":"),n=Ab(),e=b5n(e,t,n)),e}function Qfe(){var e=Ab();if(mr(","))throw new Error(LD);return e}function F5n(e){Ke=e,we=0,ka=Ke.length,Wn=null,GYe();var t=Qfe();if(Wn.type!==xF)throw new Error("Unexpect token after expression.");return t}function _S(e,t,n){return e.fields=t||[],e.fname=n,e}function O5n(e){return e.length===1?R5n(e[0]):P5n(e)}const R5n=e=>function(t){return t[e]},P5n=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function AG(e){throw Error(e)}function L5n(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||AG("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&AG("Access path missing closing bracket: "+e),r&&AG("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function B5n(e,t,n){const r=L5n(e);return e=r.length===1?r[0]:e,_S((n&&n.get||O5n)(r),[e],t||e)}B5n("id");_S(e=>e,[],"identity");_S(()=>0,[],"zero");_S(()=>1,[],"one");_S(()=>!0,[],"true");_S(()=>!1,[],"false");function AJ(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...AJ(e.object)),t.push(...AJ(e.property))),t)}function YYe(e){return e.object.type==="MemberExpression"?YYe(e.object):e.object.name==="datum"}function XYe(e){const t=F5n(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&YYe(r)&&n.add(AJ(r).slice(1).join("."))}),n}class SS extends Kn{constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=IB(this.model,this.filter,this),this._dependentFields=XYe(this.expr)}clone(){return new SS(null,this.model,Gt(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function z5n(e,t){var n;const r={},i=e.config.selection;for(const s of Ne(t!=null?t:{})){const a=Gt(t[s]),o=i[a.type],l=it(o,["fields","encodings"]);for(const f in l)f==="encodings"&&a.fields||f==="fields"&&a.encodings||(f==="mark"&&(a[f]=Object.assign(Object.assign({},l[f]),a[f])),(a[f]===void 0||a[f]===!0)&&(a[f]=(n=l[f])!==null&&n!==void 0?n:a[f]));const u=Er(s),c=r[u]=Object.assign(Object.assign({},a),{name:u,events:qt(a.on)?Ox(a.on,"scope"):Gt(a.on)});XW(c,f=>{f.has(c)&&f.parse&&f.parse(e,c,a,t[s])})}return r}function KYe(e,t,n,r="datum"){const i=[];function s(o){const l=Er(o),u=e.getSelectionComponent(l,o),c=an(l+kb);if(u.project.timeUnit){const f=n!=null?n:e.component.data.raw,h=u.project.timeUnit.clone();f.parent?h.insertAsParentOf(f):f.parent=h}return u.empty!=="none"&&i.push(c),`vlSelectionTest(${c}, ${r}`+(u.resolve==="global"?")":`, ${an(u.resolve)})`)}const a=LA(t,s);return(i.length?"!("+i.map(o=>`length(data(${o}))`).join(" || ")+") || ":"")+`(${a})`}function ZYe(e,t){const n=t.encoding;let r=t.field;if(!n&&!r)r=e.project.items[0].field,e.project.items.length>1&&Te(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${an(r)}.`);else if(n&&!r){const i=e.project.items.filter(s=>s.channel===n);!i.length||i.length>1?(r=e.project.items[0].field,Te((i.length?"Multiple ":"No ")+`matching ${an(n)} encoding found for selection ${an(t.selection)}. Using "field": ${an(r)}.`)):r=i[0].field}return`${e.name}[${an(r)}]`}function U5n(e,t){Wx(e,n=>{const r=n.name,i=e.getName(`lookup_${r}`);e.component.data.outputNodes[i]=n.materialized=new co(new SS(t,e,{selection:r}),i,"lookup",e.component.data.outputNodeRefCounts)})}function IB(e,t,n){return LA(t,r=>qt(r)?r:AFn(r)?KYe(e,r.selection,n):bGe(r))}function W5n(e,t){if(!!e)return ut(e)&&!Bg(e)?e.map(n=>jGe(n,t)).join(", "):e}function TG(e,t,n,r){var i,s,a;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(s=e.encode[t])!==null&&s!==void 0?s:{},e.encode[t].update=(a=e.encode[t].update)!==null&&a!==void 0?a:{},e.encode[t].update[n]=r}function KE(e,t,n,r={header:!1}){var i,s;const a=e.combine(),{disable:o,orient:l,scale:u,labelExpr:c,title:f,zindex:h}=a,d=it(a,["disable","orient","scale","labelExpr","title","zindex"]);if(!o){for(const p in d){const g=kNn[p],m=d[p];if(g&&g!==t&&g!=="both")delete d[p];else if(tfe(m)){const{condition:v}=m,y=it(m,["condition"]),b=ci(v),x=ECe[p];if(x){const{vgProp:w,part:C}=x,$=[...b.map(_=>{const{test:k}=_,E=it(_,["test"]);return Object.assign({test:IB(null,k)},E)}),y];TG(d,C,w,$),delete d[p]}else if(x===null){const w={signal:b.map(C=>{const{test:$}=C,_=it(C,["test"]);return`${IB(null,$)} ? ${HCe(_)} : `}).join("")+HCe(y)};d[p]=w}}else if(wt(m)){const v=ECe[p];if(v){const{vgProp:y,part:b}=v;TG(d,b,y,m),delete d[p]}}}if(t==="grid"){if(!d.grid)return;if(d.encode){const{grid:p}=d.encode;d.encode=Object.assign({},p?{grid:p}:{}),er(d.encode)&&delete d.encode}return Object.assign(Object.assign({scale:u,orient:l},d),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:bi(h,0)})}else{if(!r.header&&e.mainExtracted)return;if(c!==void 0){let g=c;((s=(i=d.encode)===null||i===void 0?void 0:i.labels)===null||s===void 0?void 0:s.update)&&wt(d.encode.labels.update.text)&&(g=X$(c,"datum.label",d.encode.labels.update.text.signal)),TG(d,"labels","text",{signal:g})}if(d.labelAlign===null&&delete d.labelAlign,d.encode){for(const g of Pqe)e.hasAxisPart(g)||delete d.encode[g];er(d.encode)&&delete d.encode}const p=W5n(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:u,orient:l,grid:!1},p?{title:p}:{}),d),n.aria===!1?{aria:!1}:{}),{zindex:bi(h,0)})}}}function QYe(e){const{axes:t}=e.component,n=[];for(const r of Vu)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const s=r==="x"?"height":"width",a=e.getSizeSignalRef(s).signal;s!==a&&n.push({name:s,update:a})}}return n}function V5n(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>KE(i,"grid",t)),...r.map(i=>KE(i,"grid",t)),...n.map(i=>KE(i,"main",t)),...r.map(i=>KE(i,"main",t))].filter(i=>i)}const JYe={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},eXe={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},j5n=Ne(JYe),H5n=Ne(eXe);function y_e(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const s=n==="x"?"bottom":"left",a=t[n==="x"?"axisBottom":"axisLeft"]||{},o=t[n==="x"?"axisTop":"axisRight"]||{},l=new Set([...Ne(a),...Ne(o)]),u={};for(const c of l.values())u[c]={signal:`${r.signal} === "${s}" ? ${FD(a[c])} : ${FD(o[c])}`};return u}return t[i]})])}function q5n(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:zFn(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],s=e==="x"?"axisX":"axisY",a=wt(n)?"axisOrient":"axis"+_W(n),o=[...i,...i.map(u=>s+u.substr(4))],l=["axis",a,s];return{vlOnlyAxisConfig:y_e(o,r,e,n),vgAxisConfig:y_e(l,r,e,n),axisConfigStyle:G5n([...l,...o],r)}}function G5n(e,t){var n;const r=[{}];for(const i of e){let s=(n=t[i])===null||n===void 0?void 0:n.style;if(s){s=ci(s);for(const a of s)r.push(t.style[a])}}return Object.assign.apply(null,r)}function TJ(e,t,n,r={}){var i;const s=XGe(e,n,t.style);if(s!==void 0)return{configFrom:"style",configValue:s};for(const a of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((i=r[a])===null||i===void 0?void 0:i[e])!==void 0)return{configFrom:a,configValue:r[a][e]};return{}}const b_e={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return DGe(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return IGe(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return Le(e)&&Ja(e.bin)?!1:(r=t.grid)!==null&&r!==void 0?r:Y5n(n,e)},gridScale:({model:e,channel:t})=>X5n(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||nXe(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||tXe(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return(r=e.labelFlush)!==null&&r!==void 0?r:Z5n(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return(r=e.labelOverlap)!==null&&r!==void 0?r:Q5n(t.type,n)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var s;const a=e==="x"?"width":e==="y"?"height":void 0,o=a?t.getSizeSignalRef(a):void 0;return(s=n.tickCount)!==null&&s!==void 0?s:ePn({fieldOrDatumDef:r,scaleType:i,size:o,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=rXe(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),s=n==="x"?"x2":"y2",a=t.fieldDef(s);return ZGe(i?[jCe(i)]:[],Le(a)?[jCe(a)]:[])},values:({axis:e,fieldOrDatumDef:t})=>tPn(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return(r=e.zindex)!==null&&r!==void 0?r:nPn(n,t)}};function Y5n(e,t){return!pl(e)&&Le(t)&&!hr(t==null?void 0:t.bin)}function X5n(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function K5n(e,t,n,r,i){const s=t==null?void 0:t.labelAngle;if(s!==void 0)return wt(s)?s:mB(s);{const{configValue:a}=TJ("labelAngle",e.config,t==null?void 0:t.style,i);return a!==void 0?mB(a):n===Ur&&ht([xfe,bfe],r.type)?270:void 0}}function DJ(e){return`(((${e.signal} % 360) + 360) % 360)`}function tXe(e,t,n,r){if(e!==void 0)if(n==="x"){if(wt(e)){const i=DJ(e),s=wt(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${s} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(wt(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(wt(e)){const i=DJ(e),s=wt(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${s} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(wt(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function nXe(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,s=r?"bottom":"left";if(wt(e)){const a=DJ(e),o=wt(t)?`(${t.signal} === "${s}")`:t===s;return{signal:`(${i?"("+a+" + 90)":a} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${a} && ${a} < ${180+i}) === ${o} ? "left" : "right"`}}if((e+i)%180===0)return r?null:"center";if(wt(t)){const a=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${a} "${s}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===s)?"left":"right"}function Z5n(e,t){if(t==="x"&&ht(["quantitative","temporal"],e))return!0}function Q5n(e,t){if(e!=="nominal")return t==="log"?"greedy":!0}function J5n(e){return e==="x"?"bottom":"left"}function ePn({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!pl(t)&&t!=="log"){if(Le(e)){if(hr(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&ht(["month","hours","day","quarter"],(i=wo(e.timeUnit))===null||i===void 0?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function rXe(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),s=r?r.title:void 0,a=i?i.title:void 0;if(s&&a)return QGe(s,a);if(s)return s;if(a)return a;if(s!==void 0)return s;if(a!==void 0)return a}function tPn(e,t){const n=e.values;if(ut(n))return qGe(t,n);if(wt(n))return n}function nPn(e,t){return e==="rect"&&BGe(t)?1:0}class eC extends Kn{constructor(t,n){super(t),this.transform=n,this._dependentFields=XYe(this.transform.calculate)}clone(){return new eC(null,Gt(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(!!Tfe(r)&&OGe(r.sort)){const{field:s,timeUnit:a}=r,o=r.sort,l=o.map((u,c)=>`${bGe({field:s,timeUnit:a,equal:u})} ? ${c} : `).join("")+o.length;t=new eC(t,{calculate:l,as:tC(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${pn(this.transform)}`}}function tC(e,t,n){return Me(e,Object.assign({prefix:t,suffix:"sort_index"},n!=null?n:{}))}function eV(e,t){return ht(["top","bottom"],t)?"column":ht(["left","right"],t)||e==="row"?"row":"column"}function nC(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return bi(((t==null?void 0:t.header)||{})[e],i[e],n.header[e])}function tV(e,t,n,r){const i={};for(const s of e){const a=nC(s,t,n,r);a!==void 0&&(i[s]=a)}return i}const Jfe=["row","column"],ehe=["header","footer"];function rPn(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:a,titleOrient:o}=tV(["titleAnchor","titleAngle","titleOrient"],i,r,t),l=eV(t,o),u=mB(a);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),sXe(u,l)),iXe(l,u,s)),aXe(r,i,t,j5n,JYe))}}function iXe(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=nXe(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function sXe(e,t){const n=tXe(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function iPn(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of ehe)if(n[i])for(const s of n[i]){const a=aPn(e,t,i,n,s);a!=null&&r.push(a)}return r}function sPn(e,t){var n;const{sort:r}=e;return bh(r)?{field:Me(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}:ut(r)?{field:tC(e,t,{expr:"datum"}),order:"ascending"}:{field:Me(e,{expr:"datum"}),order:r!=null?r:"ascending"}}function IJ(e,t,n){const{format:r,formatType:i,labelAngle:s,labelAnchor:a,labelOrient:o,labelExpr:l}=tV(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),u=Cfe({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=eV(t,o);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:l?X$(X$(l,"datum.label",u),"datum.value",Me(e,{expr:"parent"})):u}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),sXe(s,c)),iXe(c,s,a)),aXe(n,e,t,H5n,eXe))}function aPn(e,t,n,r,i){if(i){let s=null;const{facetFieldDef:a}=r,o=e.config?e.config:void 0;if(a&&i.labels){const{labelOrient:f}=tV(["labelOrient"],a,o,t);(t==="row"&&!ht(["top","bottom"],f)||t==="column"&&!ht(["left","right"],f))&&(s=IJ(a,t,o))}const l=Hc(e)&&!gF(e.facet),u=i.axes,c=(u==null?void 0:u.length)>0;if(s||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:sPn(a,t)}:{}),c&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),s?{title:s}:{}),i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{}),c?{axes:u}:{})}}return null}const oPn={column:{start:0,end:1},row:{start:1,end:0}};function lPn(e,t){return oPn[t][e]}function uPn(e,t){const n={};for(const r of ku){const i=e[r];if(i!=null&&i.facetFieldDef){const{titleAnchor:s,titleOrient:a}=tV(["titleAnchor","titleOrient"],i.facetFieldDef,t,r),o=eV(r,a),l=lPn(s,o);l!==void 0&&(n[o]=l)}}return er(n)?void 0:n}function aXe(e,t,n,r,i){const s={};for(const a of r){if(!i[a])continue;const o=nC(a,t,e,n);o!==void 0&&(s[i[a]]=o)}return s}function the(e){return[...IR(e,"width"),...IR(e,"height"),...IR(e,"childWidth"),...IR(e,"childHeight")]}function IR(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const s=e.getScaleComponent(n);if(s){const a=s.get("type"),o=s.get("range");if(pl(a)&&mv(o)){const l=e.scaleName(n);return Hc(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[x_e(l,o)]:[x_e(l,o),{name:i,update:oXe(l,s,`domain('${l}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const s=i.endsWith("width"),a=s?"containerSize()[0]":"containerSize()[1]",o=wJ(e.config.view,s?"width":"height"),l=`isFinite(${a}) ? ${a} : ${o}`;return[{name:i,init:l,on:[{update:l,events:"window:resize"}]}]}else return[{name:i,value:r}]}function x_e(e,t){return{name:e+"_step",value:t.step}}function oXe(e,t,n){const r=t.get("type"),i=t.get("padding"),s=bi(t.get("paddingOuter"),i);let a=t.get("paddingInner");return a=r==="band"?a!==void 0?a:i:1,`bandspace(${n}, ${a}, ${s}) * ${e}_step`}function lXe(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function uXe(e,t){return Ne(e).reduce((n,r)=>{const i=e[r];return Object.assign(Object.assign({},n),yF(t,i,r,s=>wt(s)?s:{value:s.value}))},{})}function cPn(e,t){if(AS(t)||Hc(t))return"shared";if(ahe(t))return Kh(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function nhe(e,t){const n=e.scale[t],r=Kh(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&Te(GMn(t)),"independent"):e[r][t]||"shared"}const fPn=Object.assign(Object.assign({},zOn),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),cXe=Ne(fPn);class hPn extends wg{}const w_e={symbols:dPn,gradient:pPn,labels:gPn,entries:mPn};function dPn(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:s}){var a,o,l,u,c;if(s!=="symbol")return;const{markDef:f,encoding:h,config:d,mark:p}=n,g=f.filled&&p!=="trail";let m=Object.assign(Object.assign({},bOn({},n,MNn)),EYe(n,{filled:g}));const v=(a=fXe(h.opacity))!==null&&a!==void 0?a:f.opacity;if(m.fill){if(r==="fill"||g&&r===hl)delete m.fill;else if(m.fill.field)i.get("symbolFillColor")?delete m.fill:(m.fill=ai((o=d.legend.symbolBaseFillColor)!==null&&o!==void 0?o:"black"),m.fillOpacity=ai(v!=null?v:1));else if(ut(m.fill)){const y=(c=(u=NJ((l=h.fill)!==null&&l!==void 0?l:h.color))!==null&&u!==void 0?u:f.fill)!==null&&c!==void 0?c:g&&f.color;y&&(m.fill=ai(y))}}if(m.stroke){if(r==="stroke"||!g&&r===hl)delete m.stroke;else if(m.stroke.field)delete m.stroke;else if(ut(m.stroke)){const y=bi(NJ(h.stroke||h.color),f.stroke,g?f.color:void 0);y&&(m.stroke={value:y})}}if(r!==xg){const y=Le(t)&&dXe(n,i,t);y?m.opacity=[Object.assign({test:y},ai(v!=null?v:1)),ai(d.legend.unselectedOpacity)]:v&&(m.opacity=ai(v))}return m=Object.assign(Object.assign({},m),e),er(m)?void 0:m}function pPn(e,{model:t,legendType:n}){if(n!=="gradient")return;let r={};const i=fXe(t.encoding.opacity)||t.markDef.opacity;return i&&(r.opacity=ai(i)),r=Object.assign(Object.assign({},r),e),er(r)?void 0:r}function gPn(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const s=n.legend(r)||{},a=n.config,o=Le(t)?dXe(n,i,t):void 0,l=o?[{test:o,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:u,formatType:c}=s,f=_b(c)?_fe({fieldOrDatumDef:t,field:"datum.value",format:u,formatType:c,config:a}):void 0,h=Object.assign(Object.assign(Object.assign({},l?{opacity:l}:{}),f?{text:f}:{}),e);return er(h)?void 0:h}function mPn(e,{legendCmpt:t}){const n=t.get("selections");return n!=null&&n.length?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function fXe(e){return hXe(e,(t,n)=>Math.max(t,n.value))}function NJ(e){return hXe(e,(t,n)=>bi(t,n.value))}function hXe(e,t){if(uOn(e))return ci(e.condition).reduce(t,e.value);if(Yp(e))return e.value}function dXe(e,t,n){const r=t.get("selections");if(!(r!=null&&r.length))return;const i=an(n.field);return r.map(s=>`(!length(data(${an(Er(s)+kb)})) || (${s}[${i}] && indexof(${s}[${i}], datum.value) >= 0))`).join(" || ")}const $_e={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return DGe(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return IGe(r,t,n)},gradientLength:e=>{var t,n;const{legend:r,legendConfig:i}=e;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:CPn(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return(i=(r=e.labelOverlap)!==null&&r!==void 0?r:t.labelOverlap)!==null&&i!==void 0?i:_Pn(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return(i=e.symbolType)!==null&&i!==void 0?i:yPn(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>yy(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(vw(n)&&Rc(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>vPn(t,e)};function vPn(e,t){const n=e.values;if(ut(n))return qGe(t,n);if(wt(n))return n}function yPn(e,t,n,r){var i;if(t!=="shape"){const s=(i=NJ(n))!==null&&i!==void 0?i:r;if(s)return s}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function bPn(e){const{legend:t}=e;return bi(t.type,xPn(e))}function xPn({channel:e,timeUnit:t,scaleType:n}){if(vw(e)){if(ht(["quarter","month","day"],t))return"symbol";if(Rc(n))return"gradient"}return"symbol"}function wPn({legendConfig:e,legendType:t,orient:n,legend:r}){var i,s;return(s=(i=r.direction)!==null&&i!==void 0?i:e[t?"gradientDirection":"symbolDirection"])!==null&&s!==void 0?s:$Pn(n,t)}function $Pn(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function CPn({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:a,gradientVerticalMaxLength:o,gradientVerticalMinLength:l}=e;if(Rc(i))return n==="horizontal"?r==="top"||r==="bottom"?C_e(t,"width",a,s):a:C_e(t,"height",l,o)}function C_e(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function _Pn(e){if(ht(["quantile","threshold","log"],e))return"greedy"}function pXe(e){const t=qr(e)?SPn(e):TPn(e);return e.component.legends=t,t}function SPn(e){const{encoding:t}=e,n={};for(const r of[hl,...dYe]){const i=Ti(t[r]);!i||!e.getScaleComponent(r)||r===dl&&Le(i)&&i.type===CS||(n[r]=APn(e,r))}return n}function kPn(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function EPn(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n!=null&&n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function APn(e,t){var n,r,i;let s=e.legend(t);const{markDef:a,encoding:o,config:l}=e,u=l.legend,c=new hPn({},kPn(e,t));u4n(e,t,c);const f=s!==void 0?!s:u.disable;if(c.set("disable",f,s!==void 0),f)return c;s=s||{};const h=e.getScaleComponent(t).get("type"),d=Ti(o[t]),p=Le(d)?(n=wo(d.timeUnit))===null||n===void 0?void 0:n.unit:void 0,g=s.orient||l.legend.orient||"right",m=bPn({legend:s,channel:t,timeUnit:p,scaleType:h}),v=wPn({legend:s,legendType:m,orient:g,legendConfig:u}),y={legend:s,channel:t,model:e,markDef:a,encoding:o,fieldOrDatumDef:d,legendConfig:u,config:l,scaleType:h,orient:g,legendType:m,direction:v};for(const $ of cXe){const _=$ in $_e?$_e[$](y):s[$];if(_!==void 0){const k=EPn(_,$,s,e.fieldDef(t));(k||l.legend[$]===void 0)&&c.set($,_,k)}}const b=(r=s==null?void 0:s.encoding)!==null&&r!==void 0?r:{},x=c.get("selections"),w={},C={fieldOrDatumDef:d,model:e,channel:t,legendCmpt:c,legendType:m};for(const $ of["labels","legend","title","symbols","gradient","entries"]){const _=uXe((i=b[$])!==null&&i!==void 0?i:{},e),k=$ in w_e?w_e[$](_,C):_;k!==void 0&&!er(k)&&(w[$]=Object.assign(Object.assign(Object.assign({},(x==null?void 0:x.length)&&Le(d)?{name:`${Er(d.field)}_legend_${$}`}:{}),x!=null&&x.length?{interactive:!!x}:{}),{update:k}))}return er(w)||c.set("encode",w,!!(s!=null&&s.encoding)),c}function TPn(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){pXe(r);for(const i of Ne(r.component.legends))n.legend[i]=nhe(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=gXe(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of Ne(t))for(const i of e.children)!i.component.legends[r]||n.legend[r]==="shared"&&delete i.component.legends[r];return t}function gXe(e,t){var n,r,i,s;if(!e)return t.clone();const a=e.getWithExplicit("orient"),o=t.getWithExplicit("orient");if(a.explicit&&o.explicit&&a.value!==o.value)return;let l=!1;for(const u of cXe){const c=Am(e.getWithExplicit(u),t.getWithExplicit(u),u,"legend",(f,h)=>{switch(u){case"symbolType":return DPn(f,h);case"title":return JGe(f,h);case"type":return l=!0,xl("symbol")}return GW(f,h,u,"legend")});e.setWithExplicit(u,c)}return l&&(!((r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0)&&r.gradient&&gJ(e.implicit,["encode","gradient"]),!((s=(i=e.explicit)===null||i===void 0?void 0:i.encode)===null||s===void 0)&&s.gradient&&gJ(e.explicit,["encode","gradient"])),e}function DPn(e,t){return t.value==="circle"?t:e}function __e(e,t,n,r){var i,s,a;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(s=e.encode[t])!==null&&s!==void 0?s:{},e.encode[t].update=(a=e.encode[t].update)!==null&&a!==void 0?a:{},e.encode[t].update[n]=r}function mXe(e){const t=e.component.legends,n={};for(const i of Ne(t)){const s=e.getScaleComponent(i),a=Sr(s.get("domains"));if(n[a])for(const o of n[a])gXe(o,t[i])||n[a].push(t[i]);else n[a]=[t[i].clone()]}return k0(n).flat().map(i=>IPn(i,e.config)).filter(i=>i!==void 0)}function IPn(e,t){var n,r,i;const s=e.combine(),{disable:a,labelExpr:o,selections:l}=s,u=it(s,["disable","labelExpr","selections"]);if(!a){if(t.aria===!1&&u.aria==null&&(u.aria=!1),!((n=u.encode)===null||n===void 0)&&n.symbols){const c=u.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!u.stroke&&(c.stroke={value:"transparent"});for(const f of dYe)u[f]&&delete c[f]}if(u.title||delete u.title,o!==void 0){let c=o;((i=(r=u.encode)===null||r===void 0?void 0:r.labels)===null||i===void 0?void 0:i.update)&&wt(u.encode.labels.update.text)&&(c=X$(o,"datum.label",u.encode.labels.update.text.signal)),__e(u,"labels","text",{signal:c})}for(const c in u){const f=u[c];if(wt(f)){const h=LOn[c];if(h){const{vgProp:d,part:p}=h;__e(u,p,d,f),delete u[c]}}}return u}}function NPn(e){return AS(e)||ahe(e)?MPn(e):vXe(e)}function MPn(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),vXe(e))}function vXe(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(a=>a.signal).join(", ")}]`},s=t.data.reduce((a,o)=>{const l=wt(o)?o.signal:`data('${e.lookupDataSource(o)}')`;return ht(a,l)||a.push(l),a},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]}},n)]}else return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const FPn=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class yXe extends wg{constructor(t,n,r,i){super(Object.assign({},n),{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function bXe(e){e.component.projection=qr(e)?OPn(e):LPn(e)}function OPn(e){var t;if(e.hasProjection){const n=e.specifiedProjection,r=!(n&&(n.scale!=null||n.translate!=null)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,s=r?RPn(e):void 0;return new yXe(e.projectionName(!0),Object.assign(Object.assign({},(t=e.config.projection)!==null&&t!==void 0?t:{}),n!=null?n:{}),i,s)}}function RPn(e){const t=[],{encoding:n}=e;for(const r of[[wd,xd],[Wu,$f]])(Ti(n[r[0]])||Ti(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(dl)&&e.typedFieldDef(dl).type===CS&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(fa)),t}function PPn(e,t){const n=Iqe(FPn,i=>!!(!H1(e.explicit,i)&&!H1(t.explicit,i)||H1(e.explicit,i)&&H1(t.explicit,i)&&Sr(e.get(i))===Sr(t.get(i))));if(Sr(e.size)===Sr(t.size)){if(n)return e;if(Sr(e.explicit)===Sr({}))return t;if(Sr(t.explicit)===Sr({}))return e}return null}function LPn(e){if(e.children.length===0)return;let t;for(const r of e.children)bXe(r);const n=Iqe(e.children,r=>{const i=r.component.projection;if(i)if(t){const s=PPn(t,i);return s&&(t=s),!!s}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new yXe(r,t.specifiedProjection,t.size,Gt(t.data));for(const s of e.children){const a=s.component.projection;a&&(a.isFit&&i.data.push(...s.component.projection.data),s.renameProjection(a.get("name"),r),a.merged=!0)}return i}}function BPn(e,t,n,r){var i,s;if(vF(t,n)){const a=qr(e)?(s=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&s!==void 0?s:{}:{},o=Me(t,{expr:"datum"}),l=Me(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Me(t,{binSuffix:"range",forAs:!0}),formula:BW(o,l,a.format,a.formatType,r)}}return{}}function xXe(e,t){return`${tGe(e)}_${t}`}function zPn(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function rhe(e,t,n){var r;const i=(r=VW(n,void 0))!==null&&r!==void 0?r:{},s=xXe(i,t);return e.getName(`${s}_bins`)}function UPn(e){return"as"in e}function S_e(e,t,n){let r,i;UPn(e)?r=qt(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Me(e,{forAs:!0}),Me(e,{binSuffix:"end",forAs:!0})];const s=Object.assign({},VW(t,void 0)),a=xXe(s,e.field),{signal:o,extentSignal:l}=zPn(n,a);if(PW(s.extent)){const c=s.extent,f=c.selection;i=ZYe(n.getSelectionComponent(Er(f),f),c),delete s.extent}const u=Object.assign(Object.assign(Object.assign({bin:s,field:e.field,as:[r]},o?{signal:o}:{}),l?{extentSignal:l}:{}),i?{span:i}:{});return{key:a,binComponent:u}}class wh extends Kn{constructor(t,n){super(t),this.bins=n}clone(){return new wh(null,Gt(this.bins))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,s,a)=>{if(Kl(s)&&hr(s.bin)){const{key:o,binComponent:l}=S_e(s,s.bin,n);i[o]=Object.assign(Object.assign(Object.assign({},l),i[o]),BPn(n,s,a,n.config))}return i},{});return er(r)?null:new wh(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:s}=S_e(n,n.bin,r);return new wh(t,{[i]:s})}merge(t,n){for(const r of Ne(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=o0([...this.bins[r].as,...t.bins[r].as],pn)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(k0(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(k0(this.bins).map(t=>t.field))}hash(){return`Bin ${pn(this.bins)}`}assemble(){return k0(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,s=t.bin,{extent:a}=s,o=it(s,["extent"]),l=Object.assign(Object.assign(Object.assign({type:"bin",field:Sm(t.field),as:r,signal:t.signal},PW(a)?{extent:null}:{extent:a}),t.span?{span:{signal:`span(${t.span})`}}:{}),o);!a&&t.extentSignal&&(n.push({type:"extent",field:Sm(t.field),signal:t.extentSignal}),l.extent={signal:t.extentSignal}),n.push(l);for(const u of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:Me({field:r[c]},{expr:"datum"}),as:u[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class rC extends Kn{constructor(t){super(null),t=t!=null?t:{name:"source"};let n;if(xy(t)||(n=t.format?Object.assign({},$p(t.format,["parse"])):{}),kB(t))this._data={values:t.values};else if(RD(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];ht(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else CYe(t)?this._data={values:[{type:"Sphere"}]}:(wYe(t)||xy(t))&&(this._data={});this._generator=xy(t),t.name&&(this._name=t.name),n&&!er(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function MJ(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return console.error("Dataflow graph is inconsistent.",t,n),!1;if(!MJ(t.children))return!1}return!0}class CF extends Kn{constructor(t,n){super(t),this.params=n}clone(){return new CF(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${pn(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class _F extends Kn{constructor(t,n){super(t),this.params=n}clone(){return new _F(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${pn(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}function nV(e){return e instanceof rC||e instanceof CF||e instanceof _F}class wXe{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class $g extends wXe{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:n}){t&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(nV(t))return!1;const n=t.parent,{continueFlag:r}=this.run(t);return r&&this.optimizeNextFromLeaves(n),this.mutatedFlag}}class ihe extends wXe{}function WPn(e,t,n,r){const i=qr(r)?r.encoding[_d(t)]:void 0;if(Kl(n)&&qr(r)&&kfe(t,n,i,r.stack,r.markDef,r.config))e.add(Me(n,{})),e.add(Me(n,{suffix:"end"})),n.bin&&vF(n,t)&&e.add(Me(n,{binSuffix:"range"}));else if(ZNn(t)){const s=KNn(t);e.add(r.getName(s))}else e.add(Me(n));return e}function VPn(e,t){var n;for(const r of Ne(t)){const i=t[r];for(const s of Ne(i))r in e?e[r][s]=new Set([...(n=e[r][s])!==null&&n!==void 0?n:[],...i[s]]):e[r]={[s]:i[s]}}}class jc extends Kn{constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}clone(){return new jc(null,new Set(this.dimensions),Gt(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(a=>{a.aggregate&&(r=!0)});const i={},s=new Set;return!r||(n.forEachFieldDef((a,o)=>{var l,u,c,f;const{aggregate:h,field:d}=a;if(h)if(h==="count")i["*"]=(l=i["*"])!==null&&l!==void 0?l:{},i["*"].count=new Set([Me(a,{forAs:!0})]);else{if(km(h)||Bx(h)){const p=km(h)?"argmin":"argmax",g=h[p];i[g]=(u=i[g])!==null&&u!==void 0?u:{},i[g][p]=new Set([Me({op:p,field:g},{forAs:!0})])}else i[d]=(c=i[d])!==null&&c!==void 0?c:{},i[d][h]=new Set([Me(a,{forAs:!0})]);gv(o)&&n.scaleDomain(o)==="unaggregated"&&(i[d]=(f=i[d])!==null&&f!==void 0?f:{},i[d].min=new Set([Me({field:d,aggregate:"min"},{forAs:!0})]),i[d].max=new Set([Me({field:d,aggregate:"max"},{forAs:!0})]))}else WPn(s,o,a,n)}),s.size+Ne(i).length===0)?null:new jc(t,s,i)}static makeFromTransform(t,n){var r,i,s;const a=new Set,o={};for(const l of n.aggregate){const{op:u,field:c,as:f}=l;u&&(u==="count"?(o["*"]=(r=o["*"])!==null&&r!==void 0?r:{},o["*"].count=new Set([f||Me(l,{forAs:!0})])):(o[c]=(i=o[c])!==null&&i!==void 0?i:{},o[c][u]=new Set([f||Me(l,{forAs:!0})])))}for(const l of(s=n.groupby)!==null&&s!==void 0?s:[])a.add(l);return a.size+Ne(o).length===0?null:new jc(t,a,o)}merge(t){return bNn(this.dimensions,t.dimensions)?(VPn(this.measures,t.measures),!0):(uFn("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Ne(this.measures)])}producedFields(){const t=new Set;for(const n of Ne(this.measures))for(const r of Ne(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${pn({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const s of Ne(this.measures))for(const a of Ne(this.measures[s]))for(const o of this.measures[s][a])r.push(o),t.push(a),n.push(s==="*"?null:Sm(s));return{type:"aggregate",groupby:[...this.dimensions].map(Sm),ops:t,fields:n,as:r}}}class kS extends Kn{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(const s of ku){const a=n.facet[s];if(a){const{bin:o,sort:l}=a;this[s]=Object.assign({name:n.getName(`${s}_domain`),fields:[Me(a),...hr(o)?[Me(a,{binSuffix:"end"})]:[]]},bh(l)?{sortField:l}:ut(l)?{sortIndexField:tC(a,s)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of ku)this[n]&&(t+=` ${n.charAt(0)}:${pn(this[n])}`);return t}get fields(){var t;const n=[];for(const r of ku)!((t=this[r])===null||t===void 0)&&t.fields&&n.push(...this[r].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of ku)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Vu){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),s=r.get("range");if(pl(i)&&mv(s)){const a=rV(this.childModel,n),o=she(a);o?t[n]=o:Te(`Unknown field for ${n}. Cannot calculate view size.`)}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x"}[t],s=[],a=[],o=[];r&&r[i]&&(n?(s.push(`distinct_${r[i]}`),a.push("max")):(s.push(r[i]),a.push("distinct")),o.push(`distinct_${r[i]}`));const{sortField:l,sortIndexField:u}=this[t];if(l){const{op:c=zW,field:f}=l;s.push(f),a.push(c),o.push(Me(l,{forAs:!0}))}else u&&(s.push(u),a.push("max"),o.push(u));return{name:this[t].name,source:n!=null?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},s.length?{fields:s,ops:a,as:o}:{})]}}assembleFacetHeaderData(t){var n,r;const{columns:i}=this.model.layout,{layoutHeaders:s}=this.model.component,a=[],o={};for(const c of Jfe){for(const f of ehe){const h=(n=s[c]&&s[c][f])!==null&&n!==void 0?n:[];for(const d of h)if(((r=d.axes)===null||r===void 0?void 0:r.length)>0){o[c]=!0;break}}if(o[c]){const f=`length(data("${this.facet.name}"))`,h=c==="row"?i?{signal:`ceil(${f} / ${i})`}:1:i?{signal:`min(${f}, ${i})`}:{signal:f};a.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:h}]})}}const{row:l,column:u}=o;return(l||u)&&a.unshift(this.assembleRowColumnHeaderData("facet",null,t)),a}assemble(){var t,n;const r=[];let i=null;const s=this.getChildIndependentFieldsWithStep(),{column:a,row:o,facet:l}=this;if(a&&o&&(s.x||s.y)){i=`cross_${this.column.name}_${this.row.name}`;const u=[].concat((t=s.x)!==null&&t!==void 0?t:[],(n=s.y)!==null&&n!==void 0?n:[]),c=u.map(()=>"distinct");r.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:u,ops:c}]})}for(const u of[_p,Cp])this[u]&&r.push(this.assembleRowColumnHeaderData(u,i,s));if(l){const u=this.assembleFacetHeaderData(s);u&&r.push(...u)}return r}}function k_e(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function jPn(e,t){const n=Oqe(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.indexOf("date:")===0){const r=k_e(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.indexOf("utc:")===0){const r=k_e(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return Te(wMn(t)),null}function HPn(e){const t={};return q4(e.filter,n=>{var r;if(yGe(n)){let i=null;gfe(n)?i=n.equal:mfe(n)?i=n.range[0]:vfe(n)&&(i=((r=n.oneOf)!==null&&r!==void 0?r:n.in)[0]),i&&(wS(i)?t[n.field]="date":yi(i)?t[n.field]="number":qt(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function qPn(e){const t={};function n(r){jW(r)?t[r.field]="date":r.type==="quantitative"&&HNn(r.aggregate)?t[r.field]="number":ND(r.field)>1?r.field in t||(t[r.field]="flatten"):Tfe(r)&&bh(r.sort)&&ND(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((qr(e)||Hc(e))&&e.forEachFieldDef((r,i)=>{if(Kl(r))n(r);else{const s=Ux(i),a=e.fieldDef(s);n(Object.assign(Object.assign({},r),{type:a.type}))}}),qr(e)){const{mark:r,markDef:i,encoding:s}=e;if(Lx(r)&&!e.encoding.order){const a=i.orient==="horizontal"?"y":"x",o=s[a];Le(o)&&o.type==="quantitative"&&!(o.field in t)&&(t[o.field]="number")}}return t}function GPn(e){const t={};if(qr(e)&&e.component.selection)for(const n of Ne(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&ND(i.field)>1&&(t[i.field]="flatten")}return t}class ba extends Kn{constructor(t,n){super(t),this._parse=n}clone(){return new ba(null,Gt(this._parse))}hash(){return`Parse ${pn(this._parse)}`}static makeExplicit(t,n,r){let i={};const s=n.data;return!xy(s)&&s&&s.format&&s.format.parse&&(i=s.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const o of Ne(r)){const l=i.getWithExplicit(o);l.value!==void 0&&(l.explicit||l.value===r[o]||l.value==="derived"||r[o]==="flatten"?delete r[o]:Te(PCe(o,r[o],l.value)))}for(const o of Ne(n)){const l=i.get(o);l!==void 0&&(l===n[o]?delete n[o]:Te(PCe(o,n[o],l)))}const s=new wg(n,r);i.copyAll(s);const a={};for(const o of Ne(s.combine())){const l=s.get(o);l!==null&&(a[o]=l)}return Ne(a).length===0||i.parseNothing?null:new ba(t,a)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of Ne(this._parse)){const r=this._parse[n];ND(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(Ne(this._parse))}dependentFields(){return new Set(Ne(this._parse))}assembleTransforms(t=!1){return Ne(this._parse).filter(n=>t?ND(n)>1:!0).map(n=>{const r=jPn(n,this._parse[n]);return r?{type:"formula",expr:r,as:Rqe(n)}:null}).filter(n=>n!==null)}}class Im extends Kn{clone(){return new Im(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Q$])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Q$}}}class jx extends Kn{constructor(t,n){super(t),this.transform=n}clone(){return new jx(null,Gt(this.transform))}addDimensions(t){this.transform.groupby=o0(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Me(t)}hash(){return`JoinAggregateTransform ${pn(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const s of this.transform.joinaggregate)n.push(s.op),r.push(this.getDefaultName(s)),t.push(s.field===void 0?null:s.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},i!==void 0?{groupby:i}:{})}}function YPn(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Me(r);return i&&t.push(i),t},[])}function XPn(e){return ut(e)&&e.every(t=>qt(t))&&e.length>1}class kp extends Kn{constructor(t,n){super(t),this._stack=n}clone(){return new kp(null,Gt(this._stack))}static makeFromTransform(t,n){const{stack:r,groupby:i,as:s,offset:a="zero"}=n,o=[],l=[];if(n.sort!==void 0)for(const f of n.sort)o.push(f.field),l.push(bi(f.order,"ascending"));const u={field:o,order:l};let c;return XPn(s)?c=s:qt(s)?c=[s,s+"_end"]:c=[n.stack+"_start",n.stack+"_end"],new kp(t,{stackField:r,groupby:i,offset:a,sort:u,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannel:s,fieldChannel:a,offset:o,impute:l}=r;let u;if(s){const d=i[s];u=Zh(d)}const c=YPn(n),f=n.encoding.order;let h;return ut(f)||Le(f)?h=KGe(f):h=c.reduce((d,p)=>(d.field.push(p),d.order.push(a==="y"?"descending":"ascending"),d),{field:[],order:[]}),new kp(t,{dimensionFieldDef:u,stackField:n.vgField(a),facetby:[],stackby:c,sort:h,offset:o,impute:l,as:[n.vgField(a,{suffix:"start",forAs:!0}),n.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${pn(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:r}=this._stack;return t?t.bin?n?[Me(t,{binSuffix:"mid"})]:[Me(t,{}),Me(t,{binSuffix:"end"})]:[Me(t)]:r!=null?r:[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:r,stackField:i,stackby:s,sort:a,offset:o,impute:l,as:u}=this._stack;if(l&&r){const{band:c=.5,bin:f}=r;f&&t.push({type:"formula",expr:`${c}*`+Me(r,{expr:"datum"})+`+${1-c}*`+Me(r,{expr:"datum",binSuffix:"end"}),as:Me(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[...s,...n],key:Me(r,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:a,as:u,offset:o}),t}}class ES extends Kn{constructor(t,n){super(t),this.transform=n}clone(){return new ES(null,Gt(this.transform))}addDimensions(t){this.transform.groupby=o0(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const r=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(r.add,r),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(i=>r.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>i!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Me(t)}hash(){return`WindowTransform ${pn(this.transform)}`}assemble(){var t;const n=[],r=[],i=[],s=[];for(const h of this.transform.window)r.push(h.op),i.push(this.getDefaultName(h)),s.push(h.param===void 0?null:h.param),n.push(h.field===void 0?null:h.field);const a=this.transform.frame,o=this.transform.groupby;if(a&&a[0]===null&&a[1]===null&&r.every(h=>sfe(h)))return Object.assign({type:"joinaggregate",as:i,ops:r,fields:n},o!==void 0?{groupby:o}:{});const l=[],u=[];if(this.transform.sort!==void 0)for(const h of this.transform.sort)l.push(h.field),u.push((t=h.order)!==null&&t!==void 0?t:"ascending");const c={field:l,order:u},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:s,as:i,ops:r,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),o!==void 0?{groupby:o}:{}),a!==void 0?{frame:a}:{})}}class KPn extends $g{run(t){const n=t.parent;if(t instanceof ba){if(nV(n))return this.flags;if(n.numChildren()>1)return this.setContinue(),this.flags;if(n instanceof ba)this.setMutated(),n.merge(t);else{if(Mqe(n.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class ZPn extends ihe{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of Ne(r))r[i].length>1&&(this.setMutated(),this.mergeNodes(t,r[i]));for(const i of t.children)this.run(i);return this.mutatedFlag}}class QPn extends $g{run(t){return t instanceof co||t.numChildren()>0||t instanceof kS?this.flags:(this.setMutated(),t.remove(),this.flags)}}class JPn extends $g{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof xh){const n=t.producedFields();Nqe(n,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...n]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class eLn extends $g{run(t){this.setContinue();const r=t.parent.children.filter(s=>s instanceof xh),i=r.pop();for(const s of r)this.setMutated(),i.merge(s);return this.flags}}function tLn(e){function t(n){if(!(n instanceof kS)){const r=n.clone();if(r instanceof co){const i=OJ+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof jc||r instanceof kp||r instanceof ES||r instanceof jx)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function FJ(e){if(e instanceof kS)if(e.numChildren()===1&&!(e.children[0]instanceof co)){const t=e.children[0];(t instanceof jc||t instanceof kp||t instanceof ES||t instanceof jx)&&t.addDimensions(e.fields),t.swapWithParent(),FJ(e)}else{const t=e.model.component.data.main;$Xe(t);const n=tLn(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(FJ)}function $Xe(e){if(e instanceof co&&e.type===fa&&e.numChildren()===1){const t=e.children[0];t instanceof kS||(t.swapWithParent(),$Xe(e))}}class nLn extends ihe{constructor(){super()}run(t){t instanceof co&&!t.isRequired()&&(this.setMutated(),t.remove());for(const n of t.children)this.run(n);return this.mutatedFlag}}class rLn extends ihe{constructor(t){super(),this.requiresSelectionId=t&&Xfe(t)}run(t){t instanceof Im&&(this.requiresSelectionId&&(nV(t.parent)||t.parent instanceof jc||t.parent instanceof ba)||(this.setMutated(),t.remove()));for(const n of t.children)this.run(n);return this.mutatedFlag}}class iLn extends $g{run(t){const n=t.parent,r=[...n.children],i=n.children.filter(s=>s instanceof ba);if(n.numChildren()>1&&i.length>=1){const s={},a=new Set;for(const o of i){const l=o.parse;for(const u of Ne(l))u in s?s[u]!==l[u]&&a.add(u):s[u]=l[u]}for(const o of a)delete s[o];if(!er(s)){this.setMutated();const o=new ba(n,s);for(const l of r){if(l instanceof ba)for(const u of Ne(s))delete l.parse[u];n.removeChild(l),l.parent=o,l instanceof ba&&Ne(l.parse).length===0&&l.remove()}}}return this.setContinue(),this.flags}}class sLn extends $g{run(t){const n=t.parent,r=n.children.filter(s=>s instanceof jc),i={};for(const s of r){const a=pn(s.groupBy);a in i||(i[a]=[]),i[a].push(s)}for(const s of Ne(i)){const a=i[s];if(a.length>1){const o=a.pop();for(const l of a)o.merge(l)&&(n.removeChild(l),l.parent=o,l.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class aLn extends $g{constructor(t){super(),this.model=t}run(t){const n=t.parent,r=!(nV(n)||n instanceof SS||n instanceof ba||n instanceof Im),i=[],s=[];for(const a of n.children)a instanceof wh&&(r&&!Mqe(n.producedFields(),a.dependentFields())?i.push(a):s.push(a));if(i.length>0){const a=i.pop();for(const o of i)a.merge(o,this.model.renameSignal.bind(this.model));this.setMutated(),n instanceof wh?n.merge(a,this.model.renameSignal.bind(this.model)):a.swapWithParent()}if(s.length>1){const a=s.pop();for(const o of s)a.merge(o,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class oLn extends $g{run(t){const n=t.parent,r=[...n.children];if(!ID(r,o=>o instanceof co)||n.numChildren()<=1)return this.setContinue(),this.flags;const s=[];let a;for(const o of r)if(o instanceof co){let l=o;for(;l.numChildren()===1;){const u=l.children[0];if(u instanceof co)l=u;else break}s.push(...l.children),a?(n.removeChild(o),o.parent=a.parent,a.parent.removeChild(a),a.parent=l,this.setMutated()):a=l}else s.push(o);if(s.length){this.setMutated();for(const o of s)o.parent.removeChild(o),o.parent=a}return this.setContinue(),this.flags}}const OJ="scale_",NR=5;function Dg(e){const t=[];function n(r){if(r.numChildren()===0)t.push(r);else for(const i of r.children)n(i)}for(const r of e)n(r);return t}function lLn(e){return e}function rc(e,t){return t.map(r=>{if(e instanceof $g){const i=e.optimizeNextFromLeaves(r);return e.reset(),i}else return e.run(r)}).some(lLn)}function E_e(e,t){let n=e.sources;const r=new Set;return r.add(rc(new nLn,n)),r.add(rc(new rLn(t),n)),n=n.filter(i=>i.numChildren()>0),r.add(rc(new QPn,Dg(n))),n=n.filter(i=>i.numChildren()>0),r.add(rc(new KPn,Dg(n))),r.add(rc(new aLn(t),Dg(n))),r.add(rc(new JPn,Dg(n))),r.add(rc(new iLn,Dg(n))),r.add(rc(new sLn,Dg(n))),r.add(rc(new eLn,Dg(n))),r.add(rc(new ZPn,n)),r.add(rc(new oLn,Dg(n))),e.sources=n,r.has(!0)}function uLn(e,t){MJ(e.sources);let n=0,r=0;for(let i=0;i<NR&&E_e(e,t);i++)n++;e.sources.map(FJ);for(let i=0;i<NR&&E_e(e,t);i++)r++;MJ(e.sources),Math.max(n,r)===NR&&Te(`Maximum optimization runs(${NR}) reached.`)}class Ll{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Ll(()=>t(n))}}function CXe(e){qr(e)?cLn(e):fLn(e)}function cLn(e){const t=e.component.scales;for(const n of Ne(t)){const r=dLn(e,n);if(t[n].setWithExplicit("domains",r),gLn(e,n),e.component.data.isFaceted){let s=e;for(;!Hc(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[n]==="shared")for(const o of r.value)l0(o)&&(o.data=OJ+o.data.replace(OJ,""))}}}function fLn(e){for(const n of e.children)CXe(n);const t=e.component.scales;for(const n of Ne(t)){let r,i=null;for(const s of e.children){const a=s.component.scales[n];if(a){r===void 0?r=a.getWithExplicit("domains"):r=Am(r,a.getWithExplicit("domains"),"domains","scale",RJ);const o=a.get("selectionExtent");i&&o&&i.selection!==o.selection&&Te("The same selection must be used to override scale domains in a layered view."),i=o}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function hLn(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:s}=A_e(t,n);if(!i){Te(s);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=A_e(t,n);if(i)return"unaggregated"}return e}function dLn(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=hLn(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),t==="x"&&Ti(r.x2)?Ti(r.x)?Am(Ng(n,i,e,"x"),Ng(n,i,e,"x2"),"domain","scale",RJ):Ng(n,i,e,"x2"):t==="y"&&Ti(r.y2)?Ti(r.y)?Am(Ng(n,i,e,"y"),Ng(n,i,e,"y2"),"domain","scale",RJ):Ng(n,i,e,"y2"):Ng(n,i,e,t)}function pLn(e,t,n){return e.map(r=>({signal:`{data: ${Nfe(r,{timeUnit:n,type:t})}}`}))}function DG(e,t,n){var r;const i=(r=wo(n))===null||r===void 0?void 0:r.unit;return t==="temporal"||i?pLn(e,t,i):[e]}function Ng(e,t,n,r){const{encoding:i}=n,s=Ti(i[r]),{type:a}=s,o=s.timeUnit;if(XFn(t)){const f=Ng(e,void 0,n,r),h=DG(t.unionWith,a,o);return q1([...f.value,...h])}else{if(wt(t))return q1([t]);if(t&&t!=="unaggregated"&&!wGe(t))return q1(DG(t,a,o))}const l=n.stack;if(l&&r===l.fieldChannel){if(l.offset==="normalize")return xl([[0,1]]);const f=n.requestDataName(fa);return xl([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const u=gv(r)&&Le(s)?mLn(n,r,e):void 0;if(vv(s)){const f=DG([s.datum],a,o);return xl(f)}const c=s;if(t==="unaggregated"){const f=n.requestDataName(fa),{field:h}=s;return xl([{data:f,field:Me({field:h,aggregate:"min"})},{data:f,field:Me({field:h,aggregate:"max"})}])}else if(hr(c.bin)){if(pl(e))return xl(e==="bin-ordinal"?[]:[{data:gB(u)?n.requestDataName(fa):n.requestDataName(EB),field:n.vgField(r,vF(c,r)?{binSuffix:"range"}:{}),sort:u===!0||!ds(u)?{field:n.vgField(r,{}),op:"min"}:u}]);{const{bin:f}=c;if(hr(f)){const h=rhe(n,c.field,f);return xl([new Ll(()=>{const d=n.getSignalName(h);return`[${d}.start, ${d}.stop]`})])}else return xl([{data:n.requestDataName(fa),field:n.vgField(r,{})}])}}else if(c.timeUnit&&ht(["time","utc"],e)&&kfe(r,c,qr(n)?n.encoding[_d(r)]:void 0,n.stack,n.markDef,n.config)){const f=n.requestDataName(fa);return xl([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return xl(u?[{data:gB(u)?n.requestDataName(fa):n.requestDataName(EB),field:n.vgField(r),sort:u}]:[{data:n.requestDataName(fa),field:n.vgField(r)}])}function IG(e,t){const{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:n!=null?n:t?"sum":zW},r?{field:Sm(r)}:{}),i?{order:i}:{})}function gLn(e,t){var n;const r=e.component.scales[t],i=e.specifiedScales[t].domain,s=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,a=wGe(i)&&i,o=pF(s)&&PW(s.extent)&&s.extent;(a||o)&&r.set("selectionExtent",a!=null?a:o,!0)}function mLn(e,t,n){if(!pl(n))return;const r=e.fieldDef(t),i=r.sort;if(OGe(i))return{op:"min",field:tC(r,t),order:"ascending"};const{stack:s}=e,a=s?[...s.groupbyField?[s.groupbyField]:[],...s.stackBy.map(o=>o.fieldDef.field)]:void 0;if(bh(i)){const o=s&&!ht(a,i.field);return IG(i,o)}else if(FGe(i)){const{encoding:o,order:l}=i,u=e.fieldDef(o),{aggregate:c,field:f}=u,h=s&&!ht(a,f);if(km(c)||Bx(c))return IG({field:Me(u),order:l},h);if(sfe(c)||!c)return IG({op:c,field:f,order:l},h)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(ht(["ascending",void 0],i))return!0}}function A_e(e,t){const{aggregate:n,type:r}=e;return n?qt(n)&&!YNn[n]?{valid:!1,reason:zMn(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:UMn(e)}:{valid:!0}:{valid:!1,reason:BMn(e)}}function RJ(e,t,n,r){return e.explicit&&t.explicit&&Te(qMn(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function vLn(e){const t=o0(e.map(a=>l0(a)?it(a,["sort"]):a),pn),n=o0(e.map(a=>{if(l0(a)){const o=a.sort;return o!==void 0&&!gB(o)&&("op"in o&&o.op==="count"&&delete o.field,o.order==="ascending"&&delete o.order),o}}).filter(a=>a!==void 0),pn);if(t.length===0)return;if(t.length===1){const a=e[0];if(l0(a)&&n.length>0){let o=n[0];if(n.length>1)Te(BCe),o=!0;else if(ds(o)&&"field"in o){const l=o.field;a.field===l&&(o=o.order?{order:o.order}:!0)}return Object.assign(Object.assign({},a),{sort:o})}return a}const r=o0(n.map(a=>gB(a)||!("op"in a)||a.op in VNn?a:(Te(YMn(a)),!0)),pn);let i;r.length===1?i=r[0]:r.length>1&&(Te(BCe),i=!0);const s=o0(e.map(a=>l0(a)?a.data:null),a=>a);return s.length===1&&s[0]!==null?Object.assign({data:s[0],fields:t.map(o=>o.field)},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}function she(e){if(l0(e)&&qt(e.field))return e.field;if(CFn(e)){let t;for(const n of e.fields)if(l0(n)&&qt(n.field)){if(!t)t=n.field;else if(t!==n.field)return Te(XMn),t}return Te(KMn),t}else if(_Fn(e)){Te(ZMn);const t=e.fields[0];return qt(t)?t:void 0}}function rV(e,t){const r=e.component.scales[t].get("domains").map(i=>(l0(i)&&(i.data=e.lookupDataSource(i.data)),i));return vLn(r)}function _Xe(e){return AS(e)||ahe(e)?e.children.reduce((t,n)=>t.concat(_Xe(n)),T_e(e)):T_e(e)}function T_e(e){return Ne(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:s,type:a,selectionExtent:o,domains:l,range:u,reverse:c}=i,f=it(i,["name","type","selectionExtent","domains","range","reverse"]),h=yLn(i.range,s,n);let d;o&&(d=y4n(e,o));const p=rV(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:s,type:a},p?{domain:p}:{}),d?{domainRaw:d}:{}),{range:h}),c!==void 0?{reverse:c}:{}),f)),t},[])}function yLn(e,t,n){return Kh(n)&&mv(e)?{step:{signal:t+"_step"}}:e}class SXe extends wg{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:ID(this.get("domains"),t=>ut(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const bLn=["range","scheme"];function kXe(e){return e==="x"?"width":e==="y"?"height":void 0}function xLn(e){const t=e.component.scales;for(const n of RW){const r=t[n];if(!r)continue;const i=wLn(n,e);r.setWithExplicit("range",i)}}function D_e(e,t){const n=e.fieldDef(t);if(n&&n.bin&&hr(n.bin)){const r=rhe(e,n.field,n.bin),i=kXe(t),s=e.getName(i);return new Ll(()=>{const a=e.getSignalName(r),o=`(${a}.stop - ${a}.start) / ${a}.step`;return`${e.getSignalName(s)} / (${o})`})}}function wLn(e,t){const n=t.specifiedScales[e],{size:r}=t,s=t.getScaleComponent(e).get("type");for(const a of bLn)if(n[a]!==void 0){const o=$Ge(s,a),l=CGe(e,a);if(!o)Te(sGe(s,a,e));else if(l)Te(l);else switch(a){case"range":return ut(n.range)&&Kh(e)?q1(n.range.map(u=>{if(u==="width"||u==="height"){const c=t.getName(u),f=t.getSignalName.bind(t);return Ll.fromName(f,c)}return u})):q1(n.range);case"scheme":return q1($Ln(n[a]))}}if(e===Ur||e===Ni){const a=e===Ur?"width":"height",o=r[a];if(Qh(o)){if(pl(s))return q1({step:o.step});Te(aGe(a))}}return xl(CLn(e,t))}function $Ln(e){return YFn(e)?Object.assign({scheme:e.name},$p(e,["name"])):{scheme:e}}function CLn(e,t){const{size:n,config:r,mark:i,encoding:s}=t,a=t.getSignalName.bind(t),{type:o}=Ti(s[e]),u=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case Ur:case Ni:{if(ht(["point","band"],u)){if(e===Ur&&!n.width){const p=OD(r.view,"width");if(Qh(p))return p}else if(e===Ni&&!n.height){const p=OD(r.view,"height");if(Qh(p))return p}}const h=kXe(e),d=t.getName(h);return e===Ni&&ju(u)?[Ll.fromName(a,d),0]:[0,Ll.fromName(a,d)]}case bg:{const h=t.component.scales[e].get("zero"),d=EXe(i,h,r),p=kLn(i,n,t,r);return bB(u)?SLn(d,p,_Ln(u,r,c,e)):[d,p]}case wf:return[0,Math.PI*2];case zx:return[0,360];case bd:return[0,new Ll(()=>{const h=t.getSignalName("width"),d=t.getSignalName("height");return`min(${h},${d})/2`})];case hv:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case dv:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case dl:return"symbol";case hl:case $d:case Cd:return u==="ordinal"?o==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case xg:case cv:case fv:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function _Ln(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&ut(n)?n.length+1:(Te(aFn(r)),3)}}function SLn(e,t,n){const r=()=>{const i=FD(t),s=FD(e),a=`(${i} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${i} + ${a}, ${a})`};return wt(t)?new Ll(r):{signal:r()}}function EXe(e,t,n){if(t)return wt(t)?{signal:`${t.signal} ? 0 : ${EXe(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(LW("size",e))}const I_e=.95;function kLn(e,t,n,r){const i={x:D_e(n,"x"),y:D_e(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const s=N_e(t,i,r.view);return yi(s)?s-1:new Ll(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const s=N_e(t,i,r.view);return yi(s)?Math.pow(I_e*s,2):new Ll(()=>`pow(${I_e} * ${s.signal}, 2)`)}}throw new Error(LW("size",e))}function N_e(e,t,n){const r=Qh(e.width)?e.width.step:SB(n,"width"),i=Qh(e.height)?e.height.step:SB(n,"height");return t.x||t.y?new Ll(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function AXe(e,t){qr(e)?ELn(e,t):DXe(e,t)}function ELn(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:s,specifiedScales:a}=e;for(const o of Ne(n)){const l=a[o],u=n[o],c=e.getScaleComponent(o),f=Ti(i[o]),h=l[t],d=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=$Ge(d,t),v=CGe(o,t);if(h!==void 0&&(m?v&&Te(v):Te(sGe(d,t,o))),m&&v===void 0)if(h!==void 0)u.copyKeyFromObject(t,l);else{const y=t in M_e?M_e[t]({model:e,channel:o,fieldOrDatumDef:f,scaleType:d,scalePadding:p,scalePaddingInner:g,domain:l.domain,markDef:s,config:r}):r.scale[t];y!==void 0&&u.set(t,y,!1)}}}const M_e={bins:({model:e,fieldOrDatumDef:t})=>Le(t)?ALn(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>TLn(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>DLn(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>ILn(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>NLn(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:s})=>MLn(e,t,n,r.type,i,s.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=Le(e)?e.sort:void 0;return FLn(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>OLn(e,t,n,r,i)};function TXe(e){qr(e)?xLn(e):DXe(e,"range")}function DXe(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?TXe(r):AXe(r,t);for(const r of Ne(n)){let i;for(const s of e.children){const a=s.component.scales[r];if(a){const o=a.getWithExplicit(t);i=Am(i,o,t,"scale",xYe((l,u)=>{switch(t){case"range":return l.step&&u.step?l.step-u.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function ALn(e,t){const n=t.bin;if(hr(n)){const r=rhe(e,t.field,n);return new Ll(()=>e.getSignalName(r))}else if(Ja(n)&&pF(n)&&n.step!==void 0)return{step:n.step}}function TLn(e,t){if(ht([hl,$d,Cd],e)&&t!=="nominal")return"hcl"}function DLn(e,t,n){var r;if(!(((r=Zh(n))===null||r===void 0?void 0:r.bin)||ht([fi.TIME,fi.UTC],e)))return t in pv?!0:void 0}function ILn(e,t,n,r,i,s){if(e in pv){if(Rc(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:a,orient:o}=i;if(a==="bar"&&!(Le(r)&&(r.bin||r.timeUnit))&&(o==="vertical"&&e==="x"||o==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===fi.POINT)return n.pointPadding}}function NLn(e,t,n,r){if(e===void 0&&t in pv){const{bandPaddingInner:i,barBandPaddingInner:s,rectBandPaddingInner:a}=r;return bi(i,n==="bar"?s:a)}}function MLn(e,t,n,r,i,s){if(e===void 0&&t in pv&&n===fi.BAND){const{bandPaddingOuter:a}=s;return bi(a,wt(i)?{signal:`${i.signal}/2`}:i/2)}}function FLn(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return ju(e)&&t==="descending"?wt(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(ju(e)&&t==="descending")return!0}function OLn(e,t,n,r,i){if(!!n&&n!=="unaggregated"&&ju(i)){if(ut(n)){const a=n[0],o=n[n.length-1];if(a<=0&&o>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!bB(i))return!0;if(!(Le(t)&&t.bin)&&ht([...Vu,...sMn],e)){const{orient:a,type:o}=r;return!(ht(["bar","area","line","trail"],o)&&(a==="horizontal"&&e==="y"||a==="vertical"&&e==="x"))}return!1}function RLn(e,t,n,r){const i=PLn(t,n,r),{type:s}=e;return gv(t)?s!==void 0?SGe(t,s)?Le(n)&&!_Ge(s,n.type)?(Te(jMn(s,i)),i):s:(Te(VMn(t,s,i)),i):i:null}function PLn(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(vw(e)||Y4(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&Te(bG(e,"ordinal")),"ordinal";if(e in pv){if(ht(["rect","bar","image","rule"],n))return"band"}else if(n==="arc"&&e in ufe)return"band";return t.band!==void 0||Dfe(t)&&((r=t.axis)===null||r===void 0?void 0:r.tickBand)?"band":"point";case"temporal":return vw(e)?"time":Y4(e)==="discrete"?(Te(bG(e,"temporal")),"ordinal"):Le(t)&&t.timeUnit&&wo(t.timeUnit).utc?"utc":"time";case"quantitative":return vw(e)?Le(t)&&hr(t.bin)?"bin-ordinal":"linear":Y4(e)==="discrete"?(Te(bG(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(rGe(t.type))}function LLn(e,{ignoreRange:t}={}){IXe(e),CXe(e);for(const n of QFn)AXe(e,n);t||TXe(e)}function IXe(e){qr(e)?e.component.scales=BLn(e):e.component.scales=ULn(e)}function BLn(e){const{encoding:t,mark:n}=e;return RW.reduce((r,i)=>{const s=Ti(t[i]);if(s&&n===Uqe&&i===dl&&s.type===CS)return r;let a=s&&s.scale;if(s&&a!==null&&a!==!1){a=a!=null?a:{};const o=RLn(a,i,s,n);r[i]=new SXe(e.scaleName(i+"",!0),{value:o,explicit:a.type===o})}return r},{})}const zLn=xYe((e,t)=>UCe(e)-UCe(t));function ULn(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const s of e.children){IXe(s);for(const a of Ne(s.component.scales))if(i.scale[a]=(t=i.scale[a])!==null&&t!==void 0?t:cPn(a,e),i.scale[a]==="shared"){const o=r[a],l=s.component.scales[a].getWithExplicit("type");o?OFn(o.value,l.value)?r[a]=Am(o,l,"type","scale",zLn):(i.scale[a]="independent",delete r[a]):r[a]=l}}for(const s of Ne(r)){const a=e.scaleName(s,!0),o=r[s];n[s]=new SXe(a,o);for(const l of e.children){const u=l.component.scales[s];u&&(l.renameScale(u.get("name"),a),u.merged=!0)}}return n}class NG{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function qr(e){return(e==null?void 0:e.type)==="unit"}function Hc(e){return(e==null?void 0:e.type)==="facet"}function ahe(e){return(e==null?void 0:e.type)==="concat"}function AS(e){return(e==null?void 0:e.type)==="layer"}class ohe{constructor(t,n,r,i,s,a,o){var l,u;this.type=n,this.parent=r,this.config=s,this.view=o,this.children=[],this.correctDataNames=c=>(c.from&&c.from.data&&(c.from.data=this.lookupDataSource(c.from.data)),c.from&&c.from.facet&&c.from.facet.data&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c),this.parent=r,this.config=s,this.name=(l=t.name)!==null&&l!==void 0?l:i,this.title=Bg(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new NG,this.projectionNameMap=r?r.projectionNameMap:new NG,this.signalNameMap=r?r.signalNameMap:new NG,this.data=t.data,this.description=t.description,this.transforms=jRn((u=t.transform)!==null&&u!==void 0?u:[]),this.layout=n==="layer"||n==="unit"?{}:HOn(t,n,s),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:UW(t)||r&&r.component.data.isFaceted&&t.data===void 0},layoutSize:new wg,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},a?Gt(a):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){LLn(this)}parseProjection(){bXe(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){pXe(this)}assembleGroupStyle(){var t,n;if(this.type==="unit"||this.type==="layer")return(n=(t=this.view)===null||t===void 0?void 0:t.style)!==null&&n!==void 0?n:"cell"}assembleEncodeFromView(t){const n=it(t,["style"]),r={};for(const i of Ne(n)){const s=n[i];s!==void 0&&(r[i]=ai(s))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=ai(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n!=null?n:{}):er(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,r=it(t,["spacing"]),{component:i,config:s}=this,a=uPn(i.layoutHeaders,s);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),a?{titleBand:a}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of ku)t[r].title&&n.push(rPn(this,r));for(const r of Jfe)n=n.concat(iPn(this,r));return n}assembleAxes(){return V5n(this.component.axes,this.config)}assembleLegends(){return mXe(this)}assembleProjections(){return NPn(this)}assembleTitle(){var t,n,r;const i=(t=this.title)!==null&&t!==void 0?t:{},{encoding:s}=i,a=it(i,["encoding"]),o=Object.assign(Object.assign(Object.assign({},GGe(this.config.title).nonMark),a),s?{encode:{update:s}}:{});if(o.text)return ht(["unit","layer"],this.type)?ht(["middle",void 0],o.anchor)&&(o.frame=(n=o.frame)!==null&&n!==void 0?n:"group"):o.anchor=(r=o.anchor)!==null&&r!==void 0?r:"start",er(o)?void 0:o}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||Hc(this.parent)?_Xe(this):[];i.length>0&&(n.scales=i);const s=this.assembleAxes();s.length>0&&(n.axes=s);const a=this.assembleLegends();return a.length>0&&(n.legends=a),n}getName(t){return Er((this.name?this.name+"_":"")+t)}requestDataName(t){var n;const r=this.getName(t),i=this.component.data.outputNodeRefCounts;return i[r]=((n=i[r])!==null&&n!==void 0?n:0)+1,r}getSizeSignalRef(t){if(Hc(this.parent)){const n=lXe(t),r=OW(n),i=this.component.scales[r];if(i&&!i.merged){const s=i.get("type"),a=i.get("range");if(pl(s)&&mv(a)){const o=i.get("name"),l=rV(this,r),u=she(l);if(u){const c=Me({aggregate:"distinct",field:u},{expr:"datum"});return{signal:oXe(o,i,c)}}else return Te(`Unknown field for ${r}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(Kqe(t)&&gv(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(gMn(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))}}class NXe extends ohe{vgField(t,n={}){const r=this.fieldDef(t);if(!!r)return Me(r,n)}reduceFieldDef(t,n){return eYe(this.getMapping(),(r,i,s)=>{const a=Zh(i);return a?t(r,a,s):r},n)}forEachFieldDef(t,n){Ofe(this.getMapping(),(r,i)=>{const s=Zh(r);s&&t(s,i)},n)}}class iV extends Kn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Gt(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:"value",(s=a[1])!==null&&s!==void 0?s:"density"]}clone(){return new iV(null,Gt(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${pn(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,r=it(t,["density"]);return Object.assign({type:"kde",field:n},r)}}class zD extends Kn{constructor(t,n){super(t),this.filter=n}clone(){return new zD(null,Object.assign({},this.filter))}static make(t,n){const{config:r,mark:i,markDef:s}=n;if(Ln("invalid",s,r)!=="filter")return null;const o=n.reduceFieldDef((l,u,c)=>{const f=gv(c)&&n.getScaleComponent(c);if(f){const h=f.get("type");ju(h)&&u.aggregate!=="count"&&!Lx(i)&&(l[u.field]=u)}return l},{});return Ne(o).length?new zD(t,o):null}dependentFields(){return new Set(Ne(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${pn(this.filter)}`}assemble(){const t=Ne(this.filter).reduce((n,r)=>{const i=this.filter[r],s=Me(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${s}) || (isValid(${s}) && isFinite(+${s})))`):i.type==="quantitative"&&(n.push(`isValid(${s})`),n.push(`isFinite(+${s})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class sV extends Kn{constructor(t,n){super(t),this.transform=n,this.transform=Gt(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((s,a)=>{var o;return(o=i[a])!==null&&o!==void 0?o:s})}clone(){return new sV(this.parent,Gt(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${pn(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class aV extends Kn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Gt(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:"key",(s=a[1])!==null&&s!==void 0?s:"value"]}clone(){return new aV(null,Gt(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${pn(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class yw extends Kn{constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}clone(){return new yw(null,Gt(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[wd,xd],[Wu,$f]]){const s=i.map(a=>{const o=Ti(n.encoding[a]);return Le(o)?o.field:vv(o)?{expr:`${o.datum}`}:Yp(o)?{expr:`${o.value}`}:void 0});(s[0]||s[1])&&(t=new yw(t,s,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(dl)){const i=n.typedFieldDef(dl);i.type===CS&&(t=new yw(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(qt);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${pn(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class UD extends Kn{constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}clone(){return new UD(null,this.projection,Gt(this.fields),Gt(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[wd,xd],[Wu,$f]]){const i=r.map(a=>{const o=Ti(n.encoding[a]);return Le(o)?o.field:vv(o)?{expr:`${o.datum}`}:Yp(o)?{expr:`${o.value}`}:void 0}),s=r[0]===Wu?"2":"";(i[0]||i[1])&&(t=new UD(t,n.projectionName(),i,[n.getName("x"+s),n.getName("y"+s)]))}return t}dependentFields(){return new Set(this.fields.filter(qt))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${pn(this.fields)} ${pn(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class wy extends Kn{constructor(t,n){super(t),this.transform=n}clone(){return new wy(null,Gt(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new wy(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,s=r.y;if(Le(i)&&Le(s)){const a=i.impute?i:s.impute?s:void 0;if(a===void 0)return;const o=i.impute?s:s.impute?i:void 0,{method:l,value:u,frame:c,keyvals:f}=a.impute,h=tYe(n.mark,r);return new wy(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:a.field,key:o.field},l?{method:l}:{}),u!==void 0?{value:u}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),h.length?{groupby:h}:{}))}return null}hash(){return`Impute ${pn(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:s,value:a,frame:o=[null,null]}=this.transform,l=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:_Rn(r)?this.processSequence(r):r}:{}),{method:"value"}),s?{groupby:s}:{}),{value:!i||i==="value"?a:null});if(i&&i!=="value"){const u=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:o,ignorePeers:!1},s?{groupby:s}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[l,u,c]}else return[l]}}class oV extends Kn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Gt(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:n.on,(s=a[1])!==null&&s!==void 0?s:n.loess]}clone(){return new oV(null,Gt(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${pn(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:r}=t,i=it(t,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},i)}}class WD extends Kn{constructor(t,n,r){super(t),this.transform=n,this.secondary=r}clone(){return new WD(null,Gt(this.transform),this.secondary)}static make(t,n,r,i){const s=n.component.data.sources,{from:a}=r;let o=null;if(kRn(a)){let l=OXe(a.data,s);l||(l=new rC(a.data),s.push(l));const u=n.getName(`lookup_${i}`);o=new co(l,u,"lookup",n.component.data.outputNodeRefCounts),n.component.data.outputNodes[u]=o}else if(ERn(a)){const l=a.selection;if(r=Object.assign({as:l},r),o=n.getSelectionComponent(Er(l),l).materialized,!o)throw new Error(yMn(l))}return new WD(t,r,o.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?ci(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${pn({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:ci(this.transform.as)}:{});else{let n=this.transform.as;qt(n)||(Te(CMn),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class lV extends Kn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Gt(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:"prob",(s=a[1])!==null&&s!==void 0?s:"value"]}clone(){return new lV(null,Gt(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${pn(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,r=it(t,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}class uV extends Kn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Gt(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:n.on,(s=a[1])!==null&&s!==void 0?s:n.regression]}clone(){return new uV(null,Gt(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${pn(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:r}=t,i=it(t,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},i)}}class cV extends Kn{constructor(t,n){super(t),this.transform=n}clone(){return new cV(null,Gt(this.transform))}addDimensions(t){var n;this.transform.groupby=o0(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),r=>r)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${pn(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:s}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==void 0?{limit:i}:{}),s!==void 0?{op:s}:{}),r!==void 0?{groupby:r}:{})}}class fV extends Kn{constructor(t,n){super(t),this.transform=n}clone(){return new fV(null,Gt(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${pn(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function MXe(e){let t=0;function n(r,i){var s;if(r instanceof rC&&!r.isGenerator&&!RD(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof ba&&(r.parent instanceof rC&&!i.source?(i.format=Object.assign(Object.assign({},(s=i.format)!==null&&s!==void 0?s:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof kS){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source;for(const a of r.assemble())e.push(a);return}switch((r instanceof CF||r instanceof _F||r instanceof zD||r instanceof SS||r instanceof eC||r instanceof UD||r instanceof yw||r instanceof jc||r instanceof WD||r instanceof ES||r instanceof jx||r instanceof aV||r instanceof sV||r instanceof iV||r instanceof oV||r instanceof lV||r instanceof uV||r instanceof Im||r instanceof fV||r instanceof cV)&&i.transform.push(r.assemble()),(r instanceof wh||r instanceof xh||r instanceof wy||r instanceof kp)&&i.transform.push(...r.assemble()),r instanceof co&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof co?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof co&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let a=i.name;!i.source||i.transform.length>0?e.push(i):a=i.source;for(const o of r.children)n(o,{name:null,source:a,transform:[]});break}}}return n}function WLn(e){const t=[],n=MXe(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function VLn(e,t){var n,r;const i=[],s=MXe(i);let a=0;for(const l of e.sources){l.hasName()||(l.dataName=`source_${a++}`);const u=l.assemble();s(l,u)}for(const l of i)l.transform.length===0&&delete l.transform;let o=0;for(const[l,u]of i.entries())((n=u.transform)!==null&&n!==void 0?n:[]).length===0&&!u.source&&i.splice(o++,0,i.splice(l,1)[0]);for(const l of i)for(const u of(r=l.transform)!==null&&r!==void 0?r:[])u.type==="lookup"&&(u.from=e.outputNodes[u.from].getSource());for(const l of i)l.name in t&&(l.values=t[l.name]);return i}function jLn(e){return e==="top"||e==="left"||wt(e)?"header":"footer"}function HLn(e){for(const t of ku)qLn(e,t);F_e(e,"x"),F_e(e,"y")}function qLn(e,t){var n;const{facet:r,config:i,child:s,component:a}=e;if(e.channelHasField(t)){const o=r[t],l=nC("title",null,i,t);let u=yy(o,i,{allowDisabling:!0,includeDefault:l===void 0||!!l});s.component.layoutHeaders[t].title&&(u=ut(u)?u.join(", "):u,u+=" / "+s.component.layoutHeaders[t].title,s.component.layoutHeaders[t].title=null);const c=nC("labelOrient",o,i,t),f=(n=o.header)!==null&&n!==void 0?n:{},h=bi(f.labels,i.header.labels,!0),d=ht(["bottom","right"],c)?"footer":"header";a.layoutHeaders[t]={title:u,facetFieldDef:o,[d]:t==="facet"?[]:[FXe(e,t,h)]}}}function FXe(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function F_e(e,t){var n;const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:i,resolve:s}=e.component;if(s.axis[t]=nhe(s,t),s.axis[t]==="shared"){const a=t==="x"?"column":"row",o=i[a];for(const l of r.component.axes[t]){const u=jLn(l.get("orient"));o[u]=(n=o[u])!==null&&n!==void 0?n:[FXe(e,a,!1)];const c=KE(l,"main",e.config,{header:!0});c&&o[u][0].axes.push(c),l.mainExtracted=!0}}}}function GLn(e){lhe(e),NB(e,"width"),NB(e,"height")}function YLn(e){lhe(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";NB(e,t),NB(e,n)}function lhe(e){for(const t of e.children)t.parseLayoutSize()}function NB(e,t){const n=lXe(t),r=OW(n),i=e.component.resolve,s=e.component.layoutSize;let a;for(const o of e.children){const l=o.component.layoutSize.getWithExplicit(n),u=i.scale[r];if(u==="independent"&&l.value==="step"){a=void 0;break}if(a){if(u==="independent"&&a.value!==l.value){a=void 0;break}a=Am(a,l,n,"")}else a=l}if(a){for(const o of e.children)e.renameSignal(o.getName(n),e.getName(t)),o.component.layoutSize.set(n,"merged",!1);s.setWithExplicit(t,a)}else s.setWithExplicit(t,{explicit:!1,value:void 0})}function XLn(e){const{size:t,component:n}=e;for(const r of Vu){const i=Sd(r);if(t[i]){const s=t[i];n.layoutSize.set(i,Qh(s)?"step":s,!0)}else{const s=KLn(e,i);n.layoutSize.set(i,s,!1)}}}function KLn(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const s=i.get("type"),a=i.get("range");if(pl(s)){const o=OD(r.view,t);return mv(a)||Qh(o)?"step":o}else return wJ(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return wJ(r.view,t);{const s=OD(r.view,t);return Qh(s)?s.step:s}}}function PJ(e,t,n){return Me(t,Object.assign({suffix:`by_${Me(e)}`},n!=null?n:{}))}class WA extends NXe{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve),this.child=hhe(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet,i)}initFacet(t,n){return gF(t)?eYe(t,(r,i,s)=>ht([Cp,_p],s)?i.field===void 0?(Te(mJ(i,s)),r):(r[s]=bJ(i,s,n),r):(Te(LW(s,"facet")),r),{}):{facet:bJ(t,"facet",n)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=hV(this),this.child.parseData()}parseLayoutSize(){lhe(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),HLn(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,r;const i={};for(const s of ku)for(const a of ehe){const o=this.component.layoutHeaders[s],l=o[a],{facetFieldDef:u}=o;if(u){const c=nC("titleOrient",u,this.config,s);if(ht(["right","bottom"],c)){const f=eV(s,c);i.titleAnchor=(t=i.titleAnchor)!==null&&t!==void 0?t:{},i.titleAnchor[f]="end"}}if(l!=null&&l[0]){const c=s==="row"?"height":"width",f=a==="header"?"headerBand":"footerBand";s!=="facet"&&!this.child.component.layoutSize.get(c)&&(i[f]=(n=i[f])!==null&&n!==void 0?n:{},i[f][s]=.5),o.title&&(i.offset=(r=i.offset)!==null&&r!==void 0?r:{},i.offset[s==="row"?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof WA))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof WA?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Me(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof WA){if(this.child.channelHasField("column")){const i=Me(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of Vu){const s=this.child.component.scales[i];if(s&&!s.merged){const a=s.get("type"),o=s.get("range");if(pl(a)&&mv(o)){const l=rV(this.child,i),u=she(l);u?(t.push(u),n.push("distinct"),r.push(`distinct_${u}`)):Te(`Unknown field for ${i}. Cannot calculate view size.`)}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:s,ops:a,as:o}=this.getCardinalityAggregateForChild(),l=[];for(const c of ku){const f=this.facet[c];if(f){l.push(Me(f));const{bin:h,sort:d}=f;if(hr(h)&&l.push(Me(f,{binSuffix:"end"})),bh(d)){const{field:p,op:g=zW}=d,m=PJ(f,d);r&&i?(s.push(m),a.push("max"),o.push(m)):(s.push(p),a.push(g),o.push(m))}else if(ut(d)){const p=tC(f,c);s.push(p),a.push("max"),o.push(p)}}}const u=!!r&&!!i;return Object.assign({name:t,data:n,groupby:l},u||s.length>0?{aggregate:Object.assign(Object.assign({},u?{cross:u}:{}),s.length?{fields:s,ops:a,as:o}:{})}:{})}facetSortFields(t){const{facet:n}=this,r=n[t];return r?bh(r.sort)?[PJ(r,r.sort,{expr:"datum"})]:ut(r.sort)?[tC(r,t,{expr:"datum"})]:[Me(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(bh(i)?i.order:!ut(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return IJ(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const i of Jfe)if(t[i]){const s=nC("labelOrient",t[i],n,i);if(ht(r[i],s))return IJ(t[i],i,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=WLn(n),i=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),a=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},s?{title:s}:{}),a?{style:a}:{}),{from:{facet:this.assembleFacet()},sort:{field:ku.map(l=>this.facetSortFields(l)).flat(),order:ku.map(l=>this.facetSortOrder(l)).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(p4n(this,[])))]}getMapping(){return this.facet}}function ZLn(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const s of[n,r])if(bh(s.sort)){const{field:a,op:o=zW}=s.sort;e=i=new jx(e,{joinaggregate:[{op:o,field:a,as:PJ(s,s.sort,{forAs:!0})}],groupby:[Me(s)]})}return i}return null}function OXe(e,t){var n,r,i,s,a,o,l,u,c,f;for(const h of t){const d=h.data;if(!(e.name&&h.hasName()&&e.name!==h.dataName)&&!(((n=e.format)===null||n===void 0?void 0:n.mesh)&&((r=d.format)===null||r===void 0?void 0:r.feature))&&!((((i=e.format)===null||i===void 0?void 0:i.feature)||((s=d.format)===null||s===void 0?void 0:s.feature))&&((a=e.format)===null||a===void 0?void 0:a.feature)!==((o=d.format)===null||o===void 0?void 0:o.feature))&&!((((l=e.format)===null||l===void 0?void 0:l.mesh)||((u=d.format)===null||u===void 0?void 0:u.mesh))&&((c=e.format)===null||c===void 0?void 0:c.mesh)!==((f=d.format)===null||f===void 0?void 0:f.mesh))){if(kB(e)&&kB(d)){if(cF(e.values,d.values))return h}else if(RD(e)&&RD(d)){if(e.url===d.url)return h}else if(wYe(e)&&e.name===h.dataName)return h}}return null}function QLn(e,t){if(e.data||!e.parent){if(e.data===null){const r=new rC({values:[]});return t.push(r),r}const n=OXe(e.data,t);if(n)return xy(e.data)||(n.data.format=vNn({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new rC(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function JLn(e,t,n){var r,i;let s=0;for(const a of t.transforms){let o,l;if(PRn(a))l=e=new eC(e,a),o="derived";else if(_Ye(a)){const u=HPn(a);l=e=(r=ba.makeWithAncestors(e,{},u,n))!==null&&r!==void 0?r:e,e=new SS(e,t,a.filter)}else if(LRn(a))l=e=wh.makeFromTransform(e,a,t),o="number";else if(zRn(a))o="date",n.getWithExplicit(a.field).value===void 0&&(e=new ba(e,{[a.field]:o}),n.set(a.field,o,!1)),l=e=xh.makeFromTransform(e,a);else if(URn(a))l=e=jc.makeFromTransform(e,a),o="number",Xfe(t)&&(e=new Im(e));else if(SRn(a))l=e=WD.make(e,t,a,s++),o="derived";else if(FRn(a))l=e=new ES(e,a),o="number";else if(ORn(a))l=e=new jx(e,a),o="number";else if(WRn(a))l=e=kp.makeFromTransform(e,a),o="derived";else if(VRn(a))l=e=new aV(e,a),o="derived";else if(RRn(a))l=e=new sV(e,a),o="derived";else if(ARn(a))l=e=new cV(e,a),o="derived";else if(MRn(a))e=new fV(e,a);else if(BRn(a))l=e=wy.makeFromTransform(e,a),o="derived";else if(TRn(a))l=e=new iV(e,a),o="derived";else if(DRn(a))l=e=new lV(e,a),o="derived";else if(IRn(a))l=e=new uV(e,a),o="derived";else if(NRn(a))l=e=new oV(e,a),o="derived";else{Te($Mn(a));continue}if(l&&o!==void 0)for(const u of(i=l.producedFields())!==null&&i!==void 0?i:[])n.set(u,o,!1)}return e}function hV(e){var t,n,r,i,s,a,o,l,u,c;let f=QLn(e,e.component.data.sources);const{outputNodes:h,outputNodeRefCounts:d}=e.component.data,p=e.parent?e.parent.component.data.ancestorParse.clone():new CRn,g=e.data;xy(g)?($Ye(g)?f=new _F(f,g.sequence):jfe(g)&&(f=new CF(f,g.graticule)),p.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(p.parseNothing=!0),f=(n=ba.makeExplicit(f,e,p))!==null&&n!==void 0?n:f,f=new Im(f);const m=e.parent&&AS(e.parent);(qr(e)||Hc(e))&&m&&(f=(r=wh.makeFromEncoding(f,e))!==null&&r!==void 0?r:f),e.transforms.length>0&&(f=JLn(f,e,p));const v=GPn(e),y=qPn(e);f=(i=ba.makeWithAncestors(f,{},Object.assign(Object.assign({},v),y),p))!==null&&i!==void 0?i:f,qr(e)&&(f=yw.parseAll(f,e),f=UD.parseAll(f,e)),(qr(e)||Hc(e))&&(m||(f=(s=wh.makeFromEncoding(f,e))!==null&&s!==void 0?s:f),f=(a=xh.makeFromEncoding(f,e))!==null&&a!==void 0?a:f,f=eC.parseAllForSortIndex(f,e));const b=e.getName(EB),x=new co(f,b,EB,d);if(h[b]=x,f=x,qr(e)){const _=jc.makeFromEncoding(f,e);_&&(f=_,Xfe(e)&&(f=new Im(f))),f=(o=wy.makeFromEncoding(f,e))!==null&&o!==void 0?o:f,f=(l=kp.makeFromEncoding(f,e))!==null&&l!==void 0?l:f}qr(e)&&(f=(u=zD.make(f,e))!==null&&u!==void 0?u:f);const w=e.getName(fa),C=new co(f,w,fa,d);h[w]=C,f=C,qr(e)&&U5n(e,C);let $=null;if(Hc(e)){const _=e.getName("facet");f=(c=ZLn(f,e.facet))!==null&&c!==void 0?c:f,$=new kS(f,e,_,C.getSource()),h[_]=$}return Object.assign(Object.assign({},e.component.data),{outputNodes:h,outputNodeRefCounts:d,raw:x,main:C,facetRoot:$,ancestorParse:p})}class e6n extends ohe{constructor(t,n,r,i){var s,a,o,l;super(t,"concat",n,r,i,t.resolve),(((a=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||a===void 0?void 0:a.x)==="shared"||((l=(o=t.resolve)===null||o===void 0?void 0:o.axis)===null||l===void 0?void 0:l.y)==="shared")&&Te(xMn),this.children=this.getChildren(t).map((u,c)=>hhe(u,this,this.getName("concat_"+c),void 0,i))}parseData(){this.component.data=hV(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Ne(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return HW(t)?t.vconcat:Wfe(t)?t.hconcat:t.concat}parseLayoutSize(){YLn(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=the(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),r?{style:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup())})}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function t6n(e){return e===!1||e===null}const n6n=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},Lqe),{labelExpr:1,encode:1}),RXe=Ne(n6n);class uhe extends wg{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new uhe(Gt(this.explicit),Gt(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!t6n(this.get(t))}hasOrientSignalRef(){return wt(this.explicit.orient)}}function r6n(e,t,n){var r;const{encoding:i,config:s}=e,a=(r=Ti(i[t]))!==null&&r!==void 0?r:Ti(i[_d(t)]),o=e.axis(t)||{},{format:l,formatType:u}=o;return _b(u)?Object.assign({text:_fe({fieldOrDatumDef:a,field:"datum.value",format:l,formatType:u,config:s})},n):n}function i6n(e){return Vu.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[f6n(n,e)]),t),{})}const s6n={bottom:"top",top:"bottom",left:"right",right:"left"};function a6n(e){var t;const{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(const s of e.children){s.parseAxesAndHeaders();for(const a of Ne(s.component.axes))r.axis[a]=nhe(e.component.resolve,a),r.axis[a]==="shared"&&(n[a]=o6n(n[a],s.component.axes[a]),n[a]||(r.axis[a]="independent",delete n[a]))}for(const s of Vu){for(const a of e.children)if(!!a.component.axes[s]){if(r.axis[s]==="independent"){n[s]=((t=n[s])!==null&&t!==void 0?t:[]).concat(a.component.axes[s]);for(const o of a.component.axes[s]){const{value:l,explicit:u}=o.getWithExplicit("orient");if(!wt(l)){if(i[l]>0&&!u){const c=s6n[l];i[l]>i[c]&&o.set("orient",c,!1)}i[l]++}}}delete a.component.axes[s]}if(r.axis[s]==="independent"&&n[s]&&n[s].length>1)for(const a of n[s])!!a.get("grid")&&!a.explicit.grid&&(a.implicit.grid=!1)}}function o6n(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],s=t[r];if(!!i!=!!s)return;if(i&&s){const a=i.getWithExplicit("orient"),o=s.getWithExplicit("orient");if(a.explicit&&o.explicit&&a.value!==o.value)return;e[r]=l6n(i,s)}}}else return t.map(n=>n.clone());return e}function l6n(e,t){for(const n of RXe){const r=Am(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,s)=>{switch(n){case"title":return JGe(i,s);case"gridScale":return{explicit:i.explicit,value:bi(i.value,s.value)}}return GW(i,s,n,"axis")});e.setWithExplicit(n,r)}return e}function u6n(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(wt(n.labelAngle)?n.labelAngle:mB(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===rXe(r,i))return!0}return e===n[t]}const c6n=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function f6n(e,t){var n,r,i;let s=t.axis(e);const a=new uhe,o=Ti(t.encoding[e]),{mark:l,config:u}=t,c=(s==null?void 0:s.orient)||((n=u[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=u.axis)===null||r===void 0?void 0:r.orient)||J5n(e),f=t.getScaleComponent(e).get("type"),h=q5n(e,f,c,t.config),d=s!==void 0?!s:TJ("disable",u,s==null?void 0:s.style,h).configValue;if(a.set("disable",d,s!==void 0),d)return a;s=s||{};const p=K5n(t,s,e,o,h),g={fieldOrDatumDef:o,axis:s,channel:e,model:t,scaleType:f,orient:c,labelAngle:p,mark:l,config:u};for(const y of RXe){const b=y in b_e?b_e[y](g):ACe(y)?s[y]:void 0,x=b!==void 0,w=u6n(b,y,s,t,e);if(x&&w)a.set(y,b,w);else{const{configValue:C=void 0,configFrom:$=void 0}=ACe(y)&&y!=="values"?TJ(y,t.config,s.style,h):{},_=C!==void 0;x&&!_?a.set(y,b,w):($!=="vgAxisConfig"||c6n.has(y)&&_||tfe(C)||wt(C))&&a.set(y,C,!1)}}const m=(i=s.encoding)!==null&&i!==void 0?i:{},v=Pqe.reduce((y,b)=>{var x;if(!a.hasAxisPart(b))return y;const w=uXe((x=m[b])!==null&&x!==void 0?x:{},t),C=b==="labels"?r6n(t,e,w):w;return C!==void 0&&!er(C)&&(y[b]={update:C}),y},{});return er(v)||a.set("encode",v,!!s.encoding||s.labelAngle!==void 0),a}function h6n({encoding:e,size:t}){for(const n of Vu){const r=Sd(n);Qh(t[r])&&eh(e[n])&&(delete t[r],Te(aGe(r)))}return t}function d6n(e,t,n,{graticule:r}){const i=Xh(e)?Object.assign({},e):{type:e},s=Ln("orient",i,n);if(i.orient=v6n(i.type,t,s),s!==void 0&&s!==i.orient&&Te(RMn(i.orient,s)),i.type==="bar"&&i.orient){const u=Ln("cornerRadiusEnd",i,n);if(u!==void 0){const c=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:PNn[i.orient];for(const f of c)i[f]=u;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return Ln("opacity",i,n)===void 0&&(i.opacity=g6n(i.type,t)),i.filled===void 0&&(i.filled=r?!1:m6n(i,n)),Ln("cursor",i,n)===void 0&&(i.cursor=p6n(i,t,n)),i}function p6n(e,t,n){return t.href||e.href||Ln("href",e,n)?"pointer":e.cursor}function g6n(e,t){if(ht([AW,nfe,rfe,ife],e)&&!Mfe(t))return .7}function m6n(e,t){const n=Sb("filled",e,t),r=e.type;return bi(n,r!==AW&&r!==EW&&r!==vB)}function v6n(e,t,n){switch(e){case AW:case rfe:case ife:case zqe:case TNn:case ANn:return}const{x:r,y:i,x2:s,y2:a}=t;switch(e){case kW:if(Le(r)&&(Ja(r.bin)||Le(i)&&i.aggregate&&!r.aggregate))return"vertical";if(Le(i)&&(Ja(i.bin)||Le(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(a||s){if(n)return n;if(!s&&(Le(r)&&r.type===Cb&&!hr(r.bin)||yJ(r)))return"horizontal";if(!a&&(Le(i)&&i.type===Cb&&!hr(i.bin)||yJ(i)))return"vertical"}case vB:if(s&&!(Le(r)&&Ja(r.bin))&&a&&!(Le(i)&&Ja(i.bin)))return;case SW:if(a)return Le(i)&&Ja(i.bin)?"horizontal":"vertical";if(s)return Le(r)&&Ja(r.bin)?"vertical":"horizontal";if(e===vB){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case EW:case nfe:{const o=eh(r),l=eh(i);if(o&&!l)return e!=="tick"?"horizontal":"vertical";if(!o&&l)return e!=="tick"?"vertical":"horizontal";if(o&&l){const u=r,c=i,f=u.type===Z$,h=c.type===Z$;return f&&!h?e!=="tick"?"vertical":"horizontal":!f&&h?e!=="tick"?"horizontal":"vertical":!u.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":u.aggregate&&!c.aggregate?e!=="tick"?"horizontal":"vertical":n||"vertical"}else return n||void 0}}return"vertical"}const y6n={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ku(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),va("x",e,{defaultPos:"mid"})),va("y",e,{defaultPos:"mid"})),Tm(e,"radius","arc")),Tm(e,"theta","arc"))},b6n={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Ku(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),AB("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),AB("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),Gfe(e))},x6n={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Ku(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Tm(e,"x","bar")),Tm(e,"y","bar"))},w6n={vgMark:"shape",encodeEntry:e=>Object.assign({},Ku(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&Le(n)&&n.type===CS?{field:Me(n,{expr:"datum"})}:{})]}},$6n={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Ku(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Tm(e,"x","image")),Tm(e,"y","image")),Hfe(e,"url"))},C6n={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ku(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),va("x",e,{defaultPos:"mid"})),va("y",e,{defaultPos:"mid"})),Ji("size",e,{vgChannel:"strokeWidth"})),Gfe(e))},_6n={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ku(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),va("x",e,{defaultPos:"mid"})),va("y",e,{defaultPos:"mid"})),Ji("size",e)),Gfe(e))};function che(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ku(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),va("x",e,{defaultPos:"mid"})),va("y",e,{defaultPos:"mid"})),Ji("size",e)),Ji("angle",e)),S6n(e,n,t))}function S6n(e,t,n){return n?{shape:{value:n}}:Ji("shape",e)}const k6n={vgMark:"symbol",encodeEntry:e=>che(e)},E6n={vgMark:"symbol",encodeEntry:e=>che(e,"circle")},A6n={vgMark:"symbol",encodeEntry:e=>che(e,"square")},T6n={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Ku(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Tm(e,"x","rect")),Tm(e,"y","rect"))},D6n={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Ku(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),AB("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),AB("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),Ji("size",e,{vgChannel:"strokeWidth"}))}},I6n={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ku(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),va("x",e,{defaultPos:"mid"})),va("y",e,{defaultPos:"mid"})),Hfe(e)),Ji("size",e,{vgChannel:"fontSize"})),Ji("angle",e)),l_e("align",N6n(e.markDef,n,t))),l_e("baseline",M6n(e.markDef,n,t))),va("radius",e,{defaultPos:null,isMidPoint:!0})),va("theta",e,{defaultPos:null,isMidPoint:!0}))}};function N6n(e,t,n){if(Ln("align",e,n)===void 0)return"center"}function M6n(e,t,n){if(Ln("baseline",e,n)===void 0)return"middle"}const F6n={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",s=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ku(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),va("x",e,{defaultPos:"mid",vgChannel:"xc"})),va("y",e,{defaultPos:"mid",vgChannel:"yc"})),Ji("size",e,{defaultValue:O6n(e),vgChannel:i})),{[s]:ai(Ln("thickness",n,t))})}};function O6n(e){var t;const{config:n,markDef:r}=e,{orient:i}=r,s=i==="horizontal"?"width":"height",a=e.getScaleComponent(i==="horizontal"?"x":"y"),o=(t=Ln("size",r,n,{vgChannel:s}))!==null&&t!==void 0?t:n.tick.bandSize;if(o!==void 0)return o;{const l=a?a.get("range"):void 0;return l&&mv(l)&&yi(l.step)?l.step*3/4:SB(n.view,s)*3/4}}const MR={arc:y6n,area:b6n,bar:x6n,circle:E6n,geoshape:w6n,image:$6n,line:C6n,point:k6n,rect:T6n,rule:D6n,square:A6n,text:I6n,tick:F6n,trail:_6n};function R6n(e){return ht([EW,SW,DNn],e.mark)?P6n(e):ht([kW],e.mark)?L6n(e):MB(e)}const O_e="faceted_path_";function P6n(e){const t=tYe(e.mark,e.encoding),n=MB(e,{fromPrefix:t.length>0?O_e:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:O_e+e.requestDataName(fa),data:e.requestDataName(fa),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}const R_e="stack_group_";function L6n(e){const t=xG.some(n=>Ln(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t){const[n]=MB(e,{fromPrefix:R_e}),r=e.scaleName(e.stack.fieldChannel),i=(f={})=>e.vgField(e.stack.fieldChannel,f),s=(f,h)=>{const d=[i({prefix:"min",suffix:"start",expr:h}),i({prefix:"max",suffix:"start",expr:h}),i({prefix:"min",suffix:"end",expr:h}),i({prefix:"max",suffix:"end",expr:h})];return`${f}(${d.map(p=>`scale('${r}',${p})`).join(",")})`};let a,o;e.stack.fieldChannel==="x"?(a=Object.assign(Object.assign({},DD(n.encode.update,["y","yc","y2","height",...xG])),{x:{signal:s("min","datum")},x2:{signal:s("max","datum")},clip:{value:!0}}),o={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},$p(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(a=Object.assign(Object.assign({},DD(n.encode.update,["x","xc","x2","width"])),{y:{signal:s("min","datum")},y2:{signal:s("max","datum")},clip:{value:!0}}),o={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},$p(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const f of xG){const h=Sb(f,e.markDef,e.config);n.encode.update[f]?(a[f]=n.encode.update[f],delete n.encode.update[f]):h&&(a[f]=ai(h)),h&&(n.encode.update[f]={value:0})}const l=e.fieldDef(e.stack.groupbyChannel),u=Me(l)?[Me(l)]:[];return((l==null?void 0:l.bin)||(l==null?void 0:l.timeUnit))&&u.push(Me(l,{binSuffix:"end"})),a=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((f,h)=>{if(n.encode.update[h])return Object.assign(Object.assign({},f),{[h]:n.encode.update[h]});{const d=Sb(h,e.markDef,e.config);return d!==void 0?Object.assign(Object.assign({},f),{[h]:ai(d)}):f}},a),a.stroke&&(a.strokeForeground={value:!0},a.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(fa),name:R_e+e.requestDataName(fa),groupby:u,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:a},marks:[{type:"group",encode:{update:o},marks:[n]}]}]}else return MB(e)}function B6n(e){const{encoding:t,stack:n,mark:r,markDef:i,config:s}=e,a=t.order;if(!(!ut(a)&&Yp(a)&&SCe(a.value)||!a&&SCe(Ln("order",i,s)))){if((ut(a)||Le(a))&&!n)return KGe(a,{expr:"datum"});if(Lx(r)){const o=i.orient==="horizontal"?"y":"x",l=t[o];if(Le(l)){const u=l.sort;if(ut(u))return{field:Me(l,{prefix:o,suffix:"sort_index",expr:"datum"})};if(bh(u))return{field:Me({aggregate:Mfe(e.encoding)?u.op:void 0,field:u.field},{expr:"datum"})};if(FGe(u)){const c=e.fieldDef(u.encoding);return{field:Me(c,{expr:"datum"}),order:u.order}}else return u===null?void 0:{field:Me(l,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}return}}}function MB(e,t={fromPrefix:""}){const{mark:n,markDef:r,config:i}=e,s=bi(r.clip,z6n(e),U6n(e)),a=YGe(r),o=e.encoding.key,l=B6n(e),u=W6n(e),c=Ln("aria",r,i),f=MR[n].postEncodingTransform?MR[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:MR[n].vgMark},s?{clip:!0}:{}),a?{style:a}:{}),o?{key:o.field}:{}),l?{sort:l}:{}),u||{}),c===!1?{aria:c}:{}),{from:{data:t.fromPrefix+e.requestDataName(fa)},encode:{update:MR[n].encodeEntry(e)}}),f?{transform:f}:{})]}function z6n(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function U6n(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function W6n(e){if(!e.component.selection)return null;const t=Ne(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=Ne(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}class PXe extends NXe{constructor(t,n,r,i={},s){var a,o;super(t,"unit",n,r,s,void 0,GCe(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const l=Xh(t.mark)?t.mark.type:t.mark;this.markDef=d6n(t.mark,(a=t.encoding)!==null&&a!==void 0?a:{},s,{graticule:t.data&&jfe(t.data)});const u=this.encoding=wOn((o=t.encoding)!==null&&o!==void 0?o:{},this.markDef,s);this.size=h6n({encoding:u,size:GCe(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i}),this.stack=mYe(l,u),this.specifiedScales=this.initScales(l,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegend(u),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,n=this.mark===Uqe,r=t&&QNn.some(i=>_t(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return RW.reduce((r,i)=>{var s;const a=Ti(n[i]);return a&&(r[i]=(s=a.scale)!==null&&s!==void 0?s:{}),r},{})}initAxes(t){return Vu.reduce((n,r)=>{const i=t[r];if(_t(i)||r===Ur&&_t(t.x2)||r===Ni&&_t(t.y2)){const s=_t(i)?i.axis:void 0;n[r]=s&&Object.assign({},s)}return n},{})}initLegend(t){return aMn.reduce((n,r)=>{const i=Ti(t[r]);if(i&&lMn(r)){const s=i.legend;n[r]=s&&Object.assign({},s)}return n},{})}parseData(){this.component.data=hV(this)}parseLayoutSize(){XLn(this)}parseSelections(){this.component.selection=z5n(this,this.selection)}parseMarkGroup(){this.component.mark=R6n(this)}parseAxesAndHeaders(){this.component.axes=i6n(this)}assembleSelectionTopLevelSignals(t){return g4n(this,t)}assembleSignals(){return[...QYe(this),...d4n(this,[])]}assembleSelectionData(t){return m4n(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return the(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!AS(this.parent))&&(n=LYe(this,n)),n.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return by(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Zh(n)}typedFieldDef(t){const n=this.fieldDef(t);return Kl(n)?n:null}}class fhe extends ohe{constructor(t,n,r,i,s){super(t,"layer",n,r,s,t.resolve,t.view);const a=Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((o,l)=>{if(qW(o))return new fhe(o,this,this.getName("layer_"+l),a,s);if(mg(o))return new PXe(o,this,this.getName("layer_"+l),a,s);throw new Error(cfe(o))})}parseData(){this.component.data=hV(this);for(const t of this.children)t.parseData()}parseLayoutSize(){GLn(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Ne(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){a6n(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),QYe(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),the(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return v4n(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),mXe(this))}}function hhe(e,t,n,r,i){if(UW(e))return new WA(e,t,n,i);if(qW(e))return new fhe(e,t,n,r,i);if(mg(e))return new PXe(e,t,n,r,i);if(WOn(e))return new e6n(e,t,n,i);throw new Error(cfe(e))}function V6n(e,t={}){t.logger&&oFn(t.logger),t.fieldTitle&&VGe(t.fieldTitle);try{const n=pYe(Tqe(t.config,e.config)),r=bYe(e,n),i=hhe(r,null,"",void 0,n);return i.parse(),uLn(i.component.data,i),{spec:H6n(i,j6n(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&lFn(),t.fieldTitle&&pOn()}}function j6n(e,t,n,r){const i=r.component.layoutSize.get("width"),s=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):qt(t)&&(t={type:t}),i&&s&&xRn(t.type)){if(i==="step"&&s==="step")Te(FCe()),t.type="pad";else if(i==="step"||s==="step"){const a=i==="step"?"width":"height";Te(FCe(OW(a)));const o=a==="width"?"height":"width";t.type=wRn(o)}}return Object.assign(Object.assign(Object.assign({},Ne(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),i_e(n)),i_e(e))}function H6n(e,t,n={},r){const i=e.config?eRn(e.config):void 0,s=[].concat(e.assembleSelectionData([]),VLn(e.component.data,n)),a=e.assembleProjections(),o=e.assembleTitle(),l=e.assembleGroupStyle(),u=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();return c=c.filter(f=>(f.name==="width"||f.name==="height")&&f.value!==void 0?(t[f.name]=+f.value,!1):!0),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),o?{title:o}:{}),l?{style:l}:{}),u?{encode:{update:u}}:{}),{data:s}),a.length>0?{projections:a}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}class q6n extends gYe{mapUnit(t,{config:n}){if(t.encoding){const{encoding:r,transform:i}=t,{bins:s,timeUnits:a,aggregate:o,groupby:l,encoding:u}=Ffe(r,n),c=[...i||[],...s,...a,...o.length===0?[]:[{aggregate:o,groupby:l}]];return Object.assign(Object.assign(Object.assign({},t),c.length>0?{transform:c}:{}),{encoding:u})}else return t}}const G6n=new q6n;function Y6n(e,t){return G6n.map(e,{config:t})}const X6n=tNn.version,K6n=Object.freeze(Object.defineProperty({__proto__:null,normalize:bYe,version:X6n,compile:V6n,extractTransforms:Y6n},Symbol.toStringTag,{value:"Module"}));function LXe(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var Z6n="vega-themes",Q6n="2.13.0",J6n="Themes for stylized Vega and Vega-Lite visualizations.",eBn=["vega","vega-lite","themes","style"],tBn="BSD-3-Clause",nBn={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},rBn=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],iBn="build/vega-themes.js",dhe="build/vega-themes.module.js",sBn="build/vega-themes.min.js",aBn="build/vega-themes.min.js",oBn="build/vega-themes.module.d.ts",lBn={type:"git",url:"https://github.com/vega/vega-themes.git"},uBn=["src","build"],cBn={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},fBn={"@babel/core":"^7.21.4","@babel/plugin-transform-runtime":"^7.21.4","@babel/preset-env":"^7.21.4","@babel/preset-typescript":"^7.21.4","@release-it/conventional-changelog":"^5.1.1","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.2","@rollup/plugin-terser":"^0.4.1","@typescript-eslint/eslint-plugin":"^5.59.0","@typescript-eslint/parser":"^5.59.0","browser-sync":"^2.29.1",concurrently:"^8.0.1",eslint:"^8.38.0","eslint-config-prettier":"^8.8.0","eslint-plugin-prettier":"^4.2.1","gh-pages":"^5.0.0",prettier:"^2.8.7","release-it":"^15.10.1",rollup:"^3.20.6","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.2.0",typescript:"^5.0.4",vega:"^5.24.0","vega-lite":"^5.7.1"},hBn={vega:"*","vega-lite":"*"},dBn={},pBn={name:Z6n,version:Q6n,description:J6n,keywords:eBn,license:tBn,author:nBn,contributors:rBn,main:iBn,module:dhe,unpkg:sBn,jsdelivr:aBn,types:oBn,repository:lBn,files:uBn,scripts:cBn,devDependencies:fBn,peerDependencies:hBn,dependencies:dBn};const b2="#fff",P_e="#888",gBn={background:"#333",view:{stroke:P_e},title:{color:b2,subtitleColor:b2},style:{"guide-label":{fill:b2},"guide-title":{fill:b2}},axis:{domainColor:b2,gridColor:P_e,tickColor:b2}},Fv="#4572a7",mBn={background:"#fff",arc:{fill:Fv},area:{fill:Fv},line:{stroke:Fv,strokeWidth:2},path:{stroke:Fv},rect:{fill:Fv},shape:{stroke:Fv},symbol:{fill:Fv,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Ov="#30a2da",MG="#cbcbcb",vBn="#999",yBn="#333",L_e="#f0f0f0",B_e="#333",bBn={arc:{fill:Ov},area:{fill:Ov},axis:{domainColor:MG,grid:!0,gridColor:MG,gridWidth:1,labelColor:vBn,labelFontSize:10,titleColor:yBn,tickColor:MG,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:L_e,group:{fill:L_e},legend:{labelColor:B_e,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:B_e,titleFontSize:14,titlePadding:10},line:{stroke:Ov,strokeWidth:2},path:{stroke:Ov,strokeWidth:.5},rect:{fill:Ov},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Ov},bar:{binSpacing:2,fill:Ov,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Rv="#000",xBn={group:{fill:"#e5e5e5"},arc:{fill:Rv},area:{fill:Rv},line:{stroke:Rv},path:{stroke:Rv},rect:{fill:Rv},shape:{stroke:Rv},symbol:{fill:Rv,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},wBn=22,$Bn="normal",z_e="Benton Gothic, sans-serif",U_e=11.5,CBn="normal",Pv="#82c6df",FG="Benton Gothic Bold, sans-serif",W_e="normal",V_e=13,Hk={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},_Bn={background:"#ffffff",title:{anchor:"start",color:"#000000",font:FG,fontSize:wBn,fontWeight:$Bn},arc:{fill:Pv},area:{fill:Pv},line:{stroke:Pv,strokeWidth:2},path:{stroke:Pv},rect:{fill:Pv},shape:{stroke:Pv},symbol:{fill:Pv,size:30},axis:{labelFont:z_e,labelFontSize:U_e,labelFontWeight:CBn,titleFont:FG,titleFontSize:V_e,titleFontWeight:W_e},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:z_e,labelFontSize:U_e,symbolType:"square",titleFont:FG,titleFontSize:V_e,titleFontWeight:W_e},range:{category:Hk["category-6"],diverging:Hk["fireandice-6"],heatmap:Hk["fire-7"],ordinal:Hk["fire-7"],ramp:Hk["fire-7"]}},Lv="#ab5787",FR="#979797",SBn={background:"#f9f9f9",arc:{fill:Lv},area:{fill:Lv},line:{stroke:Lv},path:{stroke:Lv},rect:{fill:Lv},shape:{stroke:Lv},symbol:{fill:Lv,size:30},axis:{domainColor:FR,domainWidth:.5,gridWidth:.2,labelColor:FR,tickColor:FR,tickWidth:.2,titleColor:FR},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Bv="#3e5c69",kBn={background:"#fff",arc:{fill:Bv},area:{fill:Bv},line:{stroke:Bv},path:{stroke:Bv},rect:{fill:Bv},shape:{stroke:Bv},symbol:{fill:Bv},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},ou="#1696d2",j_e="#000000",EBn="#FFFFFF",OR="Lato",OG="Lato",ABn="Lato",TBn="#DEDDDD",DBn=18,qk={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},IBn={background:EBn,title:{anchor:"start",fontSize:DBn,font:OR},axisX:{domain:!0,domainColor:j_e,domainWidth:1,grid:!1,labelFontSize:12,labelFont:OG,labelAngle:0,tickColor:j_e,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:OR},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:TBn,gridWidth:1,labelFontSize:12,labelFont:OG,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:OR,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:OG,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:OR,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:qk["six-groups-cat-1"],diverging:qk["diverging-colors"],heatmap:qk["diverging-colors"],ordinal:qk["six-groups-seq"],ramp:qk["shades-blue"]},area:{fill:ou},rect:{fill:ou},line:{color:ou,stroke:ou,strokeWidth:5},trail:{color:ou,stroke:ou,strokeWidth:0,size:1},path:{stroke:ou,strokeWidth:.5},point:{filled:!0},text:{font:ABn,color:ou,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:ou,stroke:null}},arc:{fill:ou},shape:{stroke:ou},symbol:{fill:ou,size:30}},zv="#3366CC",H_e="#ccc",RR="Arial, sans-serif",NBn={arc:{fill:zv},area:{fill:zv},path:{stroke:zv},rect:{fill:zv},shape:{stroke:zv},symbol:{stroke:zv},circle:{fill:zv},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:RR,fontSize:12},"guide-title":{font:RR,fontSize:12},"group-title":{font:RR,fontSize:12}},title:{font:RR,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:H_e,tickColor:H_e,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},phe=e=>e*(1/3+1),q_e=phe(9),G_e=phe(10),Y_e=phe(12),Gk="Segoe UI",X_e="wf_standard-font, helvetica, arial, sans-serif",K_e="#252423",Yk="#605E5C",Z_e="transparent",MBn="#C8C6C4",oc="#118DFF",FBn="#12239E",OBn="#E66C37",RBn="#6B007B",PBn="#E044A7",LBn="#744EC2",BBn="#D9B300",zBn="#D64550",BXe=oc,zXe="#DEEFFF",Q_e=[zXe,BXe],UBn=[zXe,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",BXe],WBn={view:{stroke:Z_e},background:Z_e,font:Gk,header:{titleFont:X_e,titleFontSize:Y_e,titleColor:K_e,labelFont:Gk,labelFontSize:G_e,labelColor:Yk},axis:{ticks:!1,grid:!1,domain:!1,labelColor:Yk,labelFontSize:q_e,titleFont:X_e,titleColor:K_e,titleFontSize:Y_e,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:MBn,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:oc},line:{stroke:oc,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:Gk,fontSize:q_e,fill:Yk},arc:{fill:oc},area:{fill:oc,line:!0,opacity:.6},path:{stroke:oc},rect:{fill:oc},point:{fill:oc,filled:!0,size:75},shape:{stroke:oc},symbol:{fill:oc,strokeWidth:1.5,size:50},legend:{titleFont:Gk,titleFontWeight:"bold",titleColor:Yk,labelFont:Gk,labelFontSize:G_e,labelColor:Yk,symbolType:"circle",symbolSize:75},range:{category:[oc,FBn,OBn,RBn,PBn,LBn,BBn,zBn],diverging:Q_e,heatmap:Q_e,ordinal:UBn}},VBn=pBn.version,jBn=Object.freeze(Object.defineProperty({__proto__:null,dark:gBn,excel:mBn,fivethirtyeight:bBn,ggplot2:xBn,googlecharts:NBn,latimes:_Bn,powerbi:WBn,quartz:SBn,urbaninstitute:IBn,version:VBn,vox:kBn},Symbol.toStringTag,{value:"Module"}));var HBn=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const UXe="vg-tooltip-element",qBn={offsetX:10,offsetY:10,id:UXe,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:GBn,maxDepth:2};function GBn(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function YBn(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return HBn.toString().replace(UXe,e)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function XBn(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function KBn(e,t,n){if(at(e))return`[${e.map(r=>t(wr(r)?r:J_e(r,n))).join(", ")}]`;if(Ft(e)){let r="";const i=e,{title:s,image:a}=i,o=XBn(i,["title","image"]);s&&(r+=`<h2>${t(s)}</h2>`),a&&(r+=`<img src="${t(a)}">`);const l=Object.keys(o);if(l.length>0){r+="<table>";for(const u of l){let c=o[u];c!==void 0&&(Ft(c)&&(c=J_e(c,n)),r+=`<tr><td class="key">${t(u)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function ZBn(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function J_e(e,t){return JSON.stringify(e,ZBn(t))}function QBn(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let s=e.clientY+r;return s+t.height>window.innerHeight&&(s=+e.clientY-r-t.height),{x:i,y:s}}class JBn{constructor(t){this.options=Object.assign(Object.assign({},qBn),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=YBn(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(document.fullscreenElement!=null?document.fullscreenElement:document.body).appendChild(this.el),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=KBn(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:a,y:o}=QBn(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${o}px; left: ${a}px`)}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function FB(e,t,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(f){a(f)}}function l(c){try{u(r.throw(c))}catch(f){a(f)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((r=r.apply(e,t||[])).next())})}function e8n(e,t,n){const r=e.open(t),i=1e4,s=250,{origin:a}=new URL(t);let o=~~(i/s);function l(c){c.source===r&&(o=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function u(){o<=0||(r.postMessage(n,a),setTimeout(u,s),o-=1)}setTimeout(u,s)}var t8n=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper {
    width: 100%;
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function WXe(e,...t){for(const n of t)n8n(e,n);return e}function n8n(e,t){for(const n of Object.keys(t))W7(e,n,t[n],!0)}var RG;const qd=MIn;let iC=K6n;const PR=typeof window<"u"?window:void 0;iC===void 0&&((RG=PR==null?void 0:PR.vl)===null||RG===void 0?void 0:RG.compile)&&(iC=PR.vl);const VXe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},r8n={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},ZE={vega:"Vega","vega-lite":"Vega-Lite"},OB={vega:qd.version,"vega-lite":iC?iC.version:"not available"},i8n={vega:e=>e,"vega-lite":(e,t)=>iC.compile(e,{config:t}).spec},s8n=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,a8n="chart-wrapper";function o8n(e){return typeof e=="function"}function eSe(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,s=`</code></pre>${n}</body></html>`,a=window.open("");a.document.write(i+e+s),a.document.title=`${ZE[r]} JSON Source`}function jXe(e,t){var n;if(e.$schema){const r=LXe(e.$schema);t&&t!==r.library&&console.warn(`The given visualization spec is written in ${ZE[r.library]}, but mode argument sets ${(n=ZE[t])!==null&&n!==void 0?n:t}.`);const i=r.library;return kFe.satisfies(OB[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${ZE[i]} ${r.version}, but the current version of ${ZE[i]} is v${OB[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t!=null?t:"vega"}function l8n(e){return!!(e&&"load"in e)}function tSe(e){return l8n(e)?e:qd.loader(e)}function nSe(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function u8n(e,t,n={}){var r,i,s;return FB(this,void 0,void 0,function*(){let a,o;MT(t)?(o=tSe(n.loader),a=JSON.parse(yield o.load(t))):a=t;const l=nSe(a).loader;(!o||l)&&(o=tSe((r=n.loader)!==null&&r!==void 0?r:l));const u=yield rSe(nSe(a),o),c=yield rSe(n,o),f=Object.assign(Object.assign({},WXe(c,u)),{config:wre((i=c.config)!==null&&i!==void 0?i:{},(s=u.config)!==null&&s!==void 0?s:{})});return yield f8n(e,a,f,o)})}function rSe(e,t){var n;return FB(this,void 0,void 0,function*(){const r=MT(e.config)?JSON.parse(yield t.load(e.config)):(n=e.config)!==null&&n!==void 0?n:{},i=MT(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),r?{config:r}:{})})}function c8n(e){var t;const n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:(t=document.head)!==null&&t!==void 0?t:document.body}}function f8n(e,t,n={},r){var i,s,a,o,l,u;return FB(this,void 0,void 0,function*(){const c=n.theme?wre(jBn[n.theme],(i=n.config)!==null&&i!==void 0?i:{}):n.config,f=LFe(n.actions)?n.actions:WXe({},VXe,(s=n.actions)!==null&&s!==void 0?s:{}),h=Object.assign(Object.assign({},r8n),n.i18n),d=(a=n.renderer)!==null&&a!==void 0?a:"canvas",p=(o=n.logLevel)!==null&&o!==void 0?o:qd.Warn,g=(l=n.downloadFileName)!==null&&l!==void 0?l:"visualization",m=typeof e=="string"?document.querySelector(e):e;if(!m)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const S="vega-embed-style",{root:I,rootContainer:A}=c8n(m);if(!I.getElementById(S)){const D=document.createElement("style");D.id=S,D.innerText=n.defaultStyle===void 0||n.defaultStyle===!0?t8n.toString():n.defaultStyle,A.appendChild(D)}}const v=jXe(t,n.mode);let y=i8n[v](t,c);if(v==="vega-lite"&&y.$schema){const S=LXe(y.$schema);kFe.satisfies(OB.vega,`^${S.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${S.version}, but current version is v${OB.vega}.`)}m.classList.add("vega-embed"),f&&m.classList.add("has-actions"),m.innerHTML="";let b=m;if(f){const S=document.createElement("div");S.classList.add(a8n),m.appendChild(S),b=S}const x=n.patch;x&&(x instanceof Function?y=x(y):y=O7(y,x,!0,!1).newDocument),n.formatLocale&&qd.formatLocale(n.formatLocale),n.timeFormatLocale&&qd.timeFormatLocale(n.timeFormatLocale);const{ast:w}=n,C=qd.parse(y,v==="vega-lite"?{}:c,{ast:w}),$=new(n.viewClass||qd.View)(C,Object.assign({loader:r,logLevel:p,renderer:d},w?{expr:qd.expressionInterpreter}:{}));if(n.tooltip!==!1){let S;o8n(n.tooltip)?S=n.tooltip:S=new JBn(n.tooltip===!0?{}:n.tooltip).call,$.tooltip(S)}let{hover:_}=n;if(_===void 0&&(_=v==="vega"),_){const{hoverSet:S,updateSet:I}=typeof _=="boolean"?{}:_;$.hover(S,I)}n&&(n.width!=null&&$.width(n.width),n.height!=null&&$.height(n.height),n.padding!=null&&$.padding(n.padding)),yield $.initialize(b,n.bind).runAsync();let k;if(f!==!1){let S=m;if(n.defaultStyle!==!1){const A=document.createElement("details");A.title=h.CLICK_TO_VIEW_ACTIONS,m.append(A),S=A;const D=document.createElement("summary");D.innerHTML=s8n,A.append(D),k=T=>{A.contains(T.target)||A.removeAttribute("open")},document.addEventListener("click",k)}const I=document.createElement("div");if(S.append(I),I.classList.add("vega-actions"),f===!0||f.export!==!1){for(const A of["svg","png"])if(f===!0||f.export===!0||f.export[A]){const D=h[`${A.toUpperCase()}_ACTION`],T=document.createElement("a");T.text=D,T.href="#",T.target="_blank",T.download=`${g}.${A}`,T.addEventListener("mousedown",function(N){return FB(this,void 0,void 0,function*(){N.preventDefault();const F=yield $.toImageURL(A,n.scaleFactor);this.href=F})}),I.append(T)}}if(f===!0||f.source!==!1){const A=document.createElement("a");A.text=h.SOURCE_ACTION,A.href="#",A.addEventListener("click",function(D){var T,N;eSe(wj(t),(T=n.sourceHeader)!==null&&T!==void 0?T:"",(N=n.sourceFooter)!==null&&N!==void 0?N:"",v),D.preventDefault()}),I.append(A)}if(v==="vega-lite"&&(f===!0||f.compiled!==!1)){const A=document.createElement("a");A.text=h.COMPILED_ACTION,A.href="#",A.addEventListener("click",function(D){var T,N;eSe(wj(y),(T=n.sourceHeader)!==null&&T!==void 0?T:"",(N=n.sourceFooter)!==null&&N!==void 0?N:"","vega"),D.preventDefault()}),I.append(A)}if(f===!0||f.editor!==!1){const A=(u=n.editorUrl)!==null&&u!==void 0?u:"https://vega.github.io/editor/",D=document.createElement("a");D.text=h.EDITOR_ACTION,D.href="#",D.addEventListener("click",function(T){e8n(window,A,{config:c,mode:v,renderer:d,spec:wj(t)}),T.preventDefault()}),I.append(D)}}function E(){k&&document.removeEventListener("click",k),$.finalize()}return{view:$,spec:t,vgSpec:y,finalize:E}})}const h8n=Object.freeze(Object.defineProperty({__proto__:null,default:u8n,DEFAULT_ACTIONS:VXe,guessMode:jXe,vega:qd,get vegaLite(){return iC}},Symbol.toStringTag,{value:"Module"})),TS=Fb(h8n);var Zu={},De={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var iSe=Object.getOwnPropertySymbols,d8n=Object.prototype.hasOwnProperty,p8n=Object.prototype.propertyIsEnumerable;function g8n(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function m8n(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(s){return t[s]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(s){i[s]=s}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var ghe=m8n()?Object.assign:function(e,t){for(var n,r=g8n(e),i,s=1;s<arguments.length;s++){n=Object(arguments[s]);for(var a in n)d8n.call(n,a)&&(r[a]=n[a]);if(iSe){i=iSe(n);for(var o=0;o<i.length;o++)p8n.call(n,i[o])&&(r[i[o]]=n[i[o]])}}return r},mhe={};Object.defineProperty(mhe,"__esModule",{value:!0});mhe.StyleSheet=HXe;var v8n=ghe,y8n=b8n(v8n);function b8n(e){return e&&e.__esModule?e:{default:e}}function x8n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}function PG(e){return e[e.length-1]}function sSe(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var w1=typeof window<"u",w8n=!1,$8n=function(){if(w1){var e=document.createElement("div");return e.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->",e.getElementsByTagName("i").length===1}}();function aSe(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function HXe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.speedy,n=t===void 0?!w8n:t,r=e.maxLength,i=r===void 0?w1&&$8n?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,y8n.default)(HXe.prototype,{getSheet:function(){return sSe(PG(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");w1?this.tags[0]=aSe():this.sheet={cssRules:[],insertRule:function(r){t.sheet.cssRules.push({cssText:r})}},this.injected=!0},speedy:function(t){if(this.ctr!==0)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var n=this.getSheet();n.insertRule(t,t.indexOf("@import")!==-1?0:n.cssRules.length)}catch{}},insert:function(t){if(w1)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(t.indexOf("@import")!==-1){var n=PG(this.tags);n.insertBefore(document.createTextNode(t),n.firstChild)}else PG(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,t.indexOf("@import")!==-1?0:this.sheet.cssRules.length);return this.ctr++,w1&&this.ctr%this.maxLength===0&&this.tags.push(aSe()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){w1?(this.tags.forEach(function(t){return t.parentNode.removeChild(t)}),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!w1)return this.sheet.cssRules;var t=[];return this.tags.forEach(function(n){return t.splice.apply(t,[t.length,0].concat(x8n(Array.from(sSe(n).cssRules))))}),t}});var DS={},C8n=/-(.)/g;function _8n(e){return e.replace(C8n,function(t,n){return n.toUpperCase()})}var S8n=_8n,k8n=S8n,E8n=/^-ms-/;function A8n(e){return k8n(e.replace(E8n,"ms-"))}var T8n=A8n,vhe={},yhe={};Object.defineProperty(yhe,"__esModule",{value:!0});var K4={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function D8n(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var I8n=["Webkit","ms","Moz","O"];Object.keys(K4).forEach(function(e){I8n.forEach(function(t){K4[D8n(t,e)]=K4[e]})});var N8n={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},M8n={isUnitlessNumber:K4,shorthandPropertyExpansions:N8n};yhe.default=M8n;function dV(e){return function(){return e}}var Hx=function(){};Hx.thatReturns=dV;Hx.thatReturnsFalse=dV(!1);Hx.thatReturnsTrue=dV(!0);Hx.thatReturnsNull=dV(null);Hx.thatReturnsThis=function(){return this};Hx.thatReturnsArgument=function(e){return e};var F8n=Hx,O8n=F8n,R8n=O8n,qXe=R8n;Object.defineProperty(vhe,"__esModule",{value:!0});var P8n=yhe,L8n=GXe(P8n),B8n=qXe;GXe(B8n);function GXe(e){return e&&e.__esModule?e:{default:e}}var oSe=L8n.default.isUnitlessNumber;function z8n(e,t,n){var r=t==null||typeof t=="boolean"||t==="";if(r)return"";var i=isNaN(t);return i||t===0||oSe.hasOwnProperty(e)&&oSe[e]?""+t:(typeof t=="string"&&(t=t.trim()),t+"px")}vhe.default=z8n;var U8n=/([A-Z])/g;function W8n(e){return e.replace(U8n,"-$1").toLowerCase()}var V8n=W8n,j8n=V8n,H8n=/^ms-/;function q8n(e){return j8n(e).replace(H8n,"-ms-")}var G8n=q8n;function Y8n(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}var X8n=Y8n;Object.defineProperty(DS,"__esModule",{value:!0});DS.processStyleName=void 0;DS.createMarkupForStyles=szn;var K8n=T8n;SF(K8n);var Z8n=vhe,Q8n=SF(Z8n),J8n=G8n,ezn=SF(J8n),tzn=X8n,nzn=SF(tzn),rzn=qXe;SF(rzn);function SF(e){return e&&e.__esModule?e:{default:e}}var izn=DS.processStyleName=(0,nzn.default)(ezn.default);function szn(e,t){var n="";for(var r in e){var i=r.indexOf("--")===0;if(!!e.hasOwnProperty(r)&&r!=="label"){var s=e[r];s!=null&&(i?n+=r+":"+s+";":(n+=izn(r)+":",n+=(0,Q8n.default)(r,s,t)+";"))}}return n||null}var bhe={};Object.defineProperty(bhe,"__esModule",{value:!0});var YXe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};bhe.default=xhe;function azn(e){return e==null||e===!1||(typeof e>"u"?"undefined":YXe(e))==="object"&&Object.keys(e).length===0}function ozn(e){if(azn(e))return null;if((typeof e>"u"?"undefined":YXe(e))!=="object")return e;for(var t={},n=Object.keys(e),r=!1,i=0;i<n.length;i++){var s=e[n[i]],a=xhe(s);(a===null||a!==s)&&(r=!0),a!==null&&(t[n[i]]=a)}return Object.keys(t).length===0?null:r?t:e}function lzn(e){var t=!1,n=[];return e.forEach(function(r){var i=xhe(r);(i===null||i!==r)&&(t=!0),i!==null&&n.push(i)}),n.length==0?null:t?n:e}function xhe(e){return Array.isArray(e)?lzn(e):ozn(e)}var IS={},whe={},LJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],i=["ms"],s=["Webkit","Moz"],a=["Webkit","ms"],o=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:s,userSelect:o,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:o,breakBefore:o,breakInside:o,columnCount:s,columnFill:s,columnGap:s,columnRule:s,columnRuleColor:s,columnRuleStyle:s,columnRuleWidth:s,columns:s,columnSpan:s,columnWidth:s,writingMode:a,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:a,scrollSnapPointsX:a,scrollSnapPointsY:a,scrollSnapDestination:a,scrollSnapCoordinate:a,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:o,flowInto:a,flowFrom:a,regionFragment:a,textAlignLast:r,tabSize:r,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:a,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default})(LJ,LJ.exports);var BJ={exports:{}},RB={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r){return r.charAt(0).toUpperCase()+r.slice(1)}e.exports=t.default})(RB,RB.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=RB.exports,r=i(n);function i(a){return a&&a.__esModule?a:{default:a}}function s(a,o,l){if(a.hasOwnProperty(o))for(var u=a[o],c=0,f=u.length;c<f;++c)l[u[c]+(0,r.default)(o)]=l[o]}e.exports=t.default})(BJ,BJ.exports);var zJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i,s,a,o){for(var l=0,u=r.length;l<u;++l){var c=r[l](i,s,a,o);if(c)return c}}e.exports=t.default})(zJ,zJ.exports);var UJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function i(s,a){if(s==="cursor"&&r.hasOwnProperty(a))return n.map(function(o){return o+a})}e.exports=t.default})(UJ,UJ.exports);var WJ={exports:{}},Tb={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=/-webkit-|-moz-|-ms-/;function r(i){return typeof i=="string"&&n.test(i)}e.exports=t.default})(Tb,Tb.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=Tb.exports,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}var s=["-webkit-",""];function a(o,l){if(typeof l=="string"&&!(0,r.default)(l)&&l.indexOf("cross-fade(")>-1)return s.map(function(u){return l.replace(/cross-fade\(/g,u+"cross-fade(")})}e.exports=t.default})(WJ,WJ.exports);var VJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=Tb.exports,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}var s=["-webkit-",""];function a(o,l){if(typeof l=="string"&&!(0,r.default)(l)&&l.indexOf("filter(")>-1)return s.map(function(u){return l.replace(/filter\(/g,u+"filter(")})}e.exports=t.default})(VJ,VJ.exports);var jJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function r(i,s){if(i==="display"&&n.hasOwnProperty(s))return n[s]}e.exports=t.default})(jJ,jJ.exports);var HJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};function i(s,a,o){s==="flexDirection"&&typeof a=="string"&&(a.indexOf("column")>-1?o.WebkitBoxOrient="vertical":o.WebkitBoxOrient="horizontal",a.indexOf("reverse")>-1?o.WebkitBoxDirection="reverse":o.WebkitBoxDirection="normal"),r.hasOwnProperty(s)&&(o[r[s]]=n[a]||a)}e.exports=t.default})(HJ,HJ.exports);var qJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Tb.exports,r=i(n);function i(l){return l&&l.__esModule?l:{default:l}}var s=["-webkit-","-moz-",""],a=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;function o(l,u){if(typeof u=="string"&&!(0,r.default)(u)&&a.test(u))return s.map(function(c){return c+u})}e.exports=t.default})(qJ,qJ.exports);var GJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=Tb.exports,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}var s=["-webkit-",""];function a(o,l){if(typeof l=="string"&&!(0,r.default)(l)&&l.indexOf("image-set(")>-1)return s.map(function(u){return l.replace(/image-set\(/g,u+"image-set(")})}e.exports=t.default})(GJ,GJ.exports);var YJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i){if(r==="position"&&i==="sticky")return["-webkit-sticky","sticky"]}e.exports=t.default})(YJ,YJ.exports);var XJ={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function s(a,o){if(r.hasOwnProperty(a)&&i.hasOwnProperty(o))return n.map(function(l){return l+o})}e.exports=t.default})(XJ,XJ.exports);var KJ={exports:{}},ZJ={exports:{}},uzn=/[A-Z]/g,czn=/^ms-/,LG={};function fzn(e){return"-"+e.toLowerCase()}function hzn(e){if(LG.hasOwnProperty(e))return LG[e];var t=e.replace(uzn,fzn);return LG[e]=czn.test(t)?"-"+t:t}const dzn=Object.freeze(Object.defineProperty({__proto__:null,default:hzn},Symbol.toStringTag,{value:"Module"})),pzn=Fb(dzn);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=pzn,r=i(n);function i(a){return a&&a.__esModule?a:{default:a}}function s(a){return(0,r.default)(a)}e.exports=t.default})(ZJ,ZJ.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=h;var n=ZJ.exports,r=l(n),i=Tb.exports,s=l(i),a=RB.exports,o=l(a);function l(d){return d&&d.__esModule?d:{default:d}}var u={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},c={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function f(d,p){if((0,s.default)(d))return d;for(var g=d.split(/,(?![^()]*(?:\([^()]*\))?\))/g),m=0,v=g.length;m<v;++m){var y=g[m],b=[y];for(var x in p){var w=(0,r.default)(x);if(y.indexOf(w)>-1&&w!=="order")for(var C=p[x],$=0,_=C.length;$<_;++$)b.unshift(y.replace(w,c[C[$]]+w))}g[m]=b.join(",")}return g.join(",")}function h(d,p,g,m){if(typeof p=="string"&&u.hasOwnProperty(d)){var v=f(p,m),y=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-moz-|-ms-/.test(x)}).join(",");if(d.indexOf("Webkit")>-1)return y;var b=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-webkit-|-ms-/.test(x)}).join(",");return d.indexOf("Moz")>-1?b:(g["Webkit"+(0,o.default)(d)]=y,g["Moz"+(0,o.default)(d)]=b,v)}}e.exports=t.default})(KJ,KJ.exports);Object.defineProperty(whe,"__esModule",{value:!0});whe.default=Wzn;var gzn=LJ.exports,mzn=eu(gzn),vzn=BJ.exports,yzn=eu(vzn),bzn=zJ.exports,xzn=eu(bzn),wzn=UJ.exports,$zn=eu(wzn),Czn=WJ.exports,_zn=eu(Czn),Szn=VJ.exports,kzn=eu(Szn),Ezn=jJ.exports,Azn=eu(Ezn),Tzn=HJ.exports,Dzn=eu(Tzn),Izn=qJ.exports,Nzn=eu(Izn),Mzn=GJ.exports,Fzn=eu(Mzn),Ozn=YJ.exports,Rzn=eu(Ozn),Pzn=XJ.exports,Lzn=eu(Pzn),Bzn=KJ.exports,zzn=eu(Bzn);function eu(e){return e&&e.__esModule?e:{default:e}}var Uzn=[_zn.default,$zn.default,kzn.default,Dzn.default,Nzn.default,Fzn.default,Rzn.default,Lzn.default,zzn.default,Azn.default],lSe=mzn.default.prefixMap;function Wzn(e){for(var t in e){var n=e[t],r=(0,xzn.default)(Uzn,t,n,e,lSe);r&&(e[t]=r),(0,yzn.default)(lSe,t,e)}return e}Object.defineProperty(IS,"__esModule",{value:!0});var QJ=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};IS.PluginSet=KXe;IS.fallbacks=Yzn;IS.contentWrap=Kzn;IS.prefixes=Zzn;var Vzn=ghe,$he=XXe(Vzn),jzn=DS,Hzn=whe,qzn=XXe(Hzn);function XXe(e){return e&&e.__esModule?e:{default:e}}var Gzn=function(e){return e==="development"||!e}("production");function KXe(e){this.fns=e||[]}(0,$he.default)(KXe.prototype,{add:function(){for(var t=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(s){t.fns.indexOf(s)>=0?Gzn&&console.warn("adding the same plugin again, ignoring"):t.fns=[s].concat(t.fns)})},remove:function(t){this.fns=this.fns.filter(function(n){return n!==t})},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce(function(n,r){return r(n)},t)}});function Yzn(e){var t=Object.keys(e.style).map(function(i){return Array.isArray(e.style[i])}).indexOf(!0)>=0;if(t){var n=e.style,r=Object.keys(n).reduce(function(i,s){return i[s]=Array.isArray(n[s])?n[s].join("; "+(0,jzn.processStyleName)(s)+": "):n[s],i},{});return(0,$he.default)({},e,{style:r})}return e}var Xzn=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"];function Kzn(e){if(e.style.content){var t=e.style.content;return Xzn.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)||t.charAt(0)===t.charAt(t.length-1)&&(t.charAt(0)==='"'||t.charAt(0)==="'")?e:QJ({},e,{style:QJ({},e.style,{content:'"'+t+'"'})})}return e}function Zzn(e){return(0,$he.default)({},e,{style:(0,qzn.default)(QJ({},e.style))})}var Che={};Object.defineProperty(Che,"__esModule",{value:!0});Che.default=Qzn;function Qzn(e,t){for(var n=1540483477,r=24,i=t^e.length,s=e.length,a=0;s>=4;){var o=Jzn(e,a);o=Uv(o,n),o^=o>>>r,o=Uv(o,n),i=Uv(i,n),i^=o,a+=4,s-=4}switch(s){case 3:i^=uSe(e,a),i^=e.charCodeAt(a+2)<<16,i=Uv(i,n);break;case 2:i^=uSe(e,a),i=Uv(i,n);break;case 1:i^=e.charCodeAt(a),i=Uv(i,n);break}return i^=i>>>13,i=Uv(i,n),i^=i>>>15,i>>>0}function Jzn(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function uSe(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function Uv(e,t){e=e|0,t=t|0;var n=e&65535,r=e>>>16,i=n*t+((r*t&65535)<<16)|0;return i}Object.defineProperty(De,"__esModule",{value:!0});De.compose=De.merge=De.$=De.style=De.presets=De.keyframes=De.fontFace=De.insertGlobal=De.insertRule=De.plugins=De.styleSheet=void 0;De.speedy=a7n;De.simulations=o7n;De.simulate=l7n;De.cssLabels=u7n;De.isLikeRule=Ahe;De.idFor=The;De.css=ps;De.rehydrate=C7n;De.flush=_7n;De.select=Dhe;De.parent=k7n;De.media=E7n;De.pseudo=$t;De.active=A7n;De.any=T7n;De.checked=D7n;De.disabled=I7n;De.empty=N7n;De.enabled=M7n;De._default=F7n;De.first=O7n;De.firstChild=R7n;De.firstOfType=P7n;De.fullscreen=L7n;De.focus=B7n;De.hover=z7n;De.indeterminate=U7n;De.inRange=W7n;De.invalid=V7n;De.lastChild=j7n;De.lastOfType=H7n;De.left=q7n;De.link=G7n;De.onlyChild=Y7n;De.onlyOfType=X7n;De.optional=K7n;De.outOfRange=Z7n;De.readOnly=Q7n;De.readWrite=J7n;De.required=e9n;De.right=t9n;De.root=n9n;De.scope=r9n;De.target=i9n;De.valid=s9n;De.visited=a9n;De.dir=o9n;De.lang=l9n;De.not=u9n;De.nthChild=c9n;De.nthLastChild=f9n;De.nthLastOfType=h9n;De.nthOfType=d9n;De.after=p9n;De.before=g9n;De.firstLetter=m9n;De.firstLine=v9n;De.selection=y9n;De.backdrop=b9n;De.placeholder=x9n;De.cssFor=w9n;De.attribsFor=$9n;var e7n=ghe,t7n=She(e7n),n7n=mhe,_he=DS,r7n=bhe,bv=She(r7n),gp=IS,i7n=Che,s7n=She(i7n);function She(e){return e&&e.__esModule?e:{default:e}}function kF(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fl=De.styleSheet=new n7n.StyleSheet;Fl.inject();function a7n(e){return Fl.speedy(e)}var EF=De.plugins=Fl.plugins=new gp.PluginSet([gp.prefixes,gp.contentWrap,gp.fallbacks]);EF.media=new gp.PluginSet;EF.fontFace=new gp.PluginSet;EF.keyframes=new gp.PluginSet([gp.prefixes,gp.fallbacks]);var khe=!1,pV=typeof window<"u",Ehe=khe,cSe=!1,fSe=!1;function o7n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;Ehe=!!e}function l7n(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,bv.default)(t),t?Ehe?t.reduce(function(r,i){return r["data-simulate-"+PB(i)]="",r},{}):(cSe||(console.warn("can't simulate without once calling simulations(true)"),cSe=!0),fSe||(console.warn("don't use simulation outside dev"),fSe=!0),{}):{}}var AF=khe;function u7n(e){AF=!!e}function PB(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function TF(e){var t=JSON.stringify(e),n=(0,s7n.default)(t).toString(36);return e.label&&e.label.length>0&&khe?PB(e.label.join("."),"-")+"-"+n:n}function Ahe(e){var t=Object.keys(e).filter(function(n){return n!=="toString"});return t.length!==1?!1:!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function The(e){var t=Object.keys(e).filter(function(i){return i!=="toString"});if(t.length!==1)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/,r=n.exec(t[0]);if(!r)throw new Error("not a rule");return r[1]}var c7n=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function JJ(e){if(e.indexOf(",")===-1)return[e];for(var t=[],n=[],r=0,i;i=c7n.exec(e);)switch(i[0]){case"(":r++;break;case")":r--;break;case",":if(r)break;t.push(i.index)}for(i=t.length;i--;)n.unshift(e.slice(t[i]+1)),e=e.slice(0,t[i]);return n.unshift(e),n}function hSe(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=JJ(t).map(function(r){return r.indexOf("&")>=0?[r.replace(/\&/mg,".css-"+e),r.replace(/\&/mg,"[data-css-"+e+"]")].join(","):".css-"+e+r+",[data-css-"+e+"]"+r}).join(",");return Ehe&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+PB(t)+"],[data-css-"+e+"][data-simulate-"+PB(t)+"]"),n}function eee(e){var t=e.selector,n=e.style,r=EF.transform({selector:t,style:n});return r.selector+"{"+(0,_he.createMarkupForStyles)(r.style)+"}"}function LB(e){var t=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(e).forEach(function(s){s.indexOf("&")>=0?(n=n||{},n[s]=e[s]):s.indexOf("@media")===0?(r=r||{},r[s]=LB(e[s])):s.indexOf("@supports")===0?(i=i||{},i[s]=LB(e[s])):s==="label"?e.label.length>0&&(t=t||{},t.label=AF?e.label.join("."):""):(t=t||{},t[s]=e[s])}),{plain:t,selects:n,medias:r,supports:i}}function BB(e,t){var n=[],r=t.plain,i=t.selects,s=t.medias,a=t.supports;return r&&n.push(eee({style:r,selector:hSe(e)})),i&&Object.keys(i).forEach(function(o){return n.push(eee({style:i[o],selector:hSe(e,o)}))}),s&&Object.keys(s).forEach(function(o){return n.push(o+"{"+BB(e,s[o]).join("")+"}")}),a&&Object.keys(a).forEach(function(o){return n.push(o+"{"+BB(e,a[o]).join("")+"}")}),n}var qc=Fl.inserted={};function f7n(e){if(!qc[e.id]){qc[e.id]=!0;var t=LB(e.style),n=BB(e.id,t);qc[e.id]=pV?!0:n,n.forEach(function(r){return Fl.insert(r)})}}var VD=Fl.registered={};function gV(e){VD[e.id]||(VD[e.id]=e)}function h7n(e){if(Ahe(e)){var t=VD[The(e)];if(t==null)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}var Z4={};function d7n(e){if(gV(e),f7n(e),Z4[e.id])return Z4[e.id];var t=kF({},"data-css-"+e.id,AF&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),Z4[e.id]=t,t}function p7n(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),i=0;i<t.length;i++)if(r===t[i]){n=!0;break}return n||e.indexOf("&")>=0}function dSe(e,t){var n=JJ(e).map(function(i){return i.indexOf("&")>=0?i:"&"+i}),r=JJ(t).map(function(i){return i.indexOf("&")>=0?i:"&"+i});return r.reduce(function(i,s){return i.concat(n.map(function(a){return s.replace(/\&/g,a)}))},[]).join(",")}function g7n(e,t){return e?"@media "+e.substring(6)+" and "+t.substring(6):t}function m7n(e){return e.indexOf("@media")===0}function v7n(e){return e.indexOf("@supports")===0}function y7n(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function ZXe(e){for(var t=[],n=0;n<e.length;n++)Array.isArray(e[n])?t=t.concat(ZXe(e[n])):t=t.concat(e[n]);return t}var pSe={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function $1(e,t){var n=t.selector,r=n===void 0?"":n,i=t.mq,s=i===void 0?"":i,a=t.supp,o=a===void 0?"":a,l=t.src,u=l===void 0?{}:l;Array.isArray(u)||(u=[u]),u=ZXe(u),u.forEach(function(c){if(Ahe(c)){var f=h7n(c);if(f.type!=="css")throw new Error("cannot merge this rule");c=f.style}c=(0,bv.default)(c),c&&c.composes&&$1(e,{selector:r,mq:s,supp:o,src:c.composes}),Object.keys(c||{}).forEach(function(h){if(p7n(h))pSe[h]&&pSe[h].forEach(function(p){return $1(e,{selector:dSe(r,p),mq:s,supp:o,src:c[h]})}),$1(e,{selector:dSe(r,h),mq:s,supp:o,src:c[h]});else if(m7n(h))$1(e,{selector:r,mq:g7n(s,h),supp:o,src:c[h]});else if(v7n(h))$1(e,{selector:r,mq:s,supp:y7n(o,h),src:c[h]});else if(h!=="composes"){var d=e;o&&(d[o]=d[o]||{},d=d[o]),s&&(d[s]=d[s]||{},d=d[s]),r&&(d[r]=d[r]||{},d=d[r]),h==="label"?AF&&(e.label=e.label.concat(c.label)):d[h]=c[h]}})})}function gSe(e){var t={label:[]};$1(t,{src:e});var n={id:TF(t),style:t,label:AF?t.label.join("."):"",type:"css"};return d7n(n)}var zB={};Object.defineProperty(zB,"toString",{enumerable:!1,value:function(){return"css-nil"}});var LR=typeof WeakMap<"u"?[zB,new WeakMap,new WeakMap,new WeakMap]:[zB];function b7n(e){return function(t){if(LR[t.length]){for(var n=LR[t.length],r=0;r<t.length-1;)n.has(t[r])||n.set(t[r],new WeakMap),n=n.get(t[r]),r++;if(n.has(t[t.length-1])){var i=n.get(t[r]);if(VD[i.toString().substring(4)])return i}}var s=e(t);if(LR[t.length]){for(var a=0,o=LR[t.length];a<t.length-1;)o=o.get(t[a]),a++;try{o.set(t[a],s)}catch{}}return s}}var x7n=typeof WeakMap<"u"?b7n(gSe):gSe;function ps(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return t=(0,bv.default)(t),t?x7n(t):zB}ps.insert=function(e){var t={id:TF(e),css:e,type:"raw"};gV(t),qc[t.id]||(Fl.insert(t.css),qc[t.id]=pV?!0:[t.css])};De.insertRule=ps.insert;ps.global=function(e,t){if(t=(0,bv.default)(t),t)return ps.insert(eee({selector:e,style:t}))};De.insertGlobal=ps.global;function w7n(e){if(!qc[e.id]){var t=Object.keys(e.keyframes).map(function(r){var i=EF.keyframes.transform({id:e.id,name:r,style:e.keyframes[r]});return i.name+"{"+(0,_he.createMarkupForStyles)(i.style)+"}"}).join(""),n=["-webkit-","-moz-","-o-",""].map(function(r){return"@"+r+"keyframes "+(e.name+"_"+e.id)+"{"+t+"}"});n.forEach(function(r){return Fl.insert(r)}),qc[e.id]=pV?!0:n}}ps.keyframes=function(e,t){t||(t=e,e="animation"),t=(0,bv.default)(t)||{};var n={id:TF({name:e,kfs:t}),type:"keyframes",name:e,keyframes:t};return gV(n),w7n(n),e+"_"+n.id};ps.fontFace=function(e){e=(0,bv.default)(e);var t={id:TF(e),type:"font-face",font:e};return gV(t),$7n(t),e.fontFamily};De.fontFace=ps.fontFace;De.keyframes=ps.keyframes;function $7n(e){if(!qc[e.id]){var t="@font-face{"+(0,_he.createMarkupForStyles)(e.font)+"}";Fl.insert(t),qc[e.id]=pV?!0:[t]}}function C7n(e){(0,t7n.default)(qc,e.reduce(function(t,n){return t[n]=!0,t},{}))}function _7n(){qc=Fl.inserted={},VD=Fl.registered={},Z4={},Fl.flush(),Fl.inject()}De.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var S7n=De.style=ps;function Dhe(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?ps(kF({},e,n)):S7n(n)}De.$=Dhe;function k7n(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ps(kF({},e+" &",n))}De.merge=ps;De.compose=ps;function E7n(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ps(kF({},"@media "+e,n))}function $t(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ps(kF({},e,n))}function A7n(e){return $t(":active",e)}function T7n(e){return $t(":any",e)}function D7n(e){return $t(":checked",e)}function I7n(e){return $t(":disabled",e)}function N7n(e){return $t(":empty",e)}function M7n(e){return $t(":enabled",e)}function F7n(e){return $t(":default",e)}function O7n(e){return $t(":first",e)}function R7n(e){return $t(":first-child",e)}function P7n(e){return $t(":first-of-type",e)}function L7n(e){return $t(":fullscreen",e)}function B7n(e){return $t(":focus",e)}function z7n(e){return $t(":hover",e)}function U7n(e){return $t(":indeterminate",e)}function W7n(e){return $t(":in-range",e)}function V7n(e){return $t(":invalid",e)}function j7n(e){return $t(":last-child",e)}function H7n(e){return $t(":last-of-type",e)}function q7n(e){return $t(":left",e)}function G7n(e){return $t(":link",e)}function Y7n(e){return $t(":only-child",e)}function X7n(e){return $t(":only-of-type",e)}function K7n(e){return $t(":optional",e)}function Z7n(e){return $t(":out-of-range",e)}function Q7n(e){return $t(":read-only",e)}function J7n(e){return $t(":read-write",e)}function e9n(e){return $t(":required",e)}function t9n(e){return $t(":right",e)}function n9n(e){return $t(":root",e)}function r9n(e){return $t(":scope",e)}function i9n(e){return $t(":target",e)}function s9n(e){return $t(":valid",e)}function a9n(e){return $t(":visited",e)}function o9n(e,t){return $t(":dir("+e+")",t)}function l9n(e,t){return $t(":lang("+e+")",t)}function u9n(e,t){var n=e.split(",").map(function(r){return r.trim()}).map(function(r){return":not("+r+")"});return n.length===1?$t(":not("+e+")",t):Dhe(n.join(""),t)}function c9n(e,t){return $t(":nth-child("+e+")",t)}function f9n(e,t){return $t(":nth-last-child("+e+")",t)}function h9n(e,t){return $t(":nth-last-of-type("+e+")",t)}function d9n(e,t){return $t(":nth-of-type("+e+")",t)}function p9n(e){return $t("::after",e)}function g9n(e){return $t("::before",e)}function m9n(e){return $t("::first-letter",e)}function v9n(e){return $t("::first-line",e)}function y9n(e){return $t("::selection",e)}function b9n(e){return $t("::backdrop",e)}function x9n(e){return ps({"::placeholder":e})}function w9n(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,bv.default)(t),t?t.map(function(r){var i={label:[]};return $1(i,{src:r}),BB(TF(i),LB(i)).join("")}).join(""):""}function $9n(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t=(0,bv.default)(t);var r=t?t.map(function(i){The(i);var s=Object.keys(i)[0],a=i[s];return s+'="'+(a||"")+'"'}).join(" "):"";return r}var To={},DF={};Object.defineProperty(DF,"__esModule",{value:!0});function C9n(e){return e.name!=null}DF.isSurfaceInfo=C9n;function _9n(e){return e.drawArea instanceof HTMLElement}DF.isSurface=_9n;var IF={},Ihe={};function S9n(){}var gl={},x2=[],mSe=[];function jD(e,t){var n=mSe,r,i,s,a;for(a=arguments.length;a-- >2;)x2.push(arguments[a]);for(t&&t.children!=null&&(x2.length||x2.push(t.children),delete t.children);x2.length;)if((i=x2.pop())&&i.pop!==void 0)for(a=i.length;a--;)x2.push(i[a]);else typeof i=="boolean"&&(i=null),(s=typeof e!="function")&&(i==null?i="":typeof i=="number"?i=String(i):typeof i!="string"&&(s=!1)),s&&r?n[n.length-1]+=i:n===mSe?n=[i]:n.push(i),r=s;var o=new S9n;return o.nodeName=e,o.children=n,o.attributes=t==null?void 0:t,o.key=t==null?void 0:t.key,gl.vnode!==void 0&&gl.vnode(o),o}function E0(e,t){for(var n in t)e[n]=t[n];return e}var k9n=typeof Promise=="function"?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function QXe(e,t){return jD(e.nodeName,E0(E0({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var E9n=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,tee=[];function JXe(e){!e._dirty&&(e._dirty=!0)&&tee.push(e)==1&&(gl.debounceRendering||k9n)(Nhe)}function Nhe(){var e,t=tee;for(tee=[];e=t.pop();)e._dirty&&mV(e)}function A9n(e,t,n){return typeof t=="string"||typeof t=="number"?e.splitText!==void 0:typeof t.nodeName=="string"?!e._componentConstructor&&eKe(e,t.nodeName):n||e._componentConstructor===t.nodeName}function eKe(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function tKe(e){var t=E0({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(n!==void 0)for(var r in n)t[r]===void 0&&(t[r]=n[r]);return t}function T9n(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}function Mhe(e){var t=e.parentNode;t&&t.removeChild(e)}function vSe(e,t,n,r,i){if(t==="className"&&(t="class"),t!=="key")if(t==="ref")n&&n(null),r&&r(e);else if(t==="class"&&!i)e.className=r||"";else if(t==="style"){if((!r||typeof r=="string"||typeof n=="string")&&(e.style.cssText=r||""),r&&typeof r=="object"){if(typeof n!="string")for(var s in n)s in r||(e.style[s]="");for(var s in r)e.style[s]=typeof r[s]=="number"&&E9n.test(s)===!1?r[s]+"px":r[s]}}else if(t==="dangerouslySetInnerHTML")r&&(e.innerHTML=r.__html||"");else if(t[0]=="o"&&t[1]=="n"){var a=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,ySe,a):e.removeEventListener(t,ySe,a),(e._listeners||(e._listeners={}))[t]=r}else if(t!=="list"&&t!=="type"&&!i&&t in e)D9n(e,t,r==null?"":r),(r==null||r===!1)&&e.removeAttribute(t);else{var o=i&&t!==(t=t.replace(/^xlink:?/,""));r==null||r===!1?o?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):typeof r!="function"&&(o?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}}function D9n(e,t,n){try{e[t]=n}catch{}}function ySe(e){return this._listeners[e.type](gl.event&&gl.event(e)||e)}var nKe=[],nee=0,jg=!1,UB=!1;function rKe(){for(var e;e=nKe.pop();)gl.afterMount&&gl.afterMount(e),e.componentDidMount&&e.componentDidMount()}function iKe(e,t,n,r,i,s){nee++||(jg=i!=null&&i.ownerSVGElement!==void 0,UB=e!=null&&!("__preactattr_"in e));var a=sKe(e,t,n,r,s);return i&&a.parentNode!==i&&i.appendChild(a),--nee||(UB=!1,s||rKe()),a}function sKe(e,t,n,r,i){var s=e,a=jg;if((t==null||typeof t=="boolean")&&(t=""),typeof t=="string"||typeof t=="number")return e&&e.splitText!==void 0&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(s=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(s,e),Db(e,!0))),s.__preactattr_=!0,s;var o=t.nodeName;if(typeof o=="function")return O9n(e,t,n,r);if(jg=o==="svg"?!0:o==="foreignObject"?!1:jg,o=String(o),(!e||!eKe(e,o))&&(s=T9n(o,jg),e)){for(;e.firstChild;)s.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(s,e),Db(e,!0)}var l=s.firstChild,u=s.__preactattr_,c=t.children;if(u==null){u=s.__preactattr_={};for(var f=s.attributes,h=f.length;h--;)u[f[h].name]=f[h].value}return!UB&&c&&c.length===1&&typeof c[0]=="string"&&l!=null&&l.splitText!==void 0&&l.nextSibling==null?l.nodeValue!=c[0]&&(l.nodeValue=c[0]):(c&&c.length||l!=null)&&I9n(s,c,n,r,UB||u.dangerouslySetInnerHTML!=null),N9n(s,t.attributes,u),jg=a,s}function I9n(e,t,n,r,i){var s=e.childNodes,a=[],o={},l=0,u=0,c=s.length,f=0,h=t?t.length:0,d,p,g,m,v;if(c!==0)for(var y=0;y<c;y++){var b=s[y],x=b.__preactattr_,w=h&&x?b._component?b._component.__key:x.key:null;w!=null?(l++,o[w]=b):(x||(b.splitText!==void 0?i?b.nodeValue.trim():!0:i))&&(a[f++]=b)}if(h!==0)for(var y=0;y<h;y++){m=t[y],v=null;var w=m.key;if(w!=null)l&&o[w]!==void 0&&(v=o[w],o[w]=void 0,l--);else if(!v&&u<f){for(d=u;d<f;d++)if(a[d]!==void 0&&A9n(p=a[d],m,i)){v=p,a[d]=void 0,d===f-1&&f--,d===u&&u++;break}}v=sKe(v,m,n,r),g=s[y],v&&v!==e&&v!==g&&(g==null?e.appendChild(v):v===g.nextSibling?Mhe(g):e.insertBefore(v,g))}if(l)for(var y in o)o[y]!==void 0&&Db(o[y],!1);for(;u<=f;)(v=a[f--])!==void 0&&Db(v,!1)}function Db(e,t){var n=e._component;n?vV(n):(e.__preactattr_!=null&&e.__preactattr_.ref&&e.__preactattr_.ref(null),(t===!1||e.__preactattr_==null)&&Mhe(e),aKe(e))}function aKe(e){for(e=e.lastChild;e;){var t=e.previousSibling;Db(e,!0),e=t}}function N9n(e,t,n){var r;for(r in n)!(t&&t[r]!=null)&&n[r]!=null&&vSe(e,r,n[r],n[r]=void 0,jg);for(r in t)r!=="children"&&r!=="innerHTML"&&(!(r in n)||t[r]!==(r==="value"||r==="checked"?e[r]:n[r]))&&vSe(e,r,n[r],n[r]=t[r],jg)}var ree={};function M9n(e){var t=e.constructor.name;(ree[t]||(ree[t]=[])).push(e)}function oKe(e,t,n){var r=ree[e.name],i;if(e.prototype&&e.prototype.render?(i=new e(t,n),HD.call(i,t,n)):(i=new HD(t,n),i.constructor=e,i.render=F9n),r){for(var s=r.length;s--;)if(r[s].constructor===e){i.nextBase=r[s].nextBase,r.splice(s,1);break}}return i}function F9n(e,t,n){return this.constructor(e,n)}function WB(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,n!==0&&(n===1||gl.syncComponentUpdates!==!1||!e.base?mV(e,1,i):JXe(e)),e.__ref&&e.__ref(e))}function mV(e,t,n,r){if(!e._disable){var i=e.props,s=e.state,a=e.context,o=e.prevProps||i,l=e.prevState||s,u=e.prevContext||a,c=e.base,f=e.nextBase,h=c||f,d=e._component,p=!1,g,m,v;if(c&&(e.props=o,e.state=l,e.context=u,t!==2&&e.shouldComponentUpdate&&e.shouldComponentUpdate(i,s,a)===!1?p=!0:e.componentWillUpdate&&e.componentWillUpdate(i,s,a),e.props=i,e.state=s,e.context=a),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!p){g=e.render(i,s,a),e.getChildContext&&(a=E0(E0({},a),e.getChildContext()));var y=g&&g.nodeName,b,x;if(typeof y=="function"){var w=tKe(g);m=d,m&&m.constructor===y&&w.key==m.__key?WB(m,w,1,a,!1):(b=m,e._component=m=oKe(y,w,a),m.nextBase=m.nextBase||f,m._parentComponent=e,WB(m,w,0,a,!1),mV(m,1,n,!0)),x=m.base}else v=h,b=d,b&&(v=e._component=null),(h||t===1)&&(v&&(v._component=null),x=iKe(v,g,a,n||!c,h&&h.parentNode,!0));if(h&&x!==h&&m!==d){var C=h.parentNode;C&&x!==C&&(C.replaceChild(x,h),b||(h._component=null,Db(h,!1)))}if(b&&vV(b),e.base=x,x&&!r){for(var $=e,_=e;_=_._parentComponent;)($=_).base=x;x._component=$,x._componentConstructor=$.constructor}}if(!c||n?nKe.unshift(e):p||(e.componentDidUpdate&&e.componentDidUpdate(o,l,u),gl.afterUpdate&&gl.afterUpdate(e)),e._renderCallbacks!=null)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);!nee&&!r&&rKe()}}function O9n(e,t,n,r){for(var i=e&&e._component,s=i,a=e,o=i&&e._componentConstructor===t.nodeName,l=o,u=tKe(t);i&&!l&&(i=i._parentComponent);)l=i.constructor===t.nodeName;return i&&l&&(!r||i._component)?(WB(i,u,3,n,r),e=i.base):(s&&!o&&(vV(s),e=a=null),i=oKe(t.nodeName,u,n),e&&!i.nextBase&&(i.nextBase=e,a=null),WB(i,u,1,n,r),e=i.base,a&&e!==a&&(a._component=null,Db(a,!1))),e}function vV(e){gl.beforeUnmount&&gl.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?vV(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,Mhe(t),M9n(e),aKe(t)),e.__ref&&e.__ref(null)}function HD(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}E0(HD.prototype,{setState:function(t,n){var r=this.state;this.prevState||(this.prevState=E0({},r)),E0(r,typeof t=="function"?t(r,this.props):t),n&&(this._renderCallbacks=this._renderCallbacks||[]).push(n),JXe(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),mV(this,2)},render:function(){}});function lKe(e,t,n){return iKe(n,e,{},!1,t,!1)}var R9n={h:jD,createElement:jD,cloneElement:QXe,Component:HD,render:lKe,rerender:Nhe,options:gl};const P9n=Object.freeze(Object.defineProperty({__proto__:null,default:R9n,h:jD,createElement:jD,cloneElement:QXe,Component:HD,render:lKe,rerender:Nhe,options:gl},Symbol.toStringTag,{value:"Module"})),Fhe=Fb(P9n);var Ohe={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Ohe,"__esModule",{value:!0});const BR=Fhe,BG=De;class bw extends BR.Component{componentDidMount(){const{name:t,tab:n}=this.props;this.props.registerSurface(t,n,this)}componentDidUpdate(){return!1}render(){const{name:t,visible:n,styles:r}=this.props,i=Object.assign({},bw.defaultStyles,r),{width:s,height:a}=i;let{maxHeight:o,maxWidth:l}=i;o=a===bw.defaultStyles.height?o:a,l=s===bw.defaultStyles.width?l:s;const u=BG.css({display:n?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:a,width:s,maxHeight:o,maxWidth:l,overflow:"auto"}),c=BG.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),f=BG.css({boxSizing:"border-box"});return BR.h("div",{className:`${u} tf-surface`,ref:h=>this.container=h,"data-visible":n},BR.h("div",{className:`${c} tf-label`,ref:h=>this.label=h},t),BR.h("div",{className:`${f} tf-draw-area`,ref:h=>this.drawArea=h}))}}bw.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"};Ohe.SurfaceComponent=bw;var Rhe={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Rhe,"__esModule",{value:!0});const VA=Fhe,uKe=De;class L9n extends VA.Component{render(){const{tabNames:t,activeTab:n,handleClick:r}=this.props,i=t.length>0?t.map(a=>VA.h(B9n,{key:a,id:a,handleClick:r,isActive:a===n},a)):null,s=uKe.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return VA.h("div",{className:`${s} visor-tabs`},i)}}Rhe.Tabs=L9n;class B9n extends VA.Component{render(){const{children:t,isActive:n,handleClick:r,id:i}=this.props,s=uKe.css({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return VA.h("a",{className:`${s} tf-tab`,"data-isactive":n,onClick:()=>r(i)},t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Ihe,"__esModule",{value:!0});const hc=Fhe,G1=De,z9n=Ohe,U9n=Rhe;class Phe extends hc.Component{static render(t,n,r){return hc.render(hc.h(Phe,Object.assign({},r)),t,n)}constructor(t){super(t),this.surfaces=new Map;const n=t.startOpen==null?!0:t.startOpen;this.state={isOpen:n,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,n){const r=this.surfaceId(t,n);let i;if(this.surfaces.has(r))i=this.surfaces.get(r);else throw Error(`Surface not found with id: ${r}`);return{container:i.container,label:i.label,drawArea:i.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,n){return t+n}setTabs(t){const n=t.map(s=>s.tab),r=this.state.tabs;let i;for(const s of n)r.has(s)||(r.add(s),i=s);i!=null&&this.setState({tabs:r,activeTab:i})}getTabs(){return this.state.tabs}registerSurface(t,n,r){const i=this.surfaceId(t,n);this.surfaces.set(i,r)}keyHandler(t){t.keyCode===192&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){const{isOpen:t,isFullscreen:n,activeTab:r}=this.state,{surfaceList:i}=this.props,s=Array.from(this.getTabs().values()),l=n?"90vw":"550px",u=G1.css({width:l,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),c=G1.css({right:"0"}),f=G1.css({right:`calc(-${l} - 10px)`}),h=t?c:f,d=G1.css({});return hc.h("div",{className:`${u} ${h} visor`,"data-isopen":t,"data-isfullscreen":n},hc.h(W9n,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:n}),hc.h(U9n.Tabs,{tabNames:s,activeTab:r,handleClick:this.setActiveTab.bind(this)}),hc.h("div",{className:`${d} visor-surfaces`},i.map(p=>hc.h(z9n.SurfaceComponent,{key:p.name+p.tab,name:p.name,tab:p.tab,styles:p.styles,registerSurface:this.registerSurface.bind(this),visible:r===p.tab}))))}}Ihe.VisorComponent=Phe;function W9n(e){const{isFullScreen:t,fullScreenHandler:n,closeHandler:r}=e,i=G1.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),s=G1.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),a=G1.css({marginLeft:"auto"});return hc.h("div",{className:`${i} visor-controls`},hc.h("button",{className:`${s}`,onClick:n},t?"Minimize":"Maximize"),hc.h("button",{className:`${s} ${a}`,onClick:r},"Hide"))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(IF,"__esModule",{value:!0});const V9n=Ihe;let zR;const j9n="Visor",zG="tfjs-visor-container";function H9n(){if(typeof document>"u")throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(zG)&&zR!=null)return zR;let e=document.getElementById(zG);e==null&&(e=document.createElement("div"),e.id=zG,document.body.appendChild(e));let t;function n(s,a){let o=null;return t=V9n.VisorComponent.render(s,t,{ref:l=>o=l,surfaceList:Array.from(a.values())}),o}const r=new Map,i=n(e,r);return zR=new cKe(i,e,r,n),zR}IF.visor=H9n;class cKe{constructor(t,n,r,i){this.visorComponent=t,this.el=n,this.surfaceList=r,this.renderVisor=i}surface(t){const{name:n}=t,r=t.tab==null?j9n:t.tab;if(n==null||!(typeof n=="string"||n instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const i=Object.assign({},t,{tab:r}),s=`${n}-${r}`;return this.surfaceList.has(s)||this.surfaceList.set(s,i),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(n,r)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error(`Tab '${t}' does not exist`);this.visorComponent.setState({activeTab:t})}}IF.Visor=cKe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var q9n=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(To,"__esModule",{value:!0});const bSe=DF,G9n=IF;function Y9n(e){if(e instanceof HTMLElement)return e;if(bSe.isSurface(e))return e.drawArea;if(bSe.isSurfaceInfo(e))return G9n.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")}To.getDrawArea=Y9n;function X9n(e,t){const n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){const s=n[i];if(e[s]!==t[s])return!1}return!0}To.shallowEquals=X9n;function K9n(){return q9n(this,void 0,void 0,function*(){yield new Promise(e=>requestAnimationFrame(e))})}To.nextFrame=K9n;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Zu,"__esModule",{value:!0});const xSe=De,Z9n=To,Q9n={prepend:!1};function J9n(e,t,n={}){const r=Z9n.getDrawArea(e),i=xSe.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),s=xSe.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),a=Object.assign({},Q9n,n);let o=r.querySelector(`div[data-name=${t}]`);if(!o){if(o=document.createElement("div"),o.setAttribute("class",`${i}`),o.dataset.name=t,a.title){const l=document.createElement("div");l.setAttribute("class",`subsurface-title ${s}`),l.innerText=a.title,o.appendChild(l)}a.prepend?r.insertBefore(o,r.firstChild):r.appendChild(o)}return o}Zu.subSurface=J9n;function eUn(e){let n=0,r=e;for(;r&&r.clientWidth===0;)r=r.parentElement,n=50;return r.clientWidth-n}Zu.getDefaultWidth=eUn;function tUn(e){return e.clientHeight===0?200:e.clientHeight}Zu.getDefaultHeight=tUn;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var nUn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})},rUn=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ore,"__esModule",{value:!0});const iUn=rUn(TS),wSe=Zu,UR=To;function sUn(e,t,n={}){return nUn(this,void 0,void 0,function*(){const r=UR.getDrawArea(e),i=t,s=Object.assign({},aUn,n);if(UG.has(r)){const m=UG.get(r);if(UR.shallowEquals(s,m.lastOptions)){yield UR.nextFrame();const v=m.view,y=v.changeset().remove(()=>!0).insert(i);yield v.change("values",y).runAsync();return}}const{xLabel:a,yLabel:o,xType:l,yType:u}=s;let c=null;a!=null&&(c={title:a});let f=null;o!=null&&(f={title:o});const h={actions:!1,mode:"vega-lite",defaultStyle:!1};let d;s.color!=null?Array.isArray(s.color)?d={field:"index",type:"nominal",scale:{range:s.color}}:d={value:s.color}:d={value:"#4C78A0"};const p={width:s.width||wSe.getDefaultWidth(r),height:s.height||wSe.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:l,axis:c},y:{field:"value",type:u,axis:f},color:d}};yield UR.nextFrame();const g=yield iUn.default(r,p,h);UG.set(r,{view:g.view,lastOptions:s})})}ore.barchart=sUn;const aUn={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},UG=new Map;var Lhe={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var oUn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})},lUn=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Lhe,"__esModule",{value:!0});const uUn=lUn(TS),$Se=Zu,cUn=To;function fUn(e,t,n={}){return oUn(this,void 0,void 0,function*(){const r=Object.assign({},hUn,n),i=cUn.getDrawArea(e),s=[],a=t.values,o=t.tickLabels||[],l=o.length===0;let u=!0;for(let d=0;d<a.length;d++){const p=l?`Class ${d}`:o[d];l&&o.push(p);for(let g=0;g<a[d].length;g++){const m=l?`Class ${g}`:o[g],v=a[d][g];d===g&&!r.shadeDiagonal?s.push({label:p,prediction:m,count:v,noFill:!0}):(s.push({label:p,prediction:m,count:v,scaleCount:v}),v!==0&&(u=!1))}}if(!r.shadeDiagonal&&u)for(const d of s)d.noFill===!0&&(d.noFill=!1,d.scaleCount=d.count);const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||$Se.getDefaultWidth(i),height:r.height||$Se.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:s},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:o}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:o}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};r.shadeDiagonal===!1&&f.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&f.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});const h=typeof r.colorMap=="string"?{scheme:r.colorMap}:r.colorMap;f.layer[0].encoding.color.scale.range=h,yield uUn.default(i,f,c)})}Lhe.confusionMatrix=fUn;const hUn={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]};var Bhe={},Cg={};Object.defineProperty(Cg,"__esModule",{value:!0});/*
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fKe(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}Cg.assert=fKe;function dUn(e,t,n=""){fKe(hKe(e,t),n+` Shapes ${e} and ${t} must match`)}Cg.assertShapesMatch=dUn;function hKe(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}Cg.arraysEqual=hKe;Cg.DECIMAL_PLACES_TO_CHECK=4;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var dKe=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})},pUn=mt&&mt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},gUn=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Bhe,"__esModule",{value:!0});const jA=pUn(pFe),mUn=gUn(TS),CSe=Zu,qD=Cg,vUn=To;function yUn(e,t,n={}){return dKe(this,void 0,void 0,function*(){const r=Object.assign({},xUn,n),i=vUn.getDrawArea(e);let s=t.values;r.rowMajor&&(s=yield bUn(t.values));const{xTickLabels:a,yTickLabels:o}=t;a!=null&&_Se(s,a,0),o!=null&&_Se(s,o,1);const l="@tfidx@",u=[];if(s instanceof jA.Tensor){qD.assert(s.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const g=yield s.data(),[m,v]=s.shape;for(let y=0;y<m;y++){const b=a?`${a[y]}${l}${y}`:y;for(let x=0;x<v;x++){const w=o?`${o[x]}${l}${x}`:x,C=y*v+x,$=g[C];u.push({x:b,y:w,value:$})}}}else{const g=s;for(let m=0;m<g.length;m++){const v=a?`${a[m]}${l}${m}`:m;for(let y=0;y<g[m].length;y++){const b=o?`${o[y]}${l}${y}`:y,x=g[m][y];u.push({x:v,y:b,value:x})}}}const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||CSe.getDefaultWidth(i),height:r.height||CSe.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:u},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:r.xType,title:r.xLabel,sort:!1},y:{field:"y",type:r.yType,title:r.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},h=`${l}\\d+$`,d=new RegExp(h);a&&(f.encoding.x.axis={labelExpr:`replace(datum.value, regexp(/${h}/), '')`}),o&&(f.encoding.y.axis={labelExpr:`replace(datum.value, regexp(/${h}/), '')`}),(a||o)&&(c.tooltip={sanitize:g=>String(g).replace(d,"")});let p;switch(r.colorMap){case"blues":p=["#f7fbff","#4292c6"];break;case"greyscale":p=["#000000","#ffffff"];break;case"viridis":default:p="viridis";break}if(p!=="viridis"){const g=f.encoding.fill;g.scale={range:p}}if(r.domain){const g=f.encoding.fill;g.scale!=null?g.scale=Object.assign({},g.scale,{domain:r.domain}):g.scale={domain:r.domain}}yield mUn.default(i,f,c)})}Bhe.heatmap=yUn;function bUn(e){return dKe(this,void 0,void 0,function*(){let t,n;e instanceof jA.Tensor?(t=e.shape,n=e.transpose()):(t=[e.length,e[0].length],n=jA.tidy(()=>jA.tensor2d(e).transpose())),qD.assert(n.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const r=yield n.array();n.dispose();const i=[r.length,r[0].length];return qD.assert(t[0]===i[1]&&t[1]===i[0],`Unexpected transposed shape. Original ${t} : Transposed ${i}`),r})}function _Se(e,t,n){const r=e instanceof jA.Tensor?e.shape:[e.length,e[0].length];n===0?qD.assert(r[0]===t.length,`Length of xTickLabels (${t.length}) must match number of rows (${r[0]})`):n===1&&qD.assert(r[1]===t.length,`Length of yTickLabels (${t.length}) must match number of columns (${r[1]})`)}const xUn={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1};var NF={};function VB(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function sC(e){return e=VB(Math.abs(e)),e?e[1]:NaN}function wUn(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function $Un(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var CUn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function jB(e){return new zhe(e)}jB.prototype=zhe.prototype;function zhe(e){if(!(t=CUn.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}zhe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function _Un(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(r>0){if(!+e[n])break e;r=0}break}return r>0?e.slice(0,r)+e.slice(i+1):e}var pKe;function SUn(e,t){var n=VB(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(pKe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+VB(e,Math.max(0,t+s-1))[0]}function SSe(e,t){var n=VB(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const kSe={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return SSe(e*100,t)},r:SSe,s:SUn,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function ESe(e){return e}var ASe=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function gKe(e){var t=e.grouping&&e.thousands?wUn(e.grouping,e.thousands):ESe,n=e.currency,r=e.decimal,i=e.numerals?$Un(e.numerals):ESe,s=e.percent||"%";function a(l){l=jB(l);var u=l.fill,c=l.align,f=l.sign,h=l.symbol,d=l.zero,p=l.width,g=l.comma,m=l.precision,v=l.trim,y=l.type;y==="n"?(g=!0,y="g"):kSe[y]||(m==null&&(m=12),v=!0,y="g"),(d||u==="0"&&c==="=")&&(d=!0,u="0",c="=");var b=h==="$"?n[0]:h==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x=h==="$"?n[1]:/[%p]/.test(y)?s:"",w=kSe[y],C=/[defgprs%]/.test(y);m=m==null?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m));function $(_){var k=b,E=x,S,I,A;if(y==="c")E=w(_)+E,_="";else{_=+_;var D=_<0;if(_=w(Math.abs(_),m),v&&(_=_Un(_)),D&&+_==0&&(D=!1),k=(D?f==="("?f:"-":f==="-"||f==="("?"":f)+k,E=(y==="s"?ASe[8+pKe/3]:"")+E+(D&&f==="("?")":""),C){for(S=-1,I=_.length;++S<I;)if(A=_.charCodeAt(S),48>A||A>57){E=(A===46?r+_.slice(S+1):_.slice(S))+E,_=_.slice(0,S);break}}}g&&!d&&(_=t(_,1/0));var T=k.length+_.length+E.length,N=T<p?new Array(p-T+1).join(u):"";switch(g&&d&&(_=t(N+_,N.length?p-E.length:1/0),N=""),c){case"<":_=k+_+E+N;break;case"=":_=k+N+_+E;break;case"^":_=N.slice(0,T=N.length>>1)+k+_+E+N.slice(T);break;default:_=N+k+_+E;break}return i(_)}return $.toString=function(){return l+""},$}function o(l,u){var c=a((l=jB(l),l.type="f",l)),f=Math.max(-8,Math.min(8,Math.floor(sC(u)/3)))*3,h=Math.pow(10,-f),d=ASe[8+f/3];return function(p){return c(h*p)+d}}return{format:a,formatPrefix:o}}var WR,mKe,vKe;yKe({decimal:".",thousands:",",grouping:[3],currency:["$",""]});function yKe(e){return WR=gKe(e),mKe=WR.format,vKe=WR.formatPrefix,WR}function kUn(e){return Math.max(0,-sC(Math.abs(e)))}function EUn(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(sC(t)/3)))*3-sC(Math.abs(e)))}function AUn(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,sC(t)-sC(e))+1}const TUn=Object.freeze(Object.defineProperty({__proto__:null,formatDefaultLocale:yKe,get format(){return mKe},get formatPrefix(){return vKe},formatLocale:gKe,formatSpecifier:jB,precisionFixed:kUn,precisionPrefix:EUn,precisionRound:AUn},Symbol.toStringTag,{value:"Module"})),bKe=Fb(TUn);var Ed={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var yV=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(Ed,"__esModule",{value:!0});const Ib=pFe,u0=Cg;function DUn(e){if(!Array.isArray(e))throw new Error("input must be an array");if(e.length===0)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const t=e.length;let n=-1/0,r=1/0,i=0,s=0,a=0;for(let l=0;l<t;l++){const u=e[l];u>n&&(n=u),u<r&&(r=u),u===0&&(i+=1),isNaN(u)?s+=1:isFinite(u)||(a+=1)}const o={numVals:t,numZeros:i,numNans:s,max:n,min:r,numInfs:a};return o.max===-1/0&&(o.max=NaN),o.min===1/0&&(o.min=NaN),o}Ed.arrayStats=DUn;function IUn(e){return yV(this,void 0,void 0,function*(){const[t,n,r]=Ib.tidy(()=>{const i=Ib.scalar(0,e.dtype),s=e.min(),a=e.max(),o=e.equal(i).sum();return[s,a,o]});return Promise.all([e.data(),t.data(),n.data(),r.data()]).then(([i,s,a,o])=>{const l=i.length;let u=0,c=0;for(let p=0;p<l;p++){const g=i[p];isNaN(g)?u+=1:isFinite(g)||(c+=1)}let f=s[0],h=a[0];return u===l&&(f=NaN,h=NaN),{numVals:l,numZeros:o[0],numNans:u,min:f,max:h,numInfs:c}})})}Ed.tensorStats=IUn;function NUn(e,t,n,r){return yV(this,void 0,void 0,function*(){u0.assert(e.rank===1,"labels must be a 1D tensor"),u0.assert(t.rank===1,"predictions must be a 1D tensor"),u0.assert(e.size===t.size,"labels and predictions must be the same length"),r!=null&&u0.assert(r.size===t.size,"labels and predictions must be the same length");const i=e.cast("int32"),s=t.cast("int32");n==null&&(n=Ib.tidy(()=>Ib.maximum(i.max(),s.max()).cast("int32").dataSync()[0]+1));let a=Promise.resolve(null);return r!=null&&(a=r.data()),Promise.all([i.data(),s.data(),a]).then(([o,l,u])=>{const c=Array(n).fill(0);for(let f=0;f<n;f++)c[f]=Array(n).fill(0);for(let f=0;f<o.length;f++){const h=o[f],d=l[f];u!=null?c[h][d]+=u[f]:c[h][d]+=1}return c})})}Ed.confusionMatrix=NUn;function MUn(e,t){return yV(this,void 0,void 0,function*(){u0.assertShapesMatch(e.shape,t.shape,"Error computing accuracy.");const n=e.equal(t),r=n.mean(),i=(yield r.data())[0];return Ib.dispose([n,r]),i})}Ed.accuracy=MUn;function FUn(e,t,n){return yV(this,void 0,void 0,function*(){return u0.assert(e.rank===1,"labels must be a 1D tensor"),u0.assert(t.rank===1,"predictions must be a 1D tensor"),u0.assert(e.size===t.size,"labels and predictions must be the same length"),n==null&&(n=Ib.tidy(()=>Ib.maximum(e.max(),t.max()).dataSync()[0]+1)),Promise.all([e.data(),t.data()]).then(([r,i])=>{const s=Array(n).fill(0),a=Array(n).fill(0);for(let l=0;l<r.length;l++){const u=r[l],c=i[l];s[u]+=1,u===c&&(a[u]+=1)}const o=[];for(let l=0;l<s.length;l++)o.push({count:s[l],accuracy:s[l]===0?0:a[l]/s[l]});return o})})}Ed.perClassAccuracy=FUn;var NS={},iee="http://www.w3.org/1999/xhtml";const see={svg:"http://www.w3.org/2000/svg",xhtml:iee,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Uhe(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),see.hasOwnProperty(t)?{space:see[t],local:e}:e}function OUn(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===iee&&t.documentElement.namespaceURI===iee?t.createElement(e):t.createElementNS(n,e)}}function RUn(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function bV(e){var t=Uhe(e);return(t.local?RUn:OUn)(t)}function PUn(){}function Whe(e){return e==null?PUn:function(){return this.querySelector(e)}}function LUn(e){typeof e!="function"&&(e=Whe(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,o=r[i]=new Array(a),l,u,c=0;c<a;++c)(l=s[c])&&(u=e.call(l,l.__data__,c,s))&&("__data__"in l&&(u.__data__=l.__data__),o[c]=u);return new $o(r,this._parents)}function BUn(){return[]}function xKe(e){return e==null?BUn:function(){return this.querySelectorAll(e)}}function zUn(e){typeof e!="function"&&(e=xKe(e));for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var a=t[s],o=a.length,l,u=0;u<o;++u)(l=a[u])&&(r.push(e.call(l,l.__data__,u,a)),i.push(l));return new $o(r,i)}var wKe=function(e){return function(){return this.matches(e)}};if(typeof document<"u"){var Xk=document.documentElement;if(!Xk.matches){var UUn=Xk.webkitMatchesSelector||Xk.msMatchesSelector||Xk.mozMatchesSelector||Xk.oMatchesSelector;wKe=function(e){return function(){return UUn.call(this,e)}}}}const $Ke=wKe;function WUn(e){typeof e!="function"&&(e=$Ke(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,o=r[i]=[],l,u=0;u<a;++u)(l=s[u])&&e.call(l,l.__data__,u,s)&&o.push(l);return new $o(r,this._parents)}function CKe(e){return new Array(e.length)}function VUn(){return new $o(this._enter||this._groups.map(CKe),this._parents)}function HB(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}HB.prototype={constructor:HB,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function jUn(e){return function(){return e}}var TSe="$";function HUn(e,t,n,r,i,s){for(var a=0,o,l=t.length,u=s.length;a<u;++a)(o=t[a])?(o.__data__=s[a],r[a]=o):n[a]=new HB(e,s[a]);for(;a<l;++a)(o=t[a])&&(i[a]=o)}function qUn(e,t,n,r,i,s,a){var o,l,u={},c=t.length,f=s.length,h=new Array(c),d;for(o=0;o<c;++o)(l=t[o])&&(h[o]=d=TSe+a.call(l,l.__data__,o,t),d in u?i[o]=l:u[d]=l);for(o=0;o<f;++o)d=TSe+a.call(e,s[o],o,s),(l=u[d])?(r[o]=l,l.__data__=s[o],u[d]=null):n[o]=new HB(e,s[o]);for(o=0;o<c;++o)(l=t[o])&&u[h[o]]===l&&(i[o]=l)}function GUn(e,t){if(!e)return d=new Array(this.size()),u=-1,this.each(function(C){d[++u]=C}),d;var n=t?qUn:HUn,r=this._parents,i=this._groups;typeof e!="function"&&(e=jUn(e));for(var s=i.length,a=new Array(s),o=new Array(s),l=new Array(s),u=0;u<s;++u){var c=r[u],f=i[u],h=f.length,d=e.call(c,c&&c.__data__,u,r),p=d.length,g=o[u]=new Array(p),m=a[u]=new Array(p),v=l[u]=new Array(h);n(c,f,g,m,v,d,t);for(var y=0,b=0,x,w;y<p;++y)if(x=g[y]){for(y>=b&&(b=y+1);!(w=m[b])&&++b<p;);x._next=w||null}}return a=new $o(a,r),a._enter=o,a._exit=l,a}function YUn(){return new $o(this._exit||this._groups.map(CKe),this._parents)}function XUn(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),a=new Array(r),o=0;o<s;++o)for(var l=t[o],u=n[o],c=l.length,f=a[o]=new Array(c),h,d=0;d<c;++d)(h=l[d]||u[d])&&(f[d]=h);for(;o<r;++o)a[o]=t[o];return new $o(a,this._parents)}function KUn(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],a;--i>=0;)(a=r[i])&&(s&&s!==a.nextSibling&&s.parentNode.insertBefore(a,s),s=a);return this}function ZUn(e){e||(e=QUn);function t(f,h){return f&&h?e(f.__data__,h.__data__):!f-!h}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var a=n[s],o=a.length,l=i[s]=new Array(o),u,c=0;c<o;++c)(u=a[c])&&(l[c]=u);l.sort(t)}return new $o(i,this._parents).order()}function QUn(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function JUn(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function eWn(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e}function tWn(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var a=r[i];if(a)return a}return null}function nWn(){var e=0;return this.each(function(){++e}),e}function rWn(){return!this.node()}function iWn(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,a=i.length,o;s<a;++s)(o=i[s])&&e.call(o,o.__data__,s,i);return this}function sWn(e){return function(){this.removeAttribute(e)}}function aWn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function oWn(e,t){return function(){this.setAttribute(e,t)}}function lWn(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function uWn(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function cWn(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function fWn(e,t){var n=Uhe(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?aWn:sWn:typeof t=="function"?n.local?cWn:uWn:n.local?lWn:oWn)(n,t))}function Vhe(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function hWn(e){return function(){this.style.removeProperty(e)}}function dWn(e,t,n){return function(){this.style.setProperty(e,t,n)}}function pWn(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function gWn(e,t,n){return arguments.length>1?this.each((t==null?hWn:typeof t=="function"?pWn:dWn)(e,t,n==null?"":n)):_Ke(this.node(),e)}function _Ke(e,t){return e.style.getPropertyValue(t)||Vhe(e).getComputedStyle(e,null).getPropertyValue(t)}function mWn(e){return function(){delete this[e]}}function vWn(e,t){return function(){this[e]=t}}function yWn(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function bWn(e,t){return arguments.length>1?this.each((t==null?mWn:typeof t=="function"?yWn:vWn)(e,t)):this.node()[e]}function SKe(e){return e.trim().split(/^|\s+/)}function jhe(e){return e.classList||new kKe(e)}function kKe(e){this._node=e,this._names=SKe(e.getAttribute("class")||"")}kKe.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function EKe(e,t){for(var n=jhe(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function AKe(e,t){for(var n=jhe(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function xWn(e){return function(){EKe(this,e)}}function wWn(e){return function(){AKe(this,e)}}function $Wn(e,t){return function(){(t.apply(this,arguments)?EKe:AKe)(this,e)}}function CWn(e,t){var n=SKe(e+"");if(arguments.length<2){for(var r=jhe(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?$Wn:t?xWn:wWn)(n,t))}function _Wn(){this.textContent=""}function SWn(e){return function(){this.textContent=e}}function kWn(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function EWn(e){return arguments.length?this.each(e==null?_Wn:(typeof e=="function"?kWn:SWn)(e)):this.node().textContent}function AWn(){this.innerHTML=""}function TWn(e){return function(){this.innerHTML=e}}function DWn(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function IWn(e){return arguments.length?this.each(e==null?AWn:(typeof e=="function"?DWn:TWn)(e)):this.node().innerHTML}function NWn(){this.nextSibling&&this.parentNode.appendChild(this)}function MWn(){return this.each(NWn)}function FWn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function OWn(){return this.each(FWn)}function RWn(e){var t=typeof e=="function"?e:bV(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function PWn(){return null}function LWn(e,t){var n=typeof e=="function"?e:bV(e),r=t==null?PWn:typeof t=="function"?t:Whe(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function BWn(){var e=this.parentNode;e&&e.removeChild(this)}function zWn(){return this.each(BWn)}function UWn(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function WWn(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}function VWn(e){return this.select(e?WWn:UWn)}function jWn(e){return arguments.length?this.property("__data__",e):this.node().__data__}var TKe={},mp=null;if(typeof document<"u"){var HWn=document.documentElement;"onmouseenter"in HWn||(TKe={mouseenter:"mouseover",mouseleave:"mouseout"})}function qWn(e,t,n){return e=DKe(e,t,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&e.call(this,r)}}function DKe(e,t,n){return function(r){var i=mp;mp=r;try{e.call(this,this.__data__,t,n)}finally{mp=i}}}function GWn(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function YWn(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.capture):t[++r]=s;++r?t.length=r:delete this.__on}}}function XWn(e,t,n){var r=TKe.hasOwnProperty(e.type)?qWn:DKe;return function(i,s,a){var o=this.__on,l,u=r(t,s,a);if(o){for(var c=0,f=o.length;c<f;++c)if((l=o[c]).type===e.type&&l.name===e.name){this.removeEventListener(l.type,l.listener,l.capture),this.addEventListener(l.type,l.listener=u,l.capture=n),l.value=t;return}}this.addEventListener(e.type,u,n),l={type:e.type,name:e.name,value:t,listener:u,capture:n},o?o.push(l):this.__on=[l]}}function KWn(e,t,n){var r=GWn(e+""),i,s=r.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,u=o.length,c;l<u;++l)for(i=0,c=o[l];i<s;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(o=t?XWn:YWn,n==null&&(n=!1),i=0;i<s;++i)this.each(o(r[i],t,n));return this}function ZWn(e,t,n,r){var i=mp;e.sourceEvent=mp,mp=e;try{return t.apply(n,r)}finally{mp=i}}function IKe(e,t,n){var r=Vhe(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function QWn(e,t){return function(){return IKe(this,e,t)}}function JWn(e,t){return function(){return IKe(this,e,t.apply(this,arguments))}}function eVn(e,t){return this.each((typeof t=="function"?JWn:QWn)(e,t))}var Hhe=[null];function $o(e,t){this._groups=e,this._parents=t}function NKe(){return new $o([[document.documentElement]],Hhe)}$o.prototype=NKe.prototype={constructor:$o,select:LUn,selectAll:zUn,filter:WUn,data:GUn,enter:VUn,exit:YUn,merge:XUn,order:KUn,sort:ZUn,call:JUn,nodes:eWn,node:tWn,size:nWn,empty:rWn,each:iWn,attr:fWn,style:gWn,property:bWn,classed:CWn,text:EWn,html:IWn,raise:MWn,lower:OWn,append:RWn,insert:LWn,remove:zWn,clone:VWn,datum:jWn,on:KWn,dispatch:eVn};function MKe(e){return typeof e=="string"?new $o([[document.querySelector(e)]],[document.documentElement]):new $o([[e]],Hhe)}function tVn(e){return MKe(bV(e).call(document.documentElement))}var nVn=0;function FKe(){return new aee}function aee(){this._="@"+(++nVn).toString(36)}aee.prototype=FKe.prototype={constructor:aee,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function qhe(){for(var e=mp,t;t=e.sourceEvent;)e=t;return e}function xV(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}function rVn(e){var t=qhe();return t.changedTouches&&(t=t.changedTouches[0]),xV(e,t)}function iVn(e){return typeof e=="string"?new $o([document.querySelectorAll(e)],[document.documentElement]):new $o([e==null?[]:e],Hhe)}function sVn(e,t,n){arguments.length<3&&(n=t,t=qhe().changedTouches);for(var r=0,i=t?t.length:0,s;r<i;++r)if((s=t[r]).identifier===n)return xV(e,s);return null}function aVn(e,t){t==null&&(t=qhe().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=xV(e,t[n]);return i}const oVn=Object.freeze(Object.defineProperty({__proto__:null,create:tVn,creator:bV,local:FKe,matcher:$Ke,mouse:rVn,namespace:Uhe,namespaces:see,clientPoint:xV,select:MKe,selectAll:iVn,selection:NKe,selector:Whe,selectorAll:xKe,style:_Ke,touch:sVn,touches:aVn,window:Vhe,get event(){return mp},customEvent:ZWn},Symbol.toStringTag,{value:"Module"})),lVn=Fb(oVn);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(NS,"__esModule",{value:!0});const uVn=bKe,DSe=lVn,WG=De,cVn=To;function fVn(e,t,n={}){if(t&&t.headers==null)throw new Error('Data to render must have a "headers" property');if(t&&t.values==null)throw new Error('Data to render must have a "values" property');const r=cVn.getDrawArea(e),i=Object.assign({},hVn,n);let s=DSe.select(r).select("table.tf-table");const a=WG.css({fontSize:i.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(s.size()===0&&(s=DSe.select(r).append("table"),s.attr("class",` ${a} tf-table`),s.append("thead").append("tr"),s.append("tbody")),s.size()!==1)throw new Error("Error inserting table");const o=WG.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),l=s.select("thead").select("tr").selectAll("th").data(t.headers),u=l.enter().append("th").attr("class",`${o}`);l.merge(u).html(m=>m),l.exit().remove();const c=uVn.format(",.4~f"),f=s.select("tbody").selectAll("tr").data(t.values),h=f.enter().append("tr"),d=WG.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),p=f.merge(h).selectAll("td").data(m=>m),g=p.enter().append("td").attr("class",`${d}`);p.merge(g).html(m=>typeof m=="number"?c(m):m),p.exit().remove(),f.exit().remove()}NS.table=fVn;const hVn={fontSize:14};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var dVn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})},pVn=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(NF,"__esModule",{value:!0});const ISe=bKe,gVn=pVn(TS),VR=Zu,mVn=Ed,vVn=NS,yVn={maxBins:12,fontSize:11};function bVn(e,t,n={}){return dVn(this,void 0,void 0,function*(){const r=wVn(t),i=Object.assign({},yVn,n),s={actions:!1,mode:"vega-lite",defaultStyle:!1},a=VR.subSurface(e,"histogram");if(n.stats!==!1){const u=VR.subSurface(e,"stats",{prepend:!0});let c;n.stats?c=n.stats:c=mVn.arrayStats(r.map(f=>f.value)),xVn(c,u,{fontSize:i.fontSize})}if(r.length===0)return;const o=[];for(let u=0;u<r.length;u++){const c=r[u].value;c!=null&&isFinite(c)&&o.push(r[u])}const l={width:i.width||VR.getDefaultWidth(a),height:i.height||VR.getDefaultHeight(a),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:o},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return gVn.default(a,l,s)})}NF.histogram=bVn;function xVn(e,t,n){const r=ISe.format(",.4~f"),i=ISe.format(".4~p"),s=[],a=[];if(e.numVals!=null&&(s.push("Num Vals"),a.push(r(e.numVals))),e.min!=null&&(s.push("Min"),a.push(r(e.min))),e.max!=null&&(s.push("Max"),a.push(r(e.max))),e.numZeros!=null){s.push("# Zeros");let o="";e.numVals&&(o=e.numZeros>0?`(${i(e.numZeros/e.numVals)})`:""),a.push(`${r(e.numZeros)} ${o}`)}if(e.numNans!=null){s.push("# NaNs");let o="";e.numVals&&(o=e.numNans>0?`(${i(e.numNans/e.numVals)})`:""),a.push(`${r(e.numNans)} ${o}`)}if(e.numInfs!=null){s.push("# Infinity");let o="";e.numVals&&(o=e.numInfs>0?`(${i(e.numInfs/e.numVals)})`:""),a.push(`${r(e.numInfs)} ${o}`)}vVn.table(t,{headers:s,values:[a]},n)}function wVn(e){if(e.length==null)throw new Error("input data must be an array");if(e.length===0)return[];if(typeof e[0]=="object"){if(e[0].value==null)throw new Error("input data must have a value field");return e}else{const t=Array(e.length);for(let n=0;n<e.length;n++)t[n]={value:e[n]};return t}}var wV={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var $Vn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})},CVn=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(wV,"__esModule",{value:!0});const _Vn=CVn(TS),NSe=Zu,MSe=Cg,SVn=To;function kVn(e,t,n={}){return $Vn(this,void 0,void 0,function*(){const r=Array.isArray(t.values[0])?t.values:[t.values],i=r[0].length,s=t.series?t.series:r.map((g,m)=>`Series ${m+1}`);MSe.assert(s.length===r.length,"Must have an equal number of series labels as there are data series"),n.seriesColors!=null&&MSe.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const a=[];for(let g=0;g<i;g++){const m={x:g};s.forEach((v,y)=>{const b=r[y][g].y;m[v]=b,m[`${v}-name`]=v}),a.push(m)}const o=Object.assign({},EVn,n),l=()=>{if(o.zoomToFit)return{zero:!1};if(o.yAxisDomain!=null)return{domain:o.yAxisDomain}},u={x:{field:"x",type:o.xType,title:o.xLabel},tooltip:[{field:"x",type:"quantitative"},...s.map(g=>({field:g,type:"quantitative"}))]},c=s.map(g=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:g,type:o.yType,title:o.yLabel,scale:l()},color:{field:`${g}-name`,type:"nominal",legend:{values:s,title:null},scale:{range:o.seriesColors}}}})),f={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},h=SVn.getDrawArea(e),d={width:o.width||NSe.getDefaultWidth(h),height:o.height||NSe.getDefaultHeight(h),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize}},data:{values:a},encoding:u,layer:[...c,f]},p={actions:!1,mode:"vega-lite",defaultStyle:!1};return yield _Vn.default(h,d,p),Promise.resolve()})}wV.linechart=kVn;const EVn={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var Ghe={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var AVn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})},TVn=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ghe,"__esModule",{value:!0});const DVn=TVn(TS),FSe=Zu,IVn=Cg,NVn=To;function MVn(e,t,n={}){return AVn(this,void 0,void 0,function*(){let r=t.values;const i=t.series==null?[]:t.series;r=Array.isArray(r[0])?r:[r];const s=[];r.forEach((h,d)=>{const p=i[d]!=null?i[d]:`Series ${d+1}`,g=h.map(m=>Object.assign({},m,{series:p}));s.push(...g)}),n.seriesColors!=null&&IVn.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const a=NVn.getDrawArea(e),o=Object.assign({},FVn,n),l={actions:!1,mode:"vega-lite",defaultStyle:!1},u=()=>{if(o.zoomToFit)return{zero:!1};if(o.xAxisDomain!=null)return{domain:o.xAxisDomain}},c=()=>{if(o.zoomToFit)return{zero:!1};if(o.yAxisDomain!=null)return{domain:o.yAxisDomain}},f={width:o.width||FSe.getDefaultWidth(a),height:o.height||FSe.getDefaultHeight(a),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize}},data:{values:s},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:o.xType,title:o.xLabel,scale:u()},y:{field:"y",type:o.yType,title:o.yLabel,scale:c()},color:{field:"series",type:"nominal",scale:{range:o.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield DVn.default(a,f,l),Promise.resolve()})}Ghe.scatterplot=MVn;const FVn={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var $V={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var OKe=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty($V,"__esModule",{value:!0});const OVn=wV,oee=To,RKe=Zu;function PKe(e,t,n,r={}){return OKe(this,void 0,void 0,function*(){const i=oee.getDrawArea(e),s={};for(const u of n)if(/val_/.test(u)){const c=u.replace("val_","");OSe(s,c);const f=RSe(t,u,n.indexOf(u));s[c].series.push(u),s[c].values.push(f)}else{const c=RSe(t,u,n.indexOf(u));OSe(s,u),s[u].series.push(u),s[u].values.push(c)}const a=Object.keys(s),o=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},r),l=[];for(const u of a){const c=RKe.subSurface(i,u),f=s[u].series,h=s[u].values;f.every(p=>Boolean(p.match("acc")))&&(o.zoomToFitAccuracy?o.zoomToFit=!0:(o.yAxisDomain=[0,1],delete o.zoomToFit));const d=OVn.linechart(c,{values:h,series:f},o);l.push(d)}yield Promise.all(l)})}$V.history=PKe;function OSe(e,t){e[t]==null&&(e[t]={series:[],values:[]})}function RSe(e,t,n){if(Array.isArray(e)){const r=Array.isArray(e[0])?e[n]:e,i=[];for(let s=0;s<r.length;s++){const a=r[s];i.push({x:s,y:a[t]})}return i}else return e.history[t].map((r,i)=>({x:i,y:r}))}function RVn(e,t,n={}){const r={},i=n.callbacks||["onEpochEnd","onBatchEnd"],s=oee.getDrawArea(e),a=Object.assign({},n);delete a.callbacks;function o(u){return(c,f)=>OKe(this,void 0,void 0,function*(){/batch/i.test(u)?a.xLabel="Batch":/epoch/i.test(u)&&(a.xLabel="Epoch");const h=[],d=[];for(const g of t)if(f[g]!=null){d.push(g);const m=PVn(r,u,g);m.push({[g]:f[g]}),h.push(m)}const p=RKe.subSurface(s,u,{title:u});PKe(p,h,d,a),yield oee.nextFrame()})}const l={};return i.forEach(u=>{l[u]=o(u)}),l}$V.fitCallbacks=RVn;function PVn(e,t,n){return e[t]==null&&(e[t]={}),e[t][n]==null&&(e[t][n]=[]),e[t][n]}var CV={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var qB=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(CV,"__esModule",{value:!0});const LVn=NF,LKe=To,BKe=NS,VG=Zu,BVn=Ed;function zVn(e,t){return qB(this,void 0,void 0,function*(){const n=LKe.getDrawArea(e),r=WVn(t),i=["Layer Name","Output Shape","# Of Params","Trainable"],s=r.layers.map(a=>[a.name,a.outputShape,a.parameters,a.trainable]);BKe.table(n,{headers:i,values:s})})}CV.modelSummary=zVn;function UVn(e,t){return qB(this,void 0,void 0,function*(){const n=LKe.getDrawArea(e),r=yield jVn(t),i=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],s=VG.subSurface(n,"layer-weights-info"),a=r.map(c=>[c.name,c.shape,c.stats.min,c.stats.max,c.weight.size,c.stats.numZeros,c.stats.numNans,c.stats.numInfs]);BKe.table(s,{headers:i,values:a});const o=VG.subSurface(n,"select-layer"),l=VG.subSurface(n,"param-distribution"),u=c=>qB(this,void 0,void 0,function*(){const h=yield r.filter(d=>d.name===c)[0].weight.data();LVn.histogram(l,h,{height:150,width:460,stats:!1})});HVn(r.map(c=>c.name),o,u)})}CV.layer=UVn;function WVn(e){return{layers:e.layers.map(VVn)}}function VVn(e){let t;return Array.isArray(e.outputShape[0])?t=`[${e.outputShape.map(r=>lee(r)).join(", ")}]`:t=lee(e.outputShape),{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function jVn(e){return qB(this,void 0,void 0,function*(){const t=e.getWeights(),n=e.weights,r=t.map(BVn.tensorStats),i=yield Promise.all(r),s=t.map(a=>a.shape);return t.map((a,o)=>({name:n[o].name,stats:i[o],shape:lee(s[o]),weight:a}))})}function lee(e){const t=e.slice();return t.length===0?"Scalar":(t[0]===null&&(t[0]="batch"),`[${t.join(",")}]`)}function HVn(e,t,n){const s=`<div><button>Show Values Distribution for:</button>${`
    <select>
      ${e.map(l=>`<option value=${l}>${l}</option>`)}
    </select>
  `}</div>`;t.innerHTML=s;const a=t.querySelector("button"),o=t.querySelector("select");a.addEventListener("click",()=>{n(o.selectedOptions[0].label)})}var Yhe={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var qVn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(Yhe,"__esModule",{value:!0});const GVn=To,YVn=NS;function XVn(e,t,n){return qVn(this,void 0,void 0,function*(){const r=GVn.getDrawArea(e),i=["Class","Accuracy","# Samples"],s=[];for(let a=0;a<t.length;a++){const o=n?n[a]:a.toString(),l=t[a];s.push([o,l.accuracy,l.count])}return YVn.table(r,{headers:i,values:s})})}Yhe.perClassAccuracy=XVn;var Xhe={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var KVn=mt&&mt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(c){s(c)}}function o(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(a,o)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(Xhe,"__esModule",{value:!0});const ZVn=NF,QVn=To,JVn=Ed;function ejn(e,t){return KVn(this,void 0,void 0,function*(){const n=QVn.getDrawArea(e),r=yield JVn.tensorStats(t),i=yield t.data();ZVn.histogram(n,i,{height:150,stats:r})})}Xhe.valuesDistribution=ejn;var Khe={};/** @license See the LICENSE file. */Object.defineProperty(Khe,"__esModule",{value:!0});const tjn="1.5.1";Khe.version=tjn;(function(e){function t(b){for(var x in b)e.hasOwnProperty(x)||(e[x]=b[x])}Object.defineProperty(e,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n=ore,r=Lhe,i=Bhe,s=NF,a=wV,o=Ghe,l=NS,u=$V,c=CV,f=Yhe,h=Xhe,d=Ed,p=Khe;e.version_vis=p.version;const g={barchart:n.barchart,table:l.table,histogram:s.histogram,linechart:a.linechart,scatterplot:o.scatterplot,confusionMatrix:r.confusionMatrix,heatmap:i.heatmap};e.render=g;const m={accuracy:d.accuracy,perClassAccuracy:d.perClassAccuracy,confusionMatrix:d.confusionMatrix};e.metrics=m;const v={history:u.history,fitCallbacks:u.fitCallbacks,perClassAccuracy:f.perClassAccuracy,valuesDistribution:h.valuesDistribution,layer:c.layer,modelSummary:c.modelSummary};e.show=v;var y=IF;e.visor=y.visor,t(DF)})(dFe);var njn=Object.defineProperty,rjn=Object.getOwnPropertyDescriptor,Zhe=(e,t,n,r)=>{for(var i=r>1?void 0:r?rjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&njn(t,n,i),i};let GD=class extends St{buildPlots(){if(this.dataSet&&this.inputKey){const e=document.createElement("div");e.setAttribute("id","plots");const t=this.dataSet.label,n=this.dataSet.inputs.findIndex(a=>a.key==this.inputKey),r=this.dataSet.data.map(a=>({x:a.inputs[n],y:a.label})),i=["Data set"],s=e.appendChild(document.createElement("div"));return dFe.render.scatterplot({drawArea:s},{values:r,series:i},{xLabel:this.inputKey,yLabel:t.key,width:350,height:240}),de`${e}`}else return de`Click on an input pill above to see the relation between this
      input and the output in a plot`}render(){return de`
      <c-card>
        <div slot="title">Plots</div>
        <div slot="content">${this.buildPlots()}</div>
      </c-card>
    `}};GD.styles=[kt,Qt`
      #plots {
        display: flex;
        flex-direction: row;
        gap: 10px;
        overflow-x: auto;
      }
    `];Zhe([J()],GD.prototype,"dataSet",2);Zhe([J()],GD.prototype,"inputKey",2);GD=Zhe([Ue("plots-card")],GD);var ijn=Object.defineProperty,sjn=Object.getOwnPropertyDescriptor,Qhe=(e,t,n,r)=>{for(var i=r>1?void 0:r?sjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&ijn(t,n,i),i};let YD=class extends St{async _handleChangeDataSet(){const e=await q2.getDataSetByName(decodeURI(this._dataSetSelect.value)),t=new CustomEvent("change-data-set",{detail:e,bubbles:!0,composed:!0});this.dispatchEvent(t)}render(){return de`
      <c-card>
        <div slot="title">Select data set</div>
        <div slot="content">
          <sl-select
            .value="${this.dataSet?encodeURI(this.dataSet.name):ri}"
            id="dataSetSelect"
            placeholder="Select a data set"
            @sl-change="${e=>{this._handleChangeDataSet()}}"
          >
            ${q2.getOptions().map(e=>de`<sl-option .value="${encodeURI(e)}"
                  >${e}</sl-option
                >`)}
          </sl-select>
          <sl-button disabled>Create your own data set</sl-button>
        </div>
      </c-card>
    `}};YD.styles=[kt];Qhe([J()],YD.prototype,"dataSet",2);Qhe([gt("#dataSetSelect")],YD.prototype,"_dataSetSelect",2);YD=Qhe([Ue("data-set-select-card")],YD);var ajn=Object.defineProperty,ojn=Object.getOwnPropertyDescriptor,Jhe=(e,t,n,r)=>{for(var i=r>1?void 0:r?ojn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&ajn(t,n,i),i};let XD=class extends St{updated(e){e.has("dataSet")&&(this.selectedInputKey=null)}_handleClickedDataProperty(e){this.selectedInputKey=e.detail}render(){return de`
      <c-panel name="dataSet">
        <data-set-select-card .dataSet="${this.dataSet}"></data-set-select-card>
        ${this.dataSet?de`
              <data-set-info-card
                .dataSet="${this.dataSet}"
                @clicked-data-property="${e=>{this._handleClickedDataProperty(e)}}"
              ></data-set-info-card>
            `:""}
        <plots-card
          .dataSet="${this.dataSet}"
          .inputKey="${this.selectedInputKey}"
        ></plots-card>
      </c-panel>
    `}};XD.styles=[kt];Jhe([J({attribute:!0,reflect:!0})],XD.prototype,"selectedInputKey",2);Jhe([En({context:Rm,subscribe:!0}),J({attribute:!1})],XD.prototype,"dataSet",2);XD=Jhe([Ue("data-set-panel")],XD);var ljn=Object.defineProperty,ujn=Object.getOwnPropertyDescriptor,zKe=(e,t,n,r)=>{for(var i=r>1?void 0:r?ujn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&ljn(t,n,i),i};let GB=class extends St{_handleTrainStep(){this.model.train()}render(){return de`
      <c-card>
        <div slot="title">Train</div>
        <div slot="content">
          <div>
            <sl-tooltip content="Reset training progress">
              <sl-button size="large" circle>
                <sl-icon name="arrow-counterclockwise" label="Reset"></sl-icon>
              </sl-button>
            </sl-tooltip>
            <sl-tooltip content="Start training">
              <sl-button
                variant="primary"
                size="large"
                circle
                @click="${e=>this._handleTrainStep()}"
              >
                <sl-icon name="play" label="Run"></sl-icon>
              </sl-button>
            </sl-tooltip>
            <sl-tooltip content="Train a single batch">
              <sl-button size="large" circle>
                <sl-icon name="fast-forward" label="Next"></sl-icon>
              </sl-button>
            </sl-tooltip>
            <sl-tooltip content="Train a single epoch">
              <sl-button size="large" circle>
                <sl-icon name="fast-forward" label="Next"></sl-icon>
              </sl-button>
            </sl-tooltip>
          </div>
        </div>
      </c-card>
    `}};GB.styles=[kt];zKe([En({context:Hee,subscribe:!0})],GB.prototype,"model",2);GB=zKe([Ue("training-train-card")],GB);var cjn=Object.defineProperty,fjn=Object.getOwnPropertyDescriptor,ede=(e,t,n,r)=>{for(var i=r>1?void 0:r?fjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&cjn(t,n,i),i};let KD=class extends St{_handleChangeLearningRate(){console.log(this._learningRateRange.value)}_handleChangeDropoutRate(){console.log(this._dropoutRateRange.value)}render(){return de`
      <c-card>
        <div slot="title">Hyperparameters</div>
        <div slot="content">
          <sl-range
            id="learningRateRange"
            label="learning rate"
            help-text="Adjust the speed at which the network learns"
            min="0"
            max="1"
            step="0.01"
            @sl-change="${e=>this._handleChangeLearningRate()}"
          >
          </sl-range>
          <sl-range
            id="dropoutRateRange"
            label="dropout rate"
            help-text="Adjust the probability of neurons being deactivated during training"
            min="0"
            max="1"
            step="0.01"
            @sl-change="${e=>this._handleChangeDropoutRate()}"
          >
          </sl-range>
        </div>
      </c-card>
    `}};KD.styles=[kt];ede([gt("#learningRateRange")],KD.prototype,"_learningRateRange",2);ede([gt("#dropoutRateRange")],KD.prototype,"_dropoutRateRange",2);KD=ede([Ue("training-hyperparameters-card")],KD);var hjn=Object.defineProperty,djn=Object.getOwnPropertyDescriptor,pjn=(e,t,n,r)=>{for(var i=r>1?void 0:r?djn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&hjn(t,n,i),i};let uee=class extends St{render(){return de`
      <c-panel name="train">
        <training-train-card></training-train-card>
        <training-hyperparameters-card></training-hyperparameters-card>
      </c-panel>
    `}};uee.styles=[kt];uee=pjn([Ue("train-panel")],uee);function UKe(e){const t=new FormData(e),n={};return t.forEach((r,i)=>{if(Reflect.has(n,i)){const s=n[i];Array.isArray(s)?s.push(r):n[i]=[n[i],r]}else n[i]=r}),n}var gjn=Object.defineProperty,mjn=Object.getOwnPropertyDescriptor,_V=(e,t,n,r)=>{for(var i=r>1?void 0:r?mjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&gjn(t,n,i),i};let aC=class extends St{async connectedCallback(){super.connectedCallback(),await this.updateComplete,this._predictForm.addEventListener("submit",e=>this._handlePredict(e))}_handlePredict(e){e.preventDefault();const t=UKe(this._predictForm);console.log(t),this._predictForm.reset()}getInputFieldsForLayer(e){return console.log("input fields"),console.log(this.dataSet.getAssignedInputsFor(e)),this.dataSet.getAssignedInputsFor(e).map(n=>de`
        <sl-tooltip content=${n.description}>
          <sl-input
            name="${n.key}"
            placeholder="${n.key}"
            type="number"
            required
          ></sl-input>
        </sl-tooltip>
      `)}getInputFields(){return this.networkConf.network.getInputLayers().map(t=>de`
        ${t.getName()} ${this.getInputFieldsForLayer(t)}
      `)}render(){return de`
      <c-card>
        <div slot="title">Predict</div>
        <form slot="content" id="predictForm">
          ${this.getInputFields()}
          <sl-button variant="primary" type="submit">
            Predict
            <sl-icon slot="suffix" name="send"></sl-icon>
          </sl-button>
        </form>
      </c-card>
    `}};aC.styles=[kt];_V([En({context:Qp,subscribe:!0})],aC.prototype,"networkConf",2);_V([En({context:Rm,subscribe:!0})],aC.prototype,"dataSet",2);_V([gt("#predictForm")],aC.prototype,"_predictForm",2);aC=_V([Ue("predict-card")],aC);var vjn=Object.defineProperty,yjn=Object.getOwnPropertyDescriptor,bjn=(e,t,n,r)=>{for(var i=r>1?void 0:r?yjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&vjn(t,n,i),i};let cee=class extends St{render(){return de`
      <c-panel name="predict">
        <predict-card></predict-card>
      </c-panel>
    `}};cee.styles=[kt];cee=bjn([Ue("predict-panel")],cee);var xjn=Object.defineProperty,wjn=Object.getOwnPropertyDescriptor,WKe=(e,t,n,r)=>{for(var i=r>1?void 0:r?wjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&xjn(t,n,i),i};let YB=class extends St{render(){return de`
      <c-card>
        <div slot="title">Info</div>
        <div slot="content">
          <span>
            Selected:
            <c-network-link .target="${this.layer}">
              ${this.layer.getName()}
            </c-network-link>
          </span>
          <span> ${this.layer.getDescription()} </span>
        </div>
      </c-card>
    `}};YB.styles=[kt];WKe([J()],YB.prototype,"layer",2);YB=WKe([Ue("layer-info-card")],YB);var $jn=Object.defineProperty,Cjn=Object.getOwnPropertyDescriptor,MS=(e,t,n,r)=>{for(var i=r>1?void 0:r?Cjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&$jn(t,n,i),i};let Nm=class extends St{async connectedCallback(){super.connectedCallback(),await this.updateComplete,this._updateNeuronsForm&&this._updateNeuronsForm.addEventListener("submit",e=>{this._handleSetNeurons(e)})}_handleRemoveNeuron(){this.layer instanceof Lc&&this.layer.removeNeuron()}_handleAddNeuron(){this.layer instanceof Lc&&this.layer.addNeuron()}_handleSetNeurons(e){e.preventDefault();const t=UKe(this._updateNeuronsForm);if(typeof t.units!="string")throw new Error("The number of neurons in the form should be of type string.");const n=parseInt(t.units);this.layer instanceof R0&&this.layer.setNeurons(n),this._updateNeuronsForm.reset()}_handleDuplicateLayer(){this.networkConf.network.duplicateLayer(this.layer)}_handleDeleteLayer(){this.networkConf.network.removeLayer(this.layer),ja({message:`'${this.layer.getName()}' has been deleted!`,variant:"danger",icon:"trash"})}render(){return de`
      <c-card>
        <div slot="title">Edit layer</div>
        <div slot="content">
          ${this.layer instanceof Us||this.layer instanceof Qo?de``:de`<div>
                  <h2>Neurons</h2>
                  <c-button-group>
                    <sl-button
                      .disabled=${this.layer instanceof Lc&&this.layer.neurons.length<=1}
                      @click="${e=>this._handleRemoveNeuron()}"
                    >
                      <sl-icon slot="prefix" name="dash-square"></sl-icon>
                      Remove
                    </sl-button>
                    <sl-button
                      @click="${e=>this._handleAddNeuron()}"
                    >
                      <sl-icon slot="prefix" name="plus-square"></sl-icon>
                      Add
                    </sl-button>
                  </c-button-group>
                </div>
                <form id="updateNeuronsForm">
                  <c-button-group>
                    <sl-input
                      name="units"
                      placeholder="neurons"
                      type="number"
                      required
                    ></sl-input>
                    <sl-button type="submit">
                      <sl-icon slot="prefix" name="arrow-clockwise"></sl-icon>
                      Update
                    </sl-button>
                  </c-button-group>
                </form>`}
          <h2>Layer</h2>
          <c-button-group>
            ${this.layer instanceof Us||this.layer instanceof Qo?de``:de` <sl-button
                  @click="${e=>this._handleDuplicateLayer()}"
                >
                  <sl-icon slot="prefix" name="files"></sl-icon>
                  Duplicate
                </sl-button>`}
            <sl-button
              @click="${e=>this._handleDeleteLayer()}"
            >
              <sl-icon slot="prefix" name="trash"></sl-icon>
              Delete
            </sl-button>
          </c-button-group>
        </div>
      </c-card>
    `}};Nm.styles=[kt];MS([J()],Nm.prototype,"layer",2);MS([En({context:Qp,subscribe:!0})],Nm.prototype,"networkConf",2);MS([gt("#inputSelect")],Nm.prototype,"_inputSelect",2);MS([gt("#outputSelect")],Nm.prototype,"_outputSelect",2);MS([gt("#updateNeuronsForm")],Nm.prototype,"_updateNeuronsForm",2);Nm=MS([Ue("layer-edit-card")],Nm);const _jn=["None","ReLu","Sigmoid","Softmax"],SV=new Map;SV.set("None",null);SV.set("ReLu","relu");SV.set("Sigmoid","sigmoid");SV.set("Softmax","softmax");var Sjn=Object.defineProperty,kjn=Object.getOwnPropertyDescriptor,tde=(e,t,n,r)=>{for(var i=r>1?void 0:r?kjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Sjn(t,n,i),i};let ZD=class extends St{_handleChangeActivation(){this.layer.setActivation(this._selectActivationFormElm.value)}render(){return de`
      <c-card>
        <div slot="title">Activation function</div>
        <div slot="content">
          <sl-select
            .value="${this.layer.activation}"
            help-text="The selected activation will be applied to all neurons in this layer."
            @sl-change="${e=>{this._handleChangeActivation()}}"
          >
            ${_jn.map(e=>de`<sl-option .value="${e}">${e}</sl-option>`)}
          </sl-select>
        </div>
      </c-card>
    `}};ZD.styles=[kt];tde([J()],ZD.prototype,"layer",2);tde([gt("sl-select")],ZD.prototype,"_selectActivationFormElm",2);ZD=tde([Ue("layer-activation-card")],ZD);var Ejn=Object.defineProperty,Ajn=Object.getOwnPropertyDescriptor,kV=(e,t,n,r)=>{for(var i=r>1?void 0:r?Ajn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Ejn(t,n,i),i};let oC=class extends St{_handleChangeConnections(){const e=Array.from(this.networkConf.layerConnections.keys()).filter(([i,s])=>s==this.layer.layerId).map(([i,s])=>i),t=this._connectionSelect.value.map(i=>parseInt(i)),n=t.filter(i=>!e.includes(i));for(const i of n){const s=this.networkConf.network.getLayerById(i);this.networkConf.network.addLayerConnection(s,this.layer)}const r=e.filter(i=>!t.includes(i));for(const i of r){const s=this.networkConf.network.getLayerById(i);this.networkConf.network.removeLayerConnection(s,this.layer)}}_getConnectionOptions(){return Array.from(this.networkConf.layers.values()).filter(t=>t!=this.layer&&!(t instanceof Qo)).map(t=>de`<sl-option value="${t.layerId.toString()}"
          >${t.getName()}</sl-option
        >`)}render(){return de`
      <c-card>
        <div slot="title">Incoming connections</div>
        <div slot="content">
          <sl-select
            id="connectionSelect"
            value=${Array.from(this.networkConf.layerConnections.keys()).filter(([e,t])=>{t==this.layer.layerId}).map(([e,t])=>e).join(" ")}
            multiple
            clearable
            help-text="Select the layers that connect to this layer"
            @sl-change="${e=>this._handleChangeConnections()}"
          >
            ${this._getConnectionOptions()}
          </sl-select>
        </div>
      </c-card>
    `}};oC.styles=[kt];kV([J()],oC.prototype,"layer",2);kV([En({context:Qp,subscribe:!0})],oC.prototype,"networkConf",2);kV([gt("#connectionSelect")],oC.prototype,"_connectionSelect",2);oC=kV([Ue("layer-incoming-connections-card")],oC);var Tjn=Object.defineProperty,Djn=Object.getOwnPropertyDescriptor,EV=(e,t,n,r)=>{for(var i=r>1?void 0:r?Djn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Tjn(t,n,i),i};let lC=class extends St{_handleChangeInputData(){const e=this._inputDataSelect.value;this.layer.dataSetKeys=e}getInputOptions(){const e=this.layer.getAssignedInputs().map(n=>de`
        <sl-option value="${n}">
          <sl-tooltip content="${this.dataSet.getInputByKey(n).description}"
            >${n}</sl-tooltip
          >
        </sl-option>
      `);console.log(e);const t=this.dataSet.getNonAssignedInputKeys().map(n=>de`
        <sl-option .value="${n}">
          <sl-tooltip content="${this.dataSet.getInputByKey(n).description}"
            >${n}</sl-tooltip
          >
        </sl-option>
      `);return console.log(t),de`${e} ${t}`}render(){return de`
      <c-card>
        <div slot="title">Incoming data</div>
        <div slot="content">
          <sl-select
            id="inputDataSelect"
            value=${this.layer.getAssignedInputs().join(" ")}
            multiple
            max-options-visible="100"
            help-text="Assign input data to this layer"
            @sl-change="${e=>{this._handleChangeInputData()}}"
          >
            ${this.getInputOptions()}
          </sl-select>
        </div>
      </c-card>
    `}};lC.styles=[kt];EV([J()],lC.prototype,"layer",2);EV([J()],lC.prototype,"dataSet",2);EV([gt("#inputDataSelect")],lC.prototype,"_inputDataSelect",2);lC=EV([Ue("layer-incoming-data-card")],lC);var Ijn=Object.defineProperty,Njn=Object.getOwnPropertyDescriptor,AV=(e,t,n,r)=>{for(var i=r>1?void 0:r?Njn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Ijn(t,n,i),i};let uC=class extends St{_handleChangeConnections(){const e=Array.from(this.networkConf.layerConnections.keys()).filter(([i,s])=>i==this.layer.layerId).map(([i,s])=>s),t=this._connectionSelect.value.map(i=>parseInt(i)),n=t.filter(i=>!e.includes(i));for(const i of n){const s=this.networkConf.network.getLayerById(i);this.networkConf.network.addLayerConnection(this.layer,s)}const r=e.filter(i=>!t.includes(i));for(const i of r){const s=this.networkConf.network.getLayerById(i);this.networkConf.network.removeLayerConnection(this.layer,s)}}_getConnectionOptions(){return Array.from(this.networkConf.layers.values()).filter(t=>t!=this.layer&&!(t instanceof Us)).map(t=>de`<sl-option value="${t.layerId.toString()}"
          >${t.getName()}</sl-option
        >`)}render(){return de`
      <c-card>
        <div slot="title">Outgoing connections</div>
        <div slot="content">
          <sl-select
            id="connectionSelect"
            value=${Array.from(this.networkConf.layerConnections.keys()).filter(([e,t])=>{e==this.layer.layerId}).map(([e,t])=>t).join(" ")}
            multiple
            clearable
            help-text="Select the layers that connect to this layer"
            @sl-change="${e=>this._handleChangeConnections()}"
          >
            ${this._getConnectionOptions()}
          </sl-select>
        </div>
      </c-card>
    `}};uC.styles=[kt];AV([J()],uC.prototype,"layer",2);AV([En({context:Qp,subscribe:!0})],uC.prototype,"networkConf",2);AV([gt("#connectionSelect")],uC.prototype,"_connectionSelect",2);uC=AV([Ue("layer-outgoing-connections-card")],uC);var Mjn=Object.defineProperty,Fjn=Object.getOwnPropertyDescriptor,VKe=(e,t,n,r)=>{for(var i=r>1?void 0:r?Fjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Mjn(t,n,i),i};let XB=class extends St{render(){return de`
      <c-card>
        <div slot="title">Outgoing data</div>
        <div slot="content">
          ${this.layer.dataSetLabel.key?de`
                <c-data-info
                  .dataProperty="${this.layer.dataSetLabel}"
                ></c-data-info>
              `:de``}
        </div>
      </c-card>
    `}};XB.styles=[kt];VKe([J()],XB.prototype,"layer",2);XB=VKe([Ue("layer-outgoing-data-card")],XB);var Ojn=Object.defineProperty,Rjn=Object.getOwnPropertyDescriptor,nde=(e,t,n,r)=>{for(var i=r>1?void 0:r?Rjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Ojn(t,n,i),i};let QD=class extends St{getCards(){if(!this.selected.layer)return de``;const e=this.selected.layer;if(e instanceof Us)return de`
        <layer-info-card .layer=${e}></layer-info-card>
        <layer-edit-card
          .layer=${e}
          .dataSet=${this.dataSet}
        ></layer-edit-card>
        <layer-incoming-data-card
          .layer=${e}
          .dataSet=${this.dataSet}
        ></layer-incoming-data-card>
        <layer-outgoing-connections-card
          .layer=${e}
        ></layer-outgoing-connections-card>
      `;if(e instanceof R0)return de`
        <layer-info-card .layer=${e}></layer-info-card>
        <layer-edit-card .layer=${e}></layer-edit-card>
        <layer-incoming-connections-card
          .layer=${e}
        ></layer-incoming-connections-card>
        <layer-outgoing-connections-card
          .layer=${e}
        ></layer-outgoing-connections-card>
        <layer-activation-card .layer=${e}></layer-activation-card>
      `;if(e instanceof Qo)return de`
        <layer-info-card .layer=${e}></layer-info-card>
        <layer-edit-card
          .layer=${e}
          .dataSet=${this.dataSet}
        ></layer-edit-card>
        <layer-incoming-connections-card
          .layer=${e}
        ></layer-incoming-connections-card>
        <layer-outgoing-data-card .layer=${e}></layer-outgoing-data-card>
        <layer-activation-card .layer=${e}></layer-activation-card>
      `}render(){return de` <c-panel name="layer"> ${this.getCards()} </c-panel> `}};QD.styles=[kt];nde([En({context:Rm,subscribe:!0})],QD.prototype,"dataSet",2);nde([En({context:kC,subscribe:!0})],QD.prototype,"selected",2);QD=nde([Ue("layer-panel")],QD);var Pjn=Object.defineProperty,Ljn=Object.getOwnPropertyDescriptor,TV=(e,t,n,r)=>{for(var i=r>1?void 0:r?Ljn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Pjn(t,n,i),i};let cC=class extends St{render(){let e;return this.neuron.layer instanceof Us?e=this.dataSet.getByKey(this.neuron.label):this.neuron.layer instanceof Qo&&(e=this.neuron.layer.dataSetLabel),de`
      <c-card>
        <div slot="title">Info</div>
        <div slot="content">
          <div>
            <p>
              Selected item:
              <c-network-link .target="${this.neuron}"
                >Neuron ${this.neuron.neuronId}</c-network-link
              >
              inside
              <c-network-link .target="${this.layer}"
                >${this.neuron.layer.getName()}</c-network-link
              >
            </p>
            ${e?de`
                  <h2>Assigned data</h2>
                  <c-data-info .dataProperty="${e}"></c-data-info>
                `:de``}
          </div>
        </div>
      </c-card>
    `}};cC.styles=[kt];TV([J()],cC.prototype,"neuron",2);TV([J()],cC.prototype,"layer",2);TV([J()],cC.prototype,"dataSet",2);cC=TV([Ue("neuron-info-card")],cC);var Bjn=Object.defineProperty,zjn=Object.getOwnPropertyDescriptor,rde=(e,t,n,r)=>{for(var i=r>1?void 0:r?zjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Bjn(t,n,i),i};let JD=class extends St{getCards(){if(!this.selected.neuron&&!this.selected.layer)return de``;const e=this.selected.neuron,t=this.selected.layer;return de`
      <neuron-info-card
        .neuron=${e}
        .layer=${t}
        .dataSet=${this.dataSet}
      ></neuron-info-card>
      ${t instanceof Us&&e.label?de`
            <plots-card
              .dataSet=${this.dataSet}
              .inputKey=${e.label}
            ></plots-card>
          `:de``}
    `}render(){return de` <c-panel name="neuron"> ${this.getCards()} </c-panel> `}};JD.styles=[kt];rde([En({context:Rm,subscribe:!0})],JD.prototype,"dataSet",2);rde([En({context:kC,subscribe:!0})],JD.prototype,"selected",2);JD=rde([Ue("neuron-panel")],JD);var Ujn=Object.defineProperty,Wjn=Object.getOwnPropertyDescriptor,MF=(e,t,n,r)=>{for(var i=r>1?void 0:r?Wjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Ujn(t,n,i),i};let Nb=class extends St{render(){return de`
      <c-card>
        <div slot="title">Info</div>
        <div slot="content">
          <span>
            Selected: Edge connecting
            ${this.sourceNeuron!=null?de`
                  <c-network-link .target="${this.sourceNeuron}"
                    >Neuron ${this.sourceNeuron.neuronId}</c-network-link
                  >
                  inside
                `:de``}.id
            <c-network-link .target="${this.sourceLayer}"
              >${this.sourceLayer.getName()}</c-network-link
            >
            with
            ${this.targetNeuron!=null?de`
                  <c-network-link .target="${this.targetNeuron}"
                    >Neuron ${this.targetNeuron.neuronId}</c-network-link
                  >
                  inside
                `:de``}
            <c-network-link .target="${this.targetLayer}"
              >${this.targetLayer.getName()}</c-network-link
            >
          </span>
        </div>
      </c-card>
    `}};Nb.styles=[kt];MF([J()],Nb.prototype,"sourceLayer",2);MF([J()],Nb.prototype,"targetLayer",2);MF([J()],Nb.prototype,"sourceNeuron",2);MF([J()],Nb.prototype,"targetNeuron",2);Nb=MF([Ue("edge-info-card")],Nb);var Vjn=Object.defineProperty,jjn=Object.getOwnPropertyDescriptor,jKe=(e,t,n,r)=>{for(var i=r>1?void 0:r?jjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Vjn(t,n,i),i};let KB=class extends St{getCards(){return this.selected.edge?de`
      <edge-info-card
        .sourceLayer=${this.selected.edge.sourceLayer}
        .targetLayer=${this.selected.edge.targetLayer}
        .sourceNeuron=${this.selected.edge.sourceNeuron}
        .targetNeuron=${this.selected.edge.targetNeuron}
      >
      </edge-info-card>
    `:de``}render(){return de` <c-panel name="edge"> ${this.getCards()} </c-panel> `}};KB.styles=[kt];jKe([En({context:kC,subscribe:!0})],KB.prototype,"selected",2);KB=jKe([Ue("edge-panel")],KB);var Hjn=Object.defineProperty,qjn=Object.getOwnPropertyDescriptor,DV=(e,t,n,r)=>{for(var i=r>1?void 0:r?qjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Hjn(t,n,i),i};let fC=class extends St{render(){return de`
      <div
        id="rightMenu"
        class="${this.panels.containsSome(...S1.right)?"":"collapsed"}"
      >
        <div id="rightMenuTabs">
          <c-tab group="right" name="settings" class="only-editable"
            >Settings</c-tab
          >
          <c-tab group="right" name="network">Network</c-tab>
          <c-tab group="right" name="dataSet">Data set</c-tab>
          <c-tab group="right" name="train">Train</c-tab>
          ${this.model.model?de` <c-tab group="right" name="predict">Predict</c-tab> `:de``}
          ${this.selected.layer?de` <c-tab group="right" name="layer" colored>Layer</c-tab> `:de``}
          ${this.selected.neuron?de` <c-tab group="right" name="neuron" colored>Neuron</c-tab> `:de``}
          ${this.selected.edge?de` <c-tab group="right" name="edge" colored>Edge</c-tab> `:de``}
        </div>
        <div
          id="rightMenuPanel"
          class="${this.panels.containsSome(...S1.right)?"":"collapsed"}"
        >
          <settings-panel></settings-panel>
          <network-panel></network-panel>
          <data-set-panel></data-set-panel>
          <train-panel></train-panel>
          ${this.model.model?de` <predict-panel></predict-panel> `:de``}
          ${this.selected.layer?de` <layer-panel></layer-panel> `:de``}
          ${this.selected.neuron?de` <neuron-panel></neuron-panel> `:de``}
          ${this.selected.edge?de` <edge-panel></edge-panel> `:de``}
        </div>
      </div>
    `}};fC.styles=[kt,Qt`
      #rightMenu {
        width: 100%;
        height: 100%;
      }

      #rightMenu.collapsed {
        transform: translate(450px, 0);
      }

      #rightMenuTabs {
        position: absolute;
        top: 10px;
        right: 460px;
        width: 90px;
        display: grid;
        gap: 10px;
      }

      #rightMenuPanel {
        width: 100%;
        height: 100%;
        overflow: auto;
        padding: 10px;
      }

      #rightMenuPanel.collapsed {
        display: none;
      }
    `];DV([En({context:Hee,subscribe:!0})],fC.prototype,"model",2);DV([En({context:kC,subscribe:!0})],fC.prototype,"selected",2);DV([En({context:C8,subscribe:!0})],fC.prototype,"panels",2);fC=DV([Ue("menu-area")],fC);var Gjn=Object.defineProperty,Yjn=Object.getOwnPropertyDescriptor,xv=(e,t,n,r)=>{for(var i=r>1?void 0:r?Yjn(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Gjn(t,n,i),i};let ed=class extends St{constructor(){super(...arguments),this.shortcutListener=new Zlt(this),this.trainOptions={learningRate:.2,dropoutRate:.2,epochs:3,batchSize:50,lossFunction:"meanSquaredError",optimizer:"sgd"},this.model={model:null,reset:()=>{this.model.model=null,this.model=Object.create(this.model)},build:()=>{this.model.reset();const e=this.networkConf.network.buildModel();e&&(e.compile({optimizer:"sgd",loss:"meanSquaredError",metrics:["mse"]}),this.model.model=e,this.model=Object.create(this.model))},train:()=>{if(this.model.model||this.model.build(),this.model.model){const e=[];for(const n of this.networkConf.network.getInputLayers())e.push(...this.dataSet.getInputDataForLayer(n));const t=this.dataSet.getLabelData();this.model.model.fit(vp(e),vp(t),{epochs:10,batchSize:10,callbacks:{onBatchEnd:(n,r)=>{console.log("MSE",r.mse)}}}).then(n=>{console.log("Final MSE",n.history.mse)}),this.model=Object.create(this.model)}},predict:()=>{}},this.selected={select:({layer:e=null,neuron:t=null,edge:n=null}={})=>{const r={select:this.selected.select};t&&e?(r.neuron=t,r.layer=e,this.panels.open("neuron","right")):e?(r.layer=e,this.panels.open("layer","right")):n&&(r.edge=n,this.panels.open("edge","right")),this.selected=r}},this.panels={openPanels:[],open:(e,t)=>{t&&this.panels.close(...S1[t]),this.panels.openPanels.push(e),this.panels=Object.create(this.panels)},close:(...e)=>{this.panels.openPanels=this.panels.openPanels.filter(t=>!e.includes(t)),this.panels=Object.create(this.panels)},containsSome:(...e)=>this.panels.openPanels.some(t=>e.includes(t))}}async connectedCallback(){super.connectedCallback(),this.createNetworkConf();const e=await q2.getDataSetByName("Boston House Pricing");this.setDataSet(e)}createCanvas(e){this.canvas=new Vlt(this,e)}createNetworkConf(){this.networkConf={layers:new Map,addLayer:e=>{this.networkConf.layers.set(e.layerId,e),this.networkConf=Object.create(this.networkConf)},removeLayer:e=>{this.networkConf.layers.delete(e),this.networkConf=Object.create(this.networkConf)},layerConnections:new Map,addLayerConnection:e=>{this.networkConf.layerConnections.set([e.sourceLayer.layerId,e.targetLayer.layerId],e),this.networkConf=Object.create(this.networkConf)},removeLayerConnection:e=>{this.networkConf.layerConnections.delete(e),this.networkConf=Object.create(this.networkConf)},network:null}}createNetwork(e){console.log("created network"),this.networkConf.network=e,this.networkConf=Object.create(this.networkConf)}clearNetwork(){const e=this.networkConf.network;this.createNetworkConf(),this.networkConf.network=e,console.log("cleared network")}setDataSet(e){this.dataSet=e,this.networkConf.network&&this.networkConf.network.handleDataSetChange()}render(){return de`
      <div id="app">
        <canvas-area
          class="${this.panels.containsSome(...S1.right)?"":"right-collapsed"}"
          @canvas-created="${e=>this.createCanvas(e.detail)}"
        ></canvas-area>

        <div
          id="divider"
          class="${this.panels.containsSome(...S1.right)?"":"hidden"}"
        ></div>

        <menu-area
          class="${this.panels.containsSome(...S1.right)?"":"right-collapsed"}"
          @change-data-set="${e=>this.setDataSet(e.detail)}"
          @clear-network="${e=>this.clearNetwork()}"
        ></menu-area>
      </div>
      ${this.networkConf?de` <c-network
            @network-created="${e=>this.createNetwork(e.detail)}"
          ></c-network>`:de``}
    `}};ed.styles=[kt,Qt`
      #app {
        height: 100vh;
        display: flex;
        flex-direction: row;
        overflow: hidden;
        background-color: #f7f7f7;
      }

      canvas-area {
        width: calc(100% - 450px);
        height: 100%;
      }

      canvas-area.right-collapsed {
        width: 100%;
      }

      menu-area {
        width: 450px;
      }

      menu-area.right-collapsed {
        width: 0;
      }

      #divider {
        position: absolute;
        right: 449px;
        width: 2px;
        top: 10px;
        bottom: 10px;
        background-color: #efefef;
      }
    `];xv([Mb({context:Om}),J({attribute:!0,reflect:!0})],ed.prototype,"canvas",2);xv([Mb({context:Qp}),J({attribute:!0,reflect:!0})],ed.prototype,"networkConf",2);xv([Mb({context:Rm}),J({attribute:!0,reflect:!0})],ed.prototype,"dataSet",2);xv([Mb({context:Qlt}),J({attribute:!0,reflect:!0})],ed.prototype,"trainOptions",2);xv([Mb({context:Hee}),J({attribute:!0,reflect:!0})],ed.prototype,"model",2);xv([Mb({context:kC}),J({attribute:!0,reflect:!0})],ed.prototype,"selected",2);xv([Mb({context:C8}),J({attribute:!0,reflect:!0,type:Object})],ed.prototype,"panels",2);ed=xv([Ue("ww-deeplearning")],ed)});export default Xjn();
